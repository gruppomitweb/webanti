* --- CodePainter Revolution Batch Vers. 5.1
￼Icpbatch.CPBatch
Items=[
Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + czipfile + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Inizio estrazione del file '+ czipfile
global=True
len=500
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathDoc)+"/appo/"+LRTrim(gAzienda)+"/"+czipfile
name='cpercorsozip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathDoc)+"/appo/"+LRTrim(gAzienda)+"/"
name='cdirectoryfile
next=Icpitembatch.CPExec
check='man
frm_calc='try {﷯      // Apro il file zip﷯      java.util.zip.ZipFile zf = new java.util.zip.ZipFile(cpercorsozip);﷯﷯      //Conto il numero di file all interno del file zip e creo un array di stringhe per memorizzare i nomi file﷯      conteggio=zf.size();﷯      lista=new String[conteggio];﷯      ﷯      // Enumerate each entry﷯      i=0;﷯      for (java.util.Enumeration entries = zf.entries(); entries.hasMoreElements();) {﷯          // Get the entry name﷯          lista[i] = ((java.util.zip.ZipEntry)entries.nextElement()).getName();﷯          i++;﷯      }﷯     zf.close();﷯     } catch (java.io.IOException e) {﷯     }﷯try {﷯      // Apro il file zip﷯      java.util.zip.ZipFile zf = new java.util.zip.ZipFile(cpercorsozip);﷯﷯      byte[] buffer = new byte[1024]; ﷯      java.util.Enumeration entries = zf.entries();﷯      while(entries.hasMoreElements() ) {﷯        java.util.zip.ZipEntry entry = (java.util.zip.ZipEntry)entries.nextElement();﷯        java.io.InputStream in =zf.getInputStream(entry);﷯        java.io.OutputStream out = new java.io.BufferedOutputStream(new java.io.FileOutputStream(cdirectoryfile+entry.getName()));﷯﷯        int len;﷯﷯        while((len = in.read(buffer)) >= 0){﷯          out.write(buffer, 0, len);﷯        }﷯﷯          in.close();﷯          out.close();﷯      }﷯﷯      zf.close();﷯} catch (java.io.IOException ioe) {﷯      System.err.println("Unhandled exception:");﷯      ioe.printStackTrace();﷯      return;﷯}
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='contanome
next=Icpitembatch.CPVarDecl
frm_calc='0
len=3
name='_priorita
next=Icpitembatch.CPWhile
frm_calc='contanome<conteggio
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.MoveFile(LRTrim(gPathDoc)+"/appo/"+LRTrim(gAzienda)+"/"+LRTrim(czipfile),LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateToChar(Date())+"_"+LRTrim(czipfile))
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine estrazione del file '+ czipfile
global=True
len=500
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +czipfile + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O13
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O12
var_op='asgn
I
obj='Exec
pag=2
prev=O10
I
obj='While
pag=2
prev=O9
sons=[
Icpitembatch.CPItemSon
comment='Assegnal apriorità ad ogni file e lo inserisce in tmp_list
instr=Icpitembatch.CPExec
check='man
father=O10
fatherSonIndex=0
frm_calc='buffernomefile=lista[contanome];
next=Icpitembatch.CPVarDecl
frm_seek='AppendBlank
name='mcLista
next=Icpitembatch.CPVarDecl
frm_calc='buffernomefile
frm_seek='nomefile
name='mcLista
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcLista
next=Icpitembatch.CPVarDecl
frm_calc='contanome+1
len=10
name='contanome
obj='Var
obj_type='N
pag=2
prev=O20
var_op='asgn
I
obj='Var
obj_type='MC
pag=2
prev=O19
var_op='meth
I
obj='Var
obj_type='MC
pag=2
prev=O18
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O17
var_op='meth
I
obj='Exec
pag=2
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O8
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O7
var_op='asgn
I
obj='Exec
pag=2
prev=O6
I
obj='Var
pag=2
prev=O5
var_op='asgn
I
obj='Var
pag=2
prev=O4
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O3
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
x=12
y=18
I
Icpitembatch.CPBeginEnd
comment='Apre il file di testo
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge il file di testo e scrive il Memory Cursor
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Chiude il file di testo
h=[
19
19
]
obj='Begin
pag=3
prev=O25
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O27
fatherSonIndex=0
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + nomefileimport + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O31
var_op='asgn
I
obj='Exec
pag=3
I
I
]
w=[
150
150
]
I
obj='Begin
pag=3
prev=O23
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWhile
father=O25
fatherSonIndex=0
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
obj='While
pag=3
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O36
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=3
prev=O40
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O41
fatherSonIndex=0
frm_seek='AppendBlank
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Left(riga,11))
frm_seek='CodiceIstituto
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,12,8))
frm_seek='DataElaborazione
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,20,3))
frm_seek='ProceduraOrigine
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,23,9))
frm_seek='NumeroElettronicoOperante
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,32,9))
frm_seek='SottoNumeroOperazione
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,41,2))
frm_seek='TipoRegistrazione
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,43,8))
frm_seek='DataOperazione
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,51,6))
frm_seek='FilialeOperante
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,57,5))
frm_seek='CodiceOperatore
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,62,4))
frm_seek='TerminaleOperante
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,66,4))
frm_seek='Transazione
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,70,1))
frm_seek='OperazioneCassa
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,71,4))
frm_seek='CausaleInterna
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,75,4))
frm_seek='CodiceCausale
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,79,1))
frm_seek='FlagContanti
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='Val(LRTrim(Substr(riga,80,15))) / 100
frm_seek='ImportoTotale
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='Val(LRTrim(Substr(riga,95,15))) / 100
frm_seek='ImportoContante
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,110,1))
frm_seek='Segno
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,111,3))
frm_seek='CodiceDivisa
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,114,25))
frm_seek='NumeroRapporto
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,139,1))
frm_seek='TipoRapportoAUI
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,140,5))
frm_seek='FormaTecnica
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,145,3))
frm_seek='TipoRapportoIntermediario
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,148,5))
frm_seek='CABSportello
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,153,100))
frm_seek='Note
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,253,1))
frm_seek='FlagSaggio
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,254,1))
frm_seek='FlagPostRep
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,255,20))
frm_seek='FILLER1
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,275,1))
frm_seek='Ragionevolezza
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,276,3))
frm_seek='Tipologia
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,279,3))
frm_seek='Motivazione
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,282,1))
frm_seek='NaturaScopo
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,283,1))
frm_seek='TipoVerifica
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,284,1))
frm_seek='ObbTitolareEff
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,285,1))
frm_seek='SocFiduciaria
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,286,25))
frm_seek='NumeroOperazione
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='Val(LRTrim(Substr(riga,311,15))) / 100
frm_seek='ImportoFineMese
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,326,1))
frm_seek='FlagObbFiduciante
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,327,1))
frm_seek='FlagObbNumOpeLegame
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,328,25))
frm_seek='NumOpeLegame
name='mcFlussi
obj='Var
obj_type='MC
pag=3
prev=O85
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O84
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O83
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O82
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O81
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O80
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O79
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O78
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O77
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O76
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O75
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O74
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O73
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O72
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O71
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O70
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O69
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O68
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O67
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O66
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O65
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O64
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O63
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O62
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O61
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O60
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O59
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O58
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O57
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O56
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O55
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O54
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O53
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O52
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O51
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O50
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O49
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O48
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O47
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O46
var_op='prop
I
obj='Var
obj_type='MC
pag=3
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O23
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
name='fhand
obj='Var
pag=3
prev=O92
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
x=15
y=17
I
Icpitembatch.CPBeginEnd
comment='Apre il file di testo
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge il file di testo e scrive il Memory Cursor
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Chiude il file di testo
h=[
19
19
]
obj='Begin
pag=4
prev=O97
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O99
fatherSonIndex=0
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + nomefileimport + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O103
var_op='asgn
I
obj='Exec
pag=4
I
I
]
w=[
150
150
]
I
obj='Begin
pag=4
prev=O95
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPWhile
father=O97
fatherSonIndex=0
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
obj='While
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O108
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=4
prev=O112
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O113
fatherSonIndex=0
frm_seek='AppendBlank
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Left(riga,11))
frm_seek='CodiceIstituto
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,12,8))
frm_seek='DataElaborazione
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,20,16))
frm_seek='CodiceCliente
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,36,16))
frm_seek='CodiceFiscale
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='iif(LRTrim(Substr(riga,321,1))='F',LRTrim(Substr(riga,323,45))+" "+LRTrim(Substr(riga,368,30)),LRTrim(Substr(riga,52,70)))
frm_seek='Intestazione
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,122,30))
frm_seek='NascitaOSede
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='iif(LRTrim(Substr(riga,152,8))='00000000','',LRTrim(Substr(riga,152,8)))
frm_seek='DataDiNascita
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,160,35))
frm_seek='Indirizzo
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,195,5))
frm_seek='CAP
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,200,6))
frm_seek='CAB
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,206,30))
frm_seek='Localita
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,236,2))
frm_seek='Provincia
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,238,3))
frm_seek='Stato
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,241,2))
frm_seek='TipoDocumento
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,243,15))
frm_seek='NumeroDocumento
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='iif(LRTrim(Substr(riga,258,8))='00000000','',LRTrim(Substr(riga,258,8)))
frm_seek='DataRilascio
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,266,30))
frm_seek='AutoritaRilascio
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='iif(LRTrim(Substr(riga,296,3))='000','',LRTrim(Substr(riga,296,3)))
frm_seek='SAE
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,299,3))
frm_seek='RAE
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,302,1))
frm_seek='Sesso
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,303,5))
frm_seek='SportelloCapofila
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,308,5))
frm_seek='CabCapofila
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,313,8))
frm_seek='DataCensimento
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,321,1))
frm_seek='TipoSoggetto
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,322,1))
frm_seek='SoggettoOccasionale
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,323,45))
frm_seek='Cognome
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,368,30))
frm_seek='Nome
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,398,2))
frm_seek='ProvinciaNascita
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,400,3))
frm_seek='StatoNascita
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,403,5))
frm_seek='FormaGiuridica
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,408,8))
frm_seek='DataCostituzione
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,416,60))
frm_seek='Note
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='iif(LRTrim(Substr(riga,476,8))='00000000','',LRTrim(Substr(riga,476,8)))
frm_seek='DataRiferimento
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,484,1))
frm_seek='FlagAsiloPolitico
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,485,3))
frm_seek='PrevalenteAttivita
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,488,1))
frm_seek='ComportamentoTenuto
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,489,1))
frm_seek='ModalitaAcquisizione
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,490,1))
frm_seek='PatrimonioIntermediario
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,491,1))
frm_seek='CapacitaPatrimoniale
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,492,1))
frm_seek='Flag231
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,493,3))
frm_seek='NazionalitaISO
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,496,1))
frm_seek='SocietaNonQuotata
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,497,1))
frm_seek='PrecedentiPenali
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,498,1))
frm_seek='AffidabilitaFinanziaria
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,499,1))
frm_seek='ProcedureConcorsuali
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,500,5))
frm_seek='ProfiloRischio
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,505,6))
frm_seek='ATECO
name='mcAnagrafiche
obj='Var
obj_type='MC
pag=4
prev=O164
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O163
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O162
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O161
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O160
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O159
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O158
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O157
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O156
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O155
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O154
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O153
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O152
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O151
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O150
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O149
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O148
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O147
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O146
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O145
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O144
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O143
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O142
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O141
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O140
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O139
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O138
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O137
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O136
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O135
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O134
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O133
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O132
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O131
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O130
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O129
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O128
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O127
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O126
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O125
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O124
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O123
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O122
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O121
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O120
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O119
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O118
var_op='prop
I
obj='Var
obj_type='MC
pag=4
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O95
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
name='fhand
obj='Var
pag=4
prev=O171
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
x=17
y=18
I
Icpitembatch.CPBeginEnd
comment='Apre il file di testo
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge il file di testo e scrive il Memory Cursor
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Chiude il file di testo
h=[
19
19
]
obj='Begin
pag=5
prev=O176
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O178
fatherSonIndex=0
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + nomefileimport + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O182
var_op='asgn
I
obj='Exec
pag=5
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
prev=O174
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWhile
father=O176
fatherSonIndex=0
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
obj='While
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O187
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=5
prev=O191
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O192
fatherSonIndex=0
frm_seek='AppendBlank
name='mcCollegamento
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Left(riga,11))
frm_seek='CodiceIstituto
name='mcCollegamento
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,12,8))
frm_seek='DataElaborazione
name='mcCollegamento
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,20,3))
frm_seek='ProceduraOrigine
name='mcCollegamento
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,23,9))
frm_seek='NumeroElettronicoOperante
name='mcCollegamento
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,32,9))
frm_seek='SottoNumeroOperazione
name='mcCollegamento
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,41,16))
frm_seek='CodiceCliente
name='mcCollegamento
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,57,1))
frm_seek='RuoloCliente
name='mcCollegamento
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,58,1))
frm_seek='EsecutoreOperazione
name='mcCollegamento
obj='Var
obj_type='MC
pag=5
prev=O204
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O203
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O202
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O201
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O200
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O199
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O198
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O197
var_op='prop
I
obj='Var
obj_type='MC
pag=5
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O174
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
name='fhand
obj='Var
pag=5
prev=O211
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
x=9
y=17
I
Icpitembatch.CPBeginEnd
comment='Variabili locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge il primo cursore
h=[
19
19
]
obj='Begin
pag=7
prev=O214
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O216
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Caricamento Anagrafiche: '+ arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPForEach
for_variable='rwAnagrafiche
for_variable_type='mcAnagrafiche.MCRDef
h=[
19
19
]
iterator_expr='mcAnagraficheRapporti
next=Icpitembatch.CPForEach
for_variable='rwAnagrafiche
for_variable_type='mcAnagrafiche.MCRDef
h=[
19
19
]
iterator_expr='mcAnagraficheMovimenti
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Caricamento Anagrafiche: '+ arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=7
prev=O223
var_op='asgn
I
obj='ForEach
pag=7
prev=O221
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Variabile per messaggi Elaborazione
father=O223
fatherSonIndex=0
frm_calc=''Processo soggetto con codice: '+LRTrim(rwAnagrafiche.CodiceCliente)
global=True
len=500
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_connes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPVarDecl
frm_seek='armt_personboBO
name='oMaster
next=Icpitembatch.CPVarDecl
frm_seek='Initialize
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='False
frm_seek='Set_COMPLETA
name='oMaster
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_connes))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_modificato
]
h=[
19
19
]
obj='If
pag=7
prev=O235
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O238
fatherSonIndex=0
frm_calc='LRTrim(rwAnagrafiche.Intestazione)
frm_seek='Set_RAGSOC
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.Stato)
frm_seek='Set_PAESE
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.Localita)
frm_seek='Set_DESCCIT
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.Provincia)
frm_seek='Set_PROVINCIA
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.CAP)
frm_seek='Set_CAP
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.CAB)
frm_seek='Set_CODCAB
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.Indirizzo)
frm_seek='Set_DOMICILIO
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.SAE)
frm_seek='Set_SOTGRUP
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.ATECO)
frm_seek='Set_ATTIV
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='iif(LRTrim(rwAnagrafiche.TipoSoggetto)='F','P','G')
frm_seek='Set_TIPOPERS
name='oMaster
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(rwAnagrafiche.TipoSoggetto)='F'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.CodiceFiscale)
frm_seek='Set_CODFISC
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.CodiceCliente)
frm_seek='Set_CONNES
name='oMaster
next=Icpitembatch.CPIfElse
frm_calc=[
'mcCategoria.HasKey(LRTrim(rwAnagrafiche.CodiceCliente))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_seek='Calculate
name='oMaster
next=Icpitembatch.CPVarDecl
frm_seek='Save
name='oMaster
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(oMaster.m_cLastMsgError))
]
h=[
19
19
]
obj='If
pag=7
prev=O262
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O263
fatherSonIndex=0
frm_calc='gMsgProc + "Errore nell'elaborazione del soggetto  "+ LRTrim(rwAnagrafiche.CodiceCliente) +": "+LRTrim(oMaster.m_cLastMsgError)+ NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O261
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O258
var_op='meth
I
obj='If
pag=7
prev=O257
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O258
fatherSonIndex=0
frm_calc='LRTrim(rwAnagrafiche.CodiceCliente)
frm_seek='GoToKey
name='mcCategoria
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(mcCategoria.COD_TIPO_SOGG)='PG'
]
h=[
19
19
]
obj='If
pag=7
prev=O272
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O273
fatherSonIndex=0
frm_calc='LRTrim(mcCategoria.COD_ATECO)
frm_seek='Set_ATTIV
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(mcCategoria.COD_SPEC_GIUR)
frm_seek='Set_PKTBSPECIE
name='oMaster
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O278
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=7
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O256
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O253
var_op='meth
I
obj='If
pag=7
prev=O252
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O253
fatherSonIndex=0
frm_calc='LRTrim(rwAnagrafiche.Cognome)
frm_seek='Set_COGNOME
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.Nome)
frm_seek='Set_NOME
name='oMaster
next=Icpitembatch.CPVarDecl
frm_seek='Calculation_UEZIABOGNW
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(LRTrim(rwAnagrafiche.DataDiNascita))
frm_seek='Set_DATANASC
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.ProvinciaNascita)
frm_seek='Set_TIPINTER
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.Sesso)
frm_seek='Set_SESSO
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.NascitaOSede)
frm_seek='Set_NASCOMUN
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='''
len=40
name='_stato
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(_stato)
frm_seek='Set_NASSTATO
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.TipoDocumento)
frm_seek='Set_TIPODOC
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.NumeroDocumento)
frm_seek='Set_NUMDOCUM
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(LRTrim(rwAnagrafiche.DataRilascio))
frm_seek='Set_DATARILASC
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.AutoritaRilascio)
frm_seek='Set_AUTRILASC
name='oMaster
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O296
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O295
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O294
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O293
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O292
var_op='meth
I
obj='Read
pag=7
prev=O291
rd_field=[
'DESCRI
]
rd_kfield=[
'ISO
]
rd_kvar=[
'LRTrim(rwAnagrafiche.StatoNascita)
]
rd_var=[
'_stato
]
I
obj='Var
pag=7
pagelocal=True
prev=O290
var_op='asgn
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O289
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O288
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O287
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O286
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O285
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O284
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O251
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O250
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O249
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O248
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O247
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O246
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O245
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O244
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O243
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
var_op='meth
I
I
]
w=[
150
150
]
I
obj='If
pag=7
prev=O234
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O235
fatherSonIndex=0
frm_calc='_connes
frm_seek='Load
name='oMaster
next=Icpitembatch.CPBeginEnd
comment='Controlla se deve modificare il record
h=[
19
19
]
obj='Begin
pag=7
prev=O306
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O307
fatherSonIndex=0
frm_calc='_modificato or (LRTrim(oMaster.w_RAGSOC)<>LRTrim(rwAnagrafiche.Intestazione))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_PAESE)<>LRTrim(rwAnagrafiche.Stato))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_DESCCIT)<>LRTrim(rwAnagrafiche.Localita))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_PROVINCIA)<>LRTrim(rwAnagrafiche.Provincia))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_CAP)<>LRTrim(rwAnagrafiche.CAP))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_CODCAB)<>LRTrim(rwAnagrafiche.CAB))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_DOMICILIO)<>LRTrim(rwAnagrafiche.Indirizzo))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_SOTGRUP)<>LRTrim(rwAnagrafiche.SAE))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_ATTIV)<>LRTrim(rwAnagrafiche.ATECO))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='iif(LRTrim(rwAnagrafiche.TipoSoggetto)='F','P','G')
len=1
name='_tiposog
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_TIPOPERS)<>_tiposog)
len=1
name='_modificato
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(rwAnagrafiche.TipoSoggetto)='F'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_CODFISC)<>LRTrim(rwAnagrafiche.CodiceFiscale))
len=1
name='_modificato
next=Icpitembatch.CPIfElse
frm_calc=[
'mcCategoria.HasKey(LRTrim(rwAnagrafiche.CodiceCliente))
]
h=[
19
19
]
obj='If
pag=7
prev=O325
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O326
fatherSonIndex=0
frm_calc='LRTrim(rwAnagrafiche.CodiceCliente)
frm_seek='GoToKey
name='mcCategoria
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(mcCategoria.COD_TIPO_SOGG)='PG'
]
h=[
19
19
]
obj='If
pag=7
prev=O331
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O332
fatherSonIndex=0
frm_calc='_modificato or (LRTrim(oMaster.w_ATTIV)<>LRTrim(mcCategoria.COD_ATECO))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_PKTBSPECIE)<>LRTrim(mcCategoria.COD_SPEC_GIUR))
len=1
name='_modificato
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O337
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=7
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O322
var_op='asgn
I
obj='If
pag=7
prev=O321
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O322
fatherSonIndex=0
frm_calc='_modificato or (LRTrim(oMaster.w_COGNOME)<>LRTrim(rwAnagrafiche.Cognome))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_NOME)<>LRTrim(rwAnagrafiche.Nome))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (oMaster.w_DATANASC<>CharToDate(LRTrim(rwAnagrafiche.DataDiNascita)))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_TIPINTER)<>LRTrim(rwAnagrafiche.ProvinciaNascita))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_SESSO)<>LRTrim(rwAnagrafiche.Sesso))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_NASCOMUN)<>LRTrim(rwAnagrafiche.NascitaOSede))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='''
len=40
name='_stato
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_NASSTATO)<>LRTrim(_stato))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_TIPODOC)<>LRTrim(rwAnagrafiche.TipoDocumento))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_NUMDOCUM)<>LRTrim(rwAnagrafiche.NumeroDocumento))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (oMaster.w_DATARILASC<>CharToDate(LRTrim(rwAnagrafiche.DataRilascio)))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_AUTRILASC)<>LRTrim(rwAnagrafiche.AutoritaRilascio))
len=1
name='_modificato
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O354
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O353
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O352
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O351
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O350
var_op='asgn
I
obj='Read
pag=7
prev=O349
rd_field=[
'DESCRI
]
rd_kfield=[
'ISO
]
rd_kvar=[
'LRTrim(rwAnagrafiche.StatoNascita)
]
rd_var=[
'_stato
]
I
obj='Var
pag=7
pagelocal=True
prev=O348
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O347
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O346
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O345
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O344
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O343
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O320
var_op='asgn
I
obj='Var
pag=7
pagelocal=True
prev=O319
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O318
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O317
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O316
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O315
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O314
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O313
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O312
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O311
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='O
pag=7
pagelocal=True
var_op='meth
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O235
fatherSonIndex=1
frm_calc='True
len=1
name='_modificato
obj='Var
obj_type='L
pag=7
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O233
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O232
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O231
var_op='new
I
obj='Read
pag=7
prev=O230
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(rwAnagrafiche.CodiceCliente)
]
rd_var=[
'_connes
]
I
obj='Var
pag=7
pagelocal=True
prev=O229
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O228
var_op='asgn
I
nonlocal=True
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=7
prev=O220
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Variabile per messaggi Elaborazione
father=O221
fatherSonIndex=0
frm_calc=''Processo soggetto con codice: '+LRTrim(rwAnagrafiche.CodiceCliente)
global=True
len=500
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_connes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPVarDecl
frm_seek='armt_personboBO
name='oMaster
next=Icpitembatch.CPVarDecl
frm_seek='Initialize
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='False
frm_seek='Set_COMPLETA
name='oMaster
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_connes))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_modificato
]
h=[
19
19
]
obj='If
pag=7
prev=O379
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O382
fatherSonIndex=0
frm_calc='LRTrim(rwAnagrafiche.Intestazione)
frm_seek='Set_RAGSOC
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.Stato)
frm_seek='Set_PAESE
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.Localita)
frm_seek='Set_DESCCIT
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.Provincia)
frm_seek='Set_PROVINCIA
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.CAP)
frm_seek='Set_CAP
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.CAB)
frm_seek='Set_CODCAB
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.Indirizzo)
frm_seek='Set_DOMICILIO
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.SAE)
frm_seek='Set_SOTGRUP
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.ATECO)
frm_seek='Set_ATTIV
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='iif(LRTrim(rwAnagrafiche.TipoSoggetto)='F','P','G')
frm_seek='Set_TIPOPERS
name='oMaster
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(rwAnagrafiche.TipoSoggetto)='F'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.CodiceFiscale)
frm_seek='Set_CODFISC
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.CodiceCliente)
frm_seek='Set_CONNES
name='oMaster
next=Icpitembatch.CPIfElse
frm_calc=[
'mcCategoria.HasKey(LRTrim(rwAnagrafiche.CodiceCliente))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_seek='Calculate
name='oMaster
next=Icpitembatch.CPVarDecl
frm_seek='Save
name='oMaster
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(oMaster.m_cLastMsgError))
]
h=[
19
19
]
obj='If
pag=7
prev=O406
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O407
fatherSonIndex=0
frm_calc='gMsgProc + "Errore nell'elaborazione del soggetto  "+ LRTrim(rwAnagrafiche.CodiceCliente) +": "+LRTrim(oMaster.m_cLastMsgError)+ NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O405
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O402
var_op='meth
I
obj='If
pag=7
prev=O401
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O402
fatherSonIndex=0
frm_calc='LRTrim(rwAnagrafiche.CodiceCliente)
frm_seek='GoToKey
name='mcCategoria
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(mcCategoria.COD_TIPO_SOGG)='PG'
]
h=[
19
19
]
obj='If
pag=7
prev=O416
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O417
fatherSonIndex=0
frm_calc='LRTrim(mcCategoria.COD_ATECO)
frm_seek='Set_ATTIV
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(mcCategoria.COD_SPEC_GIUR)
frm_seek='Set_PKTBSPECIE
name='oMaster
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O422
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=7
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O400
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O397
var_op='meth
I
obj='If
pag=7
prev=O396
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O397
fatherSonIndex=0
frm_calc='LRTrim(rwAnagrafiche.Cognome)
frm_seek='Set_COGNOME
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.Nome)
frm_seek='Set_NOME
name='oMaster
next=Icpitembatch.CPVarDecl
frm_seek='Calculation_UEZIABOGNW
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(LRTrim(rwAnagrafiche.DataDiNascita))
frm_seek='Set_DATANASC
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.ProvinciaNascita)
frm_seek='Set_TIPINTER
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.Sesso)
frm_seek='Set_SESSO
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.NascitaOSede)
frm_seek='Set_NASCOMUN
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='''
len=40
name='_stato
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(_stato)
frm_seek='Set_NASSTATO
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.TipoDocumento)
frm_seek='Set_TIPODOC
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.NumeroDocumento)
frm_seek='Set_NUMDOCUM
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(LRTrim(rwAnagrafiche.DataRilascio))
frm_seek='Set_DATARILASC
name='oMaster
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwAnagrafiche.AutoritaRilascio)
frm_seek='Set_AUTRILASC
name='oMaster
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O440
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O439
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O438
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O437
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O436
var_op='meth
I
obj='Read
pag=7
prev=O435
rd_field=[
'DESCRI
]
rd_kfield=[
'ISO
]
rd_kvar=[
'LRTrim(rwAnagrafiche.StatoNascita)
]
rd_var=[
'_stato
]
I
obj='Var
pag=7
pagelocal=True
prev=O434
var_op='asgn
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O433
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O432
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O431
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O430
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O429
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O428
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O395
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O394
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O393
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O392
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O391
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O390
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O389
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O388
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O387
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
var_op='meth
I
I
]
w=[
150
150
]
I
obj='If
pag=7
prev=O378
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O379
fatherSonIndex=0
frm_calc='_connes
frm_seek='Load
name='oMaster
next=Icpitembatch.CPBeginEnd
comment='Controlla se deve modificare il record
h=[
19
19
]
obj='Begin
pag=7
prev=O450
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O451
fatherSonIndex=0
frm_calc='_modificato or (LRTrim(oMaster.w_RAGSOC)<>LRTrim(rwAnagrafiche.Intestazione))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_PAESE)<>LRTrim(rwAnagrafiche.Stato))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_DESCCIT)<>LRTrim(rwAnagrafiche.Localita))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_PROVINCIA)<>LRTrim(rwAnagrafiche.Provincia))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_CAP)<>LRTrim(rwAnagrafiche.CAP))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_CODCAB)<>LRTrim(rwAnagrafiche.CAB))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_DOMICILIO)<>LRTrim(rwAnagrafiche.Indirizzo))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_SOTGRUP)<>LRTrim(rwAnagrafiche.SAE))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_ATTIV)<>LRTrim(rwAnagrafiche.ATECO))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='iif(LRTrim(rwAnagrafiche.TipoSoggetto)='F','P','G')
len=1
name='_tiposog
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_TIPOPERS)<>_tiposog)
len=1
name='_modificato
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(rwAnagrafiche.TipoSoggetto)='F'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_CODFISC)<>LRTrim(rwAnagrafiche.CodiceFiscale))
len=1
name='_modificato
next=Icpitembatch.CPIfElse
frm_calc=[
'mcCategoria.HasKey(LRTrim(rwAnagrafiche.CodiceCliente))
]
h=[
19
19
]
obj='If
pag=7
prev=O469
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O470
fatherSonIndex=0
frm_calc='LRTrim(rwAnagrafiche.CodiceCliente)
frm_seek='GoToKey
name='mcCategoria
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(mcCategoria.COD_TIPO_SOGG)='PG'
]
h=[
19
19
]
obj='If
pag=7
prev=O475
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O476
fatherSonIndex=0
frm_calc='_modificato or (LRTrim(oMaster.w_ATTIV)<>LRTrim(mcCategoria.COD_ATECO))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_PKTBSPECIE)<>LRTrim(mcCategoria.COD_SPEC_GIUR))
len=1
name='_modificato
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O481
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=7
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O466
var_op='asgn
I
obj='If
pag=7
prev=O465
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O466
fatherSonIndex=0
frm_calc='_modificato or (LRTrim(oMaster.w_COGNOME)<>LRTrim(rwAnagrafiche.Cognome))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_NOME)<>LRTrim(rwAnagrafiche.Nome))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (oMaster.w_DATANASC<>CharToDate(LRTrim(rwAnagrafiche.DataDiNascita)))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_TIPINTER)<>LRTrim(rwAnagrafiche.ProvinciaNascita))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_SESSO)<>LRTrim(rwAnagrafiche.Sesso))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_NASCOMUN)<>LRTrim(rwAnagrafiche.NascitaOSede))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='''
len=40
name='_stato
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_NASSTATO)<>LRTrim(_stato))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_TIPODOC)<>LRTrim(rwAnagrafiche.TipoDocumento))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_NUMDOCUM)<>LRTrim(rwAnagrafiche.NumeroDocumento))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (oMaster.w_DATARILASC<>CharToDate(LRTrim(rwAnagrafiche.DataRilascio)))
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
frm_calc='_modificato or (LRTrim(oMaster.w_AUTRILASC)<>LRTrim(rwAnagrafiche.AutoritaRilascio))
len=1
name='_modificato
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O498
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O497
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O496
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O495
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O494
var_op='asgn
I
obj='Read
pag=7
prev=O493
rd_field=[
'DESCRI
]
rd_kfield=[
'ISO
]
rd_kvar=[
'LRTrim(rwAnagrafiche.StatoNascita)
]
rd_var=[
'_stato
]
I
obj='Var
pag=7
pagelocal=True
prev=O492
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O491
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O490
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O489
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O488
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O487
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O464
var_op='asgn
I
obj='Var
pag=7
pagelocal=True
prev=O463
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O462
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O461
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O460
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O459
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O458
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O457
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O456
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O455
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='O
pag=7
pagelocal=True
var_op='meth
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O379
fatherSonIndex=1
frm_calc='True
len=1
name='_modificato
obj='Var
obj_type='L
pag=7
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O377
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O376
var_op='meth
I
obj='Var
obj_type='O
pag=7
pagelocal=True
prev=O375
var_op='new
I
obj='Read
pag=7
prev=O374
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(rwAnagrafiche.CodiceCliente)
]
rd_var=[
'_connes
]
I
obj='Var
pag=7
pagelocal=True
prev=O373
var_op='asgn
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O372
var_op='asgn
I
nonlocal=True
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O214
fatherSonIndex=0
frm_seek='armt_personboBO
name='oMaster
next=Icpitembatch.CPVarDecl
len=16
name='_connes
next=Icpitembatch.CPVarDecl
len=40
name='_stato
next=Icpitembatch.CPVarDecl
len=1
name='_modificato
next=Icpitembatch.CPVarDecl
len=1
name='_tiposog
obj='Var
pag=7
pagelocal=True
prev=O520
I
obj='Var
obj_type='L
pag=7
pagelocal=True
prev=O519
I
obj='Var
pag=7
pagelocal=True
prev=O518
I
obj='Var
pag=7
pagelocal=True
prev=O517
I
obj='Var
obj_type='O
pag=7
pagelocal=True
I
I
]
w=[
150
150
]
x=22
y=17
I
Icpitembatch.CPBeginEnd
comment='Variabili Locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Scorre i dati dei Rapporti Legami
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Scorre i dati dei movimenti
h=[
19
19
]
obj='Begin
pag=8
prev=O525
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O527
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Caricamento Movimenti: '+ arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPForEach
for_variable='rwFlusso
for_variable_type='mcFlusso.MCRDef
h=[
19
19
]
iterator_expr='mcFlussiMovimenti
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Caricamento Movimenti: '+ arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O532
var_op='asgn
I
obj='ForEach
pag=8
prev=O531
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Variabile per messaggi Elaborazione
father=O532
fatherSonIndex=0
frm_calc=''Processo Informazione con codice: '+LRTrim(rwFlusso.NumeroOperazione)
global=True
len=500
name='gMsgImp
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'rwFlusso.ImportoTotale < 5000
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
prev=O538
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Frazionate
instr=Icpitembatch.CPVarDecl
father=O540
fatherSonIndex=0
frm_seek='armt_ofrazionateBO
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_seek='Initialize
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_calc='False
frm_seek='Set_CALCOLI
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_calc='False
frm_seek='Set_COMPLETA
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(rwFlusso.DataOperazione)
frm_seek='Set_DATAOPE
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_calc='Date()
frm_seek='Set_DATAREG
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_calc=''0'
frm_seek='Set_FLAGFRAZ
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_calc='_codcau
frm_seek='Set_idcauana
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwFlusso.CodiceCausale)
frm_seek='w_CODANA
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(_codvoc)
frm_seek='w_CODVOC
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_calc='rwFlusso.Segno
frm_seek='w_SEGNO
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_calc='iif(rwFlusso.CodiceDivisa='242','E','V')
frm_seek='Set_appolire
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_calc='rwFlusso.TipoRegistrazione
frm_seek='Set_TIPOOPRAP
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_calc='rwFlusso.CodiceDivisa
frm_seek='Set_VALUTA
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_calc='rwFlusso.ImportoTotale
frm_seek='Set_xTOTLIRE
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_calc='rwFlusso.FlagContanti
frm_seek='Set_FLAGCONT
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_calc='rwFlusso.ImportoContante
frm_seek='Set_xTOTCONT
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_calc='rwFlusso.NumeroRapporto
frm_seek='w_RAPPORTO
name='oFrazionate
next=Icpitembatch.CPForEach
for_variable='rwCollega
for_variable_type='mcCollegamento.MCRDef
h=[
19
19
]
iterator_expr='mcCollegamentoMovimenti
next=Icpitembatch.CPForEach
for_variable='rwContro
for_variable_type='mcControparte.MCRDef
h=[
19
19
]
iterator_expr='mcControparti
next=Icpitembatch.CPVarDecl
frm_calc='"XXXXXXXXX"
frm_seek='w_RIFIMP
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwFlusso.NumeroOperazione)
frm_seek='w_INFORM
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_seek='Save
name='oFrazionate
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(oFrazionate.m_cLastMsgError))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
prev=O569
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O570
fatherSonIndex=0
frm_calc='gMsgProc + "Errore nell'elaborazione della frazionata "+ LRTrim(rwFlusso.NumeroElettronicoOperante) +": "+LRTrim(oFrazionate.m_cLastMsgError)+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPMessage
frm_calc='"Errore nell'elaborazione della frazionata "+ LRTrim(rwFlusso.NumeroElettronicoOperante) +": "+LRTrim(oFrazionate.m_cLastMsgError)
msg_type='Warn
obj='Message
pag=8
prev=O575
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='bat
father=O570
fatherSonIndex=1
frm_calc='arrt_writelog('NUOVO RECORD','FRAZIOBO',oFrazionate.w_IDBASE)
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_crea_idereg('F',oFrazionate.w_IDBASE,'D')
obj='Exec
pag=8
prev=O578
I
obj='Exec
pag=8
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O568
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O567
var_op='prop
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O565
var_op='prop
I
obj='ForEach
pag=8
prev=O563
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O565
fatherSonIndex=0
frm_calc=[
'rwContro.CodiceIstituto+rwContro.DataElaborazione+rwContro.ProceduraOrigine+rwContro.NumeroElettronicoOperante+rwContro.SottoNumeroOperazione=rwFlusso.CodiceIstituto+rwFlusso.DataElaborazione+rwFlusso.ProceduraOrigine+rwFlusso.NumeroElettronicoOperante+rwFlusso.SottoNumeroOperazione
]
h=[
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O583
fatherSonIndex=0
frm_calc='LRTrim(rwContro.CodiceBeneficiario)
frm_seek='Set_CONNESBEN
name='oFrazionate
next=Icpitembatch.CPIfElse
frm_calc=[
'rwContro.CodiceStatoBanca='086'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='rwContro.TipoIntermediario
frm_seek='Set_TIPOINT2
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwContro.DescrizioneIntermediario)
frm_seek='Set_DESCINTER
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwContro.StatoBeneficiario)
frm_seek='Set_PAESE
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwContro.CabBanca)
frm_seek='Set_CODCAB2
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwContro.ComuneBanca)
frm_seek='Set_DESC2
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwContro.ProvinciaBanca)
frm_seek='Set_PROV2
name='oFrazionate
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O596
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O595
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O594
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O593
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O592
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O589
var_op='meth
I
obj='If
pag=8
prev=O588
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O589
fatherSonIndex=0
frm_calc='Substr(rwContro.CodiceRapporto,4,5)+"-"+Substr(rwContro.CodiceRapporto,9,5)
frm_seek='Set_CODINT2
name='oFrazionate
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O589
fatherSonIndex=1
frm_calc='LRTrim(rwContro.CodiceIntermediario)
frm_seek='Set_CODINT2
name='oFrazionate
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=8
prev=O562
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O563
fatherSonIndex=0
frm_calc=[
'rwCollega.RuoloCliente='T' or rwCollega.RuoloCliente='C'
'rwCollega.RuoloCliente='S'
'rwCollega.RuoloCliente='U'
]
h=[
19
19
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O608
fatherSonIndex=0
frm_calc='LRTrim(rwCollega.CodiceCliente)
frm_seek='Set_CONNESCLI
name='oFrazionate
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O608
fatherSonIndex=1
frm_calc='LRTrim(rwCollega.CodiceCliente)
frm_seek='Set_CONNESOPER
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_calc=''3'
frm_seek='Set_TIPOLEG
name='oFrazionate
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O615
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O608
fatherSonIndex=2
frm_calc='LRTrim(rwCollega.CodiceCliente)
frm_seek='Set_CONNALTRO
name='oFrazionate
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
]
where_expr='rwCollega.CodiceIstituto+rwCollega.DataElaborazione+rwCollega.ProceduraOrigine+rwCollega.NumeroElettronicoOperante+rwCollega.SottoNumeroOperazione=rwFlusso.CodiceIstituto+rwFlusso.DataElaborazione+rwFlusso.ProceduraOrigine+rwFlusso.NumeroElettronicoOperante+rwFlusso.SottoNumeroOperazione
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O561
var_op='prop
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O560
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O559
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O558
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O557
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O556
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O555
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O554
var_op='prop
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O553
var_op='prop
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O552
var_op='prop
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O551
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O550
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O549
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O548
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O547
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O546
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O545
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='new
I
I
Icpitembatch.CPItemSon
comment='Operazioni
instr=Icpitembatch.CPVarDecl
father=O540
fatherSonIndex=1
frm_seek='armt_operazioniBO
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_seek='Initialize
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='False
frm_seek='Set_CALCOLI
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='False
frm_seek='Set_COMPLETA
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(rwFlusso.DataOperazione)
frm_seek='Set_DATAOPE
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Date()
frm_seek='Set_DATAREG
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_calc=''0'
frm_seek='Set_FLAGFRAZ
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='rwFlusso.TipoRegistrazione
frm_seek='Set_TIPOOPRAP
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='_codcau
frm_seek='Set_idcauana
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwFlusso.CodiceCausale)
frm_seek='w_CODANA
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(_codvoc)
frm_seek='w_CODVOC
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='rwFlusso.Segno
frm_seek='w_SEGNO
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='iif(rwFlusso.CodiceDivisa='242','E','V')
frm_seek='Set_appolire
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='rwFlusso.CodiceDivisa
frm_seek='Set_VALUTA
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='rwFlusso.ImportoTotale
frm_seek='Set_xTOTLIRE
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='rwFlusso.FlagContanti
frm_seek='Set_FLAGCONT
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='rwFlusso.ImportoContante
frm_seek='Set_xTOTCONT
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='rwFlusso.NumeroRapporto
frm_seek='w_RAPPORTO
name='oOperazioni
next=Icpitembatch.CPForEach
for_variable='rwCollega
for_variable_type='mcCollegamento.MCRDef
h=[
19
19
]
iterator_expr='mcCollegamentoMovimenti
next=Icpitembatch.CPForEach
for_variable='rwContro
for_variable_type='mcControparte.MCRDef
h=[
19
19
]
iterator_expr='mcControparti
next=Icpitembatch.CPVarDecl
frm_calc='"XXXXXXXXX"
frm_seek='w_RIFIMP
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwFlusso.NumeroOperazione)
frm_seek='w_INFORM
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_seek='Save
name='oOperazioni
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(oOperazioni.m_cLastMsgError))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
prev=O646
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O647
fatherSonIndex=0
frm_calc='gMsgProc + "Errore nell'elaborazione dell'operazione "+ LRTrim(rwFlusso.NumeroElettronicoOperante) +": "+LRTrim(oOperazioni.m_cLastMsgError)+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPMessage
frm_calc='"Errore nell'elaborazione dell'operazione "+ LRTrim(rwFlusso.NumeroElettronicoOperante) +": "+LRTrim(oOperazioni.m_cLastMsgError)
msg_type='Warn
obj='Message
pag=8
prev=O652
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='bat
father=O647
fatherSonIndex=1
frm_calc='arrt_writelog('NUOVO RECORD','OPERAZBO',oOperazioni.w_IDBASE)
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_crea_idereg('O',oOperazioni.w_IDBASE,'D')
obj='Exec
pag=8
prev=O655
I
obj='Exec
pag=8
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O645
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O644
var_op='prop
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O642
var_op='prop
I
obj='ForEach
pag=8
prev=O640
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O642
fatherSonIndex=0
frm_calc=[
'rwContro.CodiceIstituto+rwContro.DataElaborazione+rwContro.ProceduraOrigine+rwContro.NumeroElettronicoOperante+rwContro.SottoNumeroOperazione=rwFlusso.CodiceIstituto+rwFlusso.DataElaborazione+rwFlusso.ProceduraOrigine+rwFlusso.NumeroElettronicoOperante+rwFlusso.SottoNumeroOperazione
]
h=[
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O660
fatherSonIndex=0
frm_calc='LRTrim(rwContro.CodiceBeneficiario)
frm_seek='Set_CONNESBEN
name='oOperazioni
next=Icpitembatch.CPIfElse
frm_calc=[
'rwContro.CodiceStatoBanca='086'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='rwContro.TipoIntermediario
frm_seek='Set_TIPOINT2
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwContro.DescrizioneIntermediario)
frm_seek='Set_DESCINTER
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwContro.StatoBeneficiario)
frm_seek='Set_PAESE
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwContro.CabBanca)
frm_seek='Set_CODCAB2
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwContro.ComuneBanca)
frm_seek='Set_DESC2
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwContro.ProvinciaBanca)
frm_seek='Set_PROV2
name='oOperazioni
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O673
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O672
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O671
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O670
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O669
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O666
var_op='meth
I
obj='If
pag=8
prev=O665
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O666
fatherSonIndex=0
frm_calc='Substr(rwContro.CodiceRapporto,4,5)+"-"+Substr(rwContro.CodiceRapporto,9,5)
frm_seek='Set_CODINT2
name='oOperazioni
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O666
fatherSonIndex=1
frm_calc='LRTrim(rwContro.CodiceIntermediario)
frm_seek='Set_CODINT2
name='oOperazioni
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=8
prev=O639
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O640
fatherSonIndex=0
frm_calc=[
'rwCollega.RuoloCliente='T' or rwCollega.RuoloCliente='C'
'rwCollega.RuoloCliente='S'
'rwCollega.RuoloCliente='U'
]
h=[
19
19
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O685
fatherSonIndex=0
frm_calc='LRTrim(rwCollega.CodiceCliente)
frm_seek='Set_CONNESCLI
name='oOperazioni
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O685
fatherSonIndex=1
frm_calc='LRTrim(rwCollega.CodiceCliente)
frm_seek='Set_CONNESOPER
name='oOperazioni
next=Icpitembatch.CPVarDecl
frm_calc=''3'
frm_seek='Set_TIPOLEG
name='oOperazioni
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O692
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O685
fatherSonIndex=2
frm_calc='LRTrim(rwCollega.CodiceCliente)
frm_seek='Set_CONNALTRO
name='oOperazioni
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
]
where_expr='rwCollega.CodiceIstituto+rwCollega.DataElaborazione+rwCollega.ProceduraOrigine+rwCollega.NumeroElettronicoOperante+rwCollega.SottoNumeroOperazione=rwFlusso.CodiceIstituto+rwFlusso.DataElaborazione+rwFlusso.ProceduraOrigine+rwFlusso.NumeroElettronicoOperante+rwFlusso.SottoNumeroOperazione
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O638
var_op='prop
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O637
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O636
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O635
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O634
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O633
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O632
var_op='prop
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O631
var_op='prop
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O630
var_op='prop
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O629
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O628
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O627
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O626
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O625
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O624
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O623
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O622
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='new
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=8
prev=O537
sel_field='tbcauana->CAUSINT,tbcauana->DATAVALI,tbcauana->VALPERINT,tbcauana->DATINI,tbcauana->idbase
sel_name='tbcauana
sel_where='tbcauana->CODCAU=rwFlusso.CodiceCausale and tbcauana->SEGNO=rwFlusso.Segno
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O538
fatherSonIndex=0
frm_calc=[
'At(gTipInter,tbcauana->VALPERINT) > 0 and (Empty(tbcauana->DATAVALI) or Date() <= tbcauana->DATAVALI) and (Empty(tbcauana->DATINI) or Date() >= tbcauana->DATINI)
]
h=[
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O701
fatherSonIndex=0
frm_calc='tbcauana->CAUSINT
len=2
name='_codvoc
next=Icpitembatch.CPVarDecl
frm_calc='tbcauana->idbase
len=4
name='_codcau
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O707
I
obj='Var
pag=8
pagelocal=True
prev=O706
var_op='asgn
I
obj='Var
pag=8
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=8
prev=O523
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O525
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Caricamento Dati Rapporti e Legami: '+ arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPForEach
for_variable='rwFlusso
for_variable_type='mcFlusso.MCRDef
h=[
19
19
]
iterator_expr='mcFlussiRapporti
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Caricamento Dati Rapporti e Legami: '+ arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O716
var_op='asgn
I
obj='ForEach
pag=8
prev=O715
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Variabile per messaggi Elaborazione
father=O716
fatherSonIndex=0
frm_calc=''Processo Informazione con codice: '+LRTrim(rwFlusso.NumeroOperazione)
global=True
len=500
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'Left(rwFlusso.TipoRegistrazione,1)='5'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
prev=O721
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Legami tra soggetti
instr=Icpitembatch.CPIfElse
father=O722
fatherSonIndex=0
frm_calc=[
'rwFlusso.TipoRegistrazione='55'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_seek='armt_rapotitBO
name='oTitolari
next=Icpitembatch.CPVarDecl
frm_seek='Initialize
name='oTitolari
next=Icpitembatch.CPVarDecl
frm_seek='CtxLoad_ardt_intestit
name='oTitolari
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(rwFlusso.DataOperazione)
frm_seek='Set_DATAOPE
name='oTitolari
next=Icpitembatch.CPVarDecl
frm_calc='Date()
frm_seek='Set_DATAREG
name='oTitolari
next=Icpitembatch.CPVarDecl
frm_calc='rwFlusso.TipoRegistrazione
frm_seek='Set_TIPOOPRAP
name='oTitolari
next=Icpitembatch.CPForEach
for_variable='rwCollega
for_variable_type='mcCollegamento.MCRDef
h=[
19
19
]
iterator_expr='mcCollegamentoRapporti
next=Icpitembatch.CPVarDecl
frm_seek='Save
name='oTitolari
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog('NUOVO RECORD','RAPOTIT',oTitolari.w_IDBASE)
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_crea_idereg('T',oTitolari.w_IDBASE,'D')
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_ae_agg_aetesta_tit(oTitolari.w_CONNESCLI)
obj='Exec
pag=8
prev=O740
I
obj='Exec
pag=8
prev=O739
I
obj='Exec
pag=8
prev=O738
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O736
var_op='meth
I
obj='ForEach
pag=8
prev=O735
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O736
fatherSonIndex=0
frm_calc=[
'rwCollega.RuoloCliente='T' or rwCollega.RuoloCliente='C'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'rwCollega.RuoloCliente='E' and At(rwFlusso.TipoRegistrazione,'|50|58') >0
'rwCollega.RuoloCliente='E' and rwFlusso.TipoRegistrazione='51'
]
h=[
19
19
19
]
obj='If
pag=8
prev=O744
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O747
fatherSonIndex=0
frm_seek='ardt_intestit.AddRow
name='oTitolari
next=Icpitembatch.CPVarDecl
frm_calc='rwCollega.CodiceCliente
frm_seek='ardt_intestit.Set_CODINTER
name='oTitolari
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(rwFlusso.DataOperazione)
frm_seek='ardt_intestit.Set_DATAINI
name='oTitolari
next=Icpitembatch.CPVarDecl
frm_seek='ardt_intestit.SaveRow
name='oTitolari
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O754
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O753
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O752
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O747
fatherSonIndex=1
frm_calc='0
len=3
name='_righe
next=Icpitembatch.CPWhile
frm_calc='_righe < oTitolari.ardt_intestit.Rows()
h=[
19
19
]
obj='While
pag=8
prev=O757
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O758
fatherSonIndex=0
frm_calc='_righe
frm_seek='ardt_intestit.SetRow
name='oTitolari
next=Icpitembatch.CPIfElse
frm_calc=[
'oTitolari.ardt_intestit.w_CODINTER=rwCollega.CodiceCliente
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_righe + 1
len=3
name='_righe
obj='Var
obj_type='N
pag=8
pagelocal=True
prev=O763
var_op='asgn
I
obj='If
pag=8
prev=O762
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O763
fatherSonIndex=0
frm_calc='CharToDate(rwFlusso.DataOperazione)
frm_seek='ardt_intestit.Set_DATAFINE
name='oTitolari
next=Icpitembatch.CPVarDecl
frm_seek='ardt_intestit.SaveRow
name='oTitolari
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O769
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O744
fatherSonIndex=0
frm_calc='rwCollega.CodiceCliente
frm_seek='Set_CONNESCLI
name='oTitolari
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
where_expr='rwCollega.CodiceIstituto+rwCollega.DataElaborazione+rwCollega.ProceduraOrigine+rwCollega.NumeroElettronicoOperante+rwCollega.SottoNumeroOperazione=rwFlusso.CodiceIstituto+rwFlusso.DataElaborazione+rwFlusso.ProceduraOrigine+rwFlusso.NumeroElettronicoOperante+rwFlusso.SottoNumeroOperazione
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O734
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O733
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O732
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O731
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O730
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O727
var_op='new
I
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O727
fatherSonIndex=0
frm_seek='armt_rapotitBO
name='oTitolari
next=Icpitembatch.CPVarDecl
frm_seek='Initialize
name='oTitolari
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(rwFlusso.DataOperazione)
frm_seek='Set_DATAOPE
name='oTitolari
next=Icpitembatch.CPVarDecl
frm_calc='Date()
frm_seek='Set_DATAREG
name='oTitolari
next=Icpitembatch.CPVarDecl
frm_calc=''54'
frm_seek='Set_TIPOOPRAP
name='oTitolari
next=Icpitembatch.CPForEach
for_variable='rwCollega
for_variable_type='mcCollegamento.MCRDef
h=[
19
19
]
iterator_expr='mcCollegamentoRapporti
next=Icpitembatch.CPVarDecl
frm_seek='Save
name='oTitolari
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog('NUOVO RECORD','RAPOTIT',oTitolari.w_IDBASE)
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_crea_idereg('T',oTitolari.w_IDBASE,'D')
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_ae_agg_aetesta_tit(oTitolari.w_CONNESCLI)
obj='Exec
pag=8
prev=O790
I
obj='Exec
pag=8
prev=O789
I
obj='Exec
pag=8
prev=O788
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O786
var_op='meth
I
obj='ForEach
pag=8
prev=O785
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O786
fatherSonIndex=0
frm_calc=[
'rwCollega.RuoloCliente='T' or rwCollega.RuoloCliente='C'
]
h=[
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O794
fatherSonIndex=0
frm_calc='rwCollega.CodiceCliente
frm_seek='Set_CONNESCLI
name='oTitolari
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
where_expr='rwCollega.CodiceIstituto+rwCollega.DataElaborazione+rwCollega.ProceduraOrigine+rwCollega.NumeroElettronicoOperante+rwCollega.SottoNumeroOperazione=rwFlusso.CodiceIstituto+rwFlusso.DataElaborazione+rwFlusso.ProceduraOrigine+rwFlusso.NumeroElettronicoOperante+rwFlusso.SottoNumeroOperazione
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O784
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O783
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O782
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O781
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='new
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
comment='Rapporti Continuativi
instr=Icpitembatch.CPVarDecl
father=O722
fatherSonIndex=1
frm_calc='''
len=25
name='_rapporto
next=Icpitembatch.CPRead
arch='anarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_rapporto)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'rwFlusso.TipoRegistrazione='32'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_seek='armt_informazioniBO
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_seek='Initialize
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_seek='CtxLoad_ardt_informazioni
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_seek='CtxLoad_ardt_delegabo
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwFlusso.NumeroRapporto)
frm_seek='Set_RAPPORTO
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(rwFlusso.DataOperazione)
frm_seek='Set_DATAOPE
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_calc='Date()
frm_seek='Set_DATAREG
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_calc='rwFlusso.TipoRegistrazione
frm_seek='Set_TIPOOPRAP
name='oRapporti
next=Icpitembatch.CPForEach
for_variable='rwCollega
for_variable_type='mcCollegamento.MCRDef
h=[
19
19
]
iterator_expr='mcCollegamentoRapporti
next=Icpitembatch.CPVarDecl
frm_seek='Save
name='oRapporti
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog('NUOVO RECORD','RAPOPEBO',oRapporti.w_IDBASE)
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_crea_idereg('I',oRapporti.w_IDBASE,'D')
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_ae_agg_aetesta(oRapporti.w_RAPPORTO,oRapporti.w_TIPOOPRAP,oRapporti.w_NUMPROG,oRapporti.w_DATAOPE,'N')
obj='Exec
pag=8
prev=O824
I
obj='Exec
pag=8
prev=O823
I
obj='Exec
pag=8
prev=O822
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O820
var_op='meth
I
obj='ForEach
pag=8
prev=O819
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O820
fatherSonIndex=0
frm_calc=[
'At(LRTrim(rwFlusso.TipoRegistrazione),"|25|28|39|40|41|47") >0
'At(LRTrim(rwFlusso.TipoRegistrazione),"|21|22|23|24|26|27|33|34|35|36|43|44|45|46") >0
]
h=[
19
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O828
fatherSonIndex=0
frm_calc=[
'At(LRTrim(rwFlusso.Tipologia),"|28|41|47") >0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O833
fatherSonIndex=0
frm_calc=[
'rwCollega.RuoloCliente='D'
'rwCollega.RuoloCliente='S'
]
h=[
19
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O838
fatherSonIndex=0
frm_calc='0
len=3
name='_righe
next=Icpitembatch.CPWhile
frm_calc='_righe < oRapporti.ardt_delegabo.Rows()
h=[
19
19
]
obj='While
pag=8
prev=O843
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O844
fatherSonIndex=0
frm_calc='_righe
frm_seek='ardt_delegabo.SetRow
name='oRapporti
next=Icpitembatch.CPIfElse
frm_calc=[
'oRapporti.ardt_delegabo.w_CODINTER=rwCollega.CodiceCliente
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_righe + 1
len=3
name='_righe
obj='Var
obj_type='N
pag=8
pagelocal=True
prev=O849
var_op='asgn
I
obj='If
pag=8
prev=O848
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O849
fatherSonIndex=0
frm_calc='CharToDate(rwFlusso.DataOperazione)
frm_seek='ardt_delegabo.Set_DATAFINE
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_calc='oRapporti.w_NUMPROG
frm_seek='ardt_delegabo.w_NUMPROG2
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_seek='ardt_delegabo.SaveRow
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_seek='ardt_delegabo.Calculate
name='oRapporti
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O857
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O856
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O855
var_op='prop
I
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O838
fatherSonIndex=1
frm_calc='rwCollega.CodiceCliente
frm_seek='Set_CONNESOPER
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_calc=''3'
frm_seek='Set_TIPOLEG
name='oRapporti
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O862
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O833
fatherSonIndex=1
frm_calc=[
'rwCollega.RuoloCliente='D'
'rwCollega.RuoloCliente='S'
]
h=[
19
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O866
fatherSonIndex=0
frm_seek='ardt_delegabo.AddRow
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_calc='rwCollega.CodiceCliente
frm_seek='ardt_delegabo.Set_CODINTER
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(rwFlusso.DataOperazione)
frm_seek='ardt_delegabo.Set_DATAINI
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_calc='oRapporti.w_NUMPROG
frm_seek='ardt_delegabo.w_NUMPROG1
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_seek='ardt_informazioni.SaveRow
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_seek='ardt_delegabo.Calculate
name='oRapporti
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O875
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O874
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O873
var_op='prop
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O872
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O871
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O866
fatherSonIndex=1
frm_calc='rwCollega.CodiceCliente
frm_seek='Set_CONNESOPER
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_calc=''3'
frm_seek='Set_TIPOLEG
name='oRapporti
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O878
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O828
fatherSonIndex=1
frm_calc=[
'At(LRTrim(rwFlusso.TipoRegistrazione),"|26|36|46") >0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O883
fatherSonIndex=0
frm_calc=[
'rwCollega.RuoloCliente='T' or rwCollega.RuoloCliente='C'
'rwCollega.RuoloCliente='S'
]
h=[
19
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O888
fatherSonIndex=0
frm_calc='0
len=3
name='_righe
next=Icpitembatch.CPWhile
frm_calc='_righe < oRapporti.ardt_informazioni.Rows()
h=[
19
19
]
obj='While
pag=8
prev=O893
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O894
fatherSonIndex=0
frm_calc='_righe
frm_seek='ardt_informazioni.SetRow
name='oRapporti
next=Icpitembatch.CPIfElse
frm_calc=[
'oRapporti.ardt_informazioni.w_CODINTER=rwCollega.CodiceCliente
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_righe + 1
len=3
name='_righe
obj='Var
obj_type='N
pag=8
pagelocal=True
prev=O899
var_op='asgn
I
obj='If
pag=8
prev=O898
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O899
fatherSonIndex=0
frm_calc='CharToDate(rwFlusso.DataOperazione)
frm_seek='ardt_informazioni.Set_DATAFINE
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_calc='oRapporti.w_NUMPROG
frm_seek='ardt_informazioni.w_NUMPROG2
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_seek='ardt_informazioni.SaveRow
name='oRapporti
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O906
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O905
var_op='prop
I
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O888
fatherSonIndex=1
frm_calc='rwCollega.CodiceCliente
frm_seek='Set_CONNESOPER
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_calc=''3'
frm_seek='Set_TIPOLEG
name='oRapporti
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O911
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O883
fatherSonIndex=1
frm_calc=[
'rwCollega.RuoloCliente='T' or rwCollega.RuoloCliente='C'
'rwCollega.RuoloCliente='S'
]
h=[
19
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O915
fatherSonIndex=0
frm_seek='ardt_informazioni.AddRow
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_calc='rwCollega.CodiceCliente
frm_seek='ardt_informazioni.Set_CODINTER
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(rwFlusso.DataOperazione)
frm_seek='ardt_informazioni.Set_DATAINI
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_calc='oRapporti.w_NUMPROG
frm_seek='ardt_informazioni.w_NUMPROG1
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_seek='ardt_informazioni.SaveRow
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_seek='ardt_informazioni.Calculate
name='oRapporti
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O924
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O923
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O922
var_op='prop
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O921
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O920
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O915
fatherSonIndex=1
frm_calc='rwCollega.CodiceCliente
frm_seek='Set_CONNESOPER
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_calc=''3'
frm_seek='Set_TIPOLEG
name='oRapporti
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O927
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='meth
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
where_expr='rwCollega.CodiceIstituto+rwCollega.DataElaborazione+rwCollega.ProceduraOrigine+rwCollega.NumeroElettronicoOperante+rwCollega.SottoNumeroOperazione=rwFlusso.CodiceIstituto+rwFlusso.DataElaborazione+rwFlusso.ProceduraOrigine+rwFlusso.NumeroElettronicoOperante+rwFlusso.SottoNumeroOperazione
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O818
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O817
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O816
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O815
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O814
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O813
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O812
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O809
var_op='new
I
obj='If
pag=8
prev=O806
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O809
fatherSonIndex=0
frm_seek='armt_informazioniBO
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_seek='Initialize
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwFlusso.NumeroRapporto)
frm_seek='Set_RAPPORTO
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(rwFlusso.DataOperazione)
frm_seek='Set_DATAOPE
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_calc='Date()
frm_seek='Set_DATAREG
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_calc=''31'
frm_seek='Set_TIPOOPRAP
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_calc=''0'
frm_seek='Set_STATOREG
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_seek='Save
name='oRapporti
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog('NUOVO RECORD','RAPOPEBO',oRapporti.w_IDBASE)
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_crea_idereg('I',oRapporti.w_IDBASE,'D')
obj='Exec
pag=8
prev=O943
I
obj='Exec
pag=8
prev=O942
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O941
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O940
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O939
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O938
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O937
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O936
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O935
var_op='meth
I
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='new
I
I
]
w=[
150
150
]
I
obj='If
pag=8
prev=O805
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anarapbo
father=O806
fatherSonIndex=0
next=Icpitembatch.CPInsert
arch='knarapbo
obj='Insert
pag=8
prev=O948
rd_kfield=[
'RAPPORTO
'TIPORAP
]
rd_kvar=[
'LRTrim(rwFlusso.NumeroRapporto)
''D'
]
I
obj='Insert
pag=8
rd_kfield=[
'RAPPORTO
'TIPORAP
'TIPOAG
]
rd_kvar=[
'LRTrim(rwFlusso.NumeroRapporto)
'rwFlusso.TipoRapportoAUI
'LRTrim(rwFlusso.TipoRapportoIntermediario)
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
prev=O804
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'LRTrim(rwFlusso.NumeroRapporto)
]
rd_var=[
'_rapporto
]
I
obj='Var
pag=8
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O523
fatherSonIndex=0
frm_seek='armt_rapotitBO
name='oTitolari
next=Icpitembatch.CPVarDecl
frm_seek='armt_informazioniBO
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_seek='armt_ofrazionateBO
name='oFrazionate
next=Icpitembatch.CPVarDecl
frm_seek='armt_operazioniBO
name='oOperazioni
next=Icpitembatch.CPVarDecl
len=25
name='_rapporto
next=Icpitembatch.CPVarDecl
len=2
name='_codvoc
next=Icpitembatch.CPVarDecl
len=4
name='_codcau
next=Icpitembatch.CPVarDecl
len=3
name='_righe
obj='Var
obj_type='N
pag=8
pagelocal=True
prev=O970
I
obj='Var
pag=8
pagelocal=True
prev=O969
I
obj='Var
pag=8
pagelocal=True
prev=O968
I
obj='Var
pag=8
pagelocal=True
prev=O967
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O966
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O965
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O964
I
obj='Var
obj_type='O
pag=8
pagelocal=True
I
I
]
w=[
150
150
]
x=21
y=11
I
Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
frm_seek='ardt_delegabo.w_IDBASE
name='oRapporti
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='prop
x=1340
y=1594
I
Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
frm_seek='ardt_informazioni.w_IDBASE
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_calc=''P'
frm_seek='ardt_informazioni.w_TIPOPERS
name='oRapporti
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber('PRGIMPSOG',0,10)
frm_seek='ardt_informazioni.w_PRGIMPSOG
name='oRapporti
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O975
var_op='prop
I
obj='Var
obj_type='O
pag=8
pagelocal=True
prev=O974
var_op='prop
I
obj='Var
obj_type='O
pag=8
pagelocal=True
var_op='prop
x=1399
y=2463
I
Icpitembatch.CPBeginEnd
comment='Apre il file di testo
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge il file di testo e scrive il Memory Cursor
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Chiude il file di testo
h=[
19
19
]
obj='Begin
pag=6
prev=O979
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O981
fatherSonIndex=0
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + nomefileimport + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O985
var_op='asgn
I
obj='Exec
pag=6
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
prev=O977
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWhile
father=O979
fatherSonIndex=0
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
obj='While
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O990
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=6
prev=O994
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O995
fatherSonIndex=0
frm_calc='Left(riga,40)
frm_seek='AppendWithKey
name='mcControparti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Left(riga,11))
frm_seek='CodiceIstituto
name='mcControparti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,12,8))
frm_seek='DataElaborazione
name='mcControparti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,20,3))
frm_seek='ProceduraOrigine
name='mcControparti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,23,9))
frm_seek='NumeroElettronicoOperante
name='mcControparti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,32,9))
frm_seek='SottoNumeroOperazione
name='mcControparti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,41,1))
frm_seek='TipoRapportoBeneficiario
name='mcControparti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,42,16))
frm_seek='CodiceBeneficiario
name='mcControparti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,58,25))
frm_seek='CodiceRapporto
name='mcControparti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,83,70))
frm_seek='NomeBeneficiario
name='mcControparti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,153,35))
frm_seek='IndirizzoBeneficiario
name='mcControparti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,188,5))
frm_seek='CapBeneficiario
name='mcControparti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,193,6))
frm_seek='CabBeneficiario
name='mcControparti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,199,30))
frm_seek='LocalitaBeneficiario
name='mcControparti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,229,2))
frm_seek='ProvinciaBeneficiario
name='mcControparti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,231,3))
frm_seek='StatoBeneficiario
name='mcControparti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,234,2))
frm_seek='TipoIntermediario
name='mcControparti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,236,11))
frm_seek='CodiceIntermediario
name='mcControparti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,247,3))
frm_seek='CodiceStatoBanca
name='mcControparti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,250,6))
frm_seek='CabBanca
name='mcControparti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,256,30))
frm_seek='ComuneBanca
name='mcControparti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,286,2))
frm_seek='ProvinciaBanca
name='mcControparti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,288,50))
frm_seek='DescrizioneIntermediario
name='mcControparti
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcControparti
obj='Var
obj_type='MC
pag=6
prev=O1022
var_op='meth
I
obj='Var
obj_type='MC
pag=6
prev=O1021
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1020
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1019
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1018
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1017
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1016
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1015
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1014
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1013
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1012
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1011
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1010
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1009
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1008
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1007
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1006
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1005
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1004
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1003
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1002
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1001
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1000
var_op='prop
I
obj='Var
obj_type='MC
pag=6
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O977
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
name='fhand
obj='Var
pag=6
prev=O1029
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
x=18
y=14
I
Icpitembatch.CPBeginEnd
comment='Apre il file di testo
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge il file di testo e scrive il Memory Cursor
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Chiude il file di testo
h=[
19
19
]
obj='Begin
pag=9
prev=O1034
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O1036
fatherSonIndex=0
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + nomefileimport + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=9
prev=O1040
var_op='asgn
I
obj='Exec
pag=9
I
I
]
w=[
150
150
]
I
obj='Begin
pag=9
prev=O1032
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWhile
father=O1034
fatherSonIndex=0
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
obj='While
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1045
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=9
prev=O1049
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1050
fatherSonIndex=0
frm_calc='LRTrim(Substr(riga,19,16))
frm_seek='AppendWithKey
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,5)
frm_seek='CODIST
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,6,2)
frm_seek='TIPOINT
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,8,11)
frm_seek='CODINT
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,19,16))
frm_seek='IDSOGG
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,35,3))
frm_seek='COD_TIPO_SOGG
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,38,3)
frm_seek='COD_STATO 
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,41,5))
frm_seek='COD_SPEC_GIUR
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,46,3)
frm_seek='COD_SETT
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,49,3)
frm_seek='COD_RAMO
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,52,16)
frm_seek='COD_NDG_GRUP_ECON
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,68,6))
frm_seek='COD_ATECO
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,74,3)
frm_seek='SEG_CAN_TERZI
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,77,1)
frm_seek='COD_TIT_EFFETTIVO
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,78,5)
frm_seek='COD_COMP_RILE
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,83,3)
frm_seek='COD_SCOPO_RAPP
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,86,16)
frm_seek='NDG_SOGG_PRIMARIO
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,102,3)
frm_seek='TIPO_RELAZIONE
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,105,5)
frm_seek='NAT_GIURIDICA
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,110,5)
frm_seek='CATENA_CTRL
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,115,1)
frm_seek='AMMONTARE
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,116,10)
frm_seek='COD_FILIALE
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,126,30)
frm_seek='DESC_FILIALE
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,156,3)
frm_seek='OPERATIVITA
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,159,3)
frm_seek='COMPORTAMENTO
name='mcCategoria
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcCategoria
obj='Var
obj_type='MC
pag=9
prev=O1079
var_op='meth
I
obj='Var
obj_type='MC
pag=9
prev=O1078
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1077
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1076
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1075
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1074
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1073
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1072
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1071
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1070
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1069
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1068
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1067
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1066
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1065
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1064
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1063
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1062
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1061
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1060
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1059
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1058
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1057
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1056
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1055
var_op='prop
I
obj='Var
obj_type='MC
pag=9
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1032
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
name='fhand
obj='Var
pag=9
prev=O1086
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
x=9
y=26
I
Icpitembatch.CPBeginEnd
comment='Parametri Procedura
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Dichiarazione Variabili Globali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili Locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Definizione MC per import
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc=''Ora Inizio Import Dati: '+ arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPBeginEnd
comment='Legge la lista dei file e verifica se c'è uno zip
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Azzera i cursori
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Carica i dati nei MC
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Importa i dati
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='"Elaborazione Terminta!"
global=True
len=500
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Import Dati: '+ arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Ispitembatch.CPReturn
frm_calc='gMsgProc
obj='Return
pag=1
prev=O1107
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O1106
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
prev=O1104
var_op='asgn
I
obj='Begin
pag=1
prev=O1102
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Verifica da import
father=O1104
fatherSonIndex=0
frm_calc=''S'
global=True
len=1
name='gVerImp
next=Icpitembatch.CPIfElse
frm_calc=[
'_numana > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_nummov > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Verifica da import
frm_calc=''N'
global=True
len=1
name='gVerImp
nonlocal=True
obj='Var
pag=1
prev=O1115
var_op='asgn
I
obj='If
pag=1
prev=O1112
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1115
fatherSonIndex=0
frm_calc='8
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O1111
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1112
fatherSonIndex=0
frm_calc='7
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O1100
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O1102
fatherSonIndex=0
for_variable='rwFile
for_variable_type='tmp_list_imprich
h=[
19
19
]
iterator_expr='mcLista
obj='ForEach
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Azzera i cursori di passaggio
father=O1130
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwFile.nomefile)
len=50
name='nomefileimport
next=Icpitembatch.CPCase
frm_calc=[
'At("RAPPTOT",Upper(nomefileimport)) > 0 or At("MOVIM",Upper(nomefileimport)) > 0
'At("COLL",Upper(nomefileimport)) > 0
'At("ANASORT",Upper(nomefileimport)) > 0 or At("ANAMOVI",Upper(nomefileimport)) > 0
'At("BONIFICI",Upper(nomefileimport)) > 0
'At("ANAGRAFE",Upper(nomefileimport)) > 0
]
h=[
19
19
19
19
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
obj='Exec
pag=1
prev=O1137
I
obj='Case
pag=1
prev=O1136
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1137
fatherSonIndex=0
frm_calc='3
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_nummov
next=Icpitembatch.CPForEach
for_variable='rwFlussi
for_variable_type='mcFlusso.MCRDef
h=[
19
19
]
iterator_expr='mcFlussi
obj='ForEach
pag=1
prev=O1144
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1145
fatherSonIndex=0
frm_calc='_nummov + 1
len=10
name='_nummov
next=Icpitembatch.CPIfElse
frm_calc=[
'At("MOVIM",Upper(nomefileimport)) > 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O1149
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1150
fatherSonIndex=0
frm_calc='rwFlussi.CodiceIstituto+rwFlussi.DataElaborazione+rwFlussi.ProceduraOrigine+rwFlussi.NumeroElettronicoOperante+rwFlussi.SottoNumeroOperazione,rwFlussi
frm_seek='AppendRowWithKey
name='mcFlussiMovimenti
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1150
fatherSonIndex=1
frm_calc='rwFlussi.CodiceIstituto+rwFlussi.DataElaborazione+rwFlussi.ProceduraOrigine+rwFlussi.NumeroElettronicoOperante+rwFlussi.SottoNumeroOperazione,rwFlussi
frm_seek='AppendRowWithKey
name='mcFlussiRapporti
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O1143
var_op='asgn
I
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1137
fatherSonIndex=1
frm_calc='5
next=Icpitembatch.CPForEach
for_variable='rwCollegamento
for_variable_type='mcCollegamento.MCRDef
h=[
19
19
]
iterator_expr='mcCollegamento
obj='ForEach
pag=1
prev=O1161
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1162
fatherSonIndex=0
frm_calc=[
'At("COLLMOVI",Upper(nomefileimport)) > 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1166
fatherSonIndex=0
frm_calc='rwCollegamento.CodiceIstituto+rwCollegamento.DataElaborazione+rwCollegamento.ProceduraOrigine+rwCollegamento.NumeroElettronicoOperante+rwCollegamento.SottoNumeroOperazione+rwCollegamento.CodiceCliente,rwCollegamento
frm_seek='AppendRowWithKey
name='mcCollegamentoMovimenti
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1166
fatherSonIndex=1
frm_calc='rwCollegamento.CodiceIstituto+rwCollegamento.DataElaborazione+rwCollegamento.ProceduraOrigine+rwCollegamento.NumeroElettronicoOperante+rwCollegamento.SottoNumeroOperazione+rwCollegamento.CodiceCliente,rwCollegamento
frm_seek='AppendRowWithKey
name='mcCollegamentoRapporti
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1137
fatherSonIndex=2
frm_calc='4
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_numana
next=Icpitembatch.CPForEach
for_variable='rwAnagrafiche
for_variable_type='mcAnagrafiche.MCRDef
h=[
19
19
]
iterator_expr='mcAnagrafiche
obj='ForEach
pag=1
prev=O1178
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1179
fatherSonIndex=0
frm_calc='_numana + 1
len=10
name='_numana
next=Icpitembatch.CPIfElse
frm_calc=[
'At("ANAMOVI",Upper(nomefileimport)) > 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O1183
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1184
fatherSonIndex=0
frm_calc='rwAnagrafiche.CodiceIstituto+rwAnagrafiche.DataElaborazione+rwAnagrafiche.CodiceCliente,rwAnagrafiche
frm_seek='AppendRowWithKey
name='mcAnagraficheMovimenti
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1184
fatherSonIndex=1
frm_calc='rwAnagrafiche.CodiceIstituto+rwAnagrafiche.DataElaborazione+rwAnagrafiche.CodiceCliente,rwAnagrafiche
frm_seek='AppendRowWithKey
name='mcAnagraficheRapporti
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O1177
var_op='asgn
I
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1137
fatherSonIndex=3
frm_calc='6
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1137
fatherSonIndex=4
frm_calc='9
obj='Exec
pag=1
I
I
]
w=[
150
150
150
150
150
150
]
I
obj='Var
pag=1
prev=O1134
var_op='asgn
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1134
fatherSonIndex=0
frm_seek='Zap
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcCollegamento
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcAnagrafiche
obj='Var
obj_type='MC
pag=1
prev=O1202
var_op='meth
I
obj='Var
obj_type='MC
pag=1
prev=O1201
var_op='meth
I
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O1098
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1100
fatherSonIndex=0
frm_seek='Zap
name='mcFlussiRapporti
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcCollegamentoRapporti
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcAnagraficheRapporti
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcFlussiMovimenti
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcCollegamentoMovimenti
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcAnagraficheMovimenti
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcControparti
obj='Var
obj_type='MC
pag=1
prev=O1214
var_op='meth
I
obj='Var
obj_type='MC
pag=1
prev=O1213
var_op='meth
I
obj='Var
obj_type='MC
pag=1
prev=O1212
var_op='meth
I
obj='Var
obj_type='MC
pag=1
prev=O1211
var_op='meth
I
obj='Var
obj_type='MC
pag=1
prev=O1210
var_op='meth
I
obj='Var
obj_type='MC
pag=1
prev=O1209
var_op='meth
I
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O1097
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O1098
fatherSonIndex=0
for_variable='rwFile
for_variable_type='tmp_list_imprich
h=[
19
19
]
iterator_expr='pmcListaFile
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(czipfile)
]
h=[
19
19
]
obj='If
pag=1
prev=O1219
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O1221
fatherSonIndex=0
for_variable='rwFile
for_variable_type='tmp_list_imprich
h=[
19
19
]
iterator_expr='pmcListaFile
obj='ForEach
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1226
fatherSonIndex=0
frm_calc='rwFile
frm_seek='AppendRow
name='mcLista
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1219
fatherSonIndex=0
frm_calc=[
'At('.zip',Lower(LRTrim(rwFile.nomefile))) <> 0
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1235
fatherSonIndex=0
frm_calc='LRTrim(rwFile.nomefile)
len=100
name='czipfile
next=Icpitembatch.CPExec
check='page
frm_calc='2
obj='Exec
pag=1
prev=O1240
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O1095
var_op='asgn
I
obj='Begin
pag=1
prev=O1093
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1095
fatherSonIndex=0
frm_seek='mcFlusso.MCRDef
name='mcFlussiRapporti
next=Icpitembatch.CPVarDecl
frm_seek='mcCollegamento.MCRDef
name='mcCollegamentoRapporti
next=Icpitembatch.CPVarDecl
frm_seek='mcAnagrafiche.MCRDef
name='mcAnagraficheRapporti
next=Icpitembatch.CPVarDecl
frm_seek='mcFlusso.MCRDef
name='mcFlussiMovimenti
next=Icpitembatch.CPVarDecl
frm_seek='mcCollegamento.MCRDef
name='mcCollegamentoMovimenti
next=Icpitembatch.CPVarDecl
frm_seek='mcAnagrafiche.MCRDef
name='mcAnagraficheMovimenti
next=Icpitembatch.CPVarDecl
frm_seek='mcFlusso.MCRDef
name='mcFlussi
next=Icpitembatch.CPVarDecl
frm_seek='mcCollegamento.MCRDef
name='mcCollegamento
next=Icpitembatch.CPVarDecl
frm_seek='mcAnagrafiche.MCRDef
name='mcAnagrafiche
next=Icpitembatch.CPVarDecl
frm_seek='mcControparte.MCRDef
name='mcControparti
next=Icpitembatch.CPVarDecl
frm_seek='mcCategorizzazione.MCRDef
name='mcCategoria
obj='Var
obj_type='MC
pag=1
prev=O1256
I
obj='Var
obj_type='MC
pag=1
prev=O1255
I
obj='Var
obj_type='MC
pag=1
prev=O1254
I
obj='Var
obj_type='MC
pag=1
prev=O1253
I
obj='Var
obj_type='MC
pag=1
prev=O1252
I
obj='Var
obj_type='MC
pag=1
prev=O1251
I
obj='Var
obj_type='MC
pag=1
prev=O1250
I
obj='Var
obj_type='MC
pag=1
prev=O1249
I
obj='Var
obj_type='MC
pag=1
prev=O1248
I
obj='Var
obj_type='MC
pag=1
prev=O1247
I
obj='Var
obj_type='MC
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O1091
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1093
fatherSonIndex=0
name='fhand
next=Icpitembatch.CPVarDecl
len=100
name='czipfile
next=Icpitembatch.CPVarDecl
len=200
name='cpercorsozip
next=Icpitembatch.CPVarDecl
len=200
name='cdirectoryfile
next=Icpitembatch.CPVarDecl
len=100
name='buffernomefile
next=Icpitembatch.CPVarDecl
len=50
name='nomefileimport
next=Icpitembatch.CPVarDecl
len=3
name='_priorita
next=Icpitembatch.CPVarDecl
len=10
name='riga
next=Icpitembatch.CPVarDecl
len=10
name='_numana
next=Icpitembatch.CPVarDecl
len=10
name='_nummov
next=Icpitembatch.CPVarDecl
frm_seek='tmp_list_imprich
name='mcLista
obj='Var
obj_type='MC
pag=1
prev=O1270
I
obj='Var
obj_type='N
pag=1
prev=O1269
I
obj='Var
obj_type='N
pag=1
prev=O1268
I
obj='Var
obj_type='M
pag=1
prev=O1267
I
obj='Var
obj_type='N
pag=1
prev=O1266
I
obj='Var
pag=1
prev=O1265
I
obj='Var
pag=1
prev=O1264
I
obj='Var
pag=1
prev=O1263
I
obj='Var
pag=1
prev=O1262
I
obj='Var
pag=1
prev=O1261
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O1089
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Codice Azienda
father=O1091
fatherSonIndex=0
global=True
len=60
name='gAzienda
next=Icpitembatch.CPVarDecl
comment='Path Applicazione
global=True
len=80
name='gPathApp
next=Icpitembatch.CPVarDecl
comment='Path dei doc esterni
global=True
len=200
name='gPathDoc
next=Icpitembatch.CPVarDecl
comment='Variabile per messaggi Elaborazione
global=True
len=500
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='Log Elaborazione
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Tipo Intermediario
global=True
len=2
name='gTipInter
next=Icpitembatch.CPVarDecl
comment='Verifica da import
global=True
len=1
name='gVerImp
nonlocal=True
obj='Var
pag=1
prev=O1280
I
nonlocal=True
obj='Var
pag=1
prev=O1279
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O1278
I
nonlocal=True
obj='Var
pag=1
prev=O1277
I
nonlocal=True
obj='Var
pag=1
prev=O1276
I
nonlocal=True
obj='Var
pag=1
prev=O1275
I
nonlocal=True
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1089
fatherSonIndex=0
frm_seek='tmp_list_imprich
name='pmcListaFile
obj='Var
obj_type='MC
pag=1
param=True
I
I
]
w=[
150
150
]
x=20
y=12
I
]
ManualBlocks={
'BO - Header
Icpmanualblocks.CPManualBlocks
code='import java.io.File; ﷯import java.lang.Double;﷯import java.util.*;﷯import jxl.*;﷯import java.nio.file.Files;﷯import java.nio.file.Path;﷯import java.nio.file.Paths;﷯import java.nio.charset.*;﷯﷯import java.io.FileInputStream;﷯import java.io.IOException;﷯import java.io.InputStreamReader;
name='BO - Header
I
'BO - Properties
Icpmanualblocks.CPManualBlocks
code='public String[] lista;﷯public int conteggio;﷯public int i;﷯public int _i;﷯public int _y;﷯public int contanome;﷯public int _righe;﷯public int _conta;﷯public Path path;﷯// These are the files to include in the ZIP file﷯Vector filenames = new Vector();﷯Vector fileonames = new Vector();
name='BO - Properties
I
}
comment='Import Dati (Unifactor / IFIR)
date_creat=#2023-05-23
date_rev=#2024-02-29
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'FileLibMit
'LibreriaMit
]
modcnt=137
page_result_class=[
'
'
'
'
'
'
'
'
'
]
page_result_type=[
'U
'U
'U
'U
'U
'U
'U
'U
'U
]
page_uid=[
'YEVQYCDYSZ
'AFDRJTDRXW
'NTYOIGAXAQ
'ZOJTQFQLRW
'RYTQXODBFJ
'ZJHJYNJJKV
'PSDCUDPEJM
'PVHMPBTXQF
'QQLBLQBZXV
]
pagename=[
'Principale
'EstraeZip
'ImportFlussi
'ImportAnagrafiche
'ImportCollegamenti
'ImportBeneficiari
'Anagrafiche
'Flussi
'Categorizzazione
]
pagenote=[
'
'
'
'
'
'
'
'
'
]
pagetitle=[
'Principale
'Estrazione Zip
'Import flussi
'Import Anagrafiche
'Import Collegamenti
'Import Beneficiari
'Anagrafiche
'Flussi
'Categorizzazione Anagrafiche
]
result_type='C
runtime_filters=2
tpl_name='Function
work_file=[
'anarapbo
'fraziobo
'knarapbo
'operazbo
'opextrbo
'personbo
'personbo_agg
'tbcauana
'tbcitta
'tbstati
'tmp_list_imprich
'wersonbo
'xersonbo
]
work_filter=[
'
'
'
'
'
]
I
*--*
*----*
