// * --- Area Manuale = BO - Header
// * --- arrt_chkdiana_all
import java.util.*;
import java.io.InputStream;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.util.Iterator;
import java.io.File;
import java.io.FileWriter;
import java.io.RandomAccessFile;
import java.nio.*;
import java.nio.channels.*;
import org.apache.poi.xssf.usermodel.XSSFCell;
import org.apache.poi.xssf.usermodel.XSSFRow;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.apache.poi.xssf.usermodel.XSSFCellStyle;
import org.apache.poi.ss.usermodel.*;
import org.apache.poi.xssf.streaming.SXSSFCell;
import org.apache.poi.xssf.streaming.SXSSFRow;
import org.apache.poi.xssf.streaming.SXSSFSheet;
import org.apache.poi.xssf.streaming.SXSSFWorkbook;
import java.nio.charset.StandardCharsets;
// * --- Fine Area Manuale
public class arrt_chkdiana_allR implements CallerWithObjs {
  // gestori associati a particolari eventi ('Routine start')
  public static volatile java.util.Map<String,java.util.List<com.zucchetti.sitepainter.EventHandler>> specificEventsHandlers;
  // gestori associati a tutti gli eventi
  public static volatile java.util.List<com.zucchetti.sitepainter.EventHandler> allEventsHandlers;
  // indica se si sta gestendo un evento scatenato da questa routine per restituire il valore corretto di i_EntityName ed i_EntityType
  static boolean m_bEventRunning;
  public String m_cLastMsgError;
  public boolean m_bError;
  // Variabile di collegamento con il database: passata nel costruttore
  public CPSql m_Sql;
  // Variabile di contesto (variabili globali): passata nel costruttore
  public CPContext m_Ctx;
  // Variabile di caller (variabili di caller): passata nel costruttore
  public CallerWithObjs m_Caller;
  public String m_cPhName_anadip;
  public String m_cServer_anadip;
  public String m_cPhName_beneficfrz;
  public String m_cServer_beneficfrz;
  public String m_cPhName_beneficope;
  public String m_cServer_beneficope;
  public String m_cPhName_clientifrz;
  public String m_cServer_clientifrz;
  public String m_cPhName_clientiope;
  public String m_cServer_clientiope;
  public String m_cPhName_contatori;
  public String m_cServer_contatori;
  public String m_cPhName_delegabo;
  public String m_cServer_delegabo;
  public String m_cPhName_fiduciabo;
  public String m_cServer_fiduciabo;
  public String m_cPhName_fraziobo;
  public String m_cServer_fraziobo;
  public String m_cPhName_intermbo;
  public String m_cServer_intermbo;
  public String m_cPhName_intestbo;
  public String m_cServer_intestbo;
  public String m_cPhName_intestit;
  public String m_cServer_intestit;
  public String m_cPhName_kersonbo;
  public String m_cServer_kersonbo;
  public String m_cPhName_knarapbo;
  public String m_cServer_knarapbo;
  public String m_cPhName_log_app;
  public String m_cServer_log_app;
  public String m_cPhName_meneficfrz;
  public String m_cServer_meneficfrz;
  public String m_cPhName_meneficope;
  public String m_cServer_meneficope;
  public String m_cPhName_merzistifrz;
  public String m_cServer_merzistifrz;
  public String m_cPhName_merzistiope;
  public String m_cServer_merzistiope;
  public String m_cPhName_mlientifrz;
  public String m_cServer_mlientifrz;
  public String m_cPhName_mlientiope;
  public String m_cServer_mlientiope;
  public String m_cPhName_mogopebo;
  public String m_cServer_mogopebo;
  public String m_cPhName_mogopefbo;
  public String m_cServer_mogopefbo;
  public String m_cPhName_operazbo;
  public String m_cServer_operazbo;
  public String m_cPhName_personbo;
  public String m_cServer_personbo;
  public String m_cPhName_rapcoll;
  public String m_cServer_rapcoll;
  public String m_cPhName_rapopebo;
  public String m_cServer_rapopebo;
  public String m_cPhName_rapotit;
  public String m_cServer_rapotit;
  public String m_cPhName_sogopebo;
  public String m_cServer_sogopebo;
  public String m_cPhName_sogopefbo;
  public String m_cServer_sogopefbo;
  public String m_cPhName_tbprcbck;
  public String m_cServer_tbprcbck;
  public String m_cPhName_tbstgru;
  public String m_cServer_tbstgru;
  public String m_cPhName_terzistifrz;
  public String m_cServer_terzistifrz;
  public String m_cPhName_terzistiope;
  public String m_cServer_terzistiope;
  public String m_cPhName_tipo1;
  public String m_cServer_tipo1;
  public String m_cPhName_tipo2_3;
  public String m_cServer_tipo2_3;
  public String m_cPhName_tipo4;
  public String m_cServer_tipo4;
  public String m_cPhName_tipo5;
  public String m_cServer_tipo5;
  public String m_cPhName_tipo6;
  public String m_cServer_tipo6;
  public String m_cPhName_tipo7;
  public String m_cServer_tipo7;
  public String m_cPhName_tipo8;
  public String m_cServer_tipo8;
  public String m_cPhName_tipo9;
  public String m_cServer_tipo9;
  public String m_cPhName_wersonbo;
  public String m_cServer_wersonbo;
  public String m_cPhName_xapcoll;
  public String m_cServer_xapcoll;
  public String m_cPhName_xapopebo;
  public String m_cServer_xapopebo;
  public String m_cPhName_xelegabo;
  public String m_cServer_xelegabo;
  public String m_cPhName_xeneficfrz;
  public String m_cServer_xeneficfrz;
  public String m_cPhName_xeneficope;
  public String m_cServer_xeneficope;
  public String m_cPhName_xerzistifrz;
  public String m_cServer_xerzistifrz;
  public String m_cPhName_xerzistiope;
  public String m_cServer_xerzistiope;
  public String m_cPhName_xiduciabo;
  public String m_cServer_xiduciabo;
  public String m_cPhName_xlientifrz;
  public String m_cServer_xlientifrz;
  public String m_cPhName_xlientiope;
  public String m_cServer_xlientiope;
  public String m_cPhName_xnarapbo;
  public String m_cServer_xnarapbo;
  public String m_cPhName_xntestbo;
  public String m_cServer_xntestbo;
  public String m_cPhName_xogopebo;
  public String m_cServer_xogopebo;
  public String m_cPhName_xogopefbo;
  public String m_cServer_xogopefbo;
  public String m_cPhName_cgo_stampeav;
  public String m_cServer_cgo_stampeav;
  public String m_cPhName_terzistirap;
  public String m_cServer_terzistirap;
  public String m_cPhName_xerzistirap;
  public String m_cServer_xerzistirap;
  public String m_cPhName_xntestit;
  public String m_cServer_xntestit;
  String m_cServer;
  String m_cPhName;
  CPPhTableWrInfo m_oWrInfo;
  String m_cQuery;
  String m_cQueryTable;
  String m_cSql;
  java.util.List<String> m_oParameters;
  String m_cWhere;
  int m_nUpdatedRows;
  // Contiene il messaggio di errore dell'ultima select terminata a causa della caduta della connessione
  String m_cConnectivityError;
  public String w_codinter;
  public String w_tipinter;
  public String w_codage;
  public String w_codcli;
  public String w_ragben;
  public String daope;
  public String a_ope;
  public String dareg;
  public String a_reg;
  public String w_tipoarchd;
  public String w_tipoarchp;
  public String w_stoper;
  public String w_flgope;
  public String w_flgfrz;
  public String w_flgrae;
  public String w_flgrap;
  public String w_tiprap;
  public String w_flgtit;
  public String w_tiptit;
  public String w_flgint;
  public String w_flgdel;
  public String w_flgchk;
  public String w_flgxls;
  public String w_flgsto;
  public String w_allsto;
  public String w_multifile;
  public String w_flg2020;
  public String gPathApp;
  public String gPathDoc;
  public String gIntemediario;
  public String gUrlApp;
  public String gAzienda;
  public double gNumRec;
  public double gNumReg;
  public String gMsgImp;
  public String gMsgProc;
  public String gFlgWU;
  public String gCodDip;
  public String w_codcab;
  public String w_cabcod;
  public String w_desccit;
  public String w_citdesc;
  public String w_provin;
  public String w_provind;
  public String w_coddipe;
  public double w_agente;
  public String _note;
  public double _rownum;
  public String fhand;
  public String _nomefile;
  public String cNomeFile;
  public String cOnlyNomeFile;
  public String cNomeFileZip;
  public double nTotRec;
  public double nTotReg;
  public double nNumRec;
  public double _avanza;
  public String _codrif;
  public String w_cdadata;
  public String w_c_adata;
  public String w_cdadata_rap;
  public String w_c_adata_rap;
  public String w_cdareg_rap;
  public String w_c_areg_rap;
  public double _ctotale;
  public double _conta;
  public double _max;
  public double _min;
  public double _top;
  public double _bottom;
  public double _cicli;
  public double _contacilci;
  public String _flagrap;
  public double _ciclo;
  public String _ramate;
  public String _numsto;
  public double _oldrighe;
  public double _continua;
  public String _oldrap;
  public String _idereg;
  public String xStato;
  public double _conta1;
  public double _conta2;
  public double _conta4;
  public double _conta5;
  public double _conta6;
  public double _conta7;
  public double _conta8;
  public double _conta9;
  public String _tiprec;
  public String _raeatc;
  public String oldfolder;
  public String _tipoag;
  public String _datage;
  public String _numticket;
  public String w_cdareg;
  public String w_c_areg;
  public String z_codcab;
  public String z_desccit;
  public String z_provin;
  public String z_coddipe;
  public MemoryCursor_anadip mcANADIP;
  public MemoryCursor_mcdiana_mcrdef mcRighe;
  public MemoryCursor_mcdiana_mcrdef mcRigheTXT;
  public MemoryCursor_personbo mcPersonbo;
  public MemoryCursor_wersonbo mcWersonbo;
  public MemoryCursor_knarapbo mcKnarapbo;
  public MemoryCursor_tbstgru mcStgru;
  public String _tiporap;
  public String cRitorno;
  public double _righe;
  public double _righetot;
  public double _numfile;
  public String _riga;
  public double tblnum;
  public String tblname_main;
  public double _maxrighe;
  public String _file1;
  public String _file2;
  public double _oldmc;
  public String cProg;
  public boolean _mlientiope;
  public boolean _clientiope;
  public boolean _mogopebo;
  public boolean _sogopebo;
  public boolean _meneficope;
  public boolean _beneficope;
  public boolean _merzistiope;
  public boolean _terzistiope;
  public boolean _mlientifrz;
  public boolean _clientifrz;
  public boolean _mogopefbo;
  public boolean _sogopefbo;
  public boolean _meneficfrz;
  public boolean _beneficfrz;
  public boolean _merzistifrz;
  public boolean _terzistifrz;
  public boolean _rapcoll;
  public boolean _rapcolleg;
  public boolean _xlientiope;
  public boolean _xogopebo;
  public boolean _xeneficope;
  public boolean _xerzistiope;
  public boolean _xlientifrz;
  public boolean _xogopefbo;
  public boolean _xeneficfrz;
  public boolean _xerzistifrz;
  public boolean _xapcoll;
  public boolean _xapcolleg;
  public MemoryCursor_tipo1 mcTipo1;
  public MemoryCursor_tipo2_3 mcTipo2;
  public MemoryCursor_tipo4 mcTipo4;
  public MemoryCursor_tipo5 mcTipo5;
  public MemoryCursor_tipo6 mcTipo6;
  public MemoryCursor_tipo7 mcTipo7;
  public MemoryCursor_tipo8 mcTipo8;
  public MemoryCursor_tipo9 mcTipo9;
  public String _nfile;
  public String pCodDip;
  public String pCodCab;
  public String pDesCit;
  public String pProv;
  public java.sql.Date w_DaData;
  public java.sql.Date w_AData;
  public java.sql.Date w_DaDataReg;
  public java.sql.Date w_ADataReg;
  public String pCli;
  public java.sql.Date pDatOpe;
  public String pRap;
  public String pTRap;
  public String pTipoR;
  public String pRAE;
  public String pSTATO;
  public java.sql.Date pDatRet;
  public double _usemc;
  public String cStringa;
  public String _tipsot;
  // * --- Area Manuale = BO - Properties
  // * --- arrt_chkdiana_all
  public int _i;
  public int _y;
  public int conta;
  public int r;
  String sheetName = "Foglio1";
  public String[] lista;
  public String[] campi;
  public int conteggio;
  public int i;
  public int contanome;
  public int nfogli;
  public int ncampi;
  public SXSSFWorkbook wb;
  public SXSSFSheet sheet;
  public Row row; 
  public Cell cell;
  public CellStyle cs;
  public Font f;
  Vector filenames = new Vector();
  Vector fileonames = new Vector();
  public byte[] buffer;
  // * --- Fine Area Manuale
  public arrt_chkdiana_allR (CPContext p_ContextObject, Caller caller) {
    if (caller == null)
      m_Caller = CallerWithObjsImpl.EMPTY;
    else if (caller instanceof CallerWithObjs)
      m_Caller = (CallerWithObjs)caller;
    else
      m_Caller = new CallerWithObjsImpl(caller);
    m_Ctx=p_ContextObject;
    // Assegnazione della variabile di collegamento con il database
    m_Sql=m_Ctx.GetSql();
    /*  Impostazione dell'ambiente globale: il businness object si collega
                                all'oggetto globale (unico per più istanze di una stessa applicazione)
                                per recuperare informazioni sul:
                                1) nome fisico della tabella di gestione;
                                2) nome fisico delle tabelle collegate nei link;
                                3) stringa di connessione.
                                L'azienda è contenuta nel global object.
                             */
    p_ContextObject = p_ContextObject.DisabledDataFilteringVersion();
    CPSecurity.RoutineCallableByProgram("arrt_chkdiana_all",m_Caller);
    m_cPhName_anadip = p_ContextObject.GetPhName("anadip");
    if (m_cPhName_anadip.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_anadip = m_cPhName_anadip+" "+m_Ctx.GetWritePhName("anadip");
    }
    m_cServer_anadip = p_ContextObject.GetServer("anadip");
    m_cPhName_beneficfrz = p_ContextObject.GetPhName("beneficfrz");
    if (m_cPhName_beneficfrz.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_beneficfrz = m_cPhName_beneficfrz+" "+m_Ctx.GetWritePhName("beneficfrz");
    }
    m_cServer_beneficfrz = p_ContextObject.GetServer("beneficfrz");
    m_cPhName_beneficope = p_ContextObject.GetPhName("beneficope");
    if (m_cPhName_beneficope.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_beneficope = m_cPhName_beneficope+" "+m_Ctx.GetWritePhName("beneficope");
    }
    m_cServer_beneficope = p_ContextObject.GetServer("beneficope");
    m_cPhName_clientifrz = p_ContextObject.GetPhName("clientifrz");
    if (m_cPhName_clientifrz.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_clientifrz = m_cPhName_clientifrz+" "+m_Ctx.GetWritePhName("clientifrz");
    }
    m_cServer_clientifrz = p_ContextObject.GetServer("clientifrz");
    m_cPhName_clientiope = p_ContextObject.GetPhName("clientiope");
    if (m_cPhName_clientiope.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_clientiope = m_cPhName_clientiope+" "+m_Ctx.GetWritePhName("clientiope");
    }
    m_cServer_clientiope = p_ContextObject.GetServer("clientiope");
    m_cPhName_contatori = p_ContextObject.GetPhName("contatori");
    if (m_cPhName_contatori.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_contatori = m_cPhName_contatori+" "+m_Ctx.GetWritePhName("contatori");
    }
    m_cServer_contatori = p_ContextObject.GetServer("contatori");
    m_cPhName_delegabo = p_ContextObject.GetPhName("delegabo");
    if (m_cPhName_delegabo.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_delegabo = m_cPhName_delegabo+" "+m_Ctx.GetWritePhName("delegabo");
    }
    m_cServer_delegabo = p_ContextObject.GetServer("delegabo");
    m_cPhName_fiduciabo = p_ContextObject.GetPhName("fiduciabo");
    if (m_cPhName_fiduciabo.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_fiduciabo = m_cPhName_fiduciabo+" "+m_Ctx.GetWritePhName("fiduciabo");
    }
    m_cServer_fiduciabo = p_ContextObject.GetServer("fiduciabo");
    m_cPhName_fraziobo = p_ContextObject.GetPhName("fraziobo");
    if (m_cPhName_fraziobo.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_fraziobo = m_cPhName_fraziobo+" "+m_Ctx.GetWritePhName("fraziobo");
    }
    m_cServer_fraziobo = p_ContextObject.GetServer("fraziobo");
    m_cPhName_intermbo = p_ContextObject.GetPhName("intermbo");
    if (m_cPhName_intermbo.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_intermbo = m_cPhName_intermbo+" "+m_Ctx.GetWritePhName("intermbo");
    }
    m_cServer_intermbo = p_ContextObject.GetServer("intermbo");
    m_cPhName_intestbo = p_ContextObject.GetPhName("intestbo");
    if (m_cPhName_intestbo.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_intestbo = m_cPhName_intestbo+" "+m_Ctx.GetWritePhName("intestbo");
    }
    m_cServer_intestbo = p_ContextObject.GetServer("intestbo");
    m_cPhName_intestit = p_ContextObject.GetPhName("intestit");
    if (m_cPhName_intestit.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_intestit = m_cPhName_intestit+" "+m_Ctx.GetWritePhName("intestit");
    }
    m_cServer_intestit = p_ContextObject.GetServer("intestit");
    m_cPhName_kersonbo = p_ContextObject.GetPhName("kersonbo");
    if (m_cPhName_kersonbo.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_kersonbo = m_cPhName_kersonbo+" "+m_Ctx.GetWritePhName("kersonbo");
    }
    m_cServer_kersonbo = p_ContextObject.GetServer("kersonbo");
    m_cPhName_knarapbo = p_ContextObject.GetPhName("knarapbo");
    if (m_cPhName_knarapbo.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_knarapbo = m_cPhName_knarapbo+" "+m_Ctx.GetWritePhName("knarapbo");
    }
    m_cServer_knarapbo = p_ContextObject.GetServer("knarapbo");
    m_cPhName_log_app = p_ContextObject.GetPhName("log_app");
    if (m_cPhName_log_app.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_log_app = m_cPhName_log_app+" "+m_Ctx.GetWritePhName("log_app");
    }
    m_cServer_log_app = p_ContextObject.GetServer("log_app");
    m_cPhName_meneficfrz = p_ContextObject.GetPhName("meneficfrz");
    if (m_cPhName_meneficfrz.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_meneficfrz = m_cPhName_meneficfrz+" "+m_Ctx.GetWritePhName("meneficfrz");
    }
    m_cServer_meneficfrz = p_ContextObject.GetServer("meneficfrz");
    m_cPhName_meneficope = p_ContextObject.GetPhName("meneficope");
    if (m_cPhName_meneficope.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_meneficope = m_cPhName_meneficope+" "+m_Ctx.GetWritePhName("meneficope");
    }
    m_cServer_meneficope = p_ContextObject.GetServer("meneficope");
    m_cPhName_merzistifrz = p_ContextObject.GetPhName("merzistifrz");
    if (m_cPhName_merzistifrz.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_merzistifrz = m_cPhName_merzistifrz+" "+m_Ctx.GetWritePhName("merzistifrz");
    }
    m_cServer_merzistifrz = p_ContextObject.GetServer("merzistifrz");
    m_cPhName_merzistiope = p_ContextObject.GetPhName("merzistiope");
    if (m_cPhName_merzistiope.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_merzistiope = m_cPhName_merzistiope+" "+m_Ctx.GetWritePhName("merzistiope");
    }
    m_cServer_merzistiope = p_ContextObject.GetServer("merzistiope");
    m_cPhName_mlientifrz = p_ContextObject.GetPhName("mlientifrz");
    if (m_cPhName_mlientifrz.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_mlientifrz = m_cPhName_mlientifrz+" "+m_Ctx.GetWritePhName("mlientifrz");
    }
    m_cServer_mlientifrz = p_ContextObject.GetServer("mlientifrz");
    m_cPhName_mlientiope = p_ContextObject.GetPhName("mlientiope");
    if (m_cPhName_mlientiope.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_mlientiope = m_cPhName_mlientiope+" "+m_Ctx.GetWritePhName("mlientiope");
    }
    m_cServer_mlientiope = p_ContextObject.GetServer("mlientiope");
    m_cPhName_mogopebo = p_ContextObject.GetPhName("mogopebo");
    if (m_cPhName_mogopebo.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_mogopebo = m_cPhName_mogopebo+" "+m_Ctx.GetWritePhName("mogopebo");
    }
    m_cServer_mogopebo = p_ContextObject.GetServer("mogopebo");
    m_cPhName_mogopefbo = p_ContextObject.GetPhName("mogopefbo");
    if (m_cPhName_mogopefbo.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_mogopefbo = m_cPhName_mogopefbo+" "+m_Ctx.GetWritePhName("mogopefbo");
    }
    m_cServer_mogopefbo = p_ContextObject.GetServer("mogopefbo");
    m_cPhName_operazbo = p_ContextObject.GetPhName("operazbo");
    if (m_cPhName_operazbo.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_operazbo = m_cPhName_operazbo+" "+m_Ctx.GetWritePhName("operazbo");
    }
    m_cServer_operazbo = p_ContextObject.GetServer("operazbo");
    m_cPhName_personbo = p_ContextObject.GetPhName("personbo");
    if (m_cPhName_personbo.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_personbo = m_cPhName_personbo+" "+m_Ctx.GetWritePhName("personbo");
    }
    m_cServer_personbo = p_ContextObject.GetServer("personbo");
    m_cPhName_rapcoll = p_ContextObject.GetPhName("rapcoll");
    if (m_cPhName_rapcoll.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_rapcoll = m_cPhName_rapcoll+" "+m_Ctx.GetWritePhName("rapcoll");
    }
    m_cServer_rapcoll = p_ContextObject.GetServer("rapcoll");
    m_cPhName_rapopebo = p_ContextObject.GetPhName("rapopebo");
    if (m_cPhName_rapopebo.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_rapopebo = m_cPhName_rapopebo+" "+m_Ctx.GetWritePhName("rapopebo");
    }
    m_cServer_rapopebo = p_ContextObject.GetServer("rapopebo");
    m_cPhName_rapotit = p_ContextObject.GetPhName("rapotit");
    if (m_cPhName_rapotit.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_rapotit = m_cPhName_rapotit+" "+m_Ctx.GetWritePhName("rapotit");
    }
    m_cServer_rapotit = p_ContextObject.GetServer("rapotit");
    m_cPhName_sogopebo = p_ContextObject.GetPhName("sogopebo");
    if (m_cPhName_sogopebo.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_sogopebo = m_cPhName_sogopebo+" "+m_Ctx.GetWritePhName("sogopebo");
    }
    m_cServer_sogopebo = p_ContextObject.GetServer("sogopebo");
    m_cPhName_sogopefbo = p_ContextObject.GetPhName("sogopefbo");
    if (m_cPhName_sogopefbo.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_sogopefbo = m_cPhName_sogopefbo+" "+m_Ctx.GetWritePhName("sogopefbo");
    }
    m_cServer_sogopefbo = p_ContextObject.GetServer("sogopefbo");
    m_cPhName_tbprcbck = p_ContextObject.GetPhName("tbprcbck");
    if (m_cPhName_tbprcbck.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_tbprcbck = m_cPhName_tbprcbck+" "+m_Ctx.GetWritePhName("tbprcbck");
    }
    m_cServer_tbprcbck = p_ContextObject.GetServer("tbprcbck");
    m_cPhName_tbstgru = p_ContextObject.GetPhName("tbstgru");
    if (m_cPhName_tbstgru.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_tbstgru = m_cPhName_tbstgru+" "+m_Ctx.GetWritePhName("tbstgru");
    }
    m_cServer_tbstgru = p_ContextObject.GetServer("tbstgru");
    m_cPhName_terzistifrz = p_ContextObject.GetPhName("terzistifrz");
    if (m_cPhName_terzistifrz.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_terzistifrz = m_cPhName_terzistifrz+" "+m_Ctx.GetWritePhName("terzistifrz");
    }
    m_cServer_terzistifrz = p_ContextObject.GetServer("terzistifrz");
    m_cPhName_terzistiope = p_ContextObject.GetPhName("terzistiope");
    if (m_cPhName_terzistiope.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_terzistiope = m_cPhName_terzistiope+" "+m_Ctx.GetWritePhName("terzistiope");
    }
    m_cServer_terzistiope = p_ContextObject.GetServer("terzistiope");
    m_cPhName_tipo1 = p_ContextObject.GetPhName("tipo1");
    if (m_cPhName_tipo1.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_tipo1 = m_cPhName_tipo1+" "+m_Ctx.GetWritePhName("tipo1");
    }
    m_cServer_tipo1 = p_ContextObject.GetServer("tipo1");
    m_cPhName_tipo2_3 = p_ContextObject.GetPhName("tipo2_3");
    if (m_cPhName_tipo2_3.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_tipo2_3 = m_cPhName_tipo2_3+" "+m_Ctx.GetWritePhName("tipo2_3");
    }
    m_cServer_tipo2_3 = p_ContextObject.GetServer("tipo2_3");
    m_cPhName_tipo4 = p_ContextObject.GetPhName("tipo4");
    if (m_cPhName_tipo4.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_tipo4 = m_cPhName_tipo4+" "+m_Ctx.GetWritePhName("tipo4");
    }
    m_cServer_tipo4 = p_ContextObject.GetServer("tipo4");
    m_cPhName_tipo5 = p_ContextObject.GetPhName("tipo5");
    if (m_cPhName_tipo5.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_tipo5 = m_cPhName_tipo5+" "+m_Ctx.GetWritePhName("tipo5");
    }
    m_cServer_tipo5 = p_ContextObject.GetServer("tipo5");
    m_cPhName_tipo6 = p_ContextObject.GetPhName("tipo6");
    if (m_cPhName_tipo6.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_tipo6 = m_cPhName_tipo6+" "+m_Ctx.GetWritePhName("tipo6");
    }
    m_cServer_tipo6 = p_ContextObject.GetServer("tipo6");
    m_cPhName_tipo7 = p_ContextObject.GetPhName("tipo7");
    if (m_cPhName_tipo7.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_tipo7 = m_cPhName_tipo7+" "+m_Ctx.GetWritePhName("tipo7");
    }
    m_cServer_tipo7 = p_ContextObject.GetServer("tipo7");
    m_cPhName_tipo8 = p_ContextObject.GetPhName("tipo8");
    if (m_cPhName_tipo8.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_tipo8 = m_cPhName_tipo8+" "+m_Ctx.GetWritePhName("tipo8");
    }
    m_cServer_tipo8 = p_ContextObject.GetServer("tipo8");
    m_cPhName_tipo9 = p_ContextObject.GetPhName("tipo9");
    if (m_cPhName_tipo9.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_tipo9 = m_cPhName_tipo9+" "+m_Ctx.GetWritePhName("tipo9");
    }
    m_cServer_tipo9 = p_ContextObject.GetServer("tipo9");
    m_cPhName_wersonbo = p_ContextObject.GetPhName("wersonbo");
    if (m_cPhName_wersonbo.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_wersonbo = m_cPhName_wersonbo+" "+m_Ctx.GetWritePhName("wersonbo");
    }
    m_cServer_wersonbo = p_ContextObject.GetServer("wersonbo");
    m_cPhName_xapcoll = p_ContextObject.GetPhName("xapcoll");
    if (m_cPhName_xapcoll.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_xapcoll = m_cPhName_xapcoll+" "+m_Ctx.GetWritePhName("xapcoll");
    }
    m_cServer_xapcoll = p_ContextObject.GetServer("xapcoll");
    m_cPhName_xapopebo = p_ContextObject.GetPhName("xapopebo");
    if (m_cPhName_xapopebo.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_xapopebo = m_cPhName_xapopebo+" "+m_Ctx.GetWritePhName("xapopebo");
    }
    m_cServer_xapopebo = p_ContextObject.GetServer("xapopebo");
    m_cPhName_xelegabo = p_ContextObject.GetPhName("xelegabo");
    if (m_cPhName_xelegabo.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_xelegabo = m_cPhName_xelegabo+" "+m_Ctx.GetWritePhName("xelegabo");
    }
    m_cServer_xelegabo = p_ContextObject.GetServer("xelegabo");
    m_cPhName_xeneficfrz = p_ContextObject.GetPhName("xeneficfrz");
    if (m_cPhName_xeneficfrz.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_xeneficfrz = m_cPhName_xeneficfrz+" "+m_Ctx.GetWritePhName("xeneficfrz");
    }
    m_cServer_xeneficfrz = p_ContextObject.GetServer("xeneficfrz");
    m_cPhName_xeneficope = p_ContextObject.GetPhName("xeneficope");
    if (m_cPhName_xeneficope.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_xeneficope = m_cPhName_xeneficope+" "+m_Ctx.GetWritePhName("xeneficope");
    }
    m_cServer_xeneficope = p_ContextObject.GetServer("xeneficope");
    m_cPhName_xerzistifrz = p_ContextObject.GetPhName("xerzistifrz");
    if (m_cPhName_xerzistifrz.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_xerzistifrz = m_cPhName_xerzistifrz+" "+m_Ctx.GetWritePhName("xerzistifrz");
    }
    m_cServer_xerzistifrz = p_ContextObject.GetServer("xerzistifrz");
    m_cPhName_xerzistiope = p_ContextObject.GetPhName("xerzistiope");
    if (m_cPhName_xerzistiope.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_xerzistiope = m_cPhName_xerzistiope+" "+m_Ctx.GetWritePhName("xerzistiope");
    }
    m_cServer_xerzistiope = p_ContextObject.GetServer("xerzistiope");
    m_cPhName_xiduciabo = p_ContextObject.GetPhName("xiduciabo");
    if (m_cPhName_xiduciabo.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_xiduciabo = m_cPhName_xiduciabo+" "+m_Ctx.GetWritePhName("xiduciabo");
    }
    m_cServer_xiduciabo = p_ContextObject.GetServer("xiduciabo");
    m_cPhName_xlientifrz = p_ContextObject.GetPhName("xlientifrz");
    if (m_cPhName_xlientifrz.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_xlientifrz = m_cPhName_xlientifrz+" "+m_Ctx.GetWritePhName("xlientifrz");
    }
    m_cServer_xlientifrz = p_ContextObject.GetServer("xlientifrz");
    m_cPhName_xlientiope = p_ContextObject.GetPhName("xlientiope");
    if (m_cPhName_xlientiope.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_xlientiope = m_cPhName_xlientiope+" "+m_Ctx.GetWritePhName("xlientiope");
    }
    m_cServer_xlientiope = p_ContextObject.GetServer("xlientiope");
    m_cPhName_xnarapbo = p_ContextObject.GetPhName("xnarapbo");
    if (m_cPhName_xnarapbo.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_xnarapbo = m_cPhName_xnarapbo+" "+m_Ctx.GetWritePhName("xnarapbo");
    }
    m_cServer_xnarapbo = p_ContextObject.GetServer("xnarapbo");
    m_cPhName_xntestbo = p_ContextObject.GetPhName("xntestbo");
    if (m_cPhName_xntestbo.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_xntestbo = m_cPhName_xntestbo+" "+m_Ctx.GetWritePhName("xntestbo");
    }
    m_cServer_xntestbo = p_ContextObject.GetServer("xntestbo");
    m_cPhName_xogopebo = p_ContextObject.GetPhName("xogopebo");
    if (m_cPhName_xogopebo.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_xogopebo = m_cPhName_xogopebo+" "+m_Ctx.GetWritePhName("xogopebo");
    }
    m_cServer_xogopebo = p_ContextObject.GetServer("xogopebo");
    m_cPhName_xogopefbo = p_ContextObject.GetPhName("xogopefbo");
    if (m_cPhName_xogopefbo.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_xogopefbo = m_cPhName_xogopefbo+" "+m_Ctx.GetWritePhName("xogopefbo");
    }
    m_cServer_xogopefbo = p_ContextObject.GetServer("xogopefbo");
    m_cPhName_cgo_stampeav = p_ContextObject.GetPhName("cgo_stampeav");
    if (m_cPhName_cgo_stampeav.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_cgo_stampeav = m_cPhName_cgo_stampeav+" "+m_Ctx.GetWritePhName("cgo_stampeav");
    }
    m_cServer_cgo_stampeav = p_ContextObject.GetServer("cgo_stampeav");
    m_cPhName_terzistirap = p_ContextObject.GetPhName("terzistirap");
    if (m_cPhName_terzistirap.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_terzistirap = m_cPhName_terzistirap+" "+m_Ctx.GetWritePhName("terzistirap");
    }
    m_cServer_terzistirap = p_ContextObject.GetServer("terzistirap");
    m_cPhName_xerzistirap = p_ContextObject.GetPhName("xerzistirap");
    if (m_cPhName_xerzistirap.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_xerzistirap = m_cPhName_xerzistirap+" "+m_Ctx.GetWritePhName("xerzistirap");
    }
    m_cServer_xerzistirap = p_ContextObject.GetServer("xerzistirap");
    m_cPhName_xntestit = p_ContextObject.GetPhName("xntestit");
    if (m_cPhName_xntestit.endsWith(CPSecurity.FILTER_QUERY_POSTFIX)) {
      m_cPhName_xntestit = m_cPhName_xntestit+" "+m_Ctx.GetWritePhName("xntestit");
    }
    m_cServer_xntestit = p_ContextObject.GetServer("xntestit");
    Blank();
  }
  public double GetNumber(String p_cVarName,String p_cType,int len,int dec) {
    if (CPLib.eqr("gNumRec",p_cVarName)) {
      return gNumRec;
    }
    if (CPLib.eqr("gNumReg",p_cVarName)) {
      return gNumReg;
    }
    if (CPLib.eqr("agente",p_cVarName)) {
      return w_agente;
    }
    if (CPLib.eqr("_rownum",p_cVarName)) {
      return _rownum;
    }
    if (CPLib.eqr("nTotRec",p_cVarName)) {
      return nTotRec;
    }
    if (CPLib.eqr("nTotReg",p_cVarName)) {
      return nTotReg;
    }
    if (CPLib.eqr("nNumRec",p_cVarName)) {
      return nNumRec;
    }
    if (CPLib.eqr("_avanza",p_cVarName)) {
      return _avanza;
    }
    if (CPLib.eqr("_ctotale",p_cVarName)) {
      return _ctotale;
    }
    if (CPLib.eqr("_conta",p_cVarName)) {
      return _conta;
    }
    if (CPLib.eqr("_max",p_cVarName)) {
      return _max;
    }
    if (CPLib.eqr("_min",p_cVarName)) {
      return _min;
    }
    if (CPLib.eqr("_top",p_cVarName)) {
      return _top;
    }
    if (CPLib.eqr("_bottom",p_cVarName)) {
      return _bottom;
    }
    if (CPLib.eqr("_cicli",p_cVarName)) {
      return _cicli;
    }
    if (CPLib.eqr("_contacilci",p_cVarName)) {
      return _contacilci;
    }
    if (CPLib.eqr("_ciclo",p_cVarName)) {
      return _ciclo;
    }
    if (CPLib.eqr("_oldrighe",p_cVarName)) {
      return _oldrighe;
    }
    if (CPLib.eqr("_continua",p_cVarName)) {
      return _continua;
    }
    if (CPLib.eqr("_conta1",p_cVarName)) {
      return _conta1;
    }
    if (CPLib.eqr("_conta2",p_cVarName)) {
      return _conta2;
    }
    if (CPLib.eqr("_conta4",p_cVarName)) {
      return _conta4;
    }
    if (CPLib.eqr("_conta5",p_cVarName)) {
      return _conta5;
    }
    if (CPLib.eqr("_conta6",p_cVarName)) {
      return _conta6;
    }
    if (CPLib.eqr("_conta7",p_cVarName)) {
      return _conta7;
    }
    if (CPLib.eqr("_conta8",p_cVarName)) {
      return _conta8;
    }
    if (CPLib.eqr("_conta9",p_cVarName)) {
      return _conta9;
    }
    if (CPLib.eqr("_righe",p_cVarName)) {
      return _righe;
    }
    if (CPLib.eqr("_righetot",p_cVarName)) {
      return _righetot;
    }
    if (CPLib.eqr("_numfile",p_cVarName)) {
      return _numfile;
    }
    if (CPLib.eqr("tblnum",p_cVarName)) {
      return tblnum;
    }
    if (CPLib.eqr("_maxrighe",p_cVarName)) {
      return _maxrighe;
    }
    if (CPLib.eqr("_oldmc",p_cVarName)) {
      return _oldmc;
    }
    if (CPLib.eqr("_usemc",p_cVarName)) {
      return _usemc;
    }
    return 0;
  }
  public String GetString(String p_cVarName,String p_cType,int len,int dec) {
    if (CPLib.eqr("m_cVQRList",p_cVarName)) {
      return m_cVQRList;
    } else if (CPLib.eqr("i_InvokedRoutines",p_cVarName)) {
      return i_InvokedRoutines;
    } else if (m_bEventRunning && CPLib.eqr("i_EntityName",p_cVarName)) {
      return "arrt_chkdiana_all";
    } else if (m_bEventRunning && CPLib.eqr("i_EntityType",p_cVarName)) {
      return "function";
    }
    if (CPLib.eqr("codinter",p_cVarName)) {
      return w_codinter;
    }
    if (CPLib.eqr("tipinter",p_cVarName)) {
      return w_tipinter;
    }
    if (CPLib.eqr("codage",p_cVarName)) {
      return w_codage;
    }
    if (CPLib.eqr("codcli",p_cVarName)) {
      return w_codcli;
    }
    if (CPLib.eqr("ragben",p_cVarName)) {
      return w_ragben;
    }
    if (CPLib.eqr("daope",p_cVarName)) {
      return daope;
    }
    if (CPLib.eqr("a_ope",p_cVarName)) {
      return a_ope;
    }
    if (CPLib.eqr("dareg",p_cVarName)) {
      return dareg;
    }
    if (CPLib.eqr("a_reg",p_cVarName)) {
      return a_reg;
    }
    if (CPLib.eqr("tipoarchd",p_cVarName)) {
      return w_tipoarchd;
    }
    if (CPLib.eqr("tipoarchp",p_cVarName)) {
      return w_tipoarchp;
    }
    if (CPLib.eqr("stoper",p_cVarName)) {
      return w_stoper;
    }
    if (CPLib.eqr("flgope",p_cVarName)) {
      return w_flgope;
    }
    if (CPLib.eqr("flgfrz",p_cVarName)) {
      return w_flgfrz;
    }
    if (CPLib.eqr("flgrae",p_cVarName)) {
      return w_flgrae;
    }
    if (CPLib.eqr("flgrap",p_cVarName)) {
      return w_flgrap;
    }
    if (CPLib.eqr("tiprap",p_cVarName)) {
      return w_tiprap;
    }
    if (CPLib.eqr("flgtit",p_cVarName)) {
      return w_flgtit;
    }
    if (CPLib.eqr("tiptit",p_cVarName)) {
      return w_tiptit;
    }
    if (CPLib.eqr("flgint",p_cVarName)) {
      return w_flgint;
    }
    if (CPLib.eqr("flgdel",p_cVarName)) {
      return w_flgdel;
    }
    if (CPLib.eqr("flgchk",p_cVarName)) {
      return w_flgchk;
    }
    if (CPLib.eqr("flgxls",p_cVarName)) {
      return w_flgxls;
    }
    if (CPLib.eqr("flgsto",p_cVarName)) {
      return w_flgsto;
    }
    if (CPLib.eqr("allsto",p_cVarName)) {
      return w_allsto;
    }
    if (CPLib.eqr("multifile",p_cVarName)) {
      return w_multifile;
    }
    if (CPLib.eqr("flg2020",p_cVarName)) {
      return w_flg2020;
    }
    if (CPLib.eqr("gPathApp",p_cVarName)) {
      return gPathApp;
    }
    if (CPLib.eqr("gPathDoc",p_cVarName)) {
      return gPathDoc;
    }
    if (CPLib.eqr("gIntemediario",p_cVarName)) {
      return gIntemediario;
    }
    if (CPLib.eqr("gUrlApp",p_cVarName)) {
      return gUrlApp;
    }
    if (CPLib.eqr("gAzienda",p_cVarName)) {
      return gAzienda;
    }
    if (CPLib.eqr("gMsgImp",p_cVarName)) {
      return gMsgImp;
    }
    if (CPLib.eqr("gMsgProc",p_cVarName)) {
      return gMsgProc;
    }
    if (CPLib.eqr("gFlgWU",p_cVarName)) {
      return gFlgWU;
    }
    if (CPLib.eqr("gCodDip",p_cVarName)) {
      return gCodDip;
    }
    if (CPLib.eqr("codcab",p_cVarName)) {
      return w_codcab;
    }
    if (CPLib.eqr("cabcod",p_cVarName)) {
      return w_cabcod;
    }
    if (CPLib.eqr("desccit",p_cVarName)) {
      return w_desccit;
    }
    if (CPLib.eqr("citdesc",p_cVarName)) {
      return w_citdesc;
    }
    if (CPLib.eqr("provin",p_cVarName)) {
      return w_provin;
    }
    if (CPLib.eqr("provind",p_cVarName)) {
      return w_provind;
    }
    if (CPLib.eqr("coddipe",p_cVarName)) {
      return w_coddipe;
    }
    if (CPLib.eqr("_note",p_cVarName)) {
      return _note;
    }
    if (CPLib.eqr("fhand",p_cVarName)) {
      return fhand;
    }
    if (CPLib.eqr("_nomefile",p_cVarName)) {
      return _nomefile;
    }
    if (CPLib.eqr("cNomeFile",p_cVarName)) {
      return cNomeFile;
    }
    if (CPLib.eqr("cOnlyNomeFile",p_cVarName)) {
      return cOnlyNomeFile;
    }
    if (CPLib.eqr("cNomeFileZip",p_cVarName)) {
      return cNomeFileZip;
    }
    if (CPLib.eqr("_codrif",p_cVarName)) {
      return _codrif;
    }
    if (CPLib.eqr("cdadata",p_cVarName)) {
      return w_cdadata;
    }
    if (CPLib.eqr("c_adata",p_cVarName)) {
      return w_c_adata;
    }
    if (CPLib.eqr("cdadata_rap",p_cVarName)) {
      return w_cdadata_rap;
    }
    if (CPLib.eqr("c_adata_rap",p_cVarName)) {
      return w_c_adata_rap;
    }
    if (CPLib.eqr("cdareg_rap",p_cVarName)) {
      return w_cdareg_rap;
    }
    if (CPLib.eqr("c_areg_rap",p_cVarName)) {
      return w_c_areg_rap;
    }
    if (CPLib.eqr("_flagrap",p_cVarName)) {
      return _flagrap;
    }
    if (CPLib.eqr("_ramate",p_cVarName)) {
      return _ramate;
    }
    if (CPLib.eqr("_numsto",p_cVarName)) {
      return _numsto;
    }
    if (CPLib.eqr("_oldrap",p_cVarName)) {
      return _oldrap;
    }
    if (CPLib.eqr("_idereg",p_cVarName)) {
      return _idereg;
    }
    if (CPLib.eqr("xStato",p_cVarName)) {
      return xStato;
    }
    if (CPLib.eqr("_tiprec",p_cVarName)) {
      return _tiprec;
    }
    if (CPLib.eqr("_raeatc",p_cVarName)) {
      return _raeatc;
    }
    if (CPLib.eqr("oldfolder",p_cVarName)) {
      return oldfolder;
    }
    if (CPLib.eqr("_tipoag",p_cVarName)) {
      return _tipoag;
    }
    if (CPLib.eqr("_datage",p_cVarName)) {
      return _datage;
    }
    if (CPLib.eqr("_numticket",p_cVarName)) {
      return _numticket;
    }
    if (CPLib.eqr("cdareg",p_cVarName)) {
      return w_cdareg;
    }
    if (CPLib.eqr("c_areg",p_cVarName)) {
      return w_c_areg;
    }
    if (CPLib.eqr("z_codcab",p_cVarName)) {
      return z_codcab;
    }
    if (CPLib.eqr("z_desccit",p_cVarName)) {
      return z_desccit;
    }
    if (CPLib.eqr("z_provin",p_cVarName)) {
      return z_provin;
    }
    if (CPLib.eqr("z_coddipe",p_cVarName)) {
      return z_coddipe;
    }
    if (CPLib.eqr("_tiporap",p_cVarName)) {
      return _tiporap;
    }
    if (CPLib.eqr("cRitorno",p_cVarName)) {
      return cRitorno;
    }
    if (CPLib.eqr("_riga",p_cVarName)) {
      return _riga;
    }
    if (CPLib.eqr("tblname_main",p_cVarName)) {
      return tblname_main;
    }
    if (CPLib.eqr("_file1",p_cVarName)) {
      return _file1;
    }
    if (CPLib.eqr("_file2",p_cVarName)) {
      return _file2;
    }
    if (CPLib.eqr("cProg",p_cVarName)) {
      return cProg;
    }
    if (CPLib.eqr("_nfile",p_cVarName)) {
      return _nfile;
    }
    if (CPLib.eqr("pCodDip",p_cVarName)) {
      return pCodDip;
    }
    if (CPLib.eqr("pCodCab",p_cVarName)) {
      return pCodCab;
    }
    if (CPLib.eqr("pDesCit",p_cVarName)) {
      return pDesCit;
    }
    if (CPLib.eqr("pProv",p_cVarName)) {
      return pProv;
    }
    if (CPLib.eqr("pCli",p_cVarName)) {
      return pCli;
    }
    if (CPLib.eqr("pRap",p_cVarName)) {
      return pRap;
    }
    if (CPLib.eqr("pTRap",p_cVarName)) {
      return pTRap;
    }
    if (CPLib.eqr("pTipoR",p_cVarName)) {
      return pTipoR;
    }
    if (CPLib.eqr("pRAE",p_cVarName)) {
      return pRAE;
    }
    if (CPLib.eqr("pSTATO",p_cVarName)) {
      return pSTATO;
    }
    if (CPLib.eqr("cStringa",p_cVarName)) {
      return cStringa;
    }
    if (CPLib.eqr("_tipsot",p_cVarName)) {
      return _tipsot;
    }
    return "";
  }
  public java.sql.Date GetDate(String p_cVarName,String p_cType,int len,int dec) {
    if (CPLib.eqr("DaData",p_cVarName)) {
      return w_DaData;
    }
    if (CPLib.eqr("AData",p_cVarName)) {
      return w_AData;
    }
    if (CPLib.eqr("DaDataReg",p_cVarName)) {
      return w_DaDataReg;
    }
    if (CPLib.eqr("ADataReg",p_cVarName)) {
      return w_ADataReg;
    }
    if (CPLib.eqr("pDatOpe",p_cVarName)) {
      return pDatOpe;
    }
    if (CPLib.eqr("pDatRet",p_cVarName)) {
      return pDatRet;
    }
    return CPLib.NullDate();
  }
  public java.sql.Timestamp GetDateTime(String p_cVarName,String p_cType,int len,int dec) {
    return CPLib.NullDateTime();
  }
  public boolean GetLogic(String p_cVarName,String p_cType,int len,int dec) {
    if (CPLib.eqr("_mlientiope",p_cVarName)) {
      return _mlientiope;
    }
    if (CPLib.eqr("_clientiope",p_cVarName)) {
      return _clientiope;
    }
    if (CPLib.eqr("_mogopebo",p_cVarName)) {
      return _mogopebo;
    }
    if (CPLib.eqr("_sogopebo",p_cVarName)) {
      return _sogopebo;
    }
    if (CPLib.eqr("_meneficope",p_cVarName)) {
      return _meneficope;
    }
    if (CPLib.eqr("_beneficope",p_cVarName)) {
      return _beneficope;
    }
    if (CPLib.eqr("_merzistiope",p_cVarName)) {
      return _merzistiope;
    }
    if (CPLib.eqr("_terzistiope",p_cVarName)) {
      return _terzistiope;
    }
    if (CPLib.eqr("_mlientifrz",p_cVarName)) {
      return _mlientifrz;
    }
    if (CPLib.eqr("_clientifrz",p_cVarName)) {
      return _clientifrz;
    }
    if (CPLib.eqr("_mogopefbo",p_cVarName)) {
      return _mogopefbo;
    }
    if (CPLib.eqr("_sogopefbo",p_cVarName)) {
      return _sogopefbo;
    }
    if (CPLib.eqr("_meneficfrz",p_cVarName)) {
      return _meneficfrz;
    }
    if (CPLib.eqr("_beneficfrz",p_cVarName)) {
      return _beneficfrz;
    }
    if (CPLib.eqr("_merzistifrz",p_cVarName)) {
      return _merzistifrz;
    }
    if (CPLib.eqr("_terzistifrz",p_cVarName)) {
      return _terzistifrz;
    }
    if (CPLib.eqr("_rapcoll",p_cVarName)) {
      return _rapcoll;
    }
    if (CPLib.eqr("_rapcolleg",p_cVarName)) {
      return _rapcolleg;
    }
    if (CPLib.eqr("_xlientiope",p_cVarName)) {
      return _xlientiope;
    }
    if (CPLib.eqr("_xogopebo",p_cVarName)) {
      return _xogopebo;
    }
    if (CPLib.eqr("_xeneficope",p_cVarName)) {
      return _xeneficope;
    }
    if (CPLib.eqr("_xerzistiope",p_cVarName)) {
      return _xerzistiope;
    }
    if (CPLib.eqr("_xlientifrz",p_cVarName)) {
      return _xlientifrz;
    }
    if (CPLib.eqr("_xogopefbo",p_cVarName)) {
      return _xogopefbo;
    }
    if (CPLib.eqr("_xeneficfrz",p_cVarName)) {
      return _xeneficfrz;
    }
    if (CPLib.eqr("_xerzistifrz",p_cVarName)) {
      return _xerzistifrz;
    }
    if (CPLib.eqr("_xapcoll",p_cVarName)) {
      return _xapcoll;
    }
    if (CPLib.eqr("_xapcolleg",p_cVarName)) {
      return _xapcolleg;
    }
    return false;
  }
  public CPMemoryCursor GetMemoryCursor(String p_cVarName,String p_cType,int len,int dec) {
    if (CPLib.eqr("mcANADIP",p_cVarName)) {
      return mcANADIP;
    }
    if (CPLib.eqr("mcRighe",p_cVarName)) {
      return mcRighe;
    }
    if (CPLib.eqr("mcRigheTXT",p_cVarName)) {
      return mcRigheTXT;
    }
    if (CPLib.eqr("mcPersonbo",p_cVarName)) {
      return mcPersonbo;
    }
    if (CPLib.eqr("mcWersonbo",p_cVarName)) {
      return mcWersonbo;
    }
    if (CPLib.eqr("mcKnarapbo",p_cVarName)) {
      return mcKnarapbo;
    }
    if (CPLib.eqr("mcStgru",p_cVarName)) {
      return mcStgru;
    }
    if (CPLib.eqr("mcTipo1",p_cVarName)) {
      return mcTipo1;
    }
    if (CPLib.eqr("mcTipo2",p_cVarName)) {
      return mcTipo2;
    }
    if (CPLib.eqr("mcTipo4",p_cVarName)) {
      return mcTipo4;
    }
    if (CPLib.eqr("mcTipo5",p_cVarName)) {
      return mcTipo5;
    }
    if (CPLib.eqr("mcTipo6",p_cVarName)) {
      return mcTipo6;
    }
    if (CPLib.eqr("mcTipo7",p_cVarName)) {
      return mcTipo7;
    }
    if (CPLib.eqr("mcTipo8",p_cVarName)) {
      return mcTipo8;
    }
    if (CPLib.eqr("mcTipo9",p_cVarName)) {
      return mcTipo9;
    }
    return null;
  }
  public CPMemoryCursorRow GetMemoryCursorRow(String p_cVarName,String p_cType,int len,int dec) {
    return null;
  }
  public com.zucchetti.sitepainter.datatypes.CPJSONStruct GetJSON(String p_cVarName,String p_cType,int len,int dec) {
    return com.zucchetti.sitepainter.datatypes.CPJSONStruct.EmptyStruct();
  }
  public void SetNumber(String p_cVarName,String p_cType,int len,int dec,double value) {
    if (CPLib.eqr("gNumRec",p_cVarName)) {
      gNumRec = value;
      return;
    }
    if (CPLib.eqr("gNumReg",p_cVarName)) {
      gNumReg = value;
      return;
    }
    if (CPLib.eqr("agente",p_cVarName)) {
      w_agente = value;
      return;
    }
    if (CPLib.eqr("_rownum",p_cVarName)) {
      _rownum = value;
      return;
    }
    if (CPLib.eqr("nTotRec",p_cVarName)) {
      nTotRec = value;
      return;
    }
    if (CPLib.eqr("nTotReg",p_cVarName)) {
      nTotReg = value;
      return;
    }
    if (CPLib.eqr("nNumRec",p_cVarName)) {
      nNumRec = value;
      return;
    }
    if (CPLib.eqr("_avanza",p_cVarName)) {
      _avanza = value;
      return;
    }
    if (CPLib.eqr("_ctotale",p_cVarName)) {
      _ctotale = value;
      return;
    }
    if (CPLib.eqr("_conta",p_cVarName)) {
      _conta = value;
      return;
    }
    if (CPLib.eqr("_max",p_cVarName)) {
      _max = value;
      return;
    }
    if (CPLib.eqr("_min",p_cVarName)) {
      _min = value;
      return;
    }
    if (CPLib.eqr("_top",p_cVarName)) {
      _top = value;
      return;
    }
    if (CPLib.eqr("_bottom",p_cVarName)) {
      _bottom = value;
      return;
    }
    if (CPLib.eqr("_cicli",p_cVarName)) {
      _cicli = value;
      return;
    }
    if (CPLib.eqr("_contacilci",p_cVarName)) {
      _contacilci = value;
      return;
    }
    if (CPLib.eqr("_ciclo",p_cVarName)) {
      _ciclo = value;
      return;
    }
    if (CPLib.eqr("_oldrighe",p_cVarName)) {
      _oldrighe = value;
      return;
    }
    if (CPLib.eqr("_continua",p_cVarName)) {
      _continua = value;
      return;
    }
    if (CPLib.eqr("_conta1",p_cVarName)) {
      _conta1 = value;
      return;
    }
    if (CPLib.eqr("_conta2",p_cVarName)) {
      _conta2 = value;
      return;
    }
    if (CPLib.eqr("_conta4",p_cVarName)) {
      _conta4 = value;
      return;
    }
    if (CPLib.eqr("_conta5",p_cVarName)) {
      _conta5 = value;
      return;
    }
    if (CPLib.eqr("_conta6",p_cVarName)) {
      _conta6 = value;
      return;
    }
    if (CPLib.eqr("_conta7",p_cVarName)) {
      _conta7 = value;
      return;
    }
    if (CPLib.eqr("_conta8",p_cVarName)) {
      _conta8 = value;
      return;
    }
    if (CPLib.eqr("_conta9",p_cVarName)) {
      _conta9 = value;
      return;
    }
    if (CPLib.eqr("_righe",p_cVarName)) {
      _righe = value;
      return;
    }
    if (CPLib.eqr("_righetot",p_cVarName)) {
      _righetot = value;
      return;
    }
    if (CPLib.eqr("_numfile",p_cVarName)) {
      _numfile = value;
      return;
    }
    if (CPLib.eqr("tblnum",p_cVarName)) {
      tblnum = value;
      return;
    }
    if (CPLib.eqr("_maxrighe",p_cVarName)) {
      _maxrighe = value;
      return;
    }
    if (CPLib.eqr("_oldmc",p_cVarName)) {
      _oldmc = value;
      return;
    }
    if (CPLib.eqr("_usemc",p_cVarName)) {
      _usemc = value;
      return;
    }
  }
  public void SetString(String p_cVarName,String p_cType,int len,int dec,String value) {
    if (CPLib.eqr("codinter",p_cVarName)) {
      w_codinter = value;
      return;
    }
    if (CPLib.eqr("tipinter",p_cVarName)) {
      w_tipinter = value;
      return;
    }
    if (CPLib.eqr("codage",p_cVarName)) {
      w_codage = value;
      return;
    }
    if (CPLib.eqr("codcli",p_cVarName)) {
      w_codcli = value;
      return;
    }
    if (CPLib.eqr("ragben",p_cVarName)) {
      w_ragben = value;
      return;
    }
    if (CPLib.eqr("daope",p_cVarName)) {
      daope = value;
      return;
    }
    if (CPLib.eqr("a_ope",p_cVarName)) {
      a_ope = value;
      return;
    }
    if (CPLib.eqr("dareg",p_cVarName)) {
      dareg = value;
      return;
    }
    if (CPLib.eqr("a_reg",p_cVarName)) {
      a_reg = value;
      return;
    }
    if (CPLib.eqr("tipoarchd",p_cVarName)) {
      w_tipoarchd = value;
      return;
    }
    if (CPLib.eqr("tipoarchp",p_cVarName)) {
      w_tipoarchp = value;
      return;
    }
    if (CPLib.eqr("stoper",p_cVarName)) {
      w_stoper = value;
      return;
    }
    if (CPLib.eqr("flgope",p_cVarName)) {
      w_flgope = value;
      return;
    }
    if (CPLib.eqr("flgfrz",p_cVarName)) {
      w_flgfrz = value;
      return;
    }
    if (CPLib.eqr("flgrae",p_cVarName)) {
      w_flgrae = value;
      return;
    }
    if (CPLib.eqr("flgrap",p_cVarName)) {
      w_flgrap = value;
      return;
    }
    if (CPLib.eqr("tiprap",p_cVarName)) {
      w_tiprap = value;
      return;
    }
    if (CPLib.eqr("flgtit",p_cVarName)) {
      w_flgtit = value;
      return;
    }
    if (CPLib.eqr("tiptit",p_cVarName)) {
      w_tiptit = value;
      return;
    }
    if (CPLib.eqr("flgint",p_cVarName)) {
      w_flgint = value;
      return;
    }
    if (CPLib.eqr("flgdel",p_cVarName)) {
      w_flgdel = value;
      return;
    }
    if (CPLib.eqr("flgchk",p_cVarName)) {
      w_flgchk = value;
      return;
    }
    if (CPLib.eqr("flgxls",p_cVarName)) {
      w_flgxls = value;
      return;
    }
    if (CPLib.eqr("flgsto",p_cVarName)) {
      w_flgsto = value;
      return;
    }
    if (CPLib.eqr("allsto",p_cVarName)) {
      w_allsto = value;
      return;
    }
    if (CPLib.eqr("multifile",p_cVarName)) {
      w_multifile = value;
      return;
    }
    if (CPLib.eqr("flg2020",p_cVarName)) {
      w_flg2020 = value;
      return;
    }
    if (CPLib.eqr("gPathApp",p_cVarName)) {
      gPathApp = value;
      return;
    }
    if (CPLib.eqr("gPathDoc",p_cVarName)) {
      gPathDoc = value;
      return;
    }
    if (CPLib.eqr("gIntemediario",p_cVarName)) {
      gIntemediario = value;
      return;
    }
    if (CPLib.eqr("gUrlApp",p_cVarName)) {
      gUrlApp = value;
      return;
    }
    if (CPLib.eqr("gAzienda",p_cVarName)) {
      gAzienda = value;
      return;
    }
    if (CPLib.eqr("gMsgImp",p_cVarName)) {
      gMsgImp = value;
      return;
    }
    if (CPLib.eqr("gMsgProc",p_cVarName)) {
      gMsgProc = value;
      return;
    }
    if (CPLib.eqr("gFlgWU",p_cVarName)) {
      gFlgWU = value;
      return;
    }
    if (CPLib.eqr("gCodDip",p_cVarName)) {
      gCodDip = value;
      return;
    }
    if (CPLib.eqr("codcab",p_cVarName)) {
      w_codcab = value;
      return;
    }
    if (CPLib.eqr("cabcod",p_cVarName)) {
      w_cabcod = value;
      return;
    }
    if (CPLib.eqr("desccit",p_cVarName)) {
      w_desccit = value;
      return;
    }
    if (CPLib.eqr("citdesc",p_cVarName)) {
      w_citdesc = value;
      return;
    }
    if (CPLib.eqr("provin",p_cVarName)) {
      w_provin = value;
      return;
    }
    if (CPLib.eqr("provind",p_cVarName)) {
      w_provind = value;
      return;
    }
    if (CPLib.eqr("coddipe",p_cVarName)) {
      w_coddipe = value;
      return;
    }
    if (CPLib.eqr("_note",p_cVarName)) {
      _note = value;
      return;
    }
    if (CPLib.eqr("fhand",p_cVarName)) {
      fhand = value;
      return;
    }
    if (CPLib.eqr("_nomefile",p_cVarName)) {
      _nomefile = value;
      return;
    }
    if (CPLib.eqr("cNomeFile",p_cVarName)) {
      cNomeFile = value;
      return;
    }
    if (CPLib.eqr("cOnlyNomeFile",p_cVarName)) {
      cOnlyNomeFile = value;
      return;
    }
    if (CPLib.eqr("cNomeFileZip",p_cVarName)) {
      cNomeFileZip = value;
      return;
    }
    if (CPLib.eqr("_codrif",p_cVarName)) {
      _codrif = value;
      return;
    }
    if (CPLib.eqr("cdadata",p_cVarName)) {
      w_cdadata = value;
      return;
    }
    if (CPLib.eqr("c_adata",p_cVarName)) {
      w_c_adata = value;
      return;
    }
    if (CPLib.eqr("cdadata_rap",p_cVarName)) {
      w_cdadata_rap = value;
      return;
    }
    if (CPLib.eqr("c_adata_rap",p_cVarName)) {
      w_c_adata_rap = value;
      return;
    }
    if (CPLib.eqr("cdareg_rap",p_cVarName)) {
      w_cdareg_rap = value;
      return;
    }
    if (CPLib.eqr("c_areg_rap",p_cVarName)) {
      w_c_areg_rap = value;
      return;
    }
    if (CPLib.eqr("_flagrap",p_cVarName)) {
      _flagrap = value;
      return;
    }
    if (CPLib.eqr("_ramate",p_cVarName)) {
      _ramate = value;
      return;
    }
    if (CPLib.eqr("_numsto",p_cVarName)) {
      _numsto = value;
      return;
    }
    if (CPLib.eqr("_oldrap",p_cVarName)) {
      _oldrap = value;
      return;
    }
    if (CPLib.eqr("_idereg",p_cVarName)) {
      _idereg = value;
      return;
    }
    if (CPLib.eqr("xStato",p_cVarName)) {
      xStato = value;
      return;
    }
    if (CPLib.eqr("_tiprec",p_cVarName)) {
      _tiprec = value;
      return;
    }
    if (CPLib.eqr("_raeatc",p_cVarName)) {
      _raeatc = value;
      return;
    }
    if (CPLib.eqr("oldfolder",p_cVarName)) {
      oldfolder = value;
      return;
    }
    if (CPLib.eqr("_tipoag",p_cVarName)) {
      _tipoag = value;
      return;
    }
    if (CPLib.eqr("_datage",p_cVarName)) {
      _datage = value;
      return;
    }
    if (CPLib.eqr("_numticket",p_cVarName)) {
      _numticket = value;
      return;
    }
    if (CPLib.eqr("cdareg",p_cVarName)) {
      w_cdareg = value;
      return;
    }
    if (CPLib.eqr("c_areg",p_cVarName)) {
      w_c_areg = value;
      return;
    }
    if (CPLib.eqr("z_codcab",p_cVarName)) {
      z_codcab = value;
      return;
    }
    if (CPLib.eqr("z_desccit",p_cVarName)) {
      z_desccit = value;
      return;
    }
    if (CPLib.eqr("z_provin",p_cVarName)) {
      z_provin = value;
      return;
    }
    if (CPLib.eqr("z_coddipe",p_cVarName)) {
      z_coddipe = value;
      return;
    }
    if (CPLib.eqr("_tiporap",p_cVarName)) {
      _tiporap = value;
      return;
    }
    if (CPLib.eqr("cRitorno",p_cVarName)) {
      cRitorno = value;
      return;
    }
    if (CPLib.eqr("_riga",p_cVarName)) {
      _riga = value;
      return;
    }
    if (CPLib.eqr("tblname_main",p_cVarName)) {
      tblname_main = value;
      return;
    }
    if (CPLib.eqr("_file1",p_cVarName)) {
      _file1 = value;
      return;
    }
    if (CPLib.eqr("_file2",p_cVarName)) {
      _file2 = value;
      return;
    }
    if (CPLib.eqr("cProg",p_cVarName)) {
      cProg = value;
      return;
    }
    if (CPLib.eqr("_nfile",p_cVarName)) {
      _nfile = value;
      return;
    }
    if (CPLib.eqr("pCodDip",p_cVarName)) {
      pCodDip = value;
      return;
    }
    if (CPLib.eqr("pCodCab",p_cVarName)) {
      pCodCab = value;
      return;
    }
    if (CPLib.eqr("pDesCit",p_cVarName)) {
      pDesCit = value;
      return;
    }
    if (CPLib.eqr("pProv",p_cVarName)) {
      pProv = value;
      return;
    }
    if (CPLib.eqr("pCli",p_cVarName)) {
      pCli = value;
      return;
    }
    if (CPLib.eqr("pRap",p_cVarName)) {
      pRap = value;
      return;
    }
    if (CPLib.eqr("pTRap",p_cVarName)) {
      pTRap = value;
      return;
    }
    if (CPLib.eqr("pTipoR",p_cVarName)) {
      pTipoR = value;
      return;
    }
    if (CPLib.eqr("pRAE",p_cVarName)) {
      pRAE = value;
      return;
    }
    if (CPLib.eqr("pSTATO",p_cVarName)) {
      pSTATO = value;
      return;
    }
    if (CPLib.eqr("cStringa",p_cVarName)) {
      cStringa = value;
      return;
    }
    if (CPLib.eqr("_tipsot",p_cVarName)) {
      _tipsot = value;
      return;
    }
  }
  public void SetDate(String p_cVarName,String p_cType,int len,int dec,java.sql.Date value) {
    if (CPLib.eqr("DaData",p_cVarName)) {
      w_DaData = value;
      return;
    }
    if (CPLib.eqr("AData",p_cVarName)) {
      w_AData = value;
      return;
    }
    if (CPLib.eqr("DaDataReg",p_cVarName)) {
      w_DaDataReg = value;
      return;
    }
    if (CPLib.eqr("ADataReg",p_cVarName)) {
      w_ADataReg = value;
      return;
    }
    if (CPLib.eqr("pDatOpe",p_cVarName)) {
      pDatOpe = value;
      return;
    }
    if (CPLib.eqr("pDatRet",p_cVarName)) {
      pDatRet = value;
      return;
    }
  }
  public void SetDateTime(String p_cVarName,String p_cType,int len,int dec,java.sql.Timestamp value) {
  }
  public void SetLogic(String p_cVarName,String p_cType,int len,int dec,boolean value) {
    if (CPLib.eqr("_mlientiope",p_cVarName)) {
      _mlientiope = value;
      return;
    }
    if (CPLib.eqr("_clientiope",p_cVarName)) {
      _clientiope = value;
      return;
    }
    if (CPLib.eqr("_mogopebo",p_cVarName)) {
      _mogopebo = value;
      return;
    }
    if (CPLib.eqr("_sogopebo",p_cVarName)) {
      _sogopebo = value;
      return;
    }
    if (CPLib.eqr("_meneficope",p_cVarName)) {
      _meneficope = value;
      return;
    }
    if (CPLib.eqr("_beneficope",p_cVarName)) {
      _beneficope = value;
      return;
    }
    if (CPLib.eqr("_merzistiope",p_cVarName)) {
      _merzistiope = value;
      return;
    }
    if (CPLib.eqr("_terzistiope",p_cVarName)) {
      _terzistiope = value;
      return;
    }
    if (CPLib.eqr("_mlientifrz",p_cVarName)) {
      _mlientifrz = value;
      return;
    }
    if (CPLib.eqr("_clientifrz",p_cVarName)) {
      _clientifrz = value;
      return;
    }
    if (CPLib.eqr("_mogopefbo",p_cVarName)) {
      _mogopefbo = value;
      return;
    }
    if (CPLib.eqr("_sogopefbo",p_cVarName)) {
      _sogopefbo = value;
      return;
    }
    if (CPLib.eqr("_meneficfrz",p_cVarName)) {
      _meneficfrz = value;
      return;
    }
    if (CPLib.eqr("_beneficfrz",p_cVarName)) {
      _beneficfrz = value;
      return;
    }
    if (CPLib.eqr("_merzistifrz",p_cVarName)) {
      _merzistifrz = value;
      return;
    }
    if (CPLib.eqr("_terzistifrz",p_cVarName)) {
      _terzistifrz = value;
      return;
    }
    if (CPLib.eqr("_rapcoll",p_cVarName)) {
      _rapcoll = value;
      return;
    }
    if (CPLib.eqr("_rapcolleg",p_cVarName)) {
      _rapcolleg = value;
      return;
    }
    if (CPLib.eqr("_xlientiope",p_cVarName)) {
      _xlientiope = value;
      return;
    }
    if (CPLib.eqr("_xogopebo",p_cVarName)) {
      _xogopebo = value;
      return;
    }
    if (CPLib.eqr("_xeneficope",p_cVarName)) {
      _xeneficope = value;
      return;
    }
    if (CPLib.eqr("_xerzistiope",p_cVarName)) {
      _xerzistiope = value;
      return;
    }
    if (CPLib.eqr("_xlientifrz",p_cVarName)) {
      _xlientifrz = value;
      return;
    }
    if (CPLib.eqr("_xogopefbo",p_cVarName)) {
      _xogopefbo = value;
      return;
    }
    if (CPLib.eqr("_xeneficfrz",p_cVarName)) {
      _xeneficfrz = value;
      return;
    }
    if (CPLib.eqr("_xerzistifrz",p_cVarName)) {
      _xerzistifrz = value;
      return;
    }
    if (CPLib.eqr("_xapcoll",p_cVarName)) {
      _xapcoll = value;
      return;
    }
    if (CPLib.eqr("_xapcolleg",p_cVarName)) {
      _xapcolleg = value;
      return;
    }
  }
  public void SetMemoryCursorRow(String p_cVarName,String p_cType,int len,int dec,CPMemoryCursorRow value) {
  }
  public void SetMemoryCursor(String p_cVarName,String p_cType,int len,int dec,CPMemoryCursor value) {
    if (CPLib.eqr("mcANADIP",p_cVarName)) {
      mcANADIP = (MemoryCursor_anadip)value;
      return;
    }
    if (CPLib.eqr("mcRighe",p_cVarName)) {
      mcRighe = (MemoryCursor_mcdiana_mcrdef)value;
      return;
    }
    if (CPLib.eqr("mcRigheTXT",p_cVarName)) {
      mcRigheTXT = (MemoryCursor_mcdiana_mcrdef)value;
      return;
    }
    if (CPLib.eqr("mcPersonbo",p_cVarName)) {
      mcPersonbo = (MemoryCursor_personbo)value;
      return;
    }
    if (CPLib.eqr("mcWersonbo",p_cVarName)) {
      mcWersonbo = (MemoryCursor_wersonbo)value;
      return;
    }
    if (CPLib.eqr("mcKnarapbo",p_cVarName)) {
      mcKnarapbo = (MemoryCursor_knarapbo)value;
      return;
    }
    if (CPLib.eqr("mcStgru",p_cVarName)) {
      mcStgru = (MemoryCursor_tbstgru)value;
      return;
    }
    if (CPLib.eqr("mcTipo1",p_cVarName)) {
      mcTipo1 = (MemoryCursor_tipo1)value;
      return;
    }
    if (CPLib.eqr("mcTipo2",p_cVarName)) {
      mcTipo2 = (MemoryCursor_tipo2_3)value;
      return;
    }
    if (CPLib.eqr("mcTipo4",p_cVarName)) {
      mcTipo4 = (MemoryCursor_tipo4)value;
      return;
    }
    if (CPLib.eqr("mcTipo5",p_cVarName)) {
      mcTipo5 = (MemoryCursor_tipo5)value;
      return;
    }
    if (CPLib.eqr("mcTipo6",p_cVarName)) {
      mcTipo6 = (MemoryCursor_tipo6)value;
      return;
    }
    if (CPLib.eqr("mcTipo7",p_cVarName)) {
      mcTipo7 = (MemoryCursor_tipo7)value;
      return;
    }
    if (CPLib.eqr("mcTipo8",p_cVarName)) {
      mcTipo8 = (MemoryCursor_tipo8)value;
      return;
    }
    if (CPLib.eqr("mcTipo9",p_cVarName)) {
      mcTipo9 = (MemoryCursor_tipo9)value;
      return;
    }
  }
  public void SetJSON(String p_cVarName,String p_cType,int len,int dec,com.zucchetti.sitepainter.datatypes.CPJSONStruct value) {
  }
  public void CalledBatchEnd() {
  }
  void Page_1() throws Exception {
    CPResultSet Read_Cursor=null;
    CPResultSet Cursor_anadip=null;
    CPResultSet Cursor_personbo=null;
    CPResultSet Cursor_qbe_personbo_all=null;
    CPResultSet Cursor_wersonbo=null;
    CPResultSet Cursor_qbe_wersonbo_all=null;
    CPResultSet Cursor_tbstgru=null;
    CPResultSet Cursor_knarapbo=null;
    VQRHolder l_VQRHolder = null;
    try {
      /* w_codinter Char(11) */
      /* w_tipinter Char(2) */
      /* w_codage Char(6) */
      /* w_codcli Char(16) */
      /* w_ragben Char(70) */
      /* daope Char(8) */
      /* a_ope Char(8) */
      /* dareg Char(8) */
      /* a_reg Char(8) */
      /* w_tipoarchd Char(1) */
      /* w_tipoarchp Char(1) */
      /* w_stoper Char(1) */
      /* w_flgope Char(1) */
      /* w_flgfrz Char(1) */
      /* w_flgrae Char(1) */
      /* w_flgrap Char(1) */
      /* w_tiprap Char(1) */
      /* w_flgtit Char(1) */
      /* w_tiptit Char(1) */
      /* w_flgint Char(1) */
      /* w_flgdel Char(1) */
      /* w_flgchk Char(1) */
      /* w_flgxls Char(1) */
      /* w_flgsto Char(1) */
      /* w_allsto Char(1) */
      /* w_multifile Char(1) */
      /* w_flg2020 Char(1) */
      /* gPathApp Char(80) // Path Applicazione */
      /* gPathDoc Char(80) // Path Applicazione */
      /* gIntemediario Char(11) // Intermediario */
      /* gUrlApp Char(80) // URL Applicazione */
      /* gAzienda Char(10) // Azienda */
      /* gNumRec Numeric(15, 0) // N° Record DIANA */
      /* gNumReg Numeric(15, 0) // N° Registrazioni DIANA */
      /* gMsgImp Char(120) // Messaggio Import */
      /* gMsgProc Memo // Messaggio */
      /* gFlgWU Char(1) // Gestione WU */
      /* gCodDip Char(6) // Dipendenza */
      /* w_codcab Char(6) */
      /* w_cabcod Char(6) */
      /* w_desccit Char(30) */
      /* w_citdesc Char(30) */
      /* w_provin Char(2) */
      /* w_provind Char(2) */
      /* w_coddipe Char(6) */
      /* w_agente Numeric(1, 0) */
      /* _note Memo */
      /* _rownum Numeric(10, 0) */
      /* fhand Char(10) */
      /* _nomefile Char(15) */
      /* cNomeFile Char(30) */
      /* cOnlyNomeFile Char(30) */
      /* cNomeFileZip Char(30) */
      /* nTotRec Numeric(10, 0) */
      /* nTotReg Numeric(10, 0) */
      /* nNumRec Numeric(10, 0) */
      /* _avanza Numeric(1, 0) */
      /* _codrif Char(16) */
      /* w_cdadata Char(8) // Da Data Operazione */
      /* w_c_adata Char(8) // A Data Operazione */
      /* w_cdadata_rap Char(8) */
      /* w_c_adata_rap Char(8) */
      /* w_cdareg_rap Char(8) */
      /* w_c_areg_rap Char(8) */
      /* _ctotale Numeric(10, 0) */
      /* _conta Numeric(10, 0) */
      /* _max Numeric(15, 0) */
      /* _min Numeric(15, 0) */
      /* _top Numeric(15, 0) */
      /* _bottom Numeric(15, 0) */
      /* _cicli Numeric(15, 0) */
      /* _contacilci Numeric(15, 0) */
      /* _ctotale Numeric(15, 0) */
      /* _flagrap Char(1) */
      /* _ciclo Numeric(1, 0) */
      /* _ramate Char(3) */
      /* _numsto Char(15) */
      /* _oldrighe Numeric(1, 0) */
      /* _continua Numeric(1, 0) */
      /* _oldrap Char(25) */
      /* _idereg Char(20) */
      /* xStato Char(1) */
      /* _conta1 Numeric(10, 0) */
      /* _conta2 Numeric(10, 0) */
      /* _conta4 Numeric(10, 0) */
      /* _conta5 Numeric(10, 0) */
      /* _conta6 Numeric(10, 0) */
      /* _conta7 Numeric(10, 0) */
      /* _conta8 Numeric(10, 0) */
      /* _conta9 Numeric(10, 0) */
      /* _tiprec Char(1) */
      /* _raeatc Char(1) */
      /* oldfolder Char(120) */
      /* _tipoag Char(10) */
      /* _datage Char(44) */
      /* _numticket Char(30) */
      /* w_cdareg Char(8) // Da Data Registrazione */
      /* w_c_areg Char(8) // A Data Registrazione */
      /* z_codcab Char(6) */
      /* z_desccit Char(30) */
      /* z_provin Char(2) */
      /* z_coddipe Char(6) */
      /* mcANADIP MemoryCursor(anadip) */
      /* mcRighe MemoryCursor(mcDIANA.MCRDef) */
      /* mcRigheTXT MemoryCursor(mcDIANA.MCRDef) */
      /* mcPersonbo MemoryCursor(personbo) */
      /* mcWersonbo MemoryCursor(wersonbo) */
      /* mcKnarapbo MemoryCursor(knarapbo) */
      /* mcStgru MemoryCursor(tbstgru) */
      /* _tiporap Char(1) */
      /* cRitorno Char(2) := 'KO' */
      cRitorno = "KO";
      /* _righe Numeric(10, 0) */
      /* _righetot Numeric(10, 0) */
      /* _numfile Numeric(10, 0) */
      /* _riga Memo */
      /* tblnum Numeric(2, 0) := 1 */
      tblnum = CPLib.Round(1,0);
      /* tblname_main Char(9) */
      /* _maxrighe Numeric(10, 0) := 25000 */
      _maxrighe = CPLib.Round(25000,0);
      /* _file1 Char(30) */
      /* _file2 Char(30) */
      /* _oldmc Numeric(1, 0) */
      /* cProg Char(20) */
      /* _mlientiope Bool */
      /* _clientiope Bool */
      /* _mogopebo Bool */
      /* _sogopebo Bool */
      /* _meneficope Bool */
      /* _beneficope Bool */
      /* _merzistiope Bool */
      /* _terzistiope Bool */
      /* _mlientifrz Bool */
      /* _clientifrz Bool */
      /* _mogopefbo Bool */
      /* _sogopefbo Bool */
      /* _meneficfrz Bool */
      /* _beneficfrz Bool */
      /* _merzistifrz Bool */
      /* _terzistifrz Bool */
      /* _rapcoll Bool */
      /* _rapcolleg Bool */
      /* _xlientiope Bool */
      /* _xogopebo Bool */
      /* _xeneficope Bool */
      /* _xerzistiope Bool */
      /* _xlientifrz Bool */
      /* _xogopefbo Bool */
      /* _xeneficfrz Bool */
      /* _xerzistifrz Bool */
      /* _xapcoll Bool */
      /* _xapcolleg Bool */
      /* mcTipo1 MemoryCursor(tipo1) */
      /* mcTipo2 MemoryCursor(tipo2_3) */
      /* mcTipo4 MemoryCursor(tipo4) */
      /* mcTipo5 MemoryCursor(tipo5) */
      /* mcTipo6 MemoryCursor(tipo6) */
      /* mcTipo7 MemoryCursor(tipo7) */
      /* mcTipo8 MemoryCursor(tipo8) */
      /* mcTipo9 MemoryCursor(tipo9) */
      /* _nfile Char(120) */
      /* pCodDip Char(6) // Codice Dipendenza */
      /* pCodCab Char(6) // CAB Dipendenza */
      /* pDesCit Char(30) // Città Dipendenza */
      /* pProv Char(2) // Provincia Dipendenza */
      /* w_DaData Date */
      /* w_AData Date */
      /* w_DaDataReg Date */
      /* w_ADataReg Date */
      /* pCli Char(16) // Codice Soggetto */
      /* pDatOpe Date // Data Operazione */
      /* pRap Char(25) // Codice Rapporto */
      /* pTRap Char(1) // Tipo Rapporto */
      /* pTipoR Char(1) // Tipo Riga */
      /* pRAE Char(1) // RAE o ATECO */
      /* pSTATO Char(1) // Stato Registrazione */
      /* pDatRet Date // Data Rettifica */
      /* _usemc Numeric(1, 0) := 0 */
      _usemc = CPLib.Round(0,0);
      /* If not(Empty(w_codcli)) or not(Empty(w_DaData)) or not(Empty(w_AData)) or not(Empty(w_DaDataReg)) or not(Empty(w_ADataReg)) */
      if ( ! (CPLib.Empty(w_codcli)) ||  ! (CPLib.Empty(w_DaData)) ||  ! (CPLib.Empty(w_AData)) ||  ! (CPLib.Empty(w_DaDataReg)) ||  ! (CPLib.Empty(w_ADataReg))) {
        /* _usemc := 1 */
        _usemc = CPLib.Round(1,0);
      } // End If
      /* w_DaData := iif(not(Empty(daope)),CharToDate(daope),NullDate()) */
      w_DaData = ( ! (CPLib.Empty(daope))?CPLib.CharToDate(daope):CPLib.NullDate());
      /* w_AData := iif(not(Empty(a_ope)),CharToDate(a_ope),NullDate()) */
      w_AData = ( ! (CPLib.Empty(a_ope))?CPLib.CharToDate(a_ope):CPLib.NullDate());
      /* w_DaDataReg := iif(not(Empty(dareg)),CharToDate(dareg),NullDate()) */
      w_DaDataReg = ( ! (CPLib.Empty(dareg))?CPLib.CharToDate(dareg):CPLib.NullDate());
      /* w_ADataReg := iif(not(Empty(a_reg)),CharToDate(a_reg),NullDate()) */
      w_ADataReg = ( ! (CPLib.Empty(a_reg))?CPLib.CharToDate(a_reg):CPLib.NullDate());
      /* gMsgProc := gMsgProc + 'Ora Inizio Procedura: '+ arfn_fdatetime(DateTime()) + NL */
      gMsgProc = gMsgProc+"Ora Inizio Procedura: "+arfn_fdatetimeR.Make(m_Ctx,this).Run(CPLib.DateTime())+"\n";
      m_Ctx.SetGlobalString("gMsgProc",gMsgProc);
      /* Exec "Crea variabili per lettura tabelle accessorie" Page 12:Page_16 */
      Page_16();
      /* w_cdadata := iif(Empty(w_DaData) or DateToChar(w_DaData)='01000101','',DateToChar(w_DaData)) */
      w_cdadata = (CPLib.Empty(w_DaData) || CPLib.eqr(CPLib.DateToChar(w_DaData),"01000101")?"":CPLib.DateToChar(w_DaData));
      /* w_c_adata := iif(Empty(w_AData) or DateToChar(w_AData)='01000101','',DateToChar(w_AData)) */
      w_c_adata = (CPLib.Empty(w_AData) || CPLib.eqr(CPLib.DateToChar(w_AData),"01000101")?"":CPLib.DateToChar(w_AData));
      /* w_cdareg := iif(Empty(w_DaDataReg) or DateToChar(w_DaDataReg)='01000101','',DateToChar(w_DaDataReg)) */
      w_cdareg = (CPLib.Empty(w_DaDataReg) || CPLib.eqr(CPLib.DateToChar(w_DaDataReg),"01000101")?"":CPLib.DateToChar(w_DaDataReg));
      /* w_c_areg := iif(Empty(w_ADataReg) or DateToChar(w_ADataReg)='01000101','',DateToChar(w_ADataReg)) */
      w_c_areg = (CPLib.Empty(w_ADataReg) || CPLib.eqr(CPLib.DateToChar(w_ADataReg),"01000101")?"":CPLib.DateToChar(w_ADataReg));
      /* z_codcab := '' */
      z_codcab = "";
      /* z_desccit := '' */
      z_desccit = "";
      /* z_provin := '' */
      z_provin = "";
      /* z_coddipe := '' */
      z_coddipe = "";
      // * --- Read from intermbo
      m_cServer = m_Ctx.GetServer("intermbo");
      m_cPhName = m_Ctx.GetPhName("intermbo");
      m_cSql = "";
      m_cSql = m_cSql+"CODINTER="+CPSql.SQLValueAdapter(CPLib.ToSQL(gIntemediario,"C",11,0,m_cServer),m_cServer,gIntemediario);
      if (m_Ctx.IsSharedTemp("intermbo")) {
        m_cSql = m_cSql+" and context_id='"+m_Ctx.GetTempID()+"'";
      }
      if (Read_Cursor!=null)
        Read_Cursor.Close();
      Read_Cursor = m_Sql.Query(m_cServer,"select "+CPLib.GetMultilanguageField("CODCAB",m_Ctx,m_cServer)+","+CPLib.GetMultilanguageField("DESCCIT",m_Ctx,m_cServer)+","+CPLib.GetMultilanguageField("PROVINCIA",m_Ctx,m_cServer)+","+CPLib.GetMultilanguageField("CODDIPE",m_Ctx,m_cServer)+" from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+m_cSql);
      if ( ! (Read_Cursor.Eof())) {
        z_codcab = Read_Cursor.GetString("CODCAB");
        z_desccit = Read_Cursor.GetString("DESCCIT");
        z_provin = Read_Cursor.GetString("PROVINCIA");
        z_coddipe = Read_Cursor.GetString("CODDIPE");
        Read_Cursor.Next();
        if ( ! (Read_Cursor.Eof())) {
          Error l_oErrorFault = new Error("Read on intermbo into routine arrt_chkdiana_all returns two or more records. This item should return only a record.");
          CPStdCounter.Error(l_oErrorFault);
        }
        Read_Cursor.Close();
      } else {
        // Error: no record found!
        z_codcab = "";
        z_desccit = "";
        z_provin = "";
        z_coddipe = "";
        Read_Cursor.Close();
        m_cLastMsgError = "MSG_RECORD_NOT_FOUND";
      }
      // * --- Fill memory cursor mcANADIP on anadip
      mcANADIP.Zap();
      m_cServer = m_Ctx.GetServer("anadip");
      m_cPhName = m_Ctx.GetPhName("anadip");
      if (Cursor_anadip!=null)
        Cursor_anadip.Close();
      Cursor_anadip = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+(m_Ctx.IsSharedTemp("anadip")?"context_id='"+m_Ctx.GetTempID()+"'":"1=1"),m_cServer,m_Ctx,true));
      {
        final CPResultSet m_TheCursor = Cursor_anadip;
        Cursor_anadip.ActionOnClose(new Runnable() {
          public void run() {
            if (CPLib.gt(m_TheCursor.CurrentRow()-1,1000*1.1)) {
              com.zucchetti.sitepainter.Logger info = com.zucchetti.sitepainter.Logger.getWarningLogger();
              if ( ! (CPLib.IsNull(info))) {
                info.log("Routine arrt_chkdiana_all: query on anadip returns "+(m_TheCursor.CurrentRow()-1)+" rows larger then the expected 1000");
              }
            }
          }
          });
      }
      while ( ! (Cursor_anadip.Eof())) {
        mcANADIP.AppendWithTrimmedKey(Cursor_anadip.GetString("CODDIP"));
        mcANADIP.row.CODDIP = Cursor_anadip.GetString("CODDIP");
        mcANADIP.row.DESCRIZ = Cursor_anadip.GetString("DESCRIZ");
        mcANADIP.row.IDCITTA = Cursor_anadip.GetString("IDCITTA");
        mcANADIP.row.DESCCIT = Cursor_anadip.GetString("DESCCIT");
        mcANADIP.row.PROVINCIA = Cursor_anadip.GetString("PROVINCIA");
        mcANADIP.row.CAB = Cursor_anadip.GetString("CAB");
        mcANADIP.row.IDBASE = Cursor_anadip.GetString("IDBASE");
        mcANADIP.row.AGENTE = Cursor_anadip.GetString("AGENTE");
        mcANADIP.row.MACROAGENTE = Cursor_anadip.GetString("MACROAGENTE");
        mcANADIP.row.TERMINALID = Cursor_anadip.GetString("TERMINALID");
        mcANADIP.row.DOMICILIO = Cursor_anadip.GetString("DOMICILIO");
        mcANADIP.row.TELEFONO = Cursor_anadip.GetString("TELEFONO");
        mcANADIP.row.CODLOC = Cursor_anadip.GetString("CODLOC");
        mcANADIP.row.ABICABSARA = Cursor_anadip.GetString("ABICABSARA");
        mcANADIP.row.NUOVO = Cursor_anadip.GetString("NUOVO");
        mcANADIP.row.CAP = Cursor_anadip.GetString("CAP");
        mcANADIP.row.AGACCODE = Cursor_anadip.GetString("AGACCODE");
        mcANADIP.row.NAZAGENTE = Cursor_anadip.GetString("NAZAGENTE");
        mcANADIP.row.OPXSOSCLI = Cursor_anadip.GetDouble("OPXSOSCLI");
        mcANADIP.row.OPXSOSAGE = Cursor_anadip.GetDouble("OPXSOSAGE");
        mcANADIP.row.VALCOMPL = Cursor_anadip.GetString("VALCOMPL");
        mcANADIP.row.ANOMOPER = Cursor_anadip.GetString("ANOMOPER");
        mcANADIP.row.AGEREGIO = Cursor_anadip.GetString("AGEREGIO");
        mcANADIP.row.FLGATT = Cursor_anadip.GetString("FLGATT");
        mcANADIP.row.CODAGE = Cursor_anadip.GetString("CODAGE");
        mcANADIP.row.TIPOSV = Cursor_anadip.GetString("TIPOSV");
        mcANADIP.row.FLGNOAUA = Cursor_anadip.GetString("FLGNOAUA");
        mcANADIP.row.FLGWUPOS = Cursor_anadip.GetString("FLGWUPOS");
        mcANADIP.row.CATEG01 = Cursor_anadip.GetString("CATEG01");
        mcANADIP.row.CATEG02 = Cursor_anadip.GetString("CATEG02");
        mcANADIP.row.CATEG03 = Cursor_anadip.GetString("CATEG03");
        mcANADIP.row.CATEG04 = Cursor_anadip.GetString("CATEG04");
        mcANADIP.row.CATEG05 = Cursor_anadip.GetString("CATEG05");
        mcANADIP.row.CATEGORIA = Cursor_anadip.GetString("CATEGORIA");
        mcANADIP.row.CAB2 = Cursor_anadip.GetString("CAB2");
        mcANADIP.row.RISGLOB = Cursor_anadip.GetString("RISGLOB");
        mcANADIP.row.DATAPROF = Cursor_anadip.GetDate("DATAPROF");
        mcANADIP.row.CODICEAAMS = Cursor_anadip.GetString("CODICEAAMS");
        mcANADIP.row.CONCESSIONE = Cursor_anadip.GetString("CONCESSIONE");
        mcANADIP.row.CODFISC = Cursor_anadip.GetString("CODFISC");
        mcANADIP.row.PARTIVA = Cursor_anadip.GetString("PARTIVA");
        mcANADIP.row.TIPOAGENTE = Cursor_anadip.GetString("TIPOAGENTE");
        mcANADIP.row.NUMCIVICO = Cursor_anadip.GetString("NUMCIVICO");
        mcANADIP.row.DATAINI = Cursor_anadip.GetDate("DATAINI");
        mcANADIP.row.DATAFINE = Cursor_anadip.GetDate("DATAFINE");
        mcANADIP.row.SERRIMDEN = Cursor_anadip.GetString("SERRIMDEN");
        mcANADIP.row.FLGCOMPL = Cursor_anadip.GetDouble("FLGCOMPL");
        Cursor_anadip.Next();
      }
      m_cConnectivityError = Cursor_anadip.ErrorMessage();
      Cursor_anadip.Close();
      mcANADIP.GoTop();
      /* If _usemc=1 */
      if (CPLib.eqr(_usemc,1)) {
        /* gMsgProc := gMsgProc + 'Ora Inizio Creazione Lista Soggetti: '+ arfn_fdatetime(DateTime()) + NL */
        gMsgProc = gMsgProc+"Ora Inizio Creazione Lista Soggetti: "+arfn_fdatetimeR.Make(m_Ctx,this).Run(CPLib.DateTime())+"\n";
        m_Ctx.SetGlobalString("gMsgProc",gMsgProc);
        /* If not(Empty(LRTrim(w_codcli))) */
        if ( ! (CPLib.Empty(CPLib.LRTrim(w_codcli)))) {
          // * --- Fill memory cursor mcPersonbo on personbo
          mcPersonbo.Zap();
          m_cServer = m_Ctx.GetServer("personbo");
          m_cPhName = m_Ctx.GetPhName("personbo");
          if (Cursor_personbo!=null)
            Cursor_personbo.Close();
          Cursor_personbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CONNES="+CPSql.SQLValueAdapter(CPLib.ToSQL(CPLib.LRTrim(w_codcli),"?",0,0,m_cServer, m_oParameters),m_cServer,CPLib.LRTrim(w_codcli))+" "+")"+(m_Ctx.IsSharedTemp("personbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
          {
            final CPResultSet m_TheCursor = Cursor_personbo;
            Cursor_personbo.ActionOnClose(new Runnable() {
              public void run() {
                if (CPLib.gt(m_TheCursor.CurrentRow()-1,2000000*1.1)) {
                  com.zucchetti.sitepainter.Logger info = com.zucchetti.sitepainter.Logger.getWarningLogger();
                  if ( ! (CPLib.IsNull(info))) {
                    info.log("Routine arrt_chkdiana_all: query on personbo returns "+(m_TheCursor.CurrentRow()-1)+" rows larger then the expected 2000000");
                  }
                }
              }
              });
          }
          while ( ! (Cursor_personbo.Eof())) {
            mcPersonbo.AppendWithTrimmedKey(CPLib.LRTrim(Cursor_personbo.GetString("CONNES")));
            mcPersonbo.row.CONNES = Cursor_personbo.GetString("CONNES");
            mcPersonbo.row.CODCAB = Cursor_personbo.GetString("CODCAB");
            mcPersonbo.row.RAGSOC = Cursor_personbo.GetString("RAGSOC");
            mcPersonbo.row.DOMICILIO = Cursor_personbo.GetString("DOMICILIO");
            mcPersonbo.row.CODFISC = Cursor_personbo.GetString("CODFISC");
            mcPersonbo.row.DATANASC = Cursor_personbo.GetDate("DATANASC");
            mcPersonbo.row.NASCOMUN = Cursor_personbo.GetString("NASCOMUN");
            mcPersonbo.row.SOTGRUP = Cursor_personbo.GetString("SOTGRUP");
            mcPersonbo.row.RAMOGRUP = Cursor_personbo.GetString("RAMOGRUP");
            mcPersonbo.row.SETTSINT = Cursor_personbo.GetString("SETTSINT");
            mcPersonbo.row.TIPODOC = Cursor_personbo.GetString("TIPODOC");
            mcPersonbo.row.NUMDOCUM = Cursor_personbo.GetString("NUMDOCUM");
            mcPersonbo.row.DATARILASC = Cursor_personbo.GetDate("DATARILASC");
            mcPersonbo.row.AUTRILASC = Cursor_personbo.GetString("AUTRILASC");
            mcPersonbo.row.DESCCIT = Cursor_personbo.GetString("DESCCIT");
            mcPersonbo.row.PROVINCIA = Cursor_personbo.GetString("PROVINCIA");
            mcPersonbo.row.PAESE = Cursor_personbo.GetString("PAESE");
            mcPersonbo.row.CAP = Cursor_personbo.GetString("CAP");
            mcPersonbo.row.CODINTER = Cursor_personbo.GetString("CODINTER");
            mcPersonbo.row.TIPINTER = Cursor_personbo.GetString("TIPINTER");
            mcPersonbo.row.TIPOPERS = Cursor_personbo.GetString("TIPOPERS");
            mcPersonbo.row.CODDIPE = Cursor_personbo.GetString("CODDIPE");
            mcPersonbo.row.PARTIVA = Cursor_personbo.GetString("PARTIVA");
            mcPersonbo.row.NOTE = Cursor_personbo.GetString("NOTE");
            mcPersonbo.row.SESSO = Cursor_personbo.GetString("SESSO");
            mcPersonbo.row.SOSPMAF = Cursor_personbo.GetString("SOSPMAF");
            mcPersonbo.row.idcitta = Cursor_personbo.GetString("idcitta");
            mcPersonbo.row.DATAVALI = Cursor_personbo.GetDate("DATAVALI");
            mcPersonbo.row.NASSTATO = Cursor_personbo.GetString("NASSTATO");
            mcPersonbo.row.DOCFILE = Cursor_personbo.GetString("DOCFILE");
            mcPersonbo.row.NOME = Cursor_personbo.GetString("NOME");
            mcPersonbo.row.COGNOME = Cursor_personbo.GetString("COGNOME");
            mcPersonbo.row.CFESTERO = Cursor_personbo.GetDouble("CFESTERO");
            mcPersonbo.row.OLDCONNES = Cursor_personbo.GetString("OLDCONNES");
            mcPersonbo.row.DATEXTRA = Cursor_personbo.GetDate("DATEXTRA");
            mcPersonbo.row.PKTBSPECIE = Cursor_personbo.GetString("PKTBSPECIE");
            mcPersonbo.row.COMPORT = Cursor_personbo.GetString("COMPORT");
            mcPersonbo.row.ATTIV = Cursor_personbo.GetString("ATTIV");
            mcPersonbo.row.RNATGIU = Cursor_personbo.GetDouble("RNATGIU");
            mcPersonbo.row.RATTIV = Cursor_personbo.GetDouble("RATTIV");
            mcPersonbo.row.RCOMP = Cursor_personbo.GetDouble("RCOMP");
            mcPersonbo.row.RAREA = Cursor_personbo.GetDouble("RAREA");
            mcPersonbo.row.ALLINEATO = Cursor_personbo.GetDouble("ALLINEATO");
            mcPersonbo.row.ALLINEATONOMECNOME = Cursor_personbo.GetDouble("ALLINEATONOMECNOME");
            mcPersonbo.row.RAGSOCOLD = Cursor_personbo.GetString("RAGSOCOLD");
            mcPersonbo.row.PROGIMPORT = Cursor_personbo.GetDouble("PROGIMPORT");
            mcPersonbo.row.PROGIMP_C = Cursor_personbo.GetString("PROGIMP_C");
            mcPersonbo.row.AREAGEO = Cursor_personbo.GetString("AREAGEO");
            mcPersonbo.row.PEP = Cursor_personbo.GetString("PEP");
            mcPersonbo.row.IDFILE = Cursor_personbo.GetString("IDFILE");
            mcPersonbo.row.OLDCODFISC = Cursor_personbo.GetString("OLDCODFISC");
            mcPersonbo.row.MACROAGENTE = Cursor_personbo.GetString("MACROAGENTE");
            mcPersonbo.row.SPOTID = Cursor_personbo.GetString("SPOTID");
            mcPersonbo.row.DATASEGN = Cursor_personbo.GetDate("DATASEGN");
            mcPersonbo.row.OLDSETSIN = Cursor_personbo.GetString("OLDSETSIN");
            mcPersonbo.row.DATAVARAGE = Cursor_personbo.GetDate("DATAVARAGE");
            mcPersonbo.row.SETTSINT2 = Cursor_personbo.GetString("SETTSINT2");
            mcPersonbo.row.FATCA = Cursor_personbo.GetString("FATCA");
            mcPersonbo.row.BANCABEN = Cursor_personbo.GetString("BANCABEN");
            mcPersonbo.row.TIN = Cursor_personbo.GetString("TIN");
            mcPersonbo.row.ODB = Cursor_personbo.GetDouble("ODB");
            mcPersonbo.row.TELEF = Cursor_personbo.GetString("TELEF");
            mcPersonbo.row.TIPOORO = Cursor_personbo.GetString("TIPOORO");
            mcPersonbo.row.CODORO = Cursor_personbo.GetString("CODORO");
            mcPersonbo.row.IDNASCOMUN = Cursor_personbo.GetString("IDNASCOMUN");
            mcPersonbo.row.IDNASSTATO = Cursor_personbo.GetString("IDNASSTATO");
            mcPersonbo.row.NOTIT = Cursor_personbo.GetDouble("NOTIT");
            mcPersonbo.row.IDBASE = Cursor_personbo.GetString("IDBASE");
            mcPersonbo.row.FLGVALIDO = Cursor_personbo.GetString("FLGVALIDO");
            mcPersonbo.row.CITTADIN1 = Cursor_personbo.GetString("CITTADIN1");
            mcPersonbo.row.CITTADIN2 = Cursor_personbo.GetString("CITTADIN2");
            mcPersonbo.row.RESFISC = Cursor_personbo.GetString("RESFISC");
            mcPersonbo.row.MITIG = Cursor_personbo.GetDouble("MITIG");
            mcPersonbo.row.MITIGDOC = Cursor_personbo.GetString("MITIGDOC");
            mcPersonbo.row.NOSARA = Cursor_personbo.GetString("NOSARA");
            mcPersonbo.row.RISGLOB = Cursor_personbo.GetString("RISGLOB");
            mcPersonbo.row.DATAPROF = Cursor_personbo.GetDate("DATAPROF");
            mcPersonbo.row.DATAREVPROF = Cursor_personbo.GetDate("DATAREVPROF");
            mcPersonbo.row.IDENT = Cursor_personbo.GetString("IDENT");
            mcPersonbo.row.PEPDATE = Cursor_personbo.GetDate("PEPDATE");
            mcPersonbo.row.DAC6 = Cursor_personbo.GetString("DAC6");
            mcPersonbo.row.FLAGDAC6 = Cursor_personbo.GetDouble("FLAGDAC6");
            mcPersonbo.row.CRIME = Cursor_personbo.GetString("CRIME");
            mcPersonbo.row.CRIMEDATE = Cursor_personbo.GetDate("CRIMEDATE");
            mcPersonbo.row.ALTRODOM = Cursor_personbo.GetString("ALTRODOM");
            mcPersonbo.row.ALTROCAP = Cursor_personbo.GetString("ALTROCAP");
            mcPersonbo.row.CONTO = Cursor_personbo.GetString("CONTO");
            mcPersonbo.row.NUMIMP = Cursor_personbo.GetDateTime("NUMIMP");
            mcPersonbo.row.RAPSEGNA = Cursor_personbo.GetString("RAPSEGNA");
            mcPersonbo.row.CODLEGRAP = Cursor_personbo.GetString("CODLEGRAP");
            mcPersonbo.row.TIPOSOGGETTO = Cursor_personbo.GetString("TIPOSOGGETTO");
            mcPersonbo.row.CAUSALE = Cursor_personbo.GetDouble("CAUSALE");
            mcPersonbo.row.IMPORTOMAX = Cursor_personbo.GetDouble("IMPORTOMAX");
            mcPersonbo.row.FATTURATO = Cursor_personbo.GetDouble("FATTURATO");
            mcPersonbo.row.FREQUENZA = Cursor_personbo.GetString("FREQUENZA");
            mcPersonbo.row.NUMOPERAZ = Cursor_personbo.GetDouble("NUMOPERAZ");
            mcPersonbo.row.SOGAFFIDATARIO = Cursor_personbo.GetString("SOGAFFIDATARIO");
            mcPersonbo.row.FLGNOTRIM = Cursor_personbo.GetString("FLGNOTRIM");
            mcPersonbo.row.DISATTIVO = Cursor_personbo.GetDate("DISATTIVO");
            mcPersonbo.row.DATAFINE = Cursor_personbo.GetDate("DATAFINE");
            mcPersonbo.row.DATAINI = Cursor_personbo.GetDate("DATAINI");
            mcPersonbo.row.DATAIDENT = Cursor_personbo.GetDate("DATAIDENT");
            mcPersonbo.row.DATASIGN = Cursor_personbo.GetDate("DATASIGN");
            mcPersonbo.row.DATARAUT = Cursor_personbo.GetDate("DATARAUT");
            mcPersonbo.row.VERIFICA = Cursor_personbo.GetString("VERIFICA");
            mcPersonbo.row.NOTERIS = Cursor_personbo.GetString("NOTERIS");
            Cursor_personbo.Next();
          }
          m_cConnectivityError = Cursor_personbo.ErrorMessage();
          Cursor_personbo.Close();
          mcPersonbo.GoTop();
        } else { // Else
          // * --- Fill memory cursor mcPersonbo on qbe_personbo_all
          mcPersonbo.Zap();
          SPBridge.HMCaller _h000000D2;
          _h000000D2 = new SPBridge.HMCaller();
          _h000000D2.Set("m_cVQRList",m_cVQRList);
          _h000000D2.Set("pCDATOPE",w_cdadata);
          _h000000D2.Set("pCDATOPE1",w_c_adata);
          _h000000D2.Set("pCDATREG",w_cdareg);
          _h000000D2.Set("pCDATREG1",w_c_areg);
          _h000000D2.Set("tipoarchd",w_tipoarchd);
          _h000000D2.Set("tipoarchp",w_tipoarchp);
          _h000000D2.Set("flgope",w_flgope);
          _h000000D2.Set("flgfrz",w_flgfrz);
          if (Cursor_qbe_personbo_all!=null)
            Cursor_qbe_personbo_all.Close();
          Cursor_qbe_personbo_all = new VQRHolder("qbe_personbo_all",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h000000D2,true).GetResultSet(m_Ctx);
          {
            final CPResultSet m_TheCursor = Cursor_qbe_personbo_all;
            Cursor_qbe_personbo_all.ActionOnClose(new Runnable() {
              public void run() {
                if (CPLib.gt(m_TheCursor.CurrentRow()-1,2000000*1.1)) {
                  com.zucchetti.sitepainter.Logger info = com.zucchetti.sitepainter.Logger.getWarningLogger();
                  if ( ! (CPLib.IsNull(info))) {
                    info.log("Routine arrt_chkdiana_all: query on qbe_personbo_all returns "+(m_TheCursor.CurrentRow()-1)+" rows larger then the expected 2000000");
                  }
                }
              }
              });
          }
          while ( ! (Cursor_qbe_personbo_all.Eof())) {
            mcPersonbo.AppendWithTrimmedKey(CPLib.LRTrim(Cursor_qbe_personbo_all.GetString("CONNES")));
            mcPersonbo.row.CONNES = Cursor_qbe_personbo_all.GetString("CONNES");
            mcPersonbo.row.CODCAB = Cursor_qbe_personbo_all.GetString("CODCAB");
            mcPersonbo.row.RAGSOC = Cursor_qbe_personbo_all.GetString("RAGSOC");
            mcPersonbo.row.DOMICILIO = Cursor_qbe_personbo_all.GetString("DOMICILIO");
            mcPersonbo.row.CODFISC = Cursor_qbe_personbo_all.GetString("CODFISC");
            mcPersonbo.row.DATANASC = Cursor_qbe_personbo_all.GetDate("DATANASC");
            mcPersonbo.row.NASCOMUN = Cursor_qbe_personbo_all.GetString("NASCOMUN");
            mcPersonbo.row.SOTGRUP = Cursor_qbe_personbo_all.GetString("SOTGRUP");
            mcPersonbo.row.RAMOGRUP = Cursor_qbe_personbo_all.GetString("RAMOGRUP");
            mcPersonbo.row.SETTSINT = Cursor_qbe_personbo_all.GetString("SETTSINT");
            mcPersonbo.row.TIPODOC = Cursor_qbe_personbo_all.GetString("TIPODOC");
            mcPersonbo.row.NUMDOCUM = Cursor_qbe_personbo_all.GetString("NUMDOCUM");
            mcPersonbo.row.DATARILASC = Cursor_qbe_personbo_all.GetDate("DATARILASC");
            mcPersonbo.row.AUTRILASC = Cursor_qbe_personbo_all.GetString("AUTRILASC");
            mcPersonbo.row.DESCCIT = Cursor_qbe_personbo_all.GetString("DESCCIT");
            mcPersonbo.row.PROVINCIA = Cursor_qbe_personbo_all.GetString("PROVINCIA");
            mcPersonbo.row.PAESE = Cursor_qbe_personbo_all.GetString("PAESE");
            mcPersonbo.row.CAP = Cursor_qbe_personbo_all.GetString("CAP");
            mcPersonbo.row.CODINTER = Cursor_qbe_personbo_all.GetString("CODINTER");
            mcPersonbo.row.TIPINTER = Cursor_qbe_personbo_all.GetString("TIPINTER");
            mcPersonbo.row.TIPOPERS = Cursor_qbe_personbo_all.GetString("TIPOPERS");
            mcPersonbo.row.CODDIPE = Cursor_qbe_personbo_all.GetString("CODDIPE");
            mcPersonbo.row.PARTIVA = Cursor_qbe_personbo_all.GetString("PARTIVA");
            mcPersonbo.row.NOTE = Cursor_qbe_personbo_all.GetString("NOTE");
            mcPersonbo.row.SESSO = Cursor_qbe_personbo_all.GetString("SESSO");
            mcPersonbo.row.SOSPMAF = Cursor_qbe_personbo_all.GetString("SOSPMAF");
            mcPersonbo.row.idcitta = Cursor_qbe_personbo_all.GetString("idcitta");
            mcPersonbo.row.DATAVALI = Cursor_qbe_personbo_all.GetDate("DATAVALI");
            mcPersonbo.row.NASSTATO = Cursor_qbe_personbo_all.GetString("NASSTATO");
            mcPersonbo.row.DOCFILE = Cursor_qbe_personbo_all.GetString("DOCFILE");
            mcPersonbo.row.NOME = Cursor_qbe_personbo_all.GetString("NOME");
            mcPersonbo.row.COGNOME = Cursor_qbe_personbo_all.GetString("COGNOME");
            mcPersonbo.row.CFESTERO = Cursor_qbe_personbo_all.GetDouble("CFESTERO");
            mcPersonbo.row.OLDCONNES = Cursor_qbe_personbo_all.GetString("OLDCONNES");
            mcPersonbo.row.DATEXTRA = Cursor_qbe_personbo_all.GetDate("DATEXTRA");
            mcPersonbo.row.PKTBSPECIE = Cursor_qbe_personbo_all.GetString("PKTBSPECIE");
            mcPersonbo.row.COMPORT = Cursor_qbe_personbo_all.GetString("COMPORT");
            mcPersonbo.row.ATTIV = Cursor_qbe_personbo_all.GetString("ATTIV");
            mcPersonbo.row.RNATGIU = Cursor_qbe_personbo_all.GetDouble("RNATGIU");
            mcPersonbo.row.RATTIV = Cursor_qbe_personbo_all.GetDouble("RATTIV");
            mcPersonbo.row.RCOMP = Cursor_qbe_personbo_all.GetDouble("RCOMP");
            mcPersonbo.row.RAREA = Cursor_qbe_personbo_all.GetDouble("RAREA");
            mcPersonbo.row.ALLINEATO = Cursor_qbe_personbo_all.GetDouble("ALLINEATO");
            mcPersonbo.row.ALLINEATONOMECNOME = Cursor_qbe_personbo_all.GetDouble("ALLINEATONOMECNOME");
            mcPersonbo.row.RAGSOCOLD = Cursor_qbe_personbo_all.GetString("RAGSOCOLD");
            mcPersonbo.row.PROGIMPORT = Cursor_qbe_personbo_all.GetDouble("PROGIMPORT");
            mcPersonbo.row.PROGIMP_C = Cursor_qbe_personbo_all.GetString("PROGIMP_C");
            mcPersonbo.row.AREAGEO = Cursor_qbe_personbo_all.GetString("AREAGEO");
            mcPersonbo.row.PEP = Cursor_qbe_personbo_all.GetString("PEP");
            mcPersonbo.row.IDFILE = Cursor_qbe_personbo_all.GetString("IDFILE");
            mcPersonbo.row.OLDCODFISC = Cursor_qbe_personbo_all.GetString("OLDCODFISC");
            mcPersonbo.row.MACROAGENTE = Cursor_qbe_personbo_all.GetString("MACROAGENTE");
            mcPersonbo.row.SPOTID = Cursor_qbe_personbo_all.GetString("SPOTID");
            mcPersonbo.row.DATASEGN = Cursor_qbe_personbo_all.GetDate("DATASEGN");
            mcPersonbo.row.OLDSETSIN = Cursor_qbe_personbo_all.GetString("OLDSETSIN");
            mcPersonbo.row.DATAVARAGE = Cursor_qbe_personbo_all.GetDate("DATAVARAGE");
            mcPersonbo.row.SETTSINT2 = Cursor_qbe_personbo_all.GetString("SETTSINT2");
            mcPersonbo.row.FATCA = Cursor_qbe_personbo_all.GetString("FATCA");
            mcPersonbo.row.BANCABEN = Cursor_qbe_personbo_all.GetString("BANCABEN");
            mcPersonbo.row.TIN = Cursor_qbe_personbo_all.GetString("TIN");
            mcPersonbo.row.ODB = Cursor_qbe_personbo_all.GetDouble("ODB");
            mcPersonbo.row.TELEF = Cursor_qbe_personbo_all.GetString("TELEF");
            mcPersonbo.row.TIPOORO = Cursor_qbe_personbo_all.GetString("TIPOORO");
            mcPersonbo.row.CODORO = Cursor_qbe_personbo_all.GetString("CODORO");
            mcPersonbo.row.IDNASCOMUN = Cursor_qbe_personbo_all.GetString("IDNASCOMUN");
            mcPersonbo.row.IDNASSTATO = Cursor_qbe_personbo_all.GetString("IDNASSTATO");
            mcPersonbo.row.NOTIT = Cursor_qbe_personbo_all.GetDouble("NOTIT");
            mcPersonbo.row.IDBASE = Cursor_qbe_personbo_all.GetString("IDBASE");
            mcPersonbo.row.FLGVALIDO = Cursor_qbe_personbo_all.GetString("FLGVALIDO");
            mcPersonbo.row.CITTADIN1 = Cursor_qbe_personbo_all.GetString("CITTADIN1");
            mcPersonbo.row.CITTADIN2 = Cursor_qbe_personbo_all.GetString("CITTADIN2");
            mcPersonbo.row.RESFISC = Cursor_qbe_personbo_all.GetString("RESFISC");
            mcPersonbo.row.MITIG = Cursor_qbe_personbo_all.GetDouble("MITIG");
            mcPersonbo.row.MITIGDOC = Cursor_qbe_personbo_all.GetString("MITIGDOC");
            mcPersonbo.row.NOSARA = Cursor_qbe_personbo_all.GetString("NOSARA");
            mcPersonbo.row.RISGLOB = Cursor_qbe_personbo_all.GetString("RISGLOB");
            mcPersonbo.row.DATAPROF = Cursor_qbe_personbo_all.GetDate("DATAPROF");
            mcPersonbo.row.DATAREVPROF = Cursor_qbe_personbo_all.GetDate("DATAREVPROF");
            mcPersonbo.row.IDENT = Cursor_qbe_personbo_all.GetString("IDENT");
            mcPersonbo.row.PEPDATE = Cursor_qbe_personbo_all.GetDate("PEPDATE");
            mcPersonbo.row.DAC6 = Cursor_qbe_personbo_all.GetString("DAC6");
            mcPersonbo.row.FLAGDAC6 = Cursor_qbe_personbo_all.GetDouble("FLAGDAC6");
            mcPersonbo.row.CRIME = Cursor_qbe_personbo_all.GetString("CRIME");
            mcPersonbo.row.CRIMEDATE = Cursor_qbe_personbo_all.GetDate("CRIMEDATE");
            mcPersonbo.row.ALTRODOM = Cursor_qbe_personbo_all.GetString("ALTRODOM");
            mcPersonbo.row.ALTROCAP = Cursor_qbe_personbo_all.GetString("ALTROCAP");
            mcPersonbo.row.CONTO = Cursor_qbe_personbo_all.GetString("CONTO");
            mcPersonbo.row.NUMIMP = Cursor_qbe_personbo_all.GetDateTime("NUMIMP");
            mcPersonbo.row.RAPSEGNA = Cursor_qbe_personbo_all.GetString("RAPSEGNA");
            mcPersonbo.row.CODLEGRAP = Cursor_qbe_personbo_all.GetString("CODLEGRAP");
            mcPersonbo.row.TIPOSOGGETTO = Cursor_qbe_personbo_all.GetString("TIPOSOGGETTO");
            mcPersonbo.row.CAUSALE = Cursor_qbe_personbo_all.GetDouble("CAUSALE");
            mcPersonbo.row.IMPORTOMAX = Cursor_qbe_personbo_all.GetDouble("IMPORTOMAX");
            mcPersonbo.row.FATTURATO = Cursor_qbe_personbo_all.GetDouble("FATTURATO");
            mcPersonbo.row.FREQUENZA = Cursor_qbe_personbo_all.GetString("FREQUENZA");
            mcPersonbo.row.NUMOPERAZ = Cursor_qbe_personbo_all.GetDouble("NUMOPERAZ");
            mcPersonbo.row.SOGAFFIDATARIO = Cursor_qbe_personbo_all.GetString("SOGAFFIDATARIO");
            mcPersonbo.row.FLGNOTRIM = Cursor_qbe_personbo_all.GetString("FLGNOTRIM");
            mcPersonbo.row.DISATTIVO = Cursor_qbe_personbo_all.GetDate("DISATTIVO");
            mcPersonbo.row.DATAFINE = Cursor_qbe_personbo_all.GetDate("DATAFINE");
            mcPersonbo.row.DATAINI = Cursor_qbe_personbo_all.GetDate("DATAINI");
            mcPersonbo.row.DATAIDENT = Cursor_qbe_personbo_all.GetDate("DATAIDENT");
            mcPersonbo.row.DATASIGN = Cursor_qbe_personbo_all.GetDate("DATASIGN");
            mcPersonbo.row.DATARAUT = Cursor_qbe_personbo_all.GetDate("DATARAUT");
            mcPersonbo.row.VERIFICA = Cursor_qbe_personbo_all.GetString("VERIFICA");
            mcPersonbo.row.NOTERIS = Cursor_qbe_personbo_all.GetString("NOTERIS");
            Cursor_qbe_personbo_all.Next();
          }
          m_cConnectivityError = Cursor_qbe_personbo_all.ErrorMessage();
          Cursor_qbe_personbo_all.Close();
          mcPersonbo.GoTop();
        } // End If
        /* gMsgProc := gMsgProc + 'Ora Fine Creazione Lista Soggetti: '+ arfn_fdatetime(DateTime()) + NL */
        gMsgProc = gMsgProc+"Ora Fine Creazione Lista Soggetti: "+arfn_fdatetimeR.Make(m_Ctx,this).Run(CPLib.DateTime())+"\n";
        m_Ctx.SetGlobalString("gMsgProc",gMsgProc);
        /* gMsgProc := gMsgProc + 'Ora Inizio Creazione Storico Lista Soggetti: '+ arfn_fdatetime(DateTime()) + NL */
        gMsgProc = gMsgProc+"Ora Inizio Creazione Storico Lista Soggetti: "+arfn_fdatetimeR.Make(m_Ctx,this).Run(CPLib.DateTime())+"\n";
        m_Ctx.SetGlobalString("gMsgProc",gMsgProc);
        /* If not(Empty(LRTrim(w_codcli))) */
        if ( ! (CPLib.Empty(CPLib.LRTrim(w_codcli)))) {
          // * --- Fill memory cursor mcWersonbo on wersonbo
          mcWersonbo.Zap();
          m_cServer = m_Ctx.GetServer("wersonbo");
          m_cPhName = m_Ctx.GetPhName("wersonbo");
          if (Cursor_wersonbo!=null)
            Cursor_wersonbo.Close();
          Cursor_wersonbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CONNES="+CPSql.SQLValueAdapter(CPLib.ToSQL(w_codcli,"?",0,0,m_cServer, m_oParameters),m_cServer,w_codcli)+" "+")"+(m_Ctx.IsSharedTemp("wersonbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1")+" order by "+"CONNES,datamodi,sanumpro ",m_cServer,m_Ctx,true));
          {
            final CPResultSet m_TheCursor = Cursor_wersonbo;
            Cursor_wersonbo.ActionOnClose(new Runnable() {
              public void run() {
                if (CPLib.gt(m_TheCursor.CurrentRow()-1,2000000*1.1)) {
                  com.zucchetti.sitepainter.Logger info = com.zucchetti.sitepainter.Logger.getWarningLogger();
                  if ( ! (CPLib.IsNull(info))) {
                    info.log("Routine arrt_chkdiana_all: query on wersonbo returns "+(m_TheCursor.CurrentRow()-1)+" rows larger then the expected 2000000");
                  }
                }
              }
              });
          }
          while ( ! (Cursor_wersonbo.Eof())) {
            mcWersonbo.AppendWithTrimmedKey(Cursor_wersonbo.GetString("sanumpro"));
            mcWersonbo.row.sanumpro = Cursor_wersonbo.GetString("sanumpro");
            mcWersonbo.row.CONNES = Cursor_wersonbo.GetString("CONNES");
            mcWersonbo.row.CODCAB = Cursor_wersonbo.GetString("CODCAB");
            mcWersonbo.row.RAGSOC = Cursor_wersonbo.GetString("RAGSOC");
            mcWersonbo.row.DOMICILIO = Cursor_wersonbo.GetString("DOMICILIO");
            mcWersonbo.row.CODFISC = Cursor_wersonbo.GetString("CODFISC");
            mcWersonbo.row.DATANASC = Cursor_wersonbo.GetDate("DATANASC");
            mcWersonbo.row.NASCOMUN = Cursor_wersonbo.GetString("NASCOMUN");
            mcWersonbo.row.SOTGRUP = Cursor_wersonbo.GetString("SOTGRUP");
            mcWersonbo.row.RAMOGRUP = Cursor_wersonbo.GetString("RAMOGRUP");
            mcWersonbo.row.SETTSINT = Cursor_wersonbo.GetString("SETTSINT");
            mcWersonbo.row.TIPODOC = Cursor_wersonbo.GetString("TIPODOC");
            mcWersonbo.row.NUMDOCUM = Cursor_wersonbo.GetString("NUMDOCUM");
            mcWersonbo.row.DATARILASC = Cursor_wersonbo.GetDate("DATARILASC");
            mcWersonbo.row.AUTRILASC = Cursor_wersonbo.GetString("AUTRILASC");
            mcWersonbo.row.DESCCIT = Cursor_wersonbo.GetString("DESCCIT");
            mcWersonbo.row.PROVINCIA = Cursor_wersonbo.GetString("PROVINCIA");
            mcWersonbo.row.PAESE = Cursor_wersonbo.GetString("PAESE");
            mcWersonbo.row.CAP = Cursor_wersonbo.GetString("CAP");
            mcWersonbo.row.CODINTER = Cursor_wersonbo.GetString("CODINTER");
            mcWersonbo.row.TIPINTER = Cursor_wersonbo.GetString("TIPINTER");
            mcWersonbo.row.TIPOPERS = Cursor_wersonbo.GetString("TIPOPERS");
            mcWersonbo.row.CODDIPE = Cursor_wersonbo.GetString("CODDIPE");
            mcWersonbo.row.PARTIVA = Cursor_wersonbo.GetString("PARTIVA");
            mcWersonbo.row.NOTE = Cursor_wersonbo.GetString("NOTE");
            mcWersonbo.row.SESSO = Cursor_wersonbo.GetString("SESSO");
            mcWersonbo.row.SOSPMAF = Cursor_wersonbo.GetString("SOSPMAF");
            mcWersonbo.row.idcitta = Cursor_wersonbo.GetString("idcitta");
            mcWersonbo.row.DATAVALI = Cursor_wersonbo.GetDate("DATAVALI");
            mcWersonbo.row.NASSTATO = Cursor_wersonbo.GetString("NASSTATO");
            mcWersonbo.row.DOCFILE = Cursor_wersonbo.GetString("DOCFILE");
            mcWersonbo.row.NOME = Cursor_wersonbo.GetString("NOME");
            mcWersonbo.row.COGNOME = Cursor_wersonbo.GetString("COGNOME");
            mcWersonbo.row.CFESTERO = Cursor_wersonbo.GetDouble("CFESTERO");
            mcWersonbo.row.OLDCONNES = Cursor_wersonbo.GetString("OLDCONNES");
            mcWersonbo.row.DATEXTRA = Cursor_wersonbo.GetDate("DATEXTRA");
            mcWersonbo.row.PKTBSPECIE = Cursor_wersonbo.GetString("PKTBSPECIE");
            mcWersonbo.row.COMPORT = Cursor_wersonbo.GetString("COMPORT");
            mcWersonbo.row.ATTIV = Cursor_wersonbo.GetString("ATTIV");
            mcWersonbo.row.RNATGIU = Cursor_wersonbo.GetDouble("RNATGIU");
            mcWersonbo.row.RATTIV = Cursor_wersonbo.GetDouble("RATTIV");
            mcWersonbo.row.RCOMP = Cursor_wersonbo.GetDouble("RCOMP");
            mcWersonbo.row.RAREA = Cursor_wersonbo.GetDouble("RAREA");
            mcWersonbo.row.ALLINEATO = Cursor_wersonbo.GetDouble("ALLINEATO");
            mcWersonbo.row.ALLINEATONOMECNOME = Cursor_wersonbo.GetDouble("ALLINEATONOMECNOME");
            mcWersonbo.row.RAGSOCOLD = Cursor_wersonbo.GetString("RAGSOCOLD");
            mcWersonbo.row.PROGIMPORT = Cursor_wersonbo.GetDouble("PROGIMPORT");
            mcWersonbo.row.PROGIMP_C = Cursor_wersonbo.GetString("PROGIMP_C");
            mcWersonbo.row.AREAGEO = Cursor_wersonbo.GetString("AREAGEO");
            mcWersonbo.row.datamodi = Cursor_wersonbo.GetDate("datamodi");
            mcWersonbo.row.PEP = Cursor_wersonbo.GetString("PEP");
            mcWersonbo.row.IDFILE = Cursor_wersonbo.GetString("IDFILE");
            mcWersonbo.row.OLDCODFISC = Cursor_wersonbo.GetString("OLDCODFISC");
            mcWersonbo.row.MACROAGENTE = Cursor_wersonbo.GetString("MACROAGENTE");
            mcWersonbo.row.SPOTID = Cursor_wersonbo.GetString("SPOTID");
            mcWersonbo.row.DATASEGN = Cursor_wersonbo.GetDate("DATASEGN");
            mcWersonbo.row.OLDSETSIN = Cursor_wersonbo.GetString("OLDSETSIN");
            mcWersonbo.row.DATAVARAGE = Cursor_wersonbo.GetDate("DATAVARAGE");
            mcWersonbo.row.SETTSINT2 = Cursor_wersonbo.GetString("SETTSINT2");
            mcWersonbo.row.FATCA = Cursor_wersonbo.GetString("FATCA");
            mcWersonbo.row.BANCABEN = Cursor_wersonbo.GetString("BANCABEN");
            mcWersonbo.row.TIN = Cursor_wersonbo.GetString("TIN");
            mcWersonbo.row.ODB = Cursor_wersonbo.GetDouble("ODB");
            mcWersonbo.row.TELEF = Cursor_wersonbo.GetString("TELEF");
            mcWersonbo.row.TIPOORO = Cursor_wersonbo.GetString("TIPOORO");
            mcWersonbo.row.CODORO = Cursor_wersonbo.GetString("CODORO");
            mcWersonbo.row.IDNASCOMUN = Cursor_wersonbo.GetString("IDNASCOMUN");
            mcWersonbo.row.IDNASSTATO = Cursor_wersonbo.GetString("IDNASSTATO");
            mcWersonbo.row.NOTIT = Cursor_wersonbo.GetDouble("NOTIT");
            mcWersonbo.row.IDBASE = Cursor_wersonbo.GetString("IDBASE");
            mcWersonbo.row.FLGVALIDO = Cursor_wersonbo.GetString("FLGVALIDO");
            mcWersonbo.row.CITTADIN1 = Cursor_wersonbo.GetString("CITTADIN1");
            mcWersonbo.row.CITTADIN2 = Cursor_wersonbo.GetString("CITTADIN2");
            mcWersonbo.row.RESFISC = Cursor_wersonbo.GetString("RESFISC");
            mcWersonbo.row.MITIG = Cursor_wersonbo.GetDouble("MITIG");
            mcWersonbo.row.MITGDOC = Cursor_wersonbo.GetString("MITGDOC");
            mcWersonbo.row.NOSARA = Cursor_wersonbo.GetString("NOSARA");
            mcWersonbo.row.RISGLOB = Cursor_wersonbo.GetString("RISGLOB");
            mcWersonbo.row.DATAPROF = Cursor_wersonbo.GetDate("DATAPROF");
            mcWersonbo.row.DATAREVPROF = Cursor_wersonbo.GetDate("DATAREVPROF");
            mcWersonbo.row.IDENT = Cursor_wersonbo.GetString("IDENT");
            mcWersonbo.row.PEPDATE = Cursor_wersonbo.GetDate("PEPDATE");
            mcWersonbo.row.DAC6 = Cursor_wersonbo.GetString("DAC6");
            mcWersonbo.row.FLAGDAC6 = Cursor_wersonbo.GetDouble("FLAGDAC6");
            mcWersonbo.row.CRIME = Cursor_wersonbo.GetString("CRIME");
            mcWersonbo.row.CRIMEDATE = Cursor_wersonbo.GetDate("CRIMEDATE");
            mcWersonbo.row.ALTRODOM = Cursor_wersonbo.GetString("ALTRODOM");
            mcWersonbo.row.ALTROCAP = Cursor_wersonbo.GetString("ALTROCAP");
            mcWersonbo.row.CONTO = Cursor_wersonbo.GetString("CONTO");
            mcWersonbo.row.NUMIMP = Cursor_wersonbo.GetDateTime("NUMIMP");
            mcWersonbo.row.RAPSEGNA = Cursor_wersonbo.GetString("RAPSEGNA");
            mcWersonbo.row.CODLEGRAP = Cursor_wersonbo.GetString("CODLEGRAP");
            mcWersonbo.row.TIPOSOGGETTO = Cursor_wersonbo.GetString("TIPOSOGGETTO");
            mcWersonbo.row.CAUSALE = Cursor_wersonbo.GetDouble("CAUSALE");
            mcWersonbo.row.IMPORTOMAX = Cursor_wersonbo.GetDouble("IMPORTOMAX");
            mcWersonbo.row.FATTURATO = Cursor_wersonbo.GetDouble("FATTURATO");
            mcWersonbo.row.FREQUENZA = Cursor_wersonbo.GetString("FREQUENZA");
            mcWersonbo.row.NUMOPERAZ = Cursor_wersonbo.GetDouble("NUMOPERAZ");
            mcWersonbo.row.SOGAFFIDATARIO = Cursor_wersonbo.GetString("SOGAFFIDATARIO");
            mcWersonbo.row.FLGNOTRIM = Cursor_wersonbo.GetString("FLGNOTRIM");
            mcWersonbo.row.DISATTIVO = Cursor_wersonbo.GetDate("DISATTIVO");
            mcWersonbo.row.DATAFINE = Cursor_wersonbo.GetDate("DATAFINE");
            mcWersonbo.row.DATAINI = Cursor_wersonbo.GetDate("DATAINI");
            mcWersonbo.row.DATAIDENT = Cursor_wersonbo.GetDate("DATAIDENT");
            mcWersonbo.row.DATASIGN = Cursor_wersonbo.GetDate("DATASIGN");
            mcWersonbo.row.DATARAUT = Cursor_wersonbo.GetDate("DATARAUT");
            mcWersonbo.row.VERIFICA = Cursor_wersonbo.GetString("VERIFICA");
            mcWersonbo.row.NOTERIS = Cursor_wersonbo.GetString("NOTERIS");
            Cursor_wersonbo.Next();
          }
          m_cConnectivityError = Cursor_wersonbo.ErrorMessage();
          Cursor_wersonbo.Close();
          mcWersonbo.GoTop();
        } else { // Else
          // * --- Fill memory cursor mcWersonbo on qbe_wersonbo_all
          mcWersonbo.Zap();
          SPBridge.HMCaller _h000000D7;
          _h000000D7 = new SPBridge.HMCaller();
          _h000000D7.Set("m_cVQRList",m_cVQRList);
          _h000000D7.Set("pCDATOPE",w_cdadata);
          _h000000D7.Set("pCDATOPE1",w_c_adata);
          _h000000D7.Set("pCDATREG",w_cdareg);
          _h000000D7.Set("pCDATREG1",w_c_areg);
          _h000000D7.Set("tipoarchd",w_tipoarchd);
          _h000000D7.Set("tipoarchp",w_tipoarchp);
          _h000000D7.Set("flgope",w_flgope);
          _h000000D7.Set("flgfrz",w_flgfrz);
          _h000000D7.Set("DaData",(CPLib.Empty(w_DaData) || CPLib.eqr(CPLib.DateToChar(w_DaData),"01000101")?CPLib.NullDate():w_DaData));
          _h000000D7.Set("DaDataReg",(CPLib.Empty(w_DaDataReg) || CPLib.eqr(CPLib.DateToChar(w_DaDataReg),"01000101")?CPLib.NullDate():w_DaDataReg));
          if (Cursor_qbe_wersonbo_all!=null)
            Cursor_qbe_wersonbo_all.Close();
          Cursor_qbe_wersonbo_all = new VQRHolder("qbe_wersonbo_all",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h000000D7,true).GetResultSet(m_Ctx);
          {
            final CPResultSet m_TheCursor = Cursor_qbe_wersonbo_all;
            Cursor_qbe_wersonbo_all.ActionOnClose(new Runnable() {
              public void run() {
                if (CPLib.gt(m_TheCursor.CurrentRow()-1,2000000*1.1)) {
                  com.zucchetti.sitepainter.Logger info = com.zucchetti.sitepainter.Logger.getWarningLogger();
                  if ( ! (CPLib.IsNull(info))) {
                    info.log("Routine arrt_chkdiana_all: query on qbe_wersonbo_all returns "+(m_TheCursor.CurrentRow()-1)+" rows larger then the expected 2000000");
                  }
                }
              }
              });
          }
          while ( ! (Cursor_qbe_wersonbo_all.Eof())) {
            mcWersonbo.AppendWithTrimmedKey(Cursor_qbe_wersonbo_all.GetString("sanumpro"));
            mcWersonbo.row.sanumpro = Cursor_qbe_wersonbo_all.GetString("sanumpro");
            mcWersonbo.row.CONNES = Cursor_qbe_wersonbo_all.GetString("CONNES");
            mcWersonbo.row.CODCAB = Cursor_qbe_wersonbo_all.GetString("CODCAB");
            mcWersonbo.row.RAGSOC = Cursor_qbe_wersonbo_all.GetString("RAGSOC");
            mcWersonbo.row.DOMICILIO = Cursor_qbe_wersonbo_all.GetString("DOMICILIO");
            mcWersonbo.row.CODFISC = Cursor_qbe_wersonbo_all.GetString("CODFISC");
            mcWersonbo.row.DATANASC = Cursor_qbe_wersonbo_all.GetDate("DATANASC");
            mcWersonbo.row.NASCOMUN = Cursor_qbe_wersonbo_all.GetString("NASCOMUN");
            mcWersonbo.row.SOTGRUP = Cursor_qbe_wersonbo_all.GetString("SOTGRUP");
            mcWersonbo.row.RAMOGRUP = Cursor_qbe_wersonbo_all.GetString("RAMOGRUP");
            mcWersonbo.row.SETTSINT = Cursor_qbe_wersonbo_all.GetString("SETTSINT");
            mcWersonbo.row.TIPODOC = Cursor_qbe_wersonbo_all.GetString("TIPODOC");
            mcWersonbo.row.NUMDOCUM = Cursor_qbe_wersonbo_all.GetString("NUMDOCUM");
            mcWersonbo.row.DATARILASC = Cursor_qbe_wersonbo_all.GetDate("DATARILASC");
            mcWersonbo.row.AUTRILASC = Cursor_qbe_wersonbo_all.GetString("AUTRILASC");
            mcWersonbo.row.DESCCIT = Cursor_qbe_wersonbo_all.GetString("DESCCIT");
            mcWersonbo.row.PROVINCIA = Cursor_qbe_wersonbo_all.GetString("PROVINCIA");
            mcWersonbo.row.PAESE = Cursor_qbe_wersonbo_all.GetString("PAESE");
            mcWersonbo.row.CAP = Cursor_qbe_wersonbo_all.GetString("CAP");
            mcWersonbo.row.CODINTER = Cursor_qbe_wersonbo_all.GetString("CODINTER");
            mcWersonbo.row.TIPINTER = Cursor_qbe_wersonbo_all.GetString("TIPINTER");
            mcWersonbo.row.TIPOPERS = Cursor_qbe_wersonbo_all.GetString("TIPOPERS");
            mcWersonbo.row.CODDIPE = Cursor_qbe_wersonbo_all.GetString("CODDIPE");
            mcWersonbo.row.PARTIVA = Cursor_qbe_wersonbo_all.GetString("PARTIVA");
            mcWersonbo.row.NOTE = Cursor_qbe_wersonbo_all.GetString("NOTE");
            mcWersonbo.row.SESSO = Cursor_qbe_wersonbo_all.GetString("SESSO");
            mcWersonbo.row.SOSPMAF = Cursor_qbe_wersonbo_all.GetString("SOSPMAF");
            mcWersonbo.row.idcitta = Cursor_qbe_wersonbo_all.GetString("idcitta");
            mcWersonbo.row.DATAVALI = Cursor_qbe_wersonbo_all.GetDate("DATAVALI");
            mcWersonbo.row.NASSTATO = Cursor_qbe_wersonbo_all.GetString("NASSTATO");
            mcWersonbo.row.DOCFILE = Cursor_qbe_wersonbo_all.GetString("DOCFILE");
            mcWersonbo.row.NOME = Cursor_qbe_wersonbo_all.GetString("NOME");
            mcWersonbo.row.COGNOME = Cursor_qbe_wersonbo_all.GetString("COGNOME");
            mcWersonbo.row.CFESTERO = Cursor_qbe_wersonbo_all.GetDouble("CFESTERO");
            mcWersonbo.row.OLDCONNES = Cursor_qbe_wersonbo_all.GetString("OLDCONNES");
            mcWersonbo.row.DATEXTRA = Cursor_qbe_wersonbo_all.GetDate("DATEXTRA");
            mcWersonbo.row.PKTBSPECIE = Cursor_qbe_wersonbo_all.GetString("PKTBSPECIE");
            mcWersonbo.row.COMPORT = Cursor_qbe_wersonbo_all.GetString("COMPORT");
            mcWersonbo.row.ATTIV = Cursor_qbe_wersonbo_all.GetString("ATTIV");
            mcWersonbo.row.RNATGIU = Cursor_qbe_wersonbo_all.GetDouble("RNATGIU");
            mcWersonbo.row.RATTIV = Cursor_qbe_wersonbo_all.GetDouble("RATTIV");
            mcWersonbo.row.RCOMP = Cursor_qbe_wersonbo_all.GetDouble("RCOMP");
            mcWersonbo.row.RAREA = Cursor_qbe_wersonbo_all.GetDouble("RAREA");
            mcWersonbo.row.ALLINEATO = Cursor_qbe_wersonbo_all.GetDouble("ALLINEATO");
            mcWersonbo.row.ALLINEATONOMECNOME = Cursor_qbe_wersonbo_all.GetDouble("ALLINEATONOMECNOME");
            mcWersonbo.row.RAGSOCOLD = Cursor_qbe_wersonbo_all.GetString("RAGSOCOLD");
            mcWersonbo.row.PROGIMPORT = Cursor_qbe_wersonbo_all.GetDouble("PROGIMPORT");
            mcWersonbo.row.PROGIMP_C = Cursor_qbe_wersonbo_all.GetString("PROGIMP_C");
            mcWersonbo.row.AREAGEO = Cursor_qbe_wersonbo_all.GetString("AREAGEO");
            mcWersonbo.row.datamodi = Cursor_qbe_wersonbo_all.GetDate("datamodi");
            mcWersonbo.row.PEP = Cursor_qbe_wersonbo_all.GetString("PEP");
            mcWersonbo.row.IDFILE = Cursor_qbe_wersonbo_all.GetString("IDFILE");
            mcWersonbo.row.OLDCODFISC = Cursor_qbe_wersonbo_all.GetString("OLDCODFISC");
            mcWersonbo.row.MACROAGENTE = Cursor_qbe_wersonbo_all.GetString("MACROAGENTE");
            mcWersonbo.row.SPOTID = Cursor_qbe_wersonbo_all.GetString("SPOTID");
            mcWersonbo.row.DATASEGN = Cursor_qbe_wersonbo_all.GetDate("DATASEGN");
            mcWersonbo.row.OLDSETSIN = Cursor_qbe_wersonbo_all.GetString("OLDSETSIN");
            mcWersonbo.row.DATAVARAGE = Cursor_qbe_wersonbo_all.GetDate("DATAVARAGE");
            mcWersonbo.row.SETTSINT2 = Cursor_qbe_wersonbo_all.GetString("SETTSINT2");
            mcWersonbo.row.FATCA = Cursor_qbe_wersonbo_all.GetString("FATCA");
            mcWersonbo.row.BANCABEN = Cursor_qbe_wersonbo_all.GetString("BANCABEN");
            mcWersonbo.row.TIN = Cursor_qbe_wersonbo_all.GetString("TIN");
            mcWersonbo.row.ODB = Cursor_qbe_wersonbo_all.GetDouble("ODB");
            mcWersonbo.row.TELEF = Cursor_qbe_wersonbo_all.GetString("TELEF");
            mcWersonbo.row.TIPOORO = Cursor_qbe_wersonbo_all.GetString("TIPOORO");
            mcWersonbo.row.CODORO = Cursor_qbe_wersonbo_all.GetString("CODORO");
            mcWersonbo.row.IDNASCOMUN = Cursor_qbe_wersonbo_all.GetString("IDNASCOMUN");
            mcWersonbo.row.IDNASSTATO = Cursor_qbe_wersonbo_all.GetString("IDNASSTATO");
            mcWersonbo.row.NOTIT = Cursor_qbe_wersonbo_all.GetDouble("NOTIT");
            mcWersonbo.row.IDBASE = Cursor_qbe_wersonbo_all.GetString("IDBASE");
            mcWersonbo.row.FLGVALIDO = Cursor_qbe_wersonbo_all.GetString("FLGVALIDO");
            mcWersonbo.row.CITTADIN1 = Cursor_qbe_wersonbo_all.GetString("CITTADIN1");
            mcWersonbo.row.CITTADIN2 = Cursor_qbe_wersonbo_all.GetString("CITTADIN2");
            mcWersonbo.row.RESFISC = Cursor_qbe_wersonbo_all.GetString("RESFISC");
            mcWersonbo.row.MITIG = Cursor_qbe_wersonbo_all.GetDouble("MITIG");
            mcWersonbo.row.MITGDOC = Cursor_qbe_wersonbo_all.GetString("MITGDOC");
            mcWersonbo.row.NOSARA = Cursor_qbe_wersonbo_all.GetString("NOSARA");
            mcWersonbo.row.RISGLOB = Cursor_qbe_wersonbo_all.GetString("RISGLOB");
            mcWersonbo.row.DATAPROF = Cursor_qbe_wersonbo_all.GetDate("DATAPROF");
            mcWersonbo.row.DATAREVPROF = Cursor_qbe_wersonbo_all.GetDate("DATAREVPROF");
            mcWersonbo.row.IDENT = Cursor_qbe_wersonbo_all.GetString("IDENT");
            mcWersonbo.row.PEPDATE = Cursor_qbe_wersonbo_all.GetDate("PEPDATE");
            mcWersonbo.row.DAC6 = Cursor_qbe_wersonbo_all.GetString("DAC6");
            mcWersonbo.row.FLAGDAC6 = Cursor_qbe_wersonbo_all.GetDouble("FLAGDAC6");
            mcWersonbo.row.CRIME = Cursor_qbe_wersonbo_all.GetString("CRIME");
            mcWersonbo.row.CRIMEDATE = Cursor_qbe_wersonbo_all.GetDate("CRIMEDATE");
            mcWersonbo.row.ALTRODOM = Cursor_qbe_wersonbo_all.GetString("ALTRODOM");
            mcWersonbo.row.ALTROCAP = Cursor_qbe_wersonbo_all.GetString("ALTROCAP");
            mcWersonbo.row.CONTO = Cursor_qbe_wersonbo_all.GetString("CONTO");
            mcWersonbo.row.NUMIMP = Cursor_qbe_wersonbo_all.GetDateTime("NUMIMP");
            mcWersonbo.row.RAPSEGNA = Cursor_qbe_wersonbo_all.GetString("RAPSEGNA");
            mcWersonbo.row.CODLEGRAP = Cursor_qbe_wersonbo_all.GetString("CODLEGRAP");
            mcWersonbo.row.TIPOSOGGETTO = Cursor_qbe_wersonbo_all.GetString("TIPOSOGGETTO");
            mcWersonbo.row.CAUSALE = Cursor_qbe_wersonbo_all.GetDouble("CAUSALE");
            mcWersonbo.row.IMPORTOMAX = Cursor_qbe_wersonbo_all.GetDouble("IMPORTOMAX");
            mcWersonbo.row.FATTURATO = Cursor_qbe_wersonbo_all.GetDouble("FATTURATO");
            mcWersonbo.row.FREQUENZA = Cursor_qbe_wersonbo_all.GetString("FREQUENZA");
            mcWersonbo.row.NUMOPERAZ = Cursor_qbe_wersonbo_all.GetDouble("NUMOPERAZ");
            mcWersonbo.row.SOGAFFIDATARIO = Cursor_qbe_wersonbo_all.GetString("SOGAFFIDATARIO");
            mcWersonbo.row.FLGNOTRIM = Cursor_qbe_wersonbo_all.GetString("FLGNOTRIM");
            mcWersonbo.row.DISATTIVO = Cursor_qbe_wersonbo_all.GetDate("DISATTIVO");
            mcWersonbo.row.DATAFINE = Cursor_qbe_wersonbo_all.GetDate("DATAFINE");
            mcWersonbo.row.DATAINI = Cursor_qbe_wersonbo_all.GetDate("DATAINI");
            mcWersonbo.row.DATAIDENT = Cursor_qbe_wersonbo_all.GetDate("DATAIDENT");
            mcWersonbo.row.DATASIGN = Cursor_qbe_wersonbo_all.GetDate("DATASIGN");
            mcWersonbo.row.DATARAUT = Cursor_qbe_wersonbo_all.GetDate("DATARAUT");
            mcWersonbo.row.VERIFICA = Cursor_qbe_wersonbo_all.GetString("VERIFICA");
            mcWersonbo.row.NOTERIS = Cursor_qbe_wersonbo_all.GetString("NOTERIS");
            Cursor_qbe_wersonbo_all.Next();
          }
          m_cConnectivityError = Cursor_qbe_wersonbo_all.ErrorMessage();
          Cursor_qbe_wersonbo_all.Close();
          mcWersonbo.GoTop();
        } // End If
        /* gMsgProc := gMsgProc + 'Ora Fine Creazione Storico Lista Soggetti: '+ arfn_fdatetime(DateTime()) + NL */
        gMsgProc = gMsgProc+"Ora Fine Creazione Storico Lista Soggetti: "+arfn_fdatetimeR.Make(m_Ctx,this).Run(CPLib.DateTime())+"\n";
        m_Ctx.SetGlobalString("gMsgProc",gMsgProc);
      } // End If
      // * --- Fill memory cursor mcStgru on tbstgru
      mcStgru.Zap();
      m_cServer = m_Ctx.GetServer("tbstgru");
      m_cPhName = m_Ctx.GetPhName("tbstgru");
      if (Cursor_tbstgru!=null)
        Cursor_tbstgru.Close();
      Cursor_tbstgru = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+(m_Ctx.IsSharedTemp("tbstgru")?"context_id='"+m_Ctx.GetTempID()+"'":"1=1"),m_cServer,m_Ctx,true));
      {
        final CPResultSet m_TheCursor = Cursor_tbstgru;
        Cursor_tbstgru.ActionOnClose(new Runnable() {
          public void run() {
            if (CPLib.gt(m_TheCursor.CurrentRow()-1,1000*1.1)) {
              com.zucchetti.sitepainter.Logger info = com.zucchetti.sitepainter.Logger.getWarningLogger();
              if ( ! (CPLib.IsNull(info))) {
                info.log("Routine arrt_chkdiana_all: query on tbstgru returns "+(m_TheCursor.CurrentRow()-1)+" rows larger then the expected 1000");
              }
            }
          }
          });
      }
      while ( ! (Cursor_tbstgru.Eof())) {
        mcStgru.AppendWithTrimmedKey(Cursor_tbstgru.GetString("SOTGRU"));
        mcStgru.row.SOTGRU = Cursor_tbstgru.GetString("SOTGRU");
        mcStgru.row.DESCRI = Cursor_tbstgru.GetString("DESCRI");
        mcStgru.row.TIPOSOT = Cursor_tbstgru.GetString("TIPOSOT");
        mcStgru.row.DATAINI = Cursor_tbstgru.GetDate("DATAINI");
        mcStgru.row.DATAFINE = Cursor_tbstgru.GetDate("DATAFINE");
        Cursor_tbstgru.Next();
      }
      m_cConnectivityError = Cursor_tbstgru.ErrorMessage();
      Cursor_tbstgru.Close();
      mcStgru.GoTop();
      // * --- Fill memory cursor mcKnarapbo on knarapbo
      mcKnarapbo.Zap();
      m_cServer = m_Ctx.GetServer("knarapbo");
      m_cPhName = m_Ctx.GetPhName("knarapbo");
      if (Cursor_knarapbo!=null)
        Cursor_knarapbo.Close();
      Cursor_knarapbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+(m_Ctx.IsSharedTemp("knarapbo")?"context_id='"+m_Ctx.GetTempID()+"'":"1=1"),m_cServer,m_Ctx,true));
      {
        final CPResultSet m_TheCursor = Cursor_knarapbo;
        Cursor_knarapbo.ActionOnClose(new Runnable() {
          public void run() {
            if (CPLib.gt(m_TheCursor.CurrentRow()-1,1000*1.1)) {
              com.zucchetti.sitepainter.Logger info = com.zucchetti.sitepainter.Logger.getWarningLogger();
              if ( ! (CPLib.IsNull(info))) {
                info.log("Routine arrt_chkdiana_all: query on knarapbo returns "+(m_TheCursor.CurrentRow()-1)+" rows larger then the expected 1000");
              }
            }
          }
          });
      }
      while ( ! (Cursor_knarapbo.Eof())) {
        mcKnarapbo.AppendWithTrimmedKey(Cursor_knarapbo.GetString("RAPPORTO"));
        mcKnarapbo.row.RAPPORTO = Cursor_knarapbo.GetString("RAPPORTO");
        mcKnarapbo.row.DESCRAP = Cursor_knarapbo.GetString("DESCRAP");
        mcKnarapbo.row.TIPORAP = Cursor_knarapbo.GetString("TIPORAP");
        mcKnarapbo.row.DATAINI = Cursor_knarapbo.GetDate("DATAINI");
        mcKnarapbo.row.DATAFIN = Cursor_knarapbo.GetDate("DATAFIN");
        mcKnarapbo.row.FLAGRAP = Cursor_knarapbo.GetString("FLAGRAP");
        mcKnarapbo.row.CODDIPE = Cursor_knarapbo.GetString("CODDIPE");
        Cursor_knarapbo.Next();
      }
      m_cConnectivityError = Cursor_knarapbo.ErrorMessage();
      Cursor_knarapbo.Close();
      mcKnarapbo.GoTop();
      /* xStato := '' */
      xStato = "";
      /* _codrif := '' */
      _codrif = "";
      /* _ctotale := 0 */
      _ctotale = CPLib.Round(0,0);
      /* _conta := 0 */
      _conta = CPLib.Round(0,0);
      /* If w_flgchk='N' */
      if (CPLib.eqr(w_flgchk,"N")) {
        /* If w_flgxls = 'N' */
        if (CPLib.eqr(w_flgxls,"N")) {
          /* If w_multifile='S' */
          if (CPLib.eqr(w_multifile,"S")) {
            /* _numfile := 0 */
            _numfile = CPLib.Round(0,0);
          } // End If
        } else { // Else
          /* _numfile := 0 */
          _numfile = CPLib.Round(0,0);
          /* gMsgProc := gMsgProc + 'Ora Inizio Azzeramento archivi appoggio per 380 Excel: '+ arfn_fdatetime(DateTime()) + NL */
          gMsgProc = gMsgProc+"Ora Inizio Azzeramento archivi appoggio per 380 Excel: "+arfn_fdatetimeR.Make(m_Ctx,this).Run(CPLib.DateTime())+"\n";
          m_Ctx.SetGlobalString("gMsgProc",gMsgProc);
          /* mcTipo1.Zap() */
          mcTipo1.Zap();
          /* mcTipo2.Zap() */
          mcTipo2.Zap();
          /* mcTipo4.Zap() */
          mcTipo4.Zap();
          /* mcTipo5.Zap() */
          mcTipo5.Zap();
          /* mcTipo6.Zap() */
          mcTipo6.Zap();
          /* mcTipo7.Zap() */
          mcTipo7.Zap();
          /* mcTipo8.Zap() */
          mcTipo8.Zap();
          /* mcTipo9.Zap() */
          mcTipo9.Zap();
          /* gMsgProc := gMsgProc + 'Ora Fine Azzeramento archivi appoggio per 380 Excel: '+ arfn_fdatetime(DateTime()) + NL */
          gMsgProc = gMsgProc+"Ora Fine Azzeramento archivi appoggio per 380 Excel: "+arfn_fdatetimeR.Make(m_Ctx,this).Run(CPLib.DateTime())+"\n";
          m_Ctx.SetGlobalString("gMsgProc",gMsgProc);
        } // End If
        /* cNomeFileZip := LRTrim(gPathDoc)+'/flussi/'+LRTrim(gAzienda)+"/campione.zip" */
        cNomeFileZip = CPLib.LRTrim(gPathDoc)+"/flussi/"+CPLib.LRTrim(gAzienda)+"/campione.zip";
      } else { // Else
        /* _conta1 := 0 */
        _conta1 = CPLib.Round(0,0);
        /* _conta2 := 0 */
        _conta2 = CPLib.Round(0,0);
        /* _conta4 := 0 */
        _conta4 = CPLib.Round(0,0);
        /* _conta5 := 0 */
        _conta5 = CPLib.Round(0,0);
        /* _conta6 := 0 */
        _conta6 = CPLib.Round(0,0);
        /* _conta7 := 0 */
        _conta7 = CPLib.Round(0,0);
        /* _conta8 := 0 */
        _conta8 = CPLib.Round(0,0);
        /* _conta9 := 0 */
        _conta9 = CPLib.Round(0,0);
        /* gMsgProc := gMsgProc + 'Ora Inizio Azzeramento archivi appoggio: '+ arfn_fdatetime(DateTime()) + NL */
        gMsgProc = gMsgProc+"Ora Inizio Azzeramento archivi appoggio: "+arfn_fdatetimeR.Make(m_Ctx,this).Run(CPLib.DateTime())+"\n";
        m_Ctx.SetGlobalString("gMsgProc",gMsgProc);
        /* gMsgImp := 'Azzeramento tabelle WEBCHK ...' // Messaggio Import */
        gMsgImp = "Azzeramento tabelle WEBCHK ...";
        m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
        /* If CPLib.eqr(m_Sql.GetDataBaseType(m_cServer),CPSql.m_nSQLServer) */
        if (CPLib.eqr(m_Sql.GetDataBaseType(m_cServer),CPSql.m_nSQLServer)) {
          // * --- Delete from tipo1
          m_Sql.RequireTransaction();
          m_cServer = m_Ctx.GetServer("tipo1");
          m_cPhName = m_Ctx.GetPhName("tipo1");
          m_oWrInfo = CPPhTableWrInfo.GetCPPhTableWrInfo(m_Ctx,"tipo1",m_Ctx.GetCompany());
          m_oParameters = CPLib.GetParamsForSqlUpdate(m_cServer);
          m_cSql = CPLib.GetSQLPrefixComment("arrt_chkdiana_all",572,"000000FB")+"delete from "+m_oWrInfo.GetTableWriteName();
          m_cSql = m_cSql+" where ";
          m_cSql = m_cSql+m_oWrInfo.WhereFilter("1=1");
          m_nUpdatedRows = m_Sql.Update(m_cServer,m_cSql,m_oParameters);
          if (CPLib.lt(m_nUpdatedRows,0)) {
            m_Sql.AbortTransaction();
          }
          m_Sql.CompleteTransaction();
          m_cLastMsgError = m_Sql.TransactionErrorMessage();
          if (CPLib.ne(m_cLastMsgError,"")) {
            m_bError = true;
          }
          // * --- Delete from tipo2_3
          m_Sql.RequireTransaction();
          m_cServer = m_Ctx.GetServer("tipo2_3");
          m_cPhName = m_Ctx.GetPhName("tipo2_3");
          m_oWrInfo = CPPhTableWrInfo.GetCPPhTableWrInfo(m_Ctx,"tipo2_3",m_Ctx.GetCompany());
          m_oParameters = CPLib.GetParamsForSqlUpdate(m_cServer);
          m_cSql = CPLib.GetSQLPrefixComment("arrt_chkdiana_all",572,"000000FC")+"delete from "+m_oWrInfo.GetTableWriteName();
          m_cSql = m_cSql+" where ";
          m_cSql = m_cSql+m_oWrInfo.WhereFilter("1=1");
          m_nUpdatedRows = m_Sql.Update(m_cServer,m_cSql,m_oParameters);
          if (CPLib.lt(m_nUpdatedRows,0)) {
            m_Sql.AbortTransaction();
          }
          m_Sql.CompleteTransaction();
          m_cLastMsgError = m_Sql.TransactionErrorMessage();
          if (CPLib.ne(m_cLastMsgError,"")) {
            m_bError = true;
          }
          // * --- Delete from tipo4
          m_Sql.RequireTransaction();
          m_cServer = m_Ctx.GetServer("tipo4");
          m_cPhName = m_Ctx.GetPhName("tipo4");
          m_oWrInfo = CPPhTableWrInfo.GetCPPhTableWrInfo(m_Ctx,"tipo4",m_Ctx.GetCompany());
          m_oParameters = CPLib.GetParamsForSqlUpdate(m_cServer);
          m_cSql = CPLib.GetSQLPrefixComment("arrt_chkdiana_all",572,"000000FD")+"delete from "+m_oWrInfo.GetTableWriteName();
          m_cSql = m_cSql+" where ";
          m_cSql = m_cSql+m_oWrInfo.WhereFilter("1=1");
          m_nUpdatedRows = m_Sql.Update(m_cServer,m_cSql,m_oParameters);
          if (CPLib.lt(m_nUpdatedRows,0)) {
            m_Sql.AbortTransaction();
          }
          m_Sql.CompleteTransaction();
          m_cLastMsgError = m_Sql.TransactionErrorMessage();
          if (CPLib.ne(m_cLastMsgError,"")) {
            m_bError = true;
          }
          // * --- Delete from tipo5
          m_Sql.RequireTransaction();
          m_cServer = m_Ctx.GetServer("tipo5");
          m_cPhName = m_Ctx.GetPhName("tipo5");
          m_oWrInfo = CPPhTableWrInfo.GetCPPhTableWrInfo(m_Ctx,"tipo5",m_Ctx.GetCompany());
          m_oParameters = CPLib.GetParamsForSqlUpdate(m_cServer);
          m_cSql = CPLib.GetSQLPrefixComment("arrt_chkdiana_all",572,"000000FE")+"delete from "+m_oWrInfo.GetTableWriteName();
          m_cSql = m_cSql+" where ";
          m_cSql = m_cSql+m_oWrInfo.WhereFilter("1=1");
          m_nUpdatedRows = m_Sql.Update(m_cServer,m_cSql,m_oParameters);
          if (CPLib.lt(m_nUpdatedRows,0)) {
            m_Sql.AbortTransaction();
          }
          m_Sql.CompleteTransaction();
          m_cLastMsgError = m_Sql.TransactionErrorMessage();
          if (CPLib.ne(m_cLastMsgError,"")) {
            m_bError = true;
          }
          // * --- Delete from tipo6
          m_Sql.RequireTransaction();
          m_cServer = m_Ctx.GetServer("tipo6");
          m_cPhName = m_Ctx.GetPhName("tipo6");
          m_oWrInfo = CPPhTableWrInfo.GetCPPhTableWrInfo(m_Ctx,"tipo6",m_Ctx.GetCompany());
          m_oParameters = CPLib.GetParamsForSqlUpdate(m_cServer);
          m_cSql = CPLib.GetSQLPrefixComment("arrt_chkdiana_all",572,"000000FF")+"delete from "+m_oWrInfo.GetTableWriteName();
          m_cSql = m_cSql+" where ";
          m_cSql = m_cSql+m_oWrInfo.WhereFilter("1=1");
          m_nUpdatedRows = m_Sql.Update(m_cServer,m_cSql,m_oParameters);
          if (CPLib.lt(m_nUpdatedRows,0)) {
            m_Sql.AbortTransaction();
          }
          m_Sql.CompleteTransaction();
          m_cLastMsgError = m_Sql.TransactionErrorMessage();
          if (CPLib.ne(m_cLastMsgError,"")) {
            m_bError = true;
          }
          // * --- Delete from tipo7
          m_Sql.RequireTransaction();
          m_cServer = m_Ctx.GetServer("tipo7");
          m_cPhName = m_Ctx.GetPhName("tipo7");
          m_oWrInfo = CPPhTableWrInfo.GetCPPhTableWrInfo(m_Ctx,"tipo7",m_Ctx.GetCompany());
          m_oParameters = CPLib.GetParamsForSqlUpdate(m_cServer);
          m_cSql = CPLib.GetSQLPrefixComment("arrt_chkdiana_all",572,"00000100")+"delete from "+m_oWrInfo.GetTableWriteName();
          m_cSql = m_cSql+" where ";
          m_cSql = m_cSql+m_oWrInfo.WhereFilter("1=1");
          m_nUpdatedRows = m_Sql.Update(m_cServer,m_cSql,m_oParameters);
          if (CPLib.lt(m_nUpdatedRows,0)) {
            m_Sql.AbortTransaction();
          }
          m_Sql.CompleteTransaction();
          m_cLastMsgError = m_Sql.TransactionErrorMessage();
          if (CPLib.ne(m_cLastMsgError,"")) {
            m_bError = true;
          }
          // * --- Delete from tipo8
          m_Sql.RequireTransaction();
          m_cServer = m_Ctx.GetServer("tipo8");
          m_cPhName = m_Ctx.GetPhName("tipo8");
          m_oWrInfo = CPPhTableWrInfo.GetCPPhTableWrInfo(m_Ctx,"tipo8",m_Ctx.GetCompany());
          m_oParameters = CPLib.GetParamsForSqlUpdate(m_cServer);
          m_cSql = CPLib.GetSQLPrefixComment("arrt_chkdiana_all",572,"00000101")+"delete from "+m_oWrInfo.GetTableWriteName();
          m_cSql = m_cSql+" where ";
          m_cSql = m_cSql+m_oWrInfo.WhereFilter("1=1");
          m_nUpdatedRows = m_Sql.Update(m_cServer,m_cSql,m_oParameters);
          if (CPLib.lt(m_nUpdatedRows,0)) {
            m_Sql.AbortTransaction();
          }
          m_Sql.CompleteTransaction();
          m_cLastMsgError = m_Sql.TransactionErrorMessage();
          if (CPLib.ne(m_cLastMsgError,"")) {
            m_bError = true;
          }
          // * --- Delete from tipo9
          m_Sql.RequireTransaction();
          m_cServer = m_Ctx.GetServer("tipo9");
          m_cPhName = m_Ctx.GetPhName("tipo9");
          m_oWrInfo = CPPhTableWrInfo.GetCPPhTableWrInfo(m_Ctx,"tipo9",m_Ctx.GetCompany());
          m_oParameters = CPLib.GetParamsForSqlUpdate(m_cServer);
          m_cSql = CPLib.GetSQLPrefixComment("arrt_chkdiana_all",572,"00000102")+"delete from "+m_oWrInfo.GetTableWriteName();
          m_cSql = m_cSql+" where ";
          m_cSql = m_cSql+m_oWrInfo.WhereFilter("1=1");
          m_nUpdatedRows = m_Sql.Update(m_cServer,m_cSql,m_oParameters);
          if (CPLib.lt(m_nUpdatedRows,0)) {
            m_Sql.AbortTransaction();
          }
          m_Sql.CompleteTransaction();
          m_cLastMsgError = m_Sql.TransactionErrorMessage();
          if (CPLib.ne(m_cLastMsgError,"")) {
            m_bError = true;
          }
        } else { // Else
          /* gMsgImp := 'Attendere. Azzeramento Archivi ...' // Messaggio Import */
          gMsgImp = "Attendere. Azzeramento Archivi ...";
          m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
          /* While tblnum<10 */
          while (CPLib.lt(tblnum,10)) {
            /* tblname_main := 'tipo'+Str(tblnum,1,0)+iif(tblnum<>2,'','_3') // nome tabella */
            tblname_main = "tipo"+CPLib.Str(tblnum,1,0)+(CPLib.ne(tblnum,2)?"":"_3");
            /* gMsgImp := 'Attendere. Azzeramento Archivio '+LRTrim(tblname_main) // Messaggio Import */
            gMsgImp = "Attendere. Azzeramento Archivio "+CPLib.LRTrim(tblname_main);
            m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
            /* Exec "Truncate Tabella" Page 17:TruncTab(tblname_main) */
            TruncTab(tblname_main);
            /* tblnum := tblnum+iif(tblnum<>2,1,2) // numero progressivo tabella */
            tblnum = CPLib.Round(tblnum+(CPLib.ne(tblnum,2)?1:2),0);
          } // End While
          /* tblname_main := 'contatori' // nome tabella */
          tblname_main = "contatori";
          /* gMsgImp := 'Attendere. Azzeramento Archivio '+LRTrim(tblname_main) // Messaggio Import */
          gMsgImp = "Attendere. Azzeramento Archivio "+CPLib.LRTrim(tblname_main);
          m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
          /* Exec "Truncate Tabella" Page 17:TruncTab(tblname_main) */
          TruncTab(tblname_main);
        } // End If
        /* gMsgProc := gMsgProc + 'Ora Fine Azzeramento archivi appoggio: '+ arfn_fdatetime(DateTime()) + NL */
        gMsgProc = gMsgProc+"Ora Fine Azzeramento archivi appoggio: "+arfn_fdatetimeR.Make(m_Ctx,this).Run(CPLib.DateTime())+"\n";
        m_Ctx.SetGlobalString("gMsgProc",gMsgProc);
      } // End If
      File directoryPath = new File(CPLib.LRTrim(gPathDoc)+"/flussi/"+CPLib.LRTrim(gAzienda));
      File filesList[] = directoryPath.listFiles();
      for(File file : filesList) {
      /* If At("campione", file.getName()) <> 0 */
      if (CPLib.ne(CPLib.At("campione",file.getName()),0)) {
        /* FileLibMit.DeleteFilePath(file.getAbsolutePath()) */
        FileLibMit.DeleteFilePath(file.getAbsolutePath());
      } // End If
      /* } */
      };
      // Begin Transaction
      m_Sql.RequireTransaction();
      double nTry00000113status;
      nTry00000113status = m_Sql.GetTransactionStatus();
      String cTry00000113msg;
      cTry00000113msg = m_Sql.TransactionErrorMessage();
      try {
        /* gMsgProc := gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' dei dati' + NL */
        gMsgProc = gMsgProc+"Ora Inizio Processo: "+arfn_fdatetimeR.Make(m_Ctx,this).Run(CPLib.DateTime())+" dei dati"+"\n";
        m_Ctx.SetGlobalString("gMsgProc",gMsgProc);
        /* If w_flgope = 'S' */
        if (CPLib.eqr(w_flgope,"S")) {
          /* Exec "Operazioni" Page 2:Page_2 */
          Page_2();
          if ( ! (CPLib.Empty(m_Sql.TransactionErrorMessage()))) {
            throw new RoutineException();
          }
        } // End If
        /* If w_flgfrz = 'S' */
        if (CPLib.eqr(w_flgfrz,"S")) {
          /* Exec "Frazionate" Page 4:Page_4 */
          Page_4();
          if ( ! (CPLib.Empty(m_Sql.TransactionErrorMessage()))) {
            throw new RoutineException();
          }
        } // End If
        /* If w_flgrap='N' or (w_flgrap='S' and At(w_tiprap,"|1|2|3") <> 0) */
        if (CPLib.eqr(w_flgrap,"N") || (CPLib.eqr(w_flgrap,"S") && CPLib.ne(CPLib.At(w_tiprap,"|1|2|3"),0))) {
          /* _oldmc := _usemc */
          _oldmc = CPLib.Round(_usemc,0);
          /* _usemc := 0 */
          _usemc = CPLib.Round(0,0);
          /* Exec "Informazioni" Page 3:Page_3 */
          Page_3();
          if ( ! (CPLib.Empty(m_Sql.TransactionErrorMessage()))) {
            throw new RoutineException();
          }
          /* _usemc := _oldmc */
          _usemc = CPLib.Round(_oldmc,0);
        } // End If
        /* If w_flgtit = 'N' or (w_flgtit='S' and At(w_tiptit,"|1|2|3") <> 0) */
        if (CPLib.eqr(w_flgtit,"N") || (CPLib.eqr(w_flgtit,"S") && CPLib.ne(CPLib.At(w_tiptit,"|1|2|3"),0))) {
          /* _oldmc := _usemc */
          _oldmc = CPLib.Round(_usemc,0);
          /* _usemc := 0 */
          _usemc = CPLib.Round(0,0);
          /* Exec "Titolari" Page 5:Page_5 */
          Page_5();
          if ( ! (CPLib.Empty(m_Sql.TransactionErrorMessage()))) {
            throw new RoutineException();
          }
          /* _usemc := _oldmc */
          _usemc = CPLib.Round(_oldmc,0);
        } // End If
        /* If w_flgchk='N' */
        if (CPLib.eqr(w_flgchk,"N")) {
          /* If w_flgxls='N' */
          if (CPLib.eqr(w_flgxls,"N")) {
            /* If w_multifile='S' */
            if (CPLib.eqr(w_multifile,"S")) {
              /* _numfile := _numfile + 1 */
              _numfile = CPLib.Round(_numfile+1,0);
              /* cOnlyNomeFile := "campione_"+Right('000000'+LRTrim(Str(_numfile,10,0)),6)+".txt" */
              cOnlyNomeFile = "campione_"+CPLib.Right("000000"+CPLib.LRTrim(CPLib.Str(_numfile,10,0)),6)+".txt";
              /* cNomeFile := LRTrim(gPathDoc)+'/flussi/'+LRTrim(gAzienda)+"/"+cOnlyNomeFile */
              cNomeFile = CPLib.LRTrim(gPathDoc)+"/flussi/"+CPLib.LRTrim(gAzienda)+"/"+cOnlyNomeFile;
            } else { // Else
              /* cOnlyNomeFile := "campione.txt" */
              cOnlyNomeFile = "campione.txt";
              /* cNomeFile := LRTrim(gPathDoc)+'/flussi/'+LRTrim(gAzienda)+"/"+cOnlyNomeFile */
              cNomeFile = CPLib.LRTrim(gPathDoc)+"/flussi/"+CPLib.LRTrim(gAzienda)+"/"+cOnlyNomeFile;
            } // End If
            // Aggiunge i file nei vettori
            filenames.add(CPLib.LRTrim(cNomeFile));
            fileonames.add(CPLib.LRTrim(cOnlyNomeFile));
            
            // Provo nuovo metodo
            FileChannel rwChannel= new RandomAccessFile(CPLib.LRTrim(cNomeFile),"rw").getChannel();
            //ByteBuffer wrBuf=rwChannel.map(FileChannel.MapMode.READ_WRITE,0,380 * (int)_righetot);
            ByteBuffer wrBuf;
            for (MemoryCursorRow_mcdiana_mcrdef rwRigheTXT : mcRigheTXT._iterable_()) {
              /* _riga := rwRigheTXT.RIGA */
              _riga = rwRigheTXT.RIGA;
              // Scrive le righe
              wrBuf = ByteBuffer.wrap(_riga.getBytes(StandardCharsets.UTF_8));
              rwChannel.write(wrBuf);
            }
            /* rwChannel.close() */
            rwChannel.close();
            /* _righe := 0 */
            _righe = CPLib.Round(0,0);
          } else { // Else
            /* _numfile := _numfile + 1 */
            _numfile = CPLib.Round(_numfile+1,0);
            /* cOnlyNomeFile := "campione_"+Right('000000'+LRTrim(Str(_numfile,10,0)),6)+".xlsx" */
            cOnlyNomeFile = "campione_"+CPLib.Right("000000"+CPLib.LRTrim(CPLib.Str(_numfile,10,0)),6)+".xlsx";
            /* cNomeFile := LRTrim(gPathDoc)+'/flussi/'+LRTrim(gAzienda)+"/"+cOnlyNomeFile */
            cNomeFile = CPLib.LRTrim(gPathDoc)+"/flussi/"+CPLib.LRTrim(gAzienda)+"/"+cOnlyNomeFile;
            // Aggiunge i file nei vettori
            filenames.add(CPLib.LRTrim(cNomeFile));
            fileonames.add(CPLib.LRTrim(cOnlyNomeFile));
            /* gMsgProc := gMsgProc + 'Ora Inizio Scrittura file '+LRTrim(cOnlyNomeFile) +' per 380 Excel: '+ arfn_fdatetime(DateTime()) + NL */
            gMsgProc = gMsgProc+"Ora Inizio Scrittura file "+CPLib.LRTrim(cOnlyNomeFile)+" per 380 Excel: "+arfn_fdatetimeR.Make(m_Ctx,this).Run(CPLib.DateTime())+"\n";
            m_Ctx.SetGlobalString("gMsgProc",gMsgProc);
            /* Exec "Scrive il file Excel (xlsx)" Page 16:Page_20 */
            Page_20();
            if ( ! (CPLib.Empty(m_Sql.TransactionErrorMessage()))) {
              throw new RoutineException();
            }
            /* gMsgProc := gMsgProc + 'Ora Fine Scrittura file '+LRTrim(cOnlyNomeFile) +' per 380 Excel: '+ arfn_fdatetime(DateTime()) + NL */
            gMsgProc = gMsgProc+"Ora Fine Scrittura file "+CPLib.LRTrim(cOnlyNomeFile)+" per 380 Excel: "+arfn_fdatetimeR.Make(m_Ctx,this).Run(CPLib.DateTime())+"\n";
            m_Ctx.SetGlobalString("gMsgProc",gMsgProc);
          } // End If
          /* Exec "Crea file zip" Page 6:Page_6 */
          Page_6();
          if ( ! (CPLib.Empty(m_Sql.TransactionErrorMessage()))) {
            throw new RoutineException();
          }
          /* gMsgImp := 'Elaborazione terminata. Premere il bottone per prelevare il file' // Messaggio Import */
          gMsgImp = "Elaborazione terminata. Premere il bottone per prelevare il file";
          m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
        } else { // Else
          /* gMsgProc := gMsgProc + 'Ora Inizio Scrittura su WEBCHK: '+ arfn_fdatetime(DateTime()) + NL */
          gMsgProc = gMsgProc+"Ora Inizio Scrittura su WEBCHK: "+arfn_fdatetimeR.Make(m_Ctx,this).Run(CPLib.DateTime())+"\n";
          m_Ctx.SetGlobalString("gMsgProc",gMsgProc);
          /* Exec "Scrittura diretta su WEBCHK" Page 11:Page_15 */
          Page_15();
          if ( ! (CPLib.Empty(m_Sql.TransactionErrorMessage()))) {
            throw new RoutineException();
          }
          /* gMsgProc := gMsgProc + 'Ora Fine Scrittura su WEBCHK: '+ arfn_fdatetime(DateTime()) + NL */
          gMsgProc = gMsgProc+"Ora Fine Scrittura su WEBCHK: "+arfn_fdatetimeR.Make(m_Ctx,this).Run(CPLib.DateTime())+"\n";
          m_Ctx.SetGlobalString("gMsgProc",gMsgProc);
          /* gMsgImp := 'Elaborazione Terminata. Utilizzare WEBCHK per analizzare i dati' // Messaggio Import */
          gMsgImp = "Elaborazione Terminata. Utilizzare WEBCHK per analizzare i dati";
          m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
        } // End If
        // Commit
        m_cLastMsgError = m_Sql.TransactionErrorMessage();
        if (CPLib.ne(m_cLastMsgError,"")) {
          m_bError = true;
        }
        m_Sql.CompleteTransaction();
        /* gMsgProc := gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' dei dati' + NL */
        gMsgProc = gMsgProc+"Ora Fine Processo: "+arfn_fdatetimeR.Make(m_Ctx,this).Run(CPLib.DateTime())+" dei dati"+"\n";
        m_Ctx.SetGlobalString("gMsgProc",gMsgProc);
        /* Crea il primo report */
        /* cProg := Utilities.GetAutonumber("PSTPMAV\'"+LRTrim(gAzienda)+"'","",10) */
        cProg = Utilities.Make(m_Ctx,m_Caller).GetAutonumber("PSTPMAV\\'"+CPLib.LRTrim(gAzienda)+"'","",10);
        // * --- Insert into cgo_stampeav from values
        m_Sql.RequireTransaction();
        m_cServer = m_Ctx.GetServer("cgo_stampeav");
        m_cPhName = m_Ctx.GetPhName("cgo_stampeav");
        m_oWrInfo = CPPhTableWrInfo.GetCPPhTableWrInfo(m_Ctx,"cgo_stampeav",m_Ctx.GetCompany());
        m_oParameters = CPLib.GetParamsForSqlUpdate(m_cServer);
        m_cSql = CPLib.GetSQLPrefixComment("arrt_chkdiana_all",572,"00000142")+CPLib.InsertIntoStatement(m_Ctx,m_oWrInfo)+" (";
        m_cSql = m_cSql+GetFieldsName_00000142(m_Ctx,m_oWrInfo);
        m_cSql = m_cSql+") values (";
        m_cSql = m_cSql+""+CPLib.ToSQL(cProg,"?",0,0,m_cServer)+", ";
        m_cSql = m_cSql+""+CPLib.ToSQL(gCodDip,"?",0,0,m_cServer)+", ";
        m_cSql = m_cSql+""+CPLib.ToSQL(CPLib.Date(),"?",0,0)+", ";
        m_cSql = m_cSql+""+CPLib.ToSQL(1,"?",0,0)+", ";
        m_cSql = m_cSql+""+CPLib.ToSQL(cNomeFileZip,"?",0,0,m_cServer, m_oParameters)+", ";
        m_cSql = m_cSql+m_oWrInfo.InsertValues();
        m_cSql = CPLib.AddCPCCCHKValue(m_Ctx,m_cSql,"cgo_stampeav",true);
        m_cSql = m_cSql+")";
        m_nUpdatedRows = m_Sql.Update(m_cServer,m_cSql,m_oParameters);
        if (CPLib.lt(m_nUpdatedRows,0)) {
          m_Sql.AbortTransaction();
        }
        m_Sql.CompleteTransaction();
        m_cLastMsgError = m_Sql.TransactionErrorMessage();
        if (CPLib.ne(m_cLastMsgError,"")) {
          m_bError = true;
          throw new RoutineException();
        }
        /* cRitorno := cProg */
        cRitorno = cProg;
      } catch(Exception l_exeption) {
        Stop.ReactToException(l_exeption);
        // Rollback
        m_Sql.AbortTransaction();
        m_cLastMsgError = m_Sql.TransactionErrorMessage();
        m_bError = true;
        m_Sql.CompleteTransaction();
        /* If w_flgchk='S' */
        if (CPLib.eqr(w_flgchk,"S")) {
          /* gMsgProc := gMsgProc + "Rilevati errori nell'elaborazione dei dati !" + NL */
          gMsgProc = gMsgProc+"Rilevati errori nell'elaborazione dei dati !"+"\n";
          m_Ctx.SetGlobalString("gMsgProc",gMsgProc);
          /* gMsgProc := gMsgProc + 'Errore SQL: ' + m_Sql.TransactionErrorMessage() + NL */
          gMsgProc = gMsgProc+"Errore SQL: "+m_Sql.TransactionErrorMessage()+"\n";
          m_Ctx.SetGlobalString("gMsgProc",gMsgProc);
        } else { // Else
          /* gMsgProc := gMsgProc + "Rilevati errori nell'elaborazione dei dati !" + NL */
          gMsgProc = gMsgProc+"Rilevati errori nell'elaborazione dei dati !"+"\n";
          m_Ctx.SetGlobalString("gMsgProc",gMsgProc);
        } // End If
        /* gMsgProc := gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' dei dati' + NL */
        gMsgProc = gMsgProc+"Ora Fine Processo: "+arfn_fdatetimeR.Make(m_Ctx,this).Run(CPLib.DateTime())+" dei dati"+"\n";
        m_Ctx.SetGlobalString("gMsgProc",gMsgProc);
      } finally {
        if (CPLib.eqr(m_Sql.GetTransactionStatus(),0) || CPLib.ne(nTry00000113status,0)) {
          m_Sql.SetTransactionStatus(nTry00000113status,cTry00000113msg);
        }
      }
      /* mcRighe.Zap() */
      mcRighe.Zap();
      /* mcRigheTXT.Zap() */
      mcRigheTXT.Zap();
      /* mcPersonbo.Zap() */
      mcPersonbo.Zap();
      /* mcWersonbo.Zap() */
      mcWersonbo.Zap();
      /* mcKnarapbo.Zap() */
      mcKnarapbo.Zap();
      /* mcStgru.Zap() */
      mcStgru.Zap();
      /* LibreriaMit.FreeMem() */
      LibreriaMit.FreeMem();
      // * --- Write into tbprcbck from values
      m_Sql.RequireTransaction();
      m_cServer = m_Ctx.GetServer("tbprcbck");
      m_cPhName = m_Ctx.GetPhName("tbprcbck");
      m_oWrInfo = CPPhTableWrInfo.GetCPPhTableWrInfo(m_Ctx,"tbprcbck",m_Ctx.GetCompany());
      m_oParameters = CPLib.GetParamsForSqlUpdate(m_cServer);
      m_cSql = CPLib.GetSQLPrefixComment("arrt_chkdiana_all",572,"00000152")+"Update "+m_oWrInfo.GetTableWriteName()+" set ";
      m_cSql = m_cSql+"PBATTIVO = "+CPLib.ToSQL("N","C",1,0,m_cServer)+", ";
      m_cSql = CPLib.AddCPCCCHKUpdate(m_Ctx,m_cSql,"tbprcbck",false,true);
      m_cSql = m_cSql+" where ";
      m_cSql = m_cSql+"PBDESCRI = "+CPSql.SQLValueAdapter(CPLib.ToSQL("SCHEDULAZIONE 380","?",0,0,m_cServer),m_cServer,"SCHEDULAZIONE 380")+"";
      m_cSql = m_cSql+m_oWrInfo.WhereFilter();
      m_nUpdatedRows = m_Sql.Update(m_cServer,m_cSql,m_oParameters);
      if (CPLib.lt(m_nUpdatedRows,0)) {
        m_Sql.AbortTransaction();
      }
      m_Sql.CompleteTransaction();
      m_cLastMsgError = m_Sql.TransactionErrorMessage();
      if (CPLib.ne(m_cLastMsgError,"")) {
        m_bError = true;
      }
      /* gMsgProc := gMsgProc + 'Ora Fine Procedura: '+ arfn_fdatetime(DateTime()) + NL */
      gMsgProc = gMsgProc+"Ora Fine Procedura: "+arfn_fdatetimeR.Make(m_Ctx,this).Run(CPLib.DateTime())+"\n";
      m_Ctx.SetGlobalString("gMsgProc",gMsgProc);
      /* cProg := Utilities.GetAutonumber("PRGLOG\'"+LRTrim(gAzienda)+"'",'',20) */
      cProg = Utilities.Make(m_Ctx,m_Caller).GetAutonumber("PRGLOG\\'"+CPLib.LRTrim(gAzienda)+"'","",20);
      // * --- Insert into log_app from values
      m_Sql.RequireTransaction();
      m_cServer = m_Ctx.GetServer("log_app");
      m_cPhName = m_Ctx.GetPhName("log_app");
      m_oWrInfo = CPPhTableWrInfo.GetCPPhTableWrInfo(m_Ctx,"log_app",m_Ctx.GetCompany());
      m_oParameters = CPLib.GetParamsForSqlUpdate(m_cServer);
      m_cSql = CPLib.GetSQLPrefixComment("arrt_chkdiana_all",572,"00000156")+CPLib.InsertIntoStatement(m_Ctx,m_oWrInfo)+" (";
      m_cSql = m_cSql+GetFieldsName_00000156(m_Ctx,m_oWrInfo);
      m_cSql = m_cSql+") values (";
      m_cSql = m_cSql+""+CPLib.ToSQL(cProg,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(CPLib.DateTime(),"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(1,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL("Schedulazione 380","?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(gMsgProc,"?",0,0,m_cServer, m_oParameters)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL("Scheduler","?",0,0,m_cServer, m_oParameters)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL("SCHEDULAZIONE 380","?",0,0,m_cServer, m_oParameters)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL("campione.zip","?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL("image:../images/GIF/118.gif","?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL("S","?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+m_oWrInfo.InsertValues();
      m_cSql = CPLib.AddCPCCCHKValue(m_Ctx,m_cSql,"log_app",true);
      m_cSql = m_cSql+")";
      m_nUpdatedRows = m_Sql.Update(m_cServer,m_cSql,m_oParameters);
      if (CPLib.lt(m_nUpdatedRows,0)) {
        m_Sql.AbortTransaction();
      }
      m_Sql.CompleteTransaction();
      m_cLastMsgError = m_Sql.TransactionErrorMessage();
      if (CPLib.ne(m_cLastMsgError,"")) {
        m_bError = true;
      }
      /* Return cRitorno */
      throw new Stop(cRitorno);
    } finally {
      try {
        if (Read_Cursor!=null)
          Read_Cursor.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_anadip!=null)
          Cursor_anadip.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_personbo!=null)
          Cursor_personbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_qbe_personbo_all!=null)
          Cursor_qbe_personbo_all.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_wersonbo!=null)
          Cursor_wersonbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_qbe_wersonbo_all!=null)
          Cursor_qbe_wersonbo_all.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_tbstgru!=null)
          Cursor_tbstgru.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_knarapbo!=null)
          Cursor_knarapbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
    }
  }
  void Page_2() throws Exception {
    /* Cicla sulle operazioni */
    /* If w_tipoarchd = 'S' */
    if (CPLib.eqr(w_tipoarchd,"S")) {
      /* Exec "Operazioni Definitive" Page 7:Page_7 */
      Page_7();
    } // End If
    /* If w_tipoarchp = 'S' */
    if (CPLib.eqr(w_tipoarchp,"S")) {
      /* Exec "Operazioni Provvisorie" Page 8:Page_8 */
      Page_8();
    } // End If
  }
  void Page_3() throws Exception {
    CPResultSet Cursor_qbe_rapd_chkdiana_min_max=null;
    CPResultSet Cursor_qbe_rapd_chkdiana=null;
    CPResultSet Cursor_rapopebo=null;
    CPResultSet Cursor_intestbo=null;
    CPResultSet Cursor_knarapbo=null;
    CPResultSet Cursor_delegabo=null;
    CPResultSet Cursor_intestit=null;
    CPResultSet Cursor_fiduciabo=null;
    CPResultSet Cursor_terzistirap=null;
    CPResultSet Cursor_qbe_rapp_chkdiana=null;
    CPResultSet Cursor_xapopebo=null;
    CPResultSet Cursor_xntestbo=null;
    CPResultSet Cursor_xelegabo=null;
    CPResultSet Cursor_xntestit=null;
    CPResultSet Cursor_xiduciabo=null;
    CPResultSet Cursor_xerzistirap=null;
    VQRHolder l_VQRHolder = null;
    try {
      /* Cicla sulle informazioni sui rapporti */
      /* _conta := _conta + 1 */
      _conta = CPLib.Round(_conta+1,0);
      /* If w_flgrap = 'N' or (w_flgrap='S' and (w_tiprap='1' or w_tiprap='2')) */
      if (CPLib.eqr(w_flgrap,"N") || (CPLib.eqr(w_flgrap,"S") && (CPLib.eqr(w_tiprap,"1") || CPLib.eqr(w_tiprap,"2")))) {
        /* w_cdadata_rap := '' */
        w_cdadata_rap = "";
        /* w_c_adata_rap := '' */
        w_c_adata_rap = "";
        /* w_cdareg_rap := '' */
        w_cdareg_rap = "";
        /* w_c_areg_rap := '' */
        w_c_areg_rap = "";
        /* ElseIf w_flgrap='S' and w_tiprap='9' */
      } else if (CPLib.eqr(w_flgrap,"S") && CPLib.eqr(w_tiprap,"9")) {
        /* w_cdadata_rap := '99991231' */
        w_cdadata_rap = "99991231";
        /* w_c_adata_rap := '99991231' */
        w_c_adata_rap = "99991231";
        /* w_cdareg_rap := '99991231' */
        w_cdareg_rap = "99991231";
        /* w_c_areg_rap := '99991231' */
        w_c_areg_rap = "99991231";
      } else { // Else
        /* w_cdadata_rap := w_cdadata */
        w_cdadata_rap = w_cdadata;
        /* w_c_adata_rap := w_c_adata */
        w_c_adata_rap = w_c_adata;
        /* w_cdareg_rap := w_cdareg */
        w_cdareg_rap = w_cdareg;
        /* w_c_areg_rap := w_c_areg */
        w_c_areg_rap = w_c_areg;
      } // End If
      /* If w_tipoarchd = 'S' */
      if (CPLib.eqr(w_tipoarchd,"S")) {
        /* _max := 0 */
        _max = CPLib.Round(0,0);
        /* _min := 0 */
        _min = CPLib.Round(0,0);
        /* _ciclo := 0 */
        _ciclo = CPLib.Round(0,0);
        /* Prima gli italiani */
        /* _contacilci := 0 */
        _contacilci = CPLib.Round(0,0);
        // * --- Select from qbe_rapd_chkdiana_min_max
        SPBridge.HMCaller _h00000172;
        _h00000172 = new SPBridge.HMCaller();
        _h00000172.Set("m_cVQRList",m_cVQRList);
        _h00000172.Set("cdadata_rap",w_cdadata_rap);
        _h00000172.Set("c_adata_rap",w_c_adata_rap);
        _h00000172.Set("cdareg",w_cdareg_rap);
        _h00000172.Set("c_areg",w_c_areg_rap);
        _h00000172.Set("flgsto",w_flgsto);
        if (Cursor_qbe_rapd_chkdiana_min_max!=null)
          Cursor_qbe_rapd_chkdiana_min_max.Close();
        Cursor_qbe_rapd_chkdiana_min_max = new VQRHolder("qbe_rapd_chkdiana_min_max",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000172,true).GetResultSet(m_Ctx);
        while ( ! (Cursor_qbe_rapd_chkdiana_min_max.Eof())) {
          /* _min := qbe_rapd_chkdiana_min_max->MININF */
          _min = CPLib.Round(Cursor_qbe_rapd_chkdiana_min_max.GetDouble("MININF"),0);
          /* _max := qbe_rapd_chkdiana_min_max->MAXINF */
          _max = CPLib.Round(Cursor_qbe_rapd_chkdiana_min_max.GetDouble("MAXINF"),0);
          Cursor_qbe_rapd_chkdiana_min_max.Next();
        }
        m_cConnectivityError = Cursor_qbe_rapd_chkdiana_min_max.ErrorMessage();
        Cursor_qbe_rapd_chkdiana_min_max.Close();
        // * --- End Select
        /* _cicli := iif(Mod(_max,5000) <> 0,Int(_max/5000) + 1,Int(_max/5000)) */
        _cicli = CPLib.Round((CPLib.ne(CPLib.Mod(_max,5000),0)?CPLib.Int(_max/5000)+1:CPLib.Int(_max/5000)),0);
        /* _bottom := _min */
        _bottom = CPLib.Round(_min,0);
        /* If _min > 5000 */
        if (CPLib.gt(_min,5000)) {
          /* _contacilci := Int(_min/5000) + 1 */
          _contacilci = CPLib.Round(CPLib.Int(_min/5000)+1,0);
        } else { // Else
          /* _contacilci := 1 */
          _contacilci = CPLib.Round(1,0);
        } // End If
        /* gMsgImp := 'Lettura informazioni in corso ...' // Messaggio Import */
        gMsgImp = "Lettura informazioni in corso ...";
        m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
        /* While _contacilci<=_cicli */
        while (CPLib.le(_contacilci,_cicli)) {
          /* _bottom := iif(_ciclo=0,_bottom,((_contacilci -1 ) * 5000) + 1) */
          _bottom = CPLib.Round((CPLib.eqr(_ciclo,0)?_bottom:((_contacilci-1)*5000)+1),0);
          /* _top := _contacilci * 5000 */
          _top = CPLib.Round(_contacilci*5000,0);
          /* _ciclo := 1 */
          _ciclo = CPLib.Round(1,0);
          /* _conta := _conta + 1 */
          _conta = CPLib.Round(_conta+1,0);
          /* gMsgImp := 'Lettura informazioni in corso ... Ciclo N. '+LRTrim(Str(_contacilci,10,0)) // Messaggio Import */
          gMsgImp = "Lettura informazioni in corso ... Ciclo N. "+CPLib.LRTrim(CPLib.Str(_contacilci,10,0));
          m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
          /* Cicla sulle operazioni */
          /* _contacilci := _contacilci+1 */
          _contacilci = CPLib.Round(_contacilci+1,0);
          // * --- Select from qbe_rapd_chkdiana
          SPBridge.HMCaller _h00000183;
          _h00000183 = new SPBridge.HMCaller();
          _h00000183.Set("m_cVQRList",m_cVQRList);
          _h00000183.Set("cdadata_rap",w_cdadata_rap);
          _h00000183.Set("c_adata_rap",w_c_adata_rap);
          _h00000183.Set("_bottom",_bottom);
          _h00000183.Set("_top",_top);
          _h00000183.Set("cdareg",w_cdareg_rap);
          _h00000183.Set("c_areg",w_c_areg_rap);
          _h00000183.Set("flgsto",w_flgsto);
          if (Cursor_qbe_rapd_chkdiana!=null)
            Cursor_qbe_rapd_chkdiana.Close();
          Cursor_qbe_rapd_chkdiana = new VQRHolder("qbe_rapd_chkdiana",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000183,true).GetResultSet(m_Ctx);
          while ( ! (Cursor_qbe_rapd_chkdiana.Eof())) {
            /* _continua := 0 */
            _continua = CPLib.Round(0,0);
            /* If qbe_rapd_chkdiana->DATAOPE <  CharToDate('20100601') */
            if (CPLib.lt(Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20100601"))) {
              /* _raeatc := 'R' */
              _raeatc = "R";
              /* ElseIf qbe_rapd_chkdiana->DATAOPE >  CharToDate('20131231') */
            } else if (CPLib.gt(Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
              /* _raeatc := 'A' */
              _raeatc = "A";
            } else { // Else
              /* _raeatc := w_flgrae */
              _raeatc = w_flgrae;
            } // End If
            /* Case w_flgrap='N' or (w_flgrap='S' and w_tiprap='3') */
            if (CPLib.eqr(w_flgrap,"N") || (CPLib.eqr(w_flgrap,"S") && CPLib.eqr(w_tiprap,"3"))) {
              /* _continua := 1 */
              _continua = CPLib.Round(1,0);
              /* Case w_flgrap='S' and w_tiprap='1' */
            } else if (CPLib.eqr(w_flgrap,"S") && CPLib.eqr(w_tiprap,"1")) {
              /* _continua := 1 */
              _continua = CPLib.Round(1,0);
              // * --- Select from rapopebo
              m_cServer = m_Ctx.GetServer("rapopebo");
              m_cPhName = m_Ctx.GetPhName("rapopebo");
              if (Cursor_rapopebo!=null)
                Cursor_rapopebo.Close();
              Cursor_rapopebo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("rapopebo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1")+" order by "+"DATAOPE ",m_cServer,m_Ctx,true));
              while ( ! (Cursor_rapopebo.Eof())) {
                /* Case rapopebo->TIPOOPRAP='25' or rapopebo->TIPOOPRAP='28' */
                if (CPLib.eqr(Cursor_rapopebo.GetString("TIPOOPRAP"),"25") || CPLib.eqr(Cursor_rapopebo.GetString("TIPOOPRAP"),"28")) {
                  /* Case Right(rapopebo->TIPOOPRAP,1)='6' or rapopebo->TIPOOPRAP='38' */
                } else if (CPLib.eqr(CPLib.Right(Cursor_rapopebo.GetString("TIPOOPRAP"),1),"6") || CPLib.eqr(Cursor_rapopebo.GetString("TIPOOPRAP"),"38")) {
                  /* If rapopebo->DATAOPE < w_DaData */
                  if (CPLib.lt(Cursor_rapopebo.GetDate("DATAOPE"),w_DaData)) {
                    /* _continua := 0 */
                    _continua = CPLib.Round(0,0);
                  } // End If
                  /* Case rapopebo->TIPOOPRAP='31' or rapopebo->TIPOOPRAP='32' */
                } else if (CPLib.eqr(Cursor_rapopebo.GetString("TIPOOPRAP"),"31") || CPLib.eqr(Cursor_rapopebo.GetString("TIPOOPRAP"),"32")) {
                } else { // Otherwise
                  /* If rapopebo->DATAOPE > w_AData */
                  if (CPLib.gt(Cursor_rapopebo.GetDate("DATAOPE"),w_AData)) {
                    /* _continua := 0 */
                    _continua = CPLib.Round(0,0);
                  } // End If
                } // End Case
                Cursor_rapopebo.Next();
              }
              m_cConnectivityError = Cursor_rapopebo.ErrorMessage();
              Cursor_rapopebo.Close();
              // * --- End Select
              /* Case w_flgrap='S' and w_tiprap='2' */
            } else if (CPLib.eqr(w_flgrap,"S") && CPLib.eqr(w_tiprap,"2")) {
              // * --- Select from rapopebo
              m_cServer = m_Ctx.GetServer("rapopebo");
              m_cPhName = m_Ctx.GetPhName("rapopebo");
              if (Cursor_rapopebo!=null)
                Cursor_rapopebo.Close();
              Cursor_rapopebo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("rapopebo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1")+" order by "+"DATAOPE ",m_cServer,m_Ctx,true));
              while ( ! (Cursor_rapopebo.Eof())) {
                /* Case rapopebo->TIPOOPRAP='25' or rapopebo->TIPOOPRAP='28' */
                if (CPLib.eqr(Cursor_rapopebo.GetString("TIPOOPRAP"),"25") || CPLib.eqr(Cursor_rapopebo.GetString("TIPOOPRAP"),"28")) {
                  /* Case Right(rapopebo->TIPOOPRAP,1)='6' or rapopebo->TIPOOPRAP='38' */
                } else if (CPLib.eqr(CPLib.Right(Cursor_rapopebo.GetString("TIPOOPRAP"),1),"6") || CPLib.eqr(Cursor_rapopebo.GetString("TIPOOPRAP"),"38")) {
                  /* If rapopebo->DATAOPE < w_DaData */
                  if (CPLib.lt(Cursor_rapopebo.GetDate("DATAOPE"),w_DaData)) {
                    /* _continua := 0 */
                    _continua = CPLib.Round(0,0);
                  } // End If
                  /* If _continua= 1 and rapopebo->DATAOPE > w_AData */
                  if (CPLib.eqr(_continua,1) && CPLib.gt(Cursor_rapopebo.GetDate("DATAOPE"),w_AData)) {
                    /* _continua := 0 */
                    _continua = CPLib.Round(0,0);
                  } // End If
                  /* Case rapopebo->TIPOOPRAP='31' or rapopebo->TIPOOPRAP='32' */
                } else if (CPLib.eqr(Cursor_rapopebo.GetString("TIPOOPRAP"),"31") || CPLib.eqr(Cursor_rapopebo.GetString("TIPOOPRAP"),"32")) {
                } else { // Otherwise
                  /* If rapopebo->DATAOPE > w_AData */
                  if (CPLib.gt(Cursor_rapopebo.GetDate("DATAOPE"),w_AData)) {
                    /* _continua := 0 */
                    _continua = CPLib.Round(0,0);
                  } // End If
                } // End Case
                Cursor_rapopebo.Next();
              }
              m_cConnectivityError = Cursor_rapopebo.ErrorMessage();
              Cursor_rapopebo.Close();
              // * --- End Select
            } // End Case
            /* If not(Empty(w_codcli)) and _continua=1 */
            if ( ! (CPLib.Empty(w_codcli)) && CPLib.eqr(_continua,1)) {
              /* _continua := 0 */
              _continua = CPLib.Round(0,0);
              // * --- Select from intestbo
              m_cServer = m_Ctx.GetServer("intestbo");
              m_cPhName = m_Ctx.GetPhName("intestbo");
              if (Cursor_intestbo!=null)
                Cursor_intestbo.Close();
              Cursor_intestbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("intestbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
              while ( ! (Cursor_intestbo.Eof())) {
                /* If intestbo->CODINTER=w_codcli */
                if (CPLib.eqr(Cursor_intestbo.GetString("CODINTER"),w_codcli)) {
                  /* _continua := 1 */
                  _continua = CPLib.Round(1,0);
                } // End If
                Cursor_intestbo.Next();
              }
              m_cConnectivityError = Cursor_intestbo.ErrorMessage();
              Cursor_intestbo.Close();
              // * --- End Select
            } // End If
            /* If _continua=1 */
            if (CPLib.eqr(_continua,1)) {
              /* _ctotale := _ctotale + 1 */
              _ctotale = CPLib.Round(_ctotale+1,0);
              /* gMsgImp := 'Elaborazione Informazione N.: '+LRTrim(Str(_ctotale,15,0)) // Messaggio Import */
              gMsgImp = "Elaborazione Informazione N.: "+CPLib.LRTrim(CPLib.Str(_ctotale,15,0));
              m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
              /* _idereg := arfn_calc_idereg("I",qbe_rapd_chkdiana->NUMPROG,qbe_rapd_chkdiana->IDEREG) */
              _idereg = arfn_calc_ideregR.Make(m_Ctx,this).Run("I",Cursor_qbe_rapd_chkdiana.GetString("NUMPROG"),Cursor_qbe_rapd_chkdiana.GetString("IDEREG"));
              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '1' + _idereg */
              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"1"+_idereg;
              /* _flagrap := '' */
              _flagrap = "";
              /* If not(Empty(LRTrim(qbe_rapd_chkdiana->RAPPORTO))) */
              if ( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO"))))) {
                // * --- Select from knarapbo
                m_cServer = m_Ctx.GetServer("knarapbo");
                m_cPhName = m_Ctx.GetPhName("knarapbo");
                if (Cursor_knarapbo!=null)
                  Cursor_knarapbo.Close();
                Cursor_knarapbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select FLAGRAP  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("knarapbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                while ( ! (Cursor_knarapbo.Eof())) {
                  /* _flagrap := knarapbo->FLAGRAP */
                  _flagrap = Cursor_knarapbo.GetString("FLAGRAP");
                  Cursor_knarapbo.Next();
                }
                m_cConnectivityError = Cursor_knarapbo.ErrorMessage();
                Cursor_knarapbo.Close();
                // * --- End Select
              } // End If
              /* _datage := arfn_datidip_sol(qbe_rapd_chkdiana->CODDIPE,qbe_rapd_chkdiana->CODCAB,qbe_rapd_chkdiana->DESCCIT,qbe_rapd_chkdiana->PROVINCIA) */
              _datage = arfn_datidip_solR.Make(m_Ctx,this).Run(Cursor_qbe_rapd_chkdiana.GetString("CODDIPE"),Cursor_qbe_rapd_chkdiana.GetString("CODCAB"),Cursor_qbe_rapd_chkdiana.GetString("DESCCIT"),Cursor_qbe_rapd_chkdiana.GetString("PROVINCIA"));
              /* _tipoag := Right(_datage,10) */
              _tipoag = CPLib.Right(_datage,10);
              /* _note := _note + Left(_datage,44) */
              _note = _note+CPLib.Left(_datage,44);
              /* _note := _note + Left(LRTrim(DateToChar(qbe_rapd_chkdiana->DATAOPE))+Space(8),8) + Left(LRTrim(qbe_rapd_chkdiana->FLAGFRAZ)+" ",1) + Left(LRTrim(qbe_rapd_chkdiana->FLAGCONT)+" ",1) */
              _note = _note+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE")))+CPLib.Space(8),8)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapd_chkdiana.GetString("FLAGFRAZ"))+" ",1)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapd_chkdiana.GetString("FLAGCONT"))+" ",1);
              /* _note := _note + Left(LRTrim(qbe_rapd_chkdiana->CODANA)+Space(4),4) + Left(LRTrim(qbe_rapd_chkdiana->CODVOC)+Space(2),2) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapd_chkdiana.GetString("CODANA"))+CPLib.Space(4),4)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapd_chkdiana.GetString("CODVOC"))+CPLib.Space(2),2);
              /* _note := _note + Left(LRTrim(qbe_rapd_chkdiana->TIPOINT2)+Space(2),2) + Left(LRTrim(qbe_rapd_chkdiana->CODINT2)+Space(11),11) + Left(LRTrim(qbe_rapd_chkdiana->PAESE)+Space(3),3) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapd_chkdiana.GetString("TIPOINT2"))+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapd_chkdiana.GetString("CODINT2"))+CPLib.Space(11),11)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapd_chkdiana.GetString("PAESE"))+CPLib.Space(3),3);
              /* _note := _note + Left(LRTrim(qbe_rapd_chkdiana->CODCAB2)+Space(6),6) + Left(LRTrim(qbe_rapd_chkdiana->DESC2)+Space(30),30) + Left(LRTrim(qbe_rapd_chkdiana->PROV2)+Space(2),2) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapd_chkdiana.GetString("CODCAB2"))+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapd_chkdiana.GetString("DESC2"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapd_chkdiana.GetString("PROV2"))+CPLib.Space(2),2);
              /* _note := _note + Space(50) + Left(LRTrim(qbe_rapd_chkdiana->RAPPORTO)+Space(25),25) + Left(LRTrim(_flagrap)+" ",1) */
              _note = _note+CPLib.Space(50)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO"))+CPLib.Space(25),25)+CPLib.Left(CPLib.LRTrim(_flagrap)+" ",1);
              /* _note := _note + Left(LRTrim(qbe_rapd_chkdiana->TIPOLEG)+" ",1) + Left(LRTrim(DateToChar(qbe_rapd_chkdiana->DATAREG))+Space(8),8) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapd_chkdiana.GetString("TIPOLEG"))+" ",1)+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_qbe_rapd_chkdiana.GetDate("DATAREG")))+CPLib.Space(8),8);
              /* _note := _note + Left(LRTrim(qbe_rapd_chkdiana->TIPOOPRAP)+Space(2),2) + Left(LRTrim(qbe_rapd_chkdiana->COLLEG)+Space(12),12) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapd_chkdiana.GetString("TIPOOPRAP"))+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapd_chkdiana.GetString("COLLEG"))+CPLib.Space(12),12);
              /* _note := _note + Left(LRTrim(qbe_rapd_chkdiana->STATOREG)+" ",1)  */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapd_chkdiana.GetString("STATOREG"))+" ",1);
              /* If Empty(qbe_rapd_chkdiana->DATARETT) or DateToChar(qbe_rapd_chkdiana->DATARETT)='01000101' */
              if (CPLib.Empty(Cursor_qbe_rapd_chkdiana.GetDate("DATARETT")) || CPLib.eqr(CPLib.DateToChar(Cursor_qbe_rapd_chkdiana.GetDate("DATARETT")),"01000101")) {
                /* _note := _note + Space(8) */
                _note = _note+CPLib.Space(8);
              } else { // Else
                /* _note := _note + Left(LRTrim(DateToChar(qbe_rapd_chkdiana->DATARETT))+Space(8),8) */
                _note = _note+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_qbe_rapd_chkdiana.GetDate("DATARETT")))+CPLib.Space(8),8);
              } // End If
              /* If Left(qbe_rapd_chkdiana->OPERAZMOD,1)='I' */
              if (CPLib.eqr(CPLib.Left(Cursor_qbe_rapd_chkdiana.GetString("OPERAZMOD"),1),"I")) {
                /* _note := _note + iif(Empty(LRTrim(qbe_rapd_chkdiana->OPERAZMOD)),Space(20),qbe_rapd_chkdiana->OPERAZMOD) */
                _note = _note+(CPLib.Empty(CPLib.LRTrim(Cursor_qbe_rapd_chkdiana.GetString("OPERAZMOD")))?CPLib.Space(20):Cursor_qbe_rapd_chkdiana.GetString("OPERAZMOD"));
              } else { // Else
                /* _note := _note + iif(Empty(LRTrim(qbe_rapd_chkdiana->OPERAZMOD)),Space(20),Left(qbe_rapd_chkdiana->OPERAZMOD,8)+"I"+Right(qbe_rapd_chkdiana->OPERAZMOD,11)) */
                _note = _note+(CPLib.Empty(CPLib.LRTrim(Cursor_qbe_rapd_chkdiana.GetString("OPERAZMOD")))?CPLib.Space(20):CPLib.Left(Cursor_qbe_rapd_chkdiana.GetString("OPERAZMOD"),8)+"I"+CPLib.Right(Cursor_qbe_rapd_chkdiana.GetString("OPERAZMOD"),11));
              } // End If
              /* _note := _note + arfn_flaglire(qbe_rapd_chkdiana->RAPLIRE,qbe_rapd_chkdiana->DATAOPE) + Left(LRTrim(qbe_rapd_chkdiana->RAPVALUTA)+Space(3),3) + Left(LRTrim(qbe_rapd_chkdiana->SEGNO)+" ",1) */
              _note = _note+arfn_flaglireR.Make(m_Ctx,this).Run(Cursor_qbe_rapd_chkdiana.GetString("RAPLIRE"),Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"))+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapd_chkdiana.GetString("RAPVALUTA"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapd_chkdiana.GetString("SEGNO"))+" ",1);
              /* _note := _note +  Right('000000000000000'+LRTrim(Str(qbe_rapd_chkdiana->TOTLIRE,15,0)),15) + Right('000000000000000'+LRTrim(Str(qbe_rapd_chkdiana->TOTCONT,15,0)),15) + Space(47)+"I"+qbe_rapd_chkdiana->NUMPROG+Left(LRTrim(_tipoag)+Space(10),10) */
              _note = _note+CPLib.Right("000000000000000"+CPLib.LRTrim(CPLib.Str(Cursor_qbe_rapd_chkdiana.GetDouble("TOTLIRE"),15,0)),15)+CPLib.Right("000000000000000"+CPLib.LRTrim(CPLib.Str(Cursor_qbe_rapd_chkdiana.GetDouble("TOTCONT"),15,0)),15)+CPLib.Space(47)+"I"+Cursor_qbe_rapd_chkdiana.GetString("NUMPROG")+CPLib.Left(CPLib.LRTrim(_tipoag)+CPLib.Space(10),10);
              /* Exec "Scrittura Dati" Page 15:Page_19 */
              Page_19();
              /* nTotRec := nTotRec + 1 */
              nTotRec = CPLib.Round(nTotRec+1,0);
              /* nTotReg := nTotReg + 1 */
              nTotReg = CPLib.Round(nTotReg+1,0);
              /* nNumRec := nNumRec + 1 */
              nNumRec = CPLib.Round(nNumRec+1,0);
              /* Case At(qbe_rapd_chkdiana->TIPOOPRAP,'|25|28|39|41|40|47') > 0 */
              if (CPLib.gt(CPLib.At(Cursor_qbe_rapd_chkdiana.GetString("TIPOOPRAP"),"|25|28|39|41|40|47"),0)) {
                /* If qbe_rapd_chkdiana->TIPOOPRAP='25' or qbe_rapd_chkdiana->TIPOOPRAP='39' or qbe_rapd_chkdiana->TIPOOPRAP='40' */
                if (CPLib.eqr(Cursor_qbe_rapd_chkdiana.GetString("TIPOOPRAP"),"25") || CPLib.eqr(Cursor_qbe_rapd_chkdiana.GetString("TIPOOPRAP"),"39") || CPLib.eqr(Cursor_qbe_rapd_chkdiana.GetString("TIPOOPRAP"),"40")) {
                  /* If w_flgint = 'S' */
                  if (CPLib.eqr(w_flgint,"S")) {
                    // * --- Select from intestbo
                    m_cServer = m_Ctx.GetServer("intestbo");
                    m_cPhName = m_Ctx.GetPhName("intestbo");
                    if (Cursor_intestbo!=null)
                      Cursor_intestbo.Close();
                    Cursor_intestbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("intestbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                    while ( ! (Cursor_intestbo.Eof())) {
                      /* If intestbo->DATAINI <= qbe_rapd_chkdiana->DATAOPE and (intestbo->DATAFINE >= qbe_rapd_chkdiana->DATAOPE or Empty(intestbo->DATAFINE)) */
                      if (CPLib.le(Cursor_intestbo.GetDate("DATAINI"),Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE")) && (CPLib.ge(Cursor_intestbo.GetDate("DATAFINE"),Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE")) || CPLib.Empty(Cursor_intestbo.GetDate("DATAFINE")))) {
                        /* If qbe_rapd_chkdiana->DATAOPE > CharToDate('20131231') */
                        if (CPLib.gt(Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                          /* _tiprec := '7' */
                          _tiprec = "7";
                        } else { // Else
                          /* _tiprec := '2' */
                          _tiprec = "2";
                        } // End If
                        /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+_tiprec+_idereg */
                        _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+_tiprec+_idereg;
                        /* pCli := intestbo->CODINTER // Codice Soggetto */
                        pCli = Cursor_intestbo.GetString("CODINTER");
                        /* pDatOpe := iif(w_stoper='R',qbe_rapd_chkdiana->DATAREG,qbe_rapd_chkdiana->DATAOPE) // Data Operazione */
                        pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_rapd_chkdiana.GetDate("DATAREG"):Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"));
                        /* pRap := qbe_rapd_chkdiana->RAPPORTO // Codice Rapporto */
                        pRap = Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO");
                        /* pTRap := qbe_rapd_chkdiana->FLAGRAP // Tipo Rapporto */
                        pTRap = Cursor_qbe_rapd_chkdiana.GetString("FLAGRAP");
                        /* pTipoR := _tiprec // Tipo Riga */
                        pTipoR = _tiprec;
                        /* pRAE := _raeatc // RAE o ATECO */
                        pRAE = _raeatc;
                        /* pSTATO := qbe_rapd_chkdiana->STATOREG // Stato Registrazione */
                        pSTATO = Cursor_qbe_rapd_chkdiana.GetString("STATOREG");
                        /* pDatRet := qbe_rapd_chkdiana->DATARETT // Data Rettifica */
                        pDatRet = Cursor_qbe_rapd_chkdiana.GetDate("DATARETT");
                        /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                        DatiSoggetto();
                        /* Exec "Scrittura Dati" Page 15:Page_19 */
                        Page_19();
                        /* nTotRec := nTotRec + 1 */
                        nTotRec = CPLib.Round(nTotRec+1,0);
                        /* nNumRec := nNumRec + 1 */
                        nNumRec = CPLib.Round(nNumRec+1,0);
                      } // End If
                      Cursor_intestbo.Next();
                    }
                    m_cConnectivityError = Cursor_intestbo.ErrorMessage();
                    Cursor_intestbo.Close();
                    // * --- End Select
                  } // End If
                  // * --- Select from delegabo
                  m_cServer = m_Ctx.GetServer("delegabo");
                  m_cPhName = m_Ctx.GetPhName("delegabo");
                  if (Cursor_delegabo!=null)
                    Cursor_delegabo.Close();
                  Cursor_delegabo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO"),"?",0,0)+"  and  NUMPROG1="+CPLib.ToSQL(Cursor_qbe_rapd_chkdiana.GetString("NUMPROG"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("delegabo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                  while ( ! (Cursor_delegabo.Eof())) {
                    /* _avanza := 0 */
                    _avanza = CPLib.Round(0,0);
                    /* If Empty(delegabo->CODINTER) */
                    if (CPLib.Empty(Cursor_delegabo.GetString("CODINTER"))) {
                      /* _avanza := 1 */
                      _avanza = CPLib.Round(1,0);
                    } // End If
                    /* If _avanza=0 */
                    if (CPLib.eqr(_avanza,0)) {
                      /* If qbe_rapd_chkdiana->DATAOPE > CharToDate('20131231') */
                      if (CPLib.gt(Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                        /* _tiprec := '8' */
                        _tiprec = "8";
                      } else { // Else
                        /* _tiprec := '4' */
                        _tiprec = "4";
                      } // End If
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+_tiprec+_idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+_tiprec+_idereg;
                      /* pCli := delegabo->CODINTER // Codice Soggetto */
                      pCli = Cursor_delegabo.GetString("CODINTER");
                      /* pDatOpe := iif(w_stoper='R',qbe_rapd_chkdiana->DATAREG,qbe_rapd_chkdiana->DATAOPE) // Data Operazione */
                      pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_rapd_chkdiana.GetDate("DATAREG"):Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"));
                      /* pRap := qbe_rapd_chkdiana->RAPPORTO // Codice Rapporto */
                      pRap = Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO");
                      /* pTRap := qbe_rapd_chkdiana->FLAGRAP // Tipo Rapporto */
                      pTRap = Cursor_qbe_rapd_chkdiana.GetString("FLAGRAP");
                      /* pTipoR := _tiprec // Tipo Riga */
                      pTipoR = _tiprec;
                      /* pRAE := _raeatc // RAE o ATECO */
                      pRAE = _raeatc;
                      /* pSTATO := qbe_rapd_chkdiana->STATOREG // Stato Registrazione */
                      pSTATO = Cursor_qbe_rapd_chkdiana.GetString("STATOREG");
                      /* pDatRet := qbe_rapd_chkdiana->DATARETT // Data Rettifica */
                      pDatRet = Cursor_qbe_rapd_chkdiana.GetDate("DATARETT");
                      /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                      DatiSoggetto();
                      /* Exec "Scrittura Dati" Page 15:Page_19 */
                      Page_19();
                      /* nTotRec := nTotRec + 1 */
                      nTotRec = CPLib.Round(nTotRec+1,0);
                      /* nNumRec := nNumRec + 1 */
                      nNumRec = CPLib.Round(nNumRec+1,0);
                    } // End If
                    Cursor_delegabo.Next();
                  }
                  m_cConnectivityError = Cursor_delegabo.ErrorMessage();
                  Cursor_delegabo.Close();
                  // * --- End Select
                } else { // Else
                  /* If w_flgint = 'S' */
                  if (CPLib.eqr(w_flgint,"S")) {
                    // * --- Select from intestbo
                    m_cServer = m_Ctx.GetServer("intestbo");
                    m_cPhName = m_Ctx.GetPhName("intestbo");
                    if (Cursor_intestbo!=null)
                      Cursor_intestbo.Close();
                    Cursor_intestbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("intestbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                    while ( ! (Cursor_intestbo.Eof())) {
                      /* If intestbo->DATAINI <= qbe_rapd_chkdiana->DATAOPE and (intestbo->DATAFINE >= qbe_rapd_chkdiana->DATAOPE or Empty(intestbo->DATAFINE)) */
                      if (CPLib.le(Cursor_intestbo.GetDate("DATAINI"),Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE")) && (CPLib.ge(Cursor_intestbo.GetDate("DATAFINE"),Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE")) || CPLib.Empty(Cursor_intestbo.GetDate("DATAFINE")))) {
                        /* If qbe_rapd_chkdiana->DATAOPE > CharToDate('20131231') */
                        if (CPLib.gt(Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                          /* _tiprec := '7' */
                          _tiprec = "7";
                        } else { // Else
                          /* _tiprec := '2' */
                          _tiprec = "2";
                        } // End If
                        /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+_tiprec+_idereg */
                        _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+_tiprec+_idereg;
                        /* pCli := intestbo->CODINTER // Codice Soggetto */
                        pCli = Cursor_intestbo.GetString("CODINTER");
                        /* pDatOpe := iif(w_stoper='R',qbe_rapd_chkdiana->DATAREG,qbe_rapd_chkdiana->DATAOPE) // Data Operazione */
                        pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_rapd_chkdiana.GetDate("DATAREG"):Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"));
                        /* pRap := qbe_rapd_chkdiana->RAPPORTO // Codice Rapporto */
                        pRap = Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO");
                        /* pTRap := qbe_rapd_chkdiana->FLAGRAP // Tipo Rapporto */
                        pTRap = Cursor_qbe_rapd_chkdiana.GetString("FLAGRAP");
                        /* pTipoR := _tiprec // Tipo Riga */
                        pTipoR = _tiprec;
                        /* pRAE := _raeatc // RAE o ATECO */
                        pRAE = _raeatc;
                        /* pSTATO := qbe_rapd_chkdiana->STATOREG // Stato Registrazione */
                        pSTATO = Cursor_qbe_rapd_chkdiana.GetString("STATOREG");
                        /* pDatRet := qbe_rapd_chkdiana->DATARETT // Data Rettifica */
                        pDatRet = Cursor_qbe_rapd_chkdiana.GetDate("DATARETT");
                        /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                        DatiSoggetto();
                        /* Exec "Scrittura Dati" Page 15:Page_19 */
                        Page_19();
                        /* nTotRec := nTotRec + 1 */
                        nTotRec = CPLib.Round(nTotRec+1,0);
                        /* nNumRec := nNumRec + 1 */
                        nNumRec = CPLib.Round(nNumRec+1,0);
                      } // End If
                      Cursor_intestbo.Next();
                    }
                    m_cConnectivityError = Cursor_intestbo.ErrorMessage();
                    Cursor_intestbo.Close();
                    // * --- End Select
                  } // End If
                  // * --- Select from delegabo
                  m_cServer = m_Ctx.GetServer("delegabo");
                  m_cPhName = m_Ctx.GetPhName("delegabo");
                  if (Cursor_delegabo!=null)
                    Cursor_delegabo.Close();
                  Cursor_delegabo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO"),"?",0,0)+"  and  NUMPROG2="+CPLib.ToSQL(Cursor_qbe_rapd_chkdiana.GetString("NUMPROG"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("delegabo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                  while ( ! (Cursor_delegabo.Eof())) {
                    /* _avanza := 0 */
                    _avanza = CPLib.Round(0,0);
                    /* If Empty(delegabo->CODINTER) */
                    if (CPLib.Empty(Cursor_delegabo.GetString("CODINTER"))) {
                      /* _avanza := 1 */
                      _avanza = CPLib.Round(1,0);
                    } // End If
                    /* If _avanza=0 */
                    if (CPLib.eqr(_avanza,0)) {
                      /* If qbe_rapd_chkdiana->DATAOPE > CharToDate('20131231') */
                      if (CPLib.gt(Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                        /* _tiprec := '8' */
                        _tiprec = "8";
                      } else { // Else
                        /* _tiprec := '4' */
                        _tiprec = "4";
                      } // End If
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+_tiprec+_idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+_tiprec+_idereg;
                      /* pCli := delegabo->CODINTER // Codice Soggetto */
                      pCli = Cursor_delegabo.GetString("CODINTER");
                      /* pDatOpe := iif(w_stoper='R',qbe_rapd_chkdiana->DATAREG,qbe_rapd_chkdiana->DATAOPE) // Data Operazione */
                      pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_rapd_chkdiana.GetDate("DATAREG"):Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"));
                      /* pRap := qbe_rapd_chkdiana->RAPPORTO // Codice Rapporto */
                      pRap = Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO");
                      /* pTRap := qbe_rapd_chkdiana->FLAGRAP // Tipo Rapporto */
                      pTRap = Cursor_qbe_rapd_chkdiana.GetString("FLAGRAP");
                      /* pTipoR := _tiprec // Tipo Riga */
                      pTipoR = _tiprec;
                      /* pRAE := _raeatc // RAE o ATECO */
                      pRAE = _raeatc;
                      /* pSTATO := qbe_rapd_chkdiana->STATOREG // Stato Registrazione */
                      pSTATO = Cursor_qbe_rapd_chkdiana.GetString("STATOREG");
                      /* pDatRet := qbe_rapd_chkdiana->DATARETT // Data Rettifica */
                      pDatRet = Cursor_qbe_rapd_chkdiana.GetDate("DATARETT");
                      /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                      DatiSoggetto();
                      /* Exec "Scrittura Dati" Page 15:Page_19 */
                      Page_19();
                      /* nTotRec := nTotRec + 1 */
                      nTotRec = CPLib.Round(nTotRec+1,0);
                      /* nNumRec := nNumRec + 1 */
                      nNumRec = CPLib.Round(nNumRec+1,0);
                    } // End If
                    Cursor_delegabo.Next();
                  }
                  m_cConnectivityError = Cursor_delegabo.ErrorMessage();
                  Cursor_delegabo.Close();
                  // * --- End Select
                } // End If
                /* Case Right(qbe_rapd_chkdiana->TIPOOPRAP,1)='6' or qbe_rapd_chkdiana->TIPOOPRAP='38' */
              } else if (CPLib.eqr(CPLib.Right(Cursor_qbe_rapd_chkdiana.GetString("TIPOOPRAP"),1),"6") || CPLib.eqr(Cursor_qbe_rapd_chkdiana.GetString("TIPOOPRAP"),"38")) {
                // * --- Select from intestbo
                m_cServer = m_Ctx.GetServer("intestbo");
                m_cPhName = m_Ctx.GetPhName("intestbo");
                if (Cursor_intestbo!=null)
                  Cursor_intestbo.Close();
                Cursor_intestbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO"),"?",0,0)+"  and  NUMPROG2="+CPLib.ToSQL(Cursor_qbe_rapd_chkdiana.GetString("NUMPROG"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("intestbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                while ( ! (Cursor_intestbo.Eof())) {
                  /* _avanza := 0 */
                  _avanza = CPLib.Round(0,0);
                  /* If Empty(intestbo->CODINTER) */
                  if (CPLib.Empty(Cursor_intestbo.GetString("CODINTER"))) {
                    /* _avanza := 1 */
                    _avanza = CPLib.Round(1,0);
                  } // End If
                  /* If _avanza=0 */
                  if (CPLib.eqr(_avanza,0)) {
                    /* If qbe_rapd_chkdiana->DATAOPE > CharToDate('20131231') */
                    if (CPLib.gt(Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                      /* _tiprec := '7' */
                      _tiprec = "7";
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'7'+_idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                    } else { // Else
                      /* If qbe_rapd_chkdiana->DATAOPE > CharToDate('20100531') and qbe_rapd_chkdiana->DATAOPE < CharToDate('20140101') */
                      if (CPLib.gt(Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20100531")) && CPLib.lt(Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20140101"))) {
                        /* _tiprec := '2' */
                        _tiprec = "2";
                      } else { // Else
                        /* If Empty(qbe_rapd_chkdiana->CONNESOPER) or (qbe_rapd_chkdiana->CONNESOPER=intestbo->CODINTER) */
                        if (CPLib.Empty(Cursor_qbe_rapd_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(Cursor_qbe_rapd_chkdiana.GetString("CONNESOPER"),Cursor_intestbo.GetString("CODINTER")))) {
                          /* _tiprec := '2' */
                          _tiprec = "2";
                        } else { // Else
                          /* _tiprec := '3' */
                          _tiprec = "3";
                        } // End If
                      } // End If
                    } // End If
                    /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + _tiprec + _idereg */
                    _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+_tiprec+_idereg;
                    /* pCli := intestbo->CODINTER // Codice Soggetto */
                    pCli = Cursor_intestbo.GetString("CODINTER");
                    /* pDatOpe := iif(w_stoper='R',qbe_rapd_chkdiana->DATAREG,qbe_rapd_chkdiana->DATAOPE) // Data Operazione */
                    pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_rapd_chkdiana.GetDate("DATAREG"):Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"));
                    /* pRap := qbe_rapd_chkdiana->RAPPORTO // Codice Rapporto */
                    pRap = Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO");
                    /* pTRap := qbe_rapd_chkdiana->FLAGRAP // Tipo Rapporto */
                    pTRap = Cursor_qbe_rapd_chkdiana.GetString("FLAGRAP");
                    /* pTipoR := _tiprec // Tipo Riga */
                    pTipoR = _tiprec;
                    /* pRAE := _raeatc // RAE o ATECO */
                    pRAE = _raeatc;
                    /* pSTATO := qbe_rapd_chkdiana->STATOREG // Stato Registrazione */
                    pSTATO = Cursor_qbe_rapd_chkdiana.GetString("STATOREG");
                    /* pDatRet := qbe_rapd_chkdiana->DATARETT // Data Rettifica */
                    pDatRet = Cursor_qbe_rapd_chkdiana.GetDate("DATARETT");
                    /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                    DatiSoggetto();
                    /* Exec "Scrittura Dati" Page 15:Page_19 */
                    Page_19();
                    /* nTotRec := nTotRec + 1 */
                    nTotRec = CPLib.Round(nTotRec+1,0);
                    /* nNumRec := nNumRec + 1 */
                    nNumRec = CPLib.Round(nNumRec+1,0);
                    /* If qbe_rapd_chkdiana->FLAGTIT=1 and w_flg2020='S' */
                    if (CPLib.eqr(Cursor_qbe_rapd_chkdiana.GetDouble("FLAGTIT"),1) && CPLib.eqr(w_flg2020,"S")) {
                      // * --- Select from intestit
                      m_cServer = m_Ctx.GetServer("intestit");
                      m_cPhName = m_Ctx.GetPhName("intestit");
                      if (Cursor_intestit!=null)
                        Cursor_intestit.Close();
                      Cursor_intestit = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CODCLI="+CPLib.ToSQL(Cursor_intestbo.GetString("CODINTER"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("intestit")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                      while ( ! (Cursor_intestit.Eof())) {
                        /* If (Empty(intestit->DATAFINE) or intestit->DATAFINE >= qbe_rapd_chkdiana->DATAOPE) and intestit->DATAINI <= qbe_rapd_chkdiana->DATAOPE */
                        if ((CPLib.Empty(Cursor_intestit.GetDate("DATAFINE")) || CPLib.ge(Cursor_intestit.GetDate("DATAFINE"),Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"))) && CPLib.le(Cursor_intestit.GetDate("DATAINI"),Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"))) {
                          /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'6'+_idereg */
                          _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"6"+_idereg;
                          /* pCli := intestit->CODINTER // Codice Soggetto */
                          pCli = Cursor_intestit.GetString("CODINTER");
                          /* pDatOpe := iif(w_stoper='R',qbe_rapd_chkdiana->DATAREG,qbe_rapd_chkdiana->DATAOPE) // Data Operazione */
                          pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_rapd_chkdiana.GetDate("DATAREG"):Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"));
                          /* pRap := qbe_rapd_chkdiana->RAPPORTO // Codice Rapporto */
                          pRap = Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO");
                          /* pTRap := qbe_rapd_chkdiana->FLAGRAP // Tipo Rapporto */
                          pTRap = Cursor_qbe_rapd_chkdiana.GetString("FLAGRAP");
                          /* pTipoR := '6' // Tipo Riga */
                          pTipoR = "6";
                          /* pRAE := _raeatc // RAE o ATECO */
                          pRAE = _raeatc;
                          /* pSTATO := qbe_rapd_chkdiana->STATOREG // Stato Registrazione */
                          pSTATO = Cursor_qbe_rapd_chkdiana.GetString("STATOREG");
                          /* pDatRet := qbe_rapd_chkdiana->DATARETT // Data Rettifica */
                          pDatRet = Cursor_qbe_rapd_chkdiana.GetDate("DATARETT");
                          /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                          DatiSoggetto();
                          /* Exec "Scrittura Dati" Page 15:Page_19 */
                          Page_19();
                          /* nTotRec := nTotRec + 1 */
                          nTotRec = CPLib.Round(nTotRec+1,0);
                          /* nNumRec := nNumRec + 1 */
                          nNumRec = CPLib.Round(nNumRec+1,0);
                        } // End If
                        Cursor_intestit.Next();
                      }
                      m_cConnectivityError = Cursor_intestit.ErrorMessage();
                      Cursor_intestit.Close();
                      // * --- End Select
                    } // End If
                  } // End If
                  Cursor_intestbo.Next();
                }
                m_cConnectivityError = Cursor_intestbo.ErrorMessage();
                Cursor_intestbo.Close();
                // * --- End Select
                /* Case qbe_rapd_chkdiana->TIPOOPRAP='31' or qbe_rapd_chkdiana->TIPOOPRAP='32' */
              } else if (CPLib.eqr(Cursor_qbe_rapd_chkdiana.GetString("TIPOOPRAP"),"31") || CPLib.eqr(Cursor_qbe_rapd_chkdiana.GetString("TIPOOPRAP"),"32")) {
                // * --- Select from intestbo
                m_cServer = m_Ctx.GetServer("intestbo");
                m_cPhName = m_Ctx.GetPhName("intestbo");
                if (Cursor_intestbo!=null)
                  Cursor_intestbo.Close();
                Cursor_intestbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("intestbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                while ( ! (Cursor_intestbo.Eof())) {
                  /* _avanza := 0 */
                  _avanza = CPLib.Round(0,0);
                  /* If Empty(intestbo->CODINTER) */
                  if (CPLib.Empty(Cursor_intestbo.GetString("CODINTER"))) {
                    /* _avanza := 1 */
                    _avanza = CPLib.Round(1,0);
                  } // End If
                  /* If _avanza=0 */
                  if (CPLib.eqr(_avanza,0)) {
                    /* If qbe_rapd_chkdiana->DATAOPE > CharToDate('20131231') */
                    if (CPLib.gt(Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                      /* _tiprec := '7' */
                      _tiprec = "7";
                    } else { // Else
                      /* If qbe_rapd_chkdiana->DATAOPE > CharToDate('20100531') and qbe_rapd_chkdiana->DATAOPE < CharToDate('20140101') */
                      if (CPLib.gt(Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20100531")) && CPLib.lt(Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20140101"))) {
                        /* _tiprec := '2' */
                        _tiprec = "2";
                      } else { // Else
                        /* If Empty(qbe_rapd_chkdiana->CONNESOPER) or (qbe_rapd_chkdiana->CONNESOPER=intestbo->CODINTER) */
                        if (CPLib.Empty(Cursor_qbe_rapd_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(Cursor_qbe_rapd_chkdiana.GetString("CONNESOPER"),Cursor_intestbo.GetString("CODINTER")))) {
                          /* _tiprec := '2' */
                          _tiprec = "2";
                        } else { // Else
                          /* _tiprec := '3' */
                          _tiprec = "3";
                        } // End If
                      } // End If
                    } // End If
                    /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+_tiprec+_idereg */
                    _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+_tiprec+_idereg;
                    /* If qbe_rapd_chkdiana->TIPOOPRAP='31' */
                    if (CPLib.eqr(Cursor_qbe_rapd_chkdiana.GetString("TIPOOPRAP"),"31")) {
                      /* pCli := intestbo->CODINTER // Codice Soggetto */
                      pCli = Cursor_intestbo.GetString("CODINTER");
                      /* pDatOpe := iif(w_stoper='R',qbe_rapd_chkdiana->DATAREG,qbe_rapd_chkdiana->DATAOPE) // Data Operazione */
                      pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_rapd_chkdiana.GetDate("DATAREG"):Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"));
                      /* pRap := qbe_rapd_chkdiana->RAPPORTO // Codice Rapporto */
                      pRap = Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO");
                      /* pTRap := qbe_rapd_chkdiana->FLAGRAP // Tipo Rapporto */
                      pTRap = Cursor_qbe_rapd_chkdiana.GetString("FLAGRAP");
                      /* pTipoR := _tiprec // Tipo Riga */
                      pTipoR = _tiprec;
                      /* pRAE := _raeatc // RAE o ATECO */
                      pRAE = _raeatc;
                      /* pSTATO := qbe_rapd_chkdiana->STATOREG // Stato Registrazione */
                      pSTATO = Cursor_qbe_rapd_chkdiana.GetString("STATOREG");
                      /* pDatRet := qbe_rapd_chkdiana->DATARETT // Data Rettifica */
                      pDatRet = Cursor_qbe_rapd_chkdiana.GetDate("DATARETT");
                      /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                      DatiSoggetto();
                      /* ElseIf qbe_rapd_chkdiana->TIPOOPRAP='32' */
                    } else if (CPLib.eqr(Cursor_qbe_rapd_chkdiana.GetString("TIPOOPRAP"),"32")) {
                      /* pCli := intestbo->CODINTER // Codice Soggetto */
                      pCli = Cursor_intestbo.GetString("CODINTER");
                      /* pDatOpe := iif(w_stoper='R',qbe_rapd_chkdiana->DATAREG,qbe_rapd_chkdiana->DATAOPE) // Data Operazione */
                      pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_rapd_chkdiana.GetDate("DATAREG"):Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"));
                      /* pRap := qbe_rapd_chkdiana->RAPPORTO // Codice Rapporto */
                      pRap = Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO");
                      /* pTRap := qbe_rapd_chkdiana->FLAGRAP // Tipo Rapporto */
                      pTRap = Cursor_qbe_rapd_chkdiana.GetString("FLAGRAP");
                      /* pTipoR := _tiprec // Tipo Riga */
                      pTipoR = _tiprec;
                      /* pRAE := _raeatc // RAE o ATECO */
                      pRAE = _raeatc;
                      /* pSTATO := qbe_rapd_chkdiana->STATOREG // Stato Registrazione */
                      pSTATO = Cursor_qbe_rapd_chkdiana.GetString("STATOREG");
                      /* pDatRet := qbe_rapd_chkdiana->DATARETT // Data Rettifica */
                      pDatRet = Cursor_qbe_rapd_chkdiana.GetDate("DATARETT");
                      /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                      DatiSoggetto();
                    } // End If
                    /* Exec "Scrittura Dati" Page 15:Page_19 */
                    Page_19();
                    /* nTotRec := nTotRec + 1 */
                    nTotRec = CPLib.Round(nTotRec+1,0);
                    /* nNumRec := nNumRec + 1 */
                    nNumRec = CPLib.Round(nNumRec+1,0);
                    /* If qbe_rapd_chkdiana->FLAGTIT=1 and w_flg2020='S' */
                    if (CPLib.eqr(Cursor_qbe_rapd_chkdiana.GetDouble("FLAGTIT"),1) && CPLib.eqr(w_flg2020,"S")) {
                      // * --- Select from intestit
                      m_cServer = m_Ctx.GetServer("intestit");
                      m_cPhName = m_Ctx.GetPhName("intestit");
                      if (Cursor_intestit!=null)
                        Cursor_intestit.Close();
                      Cursor_intestit = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CODCLI="+CPLib.ToSQL(Cursor_intestbo.GetString("CODINTER"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("intestit")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                      while ( ! (Cursor_intestit.Eof())) {
                        /* If (Empty(intestit->DATAFINE) or intestit->DATAFINE >= qbe_rapd_chkdiana->DATAOPE) and intestit->DATAINI <= qbe_rapd_chkdiana->DATAOPE */
                        if ((CPLib.Empty(Cursor_intestit.GetDate("DATAFINE")) || CPLib.ge(Cursor_intestit.GetDate("DATAFINE"),Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"))) && CPLib.le(Cursor_intestit.GetDate("DATAINI"),Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"))) {
                          /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'6'+_idereg */
                          _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"6"+_idereg;
                          /* pCli := intestit->CODINTER // Codice Soggetto */
                          pCli = Cursor_intestit.GetString("CODINTER");
                          /* pDatOpe := iif(w_stoper='R',qbe_rapd_chkdiana->DATAREG,qbe_rapd_chkdiana->DATAOPE) // Data Operazione */
                          pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_rapd_chkdiana.GetDate("DATAREG"):Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"));
                          /* pRap := qbe_rapd_chkdiana->RAPPORTO // Codice Rapporto */
                          pRap = Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO");
                          /* pTRap := qbe_rapd_chkdiana->FLAGRAP // Tipo Rapporto */
                          pTRap = Cursor_qbe_rapd_chkdiana.GetString("FLAGRAP");
                          /* pTipoR := '6' // Tipo Riga */
                          pTipoR = "6";
                          /* pRAE := _raeatc // RAE o ATECO */
                          pRAE = _raeatc;
                          /* pSTATO := qbe_rapd_chkdiana->STATOREG // Stato Registrazione */
                          pSTATO = Cursor_qbe_rapd_chkdiana.GetString("STATOREG");
                          /* pDatRet := qbe_rapd_chkdiana->DATARETT // Data Rettifica */
                          pDatRet = Cursor_qbe_rapd_chkdiana.GetDate("DATARETT");
                          /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                          DatiSoggetto();
                          /* Exec "Scrittura Dati" Page 15:Page_19 */
                          Page_19();
                          /* nTotRec := nTotRec + 1 */
                          nTotRec = CPLib.Round(nTotRec+1,0);
                          /* nNumRec := nNumRec + 1 */
                          nNumRec = CPLib.Round(nNumRec+1,0);
                        } // End If
                        Cursor_intestit.Next();
                      }
                      m_cConnectivityError = Cursor_intestit.ErrorMessage();
                      Cursor_intestit.Close();
                      // * --- End Select
                    } // End If
                  } // End If
                  Cursor_intestbo.Next();
                }
                m_cConnectivityError = Cursor_intestbo.ErrorMessage();
                Cursor_intestbo.Close();
                // * --- End Select
                /* If w_flgdel='S' */
                if (CPLib.eqr(w_flgdel,"S")) {
                  // * --- Select from delegabo
                  m_cServer = m_Ctx.GetServer("delegabo");
                  m_cPhName = m_Ctx.GetPhName("delegabo");
                  if (Cursor_delegabo!=null)
                    Cursor_delegabo.Close();
                  Cursor_delegabo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO"),"?",0,0)+"  and  DATAINI <= "+CPLib.ToSQL(Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("delegabo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                  while ( ! (Cursor_delegabo.Eof())) {
                    /* If Empty(delegabo->DATAFINE) or delegabo->DATAFINE >= qbe_rapd_chkdiana->DATAOPE */
                    if (CPLib.Empty(Cursor_delegabo.GetDate("DATAFINE")) || CPLib.ge(Cursor_delegabo.GetDate("DATAFINE"),Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"))) {
                      /* _avanza := 0 */
                      _avanza = CPLib.Round(0,0);
                      /* If Empty(delegabo->CODINTER) */
                      if (CPLib.Empty(Cursor_delegabo.GetString("CODINTER"))) {
                        /* _avanza := 1 */
                        _avanza = CPLib.Round(1,0);
                      } // End If
                      /* If _avanza=0 */
                      if (CPLib.eqr(_avanza,0)) {
                        /* If qbe_rapd_chkdiana->DATAOPE > CharToDate('20131231') */
                        if (CPLib.gt(Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                          /* _tiprec := '8' */
                          _tiprec = "8";
                        } else { // Else
                          /* _tiprec := '4' */
                          _tiprec = "4";
                        } // End If
                        /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+_tiprec+_idereg */
                        _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+_tiprec+_idereg;
                        /* If qbe_rapd_chkdiana->TIPOOPRAP='31' */
                        if (CPLib.eqr(Cursor_qbe_rapd_chkdiana.GetString("TIPOOPRAP"),"31")) {
                          /* pCli := delegabo->CODINTER // Codice Soggetto */
                          pCli = Cursor_delegabo.GetString("CODINTER");
                          /* pDatOpe := iif(w_stoper='R',qbe_rapd_chkdiana->DATAREG,qbe_rapd_chkdiana->DATAOPE) // Data Operazione */
                          pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_rapd_chkdiana.GetDate("DATAREG"):Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"));
                          /* pRap := qbe_rapd_chkdiana->RAPPORTO // Codice Rapporto */
                          pRap = Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO");
                          /* pTRap := qbe_rapd_chkdiana->FLAGRAP // Tipo Rapporto */
                          pTRap = Cursor_qbe_rapd_chkdiana.GetString("FLAGRAP");
                          /* pTipoR := _tiprec // Tipo Riga */
                          pTipoR = _tiprec;
                          /* pRAE := _raeatc // RAE o ATECO */
                          pRAE = _raeatc;
                          /* pSTATO := qbe_rapd_chkdiana->STATOREG // Stato Registrazione */
                          pSTATO = Cursor_qbe_rapd_chkdiana.GetString("STATOREG");
                          /* pDatRet := qbe_rapd_chkdiana->DATARETT // Data Rettifica */
                          pDatRet = Cursor_qbe_rapd_chkdiana.GetDate("DATARETT");
                          /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                          DatiSoggetto();
                          /* ElseIf qbe_rapd_chkdiana->TIPOOPRAP='32' */
                        } else if (CPLib.eqr(Cursor_qbe_rapd_chkdiana.GetString("TIPOOPRAP"),"32")) {
                          /* pCli := delegabo->CODINTER // Codice Soggetto */
                          pCli = Cursor_delegabo.GetString("CODINTER");
                          /* pDatOpe := iif(w_stoper='R',qbe_rapd_chkdiana->DATAREG,qbe_rapd_chkdiana->DATAOPE) // Data Operazione */
                          pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_rapd_chkdiana.GetDate("DATAREG"):Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"));
                          /* pRap := qbe_rapd_chkdiana->RAPPORTO // Codice Rapporto */
                          pRap = Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO");
                          /* pTRap := qbe_rapd_chkdiana->FLAGRAP // Tipo Rapporto */
                          pTRap = Cursor_qbe_rapd_chkdiana.GetString("FLAGRAP");
                          /* pTipoR := _tiprec // Tipo Riga */
                          pTipoR = _tiprec;
                          /* pRAE := _raeatc // RAE o ATECO */
                          pRAE = _raeatc;
                          /* pSTATO := qbe_rapd_chkdiana->STATOREG // Stato Registrazione */
                          pSTATO = Cursor_qbe_rapd_chkdiana.GetString("STATOREG");
                          /* pDatRet := qbe_rapd_chkdiana->DATARETT // Data Rettifica */
                          pDatRet = Cursor_qbe_rapd_chkdiana.GetDate("DATARETT");
                          /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                          DatiSoggetto();
                        } // End If
                        /* Exec "Scrittura Dati" Page 15:Page_19 */
                        Page_19();
                        /* nTotRec := nTotRec + 1 */
                        nTotRec = CPLib.Round(nTotRec+1,0);
                        /* nNumRec := nNumRec + 1 */
                        nNumRec = CPLib.Round(nNumRec+1,0);
                      } // End If
                    } // End If
                    Cursor_delegabo.Next();
                  }
                  m_cConnectivityError = Cursor_delegabo.ErrorMessage();
                  Cursor_delegabo.Close();
                  // * --- End Select
                } // End If
              } else { // Otherwise
                // * --- Select from intestbo
                m_cServer = m_Ctx.GetServer("intestbo");
                m_cPhName = m_Ctx.GetPhName("intestbo");
                if (Cursor_intestbo!=null)
                  Cursor_intestbo.Close();
                Cursor_intestbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO"),"?",0,0)+"  and  NUMPROG1="+CPLib.ToSQL(Cursor_qbe_rapd_chkdiana.GetString("NUMPROG"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("intestbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                while ( ! (Cursor_intestbo.Eof())) {
                  /* _avanza := 0 */
                  _avanza = CPLib.Round(0,0);
                  /* If Empty(intestbo->CODINTER) */
                  if (CPLib.Empty(Cursor_intestbo.GetString("CODINTER"))) {
                    /* _avanza := 1 */
                    _avanza = CPLib.Round(1,0);
                  } // End If
                  /* If _avanza=0 */
                  if (CPLib.eqr(_avanza,0)) {
                    /* If qbe_rapd_chkdiana->DATAOPE > CharToDate('20131231') */
                    if (CPLib.gt(Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                      /* _tiprec := '7' */
                      _tiprec = "7";
                    } else { // Else
                      /* If qbe_rapd_chkdiana->DATAOPE > CharToDate('20100531') and qbe_rapd_chkdiana->DATAOPE < CharToDate('20140101') */
                      if (CPLib.gt(Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20100531")) && CPLib.lt(Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20140101"))) {
                        /* _tiprec := '2' */
                        _tiprec = "2";
                      } else { // Else
                        /* If Empty(qbe_rapd_chkdiana->CONNESOPER) or (qbe_rapd_chkdiana->CONNESOPER=intestbo->CODINTER) */
                        if (CPLib.Empty(Cursor_qbe_rapd_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(Cursor_qbe_rapd_chkdiana.GetString("CONNESOPER"),Cursor_intestbo.GetString("CODINTER")))) {
                          /* _tiprec := '2' */
                          _tiprec = "2";
                        } else { // Else
                          /* _tiprec := '3' */
                          _tiprec = "3";
                        } // End If
                      } // End If
                    } // End If
                    /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+_tiprec+_idereg */
                    _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+_tiprec+_idereg;
                    /* pCli := intestbo->CODINTER // Codice Soggetto */
                    pCli = Cursor_intestbo.GetString("CODINTER");
                    /* pDatOpe := iif(w_stoper='R',qbe_rapd_chkdiana->DATAREG,qbe_rapd_chkdiana->DATAOPE) // Data Operazione */
                    pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_rapd_chkdiana.GetDate("DATAREG"):Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"));
                    /* pRap := qbe_rapd_chkdiana->RAPPORTO // Codice Rapporto */
                    pRap = Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO");
                    /* pTRap := qbe_rapd_chkdiana->FLAGRAP // Tipo Rapporto */
                    pTRap = Cursor_qbe_rapd_chkdiana.GetString("FLAGRAP");
                    /* pTipoR := _tiprec // Tipo Riga */
                    pTipoR = _tiprec;
                    /* pRAE := _raeatc // RAE o ATECO */
                    pRAE = _raeatc;
                    /* pSTATO := qbe_rapd_chkdiana->STATOREG // Stato Registrazione */
                    pSTATO = Cursor_qbe_rapd_chkdiana.GetString("STATOREG");
                    /* pDatRet := qbe_rapd_chkdiana->DATARETT // Data Rettifica */
                    pDatRet = Cursor_qbe_rapd_chkdiana.GetDate("DATARETT");
                    /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                    DatiSoggetto();
                    /* Exec "Scrittura Dati" Page 15:Page_19 */
                    Page_19();
                    /* nTotRec := nTotRec + 1 */
                    nTotRec = CPLib.Round(nTotRec+1,0);
                    /* nNumRec := nNumRec + 1 */
                    nNumRec = CPLib.Round(nNumRec+1,0);
                    /* If qbe_rapd_chkdiana->FLAGTIT=1 and w_flg2020='S' */
                    if (CPLib.eqr(Cursor_qbe_rapd_chkdiana.GetDouble("FLAGTIT"),1) && CPLib.eqr(w_flg2020,"S")) {
                      // * --- Select from intestit
                      m_cServer = m_Ctx.GetServer("intestit");
                      m_cPhName = m_Ctx.GetPhName("intestit");
                      if (Cursor_intestit!=null)
                        Cursor_intestit.Close();
                      Cursor_intestit = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CODCLI="+CPLib.ToSQL(Cursor_intestbo.GetString("CODINTER"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("intestit")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                      while ( ! (Cursor_intestit.Eof())) {
                        /* If (Empty(intestit->DATAFINE) or intestit->DATAFINE >= qbe_rapd_chkdiana->DATAOPE) and intestit->DATAINI <= qbe_rapd_chkdiana->DATAOPE */
                        if ((CPLib.Empty(Cursor_intestit.GetDate("DATAFINE")) || CPLib.ge(Cursor_intestit.GetDate("DATAFINE"),Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"))) && CPLib.le(Cursor_intestit.GetDate("DATAINI"),Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"))) {
                          /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'6'+_idereg */
                          _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"6"+_idereg;
                          /* pCli := intestit->CODINTER // Codice Soggetto */
                          pCli = Cursor_intestit.GetString("CODINTER");
                          /* pDatOpe := iif(w_stoper='R',qbe_rapd_chkdiana->DATAREG,qbe_rapd_chkdiana->DATAOPE) // Data Operazione */
                          pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_rapd_chkdiana.GetDate("DATAREG"):Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"));
                          /* pRap := qbe_rapd_chkdiana->RAPPORTO // Codice Rapporto */
                          pRap = Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO");
                          /* pTRap := qbe_rapd_chkdiana->FLAGRAP // Tipo Rapporto */
                          pTRap = Cursor_qbe_rapd_chkdiana.GetString("FLAGRAP");
                          /* pTipoR := '6' // Tipo Riga */
                          pTipoR = "6";
                          /* pRAE := _raeatc // RAE o ATECO */
                          pRAE = _raeatc;
                          /* pSTATO := qbe_rapd_chkdiana->STATOREG // Stato Registrazione */
                          pSTATO = Cursor_qbe_rapd_chkdiana.GetString("STATOREG");
                          /* pDatRet := qbe_rapd_chkdiana->DATARETT // Data Rettifica */
                          pDatRet = Cursor_qbe_rapd_chkdiana.GetDate("DATARETT");
                          /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                          DatiSoggetto();
                          /* Exec "Scrittura Dati" Page 15:Page_19 */
                          Page_19();
                          /* nTotRec := nTotRec + 1 */
                          nTotRec = CPLib.Round(nTotRec+1,0);
                          /* nNumRec := nNumRec + 1 */
                          nNumRec = CPLib.Round(nNumRec+1,0);
                        } // End If
                        Cursor_intestit.Next();
                      }
                      m_cConnectivityError = Cursor_intestit.ErrorMessage();
                      Cursor_intestit.Close();
                      // * --- End Select
                    } // End If
                  } // End If
                  Cursor_intestbo.Next();
                }
                m_cConnectivityError = Cursor_intestbo.ErrorMessage();
                Cursor_intestbo.Close();
                // * --- End Select
              } // End Case
              /* If At(qbe_rapd_chkdiana->TIPOOPRAP,'|25|28|39|41|40|47') = 0 */
              if (CPLib.eqr(CPLib.At(Cursor_qbe_rapd_chkdiana.GetString("TIPOOPRAP"),"|25|28|39|41|40|47"),0)) {
                /* If not(Empty(qbe_rapd_chkdiana->CONNESOPER)) */
                if ( ! (CPLib.Empty(Cursor_qbe_rapd_chkdiana.GetString("CONNESOPER")))) {
                  /* If qbe_rapd_chkdiana->DATAOPE > CharToDate('20131231') */
                  if (CPLib.gt(Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                    /* _tiprec := '8' */
                    _tiprec = "8";
                  } else { // Else
                    /* _tiprec := '4' */
                    _tiprec = "4";
                  } // End If
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+_tiprec+_idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+_tiprec+_idereg;
                  /* pCli := qbe_rapd_chkdiana->CONNESOPER // Codice Soggetto */
                  pCli = Cursor_qbe_rapd_chkdiana.GetString("CONNESOPER");
                  /* pDatOpe := iif(w_stoper='R',qbe_rapd_chkdiana->DATAREG,qbe_rapd_chkdiana->DATAOPE) // Data Operazione */
                  pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_rapd_chkdiana.GetDate("DATAREG"):Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"));
                  /* pRap := qbe_rapd_chkdiana->RAPPORTO // Codice Rapporto */
                  pRap = Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO");
                  /* pTRap := qbe_rapd_chkdiana->FLAGRAP // Tipo Rapporto */
                  pTRap = Cursor_qbe_rapd_chkdiana.GetString("FLAGRAP");
                  /* pTipoR := _tiprec // Tipo Riga */
                  pTipoR = _tiprec;
                  /* pRAE := _raeatc // RAE o ATECO */
                  pRAE = _raeatc;
                  /* pSTATO := qbe_rapd_chkdiana->STATOREG // Stato Registrazione */
                  pSTATO = Cursor_qbe_rapd_chkdiana.GetString("STATOREG");
                  /* pDatRet := qbe_rapd_chkdiana->DATARETT // Data Rettifica */
                  pDatRet = Cursor_qbe_rapd_chkdiana.GetDate("DATARETT");
                  /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                  DatiSoggetto();
                  /* Exec "Scrittura Dati" Page 15:Page_19 */
                  Page_19();
                  /* nTotRec := nTotRec + 1 */
                  nTotRec = CPLib.Round(nTotRec+1,0);
                  /* nNumRec := nNumRec + 1 */
                  nNumRec = CPLib.Round(nNumRec+1,0);
                } // End If
                // * --- Select from fiduciabo
                m_cServer = m_Ctx.GetServer("fiduciabo");
                m_cPhName = m_Ctx.GetPhName("fiduciabo");
                if (Cursor_fiduciabo!=null)
                  Cursor_fiduciabo.Close();
                Cursor_fiduciabo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPCOL="+CPLib.ToSQL(Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("fiduciabo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                while ( ! (Cursor_fiduciabo.Eof())) {
                  /* _avanza := 0 */
                  _avanza = CPLib.Round(0,0);
                  /* If Empty(fiduciabo->CODSOG) */
                  if (CPLib.Empty(Cursor_fiduciabo.GetString("CODSOG"))) {
                    /* _avanza := 1 */
                    _avanza = CPLib.Round(1,0);
                  } // End If
                  /* If _avanza=0 */
                  if (CPLib.eqr(_avanza,0)) {
                    /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'9'+_idereg */
                    _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"9"+_idereg;
                    /* pCli := fiduciabo->CODSOG // Codice Soggetto */
                    pCli = Cursor_fiduciabo.GetString("CODSOG");
                    /* pDatOpe := iif(w_stoper='R',qbe_rapd_chkdiana->DATAREG,qbe_rapd_chkdiana->DATAOPE) // Data Operazione */
                    pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_rapd_chkdiana.GetDate("DATAREG"):Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"));
                    /* pRap := qbe_rapd_chkdiana->RAPPORTO // Codice Rapporto */
                    pRap = Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO");
                    /* pTRap := qbe_rapd_chkdiana->FLAGRAP // Tipo Rapporto */
                    pTRap = Cursor_qbe_rapd_chkdiana.GetString("FLAGRAP");
                    /* pTipoR := '9' // Tipo Riga */
                    pTipoR = "9";
                    /* pRAE := _raeatc // RAE o ATECO */
                    pRAE = _raeatc;
                    /* pSTATO := qbe_rapd_chkdiana->STATOREG // Stato Registrazione */
                    pSTATO = Cursor_qbe_rapd_chkdiana.GetString("STATOREG");
                    /* pDatRet := qbe_rapd_chkdiana->DATARETT // Data Rettifica */
                    pDatRet = Cursor_qbe_rapd_chkdiana.GetDate("DATARETT");
                    /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                    DatiSoggetto();
                    /* Exec "Scrittura Dati" Page 15:Page_19 */
                    Page_19();
                    /* nTotRec := nTotRec + 1 */
                    nTotRec = CPLib.Round(nTotRec+1,0);
                    /* nNumRec := nNumRec + 1 */
                    nNumRec = CPLib.Round(nNumRec+1,0);
                  } // End If
                  Cursor_fiduciabo.Next();
                }
                m_cConnectivityError = Cursor_fiduciabo.ErrorMessage();
                Cursor_fiduciabo.Close();
                // * --- End Select
                /* If w_flg2020='S' */
                if (CPLib.eqr(w_flg2020,"S")) {
                  // * --- Select from terzistirap
                  m_cServer = m_Ctx.GetServer("terzistirap");
                  m_cPhName = m_Ctx.GetPhName("terzistirap");
                  if (Cursor_terzistirap!=null)
                    Cursor_terzistirap.Close();
                  Cursor_terzistirap = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPCOL="+CPLib.ToSQL(Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("terzistirap")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                  while ( ! (Cursor_terzistirap.Eof())) {
                    /* _avanza := 0 */
                    _avanza = CPLib.Round(0,0);
                    /* If Empty(terzistirap->CODSOG) */
                    if (CPLib.Empty(Cursor_terzistirap.GetString("CODSOG"))) {
                      /* _avanza := 1 */
                      _avanza = CPLib.Round(1,0);
                    } // End If
                    /* If _avanza=0 */
                    if (CPLib.eqr(_avanza,0)) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'6'+_idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"6"+_idereg;
                      /* pCli := terzistirap->CODSOG // Codice Soggetto */
                      pCli = Cursor_terzistirap.GetString("CODSOG");
                      /* pDatOpe := iif(w_stoper='R',qbe_rapd_chkdiana->DATAREG,qbe_rapd_chkdiana->DATAOPE) // Data Operazione */
                      pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_rapd_chkdiana.GetDate("DATAREG"):Cursor_qbe_rapd_chkdiana.GetDate("DATAOPE"));
                      /* pRap := qbe_rapd_chkdiana->RAPPORTO // Codice Rapporto */
                      pRap = Cursor_qbe_rapd_chkdiana.GetString("RAPPORTO");
                      /* pTRap := qbe_rapd_chkdiana->FLAGRAP // Tipo Rapporto */
                      pTRap = Cursor_qbe_rapd_chkdiana.GetString("FLAGRAP");
                      /* pTipoR := '6' // Tipo Riga */
                      pTipoR = "6";
                      /* pRAE := _raeatc // RAE o ATECO */
                      pRAE = _raeatc;
                      /* pSTATO := qbe_rapd_chkdiana->STATOREG // Stato Registrazione */
                      pSTATO = Cursor_qbe_rapd_chkdiana.GetString("STATOREG");
                      /* pDatRet := qbe_rapd_chkdiana->DATARETT // Data Rettifica */
                      pDatRet = Cursor_qbe_rapd_chkdiana.GetDate("DATARETT");
                      /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                      DatiSoggetto();
                      /* Exec "Scrittura Dati" Page 15:Page_19 */
                      Page_19();
                      /* nTotRec := nTotRec + 1 */
                      nTotRec = CPLib.Round(nTotRec+1,0);
                      /* nNumRec := nNumRec + 1 */
                      nNumRec = CPLib.Round(nNumRec+1,0);
                    } // End If
                    Cursor_terzistirap.Next();
                  }
                  m_cConnectivityError = Cursor_terzistirap.ErrorMessage();
                  Cursor_terzistirap.Close();
                  // * --- End Select
                } // End If
              } // End If
            } // End If
            Cursor_qbe_rapd_chkdiana.Next();
          }
          m_cConnectivityError = Cursor_qbe_rapd_chkdiana.ErrorMessage();
          Cursor_qbe_rapd_chkdiana.Close();
          // * --- End Select
        } // End While
      } // End If
      /* If w_tipoarchp='S' */
      if (CPLib.eqr(w_tipoarchp,"S")) {
        // * --- Select from qbe_rapp_chkdiana
        if (Cursor_qbe_rapp_chkdiana!=null)
          Cursor_qbe_rapp_chkdiana.Close();
        Cursor_qbe_rapp_chkdiana = new VQRHolder("qbe_rapp_chkdiana",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),this,true).GetResultSet(m_Ctx);
        while ( ! (Cursor_qbe_rapp_chkdiana.Eof())) {
          /* _continua := 0 */
          _continua = CPLib.Round(0,0);
          /* If qbe_rapp_chkdiana->DATAOPE <  CharToDate('20100601') */
          if (CPLib.lt(Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20100601"))) {
            /* _raeatc := 'R' */
            _raeatc = "R";
            /* ElseIf qbe_rapp_chkdiana->DATAOPE >  CharToDate('20131231') */
          } else if (CPLib.gt(Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
            /* _raeatc := 'A' */
            _raeatc = "A";
          } else { // Else
            /* _raeatc := w_flgrae */
            _raeatc = w_flgrae;
          } // End If
          /* Case w_flgrap='N' or (w_flgrap='S' and w_tiprap='3') */
          if (CPLib.eqr(w_flgrap,"N") || (CPLib.eqr(w_flgrap,"S") && CPLib.eqr(w_tiprap,"3"))) {
            /* _continua := 1 */
            _continua = CPLib.Round(1,0);
            /* Case w_flgrap='S' and w_tiprap='1' */
          } else if (CPLib.eqr(w_flgrap,"S") && CPLib.eqr(w_tiprap,"1")) {
            /* _continua := 1 */
            _continua = CPLib.Round(1,0);
            // * --- Select from xapopebo
            m_cServer = m_Ctx.GetServer("xapopebo");
            m_cPhName = m_Ctx.GetPhName("xapopebo");
            if (Cursor_xapopebo!=null)
              Cursor_xapopebo.Close();
            Cursor_xapopebo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xapopebo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1")+" order by "+"DATAOPE ",m_cServer,m_Ctx,true));
            while ( ! (Cursor_xapopebo.Eof())) {
              /* Case xapopebo->TIPOOPRAP='25' or qbe_rapp_chkdiana->TIPOOPRAP='28' */
              if (CPLib.eqr(Cursor_xapopebo.GetString("TIPOOPRAP"),"25") || CPLib.eqr(Cursor_qbe_rapp_chkdiana.GetString("TIPOOPRAP"),"28")) {
                /* Case Right(xapopebo->TIPOOPRAP,1)='6' or xapopebo->TIPOOPRAP='38' */
              } else if (CPLib.eqr(CPLib.Right(Cursor_xapopebo.GetString("TIPOOPRAP"),1),"6") || CPLib.eqr(Cursor_xapopebo.GetString("TIPOOPRAP"),"38")) {
                /* If xapopebo->DATAOPE < w_DaData */
                if (CPLib.lt(Cursor_xapopebo.GetDate("DATAOPE"),w_DaData)) {
                  /* _continua := 0 */
                  _continua = CPLib.Round(0,0);
                } // End If
                /* Case xapopebo->TIPOOPRAP='31' or xapopebo->TIPOOPRAP='32' */
              } else if (CPLib.eqr(Cursor_xapopebo.GetString("TIPOOPRAP"),"31") || CPLib.eqr(Cursor_xapopebo.GetString("TIPOOPRAP"),"32")) {
              } else { // Otherwise
                /* If xapopebo->DATAOPE > w_AData */
                if (CPLib.gt(Cursor_xapopebo.GetDate("DATAOPE"),w_AData)) {
                  /* _continua := 0 */
                  _continua = CPLib.Round(0,0);
                } // End If
              } // End Case
              Cursor_xapopebo.Next();
            }
            m_cConnectivityError = Cursor_xapopebo.ErrorMessage();
            Cursor_xapopebo.Close();
            // * --- End Select
            /* Case w_flgrap='S' and w_tiprap='2' */
          } else if (CPLib.eqr(w_flgrap,"S") && CPLib.eqr(w_tiprap,"2")) {
            /* Case xapopebo->TIPOOPRAP='25' or qbe_rapp_chkdiana->TIPOOPRAP='28' */
            if (CPLib.eqr(Cursor_xapopebo.GetString("TIPOOPRAP"),"25") || CPLib.eqr(Cursor_qbe_rapp_chkdiana.GetString("TIPOOPRAP"),"28")) {
              /* Case Right(xapopebo->TIPOOPRAP,1)='6' or xapopebo->TIPOOPRAP='38' */
            } else if (CPLib.eqr(CPLib.Right(Cursor_xapopebo.GetString("TIPOOPRAP"),1),"6") || CPLib.eqr(Cursor_xapopebo.GetString("TIPOOPRAP"),"38")) {
              /* If xapopebo->DATAOPE > w_AData */
              if (CPLib.gt(Cursor_xapopebo.GetDate("DATAOPE"),w_AData)) {
                /* _continua := 0 */
                _continua = CPLib.Round(0,0);
              } // End If
              /* Case xapopebo->TIPOOPRAP='31' or xapopebo->TIPOOPRAP='32' */
            } else if (CPLib.eqr(Cursor_xapopebo.GetString("TIPOOPRAP"),"31") || CPLib.eqr(Cursor_xapopebo.GetString("TIPOOPRAP"),"32")) {
            } else { // Otherwise
              /* If xapopebo->DATAOPE > w_AData */
              if (CPLib.gt(Cursor_xapopebo.GetDate("DATAOPE"),w_AData)) {
                /* _continua := 0 */
                _continua = CPLib.Round(0,0);
              } // End If
            } // End Case
          } // End Case
          /* If not(Empty(w_codcli)) and _continua=1 */
          if ( ! (CPLib.Empty(w_codcli)) && CPLib.eqr(_continua,1)) {
            /* _continua := 0 */
            _continua = CPLib.Round(0,0);
            // * --- Select from xntestbo
            m_cServer = m_Ctx.GetServer("xntestbo");
            m_cPhName = m_Ctx.GetPhName("xntestbo");
            if (Cursor_xntestbo!=null)
              Cursor_xntestbo.Close();
            Cursor_xntestbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xntestbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_xntestbo.Eof())) {
              /* If xntestbo->CODINTER=w_codcli */
              if (CPLib.eqr(Cursor_xntestbo.GetString("CODINTER"),w_codcli)) {
                /* _continua := 1 */
                _continua = CPLib.Round(1,0);
              } // End If
              Cursor_xntestbo.Next();
            }
            m_cConnectivityError = Cursor_xntestbo.ErrorMessage();
            Cursor_xntestbo.Close();
            // * --- End Select
          } // End If
          /* If _continua=1 */
          if (CPLib.eqr(_continua,1)) {
            /* _ctotale := _ctotale + 1 */
            _ctotale = CPLib.Round(_ctotale+1,0);
            /* gMsgImp := 'Elaborazione Informazione N.: '+LRTrim(Str(_ctotale,15,0)) // Messaggio Import */
            gMsgImp = "Elaborazione Informazione N.: "+CPLib.LRTrim(CPLib.Str(_ctotale,15,0));
            m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
            /* _idereg := arfn_calc_idereg("I",qbe_rapp_chkdiana->NUMPROG,qbe_rapp_chkdiana->IDEREG) */
            _idereg = arfn_calc_ideregR.Make(m_Ctx,this).Run("I",Cursor_qbe_rapp_chkdiana.GetString("NUMPROG"),Cursor_qbe_rapp_chkdiana.GetString("IDEREG"));
            /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '1'+_idereg */
            _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"1"+_idereg;
            /* _flagrap := '' */
            _flagrap = "";
            /* _datage := arfn_datidip_sol(qbe_rapp_chkdiana->CODDIPE,qbe_rapp_chkdiana->CODCAB,qbe_rapp_chkdiana->DESCCIT,qbe_rapp_chkdiana->PROVINCIA) */
            _datage = arfn_datidip_solR.Make(m_Ctx,this).Run(Cursor_qbe_rapp_chkdiana.GetString("CODDIPE"),Cursor_qbe_rapp_chkdiana.GetString("CODCAB"),Cursor_qbe_rapp_chkdiana.GetString("DESCCIT"),Cursor_qbe_rapp_chkdiana.GetString("PROVINCIA"));
            /* _tipoag := Right(_datage,10) */
            _tipoag = CPLib.Right(_datage,10);
            /* _note := _note + Left(_datage,44) */
            _note = _note+CPLib.Left(_datage,44);
            /* _note := _note + Left(LRTrim(DateToChar(qbe_rapp_chkdiana->DATAOPE))+Space(8),8) + Left(LRTrim(qbe_rapp_chkdiana->FLAGFRAZ)+" ",1) + Left(LRTrim(qbe_rapp_chkdiana->FLAGCONT)+" ",1) */
            _note = _note+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE")))+CPLib.Space(8),8)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapp_chkdiana.GetString("FLAGFRAZ"))+" ",1)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapp_chkdiana.GetString("FLAGCONT"))+" ",1);
            /* _note := _note + Left(LRTrim(qbe_rapp_chkdiana->CODANA)+Space(4),4) + Left(LRTrim(qbe_rapp_chkdiana->CODVOC)+Space(2),2) */
            _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapp_chkdiana.GetString("CODANA"))+CPLib.Space(4),4)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapp_chkdiana.GetString("CODVOC"))+CPLib.Space(2),2);
            /* _note := _note + Left(LRTrim(qbe_rapp_chkdiana->TIPOINT2)+Space(2),2) + Left(LRTrim(qbe_rapp_chkdiana->CODINT2)+Space(11),11) + Left(LRTrim(qbe_rapp_chkdiana->PAESE)+Space(3),3) */
            _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapp_chkdiana.GetString("TIPOINT2"))+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapp_chkdiana.GetString("CODINT2"))+CPLib.Space(11),11)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapp_chkdiana.GetString("PAESE"))+CPLib.Space(3),3);
            /* _note := _note + Left(LRTrim(qbe_rapp_chkdiana->CODCAB2)+Space(6),6) + Left(LRTrim(qbe_rapp_chkdiana->DESC2)+Space(30),30) + Left(LRTrim(qbe_rapp_chkdiana->PROV2)+Space(2),2) */
            _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapp_chkdiana.GetString("CODCAB2"))+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapp_chkdiana.GetString("DESC2"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapp_chkdiana.GetString("PROV2"))+CPLib.Space(2),2);
            /* _note := _note + Space(50) + Left(LRTrim(qbe_rapp_chkdiana->RAPPORTO)+Space(25),25) + Left(LRTrim(_flagrap)+" ",1) */
            _note = _note+CPLib.Space(50)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO"))+CPLib.Space(25),25)+CPLib.Left(CPLib.LRTrim(_flagrap)+" ",1);
            /* _note := _note + Left(LRTrim(qbe_rapp_chkdiana->TIPOLEG)+" ",1) + Left(LRTrim(DateToChar(Date()))+Space(8),8) */
            _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapp_chkdiana.GetString("TIPOLEG"))+" ",1)+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(CPLib.Date()))+CPLib.Space(8),8);
            /* _note := _note + Left(LRTrim(qbe_rapp_chkdiana->TIPOOPRAP)+Space(2),2) + Left(LRTrim(qbe_rapp_chkdiana->COLLEG)+Space(12),12) */
            _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapp_chkdiana.GetString("TIPOOPRAP"))+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapp_chkdiana.GetString("COLLEG"))+CPLib.Space(12),12);
            /* _note := _note + Left(LRTrim(qbe_rapp_chkdiana->STATOREG)+" ",1)  */
            _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapp_chkdiana.GetString("STATOREG"))+" ",1);
            /* If Empty(qbe_rapp_chkdiana->DATARETT) or DateToChar(qbe_rapp_chkdiana->DATARETT)='01000101' */
            if (CPLib.Empty(Cursor_qbe_rapp_chkdiana.GetDate("DATARETT")) || CPLib.eqr(CPLib.DateToChar(Cursor_qbe_rapp_chkdiana.GetDate("DATARETT")),"01000101")) {
              /* _note := _note + Space(8) */
              _note = _note+CPLib.Space(8);
            } else { // Else
              /* _note := _note + Left(LRTrim(DateToChar(qbe_rapp_chkdiana->DATARETT))+Space(8),8) */
              _note = _note+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_qbe_rapp_chkdiana.GetDate("DATARETT")))+CPLib.Space(8),8);
            } // End If
            /* If Left(qbe_rapp_chkdiana->OPERAZMOD,1)='I' */
            if (CPLib.eqr(CPLib.Left(Cursor_qbe_rapp_chkdiana.GetString("OPERAZMOD"),1),"I")) {
              /* _note := _note + iif(Empty(LRTrim(qbe_rapp_chkdiana->OPERAZMOD)),Space(20),qbe_rapp_chkdiana->OPERAZMOD) */
              _note = _note+(CPLib.Empty(CPLib.LRTrim(Cursor_qbe_rapp_chkdiana.GetString("OPERAZMOD")))?CPLib.Space(20):Cursor_qbe_rapp_chkdiana.GetString("OPERAZMOD"));
            } else { // Else
              /* _note := _note + iif(Empty(LRTrim(qbe_rapp_chkdiana->OPERAZMOD)),Space(20),Left(qbe_rapp_chkdiana->OPERAZMOD,8)+"I"+Right(qbe_rapp_chkdiana->OPERAZMOD,11)) */
              _note = _note+(CPLib.Empty(CPLib.LRTrim(Cursor_qbe_rapp_chkdiana.GetString("OPERAZMOD")))?CPLib.Space(20):CPLib.Left(Cursor_qbe_rapp_chkdiana.GetString("OPERAZMOD"),8)+"I"+CPLib.Right(Cursor_qbe_rapp_chkdiana.GetString("OPERAZMOD"),11));
            } // End If
            /* _note := _note + arfn_flaglire(qbe_rapp_chkdiana->RAPLIRE,qbe_rapp_chkdiana->DATAOPE) + Left(LRTrim(qbe_rapp_chkdiana->RAPVALUTA)+Space(3),3) + Left(LRTrim(qbe_rapp_chkdiana->SEGNO)+" ",1) */
            _note = _note+arfn_flaglireR.Make(m_Ctx,this).Run(Cursor_qbe_rapp_chkdiana.GetString("RAPLIRE"),Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"))+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapp_chkdiana.GetString("RAPVALUTA"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_rapp_chkdiana.GetString("SEGNO"))+" ",1);
            /* _note := _note +  Right('000000000000000'+LRTrim(Str(qbe_rapp_chkdiana->TOTLIRE,15,0)),15) + Right('000000000000000'+LRTrim(Str(qbe_rapp_chkdiana->TOTCONT,15,0)),15)  + Space(47)+"I"+qbe_rapp_chkdiana->NUMPROG+Left(LRTrim(_tipoag)+Space(10),10) */
            _note = _note+CPLib.Right("000000000000000"+CPLib.LRTrim(CPLib.Str(Cursor_qbe_rapp_chkdiana.GetDouble("TOTLIRE"),15,0)),15)+CPLib.Right("000000000000000"+CPLib.LRTrim(CPLib.Str(Cursor_qbe_rapp_chkdiana.GetDouble("TOTCONT"),15,0)),15)+CPLib.Space(47)+"I"+Cursor_qbe_rapp_chkdiana.GetString("NUMPROG")+CPLib.Left(CPLib.LRTrim(_tipoag)+CPLib.Space(10),10);
            /* Exec "Scrittura Dati" Page 15:Page_19 */
            Page_19();
            /* nTotRec := nTotRec + 1 */
            nTotRec = CPLib.Round(nTotRec+1,0);
            /* nTotReg := nTotReg + 1 */
            nTotReg = CPLib.Round(nTotReg+1,0);
            /* nNumRec := nNumRec + 1 */
            nNumRec = CPLib.Round(nNumRec+1,0);
            /* Case qbe_rapp_chkdiana->TIPOOPRAP='25' or qbe_rapp_chkdiana->TIPOOPRAP='28' */
            if (CPLib.eqr(Cursor_qbe_rapp_chkdiana.GetString("TIPOOPRAP"),"25") || CPLib.eqr(Cursor_qbe_rapp_chkdiana.GetString("TIPOOPRAP"),"28")) {
              /* If qbe_rapp_chkdiana->TIPOOPRAP='25' */
              if (CPLib.eqr(Cursor_qbe_rapp_chkdiana.GetString("TIPOOPRAP"),"25")) {
                /* If w_flgint = 'S' */
                if (CPLib.eqr(w_flgint,"S")) {
                  // * --- Select from xntestbo
                  m_cServer = m_Ctx.GetServer("xntestbo");
                  m_cPhName = m_Ctx.GetPhName("xntestbo");
                  if (Cursor_xntestbo!=null)
                    Cursor_xntestbo.Close();
                  Cursor_xntestbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xntestbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                  while ( ! (Cursor_xntestbo.Eof())) {
                    /* If xntestbo->DATAINI <= qbe_rapp_chkdiana->DATAOPE and (xntestbo->DATAFINE >= qbe_rapp_chkdiana->DATAOPE or Empty(xntestbo->DATAFINE)) */
                    if (CPLib.le(Cursor_xntestbo.GetDate("DATAINI"),Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE")) && (CPLib.ge(Cursor_xntestbo.GetDate("DATAFINE"),Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE")) || CPLib.Empty(Cursor_xntestbo.GetDate("DATAFINE")))) {
                      /* If qbe_rapp_chkdiana->DATAOPE > CharToDate('20131231') */
                      if (CPLib.gt(Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                        /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'7'+_idereg */
                        _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                        /* pTipoR := '7' // Tipo Riga */
                        pTipoR = "7";
                      } else { // Else
                        /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'2'+_idereg */
                        _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                        /* pTipoR := '2' // Tipo Riga */
                        pTipoR = "2";
                      } // End If
                      /* pCli := xntestbo->CODINTER // Codice Soggetto */
                      pCli = Cursor_xntestbo.GetString("CODINTER");
                      /* pDatOpe := qbe_rapp_chkdiana->DATAOPE // Data Operazione */
                      pDatOpe = Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE");
                      /* pRap := qbe_rapp_chkdiana->RAPPORTO // Codice Rapporto */
                      pRap = Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO");
                      /* pTRap := qbe_rapp_chkdiana->FLAGRAP // Tipo Rapporto */
                      pTRap = Cursor_qbe_rapp_chkdiana.GetString("FLAGRAP");
                      /* pRAE := _raeatc // RAE o ATECO */
                      pRAE = _raeatc;
                      /* pSTATO := qbe_rapp_chkdiana->STATOREG // Stato Registrazione */
                      pSTATO = Cursor_qbe_rapp_chkdiana.GetString("STATOREG");
                      /* pDatRet := qbe_rapp_chkdiana->DATARETT // Data Rettifica */
                      pDatRet = Cursor_qbe_rapp_chkdiana.GetDate("DATARETT");
                      /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                      DatiSoggetto();
                      /* Exec "Scrittura Dati" Page 15:Page_19 */
                      Page_19();
                      /* nTotRec := nTotRec + 1 */
                      nTotRec = CPLib.Round(nTotRec+1,0);
                      /* nNumRec := nNumRec + 1 */
                      nNumRec = CPLib.Round(nNumRec+1,0);
                    } // End If
                    Cursor_xntestbo.Next();
                  }
                  m_cConnectivityError = Cursor_xntestbo.ErrorMessage();
                  Cursor_xntestbo.Close();
                  // * --- End Select
                } // End If
                // * --- Select from xelegabo
                m_cServer = m_Ctx.GetServer("xelegabo");
                m_cPhName = m_Ctx.GetPhName("xelegabo");
                if (Cursor_xelegabo!=null)
                  Cursor_xelegabo.Close();
                Cursor_xelegabo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO"),"?",0,0)+"  and  NUMPROG1="+CPLib.ToSQL(Cursor_qbe_rapp_chkdiana.GetString("NUMPROG"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xelegabo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                while ( ! (Cursor_xelegabo.Eof())) {
                  /* _avanza := 0 */
                  _avanza = CPLib.Round(0,0);
                  /* If Empty(xelegabo->CODINTER) */
                  if (CPLib.Empty(Cursor_xelegabo.GetString("CODINTER"))) {
                    /* _avanza := 1 */
                    _avanza = CPLib.Round(1,0);
                  } // End If
                  /* If _avanza=0 */
                  if (CPLib.eqr(_avanza,0)) {
                    /* If qbe_rapp_chkdiana->DATAOPE > CharToDate('20131231') */
                    if (CPLib.gt(Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'8'+_idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"8"+_idereg;
                      /* pTipoR := '8' // Tipo Riga */
                      pTipoR = "8";
                    } else { // Else
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'4'+_idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"4"+_idereg;
                      /* pTipoR := '4' // Tipo Riga */
                      pTipoR = "4";
                    } // End If
                    /* pCli := xelegabo->CODINTER // Codice Soggetto */
                    pCli = Cursor_xelegabo.GetString("CODINTER");
                    /* pDatOpe := qbe_rapp_chkdiana->DATAOPE // Data Operazione */
                    pDatOpe = Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE");
                    /* pRap := qbe_rapp_chkdiana->RAPPORTO // Codice Rapporto */
                    pRap = Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO");
                    /* pTRap := qbe_rapp_chkdiana->FLAGRAP // Tipo Rapporto */
                    pTRap = Cursor_qbe_rapp_chkdiana.GetString("FLAGRAP");
                    /* pRAE := _raeatc // RAE o ATECO */
                    pRAE = _raeatc;
                    /* pSTATO := qbe_rapp_chkdiana->STATOREG // Stato Registrazione */
                    pSTATO = Cursor_qbe_rapp_chkdiana.GetString("STATOREG");
                    /* pDatRet := qbe_rapp_chkdiana->DATARETT // Data Rettifica */
                    pDatRet = Cursor_qbe_rapp_chkdiana.GetDate("DATARETT");
                    /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                    DatiSoggetto();
                    /* Exec "Scrittura Dati" Page 15:Page_19 */
                    Page_19();
                    /* nTotRec := nTotRec + 1 */
                    nTotRec = CPLib.Round(nTotRec+1,0);
                    /* nNumRec := nNumRec + 1 */
                    nNumRec = CPLib.Round(nNumRec+1,0);
                  } // End If
                  Cursor_xelegabo.Next();
                }
                m_cConnectivityError = Cursor_xelegabo.ErrorMessage();
                Cursor_xelegabo.Close();
                // * --- End Select
              } else { // Else
                /* If w_flgint = 'S' */
                if (CPLib.eqr(w_flgint,"S")) {
                  // * --- Select from xntestbo
                  m_cServer = m_Ctx.GetServer("xntestbo");
                  m_cPhName = m_Ctx.GetPhName("xntestbo");
                  if (Cursor_xntestbo!=null)
                    Cursor_xntestbo.Close();
                  Cursor_xntestbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xntestbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                  while ( ! (Cursor_xntestbo.Eof())) {
                    /* If xntestbo->DATAINI <= qbe_rapp_chkdiana->DATAOPE and (xntestbo->DATAFINE >= qbe_rapp_chkdiana->DATAOPE or Empty(xntestbo->DATAFINE)) */
                    if (CPLib.le(Cursor_xntestbo.GetDate("DATAINI"),Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE")) && (CPLib.ge(Cursor_xntestbo.GetDate("DATAFINE"),Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE")) || CPLib.Empty(Cursor_xntestbo.GetDate("DATAFINE")))) {
                      /* If qbe_rapp_chkdiana->DATAOPE > CharToDate('20131231') */
                      if (CPLib.gt(Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                        /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'7'+_idereg */
                        _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                        /* pTipoR := '7' // Tipo Riga */
                        pTipoR = "7";
                      } else { // Else
                        /* If qbe_rapp_chkdiana->DATAOPE > CharToDate('20100531') and qbe_rapp_chkdiana->DATAOPE < CharToDate('20140101') */
                        if (CPLib.gt(Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20100531")) && CPLib.lt(Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20140101"))) {
                          /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'2'+_idereg */
                          _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                          /* pTipoR := '2' // Tipo Riga */
                          pTipoR = "2";
                        } else { // Else
                          /* If Empty(qbe_rapp_chkdiana->CONNESOPER) or (qbe_rapp_chkdiana->CONNESOPER=xntestbo->CODINTER) */
                          if (CPLib.Empty(Cursor_qbe_rapp_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(Cursor_qbe_rapp_chkdiana.GetString("CONNESOPER"),Cursor_xntestbo.GetString("CODINTER")))) {
                            /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                            _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                            /* pTipoR := '2' // Tipo Riga */
                            pTipoR = "2";
                          } else { // Else
                            /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                            _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                            /* pTipoR := '3' // Tipo Riga */
                            pTipoR = "3";
                          } // End If
                        } // End If
                      } // End If
                      /* pCli := xntestbo->CODINTER // Codice Soggetto */
                      pCli = Cursor_xntestbo.GetString("CODINTER");
                      /* pDatOpe := qbe_rapp_chkdiana->DATAOPE // Data Operazione */
                      pDatOpe = Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE");
                      /* pRap := qbe_rapp_chkdiana->RAPPORTO // Codice Rapporto */
                      pRap = Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO");
                      /* pTRap := qbe_rapp_chkdiana->FLAGRAP // Tipo Rapporto */
                      pTRap = Cursor_qbe_rapp_chkdiana.GetString("FLAGRAP");
                      /* pRAE := _raeatc // RAE o ATECO */
                      pRAE = _raeatc;
                      /* pSTATO := qbe_rapp_chkdiana->STATOREG // Stato Registrazione */
                      pSTATO = Cursor_qbe_rapp_chkdiana.GetString("STATOREG");
                      /* pDatRet := qbe_rapp_chkdiana->DATARETT // Data Rettifica */
                      pDatRet = Cursor_qbe_rapp_chkdiana.GetDate("DATARETT");
                      /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                      DatiSoggetto();
                      /* Exec "Scrittura Dati" Page 15:Page_19 */
                      Page_19();
                      /* nTotRec := nTotRec + 1 */
                      nTotRec = CPLib.Round(nTotRec+1,0);
                      /* nNumRec := nNumRec + 1 */
                      nNumRec = CPLib.Round(nNumRec+1,0);
                    } // End If
                    Cursor_xntestbo.Next();
                  }
                  m_cConnectivityError = Cursor_xntestbo.ErrorMessage();
                  Cursor_xntestbo.Close();
                  // * --- End Select
                } // End If
                // * --- Select from xelegabo
                m_cServer = m_Ctx.GetServer("xelegabo");
                m_cPhName = m_Ctx.GetPhName("xelegabo");
                if (Cursor_xelegabo!=null)
                  Cursor_xelegabo.Close();
                Cursor_xelegabo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO"),"?",0,0)+"  and  NUMPROG2="+CPLib.ToSQL(Cursor_qbe_rapp_chkdiana.GetString("NUMPROG"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xelegabo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                while ( ! (Cursor_xelegabo.Eof())) {
                  /* _avanza := 0 */
                  _avanza = CPLib.Round(0,0);
                  /* If Empty(xelegabo->CODINTER) */
                  if (CPLib.Empty(Cursor_xelegabo.GetString("CODINTER"))) {
                    /* _avanza := 1 */
                    _avanza = CPLib.Round(1,0);
                  } // End If
                  /* If _avanza=0 */
                  if (CPLib.eqr(_avanza,0)) {
                    /* If qbe_rapp_chkdiana->DATAOPE > CharToDate('20131231') */
                    if (CPLib.gt(Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'8'+_idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"8"+_idereg;
                      /* pTipoR := '8' // Tipo Riga */
                      pTipoR = "8";
                    } else { // Else
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'4'+_idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"4"+_idereg;
                      /* pTipoR := '4' // Tipo Riga */
                      pTipoR = "4";
                    } // End If
                    /* pCli := xelegabo->CODINTER // Codice Soggetto */
                    pCli = Cursor_xelegabo.GetString("CODINTER");
                    /* pDatOpe := qbe_rapp_chkdiana->DATAOPE // Data Operazione */
                    pDatOpe = Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE");
                    /* pRap := qbe_rapp_chkdiana->RAPPORTO // Codice Rapporto */
                    pRap = Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO");
                    /* pTRap := qbe_rapp_chkdiana->FLAGRAP // Tipo Rapporto */
                    pTRap = Cursor_qbe_rapp_chkdiana.GetString("FLAGRAP");
                    /* pRAE := _raeatc // RAE o ATECO */
                    pRAE = _raeatc;
                    /* pSTATO := qbe_rapp_chkdiana->STATOREG // Stato Registrazione */
                    pSTATO = Cursor_qbe_rapp_chkdiana.GetString("STATOREG");
                    /* pDatRet := qbe_rapp_chkdiana->DATARETT // Data Rettifica */
                    pDatRet = Cursor_qbe_rapp_chkdiana.GetDate("DATARETT");
                    /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                    DatiSoggetto();
                    /* Exec "Scrittura Dati" Page 15:Page_19 */
                    Page_19();
                    /* nTotRec := nTotRec + 1 */
                    nTotRec = CPLib.Round(nTotRec+1,0);
                    /* nNumRec := nNumRec + 1 */
                    nNumRec = CPLib.Round(nNumRec+1,0);
                  } // End If
                  Cursor_xelegabo.Next();
                }
                m_cConnectivityError = Cursor_xelegabo.ErrorMessage();
                Cursor_xelegabo.Close();
                // * --- End Select
              } // End If
              /* Case Right(qbe_rapp_chkdiana->TIPOOPRAP,1)='6' or qbe_rapp_chkdiana->TIPOOPRAP='38' */
            } else if (CPLib.eqr(CPLib.Right(Cursor_qbe_rapp_chkdiana.GetString("TIPOOPRAP"),1),"6") || CPLib.eqr(Cursor_qbe_rapp_chkdiana.GetString("TIPOOPRAP"),"38")) {
              // * --- Select from xntestbo
              m_cServer = m_Ctx.GetServer("xntestbo");
              m_cPhName = m_Ctx.GetPhName("xntestbo");
              if (Cursor_xntestbo!=null)
                Cursor_xntestbo.Close();
              Cursor_xntestbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO"),"?",0,0)+"  and  NUMPROG2="+CPLib.ToSQL(Cursor_qbe_rapp_chkdiana.GetString("NUMPROG"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xntestbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
              while ( ! (Cursor_xntestbo.Eof())) {
                /* _avanza := 0 */
                _avanza = CPLib.Round(0,0);
                /* If Empty(xntestbo->CODINTER) */
                if (CPLib.Empty(Cursor_xntestbo.GetString("CODINTER"))) {
                  /* _avanza := 1 */
                  _avanza = CPLib.Round(1,0);
                } // End If
                /* If _avanza=0 */
                if (CPLib.eqr(_avanza,0)) {
                  /* If qbe_rapp_chkdiana->DATAOPE > CharToDate('20131231') */
                  if (CPLib.gt(Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                    /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'7'+_idereg */
                    _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                    /* pTipoR := '7' // Tipo Riga */
                    pTipoR = "7";
                  } else { // Else
                    /* If qbe_rapp_chkdiana->DATAOPE > CharToDate('20100531') and qbe_rapp_chkdiana->DATAOPE < CharToDate('20140101') */
                    if (CPLib.gt(Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20100531")) && CPLib.lt(Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20140101"))) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'2'+_idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                      /* pTipoR := '2' // Tipo Riga */
                      pTipoR = "2";
                    } else { // Else
                      /* If Empty(qbe_rapp_chkdiana->CONNESOPER) or (qbe_rapp_chkdiana->CONNESOPER=xntestbo->CODINTER) */
                      if (CPLib.Empty(Cursor_qbe_rapp_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(Cursor_qbe_rapp_chkdiana.GetString("CONNESOPER"),Cursor_xntestbo.GetString("CODINTER")))) {
                        /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                        _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                        /* pTipoR := '2' // Tipo Riga */
                        pTipoR = "2";
                      } else { // Else
                        /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                        _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                        /* pTipoR := '3' // Tipo Riga */
                        pTipoR = "3";
                      } // End If
                    } // End If
                  } // End If
                  /* pCli := xntestbo->CODINTER // Codice Soggetto */
                  pCli = Cursor_xntestbo.GetString("CODINTER");
                  /* pDatOpe := qbe_rapp_chkdiana->DATAOPE // Data Operazione */
                  pDatOpe = Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE");
                  /* pRap := qbe_rapp_chkdiana->RAPPORTO // Codice Rapporto */
                  pRap = Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO");
                  /* pTRap := qbe_rapp_chkdiana->FLAGRAP // Tipo Rapporto */
                  pTRap = Cursor_qbe_rapp_chkdiana.GetString("FLAGRAP");
                  /* pRAE := _raeatc // RAE o ATECO */
                  pRAE = _raeatc;
                  /* pSTATO := qbe_rapp_chkdiana->STATOREG // Stato Registrazione */
                  pSTATO = Cursor_qbe_rapp_chkdiana.GetString("STATOREG");
                  /* pDatRet := qbe_rapp_chkdiana->DATARETT // Data Rettifica */
                  pDatRet = Cursor_qbe_rapp_chkdiana.GetDate("DATARETT");
                  /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                  DatiSoggetto();
                  /* Exec "Scrittura Dati" Page 15:Page_19 */
                  Page_19();
                  /* nTotRec := nTotRec + 1 */
                  nTotRec = CPLib.Round(nTotRec+1,0);
                  /* nNumRec := nNumRec + 1 */
                  nNumRec = CPLib.Round(nNumRec+1,0);
                  /* If qbe_rapp_chkdiana->FLAGTIT=1 and w_flg2020='S' */
                  if (CPLib.eqr(Cursor_qbe_rapp_chkdiana.GetDouble("FLAGTIT"),1) && CPLib.eqr(w_flg2020,"S")) {
                    // * --- Select from intestit
                    m_cServer = m_Ctx.GetServer("intestit");
                    m_cPhName = m_Ctx.GetPhName("intestit");
                    if (Cursor_intestit!=null)
                      Cursor_intestit.Close();
                    Cursor_intestit = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CODCLI="+CPLib.ToSQL(Cursor_intestbo.GetString("CODINTER"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("intestit")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                    while ( ! (Cursor_intestit.Eof())) {
                      /* If (Empty(intestit->DATAFINE) or intestit->DATAFINE >= qbe_rapp_chkdiana->DATAOPE) and intestit->DATAINI <= qbe_rapp_chkdiana->DATAOPE */
                      if ((CPLib.Empty(Cursor_intestit.GetDate("DATAFINE")) || CPLib.ge(Cursor_intestit.GetDate("DATAFINE"),Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"))) && CPLib.le(Cursor_intestit.GetDate("DATAINI"),Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"))) {
                        /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'6'+_idereg */
                        _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"6"+_idereg;
                        /* pCli := intestit->CODINTER // Codice Soggetto */
                        pCli = Cursor_intestit.GetString("CODINTER");
                        /* pDatOpe := iif(w_stoper='R',qbe_rapp_chkdiana->DATAREG,qbe_rapp_chkdiana->DATAOPE) // Data Operazione */
                        pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_rapp_chkdiana.GetDate("DATAREG"):Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"));
                        /* pRap := qbe_rapp_chkdiana->RAPPORTO // Codice Rapporto */
                        pRap = Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO");
                        /* pTRap := qbe_rapp_chkdiana->FLAGRAP // Tipo Rapporto */
                        pTRap = Cursor_qbe_rapp_chkdiana.GetString("FLAGRAP");
                        /* pTipoR := '6' // Tipo Riga */
                        pTipoR = "6";
                        /* pRAE := _raeatc // RAE o ATECO */
                        pRAE = _raeatc;
                        /* pSTATO := qbe_rapp_chkdiana->STATOREG // Stato Registrazione */
                        pSTATO = Cursor_qbe_rapp_chkdiana.GetString("STATOREG");
                        /* pDatRet := qbe_rapp_chkdiana->DATARETT // Data Rettifica */
                        pDatRet = Cursor_qbe_rapp_chkdiana.GetDate("DATARETT");
                        /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                        DatiSoggetto();
                        /* Exec "Scrittura Dati" Page 15:Page_19 */
                        Page_19();
                        /* nTotRec := nTotRec + 1 */
                        nTotRec = CPLib.Round(nTotRec+1,0);
                        /* nNumRec := nNumRec + 1 */
                        nNumRec = CPLib.Round(nNumRec+1,0);
                      } // End If
                      Cursor_intestit.Next();
                    }
                    m_cConnectivityError = Cursor_intestit.ErrorMessage();
                    Cursor_intestit.Close();
                    // * --- End Select
                    // * --- Select from xntestit
                    m_cServer = m_Ctx.GetServer("xntestit");
                    m_cPhName = m_Ctx.GetPhName("xntestit");
                    if (Cursor_xntestit!=null)
                      Cursor_xntestit.Close();
                    Cursor_xntestit = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CODCLI="+CPLib.ToSQL(Cursor_xntestbo.GetString("CODINTER"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xntestit")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                    while ( ! (Cursor_xntestit.Eof())) {
                      /* If (Empty(xntestit->DATAFINE) or xntestit->DATAFINE >= qbe_rapp_chkdiana->DATAOPE) and xntestit->DATAINI <= qbe_rapp_chkdiana->DATAOPE */
                      if ((CPLib.Empty(Cursor_xntestit.GetDate("DATAFINE")) || CPLib.ge(Cursor_xntestit.GetDate("DATAFINE"),Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"))) && CPLib.le(Cursor_xntestit.GetDate("DATAINI"),Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"))) {
                        /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'6'+_idereg */
                        _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"6"+_idereg;
                        /* pCli := xntestit->CODINTER // Codice Soggetto */
                        pCli = Cursor_xntestit.GetString("CODINTER");
                        /* pDatOpe := iif(w_stoper='R',qbe_rapp_chkdiana->DATAREG,qbe_rapp_chkdiana->DATAOPE) // Data Operazione */
                        pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_rapp_chkdiana.GetDate("DATAREG"):Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"));
                        /* pRap := qbe_rapp_chkdiana->RAPPORTO // Codice Rapporto */
                        pRap = Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO");
                        /* pTRap := qbe_rapp_chkdiana->FLAGRAP // Tipo Rapporto */
                        pTRap = Cursor_qbe_rapp_chkdiana.GetString("FLAGRAP");
                        /* pTipoR := '6' // Tipo Riga */
                        pTipoR = "6";
                        /* pRAE := _raeatc // RAE o ATECO */
                        pRAE = _raeatc;
                        /* pSTATO := qbe_rapp_chkdiana->STATOREG // Stato Registrazione */
                        pSTATO = Cursor_qbe_rapp_chkdiana.GetString("STATOREG");
                        /* pDatRet := qbe_rapp_chkdiana->DATARETT // Data Rettifica */
                        pDatRet = Cursor_qbe_rapp_chkdiana.GetDate("DATARETT");
                        /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                        DatiSoggetto();
                        /* Exec "Scrittura Dati" Page 15:Page_19 */
                        Page_19();
                        /* nTotRec := nTotRec + 1 */
                        nTotRec = CPLib.Round(nTotRec+1,0);
                        /* nNumRec := nNumRec + 1 */
                        nNumRec = CPLib.Round(nNumRec+1,0);
                      } // End If
                      Cursor_xntestit.Next();
                    }
                    m_cConnectivityError = Cursor_xntestit.ErrorMessage();
                    Cursor_xntestit.Close();
                    // * --- End Select
                  } // End If
                } // End If
                Cursor_xntestbo.Next();
              }
              m_cConnectivityError = Cursor_xntestbo.ErrorMessage();
              Cursor_xntestbo.Close();
              // * --- End Select
              /* Case qbe_rapp_chkdiana->TIPOOPRAP='31' or qbe_rapp_chkdiana->TIPOOPRAP='32' */
            } else if (CPLib.eqr(Cursor_qbe_rapp_chkdiana.GetString("TIPOOPRAP"),"31") || CPLib.eqr(Cursor_qbe_rapp_chkdiana.GetString("TIPOOPRAP"),"32")) {
              // * --- Select from xntestbo
              m_cServer = m_Ctx.GetServer("xntestbo");
              m_cPhName = m_Ctx.GetPhName("xntestbo");
              if (Cursor_xntestbo!=null)
                Cursor_xntestbo.Close();
              Cursor_xntestbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xntestbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
              while ( ! (Cursor_xntestbo.Eof())) {
                /* _avanza := 0 */
                _avanza = CPLib.Round(0,0);
                /* If Empty(xntestbo->CODINTER) */
                if (CPLib.Empty(Cursor_xntestbo.GetString("CODINTER"))) {
                  /* _avanza := 1 */
                  _avanza = CPLib.Round(1,0);
                } // End If
                /* If _avanza=0 */
                if (CPLib.eqr(_avanza,0)) {
                  /* If qbe_rapp_chkdiana->DATAOPE > CharToDate('20131231') */
                  if (CPLib.gt(Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                    /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'7'+_idereg */
                    _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                    /* pTipoR := '7' // Tipo Riga */
                    pTipoR = "7";
                  } else { // Else
                    /* If qbe_rapp_chkdiana->DATAOPE > CharToDate('20100531') and qbe_rapp_chkdiana->DATAOPE < CharToDate('20140101') */
                    if (CPLib.gt(Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20100531")) && CPLib.lt(Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20140101"))) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'2'+_idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                      /* pTipoR := '2' // Tipo Riga */
                      pTipoR = "2";
                    } else { // Else
                      /* If Empty(qbe_rapp_chkdiana->CONNESOPER) or (qbe_rapp_chkdiana->CONNESOPER=xntestbo->CODINTER) */
                      if (CPLib.Empty(Cursor_qbe_rapp_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(Cursor_qbe_rapp_chkdiana.GetString("CONNESOPER"),Cursor_xntestbo.GetString("CODINTER")))) {
                        /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                        _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                        /* pTipoR := '2' // Tipo Riga */
                        pTipoR = "2";
                      } else { // Else
                        /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                        _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                        /* pTipoR := '3' // Tipo Riga */
                        pTipoR = "3";
                      } // End If
                    } // End If
                  } // End If
                  /* If qbe_rapp_chkdiana->TIPOOPRAP='31' */
                  if (CPLib.eqr(Cursor_qbe_rapp_chkdiana.GetString("TIPOOPRAP"),"31")) {
                    /* pDatOpe := arfn_dateminus(iif(w_stoper='R',Date(),qbe_rapp_chkdiana->DATAOPE),1) // Data Operazione */
                    pDatOpe = arfn_dateminusR.Make(m_Ctx,this).Run((CPLib.eqr(w_stoper,"R")?CPLib.Date():Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE")),1);
                    /* ElseIf qbe_rapp_chkdiana->TIPOOPRAP='32' */
                  } else if (CPLib.eqr(Cursor_qbe_rapp_chkdiana.GetString("TIPOOPRAP"),"32")) {
                    /* pDatOpe := iif(w_stoper='R',Date(),qbe_rapp_chkdiana->DATAOPE) // Data Operazione */
                    pDatOpe = (CPLib.eqr(w_stoper,"R")?CPLib.Date():Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"));
                  } // End If
                  /* pCli := xntestbo->CODINTER // Codice Soggetto */
                  pCli = Cursor_xntestbo.GetString("CODINTER");
                  /* pRap := qbe_rapp_chkdiana->RAPPORTO // Codice Rapporto */
                  pRap = Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO");
                  /* pTRap := qbe_rapp_chkdiana->FLAGRAP // Tipo Rapporto */
                  pTRap = Cursor_qbe_rapp_chkdiana.GetString("FLAGRAP");
                  /* pRAE := _raeatc // RAE o ATECO */
                  pRAE = _raeatc;
                  /* pSTATO := qbe_rapp_chkdiana->STATOREG // Stato Registrazione */
                  pSTATO = Cursor_qbe_rapp_chkdiana.GetString("STATOREG");
                  /* pDatRet := qbe_rapp_chkdiana->DATARETT // Data Rettifica */
                  pDatRet = Cursor_qbe_rapp_chkdiana.GetDate("DATARETT");
                  /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                  DatiSoggetto();
                  /* Exec "Scrittura Dati" Page 15:Page_19 */
                  Page_19();
                  /* nTotRec := nTotRec + 1 */
                  nTotRec = CPLib.Round(nTotRec+1,0);
                  /* nNumRec := nNumRec + 1 */
                  nNumRec = CPLib.Round(nNumRec+1,0);
                  /* If qbe_rapp_chkdiana->FLAGTIT=1 and w_flg2020='S' */
                  if (CPLib.eqr(Cursor_qbe_rapp_chkdiana.GetDouble("FLAGTIT"),1) && CPLib.eqr(w_flg2020,"S")) {
                    // * --- Select from intestit
                    m_cServer = m_Ctx.GetServer("intestit");
                    m_cPhName = m_Ctx.GetPhName("intestit");
                    if (Cursor_intestit!=null)
                      Cursor_intestit.Close();
                    Cursor_intestit = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CODCLI="+CPLib.ToSQL(Cursor_intestbo.GetString("CODINTER"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("intestit")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                    while ( ! (Cursor_intestit.Eof())) {
                      /* If (Empty(intestit->DATAFINE) or intestit->DATAFINE >= qbe_rapp_chkdiana->DATAOPE) and intestit->DATAINI <= qbe_rapp_chkdiana->DATAOPE */
                      if ((CPLib.Empty(Cursor_intestit.GetDate("DATAFINE")) || CPLib.ge(Cursor_intestit.GetDate("DATAFINE"),Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"))) && CPLib.le(Cursor_intestit.GetDate("DATAINI"),Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"))) {
                        /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'6'+_idereg */
                        _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"6"+_idereg;
                        /* pCli := intestit->CODINTER // Codice Soggetto */
                        pCli = Cursor_intestit.GetString("CODINTER");
                        /* pDatOpe := iif(w_stoper='R',qbe_rapp_chkdiana->DATAREG,qbe_rapp_chkdiana->DATAOPE) // Data Operazione */
                        pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_rapp_chkdiana.GetDate("DATAREG"):Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"));
                        /* pRap := qbe_rapp_chkdiana->RAPPORTO // Codice Rapporto */
                        pRap = Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO");
                        /* pTRap := qbe_rapp_chkdiana->FLAGRAP // Tipo Rapporto */
                        pTRap = Cursor_qbe_rapp_chkdiana.GetString("FLAGRAP");
                        /* pTipoR := '6' // Tipo Riga */
                        pTipoR = "6";
                        /* pRAE := _raeatc // RAE o ATECO */
                        pRAE = _raeatc;
                        /* pSTATO := qbe_rapp_chkdiana->STATOREG // Stato Registrazione */
                        pSTATO = Cursor_qbe_rapp_chkdiana.GetString("STATOREG");
                        /* pDatRet := qbe_rapp_chkdiana->DATARETT // Data Rettifica */
                        pDatRet = Cursor_qbe_rapp_chkdiana.GetDate("DATARETT");
                        /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                        DatiSoggetto();
                        /* Exec "Scrittura Dati" Page 15:Page_19 */
                        Page_19();
                        /* nTotRec := nTotRec + 1 */
                        nTotRec = CPLib.Round(nTotRec+1,0);
                        /* nNumRec := nNumRec + 1 */
                        nNumRec = CPLib.Round(nNumRec+1,0);
                      } // End If
                      Cursor_intestit.Next();
                    }
                    m_cConnectivityError = Cursor_intestit.ErrorMessage();
                    Cursor_intestit.Close();
                    // * --- End Select
                    // * --- Select from xntestit
                    m_cServer = m_Ctx.GetServer("xntestit");
                    m_cPhName = m_Ctx.GetPhName("xntestit");
                    if (Cursor_xntestit!=null)
                      Cursor_xntestit.Close();
                    Cursor_xntestit = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CODCLI="+CPLib.ToSQL(Cursor_xntestbo.GetString("CODINTER"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xntestit")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                    while ( ! (Cursor_xntestit.Eof())) {
                      /* If (Empty(xntestit->DATAFINE) or xntestit->DATAFINE >= qbe_rapp_chkdiana->DATAOPE) and xntestit->DATAINI <= qbe_rapp_chkdiana->DATAOPE */
                      if ((CPLib.Empty(Cursor_xntestit.GetDate("DATAFINE")) || CPLib.ge(Cursor_xntestit.GetDate("DATAFINE"),Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"))) && CPLib.le(Cursor_xntestit.GetDate("DATAINI"),Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"))) {
                        /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'6'+_idereg */
                        _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"6"+_idereg;
                        /* pCli := xntestit->CODINTER // Codice Soggetto */
                        pCli = Cursor_xntestit.GetString("CODINTER");
                        /* pDatOpe := iif(w_stoper='R',qbe_rapp_chkdiana->DATAREG,qbe_rapp_chkdiana->DATAOPE) // Data Operazione */
                        pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_rapp_chkdiana.GetDate("DATAREG"):Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"));
                        /* pRap := qbe_rapp_chkdiana->RAPPORTO // Codice Rapporto */
                        pRap = Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO");
                        /* pTRap := qbe_rapp_chkdiana->FLAGRAP // Tipo Rapporto */
                        pTRap = Cursor_qbe_rapp_chkdiana.GetString("FLAGRAP");
                        /* pTipoR := '6' // Tipo Riga */
                        pTipoR = "6";
                        /* pRAE := _raeatc // RAE o ATECO */
                        pRAE = _raeatc;
                        /* pSTATO := qbe_rapp_chkdiana->STATOREG // Stato Registrazione */
                        pSTATO = Cursor_qbe_rapp_chkdiana.GetString("STATOREG");
                        /* pDatRet := qbe_rapp_chkdiana->DATARETT // Data Rettifica */
                        pDatRet = Cursor_qbe_rapp_chkdiana.GetDate("DATARETT");
                        /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                        DatiSoggetto();
                        /* Exec "Scrittura Dati" Page 15:Page_19 */
                        Page_19();
                        /* nTotRec := nTotRec + 1 */
                        nTotRec = CPLib.Round(nTotRec+1,0);
                        /* nNumRec := nNumRec + 1 */
                        nNumRec = CPLib.Round(nNumRec+1,0);
                      } // End If
                      Cursor_xntestit.Next();
                    }
                    m_cConnectivityError = Cursor_xntestit.ErrorMessage();
                    Cursor_xntestit.Close();
                    // * --- End Select
                  } // End If
                } // End If
                Cursor_xntestbo.Next();
              }
              m_cConnectivityError = Cursor_xntestbo.ErrorMessage();
              Cursor_xntestbo.Close();
              // * --- End Select
              /* If w_flgdel = 'S' */
              if (CPLib.eqr(w_flgdel,"S")) {
                // * --- Select from xelegabo
                m_cServer = m_Ctx.GetServer("xelegabo");
                m_cPhName = m_Ctx.GetPhName("xelegabo");
                if (Cursor_xelegabo!=null)
                  Cursor_xelegabo.Close();
                Cursor_xelegabo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xelegabo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                while ( ! (Cursor_xelegabo.Eof())) {
                  /* _avanza := 0 */
                  _avanza = CPLib.Round(0,0);
                  /* If Empty(xelegabo->CODINTER) */
                  if (CPLib.Empty(Cursor_xelegabo.GetString("CODINTER"))) {
                    /* _avanza := 1 */
                    _avanza = CPLib.Round(1,0);
                  } // End If
                  /* If _avanza=0 */
                  if (CPLib.eqr(_avanza,0)) {
                    /* If qbe_rapp_chkdiana->DATAOPE > CharToDate('20131231') */
                    if (CPLib.gt(Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'8'+_idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"8"+_idereg;
                      /* pTipoR := '8' // Tipo Riga */
                      pTipoR = "8";
                    } else { // Else
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'4'+_idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"4"+_idereg;
                      /* pTipoR := '4' // Tipo Riga */
                      pTipoR = "4";
                    } // End If
                    /* If qbe_rapd_chkdiana->TIPOOPRAP='31' */
                    if (CPLib.eqr(Cursor_qbe_rapd_chkdiana.GetString("TIPOOPRAP"),"31")) {
                      /* pDatOpe := arfn_dateminus(iif(w_stoper='R',Date(),qbe_rapp_chkdiana->DATAOPE),1) // Data Operazione */
                      pDatOpe = arfn_dateminusR.Make(m_Ctx,this).Run((CPLib.eqr(w_stoper,"R")?CPLib.Date():Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE")),1);
                      /* ElseIf qbe_rapd_chkdiana->TIPOOPRAP='32' */
                    } else if (CPLib.eqr(Cursor_qbe_rapd_chkdiana.GetString("TIPOOPRAP"),"32")) {
                      /* pDatOpe := iif(w_stoper='R',Date(),qbe_rapp_chkdiana->DATAOPE) // Data Operazione */
                      pDatOpe = (CPLib.eqr(w_stoper,"R")?CPLib.Date():Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"));
                    } // End If
                    /* pCli := xelegabo->CODINTER // Codice Soggetto */
                    pCli = Cursor_xelegabo.GetString("CODINTER");
                    /* pRap := qbe_rapp_chkdiana->RAPPORTO // Codice Rapporto */
                    pRap = Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO");
                    /* pTRap := qbe_rapp_chkdiana->FLAGRAP // Tipo Rapporto */
                    pTRap = Cursor_qbe_rapp_chkdiana.GetString("FLAGRAP");
                    /* pRAE := _raeatc // RAE o ATECO */
                    pRAE = _raeatc;
                    /* pSTATO := qbe_rapp_chkdiana->STATOREG // Stato Registrazione */
                    pSTATO = Cursor_qbe_rapp_chkdiana.GetString("STATOREG");
                    /* pDatRet := qbe_rapp_chkdiana->DATARETT // Data Rettifica */
                    pDatRet = Cursor_qbe_rapp_chkdiana.GetDate("DATARETT");
                    /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                    DatiSoggetto();
                    /* Exec "Scrittura Dati" Page 15:Page_19 */
                    Page_19();
                    /* nTotRec := nTotRec + 1 */
                    nTotRec = CPLib.Round(nTotRec+1,0);
                    /* nNumRec := nNumRec + 1 */
                    nNumRec = CPLib.Round(nNumRec+1,0);
                  } // End If
                  Cursor_xelegabo.Next();
                }
                m_cConnectivityError = Cursor_xelegabo.ErrorMessage();
                Cursor_xelegabo.Close();
                // * --- End Select
              } // End If
            } else { // Otherwise
              // * --- Select from xntestbo
              m_cServer = m_Ctx.GetServer("xntestbo");
              m_cPhName = m_Ctx.GetPhName("xntestbo");
              if (Cursor_xntestbo!=null)
                Cursor_xntestbo.Close();
              Cursor_xntestbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO"),"?",0,0)+"  and  NUMPROG1="+CPLib.ToSQL(Cursor_qbe_rapp_chkdiana.GetString("NUMPROG"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xntestbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
              while ( ! (Cursor_xntestbo.Eof())) {
                /* _avanza := 0 */
                _avanza = CPLib.Round(0,0);
                /* If Empty(xntestbo->CODINTER) */
                if (CPLib.Empty(Cursor_xntestbo.GetString("CODINTER"))) {
                  /* _avanza := 1 */
                  _avanza = CPLib.Round(1,0);
                } // End If
                /* If _avanza=0 */
                if (CPLib.eqr(_avanza,0)) {
                  /* If qbe_rapp_chkdiana->DATAOPE > CharToDate('20131231') */
                  if (CPLib.gt(Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                    /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'7'+_idereg */
                    _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                    /* pTipoR := '7' */
                    pTipoR = "7";
                  } else { // Else
                    /* If qbe_rapp_chkdiana->DATAOPE > CharToDate('20100531') and qbe_rapp_chkdiana->DATAOPE < CharToDate('20140101') */
                    if (CPLib.gt(Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20100531")) && CPLib.lt(Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20140101"))) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'2'+_idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                      /* pTipoR := '2' */
                      pTipoR = "2";
                    } else { // Else
                      /* If Empty(qbe_rapp_chkdiana->CONNESOPER) or (qbe_rapp_chkdiana->CONNESOPER=xntestbo->CODINTER) */
                      if (CPLib.Empty(Cursor_qbe_rapp_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(Cursor_qbe_rapp_chkdiana.GetString("CONNESOPER"),Cursor_xntestbo.GetString("CODINTER")))) {
                        /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                        _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                        /* pTipoR := '2' */
                        pTipoR = "2";
                      } else { // Else
                        /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                        _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                        /* pTipoR := '3' */
                        pTipoR = "3";
                      } // End If
                    } // End If
                  } // End If
                  /* pCli := xntestbo->CODINTER // Codice Soggetto */
                  pCli = Cursor_xntestbo.GetString("CODINTER");
                  /* pDatOpe := qbe_rapp_chkdiana->DATAOPE // Data Operazione */
                  pDatOpe = Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE");
                  /* pRap := qbe_rapp_chkdiana->RAPPORTO // Codice Rapporto */
                  pRap = Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO");
                  /* pTRap := qbe_rapp_chkdiana->FLAGRAP // Tipo Rapporto */
                  pTRap = Cursor_qbe_rapp_chkdiana.GetString("FLAGRAP");
                  /* pRAE := _raeatc // RAE o ATECO */
                  pRAE = _raeatc;
                  /* pSTATO := qbe_rapp_chkdiana->STATOREG // Stato Registrazione */
                  pSTATO = Cursor_qbe_rapp_chkdiana.GetString("STATOREG");
                  /* pDatRet := qbe_rapp_chkdiana->DATARETT // Data Rettifica */
                  pDatRet = Cursor_qbe_rapp_chkdiana.GetDate("DATARETT");
                  /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                  DatiSoggetto();
                  /* Exec "Scrittura Dati" Page 15:Page_19 */
                  Page_19();
                  /* nTotRec := nTotRec + 1 */
                  nTotRec = CPLib.Round(nTotRec+1,0);
                  /* nNumRec := nNumRec + 1 */
                  nNumRec = CPLib.Round(nNumRec+1,0);
                  /* If qbe_rapp_chkdiana->FLAGTIT=1 and w_flg2020='S' */
                  if (CPLib.eqr(Cursor_qbe_rapp_chkdiana.GetDouble("FLAGTIT"),1) && CPLib.eqr(w_flg2020,"S")) {
                    // * --- Select from intestit
                    m_cServer = m_Ctx.GetServer("intestit");
                    m_cPhName = m_Ctx.GetPhName("intestit");
                    if (Cursor_intestit!=null)
                      Cursor_intestit.Close();
                    Cursor_intestit = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CODCLI="+CPLib.ToSQL(Cursor_intestbo.GetString("CODINTER"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("intestit")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                    while ( ! (Cursor_intestit.Eof())) {
                      /* If (Empty(intestit->DATAFINE) or intestit->DATAFINE >= qbe_rapp_chkdiana->DATAOPE) and intestit->DATAINI <= qbe_rapp_chkdiana->DATAOPE */
                      if ((CPLib.Empty(Cursor_intestit.GetDate("DATAFINE")) || CPLib.ge(Cursor_intestit.GetDate("DATAFINE"),Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"))) && CPLib.le(Cursor_intestit.GetDate("DATAINI"),Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"))) {
                        /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'6'+_idereg */
                        _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"6"+_idereg;
                        /* pCli := intestit->CODINTER // Codice Soggetto */
                        pCli = Cursor_intestit.GetString("CODINTER");
                        /* pDatOpe := iif(w_stoper='R',qbe_rapp_chkdiana->DATAREG,qbe_rapp_chkdiana->DATAOPE) // Data Operazione */
                        pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_rapp_chkdiana.GetDate("DATAREG"):Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"));
                        /* pRap := qbe_rapp_chkdiana->RAPPORTO // Codice Rapporto */
                        pRap = Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO");
                        /* pTRap := qbe_rapp_chkdiana->FLAGRAP // Tipo Rapporto */
                        pTRap = Cursor_qbe_rapp_chkdiana.GetString("FLAGRAP");
                        /* pTipoR := '6' // Tipo Riga */
                        pTipoR = "6";
                        /* pRAE := _raeatc // RAE o ATECO */
                        pRAE = _raeatc;
                        /* pSTATO := qbe_rapp_chkdiana->STATOREG // Stato Registrazione */
                        pSTATO = Cursor_qbe_rapp_chkdiana.GetString("STATOREG");
                        /* pDatRet := qbe_rapp_chkdiana->DATARETT // Data Rettifica */
                        pDatRet = Cursor_qbe_rapp_chkdiana.GetDate("DATARETT");
                        /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                        DatiSoggetto();
                        /* Exec "Scrittura Dati" Page 15:Page_19 */
                        Page_19();
                        /* nTotRec := nTotRec + 1 */
                        nTotRec = CPLib.Round(nTotRec+1,0);
                        /* nNumRec := nNumRec + 1 */
                        nNumRec = CPLib.Round(nNumRec+1,0);
                      } // End If
                      Cursor_intestit.Next();
                    }
                    m_cConnectivityError = Cursor_intestit.ErrorMessage();
                    Cursor_intestit.Close();
                    // * --- End Select
                    // * --- Select from xntestit
                    m_cServer = m_Ctx.GetServer("xntestit");
                    m_cPhName = m_Ctx.GetPhName("xntestit");
                    if (Cursor_xntestit!=null)
                      Cursor_xntestit.Close();
                    Cursor_xntestit = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CODCLI="+CPLib.ToSQL(Cursor_xntestbo.GetString("CODINTER"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xntestit")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                    while ( ! (Cursor_xntestit.Eof())) {
                      /* If (Empty(xntestit->DATAFINE) or xntestit->DATAFINE >= qbe_rapp_chkdiana->DATAOPE) and xntestit->DATAINI <= qbe_rapp_chkdiana->DATAOPE */
                      if ((CPLib.Empty(Cursor_xntestit.GetDate("DATAFINE")) || CPLib.ge(Cursor_xntestit.GetDate("DATAFINE"),Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"))) && CPLib.le(Cursor_xntestit.GetDate("DATAINI"),Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"))) {
                        /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'6'+_idereg */
                        _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"6"+_idereg;
                        /* pCli := xntestit->CODINTER // Codice Soggetto */
                        pCli = Cursor_xntestit.GetString("CODINTER");
                        /* pDatOpe := iif(w_stoper='R',qbe_rapp_chkdiana->DATAREG,qbe_rapp_chkdiana->DATAOPE) // Data Operazione */
                        pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_rapp_chkdiana.GetDate("DATAREG"):Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"));
                        /* pRap := qbe_rapp_chkdiana->RAPPORTO // Codice Rapporto */
                        pRap = Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO");
                        /* pTRap := qbe_rapp_chkdiana->FLAGRAP // Tipo Rapporto */
                        pTRap = Cursor_qbe_rapp_chkdiana.GetString("FLAGRAP");
                        /* pTipoR := '6' // Tipo Riga */
                        pTipoR = "6";
                        /* pRAE := _raeatc // RAE o ATECO */
                        pRAE = _raeatc;
                        /* pSTATO := qbe_rapp_chkdiana->STATOREG // Stato Registrazione */
                        pSTATO = Cursor_qbe_rapp_chkdiana.GetString("STATOREG");
                        /* pDatRet := qbe_rapp_chkdiana->DATARETT // Data Rettifica */
                        pDatRet = Cursor_qbe_rapp_chkdiana.GetDate("DATARETT");
                        /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                        DatiSoggetto();
                        /* Exec "Scrittura Dati" Page 15:Page_19 */
                        Page_19();
                        /* nTotRec := nTotRec + 1 */
                        nTotRec = CPLib.Round(nTotRec+1,0);
                        /* nNumRec := nNumRec + 1 */
                        nNumRec = CPLib.Round(nNumRec+1,0);
                      } // End If
                      Cursor_xntestit.Next();
                    }
                    m_cConnectivityError = Cursor_xntestit.ErrorMessage();
                    Cursor_xntestit.Close();
                    // * --- End Select
                  } // End If
                } // End If
                Cursor_xntestbo.Next();
              }
              m_cConnectivityError = Cursor_xntestbo.ErrorMessage();
              Cursor_xntestbo.Close();
              // * --- End Select
            } // End Case
            /* If qbe_rapp_chkdiana->TIPOOPRAP<>'25' and qbe_rapp_chkdiana->TIPOOPRAP <> '28' */
            if (CPLib.ne(Cursor_qbe_rapp_chkdiana.GetString("TIPOOPRAP"),"25") && CPLib.ne(Cursor_qbe_rapp_chkdiana.GetString("TIPOOPRAP"),"28")) {
              /* If not(Empty(qbe_rapp_chkdiana->CONNESOPER)) */
              if ( ! (CPLib.Empty(Cursor_qbe_rapp_chkdiana.GetString("CONNESOPER")))) {
                /* If qbe_rapp_chkdiana->DATAOPE > CharToDate('20131231') */
                if (CPLib.gt(Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'8'+_idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"8"+_idereg;
                  /* pTipoR := '8' // Tipo Riga */
                  pTipoR = "8";
                } else { // Else
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'4'+_idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"4"+_idereg;
                  /* pTipoR := '4' // Tipo Riga */
                  pTipoR = "4";
                } // End If
                /* pCli := qbe_rapp_chkdiana->CONNESOPER // Codice Soggetto */
                pCli = Cursor_qbe_rapp_chkdiana.GetString("CONNESOPER");
                /* pDatOpe := qbe_rapp_chkdiana->DATAOPE // Data Operazione */
                pDatOpe = Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE");
                /* pRap := qbe_rapp_chkdiana->RAPPORTO // Codice Rapporto */
                pRap = Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO");
                /* pTRap := qbe_rapp_chkdiana->FLAGRAP // Tipo Rapporto */
                pTRap = Cursor_qbe_rapp_chkdiana.GetString("FLAGRAP");
                /* pRAE := _raeatc // RAE o ATECO */
                pRAE = _raeatc;
                /* pSTATO := qbe_rapp_chkdiana->STATOREG // Stato Registrazione */
                pSTATO = Cursor_qbe_rapp_chkdiana.GetString("STATOREG");
                /* pDatRet := qbe_rapp_chkdiana->DATARETT // Data Rettifica */
                pDatRet = Cursor_qbe_rapp_chkdiana.GetDate("DATARETT");
                /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                DatiSoggetto();
                /* Exec "Scrittura Dati" Page 15:Page_19 */
                Page_19();
                /* nTotRec := nTotRec + 1 */
                nTotRec = CPLib.Round(nTotRec+1,0);
                /* nNumRec := nNumRec + 1 */
                nNumRec = CPLib.Round(nNumRec+1,0);
              } // End If
              // * --- Select from xiduciabo
              m_cServer = m_Ctx.GetServer("xiduciabo");
              m_cPhName = m_Ctx.GetPhName("xiduciabo");
              if (Cursor_xiduciabo!=null)
                Cursor_xiduciabo.Close();
              Cursor_xiduciabo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPCOL="+CPLib.ToSQL(Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xiduciabo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
              while ( ! (Cursor_xiduciabo.Eof())) {
                /* _avanza := 0 */
                _avanza = CPLib.Round(0,0);
                /* If Empty(xiduciabo->CODSOG) */
                if (CPLib.Empty(Cursor_xiduciabo.GetString("CODSOG"))) {
                  /* _avanza := 1 */
                  _avanza = CPLib.Round(1,0);
                } // End If
                /* If _avanza=0 */
                if (CPLib.eqr(_avanza,0)) {
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'9'+_idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"9"+_idereg;
                  /* pTipoR := '9' // Tipo Riga */
                  pTipoR = "9";
                  /* pCli := xiduciabo->CODSOG // Codice Soggetto */
                  pCli = Cursor_xiduciabo.GetString("CODSOG");
                  /* pDatOpe := qbe_rapp_chkdiana->DATAOPE // Data Operazione */
                  pDatOpe = Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE");
                  /* pRap := qbe_rapp_chkdiana->RAPPORTO // Codice Rapporto */
                  pRap = Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO");
                  /* pTRap := qbe_rapp_chkdiana->FLAGRAP // Tipo Rapporto */
                  pTRap = Cursor_qbe_rapp_chkdiana.GetString("FLAGRAP");
                  /* pRAE := _raeatc // RAE o ATECO */
                  pRAE = _raeatc;
                  /* pSTATO := qbe_rapp_chkdiana->STATOREG // Stato Registrazione */
                  pSTATO = Cursor_qbe_rapp_chkdiana.GetString("STATOREG");
                  /* pDatRet := qbe_rapp_chkdiana->DATARETT // Data Rettifica */
                  pDatRet = Cursor_qbe_rapp_chkdiana.GetDate("DATARETT");
                  /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                  DatiSoggetto();
                  /* Exec "Scrittura Dati" Page 15:Page_19 */
                  Page_19();
                  /* nTotRec := nTotRec + 1 */
                  nTotRec = CPLib.Round(nTotRec+1,0);
                  /* nNumRec := nNumRec + 1 */
                  nNumRec = CPLib.Round(nNumRec+1,0);
                } // End If
                Cursor_xiduciabo.Next();
              }
              m_cConnectivityError = Cursor_xiduciabo.ErrorMessage();
              Cursor_xiduciabo.Close();
              // * --- End Select
              /* If w_flg2020='S' */
              if (CPLib.eqr(w_flg2020,"S")) {
                // * --- Select from xerzistirap
                m_cServer = m_Ctx.GetServer("xerzistirap");
                m_cPhName = m_Ctx.GetPhName("xerzistirap");
                if (Cursor_xerzistirap!=null)
                  Cursor_xerzistirap.Close();
                Cursor_xerzistirap = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPCOL="+CPLib.ToSQL(Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xerzistirap")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                while ( ! (Cursor_xerzistirap.Eof())) {
                  /* _avanza := 0 */
                  _avanza = CPLib.Round(0,0);
                  /* If Empty(xerzistirap->CODSOG) */
                  if (CPLib.Empty(Cursor_xerzistirap.GetString("CODSOG"))) {
                    /* _avanza := 1 */
                    _avanza = CPLib.Round(1,0);
                  } // End If
                  /* If _avanza=0 */
                  if (CPLib.eqr(_avanza,0)) {
                    /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'6'+_idereg */
                    _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"6"+_idereg;
                    /* pTipoR := '6' */
                    pTipoR = "6";
                    /* pCli := xerzistirap->CODSOG // Codice Soggetto */
                    pCli = Cursor_xerzistirap.GetString("CODSOG");
                    /* pDatOpe := qbe_rapp_chkdiana->DATAOPE // Data Operazione */
                    pDatOpe = Cursor_qbe_rapp_chkdiana.GetDate("DATAOPE");
                    /* pRap := qbe_rapp_chkdiana->RAPPORTO // Codice Rapporto */
                    pRap = Cursor_qbe_rapp_chkdiana.GetString("RAPPORTO");
                    /* pTRap := qbe_rapp_chkdiana->FLAGRAP // Tipo Rapporto */
                    pTRap = Cursor_qbe_rapp_chkdiana.GetString("FLAGRAP");
                    /* pRAE := _raeatc // RAE o ATECO */
                    pRAE = _raeatc;
                    /* pSTATO := qbe_rapp_chkdiana->STATOREG // Stato Registrazione */
                    pSTATO = Cursor_qbe_rapp_chkdiana.GetString("STATOREG");
                    /* pDatRet := qbe_rapp_chkdiana->DATARETT // Data Rettifica */
                    pDatRet = Cursor_qbe_rapp_chkdiana.GetDate("DATARETT");
                    /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                    DatiSoggetto();
                    /* Exec "Scrittura Dati" Page 15:Page_19 */
                    Page_19();
                    /* nTotRec := nTotRec + 1 */
                    nTotRec = CPLib.Round(nTotRec+1,0);
                    /* nNumRec := nNumRec + 1 */
                    nNumRec = CPLib.Round(nNumRec+1,0);
                  } // End If
                  Cursor_xerzistirap.Next();
                }
                m_cConnectivityError = Cursor_xerzistirap.ErrorMessage();
                Cursor_xerzistirap.Close();
                // * --- End Select
              } // End If
            } // End If
          } // End If
          Cursor_qbe_rapp_chkdiana.Next();
        }
        m_cConnectivityError = Cursor_qbe_rapp_chkdiana.ErrorMessage();
        Cursor_qbe_rapp_chkdiana.Close();
        // * --- End Select
      } // End If
    } finally {
      try {
        if (Cursor_qbe_rapd_chkdiana_min_max!=null)
          Cursor_qbe_rapd_chkdiana_min_max.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_qbe_rapd_chkdiana!=null)
          Cursor_qbe_rapd_chkdiana.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_rapopebo!=null)
          Cursor_rapopebo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_intestbo!=null)
          Cursor_intestbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_knarapbo!=null)
          Cursor_knarapbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_delegabo!=null)
          Cursor_delegabo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_intestit!=null)
          Cursor_intestit.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_fiduciabo!=null)
          Cursor_fiduciabo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_terzistirap!=null)
          Cursor_terzistirap.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_qbe_rapp_chkdiana!=null)
          Cursor_qbe_rapp_chkdiana.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_xapopebo!=null)
          Cursor_xapopebo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_xntestbo!=null)
          Cursor_xntestbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_xelegabo!=null)
          Cursor_xelegabo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_xntestit!=null)
          Cursor_xntestit.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_xiduciabo!=null)
          Cursor_xiduciabo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_xerzistirap!=null)
          Cursor_xerzistirap.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
    }
  }
  void Page_4() throws Exception {
    /* Cicla sulle frazionate */
    /* If w_tipoarchd = 'S' */
    if (CPLib.eqr(w_tipoarchd,"S")) {
      /* Exec "Frazionate Definitive" Page 9:Page_9 */
      Page_9();
    } // End If
    /* If w_tipoarchp = 'S' */
    if (CPLib.eqr(w_tipoarchp,"S")) {
      /* Exec "Frazionate Provvisorie" Page 10:Page_10 */
      Page_10();
    } // End If
  }
  void Page_5() throws Exception {
    CPResultSet Cursor_qbe_titd_chkdiana=null;
    CPResultSet Cursor_rapotit=null;
    CPResultSet Cursor_intestit=null;
    VQRHolder l_VQRHolder = null;
    try {
      /* Titolari Effettivi */
      /* _conta := _conta + 1 */
      _conta = CPLib.Round(_conta+1,0);
      /* If w_flgtit = 'N' or (w_flgtit='S' and (w_tiptit='1' or w_tiptit='2')) */
      if (CPLib.eqr(w_flgtit,"N") || (CPLib.eqr(w_flgtit,"S") && (CPLib.eqr(w_tiptit,"1") || CPLib.eqr(w_tiptit,"2")))) {
        /* w_cdadata_rap := '' */
        w_cdadata_rap = "";
        /* w_c_adata_rap := '' */
        w_c_adata_rap = "";
        /* w_cdareg_rap := '' */
        w_cdareg_rap = "";
        /* w_c_areg_rap := '' */
        w_c_areg_rap = "";
        /* ElseIf w_flgtit='S' and w_tiptit='9' */
      } else if (CPLib.eqr(w_flgtit,"S") && CPLib.eqr(w_tiptit,"9")) {
        /* w_cdadata_rap := '99991231' */
        w_cdadata_rap = "99991231";
        /* w_c_adata_rap := '99991231' */
        w_c_adata_rap = "99991231";
        /* w_cdareg_rap := '99991231' */
        w_cdareg_rap = "99991231";
        /* w_c_areg_rap := '99991231' */
        w_c_areg_rap = "99991231";
      } else { // Else
        /* w_cdadata_rap := w_cdadata */
        w_cdadata_rap = w_cdadata;
        /* w_c_adata_rap := w_c_adata */
        w_c_adata_rap = w_c_adata;
        /* w_cdareg_rap := w_cdareg */
        w_cdareg_rap = w_cdareg;
        /* w_c_areg_rap := w_c_areg */
        w_c_areg_rap = w_c_areg;
      } // End If
      /* If w_tipoarchd = 'S' */
      if (CPLib.eqr(w_tipoarchd,"S")) {
        // * --- Select from qbe_titd_chkdiana
        SPBridge.HMCaller _h000004B4;
        _h000004B4 = new SPBridge.HMCaller();
        _h000004B4.Set("m_cVQRList",m_cVQRList);
        _h000004B4.Set("cdadata_rap",w_cdadata_rap);
        _h000004B4.Set("c_adata_rap",w_c_adata_rap);
        _h000004B4.Set("cdareg",w_cdareg_rap);
        _h000004B4.Set("c_areg",w_c_areg_rap);
        _h000004B4.Set("flgsto",w_flgsto);
        if (Cursor_qbe_titd_chkdiana!=null)
          Cursor_qbe_titd_chkdiana.Close();
        Cursor_qbe_titd_chkdiana = new VQRHolder("qbe_titd_chkdiana",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h000004B4,true).GetResultSet(m_Ctx);
        while ( ! (Cursor_qbe_titd_chkdiana.Eof())) {
          /* _continua := 0 */
          _continua = CPLib.Round(0,0);
          /* If qbe_titd_chkdiana->DATAOPE <  CharToDate('20100601') */
          if (CPLib.lt(Cursor_qbe_titd_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20100601"))) {
            /* _raeatc := 'R' */
            _raeatc = "R";
            /* ElseIf qbe_titd_chkdiana->DATAOPE >  CharToDate('20131231') */
          } else if (CPLib.gt(Cursor_qbe_titd_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
            /* _raeatc := 'A' */
            _raeatc = "A";
          } else { // Else
            /* _raeatc := w_flgrae */
            _raeatc = w_flgrae;
          } // End If
          /* Case w_flgtit='N' or (w_flgtit='S' and w_tiptit='3') */
          if (CPLib.eqr(w_flgtit,"N") || (CPLib.eqr(w_flgtit,"S") && CPLib.eqr(w_tiptit,"3"))) {
            /* _continua := 1 */
            _continua = CPLib.Round(1,0);
            /* Case w_flgtit='S' and w_tiptit='1' */
          } else if (CPLib.eqr(w_flgtit,"S") && CPLib.eqr(w_tiptit,"1")) {
            /* _continua := 1 */
            _continua = CPLib.Round(1,0);
            // * --- Select from rapotit
            m_cServer = m_Ctx.GetServer("rapotit");
            m_cPhName = m_Ctx.GetPhName("rapotit");
            if (Cursor_rapotit!=null)
              Cursor_rapotit.Close();
            Cursor_rapotit = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CONNESCLI="+CPLib.ToSQL(Cursor_qbe_titd_chkdiana.GetString("CONNESCLI"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("rapotit")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1")+" order by "+"DATAOPE ",m_cServer,m_Ctx,true));
            while ( ! (Cursor_rapotit.Eof())) {
              /* Case rapotit->TIPOOPRAP='50' or rapotit->TIPOOPRAP='52'  */
              if (CPLib.eqr(Cursor_rapotit.GetString("TIPOOPRAP"),"50") || CPLib.eqr(Cursor_rapotit.GetString("TIPOOPRAP"),"52")) {
                /* If rapotit->DATAOPE > w_AData */
                if (CPLib.gt(Cursor_rapotit.GetDate("DATAOPE"),w_AData)) {
                  /* _continua := 0 */
                  _continua = CPLib.Round(0,0);
                } // End If
                /* Case rapotit->TIPOOPRAP='51' or rapotit->TIPOOPRAP='53'  */
              } else if (CPLib.eqr(Cursor_rapotit.GetString("TIPOOPRAP"),"51") || CPLib.eqr(Cursor_rapotit.GetString("TIPOOPRAP"),"53")) {
                /* If rapotit->DATAOPE < w_DaData */
                if (CPLib.lt(Cursor_rapotit.GetDate("DATAOPE"),w_DaData)) {
                  /* _continua := 0 */
                  _continua = CPLib.Round(0,0);
                } // End If
                /* Case rapotit->TIPOOPRAP='58' */
              } else if (CPLib.eqr(Cursor_rapotit.GetString("TIPOOPRAP"),"58")) {
                /* If rapotit->DATAOPE > w_AData or rapotit->DATAOPE < w_DaData */
                if (CPLib.gt(Cursor_rapotit.GetDate("DATAOPE"),w_AData) || CPLib.lt(Cursor_rapotit.GetDate("DATAOPE"),w_DaData)) {
                  /* _continua := 0 */
                  _continua = CPLib.Round(0,0);
                } // End If
              } // End Case
              Cursor_rapotit.Next();
            }
            m_cConnectivityError = Cursor_rapotit.ErrorMessage();
            Cursor_rapotit.Close();
            // * --- End Select
            /* Case w_flgtit='S' and w_tiptit='2' */
          } else if (CPLib.eqr(w_flgtit,"S") && CPLib.eqr(w_tiptit,"2")) {
            // * --- Select from rapotit
            m_cServer = m_Ctx.GetServer("rapotit");
            m_cPhName = m_Ctx.GetPhName("rapotit");
            if (Cursor_rapotit!=null)
              Cursor_rapotit.Close();
            Cursor_rapotit = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CONNESCLI="+CPLib.ToSQL(Cursor_qbe_titd_chkdiana.GetString("CONNESCLI"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("rapotit")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1")+" order by "+"DATAOPE ",m_cServer,m_Ctx,true));
            while ( ! (Cursor_rapotit.Eof())) {
              /* Case rapotit->TIPOOPRAP='50' or rapotit->TIPOOPRAP='52'  */
              if (CPLib.eqr(Cursor_rapotit.GetString("TIPOOPRAP"),"50") || CPLib.eqr(Cursor_rapotit.GetString("TIPOOPRAP"),"52")) {
                /* If rapotit->DATAOPE > w_AData */
                if (CPLib.gt(Cursor_rapotit.GetDate("DATAOPE"),w_AData)) {
                  /* _continua := 0 */
                  _continua = CPLib.Round(0,0);
                } // End If
                /* Case rapotit->TIPOOPRAP='51' or rapotit->TIPOOPRAP='53'  */
              } else if (CPLib.eqr(Cursor_rapotit.GetString("TIPOOPRAP"),"51") || CPLib.eqr(Cursor_rapotit.GetString("TIPOOPRAP"),"53")) {
                /* If rapotit->DATAOPE < w_DaData */
                if (CPLib.lt(Cursor_rapotit.GetDate("DATAOPE"),w_DaData)) {
                  /* _continua := 0 */
                  _continua = CPLib.Round(0,0);
                } // End If
                /* If _continua= 1 and rapotit->DATAOPE > w_AData */
                if (CPLib.eqr(_continua,1) && CPLib.gt(Cursor_rapotit.GetDate("DATAOPE"),w_AData)) {
                  /* _continua := 0 */
                  _continua = CPLib.Round(0,0);
                } // End If
                /* Case rapotit->TIPOOPRAP='58' */
              } else if (CPLib.eqr(Cursor_rapotit.GetString("TIPOOPRAP"),"58")) {
                /* If rapotit->DATAOPE > w_AData or rapotit->DATAOPE < w_DaData */
                if (CPLib.gt(Cursor_rapotit.GetDate("DATAOPE"),w_AData) || CPLib.lt(Cursor_rapotit.GetDate("DATAOPE"),w_DaData)) {
                  /* _continua := 0 */
                  _continua = CPLib.Round(0,0);
                } // End If
              } // End Case
              Cursor_rapotit.Next();
            }
            m_cConnectivityError = Cursor_rapotit.ErrorMessage();
            Cursor_rapotit.Close();
            // * --- End Select
          } // End Case
          /* If not(Empty(w_codcli)) and _continua=1 */
          if ( ! (CPLib.Empty(w_codcli)) && CPLib.eqr(_continua,1)) {
            /* _continua := 0 */
            _continua = CPLib.Round(0,0);
            // * --- Select from intestit
            m_cServer = m_Ctx.GetServer("intestit");
            m_cPhName = m_Ctx.GetPhName("intestit");
            if (Cursor_intestit!=null)
              Cursor_intestit.Close();
            Cursor_intestit = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CODCLI="+CPLib.ToSQL(Cursor_qbe_titd_chkdiana.GetString("CONNESCLI"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("intestit")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_intestit.Eof())) {
              /* If intestit->CODINTER=w_codcli */
              if (CPLib.eqr(Cursor_intestit.GetString("CODINTER"),w_codcli)) {
                /* _continua := 1 */
                _continua = CPLib.Round(1,0);
              } // End If
              Cursor_intestit.Next();
            }
            m_cConnectivityError = Cursor_intestit.ErrorMessage();
            Cursor_intestit.Close();
            // * --- End Select
          } // End If
          /* If _continua=1 */
          if (CPLib.eqr(_continua,1)) {
            /* _ctotale := _ctotale + 1 */
            _ctotale = CPLib.Round(_ctotale+1,0);
            /* gMsgImp := 'Elaborazione Informazione N.: '+LRTrim(Str(_ctotale,15,0)) // Messaggio Import */
            gMsgImp = "Elaborazione Informazione N.: "+CPLib.LRTrim(CPLib.Str(_ctotale,15,0));
            m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
            /* _idereg := arfn_calc_idereg("T",qbe_titd_chkdiana->NUMPROG,qbe_titd_chkdiana->IDEREG) */
            _idereg = arfn_calc_ideregR.Make(m_Ctx,this).Run("T",Cursor_qbe_titd_chkdiana.GetString("NUMPROG"),Cursor_qbe_titd_chkdiana.GetString("IDEREG"));
            /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '1' + _idereg */
            _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"1"+_idereg;
            /* _datage := arfn_datidip_sol(qbe_titd_chkdiana->CODDIPE,qbe_titd_chkdiana->CODCAB,qbe_titd_chkdiana->DESCCIT,qbe_titd_chkdiana->PROVINCIA) */
            _datage = arfn_datidip_solR.Make(m_Ctx,this).Run(Cursor_qbe_titd_chkdiana.GetString("CODDIPE"),Cursor_qbe_titd_chkdiana.GetString("CODCAB"),Cursor_qbe_titd_chkdiana.GetString("DESCCIT"),Cursor_qbe_titd_chkdiana.GetString("PROVINCIA"));
            /* _tipoag := Right(_datage,10) */
            _tipoag = CPLib.Right(_datage,10);
            /* _note := _note + Left(_datage,44) */
            _note = _note+CPLib.Left(_datage,44);
            /* _note := _note + Left(DateToChar(qbe_titd_chkdiana->DATAOPE)+Space(8),8) + Left(LRTrim(qbe_titd_chkdiana->FLAGFRAZ)+" ",1) + Left(LRTrim(qbe_titd_chkdiana->FLAGCONT)+" ",1) */
            _note = _note+CPLib.Left(CPLib.DateToChar(Cursor_qbe_titd_chkdiana.GetDate("DATAOPE"))+CPLib.Space(8),8)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_titd_chkdiana.GetString("FLAGFRAZ"))+" ",1)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_titd_chkdiana.GetString("FLAGCONT"))+" ",1);
            /* _note := _note + Left(LRTrim(qbe_titd_chkdiana->CODANA)+Space(4),4) + Left(LRTrim(qbe_titd_chkdiana->CODVOC)+Space(2),2) */
            _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_titd_chkdiana.GetString("CODANA"))+CPLib.Space(4),4)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_titd_chkdiana.GetString("CODVOC"))+CPLib.Space(2),2);
            /* _note := _note + Left(LRTrim(qbe_titd_chkdiana->TIPOINT2)+Space(2),2) + Left(LRTrim(qbe_titd_chkdiana->CODINT2)+Space(11),11) + Left(LRTrim(qbe_titd_chkdiana->PAESE)+Space(3),3) */
            _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_titd_chkdiana.GetString("TIPOINT2"))+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_titd_chkdiana.GetString("CODINT2"))+CPLib.Space(11),11)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_titd_chkdiana.GetString("PAESE"))+CPLib.Space(3),3);
            /* _note := _note + Left(LRTrim(qbe_titd_chkdiana->CODCAB2)+Space(6),6) + Left(LRTrim(qbe_titd_chkdiana->DESC2)+Space(30),30) + Left(LRTrim(qbe_titd_chkdiana->PROV2)+Space(2),2) */
            _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_titd_chkdiana.GetString("CODCAB2"))+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_titd_chkdiana.GetString("DESC2"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_titd_chkdiana.GetString("PROV2"))+CPLib.Space(2),2);
            /* _note := _note + Left(LRTrim(qbe_titd_chkdiana->DESCINTER)+Space(50),50) + Left(LRTrim(qbe_titd_chkdiana->RAPPORTO)+Space(25),25) + Left(LRTrim(qbe_titd_chkdiana->FLAGRAP)+" ",1) */
            _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_titd_chkdiana.GetString("DESCINTER"))+CPLib.Space(50),50)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_titd_chkdiana.GetString("RAPPORTO"))+CPLib.Space(25),25)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_titd_chkdiana.GetString("FLAGRAP"))+" ",1);
            /* _note := _note + Left(LRTrim(qbe_titd_chkdiana->TIPOLEG)+" ",1) + Left(LRTrim(DateToChar(qbe_titd_chkdiana->DATAREG))+Space(8),8) */
            _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_titd_chkdiana.GetString("TIPOLEG"))+" ",1)+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_qbe_titd_chkdiana.GetDate("DATAREG")))+CPLib.Space(8),8);
            /* _note := _note + Left(LRTrim(qbe_titd_chkdiana->TIPOOPRAP)+Space(2),2) + Left(LRTrim(qbe_titd_chkdiana->COLLEG)+Space(12),12) */
            _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_titd_chkdiana.GetString("TIPOOPRAP"))+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_titd_chkdiana.GetString("COLLEG"))+CPLib.Space(12),12);
            /* _note := _note + Left(LRTrim(qbe_titd_chkdiana->STATOREG)+" ",1)  */
            _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_titd_chkdiana.GetString("STATOREG"))+" ",1);
            /* If Empty(qbe_titd_chkdiana->DATARETT) or DateToChar(qbe_titd_chkdiana->DATARETT)='01000101' */
            if (CPLib.Empty(Cursor_qbe_titd_chkdiana.GetDate("DATARETT")) || CPLib.eqr(CPLib.DateToChar(Cursor_qbe_titd_chkdiana.GetDate("DATARETT")),"01000101")) {
              /* _note := _note + Space(8) */
              _note = _note+CPLib.Space(8);
            } else { // Else
              /* _note := _note + Left(LRTrim(DateToChar(qbe_titd_chkdiana->DATARETT))+Space(8),8) */
              _note = _note+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_qbe_titd_chkdiana.GetDate("DATARETT")))+CPLib.Space(8),8);
            } // End If
            /* If Left(qbe_titd_chkdiana->OPERAZMOD,1)='T' */
            if (CPLib.eqr(CPLib.Left(Cursor_qbe_titd_chkdiana.GetString("OPERAZMOD"),1),"T")) {
              /* _note := _note + iif(Empty(LRTrim(qbe_titd_chkdiana->OPERAZMOD)),Space(20),qbe_titd_chkdiana->OPERAZMOD) */
              _note = _note+(CPLib.Empty(CPLib.LRTrim(Cursor_qbe_titd_chkdiana.GetString("OPERAZMOD")))?CPLib.Space(20):Cursor_qbe_titd_chkdiana.GetString("OPERAZMOD"));
            } else { // Else
              /* _note := _note + iif(Empty(LRTrim(qbe_titd_chkdiana->OPERAZMOD)),Space(20),Left(qbe_titd_chkdiana->OPERAZMOD,8)+"T"+Right(qbe_titd_chkdiana->OPERAZMOD,11)) */
              _note = _note+(CPLib.Empty(CPLib.LRTrim(Cursor_qbe_titd_chkdiana.GetString("OPERAZMOD")))?CPLib.Space(20):CPLib.Left(Cursor_qbe_titd_chkdiana.GetString("OPERAZMOD"),8)+"T"+CPLib.Right(Cursor_qbe_titd_chkdiana.GetString("OPERAZMOD"),11));
            } // End If
            /* _note := _note + Left(LRTrim(qbe_titd_chkdiana->FLAGLIRE)+" ",1) + Left(LRTrim(qbe_titd_chkdiana->VALUTA)+Space(3),3) + Left(LRTrim(qbe_titd_chkdiana->SEGNO)+" ",1) */
            _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_titd_chkdiana.GetString("FLAGLIRE"))+" ",1)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_titd_chkdiana.GetString("VALUTA"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_titd_chkdiana.GetString("SEGNO"))+" ",1);
            /* _note := _note +  Right('000000000000000'+LRTrim(Str(qbe_titd_chkdiana->TOTLIRE,15,0)),15) + Right('000000000000000'+LRTrim(Str(qbe_titd_chkdiana->TOTCONT,15,0)),15)  + Space(47)+"T"+qbe_titd_chkdiana->NUMPROG+Left(LRTrim(_tipoag)+Space(10),10) */
            _note = _note+CPLib.Right("000000000000000"+CPLib.LRTrim(CPLib.Str(Cursor_qbe_titd_chkdiana.GetDouble("TOTLIRE"),15,0)),15)+CPLib.Right("000000000000000"+CPLib.LRTrim(CPLib.Str(Cursor_qbe_titd_chkdiana.GetDouble("TOTCONT"),15,0)),15)+CPLib.Space(47)+"T"+Cursor_qbe_titd_chkdiana.GetString("NUMPROG")+CPLib.Left(CPLib.LRTrim(_tipoag)+CPLib.Space(10),10);
            /* Exec "Scrittura Dati" Page 15:Page_19 */
            Page_19();
            /* nTotRec := nTotRec + 1 */
            nTotRec = CPLib.Round(nTotRec+1,0);
            /* nTotReg := nTotReg + 1 */
            nTotReg = CPLib.Round(nTotReg+1,0);
            /* nNumRec := nNumRec + 1 */
            nNumRec = CPLib.Round(nNumRec+1,0);
            /* If not(Empty(qbe_titd_chkdiana->CONNESCLI)) */
            if ( ! (CPLib.Empty(Cursor_qbe_titd_chkdiana.GetString("CONNESCLI")))) {
              /* If qbe_titd_chkdiana->DATAOPE > CharToDate('20131231') */
              if (CPLib.gt(Cursor_qbe_titd_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                /* If LRTrim(qbe_titd_chkdiana->TIPOLEG)='5' */
                if (CPLib.eqr(CPLib.LRTrim(Cursor_qbe_titd_chkdiana.GetString("TIPOLEG")),"5")) {
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'7'+_idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                  /* _tiprec := '7' */
                  _tiprec = "7";
                } else { // Else
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'9'+_idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"9"+_idereg;
                  /* _tiprec := '9' */
                  _tiprec = "9";
                } // End If
              } else { // Else
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'2'+_idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                /* _tiprec := '2' */
                _tiprec = "2";
              } // End If
              /* If qbe_titd_chkdiana->TIPOOPRAP='54' */
              if (CPLib.eqr(Cursor_qbe_titd_chkdiana.GetString("TIPOOPRAP"),"54")) {
                /* pCli := qbe_titd_chkdiana->CONNESCLI // Codice Soggetto */
                pCli = Cursor_qbe_titd_chkdiana.GetString("CONNESCLI");
                /* pDatOpe := arfn_dateminus(iif(w_stoper='R',qbe_titd_chkdiana->DATAREG,qbe_titd_chkdiana->DATAOPE),1) // Data Operazione */
                pDatOpe = arfn_dateminusR.Make(m_Ctx,this).Run((CPLib.eqr(w_stoper,"R")?Cursor_qbe_titd_chkdiana.GetDate("DATAREG"):Cursor_qbe_titd_chkdiana.GetDate("DATAOPE")),1);
                /* pRap := qbe_titd_chkdiana->RAPPORTO // Codice Rapporto */
                pRap = Cursor_qbe_titd_chkdiana.GetString("RAPPORTO");
                /* pTRap := qbe_titd_chkdiana->FLAGRAP // Tipo Rapporto */
                pTRap = Cursor_qbe_titd_chkdiana.GetString("FLAGRAP");
                /* pTipoR := _tiprec // Tipo Riga */
                pTipoR = _tiprec;
                /* pRAE := _raeatc // RAE o ATECO */
                pRAE = _raeatc;
                /* pSTATO := qbe_titd_chkdiana->STATOREG // Stato Registrazione */
                pSTATO = Cursor_qbe_titd_chkdiana.GetString("STATOREG");
                /* pDatRet := qbe_titd_chkdiana->DATARETT // Data Rettifica */
                pDatRet = Cursor_qbe_titd_chkdiana.GetDate("DATARETT");
                /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                DatiSoggetto();
              } else { // Else
                /* pCli := qbe_titd_chkdiana->CONNESCLI // Codice Soggetto */
                pCli = Cursor_qbe_titd_chkdiana.GetString("CONNESCLI");
                /* pDatOpe := iif(w_stoper='R',qbe_titd_chkdiana->DATAREG,qbe_titd_chkdiana->DATAOPE) // Data Operazione */
                pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_titd_chkdiana.GetDate("DATAREG"):Cursor_qbe_titd_chkdiana.GetDate("DATAOPE"));
                /* pRap := qbe_titd_chkdiana->RAPPORTO // Codice Rapporto */
                pRap = Cursor_qbe_titd_chkdiana.GetString("RAPPORTO");
                /* pTRap := qbe_titd_chkdiana->FLAGRAP // Tipo Rapporto */
                pTRap = Cursor_qbe_titd_chkdiana.GetString("FLAGRAP");
                /* pTipoR := _tiprec // Tipo Riga */
                pTipoR = _tiprec;
                /* pRAE := _raeatc // RAE o ATECO */
                pRAE = _raeatc;
                /* pSTATO := qbe_titd_chkdiana->STATOREG // Stato Registrazione */
                pSTATO = Cursor_qbe_titd_chkdiana.GetString("STATOREG");
                /* pDatRet := qbe_titd_chkdiana->DATARETT // Data Rettifica */
                pDatRet = Cursor_qbe_titd_chkdiana.GetDate("DATARETT");
                /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                DatiSoggetto();
              } // End If
              /* Exec "Scrittura Dati" Page 15:Page_19 */
              Page_19();
              /* nTotRec := nTotRec + 1 */
              nTotRec = CPLib.Round(nTotRec+1,0);
              /* nNumRec := nNumRec + 1 */
              nNumRec = CPLib.Round(nNumRec+1,0);
            } // End If
            /* If qbe_titd_chkdiana->TIPOOPRAP='50' or qbe_titd_chkdiana->TIPOOPRAP='52' */
            if (CPLib.eqr(Cursor_qbe_titd_chkdiana.GetString("TIPOOPRAP"),"50") || CPLib.eqr(Cursor_qbe_titd_chkdiana.GetString("TIPOOPRAP"),"52")) {
              // * --- Select from intestit
              m_cServer = m_Ctx.GetServer("intestit");
              m_cPhName = m_Ctx.GetPhName("intestit");
              if (Cursor_intestit!=null)
                Cursor_intestit.Close();
              Cursor_intestit = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"NUMPROG1="+CPLib.ToSQL(Cursor_qbe_titd_chkdiana.GetString("NUMPROG"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("intestit")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
              while ( ! (Cursor_intestit.Eof())) {
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'6'+_idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"6"+_idereg;
                /* pCli := intestit->CODINTER // Codice Soggetto */
                pCli = Cursor_intestit.GetString("CODINTER");
                /* pDatOpe := iif(w_stoper='R',qbe_titd_chkdiana->DATAREG,qbe_titd_chkdiana->DATAOPE) // Data Operazione */
                pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_titd_chkdiana.GetDate("DATAREG"):Cursor_qbe_titd_chkdiana.GetDate("DATAOPE"));
                /* pRap := qbe_titd_chkdiana->RAPPORTO // Codice Rapporto */
                pRap = Cursor_qbe_titd_chkdiana.GetString("RAPPORTO");
                /* pTRap := qbe_titd_chkdiana->FLAGRAP // Tipo Rapporto */
                pTRap = Cursor_qbe_titd_chkdiana.GetString("FLAGRAP");
                /* pTipoR := '6' // Tipo Riga */
                pTipoR = "6";
                /* pRAE := _raeatc // RAE o ATECO */
                pRAE = _raeatc;
                /* pSTATO := qbe_titd_chkdiana->STATOREG // Stato Registrazione */
                pSTATO = Cursor_qbe_titd_chkdiana.GetString("STATOREG");
                /* pDatRet := qbe_titd_chkdiana->DATARETT // Data Rettifica */
                pDatRet = Cursor_qbe_titd_chkdiana.GetDate("DATARETT");
                /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                DatiSoggetto();
                /* Exec "Scrittura Dati" Page 15:Page_19 */
                Page_19();
                Cursor_intestit.Next();
              }
              m_cConnectivityError = Cursor_intestit.ErrorMessage();
              Cursor_intestit.Close();
              // * --- End Select
              /* ElseIf qbe_titd_chkdiana->TIPOOPRAP='51' or qbe_titd_chkdiana->TIPOOPRAP='53' */
            } else if (CPLib.eqr(Cursor_qbe_titd_chkdiana.GetString("TIPOOPRAP"),"51") || CPLib.eqr(Cursor_qbe_titd_chkdiana.GetString("TIPOOPRAP"),"53")) {
              // * --- Select from intestit
              m_cServer = m_Ctx.GetServer("intestit");
              m_cPhName = m_Ctx.GetPhName("intestit");
              if (Cursor_intestit!=null)
                Cursor_intestit.Close();
              Cursor_intestit = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"NUMPROG2="+CPLib.ToSQL(Cursor_qbe_titd_chkdiana.GetString("NUMPROG"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("intestit")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
              while ( ! (Cursor_intestit.Eof())) {
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'6'+_idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"6"+_idereg;
                /* pCli := intestit->CODINTER // Codice Soggetto */
                pCli = Cursor_intestit.GetString("CODINTER");
                /* pDatOpe := iif(w_stoper='R',qbe_titd_chkdiana->DATAREG,qbe_titd_chkdiana->DATAOPE) // Data Operazione */
                pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_titd_chkdiana.GetDate("DATAREG"):Cursor_qbe_titd_chkdiana.GetDate("DATAOPE"));
                /* pRap := qbe_titd_chkdiana->RAPPORTO // Codice Rapporto */
                pRap = Cursor_qbe_titd_chkdiana.GetString("RAPPORTO");
                /* pTRap := qbe_titd_chkdiana->FLAGRAP // Tipo Rapporto */
                pTRap = Cursor_qbe_titd_chkdiana.GetString("FLAGRAP");
                /* pTipoR := '6' // Tipo Riga */
                pTipoR = "6";
                /* pRAE := _raeatc // RAE o ATECO */
                pRAE = _raeatc;
                /* pSTATO := qbe_titd_chkdiana->STATOREG // Stato Registrazione */
                pSTATO = Cursor_qbe_titd_chkdiana.GetString("STATOREG");
                /* pDatRet := qbe_titd_chkdiana->DATARETT // Data Rettifica */
                pDatRet = Cursor_qbe_titd_chkdiana.GetDate("DATARETT");
                /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                DatiSoggetto();
                /* Exec "Scrittura Dati" Page 15:Page_19 */
                Page_19();
                Cursor_intestit.Next();
              }
              m_cConnectivityError = Cursor_intestit.ErrorMessage();
              Cursor_intestit.Close();
              // * --- End Select
            } else { // Else
              // * --- Select from intestit
              m_cServer = m_Ctx.GetServer("intestit");
              m_cPhName = m_Ctx.GetPhName("intestit");
              if (Cursor_intestit!=null)
                Cursor_intestit.Close();
              Cursor_intestit = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CODCLI="+CPLib.ToSQL(Cursor_qbe_titd_chkdiana.GetString("CONNESCLI"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("intestit")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
              while ( ! (Cursor_intestit.Eof())) {
                /* If intestit->DATAINI <= qbe_titd_chkdiana->DATAOPE and (Empty(intestit->DATAFINE) or (intestit->DATAFINE >= qbe_titd_chkdiana->DATAOPE)) */
                if (CPLib.le(Cursor_intestit.GetDate("DATAINI"),Cursor_qbe_titd_chkdiana.GetDate("DATAOPE")) && (CPLib.Empty(Cursor_intestit.GetDate("DATAFINE")) || (CPLib.ge(Cursor_intestit.GetDate("DATAFINE"),Cursor_qbe_titd_chkdiana.GetDate("DATAOPE"))))) {
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'6'+_idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"6"+_idereg;
                  /* If qbe_titd_chkdiana->TIPOOPRAP='54' */
                  if (CPLib.eqr(Cursor_qbe_titd_chkdiana.GetString("TIPOOPRAP"),"54")) {
                    /* pCli := intestit->CODINTER // Codice Soggetto */
                    pCli = Cursor_intestit.GetString("CODINTER");
                    /* pDatOpe := arfn_dateminus(iif(w_stoper='R',qbe_titd_chkdiana->DATAREG,qbe_titd_chkdiana->DATAOPE),1) // Data Operazione */
                    pDatOpe = arfn_dateminusR.Make(m_Ctx,this).Run((CPLib.eqr(w_stoper,"R")?Cursor_qbe_titd_chkdiana.GetDate("DATAREG"):Cursor_qbe_titd_chkdiana.GetDate("DATAOPE")),1);
                    /* pRap := qbe_titd_chkdiana->RAPPORTO // Codice Rapporto */
                    pRap = Cursor_qbe_titd_chkdiana.GetString("RAPPORTO");
                    /* pTRap := qbe_titd_chkdiana->FLAGRAP // Tipo Rapporto */
                    pTRap = Cursor_qbe_titd_chkdiana.GetString("FLAGRAP");
                    /* pTipoR := '6' // Tipo Riga */
                    pTipoR = "6";
                    /* pRAE := _raeatc // RAE o ATECO */
                    pRAE = _raeatc;
                    /* pSTATO := qbe_titd_chkdiana->STATOREG // Stato Registrazione */
                    pSTATO = Cursor_qbe_titd_chkdiana.GetString("STATOREG");
                    /* pDatRet := qbe_titd_chkdiana->DATARETT // Data Rettifica */
                    pDatRet = Cursor_qbe_titd_chkdiana.GetDate("DATARETT");
                    /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                    DatiSoggetto();
                  } else { // Else
                    /* pCli := intestit->CODINTER // Codice Soggetto */
                    pCli = Cursor_intestit.GetString("CODINTER");
                    /* pDatOpe := iif(w_stoper='R',qbe_titd_chkdiana->DATAREG,qbe_titd_chkdiana->DATAOPE) // Data Operazione */
                    pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_titd_chkdiana.GetDate("DATAREG"):Cursor_qbe_titd_chkdiana.GetDate("DATAOPE"));
                    /* pRap := qbe_titd_chkdiana->RAPPORTO // Codice Rapporto */
                    pRap = Cursor_qbe_titd_chkdiana.GetString("RAPPORTO");
                    /* pTRap := qbe_titd_chkdiana->FLAGRAP // Tipo Rapporto */
                    pTRap = Cursor_qbe_titd_chkdiana.GetString("FLAGRAP");
                    /* pTipoR := '6' // Tipo Riga */
                    pTipoR = "6";
                    /* pRAE := _raeatc // RAE o ATECO */
                    pRAE = _raeatc;
                    /* pSTATO := qbe_titd_chkdiana->STATOREG // Stato Registrazione */
                    pSTATO = Cursor_qbe_titd_chkdiana.GetString("STATOREG");
                    /* pDatRet := qbe_titd_chkdiana->DATARETT // Data Rettifica */
                    pDatRet = Cursor_qbe_titd_chkdiana.GetDate("DATARETT");
                    /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                    DatiSoggetto();
                  } // End If
                  /* Exec "Scrittura Dati" Page 15:Page_19 */
                  Page_19();
                } // End If
                Cursor_intestit.Next();
              }
              m_cConnectivityError = Cursor_intestit.ErrorMessage();
              Cursor_intestit.Close();
              // * --- End Select
            } // End If
            /* If not(Empty(qbe_titd_chkdiana->CONNESOPER)) */
            if ( ! (CPLib.Empty(Cursor_qbe_titd_chkdiana.GetString("CONNESOPER")))) {
              /* nTotRec := nTotRec + 1 */
              nTotRec = CPLib.Round(nTotRec+1,0);
              /* nNumRec := nNumRec + 1 */
              nNumRec = CPLib.Round(nNumRec+1,0);
            } // End If
            /* gNumRec := nTotRec // N° Record DIANA */
            gNumRec = CPLib.Round(nTotRec,0);
            m_Ctx.SetGlobalNumber("gNumRec",gNumRec);
            /* gNumReg := nTotReg // N° Registrazioni DIANA */
            gNumReg = CPLib.Round(nTotReg,0);
            m_Ctx.SetGlobalNumber("gNumReg",gNumReg);
          } // End If
          Cursor_qbe_titd_chkdiana.Next();
        }
        m_cConnectivityError = Cursor_qbe_titd_chkdiana.ErrorMessage();
        Cursor_qbe_titd_chkdiana.Close();
        // * --- End Select
      } // End If
    } finally {
      try {
        if (Cursor_qbe_titd_chkdiana!=null)
          Cursor_qbe_titd_chkdiana.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_rapotit!=null)
          Cursor_rapotit.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_intestit!=null)
          Cursor_intestit.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
    }
  }
  void Page_6() throws Exception {
    // Create a buffer for reading the files
        byte[] buf = new byte[1024];
        
        try {
            // Create the ZIP file
            String outFilename = cNomeFileZip;
            java.util.zip.ZipOutputStream out = new java.util.zip.ZipOutputStream(new java.io.FileOutputStream(outFilename));
        
            // Compress the files
            for (int i=0; i<filenames.size(); i++) {
                _file1=(String)filenames.elementAt(i);
                _file2=(String)fileonames.elementAt(i);
                java.io.FileInputStream in = new java.io.FileInputStream(_file1);
        
                // Add ZIP entry to output stream.
                out.putNextEntry(new java.util.zip.ZipEntry(_file2));
        
                // Transfer bytes from the file to the ZIP file
                int len;
                while ((len = in.read(buf)) > 0) {
                    out.write(buf, 0, len);
                }
        
                // Complete the entry
                out.closeEntry();
                in.close();
            }
        
            // Complete the ZIP file
            out.close();
            filenames.removeAllElements();
            fileonames.removeAllElements();
        } catch (java.io.IOException e) {
        }
    
  }
  void Page_7() throws Exception {
    CPResultSet Cursor_qbe_oped_chkdiana_limits=null;
    CPResultSet Cursor_qbe_oped_chkdiana=null;
    CPResultSet Cursor_qbe_tab_mmc=null;
    CPResultSet Cursor_kersonbo=null;
    CPResultSet Cursor_intestbo=null;
    CPResultSet Cursor_mlientiope=null;
    CPResultSet Cursor_clientiope=null;
    CPResultSet Read_Cursor=null;
    CPResultSet Cursor_mogopebo=null;
    CPResultSet Cursor_sogopebo=null;
    CPResultSet Cursor_personbo=null;
    CPResultSet Cursor_wersonbo=null;
    CPResultSet Cursor_meneficope=null;
    CPResultSet Cursor_beneficope=null;
    CPResultSet Cursor_merzistiope=null;
    CPResultSet Cursor_terzistiope=null;
    CPResultSet Cursor_rapcoll=null;
    VQRHolder l_VQRHolder = null;
    try {
      /* Cicla sulle operazioni */
      /* gMsgImp := 'Verifica Operazioni da elaborare ...' // Messaggio Import */
      gMsgImp = "Verifica Operazioni da elaborare ...";
      m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
      /* _max := 0 */
      _max = CPLib.Round(0,0);
      /* _min := 0 */
      _min = CPLib.Round(0,0);
      /* _ciclo := 0 */
      _ciclo = CPLib.Round(0,0);
      /* Prima gli italiani */
      // * --- Select from qbe_oped_chkdiana_limits
      SPBridge.HMCaller _h00000551;
      _h00000551 = new SPBridge.HMCaller();
      _h00000551.Set("m_cVQRList",m_cVQRList);
      _h00000551.Set("cdadata",w_cdadata);
      _h00000551.Set("c_adata",w_c_adata);
      _h00000551.Set("codage",w_codage);
      _h00000551.Set("ragben",w_ragben);
      _h00000551.Set("cdareg",w_cdareg);
      _h00000551.Set("c_areg",w_c_areg);
      _h00000551.Set("codcli",w_codcli);
      _h00000551.Set("flgsto",w_flgsto);
      if (Cursor_qbe_oped_chkdiana_limits!=null)
        Cursor_qbe_oped_chkdiana_limits.Close();
      Cursor_qbe_oped_chkdiana_limits = new VQRHolder("qbe_oped_chkdiana_limits",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000551,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_oped_chkdiana_limits.Eof())) {
        /* _max := qbe_oped_chkdiana_limits->MAXOPE */
        _max = CPLib.Round(Cursor_qbe_oped_chkdiana_limits.GetDouble("MAXOPE"),0);
        /* _min := qbe_oped_chkdiana_limits->MINOPE */
        _min = CPLib.Round(Cursor_qbe_oped_chkdiana_limits.GetDouble("MINOPE"),0);
        Cursor_qbe_oped_chkdiana_limits.Next();
      }
      m_cConnectivityError = Cursor_qbe_oped_chkdiana_limits.ErrorMessage();
      Cursor_qbe_oped_chkdiana_limits.Close();
      // * --- End Select
      /* _cicli := iif(Mod(_max,_maxrighe) <> 0,Int(_max/_maxrighe) + 1,Int(_max/_maxrighe)) */
      _cicli = CPLib.Round((CPLib.ne(CPLib.Mod(_max,_maxrighe),0)?CPLib.Int(_max/_maxrighe)+1:CPLib.Int(_max/_maxrighe)),0);
      /* _bottom := _min */
      _bottom = CPLib.Round(_min,0);
      /* If _min >_maxrighe */
      if (CPLib.gt(_min,_maxrighe)) {
        /* _contacilci := Int(_min/_maxrighe) + 1 */
        _contacilci = CPLib.Round(CPLib.Int(_min/_maxrighe)+1,0);
      } else { // Else
        /* _contacilci := 1 */
        _contacilci = CPLib.Round(1,0);
      } // End If
      /* gMsgImp := 'Lettura operazioni in corso ...' // Messaggio Import */
      gMsgImp = "Lettura operazioni in corso ...";
      m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
      /* While _contacilci<=_cicli */
      while (CPLib.le(_contacilci,_cicli)) {
        /* _bottom := iif(_ciclo=0,_bottom,((_contacilci -1 ) * _maxrighe) + 1) */
        _bottom = CPLib.Round((CPLib.eqr(_ciclo,0)?_bottom:((_contacilci-1)*_maxrighe)+1),0);
        /* _top := _contacilci * _maxrighe */
        _top = CPLib.Round(_contacilci*_maxrighe,0);
        /* _ciclo := 1 */
        _ciclo = CPLib.Round(1,0);
        /* _conta := _conta + 1 */
        _conta = CPLib.Round(_conta+1,0);
        /* gMsgImp := 'Lettura operazioni in corso ... Ciclo N. '+LRTrim(Str(_contacilci,10,0)) // Messaggio Import */
        gMsgImp = "Lettura operazioni in corso ... Ciclo N. "+CPLib.LRTrim(CPLib.Str(_contacilci,10,0));
        m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
        /* Cicla sulle operazioni */
        // * --- Select from qbe_oped_chkdiana
        SPBridge.HMCaller _h00000561;
        _h00000561 = new SPBridge.HMCaller();
        _h00000561.Set("m_cVQRList",m_cVQRList);
        _h00000561.Set("cdadata",w_cdadata);
        _h00000561.Set("c_adata",w_c_adata);
        _h00000561.Set("codage",w_codage);
        _h00000561.Set("_bottom",_bottom);
        _h00000561.Set("_top",_top);
        _h00000561.Set("ragben",w_ragben);
        _h00000561.Set("cdareg",w_cdareg);
        _h00000561.Set("c_areg",w_c_areg);
        _h00000561.Set("codcli",w_codcli);
        _h00000561.Set("flgsto",w_flgsto);
        if (Cursor_qbe_oped_chkdiana!=null)
          Cursor_qbe_oped_chkdiana.Close();
        Cursor_qbe_oped_chkdiana = new VQRHolder("qbe_oped_chkdiana",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000561,true).GetResultSet(m_Ctx);
        while ( ! (Cursor_qbe_oped_chkdiana.Eof())) {
          /* mcRighe.Zap() */
          mcRighe.Zap();
          /* If _rapcolleg */
          if (_rapcolleg) {
            // * --- Select from qbe_tab_mmc
            SPBridge.HMCaller _h00000564;
            _h00000564 = new SPBridge.HMCaller();
            _h00000564.Set("m_cVQRList",m_cVQRList);
            _h00000564.Set("tbname","rapcoll");
            _h00000564.Set("fldname","IDFILEBO");
            _h00000564.Set("parname","IDFILEBO");
            _h00000564.Set("parval",Cursor_qbe_oped_chkdiana.GetString("IDBASE"));
            if (Cursor_qbe_tab_mmc!=null)
              Cursor_qbe_tab_mmc.Close();
            Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000564,true).GetResultSet(m_Ctx);
            while ( ! (Cursor_qbe_tab_mmc.Eof())) {
              /* _rapcoll := qbe_tab_mmc->tot > 0 */
              _rapcoll = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
              Cursor_qbe_tab_mmc.Next();
            }
            m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
            Cursor_qbe_tab_mmc.Close();
            // * --- End Select
          } else { // Else
            /* _rapcoll := False */
            _rapcoll = false;
          } // End If
          /* _ctotale := _ctotale + 1 */
          _ctotale = CPLib.Round(_ctotale+1,0);
          /* gMsgImp := 'Elaborazione Operazione N.: '+LRTrim(Str(_ctotale,15,0)) // Messaggio Import */
          gMsgImp = "Elaborazione Operazione N.: "+CPLib.LRTrim(CPLib.Str(_ctotale,15,0));
          m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
          /* _idereg := arfn_calc_idereg("O",qbe_oped_chkdiana->NUMPROG,qbe_oped_chkdiana->IDEREG) */
          _idereg = arfn_calc_ideregR.Make(m_Ctx,this).Run("O",Cursor_qbe_oped_chkdiana.GetString("NUMPROG"),Cursor_qbe_oped_chkdiana.GetString("IDEREG"));
          /* If qbe_oped_chkdiana->DATAOPE <  CharToDate('20100601') */
          if (CPLib.lt(Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20100601"))) {
            /* _raeatc := 'R' */
            _raeatc = "R";
            /* ElseIf qbe_oped_chkdiana->DATAOPE >  CharToDate('20131231') */
          } else if (CPLib.gt(Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
            /* _raeatc := 'A' */
            _raeatc = "A";
          } else { // Else
            /* _raeatc := w_flgrae */
            _raeatc = w_flgrae;
          } // End If
          /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '1' + _idereg */
          _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"1"+_idereg;
          /* _flagrap := '' */
          _flagrap = "";
          /* _oldrap := '' */
          _oldrap = "";
          /* If not(Empty(LRTrim(qbe_oped_chkdiana->RAPPORTO))) */
          if ( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("RAPPORTO"))))) {
            /* If mcKnarapbo.GoToKey(LRTrim(qbe_oped_chkdiana->RAPPORTO)) */
            if (mcKnarapbo.GoToKey(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("RAPPORTO")))) {
              /* _flagrap := mcKnarapbo.FLAGRAP */
              _flagrap = mcKnarapbo.row.FLAGRAP;
              /* _oldrap := mcKnarapbo.RAPPORTO */
              _oldrap = mcKnarapbo.row.RAPPORTO;
            } // End If
          } // End If
          /* pCodDip := qbe_oped_chkdiana->CODDIPE // Codice Dipendenza */
          pCodDip = Cursor_qbe_oped_chkdiana.GetString("CODDIPE");
          /* pCodCab := qbe_oped_chkdiana->CODCAB // CAB Dipendenza */
          pCodCab = Cursor_qbe_oped_chkdiana.GetString("CODCAB");
          /* pDesCit := qbe_oped_chkdiana->DESCCIT // Città Dipendenza */
          pDesCit = Cursor_qbe_oped_chkdiana.GetString("DESCCIT");
          /* pProv := qbe_oped_chkdiana->PROVINCIA // Provincia Dipendenza */
          pProv = Cursor_qbe_oped_chkdiana.GetString("PROVINCIA");
          /* Exec "Dati Agenzia" Page 13:Page_17 */
          Page_17();
          /* _note := _note + Left(_datage,44) */
          _note = _note+CPLib.Left(_datage,44);
          /* _numticket := iif(LRTrim(qbe_oped_chkdiana->RIFIMP)='XXXXXXXXX',LibreriaMit.SpacePad(LRTrim(qbe_oped_chkdiana->INFORM),30),LibreriaMit.SpacePad(LRTrim(qbe_oped_chkdiana->RIFIMP),30)) */
          _numticket = (CPLib.eqr(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("RIFIMP")),"XXXXXXXXX")?LibreriaMit.SpacePad(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("INFORM")),30):LibreriaMit.SpacePad(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("RIFIMP")),30));
          /* _note := _note + Left(DateToChar(qbe_oped_chkdiana->DATAOPE)+Space(8),8) + Left(LRTrim(qbe_oped_chkdiana->FLAGFRAZ)+" ",1) + Left(LRTrim(qbe_oped_chkdiana->FLAGCONT)+" ",1) */
          _note = _note+CPLib.Left(CPLib.DateToChar(Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"))+CPLib.Space(8),8)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("FLAGFRAZ"))+" ",1)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("FLAGCONT"))+" ",1);
          /* _note := _note + Left(LRTrim(qbe_oped_chkdiana->CODANA)+Space(4),4) + Left(LRTrim(qbe_oped_chkdiana->CODVOC)+Space(2),2) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("CODANA"))+CPLib.Space(4),4)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("CODVOC"))+CPLib.Space(2),2);
          /* _note := _note + Left(LRTrim(qbe_oped_chkdiana->TIPOINT2)+Space(2),2) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("TIPOINT2"))+CPLib.Space(2),2);
          /* _note := _note + iif(Empty(LRTrim(qbe_oped_chkdiana->CODFISCICP)),Left(LRTrim(qbe_oped_chkdiana->CODINT2)+Space(11),11),Left(LRTrim(qbe_oped_chkdiana->CODFISCICP)+Space(11),11)) */
          _note = _note+(CPLib.Empty(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("CODFISCICP")))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("CODINT2"))+CPLib.Space(11),11):CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("CODFISCICP"))+CPLib.Space(11),11));
          /* _note := _note + Left(LRTrim(qbe_oped_chkdiana->PAESE)+Space(3),3) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("PAESE"))+CPLib.Space(3),3);
          /* _note := _note + Left(LRTrim(qbe_oped_chkdiana->CODCAB2)+Space(6),6) + Left(LRTrim(qbe_oped_chkdiana->DESC2)+Space(30),30) + Left(LRTrim(qbe_oped_chkdiana->PROV2)+Space(2),2) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("CODCAB2"))+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("DESC2"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("PROV2"))+CPLib.Space(2),2);
          /* _note := _note + Left(LRTrim(qbe_oped_chkdiana->DESCINTER)+Space(50),50) + Left(LRTrim(qbe_oped_chkdiana->RAPPORTO)+Space(25),25) + Left(LRTrim(_flagrap)+" ",1) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("DESCINTER"))+CPLib.Space(50),50)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("RAPPORTO"))+CPLib.Space(25),25)+CPLib.Left(CPLib.LRTrim(_flagrap)+" ",1);
          /* _note := _note + Left(LRTrim(qbe_oped_chkdiana->TIPOLEG)+" ",1) + Left(LRTrim(DateToChar(qbe_oped_chkdiana->DATAREG))+Space(8),8) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("TIPOLEG"))+" ",1)+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_qbe_oped_chkdiana.GetDate("DATAREG")))+CPLib.Space(8),8);
          /* _note := _note + Left(LRTrim(qbe_oped_chkdiana->TIPOOPRAP)+Space(2),2) + Left(LRTrim(qbe_oped_chkdiana->COLLEG)+Space(12),12) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("TIPOOPRAP"))+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("COLLEG"))+CPLib.Space(12),12);
          /* _note := _note + Left(LRTrim(qbe_oped_chkdiana->STATOREG)+" ",1)  */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("STATOREG"))+" ",1);
          /* If Empty(qbe_oped_chkdiana->DATARETT) or DateToChar(qbe_oped_chkdiana->DATARETT)='01000101' */
          if (CPLib.Empty(Cursor_qbe_oped_chkdiana.GetDate("DATARETT")) || CPLib.eqr(CPLib.DateToChar(Cursor_qbe_oped_chkdiana.GetDate("DATARETT")),"01000101")) {
            /* _note := _note + Space(8) */
            _note = _note+CPLib.Space(8);
          } else { // Else
            /* _note := _note + Left(LRTrim(DateToChar(qbe_oped_chkdiana->DATARETT))+Space(8),8) */
            _note = _note+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_qbe_oped_chkdiana.GetDate("DATARETT")))+CPLib.Space(8),8);
          } // End If
          /* If Left(qbe_oped_chkdiana->OPERAZMOD,1)='O' */
          if (CPLib.eqr(CPLib.Left(Cursor_qbe_oped_chkdiana.GetString("OPERAZMOD"),1),"O")) {
            /* _note := _note + iif(Empty(LRTrim(qbe_oped_chkdiana->OPERAZMOD)),Space(20),qbe_oped_chkdiana->OPERAZMOD) */
            _note = _note+(CPLib.Empty(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("OPERAZMOD")))?CPLib.Space(20):Cursor_qbe_oped_chkdiana.GetString("OPERAZMOD"));
          } else { // Else
            /* _note := _note + iif(Empty(LRTrim(qbe_oped_chkdiana->OPERAZMOD)),Space(20),Left(qbe_oped_chkdiana->OPERAZMOD,8)+"O"+Right(qbe_oped_chkdiana->OPERAZMOD,11)) */
            _note = _note+(CPLib.Empty(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("OPERAZMOD")))?CPLib.Space(20):CPLib.Left(Cursor_qbe_oped_chkdiana.GetString("OPERAZMOD"),8)+"O"+CPLib.Right(Cursor_qbe_oped_chkdiana.GetString("OPERAZMOD"),11));
          } // End If
          /* _note := _note + arfn_flaglire(qbe_oped_chkdiana->FLAGLIRE,qbe_oped_chkdiana->DATAOPE) + Left(LRTrim(qbe_oped_chkdiana->VALUTA)+Space(3),3) + Left(LRTrim(qbe_oped_chkdiana->SEGNO)+" ",1) */
          _note = _note+arfn_flaglireR.Make(m_Ctx,this).Run(Cursor_qbe_oped_chkdiana.GetString("FLAGLIRE"),Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"))+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("VALUTA"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("SEGNO"))+" ",1);
          /* _note := _note +  Right('000000000000000'+LRTrim(Str(qbe_oped_chkdiana->TOTLIRE,15,0)),15) + Right('000000000000000'+LRTrim(Str(qbe_oped_chkdiana->TOTCONT,15,0)),15) + _numticket+Space(17)+"O"+qbe_oped_chkdiana->NUMPROG+Left(LRTrim(_tipoag)+Space(10),10) */
          _note = _note+CPLib.Right("000000000000000"+CPLib.LRTrim(CPLib.Str(Cursor_qbe_oped_chkdiana.GetDouble("TOTLIRE"),15,0)),15)+CPLib.Right("000000000000000"+CPLib.LRTrim(CPLib.Str(Cursor_qbe_oped_chkdiana.GetDouble("TOTCONT"),15,0)),15)+_numticket+CPLib.Space(17)+"O"+Cursor_qbe_oped_chkdiana.GetString("NUMPROG")+CPLib.Left(CPLib.LRTrim(_tipoag)+CPLib.Space(10),10);
          /* If not(_rapcoll) */
          if ( ! (_rapcoll)) {
            /* Exec "Scrittura Dati" Page 15:Page_19 */
            Page_19();
          } else { // Else
            /* mcRighe.AppendWithKey('1') */
            mcRighe.AppendWithKey("1");
            /* mcRighe.TIPO := '1' */
            mcRighe.row.TIPO = "1";
            /* mcRighe.RIGA := _note */
            mcRighe.row.RIGA = _note;
            /* mcRighe.SaveRow() */
            mcRighe.SaveRow();
          } // End If
          /* nTotRec := nTotRec + 1 */
          nTotRec = CPLib.Round(nTotRec+1,0);
          /* nTotReg := nTotReg + 1 */
          nTotReg = CPLib.Round(nTotReg+1,0);
          /* nNumRec := nNumRec + 1 */
          nNumRec = CPLib.Round(nNumRec+1,0);
          /* If not(_rapcoll) */
          if ( ! (_rapcoll)) {
            /* If not(Empty(qbe_oped_chkdiana->CONNESCLI)) */
            if ( ! (CPLib.Empty(Cursor_qbe_oped_chkdiana.GetString("CONNESCLI")))) {
              /* _codrif := qbe_oped_chkdiana->CONNESCLI */
              _codrif = Cursor_qbe_oped_chkdiana.GetString("CONNESCLI");
              /* If gFlgWU='S' and not(Empty(LRTrim(qbe_oped_chkdiana->CONNESDOC))) */
              if (CPLib.eqr(gFlgWU,"S") &&  ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("CONNESDOC"))))) {
                // * --- Select from kersonbo
                m_cServer = m_Ctx.GetServer("kersonbo");
                m_cPhName = m_Ctx.GetPhName("kersonbo");
                if (Cursor_kersonbo!=null)
                  Cursor_kersonbo.Close();
                Cursor_kersonbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CONNES="+CPLib.ToSQL(Cursor_qbe_oped_chkdiana.GetString("CONNESDOC"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("kersonbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                while ( ! (Cursor_kersonbo.Eof())) {
                  /* _ramate := iif(w_flgrae='R',LRTrim(kersonbo->RAMOGRUP),Left(LRTrim(kersonbo->ATTIV),3)) */
                  _ramate = (CPLib.eqr(w_flgrae,"R")?CPLib.LRTrim(Cursor_kersonbo.GetString("RAMOGRUP")):CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("ATTIV")),3));
                  /* If qbe_oped_chkdiana->DATAOPE > CharToDate('20131231') */
                  if (CPLib.gt(Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                    /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '7' + _idereg */
                    _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                  } else { // Else
                    /* If Empty(qbe_oped_chkdiana->CONNESOPER) or (LRTrim(Upper(qbe_oped_chkdiana->CONNESOPER))=LRTrim(Upper(qbe_oped_chkdiana->CONNESCLI))) */
                    if (CPLib.Empty(Cursor_qbe_oped_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(CPLib.LRTrim(CPLib.Upper(Cursor_qbe_oped_chkdiana.GetString("CONNESOPER"))),CPLib.LRTrim(CPLib.Upper(Cursor_qbe_oped_chkdiana.GetString("CONNESCLI")))))) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+ '2'+_idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                    } else { // Else
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                    } // End If
                  } // End If
                  /* _note := _note + Left(LRTrim(qbe_oped_chkdiana->CONNESCLI)+Space(16),16) + Left(LRTrim(kersonbo->RAGSOC)+Space(70),70) + Left(LRTrim(kersonbo->PAESE)+Space(3),3) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("CONNESCLI"))+CPLib.Space(16),16)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("RAGSOC"))+CPLib.Space(70),70)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("PAESE"))+CPLib.Space(3),3);
                  /* _note := _note + Left(LRTrim(kersonbo->CODCAB)+Space(6),6) + Left(LRTrim(kersonbo->DESCCIT)+Space(30),30) + Left(LRTrim(kersonbo->PROVINCIA)+Space(2),2) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("CODCAB"))+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("DESCCIT"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("PROVINCIA"))+CPLib.Space(2),2);
                  /* _note := _note + Left(LRTrim(kersonbo->DOMICILIO)+Space(35),35) + Left(LRTrim(kersonbo->CAP)+ Space(5),5) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("DOMICILIO"))+CPLib.Space(35),35)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("CAP"))+CPLib.Space(5),5);
                  /* _note := _note + iif(kersonbo->CFESTERO=1,Space(16),Left(LRTrim(kersonbo->CODFISC)+Space(16),16)) */
                  _note = _note+(CPLib.eqr(Cursor_kersonbo.GetDouble("CFESTERO"),1)?CPLib.Space(16):CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("CODFISC"))+CPLib.Space(16),16));
                  /* If Empty(kersonbo->DATANASC) or DateToChar(kersonbo->DATANASC)='01000101' */
                  if (CPLib.Empty(Cursor_kersonbo.GetDate("DATANASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_kersonbo.GetDate("DATANASC")),"01000101")) {
                    /* _note := _note + Space(8) */
                    _note = _note+CPLib.Space(8);
                  } else { // Else
                    /* _note := _note + Left(LRTrim(DateToChar(kersonbo->DATANASC))+Space(8),8) */
                    _note = _note+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_kersonbo.GetDate("DATANASC")))+CPLib.Space(8),8);
                  } // End If
                  /* If not(Empty(kersonbo->NASSTATO)) */
                  if ( ! (CPLib.Empty(Cursor_kersonbo.GetString("NASSTATO")))) {
                    /* _note := _note + Left(LRTrim(kersonbo->NASSTATO)+Space(30),30) + Left(LRTrim(kersonbo->SOTGRUP)+Space(3),3) + Left(LRTrim(_ramate)+Space(3),3) */
                    _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("NASSTATO"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("SOTGRUP"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(_ramate)+CPLib.Space(3),3);
                  } else { // Else
                    /* _note := _note + Left(LRTrim(kersonbo->NASCOMUN)+Space(30),30) + Left(LRTrim(kersonbo->SOTGRUP)+Space(3),3) + Left(LRTrim(_ramate) +Space(3),3) */
                    _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("NASCOMUN"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("SOTGRUP"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(_ramate)+CPLib.Space(3),3);
                  } // End If
                  /* _note := _note + Left(LRTrim(kersonbo->SETTSINT)+Space(3),3) + Left(LRTrim(qbe_oped_chkdiana->RAPPORTO)+Space(25),25) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("SETTSINT"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("RAPPORTO"))+CPLib.Space(25),25);
                  /* _note := _note + Left(LRTrim(qbe_oped_chkdiana->FLAGRAP)+" ",1) + Left(LRTrim(kersonbo->TIPODOC)+Space(2),2) + Left(LRTrim(kersonbo->NUMDOCUM)+Space(15),15) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("FLAGRAP"))+" ",1)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("TIPODOC"))+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("NUMDOCUM"))+CPLib.Space(15),15);
                  /* If Empty(kersonbo->DATARILASC) or DateToChar(kersonbo->DATARILASC)='01000101' */
                  if (CPLib.Empty(Cursor_kersonbo.GetDate("DATARILASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_kersonbo.GetDate("DATARILASC")),"01000101")) {
                    /* _note := _note + Space(8) */
                    _note = _note+CPLib.Space(8);
                  } else { // Else
                    /* _note := _note + Left(LRTrim(DateToChar(kersonbo->DATARILASC))+Space(8),8)  */
                    _note = _note+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_kersonbo.GetDate("DATARILASC")))+CPLib.Space(8),8);
                  } // End If
                  /* _note := _note + Left(LRTrim(kersonbo->AUTRILASC)+Space(30),30) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("AUTRILASC"))+CPLib.Space(30),30);
                  /* _note := _note + Left(LRTrim(kersonbo->SESSO)+" ",1) + Space(34) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("SESSO"))+" ",1)+CPLib.Space(34);
                  /* Exec "Scrittura Dati" Page 15:Page_19 */
                  Page_19();
                  /* nTotRec := nTotRec + 1 */
                  nTotRec = CPLib.Round(nTotRec+1,0);
                  /* nNumRec := nNumRec + 1 */
                  nNumRec = CPLib.Round(nNumRec+1,0);
                  Cursor_kersonbo.Next();
                }
                m_cConnectivityError = Cursor_kersonbo.ErrorMessage();
                Cursor_kersonbo.Close();
                // * --- End Select
              } else { // Else
                /* If qbe_oped_chkdiana->DATAOPE > CharToDate('20131231') */
                if (CPLib.gt(Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '7' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                  /* pTipoR := '7' // Tipo Riga */
                  pTipoR = "7";
                } else { // Else
                  /* If Empty(qbe_oped_chkdiana->CONNESOPER) or (LRTrim(Upper(qbe_oped_chkdiana->CONNESOPER))=LRTrim(Upper(qbe_oped_chkdiana->CONNESCLI))) */
                  if (CPLib.Empty(Cursor_qbe_oped_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(CPLib.LRTrim(CPLib.Upper(Cursor_qbe_oped_chkdiana.GetString("CONNESOPER"))),CPLib.LRTrim(CPLib.Upper(Cursor_qbe_oped_chkdiana.GetString("CONNESCLI")))))) {
                    /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                    _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                    /* pTipoR := '2' // Tipo Riga */
                    pTipoR = "2";
                  } else { // Else
                    /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                    _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                    /* pTipoR := '3' // Tipo Riga */
                    pTipoR = "3";
                  } // End If
                } // End If
                /* pCli := qbe_oped_chkdiana->CONNESCLI // Codice Soggetto */
                pCli = Cursor_qbe_oped_chkdiana.GetString("CONNESCLI");
                /* pDatOpe := iif(w_stoper='R',qbe_oped_chkdiana->DATAREG,qbe_oped_chkdiana->DATAOPE) // Data Operazione */
                pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_oped_chkdiana.GetDate("DATAREG"):Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"));
                /* pRap := qbe_oped_chkdiana->RAPPORTO // Codice Rapporto */
                pRap = Cursor_qbe_oped_chkdiana.GetString("RAPPORTO");
                /* pTRap := qbe_oped_chkdiana->FLAGRAP // Tipo Rapporto */
                pTRap = Cursor_qbe_oped_chkdiana.GetString("FLAGRAP");
                /* pRAE := _raeatc // RAE o ATECO */
                pRAE = _raeatc;
                /* pSTATO := qbe_oped_chkdiana->STATOREG // Stato Registrazione */
                pSTATO = Cursor_qbe_oped_chkdiana.GetString("STATOREG");
                /* pDatRet := qbe_oped_chkdiana->DATARETT // Data Rettifica */
                pDatRet = Cursor_qbe_oped_chkdiana.GetDate("DATARETT");
                /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                DatiSoggetto();
                /* Exec "Scrittura Dati" Page 15:Page_19 */
                Page_19();
                /* nTotRec := nTotRec + 1 */
                nTotRec = CPLib.Round(nTotRec+1,0);
                /* nNumRec := nNumRec + 1 */
                nNumRec = CPLib.Round(nNumRec+1,0);
              } // End If
            } // End If
            /* If not(Empty(qbe_oped_chkdiana->RAPPORTO)) */
            if ( ! (CPLib.Empty(Cursor_qbe_oped_chkdiana.GetString("RAPPORTO")))) {
              /* If not(Empty(_oldrap)) */
              if ( ! (CPLib.Empty(_oldrap))) {
                // * --- Select from intestbo
                m_cServer = m_Ctx.GetServer("intestbo");
                m_cPhName = m_Ctx.GetPhName("intestbo");
                if (Cursor_intestbo!=null)
                  Cursor_intestbo.Close();
                Cursor_intestbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_oped_chkdiana.GetString("RAPPORTO"),"?",0,0)+"  and  CODINTER <> "+CPSql.SQLValueAdapter(CPLib.ToSQL(_codrif,"?",0,0,m_cServer, m_oParameters),m_cServer,_codrif)+" "+")"+(m_Ctx.IsSharedTemp("intestbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                while ( ! (Cursor_intestbo.Eof())) {
                  /* If qbe_oped_chkdiana->RAPPORTO = intestbo->RAPPORTO */
                  if (CPLib.eqr(Cursor_qbe_oped_chkdiana.GetString("RAPPORTO"),Cursor_intestbo.GetString("RAPPORTO"))) {
                    /* _avanza := 0 */
                    _avanza = CPLib.Round(0,0);
                    /* If Empty(intestbo->CODINTER) or intestbo->STATOREG='2' or intestbo->STATOREG='3' */
                    if (CPLib.Empty(Cursor_intestbo.GetString("CODINTER")) || CPLib.eqr(Cursor_intestbo.GetString("STATOREG"),"2") || CPLib.eqr(Cursor_intestbo.GetString("STATOREG"),"3")) {
                      /* _avanza := 1 */
                      _avanza = CPLib.Round(1,0);
                    } // End If
                    /* If intestbo->DATAINI > qbe_oped_chkdiana->DATAOPE */
                    if (CPLib.gt(Cursor_intestbo.GetDate("DATAINI"),Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"))) {
                      /* _avanza := 1 */
                      _avanza = CPLib.Round(1,0);
                    } // End If
                    /* If not(Empty(intestbo->DATAFINE)) and intestbo->DATAFINE < qbe_oped_chkdiana->DATAOPE */
                    if ( ! (CPLib.Empty(Cursor_intestbo.GetDate("DATAFINE"))) && CPLib.lt(Cursor_intestbo.GetDate("DATAFINE"),Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"))) {
                      /* _avanza := 1 */
                      _avanza = CPLib.Round(1,0);
                    } // End If
                    /* If LRTrim(Upper(intestbo->CODINTER))=LRTrim(Upper(qbe_oped_chkdiana->CONNESCLI)) */
                    if (CPLib.eqr(CPLib.LRTrim(CPLib.Upper(Cursor_intestbo.GetString("CODINTER"))),CPLib.LRTrim(CPLib.Upper(Cursor_qbe_oped_chkdiana.GetString("CONNESCLI"))))) {
                      /* _avanza := 1 */
                      _avanza = CPLib.Round(1,0);
                    } // End If
                    /* If _avanza = 0 */
                    if (CPLib.eqr(_avanza,0)) {
                      /* _codrif := intestbo->CODINTER */
                      _codrif = Cursor_intestbo.GetString("CODINTER");
                      /* If qbe_oped_chkdiana->DATAOPE > CharToDate('20131231') */
                      if (CPLib.gt(Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                        /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '7' + _idereg */
                        _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                        /* pTipoR := '7' // Tipo Riga */
                        pTipoR = "7";
                      } else { // Else
                        /* If Empty(qbe_oped_chkdiana->CONNESOPER) or (qbe_oped_chkdiana->CONNESOPER=intestbo->CODINTER) */
                        if (CPLib.Empty(Cursor_qbe_oped_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(Cursor_qbe_oped_chkdiana.GetString("CONNESOPER"),Cursor_intestbo.GetString("CODINTER")))) {
                          /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                          _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                          /* pTipoR := '2' // Tipo Riga */
                          pTipoR = "2";
                        } else { // Else
                          /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                          _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                          /* pTipoR := '3' // Tipo Riga */
                          pTipoR = "3";
                        } // End If
                      } // End If
                      /* pCli := intestbo->CODINTER // Codice Soggetto */
                      pCli = Cursor_intestbo.GetString("CODINTER");
                      /* pDatOpe := iif(w_stoper='R',qbe_oped_chkdiana->DATAREG,qbe_oped_chkdiana->DATAOPE) // Data Operazione */
                      pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_oped_chkdiana.GetDate("DATAREG"):Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"));
                      /* pRap := qbe_oped_chkdiana->RAPPORTO // Codice Rapporto */
                      pRap = Cursor_qbe_oped_chkdiana.GetString("RAPPORTO");
                      /* pTRap := qbe_oped_chkdiana->FLAGRAP // Tipo Rapporto */
                      pTRap = Cursor_qbe_oped_chkdiana.GetString("FLAGRAP");
                      /* pRAE := _raeatc // RAE o ATECO */
                      pRAE = _raeatc;
                      /* pSTATO := qbe_oped_chkdiana->STATOREG // Stato Registrazione */
                      pSTATO = Cursor_qbe_oped_chkdiana.GetString("STATOREG");
                      /* pDatRet := qbe_oped_chkdiana->DATARETT // Data Rettifica */
                      pDatRet = Cursor_qbe_oped_chkdiana.GetDate("DATARETT");
                      /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                      DatiSoggetto();
                      /* Exec "Scrittura Dati" Page 15:Page_19 */
                      Page_19();
                      /* nTotRec := nTotRec + 1 */
                      nTotRec = CPLib.Round(nTotRec+1,0);
                      /* nNumRec := nNumRec + 1 */
                      nNumRec = CPLib.Round(nNumRec+1,0);
                    } // End If
                  } // End If
                  Cursor_intestbo.Next();
                }
                m_cConnectivityError = Cursor_intestbo.ErrorMessage();
                Cursor_intestbo.Close();
                // * --- End Select
              } // End If
            } // End If
            /* If Empty(LRTrim(_oldrap)) */
            if (CPLib.Empty(CPLib.LRTrim(_oldrap))) {
              /* _oldrighe := 0 */
              _oldrighe = CPLib.Round(0,0);
              /* If qbe_oped_chkdiana->STATOREG='3' and _mlientiope */
              if (CPLib.eqr(Cursor_qbe_oped_chkdiana.GetString("STATOREG"),"3") && _mlientiope) {
                /* _oldrighe := 0 */
                _oldrighe = CPLib.Round(0,0);
                // * --- Select from mlientiope
                m_cServer = m_Ctx.GetServer("mlientiope");
                m_cPhName = m_Ctx.GetPhName("mlientiope");
                if (Cursor_mlientiope!=null)
                  Cursor_mlientiope.Close();
                Cursor_mlientiope = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_oped_chkdiana.GetString("IDBASE"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("mlientiope")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                while ( ! (Cursor_mlientiope.Eof())) {
                  /* If LRTrim(Upper(mlientiope->CODSOG)) <> LRTrim(Upper(qbe_oped_chkdiana->CONNESCLI)) */
                  if (CPLib.ne(CPLib.LRTrim(CPLib.Upper(Cursor_mlientiope.GetString("CODSOG"))),CPLib.LRTrim(CPLib.Upper(Cursor_qbe_oped_chkdiana.GetString("CONNESCLI"))))) {
                    /* _oldrighe := 1 */
                    _oldrighe = CPLib.Round(1,0);
                    /* If qbe_oped_chkdiana->DATAOPE > CharToDate('20131231') */
                    if (CPLib.gt(Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '7' + _idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                      /* pTipoR := '7' // Tipo Riga */
                      pTipoR = "7";
                    } else { // Else
                      /* If Empty(qbe_oped_chkdiana->CONNESOPER) or (qbe_oped_chkdiana->CONNESOPER=mlientiope->CODSOG) */
                      if (CPLib.Empty(Cursor_qbe_oped_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(Cursor_qbe_oped_chkdiana.GetString("CONNESOPER"),Cursor_mlientiope.GetString("CODSOG")))) {
                        /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+ '2' + _idereg */
                        _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                        /* pTipoR := '2' // Tipo Riga */
                        pTipoR = "2";
                      } else { // Else
                        /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                        _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                        /* pTipoR := '3' // Tipo Riga */
                        pTipoR = "3";
                      } // End If
                    } // End If
                    /* pCli := mlientiope->CODSOG // Codice Soggetto */
                    pCli = Cursor_mlientiope.GetString("CODSOG");
                    /* pDatOpe := iif(w_stoper='R',qbe_oped_chkdiana->DATAREG,qbe_oped_chkdiana->DATAOPE) // Data Operazione */
                    pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_oped_chkdiana.GetDate("DATAREG"):Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"));
                    /* pRap := qbe_oped_chkdiana->RAPPORTO // Codice Rapporto */
                    pRap = Cursor_qbe_oped_chkdiana.GetString("RAPPORTO");
                    /* pTRap := qbe_oped_chkdiana->FLAGRAP // Tipo Rapporto */
                    pTRap = Cursor_qbe_oped_chkdiana.GetString("FLAGRAP");
                    /* pRAE := _raeatc // RAE o ATECO */
                    pRAE = _raeatc;
                    /* pSTATO := qbe_oped_chkdiana->STATOREG // Stato Registrazione */
                    pSTATO = Cursor_qbe_oped_chkdiana.GetString("STATOREG");
                    /* pDatRet := qbe_oped_chkdiana->DATARETT // Data Rettifica */
                    pDatRet = Cursor_qbe_oped_chkdiana.GetDate("DATARETT");
                    /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                    DatiSoggetto();
                    /* Exec "Scrittura Dati" Page 15:Page_19 */
                    Page_19();
                    /* nTotRec := nTotRec + 1 */
                    nTotRec = CPLib.Round(nTotRec+1,0);
                    /* nNumRec := nNumRec + 1 */
                    nNumRec = CPLib.Round(nNumRec+1,0);
                  } // End If
                  Cursor_mlientiope.Next();
                }
                m_cConnectivityError = Cursor_mlientiope.ErrorMessage();
                Cursor_mlientiope.Close();
                // * --- End Select
              } // End If
              /* If _oldrighe=0 and _clientiope */
              if (CPLib.eqr(_oldrighe,0) && _clientiope) {
                // * --- Select from clientiope
                m_cServer = m_Ctx.GetServer("clientiope");
                m_cPhName = m_Ctx.GetPhName("clientiope");
                if (Cursor_clientiope!=null)
                  Cursor_clientiope.Close();
                Cursor_clientiope = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_oped_chkdiana.GetString("IDBASE"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("clientiope")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                while ( ! (Cursor_clientiope.Eof())) {
                  /* _rownum := 0 */
                  _rownum = CPLib.Round(0,0);
                  // * --- Read from intestbo
                  m_cServer = m_Ctx.GetServer("intestbo");
                  m_cPhName = m_Ctx.GetPhName("intestbo");
                  m_cSql = "";
                  m_cSql = m_cSql+"RAPPORTO="+CPSql.SQLValueAdapter(CPLib.ToSQL(Cursor_qbe_oped_chkdiana.GetString("RAPPORTO"),"C",25,0,m_cServer),m_cServer,Cursor_qbe_oped_chkdiana.GetString("RAPPORTO"));
                  m_cSql = m_cSql+" and CODINTER="+CPSql.SQLValueAdapter(CPLib.ToSQL(Cursor_clientiope.GetString("CODSOG"),"C",16,0,m_cServer),m_cServer,Cursor_clientiope.GetString("CODSOG"));
                  if (m_Ctx.IsSharedTemp("intestbo")) {
                    m_cSql = m_cSql+" and context_id='"+m_Ctx.GetTempID()+"'";
                  }
                  if (Read_Cursor!=null)
                    Read_Cursor.Close();
                  Read_Cursor = m_Sql.Query(m_cServer,"select "+CPLib.GetMultilanguageField("CPROWNUM",m_Ctx,m_cServer)+" from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+m_cSql);
                  if ( ! (Read_Cursor.Eof())) {
                    _rownum = CPLib.Round(Read_Cursor.GetDouble("CPROWNUM"),0);
                    Read_Cursor.Next();
                    if ( ! (Read_Cursor.Eof())) {
                      Error l_oErrorFault = new Error("Read on intestbo into routine arrt_chkdiana_all returns two or more records. This item should return only a record.");
                      CPStdCounter.Error(l_oErrorFault);
                    }
                    Read_Cursor.Close();
                  } else {
                    // Error: no record found!
                    _rownum = 0;
                    Read_Cursor.Close();
                    m_cLastMsgError = "MSG_RECORD_NOT_FOUND";
                  }
                  /* If _rownum = 0 */
                  if (CPLib.eqr(_rownum,0)) {
                    /* If LRTrim(Upper(clientiope->CODSOG)) <> LRTrim(Upper(qbe_oped_chkdiana->CONNESCLI)) */
                    if (CPLib.ne(CPLib.LRTrim(CPLib.Upper(Cursor_clientiope.GetString("CODSOG"))),CPLib.LRTrim(CPLib.Upper(Cursor_qbe_oped_chkdiana.GetString("CONNESCLI"))))) {
                      /* If qbe_oped_chkdiana->DATAOPE > CharToDate('20131231') */
                      if (CPLib.gt(Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                        /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '7' + _idereg */
                        _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                        /* pTipoR := '7' // Tipo Riga */
                        pTipoR = "7";
                      } else { // Else
                        /* If Empty(qbe_oped_chkdiana->CONNESOPER) or (qbe_oped_chkdiana->CONNESOPER=clientiope->CODSOG) */
                        if (CPLib.Empty(Cursor_qbe_oped_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(Cursor_qbe_oped_chkdiana.GetString("CONNESOPER"),Cursor_clientiope.GetString("CODSOG")))) {
                          /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                          _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                          /* pTipoR := '2' // Tipo Riga */
                          pTipoR = "2";
                        } else { // Else
                          /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                          _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                          /* pTipoR := '3' // Tipo Riga */
                          pTipoR = "3";
                        } // End If
                      } // End If
                      /* pCli := clientiope->CODSOG // Codice Soggetto */
                      pCli = Cursor_clientiope.GetString("CODSOG");
                      /* pDatOpe := iif(w_stoper='R',qbe_oped_chkdiana->DATAREG,qbe_oped_chkdiana->DATAOPE) // Data Operazione */
                      pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_oped_chkdiana.GetDate("DATAREG"):Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"));
                      /* pRap := qbe_oped_chkdiana->RAPPORTO // Codice Rapporto */
                      pRap = Cursor_qbe_oped_chkdiana.GetString("RAPPORTO");
                      /* pTRap := qbe_oped_chkdiana->FLAGRAP // Tipo Rapporto */
                      pTRap = Cursor_qbe_oped_chkdiana.GetString("FLAGRAP");
                      /* pRAE := _raeatc // RAE o ATECO */
                      pRAE = _raeatc;
                      /* pSTATO := qbe_oped_chkdiana->STATOREG // Stato Registrazione */
                      pSTATO = Cursor_qbe_oped_chkdiana.GetString("STATOREG");
                      /* pDatRet := qbe_oped_chkdiana->DATARETT // Data Rettifica */
                      pDatRet = Cursor_qbe_oped_chkdiana.GetDate("DATARETT");
                      /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                      DatiSoggetto();
                      /* Exec "Scrittura Dati" Page 15:Page_19 */
                      Page_19();
                      /* nTotRec := nTotRec + 1 */
                      nTotRec = CPLib.Round(nTotRec+1,0);
                      /* nNumRec := nNumRec + 1 */
                      nNumRec = CPLib.Round(nNumRec+1,0);
                    } // End If
                  } // End If
                  Cursor_clientiope.Next();
                }
                m_cConnectivityError = Cursor_clientiope.ErrorMessage();
                Cursor_clientiope.Close();
                // * --- End Select
              } // End If
            } // End If
          } // End If
          /* If not(Empty(qbe_oped_chkdiana->CONNESOPER)) and qbe_oped_chkdiana->CONNESOPER <> _codrif */
          if ( ! (CPLib.Empty(Cursor_qbe_oped_chkdiana.GetString("CONNESOPER"))) && CPLib.ne(Cursor_qbe_oped_chkdiana.GetString("CONNESOPER"),_codrif)) {
            /* If qbe_oped_chkdiana->DATAOPE > CharToDate('20131231') */
            if (CPLib.gt(Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'8' + _idereg */
              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"8"+_idereg;
              /* pTipoR := '8' // Tipo Riga */
              pTipoR = "8";
            } else { // Else
              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'4' + _idereg */
              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"4"+_idereg;
              /* pTipoR := '4' // Tipo Riga */
              pTipoR = "4";
            } // End If
            /* pCli := qbe_oped_chkdiana->CONNESOPER // Codice Soggetto */
            pCli = Cursor_qbe_oped_chkdiana.GetString("CONNESOPER");
            /* pDatOpe := iif(w_stoper='R',qbe_oped_chkdiana->DATAREG,qbe_oped_chkdiana->DATAOPE) // Data Operazione */
            pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_oped_chkdiana.GetDate("DATAREG"):Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"));
            /* pRap := qbe_oped_chkdiana->RAPPORTO // Codice Rapporto */
            pRap = Cursor_qbe_oped_chkdiana.GetString("RAPPORTO");
            /* pTRap := qbe_oped_chkdiana->FLAGRAP // Tipo Rapporto */
            pTRap = Cursor_qbe_oped_chkdiana.GetString("FLAGRAP");
            /* pRAE := _raeatc // RAE o ATECO */
            pRAE = _raeatc;
            /* pSTATO := qbe_oped_chkdiana->STATOREG // Stato Registrazione */
            pSTATO = Cursor_qbe_oped_chkdiana.GetString("STATOREG");
            /* pDatRet := qbe_oped_chkdiana->DATARETT // Data Rettifica */
            pDatRet = Cursor_qbe_oped_chkdiana.GetDate("DATARETT");
            /* _oldmc := _usemc */
            _oldmc = CPLib.Round(_usemc,0);
            /* _usemc := 0 */
            _usemc = CPLib.Round(0,0);
            /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
            DatiSoggetto();
            /* _usemc := _oldmc */
            _usemc = CPLib.Round(_oldmc,0);
            /* If not(_rapcoll) */
            if ( ! (_rapcoll)) {
              /* Exec "Scrittura Dati" Page 15:Page_19 */
              Page_19();
            } else { // Else
              /* mcRighe.AppendWithKey(pTipoR) */
              mcRighe.AppendWithKey(pTipoR);
              /* mcRighe.TIPO := pTipoR */
              mcRighe.row.TIPO = pTipoR;
              /* mcRighe.RIGA := _note */
              mcRighe.row.RIGA = _note;
              /* mcRighe.SaveRow() */
              mcRighe.SaveRow();
            } // End If
            /* nTotRec := nTotRec + 1 */
            nTotRec = CPLib.Round(nTotRec+1,0);
            /* nNumRec := nNumRec + 1 */
            nNumRec = CPLib.Round(nNumRec+1,0);
          } // End If
          /* _oldrighe := 0 */
          _oldrighe = CPLib.Round(0,0);
          /* If qbe_oped_chkdiana->STATOREG='3' and _mogopebo */
          if (CPLib.eqr(Cursor_qbe_oped_chkdiana.GetString("STATOREG"),"3") && _mogopebo) {
            // * --- Select from mogopebo
            m_cServer = m_Ctx.GetServer("mogopebo");
            m_cPhName = m_Ctx.GetPhName("mogopebo");
            if (Cursor_mogopebo!=null)
              Cursor_mogopebo.Close();
            Cursor_mogopebo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_oped_chkdiana.GetString("IDBASE"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("mogopebo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_mogopebo.Eof())) {
              /* If mogopebo->CODSOG <> qbe_oped_chkdiana->CONNESOPER */
              if (CPLib.ne(Cursor_mogopebo.GetString("CODSOG"),Cursor_qbe_oped_chkdiana.GetString("CONNESOPER"))) {
                /* _oldrighe := 1 */
                _oldrighe = CPLib.Round(1,0);
                /* If qbe_oped_chkdiana->DATAOPE > CharToDate('20131231') */
                if (CPLib.gt(Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '8' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"8"+_idereg;
                  /* pTipoR := '8' // Tipo Riga */
                  pTipoR = "8";
                } else { // Else
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '4' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"4"+_idereg;
                  /* pTipoR := '4' // Tipo Riga */
                  pTipoR = "4";
                } // End If
                /* pCli := mogopebo->CODSOG // Codice Soggetto */
                pCli = Cursor_mogopebo.GetString("CODSOG");
                /* pDatOpe := iif(w_stoper='R',qbe_oped_chkdiana->DATAREG,qbe_oped_chkdiana->DATAOPE) // Data Operazione */
                pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_oped_chkdiana.GetDate("DATAREG"):Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"));
                /* pRap := qbe_oped_chkdiana->RAPPORTO // Codice Rapporto */
                pRap = Cursor_qbe_oped_chkdiana.GetString("RAPPORTO");
                /* pTRap := qbe_oped_chkdiana->FLAGRAP // Tipo Rapporto */
                pTRap = Cursor_qbe_oped_chkdiana.GetString("FLAGRAP");
                /* pRAE := _raeatc // RAE o ATECO */
                pRAE = _raeatc;
                /* pSTATO := qbe_oped_chkdiana->STATOREG // Stato Registrazione */
                pSTATO = Cursor_qbe_oped_chkdiana.GetString("STATOREG");
                /* pDatRet := qbe_oped_chkdiana->DATARETT // Data Rettifica */
                pDatRet = Cursor_qbe_oped_chkdiana.GetDate("DATARETT");
                /* _oldmc := _usemc */
                _oldmc = CPLib.Round(_usemc,0);
                /* _usemc := 0 */
                _usemc = CPLib.Round(0,0);
                /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                DatiSoggetto();
                /* _usemc := _oldmc */
                _usemc = CPLib.Round(_oldmc,0);
                /* If not(_rapcoll) */
                if ( ! (_rapcoll)) {
                  /* Exec "Scrittura Dati" Page 15:Page_19 */
                  Page_19();
                } else { // Else
                  /* mcRighe.AppendWithKey(pTipoR) */
                  mcRighe.AppendWithKey(pTipoR);
                  /* mcRighe.TIPO := pTipoR */
                  mcRighe.row.TIPO = pTipoR;
                  /* mcRighe.RIGA := _note */
                  mcRighe.row.RIGA = _note;
                  /* mcRighe.SaveRow() */
                  mcRighe.SaveRow();
                } // End If
                /* nTotRec := nTotRec + 1 */
                nTotRec = CPLib.Round(nTotRec+1,0);
                /* nNumRec := nNumRec + 1 */
                nNumRec = CPLib.Round(nNumRec+1,0);
              } // End If
              Cursor_mogopebo.Next();
            }
            m_cConnectivityError = Cursor_mogopebo.ErrorMessage();
            Cursor_mogopebo.Close();
            // * --- End Select
          } // End If
          /* If _oldrighe=0 and _sogopebo */
          if (CPLib.eqr(_oldrighe,0) && _sogopebo) {
            // * --- Select from sogopebo
            m_cServer = m_Ctx.GetServer("sogopebo");
            m_cPhName = m_Ctx.GetPhName("sogopebo");
            if (Cursor_sogopebo!=null)
              Cursor_sogopebo.Close();
            Cursor_sogopebo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_oped_chkdiana.GetString("IDBASE"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("sogopebo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_sogopebo.Eof())) {
              /* If sogopebo->CODSOG <> qbe_oped_chkdiana->CONNESOPER */
              if (CPLib.ne(Cursor_sogopebo.GetString("CODSOG"),Cursor_qbe_oped_chkdiana.GetString("CONNESOPER"))) {
                /* If qbe_oped_chkdiana->DATAOPE > CharToDate('20131231') */
                if (CPLib.gt(Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '8' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"8"+_idereg;
                  /* pTipoR := '8' // Tipo Riga */
                  pTipoR = "8";
                } else { // Else
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '4' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"4"+_idereg;
                  /* pTipoR := '4' // Tipo Riga */
                  pTipoR = "4";
                } // End If
                /* pCli := sogopebo->CODSOG // Codice Soggetto */
                pCli = Cursor_sogopebo.GetString("CODSOG");
                /* pDatOpe := iif(w_stoper='R',qbe_oped_chkdiana->DATAREG,qbe_oped_chkdiana->DATAOPE) // Data Operazione */
                pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_oped_chkdiana.GetDate("DATAREG"):Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"));
                /* pRap := qbe_oped_chkdiana->RAPPORTO // Codice Rapporto */
                pRap = Cursor_qbe_oped_chkdiana.GetString("RAPPORTO");
                /* pTRap := qbe_oped_chkdiana->FLAGRAP // Tipo Rapporto */
                pTRap = Cursor_qbe_oped_chkdiana.GetString("FLAGRAP");
                /* pRAE := _raeatc // RAE o ATECO */
                pRAE = _raeatc;
                /* pSTATO := qbe_oped_chkdiana->STATOREG // Stato Registrazione */
                pSTATO = Cursor_qbe_oped_chkdiana.GetString("STATOREG");
                /* pDatRet := qbe_oped_chkdiana->DATARETT // Data Rettifica */
                pDatRet = Cursor_qbe_oped_chkdiana.GetDate("DATARETT");
                /* _oldmc := _usemc */
                _oldmc = CPLib.Round(_usemc,0);
                /* _usemc := 0 */
                _usemc = CPLib.Round(0,0);
                /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                DatiSoggetto();
                /* _usemc := _oldmc */
                _usemc = CPLib.Round(_oldmc,0);
                /* If not(_rapcoll) */
                if ( ! (_rapcoll)) {
                  /* Exec "Scrittura Dati" Page 15:Page_19 */
                  Page_19();
                } else { // Else
                  /* mcRighe.AppendWithKey(pTipoR) */
                  mcRighe.AppendWithKey(pTipoR);
                  /* mcRighe.TIPO := pTipoR */
                  mcRighe.row.TIPO = pTipoR;
                  /* mcRighe.RIGA := _note */
                  mcRighe.row.RIGA = _note;
                  /* mcRighe.SaveRow() */
                  mcRighe.SaveRow();
                } // End If
                /* nTotRec := nTotRec + 1 */
                nTotRec = CPLib.Round(nTotRec+1,0);
                /* nNumRec := nNumRec + 1 */
                nNumRec = CPLib.Round(nNumRec+1,0);
              } // End If
              Cursor_sogopebo.Next();
            }
            m_cConnectivityError = Cursor_sogopebo.ErrorMessage();
            Cursor_sogopebo.Close();
            // * --- End Select
          } // End If
          /* If not(Empty(qbe_oped_chkdiana->CONNESBEN)) or not(Empty(qbe_oped_chkdiana->C_RAG)) */
          if ( ! (CPLib.Empty(Cursor_qbe_oped_chkdiana.GetString("CONNESBEN"))) ||  ! (CPLib.Empty(Cursor_qbe_oped_chkdiana.GetString("C_RAG")))) {
            /* If not(Empty(qbe_oped_chkdiana->C_RAG)) */
            if ( ! (CPLib.Empty(Cursor_qbe_oped_chkdiana.GetString("C_RAG")))) {
              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
              /* _note := _note + Left(LRTrim(qbe_oped_chkdiana->CONNESBEN)+Space(16),16) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("CONNESBEN"))+CPLib.Space(16),16);
              /* _note := _note +Left(LRTrim(qbe_oped_chkdiana->C_RAG)+Space(70),70) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_RAG"))+CPLib.Space(70),70);
              /* _note := _note + Left(LRTrim(qbe_oped_chkdiana->C_STA)+Space(3),3) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_STA"))+CPLib.Space(3),3);
              /* _note := _note +Left(LRTrim(qbe_oped_chkdiana->C_CAB)+Space(6),6) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_CAB"))+CPLib.Space(6),6);
              /* _note := _note +Left(LRTrim(qbe_oped_chkdiana->C_CTA)+Space(30),30) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_CTA"))+CPLib.Space(30),30);
              /* _note := _note + Left(LRTrim(qbe_oped_chkdiana->C_PRV)+Space(2),2) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_PRV"))+CPLib.Space(2),2);
              /* _note := _note + Left(LRTrim(qbe_oped_chkdiana->C_IND)+Space(35),35) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_IND"))+CPLib.Space(35),35);
              /* _note := _note + Left(LRTrim(qbe_oped_chkdiana->C_CAP)+Space(5),5) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_CAP"))+CPLib.Space(5),5);
              /* _note := _note + Space(63) */
              _note = _note+CPLib.Space(63);
              /* _note := _note + Left(LRTrim(qbe_oped_chkdiana->C_RAPPORTO)+Space(25),25) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_RAPPORTO"))+CPLib.Space(25),25);
              /* _note := _note + Space(91) */
              _note = _note+CPLib.Space(91);
              /* If not(_rapcoll) */
              if ( ! (_rapcoll)) {
                /* Exec "Scrittura Dati" Page 15:Page_19 */
                Page_19();
              } else { // Else
                /* mcRighe.AppendWithKey('5') */
                mcRighe.AppendWithKey("5");
                /* mcRighe.TIPO := '5' */
                mcRighe.row.TIPO = "5";
                /* mcRighe.RIGA := _note */
                mcRighe.row.RIGA = _note;
                /* mcRighe.SaveRow() */
                mcRighe.SaveRow();
              } // End If
              /* nTotRec := nTotRec + 1 */
              nTotRec = CPLib.Round(nTotRec+1,0);
              /* nNumRec := nNumRec + 1 */
              nNumRec = CPLib.Round(nNumRec+1,0);
              /* ElseIf not(Empty(qbe_oped_chkdiana->CONNESBEN)) */
            } else if ( ! (CPLib.Empty(Cursor_qbe_oped_chkdiana.GetString("CONNESBEN")))) {
              /* _numsto := arfn_chkspers(qbe_oped_chkdiana->CONNESBEN,iif(w_stoper='R',qbe_oped_chkdiana->DATAREG,qbe_oped_chkdiana->DATAOPE)) */
              _numsto = arfn_chkspersR.Make(m_Ctx,this).Run(Cursor_qbe_oped_chkdiana.GetString("CONNESBEN"),(CPLib.eqr(w_stoper,"R")?Cursor_qbe_oped_chkdiana.GetDate("DATAREG"):Cursor_qbe_oped_chkdiana.GetDate("DATAOPE")));
              /* If Empty(LRTrim(_numsto)) */
              if (CPLib.Empty(CPLib.LRTrim(_numsto))) {
                // * --- Select from personbo
                m_cServer = m_Ctx.GetServer("personbo");
                m_cPhName = m_Ctx.GetPhName("personbo");
                if (Cursor_personbo!=null)
                  Cursor_personbo.Close();
                Cursor_personbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CONNES="+CPLib.ToSQL(Cursor_qbe_oped_chkdiana.GetString("CONNESBEN"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("personbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                while ( ! (Cursor_personbo.Eof())) {
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
                  /* _note := _note + Left(LRTrim(qbe_oped_chkdiana->CONNESBEN)+Space(16),16) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("CONNESBEN"))+CPLib.Space(16),16);
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_oped_chkdiana->C_RAG))),Left(LRTrim(qbe_oped_chkdiana->C_RAG)+Space(70),70),Left(LRTrim(personbo->RAGSOC)+Space(70),70)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_RAG"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_RAG"))+CPLib.Space(70),70):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("RAGSOC"))+CPLib.Space(70),70));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_oped_chkdiana->C_STA))),Left(LRTrim(qbe_oped_chkdiana->C_STA)+Space(3),3),Left(LRTrim(personbo->PAESE)+Space(3),3)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_STA"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_STA"))+CPLib.Space(3),3):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PAESE"))+CPLib.Space(3),3));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_oped_chkdiana->C_CAB))),Left(LRTrim(qbe_oped_chkdiana->C_CAB)+Space(6),6),Left(LRTrim(personbo->CODCAB)+Space(6),6)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_CAB"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_CAB"))+CPLib.Space(6),6):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CODCAB"))+CPLib.Space(6),6));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_oped_chkdiana->C_CTA))),Left(LRTrim(qbe_oped_chkdiana->C_CTA)+Space(30),30),Left(LRTrim(personbo->DESCCIT)+Space(30),30)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_CTA"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_CTA"))+CPLib.Space(30),30):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DESCCIT"))+CPLib.Space(30),30));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_oped_chkdiana->C_PRV))),Left(LRTrim(qbe_oped_chkdiana->C_PRV)+Space(2),2),Left(LRTrim(personbo->PROVINCIA)+Space(2),2)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_PRV"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_PRV"))+CPLib.Space(2),2):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PROVINCIA"))+CPLib.Space(2),2));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_oped_chkdiana->C_IND))),Left(LRTrim(qbe_oped_chkdiana->C_IND)+Space(35),35),Left(LRTrim(personbo->DOMICILIO)+Space(35),35)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_IND"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_IND"))+CPLib.Space(35),35):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DOMICILIO"))+CPLib.Space(35),35));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_oped_chkdiana->C_CAP))),Left(LRTrim(qbe_oped_chkdiana->C_CAP)+Space(5),5),Left(LRTrim(personbo->CAP)+Space(5),5)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_CAP"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_CAP"))+CPLib.Space(5),5):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CAP"))+CPLib.Space(5),5));
                  /* _note := _note + Space(63) */
                  _note = _note+CPLib.Space(63);
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_oped_chkdiana->C_RAPPORTO))),Left(LRTrim(qbe_oped_chkdiana->C_RAPPORTO)+Space(25),25),Left(LRTrim(qbe_oped_chkdiana->RAPPORTBEN)+Space(25),25)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_RAPPORTO"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_RAPPORTO"))+CPLib.Space(25),25):CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("RAPPORTBEN"))+CPLib.Space(25),25));
                  /* _note := _note + Space(91) */
                  _note = _note+CPLib.Space(91);
                  /* If not(_rapcoll) */
                  if ( ! (_rapcoll)) {
                    /* Exec "Scrittura Dati" Page 15:Page_19 */
                    Page_19();
                  } else { // Else
                    /* mcRighe.AppendWithKey('5') */
                    mcRighe.AppendWithKey("5");
                    /* mcRighe.TIPO := '5' */
                    mcRighe.row.TIPO = "5";
                    /* mcRighe.RIGA := _note */
                    mcRighe.row.RIGA = _note;
                    /* mcRighe.SaveRow() */
                    mcRighe.SaveRow();
                  } // End If
                  /* nTotRec := nTotRec + 1 */
                  nTotRec = CPLib.Round(nTotRec+1,0);
                  /* nNumRec := nNumRec + 1 */
                  nNumRec = CPLib.Round(nNumRec+1,0);
                  Cursor_personbo.Next();
                }
                m_cConnectivityError = Cursor_personbo.ErrorMessage();
                Cursor_personbo.Close();
                // * --- End Select
              } else { // Else
                // * --- Select from wersonbo
                m_cServer = m_Ctx.GetServer("wersonbo");
                m_cPhName = m_Ctx.GetPhName("wersonbo");
                if (Cursor_wersonbo!=null)
                  Cursor_wersonbo.Close();
                Cursor_wersonbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"sanumpro="+CPSql.SQLValueAdapter(CPLib.ToSQL(_numsto,"?",0,0,m_cServer, m_oParameters),m_cServer,_numsto)+" "+")"+(m_Ctx.IsSharedTemp("wersonbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                while ( ! (Cursor_wersonbo.Eof())) {
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
                  /* _note := _note + Left(LRTrim(qbe_oped_chkdiana->CONNESBEN)+Space(16),16) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("CONNESBEN"))+CPLib.Space(16),16);
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_oped_chkdiana->C_RAG))),Left(LRTrim(qbe_oped_chkdiana->C_RAG)+Space(70),70),Left(LRTrim(wersonbo->RAGSOC)+Space(70),70)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_RAG"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_RAG"))+CPLib.Space(70),70):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("RAGSOC"))+CPLib.Space(70),70));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_oped_chkdiana->C_STA))),Left(LRTrim(qbe_oped_chkdiana->C_STA)+Space(3),3),Left(LRTrim(wersonbo->PAESE)+Space(3),3)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_STA"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_STA"))+CPLib.Space(3),3):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PAESE"))+CPLib.Space(3),3));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_oped_chkdiana->C_CAB))),Left(LRTrim(qbe_oped_chkdiana->C_CAB)+Space(6),6),Left(LRTrim(wersonbo->CODCAB)+Space(6),6)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_CAB"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_CAB"))+CPLib.Space(6),6):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CODCAB"))+CPLib.Space(6),6));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_oped_chkdiana->C_CTA))),Left(LRTrim(qbe_oped_chkdiana->C_CTA)+Space(30),30),Left(LRTrim(wersonbo->DESCCIT)+Space(30),30)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_CTA"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_CTA"))+CPLib.Space(30),30):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DESCCIT"))+CPLib.Space(30),30));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_oped_chkdiana->C_PRV))),Left(LRTrim(qbe_oped_chkdiana->C_PRV)+Space(2),2),Left(LRTrim(wersonbo->PROVINCIA)+Space(2),2)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_PRV"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_PRV"))+CPLib.Space(2),2):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PROVINCIA"))+CPLib.Space(2),2));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_oped_chkdiana->C_IND))),Left(LRTrim(qbe_oped_chkdiana->C_IND)+Space(35),35),Left(LRTrim(wersonbo->DOMICILIO)+Space(35),35)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_IND"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_IND"))+CPLib.Space(35),35):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DOMICILIO"))+CPLib.Space(35),35));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_oped_chkdiana->C_CAP))),Left(LRTrim(qbe_oped_chkdiana->C_CAP)+Space(5),5),Left(LRTrim(wersonbo->CAP)+Space(5),5)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_CAP"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_CAP"))+CPLib.Space(5),5):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CAP"))+CPLib.Space(5),5));
                  /* _note := _note + Space(63) */
                  _note = _note+CPLib.Space(63);
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_oped_chkdiana->C_RAPPORTO))),Left(LRTrim(qbe_oped_chkdiana->C_RAPPORTO)+Space(25),25),Left(LRTrim(qbe_oped_chkdiana->RAPPORTBEN)+Space(25),25)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_RAPPORTO"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("C_RAPPORTO"))+CPLib.Space(25),25):CPLib.Left(CPLib.LRTrim(Cursor_qbe_oped_chkdiana.GetString("RAPPORTBEN"))+CPLib.Space(25),25));
                  /* _note := _note + Space(91) */
                  _note = _note+CPLib.Space(91);
                  /* If not(_rapcoll) */
                  if ( ! (_rapcoll)) {
                    /* Exec "Scrittura Dati" Page 15:Page_19 */
                    Page_19();
                  } else { // Else
                    /* mcRighe.AppendWithKey('5') */
                    mcRighe.AppendWithKey("5");
                    /* mcRighe.TIPO := '5' */
                    mcRighe.row.TIPO = "5";
                    /* mcRighe.RIGA := _note */
                    mcRighe.row.RIGA = _note;
                    /* mcRighe.SaveRow() */
                    mcRighe.SaveRow();
                  } // End If
                  /* nTotRec := nTotRec + 1 */
                  nTotRec = CPLib.Round(nTotRec+1,0);
                  /* nNumRec := nNumRec + 1 */
                  nNumRec = CPLib.Round(nNumRec+1,0);
                  Cursor_wersonbo.Next();
                }
                m_cConnectivityError = Cursor_wersonbo.ErrorMessage();
                Cursor_wersonbo.Close();
                // * --- End Select
              } // End If
            } // End If
          } // End If
          /* _oldrighe := 0 */
          _oldrighe = CPLib.Round(0,0);
          /* If qbe_oped_chkdiana->STATOREG='3' and _meneficope */
          if (CPLib.eqr(Cursor_qbe_oped_chkdiana.GetString("STATOREG"),"3") && _meneficope) {
            // * --- Select from meneficope
            m_cServer = m_Ctx.GetServer("meneficope");
            m_cPhName = m_Ctx.GetPhName("meneficope");
            if (Cursor_meneficope!=null)
              Cursor_meneficope.Close();
            Cursor_meneficope = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_oped_chkdiana.GetString("IDBASE"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("meneficope")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_meneficope.Eof())) {
              /* _oldrighe := 1 */
              _oldrighe = CPLib.Round(1,0);
              /* If Empty(LRTrim(meneficope->CODSOG)) and not(Empty(LRTrim(meneficope->C_RAG))) */
              if (CPLib.Empty(CPLib.LRTrim(Cursor_meneficope.GetString("CODSOG"))) &&  ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficope.GetString("C_RAG"))))) {
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
                /* _note := _note + Left(LRTrim(meneficope->CODSOG)+Space(16),16) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("CODSOG"))+CPLib.Space(16),16);
                /* _note := _note +Left(LRTrim(meneficope->C_RAG)+Space(70),70) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("C_RAG"))+CPLib.Space(70),70);
                /* _note := _note + Left(LRTrim(meneficope->C_STA)+Space(3),3) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("C_STA"))+CPLib.Space(3),3);
                /* _note := _note +Left(LRTrim(meneficope->C_CAB)+Space(6),6) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("C_CAB"))+CPLib.Space(6),6);
                /* _note := _note +Left(LRTrim(meneficope->C_CTA)+Space(30),30) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("C_CTA"))+CPLib.Space(30),30);
                /* _note := _note + Left(LRTrim(meneficope->C_PRV)+Space(2),2) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("C_PRV"))+CPLib.Space(2),2);
                /* _note := _note + Left(LRTrim(meneficope->C_IND)+Space(35),35) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("C_IND"))+CPLib.Space(35),35);
                /* _note := _note + Left(LRTrim(meneficope->C_CAP)+Space(5),5) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("C_CAP"))+CPLib.Space(5),5);
                /* _note := _note + Space(63) */
                _note = _note+CPLib.Space(63);
                /* _note := _note + Left(LRTrim(meneficope->C_RAPPORTO)+Space(25),25) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("C_RAPPORTO"))+CPLib.Space(25),25);
                /* _note := _note + Space(91) */
                _note = _note+CPLib.Space(91);
                /* Exec "Scrittura Dati" Page 15:Page_19 */
                Page_19();
                /* nTotRec := nTotRec + 1 */
                nTotRec = CPLib.Round(nTotRec+1,0);
                /* nNumRec := nNumRec + 1 */
                nNumRec = CPLib.Round(nNumRec+1,0);
              } else { // Else
                /* If meneficope->CODSOG <> qbe_oped_chkdiana->CONNESBEN */
                if (CPLib.ne(Cursor_meneficope.GetString("CODSOG"),Cursor_qbe_oped_chkdiana.GetString("CONNESBEN"))) {
                  /* _numsto := arfn_chkspers(meneficope->CODSOG,iif(w_stoper='R',qbe_oped_chkdiana->DATAREG,qbe_oped_chkdiana->DATAOPE)) */
                  _numsto = arfn_chkspersR.Make(m_Ctx,this).Run(Cursor_meneficope.GetString("CODSOG"),(CPLib.eqr(w_stoper,"R")?Cursor_qbe_oped_chkdiana.GetDate("DATAREG"):Cursor_qbe_oped_chkdiana.GetDate("DATAOPE")));
                  /* If Empty(LRTrim(_numsto)) */
                  if (CPLib.Empty(CPLib.LRTrim(_numsto))) {
                    // * --- Select from personbo
                    m_cServer = m_Ctx.GetServer("personbo");
                    m_cPhName = m_Ctx.GetPhName("personbo");
                    if (Cursor_personbo!=null)
                      Cursor_personbo.Close();
                    Cursor_personbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CONNES="+CPLib.ToSQL(Cursor_meneficope.GetString("CODSOG"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("personbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                    while ( ! (Cursor_personbo.Eof())) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
                      /* _note := _note + Left(LRTrim(meneficope->CODSOG)+Space(16),16) */
                      _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("CODSOG"))+CPLib.Space(16),16);
                      /* _note := _note + iif(not(Empty(LRTrim(meneficope->C_RAG))),Left(LRTrim(meneficope->C_RAG)+Space(70),70),Left(LRTrim(personbo->RAGSOC)+Space(70),70)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficope.GetString("C_RAG"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("C_RAG"))+CPLib.Space(70),70):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("RAGSOC"))+CPLib.Space(70),70));
                      /* _note := _note + iif(not(Empty(LRTrim(meneficope->C_STA))),Left(LRTrim(meneficope->C_STA)+Space(3),3),Left(LRTrim(personbo->PAESE)+Space(3),3)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficope.GetString("C_STA"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("C_STA"))+CPLib.Space(3),3):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PAESE"))+CPLib.Space(3),3));
                      /* _note := _note + iif(not(Empty(LRTrim(meneficope->C_CAB))),Left(LRTrim(meneficope->C_CAB)+Space(6),6),Left(LRTrim(personbo->CODCAB)+Space(6),6)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficope.GetString("C_CAB"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("C_CAB"))+CPLib.Space(6),6):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CODCAB"))+CPLib.Space(6),6));
                      /* _note := _note + iif(not(Empty(LRTrim(meneficope->C_CTA))),Left(LRTrim(meneficope->C_CTA)+Space(30),30),Left(LRTrim(personbo->DESCCIT)+Space(30),30)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficope.GetString("C_CTA"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("C_CTA"))+CPLib.Space(30),30):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DESCCIT"))+CPLib.Space(30),30));
                      /* _note := _note + iif(not(Empty(LRTrim(meneficope->C_PRV))),Left(LRTrim(meneficope->C_PRV)+Space(2),2),Left(LRTrim(personbo->PROVINCIA)+Space(2),2)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficope.GetString("C_PRV"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("C_PRV"))+CPLib.Space(2),2):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PROVINCIA"))+CPLib.Space(2),2));
                      /* _note := _note + iif(not(Empty(LRTrim(meneficope->C_IND))),Left(LRTrim(meneficope->C_IND)+Space(35),35),Left(LRTrim(personbo->DOMICILIO)+Space(35),35)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficope.GetString("C_IND"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("C_IND"))+CPLib.Space(35),35):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DOMICILIO"))+CPLib.Space(35),35));
                      /* _note := _note + iif(not(Empty(LRTrim(meneficope->C_CAP))),Left(LRTrim(meneficope->C_CAP)+Space(5),5),Left(LRTrim(personbo->CAP)+Space(5),5)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficope.GetString("C_CAP"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("C_CAP"))+CPLib.Space(5),5):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CAP"))+CPLib.Space(5),5));
                      /* _note := _note + Space(63) */
                      _note = _note+CPLib.Space(63);
                      /* _note := _note +Left(LRTrim(meneficope->C_RAPPORTO)+Space(25),25) */
                      _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("C_RAPPORTO"))+CPLib.Space(25),25);
                      /* _note := _note + Space(91) */
                      _note = _note+CPLib.Space(91);
                      /* Exec "Scrittura Dati" Page 15:Page_19 */
                      Page_19();
                      /* nTotRec := nTotRec + 1 */
                      nTotRec = CPLib.Round(nTotRec+1,0);
                      /* nNumRec := nNumRec + 1 */
                      nNumRec = CPLib.Round(nNumRec+1,0);
                      Cursor_personbo.Next();
                    }
                    m_cConnectivityError = Cursor_personbo.ErrorMessage();
                    Cursor_personbo.Close();
                    // * --- End Select
                  } else { // Else
                    // * --- Select from wersonbo
                    m_cServer = m_Ctx.GetServer("wersonbo");
                    m_cPhName = m_Ctx.GetPhName("wersonbo");
                    if (Cursor_wersonbo!=null)
                      Cursor_wersonbo.Close();
                    Cursor_wersonbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"sanumpro="+CPSql.SQLValueAdapter(CPLib.ToSQL(_numsto,"?",0,0,m_cServer, m_oParameters),m_cServer,_numsto)+" "+")"+(m_Ctx.IsSharedTemp("wersonbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                    while ( ! (Cursor_wersonbo.Eof())) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
                      /* _note := _note + Left(LRTrim(meneficope->CODSOG)+Space(16),16) */
                      _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("CODSOG"))+CPLib.Space(16),16);
                      /* _note := _note + iif(not(Empty(LRTrim(meneficope->C_RAG))),Left(LRTrim(meneficope->C_RAG)+Space(70),70),Left(LRTrim(wersonbo->RAGSOC)+Space(70),70)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficope.GetString("C_RAG"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("C_RAG"))+CPLib.Space(70),70):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("RAGSOC"))+CPLib.Space(70),70));
                      /* _note := _note + iif(not(Empty(LRTrim(meneficope->C_STA))),Left(LRTrim(meneficope->C_STA)+Space(3),3),Left(LRTrim(wersonbo->PAESE)+Space(3),3)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficope.GetString("C_STA"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("C_STA"))+CPLib.Space(3),3):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PAESE"))+CPLib.Space(3),3));
                      /* _note := _note + iif(not(Empty(LRTrim(meneficope->C_CAB))),Left(LRTrim(meneficope->C_CAB)+Space(6),6),Left(LRTrim(wersonbo->CODCAB)+Space(6),6)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficope.GetString("C_CAB"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("C_CAB"))+CPLib.Space(6),6):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CODCAB"))+CPLib.Space(6),6));
                      /* _note := _note + iif(not(Empty(LRTrim(meneficope->C_CTA))),Left(LRTrim(meneficope->C_CTA)+Space(30),30),Left(LRTrim(wersonbo->DESCCIT)+Space(30),30)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficope.GetString("C_CTA"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("C_CTA"))+CPLib.Space(30),30):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DESCCIT"))+CPLib.Space(30),30));
                      /* _note := _note + iif(not(Empty(LRTrim(meneficope->C_PRV))),Left(LRTrim(meneficope->C_PRV)+Space(2),2),Left(LRTrim(wersonbo->PROVINCIA)+Space(2),2)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficope.GetString("C_PRV"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("C_PRV"))+CPLib.Space(2),2):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PROVINCIA"))+CPLib.Space(2),2));
                      /* _note := _note + iif(not(Empty(LRTrim(meneficope->C_IND))),Left(LRTrim(meneficope->C_IND)+Space(35),35),Left(LRTrim(wersonbo->DOMICILIO)+Space(35),35)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficope.GetString("C_IND"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("C_IND"))+CPLib.Space(35),35):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DOMICILIO"))+CPLib.Space(35),35));
                      /* _note := _note + iif(not(Empty(LRTrim(meneficope->C_CAP))),Left(LRTrim(meneficope->C_CAP)+Space(5),5),Left(LRTrim(wersonbo->CAP)+Space(5),5)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficope.GetString("C_CAP"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("C_CAP"))+CPLib.Space(5),5):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CAP"))+CPLib.Space(5),5));
                      /* _note := _note + Space(63) */
                      _note = _note+CPLib.Space(63);
                      /* _note := _note +Left(LRTrim(meneficope->C_RAPPORTO)+Space(25),25) */
                      _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficope.GetString("C_RAPPORTO"))+CPLib.Space(25),25);
                      /* _note := _note + Space(91) */
                      _note = _note+CPLib.Space(91);
                      /* Exec "Scrittura Dati" Page 15:Page_19 */
                      Page_19();
                      /* nTotRec := nTotRec + 1 */
                      nTotRec = CPLib.Round(nTotRec+1,0);
                      /* nNumRec := nNumRec + 1 */
                      nNumRec = CPLib.Round(nNumRec+1,0);
                      Cursor_wersonbo.Next();
                    }
                    m_cConnectivityError = Cursor_wersonbo.ErrorMessage();
                    Cursor_wersonbo.Close();
                    // * --- End Select
                  } // End If
                } // End If
              } // End If
              Cursor_meneficope.Next();
            }
            m_cConnectivityError = Cursor_meneficope.ErrorMessage();
            Cursor_meneficope.Close();
            // * --- End Select
          } // End If
          /* If _oldrighe=0 and _beneficope */
          if (CPLib.eqr(_oldrighe,0) && _beneficope) {
            // * --- Select from beneficope
            m_cServer = m_Ctx.GetServer("beneficope");
            m_cPhName = m_Ctx.GetPhName("beneficope");
            if (Cursor_beneficope!=null)
              Cursor_beneficope.Close();
            Cursor_beneficope = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_oped_chkdiana.GetString("IDBASE"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("beneficope")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_beneficope.Eof())) {
              /* If Empty(LRTrim(beneficope->CODSOG)) and not(Empty(LRTrim(beneficope->C_RAG))) */
              if (CPLib.Empty(CPLib.LRTrim(Cursor_beneficope.GetString("CODSOG"))) &&  ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficope.GetString("C_RAG"))))) {
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
                /* _note := _note + Left(LRTrim(beneficope->CODSOG)+Space(16),16) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("CODSOG"))+CPLib.Space(16),16);
                /* _note := _note +Left(LRTrim(beneficope->C_RAG)+Space(70),70) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("C_RAG"))+CPLib.Space(70),70);
                /* _note := _note + Left(LRTrim(beneficope->C_STA)+Space(3),3) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("C_STA"))+CPLib.Space(3),3);
                /* _note := _note +Left(LRTrim(beneficope->C_CAB)+Space(6),6) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("C_CAB"))+CPLib.Space(6),6);
                /* _note := _note +Left(LRTrim(beneficope->C_CTA)+Space(30),30) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("C_CTA"))+CPLib.Space(30),30);
                /* _note := _note + Left(LRTrim(beneficope->C_PRV)+Space(2),2) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("C_PRV"))+CPLib.Space(2),2);
                /* _note := _note + Left(LRTrim(beneficope->C_IND)+Space(35),35) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("C_IND"))+CPLib.Space(35),35);
                /* _note := _note + Left(LRTrim(beneficope->C_CAP)+Space(5),5) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("C_CAP"))+CPLib.Space(5),5);
                /* _note := _note + Space(63) */
                _note = _note+CPLib.Space(63);
                /* _note := _note + Left(LRTrim(beneficope->C_RAPPORTO)+Space(25),25) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("C_RAPPORTO"))+CPLib.Space(25),25);
                /* _note := _note + Space(91) */
                _note = _note+CPLib.Space(91);
                /* Exec "Scrittura Dati" Page 15:Page_19 */
                Page_19();
                /* nTotRec := nTotRec + 1 */
                nTotRec = CPLib.Round(nTotRec+1,0);
                /* nNumRec := nNumRec + 1 */
                nNumRec = CPLib.Round(nNumRec+1,0);
              } else { // Else
                /* If beneficope->CODSOG <> qbe_oped_chkdiana->CONNESBEN */
                if (CPLib.ne(Cursor_beneficope.GetString("CODSOG"),Cursor_qbe_oped_chkdiana.GetString("CONNESBEN"))) {
                  /* _numsto := arfn_chkspers(beneficope->CODSOG,iif(w_stoper='R',qbe_oped_chkdiana->DATAREG,qbe_oped_chkdiana->DATAOPE)) */
                  _numsto = arfn_chkspersR.Make(m_Ctx,this).Run(Cursor_beneficope.GetString("CODSOG"),(CPLib.eqr(w_stoper,"R")?Cursor_qbe_oped_chkdiana.GetDate("DATAREG"):Cursor_qbe_oped_chkdiana.GetDate("DATAOPE")));
                  /* If Empty(LRTrim(_numsto)) */
                  if (CPLib.Empty(CPLib.LRTrim(_numsto))) {
                    // * --- Select from personbo
                    m_cServer = m_Ctx.GetServer("personbo");
                    m_cPhName = m_Ctx.GetPhName("personbo");
                    if (Cursor_personbo!=null)
                      Cursor_personbo.Close();
                    Cursor_personbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CONNES="+CPLib.ToSQL(Cursor_beneficope.GetString("CODSOG"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("personbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                    while ( ! (Cursor_personbo.Eof())) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
                      /* _note := _note + Left(LRTrim(beneficope->CODSOG)+Space(16),16) */
                      _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("CODSOG"))+CPLib.Space(16),16);
                      /* _note := _note + iif(not(Empty(LRTrim(beneficope->C_RAG))),Left(LRTrim(beneficope->C_RAG)+Space(70),70),Left(LRTrim(personbo->RAGSOC)+Space(70),70)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficope.GetString("C_RAG"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("C_RAG"))+CPLib.Space(70),70):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("RAGSOC"))+CPLib.Space(70),70));
                      /* _note := _note + iif(not(Empty(LRTrim(beneficope->C_STA))),Left(LRTrim(beneficope->C_STA)+Space(3),3),Left(LRTrim(personbo->PAESE)+Space(3),3)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficope.GetString("C_STA"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("C_STA"))+CPLib.Space(3),3):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PAESE"))+CPLib.Space(3),3));
                      /* _note := _note + iif(not(Empty(LRTrim(beneficope->C_CAB))),Left(LRTrim(beneficope->C_CAB)+Space(6),6),Left(LRTrim(personbo->CODCAB)+Space(6),6)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficope.GetString("C_CAB"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("C_CAB"))+CPLib.Space(6),6):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CODCAB"))+CPLib.Space(6),6));
                      /* _note := _note + iif(not(Empty(LRTrim(beneficope->C_CTA))),Left(LRTrim(beneficope->C_CTA)+Space(30),30),Left(LRTrim(personbo->DESCCIT)+Space(30),30)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficope.GetString("C_CTA"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("C_CTA"))+CPLib.Space(30),30):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DESCCIT"))+CPLib.Space(30),30));
                      /* _note := _note + iif(not(Empty(LRTrim(beneficope->C_PRV))),Left(LRTrim(beneficope->C_PRV)+Space(2),2),Left(LRTrim(personbo->PROVINCIA)+Space(2),2)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficope.GetString("C_PRV"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("C_PRV"))+CPLib.Space(2),2):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PROVINCIA"))+CPLib.Space(2),2));
                      /* _note := _note + iif(not(Empty(LRTrim(beneficope->C_IND))),Left(LRTrim(beneficope->C_IND)+Space(35),35),Left(LRTrim(personbo->DOMICILIO)+Space(35),35)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficope.GetString("C_IND"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("C_IND"))+CPLib.Space(35),35):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DOMICILIO"))+CPLib.Space(35),35));
                      /* _note := _note + iif(not(Empty(LRTrim(beneficope->C_CAP))),Left(LRTrim(beneficope->C_CAP)+Space(5),5),Left(LRTrim(personbo->CAP)+Space(5),5)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficope.GetString("C_CAP"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("C_CAP"))+CPLib.Space(5),5):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CAP"))+CPLib.Space(5),5));
                      /* _note := _note + Space(63) */
                      _note = _note+CPLib.Space(63);
                      /* _note := _note +Left(LRTrim(beneficope->C_RAPPORTO)+Space(25),25) */
                      _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("C_RAPPORTO"))+CPLib.Space(25),25);
                      /* _note := _note + Space(91) */
                      _note = _note+CPLib.Space(91);
                      /* Exec "Scrittura Dati" Page 15:Page_19 */
                      Page_19();
                      /* nTotRec := nTotRec + 1 */
                      nTotRec = CPLib.Round(nTotRec+1,0);
                      /* nNumRec := nNumRec + 1 */
                      nNumRec = CPLib.Round(nNumRec+1,0);
                      Cursor_personbo.Next();
                    }
                    m_cConnectivityError = Cursor_personbo.ErrorMessage();
                    Cursor_personbo.Close();
                    // * --- End Select
                  } else { // Else
                    // * --- Select from wersonbo
                    m_cServer = m_Ctx.GetServer("wersonbo");
                    m_cPhName = m_Ctx.GetPhName("wersonbo");
                    if (Cursor_wersonbo!=null)
                      Cursor_wersonbo.Close();
                    Cursor_wersonbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"sanumpro="+CPSql.SQLValueAdapter(CPLib.ToSQL(_numsto,"?",0,0,m_cServer, m_oParameters),m_cServer,_numsto)+" "+")"+(m_Ctx.IsSharedTemp("wersonbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                    while ( ! (Cursor_wersonbo.Eof())) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
                      /* _note := _note + Left(LRTrim(beneficope->CODSOG)+Space(16),16) */
                      _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("CODSOG"))+CPLib.Space(16),16);
                      /* _note := _note + iif(not(Empty(LRTrim(beneficope->C_RAG))),Left(LRTrim(beneficope->C_RAG)+Space(70),70),Left(LRTrim(wersonbo->RAGSOC)+Space(70),70)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficope.GetString("C_RAG"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("C_RAG"))+CPLib.Space(70),70):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("RAGSOC"))+CPLib.Space(70),70));
                      /* _note := _note + iif(not(Empty(LRTrim(beneficope->C_STA))),Left(LRTrim(beneficope->C_STA)+Space(3),3),Left(LRTrim(wersonbo->PAESE)+Space(3),3)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficope.GetString("C_STA"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("C_STA"))+CPLib.Space(3),3):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PAESE"))+CPLib.Space(3),3));
                      /* _note := _note + iif(not(Empty(LRTrim(beneficope->C_CAB))),Left(LRTrim(beneficope->C_CAB)+Space(6),6),Left(LRTrim(wersonbo->CODCAB)+Space(6),6)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficope.GetString("C_CAB"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("C_CAB"))+CPLib.Space(6),6):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CODCAB"))+CPLib.Space(6),6));
                      /* _note := _note + iif(not(Empty(LRTrim(beneficope->C_CTA))),Left(LRTrim(beneficope->C_CTA)+Space(30),30),Left(LRTrim(wersonbo->DESCCIT)+Space(30),30)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficope.GetString("C_CTA"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("C_CTA"))+CPLib.Space(30),30):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DESCCIT"))+CPLib.Space(30),30));
                      /* _note := _note + iif(not(Empty(LRTrim(beneficope->C_PRV))),Left(LRTrim(beneficope->C_PRV)+Space(2),2),Left(LRTrim(wersonbo->PROVINCIA)+Space(2),2)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficope.GetString("C_PRV"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("C_PRV"))+CPLib.Space(2),2):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PROVINCIA"))+CPLib.Space(2),2));
                      /* _note := _note + iif(not(Empty(LRTrim(beneficope->C_IND))),Left(LRTrim(beneficope->C_IND)+Space(35),35),Left(LRTrim(wersonbo->DOMICILIO)+Space(35),35)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficope.GetString("C_IND"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("C_IND"))+CPLib.Space(35),35):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DOMICILIO"))+CPLib.Space(35),35));
                      /* _note := _note + iif(not(Empty(LRTrim(beneficope->C_CAP))),Left(LRTrim(beneficope->C_CAP)+Space(5),5),Left(LRTrim(wersonbo->CAP)+Space(5),5)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficope.GetString("C_CAP"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("C_CAP"))+CPLib.Space(5),5):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CAP"))+CPLib.Space(5),5));
                      /* _note := _note + Space(63) */
                      _note = _note+CPLib.Space(63);
                      /* _note := _note +Left(LRTrim(beneficope->C_RAPPORTO)+Space(25),25) */
                      _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficope.GetString("C_RAPPORTO"))+CPLib.Space(25),25);
                      /* _note := _note + Space(91) */
                      _note = _note+CPLib.Space(91);
                      /* Exec "Scrittura Dati" Page 15:Page_19 */
                      Page_19();
                      /* nTotRec := nTotRec + 1 */
                      nTotRec = CPLib.Round(nTotRec+1,0);
                      /* nNumRec := nNumRec + 1 */
                      nNumRec = CPLib.Round(nNumRec+1,0);
                      Cursor_wersonbo.Next();
                    }
                    m_cConnectivityError = Cursor_wersonbo.ErrorMessage();
                    Cursor_wersonbo.Close();
                    // * --- End Select
                  } // End If
                } // End If
              } // End If
              Cursor_beneficope.Next();
            }
            m_cConnectivityError = Cursor_beneficope.ErrorMessage();
            Cursor_beneficope.Close();
            // * --- End Select
          } // End If
          /* If not(Empty(qbe_oped_chkdiana->CONNALTRO)) */
          if ( ! (CPLib.Empty(Cursor_qbe_oped_chkdiana.GetString("CONNALTRO")))) {
            /* If qbe_oped_chkdiana->DATAOPE > CharToDate('20131231') */
            if (CPLib.gt(Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '9' + _idereg */
              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"9"+_idereg;
              /* pTipoR := '9' // Tipo Riga */
              pTipoR = "9";
            } else { // Else
              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '6' + _idereg */
              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"6"+_idereg;
              /* pTipoR := '6' // Tipo Riga */
              pTipoR = "6";
            } // End If
            /* pCli := qbe_oped_chkdiana->CONNALTRO // Codice Soggetto */
            pCli = Cursor_qbe_oped_chkdiana.GetString("CONNALTRO");
            /* pDatOpe := iif(w_stoper='R',qbe_oped_chkdiana->DATAREG,qbe_oped_chkdiana->DATAOPE) // Data Operazione */
            pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_oped_chkdiana.GetDate("DATAREG"):Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"));
            /* pRap := qbe_oped_chkdiana->RAPPORTO // Codice Rapporto */
            pRap = Cursor_qbe_oped_chkdiana.GetString("RAPPORTO");
            /* pTRap := qbe_oped_chkdiana->FLAGRAP // Tipo Rapporto */
            pTRap = Cursor_qbe_oped_chkdiana.GetString("FLAGRAP");
            /* pRAE := _raeatc // RAE o ATECO */
            pRAE = _raeatc;
            /* pSTATO := qbe_oped_chkdiana->STATOREG // Stato Registrazione */
            pSTATO = Cursor_qbe_oped_chkdiana.GetString("STATOREG");
            /* pDatRet := qbe_oped_chkdiana->DATARETT // Data Rettifica */
            pDatRet = Cursor_qbe_oped_chkdiana.GetDate("DATARETT");
            /* _oldmc := _usemc */
            _oldmc = CPLib.Round(_usemc,0);
            /* _usemc := 0 */
            _usemc = CPLib.Round(0,0);
            /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
            DatiSoggetto();
            /* _usemc := _oldmc */
            _usemc = CPLib.Round(_oldmc,0);
            /* If not(_rapcoll) */
            if ( ! (_rapcoll)) {
              /* Exec "Scrittura Dati" Page 15:Page_19 */
              Page_19();
            } else { // Else
              /* mcRighe.AppendWithKey(pTipoR) */
              mcRighe.AppendWithKey(pTipoR);
              /* mcRighe.TIPO := pTipoR */
              mcRighe.row.TIPO = pTipoR;
              /* mcRighe.RIGA := _note */
              mcRighe.row.RIGA = _note;
              /* mcRighe.SaveRow() */
              mcRighe.SaveRow();
            } // End If
            /* nTotRec := nTotRec + 1 */
            nTotRec = CPLib.Round(nTotRec+1,0);
            /* nNumRec := nNumRec + 1 */
            nNumRec = CPLib.Round(nNumRec+1,0);
          } // End If
          /* _oldrighe := 0 */
          _oldrighe = CPLib.Round(0,0);
          /* If qbe_oped_chkdiana->STATOREG='3' and _merzistiope */
          if (CPLib.eqr(Cursor_qbe_oped_chkdiana.GetString("STATOREG"),"3") && _merzistiope) {
            // * --- Select from merzistiope
            m_cServer = m_Ctx.GetServer("merzistiope");
            m_cPhName = m_Ctx.GetPhName("merzistiope");
            if (Cursor_merzistiope!=null)
              Cursor_merzistiope.Close();
            Cursor_merzistiope = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_oped_chkdiana.GetString("IDBASE"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("merzistiope")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_merzistiope.Eof())) {
              /* If merzistiope->CODSOG <> qbe_oped_chkdiana->CONNALTRO */
              if (CPLib.ne(Cursor_merzistiope.GetString("CODSOG"),Cursor_qbe_oped_chkdiana.GetString("CONNALTRO"))) {
                /* If qbe_oped_chkdiana->DATAOPE > CharToDate('20131231') */
                if (CPLib.gt(Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '9' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"9"+_idereg;
                  /* pTipoR := '9' // Tipo Riga */
                  pTipoR = "9";
                } else { // Else
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '6' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"6"+_idereg;
                  /* pTipoR := '6' // Tipo Riga */
                  pTipoR = "6";
                } // End If
                /* pCli := merzistiope->CODSOG // Codice Soggetto */
                pCli = Cursor_merzistiope.GetString("CODSOG");
                /* pDatOpe := iif(w_stoper='R',qbe_oped_chkdiana->DATAREG,qbe_oped_chkdiana->DATAOPE) // Data Operazione */
                pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_oped_chkdiana.GetDate("DATAREG"):Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"));
                /* pRap := qbe_oped_chkdiana->RAPPORTO // Codice Rapporto */
                pRap = Cursor_qbe_oped_chkdiana.GetString("RAPPORTO");
                /* pTRap := qbe_oped_chkdiana->FLAGRAP // Tipo Rapporto */
                pTRap = Cursor_qbe_oped_chkdiana.GetString("FLAGRAP");
                /* pRAE := _raeatc // RAE o ATECO */
                pRAE = _raeatc;
                /* pSTATO := qbe_oped_chkdiana->STATOREG // Stato Registrazione */
                pSTATO = Cursor_qbe_oped_chkdiana.GetString("STATOREG");
                /* pDatRet := qbe_oped_chkdiana->DATARETT // Data Rettifica */
                pDatRet = Cursor_qbe_oped_chkdiana.GetDate("DATARETT");
                /* _oldmc := _usemc */
                _oldmc = CPLib.Round(_usemc,0);
                /* _usemc := 0 */
                _usemc = CPLib.Round(0,0);
                /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                DatiSoggetto();
                /* _usemc := _oldmc */
                _usemc = CPLib.Round(_oldmc,0);
                /* If not(_rapcoll) */
                if ( ! (_rapcoll)) {
                  /* Exec "Scrittura Dati" Page 15:Page_19 */
                  Page_19();
                } else { // Else
                  /* mcRighe.AppendWithKey(pTipoR) */
                  mcRighe.AppendWithKey(pTipoR);
                  /* mcRighe.TIPO := pTipoR */
                  mcRighe.row.TIPO = pTipoR;
                  /* mcRighe.RIGA := _note */
                  mcRighe.row.RIGA = _note;
                  /* mcRighe.SaveRow() */
                  mcRighe.SaveRow();
                } // End If
                /* nTotRec := nTotRec + 1 */
                nTotRec = CPLib.Round(nTotRec+1,0);
                /* nNumRec := nNumRec + 1 */
                nNumRec = CPLib.Round(nNumRec+1,0);
              } // End If
              Cursor_merzistiope.Next();
            }
            m_cConnectivityError = Cursor_merzistiope.ErrorMessage();
            Cursor_merzistiope.Close();
            // * --- End Select
          } // End If
          /* If _oldrighe=0 and _terzistiope */
          if (CPLib.eqr(_oldrighe,0) && _terzistiope) {
            // * --- Select from terzistiope
            m_cServer = m_Ctx.GetServer("terzistiope");
            m_cPhName = m_Ctx.GetPhName("terzistiope");
            if (Cursor_terzistiope!=null)
              Cursor_terzistiope.Close();
            Cursor_terzistiope = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_oped_chkdiana.GetString("IDBASE"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("terzistiope")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_terzistiope.Eof())) {
              /* If terzistiope->CODSOG <> qbe_oped_chkdiana->CONNALTRO */
              if (CPLib.ne(Cursor_terzistiope.GetString("CODSOG"),Cursor_qbe_oped_chkdiana.GetString("CONNALTRO"))) {
                /* If qbe_oped_chkdiana->DATAOPE > CharToDate('20131231') */
                if (CPLib.gt(Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '9' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"9"+_idereg;
                  /* pTipoR := '9' // Tipo Riga */
                  pTipoR = "9";
                } else { // Else
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '6' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"6"+_idereg;
                  /* pTipoR := '6' // Tipo Riga */
                  pTipoR = "6";
                } // End If
                /* pCli := terzistiope->CODSOG // Codice Soggetto */
                pCli = Cursor_terzistiope.GetString("CODSOG");
                /* pDatOpe := iif(w_stoper='R',qbe_oped_chkdiana->DATAREG,qbe_oped_chkdiana->DATAOPE) // Data Operazione */
                pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_oped_chkdiana.GetDate("DATAREG"):Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"));
                /* pRap := qbe_oped_chkdiana->RAPPORTO // Codice Rapporto */
                pRap = Cursor_qbe_oped_chkdiana.GetString("RAPPORTO");
                /* pTRap := qbe_oped_chkdiana->FLAGRAP // Tipo Rapporto */
                pTRap = Cursor_qbe_oped_chkdiana.GetString("FLAGRAP");
                /* pRAE := _raeatc // RAE o ATECO */
                pRAE = _raeatc;
                /* pSTATO := qbe_oped_chkdiana->STATOREG // Stato Registrazione */
                pSTATO = Cursor_qbe_oped_chkdiana.GetString("STATOREG");
                /* pDatRet := qbe_oped_chkdiana->DATARETT // Data Rettifica */
                pDatRet = Cursor_qbe_oped_chkdiana.GetDate("DATARETT");
                /* _oldmc := _usemc */
                _oldmc = CPLib.Round(_usemc,0);
                /* _usemc := 0 */
                _usemc = CPLib.Round(0,0);
                /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                DatiSoggetto();
                /* _usemc := _oldmc */
                _usemc = CPLib.Round(_oldmc,0);
                /* If not(_rapcoll) */
                if ( ! (_rapcoll)) {
                  /* Exec "Scrittura Dati" Page 15:Page_19 */
                  Page_19();
                } else { // Else
                  /* mcRighe.AppendWithKey(pTipoR) */
                  mcRighe.AppendWithKey(pTipoR);
                  /* mcRighe.TIPO := pTipoR */
                  mcRighe.row.TIPO = pTipoR;
                  /* mcRighe.RIGA := _note */
                  mcRighe.row.RIGA = _note;
                  /* mcRighe.SaveRow() */
                  mcRighe.SaveRow();
                } // End If
                /* nTotRec := nTotRec + 1 */
                nTotRec = CPLib.Round(nTotRec+1,0);
                /* nNumRec := nNumRec + 1 */
                nNumRec = CPLib.Round(nNumRec+1,0);
              } // End If
              Cursor_terzistiope.Next();
            }
            m_cConnectivityError = Cursor_terzistiope.ErrorMessage();
            Cursor_terzistiope.Close();
            // * --- End Select
          } // End If
          /* If _rapcoll */
          if (_rapcoll) {
            // * --- Select from rapcoll
            m_cServer = m_Ctx.GetServer("rapcoll");
            m_cPhName = m_Ctx.GetPhName("rapcoll");
            if (Cursor_rapcoll!=null)
              Cursor_rapcoll.Close();
            Cursor_rapcoll = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_oped_chkdiana.GetString("IDBASE"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("rapcoll")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_rapcoll.Eof())) {
              for (MemoryCursorRow_mcdiana_mcrdef rowRighe : mcRighe._iterable_()) {
                /* If rowRighe.TIPO='1' */
                if (CPLib.eqr(rowRighe.TIPO,"1")) {
                  /* _note := Left(_note,198)+Left(LRTrim(rapcoll->RAPPORTO)+Space(25),25)+Substr(_note,224,156) */
                  _note = CPLib.Left(_note,198)+CPLib.Left(CPLib.LRTrim(Cursor_rapcoll.GetString("RAPPORTO"))+CPLib.Space(25),25)+CPLib.Substr(_note,224,156);
                } else { // Else
                  /* _note := Left(rowRighe.RIGA,380) */
                  _note = CPLib.Left(rowRighe.RIGA,380);
                } // End If
                /* Exec "Scrittura Dati" Page 15:Page_19 */
                Page_19();
                /* If rowRighe.TIPO='1' */
                if (CPLib.eqr(rowRighe.TIPO,"1")) {
                  /* If not(Empty(rapcoll->RAPPORTO)) */
                  if ( ! (CPLib.Empty(Cursor_rapcoll.GetString("RAPPORTO")))) {
                    /* _oldrap := '' */
                    _oldrap = "";
                    // * --- Read from knarapbo
                    m_cServer = m_Ctx.GetServer("knarapbo");
                    m_cPhName = m_Ctx.GetPhName("knarapbo");
                    m_cSql = "";
                    m_cSql = m_cSql+"RAPPORTO="+CPSql.SQLValueAdapter(CPLib.ToSQL(Cursor_rapcoll.GetString("RAPPORTO"),"C",25,0,m_cServer),m_cServer,Cursor_rapcoll.GetString("RAPPORTO"));
                    if (m_Ctx.IsSharedTemp("knarapbo")) {
                      m_cSql = m_cSql+" and context_id='"+m_Ctx.GetTempID()+"'";
                    }
                    if (Read_Cursor!=null)
                      Read_Cursor.Close();
                    Read_Cursor = m_Sql.Query(m_cServer,"select "+CPLib.GetMultilanguageField("RAPPORTO",m_Ctx,m_cServer)+" from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+m_cSql);
                    if ( ! (Read_Cursor.Eof())) {
                      _oldrap = Read_Cursor.GetString("RAPPORTO");
                      Read_Cursor.Next();
                      if ( ! (Read_Cursor.Eof())) {
                        Error l_oErrorFault = new Error("Read on knarapbo into routine arrt_chkdiana_all returns two or more records. This item should return only a record.");
                        CPStdCounter.Error(l_oErrorFault);
                      }
                      Read_Cursor.Close();
                    } else {
                      // Error: no record found!
                      _oldrap = "";
                      Read_Cursor.Close();
                      m_cLastMsgError = "MSG_RECORD_NOT_FOUND";
                    }
                    /* If not(Empty(_oldrap)) */
                    if ( ! (CPLib.Empty(_oldrap))) {
                      // * --- Select from intestbo
                      m_cServer = m_Ctx.GetServer("intestbo");
                      m_cPhName = m_Ctx.GetPhName("intestbo");
                      if (Cursor_intestbo!=null)
                        Cursor_intestbo.Close();
                      Cursor_intestbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_rapcoll.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("intestbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                      while ( ! (Cursor_intestbo.Eof())) {
                        /* If rapcoll->RAPPORTO = intestbo->RAPPORTO */
                        if (CPLib.eqr(Cursor_rapcoll.GetString("RAPPORTO"),Cursor_intestbo.GetString("RAPPORTO"))) {
                          /* _avanza := 0 */
                          _avanza = CPLib.Round(0,0);
                          /* If Empty(intestbo->CODINTER) or intestbo->STATOREG='2' or intestbo->STATOREG='3' */
                          if (CPLib.Empty(Cursor_intestbo.GetString("CODINTER")) || CPLib.eqr(Cursor_intestbo.GetString("STATOREG"),"2") || CPLib.eqr(Cursor_intestbo.GetString("STATOREG"),"3")) {
                            /* _avanza := 1 */
                            _avanza = CPLib.Round(1,0);
                          } // End If
                          /* If intestbo->DATAINI > qbe_oped_chkdiana->DATAOPE */
                          if (CPLib.gt(Cursor_intestbo.GetDate("DATAINI"),Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"))) {
                            /* _avanza := 1 */
                            _avanza = CPLib.Round(1,0);
                          } // End If
                          /* If not(Empty(intestbo->DATAFINE)) and intestbo->DATAFINE < qbe_oped_chkdiana->DATAOPE */
                          if ( ! (CPLib.Empty(Cursor_intestbo.GetDate("DATAFINE"))) && CPLib.lt(Cursor_intestbo.GetDate("DATAFINE"),Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"))) {
                            /* _avanza := 1 */
                            _avanza = CPLib.Round(1,0);
                          } // End If
                          /* If _avanza = 0 */
                          if (CPLib.eqr(_avanza,0)) {
                            /* _codrif := intestbo->CODINTER */
                            _codrif = Cursor_intestbo.GetString("CODINTER");
                            /* If qbe_oped_chkdiana->DATAOPE > CharToDate('20131231') */
                            if (CPLib.gt(Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '7' + _idereg */
                              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                              /* pTipoR := '7' // Tipo Riga */
                              pTipoR = "7";
                            } else { // Else
                              /* If Empty(qbe_oped_chkdiana->CONNESOPER) or (qbe_oped_chkdiana->CONNESOPER=intestbo->CODINTER) */
                              if (CPLib.Empty(Cursor_qbe_oped_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(Cursor_qbe_oped_chkdiana.GetString("CONNESOPER"),Cursor_intestbo.GetString("CODINTER")))) {
                                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                                /* pTipoR := '2' // Tipo Riga */
                                pTipoR = "2";
                              } else { // Else
                                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                                /* pTipoR := '3' // Tipo Riga */
                                pTipoR = "3";
                              } // End If
                            } // End If
                            /* pCli := intestbo->CODINTER // Codice Soggetto */
                            pCli = Cursor_intestbo.GetString("CODINTER");
                            /* pDatOpe := iif(w_stoper='R',qbe_oped_chkdiana->DATAREG,qbe_oped_chkdiana->DATAOPE) // Data Operazione */
                            pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_oped_chkdiana.GetDate("DATAREG"):Cursor_qbe_oped_chkdiana.GetDate("DATAOPE"));
                            /* pRap := qbe_oped_chkdiana->RAPPORTO // Codice Rapporto */
                            pRap = Cursor_qbe_oped_chkdiana.GetString("RAPPORTO");
                            /* pTRap := qbe_oped_chkdiana->FLAGRAP // Tipo Rapporto */
                            pTRap = Cursor_qbe_oped_chkdiana.GetString("FLAGRAP");
                            /* pRAE := _raeatc // RAE o ATECO */
                            pRAE = _raeatc;
                            /* pSTATO := qbe_oped_chkdiana->STATOREG // Stato Registrazione */
                            pSTATO = Cursor_qbe_oped_chkdiana.GetString("STATOREG");
                            /* pDatRet := qbe_oped_chkdiana->DATARETT // Data Rettifica */
                            pDatRet = Cursor_qbe_oped_chkdiana.GetDate("DATARETT");
                            /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                            DatiSoggetto();
                            /* Exec "Scrittura Dati" Page 15:Page_19 */
                            Page_19();
                            /* nTotRec := nTotRec + 1 */
                            nTotRec = CPLib.Round(nTotRec+1,0);
                            /* nNumRec := nNumRec + 1 */
                            nNumRec = CPLib.Round(nNumRec+1,0);
                          } // End If
                        } // End If
                        Cursor_intestbo.Next();
                      }
                      m_cConnectivityError = Cursor_intestbo.ErrorMessage();
                      Cursor_intestbo.Close();
                      // * --- End Select
                    } // End If
                  } // End If
                } // End If
              }
              Cursor_rapcoll.Next();
            }
            m_cConnectivityError = Cursor_rapcoll.ErrorMessage();
            Cursor_rapcoll.Close();
            // * --- End Select
          } // End If
          /* gNumRec := nTotRec // N° Record DIANA */
          gNumRec = CPLib.Round(nTotRec,0);
          m_Ctx.SetGlobalNumber("gNumRec",gNumRec);
          /* gNumReg := nTotReg // N° Registrazioni DIANA */
          gNumReg = CPLib.Round(nTotReg,0);
          m_Ctx.SetGlobalNumber("gNumReg",gNumReg);
          Cursor_qbe_oped_chkdiana.Next();
        }
        m_cConnectivityError = Cursor_qbe_oped_chkdiana.ErrorMessage();
        Cursor_qbe_oped_chkdiana.Close();
        // * --- End Select
        /* _contacilci := _contacilci+1 */
        _contacilci = CPLib.Round(_contacilci+1,0);
      } // End While
    } finally {
      try {
        if (Cursor_qbe_oped_chkdiana_limits!=null)
          Cursor_qbe_oped_chkdiana_limits.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_qbe_oped_chkdiana!=null)
          Cursor_qbe_oped_chkdiana.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_qbe_tab_mmc!=null)
          Cursor_qbe_tab_mmc.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_kersonbo!=null)
          Cursor_kersonbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_intestbo!=null)
          Cursor_intestbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_mlientiope!=null)
          Cursor_mlientiope.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_clientiope!=null)
          Cursor_clientiope.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Read_Cursor!=null)
          Read_Cursor.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_mogopebo!=null)
          Cursor_mogopebo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_sogopebo!=null)
          Cursor_sogopebo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_personbo!=null)
          Cursor_personbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_wersonbo!=null)
          Cursor_wersonbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_meneficope!=null)
          Cursor_meneficope.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_beneficope!=null)
          Cursor_beneficope.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_merzistiope!=null)
          Cursor_merzistiope.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_terzistiope!=null)
          Cursor_terzistiope.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_rapcoll!=null)
          Cursor_rapcoll.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
    }
  }
  void Page_8() throws Exception {
    CPResultSet Cursor_qbe_opep_chkdiana_limits=null;
    CPResultSet Cursor_qbe_opep_chkdiana=null;
    CPResultSet Cursor_qbe_tab_mmc=null;
    CPResultSet Cursor_knarapbo=null;
    CPResultSet Cursor_kersonbo=null;
    CPResultSet Read_Cursor=null;
    CPResultSet Cursor_xntestbo=null;
    CPResultSet Cursor_intestbo=null;
    CPResultSet Cursor_xlientiope=null;
    CPResultSet Cursor_xogopebo=null;
    CPResultSet Cursor_personbo=null;
    CPResultSet Cursor_wersonbo=null;
    CPResultSet Cursor_xeneficope=null;
    CPResultSet Cursor_xerzistiope=null;
    CPResultSet Cursor_xapcoll=null;
    VQRHolder l_VQRHolder = null;
    try {
      /* Cicla sulle operazioni provvisorie */
      /* gMsgImp := 'Verifica Operazioni Provvisorie da elaborare ...' // Messaggio Import */
      gMsgImp = "Verifica Operazioni Provvisorie da elaborare ...";
      m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
      /* _max := 0 */
      _max = CPLib.Round(0,0);
      /* _min := 0 */
      _min = CPLib.Round(0,0);
      /* _ciclo := 0 */
      _ciclo = CPLib.Round(0,0);
      /* Prima gli italiani */
      // * --- Select from qbe_opep_chkdiana_limits
      SPBridge.HMCaller _h000007B3;
      _h000007B3 = new SPBridge.HMCaller();
      _h000007B3.Set("m_cVQRList",m_cVQRList);
      _h000007B3.Set("cdadata",w_cdadata);
      _h000007B3.Set("c_adata",w_c_adata);
      _h000007B3.Set("codage",w_codage);
      _h000007B3.Set("ragben",w_ragben);
      _h000007B3.Set("codcli",w_codcli);
      if (Cursor_qbe_opep_chkdiana_limits!=null)
        Cursor_qbe_opep_chkdiana_limits.Close();
      Cursor_qbe_opep_chkdiana_limits = new VQRHolder("qbe_opep_chkdiana_limits",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h000007B3,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_opep_chkdiana_limits.Eof())) {
        /* _max := qbe_opep_chkdiana_limits->MAXOPE */
        _max = CPLib.Round(Cursor_qbe_opep_chkdiana_limits.GetDouble("MAXOPE"),0);
        /* _min := qbe_opep_chkdiana_limits->MINOPE */
        _min = CPLib.Round(Cursor_qbe_opep_chkdiana_limits.GetDouble("MINOPE"),0);
        Cursor_qbe_opep_chkdiana_limits.Next();
      }
      m_cConnectivityError = Cursor_qbe_opep_chkdiana_limits.ErrorMessage();
      Cursor_qbe_opep_chkdiana_limits.Close();
      // * --- End Select
      /* _cicli := iif(Mod(_max,5000) <> 0,Int(_max/5000) + 1,Int(_max/5000)) */
      _cicli = CPLib.Round((CPLib.ne(CPLib.Mod(_max,5000),0)?CPLib.Int(_max/5000)+1:CPLib.Int(_max/5000)),0);
      /* _bottom := _min */
      _bottom = CPLib.Round(_min,0);
      /* If _min > 5000 */
      if (CPLib.gt(_min,5000)) {
        /* _contacilci := Int(_min/5000) + 1 */
        _contacilci = CPLib.Round(CPLib.Int(_min/5000)+1,0);
      } else { // Else
        /* _contacilci := 1 */
        _contacilci = CPLib.Round(1,0);
      } // End If
      /* gMsgImp := 'Lettura operazioni in corso ...' // Messaggio Import */
      gMsgImp = "Lettura operazioni in corso ...";
      m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
      /* While _contacilci<=_cicli */
      while (CPLib.le(_contacilci,_cicli)) {
        /* _bottom := iif(_ciclo=0,_bottom,((_contacilci -1 ) * 5000) + 1) */
        _bottom = CPLib.Round((CPLib.eqr(_ciclo,0)?_bottom:((_contacilci-1)*5000)+1),0);
        /* _top := _contacilci * 5000 */
        _top = CPLib.Round(_contacilci*5000,0);
        /* _ciclo := 1 */
        _ciclo = CPLib.Round(1,0);
        /* _conta := _conta + 1 */
        _conta = CPLib.Round(_conta+1,0);
        /* gMsgImp := 'Lettura operazioni in corso ... Ciclo N. '+LRTrim(Str(_contacilci,10,0)) // Messaggio Import */
        gMsgImp = "Lettura operazioni in corso ... Ciclo N. "+CPLib.LRTrim(CPLib.Str(_contacilci,10,0));
        m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
        /* Cicla sulle operazioni */
        // * --- Select from qbe_opep_chkdiana
        SPBridge.HMCaller _h000007C3;
        _h000007C3 = new SPBridge.HMCaller();
        _h000007C3.Set("m_cVQRList",m_cVQRList);
        _h000007C3.Set("cdadata",w_cdadata);
        _h000007C3.Set("c_adata",w_c_adata);
        _h000007C3.Set("codage",w_codage);
        _h000007C3.Set("_bottom",_bottom);
        _h000007C3.Set("_top",_top);
        _h000007C3.Set("ragben",w_ragben);
        _h000007C3.Set("codcli",w_codcli);
        if (Cursor_qbe_opep_chkdiana!=null)
          Cursor_qbe_opep_chkdiana.Close();
        Cursor_qbe_opep_chkdiana = new VQRHolder("qbe_opep_chkdiana",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h000007C3,true).GetResultSet(m_Ctx);
        while ( ! (Cursor_qbe_opep_chkdiana.Eof())) {
          /* mcRighe.Zap() */
          mcRighe.Zap();
          /* If _xapcolleg */
          if (_xapcolleg) {
            // * --- Select from qbe_tab_mmc
            SPBridge.HMCaller _h000007C6;
            _h000007C6 = new SPBridge.HMCaller();
            _h000007C6.Set("m_cVQRList",m_cVQRList);
            _h000007C6.Set("tbname","xapcoll");
            _h000007C6.Set("fldname","IDFILEBO");
            _h000007C6.Set("parname","IDFILEBO");
            _h000007C6.Set("parval",Cursor_qbe_opep_chkdiana.GetString("IDBASE"));
            if (Cursor_qbe_tab_mmc!=null)
              Cursor_qbe_tab_mmc.Close();
            Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h000007C6,true).GetResultSet(m_Ctx);
            while ( ! (Cursor_qbe_tab_mmc.Eof())) {
              /* _rapcoll := qbe_tab_mmc->tot > 0 */
              _rapcoll = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
              Cursor_qbe_tab_mmc.Next();
            }
            m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
            Cursor_qbe_tab_mmc.Close();
            // * --- End Select
          } else { // Else
            /* _rapcoll := False */
            _rapcoll = false;
          } // End If
          // * --- Select from qbe_tab_mmc
          SPBridge.HMCaller _h000007C9;
          _h000007C9 = new SPBridge.HMCaller();
          _h000007C9.Set("m_cVQRList",m_cVQRList);
          _h000007C9.Set("tbname","xapcoll");
          _h000007C9.Set("fldname","IDFILEBO");
          _h000007C9.Set("parname","IDFILEBO");
          _h000007C9.Set("parval",Cursor_qbe_opep_chkdiana.GetString("IDBASE"));
          if (Cursor_qbe_tab_mmc!=null)
            Cursor_qbe_tab_mmc.Close();
          Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h000007C9,true).GetResultSet(m_Ctx);
          while ( ! (Cursor_qbe_tab_mmc.Eof())) {
            /* _rapcoll := qbe_tab_mmc->tot > 0 */
            _rapcoll = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
            Cursor_qbe_tab_mmc.Next();
          }
          m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
          Cursor_qbe_tab_mmc.Close();
          // * --- End Select
          /* _ctotale := _ctotale + 1 */
          _ctotale = CPLib.Round(_ctotale+1,0);
          /* gMsgImp := 'Elaborazione Operazione N.: '+LRTrim(Str(_ctotale,15,0)) // Messaggio Import */
          gMsgImp = "Elaborazione Operazione N.: "+CPLib.LRTrim(CPLib.Str(_ctotale,15,0));
          m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
          /* If qbe_opep_chkdiana->DATAOPE <  CharToDate('20100601') */
          if (CPLib.lt(Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20100601"))) {
            /* _raeatc := 'R' */
            _raeatc = "R";
            /* ElseIf qbe_opep_chkdiana->DATAOPE >  CharToDate('20131231') */
          } else if (CPLib.gt(Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
            /* _raeatc := 'A' */
            _raeatc = "A";
          } else { // Else
            /* _raeatc := w_flgrae */
            _raeatc = w_flgrae;
          } // End If
          /* _idereg := arfn_calc_idereg("O",qbe_opep_chkdiana->NUMPROG,qbe_opep_chkdiana->IDEREG) */
          _idereg = arfn_calc_ideregR.Make(m_Ctx,this).Run("O",Cursor_qbe_opep_chkdiana.GetString("NUMPROG"),Cursor_qbe_opep_chkdiana.GetString("IDEREG"));
          /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '1' + _idereg */
          _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"1"+_idereg;
          /* _flagrap := '' */
          _flagrap = "";
          /* If not(Empty(LRTrim(qbe_opep_chkdiana->RAPPORTO))) */
          if ( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("RAPPORTO"))))) {
            // * --- Select from knarapbo
            m_cServer = m_Ctx.GetServer("knarapbo");
            m_cPhName = m_Ctx.GetPhName("knarapbo");
            if (Cursor_knarapbo!=null)
              Cursor_knarapbo.Close();
            Cursor_knarapbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select FLAGRAP  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_opep_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("knarapbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_knarapbo.Eof())) {
              /* _flagrap := knarapbo->FLAGRAP */
              _flagrap = Cursor_knarapbo.GetString("FLAGRAP");
              Cursor_knarapbo.Next();
            }
            m_cConnectivityError = Cursor_knarapbo.ErrorMessage();
            Cursor_knarapbo.Close();
            // * --- End Select
          } // End If
          /* _datage := arfn_datidip_sol(qbe_opep_chkdiana->CODDIPE,qbe_opep_chkdiana->CODCAB,qbe_opep_chkdiana->DESCCIT,qbe_opep_chkdiana->PROVINCIA) */
          _datage = arfn_datidip_solR.Make(m_Ctx,this).Run(Cursor_qbe_opep_chkdiana.GetString("CODDIPE"),Cursor_qbe_opep_chkdiana.GetString("CODCAB"),Cursor_qbe_opep_chkdiana.GetString("DESCCIT"),Cursor_qbe_opep_chkdiana.GetString("PROVINCIA"));
          /* _tipoag := Right(_datage,10) */
          _tipoag = CPLib.Right(_datage,10);
          /* _note := _note + Left(_datage,44) */
          _note = _note+CPLib.Left(_datage,44);
          /* _numticket := iif(LRTrim(qbe_opep_chkdiana->RIFIMP)='XXXXXXXXX',LibreriaMit.SpacePad(LRTrim(qbe_opep_chkdiana->INFORM),30),LibreriaMit.SpacePad(LRTrim(qbe_opep_chkdiana->RIFIMP),30)) */
          _numticket = (CPLib.eqr(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("RIFIMP")),"XXXXXXXXX")?LibreriaMit.SpacePad(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("INFORM")),30):LibreriaMit.SpacePad(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("RIFIMP")),30));
          /* _note := _note + Left(DateToChar(qbe_opep_chkdiana->DATAOPE)+Space(8),8) + Left(LRTrim(qbe_opep_chkdiana->FLAGFRAZ)+" ",1) + Left(LRTrim(qbe_opep_chkdiana->FLAGCONT)+" ",1) */
          _note = _note+CPLib.Left(CPLib.DateToChar(Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"))+CPLib.Space(8),8)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("FLAGFRAZ"))+" ",1)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("FLAGCONT"))+" ",1);
          /* _note := _note + Left(LRTrim(qbe_opep_chkdiana->CODANA)+Space(4),4) + Left(LRTrim(qbe_opep_chkdiana->CODVOC)+Space(2),2) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("CODANA"))+CPLib.Space(4),4)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("CODVOC"))+CPLib.Space(2),2);
          /* _note := _note + Left(LRTrim(qbe_opep_chkdiana->TIPOINT2)+Space(2),2) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("TIPOINT2"))+CPLib.Space(2),2);
          /* _note := _note + iif(Empty(LRTrim(qbe_opep_chkdiana->CODFISCICP)),Left(LRTrim(qbe_opep_chkdiana->CODINT2)+Space(11),11),Left(LRTrim(qbe_opep_chkdiana->CODFISCICP)+Space(11),11)) */
          _note = _note+(CPLib.Empty(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("CODFISCICP")))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("CODINT2"))+CPLib.Space(11),11):CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("CODFISCICP"))+CPLib.Space(11),11));
          /* _note := _note + Left(LRTrim(qbe_opep_chkdiana->PAESE)+Space(3),3) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("PAESE"))+CPLib.Space(3),3);
          /* _note := _note + Left(LRTrim(qbe_opep_chkdiana->CODCAB2)+Space(6),6) + Left(LRTrim(qbe_opep_chkdiana->DESC2)+Space(30),30) + Left(LRTrim(qbe_opep_chkdiana->PROV2)+Space(2),2) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("CODCAB2"))+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("DESC2"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("PROV2"))+CPLib.Space(2),2);
          /* _note := _note + Left(LRTrim(qbe_opep_chkdiana->DESCINTER)+Space(50),50) + Left(LRTrim(qbe_opep_chkdiana->RAPPORTO)+Space(25),25) + Left(LRTrim(_flagrap)+" ",1) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("DESCINTER"))+CPLib.Space(50),50)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("RAPPORTO"))+CPLib.Space(25),25)+CPLib.Left(CPLib.LRTrim(_flagrap)+" ",1);
          /* _note := _note + Left(LRTrim(qbe_opep_chkdiana->TIPOLEG)+" ",1) + Left(LRTrim(DateToChar(Date()))+Space(8),8) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("TIPOLEG"))+" ",1)+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(CPLib.Date()))+CPLib.Space(8),8);
          /* _note := _note + Left(LRTrim(qbe_opep_chkdiana->TIPOOPRAP)+Space(2),2) + Left(LRTrim(qbe_opep_chkdiana->COLLEG)+Space(12),12) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("TIPOOPRAP"))+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("COLLEG"))+CPLib.Space(12),12);
          /* _note := _note + Left(LRTrim(qbe_opep_chkdiana->STATOREG)+" ",1)  */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("STATOREG"))+" ",1);
          /* If Empty(qbe_opep_chkdiana->DATARETT) or DateToChar(qbe_opep_chkdiana->DATARETT)='01000101' */
          if (CPLib.Empty(Cursor_qbe_opep_chkdiana.GetDate("DATARETT")) || CPLib.eqr(CPLib.DateToChar(Cursor_qbe_opep_chkdiana.GetDate("DATARETT")),"01000101")) {
            /* _note := _note + Space(8) */
            _note = _note+CPLib.Space(8);
          } else { // Else
            /* _note := _note + Left(LRTrim(DateToChar(qbe_opep_chkdiana->DATARETT))+Space(8),8) */
            _note = _note+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_qbe_opep_chkdiana.GetDate("DATARETT")))+CPLib.Space(8),8);
          } // End If
          /* If Left(qbe_opep_chkdiana->OPERAZMOD,1)='O' */
          if (CPLib.eqr(CPLib.Left(Cursor_qbe_opep_chkdiana.GetString("OPERAZMOD"),1),"O")) {
            /* _note := _note + iif(Empty(LRTrim(qbe_opep_chkdiana->OPERAZMOD)),Space(20),qbe_opep_chkdiana->OPERAZMOD) */
            _note = _note+(CPLib.Empty(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("OPERAZMOD")))?CPLib.Space(20):Cursor_qbe_opep_chkdiana.GetString("OPERAZMOD"));
          } else { // Else
            /* _note := _note + iif(Empty(LRTrim(qbe_opep_chkdiana->OPERAZMOD)),Space(20),Left(qbe_opep_chkdiana->OPERAZMOD,8)+"O"+Right(qbe_opep_chkdiana->OPERAZMOD,11)) */
            _note = _note+(CPLib.Empty(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("OPERAZMOD")))?CPLib.Space(20):CPLib.Left(Cursor_qbe_opep_chkdiana.GetString("OPERAZMOD"),8)+"O"+CPLib.Right(Cursor_qbe_opep_chkdiana.GetString("OPERAZMOD"),11));
          } // End If
          /* _note := _note + arfn_flaglire(qbe_opep_chkdiana->FLAGLIRE,qbe_opep_chkdiana->DATAOPE) + Left(LRTrim(qbe_opep_chkdiana->VALUTA)+Space(3),3) + Left(LRTrim(qbe_opep_chkdiana->SEGNO)+" ",1) */
          _note = _note+arfn_flaglireR.Make(m_Ctx,this).Run(Cursor_qbe_opep_chkdiana.GetString("FLAGLIRE"),Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"))+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("VALUTA"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("SEGNO"))+" ",1);
          /* _note := _note +  Right('000000000000000'+LRTrim(Str(qbe_opep_chkdiana->TOTLIRE,15,0)),15) + Right('000000000000000'+LRTrim(Str(qbe_opep_chkdiana->TOTCONT,15,0)),15) + _numticket + Space(17)+"O"+qbe_opep_chkdiana->NUMPROG+Left(LRTrim(_tipoag)+Space(10),10) */
          _note = _note+CPLib.Right("000000000000000"+CPLib.LRTrim(CPLib.Str(Cursor_qbe_opep_chkdiana.GetDouble("TOTLIRE"),15,0)),15)+CPLib.Right("000000000000000"+CPLib.LRTrim(CPLib.Str(Cursor_qbe_opep_chkdiana.GetDouble("TOTCONT"),15,0)),15)+_numticket+CPLib.Space(17)+"O"+Cursor_qbe_opep_chkdiana.GetString("NUMPROG")+CPLib.Left(CPLib.LRTrim(_tipoag)+CPLib.Space(10),10);
          /* If not(_rapcoll) */
          if ( ! (_rapcoll)) {
            /* Exec "Scrittura Dati" Page 15:Page_19 */
            Page_19();
          } else { // Else
            /* mcRighe.AppendWithKey('1') */
            mcRighe.AppendWithKey("1");
            /* mcRighe.TIPO := '1' */
            mcRighe.row.TIPO = "1";
            /* mcRighe.RIGA := _note */
            mcRighe.row.RIGA = _note;
            /* mcRighe.SaveRow() */
            mcRighe.SaveRow();
          } // End If
          /* nTotRec := nTotRec + 1 */
          nTotRec = CPLib.Round(nTotRec+1,0);
          /* nTotReg := nTotReg + 1 */
          nTotReg = CPLib.Round(nTotReg+1,0);
          /* nNumRec := nNumRec + 1 */
          nNumRec = CPLib.Round(nNumRec+1,0);
          /* If not(_rapcoll) */
          if ( ! (_rapcoll)) {
            /* If not(Empty(qbe_opep_chkdiana->CONNESCLI))  */
            if ( ! (CPLib.Empty(Cursor_qbe_opep_chkdiana.GetString("CONNESCLI")))) {
              /* _oldrap := '' */
              _oldrap = "";
              /* _codrif := qbe_opep_chkdiana->CONNESCLI */
              _codrif = Cursor_qbe_opep_chkdiana.GetString("CONNESCLI");
              /* If gFlgWU='S' and not(Empty(LRTrim(qbe_opep_chkdiana->CONNESDOC))) */
              if (CPLib.eqr(gFlgWU,"S") &&  ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("CONNESDOC"))))) {
                // * --- Select from kersonbo
                m_cServer = m_Ctx.GetServer("kersonbo");
                m_cPhName = m_Ctx.GetPhName("kersonbo");
                if (Cursor_kersonbo!=null)
                  Cursor_kersonbo.Close();
                Cursor_kersonbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CONNES="+CPLib.ToSQL(Cursor_qbe_opep_chkdiana.GetString("CONNESDOC"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("kersonbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                while ( ! (Cursor_kersonbo.Eof())) {
                  /* _ramate := iif(w_flgrae='R',LRTrim(kersonbo->RAMOGRUP),Left(LRTrim(kersonbo->ATTIV),3)) */
                  _ramate = (CPLib.eqr(w_flgrae,"R")?CPLib.LRTrim(Cursor_kersonbo.GetString("RAMOGRUP")):CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("ATTIV")),3));
                  /* If qbe_opep_chkdiana->DATAOPE > CharToDate('20131231') */
                  if (CPLib.gt(Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                    /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '7' + _idereg */
                    _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                  } else { // Else
                    /* If Empty(qbe_opep_chkdiana->CONNESOPER) or (LRTrim(Upper(qbe_opep_chkdiana->CONNESOPER))=LRTrim(Upper(qbe_opep_chkdiana->CONNESCLI))) */
                    if (CPLib.Empty(Cursor_qbe_opep_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(CPLib.LRTrim(CPLib.Upper(Cursor_qbe_opep_chkdiana.GetString("CONNESOPER"))),CPLib.LRTrim(CPLib.Upper(Cursor_qbe_opep_chkdiana.GetString("CONNESCLI")))))) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                    } else { // Else
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                    } // End If
                  } // End If
                  /* _note := _note + Left(LRTrim(qbe_opep_chkdiana->CONNESCLI)+Space(16),16) + Left(LRTrim(kersonbo->RAGSOC)+Space(70),70) + Left(LRTrim(kersonbo->PAESE)+Space(3),3) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("CONNESCLI"))+CPLib.Space(16),16)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("RAGSOC"))+CPLib.Space(70),70)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("PAESE"))+CPLib.Space(3),3);
                  /* _note := _note + Left(LRTrim(kersonbo->CODCAB)+Space(6),6) + Left(LRTrim(kersonbo->DESCCIT)+Space(30),30) + Left(LRTrim(kersonbo->PROVINCIA)+Space(2),2) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("CODCAB"))+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("DESCCIT"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("PROVINCIA"))+CPLib.Space(2),2);
                  /* _note := _note + Left(LRTrim(kersonbo->DOMICILIO)+Space(35),35) + Left(LRTrim(kersonbo->CAP)+ Space(5),5) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("DOMICILIO"))+CPLib.Space(35),35)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("CAP"))+CPLib.Space(5),5);
                  /* _note := _note + iif(kersonbo->CFESTERO=1,Space(16),Left(LRTrim(kersonbo->CODFISC)+Space(16),16)) */
                  _note = _note+(CPLib.eqr(Cursor_kersonbo.GetDouble("CFESTERO"),1)?CPLib.Space(16):CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("CODFISC"))+CPLib.Space(16),16));
                  /* If Empty(kersonbo->DATANASC) or DateToChar(kersonbo->DATANASC)='01000101' */
                  if (CPLib.Empty(Cursor_kersonbo.GetDate("DATANASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_kersonbo.GetDate("DATANASC")),"01000101")) {
                    /* _note := _note + Space(8) */
                    _note = _note+CPLib.Space(8);
                  } else { // Else
                    /* _note := _note + Left(LRTrim(DateToChar(kersonbo->DATANASC))+Space(8),8) */
                    _note = _note+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_kersonbo.GetDate("DATANASC")))+CPLib.Space(8),8);
                  } // End If
                  /* If not(Empty(kersonbo->NASSTATO)) */
                  if ( ! (CPLib.Empty(Cursor_kersonbo.GetString("NASSTATO")))) {
                    /* _note := _note + Left(LRTrim(kersonbo->NASSTATO)+Space(30),30) + Left(LRTrim(kersonbo->SOTGRUP)+Space(3),3) + Left(LRTrim(_ramate)+Space(3),3) */
                    _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("NASSTATO"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("SOTGRUP"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(_ramate)+CPLib.Space(3),3);
                  } else { // Else
                    /* _note := _note + Left(LRTrim(kersonbo->NASCOMUN)+Space(30),30) + Left(LRTrim(kersonbo->SOTGRUP)+Space(3),3) + Left(LRTrim(_ramate) +Space(3),3) */
                    _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("NASCOMUN"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("SOTGRUP"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(_ramate)+CPLib.Space(3),3);
                  } // End If
                  /* _note := _note + Left(LRTrim(kersonbo->SETTSINT)+Space(3),3) + Left(LRTrim(qbe_opep_chkdiana->RAPPORTO)+Space(25),25) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("SETTSINT"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("RAPPORTO"))+CPLib.Space(25),25);
                  /* _note := _note + Left(LRTrim(qbe_opep_chkdiana->FLAGRAP)+" ",1) + Left(LRTrim(kersonbo->TIPODOC)+Space(2),2) + Left(LRTrim(kersonbo->NUMDOCUM)+Space(15),15) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("FLAGRAP"))+" ",1)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("TIPODOC"))+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("NUMDOCUM"))+CPLib.Space(15),15);
                  /* If Empty(kersonbo->DATARILASC) or DateToChar(kersonbo->DATARILASC)='01000101' */
                  if (CPLib.Empty(Cursor_kersonbo.GetDate("DATARILASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_kersonbo.GetDate("DATARILASC")),"01000101")) {
                    /* _note := _note + Space(8) */
                    _note = _note+CPLib.Space(8);
                  } else { // Else
                    /* _note := _note + Left(LRTrim(DateToChar(kersonbo->DATARILASC))+Space(8),8)  */
                    _note = _note+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_kersonbo.GetDate("DATARILASC")))+CPLib.Space(8),8);
                  } // End If
                  /* _note := _note + Left(LRTrim(kersonbo->AUTRILASC)+Space(30),30) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("AUTRILASC"))+CPLib.Space(30),30);
                  /* _note := _note + Left(LRTrim(kersonbo->SESSO)+" ",1) + Space(34) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("SESSO"))+" ",1)+CPLib.Space(34);
                  /* Exec "Scrittura Dati" Page 15:Page_19 */
                  Page_19();
                  /* nTotRec := nTotRec + 1 */
                  nTotRec = CPLib.Round(nTotRec+1,0);
                  /* nNumRec := nNumRec + 1 */
                  nNumRec = CPLib.Round(nNumRec+1,0);
                  Cursor_kersonbo.Next();
                }
                m_cConnectivityError = Cursor_kersonbo.ErrorMessage();
                Cursor_kersonbo.Close();
                // * --- End Select
              } else { // Else
                /* If qbe_opep_chkdiana->DATAOPE > CharToDate('20131231') */
                if (CPLib.gt(Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '7' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                  /* pTipoR := '7' // Tipo Riga */
                  pTipoR = "7";
                } else { // Else
                  /* If Empty(qbe_opep_chkdiana->CONNESOPER) or (LRTrim(Upper(qbe_opep_chkdiana->CONNESOPER))=LRTrim(Upper(qbe_opep_chkdiana->CONNESCLI))) */
                  if (CPLib.Empty(Cursor_qbe_opep_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(CPLib.LRTrim(CPLib.Upper(Cursor_qbe_opep_chkdiana.GetString("CONNESOPER"))),CPLib.LRTrim(CPLib.Upper(Cursor_qbe_opep_chkdiana.GetString("CONNESCLI")))))) {
                    /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                    _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                    /* pTipoR := '2' // Tipo Riga */
                    pTipoR = "2";
                  } else { // Else
                    /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                    _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                    /* pTipoR := '3' // Tipo Riga */
                    pTipoR = "3";
                  } // End If
                } // End If
                /* pCli := qbe_opep_chkdiana->CONNESCLI // Codice Soggetto */
                pCli = Cursor_qbe_opep_chkdiana.GetString("CONNESCLI");
                /* pDatOpe := iif(w_stoper='R',qbe_opep_chkdiana->DATAREG,qbe_opep_chkdiana->DATAOPE) // Data Operazione */
                pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_opep_chkdiana.GetDate("DATAREG"):Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"));
                /* pRap := qbe_opep_chkdiana->RAPPORTO // Codice Rapporto */
                pRap = Cursor_qbe_opep_chkdiana.GetString("RAPPORTO");
                /* pTRap := qbe_opep_chkdiana->FLAGRAP // Tipo Rapporto */
                pTRap = Cursor_qbe_opep_chkdiana.GetString("FLAGRAP");
                /* pRAE := _raeatc // RAE o ATECO */
                pRAE = _raeatc;
                /* pSTATO := qbe_opep_chkdiana->STATOREG // Stato Registrazione */
                pSTATO = Cursor_qbe_opep_chkdiana.GetString("STATOREG");
                /* pDatRet := qbe_opep_chkdiana->DATARETT // Data Rettifica */
                pDatRet = Cursor_qbe_opep_chkdiana.GetDate("DATARETT");
                /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                DatiSoggetto();
                /* Exec "Scrittura Dati" Page 15:Page_19 */
                Page_19();
                /* nTotRec := nTotRec + 1 */
                nTotRec = CPLib.Round(nTotRec+1,0);
                /* nNumRec := nNumRec + 1 */
                nNumRec = CPLib.Round(nNumRec+1,0);
              } // End If
            } // End If
            /* If not(Empty(qbe_opep_chkdiana->RAPPORTO)) */
            if ( ! (CPLib.Empty(Cursor_qbe_opep_chkdiana.GetString("RAPPORTO")))) {
              /* _oldrap := '' */
              _oldrap = "";
              // * --- Read from knarapbo
              m_cServer = m_Ctx.GetServer("knarapbo");
              m_cPhName = m_Ctx.GetPhName("knarapbo");
              m_cSql = "";
              m_cSql = m_cSql+"RAPPORTO="+CPSql.SQLValueAdapter(CPLib.ToSQL(Cursor_qbe_opep_chkdiana.GetString("RAPPORTO"),"C",25,0,m_cServer),m_cServer,Cursor_qbe_opep_chkdiana.GetString("RAPPORTO"));
              if (m_Ctx.IsSharedTemp("knarapbo")) {
                m_cSql = m_cSql+" and context_id='"+m_Ctx.GetTempID()+"'";
              }
              if (Read_Cursor!=null)
                Read_Cursor.Close();
              Read_Cursor = m_Sql.Query(m_cServer,"select "+CPLib.GetMultilanguageField("RAPPORTO",m_Ctx,m_cServer)+" from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+m_cSql);
              if ( ! (Read_Cursor.Eof())) {
                _oldrap = Read_Cursor.GetString("RAPPORTO");
                Read_Cursor.Next();
                if ( ! (Read_Cursor.Eof())) {
                  Error l_oErrorFault = new Error("Read on knarapbo into routine arrt_chkdiana_all returns two or more records. This item should return only a record.");
                  CPStdCounter.Error(l_oErrorFault);
                }
                Read_Cursor.Close();
              } else {
                // Error: no record found!
                _oldrap = "";
                Read_Cursor.Close();
                m_cLastMsgError = "MSG_RECORD_NOT_FOUND";
              }
              /* If not(Empty(_oldrap)) */
              if ( ! (CPLib.Empty(_oldrap))) {
                // * --- Select from knarapbo
                m_cServer = m_Ctx.GetServer("knarapbo");
                m_cPhName = m_Ctx.GetPhName("knarapbo");
                if (Cursor_knarapbo!=null)
                  Cursor_knarapbo.Close();
                Cursor_knarapbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_opep_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("knarapbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                while ( ! (Cursor_knarapbo.Eof())) {
                  /* If knarapbo->TIPORAP='P' */
                  if (CPLib.eqr(Cursor_knarapbo.GetString("TIPORAP"),"P")) {
                    // * --- Select from xntestbo
                    m_cServer = m_Ctx.GetServer("xntestbo");
                    m_cPhName = m_Ctx.GetPhName("xntestbo");
                    if (Cursor_xntestbo!=null)
                      Cursor_xntestbo.Close();
                    Cursor_xntestbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_opep_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xntestbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                    while ( ! (Cursor_xntestbo.Eof())) {
                      /* If qbe_opep_chkdiana->RAPPORTO = xntestbo->RAPPORTO */
                      if (CPLib.eqr(Cursor_qbe_opep_chkdiana.GetString("RAPPORTO"),Cursor_xntestbo.GetString("RAPPORTO"))) {
                        /* _avanza := 0 */
                        _avanza = CPLib.Round(0,0);
                        /* If Empty(xntestbo->CODINTER) or xntestbo->STATOREG='2' or xntestbo->STATOREG='3' */
                        if (CPLib.Empty(Cursor_xntestbo.GetString("CODINTER")) || CPLib.eqr(Cursor_xntestbo.GetString("STATOREG"),"2") || CPLib.eqr(Cursor_xntestbo.GetString("STATOREG"),"3")) {
                          /* _avanza := 1 */
                          _avanza = CPLib.Round(1,0);
                        } // End If
                        /* If xntestbo->DATAINI > qbe_opep_chkdiana->DATAOPE */
                        if (CPLib.gt(Cursor_xntestbo.GetDate("DATAINI"),Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"))) {
                          /* _avanza := 1 */
                          _avanza = CPLib.Round(1,0);
                        } // End If
                        /* If not(Empty(xntestbo->DATAFINE)) and xntestbo->DATAFINE < qbe_opep_chkdiana->DATAOPE */
                        if ( ! (CPLib.Empty(Cursor_xntestbo.GetDate("DATAFINE"))) && CPLib.lt(Cursor_xntestbo.GetDate("DATAFINE"),Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"))) {
                          /* _avanza := 1 */
                          _avanza = CPLib.Round(1,0);
                        } // End If
                        /* If LRTrim(Upper(xntestbo->CODINTER))=LRTrim(Upper(qbe_opep_chkdiana->CONNESCLI)) */
                        if (CPLib.eqr(CPLib.LRTrim(CPLib.Upper(Cursor_xntestbo.GetString("CODINTER"))),CPLib.LRTrim(CPLib.Upper(Cursor_qbe_opep_chkdiana.GetString("CONNESCLI"))))) {
                          /* _avanza := 1 */
                          _avanza = CPLib.Round(1,0);
                        } // End If
                        /* If _avanza = 0 */
                        if (CPLib.eqr(_avanza,0)) {
                          /* _codrif := xntestbo->CODINTER */
                          _codrif = Cursor_xntestbo.GetString("CODINTER");
                          /* If qbe_opep_chkdiana->DATAOPE > CharToDate('20131231') */
                          if (CPLib.gt(Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                            /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '7' + _idereg */
                            _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                            /* pTipoR := '7' // Tipo Riga */
                            pTipoR = "7";
                          } else { // Else
                            /* If Empty(qbe_opep_chkdiana->CONNESOPER) or (qbe_opep_chkdiana->CONNESOPER=xntestbo->CODINTER) */
                            if (CPLib.Empty(Cursor_qbe_opep_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(Cursor_qbe_opep_chkdiana.GetString("CONNESOPER"),Cursor_xntestbo.GetString("CODINTER")))) {
                              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                              /* pTipoR := '2' // Tipo Riga */
                              pTipoR = "2";
                            } else { // Else
                              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                              /* pTipoR := '3' // Tipo Riga */
                              pTipoR = "3";
                            } // End If
                          } // End If
                          /* pCli := xntestbo->CODINTER // Codice Soggetto */
                          pCli = Cursor_xntestbo.GetString("CODINTER");
                          /* pDatOpe := iif(w_stoper='R',qbe_opep_chkdiana->DATAREG,qbe_opep_chkdiana->DATAOPE) // Data Operazione */
                          pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_opep_chkdiana.GetDate("DATAREG"):Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"));
                          /* pRap := qbe_opep_chkdiana->RAPPORTO // Codice Rapporto */
                          pRap = Cursor_qbe_opep_chkdiana.GetString("RAPPORTO");
                          /* pTRap := qbe_opep_chkdiana->FLAGRAP // Tipo Rapporto */
                          pTRap = Cursor_qbe_opep_chkdiana.GetString("FLAGRAP");
                          /* pRAE := _raeatc // RAE o ATECO */
                          pRAE = _raeatc;
                          /* pSTATO := qbe_opep_chkdiana->STATOREG // Stato Registrazione */
                          pSTATO = Cursor_qbe_opep_chkdiana.GetString("STATOREG");
                          /* pDatRet := qbe_opep_chkdiana->DATARETT // Data Rettifica */
                          pDatRet = Cursor_qbe_opep_chkdiana.GetDate("DATARETT");
                          /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                          DatiSoggetto();
                          /* Exec "Scrittura Dati" Page 15:Page_19 */
                          Page_19();
                          /* nTotRec := nTotRec + 1 */
                          nTotRec = CPLib.Round(nTotRec+1,0);
                          /* nNumRec := nNumRec + 1 */
                          nNumRec = CPLib.Round(nNumRec+1,0);
                        } // End If
                      } // End If
                      Cursor_xntestbo.Next();
                    }
                    m_cConnectivityError = Cursor_xntestbo.ErrorMessage();
                    Cursor_xntestbo.Close();
                    // * --- End Select
                  } else { // Else
                    // * --- Select from intestbo
                    m_cServer = m_Ctx.GetServer("intestbo");
                    m_cPhName = m_Ctx.GetPhName("intestbo");
                    if (Cursor_intestbo!=null)
                      Cursor_intestbo.Close();
                    Cursor_intestbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_opep_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("intestbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                    while ( ! (Cursor_intestbo.Eof())) {
                      /* If qbe_opep_chkdiana->RAPPORTO = intestbo->RAPPORTO */
                      if (CPLib.eqr(Cursor_qbe_opep_chkdiana.GetString("RAPPORTO"),Cursor_intestbo.GetString("RAPPORTO"))) {
                        /* _avanza := 0 */
                        _avanza = CPLib.Round(0,0);
                        /* If Empty(intestbo->CODINTER) or intestbo->STATOREG='2' or intestbo->STATOREG='3' */
                        if (CPLib.Empty(Cursor_intestbo.GetString("CODINTER")) || CPLib.eqr(Cursor_intestbo.GetString("STATOREG"),"2") || CPLib.eqr(Cursor_intestbo.GetString("STATOREG"),"3")) {
                          /* _avanza := 1 */
                          _avanza = CPLib.Round(1,0);
                        } // End If
                        /* If intestbo->DATAINI > qbe_opep_chkdiana->DATAOPE */
                        if (CPLib.gt(Cursor_intestbo.GetDate("DATAINI"),Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"))) {
                          /* _avanza := 1 */
                          _avanza = CPLib.Round(1,0);
                        } // End If
                        /* If not(Empty(intestbo->DATAFINE)) and intestbo->DATAFINE < qbe_opep_chkdiana->DATAOPE */
                        if ( ! (CPLib.Empty(Cursor_intestbo.GetDate("DATAFINE"))) && CPLib.lt(Cursor_intestbo.GetDate("DATAFINE"),Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"))) {
                          /* _avanza := 1 */
                          _avanza = CPLib.Round(1,0);
                        } // End If
                        /* If LRTrim(Upper(intestbo->CODINTER))=LRTrim(Upper(qbe_opep_chkdiana->CONNESCLI)) */
                        if (CPLib.eqr(CPLib.LRTrim(CPLib.Upper(Cursor_intestbo.GetString("CODINTER"))),CPLib.LRTrim(CPLib.Upper(Cursor_qbe_opep_chkdiana.GetString("CONNESCLI"))))) {
                          /* _avanza := 1 */
                          _avanza = CPLib.Round(1,0);
                        } // End If
                        /* If _avanza = 0 */
                        if (CPLib.eqr(_avanza,0)) {
                          /* _codrif := intestbo->CODINTER */
                          _codrif = Cursor_intestbo.GetString("CODINTER");
                          /* If qbe_opep_chkdiana->DATAOPE > CharToDate('20131231') */
                          if (CPLib.gt(Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                            /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '7' + _idereg */
                            _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                            /* pTipoR := '7' // Tipo Riga */
                            pTipoR = "7";
                          } else { // Else
                            /* If Empty(qbe_opep_chkdiana->CONNESOPER) or (qbe_opep_chkdiana->CONNESOPER=intestbo->CODINTER) */
                            if (CPLib.Empty(Cursor_qbe_opep_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(Cursor_qbe_opep_chkdiana.GetString("CONNESOPER"),Cursor_intestbo.GetString("CODINTER")))) {
                              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                              /* pTipoR := '2' // Tipo Riga */
                              pTipoR = "2";
                            } else { // Else
                              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                              /* pTipoR := '3' // Tipo Riga */
                              pTipoR = "3";
                            } // End If
                          } // End If
                          /* pCli := intestbo->CODINTER // Codice Soggetto */
                          pCli = Cursor_intestbo.GetString("CODINTER");
                          /* pDatOpe := iif(w_stoper='R',qbe_opep_chkdiana->DATAREG,qbe_opep_chkdiana->DATAOPE) // Data Operazione */
                          pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_opep_chkdiana.GetDate("DATAREG"):Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"));
                          /* pRap := qbe_opep_chkdiana->RAPPORTO // Codice Rapporto */
                          pRap = Cursor_qbe_opep_chkdiana.GetString("RAPPORTO");
                          /* pTRap := qbe_opep_chkdiana->FLAGRAP // Tipo Rapporto */
                          pTRap = Cursor_qbe_opep_chkdiana.GetString("FLAGRAP");
                          /* pRAE := _raeatc // RAE o ATECO */
                          pRAE = _raeatc;
                          /* pSTATO := qbe_opep_chkdiana->STATOREG // Stato Registrazione */
                          pSTATO = Cursor_qbe_opep_chkdiana.GetString("STATOREG");
                          /* pDatRet := qbe_opep_chkdiana->DATARETT // Data Rettifica */
                          pDatRet = Cursor_qbe_opep_chkdiana.GetDate("DATARETT");
                          /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                          DatiSoggetto();
                          /* Exec "Scrittura Dati" Page 15:Page_19 */
                          Page_19();
                          /* nTotRec := nTotRec + 1 */
                          nTotRec = CPLib.Round(nTotRec+1,0);
                          /* nNumRec := nNumRec + 1 */
                          nNumRec = CPLib.Round(nNumRec+1,0);
                        } // End If
                      } // End If
                      Cursor_intestbo.Next();
                    }
                    m_cConnectivityError = Cursor_intestbo.ErrorMessage();
                    Cursor_intestbo.Close();
                    // * --- End Select
                  } // End If
                  Cursor_knarapbo.Next();
                }
                m_cConnectivityError = Cursor_knarapbo.ErrorMessage();
                Cursor_knarapbo.Close();
                // * --- End Select
              } // End If
            } // End If
            /* If Empty(LRTrim(_oldrap)) and _xlientiope */
            if (CPLib.Empty(CPLib.LRTrim(_oldrap)) && _xlientiope) {
              /* _oldrighe := 0 */
              _oldrighe = CPLib.Round(0,0);
              // * --- Select from xlientiope
              m_cServer = m_Ctx.GetServer("xlientiope");
              m_cPhName = m_Ctx.GetPhName("xlientiope");
              if (Cursor_xlientiope!=null)
                Cursor_xlientiope.Close();
              Cursor_xlientiope = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_opep_chkdiana.GetString("IDBASE"),"?",0,0)+"  and  CODSOG <> "+CPLib.ToSQL(Cursor_qbe_opep_chkdiana.GetString("CONNESCLI"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xlientiope")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
              while ( ! (Cursor_xlientiope.Eof())) {
                /* _rownum := 0 */
                _rownum = CPLib.Round(0,0);
                // * --- Read from intestbo
                m_cServer = m_Ctx.GetServer("intestbo");
                m_cPhName = m_Ctx.GetPhName("intestbo");
                m_cSql = "";
                m_cSql = m_cSql+"RAPPORTO="+CPSql.SQLValueAdapter(CPLib.ToSQL(Cursor_qbe_opep_chkdiana.GetString("RAPPORTO"),"C",25,0,m_cServer),m_cServer,Cursor_qbe_opep_chkdiana.GetString("RAPPORTO"));
                m_cSql = m_cSql+" and CODINTER="+CPSql.SQLValueAdapter(CPLib.ToSQL(Cursor_xlientiope.GetString("CODSOG"),"C",16,0,m_cServer),m_cServer,Cursor_xlientiope.GetString("CODSOG"));
                if (m_Ctx.IsSharedTemp("intestbo")) {
                  m_cSql = m_cSql+" and context_id='"+m_Ctx.GetTempID()+"'";
                }
                if (Read_Cursor!=null)
                  Read_Cursor.Close();
                Read_Cursor = m_Sql.Query(m_cServer,"select "+CPLib.GetMultilanguageField("CPROWNUM",m_Ctx,m_cServer)+" from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+m_cSql);
                if ( ! (Read_Cursor.Eof())) {
                  _rownum = CPLib.Round(Read_Cursor.GetDouble("CPROWNUM"),0);
                  Read_Cursor.Next();
                  if ( ! (Read_Cursor.Eof())) {
                    Error l_oErrorFault = new Error("Read on intestbo into routine arrt_chkdiana_all returns two or more records. This item should return only a record.");
                    CPStdCounter.Error(l_oErrorFault);
                  }
                  Read_Cursor.Close();
                } else {
                  // Error: no record found!
                  _rownum = 0;
                  Read_Cursor.Close();
                  m_cLastMsgError = "MSG_RECORD_NOT_FOUND";
                }
                /* If _rownum = 0 */
                if (CPLib.eqr(_rownum,0)) {
                  /* If qbe_opep_chkdiana->DATAOPE > CharToDate('20131231') */
                  if (CPLib.gt(Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                    /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '7' + _idereg */
                    _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                    /* pTipoR := '7' // Tipo Riga */
                    pTipoR = "7";
                  } else { // Else
                    /* If Empty(qbe_opep_chkdiana->CONNESOPER) or (qbe_opep_chkdiana->CONNESOPER=xlientiope->CODSOG) */
                    if (CPLib.Empty(Cursor_qbe_opep_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(Cursor_qbe_opep_chkdiana.GetString("CONNESOPER"),Cursor_xlientiope.GetString("CODSOG")))) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                      /* pTipoR := '2' // Tipo Riga */
                      pTipoR = "2";
                    } else { // Else
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                      /* pTipoR := '3' // Tipo Riga */
                      pTipoR = "3";
                    } // End If
                  } // End If
                  /* pCli := xlientiope->CODSOG // Codice Soggetto */
                  pCli = Cursor_xlientiope.GetString("CODSOG");
                  /* pDatOpe := iif(w_stoper='R',qbe_opep_chkdiana->DATAREG,qbe_opep_chkdiana->DATAOPE) // Data Operazione */
                  pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_opep_chkdiana.GetDate("DATAREG"):Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"));
                  /* pRap := qbe_opep_chkdiana->RAPPORTO // Codice Rapporto */
                  pRap = Cursor_qbe_opep_chkdiana.GetString("RAPPORTO");
                  /* pTRap := qbe_opep_chkdiana->FLAGRAP // Tipo Rapporto */
                  pTRap = Cursor_qbe_opep_chkdiana.GetString("FLAGRAP");
                  /* pRAE := _raeatc // RAE o ATECO */
                  pRAE = _raeatc;
                  /* pSTATO := qbe_opep_chkdiana->STATOREG // Stato Registrazione */
                  pSTATO = Cursor_qbe_opep_chkdiana.GetString("STATOREG");
                  /* pDatRet := qbe_opep_chkdiana->DATARETT // Data Rettifica */
                  pDatRet = Cursor_qbe_opep_chkdiana.GetDate("DATARETT");
                  /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                  DatiSoggetto();
                  /* Exec "Scrittura Dati" Page 15:Page_19 */
                  Page_19();
                  /* nTotRec := nTotRec + 1 */
                  nTotRec = CPLib.Round(nTotRec+1,0);
                  /* nNumRec := nNumRec + 1 */
                  nNumRec = CPLib.Round(nNumRec+1,0);
                } // End If
                Cursor_xlientiope.Next();
              }
              m_cConnectivityError = Cursor_xlientiope.ErrorMessage();
              Cursor_xlientiope.Close();
              // * --- End Select
            } // End If
          } // End If
          /* If not(Empty(qbe_opep_chkdiana->CONNESOPER)) and qbe_opep_chkdiana->CONNESOPER <> _codrif */
          if ( ! (CPLib.Empty(Cursor_qbe_opep_chkdiana.GetString("CONNESOPER"))) && CPLib.ne(Cursor_qbe_opep_chkdiana.GetString("CONNESOPER"),_codrif)) {
            /* If qbe_opep_chkdiana->DATAOPE > CharToDate('20131231') */
            if (CPLib.gt(Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '8' + _idereg */
              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"8"+_idereg;
              /* pTipoR := '8' // Tipo Riga */
              pTipoR = "8";
            } else { // Else
              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '4' +_idereg */
              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"4"+_idereg;
              /* pTipoR := '4' */
              pTipoR = "4";
            } // End If
            /* pCli := qbe_opep_chkdiana->CONNESOPER // Codice Soggetto */
            pCli = Cursor_qbe_opep_chkdiana.GetString("CONNESOPER");
            /* pDatOpe := iif(w_stoper='R',qbe_opep_chkdiana->DATAREG,qbe_opep_chkdiana->DATAOPE) // Data Operazione */
            pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_opep_chkdiana.GetDate("DATAREG"):Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"));
            /* pRap := qbe_opep_chkdiana->RAPPORTO // Codice Rapporto */
            pRap = Cursor_qbe_opep_chkdiana.GetString("RAPPORTO");
            /* pTRap := qbe_opep_chkdiana->FLAGRAP // Tipo Rapporto */
            pTRap = Cursor_qbe_opep_chkdiana.GetString("FLAGRAP");
            /* pRAE := _raeatc // RAE o ATECO */
            pRAE = _raeatc;
            /* pSTATO := qbe_opep_chkdiana->STATOREG // Stato Registrazione */
            pSTATO = Cursor_qbe_opep_chkdiana.GetString("STATOREG");
            /* pDatRet := qbe_opep_chkdiana->DATARETT // Data Rettifica */
            pDatRet = Cursor_qbe_opep_chkdiana.GetDate("DATARETT");
            /* _oldmc := _usemc */
            _oldmc = CPLib.Round(_usemc,0);
            /* _usemc := 0 */
            _usemc = CPLib.Round(0,0);
            /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
            DatiSoggetto();
            /* _usemc := _oldmc */
            _usemc = CPLib.Round(_oldmc,0);
            /* If not(_rapcoll) */
            if ( ! (_rapcoll)) {
              /* Exec "Scrittura Dati" Page 15:Page_19 */
              Page_19();
            } else { // Else
              /* mcRighe.AppendWithKey(pTipoR) */
              mcRighe.AppendWithKey(pTipoR);
              /* mcRighe.TIPO := pTipoR */
              mcRighe.row.TIPO = pTipoR;
              /* mcRighe.RIGA := _note */
              mcRighe.row.RIGA = _note;
              /* mcRighe.SaveRow() */
              mcRighe.SaveRow();
            } // End If
            /* nTotRec := nTotRec + 1 */
            nTotRec = CPLib.Round(nTotRec+1,0);
            /* nNumRec := nNumRec + 1 */
            nNumRec = CPLib.Round(nNumRec+1,0);
          } // End If
          /* If _xogopebo */
          if (_xogopebo) {
            // * --- Select from xogopebo
            m_cServer = m_Ctx.GetServer("xogopebo");
            m_cPhName = m_Ctx.GetPhName("xogopebo");
            if (Cursor_xogopebo!=null)
              Cursor_xogopebo.Close();
            Cursor_xogopebo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_opep_chkdiana.GetString("IDBASE"),"?",0,0)+"  and  CODSOG <> "+CPLib.ToSQL(Cursor_qbe_opep_chkdiana.GetString("CONNESOPER"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xogopebo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_xogopebo.Eof())) {
              /* If qbe_opep_chkdiana->DATAOPE > CharToDate('20131231') */
              if (CPLib.gt(Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '8' + _idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"8"+_idereg;
                /* pTipoR := '8' // Tipo Riga */
                pTipoR = "8";
              } else { // Else
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '4' + _idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"4"+_idereg;
                /* pTipoR := '4' // Tipo Riga */
                pTipoR = "4";
              } // End If
              /* pCli := xogopebo->CODSOG // Codice Soggetto */
              pCli = Cursor_xogopebo.GetString("CODSOG");
              /* pDatOpe := iif(w_stoper='R',qbe_opep_chkdiana->DATAREG,qbe_opep_chkdiana->DATAOPE) // Data Operazione */
              pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_opep_chkdiana.GetDate("DATAREG"):Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"));
              /* pRap := qbe_opep_chkdiana->RAPPORTO // Codice Rapporto */
              pRap = Cursor_qbe_opep_chkdiana.GetString("RAPPORTO");
              /* pTRap := qbe_opep_chkdiana->FLAGRAP // Tipo Rapporto */
              pTRap = Cursor_qbe_opep_chkdiana.GetString("FLAGRAP");
              /* pRAE := _raeatc // RAE o ATECO */
              pRAE = _raeatc;
              /* pSTATO := qbe_opep_chkdiana->STATOREG // Stato Registrazione */
              pSTATO = Cursor_qbe_opep_chkdiana.GetString("STATOREG");
              /* pDatRet := qbe_opep_chkdiana->DATARETT // Data Rettifica */
              pDatRet = Cursor_qbe_opep_chkdiana.GetDate("DATARETT");
              /* _oldmc := _usemc */
              _oldmc = CPLib.Round(_usemc,0);
              /* _usemc := 0 */
              _usemc = CPLib.Round(0,0);
              /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
              DatiSoggetto();
              /* _usemc := _oldmc */
              _usemc = CPLib.Round(_oldmc,0);
              /* If not(_rapcoll) */
              if ( ! (_rapcoll)) {
                /* Exec "Scrittura Dati" Page 15:Page_19 */
                Page_19();
              } else { // Else
                /* mcRighe.AppendWithKey(pTipoR) */
                mcRighe.AppendWithKey(pTipoR);
                /* mcRighe.TIPO := pTipoR */
                mcRighe.row.TIPO = pTipoR;
                /* mcRighe.RIGA := _note */
                mcRighe.row.RIGA = _note;
                /* mcRighe.SaveRow() */
                mcRighe.SaveRow();
              } // End If
              /* nTotRec := nTotRec + 1 */
              nTotRec = CPLib.Round(nTotRec+1,0);
              /* nNumRec := nNumRec + 1 */
              nNumRec = CPLib.Round(nNumRec+1,0);
              Cursor_xogopebo.Next();
            }
            m_cConnectivityError = Cursor_xogopebo.ErrorMessage();
            Cursor_xogopebo.Close();
            // * --- End Select
          } // End If
          /* If not(Empty(qbe_opep_chkdiana->CONNESBEN)) or not(Empty(qbe_opep_chkdiana->C_RAG)) */
          if ( ! (CPLib.Empty(Cursor_qbe_opep_chkdiana.GetString("CONNESBEN"))) ||  ! (CPLib.Empty(Cursor_qbe_opep_chkdiana.GetString("C_RAG")))) {
            /* If not(Empty(qbe_opep_chkdiana->C_RAG)) */
            if ( ! (CPLib.Empty(Cursor_qbe_opep_chkdiana.GetString("C_RAG")))) {
              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
              /* _note := _note + Left(LRTrim(qbe_opep_chkdiana->CONNESBEN)+Space(16),16) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("CONNESBEN"))+CPLib.Space(16),16);
              /* _note := _note +Left(LRTrim(qbe_opep_chkdiana->C_RAG)+Space(70),70) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_RAG"))+CPLib.Space(70),70);
              /* _note := _note + Left(LRTrim(qbe_opep_chkdiana->C_STA)+Space(3),3) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_STA"))+CPLib.Space(3),3);
              /* _note := _note +Left(LRTrim(qbe_opep_chkdiana->C_CAB)+Space(6),6) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_CAB"))+CPLib.Space(6),6);
              /* _note := _note +Left(LRTrim(qbe_opep_chkdiana->C_CTA)+Space(30),30) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_CTA"))+CPLib.Space(30),30);
              /* _note := _note + Left(LRTrim(qbe_opep_chkdiana->C_PRV)+Space(2),2) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_PRV"))+CPLib.Space(2),2);
              /* _note := _note + Left(LRTrim(qbe_opep_chkdiana->C_IND)+Space(35),35) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_IND"))+CPLib.Space(35),35);
              /* _note := _note + Left(LRTrim(qbe_opep_chkdiana->C_CAP)+Space(5),5) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_CAP"))+CPLib.Space(5),5);
              /* _note := _note + Space(63) */
              _note = _note+CPLib.Space(63);
              /* _note := _note + Left(LRTrim(qbe_opep_chkdiana->C_RAPPORTO)+Space(25),25) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_RAPPORTO"))+CPLib.Space(25),25);
              /* _note := _note + Space(91) */
              _note = _note+CPLib.Space(91);
              /* If not(_rapcoll) */
              if ( ! (_rapcoll)) {
                /* Exec "Scrittura Dati" Page 15:Page_19 */
                Page_19();
              } else { // Else
                /* mcRighe.AppendWithKey('5') */
                mcRighe.AppendWithKey("5");
                /* mcRighe.TIPO := '5' */
                mcRighe.row.TIPO = "5";
                /* mcRighe.RIGA := _note */
                mcRighe.row.RIGA = _note;
                /* mcRighe.SaveRow() */
                mcRighe.SaveRow();
              } // End If
              /* nTotRec := nTotRec + 1 */
              nTotRec = CPLib.Round(nTotRec+1,0);
              /* nNumRec := nNumRec + 1 */
              nNumRec = CPLib.Round(nNumRec+1,0);
              /* ElseIf not(Empty(qbe_opep_chkdiana->CONNESBEN)) */
            } else if ( ! (CPLib.Empty(Cursor_qbe_opep_chkdiana.GetString("CONNESBEN")))) {
              /* _numsto := arfn_chkspers(qbe_opep_chkdiana->CONNESBEN,iif(w_stoper='R',Date(),qbe_opep_chkdiana->DATAOPE)) */
              _numsto = arfn_chkspersR.Make(m_Ctx,this).Run(Cursor_qbe_opep_chkdiana.GetString("CONNESBEN"),(CPLib.eqr(w_stoper,"R")?CPLib.Date():Cursor_qbe_opep_chkdiana.GetDate("DATAOPE")));
              /* If Empty(LRTrim(_numsto)) */
              if (CPLib.Empty(CPLib.LRTrim(_numsto))) {
                // * --- Select from personbo
                m_cServer = m_Ctx.GetServer("personbo");
                m_cPhName = m_Ctx.GetPhName("personbo");
                if (Cursor_personbo!=null)
                  Cursor_personbo.Close();
                Cursor_personbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CONNES="+CPLib.ToSQL(Cursor_qbe_opep_chkdiana.GetString("CONNESBEN"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("personbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                while ( ! (Cursor_personbo.Eof())) {
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
                  /* _note := _note + Left(LRTrim(qbe_opep_chkdiana->CONNESBEN)+Space(16),16) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("CONNESBEN"))+CPLib.Space(16),16);
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_opep_chkdiana->C_RAG))),Left(LRTrim(qbe_opep_chkdiana->C_RAG)+Space(70),70),Left(LRTrim(personbo->RAGSOC)+Space(70),70)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_RAG"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_RAG"))+CPLib.Space(70),70):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("RAGSOC"))+CPLib.Space(70),70));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_opep_chkdiana->C_STA))),Left(LRTrim(qbe_opep_chkdiana->C_STA)+Space(3),3),Left(LRTrim(personbo->PAESE)+Space(3),3)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_STA"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_STA"))+CPLib.Space(3),3):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PAESE"))+CPLib.Space(3),3));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_opep_chkdiana->C_CAB))),Left(LRTrim(qbe_opep_chkdiana->C_CAB)+Space(6),6),Left(LRTrim(personbo->CODCAB)+Space(6),6)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_CAB"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_CAB"))+CPLib.Space(6),6):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CODCAB"))+CPLib.Space(6),6));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_opep_chkdiana->C_CTA))),Left(LRTrim(qbe_opep_chkdiana->C_CTA)+Space(30),30),Left(LRTrim(personbo->DESCCIT)+Space(30),30)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_CTA"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_CTA"))+CPLib.Space(30),30):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DESCCIT"))+CPLib.Space(30),30));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_opep_chkdiana->C_PRV))),Left(LRTrim(qbe_opep_chkdiana->C_PRV)+Space(2),2),Left(LRTrim(personbo->PROVINCIA)+Space(2),2)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_PRV"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_PRV"))+CPLib.Space(2),2):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PROVINCIA"))+CPLib.Space(2),2));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_opep_chkdiana->C_IND))),Left(LRTrim(qbe_opep_chkdiana->C_IND)+Space(35),35),Left(LRTrim(personbo->DOMICILIO)+Space(35),35)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_IND"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_IND"))+CPLib.Space(35),35):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DOMICILIO"))+CPLib.Space(35),35));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_opep_chkdiana->C_CAP))),Left(LRTrim(qbe_opep_chkdiana->C_CAP)+Space(5),5),Left(LRTrim(personbo->CAP)+Space(5),5)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_CAP"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_CAP"))+CPLib.Space(5),5):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CAP"))+CPLib.Space(5),5));
                  /* _note := _note + Space(63) */
                  _note = _note+CPLib.Space(63);
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_opep_chkdiana->C_RAPPORTO))),Left(LRTrim(qbe_opep_chkdiana->C_RAPPORTO)+Space(25),25),Left(LRTrim(qbe_opep_chkdiana->RAPPORTBEN)+Space(25),25)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_RAPPORTO"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_RAPPORTO"))+CPLib.Space(25),25):CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("RAPPORTBEN"))+CPLib.Space(25),25));
                  /* _note := _note + Space(91) */
                  _note = _note+CPLib.Space(91);
                  /* If not(_rapcoll) */
                  if ( ! (_rapcoll)) {
                    /* Exec "Scrittura Dati" Page 15:Page_19 */
                    Page_19();
                  } else { // Else
                    /* mcRighe.AppendWithKey('5') */
                    mcRighe.AppendWithKey("5");
                    /* mcRighe.TIPO := '5' */
                    mcRighe.row.TIPO = "5";
                    /* mcRighe.RIGA := _note */
                    mcRighe.row.RIGA = _note;
                    /* mcRighe.SaveRow() */
                    mcRighe.SaveRow();
                  } // End If
                  /* nTotRec := nTotRec + 1 */
                  nTotRec = CPLib.Round(nTotRec+1,0);
                  /* nNumRec := nNumRec + 1 */
                  nNumRec = CPLib.Round(nNumRec+1,0);
                  Cursor_personbo.Next();
                }
                m_cConnectivityError = Cursor_personbo.ErrorMessage();
                Cursor_personbo.Close();
                // * --- End Select
              } else { // Else
                // * --- Select from wersonbo
                m_cServer = m_Ctx.GetServer("wersonbo");
                m_cPhName = m_Ctx.GetPhName("wersonbo");
                if (Cursor_wersonbo!=null)
                  Cursor_wersonbo.Close();
                Cursor_wersonbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"sanumpro="+CPSql.SQLValueAdapter(CPLib.ToSQL(_numsto,"?",0,0,m_cServer, m_oParameters),m_cServer,_numsto)+" "+")"+(m_Ctx.IsSharedTemp("wersonbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                while ( ! (Cursor_wersonbo.Eof())) {
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
                  /* _note := _note + Left(LRTrim(qbe_opep_chkdiana->CONNESBEN)+Space(16),16) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("CONNESBEN"))+CPLib.Space(16),16);
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_opep_chkdiana->C_RAG))),Left(LRTrim(qbe_opep_chkdiana->C_RAG)+Space(70),70),Left(LRTrim(wersonbo->RAGSOC)+Space(70),70)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_RAG"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_RAG"))+CPLib.Space(70),70):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("RAGSOC"))+CPLib.Space(70),70));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_opep_chkdiana->C_STA))),Left(LRTrim(qbe_opep_chkdiana->C_STA)+Space(3),3),Left(LRTrim(wersonbo->PAESE)+Space(3),3)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_STA"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_STA"))+CPLib.Space(3),3):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PAESE"))+CPLib.Space(3),3));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_opep_chkdiana->C_CAB))),Left(LRTrim(qbe_opep_chkdiana->C_CAB)+Space(6),6),Left(LRTrim(wersonbo->CODCAB)+Space(6),6)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_CAB"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_CAB"))+CPLib.Space(6),6):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CODCAB"))+CPLib.Space(6),6));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_opep_chkdiana->C_CTA))),Left(LRTrim(qbe_opep_chkdiana->C_CTA)+Space(30),30),Left(LRTrim(wersonbo->DESCCIT)+Space(30),30)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_CTA"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_CTA"))+CPLib.Space(30),30):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DESCCIT"))+CPLib.Space(30),30));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_opep_chkdiana->C_PRV))),Left(LRTrim(qbe_opep_chkdiana->C_PRV)+Space(2),2),Left(LRTrim(wersonbo->PROVINCIA)+Space(2),2)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_PRV"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_PRV"))+CPLib.Space(2),2):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PROVINCIA"))+CPLib.Space(2),2));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_opep_chkdiana->C_IND))),Left(LRTrim(qbe_opep_chkdiana->C_IND)+Space(35),35),Left(LRTrim(wersonbo->DOMICILIO)+Space(35),35)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_IND"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_IND"))+CPLib.Space(35),35):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DOMICILIO"))+CPLib.Space(35),35));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_opep_chkdiana->C_CAP))),Left(LRTrim(qbe_opep_chkdiana->C_CAP)+Space(5),5),Left(LRTrim(wersonbo->CAP)+Space(5),5)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_CAP"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_CAP"))+CPLib.Space(5),5):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CAP"))+CPLib.Space(5),5));
                  /* _note := _note + Space(63) */
                  _note = _note+CPLib.Space(63);
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_opep_chkdiana->C_RAPPORTO))),Left(LRTrim(qbe_opep_chkdiana->C_RAPPORTO)+Space(25),25),Left(LRTrim(qbe_opep_chkdiana->RAPPORTBEN)+Space(25),25)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_RAPPORTO"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("C_RAPPORTO"))+CPLib.Space(25),25):CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("RAPPORTBEN"))+CPLib.Space(25),25));
                  /* _note := _note + Space(91) */
                  _note = _note+CPLib.Space(91);
                  /* If not(_rapcoll) */
                  if ( ! (_rapcoll)) {
                    /* Exec "Scrittura Dati" Page 15:Page_19 */
                    Page_19();
                  } else { // Else
                    /* mcRighe.AppendWithKey('5') */
                    mcRighe.AppendWithKey("5");
                    /* mcRighe.TIPO := '5' */
                    mcRighe.row.TIPO = "5";
                    /* mcRighe.RIGA := _note */
                    mcRighe.row.RIGA = _note;
                    /* mcRighe.SaveRow() */
                    mcRighe.SaveRow();
                  } // End If
                  /* nTotRec := nTotRec + 1 */
                  nTotRec = CPLib.Round(nTotRec+1,0);
                  /* nNumRec := nNumRec + 1 */
                  nNumRec = CPLib.Round(nNumRec+1,0);
                  Cursor_wersonbo.Next();
                }
                m_cConnectivityError = Cursor_wersonbo.ErrorMessage();
                Cursor_wersonbo.Close();
                // * --- End Select
              } // End If
            } // End If
          } // End If
          /* If _xeneficope */
          if (_xeneficope) {
            // * --- Select from xeneficope
            m_cServer = m_Ctx.GetServer("xeneficope");
            m_cPhName = m_Ctx.GetPhName("xeneficope");
            if (Cursor_xeneficope!=null)
              Cursor_xeneficope.Close();
            Cursor_xeneficope = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_opep_chkdiana.GetString("IDBASE"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xeneficope")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_xeneficope.Eof())) {
              /* If Empty(LRTrim(xeneficope->CODSOG)) and not(Empty(LRTrim(xeneficope->C_RAG))) */
              if (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficope.GetString("CODSOG"))) &&  ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficope.GetString("C_RAG"))))) {
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
                /* _note := _note + Left(LRTrim(xeneficope->CODSOG)+Space(16),16) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("CODSOG"))+CPLib.Space(16),16);
                /* _note := _note +Left(LRTrim(xeneficope->C_RAG)+Space(70),70) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("C_RAG"))+CPLib.Space(70),70);
                /* _note := _note + Left(LRTrim(xeneficope->C_STA)+Space(3),3) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("C_STA"))+CPLib.Space(3),3);
                /* _note := _note +Left(LRTrim(xeneficope->C_CAB)+Space(6),6) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("C_CAB"))+CPLib.Space(6),6);
                /* _note := _note +Left(LRTrim(xeneficope->C_CTA)+Space(30),30) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("C_CTA"))+CPLib.Space(30),30);
                /* _note := _note + Left(LRTrim(xeneficope->C_PRV)+Space(2),2) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("C_PRV"))+CPLib.Space(2),2);
                /* _note := _note + Left(LRTrim(xeneficope->C_IND)+Space(35),35) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("C_IND"))+CPLib.Space(35),35);
                /* _note := _note + Left(LRTrim(xeneficope->C_CAP)+Space(5),5) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("C_CAP"))+CPLib.Space(5),5);
                /* _note := _note + Space(63) */
                _note = _note+CPLib.Space(63);
                /* _note := _note + Left(LRTrim(xeneficope->C_RAPPORTO)+Space(25),25) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("C_RAPPORTO"))+CPLib.Space(25),25);
                /* _note := _note + Space(91) */
                _note = _note+CPLib.Space(91);
                /* If not(_rapcoll) */
                if ( ! (_rapcoll)) {
                  /* Exec "Scrittura Dati" Page 15:Page_19 */
                  Page_19();
                } else { // Else
                  /* mcRighe.AppendWithKey('5') */
                  mcRighe.AppendWithKey("5");
                  /* mcRighe.TIPO := '5' */
                  mcRighe.row.TIPO = "5";
                  /* mcRighe.RIGA := _note */
                  mcRighe.row.RIGA = _note;
                  /* mcRighe.SaveRow() */
                  mcRighe.SaveRow();
                } // End If
                /* nTotRec := nTotRec + 1 */
                nTotRec = CPLib.Round(nTotRec+1,0);
                /* nNumRec := nNumRec + 1 */
                nNumRec = CPLib.Round(nNumRec+1,0);
              } else { // Else
                /* If xeneficope->CODSOG <> qbe_opep_chkdiana->CONNESBEN */
                if (CPLib.ne(Cursor_xeneficope.GetString("CODSOG"),Cursor_qbe_opep_chkdiana.GetString("CONNESBEN"))) {
                  /* _numsto := arfn_chkspers(xeneficope->CODSOG,iif(w_stoper='R',Date(),qbe_opep_chkdiana->DATAOPE)) */
                  _numsto = arfn_chkspersR.Make(m_Ctx,this).Run(Cursor_xeneficope.GetString("CODSOG"),(CPLib.eqr(w_stoper,"R")?CPLib.Date():Cursor_qbe_opep_chkdiana.GetDate("DATAOPE")));
                  /* If Empty(LRTrim(_numsto)) */
                  if (CPLib.Empty(CPLib.LRTrim(_numsto))) {
                    // * --- Select from personbo
                    m_cServer = m_Ctx.GetServer("personbo");
                    m_cPhName = m_Ctx.GetPhName("personbo");
                    if (Cursor_personbo!=null)
                      Cursor_personbo.Close();
                    Cursor_personbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CONNES="+CPLib.ToSQL(Cursor_xeneficope.GetString("CODSOG"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("personbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                    while ( ! (Cursor_personbo.Eof())) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
                      /* _note := _note + Left(LRTrim(xeneficope->CODSOG)+Space(16),16) */
                      _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("CODSOG"))+CPLib.Space(16),16);
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficope->C_RAG))),Left(LRTrim(xeneficope->C_RAG)+Space(70),70),Left(LRTrim(personbo->RAGSOC)+Space(70),70)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficope.GetString("C_RAG"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("C_RAG"))+CPLib.Space(70),70):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("RAGSOC"))+CPLib.Space(70),70));
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficope->C_STA))),Left(LRTrim(xeneficope->C_STA)+Space(3),3),Left(LRTrim(personbo->PAESE)+Space(3),3)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficope.GetString("C_STA"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("C_STA"))+CPLib.Space(3),3):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PAESE"))+CPLib.Space(3),3));
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficope->C_CAB))),Left(LRTrim(xeneficope->C_CAB)+Space(6),6),Left(LRTrim(personbo->CODCAB)+Space(6),6)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficope.GetString("C_CAB"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("C_CAB"))+CPLib.Space(6),6):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CODCAB"))+CPLib.Space(6),6));
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficope->C_CTA))),Left(LRTrim(xeneficope->C_CTA)+Space(30),30),Left(LRTrim(personbo->DESCCIT)+Space(30),30)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficope.GetString("C_CTA"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("C_CTA"))+CPLib.Space(30),30):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DESCCIT"))+CPLib.Space(30),30));
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficope->C_PRV))),Left(LRTrim(xeneficope->C_PRV)+Space(2),2),Left(LRTrim(personbo->PROVINCIA)+Space(2),2)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficope.GetString("C_PRV"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("C_PRV"))+CPLib.Space(2),2):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PROVINCIA"))+CPLib.Space(2),2));
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficope->C_IND))),Left(LRTrim(xeneficope->C_IND)+Space(35),35),Left(LRTrim(personbo->DOMICILIO)+Space(35),35)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficope.GetString("C_IND"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("C_IND"))+CPLib.Space(35),35):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DOMICILIO"))+CPLib.Space(35),35));
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficope->C_CAP))),Left(LRTrim(xeneficope->C_CAP)+Space(5),5),Left(LRTrim(personbo->CAP)+Space(5),5)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficope.GetString("C_CAP"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("C_CAP"))+CPLib.Space(5),5):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CAP"))+CPLib.Space(5),5));
                      /* _note := _note + Space(63) */
                      _note = _note+CPLib.Space(63);
                      /* _note := _note +Left(LRTrim(xeneficope->C_RAPPORTO)+Space(25),25) */
                      _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("C_RAPPORTO"))+CPLib.Space(25),25);
                      /* _note := _note + Space(91) */
                      _note = _note+CPLib.Space(91);
                      /* If not(_rapcoll) */
                      if ( ! (_rapcoll)) {
                        /* Exec "Scrittura Dati" Page 15:Page_19 */
                        Page_19();
                      } else { // Else
                        /* mcRighe.AppendWithKey('5') */
                        mcRighe.AppendWithKey("5");
                        /* mcRighe.TIPO := '5' */
                        mcRighe.row.TIPO = "5";
                        /* mcRighe.RIGA := _note */
                        mcRighe.row.RIGA = _note;
                        /* mcRighe.SaveRow() */
                        mcRighe.SaveRow();
                      } // End If
                      /* nTotRec := nTotRec + 1 */
                      nTotRec = CPLib.Round(nTotRec+1,0);
                      /* nNumRec := nNumRec + 1 */
                      nNumRec = CPLib.Round(nNumRec+1,0);
                      Cursor_personbo.Next();
                    }
                    m_cConnectivityError = Cursor_personbo.ErrorMessage();
                    Cursor_personbo.Close();
                    // * --- End Select
                  } else { // Else
                    // * --- Select from wersonbo
                    m_cServer = m_Ctx.GetServer("wersonbo");
                    m_cPhName = m_Ctx.GetPhName("wersonbo");
                    if (Cursor_wersonbo!=null)
                      Cursor_wersonbo.Close();
                    Cursor_wersonbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"sanumpro="+CPSql.SQLValueAdapter(CPLib.ToSQL(_numsto,"?",0,0,m_cServer, m_oParameters),m_cServer,_numsto)+" "+")"+(m_Ctx.IsSharedTemp("wersonbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                    while ( ! (Cursor_wersonbo.Eof())) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
                      /* _note := _note + Left(LRTrim(xeneficope->CODSOG)+Space(16),16) */
                      _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("CODSOG"))+CPLib.Space(16),16);
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficope->C_RAG))),Left(LRTrim(xeneficope->C_RAG)+Space(70),70),Left(LRTrim(wersonbo->RAGSOC)+Space(70),70)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficope.GetString("C_RAG"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("C_RAG"))+CPLib.Space(70),70):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("RAGSOC"))+CPLib.Space(70),70));
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficope->C_STA))),Left(LRTrim(xeneficope->C_STA)+Space(3),3),Left(LRTrim(wersonbo->PAESE)+Space(3),3)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficope.GetString("C_STA"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("C_STA"))+CPLib.Space(3),3):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PAESE"))+CPLib.Space(3),3));
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficope->C_CAB))),Left(LRTrim(xeneficope->C_CAB)+Space(6),6),Left(LRTrim(wersonbo->CODCAB)+Space(6),6)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficope.GetString("C_CAB"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("C_CAB"))+CPLib.Space(6),6):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CODCAB"))+CPLib.Space(6),6));
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficope->C_CTA))),Left(LRTrim(xeneficope->C_CTA)+Space(30),30),Left(LRTrim(wersonbo->DESCCIT)+Space(30),30)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficope.GetString("C_CTA"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("C_CTA"))+CPLib.Space(30),30):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DESCCIT"))+CPLib.Space(30),30));
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficope->C_PRV))),Left(LRTrim(xeneficope->C_PRV)+Space(2),2),Left(LRTrim(wersonbo->PROVINCIA)+Space(2),2)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficope.GetString("C_PRV"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("C_PRV"))+CPLib.Space(2),2):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PROVINCIA"))+CPLib.Space(2),2));
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficope->C_IND))),Left(LRTrim(xeneficope->C_IND)+Space(35),35),Left(LRTrim(wersonbo->DOMICILIO)+Space(35),35)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficope.GetString("C_IND"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("C_IND"))+CPLib.Space(35),35):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DOMICILIO"))+CPLib.Space(35),35));
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficope->C_CAP))),Left(LRTrim(xeneficope->C_CAP)+Space(5),5),Left(LRTrim(wersonbo->CAP)+Space(5),5)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficope.GetString("C_CAP"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("C_CAP"))+CPLib.Space(5),5):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CAP"))+CPLib.Space(5),5));
                      /* _note := _note + Space(63) */
                      _note = _note+CPLib.Space(63);
                      /* _note := _note +Left(LRTrim(xeneficope->C_RAPPORTO)+Space(25),25) */
                      _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficope.GetString("C_RAPPORTO"))+CPLib.Space(25),25);
                      /* _note := _note + Space(91) */
                      _note = _note+CPLib.Space(91);
                      /* If not(_rapcoll) */
                      if ( ! (_rapcoll)) {
                        /* Exec "Scrittura Dati" Page 15:Page_19 */
                        Page_19();
                      } else { // Else
                        /* mcRighe.AppendWithKey('5') */
                        mcRighe.AppendWithKey("5");
                        /* mcRighe.TIPO := '5' */
                        mcRighe.row.TIPO = "5";
                        /* mcRighe.RIGA := _note */
                        mcRighe.row.RIGA = _note;
                        /* mcRighe.SaveRow() */
                        mcRighe.SaveRow();
                      } // End If
                      /* nTotRec := nTotRec + 1 */
                      nTotRec = CPLib.Round(nTotRec+1,0);
                      /* nNumRec := nNumRec + 1 */
                      nNumRec = CPLib.Round(nNumRec+1,0);
                      Cursor_wersonbo.Next();
                    }
                    m_cConnectivityError = Cursor_wersonbo.ErrorMessage();
                    Cursor_wersonbo.Close();
                    // * --- End Select
                  } // End If
                } // End If
              } // End If
              Cursor_xeneficope.Next();
            }
            m_cConnectivityError = Cursor_xeneficope.ErrorMessage();
            Cursor_xeneficope.Close();
            // * --- End Select
          } // End If
          /* If not(Empty(qbe_opep_chkdiana->CONNALTRO)) */
          if ( ! (CPLib.Empty(Cursor_qbe_opep_chkdiana.GetString("CONNALTRO")))) {
            /* If qbe_opep_chkdiana->DATAOPE > CharToDate('20131231') */
            if (CPLib.gt(Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '9' + _idereg */
              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"9"+_idereg;
              /* pTipoR := '9' // Tipo Riga */
              pTipoR = "9";
            } else { // Else
              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '6' + _idereg */
              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"6"+_idereg;
              /* pTipoR := '6' // Tipo Riga */
              pTipoR = "6";
            } // End If
            /* pCli := qbe_opep_chkdiana->CONNALTRO // Codice Soggetto */
            pCli = Cursor_qbe_opep_chkdiana.GetString("CONNALTRO");
            /* pDatOpe := iif(w_stoper='R',qbe_opep_chkdiana->DATAREG,qbe_opep_chkdiana->DATAOPE) // Data Operazione */
            pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_opep_chkdiana.GetDate("DATAREG"):Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"));
            /* pRap := qbe_opep_chkdiana->RAPPORTO // Codice Rapporto */
            pRap = Cursor_qbe_opep_chkdiana.GetString("RAPPORTO");
            /* pTRap := qbe_opep_chkdiana->FLAGRAP // Tipo Rapporto */
            pTRap = Cursor_qbe_opep_chkdiana.GetString("FLAGRAP");
            /* pRAE := _raeatc // RAE o ATECO */
            pRAE = _raeatc;
            /* pSTATO := qbe_opep_chkdiana->STATOREG // Stato Registrazione */
            pSTATO = Cursor_qbe_opep_chkdiana.GetString("STATOREG");
            /* pDatRet := qbe_opep_chkdiana->DATARETT // Data Rettifica */
            pDatRet = Cursor_qbe_opep_chkdiana.GetDate("DATARETT");
            /* _oldmc := _usemc */
            _oldmc = CPLib.Round(_usemc,0);
            /* _usemc := 0 */
            _usemc = CPLib.Round(0,0);
            /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
            DatiSoggetto();
            /* _usemc := _oldmc */
            _usemc = CPLib.Round(_oldmc,0);
            /* If not(_rapcoll) */
            if ( ! (_rapcoll)) {
              /* Exec "Scrittura Dati" Page 15:Page_19 */
              Page_19();
            } else { // Else
              /* mcRighe.AppendWithKey(pTipoR) */
              mcRighe.AppendWithKey(pTipoR);
              /* mcRighe.TIPO := pTipoR */
              mcRighe.row.TIPO = pTipoR;
              /* mcRighe.RIGA := _note */
              mcRighe.row.RIGA = _note;
              /* mcRighe.SaveRow() */
              mcRighe.SaveRow();
            } // End If
            /* nTotRec := nTotRec + 1 */
            nTotRec = CPLib.Round(nTotRec+1,0);
            /* nNumRec := nNumRec + 1 */
            nNumRec = CPLib.Round(nNumRec+1,0);
          } // End If
          /* If _xerzistiope */
          if (_xerzistiope) {
            // * --- Select from xerzistiope
            m_cServer = m_Ctx.GetServer("xerzistiope");
            m_cPhName = m_Ctx.GetPhName("xerzistiope");
            if (Cursor_xerzistiope!=null)
              Cursor_xerzistiope.Close();
            Cursor_xerzistiope = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_opep_chkdiana.GetString("IDBASE"),"?",0,0)+"  and  CODSOG <> "+CPLib.ToSQL(Cursor_qbe_opep_chkdiana.GetString("CONNALTRO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xerzistiope")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_xerzistiope.Eof())) {
              /* If qbe_opep_chkdiana->DATAOPE > CharToDate('20131231') */
              if (CPLib.gt(Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '9' + _idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"9"+_idereg;
                /* pTipoR := '9' // Tipo Riga */
                pTipoR = "9";
              } else { // Else
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '6' + _idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"6"+_idereg;
                /* pTipoR := '9' // Tipo Riga */
                pTipoR = "9";
              } // End If
              /* pCli := xerzistiope->CODSOG // Codice Soggetto */
              pCli = Cursor_xerzistiope.GetString("CODSOG");
              /* pDatOpe := iif(w_stoper='R',qbe_opep_chkdiana->DATAREG,qbe_opep_chkdiana->DATAOPE) // Data Operazione */
              pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_opep_chkdiana.GetDate("DATAREG"):Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"));
              /* pRap := qbe_opep_chkdiana->RAPPORTO // Codice Rapporto */
              pRap = Cursor_qbe_opep_chkdiana.GetString("RAPPORTO");
              /* pTRap := qbe_opep_chkdiana->FLAGRAP // Tipo Rapporto */
              pTRap = Cursor_qbe_opep_chkdiana.GetString("FLAGRAP");
              /* pRAE := _raeatc // RAE o ATECO */
              pRAE = _raeatc;
              /* pSTATO := qbe_opep_chkdiana->STATOREG // Stato Registrazione */
              pSTATO = Cursor_qbe_opep_chkdiana.GetString("STATOREG");
              /* pDatRet := qbe_opep_chkdiana->DATARETT // Data Rettifica */
              pDatRet = Cursor_qbe_opep_chkdiana.GetDate("DATARETT");
              /* _oldmc := _usemc */
              _oldmc = CPLib.Round(_usemc,0);
              /* _usemc := 0 */
              _usemc = CPLib.Round(0,0);
              /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
              DatiSoggetto();
              /* _usemc := _oldmc */
              _usemc = CPLib.Round(_oldmc,0);
              /* If not(_rapcoll) */
              if ( ! (_rapcoll)) {
                /* Exec "Scrittura Dati" Page 15:Page_19 */
                Page_19();
              } else { // Else
                /* mcRighe.AppendWithKey(pTipoR) */
                mcRighe.AppendWithKey(pTipoR);
                /* mcRighe.TIPO := pTipoR */
                mcRighe.row.TIPO = pTipoR;
                /* mcRighe.RIGA := _note */
                mcRighe.row.RIGA = _note;
                /* mcRighe.SaveRow() */
                mcRighe.SaveRow();
              } // End If
              /* nTotRec := nTotRec + 1 */
              nTotRec = CPLib.Round(nTotRec+1,0);
              /* nNumRec := nNumRec + 1 */
              nNumRec = CPLib.Round(nNumRec+1,0);
              Cursor_xerzistiope.Next();
            }
            m_cConnectivityError = Cursor_xerzistiope.ErrorMessage();
            Cursor_xerzistiope.Close();
            // * --- End Select
          } // End If
          /* If _rapcoll */
          if (_rapcoll) {
            // * --- Select from xapcoll
            m_cServer = m_Ctx.GetServer("xapcoll");
            m_cPhName = m_Ctx.GetPhName("xapcoll");
            if (Cursor_xapcoll!=null)
              Cursor_xapcoll.Close();
            Cursor_xapcoll = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_opep_chkdiana.GetString("IDBASE"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xapcoll")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_xapcoll.Eof())) {
              for (MemoryCursorRow_mcdiana_mcrdef rowRighe : mcRighe._iterable_()) {
                /* If rowRighe.TIPO='1' */
                if (CPLib.eqr(rowRighe.TIPO,"1")) {
                  /* _note := Left(_note,198)+Left(LRTrim(qbe_opep_chkdiana->RAPPORTO)+Space(25),25)+Substr(_note,224,156) */
                  _note = CPLib.Left(_note,198)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_opep_chkdiana.GetString("RAPPORTO"))+CPLib.Space(25),25)+CPLib.Substr(_note,224,156);
                } else { // Else
                  /* _note := Left(rowRighe.RIGA,380) */
                  _note = CPLib.Left(rowRighe.RIGA,380);
                } // End If
                /* Exec "Scrittura Dati" Page 15:Page_19 */
                Page_19();
                /* If rowRighe.TIPO='1' */
                if (CPLib.eqr(rowRighe.TIPO,"1")) {
                  /* If not(Empty(xapcoll->RAPPORTO)) */
                  if ( ! (CPLib.Empty(Cursor_xapcoll.GetString("RAPPORTO")))) {
                    /* _oldrap := '' */
                    _oldrap = "";
                    /* _tiporap := '' */
                    _tiporap = "";
                    // * --- Read from knarapbo
                    m_cServer = m_Ctx.GetServer("knarapbo");
                    m_cPhName = m_Ctx.GetPhName("knarapbo");
                    m_cSql = "";
                    m_cSql = m_cSql+"RAPPORTO="+CPSql.SQLValueAdapter(CPLib.ToSQL(Cursor_xapcoll.GetString("RAPPORTO"),"C",25,0,m_cServer),m_cServer,Cursor_xapcoll.GetString("RAPPORTO"));
                    if (m_Ctx.IsSharedTemp("knarapbo")) {
                      m_cSql = m_cSql+" and context_id='"+m_Ctx.GetTempID()+"'";
                    }
                    if (Read_Cursor!=null)
                      Read_Cursor.Close();
                    Read_Cursor = m_Sql.Query(m_cServer,"select "+CPLib.GetMultilanguageField("RAPPORTO",m_Ctx,m_cServer)+","+CPLib.GetMultilanguageField("TIPORAP",m_Ctx,m_cServer)+" from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+m_cSql);
                    if ( ! (Read_Cursor.Eof())) {
                      _oldrap = Read_Cursor.GetString("RAPPORTO");
                      _tiporap = Read_Cursor.GetString("TIPORAP");
                      Read_Cursor.Next();
                      if ( ! (Read_Cursor.Eof())) {
                        Error l_oErrorFault = new Error("Read on knarapbo into routine arrt_chkdiana_all returns two or more records. This item should return only a record.");
                        CPStdCounter.Error(l_oErrorFault);
                      }
                      Read_Cursor.Close();
                    } else {
                      // Error: no record found!
                      _oldrap = "";
                      _tiporap = "";
                      Read_Cursor.Close();
                      m_cLastMsgError = "MSG_RECORD_NOT_FOUND";
                    }
                    /* If not(Empty(_oldrap)) */
                    if ( ! (CPLib.Empty(_oldrap))) {
                      /* If _tiporap='D' */
                      if (CPLib.eqr(_tiporap,"D")) {
                        // * --- Select from intestbo
                        m_cServer = m_Ctx.GetServer("intestbo");
                        m_cPhName = m_Ctx.GetPhName("intestbo");
                        if (Cursor_intestbo!=null)
                          Cursor_intestbo.Close();
                        Cursor_intestbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_xapcoll.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("intestbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                        while ( ! (Cursor_intestbo.Eof())) {
                          /* If xapcoll->RAPPORTO = intestbo->RAPPORTO */
                          if (CPLib.eqr(Cursor_xapcoll.GetString("RAPPORTO"),Cursor_intestbo.GetString("RAPPORTO"))) {
                            /* _avanza := 0 */
                            _avanza = CPLib.Round(0,0);
                            /* If Empty(intestbo->CODINTER) or intestbo->STATOREG='2' or intestbo->STATOREG='3' */
                            if (CPLib.Empty(Cursor_intestbo.GetString("CODINTER")) || CPLib.eqr(Cursor_intestbo.GetString("STATOREG"),"2") || CPLib.eqr(Cursor_intestbo.GetString("STATOREG"),"3")) {
                              /* _avanza := 1 */
                              _avanza = CPLib.Round(1,0);
                            } // End If
                            /* If intestbo->DATAINI > qbe_opep_chkdiana->DATAOPE */
                            if (CPLib.gt(Cursor_intestbo.GetDate("DATAINI"),Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"))) {
                              /* _avanza := 1 */
                              _avanza = CPLib.Round(1,0);
                            } // End If
                            /* If not(Empty(intestbo->DATAFINE)) and intestbo->DATAFINE < qbe_opep_chkdiana->DATAOPE */
                            if ( ! (CPLib.Empty(Cursor_intestbo.GetDate("DATAFINE"))) && CPLib.lt(Cursor_intestbo.GetDate("DATAFINE"),Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"))) {
                              /* _avanza := 1 */
                              _avanza = CPLib.Round(1,0);
                            } // End If
                            /* If _avanza = 0 */
                            if (CPLib.eqr(_avanza,0)) {
                              /* _codrif := intestbo->CODINTER */
                              _codrif = Cursor_intestbo.GetString("CODINTER");
                              /* If qbe_opep_chkdiana->DATAOPE > CharToDate('20131231') */
                              if (CPLib.gt(Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '7' + _idereg */
                                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                                /* pTipoR := '7' // Tipo Riga */
                                pTipoR = "7";
                              } else { // Else
                                /* If Empty(qbe_opep_chkdiana->CONNESOPER) or (qbe_opep_chkdiana->CONNESOPER=intestbo->CODINTER) */
                                if (CPLib.Empty(Cursor_qbe_opep_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(Cursor_qbe_opep_chkdiana.GetString("CONNESOPER"),Cursor_intestbo.GetString("CODINTER")))) {
                                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                                  /* pTipoR := '2' // Tipo Riga */
                                  pTipoR = "2";
                                } else { // Else
                                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                                  /* pTipoR := '3' // Tipo Riga */
                                  pTipoR = "3";
                                } // End If
                              } // End If
                              /* pCli := intestbo->CODINTER // Codice Soggetto */
                              pCli = Cursor_intestbo.GetString("CODINTER");
                              /* pDatOpe := iif(w_stoper='R',qbe_opep_chkdiana->DATAREG,qbe_opep_chkdiana->DATAOPE) // Data Operazione */
                              pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_opep_chkdiana.GetDate("DATAREG"):Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"));
                              /* pRap := qbe_opep_chkdiana->RAPPORTO // Codice Rapporto */
                              pRap = Cursor_qbe_opep_chkdiana.GetString("RAPPORTO");
                              /* pTRap := qbe_opep_chkdiana->FLAGRAP // Tipo Rapporto */
                              pTRap = Cursor_qbe_opep_chkdiana.GetString("FLAGRAP");
                              /* pRAE := _raeatc // RAE o ATECO */
                              pRAE = _raeatc;
                              /* pSTATO := qbe_opep_chkdiana->STATOREG // Stato Registrazione */
                              pSTATO = Cursor_qbe_opep_chkdiana.GetString("STATOREG");
                              /* pDatRet := qbe_opep_chkdiana->DATARETT // Data Rettifica */
                              pDatRet = Cursor_qbe_opep_chkdiana.GetDate("DATARETT");
                              /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                              DatiSoggetto();
                              /* Exec "Scrittura Dati" Page 15:Page_19 */
                              Page_19();
                              /* nTotRec := nTotRec + 1 */
                              nTotRec = CPLib.Round(nTotRec+1,0);
                              /* nNumRec := nNumRec + 1 */
                              nNumRec = CPLib.Round(nNumRec+1,0);
                            } // End If
                          } // End If
                          Cursor_intestbo.Next();
                        }
                        m_cConnectivityError = Cursor_intestbo.ErrorMessage();
                        Cursor_intestbo.Close();
                        // * --- End Select
                      } else { // Else
                        // * --- Select from xntestbo
                        m_cServer = m_Ctx.GetServer("xntestbo");
                        m_cPhName = m_Ctx.GetPhName("xntestbo");
                        if (Cursor_xntestbo!=null)
                          Cursor_xntestbo.Close();
                        Cursor_xntestbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_xapcoll.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xntestbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                        while ( ! (Cursor_xntestbo.Eof())) {
                          /* If xapcoll->RAPPORTO = xntestbo->RAPPORTO */
                          if (CPLib.eqr(Cursor_xapcoll.GetString("RAPPORTO"),Cursor_xntestbo.GetString("RAPPORTO"))) {
                            /* _avanza := 0 */
                            _avanza = CPLib.Round(0,0);
                            /* If Empty(xntestbo->CODINTER) */
                            if (CPLib.Empty(Cursor_xntestbo.GetString("CODINTER"))) {
                              /* _avanza := 1 */
                              _avanza = CPLib.Round(1,0);
                            } // End If
                            /* If xntestbo->DATAINI > qbe_opep_chkdiana->DATAOPE */
                            if (CPLib.gt(Cursor_xntestbo.GetDate("DATAINI"),Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"))) {
                              /* _avanza := 1 */
                              _avanza = CPLib.Round(1,0);
                            } // End If
                            /* If not(Empty(xntestbo->DATAFINE)) and xntestbo->DATAFINE < qbe_opep_chkdiana->DATAOPE */
                            if ( ! (CPLib.Empty(Cursor_xntestbo.GetDate("DATAFINE"))) && CPLib.lt(Cursor_xntestbo.GetDate("DATAFINE"),Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"))) {
                              /* _avanza := 1 */
                              _avanza = CPLib.Round(1,0);
                            } // End If
                            /* If _avanza = 0 */
                            if (CPLib.eqr(_avanza,0)) {
                              /* _codrif := xntestbo->CODINTER */
                              _codrif = Cursor_xntestbo.GetString("CODINTER");
                              /* If qbe_opep_chkdiana->DATAOPE > CharToDate('20131231') */
                              if (CPLib.gt(Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '7' + _idereg */
                                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                                /* pTipoR := '7' // Tipo Riga */
                                pTipoR = "7";
                              } else { // Else
                                /* If Empty(qbe_opep_chkdiana->CONNESOPER) or (qbe_opep_chkdiana->CONNESOPER=xntestbo->CODINTER) */
                                if (CPLib.Empty(Cursor_qbe_opep_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(Cursor_qbe_opep_chkdiana.GetString("CONNESOPER"),Cursor_xntestbo.GetString("CODINTER")))) {
                                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                                  /* pTipoR := '2' // Tipo Riga */
                                  pTipoR = "2";
                                } else { // Else
                                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                                  /* pTipoR := '3' // Tipo Riga */
                                  pTipoR = "3";
                                } // End If
                              } // End If
                              /* pCli := xntestbo->CODINTER // Codice Soggetto */
                              pCli = Cursor_xntestbo.GetString("CODINTER");
                              /* pDatOpe := iif(w_stoper='R',qbe_opep_chkdiana->DATAREG,qbe_opep_chkdiana->DATAOPE) // Data Operazione */
                              pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_opep_chkdiana.GetDate("DATAREG"):Cursor_qbe_opep_chkdiana.GetDate("DATAOPE"));
                              /* pRap := qbe_opep_chkdiana->RAPPORTO // Codice Rapporto */
                              pRap = Cursor_qbe_opep_chkdiana.GetString("RAPPORTO");
                              /* pTRap := qbe_opep_chkdiana->FLAGRAP // Tipo Rapporto */
                              pTRap = Cursor_qbe_opep_chkdiana.GetString("FLAGRAP");
                              /* pRAE := _raeatc // RAE o ATECO */
                              pRAE = _raeatc;
                              /* pSTATO := qbe_opep_chkdiana->STATOREG // Stato Registrazione */
                              pSTATO = Cursor_qbe_opep_chkdiana.GetString("STATOREG");
                              /* pDatRet := qbe_opep_chkdiana->DATARETT // Data Rettifica */
                              pDatRet = Cursor_qbe_opep_chkdiana.GetDate("DATARETT");
                              /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                              DatiSoggetto();
                              /* Exec "Scrittura Dati" Page 15:Page_19 */
                              Page_19();
                              /* nTotRec := nTotRec + 1 */
                              nTotRec = CPLib.Round(nTotRec+1,0);
                              /* nNumRec := nNumRec + 1 */
                              nNumRec = CPLib.Round(nNumRec+1,0);
                            } // End If
                          } // End If
                          Cursor_xntestbo.Next();
                        }
                        m_cConnectivityError = Cursor_xntestbo.ErrorMessage();
                        Cursor_xntestbo.Close();
                        // * --- End Select
                      } // End If
                    } // End If
                  } // End If
                } // End If
              }
              Cursor_xapcoll.Next();
            }
            m_cConnectivityError = Cursor_xapcoll.ErrorMessage();
            Cursor_xapcoll.Close();
            // * --- End Select
          } // End If
          /* gNumRec := nTotRec // N° Record DIANA */
          gNumRec = CPLib.Round(nTotRec,0);
          m_Ctx.SetGlobalNumber("gNumRec",gNumRec);
          /* gNumReg := nTotReg // N° Registrazioni DIANA */
          gNumReg = CPLib.Round(nTotReg,0);
          m_Ctx.SetGlobalNumber("gNumReg",gNumReg);
          Cursor_qbe_opep_chkdiana.Next();
        }
        m_cConnectivityError = Cursor_qbe_opep_chkdiana.ErrorMessage();
        Cursor_qbe_opep_chkdiana.Close();
        // * --- End Select
        /* _contacilci := _contacilci+1 */
        _contacilci = CPLib.Round(_contacilci+1,0);
      } // End While
    } finally {
      try {
        if (Cursor_qbe_opep_chkdiana_limits!=null)
          Cursor_qbe_opep_chkdiana_limits.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_qbe_opep_chkdiana!=null)
          Cursor_qbe_opep_chkdiana.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_qbe_tab_mmc!=null)
          Cursor_qbe_tab_mmc.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_knarapbo!=null)
          Cursor_knarapbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_kersonbo!=null)
          Cursor_kersonbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Read_Cursor!=null)
          Read_Cursor.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_xntestbo!=null)
          Cursor_xntestbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_intestbo!=null)
          Cursor_intestbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_xlientiope!=null)
          Cursor_xlientiope.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_xogopebo!=null)
          Cursor_xogopebo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_personbo!=null)
          Cursor_personbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_wersonbo!=null)
          Cursor_wersonbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_xeneficope!=null)
          Cursor_xeneficope.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_xerzistiope!=null)
          Cursor_xerzistiope.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_xapcoll!=null)
          Cursor_xapcoll.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
    }
  }
  void Page_9() throws Exception {
    CPResultSet Cursor_qbe_frad_chkdiana_limits=null;
    CPResultSet Cursor_qbe_frad_chkdiana=null;
    CPResultSet Cursor_knarapbo=null;
    CPResultSet Cursor_kersonbo=null;
    CPResultSet Read_Cursor=null;
    CPResultSet Cursor_intestbo=null;
    CPResultSet Cursor_mlientifrz=null;
    CPResultSet Cursor_clientifrz=null;
    CPResultSet Cursor_mogopefbo=null;
    CPResultSet Cursor_sogopefbo=null;
    CPResultSet Cursor_personbo=null;
    CPResultSet Cursor_wersonbo=null;
    CPResultSet Cursor_meneficfrz=null;
    CPResultSet Cursor_beneficfrz=null;
    CPResultSet Cursor_merzistifrz=null;
    CPResultSet Cursor_terzistifrz=null;
    VQRHolder l_VQRHolder = null;
    try {
      /* Cicla sulle frazionate */
      /* gMsgImp := 'Verifica Frazionate da elaborare ...' // Messaggio Import */
      gMsgImp = "Verifica Frazionate da elaborare ...";
      m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
      /* _max := 0 */
      _max = CPLib.Round(0,0);
      /* _min := 0 */
      _min = CPLib.Round(0,0);
      /* _ciclo := 0 */
      _ciclo = CPLib.Round(0,0);
      /* Prima gli italiani */
      // * --- Select from qbe_frad_chkdiana_limits
      SPBridge.HMCaller _h000009D9;
      _h000009D9 = new SPBridge.HMCaller();
      _h000009D9.Set("m_cVQRList",m_cVQRList);
      _h000009D9.Set("cdadata",w_cdadata);
      _h000009D9.Set("c_adata",w_c_adata);
      _h000009D9.Set("codage",w_codage);
      _h000009D9.Set("ragben",w_ragben);
      _h000009D9.Set("cdareg",w_cdareg);
      _h000009D9.Set("c_areg",w_c_areg);
      _h000009D9.Set("codcli",w_codcli);
      _h000009D9.Set("flgsto",w_flgsto);
      if (Cursor_qbe_frad_chkdiana_limits!=null)
        Cursor_qbe_frad_chkdiana_limits.Close();
      Cursor_qbe_frad_chkdiana_limits = new VQRHolder("qbe_frad_chkdiana_limits",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h000009D9,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_frad_chkdiana_limits.Eof())) {
        /* _max := qbe_frad_chkdiana_limits->MAXFRZ */
        _max = CPLib.Round(Cursor_qbe_frad_chkdiana_limits.GetDouble("MAXFRZ"),0);
        /* _min := qbe_frad_chkdiana_limits->MINFRZ */
        _min = CPLib.Round(Cursor_qbe_frad_chkdiana_limits.GetDouble("MINFRZ"),0);
        Cursor_qbe_frad_chkdiana_limits.Next();
      }
      m_cConnectivityError = Cursor_qbe_frad_chkdiana_limits.ErrorMessage();
      Cursor_qbe_frad_chkdiana_limits.Close();
      // * --- End Select
      /* _cicli := iif(Mod(_max,5000) <> 0,Int(_max/5000) + 1,Int(_max/5000)) */
      _cicli = CPLib.Round((CPLib.ne(CPLib.Mod(_max,5000),0)?CPLib.Int(_max/5000)+1:CPLib.Int(_max/5000)),0);
      /* _bottom := _min */
      _bottom = CPLib.Round(_min,0);
      /* If _min > 5000 */
      if (CPLib.gt(_min,5000)) {
        /* _contacilci := Int(_min/5000) + 1 */
        _contacilci = CPLib.Round(CPLib.Int(_min/5000)+1,0);
      } else { // Else
        /* _contacilci := 1 */
        _contacilci = CPLib.Round(1,0);
      } // End If
      /* gMsgImp := 'Lettura operazioni in corso ...' // Messaggio Import */
      gMsgImp = "Lettura operazioni in corso ...";
      m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
      /* While _contacilci<=_cicli */
      while (CPLib.le(_contacilci,_cicli)) {
        /* _bottom := iif(_ciclo=0,_bottom,((_contacilci -1 ) * 5000) + 1) */
        _bottom = CPLib.Round((CPLib.eqr(_ciclo,0)?_bottom:((_contacilci-1)*5000)+1),0);
        /* _top := _contacilci * 5000 */
        _top = CPLib.Round(_contacilci*5000,0);
        /* _ciclo := 1 */
        _ciclo = CPLib.Round(1,0);
        /* _conta := _conta + 1 */
        _conta = CPLib.Round(_conta+1,0);
        /* gMsgImp := 'Lettura frazionate in corso ... Ciclo N. '+LRTrim(Str(_contacilci,10,0)) // Messaggio Import */
        gMsgImp = "Lettura frazionate in corso ... Ciclo N. "+CPLib.LRTrim(CPLib.Str(_contacilci,10,0));
        m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
        /* Cicla sulle operazioni */
        // * --- Select from qbe_frad_chkdiana
        SPBridge.HMCaller _h000009E9;
        _h000009E9 = new SPBridge.HMCaller();
        _h000009E9.Set("m_cVQRList",m_cVQRList);
        _h000009E9.Set("cdadata",w_cdadata);
        _h000009E9.Set("c_adata",w_c_adata);
        _h000009E9.Set("codage",w_codage);
        _h000009E9.Set("_bottom",_bottom);
        _h000009E9.Set("_top",_top);
        _h000009E9.Set("ragben",w_ragben);
        _h000009E9.Set("cdareg",w_cdareg);
        _h000009E9.Set("c_areg",w_c_areg);
        _h000009E9.Set("codcli",w_codcli);
        _h000009E9.Set("flgsto",w_flgsto);
        if (Cursor_qbe_frad_chkdiana!=null)
          Cursor_qbe_frad_chkdiana.Close();
        Cursor_qbe_frad_chkdiana = new VQRHolder("qbe_frad_chkdiana",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h000009E9,true).GetResultSet(m_Ctx);
        while ( ! (Cursor_qbe_frad_chkdiana.Eof())) {
          /* _ctotale := _ctotale + 1 */
          _ctotale = CPLib.Round(_ctotale+1,0);
          /* gMsgImp := 'Elaborazione Frazionata N.: '+LRTrim(Str(_ctotale,15,0)) // Messaggio Import */
          gMsgImp = "Elaborazione Frazionata N.: "+CPLib.LRTrim(CPLib.Str(_ctotale,15,0));
          m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
          /* _idereg := arfn_calc_idereg("F",qbe_frad_chkdiana->NUMPROG,qbe_frad_chkdiana->IDEREG) */
          _idereg = arfn_calc_ideregR.Make(m_Ctx,this).Run("F",Cursor_qbe_frad_chkdiana.GetString("NUMPROG"),Cursor_qbe_frad_chkdiana.GetString("IDEREG"));
          /* If qbe_frad_chkdiana->DATAOPE <  CharToDate('20100601') */
          if (CPLib.lt(Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20100601"))) {
            /* _raeatc := 'R' */
            _raeatc = "R";
            /* ElseIf qbe_frad_chkdiana->DATAOPE >  CharToDate('20131231') */
          } else if (CPLib.gt(Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
            /* _raeatc := 'A' */
            _raeatc = "A";
          } else { // Else
            /* _raeatc := w_flgrae */
            _raeatc = w_flgrae;
          } // End If
          /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '1' + _idereg */
          _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"1"+_idereg;
          /* _flagrap := '' */
          _flagrap = "";
          /* If not(Empty(LRTrim(qbe_frad_chkdiana->RAPPORTO))) */
          if ( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("RAPPORTO"))))) {
            // * --- Select from knarapbo
            m_cServer = m_Ctx.GetServer("knarapbo");
            m_cPhName = m_Ctx.GetPhName("knarapbo");
            if (Cursor_knarapbo!=null)
              Cursor_knarapbo.Close();
            Cursor_knarapbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select FLAGRAP  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_frad_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("knarapbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_knarapbo.Eof())) {
              /* _flagrap := knarapbo->FLAGRAP */
              _flagrap = Cursor_knarapbo.GetString("FLAGRAP");
              Cursor_knarapbo.Next();
            }
            m_cConnectivityError = Cursor_knarapbo.ErrorMessage();
            Cursor_knarapbo.Close();
            // * --- End Select
          } // End If
          /* pCodDip := qbe_frad_chkdiana->CODDIPE // Codice Soggetto */
          pCodDip = Cursor_qbe_frad_chkdiana.GetString("CODDIPE");
          /* pCodCab := qbe_frad_chkdiana->CODCAB // Data Operazione */
          pCodCab = Cursor_qbe_frad_chkdiana.GetString("CODCAB");
          /* pDesCit := qbe_frad_chkdiana->DESCCIT // Codice Rapporto */
          pDesCit = Cursor_qbe_frad_chkdiana.GetString("DESCCIT");
          /* pProv := qbe_frad_chkdiana->PROVINCIA // Tipo Rapporto */
          pProv = Cursor_qbe_frad_chkdiana.GetString("PROVINCIA");
          /* Exec "Dati Agenzia" Page 13:Page_17 */
          Page_17();
          /* _note := _note + Left(_datage,44) */
          _note = _note+CPLib.Left(_datage,44);
          /* _numticket := iif(LRTrim(qbe_frad_chkdiana->RIFIMP)='XXXXXXXXX',LibreriaMit.SpacePad(LRTrim(qbe_frad_chkdiana->INFORM),30),LibreriaMit.SpacePad(LRTrim(qbe_frad_chkdiana->RIFIMP),30)) */
          _numticket = (CPLib.eqr(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("RIFIMP")),"XXXXXXXXX")?LibreriaMit.SpacePad(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("INFORM")),30):LibreriaMit.SpacePad(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("RIFIMP")),30));
          /* _note := _note + Left(DateToChar(qbe_frad_chkdiana->DATAOPE)+Space(8),8) + Left(LRTrim(qbe_frad_chkdiana->FLAGFRAZ)+" ",1) + Left(LRTrim(qbe_frad_chkdiana->FLAGCONT)+" ",1) */
          _note = _note+CPLib.Left(CPLib.DateToChar(Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"))+CPLib.Space(8),8)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("FLAGFRAZ"))+" ",1)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("FLAGCONT"))+" ",1);
          /* _note := _note + Left(LRTrim(qbe_frad_chkdiana->CODANA)+Space(4),4) + Left(LRTrim(qbe_frad_chkdiana->CODVOC)+Space(2),2) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("CODANA"))+CPLib.Space(4),4)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("CODVOC"))+CPLib.Space(2),2);
          /* _note := _note + Left(LRTrim(qbe_frad_chkdiana->TIPOINT2)+Space(2),2) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("TIPOINT2"))+CPLib.Space(2),2);
          /* _note := _note + iif(Empty(LRTrim(qbe_frad_chkdiana->CODFISCICP)),Left(LRTrim(qbe_frad_chkdiana->CODINT2)+Space(11),11),Left(LRTrim(qbe_frad_chkdiana->CODFISCICP)+Space(11),11)) */
          _note = _note+(CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("CODFISCICP")))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("CODINT2"))+CPLib.Space(11),11):CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("CODFISCICP"))+CPLib.Space(11),11));
          /* _note := _note + Left(LRTrim(qbe_frad_chkdiana->PAESE)+Space(3),3) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("PAESE"))+CPLib.Space(3),3);
          /* _note := _note + Left(LRTrim(qbe_frad_chkdiana->CODCAB2)+Space(6),6) + Left(LRTrim(qbe_frad_chkdiana->DESC2)+Space(30),30) + Left(LRTrim(qbe_frad_chkdiana->PROV2)+Space(2),2) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("CODCAB2"))+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("DESC2"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("PROV2"))+CPLib.Space(2),2);
          /* _note := _note + Left(LRTrim(qbe_frad_chkdiana->DESCINTER)+Space(50),50) + Left(LRTrim(qbe_frad_chkdiana->RAPPORTO)+Space(25),25) + Left(LRTrim(_flagrap)+" ",1) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("DESCINTER"))+CPLib.Space(50),50)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("RAPPORTO"))+CPLib.Space(25),25)+CPLib.Left(CPLib.LRTrim(_flagrap)+" ",1);
          /* _note := _note + Left(LRTrim(qbe_frad_chkdiana->TIPOLEG)+" ",1) + Left(LRTrim(DateToChar(qbe_frad_chkdiana->DATAREG))+Space(8),8) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("TIPOLEG"))+" ",1)+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_qbe_frad_chkdiana.GetDate("DATAREG")))+CPLib.Space(8),8);
          /* _note := _note + Left(LRTrim(qbe_frad_chkdiana->TIPOOPRAP)+Space(2),2) + Left(LRTrim(qbe_frad_chkdiana->COLLEG)+Space(12),12) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("TIPOOPRAP"))+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("COLLEG"))+CPLib.Space(12),12);
          /* _note := _note + Left(LRTrim(qbe_frad_chkdiana->STATOREG)+" ",1)  */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("STATOREG"))+" ",1);
          /* If Empty(qbe_frad_chkdiana->DATARETT) or DateToChar(qbe_frad_chkdiana->DATARETT)='01000101' */
          if (CPLib.Empty(Cursor_qbe_frad_chkdiana.GetDate("DATARETT")) || CPLib.eqr(CPLib.DateToChar(Cursor_qbe_frad_chkdiana.GetDate("DATARETT")),"01000101")) {
            /* _note := _note + Space(8) */
            _note = _note+CPLib.Space(8);
          } else { // Else
            /* _note := _note + Left(LRTrim(DateToChar(qbe_frad_chkdiana->DATARETT))+Space(8),8) */
            _note = _note+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_qbe_frad_chkdiana.GetDate("DATARETT")))+CPLib.Space(8),8);
          } // End If
          /* If Left(qbe_frad_chkdiana->OPERAZMOD,1)='F' */
          if (CPLib.eqr(CPLib.Left(Cursor_qbe_frad_chkdiana.GetString("OPERAZMOD"),1),"F")) {
            /* _note := _note + iif(Empty(LRTrim(qbe_frad_chkdiana->OPERAZMOD)),Space(20),qbe_frad_chkdiana->OPERAZMOD) */
            _note = _note+(CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("OPERAZMOD")))?CPLib.Space(20):Cursor_qbe_frad_chkdiana.GetString("OPERAZMOD"));
          } else { // Else
            /* _note := _note + iif(Empty(LRTrim(qbe_frad_chkdiana->OPERAZMOD)),Space(20),Left(qbe_frad_chkdiana->OPERAZMOD,8)+"F"+Right(qbe_frad_chkdiana->OPERAZMOD,11)) */
            _note = _note+(CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("OPERAZMOD")))?CPLib.Space(20):CPLib.Left(Cursor_qbe_frad_chkdiana.GetString("OPERAZMOD"),8)+"F"+CPLib.Right(Cursor_qbe_frad_chkdiana.GetString("OPERAZMOD"),11));
          } // End If
          /* _note := _note + arfn_flaglire(qbe_frad_chkdiana->FLAGLIRE,qbe_frad_chkdiana->DATAOPE) + Left(LRTrim(qbe_frad_chkdiana->VALUTA)+Space(3),3) + Left(LRTrim(qbe_frad_chkdiana->SEGNO)+" ",1) */
          _note = _note+arfn_flaglireR.Make(m_Ctx,this).Run(Cursor_qbe_frad_chkdiana.GetString("FLAGLIRE"),Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"))+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("VALUTA"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("SEGNO"))+" ",1);
          /* _note := _note +  Right('000000000000000'+LRTrim(Str(qbe_frad_chkdiana->TOTLIRE,15,0)),15) + Right('000000000000000'+LRTrim(Str(qbe_frad_chkdiana->TOTCONT,15,0)),15) + _numticket + Space(17)+"F"+qbe_frad_chkdiana->NUMPROG+Left(LRTrim(_tipoag)+Space(10),10) */
          _note = _note+CPLib.Right("000000000000000"+CPLib.LRTrim(CPLib.Str(Cursor_qbe_frad_chkdiana.GetDouble("TOTLIRE"),15,0)),15)+CPLib.Right("000000000000000"+CPLib.LRTrim(CPLib.Str(Cursor_qbe_frad_chkdiana.GetDouble("TOTCONT"),15,0)),15)+_numticket+CPLib.Space(17)+"F"+Cursor_qbe_frad_chkdiana.GetString("NUMPROG")+CPLib.Left(CPLib.LRTrim(_tipoag)+CPLib.Space(10),10);
          /* Exec "Scrittura Dati" Page 15:Page_19 */
          Page_19();
          /* nTotRec := nTotRec + 1 */
          nTotRec = CPLib.Round(nTotRec+1,0);
          /* nTotReg := nTotReg + 1 */
          nTotReg = CPLib.Round(nTotReg+1,0);
          /* nNumRec := nNumRec + 1 */
          nNumRec = CPLib.Round(nNumRec+1,0);
          /* If not(Empty(qbe_frad_chkdiana->CONNESCLI)) */
          if ( ! (CPLib.Empty(Cursor_qbe_frad_chkdiana.GetString("CONNESCLI")))) {
            /* _oldrap := '' */
            _oldrap = "";
            /* _codrif := qbe_frad_chkdiana->CONNESCLI */
            _codrif = Cursor_qbe_frad_chkdiana.GetString("CONNESCLI");
            /* If gFlgWU='S' and not(Empty(LRTrim(qbe_frad_chkdiana->CONNESDOC))) */
            if (CPLib.eqr(gFlgWU,"S") &&  ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("CONNESDOC"))))) {
              // * --- Select from kersonbo
              m_cServer = m_Ctx.GetServer("kersonbo");
              m_cPhName = m_Ctx.GetPhName("kersonbo");
              if (Cursor_kersonbo!=null)
                Cursor_kersonbo.Close();
              Cursor_kersonbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CONNES="+CPLib.ToSQL(Cursor_qbe_frad_chkdiana.GetString("CONNESDOC"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("kersonbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
              while ( ! (Cursor_kersonbo.Eof())) {
                /* _ramate := iif(w_flgrae='R',LRTrim(kersonbo->RAMOGRUP),Left(LRTrim(kersonbo->ATTIV),3)) */
                _ramate = (CPLib.eqr(w_flgrae,"R")?CPLib.LRTrim(Cursor_kersonbo.GetString("RAMOGRUP")):CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("ATTIV")),3));
                /* If qbe_frad_chkdiana->DATAOPE > CharToDate('20131231') */
                if (CPLib.gt(Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '7' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                } else { // Else
                  /* If Empty(qbe_frad_chkdiana->CONNESOPER) or (LRTrim(Upper(qbe_frad_chkdiana->CONNESOPER))=LRTrim(Upper(qbe_frad_chkdiana->CONNESCLI))) */
                  if (CPLib.Empty(Cursor_qbe_frad_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(CPLib.LRTrim(CPLib.Upper(Cursor_qbe_frad_chkdiana.GetString("CONNESOPER"))),CPLib.LRTrim(CPLib.Upper(Cursor_qbe_frad_chkdiana.GetString("CONNESCLI")))))) {
                    /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                    _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                  } else { // Else
                    /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                    _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                  } // End If
                } // End If
                /* _note := _note + Left(LRTrim(qbe_frad_chkdiana->CONNESCLI)+Space(16),16) + Left(LRTrim(kersonbo->RAGSOC)+Space(70),70) + Left(LRTrim(kersonbo->PAESE)+Space(3),3) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("CONNESCLI"))+CPLib.Space(16),16)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("RAGSOC"))+CPLib.Space(70),70)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("PAESE"))+CPLib.Space(3),3);
                /* _note := _note + Left(LRTrim(kersonbo->CODCAB)+Space(6),6) + Left(LRTrim(kersonbo->DESCCIT)+Space(30),30) + Left(LRTrim(kersonbo->PROVINCIA)+Space(2),2) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("CODCAB"))+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("DESCCIT"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("PROVINCIA"))+CPLib.Space(2),2);
                /* _note := _note + Left(LRTrim(kersonbo->DOMICILIO)+Space(35),35) + Left(LRTrim(kersonbo->CAP)+ Space(5),5) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("DOMICILIO"))+CPLib.Space(35),35)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("CAP"))+CPLib.Space(5),5);
                /* _note := _note + iif(kersonbo->CFESTERO=1,Space(16),Left(LRTrim(kersonbo->CODFISC)+Space(16),16)) */
                _note = _note+(CPLib.eqr(Cursor_kersonbo.GetDouble("CFESTERO"),1)?CPLib.Space(16):CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("CODFISC"))+CPLib.Space(16),16));
                /* If Empty(kersonbo->DATANASC) or DateToChar(kersonbo->DATANASC)='01000101' */
                if (CPLib.Empty(Cursor_kersonbo.GetDate("DATANASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_kersonbo.GetDate("DATANASC")),"01000101")) {
                  /* _note := _note + Space(8) */
                  _note = _note+CPLib.Space(8);
                } else { // Else
                  /* _note := _note + Left(LRTrim(DateToChar(kersonbo->DATANASC))+Space(8),8) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_kersonbo.GetDate("DATANASC")))+CPLib.Space(8),8);
                } // End If
                /* If not(Empty(kersonbo->NASSTATO)) */
                if ( ! (CPLib.Empty(Cursor_kersonbo.GetString("NASSTATO")))) {
                  /* _note := _note + Left(LRTrim(kersonbo->NASSTATO)+Space(30),30) + Left(LRTrim(kersonbo->SOTGRUP)+Space(3),3) + Left(LRTrim(_ramate)+Space(3),3) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("NASSTATO"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("SOTGRUP"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(_ramate)+CPLib.Space(3),3);
                } else { // Else
                  /* _note := _note + Left(LRTrim(kersonbo->NASCOMUN)+Space(30),30) + Left(LRTrim(kersonbo->SOTGRUP)+Space(3),3) + Left(LRTrim(_ramate) +Space(3),3) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("NASCOMUN"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("SOTGRUP"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(_ramate)+CPLib.Space(3),3);
                } // End If
                /* _note := _note + Left(LRTrim(kersonbo->SETTSINT)+Space(3),3) + Left(LRTrim(qbe_frad_chkdiana->RAPPORTO)+Space(25),25) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("SETTSINT"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("RAPPORTO"))+CPLib.Space(25),25);
                /* _note := _note + Left(LRTrim(qbe_frad_chkdiana->FLAGRAP)+" ",1) + Left(LRTrim(kersonbo->TIPODOC)+Space(2),2) + Left(LRTrim(kersonbo->NUMDOCUM)+Space(15),15) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("FLAGRAP"))+" ",1)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("TIPODOC"))+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("NUMDOCUM"))+CPLib.Space(15),15);
                /* If Empty(kersonbo->DATARILASC) or DateToChar(kersonbo->DATARILASC)='01000101' */
                if (CPLib.Empty(Cursor_kersonbo.GetDate("DATARILASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_kersonbo.GetDate("DATARILASC")),"01000101")) {
                  /* _note := _note + Space(8) */
                  _note = _note+CPLib.Space(8);
                } else { // Else
                  /* _note := _note + Left(LRTrim(DateToChar(kersonbo->DATARILASC))+Space(8),8)  */
                  _note = _note+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_kersonbo.GetDate("DATARILASC")))+CPLib.Space(8),8);
                } // End If
                /* _note := _note + Left(LRTrim(kersonbo->AUTRILASC)+Space(30),30) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("AUTRILASC"))+CPLib.Space(30),30);
                /* _note := _note + Left(LRTrim(kersonbo->SESSO)+" ",1) + Space(34) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("SESSO"))+" ",1)+CPLib.Space(34);
                /* Exec "Scrittura Dati" Page 15:Page_19 */
                Page_19();
                /* nTotRec := nTotRec + 1 */
                nTotRec = CPLib.Round(nTotRec+1,0);
                /* nNumRec := nNumRec + 1 */
                nNumRec = CPLib.Round(nNumRec+1,0);
                Cursor_kersonbo.Next();
              }
              m_cConnectivityError = Cursor_kersonbo.ErrorMessage();
              Cursor_kersonbo.Close();
              // * --- End Select
            } else { // Else
              /* If qbe_frad_chkdiana->DATAOPE > CharToDate('20131231') */
              if (CPLib.gt(Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '7' + _idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                /* pTipoR := '7' // Tipo Riga */
                pTipoR = "7";
              } else { // Else
                /* If Empty(qbe_frad_chkdiana->CONNESOPER) or (LRTrim(Upper(qbe_frad_chkdiana->CONNESOPER))=LRTrim(Upper(qbe_frad_chkdiana->CONNESCLI))) */
                if (CPLib.Empty(Cursor_qbe_frad_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(CPLib.LRTrim(CPLib.Upper(Cursor_qbe_frad_chkdiana.GetString("CONNESOPER"))),CPLib.LRTrim(CPLib.Upper(Cursor_qbe_frad_chkdiana.GetString("CONNESCLI")))))) {
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                  /* pTipoR := '2' // Tipo Riga */
                  pTipoR = "2";
                } else { // Else
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                  /* pTipoR := '3' // Tipo Riga */
                  pTipoR = "3";
                } // End If
              } // End If
              /* pCli := qbe_frad_chkdiana->CONNESCLI // Codice Soggetto */
              pCli = Cursor_qbe_frad_chkdiana.GetString("CONNESCLI");
              /* pDatOpe := iif(w_stoper='R',qbe_frad_chkdiana->DATAREG,qbe_frad_chkdiana->DATAOPE) // Data Operazione */
              pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_frad_chkdiana.GetDate("DATAREG"):Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"));
              /* pRap := qbe_frad_chkdiana->RAPPORTO // Codice Rapporto */
              pRap = Cursor_qbe_frad_chkdiana.GetString("RAPPORTO");
              /* pTRap := qbe_frad_chkdiana->FLAGRAP // Tipo Rapporto */
              pTRap = Cursor_qbe_frad_chkdiana.GetString("FLAGRAP");
              /* pRAE := _raeatc // RAE o ATECO */
              pRAE = _raeatc;
              /* pSTATO := qbe_frad_chkdiana->STATOREG // Stato Registrazione */
              pSTATO = Cursor_qbe_frad_chkdiana.GetString("STATOREG");
              /* pDatRet := qbe_frad_chkdiana->DATARETT // Data Rettifica */
              pDatRet = Cursor_qbe_frad_chkdiana.GetDate("DATARETT");
              /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
              DatiSoggetto();
              /* Exec "Scrittura Dati" Page 15:Page_19 */
              Page_19();
              /* nTotRec := nTotRec + 1 */
              nTotRec = CPLib.Round(nTotRec+1,0);
              /* nNumRec := nNumRec + 1 */
              nNumRec = CPLib.Round(nNumRec+1,0);
            } // End If
          } // End If
          /* If not(Empty(qbe_frad_chkdiana->RAPPORTO)) */
          if ( ! (CPLib.Empty(Cursor_qbe_frad_chkdiana.GetString("RAPPORTO")))) {
            /* _oldrap := '' */
            _oldrap = "";
            // * --- Read from knarapbo
            m_cServer = m_Ctx.GetServer("knarapbo");
            m_cPhName = m_Ctx.GetPhName("knarapbo");
            m_cSql = "";
            m_cSql = m_cSql+"RAPPORTO="+CPSql.SQLValueAdapter(CPLib.ToSQL(Cursor_qbe_frad_chkdiana.GetString("RAPPORTO"),"C",25,0,m_cServer),m_cServer,Cursor_qbe_frad_chkdiana.GetString("RAPPORTO"));
            if (m_Ctx.IsSharedTemp("knarapbo")) {
              m_cSql = m_cSql+" and context_id='"+m_Ctx.GetTempID()+"'";
            }
            if (Read_Cursor!=null)
              Read_Cursor.Close();
            Read_Cursor = m_Sql.Query(m_cServer,"select "+CPLib.GetMultilanguageField("RAPPORTO",m_Ctx,m_cServer)+" from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+m_cSql);
            if ( ! (Read_Cursor.Eof())) {
              _oldrap = Read_Cursor.GetString("RAPPORTO");
              Read_Cursor.Next();
              if ( ! (Read_Cursor.Eof())) {
                Error l_oErrorFault = new Error("Read on knarapbo into routine arrt_chkdiana_all returns two or more records. This item should return only a record.");
                CPStdCounter.Error(l_oErrorFault);
              }
              Read_Cursor.Close();
            } else {
              // Error: no record found!
              _oldrap = "";
              Read_Cursor.Close();
              m_cLastMsgError = "MSG_RECORD_NOT_FOUND";
            }
            /* If not(Empty(_oldrap)) */
            if ( ! (CPLib.Empty(_oldrap))) {
              // * --- Select from intestbo
              m_cServer = m_Ctx.GetServer("intestbo");
              m_cPhName = m_Ctx.GetPhName("intestbo");
              if (Cursor_intestbo!=null)
                Cursor_intestbo.Close();
              Cursor_intestbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_frad_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("intestbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
              while ( ! (Cursor_intestbo.Eof())) {
                /* If qbe_frad_chkdiana->RAPPORTO = intestbo->RAPPORTO */
                if (CPLib.eqr(Cursor_qbe_frad_chkdiana.GetString("RAPPORTO"),Cursor_intestbo.GetString("RAPPORTO"))) {
                  /* _avanza := 0 */
                  _avanza = CPLib.Round(0,0);
                  /* If Empty(intestbo->CODINTER) or intestbo->STATOREG='2' or intestbo->STATOREG='3' */
                  if (CPLib.Empty(Cursor_intestbo.GetString("CODINTER")) || CPLib.eqr(Cursor_intestbo.GetString("STATOREG"),"2") || CPLib.eqr(Cursor_intestbo.GetString("STATOREG"),"3")) {
                    /* _avanza := 1 */
                    _avanza = CPLib.Round(1,0);
                  } // End If
                  /* If intestbo->DATAINI > qbe_frad_chkdiana->DATAOPE */
                  if (CPLib.gt(Cursor_intestbo.GetDate("DATAINI"),Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"))) {
                    /* _avanza := 1 */
                    _avanza = CPLib.Round(1,0);
                  } // End If
                  /* If not(Empty(intestbo->DATAFINE)) and intestbo->DATAFINE < qbe_frad_chkdiana->DATAOPE */
                  if ( ! (CPLib.Empty(Cursor_intestbo.GetDate("DATAFINE"))) && CPLib.lt(Cursor_intestbo.GetDate("DATAFINE"),Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"))) {
                    /* _avanza := 1 */
                    _avanza = CPLib.Round(1,0);
                  } // End If
                  /* If LRTrim(Upper(intestbo->CODINTER))=LRTrim(Upper(qbe_frad_chkdiana->CONNESCLI)) */
                  if (CPLib.eqr(CPLib.LRTrim(CPLib.Upper(Cursor_intestbo.GetString("CODINTER"))),CPLib.LRTrim(CPLib.Upper(Cursor_qbe_frad_chkdiana.GetString("CONNESCLI"))))) {
                    /* _avanza := 1 */
                    _avanza = CPLib.Round(1,0);
                  } // End If
                  /* If _avanza = 0 */
                  if (CPLib.eqr(_avanza,0)) {
                    /* _codrif := intestbo->CODINTER */
                    _codrif = Cursor_intestbo.GetString("CODINTER");
                    /* If qbe_frad_chkdiana->DATAOPE > CharToDate('20131231') */
                    if (CPLib.gt(Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '7' + _idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                      /* pTipoR := '7' // Tipo Riga */
                      pTipoR = "7";
                    } else { // Else
                      /* If Empty(qbe_frad_chkdiana->CONNESOPER) or (qbe_frad_chkdiana->CONNESOPER=intestbo->CODINTER) */
                      if (CPLib.Empty(Cursor_qbe_frad_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(Cursor_qbe_frad_chkdiana.GetString("CONNESOPER"),Cursor_intestbo.GetString("CODINTER")))) {
                        /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                        _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                        /* pTipoR := '2' // Tipo Riga */
                        pTipoR = "2";
                      } else { // Else
                        /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                        _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                        /* pTipoR := '3' // Tipo Riga */
                        pTipoR = "3";
                      } // End If
                    } // End If
                    /* pCli := intestbo->CODINTER // Codice Soggetto */
                    pCli = Cursor_intestbo.GetString("CODINTER");
                    /* pDatOpe := iif(w_stoper='R',qbe_frad_chkdiana->DATAREG,qbe_frad_chkdiana->DATAOPE) // Data Operazione */
                    pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_frad_chkdiana.GetDate("DATAREG"):Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"));
                    /* pRap := qbe_frad_chkdiana->RAPPORTO // Codice Rapporto */
                    pRap = Cursor_qbe_frad_chkdiana.GetString("RAPPORTO");
                    /* pTRap := qbe_frad_chkdiana->FLAGRAP // Tipo Rapporto */
                    pTRap = Cursor_qbe_frad_chkdiana.GetString("FLAGRAP");
                    /* pRAE := _raeatc // RAE o ATECO */
                    pRAE = _raeatc;
                    /* pSTATO := qbe_frad_chkdiana->STATOREG // Stato Registrazione */
                    pSTATO = Cursor_qbe_frad_chkdiana.GetString("STATOREG");
                    /* pDatRet := qbe_frad_chkdiana->DATARETT // Data Rettifica */
                    pDatRet = Cursor_qbe_frad_chkdiana.GetDate("DATARETT");
                    /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                    DatiSoggetto();
                    /* Exec "Scrittura Dati" Page 15:Page_19 */
                    Page_19();
                    /* nTotRec := nTotRec + 1 */
                    nTotRec = CPLib.Round(nTotRec+1,0);
                    /* nNumRec := nNumRec + 1 */
                    nNumRec = CPLib.Round(nNumRec+1,0);
                  } // End If
                } // End If
                Cursor_intestbo.Next();
              }
              m_cConnectivityError = Cursor_intestbo.ErrorMessage();
              Cursor_intestbo.Close();
              // * --- End Select
            } // End If
          } // End If
          /* If not(Empty(LRTrim(_oldrap))) */
          if ( ! (CPLib.Empty(CPLib.LRTrim(_oldrap)))) {
            /* _oldrighe := 0 */
            _oldrighe = CPLib.Round(0,0);
            /* If qbe_frad_chkdiana->STATOREG='3' and _mlientifrz */
            if (CPLib.eqr(Cursor_qbe_frad_chkdiana.GetString("STATOREG"),"3") && _mlientifrz) {
              /* _oldrighe := 0 */
              _oldrighe = CPLib.Round(0,0);
              // * --- Select from mlientifrz
              m_cServer = m_Ctx.GetServer("mlientifrz");
              m_cPhName = m_Ctx.GetPhName("mlientifrz");
              if (Cursor_mlientifrz!=null)
                Cursor_mlientifrz.Close();
              Cursor_mlientifrz = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_frad_chkdiana.GetString("IDBASE"),"?",0,0)+"  and  CODSOG <> "+CPLib.ToSQL(Cursor_qbe_frad_chkdiana.GetString("CONNESCLI"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("mlientifrz")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
              while ( ! (Cursor_mlientifrz.Eof())) {
                /* _oldrighe := 1 */
                _oldrighe = CPLib.Round(1,0);
                /* If qbe_frad_chkdiana->DATAOPE > CharToDate('20131231') */
                if (CPLib.gt(Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '7' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                  /* pTipoR := '7' // Tipo Riga */
                  pTipoR = "7";
                } else { // Else
                  /* If Empty(qbe_frad_chkdiana->CONNESOPER) or (qbe_frad_chkdiana->CONNESOPER=mlientifrz->CODSOG) */
                  if (CPLib.Empty(Cursor_qbe_frad_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(Cursor_qbe_frad_chkdiana.GetString("CONNESOPER"),Cursor_mlientifrz.GetString("CODSOG")))) {
                    /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                    _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                    /* pTipoR := '2' // Tipo Riga */
                    pTipoR = "2";
                  } else { // Else
                    /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                    _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                    /* pTipoR := '3' // Tipo Riga */
                    pTipoR = "3";
                  } // End If
                } // End If
                /* pCli := mlientifrz->CODSOG // Codice Soggetto */
                pCli = Cursor_mlientifrz.GetString("CODSOG");
                /* pDatOpe := iif(w_stoper='R',qbe_frad_chkdiana->DATAREG,qbe_frad_chkdiana->DATAOPE) // Data Operazione */
                pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_frad_chkdiana.GetDate("DATAREG"):Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"));
                /* pRap := qbe_frad_chkdiana->RAPPORTO // Codice Rapporto */
                pRap = Cursor_qbe_frad_chkdiana.GetString("RAPPORTO");
                /* pTRap := qbe_frad_chkdiana->FLAGRAP // Tipo Rapporto */
                pTRap = Cursor_qbe_frad_chkdiana.GetString("FLAGRAP");
                /* pRAE := _raeatc // RAE o ATECO */
                pRAE = _raeatc;
                /* pSTATO := qbe_frad_chkdiana->STATOREG // Stato Registrazione */
                pSTATO = Cursor_qbe_frad_chkdiana.GetString("STATOREG");
                /* pDatRet := qbe_frad_chkdiana->DATARETT // Data Rettifica */
                pDatRet = Cursor_qbe_frad_chkdiana.GetDate("DATARETT");
                /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                DatiSoggetto();
                /* Exec "Scrittura Dati" Page 15:Page_19 */
                Page_19();
                /* nTotRec := nTotRec + 1 */
                nTotRec = CPLib.Round(nTotRec+1,0);
                /* nNumRec := nNumRec + 1 */
                nNumRec = CPLib.Round(nNumRec+1,0);
                Cursor_mlientifrz.Next();
              }
              m_cConnectivityError = Cursor_mlientifrz.ErrorMessage();
              Cursor_mlientifrz.Close();
              // * --- End Select
            } // End If
            /* If _oldrighe=0 and _clientifrz */
            if (CPLib.eqr(_oldrighe,0) && _clientifrz) {
              // * --- Select from clientifrz
              m_cServer = m_Ctx.GetServer("clientifrz");
              m_cPhName = m_Ctx.GetPhName("clientifrz");
              if (Cursor_clientifrz!=null)
                Cursor_clientifrz.Close();
              Cursor_clientifrz = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_frad_chkdiana.GetString("IDBASE"),"?",0,0)+"  and  CODSOG <> "+CPLib.ToSQL(Cursor_qbe_frad_chkdiana.GetString("CONNESCLI"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("clientifrz")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
              while ( ! (Cursor_clientifrz.Eof())) {
                /* _rownum := 0 */
                _rownum = CPLib.Round(0,0);
                // * --- Read from intestbo
                m_cServer = m_Ctx.GetServer("intestbo");
                m_cPhName = m_Ctx.GetPhName("intestbo");
                m_cSql = "";
                m_cSql = m_cSql+"RAPPORTO="+CPSql.SQLValueAdapter(CPLib.ToSQL(Cursor_qbe_frad_chkdiana.GetString("RAPPORTO"),"C",25,0,m_cServer),m_cServer,Cursor_qbe_frad_chkdiana.GetString("RAPPORTO"));
                m_cSql = m_cSql+" and CODINTER="+CPSql.SQLValueAdapter(CPLib.ToSQL(Cursor_clientifrz.GetString("CODSOG"),"C",16,0,m_cServer),m_cServer,Cursor_clientifrz.GetString("CODSOG"));
                if (m_Ctx.IsSharedTemp("intestbo")) {
                  m_cSql = m_cSql+" and context_id='"+m_Ctx.GetTempID()+"'";
                }
                if (Read_Cursor!=null)
                  Read_Cursor.Close();
                Read_Cursor = m_Sql.Query(m_cServer,"select "+CPLib.GetMultilanguageField("CPROWNUM",m_Ctx,m_cServer)+" from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+m_cSql);
                if ( ! (Read_Cursor.Eof())) {
                  _rownum = CPLib.Round(Read_Cursor.GetDouble("CPROWNUM"),0);
                  Read_Cursor.Next();
                  if ( ! (Read_Cursor.Eof())) {
                    Error l_oErrorFault = new Error("Read on intestbo into routine arrt_chkdiana_all returns two or more records. This item should return only a record.");
                    CPStdCounter.Error(l_oErrorFault);
                  }
                  Read_Cursor.Close();
                } else {
                  // Error: no record found!
                  _rownum = 0;
                  Read_Cursor.Close();
                  m_cLastMsgError = "MSG_RECORD_NOT_FOUND";
                }
                /* If _rownum = 0 */
                if (CPLib.eqr(_rownum,0)) {
                  /* If qbe_frad_chkdiana->DATAOPE > CharToDate('20131231') */
                  if (CPLib.gt(Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                    /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '7' + _idereg */
                    _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                    /* pTipoR := '7' // Tipo Riga */
                    pTipoR = "7";
                  } else { // Else
                    /* If Empty(qbe_frad_chkdiana->CONNESOPER) or (qbe_frad_chkdiana->CONNESOPER=clientifrz->CODSOG) */
                    if (CPLib.Empty(Cursor_qbe_frad_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(Cursor_qbe_frad_chkdiana.GetString("CONNESOPER"),Cursor_clientifrz.GetString("CODSOG")))) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                      /* pTipoR := '2' // Tipo Riga */
                      pTipoR = "2";
                    } else { // Else
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                      /* pTipoR := '3' // Tipo Riga */
                      pTipoR = "3";
                    } // End If
                  } // End If
                  /* pCli := clientifrz->CODSOG // Codice Soggetto */
                  pCli = Cursor_clientifrz.GetString("CODSOG");
                  /* pDatOpe := iif(w_stoper='R',qbe_frad_chkdiana->DATAREG,qbe_frad_chkdiana->DATAOPE) // Data Operazione */
                  pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_frad_chkdiana.GetDate("DATAREG"):Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"));
                  /* pRap := qbe_frad_chkdiana->RAPPORTO // Codice Rapporto */
                  pRap = Cursor_qbe_frad_chkdiana.GetString("RAPPORTO");
                  /* pTRap := qbe_frad_chkdiana->FLAGRAP // Tipo Rapporto */
                  pTRap = Cursor_qbe_frad_chkdiana.GetString("FLAGRAP");
                  /* pRAE := _raeatc // RAE o ATECO */
                  pRAE = _raeatc;
                  /* pSTATO := qbe_frad_chkdiana->STATOREG // Stato Registrazione */
                  pSTATO = Cursor_qbe_frad_chkdiana.GetString("STATOREG");
                  /* pDatRet := qbe_frad_chkdiana->DATARETT // Data Rettifica */
                  pDatRet = Cursor_qbe_frad_chkdiana.GetDate("DATARETT");
                  /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                  DatiSoggetto();
                  /* Exec "Scrittura Dati" Page 15:Page_19 */
                  Page_19();
                  /* nTotRec := nTotRec + 1 */
                  nTotRec = CPLib.Round(nTotRec+1,0);
                  /* nNumRec := nNumRec + 1 */
                  nNumRec = CPLib.Round(nNumRec+1,0);
                } // End If
                Cursor_clientifrz.Next();
              }
              m_cConnectivityError = Cursor_clientifrz.ErrorMessage();
              Cursor_clientifrz.Close();
              // * --- End Select
            } // End If
          } // End If
          /* If not(Empty(qbe_frad_chkdiana->CONNESOPER)) and qbe_frad_chkdiana->CONNESOPER <> _codrif */
          if ( ! (CPLib.Empty(Cursor_qbe_frad_chkdiana.GetString("CONNESOPER"))) && CPLib.ne(Cursor_qbe_frad_chkdiana.GetString("CONNESOPER"),_codrif)) {
            /* If qbe_frad_chkdiana->DATAOPE > CharToDate('20131231') */
            if (CPLib.gt(Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '8' + _idereg */
              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"8"+_idereg;
              /* pTipoR := '8' // Tipo Riga */
              pTipoR = "8";
            } else { // Else
              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '4' + _idereg */
              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"4"+_idereg;
              /* pTipoR := '4' // Tipo Riga */
              pTipoR = "4";
            } // End If
            /* pCli := qbe_frad_chkdiana->CONNESOPER // Codice Soggetto */
            pCli = Cursor_qbe_frad_chkdiana.GetString("CONNESOPER");
            /* pDatOpe := iif(w_stoper='R',qbe_frad_chkdiana->DATAREG,qbe_frad_chkdiana->DATAOPE) // Data Operazione */
            pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_frad_chkdiana.GetDate("DATAREG"):Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"));
            /* pRap := qbe_frad_chkdiana->RAPPORTO // Codice Rapporto */
            pRap = Cursor_qbe_frad_chkdiana.GetString("RAPPORTO");
            /* pTRap := qbe_frad_chkdiana->FLAGRAP // Tipo Rapporto */
            pTRap = Cursor_qbe_frad_chkdiana.GetString("FLAGRAP");
            /* pRAE := _raeatc // RAE o ATECO */
            pRAE = _raeatc;
            /* pSTATO := qbe_frad_chkdiana->STATOREG // Stato Registrazione */
            pSTATO = Cursor_qbe_frad_chkdiana.GetString("STATOREG");
            /* pDatRet := qbe_frad_chkdiana->DATARETT // Data Rettifica */
            pDatRet = Cursor_qbe_frad_chkdiana.GetDate("DATARETT");
            /* _oldmc := _usemc */
            _oldmc = CPLib.Round(_usemc,0);
            /* _usemc := 0 */
            _usemc = CPLib.Round(0,0);
            /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
            DatiSoggetto();
            /* _usemc := _oldmc */
            _usemc = CPLib.Round(_oldmc,0);
            /* Exec "Scrittura Dati" Page 15:Page_19 */
            Page_19();
            /* nTotRec := nTotRec + 1 */
            nTotRec = CPLib.Round(nTotRec+1,0);
            /* nNumRec := nNumRec + 1 */
            nNumRec = CPLib.Round(nNumRec+1,0);
          } // End If
          /* _oldrighe := 0 */
          _oldrighe = CPLib.Round(0,0);
          /* If qbe_frad_chkdiana->STATOREG='3' and _mogopefbo */
          if (CPLib.eqr(Cursor_qbe_frad_chkdiana.GetString("STATOREG"),"3") && _mogopefbo) {
            // * --- Select from mogopefbo
            m_cServer = m_Ctx.GetServer("mogopefbo");
            m_cPhName = m_Ctx.GetPhName("mogopefbo");
            if (Cursor_mogopefbo!=null)
              Cursor_mogopefbo.Close();
            Cursor_mogopefbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_frad_chkdiana.GetString("IDBASE"),"?",0,0)+"  and  CODSOG <> "+CPLib.ToSQL(Cursor_qbe_frad_chkdiana.GetString("CONNESOPER"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("mogopefbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_mogopefbo.Eof())) {
              /* _oldrighe := 1 */
              _oldrighe = CPLib.Round(1,0);
              /* If qbe_frad_chkdiana->DATAOPE > CharToDate('20131231') */
              if (CPLib.gt(Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '8' + _idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"8"+_idereg;
                /* pTipoR := '8' // Tipo Riga */
                pTipoR = "8";
              } else { // Else
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '4' + _idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"4"+_idereg;
                /* pTipoR := '4' // Tipo Riga */
                pTipoR = "4";
              } // End If
              /* pCli := mogopefbo->CODSOG // Codice Soggetto */
              pCli = Cursor_mogopefbo.GetString("CODSOG");
              /* pDatOpe := iif(w_stoper='R',qbe_frad_chkdiana->DATAREG,qbe_frad_chkdiana->DATAOPE) // Data Operazione */
              pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_frad_chkdiana.GetDate("DATAREG"):Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"));
              /* pRap := qbe_frad_chkdiana->RAPPORTO // Codice Rapporto */
              pRap = Cursor_qbe_frad_chkdiana.GetString("RAPPORTO");
              /* pTRap := qbe_frad_chkdiana->FLAGRAP // Tipo Rapporto */
              pTRap = Cursor_qbe_frad_chkdiana.GetString("FLAGRAP");
              /* pRAE := _raeatc // RAE o ATECO */
              pRAE = _raeatc;
              /* pSTATO := qbe_frad_chkdiana->STATOREG // Stato Registrazione */
              pSTATO = Cursor_qbe_frad_chkdiana.GetString("STATOREG");
              /* pDatRet := qbe_frad_chkdiana->DATARETT // Data Rettifica */
              pDatRet = Cursor_qbe_frad_chkdiana.GetDate("DATARETT");
              /* _oldmc := _usemc */
              _oldmc = CPLib.Round(_usemc,0);
              /* _usemc := 0 */
              _usemc = CPLib.Round(0,0);
              /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
              DatiSoggetto();
              /* _usemc := _oldmc */
              _usemc = CPLib.Round(_oldmc,0);
              /* Exec "Scrittura Dati" Page 15:Page_19 */
              Page_19();
              /* nTotRec := nTotRec + 1 */
              nTotRec = CPLib.Round(nTotRec+1,0);
              /* nNumRec := nNumRec + 1 */
              nNumRec = CPLib.Round(nNumRec+1,0);
              Cursor_mogopefbo.Next();
            }
            m_cConnectivityError = Cursor_mogopefbo.ErrorMessage();
            Cursor_mogopefbo.Close();
            // * --- End Select
          } // End If
          /* If _oldrighe=0 and _sogopefbo */
          if (CPLib.eqr(_oldrighe,0) && _sogopefbo) {
            // * --- Select from sogopefbo
            m_cServer = m_Ctx.GetServer("sogopefbo");
            m_cPhName = m_Ctx.GetPhName("sogopefbo");
            if (Cursor_sogopefbo!=null)
              Cursor_sogopefbo.Close();
            Cursor_sogopefbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_frad_chkdiana.GetString("IDBASE"),"?",0,0)+"  and  CODSOG <> "+CPLib.ToSQL(Cursor_qbe_frad_chkdiana.GetString("CONNESOPER"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("sogopefbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_sogopefbo.Eof())) {
              /* If qbe_frad_chkdiana->DATAOPE > CharToDate('20131231') */
              if (CPLib.gt(Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '8' + _idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"8"+_idereg;
                /* pTipoR := '8' // Tipo Riga */
                pTipoR = "8";
              } else { // Else
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '4' + _idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"4"+_idereg;
                /* pTipoR := '4' // Tipo Riga */
                pTipoR = "4";
              } // End If
              /* pCli := sogopefbo->CODSOG // Codice Soggetto */
              pCli = Cursor_sogopefbo.GetString("CODSOG");
              /* pDatOpe := iif(w_stoper='R',qbe_frad_chkdiana->DATAREG,qbe_frad_chkdiana->DATAOPE) // Data Operazione */
              pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_frad_chkdiana.GetDate("DATAREG"):Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"));
              /* pRap := qbe_frad_chkdiana->RAPPORTO // Codice Rapporto */
              pRap = Cursor_qbe_frad_chkdiana.GetString("RAPPORTO");
              /* pTRap := qbe_frad_chkdiana->FLAGRAP // Tipo Rapporto */
              pTRap = Cursor_qbe_frad_chkdiana.GetString("FLAGRAP");
              /* pRAE := _raeatc // RAE o ATECO */
              pRAE = _raeatc;
              /* pSTATO := qbe_frad_chkdiana->STATOREG // Stato Registrazione */
              pSTATO = Cursor_qbe_frad_chkdiana.GetString("STATOREG");
              /* pDatRet := qbe_frad_chkdiana->DATARETT // Data Rettifica */
              pDatRet = Cursor_qbe_frad_chkdiana.GetDate("DATARETT");
              /* _oldmc := _usemc */
              _oldmc = CPLib.Round(_usemc,0);
              /* _usemc := 0 */
              _usemc = CPLib.Round(0,0);
              /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
              DatiSoggetto();
              /* _usemc := _oldmc */
              _usemc = CPLib.Round(_oldmc,0);
              /* Exec "Scrittura Dati" Page 15:Page_19 */
              Page_19();
              /* nTotRec := nTotRec + 1 */
              nTotRec = CPLib.Round(nTotRec+1,0);
              /* nNumRec := nNumRec + 1 */
              nNumRec = CPLib.Round(nNumRec+1,0);
              Cursor_sogopefbo.Next();
            }
            m_cConnectivityError = Cursor_sogopefbo.ErrorMessage();
            Cursor_sogopefbo.Close();
            // * --- End Select
          } // End If
          /* If not(Empty(qbe_frad_chkdiana->CONNESBEN)) or not(Empty(qbe_frad_chkdiana->C_RAG)) */
          if ( ! (CPLib.Empty(Cursor_qbe_frad_chkdiana.GetString("CONNESBEN"))) ||  ! (CPLib.Empty(Cursor_qbe_frad_chkdiana.GetString("C_RAG")))) {
            /* If not(Empty(qbe_frad_chkdiana->C_RAG)) */
            if ( ! (CPLib.Empty(Cursor_qbe_frad_chkdiana.GetString("C_RAG")))) {
              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
              /* _note := _note + Left(LRTrim(qbe_frad_chkdiana->CONNESBEN)+Space(16),16) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("CONNESBEN"))+CPLib.Space(16),16);
              /* _note := _note +Left(LRTrim(qbe_frad_chkdiana->C_RAG)+Space(70),70) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_RAG"))+CPLib.Space(70),70);
              /* _note := _note + Left(LRTrim(qbe_frad_chkdiana->C_STA)+Space(3),3) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_STA"))+CPLib.Space(3),3);
              /* _note := _note +Left(LRTrim(qbe_frad_chkdiana->C_CAB)+Space(6),6) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_CAB"))+CPLib.Space(6),6);
              /* _note := _note +Left(LRTrim(qbe_frad_chkdiana->C_CTA)+Space(30),30) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_CTA"))+CPLib.Space(30),30);
              /* _note := _note + Left(LRTrim(qbe_frad_chkdiana->C_PRV)+Space(2),2) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_PRV"))+CPLib.Space(2),2);
              /* _note := _note + Left(LRTrim(qbe_frad_chkdiana->C_IND)+Space(35),35) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_IND"))+CPLib.Space(35),35);
              /* _note := _note + Left(LRTrim(qbe_frad_chkdiana->C_CAP)+Space(5),5) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_CAP"))+CPLib.Space(5),5);
              /* _note := _note + Space(63) */
              _note = _note+CPLib.Space(63);
              /* _note := _note + Left(LRTrim(qbe_frad_chkdiana->C_RAPPORTO)+Space(25),25) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_RAPPORTO"))+CPLib.Space(25),25);
              /* _note := _note + Space(91) */
              _note = _note+CPLib.Space(91);
              /* Exec "Scrittura Dati" Page 15:Page_19 */
              Page_19();
              /* nTotRec := nTotRec + 1 */
              nTotRec = CPLib.Round(nTotRec+1,0);
              /* nNumRec := nNumRec + 1 */
              nNumRec = CPLib.Round(nNumRec+1,0);
              /* ElseIf not(Empty(qbe_frad_chkdiana->CONNESBEN)) */
            } else if ( ! (CPLib.Empty(Cursor_qbe_frad_chkdiana.GetString("CONNESBEN")))) {
              /* _numsto := arfn_chkspers(qbe_frad_chkdiana->CONNESBEN,iif(w_stoper='R',qbe_frad_chkdiana->DATAREG,qbe_frad_chkdiana->DATAOPE)) */
              _numsto = arfn_chkspersR.Make(m_Ctx,this).Run(Cursor_qbe_frad_chkdiana.GetString("CONNESBEN"),(CPLib.eqr(w_stoper,"R")?Cursor_qbe_frad_chkdiana.GetDate("DATAREG"):Cursor_qbe_frad_chkdiana.GetDate("DATAOPE")));
              /* If Empty(LRTrim(_numsto)) */
              if (CPLib.Empty(CPLib.LRTrim(_numsto))) {
                // * --- Select from personbo
                m_cServer = m_Ctx.GetServer("personbo");
                m_cPhName = m_Ctx.GetPhName("personbo");
                if (Cursor_personbo!=null)
                  Cursor_personbo.Close();
                Cursor_personbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CONNES="+CPLib.ToSQL(Cursor_qbe_frad_chkdiana.GetString("CONNESBEN"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("personbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                while ( ! (Cursor_personbo.Eof())) {
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
                  /* _note := _note + Left(LRTrim(qbe_frad_chkdiana->CONNESBEN)+Space(16),16) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("CONNESBEN"))+CPLib.Space(16),16);
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frad_chkdiana->C_RAG))),Left(LRTrim(qbe_frad_chkdiana->C_RAG)+Space(70),70),Left(LRTrim(personbo->RAGSOC)+Space(70),70)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_RAG"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_RAG"))+CPLib.Space(70),70):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("RAGSOC"))+CPLib.Space(70),70));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frad_chkdiana->C_STA))),Left(LRTrim(qbe_frad_chkdiana->C_STA)+Space(3),3),Left(LRTrim(personbo->PAESE)+Space(3),3)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_STA"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_STA"))+CPLib.Space(3),3):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PAESE"))+CPLib.Space(3),3));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frad_chkdiana->C_CAB))),Left(LRTrim(qbe_frad_chkdiana->C_CAB)+Space(6),6),Left(LRTrim(personbo->CODCAB)+Space(6),6)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_CAB"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_CAB"))+CPLib.Space(6),6):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CODCAB"))+CPLib.Space(6),6));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frad_chkdiana->C_CTA))),Left(LRTrim(qbe_frad_chkdiana->C_CTA)+Space(30),30),Left(LRTrim(personbo->DESCCIT)+Space(30),30)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_CTA"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_CTA"))+CPLib.Space(30),30):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DESCCIT"))+CPLib.Space(30),30));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frad_chkdiana->C_PRV))),Left(LRTrim(qbe_frad_chkdiana->C_PRV)+Space(2),2),Left(LRTrim(personbo->PROVINCIA)+Space(2),2)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_PRV"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_PRV"))+CPLib.Space(2),2):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PROVINCIA"))+CPLib.Space(2),2));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frad_chkdiana->C_IND))),Left(LRTrim(qbe_frad_chkdiana->C_IND)+Space(35),35),Left(LRTrim(personbo->DOMICILIO)+Space(35),35)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_IND"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_IND"))+CPLib.Space(35),35):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DOMICILIO"))+CPLib.Space(35),35));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frad_chkdiana->C_CAP))),Left(LRTrim(qbe_frad_chkdiana->C_CAP)+Space(5),5),Left(LRTrim(personbo->CAP)+Space(5),5)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_CAP"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_CAP"))+CPLib.Space(5),5):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CAP"))+CPLib.Space(5),5));
                  /* _note := _note + Space(63) */
                  _note = _note+CPLib.Space(63);
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frad_chkdiana->C_RAPPORTO))),Left(LRTrim(qbe_frad_chkdiana->C_RAPPORTO)+Space(25),25),Left(LRTrim(qbe_frad_chkdiana->RAPPORTBEN)+Space(25),25)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_RAPPORTO"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_RAPPORTO"))+CPLib.Space(25),25):CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("RAPPORTBEN"))+CPLib.Space(25),25));
                  /* _note := _note + Space(91) */
                  _note = _note+CPLib.Space(91);
                  /* Exec "Scrittura Dati" Page 15:Page_19 */
                  Page_19();
                  /* nTotRec := nTotRec + 1 */
                  nTotRec = CPLib.Round(nTotRec+1,0);
                  /* nNumRec := nNumRec + 1 */
                  nNumRec = CPLib.Round(nNumRec+1,0);
                  Cursor_personbo.Next();
                }
                m_cConnectivityError = Cursor_personbo.ErrorMessage();
                Cursor_personbo.Close();
                // * --- End Select
              } else { // Else
                // * --- Select from wersonbo
                m_cServer = m_Ctx.GetServer("wersonbo");
                m_cPhName = m_Ctx.GetPhName("wersonbo");
                if (Cursor_wersonbo!=null)
                  Cursor_wersonbo.Close();
                Cursor_wersonbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"sanumpro="+CPSql.SQLValueAdapter(CPLib.ToSQL(_numsto,"?",0,0,m_cServer, m_oParameters),m_cServer,_numsto)+" "+")"+(m_Ctx.IsSharedTemp("wersonbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                while ( ! (Cursor_wersonbo.Eof())) {
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5";
                  /* If Empty(LRTrim(qbe_frad_chkdiana->FLAGRAP2)) */
                  if (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("FLAGRAP2")))) {
                    /* _note := _note + DateToChar(qbe_frad_chkdiana->DATAOPE) + qbe_frad_chkdiana->NUMPROG + 'S' */
                    _note = _note+CPLib.DateToChar(Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"))+Cursor_qbe_frad_chkdiana.GetString("NUMPROG")+"S";
                  } else { // Else
                    /* _note := _note + qbe_frad_chkdiana->IDEREG */
                    _note = _note+Cursor_qbe_frad_chkdiana.GetString("IDEREG");
                  } // End If
                  /* _note := _note + Left(LRTrim(qbe_frad_chkdiana->CONNESBEN)+Space(16),16) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("CONNESBEN"))+CPLib.Space(16),16);
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frad_chkdiana->C_RAG))),Left(LRTrim(qbe_frad_chkdiana->C_RAG)+Space(70),70),Left(LRTrim(wersonbo->RAGSOC)+Space(70),70)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_RAG"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_RAG"))+CPLib.Space(70),70):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("RAGSOC"))+CPLib.Space(70),70));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frad_chkdiana->C_STA))),Left(LRTrim(qbe_frad_chkdiana->C_STA)+Space(3),3),Left(LRTrim(wersonbo->PAESE)+Space(3),3)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_STA"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_STA"))+CPLib.Space(3),3):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PAESE"))+CPLib.Space(3),3));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frad_chkdiana->C_CAB))),Left(LRTrim(qbe_frad_chkdiana->C_CAB)+Space(6),6),Left(LRTrim(wersonbo->CODCAB)+Space(6),6)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_CAB"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_CAB"))+CPLib.Space(6),6):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CODCAB"))+CPLib.Space(6),6));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frad_chkdiana->C_CTA))),Left(LRTrim(qbe_frad_chkdiana->C_CTA)+Space(30),30),Left(LRTrim(wersonbo->DESCCIT)+Space(30),30)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_CTA"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_CTA"))+CPLib.Space(30),30):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DESCCIT"))+CPLib.Space(30),30));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frad_chkdiana->C_PRV))),Left(LRTrim(qbe_frad_chkdiana->C_PRV)+Space(2),2),Left(LRTrim(wersonbo->PROVINCIA)+Space(2),2)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_PRV"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_PRV"))+CPLib.Space(2),2):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PROVINCIA"))+CPLib.Space(2),2));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frad_chkdiana->C_IND))),Left(LRTrim(qbe_frad_chkdiana->C_IND)+Space(35),35),Left(LRTrim(wersonbo->DOMICILIO)+Space(35),35)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_IND"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_IND"))+CPLib.Space(35),35):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DOMICILIO"))+CPLib.Space(35),35));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frad_chkdiana->C_CAP))),Left(LRTrim(qbe_frad_chkdiana->C_CAP)+Space(5),5),Left(LRTrim(wersonbo->CAP)+Space(5),5)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_CAP"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_CAP"))+CPLib.Space(5),5):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CAP"))+CPLib.Space(5),5));
                  /* _note := _note + Space(63) */
                  _note = _note+CPLib.Space(63);
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frad_chkdiana->C_RAPPORTO))),Left(LRTrim(qbe_frad_chkdiana->C_RAPPORTO)+Space(25),25),Left(LRTrim(qbe_frad_chkdiana->RAPPORTBEN)+Space(25),25)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_RAPPORTO"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("C_RAPPORTO"))+CPLib.Space(25),25):CPLib.Left(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("RAPPORTBEN"))+CPLib.Space(25),25));
                  /* _note := _note + Space(91) */
                  _note = _note+CPLib.Space(91);
                  /* FileLibMit.Write(fhand,Left(LRTrim(_note)+Space(380),380) + LibreriaMit.CloseLine()) */
                  FileLibMit.Write(fhand,CPLib.Left(CPLib.LRTrim(_note)+CPLib.Space(380),380)+LibreriaMit.CloseLine());
                  /* nTotRec := nTotRec + 1 */
                  nTotRec = CPLib.Round(nTotRec+1,0);
                  /* nNumRec := nNumRec + 1 */
                  nNumRec = CPLib.Round(nNumRec+1,0);
                  Cursor_wersonbo.Next();
                }
                m_cConnectivityError = Cursor_wersonbo.ErrorMessage();
                Cursor_wersonbo.Close();
                // * --- End Select
              } // End If
            } // End If
          } // End If
          /* _oldrighe := 0 */
          _oldrighe = CPLib.Round(0,0);
          /* If qbe_frad_chkdiana->STATOREG='3' and _meneficfrz */
          if (CPLib.eqr(Cursor_qbe_frad_chkdiana.GetString("STATOREG"),"3") && _meneficfrz) {
            // * --- Select from meneficfrz
            m_cServer = m_Ctx.GetServer("meneficfrz");
            m_cPhName = m_Ctx.GetPhName("meneficfrz");
            if (Cursor_meneficfrz!=null)
              Cursor_meneficfrz.Close();
            Cursor_meneficfrz = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_frad_chkdiana.GetString("IDBASE"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("meneficfrz")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_meneficfrz.Eof())) {
              /* _oldrighe := 1 */
              _oldrighe = CPLib.Round(1,0);
              /* If Empty(LRTrim(meneficfrz->CODSOG)) and not(Empty(LRTrim(meneficfrz->C_RAG))) */
              if (CPLib.Empty(CPLib.LRTrim(Cursor_meneficfrz.GetString("CODSOG"))) &&  ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_RAG"))))) {
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
                /* _note := _note + Left(LRTrim(meneficfrz->CODSOG)+Space(16),16) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("CODSOG"))+CPLib.Space(16),16);
                /* _note := _note +Left(LRTrim(meneficfrz->C_RAG)+Space(70),70) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_RAG"))+CPLib.Space(70),70);
                /* _note := _note + Left(LRTrim(meneficfrz->C_STA)+Space(3),3) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_STA"))+CPLib.Space(3),3);
                /* _note := _note +Left(LRTrim(meneficfrz->C_CAB)+Space(6),6) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_CAB"))+CPLib.Space(6),6);
                /* _note := _note +Left(LRTrim(meneficfrz->C_CTA)+Space(30),30) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_CTA"))+CPLib.Space(30),30);
                /* _note := _note + Left(LRTrim(meneficfrz->C_PRV)+Space(2),2) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_PRV"))+CPLib.Space(2),2);
                /* _note := _note + Left(LRTrim(meneficfrz->C_IND)+Space(35),35) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_IND"))+CPLib.Space(35),35);
                /* _note := _note + Left(LRTrim(meneficfrz->C_CAP)+Space(5),5) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_CAP"))+CPLib.Space(5),5);
                /* _note := _note + Space(63) */
                _note = _note+CPLib.Space(63);
                /* _note := _note + Left(LRTrim(meneficfrz->C_RAPPORTO)+Space(25),25) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_RAPPORTO"))+CPLib.Space(25),25);
                /* _note := _note + Space(91) */
                _note = _note+CPLib.Space(91);
                /* Exec "Scrittura Dati" Page 15:Page_19 */
                Page_19();
                /* nTotRec := nTotRec + 1 */
                nTotRec = CPLib.Round(nTotRec+1,0);
                /* nNumRec := nNumRec + 1 */
                nNumRec = CPLib.Round(nNumRec+1,0);
              } else { // Else
                /* If meneficfrz->CODSOG <> qbe_frad_chkdiana->CONNESBEN */
                if (CPLib.ne(Cursor_meneficfrz.GetString("CODSOG"),Cursor_qbe_frad_chkdiana.GetString("CONNESBEN"))) {
                  /* _numsto := arfn_chkspers(meneficfrz->CODSOG,iif(w_stoper='R',qbe_frad_chkdiana->DATAREG,qbe_frad_chkdiana->DATAOPE)) */
                  _numsto = arfn_chkspersR.Make(m_Ctx,this).Run(Cursor_meneficfrz.GetString("CODSOG"),(CPLib.eqr(w_stoper,"R")?Cursor_qbe_frad_chkdiana.GetDate("DATAREG"):Cursor_qbe_frad_chkdiana.GetDate("DATAOPE")));
                  /* If Empty(LRTrim(_numsto)) */
                  if (CPLib.Empty(CPLib.LRTrim(_numsto))) {
                    // * --- Select from personbo
                    m_cServer = m_Ctx.GetServer("personbo");
                    m_cPhName = m_Ctx.GetPhName("personbo");
                    if (Cursor_personbo!=null)
                      Cursor_personbo.Close();
                    Cursor_personbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CONNES="+CPLib.ToSQL(Cursor_meneficfrz.GetString("CODSOG"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("personbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                    while ( ! (Cursor_personbo.Eof())) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
                      /* _note := _note + Left(LRTrim(meneficfrz->CODSOG)+Space(16),16) */
                      _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("CODSOG"))+CPLib.Space(16),16);
                      /* _note := _note + iif(not(Empty(LRTrim(meneficfrz->C_RAG))),Left(LRTrim(meneficfrz->C_RAG)+Space(70),70),Left(LRTrim(personbo->RAGSOC)+Space(70),70)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_RAG"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_RAG"))+CPLib.Space(70),70):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("RAGSOC"))+CPLib.Space(70),70));
                      /* _note := _note + iif(not(Empty(LRTrim(meneficfrz->C_STA))),Left(LRTrim(meneficfrz->C_STA)+Space(3),3),Left(LRTrim(personbo->PAESE)+Space(3),3)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_STA"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_STA"))+CPLib.Space(3),3):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PAESE"))+CPLib.Space(3),3));
                      /* _note := _note + iif(not(Empty(LRTrim(meneficfrz->C_CAB))),Left(LRTrim(meneficfrz->C_CAB)+Space(6),6),Left(LRTrim(personbo->CODCAB)+Space(6),6)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_CAB"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_CAB"))+CPLib.Space(6),6):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CODCAB"))+CPLib.Space(6),6));
                      /* _note := _note + iif(not(Empty(LRTrim(meneficfrz->C_CTA))),Left(LRTrim(meneficfrz->C_CTA)+Space(30),30),Left(LRTrim(personbo->DESCCIT)+Space(30),30)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_CTA"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_CTA"))+CPLib.Space(30),30):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DESCCIT"))+CPLib.Space(30),30));
                      /* _note := _note + iif(not(Empty(LRTrim(meneficfrz->C_PRV))),Left(LRTrim(meneficfrz->C_PRV)+Space(2),2),Left(LRTrim(personbo->PROVINCIA)+Space(2),2)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_PRV"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_PRV"))+CPLib.Space(2),2):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PROVINCIA"))+CPLib.Space(2),2));
                      /* _note := _note + iif(not(Empty(LRTrim(meneficfrz->C_IND))),Left(LRTrim(meneficfrz->C_IND)+Space(35),35),Left(LRTrim(personbo->DOMICILIO)+Space(35),35)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_IND"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_IND"))+CPLib.Space(35),35):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DOMICILIO"))+CPLib.Space(35),35));
                      /* _note := _note + iif(not(Empty(LRTrim(meneficfrz->C_CAP))),Left(LRTrim(meneficfrz->C_CAP)+Space(5),5),Left(LRTrim(personbo->CAP)+Space(5),5)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_CAP"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_CAP"))+CPLib.Space(5),5):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CAP"))+CPLib.Space(5),5));
                      /* _note := _note + Space(63) */
                      _note = _note+CPLib.Space(63);
                      /* _note := _note +Left(LRTrim(meneficfrz->C_RAPPORTO)+Space(25),25) */
                      _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_RAPPORTO"))+CPLib.Space(25),25);
                      /* _note := _note + Space(91) */
                      _note = _note+CPLib.Space(91);
                      /* Exec "Scrittura Dati" Page 15:Page_19 */
                      Page_19();
                      /* nTotRec := nTotRec + 1 */
                      nTotRec = CPLib.Round(nTotRec+1,0);
                      /* nNumRec := nNumRec + 1 */
                      nNumRec = CPLib.Round(nNumRec+1,0);
                      Cursor_personbo.Next();
                    }
                    m_cConnectivityError = Cursor_personbo.ErrorMessage();
                    Cursor_personbo.Close();
                    // * --- End Select
                  } else { // Else
                    // * --- Select from wersonbo
                    m_cServer = m_Ctx.GetServer("wersonbo");
                    m_cPhName = m_Ctx.GetPhName("wersonbo");
                    if (Cursor_wersonbo!=null)
                      Cursor_wersonbo.Close();
                    Cursor_wersonbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"sanumpro="+CPSql.SQLValueAdapter(CPLib.ToSQL(_numsto,"?",0,0,m_cServer, m_oParameters),m_cServer,_numsto)+" "+")"+(m_Ctx.IsSharedTemp("wersonbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                    while ( ! (Cursor_wersonbo.Eof())) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5";
                      /* If Empty(LRTrim(qbe_frad_chkdiana->FLAGRAP2)) */
                      if (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("FLAGRAP2")))) {
                        /* _note := _note + DateToChar(qbe_frad_chkdiana->DATAOPE) + qbe_frad_chkdiana->NUMPROG + 'S' */
                        _note = _note+CPLib.DateToChar(Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"))+Cursor_qbe_frad_chkdiana.GetString("NUMPROG")+"S";
                      } else { // Else
                        /* _note := _note + qbe_frad_chkdiana->IDEREG */
                        _note = _note+Cursor_qbe_frad_chkdiana.GetString("IDEREG");
                      } // End If
                      /* _note := _note + Left(LRTrim(meneficfrz->CODSOG)+Space(16),16) */
                      _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("CODSOG"))+CPLib.Space(16),16);
                      /* _note := _note + iif(not(Empty(LRTrim(meneficfrz->C_RAG))),Left(LRTrim(meneficfrz->C_RAG)+Space(70),70),Left(LRTrim(wersonbo->RAGSOC)+Space(70),70)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_RAG"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_RAG"))+CPLib.Space(70),70):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("RAGSOC"))+CPLib.Space(70),70));
                      /* _note := _note + iif(not(Empty(LRTrim(meneficfrz->C_STA))),Left(LRTrim(meneficfrz->C_STA)+Space(3),3),Left(LRTrim(wersonbo->PAESE)+Space(3),3)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_STA"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_STA"))+CPLib.Space(3),3):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PAESE"))+CPLib.Space(3),3));
                      /* _note := _note + iif(not(Empty(LRTrim(meneficfrz->C_CAB))),Left(LRTrim(meneficfrz->C_CAB)+Space(6),6),Left(LRTrim(wersonbo->CODCAB)+Space(6),6)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_CAB"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_CAB"))+CPLib.Space(6),6):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CODCAB"))+CPLib.Space(6),6));
                      /* _note := _note + iif(not(Empty(LRTrim(meneficfrz->C_CTA))),Left(LRTrim(meneficfrz->C_CTA)+Space(30),30),Left(LRTrim(wersonbo->DESCCIT)+Space(30),30)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_CTA"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_CTA"))+CPLib.Space(30),30):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DESCCIT"))+CPLib.Space(30),30));
                      /* _note := _note + iif(not(Empty(LRTrim(meneficfrz->C_PRV))),Left(LRTrim(meneficfrz->C_PRV)+Space(2),2),Left(LRTrim(wersonbo->PROVINCIA)+Space(2),2)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_PRV"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_PRV"))+CPLib.Space(2),2):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PROVINCIA"))+CPLib.Space(2),2));
                      /* _note := _note + iif(not(Empty(LRTrim(meneficfrz->C_IND))),Left(LRTrim(meneficfrz->C_IND)+Space(35),35),Left(LRTrim(wersonbo->DOMICILIO)+Space(35),35)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_IND"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_IND"))+CPLib.Space(35),35):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DOMICILIO"))+CPLib.Space(35),35));
                      /* _note := _note + iif(not(Empty(LRTrim(meneficfrz->C_CAP))),Left(LRTrim(meneficfrz->C_CAP)+Space(5),5),Left(LRTrim(wersonbo->CAP)+Space(5),5)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_CAP"))))?CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_CAP"))+CPLib.Space(5),5):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CAP"))+CPLib.Space(5),5));
                      /* _note := _note + Space(63) */
                      _note = _note+CPLib.Space(63);
                      /* _note := _note +Left(LRTrim(meneficfrz->C_RAPPORTO)+Space(25),25) */
                      _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_meneficfrz.GetString("C_RAPPORTO"))+CPLib.Space(25),25);
                      /* _note := _note + Space(91) */
                      _note = _note+CPLib.Space(91);
                      /* Exec "Scrittura Dati" Page 15:Page_19 */
                      Page_19();
                      /* nTotRec := nTotRec + 1 */
                      nTotRec = CPLib.Round(nTotRec+1,0);
                      /* nNumRec := nNumRec + 1 */
                      nNumRec = CPLib.Round(nNumRec+1,0);
                      Cursor_wersonbo.Next();
                    }
                    m_cConnectivityError = Cursor_wersonbo.ErrorMessage();
                    Cursor_wersonbo.Close();
                    // * --- End Select
                  } // End If
                } // End If
              } // End If
              Cursor_meneficfrz.Next();
            }
            m_cConnectivityError = Cursor_meneficfrz.ErrorMessage();
            Cursor_meneficfrz.Close();
            // * --- End Select
          } // End If
          /* If _oldrighe=0 and _beneficfrz */
          if (CPLib.eqr(_oldrighe,0) && _beneficfrz) {
            // * --- Select from beneficfrz
            m_cServer = m_Ctx.GetServer("beneficfrz");
            m_cPhName = m_Ctx.GetPhName("beneficfrz");
            if (Cursor_beneficfrz!=null)
              Cursor_beneficfrz.Close();
            Cursor_beneficfrz = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_frad_chkdiana.GetString("IDBASE"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("beneficfrz")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_beneficfrz.Eof())) {
              /* If Empty(LRTrim(beneficfrz->CODSOG)) and not(Empty(LRTrim(beneficfrz->C_RAG))) */
              if (CPLib.Empty(CPLib.LRTrim(Cursor_beneficfrz.GetString("CODSOG"))) &&  ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_RAG"))))) {
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
                /* _note := _note + Left(LRTrim(beneficfrz->CODSOG)+Space(16),16) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("CODSOG"))+CPLib.Space(16),16);
                /* _note := _note +Left(LRTrim(beneficfrz->C_RAG)+Space(70),70) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_RAG"))+CPLib.Space(70),70);
                /* _note := _note + Left(LRTrim(beneficfrz->C_STA)+Space(3),3) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_STA"))+CPLib.Space(3),3);
                /* _note := _note +Left(LRTrim(beneficfrz->C_CAB)+Space(6),6) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_CAB"))+CPLib.Space(6),6);
                /* _note := _note +Left(LRTrim(beneficfrz->C_CTA)+Space(30),30) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_CTA"))+CPLib.Space(30),30);
                /* _note := _note + Left(LRTrim(beneficfrz->C_PRV)+Space(2),2) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_PRV"))+CPLib.Space(2),2);
                /* _note := _note + Left(LRTrim(beneficfrz->C_IND)+Space(35),35) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_IND"))+CPLib.Space(35),35);
                /* _note := _note + Left(LRTrim(beneficfrz->C_CAP)+Space(5),5) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_CAP"))+CPLib.Space(5),5);
                /* _note := _note + Space(63) */
                _note = _note+CPLib.Space(63);
                /* _note := _note + Left(LRTrim(beneficfrz->C_RAPPORTO)+Space(25),25) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_RAPPORTO"))+CPLib.Space(25),25);
                /* _note := _note + Space(91) */
                _note = _note+CPLib.Space(91);
                /* Exec "Scrittura Dati" Page 15:Page_19 */
                Page_19();
                /* nTotRec := nTotRec + 1 */
                nTotRec = CPLib.Round(nTotRec+1,0);
                /* nNumRec := nNumRec + 1 */
                nNumRec = CPLib.Round(nNumRec+1,0);
              } else { // Else
                /* If beneficfrz->CODSOG <> qbe_frad_chkdiana->CONNESBEN */
                if (CPLib.ne(Cursor_beneficfrz.GetString("CODSOG"),Cursor_qbe_frad_chkdiana.GetString("CONNESBEN"))) {
                  /* _numsto := arfn_chkspers(beneficfrz->CODSOG,iif(w_stoper='R',qbe_frad_chkdiana->DATAREG,qbe_frad_chkdiana->DATAOPE)) */
                  _numsto = arfn_chkspersR.Make(m_Ctx,this).Run(Cursor_beneficfrz.GetString("CODSOG"),(CPLib.eqr(w_stoper,"R")?Cursor_qbe_frad_chkdiana.GetDate("DATAREG"):Cursor_qbe_frad_chkdiana.GetDate("DATAOPE")));
                  /* If Empty(LRTrim(_numsto)) */
                  if (CPLib.Empty(CPLib.LRTrim(_numsto))) {
                    // * --- Select from personbo
                    m_cServer = m_Ctx.GetServer("personbo");
                    m_cPhName = m_Ctx.GetPhName("personbo");
                    if (Cursor_personbo!=null)
                      Cursor_personbo.Close();
                    Cursor_personbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CONNES="+CPLib.ToSQL(Cursor_beneficfrz.GetString("CODSOG"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("personbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                    while ( ! (Cursor_personbo.Eof())) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
                      /* _note := _note + Left(LRTrim(beneficfrz->CODSOG)+Space(16),16) */
                      _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("CODSOG"))+CPLib.Space(16),16);
                      /* _note := _note + iif(not(Empty(LRTrim(beneficfrz->C_RAG))),Left(LRTrim(beneficfrz->C_RAG)+Space(70),70),Left(LRTrim(personbo->RAGSOC)+Space(70),70)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_RAG"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_RAG"))+CPLib.Space(70),70):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("RAGSOC"))+CPLib.Space(70),70));
                      /* _note := _note + iif(not(Empty(LRTrim(beneficfrz->C_STA))),Left(LRTrim(beneficfrz->C_STA)+Space(3),3),Left(LRTrim(personbo->PAESE)+Space(3),3)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_STA"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_STA"))+CPLib.Space(3),3):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PAESE"))+CPLib.Space(3),3));
                      /* _note := _note + iif(not(Empty(LRTrim(beneficfrz->C_CAB))),Left(LRTrim(beneficfrz->C_CAB)+Space(6),6),Left(LRTrim(personbo->CODCAB)+Space(6),6)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_CAB"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_CAB"))+CPLib.Space(6),6):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CODCAB"))+CPLib.Space(6),6));
                      /* _note := _note + iif(not(Empty(LRTrim(beneficfrz->C_CTA))),Left(LRTrim(beneficfrz->C_CTA)+Space(30),30),Left(LRTrim(personbo->DESCCIT)+Space(30),30)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_CTA"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_CTA"))+CPLib.Space(30),30):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DESCCIT"))+CPLib.Space(30),30));
                      /* _note := _note + iif(not(Empty(LRTrim(beneficfrz->C_PRV))),Left(LRTrim(beneficfrz->C_PRV)+Space(2),2),Left(LRTrim(personbo->PROVINCIA)+Space(2),2)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_PRV"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_PRV"))+CPLib.Space(2),2):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PROVINCIA"))+CPLib.Space(2),2));
                      /* _note := _note + iif(not(Empty(LRTrim(beneficfrz->C_IND))),Left(LRTrim(beneficfrz->C_IND)+Space(35),35),Left(LRTrim(personbo->DOMICILIO)+Space(35),35)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_IND"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_IND"))+CPLib.Space(35),35):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DOMICILIO"))+CPLib.Space(35),35));
                      /* _note := _note + iif(not(Empty(LRTrim(beneficfrz->C_CAP))),Left(LRTrim(beneficfrz->C_CAP)+Space(5),5),Left(LRTrim(personbo->CAP)+Space(5),5)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_CAP"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_CAP"))+CPLib.Space(5),5):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CAP"))+CPLib.Space(5),5));
                      /* _note := _note + Space(63) */
                      _note = _note+CPLib.Space(63);
                      /* _note := _note +Left(LRTrim(beneficfrz->C_RAPPORTO)+Space(25),25) */
                      _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_RAPPORTO"))+CPLib.Space(25),25);
                      /* _note := _note + Space(91) */
                      _note = _note+CPLib.Space(91);
                      /* Exec "Scrittura Dati" Page 15:Page_19 */
                      Page_19();
                      /* nTotRec := nTotRec + 1 */
                      nTotRec = CPLib.Round(nTotRec+1,0);
                      /* nNumRec := nNumRec + 1 */
                      nNumRec = CPLib.Round(nNumRec+1,0);
                      Cursor_personbo.Next();
                    }
                    m_cConnectivityError = Cursor_personbo.ErrorMessage();
                    Cursor_personbo.Close();
                    // * --- End Select
                  } else { // Else
                    // * --- Select from wersonbo
                    m_cServer = m_Ctx.GetServer("wersonbo");
                    m_cPhName = m_Ctx.GetPhName("wersonbo");
                    if (Cursor_wersonbo!=null)
                      Cursor_wersonbo.Close();
                    Cursor_wersonbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"sanumpro="+CPSql.SQLValueAdapter(CPLib.ToSQL(_numsto,"?",0,0,m_cServer, m_oParameters),m_cServer,_numsto)+" "+")"+(m_Ctx.IsSharedTemp("wersonbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                    while ( ! (Cursor_wersonbo.Eof())) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5";
                      /* If Empty(LRTrim(qbe_frad_chkdiana->FLAGRAP2)) */
                      if (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frad_chkdiana.GetString("FLAGRAP2")))) {
                        /* _note := _note + DateToChar(qbe_frad_chkdiana->DATAOPE) + qbe_frad_chkdiana->NUMPROG + 'S' */
                        _note = _note+CPLib.DateToChar(Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"))+Cursor_qbe_frad_chkdiana.GetString("NUMPROG")+"S";
                      } else { // Else
                        /* _note := _note + qbe_frad_chkdiana->IDEREG */
                        _note = _note+Cursor_qbe_frad_chkdiana.GetString("IDEREG");
                      } // End If
                      /* _note := _note + Left(LRTrim(beneficfrz->CODSOG)+Space(16),16) */
                      _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("CODSOG"))+CPLib.Space(16),16);
                      /* _note := _note + iif(not(Empty(LRTrim(beneficfrz->C_RAG))),Left(LRTrim(beneficfrz->C_RAG)+Space(70),70),Left(LRTrim(wersonbo->RAGSOC)+Space(70),70)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_RAG"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_RAG"))+CPLib.Space(70),70):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("RAGSOC"))+CPLib.Space(70),70));
                      /* _note := _note + iif(not(Empty(LRTrim(beneficfrz->C_STA))),Left(LRTrim(beneficfrz->C_STA)+Space(3),3),Left(LRTrim(wersonbo->PAESE)+Space(3),3)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_STA"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_STA"))+CPLib.Space(3),3):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PAESE"))+CPLib.Space(3),3));
                      /* _note := _note + iif(not(Empty(LRTrim(beneficfrz->C_CAB))),Left(LRTrim(beneficfrz->C_CAB)+Space(6),6),Left(LRTrim(wersonbo->CODCAB)+Space(6),6)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_CAB"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_CAB"))+CPLib.Space(6),6):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CODCAB"))+CPLib.Space(6),6));
                      /* _note := _note + iif(not(Empty(LRTrim(beneficfrz->C_CTA))),Left(LRTrim(beneficfrz->C_CTA)+Space(30),30),Left(LRTrim(wersonbo->DESCCIT)+Space(30),30)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_CTA"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_CTA"))+CPLib.Space(30),30):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DESCCIT"))+CPLib.Space(30),30));
                      /* _note := _note + iif(not(Empty(LRTrim(beneficfrz->C_PRV))),Left(LRTrim(beneficfrz->C_PRV)+Space(2),2),Left(LRTrim(wersonbo->PROVINCIA)+Space(2),2)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_PRV"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_PRV"))+CPLib.Space(2),2):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PROVINCIA"))+CPLib.Space(2),2));
                      /* _note := _note + iif(not(Empty(LRTrim(beneficfrz->C_IND))),Left(LRTrim(beneficfrz->C_IND)+Space(35),35),Left(LRTrim(wersonbo->DOMICILIO)+Space(35),35)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_IND"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_IND"))+CPLib.Space(35),35):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DOMICILIO"))+CPLib.Space(35),35));
                      /* _note := _note + iif(not(Empty(LRTrim(beneficfrz->C_CAP))),Left(LRTrim(beneficfrz->C_CAP)+Space(5),5),Left(LRTrim(wersonbo->CAP)+Space(5),5)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_CAP"))))?CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_CAP"))+CPLib.Space(5),5):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CAP"))+CPLib.Space(5),5));
                      /* _note := _note + Space(63) */
                      _note = _note+CPLib.Space(63);
                      /* _note := _note +Left(LRTrim(beneficfrz->C_RAPPORTO)+Space(25),25) */
                      _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_beneficfrz.GetString("C_RAPPORTO"))+CPLib.Space(25),25);
                      /* _note := _note + Space(91) */
                      _note = _note+CPLib.Space(91);
                      /* Exec "Scrittura Dati" Page 15:Page_19 */
                      Page_19();
                      /* nTotRec := nTotRec + 1 */
                      nTotRec = CPLib.Round(nTotRec+1,0);
                      /* nNumRec := nNumRec + 1 */
                      nNumRec = CPLib.Round(nNumRec+1,0);
                      Cursor_wersonbo.Next();
                    }
                    m_cConnectivityError = Cursor_wersonbo.ErrorMessage();
                    Cursor_wersonbo.Close();
                    // * --- End Select
                  } // End If
                } // End If
              } // End If
              Cursor_beneficfrz.Next();
            }
            m_cConnectivityError = Cursor_beneficfrz.ErrorMessage();
            Cursor_beneficfrz.Close();
            // * --- End Select
          } // End If
          /* If not(Empty(qbe_frad_chkdiana->CONNALTRO)) */
          if ( ! (CPLib.Empty(Cursor_qbe_frad_chkdiana.GetString("CONNALTRO")))) {
            /* If qbe_frad_chkdiana->DATAOPE > CharToDate('20131231') */
            if (CPLib.gt(Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '9' + _idereg */
              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"9"+_idereg;
              /* pTipoR := '9' // Tipo Riga */
              pTipoR = "9";
            } else { // Else
              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '6' + _idereg */
              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"6"+_idereg;
              /* pTipoR := '6' // Tipo Riga */
              pTipoR = "6";
            } // End If
            /* pCli := qbe_frad_chkdiana->CONNALTRO // Codice Soggetto */
            pCli = Cursor_qbe_frad_chkdiana.GetString("CONNALTRO");
            /* pDatOpe := iif(w_stoper='R',qbe_frad_chkdiana->DATAREG,qbe_frad_chkdiana->DATAOPE) // Data Operazione */
            pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_frad_chkdiana.GetDate("DATAREG"):Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"));
            /* pRap := qbe_frad_chkdiana->RAPPORTO // Codice Rapporto */
            pRap = Cursor_qbe_frad_chkdiana.GetString("RAPPORTO");
            /* pTRap := qbe_frad_chkdiana->FLAGRAP // Tipo Rapporto */
            pTRap = Cursor_qbe_frad_chkdiana.GetString("FLAGRAP");
            /* pRAE := _raeatc // RAE o ATECO */
            pRAE = _raeatc;
            /* pSTATO := qbe_frad_chkdiana->STATOREG // Stato Registrazione */
            pSTATO = Cursor_qbe_frad_chkdiana.GetString("STATOREG");
            /* pDatRet := qbe_frad_chkdiana->DATARETT // Data Rettifica */
            pDatRet = Cursor_qbe_frad_chkdiana.GetDate("DATARETT");
            /* _oldmc := _usemc */
            _oldmc = CPLib.Round(_usemc,0);
            /* _usemc := 0 */
            _usemc = CPLib.Round(0,0);
            /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
            DatiSoggetto();
            /* _usemc := _oldmc */
            _usemc = CPLib.Round(_oldmc,0);
            /* Exec "Scrittura Dati" Page 15:Page_19 */
            Page_19();
            /* nTotRec := nTotRec + 1 */
            nTotRec = CPLib.Round(nTotRec+1,0);
            /* nNumRec := nNumRec + 1 */
            nNumRec = CPLib.Round(nNumRec+1,0);
          } // End If
          /* _oldrighe := 0 */
          _oldrighe = CPLib.Round(0,0);
          /* If qbe_frad_chkdiana->STATOREG='3' and _merzistifrz */
          if (CPLib.eqr(Cursor_qbe_frad_chkdiana.GetString("STATOREG"),"3") && _merzistifrz) {
            // * --- Select from merzistifrz
            m_cServer = m_Ctx.GetServer("merzistifrz");
            m_cPhName = m_Ctx.GetPhName("merzistifrz");
            if (Cursor_merzistifrz!=null)
              Cursor_merzistifrz.Close();
            Cursor_merzistifrz = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_frad_chkdiana.GetString("IDBASE"),"?",0,0)+"  and  CODSOG <> "+CPLib.ToSQL(Cursor_qbe_frad_chkdiana.GetString("CONNALTRO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("merzistifrz")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_merzistifrz.Eof())) {
              /* If qbe_frad_chkdiana->DATAOPE > CharToDate('20131231') */
              if (CPLib.gt(Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '9' + _idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"9"+_idereg;
                /* pTipoR := '9' // Tipo Riga */
                pTipoR = "9";
              } else { // Else
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '6' + _idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"6"+_idereg;
                /* pTipoR := '6' // Tipo Riga */
                pTipoR = "6";
              } // End If
              /* pCli := merzistifrz->CODSOG // Codice Soggetto */
              pCli = Cursor_merzistifrz.GetString("CODSOG");
              /* pDatOpe := iif(w_stoper='R',qbe_frad_chkdiana->DATAREG,qbe_frad_chkdiana->DATAOPE) // Data Operazione */
              pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_frad_chkdiana.GetDate("DATAREG"):Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"));
              /* pRap := qbe_frad_chkdiana->RAPPORTO // Codice Rapporto */
              pRap = Cursor_qbe_frad_chkdiana.GetString("RAPPORTO");
              /* pTRap := qbe_frad_chkdiana->FLAGRAP // Tipo Rapporto */
              pTRap = Cursor_qbe_frad_chkdiana.GetString("FLAGRAP");
              /* pRAE := _raeatc // RAE o ATECO */
              pRAE = _raeatc;
              /* pSTATO := qbe_frad_chkdiana->STATOREG // Stato Registrazione */
              pSTATO = Cursor_qbe_frad_chkdiana.GetString("STATOREG");
              /* pDatRet := qbe_frad_chkdiana->DATARETT // Data Rettifica */
              pDatRet = Cursor_qbe_frad_chkdiana.GetDate("DATARETT");
              /* _oldmc := _usemc */
              _oldmc = CPLib.Round(_usemc,0);
              /* _usemc := 0 */
              _usemc = CPLib.Round(0,0);
              /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
              DatiSoggetto();
              /* _usemc := _oldmc */
              _usemc = CPLib.Round(_oldmc,0);
              /* Exec "Scrittura Dati" Page 15:Page_19 */
              Page_19();
              /* nTotRec := nTotRec + 1 */
              nTotRec = CPLib.Round(nTotRec+1,0);
              /* nNumRec := nNumRec + 1 */
              nNumRec = CPLib.Round(nNumRec+1,0);
              Cursor_merzistifrz.Next();
            }
            m_cConnectivityError = Cursor_merzistifrz.ErrorMessage();
            Cursor_merzistifrz.Close();
            // * --- End Select
          } // End If
          /* If _oldrighe=0 and _terzistifrz */
          if (CPLib.eqr(_oldrighe,0) && _terzistifrz) {
            // * --- Select from terzistifrz
            m_cServer = m_Ctx.GetServer("terzistifrz");
            m_cPhName = m_Ctx.GetPhName("terzistifrz");
            if (Cursor_terzistifrz!=null)
              Cursor_terzistifrz.Close();
            Cursor_terzistifrz = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_frad_chkdiana.GetString("IDBASE"),"?",0,0)+"  and  CODSOG <> "+CPLib.ToSQL(Cursor_qbe_frad_chkdiana.GetString("CONNALTRO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("terzistifrz")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_terzistifrz.Eof())) {
              /* If qbe_frad_chkdiana->DATAOPE > CharToDate('20131231') */
              if (CPLib.gt(Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '9' + _idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"9"+_idereg;
                /* pTipoR := '9' // Tipo Riga */
                pTipoR = "9";
              } else { // Else
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '6' + _idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"6"+_idereg;
                /* pTipoR := '6' // Tipo Riga */
                pTipoR = "6";
              } // End If
              /* pCli := terzistifrz->CODSOG // Codice Soggetto */
              pCli = Cursor_terzistifrz.GetString("CODSOG");
              /* pDatOpe := iif(w_stoper='R',qbe_frad_chkdiana->DATAREG,qbe_frad_chkdiana->DATAOPE) // Data Operazione */
              pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_frad_chkdiana.GetDate("DATAREG"):Cursor_qbe_frad_chkdiana.GetDate("DATAOPE"));
              /* pRap := qbe_frad_chkdiana->RAPPORTO // Codice Rapporto */
              pRap = Cursor_qbe_frad_chkdiana.GetString("RAPPORTO");
              /* pTRap := qbe_frad_chkdiana->FLAGRAP // Tipo Rapporto */
              pTRap = Cursor_qbe_frad_chkdiana.GetString("FLAGRAP");
              /* pRAE := _raeatc // RAE o ATECO */
              pRAE = _raeatc;
              /* pSTATO := qbe_frad_chkdiana->STATOREG // Stato Registrazione */
              pSTATO = Cursor_qbe_frad_chkdiana.GetString("STATOREG");
              /* pDatRet := qbe_frad_chkdiana->DATARETT // Data Rettifica */
              pDatRet = Cursor_qbe_frad_chkdiana.GetDate("DATARETT");
              /* _oldmc := _usemc */
              _oldmc = CPLib.Round(_usemc,0);
              /* _usemc := 0 */
              _usemc = CPLib.Round(0,0);
              /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
              DatiSoggetto();
              /* _usemc := _oldmc */
              _usemc = CPLib.Round(_oldmc,0);
              /* Exec "Scrittura Dati" Page 15:Page_19 */
              Page_19();
              /* nTotRec := nTotRec + 1 */
              nTotRec = CPLib.Round(nTotRec+1,0);
              /* nNumRec := nNumRec + 1 */
              nNumRec = CPLib.Round(nNumRec+1,0);
              Cursor_terzistifrz.Next();
            }
            m_cConnectivityError = Cursor_terzistifrz.ErrorMessage();
            Cursor_terzistifrz.Close();
            // * --- End Select
          } // End If
          /* gNumRec := nTotRec // N° Record DIANA */
          gNumRec = CPLib.Round(nTotRec,0);
          m_Ctx.SetGlobalNumber("gNumRec",gNumRec);
          /* gNumReg := nTotReg // N° Registrazioni DIANA */
          gNumReg = CPLib.Round(nTotReg,0);
          m_Ctx.SetGlobalNumber("gNumReg",gNumReg);
          Cursor_qbe_frad_chkdiana.Next();
        }
        m_cConnectivityError = Cursor_qbe_frad_chkdiana.ErrorMessage();
        Cursor_qbe_frad_chkdiana.Close();
        // * --- End Select
        /* _contacilci := _contacilci+1 */
        _contacilci = CPLib.Round(_contacilci+1,0);
      } // End While
    } finally {
      try {
        if (Cursor_qbe_frad_chkdiana_limits!=null)
          Cursor_qbe_frad_chkdiana_limits.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_qbe_frad_chkdiana!=null)
          Cursor_qbe_frad_chkdiana.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_knarapbo!=null)
          Cursor_knarapbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_kersonbo!=null)
          Cursor_kersonbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Read_Cursor!=null)
          Read_Cursor.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_intestbo!=null)
          Cursor_intestbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_mlientifrz!=null)
          Cursor_mlientifrz.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_clientifrz!=null)
          Cursor_clientifrz.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_mogopefbo!=null)
          Cursor_mogopefbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_sogopefbo!=null)
          Cursor_sogopefbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_personbo!=null)
          Cursor_personbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_wersonbo!=null)
          Cursor_wersonbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_meneficfrz!=null)
          Cursor_meneficfrz.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_beneficfrz!=null)
          Cursor_beneficfrz.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_merzistifrz!=null)
          Cursor_merzistifrz.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_terzistifrz!=null)
          Cursor_terzistifrz.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
    }
  }
  void Page_10() throws Exception {
    CPResultSet Cursor_qbe_frap_chkdiana_limits=null;
    CPResultSet Cursor_qbe_frap_chkdiana=null;
    CPResultSet Cursor_knarapbo=null;
    CPResultSet Cursor_kersonbo=null;
    CPResultSet Read_Cursor=null;
    CPResultSet Cursor_xntestbo=null;
    CPResultSet Cursor_intestbo=null;
    CPResultSet Cursor_xlientifrz=null;
    CPResultSet Cursor_xogopefbo=null;
    CPResultSet Cursor_personbo=null;
    CPResultSet Cursor_wersonbo=null;
    CPResultSet Cursor_xeneficfrz=null;
    CPResultSet Cursor_xerzistifrz=null;
    VQRHolder l_VQRHolder = null;
    try {
      /* Cicla sulle frazionate provvisorie */
      /* gMsgImp := 'Verifica Frazionate Provvisorie da elaborare ...' // Messaggio Import */
      gMsgImp = "Verifica Frazionate Provvisorie da elaborare ...";
      m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
      /* _max := 0 */
      _max = CPLib.Round(0,0);
      /* _min := 0 */
      _min = CPLib.Round(0,0);
      /* _ciclo := 0 */
      _ciclo = CPLib.Round(0,0);
      /* Prima gli italiani */
      // * --- Select from qbe_frap_chkdiana_limits
      SPBridge.HMCaller _h00000BDB;
      _h00000BDB = new SPBridge.HMCaller();
      _h00000BDB.Set("m_cVQRList",m_cVQRList);
      _h00000BDB.Set("cdadata",w_cdadata);
      _h00000BDB.Set("c_adata",w_c_adata);
      _h00000BDB.Set("codage",w_codage);
      _h00000BDB.Set("ragben",w_ragben);
      _h00000BDB.Set("codcli",w_codcli);
      if (Cursor_qbe_frap_chkdiana_limits!=null)
        Cursor_qbe_frap_chkdiana_limits.Close();
      Cursor_qbe_frap_chkdiana_limits = new VQRHolder("qbe_frap_chkdiana_limits",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000BDB,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_frap_chkdiana_limits.Eof())) {
        /* _max := qbe_frap_chkdiana_limits->MAXFRZ */
        _max = CPLib.Round(Cursor_qbe_frap_chkdiana_limits.GetDouble("MAXFRZ"),0);
        /* _min := qbe_frap_chkdiana_limits->MINFRZ */
        _min = CPLib.Round(Cursor_qbe_frap_chkdiana_limits.GetDouble("MINFRZ"),0);
        Cursor_qbe_frap_chkdiana_limits.Next();
      }
      m_cConnectivityError = Cursor_qbe_frap_chkdiana_limits.ErrorMessage();
      Cursor_qbe_frap_chkdiana_limits.Close();
      // * --- End Select
      /* _cicli := iif(Mod(_max,5000) <> 0,Int(_max/5000) + 1,Int(_max/5000)) */
      _cicli = CPLib.Round((CPLib.ne(CPLib.Mod(_max,5000),0)?CPLib.Int(_max/5000)+1:CPLib.Int(_max/5000)),0);
      /* _bottom := _min */
      _bottom = CPLib.Round(_min,0);
      /* If _min > 5000 */
      if (CPLib.gt(_min,5000)) {
        /* _contacilci := Int(_min/5000) + 1 */
        _contacilci = CPLib.Round(CPLib.Int(_min/5000)+1,0);
      } else { // Else
        /* _contacilci := 1 */
        _contacilci = CPLib.Round(1,0);
      } // End If
      /* gMsgImp := 'Lettura frazionate in corso ...' // Messaggio Import */
      gMsgImp = "Lettura frazionate in corso ...";
      m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
      /* While _contacilci<=_cicli */
      while (CPLib.le(_contacilci,_cicli)) {
        /* _bottom := iif(_ciclo=0,_bottom,((_contacilci -1 ) * 5000) + 1) */
        _bottom = CPLib.Round((CPLib.eqr(_ciclo,0)?_bottom:((_contacilci-1)*5000)+1),0);
        /* _top := _contacilci * 5000 */
        _top = CPLib.Round(_contacilci*5000,0);
        /* _ciclo := 1 */
        _ciclo = CPLib.Round(1,0);
        /* _conta := _conta + 1 */
        _conta = CPLib.Round(_conta+1,0);
        /* gMsgImp := 'Lettura frazionate in corso ... Ciclo N. '+LRTrim(Str(_contacilci,10,0)) // Messaggio Import */
        gMsgImp = "Lettura frazionate in corso ... Ciclo N. "+CPLib.LRTrim(CPLib.Str(_contacilci,10,0));
        m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
        /* Cicla sulle operazioni */
        // * --- Select from qbe_frap_chkdiana
        SPBridge.HMCaller _h00000BEB;
        _h00000BEB = new SPBridge.HMCaller();
        _h00000BEB.Set("m_cVQRList",m_cVQRList);
        _h00000BEB.Set("cdadata",w_cdadata);
        _h00000BEB.Set("c_adata",w_c_adata);
        _h00000BEB.Set("codage",w_codage);
        _h00000BEB.Set("_bottom",_bottom);
        _h00000BEB.Set("_top",_top);
        _h00000BEB.Set("ragben",w_ragben);
        _h00000BEB.Set("codcli",w_codcli);
        if (Cursor_qbe_frap_chkdiana!=null)
          Cursor_qbe_frap_chkdiana.Close();
        Cursor_qbe_frap_chkdiana = new VQRHolder("qbe_frap_chkdiana",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000BEB,true).GetResultSet(m_Ctx);
        while ( ! (Cursor_qbe_frap_chkdiana.Eof())) {
          /* _ctotale := _ctotale + 1 */
          _ctotale = CPLib.Round(_ctotale+1,0);
          /* gMsgImp := 'Elaborazione Frazionata N.: '+LRTrim(Str(_ctotale,15,0)) // Messaggio Import */
          gMsgImp = "Elaborazione Frazionata N.: "+CPLib.LRTrim(CPLib.Str(_ctotale,15,0));
          m_Ctx.SetGlobalString("gMsgImp",gMsgImp);
          /* _idereg := arfn_calc_idereg("F",qbe_frap_chkdiana->NUMPROG,qbe_frap_chkdiana->IDEREG) */
          _idereg = arfn_calc_ideregR.Make(m_Ctx,this).Run("F",Cursor_qbe_frap_chkdiana.GetString("NUMPROG"),Cursor_qbe_frap_chkdiana.GetString("IDEREG"));
          /* If qbe_frap_chkdiana->DATAOPE <  CharToDate('20100601') */
          if (CPLib.lt(Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20100601"))) {
            /* _raeatc := 'R' */
            _raeatc = "R";
            /* ElseIf qbe_frap_chkdiana->DATAOPE >  CharToDate('20131231') */
          } else if (CPLib.gt(Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
            /* _raeatc := 'A' */
            _raeatc = "A";
          } else { // Else
            /* _raeatc := w_flgrae */
            _raeatc = w_flgrae;
          } // End If
          /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '1' + _idereg */
          _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"1"+_idereg;
          /* _flagrap := '' */
          _flagrap = "";
          /* If not(Empty(LRTrim(qbe_frap_chkdiana->RAPPORTO))) */
          if ( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("RAPPORTO"))))) {
            // * --- Select from knarapbo
            m_cServer = m_Ctx.GetServer("knarapbo");
            m_cPhName = m_Ctx.GetPhName("knarapbo");
            if (Cursor_knarapbo!=null)
              Cursor_knarapbo.Close();
            Cursor_knarapbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select FLAGRAP  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_frap_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("knarapbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_knarapbo.Eof())) {
              /* _flagrap := knarapbo->FLAGRAP */
              _flagrap = Cursor_knarapbo.GetString("FLAGRAP");
              Cursor_knarapbo.Next();
            }
            m_cConnectivityError = Cursor_knarapbo.ErrorMessage();
            Cursor_knarapbo.Close();
            // * --- End Select
          } // End If
          /* _datage := arfn_datidip_sol(qbe_frap_chkdiana->CODDIPE,qbe_frap_chkdiana->CODCAB,qbe_frap_chkdiana->DESCCIT,qbe_frap_chkdiana->PROVINCIA) */
          _datage = arfn_datidip_solR.Make(m_Ctx,this).Run(Cursor_qbe_frap_chkdiana.GetString("CODDIPE"),Cursor_qbe_frap_chkdiana.GetString("CODCAB"),Cursor_qbe_frap_chkdiana.GetString("DESCCIT"),Cursor_qbe_frap_chkdiana.GetString("PROVINCIA"));
          /* _tipoag := Right(_datage,10) */
          _tipoag = CPLib.Right(_datage,10);
          /* _note := _note + Left(_datage,44) */
          _note = _note+CPLib.Left(_datage,44);
          /* _numticket := iif(LRTrim(qbe_frap_chkdiana->RIFIMP)='XXXXXXXXX',LibreriaMit.SpacePad(LRTrim(qbe_frap_chkdiana->INFORM),30),LibreriaMit.SpacePad(LRTrim(qbe_frap_chkdiana->RIFIMP),30)) */
          _numticket = (CPLib.eqr(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("RIFIMP")),"XXXXXXXXX")?LibreriaMit.SpacePad(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("INFORM")),30):LibreriaMit.SpacePad(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("RIFIMP")),30));
          /* _note := _note + Left(DateToChar(qbe_frap_chkdiana->DATAOPE)+Space(8),8) + Left(LRTrim(qbe_frap_chkdiana->FLAGFRAZ)+" ",1) + Left(LRTrim(qbe_frap_chkdiana->FLAGCONT)+" ",1) */
          _note = _note+CPLib.Left(CPLib.DateToChar(Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"))+CPLib.Space(8),8)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("FLAGFRAZ"))+" ",1)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("FLAGCONT"))+" ",1);
          /* _note := _note + Left(LRTrim(qbe_frap_chkdiana->CODANA)+Space(4),4) + Left(LRTrim(qbe_frap_chkdiana->CODVOC)+Space(2),2) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("CODANA"))+CPLib.Space(4),4)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("CODVOC"))+CPLib.Space(2),2);
          /* _note := _note + Left(LRTrim(qbe_frap_chkdiana->TIPOINT2)+Space(2),2) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("TIPOINT2"))+CPLib.Space(2),2);
          /* _note := _note + iif(Empty(LRTrim(qbe_frap_chkdiana->CODFISCICP)),Left(LRTrim(qbe_frap_chkdiana->CODINT2)+Space(11),11),Left(LRTrim(qbe_frap_chkdiana->CODFISCICP)+Space(11),11)) */
          _note = _note+(CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("CODFISCICP")))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("CODINT2"))+CPLib.Space(11),11):CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("CODFISCICP"))+CPLib.Space(11),11));
          /* _note := _note + Left(LRTrim(qbe_frap_chkdiana->PAESE)+Space(3),3) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("PAESE"))+CPLib.Space(3),3);
          /* _note := _note + Left(LRTrim(qbe_frap_chkdiana->CODCAB2)+Space(6),6) + Left(LRTrim(qbe_frap_chkdiana->DESC2)+Space(30),30) + Left(LRTrim(qbe_frap_chkdiana->PROV2)+Space(2),2) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("CODCAB2"))+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("DESC2"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("PROV2"))+CPLib.Space(2),2);
          /* _note := _note + Left(LRTrim(qbe_frap_chkdiana->DESCINTER)+Space(50),50) + Left(LRTrim(qbe_frap_chkdiana->RAPPORTO)+Space(25),25) + Left(LRTrim(_flagrap)+" ",1) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("DESCINTER"))+CPLib.Space(50),50)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("RAPPORTO"))+CPLib.Space(25),25)+CPLib.Left(CPLib.LRTrim(_flagrap)+" ",1);
          /* _note := _note + Left(LRTrim(qbe_frap_chkdiana->TIPOLEG)+" ",1) + Left(LRTrim(DateToChar(Date()))+Space(8),8) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("TIPOLEG"))+" ",1)+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(CPLib.Date()))+CPLib.Space(8),8);
          /* _note := _note + Left(LRTrim(qbe_frap_chkdiana->TIPOOPRAP)+Space(2),2) + Left(LRTrim(qbe_frap_chkdiana->COLLEG)+Space(12),12) */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("TIPOOPRAP"))+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("COLLEG"))+CPLib.Space(12),12);
          /* _note := _note + Left(LRTrim(qbe_frap_chkdiana->STATOREG)+" ",1)  */
          _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("STATOREG"))+" ",1);
          /* If Empty(qbe_frap_chkdiana->DATARETT) or DateToChar(qbe_frap_chkdiana->DATARETT)='01000101' */
          if (CPLib.Empty(Cursor_qbe_frap_chkdiana.GetDate("DATARETT")) || CPLib.eqr(CPLib.DateToChar(Cursor_qbe_frap_chkdiana.GetDate("DATARETT")),"01000101")) {
            /* _note := _note + Space(8) */
            _note = _note+CPLib.Space(8);
          } else { // Else
            /* _note := _note + Left(LRTrim(DateToChar(qbe_frap_chkdiana->DATARETT))+Space(8),8) */
            _note = _note+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_qbe_frap_chkdiana.GetDate("DATARETT")))+CPLib.Space(8),8);
          } // End If
          /* If Left(qbe_frap_chkdiana->OPERAZMOD,1)='F' */
          if (CPLib.eqr(CPLib.Left(Cursor_qbe_frap_chkdiana.GetString("OPERAZMOD"),1),"F")) {
            /* _note := _note + iif(Empty(LRTrim(qbe_frap_chkdiana->OPERAZMOD)),Space(20),qbe_frap_chkdiana->OPERAZMOD) */
            _note = _note+(CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("OPERAZMOD")))?CPLib.Space(20):Cursor_qbe_frap_chkdiana.GetString("OPERAZMOD"));
          } else { // Else
            /* _note := _note + iif(Empty(LRTrim(qbe_frap_chkdiana->OPERAZMOD)),Space(20),Left(qbe_frap_chkdiana->OPERAZMOD,8)+"F"+Right(qbe_frap_chkdiana->OPERAZMOD,11)) */
            _note = _note+(CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("OPERAZMOD")))?CPLib.Space(20):CPLib.Left(Cursor_qbe_frap_chkdiana.GetString("OPERAZMOD"),8)+"F"+CPLib.Right(Cursor_qbe_frap_chkdiana.GetString("OPERAZMOD"),11));
          } // End If
          /* _note := _note + arfn_flaglire(qbe_frap_chkdiana->FLAGLIRE,qbe_frap_chkdiana->DATAOPE) + Left(LRTrim(qbe_frap_chkdiana->VALUTA)+Space(3),3) + Left(LRTrim(qbe_frap_chkdiana->SEGNO)+" ",1) */
          _note = _note+arfn_flaglireR.Make(m_Ctx,this).Run(Cursor_qbe_frap_chkdiana.GetString("FLAGLIRE"),Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"))+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("VALUTA"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("SEGNO"))+" ",1);
          /* _note := _note +  Right('000000000000000'+LRTrim(Str(qbe_frap_chkdiana->TOTLIRE,15,0)),15) + Right('000000000000000'+LRTrim(Str(qbe_frap_chkdiana->TOTCONT,15,0)),15) + _numticket + Space(17)+"F"+qbe_frap_chkdiana->NUMPROG+Left(LRTrim(_tipoag)+Space(10),10) */
          _note = _note+CPLib.Right("000000000000000"+CPLib.LRTrim(CPLib.Str(Cursor_qbe_frap_chkdiana.GetDouble("TOTLIRE"),15,0)),15)+CPLib.Right("000000000000000"+CPLib.LRTrim(CPLib.Str(Cursor_qbe_frap_chkdiana.GetDouble("TOTCONT"),15,0)),15)+_numticket+CPLib.Space(17)+"F"+Cursor_qbe_frap_chkdiana.GetString("NUMPROG")+CPLib.Left(CPLib.LRTrim(_tipoag)+CPLib.Space(10),10);
          /* Exec "Scrittura Dati" Page 15:Page_19 */
          Page_19();
          /* nTotRec := nTotRec + 1 */
          nTotRec = CPLib.Round(nTotRec+1,0);
          /* nTotReg := nTotReg + 1 */
          nTotReg = CPLib.Round(nTotReg+1,0);
          /* nNumRec := nNumRec + 1 */
          nNumRec = CPLib.Round(nNumRec+1,0);
          /* If not(Empty(qbe_frap_chkdiana->CONNESCLI)) */
          if ( ! (CPLib.Empty(Cursor_qbe_frap_chkdiana.GetString("CONNESCLI")))) {
            /* _oldrap := '' */
            _oldrap = "";
            /* _codrif := qbe_frap_chkdiana->CONNESCLI */
            _codrif = Cursor_qbe_frap_chkdiana.GetString("CONNESCLI");
            /* If gFlgWU='S' and not(Empty(LRTrim(qbe_frap_chkdiana->CONNESDOC))) */
            if (CPLib.eqr(gFlgWU,"S") &&  ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("CONNESDOC"))))) {
              // * --- Select from kersonbo
              m_cServer = m_Ctx.GetServer("kersonbo");
              m_cPhName = m_Ctx.GetPhName("kersonbo");
              if (Cursor_kersonbo!=null)
                Cursor_kersonbo.Close();
              Cursor_kersonbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CONNES="+CPLib.ToSQL(Cursor_qbe_frap_chkdiana.GetString("CONNESDOC"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("kersonbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
              while ( ! (Cursor_kersonbo.Eof())) {
                /* _ramate := iif(w_flgrae='R',LRTrim(kersonbo->RAMOGRUP),Left(LRTrim(kersonbo->ATTIV),3)) */
                _ramate = (CPLib.eqr(w_flgrae,"R")?CPLib.LRTrim(Cursor_kersonbo.GetString("RAMOGRUP")):CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("ATTIV")),3));
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11);
                /* _ramate := iif(w_flgrae='R',LRTrim(kersonbo->RAMOGRUP),Left(LRTrim(kersonbo->ATTIV),3)) */
                _ramate = (CPLib.eqr(w_flgrae,"R")?CPLib.LRTrim(Cursor_kersonbo.GetString("RAMOGRUP")):CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("ATTIV")),3));
                /* If qbe_frap_chkdiana->DATAOPE > CharToDate('20131231') */
                if (CPLib.gt(Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '7' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                } else { // Else
                  /* If Empty(qbe_frap_chkdiana->CONNESOPER) or (LRTrim(Upper(qbe_frap_chkdiana->CONNESOPER))=LRTrim(Upper(qbe_frap_chkdiana->CONNESCLI))) */
                  if (CPLib.Empty(Cursor_qbe_frap_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(CPLib.LRTrim(CPLib.Upper(Cursor_qbe_frap_chkdiana.GetString("CONNESOPER"))),CPLib.LRTrim(CPLib.Upper(Cursor_qbe_frap_chkdiana.GetString("CONNESCLI")))))) {
                    /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                    _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                  } else { // Else
                    /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                    _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                  } // End If
                } // End If
                /* _note := _note + Left(LRTrim(qbe_frap_chkdiana->CONNESCLI)+Space(16),16) + Left(LRTrim(kersonbo->RAGSOC)+Space(70),70) + Left(LRTrim(kersonbo->PAESE)+Space(3),3) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("CONNESCLI"))+CPLib.Space(16),16)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("RAGSOC"))+CPLib.Space(70),70)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("PAESE"))+CPLib.Space(3),3);
                /* _note := _note + Left(LRTrim(kersonbo->CODCAB)+Space(6),6) + Left(LRTrim(kersonbo->DESCCIT)+Space(30),30) + Left(LRTrim(kersonbo->PROVINCIA)+Space(2),2) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("CODCAB"))+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("DESCCIT"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("PROVINCIA"))+CPLib.Space(2),2);
                /* _note := _note + Left(LRTrim(kersonbo->DOMICILIO)+Space(35),35) + Left(LRTrim(kersonbo->CAP)+ Space(5),5) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("DOMICILIO"))+CPLib.Space(35),35)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("CAP"))+CPLib.Space(5),5);
                /* _note := _note + iif(kersonbo->CFESTERO=1,Space(16),Left(LRTrim(kersonbo->CODFISC)+Space(16),16)) */
                _note = _note+(CPLib.eqr(Cursor_kersonbo.GetDouble("CFESTERO"),1)?CPLib.Space(16):CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("CODFISC"))+CPLib.Space(16),16));
                /* If Empty(kersonbo->DATANASC) or DateToChar(kersonbo->DATANASC)='01000101' */
                if (CPLib.Empty(Cursor_kersonbo.GetDate("DATANASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_kersonbo.GetDate("DATANASC")),"01000101")) {
                  /* _note := _note + Space(8) */
                  _note = _note+CPLib.Space(8);
                } else { // Else
                  /* _note := _note + Left(LRTrim(DateToChar(kersonbo->DATANASC))+Space(8),8) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_kersonbo.GetDate("DATANASC")))+CPLib.Space(8),8);
                } // End If
                /* If not(Empty(kersonbo->NASSTATO)) */
                if ( ! (CPLib.Empty(Cursor_kersonbo.GetString("NASSTATO")))) {
                  /* _note := _note + Left(LRTrim(kersonbo->NASSTATO)+Space(30),30) + Left(LRTrim(kersonbo->SOTGRUP)+Space(3),3) + Left(LRTrim(_ramate)+Space(3),3) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("NASSTATO"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("SOTGRUP"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(_ramate)+CPLib.Space(3),3);
                } else { // Else
                  /* _note := _note + Left(LRTrim(kersonbo->NASCOMUN)+Space(30),30) + Left(LRTrim(kersonbo->SOTGRUP)+Space(3),3) + Left(LRTrim(_ramate) +Space(3),3) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("NASCOMUN"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("SOTGRUP"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(_ramate)+CPLib.Space(3),3);
                } // End If
                /* _note := _note + Left(LRTrim(kersonbo->SETTSINT)+Space(3),3) + Left(LRTrim(qbe_frap_chkdiana->RAPPORTO)+Space(25),25) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("SETTSINT"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("RAPPORTO"))+CPLib.Space(25),25);
                /* _note := _note + Left(LRTrim(qbe_frap_chkdiana->FLAGRAP)+" ",1) + Left(LRTrim(kersonbo->TIPODOC)+Space(2),2) + Left(LRTrim(kersonbo->NUMDOCUM)+Space(15),15) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("FLAGRAP"))+" ",1)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("TIPODOC"))+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("NUMDOCUM"))+CPLib.Space(15),15);
                /* If Empty(kersonbo->DATARILASC) or DateToChar(kersonbo->DATARILASC)='01000101' */
                if (CPLib.Empty(Cursor_kersonbo.GetDate("DATARILASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_kersonbo.GetDate("DATARILASC")),"01000101")) {
                  /* _note := _note + Space(8) */
                  _note = _note+CPLib.Space(8);
                } else { // Else
                  /* _note := _note + Left(LRTrim(DateToChar(kersonbo->DATARILASC))+Space(8),8)  */
                  _note = _note+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_kersonbo.GetDate("DATARILASC")))+CPLib.Space(8),8);
                } // End If
                /* _note := _note + Left(LRTrim(kersonbo->AUTRILASC)+Space(30),30) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("AUTRILASC"))+CPLib.Space(30),30);
                /* _note := _note + Left(LRTrim(kersonbo->SESSO)+" ",1) + Space(34) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_kersonbo.GetString("SESSO"))+" ",1)+CPLib.Space(34);
                /* Exec "Scrittura Dati" Page 15:Page_19 */
                Page_19();
                /* nTotRec := nTotRec + 1 */
                nTotRec = CPLib.Round(nTotRec+1,0);
                /* nNumRec := nNumRec + 1 */
                nNumRec = CPLib.Round(nNumRec+1,0);
                Cursor_kersonbo.Next();
              }
              m_cConnectivityError = Cursor_kersonbo.ErrorMessage();
              Cursor_kersonbo.Close();
              // * --- End Select
            } else { // Else
              /* If qbe_frap_chkdiana->DATAOPE > CharToDate('20131231') */
              if (CPLib.gt(Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '7' + _idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                /* pTipoR := '7' // Tipo Riga */
                pTipoR = "7";
              } else { // Else
                /* If Empty(qbe_frap_chkdiana->CONNESOPER) or (LRTrim(Upper(qbe_frap_chkdiana->CONNESOPER))=LRTrim(Upper(qbe_frap_chkdiana->CONNESCLI))) */
                if (CPLib.Empty(Cursor_qbe_frap_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(CPLib.LRTrim(CPLib.Upper(Cursor_qbe_frap_chkdiana.GetString("CONNESOPER"))),CPLib.LRTrim(CPLib.Upper(Cursor_qbe_frap_chkdiana.GetString("CONNESCLI")))))) {
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                  /* pTipoR := '2' // Tipo Riga */
                  pTipoR = "2";
                } else { // Else
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                  /* pTipoR := '3' // Tipo Riga */
                  pTipoR = "3";
                } // End If
              } // End If
              /* pCli := qbe_frap_chkdiana->CONNESCLI // Codice Soggetto */
              pCli = Cursor_qbe_frap_chkdiana.GetString("CONNESCLI");
              /* pDatOpe := iif(w_stoper='R',qbe_frap_chkdiana->DATAREG,qbe_frap_chkdiana->DATAOPE) // Data Operazione */
              pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_frap_chkdiana.GetDate("DATAREG"):Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"));
              /* pRap := qbe_frap_chkdiana->RAPPORTO // Codice Rapporto */
              pRap = Cursor_qbe_frap_chkdiana.GetString("RAPPORTO");
              /* pTRap := qbe_frap_chkdiana->FLAGRAP // Tipo Rapporto */
              pTRap = Cursor_qbe_frap_chkdiana.GetString("FLAGRAP");
              /* pRAE := _raeatc // RAE o ATECO */
              pRAE = _raeatc;
              /* pSTATO := qbe_frap_chkdiana->STATOREG // Stato Registrazione */
              pSTATO = Cursor_qbe_frap_chkdiana.GetString("STATOREG");
              /* pDatRet := qbe_frap_chkdiana->DATARETT // Data Rettifica */
              pDatRet = Cursor_qbe_frap_chkdiana.GetDate("DATARETT");
              /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
              DatiSoggetto();
              /* Exec "Scrittura Dati" Page 15:Page_19 */
              Page_19();
              /* nTotRec := nTotRec + 1 */
              nTotRec = CPLib.Round(nTotRec+1,0);
              /* nNumRec := nNumRec + 1 */
              nNumRec = CPLib.Round(nNumRec+1,0);
            } // End If
          } // End If
          /* If not(Empty(qbe_frap_chkdiana->RAPPORTO)) */
          if ( ! (CPLib.Empty(Cursor_qbe_frap_chkdiana.GetString("RAPPORTO")))) {
            /* _oldrap := '' */
            _oldrap = "";
            // * --- Read from knarapbo
            m_cServer = m_Ctx.GetServer("knarapbo");
            m_cPhName = m_Ctx.GetPhName("knarapbo");
            m_cSql = "";
            m_cSql = m_cSql+"RAPPORTO="+CPSql.SQLValueAdapter(CPLib.ToSQL(Cursor_qbe_frap_chkdiana.GetString("RAPPORTO"),"C",25,0,m_cServer),m_cServer,Cursor_qbe_frap_chkdiana.GetString("RAPPORTO"));
            if (m_Ctx.IsSharedTemp("knarapbo")) {
              m_cSql = m_cSql+" and context_id='"+m_Ctx.GetTempID()+"'";
            }
            if (Read_Cursor!=null)
              Read_Cursor.Close();
            Read_Cursor = m_Sql.Query(m_cServer,"select "+CPLib.GetMultilanguageField("RAPPORTO",m_Ctx,m_cServer)+" from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+m_cSql);
            if ( ! (Read_Cursor.Eof())) {
              _oldrap = Read_Cursor.GetString("RAPPORTO");
              Read_Cursor.Next();
              if ( ! (Read_Cursor.Eof())) {
                Error l_oErrorFault = new Error("Read on knarapbo into routine arrt_chkdiana_all returns two or more records. This item should return only a record.");
                CPStdCounter.Error(l_oErrorFault);
              }
              Read_Cursor.Close();
            } else {
              // Error: no record found!
              _oldrap = "";
              Read_Cursor.Close();
              m_cLastMsgError = "MSG_RECORD_NOT_FOUND";
            }
            /* If not(Empty(_oldrap)) */
            if ( ! (CPLib.Empty(_oldrap))) {
              // * --- Select from knarapbo
              m_cServer = m_Ctx.GetServer("knarapbo");
              m_cPhName = m_Ctx.GetPhName("knarapbo");
              if (Cursor_knarapbo!=null)
                Cursor_knarapbo.Close();
              Cursor_knarapbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_frap_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("knarapbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
              while ( ! (Cursor_knarapbo.Eof())) {
                /* If knarapbo->TIPORAP='P' */
                if (CPLib.eqr(Cursor_knarapbo.GetString("TIPORAP"),"P")) {
                  // * --- Select from xntestbo
                  m_cServer = m_Ctx.GetServer("xntestbo");
                  m_cPhName = m_Ctx.GetPhName("xntestbo");
                  if (Cursor_xntestbo!=null)
                    Cursor_xntestbo.Close();
                  Cursor_xntestbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_frap_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xntestbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                  while ( ! (Cursor_xntestbo.Eof())) {
                    /* If qbe_frap_chkdiana->RAPPORTO = xntestbo->RAPPORTO */
                    if (CPLib.eqr(Cursor_qbe_frap_chkdiana.GetString("RAPPORTO"),Cursor_xntestbo.GetString("RAPPORTO"))) {
                      /* _avanza := 0 */
                      _avanza = CPLib.Round(0,0);
                      /* If Empty(xntestbo->CODINTER) or xntestbo->STATOREG='2' or xntestbo->STATOREG='3' */
                      if (CPLib.Empty(Cursor_xntestbo.GetString("CODINTER")) || CPLib.eqr(Cursor_xntestbo.GetString("STATOREG"),"2") || CPLib.eqr(Cursor_xntestbo.GetString("STATOREG"),"3")) {
                        /* _avanza := 1 */
                        _avanza = CPLib.Round(1,0);
                      } // End If
                      /* If xntestbo->DATAINI > qbe_frap_chkdiana->DATAOPE */
                      if (CPLib.gt(Cursor_xntestbo.GetDate("DATAINI"),Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"))) {
                        /* _avanza := 1 */
                        _avanza = CPLib.Round(1,0);
                      } // End If
                      /* If not(Empty(xntestbo->DATAFINE)) and xntestbo->DATAFINE < qbe_frap_chkdiana->DATAOPE */
                      if ( ! (CPLib.Empty(Cursor_xntestbo.GetDate("DATAFINE"))) && CPLib.lt(Cursor_xntestbo.GetDate("DATAFINE"),Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"))) {
                        /* _avanza := 1 */
                        _avanza = CPLib.Round(1,0);
                      } // End If
                      /* If LRTrim(Upper(xntestbo->CODINTER))=LRTrim(Upper(qbe_frap_chkdiana->CONNESCLI)) */
                      if (CPLib.eqr(CPLib.LRTrim(CPLib.Upper(Cursor_xntestbo.GetString("CODINTER"))),CPLib.LRTrim(CPLib.Upper(Cursor_qbe_frap_chkdiana.GetString("CONNESCLI"))))) {
                        /* _avanza := 1 */
                        _avanza = CPLib.Round(1,0);
                      } // End If
                      /* If _avanza = 0 */
                      if (CPLib.eqr(_avanza,0)) {
                        /* _codrif := xntestbo->CODINTER */
                        _codrif = Cursor_xntestbo.GetString("CODINTER");
                        /* If qbe_frap_chkdiana->DATAOPE > CharToDate('20131231') */
                        if (CPLib.gt(Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                          /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '7' + _idereg */
                          _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                          /* pTipoR := '7' // Tipo Riga */
                          pTipoR = "7";
                        } else { // Else
                          /* If Empty(qbe_frap_chkdiana->CONNESOPER) or (LRTrim(Upper(qbe_frap_chkdiana->CONNESOPER))=LRTrim(Upper(qbe_frap_chkdiana->CONNESCLI))) */
                          if (CPLib.Empty(Cursor_qbe_frap_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(CPLib.LRTrim(CPLib.Upper(Cursor_qbe_frap_chkdiana.GetString("CONNESOPER"))),CPLib.LRTrim(CPLib.Upper(Cursor_qbe_frap_chkdiana.GetString("CONNESCLI")))))) {
                            /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                            _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                            /* pTipoR := '2' // Tipo Riga */
                            pTipoR = "2";
                          } else { // Else
                            /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                            _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                            /* pTipoR := '3' // Tipo Riga */
                            pTipoR = "3";
                          } // End If
                        } // End If
                        /* pCli := xntestbo->CODINTER // Codice Soggetto */
                        pCli = Cursor_xntestbo.GetString("CODINTER");
                        /* pDatOpe := iif(w_stoper='R',qbe_frap_chkdiana->DATAREG,qbe_frap_chkdiana->DATAOPE) // Data Operazione */
                        pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_frap_chkdiana.GetDate("DATAREG"):Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"));
                        /* pRap := qbe_frap_chkdiana->RAPPORTO // Codice Rapporto */
                        pRap = Cursor_qbe_frap_chkdiana.GetString("RAPPORTO");
                        /* pTRap := qbe_frap_chkdiana->FLAGRAP // Tipo Rapporto */
                        pTRap = Cursor_qbe_frap_chkdiana.GetString("FLAGRAP");
                        /* pRAE := _raeatc // RAE o ATECO */
                        pRAE = _raeatc;
                        /* pSTATO := qbe_frap_chkdiana->STATOREG // Stato Registrazione */
                        pSTATO = Cursor_qbe_frap_chkdiana.GetString("STATOREG");
                        /* pDatRet := qbe_frap_chkdiana->DATARETT // Data Rettifica */
                        pDatRet = Cursor_qbe_frap_chkdiana.GetDate("DATARETT");
                        /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                        DatiSoggetto();
                        /* Exec "Scrittura Dati" Page 15:Page_19 */
                        Page_19();
                        /* nTotRec := nTotRec + 1 */
                        nTotRec = CPLib.Round(nTotRec+1,0);
                        /* nNumRec := nNumRec + 1 */
                        nNumRec = CPLib.Round(nNumRec+1,0);
                      } // End If
                    } // End If
                    Cursor_xntestbo.Next();
                  }
                  m_cConnectivityError = Cursor_xntestbo.ErrorMessage();
                  Cursor_xntestbo.Close();
                  // * --- End Select
                } else { // Else
                  // * --- Select from intestbo
                  m_cServer = m_Ctx.GetServer("intestbo");
                  m_cPhName = m_Ctx.GetPhName("intestbo");
                  if (Cursor_intestbo!=null)
                    Cursor_intestbo.Close();
                  Cursor_intestbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"RAPPORTO="+CPLib.ToSQL(Cursor_qbe_frap_chkdiana.GetString("RAPPORTO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("intestbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                  while ( ! (Cursor_intestbo.Eof())) {
                    /* If qbe_frap_chkdiana->RAPPORTO = intestbo->RAPPORTO */
                    if (CPLib.eqr(Cursor_qbe_frap_chkdiana.GetString("RAPPORTO"),Cursor_intestbo.GetString("RAPPORTO"))) {
                      /* _avanza := 0 */
                      _avanza = CPLib.Round(0,0);
                      /* If Empty(intestbo->CODINTER) or intestbo->STATOREG='2' or intestbo->STATOREG='3' */
                      if (CPLib.Empty(Cursor_intestbo.GetString("CODINTER")) || CPLib.eqr(Cursor_intestbo.GetString("STATOREG"),"2") || CPLib.eqr(Cursor_intestbo.GetString("STATOREG"),"3")) {
                        /* _avanza := 1 */
                        _avanza = CPLib.Round(1,0);
                      } // End If
                      /* If intestbo->DATAINI > qbe_frap_chkdiana->DATAOPE */
                      if (CPLib.gt(Cursor_intestbo.GetDate("DATAINI"),Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"))) {
                        /* _avanza := 1 */
                        _avanza = CPLib.Round(1,0);
                      } // End If
                      /* If not(Empty(intestbo->DATAFINE)) and intestbo->DATAFINE < qbe_frap_chkdiana->DATAOPE */
                      if ( ! (CPLib.Empty(Cursor_intestbo.GetDate("DATAFINE"))) && CPLib.lt(Cursor_intestbo.GetDate("DATAFINE"),Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"))) {
                        /* _avanza := 1 */
                        _avanza = CPLib.Round(1,0);
                      } // End If
                      /* If LRTrim(Upper(intestbo->CODINTER))=LRTrim(Upper(qbe_frap_chkdiana->CONNESCLI)) */
                      if (CPLib.eqr(CPLib.LRTrim(CPLib.Upper(Cursor_intestbo.GetString("CODINTER"))),CPLib.LRTrim(CPLib.Upper(Cursor_qbe_frap_chkdiana.GetString("CONNESCLI"))))) {
                        /* _avanza := 1 */
                        _avanza = CPLib.Round(1,0);
                      } // End If
                      /* If _avanza = 0 */
                      if (CPLib.eqr(_avanza,0)) {
                        /* _codrif := intestbo->CODINTER */
                        _codrif = Cursor_intestbo.GetString("CODINTER");
                        /* If qbe_frap_chkdiana->DATAOPE > CharToDate('20131231') */
                        if (CPLib.gt(Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                          /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '7' + _idereg */
                          _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                          /* pTipoR := '7' // Tipo Riga */
                          pTipoR = "7";
                        } else { // Else
                          /* If Empty(qbe_frap_chkdiana->CONNESOPER) or (LRTrim(Upper(qbe_frap_chkdiana->CONNESOPER))=LRTrim(Upper(qbe_frap_chkdiana->CONNESCLI))) */
                          if (CPLib.Empty(Cursor_qbe_frap_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(CPLib.LRTrim(CPLib.Upper(Cursor_qbe_frap_chkdiana.GetString("CONNESOPER"))),CPLib.LRTrim(CPLib.Upper(Cursor_qbe_frap_chkdiana.GetString("CONNESCLI")))))) {
                            /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                            _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                            /* pTipoR := '2' // Tipo Riga */
                            pTipoR = "2";
                          } else { // Else
                            /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                            _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                            /* pTipoR := '3' // Tipo Riga */
                            pTipoR = "3";
                          } // End If
                        } // End If
                        /* pCli := intestbo->CODINTER // Codice Soggetto */
                        pCli = Cursor_intestbo.GetString("CODINTER");
                        /* pDatOpe := iif(w_stoper='R',qbe_frap_chkdiana->DATAREG,qbe_frap_chkdiana->DATAOPE) // Data Operazione */
                        pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_frap_chkdiana.GetDate("DATAREG"):Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"));
                        /* pRap := qbe_frap_chkdiana->RAPPORTO // Codice Rapporto */
                        pRap = Cursor_qbe_frap_chkdiana.GetString("RAPPORTO");
                        /* pTRap := qbe_frap_chkdiana->FLAGRAP // Tipo Rapporto */
                        pTRap = Cursor_qbe_frap_chkdiana.GetString("FLAGRAP");
                        /* pRAE := _raeatc // RAE o ATECO */
                        pRAE = _raeatc;
                        /* pSTATO := qbe_frap_chkdiana->STATOREG // Stato Registrazione */
                        pSTATO = Cursor_qbe_frap_chkdiana.GetString("STATOREG");
                        /* pDatRet := qbe_frap_chkdiana->DATARETT // Data Rettifica */
                        pDatRet = Cursor_qbe_frap_chkdiana.GetDate("DATARETT");
                        /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                        DatiSoggetto();
                        /* Exec "Scrittura Dati" Page 15:Page_19 */
                        Page_19();
                        /* nTotRec := nTotRec + 1 */
                        nTotRec = CPLib.Round(nTotRec+1,0);
                        /* nNumRec := nNumRec + 1 */
                        nNumRec = CPLib.Round(nNumRec+1,0);
                      } // End If
                    } // End If
                    Cursor_intestbo.Next();
                  }
                  m_cConnectivityError = Cursor_intestbo.ErrorMessage();
                  Cursor_intestbo.Close();
                  // * --- End Select
                } // End If
                Cursor_knarapbo.Next();
              }
              m_cConnectivityError = Cursor_knarapbo.ErrorMessage();
              Cursor_knarapbo.Close();
              // * --- End Select
            } // End If
          } // End If
          /* If not(Empty(LRTrim(_oldrap))) and _xlientifrz */
          if ( ! (CPLib.Empty(CPLib.LRTrim(_oldrap))) && _xlientifrz) {
            /* _oldrighe := 0 */
            _oldrighe = CPLib.Round(0,0);
            // * --- Select from xlientifrz
            m_cServer = m_Ctx.GetServer("xlientifrz");
            m_cPhName = m_Ctx.GetPhName("xlientifrz");
            if (Cursor_xlientifrz!=null)
              Cursor_xlientifrz.Close();
            Cursor_xlientifrz = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_frap_chkdiana.GetString("IDBASE"),"?",0,0)+"  and  CODSOG <> "+CPLib.ToSQL(Cursor_qbe_frap_chkdiana.GetString("CONNESCLI"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xlientifrz")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_xlientifrz.Eof())) {
              /* _rownum := 0 */
              _rownum = CPLib.Round(0,0);
              // * --- Read from intestbo
              m_cServer = m_Ctx.GetServer("intestbo");
              m_cPhName = m_Ctx.GetPhName("intestbo");
              m_cSql = "";
              m_cSql = m_cSql+"RAPPORTO="+CPSql.SQLValueAdapter(CPLib.ToSQL(Cursor_qbe_frap_chkdiana.GetString("RAPPORTO"),"C",25,0,m_cServer),m_cServer,Cursor_qbe_frap_chkdiana.GetString("RAPPORTO"));
              m_cSql = m_cSql+" and CODINTER="+CPSql.SQLValueAdapter(CPLib.ToSQL(Cursor_xlientifrz.GetString("CODSOG"),"C",16,0,m_cServer),m_cServer,Cursor_xlientifrz.GetString("CODSOG"));
              if (m_Ctx.IsSharedTemp("intestbo")) {
                m_cSql = m_cSql+" and context_id='"+m_Ctx.GetTempID()+"'";
              }
              if (Read_Cursor!=null)
                Read_Cursor.Close();
              Read_Cursor = m_Sql.Query(m_cServer,"select "+CPLib.GetMultilanguageField("CPROWNUM",m_Ctx,m_cServer)+" from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+m_cSql);
              if ( ! (Read_Cursor.Eof())) {
                _rownum = CPLib.Round(Read_Cursor.GetDouble("CPROWNUM"),0);
                Read_Cursor.Next();
                if ( ! (Read_Cursor.Eof())) {
                  Error l_oErrorFault = new Error("Read on intestbo into routine arrt_chkdiana_all returns two or more records. This item should return only a record.");
                  CPStdCounter.Error(l_oErrorFault);
                }
                Read_Cursor.Close();
              } else {
                // Error: no record found!
                _rownum = 0;
                Read_Cursor.Close();
                m_cLastMsgError = "MSG_RECORD_NOT_FOUND";
              }
              /* If _rownum = 0 */
              if (CPLib.eqr(_rownum,0)) {
                /* If qbe_frap_chkdiana->DATAOPE > CharToDate('20131231') */
                if (CPLib.gt(Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '7' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"7"+_idereg;
                  /* pTipoR := '7' // Tipo Riga */
                  pTipoR = "7";
                } else { // Else
                  /* If Empty(qbe_frap_chkdiana->CONNESOPER) or (qbe_frap_chkdiana->CONNESOPER=xlientifrz->CODSOG) */
                  if (CPLib.Empty(Cursor_qbe_frap_chkdiana.GetString("CONNESOPER")) || (CPLib.eqr(Cursor_qbe_frap_chkdiana.GetString("CONNESOPER"),Cursor_xlientifrz.GetString("CODSOG")))) {
                    /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '2' + _idereg */
                    _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"2"+_idereg;
                    /* pTipoR := '2' // Tipo Riga */
                    pTipoR = "2";
                  } else { // Else
                    /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '3' + _idereg */
                    _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"3"+_idereg;
                    /* pTipoR := '3' // Tipo Riga */
                    pTipoR = "3";
                  } // End If
                } // End If
                /* _note := _note + _idereg */
                _note = _note+_idereg;
                /* pCli := xlientifrz->CODSOG // Codice Soggetto */
                pCli = Cursor_xlientifrz.GetString("CODSOG");
                /* pDatOpe := iif(w_stoper='R',qbe_frap_chkdiana->DATAREG,qbe_frap_chkdiana->DATAOPE) // Data Operazione */
                pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_frap_chkdiana.GetDate("DATAREG"):Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"));
                /* pRap := qbe_frap_chkdiana->RAPPORTO // Codice Rapporto */
                pRap = Cursor_qbe_frap_chkdiana.GetString("RAPPORTO");
                /* pTRap := qbe_frap_chkdiana->FLAGRAP // Tipo Rapporto */
                pTRap = Cursor_qbe_frap_chkdiana.GetString("FLAGRAP");
                /* pRAE := _raeatc // RAE o ATECO */
                pRAE = _raeatc;
                /* pSTATO := qbe_frap_chkdiana->STATOREG // Stato Registrazione */
                pSTATO = Cursor_qbe_frap_chkdiana.GetString("STATOREG");
                /* pDatRet := qbe_frap_chkdiana->DATARETT // Data Rettifica */
                pDatRet = Cursor_qbe_frap_chkdiana.GetDate("DATARETT");
                /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
                DatiSoggetto();
                /* Exec "Scrittura Dati" Page 15:Page_19 */
                Page_19();
                /* nTotRec := nTotRec + 1 */
                nTotRec = CPLib.Round(nTotRec+1,0);
                /* nNumRec := nNumRec + 1 */
                nNumRec = CPLib.Round(nNumRec+1,0);
              } // End If
              Cursor_xlientifrz.Next();
            }
            m_cConnectivityError = Cursor_xlientifrz.ErrorMessage();
            Cursor_xlientifrz.Close();
            // * --- End Select
          } // End If
          /* If not(Empty(qbe_frap_chkdiana->CONNESOPER)) and qbe_frap_chkdiana->CONNESOPER <> _codrif */
          if ( ! (CPLib.Empty(Cursor_qbe_frap_chkdiana.GetString("CONNESOPER"))) && CPLib.ne(Cursor_qbe_frap_chkdiana.GetString("CONNESOPER"),_codrif)) {
            /* If qbe_frap_chkdiana->DATAOPE > CharToDate('20131231') */
            if (CPLib.gt(Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '8' + _idereg */
              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"8"+_idereg;
              /* pTipoR := '8' // Tipo Riga */
              pTipoR = "8";
            } else { // Else
              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '4' + _idereg */
              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"4"+_idereg;
              /* pTipoR := '4' // Tipo Riga */
              pTipoR = "4";
            } // End If
            /* pCli := qbe_frap_chkdiana->CONNESOPER // Codice Soggetto */
            pCli = Cursor_qbe_frap_chkdiana.GetString("CONNESOPER");
            /* pDatOpe := iif(w_stoper='R',qbe_frap_chkdiana->DATAREG,qbe_frap_chkdiana->DATAOPE) // Data Operazione */
            pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_frap_chkdiana.GetDate("DATAREG"):Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"));
            /* pRap := qbe_frap_chkdiana->RAPPORTO // Codice Rapporto */
            pRap = Cursor_qbe_frap_chkdiana.GetString("RAPPORTO");
            /* pTRap := qbe_frap_chkdiana->FLAGRAP // Tipo Rapporto */
            pTRap = Cursor_qbe_frap_chkdiana.GetString("FLAGRAP");
            /* pRAE := _raeatc // RAE o ATECO */
            pRAE = _raeatc;
            /* pSTATO := qbe_frap_chkdiana->STATOREG // Stato Registrazione */
            pSTATO = Cursor_qbe_frap_chkdiana.GetString("STATOREG");
            /* pDatRet := qbe_frap_chkdiana->DATARETT // Data Rettifica */
            pDatRet = Cursor_qbe_frap_chkdiana.GetDate("DATARETT");
            /* _oldmc := _usemc */
            _oldmc = CPLib.Round(_usemc,0);
            /* _usemc := 0 */
            _usemc = CPLib.Round(0,0);
            /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
            DatiSoggetto();
            /* _usemc := _oldmc */
            _usemc = CPLib.Round(_oldmc,0);
            /* Exec "Scrittura Dati" Page 15:Page_19 */
            Page_19();
            /* nTotRec := nTotRec + 1 */
            nTotRec = CPLib.Round(nTotRec+1,0);
            /* nNumRec := nNumRec + 1 */
            nNumRec = CPLib.Round(nNumRec+1,0);
          } // End If
          /* If _xogopefbo */
          if (_xogopefbo) {
            // * --- Select from xogopefbo
            m_cServer = m_Ctx.GetServer("xogopefbo");
            m_cPhName = m_Ctx.GetPhName("xogopefbo");
            if (Cursor_xogopefbo!=null)
              Cursor_xogopefbo.Close();
            Cursor_xogopefbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_frap_chkdiana.GetString("IDBASE"),"?",0,0)+"  and  CODSOG <> "+CPLib.ToSQL(Cursor_qbe_frap_chkdiana.GetString("CONNESOPER"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xogopefbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_xogopefbo.Eof())) {
              /* If qbe_frap_chkdiana->DATAOPE > CharToDate('20131231') */
              if (CPLib.gt(Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '8' + _idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"8"+_idereg;
                /* pTipoR := '8' // Tipo Riga */
                pTipoR = "8";
              } else { // Else
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '4' + _idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"4"+_idereg;
                /* pTipoR := '4' // Tipo Riga */
                pTipoR = "4";
              } // End If
              /* pCli := xogopefbo->CODSOG // Codice Soggetto */
              pCli = Cursor_xogopefbo.GetString("CODSOG");
              /* pDatOpe := iif(w_stoper='R',qbe_frap_chkdiana->DATAREG,qbe_frap_chkdiana->DATAOPE) // Data Operazione */
              pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_frap_chkdiana.GetDate("DATAREG"):Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"));
              /* pRap := qbe_frap_chkdiana->RAPPORTO // Codice Rapporto */
              pRap = Cursor_qbe_frap_chkdiana.GetString("RAPPORTO");
              /* pTRap := qbe_frap_chkdiana->FLAGRAP // Tipo Rapporto */
              pTRap = Cursor_qbe_frap_chkdiana.GetString("FLAGRAP");
              /* pRAE := _raeatc // RAE o ATECO */
              pRAE = _raeatc;
              /* pSTATO := qbe_frap_chkdiana->STATOREG // Stato Registrazione */
              pSTATO = Cursor_qbe_frap_chkdiana.GetString("STATOREG");
              /* pDatRet := qbe_frap_chkdiana->DATARETT // Data Rettifica */
              pDatRet = Cursor_qbe_frap_chkdiana.GetDate("DATARETT");
              /* _oldmc := _usemc */
              _oldmc = CPLib.Round(_usemc,0);
              /* _usemc := 0 */
              _usemc = CPLib.Round(0,0);
              /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
              DatiSoggetto();
              /* _usemc := _oldmc */
              _usemc = CPLib.Round(_oldmc,0);
              /* Exec "Scrittura Dati" Page 15:Page_19 */
              Page_19();
              /* nTotRec := nTotRec + 1 */
              nTotRec = CPLib.Round(nTotRec+1,0);
              /* nNumRec := nNumRec + 1 */
              nNumRec = CPLib.Round(nNumRec+1,0);
              Cursor_xogopefbo.Next();
            }
            m_cConnectivityError = Cursor_xogopefbo.ErrorMessage();
            Cursor_xogopefbo.Close();
            // * --- End Select
          } // End If
          /* If not(Empty(qbe_frap_chkdiana->CONNESBEN)) or not(Empty(qbe_frap_chkdiana->C_RAG)) */
          if ( ! (CPLib.Empty(Cursor_qbe_frap_chkdiana.GetString("CONNESBEN"))) ||  ! (CPLib.Empty(Cursor_qbe_frap_chkdiana.GetString("C_RAG")))) {
            /* If not(Empty(qbe_frap_chkdiana->C_RAG)) */
            if ( ! (CPLib.Empty(Cursor_qbe_frap_chkdiana.GetString("C_RAG")))) {
              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
              /* _note := _note + Left(LRTrim(qbe_frap_chkdiana->CONNESBEN)+Space(16),16) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("CONNESBEN"))+CPLib.Space(16),16);
              /* _note := _note +Left(LRTrim(qbe_frap_chkdiana->C_RAG)+Space(70),70) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_RAG"))+CPLib.Space(70),70);
              /* _note := _note + Left(LRTrim(qbe_frap_chkdiana->C_STA)+Space(3),3) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_STA"))+CPLib.Space(3),3);
              /* _note := _note +Left(LRTrim(qbe_frap_chkdiana->C_CAB)+Space(6),6) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_CAB"))+CPLib.Space(6),6);
              /* _note := _note +Left(LRTrim(qbe_frap_chkdiana->C_CTA)+Space(30),30) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_CTA"))+CPLib.Space(30),30);
              /* _note := _note + Left(LRTrim(qbe_frap_chkdiana->C_PRV)+Space(2),2) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_PRV"))+CPLib.Space(2),2);
              /* _note := _note + Left(LRTrim(qbe_frap_chkdiana->C_IND)+Space(35),35) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_IND"))+CPLib.Space(35),35);
              /* _note := _note + Left(LRTrim(qbe_frap_chkdiana->C_CAP)+Space(5),5) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_CAP"))+CPLib.Space(5),5);
              /* _note := _note + Space(63) */
              _note = _note+CPLib.Space(63);
              /* _note := _note + Left(LRTrim(qbe_frap_chkdiana->C_RAPPORTO)+Space(25),25) */
              _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_RAPPORTO"))+CPLib.Space(25),25);
              /* _note := _note + Space(91) */
              _note = _note+CPLib.Space(91);
              /* Exec "Scrittura Dati" Page 15:Page_19 */
              Page_19();
              /* nTotRec := nTotRec + 1 */
              nTotRec = CPLib.Round(nTotRec+1,0);
              /* nNumRec := nNumRec + 1 */
              nNumRec = CPLib.Round(nNumRec+1,0);
              /* ElseIf not(Empty(qbe_frap_chkdiana->CONNESBEN)) */
            } else if ( ! (CPLib.Empty(Cursor_qbe_frap_chkdiana.GetString("CONNESBEN")))) {
              /* _numsto := arfn_chkspers(qbe_frap_chkdiana->CONNESBEN,iif(w_stoper='R',Date(),qbe_frap_chkdiana->DATAOPE)) */
              _numsto = arfn_chkspersR.Make(m_Ctx,this).Run(Cursor_qbe_frap_chkdiana.GetString("CONNESBEN"),(CPLib.eqr(w_stoper,"R")?CPLib.Date():Cursor_qbe_frap_chkdiana.GetDate("DATAOPE")));
              /* If Empty(LRTrim(_numsto)) */
              if (CPLib.Empty(CPLib.LRTrim(_numsto))) {
                // * --- Select from personbo
                m_cServer = m_Ctx.GetServer("personbo");
                m_cPhName = m_Ctx.GetPhName("personbo");
                if (Cursor_personbo!=null)
                  Cursor_personbo.Close();
                Cursor_personbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CONNES="+CPLib.ToSQL(Cursor_qbe_frap_chkdiana.GetString("CONNESBEN"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("personbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                while ( ! (Cursor_personbo.Eof())) {
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
                  /* _note := _note + Left(LRTrim(qbe_frap_chkdiana->CONNESBEN)+Space(16),16) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("CONNESBEN"))+CPLib.Space(16),16);
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frap_chkdiana->C_RAG))),Left(LRTrim(qbe_frap_chkdiana->C_RAG)+Space(70),70),Left(LRTrim(personbo->RAGSOC)+Space(70),70)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_RAG"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_RAG"))+CPLib.Space(70),70):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("RAGSOC"))+CPLib.Space(70),70));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frap_chkdiana->C_STA))),Left(LRTrim(qbe_frap_chkdiana->C_STA)+Space(3),3),Left(LRTrim(personbo->PAESE)+Space(3),3)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_STA"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_STA"))+CPLib.Space(3),3):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PAESE"))+CPLib.Space(3),3));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frap_chkdiana->C_CAB))),Left(LRTrim(qbe_frap_chkdiana->C_CAB)+Space(6),6),Left(LRTrim(personbo->CODCAB)+Space(6),6)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_CAB"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_CAB"))+CPLib.Space(6),6):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CODCAB"))+CPLib.Space(6),6));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frap_chkdiana->C_CTA))),Left(LRTrim(qbe_frap_chkdiana->C_CTA)+Space(30),30),Left(LRTrim(personbo->DESCCIT)+Space(30),30)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_CTA"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_CTA"))+CPLib.Space(30),30):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DESCCIT"))+CPLib.Space(30),30));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frap_chkdiana->C_PRV))),Left(LRTrim(qbe_frap_chkdiana->C_PRV)+Space(2),2),Left(LRTrim(personbo->PROVINCIA)+Space(2),2)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_PRV"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_PRV"))+CPLib.Space(2),2):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PROVINCIA"))+CPLib.Space(2),2));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frap_chkdiana->C_IND))),Left(LRTrim(qbe_frap_chkdiana->C_IND)+Space(35),35),Left(LRTrim(personbo->DOMICILIO)+Space(35),35)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_IND"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_IND"))+CPLib.Space(35),35):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DOMICILIO"))+CPLib.Space(35),35));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frap_chkdiana->C_CAP))),Left(LRTrim(qbe_frap_chkdiana->C_CAP)+Space(5),5),Left(LRTrim(personbo->CAP)+Space(5),5)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_CAP"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_CAP"))+CPLib.Space(5),5):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CAP"))+CPLib.Space(5),5));
                  /* _note := _note + Space(63) */
                  _note = _note+CPLib.Space(63);
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frap_chkdiana->C_RAPPORTO))),Left(LRTrim(qbe_frap_chkdiana->C_RAPPORTO)+Space(25),25),Left(LRTrim(qbe_frap_chkdiana->RAPPORTBEN)+Space(25),25)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_RAPPORTO"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_RAPPORTO"))+CPLib.Space(25),25):CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("RAPPORTBEN"))+CPLib.Space(25),25));
                  /* _note := _note + Space(91) */
                  _note = _note+CPLib.Space(91);
                  /* Exec "Scrittura Dati" Page 15:Page_19 */
                  Page_19();
                  /* nTotRec := nTotRec + 1 */
                  nTotRec = CPLib.Round(nTotRec+1,0);
                  /* nNumRec := nNumRec + 1 */
                  nNumRec = CPLib.Round(nNumRec+1,0);
                  Cursor_personbo.Next();
                }
                m_cConnectivityError = Cursor_personbo.ErrorMessage();
                Cursor_personbo.Close();
                // * --- End Select
              } else { // Else
                // * --- Select from wersonbo
                m_cServer = m_Ctx.GetServer("wersonbo");
                m_cPhName = m_Ctx.GetPhName("wersonbo");
                if (Cursor_wersonbo!=null)
                  Cursor_wersonbo.Close();
                Cursor_wersonbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"sanumpro="+CPSql.SQLValueAdapter(CPLib.ToSQL(_numsto,"?",0,0,m_cServer, m_oParameters),m_cServer,_numsto)+" "+")"+(m_Ctx.IsSharedTemp("wersonbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                while ( ! (Cursor_wersonbo.Eof())) {
                  /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
                  _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
                  /* _note := _note + Left(LRTrim(qbe_frap_chkdiana->CONNESBEN)+Space(16),16) */
                  _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("CONNESBEN"))+CPLib.Space(16),16);
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frap_chkdiana->C_RAG))),Left(LRTrim(qbe_frap_chkdiana->C_RAG)+Space(70),70),Left(LRTrim(wersonbo->RAGSOC)+Space(70),70)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_RAG"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_RAG"))+CPLib.Space(70),70):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("RAGSOC"))+CPLib.Space(70),70));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frap_chkdiana->C_STA))),Left(LRTrim(qbe_frap_chkdiana->C_STA)+Space(3),3),Left(LRTrim(wersonbo->PAESE)+Space(3),3)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_STA"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_STA"))+CPLib.Space(3),3):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PAESE"))+CPLib.Space(3),3));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frap_chkdiana->C_CAB))),Left(LRTrim(qbe_frap_chkdiana->C_CAB)+Space(6),6),Left(LRTrim(wersonbo->CODCAB)+Space(6),6)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_CAB"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_CAB"))+CPLib.Space(6),6):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CODCAB"))+CPLib.Space(6),6));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frap_chkdiana->C_CTA))),Left(LRTrim(qbe_frap_chkdiana->C_CTA)+Space(30),30),Left(LRTrim(wersonbo->DESCCIT)+Space(30),30)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_CTA"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_CTA"))+CPLib.Space(30),30):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DESCCIT"))+CPLib.Space(30),30));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frap_chkdiana->C_PRV))),Left(LRTrim(qbe_frap_chkdiana->C_PRV)+Space(2),2),Left(LRTrim(wersonbo->PROVINCIA)+Space(2),2)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_PRV"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_PRV"))+CPLib.Space(2),2):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PROVINCIA"))+CPLib.Space(2),2));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frap_chkdiana->C_IND))),Left(LRTrim(qbe_frap_chkdiana->C_IND)+Space(35),35),Left(LRTrim(wersonbo->DOMICILIO)+Space(35),35)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_IND"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_IND"))+CPLib.Space(35),35):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DOMICILIO"))+CPLib.Space(35),35));
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frap_chkdiana->C_CAP))),Left(LRTrim(qbe_frap_chkdiana->C_CAP)+Space(5),5),Left(LRTrim(wersonbo->CAP)+Space(5),5)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_CAP"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_CAP"))+CPLib.Space(5),5):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CAP"))+CPLib.Space(5),5));
                  /* _note := _note + Space(63) */
                  _note = _note+CPLib.Space(63);
                  /* _note := _note + iif(not(Empty(LRTrim(qbe_frap_chkdiana->C_RAPPORTO))),Left(LRTrim(qbe_frap_chkdiana->C_RAPPORTO)+Space(25),25),Left(LRTrim(qbe_frap_chkdiana->RAPPORTBEN)+Space(25),25)) */
                  _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_RAPPORTO"))))?CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("C_RAPPORTO"))+CPLib.Space(25),25):CPLib.Left(CPLib.LRTrim(Cursor_qbe_frap_chkdiana.GetString("RAPPORTBEN"))+CPLib.Space(25),25));
                  /* _note := _note + Space(91) */
                  _note = _note+CPLib.Space(91);
                  /* Exec "Scrittura Dati" Page 15:Page_19 */
                  Page_19();
                  /* nTotRec := nTotRec + 1 */
                  nTotRec = CPLib.Round(nTotRec+1,0);
                  /* nNumRec := nNumRec + 1 */
                  nNumRec = CPLib.Round(nNumRec+1,0);
                  Cursor_wersonbo.Next();
                }
                m_cConnectivityError = Cursor_wersonbo.ErrorMessage();
                Cursor_wersonbo.Close();
                // * --- End Select
              } // End If
            } // End If
          } // End If
          /* If _xeneficfrz */
          if (_xeneficfrz) {
            // * --- Select from xeneficfrz
            m_cServer = m_Ctx.GetServer("xeneficfrz");
            m_cPhName = m_Ctx.GetPhName("xeneficfrz");
            if (Cursor_xeneficfrz!=null)
              Cursor_xeneficfrz.Close();
            Cursor_xeneficfrz = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_frap_chkdiana.GetString("IDBASE"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xeneficfrz")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_xeneficfrz.Eof())) {
              /* If Empty(LRTrim(xeneficfrz->CODSOG)) and not(Empty(LRTrim(xeneficfrz->C_RAG))) */
              if (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficfrz.GetString("CODSOG"))) &&  ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_RAG"))))) {
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
                /* _note := _note + Left(LRTrim(xeneficfrz->CODSOG)+Space(16),16) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("CODSOG"))+CPLib.Space(16),16);
                /* _note := _note +Left(LRTrim(xeneficfrz->C_RAG)+Space(70),70) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_RAG"))+CPLib.Space(70),70);
                /* _note := _note + Left(LRTrim(xeneficfrz->C_STA)+Space(3),3) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_STA"))+CPLib.Space(3),3);
                /* _note := _note +Left(LRTrim(xeneficfrz->C_CAB)+Space(6),6) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_CAB"))+CPLib.Space(6),6);
                /* _note := _note +Left(LRTrim(xeneficfrz->C_CTA)+Space(30),30) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_CTA"))+CPLib.Space(30),30);
                /* _note := _note + Left(LRTrim(xeneficfrz->C_PRV)+Space(2),2) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_PRV"))+CPLib.Space(2),2);
                /* _note := _note + Left(LRTrim(xeneficfrz->C_IND)+Space(35),35) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_IND"))+CPLib.Space(35),35);
                /* _note := _note + Left(LRTrim(xeneficfrz->C_CAP)+Space(5),5) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_CAP"))+CPLib.Space(5),5);
                /* _note := _note + Space(63) */
                _note = _note+CPLib.Space(63);
                /* _note := _note + Left(LRTrim(xeneficfrz->C_RAPPORTO)+Space(25),25) */
                _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_RAPPORTO"))+CPLib.Space(25),25);
                /* _note := _note + Space(91) */
                _note = _note+CPLib.Space(91);
                /* Exec "Scrittura Dati" Page 15:Page_19 */
                Page_19();
                /* nTotRec := nTotRec + 1 */
                nTotRec = CPLib.Round(nTotRec+1,0);
                /* nNumRec := nNumRec + 1 */
                nNumRec = CPLib.Round(nNumRec+1,0);
              } else { // Else
                /* If xeneficfrz->CODSOG <> qbe_frap_chkdiana->CONNESBEN */
                if (CPLib.ne(Cursor_xeneficfrz.GetString("CODSOG"),Cursor_qbe_frap_chkdiana.GetString("CONNESBEN"))) {
                  /* _numsto := arfn_chkspers(xeneficfrz->CODSOG,iif(w_stoper='R',Date(),qbe_frap_chkdiana->DATAOPE)) */
                  _numsto = arfn_chkspersR.Make(m_Ctx,this).Run(Cursor_xeneficfrz.GetString("CODSOG"),(CPLib.eqr(w_stoper,"R")?CPLib.Date():Cursor_qbe_frap_chkdiana.GetDate("DATAOPE")));
                  /* If Empty(LRTrim(_numsto)) */
                  if (CPLib.Empty(CPLib.LRTrim(_numsto))) {
                    // * --- Select from personbo
                    m_cServer = m_Ctx.GetServer("personbo");
                    m_cPhName = m_Ctx.GetPhName("personbo");
                    if (Cursor_personbo!=null)
                      Cursor_personbo.Close();
                    Cursor_personbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CONNES="+CPLib.ToSQL(Cursor_xeneficfrz.GetString("CODSOG"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("personbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                    while ( ! (Cursor_personbo.Eof())) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
                      /* _note := _note + Left(LRTrim(xeneficfrz->CODSOG)+Space(16),16) */
                      _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("CODSOG"))+CPLib.Space(16),16);
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficfrz->C_RAG))),Left(LRTrim(xeneficfrz->C_RAG)+Space(70),70),Left(LRTrim(personbo->RAGSOC)+Space(70),70)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_RAG"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_RAG"))+CPLib.Space(70),70):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("RAGSOC"))+CPLib.Space(70),70));
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficfrz->C_STA))),Left(LRTrim(xeneficfrz->C_STA)+Space(3),3),Left(LRTrim(personbo->PAESE)+Space(3),3)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_STA"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_STA"))+CPLib.Space(3),3):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PAESE"))+CPLib.Space(3),3));
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficfrz->C_CAB))),Left(LRTrim(xeneficfrz->C_CAB)+Space(6),6),Left(LRTrim(personbo->CODCAB)+Space(6),6)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_CAB"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_CAB"))+CPLib.Space(6),6):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CODCAB"))+CPLib.Space(6),6));
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficfrz->C_CTA))),Left(LRTrim(xeneficfrz->C_CTA)+Space(30),30),Left(LRTrim(personbo->DESCCIT)+Space(30),30)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_CTA"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_CTA"))+CPLib.Space(30),30):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DESCCIT"))+CPLib.Space(30),30));
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficfrz->C_PRV))),Left(LRTrim(xeneficfrz->C_PRV)+Space(2),2),Left(LRTrim(personbo->PROVINCIA)+Space(2),2)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_PRV"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_PRV"))+CPLib.Space(2),2):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PROVINCIA"))+CPLib.Space(2),2));
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficfrz->C_IND))),Left(LRTrim(xeneficfrz->C_IND)+Space(35),35),Left(LRTrim(personbo->DOMICILIO)+Space(35),35)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_IND"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_IND"))+CPLib.Space(35),35):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DOMICILIO"))+CPLib.Space(35),35));
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficfrz->C_CAP))),Left(LRTrim(xeneficfrz->C_CAP)+Space(5),5),Left(LRTrim(personbo->CAP)+Space(5),5)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_CAP"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_CAP"))+CPLib.Space(5),5):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CAP"))+CPLib.Space(5),5));
                      /* _note := _note + Space(63) */
                      _note = _note+CPLib.Space(63);
                      /* _note := _note +Left(LRTrim(xeneficfrz->C_RAPPORTO)+Space(25),25) */
                      _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_RAPPORTO"))+CPLib.Space(25),25);
                      /* _note := _note + Space(91) */
                      _note = _note+CPLib.Space(91);
                      /* Exec "Scrittura Dati" Page 15:Page_19 */
                      Page_19();
                      /* nTotRec := nTotRec + 1 */
                      nTotRec = CPLib.Round(nTotRec+1,0);
                      /* nNumRec := nNumRec + 1 */
                      nNumRec = CPLib.Round(nNumRec+1,0);
                      Cursor_personbo.Next();
                    }
                    m_cConnectivityError = Cursor_personbo.ErrorMessage();
                    Cursor_personbo.Close();
                    // * --- End Select
                  } else { // Else
                    // * --- Select from wersonbo
                    m_cServer = m_Ctx.GetServer("wersonbo");
                    m_cPhName = m_Ctx.GetPhName("wersonbo");
                    if (Cursor_wersonbo!=null)
                      Cursor_wersonbo.Close();
                    Cursor_wersonbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"sanumpro="+CPSql.SQLValueAdapter(CPLib.ToSQL(_numsto,"?",0,0,m_cServer, m_oParameters),m_cServer,_numsto)+" "+")"+(m_Ctx.IsSharedTemp("wersonbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
                    while ( ! (Cursor_wersonbo.Eof())) {
                      /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11)+'5' + _idereg */
                      _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"5"+_idereg;
                      /* _note := _note + Left(LRTrim(xeneficfrz->CODSOG)+Space(16),16) */
                      _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("CODSOG"))+CPLib.Space(16),16);
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficfrz->C_RAG))),Left(LRTrim(xeneficfrz->C_RAG)+Space(70),70),Left(LRTrim(wersonbo->RAGSOC)+Space(70),70)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_RAG"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_RAG"))+CPLib.Space(70),70):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("RAGSOC"))+CPLib.Space(70),70));
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficfrz->C_STA))),Left(LRTrim(xeneficfrz->C_STA)+Space(3),3),Left(LRTrim(wersonbo->PAESE)+Space(3),3)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_STA"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_STA"))+CPLib.Space(3),3):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PAESE"))+CPLib.Space(3),3));
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficfrz->C_CAB))),Left(LRTrim(xeneficfrz->C_CAB)+Space(6),6),Left(LRTrim(wersonbo->CODCAB)+Space(6),6)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_CAB"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_CAB"))+CPLib.Space(6),6):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CODCAB"))+CPLib.Space(6),6));
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficfrz->C_CTA))),Left(LRTrim(xeneficfrz->C_CTA)+Space(30),30),Left(LRTrim(wersonbo->DESCCIT)+Space(30),30)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_CTA"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_CTA"))+CPLib.Space(30),30):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DESCCIT"))+CPLib.Space(30),30));
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficfrz->C_PRV))),Left(LRTrim(xeneficfrz->C_PRV)+Space(2),2),Left(LRTrim(wersonbo->PROVINCIA)+Space(2),2)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_PRV"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_PRV"))+CPLib.Space(2),2):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PROVINCIA"))+CPLib.Space(2),2));
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficfrz->C_IND))),Left(LRTrim(xeneficfrz->C_IND)+Space(35),35),Left(LRTrim(wersonbo->DOMICILIO)+Space(35),35)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_IND"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_IND"))+CPLib.Space(35),35):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DOMICILIO"))+CPLib.Space(35),35));
                      /* _note := _note + iif(not(Empty(LRTrim(xeneficfrz->C_CAP))),Left(LRTrim(xeneficfrz->C_CAP)+Space(5),5),Left(LRTrim(wersonbo->CAP)+Space(5),5)) */
                      _note = _note+( ! (CPLib.Empty(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_CAP"))))?CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_CAP"))+CPLib.Space(5),5):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CAP"))+CPLib.Space(5),5));
                      /* _note := _note + Space(63) */
                      _note = _note+CPLib.Space(63);
                      /* _note := _note +Left(LRTrim(xeneficfrz->C_RAPPORTO)+Space(25),25) */
                      _note = _note+CPLib.Left(CPLib.LRTrim(Cursor_xeneficfrz.GetString("C_RAPPORTO"))+CPLib.Space(25),25);
                      /* _note := _note + Space(91) */
                      _note = _note+CPLib.Space(91);
                      /* Exec "Scrittura Dati" Page 15:Page_19 */
                      Page_19();
                      /* nTotRec := nTotRec + 1 */
                      nTotRec = CPLib.Round(nTotRec+1,0);
                      /* nNumRec := nNumRec + 1 */
                      nNumRec = CPLib.Round(nNumRec+1,0);
                      Cursor_wersonbo.Next();
                    }
                    m_cConnectivityError = Cursor_wersonbo.ErrorMessage();
                    Cursor_wersonbo.Close();
                    // * --- End Select
                  } // End If
                } // End If
              } // End If
              Cursor_xeneficfrz.Next();
            }
            m_cConnectivityError = Cursor_xeneficfrz.ErrorMessage();
            Cursor_xeneficfrz.Close();
            // * --- End Select
          } // End If
          /* If not(Empty(qbe_frap_chkdiana->CONNALTRO)) */
          if ( ! (CPLib.Empty(Cursor_qbe_frap_chkdiana.GetString("CONNALTRO")))) {
            /* If qbe_frap_chkdiana->DATAOPE > CharToDate('20131231') */
            if (CPLib.gt(Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '9' + _idereg */
              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"9"+_idereg;
              /* pTipoR := '9' // Tipo Riga */
              pTipoR = "9";
            } else { // Else
              /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '6' + _idereg */
              _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"6"+_idereg;
              /* pTipoR := '6' // Tipo Riga */
              pTipoR = "6";
            } // End If
            /* pCli := qbe_frap_chkdiana->CONNALTRO // Codice Soggetto */
            pCli = Cursor_qbe_frap_chkdiana.GetString("CONNALTRO");
            /* pDatOpe := iif(w_stoper='R',qbe_frap_chkdiana->DATAREG,qbe_frap_chkdiana->DATAOPE) // Data Operazione */
            pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_frap_chkdiana.GetDate("DATAREG"):Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"));
            /* pRap := qbe_frap_chkdiana->RAPPORTO // Codice Rapporto */
            pRap = Cursor_qbe_frap_chkdiana.GetString("RAPPORTO");
            /* pTRap := qbe_frap_chkdiana->FLAGRAP // Tipo Rapporto */
            pTRap = Cursor_qbe_frap_chkdiana.GetString("FLAGRAP");
            /* pRAE := _raeatc // RAE o ATECO */
            pRAE = _raeatc;
            /* pSTATO := qbe_frap_chkdiana->STATOREG // Stato Registrazione */
            pSTATO = Cursor_qbe_frap_chkdiana.GetString("STATOREG");
            /* pDatRet := qbe_frap_chkdiana->DATARETT // Data Rettifica */
            pDatRet = Cursor_qbe_frap_chkdiana.GetDate("DATARETT");
            /* _oldmc := _usemc */
            _oldmc = CPLib.Round(_usemc,0);
            /* _usemc := 0 */
            _usemc = CPLib.Round(0,0);
            /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
            DatiSoggetto();
            /* _usemc := _oldmc */
            _usemc = CPLib.Round(_oldmc,0);
            /* Exec "Scrittura Dati" Page 15:Page_19 */
            Page_19();
            /* nTotRec := nTotRec + 1 */
            nTotRec = CPLib.Round(nTotRec+1,0);
            /* nNumRec := nNumRec + 1 */
            nNumRec = CPLib.Round(nNumRec+1,0);
          } // End If
          /* If _xerzistifrz */
          if (_xerzistifrz) {
            // * --- Select from xerzistifrz
            m_cServer = m_Ctx.GetServer("xerzistifrz");
            m_cPhName = m_Ctx.GetPhName("xerzistifrz");
            if (Cursor_xerzistifrz!=null)
              Cursor_xerzistifrz.Close();
            Cursor_xerzistifrz = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"IDFILEBO="+CPLib.ToSQL(Cursor_qbe_frap_chkdiana.GetString("IDBASE"),"?",0,0)+"  and  CODSOG <> "+CPLib.ToSQL(Cursor_qbe_frap_chkdiana.GetString("CONNALTRO"),"?",0,0)+" "+")"+(m_Ctx.IsSharedTemp("xerzistifrz")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
            while ( ! (Cursor_xerzistifrz.Eof())) {
              /* If qbe_frap_chkdiana->DATAOPE > CharToDate('20131231') */
              if (CPLib.gt(Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"),CPLib.CharToDate("20131231"))) {
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '9' + _idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"9"+_idereg;
                /* pTipoR := '9' // Tipo Riga */
                pTipoR = "9";
              } else { // Else
                /* _note := w_tipinter + Left(LRTrim(w_codinter)+Space(11),11) + '6' + _idereg */
                _note = w_tipinter+CPLib.Left(CPLib.LRTrim(w_codinter)+CPLib.Space(11),11)+"6"+_idereg;
                /* pTipoR := '6' // Tipo Riga */
                pTipoR = "6";
              } // End If
              /* pCli := xerzistifrz->CODSOG // Codice Soggetto */
              pCli = Cursor_xerzistifrz.GetString("CODSOG");
              /* pDatOpe := iif(w_stoper='R',qbe_frap_chkdiana->DATAREG,qbe_frap_chkdiana->DATAOPE) // Data Operazione */
              pDatOpe = (CPLib.eqr(w_stoper,"R")?Cursor_qbe_frap_chkdiana.GetDate("DATAREG"):Cursor_qbe_frap_chkdiana.GetDate("DATAOPE"));
              /* pRap := qbe_frap_chkdiana->RAPPORTO // Codice Rapporto */
              pRap = Cursor_qbe_frap_chkdiana.GetString("RAPPORTO");
              /* pTRap := qbe_frap_chkdiana->FLAGRAP // Tipo Rapporto */
              pTRap = Cursor_qbe_frap_chkdiana.GetString("FLAGRAP");
              /* pRAE := _raeatc // RAE o ATECO */
              pRAE = _raeatc;
              /* pSTATO := qbe_frap_chkdiana->STATOREG // Stato Registrazione */
              pSTATO = Cursor_qbe_frap_chkdiana.GetString("STATOREG");
              /* pDatRet := qbe_frap_chkdiana->DATARETT // Data Rettifica */
              pDatRet = Cursor_qbe_frap_chkdiana.GetDate("DATARETT");
              /* _oldmc := _usemc */
              _oldmc = CPLib.Round(_usemc,0);
              /* _usemc := 0 */
              _usemc = CPLib.Round(0,0);
              /* Exec "Ritorna i dati dei soggetti" Page 18:DatiSoggetto */
              DatiSoggetto();
              /* _usemc := _oldmc */
              _usemc = CPLib.Round(_oldmc,0);
              /* Exec "Scrittura Dati" Page 15:Page_19 */
              Page_19();
              /* nTotRec := nTotRec + 1 */
              nTotRec = CPLib.Round(nTotRec+1,0);
              /* nNumRec := nNumRec + 1 */
              nNumRec = CPLib.Round(nNumRec+1,0);
              Cursor_xerzistifrz.Next();
            }
            m_cConnectivityError = Cursor_xerzistifrz.ErrorMessage();
            Cursor_xerzistifrz.Close();
            // * --- End Select
          } // End If
          /* gNumRec := nTotRec // N° Record DIANA */
          gNumRec = CPLib.Round(nTotRec,0);
          m_Ctx.SetGlobalNumber("gNumRec",gNumRec);
          /* gNumReg := nTotReg // N° Registrazioni DIANA */
          gNumReg = CPLib.Round(nTotReg,0);
          m_Ctx.SetGlobalNumber("gNumReg",gNumReg);
          Cursor_qbe_frap_chkdiana.Next();
        }
        m_cConnectivityError = Cursor_qbe_frap_chkdiana.ErrorMessage();
        Cursor_qbe_frap_chkdiana.Close();
        // * --- End Select
        /* _contacilci := _contacilci+1 */
        _contacilci = CPLib.Round(_contacilci+1,0);
      } // End While
    } finally {
      try {
        if (Cursor_qbe_frap_chkdiana_limits!=null)
          Cursor_qbe_frap_chkdiana_limits.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_qbe_frap_chkdiana!=null)
          Cursor_qbe_frap_chkdiana.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_knarapbo!=null)
          Cursor_knarapbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_kersonbo!=null)
          Cursor_kersonbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Read_Cursor!=null)
          Read_Cursor.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_xntestbo!=null)
          Cursor_xntestbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_intestbo!=null)
          Cursor_intestbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_xlientifrz!=null)
          Cursor_xlientifrz.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_xogopefbo!=null)
          Cursor_xogopefbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_personbo!=null)
          Cursor_personbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_wersonbo!=null)
          Cursor_wersonbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_xeneficfrz!=null)
          Cursor_xeneficfrz.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_xerzistifrz!=null)
          Cursor_xerzistifrz.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
    }
  }
  void Page_15() throws Exception {
    for (MemoryCursorRow_tipo1 rwTipo1 : mcTipo1._iterable_()) {
      /* _conta1 := _conta1 + 1 */
      _conta1 = CPLib.Round(_conta1+1,0);
      // * --- Insert into tipo1 from values
      m_Sql.RequireTransaction();
      m_cServer = m_Ctx.GetServer("tipo1");
      m_cPhName = m_Ctx.GetPhName("tipo1");
      m_oWrInfo = CPPhTableWrInfo.GetCPPhTableWrInfo(m_Ctx,"tipo1",m_Ctx.GetCompany());
      m_oParameters = CPLib.GetParamsForSqlUpdate(m_cServer);
      m_cSql = CPLib.GetSQLPrefixComment("arrt_chkdiana_all",572,"00000D75")+CPLib.InsertIntoStatement(m_Ctx,m_oWrInfo)+" (";
      m_cSql = m_cSql+GetFieldsName_00000D75(m_Ctx,m_oWrInfo);
      m_cSql = m_cSql+") values (";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A01A,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A01B,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A02,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A03,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A11,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A12A,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A12B,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A12C,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A21,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A22,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A23,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A24,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A25,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A31A,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A31B,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A32,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A33A,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A33B,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A33C,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A34,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A41,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A42,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A43,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A51,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A52,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A53,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A54A,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A54B,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A54C,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.B11,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.B12,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.B13,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.B14,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.B15,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.PROG,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.FONTE,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.PRGANTI,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.TMOV,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo1.A52L,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+m_oWrInfo.InsertValues();
      m_cSql = CPLib.AddCPCCCHKValue(m_Ctx,m_cSql,"tipo1",true);
      m_cSql = m_cSql+")";
      m_nUpdatedRows = m_Sql.Update(m_cServer,m_cSql,m_oParameters);
      if (CPLib.lt(m_nUpdatedRows,0)) {
        m_Sql.AbortTransaction();
      }
      m_Sql.CompleteTransaction();
      m_cLastMsgError = m_Sql.TransactionErrorMessage();
      if (CPLib.ne(m_cLastMsgError,"")) {
        m_bError = true;
      }
    }
    for (MemoryCursorRow_tipo2_3 rwTipo2 : mcTipo2._iterable_()) {
      /* _conta2 := _conta2 + 1 */
      _conta2 = CPLib.Round(_conta2+1,0);
      // * --- Insert into tipo2_3 from values
      m_Sql.RequireTransaction();
      m_cServer = m_Ctx.GetServer("tipo2_3");
      m_cPhName = m_Ctx.GetPhName("tipo2_3");
      m_oWrInfo = CPPhTableWrInfo.GetCPPhTableWrInfo(m_Ctx,"tipo2_3",m_Ctx.GetCompany());
      m_oParameters = CPLib.GetParamsForSqlUpdate(m_cServer);
      m_cSql = CPLib.GetSQLPrefixComment("arrt_chkdiana_all",572,"00000D78")+CPLib.InsertIntoStatement(m_Ctx,m_oWrInfo)+" (";
      m_cSql = m_cSql+GetFieldsName_00000D78(m_Ctx,m_oWrInfo);
      m_cSql = m_cSql+") values (";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.A01A,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.A01B,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.A02,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.A03,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.C11,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.D11,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.D13,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.D14A,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.D14B,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.D14C,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.D15,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.D16,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.D17,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.D18,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.D19,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.D21,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.D22,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.D23,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.D31,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.D32,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.D41,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.D42,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.D43,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.D44,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.D45,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.PROG,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.CFESTERO,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo2.DATAVALI,"?",0,0)+", ";
      m_cSql = m_cSql+m_oWrInfo.InsertValues();
      m_cSql = CPLib.AddCPCCCHKValue(m_Ctx,m_cSql,"tipo2_3",true);
      m_cSql = m_cSql+")";
      m_nUpdatedRows = m_Sql.Update(m_cServer,m_cSql,m_oParameters);
      if (CPLib.lt(m_nUpdatedRows,0)) {
        m_Sql.AbortTransaction();
      }
      m_Sql.CompleteTransaction();
      m_cLastMsgError = m_Sql.TransactionErrorMessage();
      if (CPLib.ne(m_cLastMsgError,"")) {
        m_bError = true;
      }
    }
    for (MemoryCursorRow_tipo4 rwTipo4 : mcTipo4._iterable_()) {
      /* _conta4 := _conta4 + 1 */
      _conta4 = CPLib.Round(_conta4+1,0);
      // * --- Insert into tipo4 from values
      m_Sql.RequireTransaction();
      m_cServer = m_Ctx.GetServer("tipo4");
      m_cPhName = m_Ctx.GetPhName("tipo4");
      m_oWrInfo = CPPhTableWrInfo.GetCPPhTableWrInfo(m_Ctx,"tipo4",m_Ctx.GetCompany());
      m_oParameters = CPLib.GetParamsForSqlUpdate(m_cServer);
      m_cSql = CPLib.GetSQLPrefixComment("arrt_chkdiana_all",572,"00000D7B")+CPLib.InsertIntoStatement(m_Ctx,m_oWrInfo)+" (";
      m_cSql = m_cSql+GetFieldsName_00000D7B(m_Ctx,m_oWrInfo);
      m_cSql = m_cSql+") values (";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo4.A01A,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo4.A01B,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo4.A02,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo4.A03,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo4.C21,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo4.E11,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo4.E13,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo4.E14A,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo4.E14B,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo4.E14C,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo4.E15,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo4.E16,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo4.E17,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo4.E18,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo4.E19,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo4.E41,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo4.E42,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo4.E43,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo4.E44,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo4.E45,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo4.PROG,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo4.CFESTERO,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo4.DATAVALI,"?",0,0)+", ";
      m_cSql = m_cSql+m_oWrInfo.InsertValues();
      m_cSql = CPLib.AddCPCCCHKValue(m_Ctx,m_cSql,"tipo4",true);
      m_cSql = m_cSql+")";
      m_nUpdatedRows = m_Sql.Update(m_cServer,m_cSql,m_oParameters);
      if (CPLib.lt(m_nUpdatedRows,0)) {
        m_Sql.AbortTransaction();
      }
      m_Sql.CompleteTransaction();
      m_cLastMsgError = m_Sql.TransactionErrorMessage();
      if (CPLib.ne(m_cLastMsgError,"")) {
        m_bError = true;
      }
    }
    for (MemoryCursorRow_tipo5 rwTipo5 : mcTipo5._iterable_()) {
      /* _conta5 := _conta5 + 1 */
      _conta5 = CPLib.Round(_conta5+1,0);
      // * --- Insert into tipo5 from values
      m_Sql.RequireTransaction();
      m_cServer = m_Ctx.GetServer("tipo5");
      m_cPhName = m_Ctx.GetPhName("tipo5");
      m_oWrInfo = CPPhTableWrInfo.GetCPPhTableWrInfo(m_Ctx,"tipo5",m_Ctx.GetCompany());
      m_oParameters = CPLib.GetParamsForSqlUpdate(m_cServer);
      m_cSql = CPLib.GetSQLPrefixComment("arrt_chkdiana_all",572,"00000D7E")+CPLib.InsertIntoStatement(m_Ctx,m_oWrInfo)+" (";
      m_cSql = m_cSql+GetFieldsName_00000D7E(m_Ctx,m_oWrInfo);
      m_cSql = m_cSql+") values (";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo5.A01A,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo5.A01B,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo5.A02,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo5.A03,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo5.C31,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo5.F11,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo5.F13,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo5.F14A,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo5.F14B,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo5.F14C,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo5.F15,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo5.F16,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo5.F31,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo5.PROG,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo5.CFESTERO,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo5.DATAVALI,"?",0,0)+", ";
      m_cSql = m_cSql+m_oWrInfo.InsertValues();
      m_cSql = CPLib.AddCPCCCHKValue(m_Ctx,m_cSql,"tipo5",true);
      m_cSql = m_cSql+")";
      m_nUpdatedRows = m_Sql.Update(m_cServer,m_cSql,m_oParameters);
      if (CPLib.lt(m_nUpdatedRows,0)) {
        m_Sql.AbortTransaction();
      }
      m_Sql.CompleteTransaction();
      m_cLastMsgError = m_Sql.TransactionErrorMessage();
      if (CPLib.ne(m_cLastMsgError,"")) {
        m_bError = true;
      }
    }
    for (MemoryCursorRow_tipo6 rwTipo6 : mcTipo6._iterable_()) {
      /* _conta6 := _conta6 + 1 */
      _conta6 = CPLib.Round(_conta6+1,0);
      // * --- Insert into tipo6 from values
      m_Sql.RequireTransaction();
      m_cServer = m_Ctx.GetServer("tipo6");
      m_cPhName = m_Ctx.GetPhName("tipo6");
      m_oWrInfo = CPPhTableWrInfo.GetCPPhTableWrInfo(m_Ctx,"tipo6",m_Ctx.GetCompany());
      m_oParameters = CPLib.GetParamsForSqlUpdate(m_cServer);
      m_cSql = CPLib.GetSQLPrefixComment("arrt_chkdiana_all",572,"00000D81")+CPLib.InsertIntoStatement(m_Ctx,m_oWrInfo)+" (";
      m_cSql = m_cSql+GetFieldsName_00000D81(m_Ctx,m_oWrInfo);
      m_cSql = m_cSql+") values (";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo6.A01A,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo6.A01B,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo6.A02,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo6.A03,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo6.C41,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo6.G11,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo6.G13,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo6.G14A,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo6.G14B,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo6.G14C,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo6.G15,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo6.G16,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo6.G17,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo6.G18,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo6.G19,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo6.G41,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo6.G42,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo6.G43,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo6.G44,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo6.G45,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo6.PROG,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo6.CFESTERO,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo6.DATAVALI,"?",0,0)+", ";
      m_cSql = m_cSql+m_oWrInfo.InsertValues();
      m_cSql = CPLib.AddCPCCCHKValue(m_Ctx,m_cSql,"tipo6",true);
      m_cSql = m_cSql+")";
      m_nUpdatedRows = m_Sql.Update(m_cServer,m_cSql,m_oParameters);
      if (CPLib.lt(m_nUpdatedRows,0)) {
        m_Sql.AbortTransaction();
      }
      m_Sql.CompleteTransaction();
      m_cLastMsgError = m_Sql.TransactionErrorMessage();
      if (CPLib.ne(m_cLastMsgError,"")) {
        m_bError = true;
      }
    }
    for (MemoryCursorRow_tipo7 rwTipo7 : mcTipo7._iterable_()) {
      /* _conta7 := _conta7 + 1 */
      _conta7 = CPLib.Round(_conta7+1,0);
      // * --- Insert into tipo7 from values
      m_Sql.RequireTransaction();
      m_cServer = m_Ctx.GetServer("tipo7");
      m_cPhName = m_Ctx.GetPhName("tipo7");
      m_oWrInfo = CPPhTableWrInfo.GetCPPhTableWrInfo(m_Ctx,"tipo7",m_Ctx.GetCompany());
      m_oParameters = CPLib.GetParamsForSqlUpdate(m_cServer);
      m_cSql = CPLib.GetSQLPrefixComment("arrt_chkdiana_all",572,"00000D84")+CPLib.InsertIntoStatement(m_Ctx,m_oWrInfo)+" (";
      m_cSql = m_cSql+GetFieldsName_00000D84(m_Ctx,m_oWrInfo);
      m_cSql = m_cSql+") values (";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.A01A,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.A01B,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.A02,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.A03,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.C11,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.D11,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.D13,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.D14A,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.D14B,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.D14C,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.D15,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.D16,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.D17,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.D18,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.D19,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.D21,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.D22,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.D23,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.D31,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.D32,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.D41,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.D42,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.D43,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.D44,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.D45,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.PROG,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.CFESTERO,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo7.DATAVALI,"?",0,0)+", ";
      m_cSql = m_cSql+m_oWrInfo.InsertValues();
      m_cSql = CPLib.AddCPCCCHKValue(m_Ctx,m_cSql,"tipo7",true);
      m_cSql = m_cSql+")";
      m_nUpdatedRows = m_Sql.Update(m_cServer,m_cSql,m_oParameters);
      if (CPLib.lt(m_nUpdatedRows,0)) {
        m_Sql.AbortTransaction();
      }
      m_Sql.CompleteTransaction();
      m_cLastMsgError = m_Sql.TransactionErrorMessage();
      if (CPLib.ne(m_cLastMsgError,"")) {
        m_bError = true;
      }
    }
    for (MemoryCursorRow_tipo8 rwTipo8 : mcTipo8._iterable_()) {
      /* _conta8 := _conta8 + 1 */
      _conta8 = CPLib.Round(_conta8+1,0);
      // * --- Insert into tipo8 from values
      m_Sql.RequireTransaction();
      m_cServer = m_Ctx.GetServer("tipo8");
      m_cPhName = m_Ctx.GetPhName("tipo8");
      m_oWrInfo = CPPhTableWrInfo.GetCPPhTableWrInfo(m_Ctx,"tipo8",m_Ctx.GetCompany());
      m_oParameters = CPLib.GetParamsForSqlUpdate(m_cServer);
      m_cSql = CPLib.GetSQLPrefixComment("arrt_chkdiana_all",572,"00000D87")+CPLib.InsertIntoStatement(m_Ctx,m_oWrInfo)+" (";
      m_cSql = m_cSql+GetFieldsName_00000D87(m_Ctx,m_oWrInfo);
      m_cSql = m_cSql+") values (";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo8.A01A,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo8.A01B,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo8.A02,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo8.A03,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo8.C21,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo8.E11,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo8.E13,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo8.E14A,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo8.E14B,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo8.E14C,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo8.E15,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo8.E16,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo8.E17,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo8.E18,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo8.E19,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo8.E41,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo8.E42,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo8.E43,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo8.E44,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo8.E45,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo8.PROG,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo8.CFESTERO,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo8.DATAVALI,"?",0,0)+", ";
      m_cSql = m_cSql+m_oWrInfo.InsertValues();
      m_cSql = CPLib.AddCPCCCHKValue(m_Ctx,m_cSql,"tipo8",true);
      m_cSql = m_cSql+")";
      m_nUpdatedRows = m_Sql.Update(m_cServer,m_cSql,m_oParameters);
      if (CPLib.lt(m_nUpdatedRows,0)) {
        m_Sql.AbortTransaction();
      }
      m_Sql.CompleteTransaction();
      m_cLastMsgError = m_Sql.TransactionErrorMessage();
      if (CPLib.ne(m_cLastMsgError,"")) {
        m_bError = true;
      }
    }
    for (MemoryCursorRow_tipo9 rwTipo9 : mcTipo9._iterable_()) {
      /* _conta9 := _conta9 + 1 */
      _conta9 = CPLib.Round(_conta9+1,0);
      // * --- Insert into tipo9 from values
      m_Sql.RequireTransaction();
      m_cServer = m_Ctx.GetServer("tipo9");
      m_cPhName = m_Ctx.GetPhName("tipo9");
      m_oWrInfo = CPPhTableWrInfo.GetCPPhTableWrInfo(m_Ctx,"tipo9",m_Ctx.GetCompany());
      m_oParameters = CPLib.GetParamsForSqlUpdate(m_cServer);
      m_cSql = CPLib.GetSQLPrefixComment("arrt_chkdiana_all",572,"00000D8A")+CPLib.InsertIntoStatement(m_Ctx,m_oWrInfo)+" (";
      m_cSql = m_cSql+GetFieldsName_00000D8A(m_Ctx,m_oWrInfo);
      m_cSql = m_cSql+") values (";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo9.A01A,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo9.A01B,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo9.A02,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo9.A03,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo9.C51,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo9.H11,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo9.H13,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo9.H14A,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo9.H14B,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo9.H14C,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo9.H15,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo9.H16,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo9.H17,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo9.H18,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo9.H19,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo9.H41,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo9.H42,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo9.H43,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo9.H44,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo9.H45,"?",0,0,m_cServer)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo9.PROG,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo9.CFESTERO,"?",0,0)+", ";
      m_cSql = m_cSql+""+CPLib.ToSQL(rwTipo9.DATAVALI,"?",0,0)+", ";
      m_cSql = m_cSql+m_oWrInfo.InsertValues();
      m_cSql = CPLib.AddCPCCCHKValue(m_Ctx,m_cSql,"tipo9",true);
      m_cSql = m_cSql+")";
      m_nUpdatedRows = m_Sql.Update(m_cServer,m_cSql,m_oParameters);
      if (CPLib.lt(m_nUpdatedRows,0)) {
        m_Sql.AbortTransaction();
      }
      m_Sql.CompleteTransaction();
      m_cLastMsgError = m_Sql.TransactionErrorMessage();
      if (CPLib.ne(m_cLastMsgError,"")) {
        m_bError = true;
      }
    }
    // * --- Insert into contatori from values
    m_Sql.RequireTransaction();
    m_cServer = m_Ctx.GetServer("contatori");
    m_cPhName = m_Ctx.GetPhName("contatori");
    m_oWrInfo = CPPhTableWrInfo.GetCPPhTableWrInfo(m_Ctx,"contatori",m_Ctx.GetCompany());
    m_oParameters = CPLib.GetParamsForSqlUpdate(m_cServer);
    m_cSql = CPLib.GetSQLPrefixComment("arrt_chkdiana_all",572,"00000D8B")+CPLib.InsertIntoStatement(m_Ctx,m_oWrInfo)+" (";
    m_cSql = m_cSql+GetFieldsName_00000D8B(m_Ctx,m_oWrInfo);
    m_cSql = m_cSql+") values (";
    m_cSql = m_cSql+""+CPLib.ToSQL(_conta1,"?",0,0)+", ";
    m_cSql = m_cSql+""+CPLib.ToSQL(_conta2,"?",0,0)+", ";
    m_cSql = m_cSql+""+CPLib.ToSQL(_conta4,"?",0,0)+", ";
    m_cSql = m_cSql+""+CPLib.ToSQL(_conta5,"?",0,0)+", ";
    m_cSql = m_cSql+""+CPLib.ToSQL(_conta6,"?",0,0)+", ";
    m_cSql = m_cSql+""+CPLib.ToSQL(_conta7,"?",0,0)+", ";
    m_cSql = m_cSql+""+CPLib.ToSQL(_conta8,"?",0,0)+", ";
    m_cSql = m_cSql+""+CPLib.ToSQL(_conta9,"?",0,0)+", ";
    m_cSql = m_cSql+m_oWrInfo.InsertValues();
    m_cSql = CPLib.AddCPCCCHKValue(m_Ctx,m_cSql,"contatori",true);
    m_cSql = m_cSql+")";
    m_nUpdatedRows = m_Sql.Update(m_cServer,m_cSql,m_oParameters);
    if (CPLib.lt(m_nUpdatedRows,0)) {
      m_Sql.AbortTransaction();
    }
    m_Sql.CompleteTransaction();
    m_cLastMsgError = m_Sql.TransactionErrorMessage();
    if (CPLib.ne(m_cLastMsgError,"")) {
      m_bError = true;
    }
  }
  void Page_16() throws Exception {
    CPResultSet Cursor_qbe_tab_mmc=null;
    VQRHolder l_VQRHolder = null;
    try {
      /* _mlientiope := False */
      _mlientiope = false;
      /* _clientiope := False */
      _clientiope = false;
      /* _mogopebo := False */
      _mogopebo = false;
      /* _sogopebo := False */
      _sogopebo = false;
      /* _meneficope := False */
      _meneficope = false;
      /* _beneficope := False */
      _beneficope = false;
      /* _merzistiope := False */
      _merzistiope = false;
      /* _terzistiope := False */
      _terzistiope = false;
      /* _mlientifrz := False */
      _mlientifrz = false;
      /* _clientifrz := False */
      _clientifrz = false;
      /* _mogopefbo := False */
      _mogopefbo = false;
      /* _sogopefbo := False */
      _sogopefbo = false;
      /* _meneficfrz := False */
      _meneficfrz = false;
      /* _beneficfrz := False */
      _beneficfrz = false;
      /* _merzistifrz := False */
      _merzistifrz = false;
      /* _terzistifrz := False */
      _terzistifrz = false;
      /* _rapcolleg := False */
      _rapcolleg = false;
      /* _xlientiope := False */
      _xlientiope = false;
      /* _xogopebo := False */
      _xogopebo = false;
      /* _xeneficope := False */
      _xeneficope = false;
      /* _xerzistiope := False */
      _xerzistiope = false;
      /* _xlientifrz := False */
      _xlientifrz = false;
      /* _xogopefbo := False */
      _xogopefbo = false;
      /* _xeneficfrz := False */
      _xeneficfrz = false;
      /* _xerzistifrz := False */
      _xerzistifrz = false;
      /* _xapcolleg := False */
      _xapcolleg = false;
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DA8;
      _h00000DA8 = new SPBridge.HMCaller();
      _h00000DA8.Set("m_cVQRList",m_cVQRList);
      _h00000DA8.Set("tbname","mlientiope");
      _h00000DA8.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DA8,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _mlientiope := qbe_tab_mmc->tot > 0 */
        _mlientiope = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DAA;
      _h00000DAA = new SPBridge.HMCaller();
      _h00000DAA.Set("m_cVQRList",m_cVQRList);
      _h00000DAA.Set("tbname","clientiope");
      _h00000DAA.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DAA,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _clientiope := qbe_tab_mmc->tot > 0 */
        _clientiope = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DAC;
      _h00000DAC = new SPBridge.HMCaller();
      _h00000DAC.Set("m_cVQRList",m_cVQRList);
      _h00000DAC.Set("tbname","mogopebo");
      _h00000DAC.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DAC,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _mogopebo := qbe_tab_mmc->tot > 0 */
        _mogopebo = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DAE;
      _h00000DAE = new SPBridge.HMCaller();
      _h00000DAE.Set("m_cVQRList",m_cVQRList);
      _h00000DAE.Set("tbname","sogopebo");
      _h00000DAE.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DAE,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _sogopebo := qbe_tab_mmc->tot > 0 */
        _sogopebo = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DB0;
      _h00000DB0 = new SPBridge.HMCaller();
      _h00000DB0.Set("m_cVQRList",m_cVQRList);
      _h00000DB0.Set("tbname","meneficope");
      _h00000DB0.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DB0,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _meneficope := qbe_tab_mmc->tot > 0 */
        _meneficope = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DB2;
      _h00000DB2 = new SPBridge.HMCaller();
      _h00000DB2.Set("m_cVQRList",m_cVQRList);
      _h00000DB2.Set("tbname","beneficope");
      _h00000DB2.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DB2,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _beneficope := qbe_tab_mmc->tot > 0 */
        _beneficope = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DB4;
      _h00000DB4 = new SPBridge.HMCaller();
      _h00000DB4.Set("m_cVQRList",m_cVQRList);
      _h00000DB4.Set("tbname","merzistiope");
      _h00000DB4.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DB4,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _merzistiope := qbe_tab_mmc->tot > 0 */
        _merzistiope = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DB6;
      _h00000DB6 = new SPBridge.HMCaller();
      _h00000DB6.Set("m_cVQRList",m_cVQRList);
      _h00000DB6.Set("tbname","terzistiope");
      _h00000DB6.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DB6,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _terzistiope := qbe_tab_mmc->tot > 0 */
        _terzistiope = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DB8;
      _h00000DB8 = new SPBridge.HMCaller();
      _h00000DB8.Set("m_cVQRList",m_cVQRList);
      _h00000DB8.Set("tbname","mlientifrz");
      _h00000DB8.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DB8,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _mlientifrz := qbe_tab_mmc->tot > 0 */
        _mlientifrz = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DBA;
      _h00000DBA = new SPBridge.HMCaller();
      _h00000DBA.Set("m_cVQRList",m_cVQRList);
      _h00000DBA.Set("tbname","clientifrz");
      _h00000DBA.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DBA,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _clientifrz := qbe_tab_mmc->tot > 0 */
        _clientifrz = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DBC;
      _h00000DBC = new SPBridge.HMCaller();
      _h00000DBC.Set("m_cVQRList",m_cVQRList);
      _h00000DBC.Set("tbname","mogopefbo");
      _h00000DBC.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DBC,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _mogopefbo := qbe_tab_mmc->tot > 0 */
        _mogopefbo = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DBE;
      _h00000DBE = new SPBridge.HMCaller();
      _h00000DBE.Set("m_cVQRList",m_cVQRList);
      _h00000DBE.Set("tbname","sogopefbo");
      _h00000DBE.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DBE,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _sogopefbo := qbe_tab_mmc->tot > 0 */
        _sogopefbo = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DC0;
      _h00000DC0 = new SPBridge.HMCaller();
      _h00000DC0.Set("m_cVQRList",m_cVQRList);
      _h00000DC0.Set("tbname","meneficfrz");
      _h00000DC0.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DC0,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _meneficfrz := qbe_tab_mmc->tot > 0 */
        _meneficfrz = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DC2;
      _h00000DC2 = new SPBridge.HMCaller();
      _h00000DC2.Set("m_cVQRList",m_cVQRList);
      _h00000DC2.Set("tbname","beneficfrz");
      _h00000DC2.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DC2,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _beneficfrz := qbe_tab_mmc->tot > 0 */
        _beneficfrz = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DC4;
      _h00000DC4 = new SPBridge.HMCaller();
      _h00000DC4.Set("m_cVQRList",m_cVQRList);
      _h00000DC4.Set("tbname","merzistifrz");
      _h00000DC4.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DC4,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _merzistifrz := qbe_tab_mmc->tot > 0 */
        _merzistifrz = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DC6;
      _h00000DC6 = new SPBridge.HMCaller();
      _h00000DC6.Set("m_cVQRList",m_cVQRList);
      _h00000DC6.Set("tbname","terzistifrz");
      _h00000DC6.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DC6,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _terzistifrz := qbe_tab_mmc->tot > 0 */
        _terzistifrz = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DC8;
      _h00000DC8 = new SPBridge.HMCaller();
      _h00000DC8.Set("m_cVQRList",m_cVQRList);
      _h00000DC8.Set("tbname","rapcoll");
      _h00000DC8.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DC8,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _rapcolleg := qbe_tab_mmc->tot > 0 */
        _rapcolleg = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DCB;
      _h00000DCB = new SPBridge.HMCaller();
      _h00000DCB.Set("m_cVQRList",m_cVQRList);
      _h00000DCB.Set("tbname","xlientiope");
      _h00000DCB.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DCB,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _xlientiope := qbe_tab_mmc->tot > 0 */
        _xlientiope = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DCD;
      _h00000DCD = new SPBridge.HMCaller();
      _h00000DCD.Set("m_cVQRList",m_cVQRList);
      _h00000DCD.Set("tbname","xogopebo");
      _h00000DCD.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DCD,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _xogopebo := qbe_tab_mmc->tot > 0 */
        _xogopebo = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DCF;
      _h00000DCF = new SPBridge.HMCaller();
      _h00000DCF.Set("m_cVQRList",m_cVQRList);
      _h00000DCF.Set("tbname","xeneficope");
      _h00000DCF.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DCF,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _xeneficope := qbe_tab_mmc->tot > 0 */
        _xeneficope = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DD1;
      _h00000DD1 = new SPBridge.HMCaller();
      _h00000DD1.Set("m_cVQRList",m_cVQRList);
      _h00000DD1.Set("tbname","xerzistiope");
      _h00000DD1.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DD1,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _xerzistiope := qbe_tab_mmc->tot > 0 */
        _xerzistiope = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DD3;
      _h00000DD3 = new SPBridge.HMCaller();
      _h00000DD3.Set("m_cVQRList",m_cVQRList);
      _h00000DD3.Set("tbname","clientifrz");
      _h00000DD3.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DD3,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _clientifrz := qbe_tab_mmc->tot > 0 */
        _clientifrz = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DD5;
      _h00000DD5 = new SPBridge.HMCaller();
      _h00000DD5.Set("m_cVQRList",m_cVQRList);
      _h00000DD5.Set("tbname","xogopefbo");
      _h00000DD5.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DD5,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _xogopefbo := qbe_tab_mmc->tot > 0 */
        _xogopefbo = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DD7;
      _h00000DD7 = new SPBridge.HMCaller();
      _h00000DD7.Set("m_cVQRList",m_cVQRList);
      _h00000DD7.Set("tbname","xeneficfrz");
      _h00000DD7.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DD7,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _xeneficfrz := qbe_tab_mmc->tot > 0 */
        _xeneficfrz = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DD9;
      _h00000DD9 = new SPBridge.HMCaller();
      _h00000DD9.Set("m_cVQRList",m_cVQRList);
      _h00000DD9.Set("tbname","xerzistifrz");
      _h00000DD9.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DD9,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _xerzistifrz := qbe_tab_mmc->tot > 0 */
        _xerzistifrz = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
      // * --- Select from qbe_tab_mmc
      SPBridge.HMCaller _h00000DDB;
      _h00000DDB = new SPBridge.HMCaller();
      _h00000DDB.Set("m_cVQRList",m_cVQRList);
      _h00000DDB.Set("tbname","xapcoll");
      _h00000DDB.Set("fldname","IDFILEBO");
      if (Cursor_qbe_tab_mmc!=null)
        Cursor_qbe_tab_mmc.Close();
      Cursor_qbe_tab_mmc = new VQRHolder("qbe_tab_mmc",com.zucchetti.sitepainter.Library.getVQRReaderFactory(m_Ctx.GetInstance()),_h00000DDB,true).GetResultSet(m_Ctx);
      while ( ! (Cursor_qbe_tab_mmc.Eof())) {
        /* _xapcolleg := qbe_tab_mmc->tot > 0 */
        _xapcolleg = CPLib.gt(Cursor_qbe_tab_mmc.GetDouble("tot"),0);
        Cursor_qbe_tab_mmc.Next();
      }
      m_cConnectivityError = Cursor_qbe_tab_mmc.ErrorMessage();
      Cursor_qbe_tab_mmc.Close();
      // * --- End Select
    } finally {
      try {
        if (Cursor_qbe_tab_mmc!=null)
          Cursor_qbe_tab_mmc.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
    }
  }
  void Page_17() throws Exception {
    /* _numsto Char(15) */
    /* _ramate Char(3) */
    /* _cabcod Char(6) */
    String _cabcod;
    _cabcod = CPLib.Space(6);
    /* _citdesc Char(30) */
    String _citdesc;
    _citdesc = CPLib.Space(30);
    /* _provind Char(2) */
    String _provind;
    _provind = CPLib.Space(2);
    /* _agente Char(1) */
    String _agente;
    _agente = CPLib.Space(1);
    /* Verifica il tipo riga */
    /* _datage := '' // Stringa di ritorno */
    _datage = "";
    /* If Empty(pCodDip) */
    if (CPLib.Empty(pCodDip)) {
      /* If Empty(z_coddipe) */
      if (CPLib.Empty(z_coddipe)) {
        /* _datage := _datage + "000000" + Left(LRTrim(z_codcab)+Space(6),6) + Left(LRTrim(z_desccit)+Space(30),30) + Left(LRTrim(z_provin)+Space(2),2) */
        _datage = _datage+"000000"+CPLib.Left(CPLib.LRTrim(z_codcab)+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(z_desccit)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(z_provin)+CPLib.Space(2),2);
        /* _tipoag := Space(10) */
        _tipoag = CPLib.Space(10);
      } else { // Else
        /* _datage := _datage + Left(LRTrim(z_coddipe)+Space(6),6) */
        _datage = _datage+CPLib.Left(CPLib.LRTrim(z_coddipe)+CPLib.Space(6),6);
        /* If mcANADIP.GoToKey(z_coddipe) */
        if (mcANADIP.GoToKey(z_coddipe)) {
          /* _datage := _datage + Left(LRTrim(mcANADIP.CAB)+Space(6),6) + Left(LRTrim(mcANADIP.DESCCIT)+Space(30),30) + Left(LRTrim(mcANADIP.PROVINCIA)+Space(2),2) */
          _datage = _datage+CPLib.Left(CPLib.LRTrim(mcANADIP.row.CAB)+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(mcANADIP.row.DESCCIT)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcANADIP.row.PROVINCIA)+CPLib.Space(2),2);
          /* _tipoag := iif((mcANADIP.AGENTE='S' or mcANADIP.AGENTE='1'),'AGENZIA   ',Space(10)) */
          _tipoag = ((CPLib.eqr(mcANADIP.row.AGENTE,"S") || CPLib.eqr(mcANADIP.row.AGENTE,"1"))?"AGENZIA   ":CPLib.Space(10));
        } else { // Else
          /* _datage := _datage + Left(LRTrim(z_codcab)+Space(6),6) + Left(LRTrim(z_desccit)+Space(30),30) + Left(LRTrim(z_provin)+Space(2),2) */
          _datage = _datage+CPLib.Left(CPLib.LRTrim(z_codcab)+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(z_desccit)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(z_provin)+CPLib.Space(2),2);
          /* _tipoag := Space(10) */
          _tipoag = CPLib.Space(10);
        } // End If
      } // End If
    } else { // Else
      /* If mcANADIP.GoToKey(pCodDip) */
      if (mcANADIP.GoToKey(pCodDip)) {
        /* _datage := _datage + Left(LRTrim(pCodDip)+Space(6),6) */
        _datage = _datage+CPLib.Left(CPLib.LRTrim(pCodDip)+CPLib.Space(6),6);
        /* _datage := _datage + iif(Empty(LRTrim(pCodCab)),Left(LRTrim(mcANADIP.CAB)+Space(6),6),Left(LRTrim(pCodCab)+Space(6),6)) */
        _datage = _datage+(CPLib.Empty(CPLib.LRTrim(pCodCab))?CPLib.Left(CPLib.LRTrim(mcANADIP.row.CAB)+CPLib.Space(6),6):CPLib.Left(CPLib.LRTrim(pCodCab)+CPLib.Space(6),6));
        /* _datage := _datage + iif(Empty(LRTrim(pDesCit)),Left(LRTrim(mcANADIP.DESCCIT)+Space(30),30),Left(LRTrim(pDesCit)+Space(30),30)) */
        _datage = _datage+(CPLib.Empty(CPLib.LRTrim(pDesCit))?CPLib.Left(CPLib.LRTrim(mcANADIP.row.DESCCIT)+CPLib.Space(30),30):CPLib.Left(CPLib.LRTrim(pDesCit)+CPLib.Space(30),30));
        /* _datage := _datage + iif(Empty(LRTrim(pProv)),Left(LRTrim(mcANADIP.PROVINCIA)+Space(2),2),Left(LRTrim(pProv)+Space(2),2)) */
        _datage = _datage+(CPLib.Empty(CPLib.LRTrim(pProv))?CPLib.Left(CPLib.LRTrim(mcANADIP.row.PROVINCIA)+CPLib.Space(2),2):CPLib.Left(CPLib.LRTrim(pProv)+CPLib.Space(2),2));
        /* _tipoag := iif((mcANADIP.AGENTE='S' or mcANADIP.AGENTE='1'),'AGENZIA   ',Space(10)) */
        _tipoag = ((CPLib.eqr(mcANADIP.row.AGENTE,"S") || CPLib.eqr(mcANADIP.row.AGENTE,"1"))?"AGENZIA   ":CPLib.Space(10));
      } else { // Else
        /* _datage := _datage + Left(LRTrim(pCodDip)+Space(6),6) */
        _datage = _datage+CPLib.Left(CPLib.LRTrim(pCodDip)+CPLib.Space(6),6);
        /* _datage := _datage + Left(LRTrim(pCodCab)+Space(6),6) */
        _datage = _datage+CPLib.Left(CPLib.LRTrim(pCodCab)+CPLib.Space(6),6);
        /* _datage := _datage +Left(LRTrim(pDesCit)+Space(30),30) */
        _datage = _datage+CPLib.Left(CPLib.LRTrim(pDesCit)+CPLib.Space(30),30);
        /* _datage := _datage + Left(LRTrim(pProv)+Space(2),2) */
        _datage = _datage+CPLib.Left(CPLib.LRTrim(pProv)+CPLib.Space(2),2);
        /* _tipoag := Space(10) */
        _tipoag = CPLib.Space(10);
      } // End If
    } // End If
  }
  void Page_18() throws Exception {
    /* xType Char(1) */
    String xType;
    xType = CPLib.Space(1);
    /* xType := Substr(_note,14,1) */
    xType = CPLib.Substr(_note,14,1);
    /* Case xType='1' */
    if (CPLib.eqr(xType,"1")) {
      /* xStato := Substr(_note,248,1) */
      xStato = CPLib.Substr(_note,248,1);
      /* _conta1 := _conta1 + 1 */
      _conta1 = CPLib.Round(_conta1+1,0);
      /* mcTipo1.AppendBlank() */
      mcTipo1.AppendBlank();
      /* mcTipo1.A01A := Substr(_note,1,2) */
      mcTipo1.row.A01A = CPLib.Substr(_note,1,2);
      /* mcTipo1.A01B := Substr(_note,3,11) */
      mcTipo1.row.A01B = CPLib.Substr(_note,3,11);
      /* mcTipo1.A02 := Substr(_note,14,1) */
      mcTipo1.row.A02 = CPLib.Substr(_note,14,1);
      /* mcTipo1.A03 := Substr(_note,15,20) */
      mcTipo1.row.A03 = CPLib.Substr(_note,15,20);
      /* mcTipo1.A11 := Substr(_note,35,6) */
      mcTipo1.row.A11 = CPLib.Substr(_note,35,6);
      /* mcTipo1.A12A := Substr(_note,41,6) */
      mcTipo1.row.A12A = CPLib.Substr(_note,41,6);
      /* mcTipo1.A12B := Substr(_note,47,30) */
      mcTipo1.row.A12B = CPLib.Substr(_note,47,30);
      /* mcTipo1.A12C := Substr(_note,77,2) */
      mcTipo1.row.A12C = CPLib.Substr(_note,77,2);
      /* mcTipo1.A21 := CharToDate(Substr(_note,79,8)) */
      mcTipo1.row.A21 = CPLib.CharToDate(CPLib.Substr(_note,79,8));
      /* mcTipo1.A22 := Substr(_note,87,1) */
      mcTipo1.row.A22 = CPLib.Substr(_note,87,1);
      /* mcTipo1.A23 := Substr(_note,88,1) */
      mcTipo1.row.A23 = CPLib.Substr(_note,88,1);
      /* mcTipo1.A24 := Substr(_note,89,4) */
      mcTipo1.row.A24 = CPLib.Substr(_note,89,4);
      /* mcTipo1.A25 := Substr(_note,93,2) */
      mcTipo1.row.A25 = CPLib.Substr(_note,93,2);
      /* mcTipo1.A31A := Substr(_note,95,2) */
      mcTipo1.row.A31A = CPLib.Substr(_note,95,2);
      /* mcTipo1.A31B := Substr(_note,97,11) */
      mcTipo1.row.A31B = CPLib.Substr(_note,97,11);
      /* mcTipo1.A32 := Substr(_note,108,3) */
      mcTipo1.row.A32 = CPLib.Substr(_note,108,3);
      /* mcTipo1.A33A := Substr(_note,111,6) */
      mcTipo1.row.A33A = CPLib.Substr(_note,111,6);
      /* mcTipo1.A33B := Substr(_note,117,30) */
      mcTipo1.row.A33B = CPLib.Substr(_note,117,30);
      /* mcTipo1.A33C := Substr(_note,147,2) */
      mcTipo1.row.A33C = CPLib.Substr(_note,147,2);
      /* mcTipo1.A34 := Substr(_note,149,50) */
      mcTipo1.row.A34 = CPLib.Substr(_note,149,50);
      /* mcTipo1.A41 := Substr(_note,199,25) */
      mcTipo1.row.A41 = CPLib.Substr(_note,199,25);
      /* mcTipo1.A42 := Substr(_note,224,1) */
      mcTipo1.row.A42 = CPLib.Substr(_note,224,1);
      /* mcTipo1.A43 := Substr(_note,225,1) */
      mcTipo1.row.A43 = CPLib.Substr(_note,225,1);
      /* mcTipo1.A51 := CharToDate(Substr(_note,226,8)) */
      mcTipo1.row.A51 = CPLib.CharToDate(CPLib.Substr(_note,226,8));
      /* mcTipo1.A52 := Substr(_note,234,2) */
      mcTipo1.row.A52 = CPLib.Substr(_note,234,2);
      /* mcTipo1.A53 := Substr(_note,236,12) */
      mcTipo1.row.A53 = CPLib.Substr(_note,236,12);
      /* mcTipo1.A54A := Substr(_note,248,1) */
      mcTipo1.row.A54A = CPLib.Substr(_note,248,1);
      /* mcTipo1.A54B := CharToDate(Substr(_note,249,8)) */
      mcTipo1.row.A54B = CPLib.CharToDate(CPLib.Substr(_note,249,8));
      /* mcTipo1.A54C := Substr(_note,257,20) */
      mcTipo1.row.A54C = CPLib.Substr(_note,257,20);
      /* mcTipo1.B11 := Substr(_note,277,1) */
      mcTipo1.row.B11 = CPLib.Substr(_note,277,1);
      /* mcTipo1.B12 := Substr(_note,278,3) */
      mcTipo1.row.B12 = CPLib.Substr(_note,278,3);
      /* mcTipo1.B13 := Substr(_note,281,1) */
      mcTipo1.row.B13 = CPLib.Substr(_note,281,1);
      /* mcTipo1.B14 := Val(Substr(_note,282,15)) */
      mcTipo1.row.B14 = CPLib.Val(CPLib.Substr(_note,282,15));
      /* mcTipo1.B15 := Val(Substr(_note,297,15)) */
      mcTipo1.row.B15 = CPLib.Val(CPLib.Substr(_note,297,15));
      /* mcTipo1.PROG := _conta1 */
      mcTipo1.row.PROG = _conta1;
      /* mcTipo1.TMOV := iif(Substr(_note,371,10)='AGENZIA   ','A','D') */
      mcTipo1.row.TMOV = (CPLib.eqr(CPLib.Substr(_note,371,10),"AGENZIA   ")?"A":"D");
      /* mcTipo1.PRGANTI := Substr(_note,360,11) */
      mcTipo1.row.PRGANTI = CPLib.Substr(_note,360,11);
      /* mcTipo1.FONTE := Substr(_note,359,1) */
      mcTipo1.row.FONTE = CPLib.Substr(_note,359,1);
      /* mcTipo1.A52L := Substr(_note,234,1) */
      mcTipo1.row.A52L = CPLib.Substr(_note,234,1);
      /* mcTipo1.SaveRow() */
      mcTipo1.SaveRow();
      /* Case xType='2' or xType='3' */
    } else if (CPLib.eqr(xType,"2") || CPLib.eqr(xType,"3")) {
      /* _conta2 := _conta2 + 1 */
      _conta2 = CPLib.Round(_conta2+1,0);
      /* mcTipo2.AppendBlank() */
      mcTipo2.AppendBlank();
      /* mcTipo2.A01A := Substr(_note,1,2) */
      mcTipo2.row.A01A = CPLib.Substr(_note,1,2);
      /* mcTipo2.A01B := Substr(_note,3,11) */
      mcTipo2.row.A01B = CPLib.Substr(_note,3,11);
      /* mcTipo2.A02 := Substr(_note,14,1) */
      mcTipo2.row.A02 = CPLib.Substr(_note,14,1);
      /* mcTipo2.A03 := Substr(_note,15,20) */
      mcTipo2.row.A03 = CPLib.Substr(_note,15,20);
      /* mcTipo2.C11 := Substr(_note,35,16) */
      mcTipo2.row.C11 = CPLib.Substr(_note,35,16);
      /* mcTipo2.D11 := Substr(_note,51,70) */
      mcTipo2.row.D11 = CPLib.Substr(_note,51,70);
      /* mcTipo2.D13 := Substr(_note,121,3) */
      mcTipo2.row.D13 = CPLib.Substr(_note,121,3);
      /* mcTipo2.D14A := Substr(_note,124,6) */
      mcTipo2.row.D14A = CPLib.Substr(_note,124,6);
      /* mcTipo2.D14B := Substr(_note,130,30) */
      mcTipo2.row.D14B = CPLib.Substr(_note,130,30);
      /* mcTipo2.D14C := Substr(_note,160,2) */
      mcTipo2.row.D14C = CPLib.Substr(_note,160,2);
      /* mcTipo2.D15 := Substr(_note,162,35) */
      mcTipo2.row.D15 = CPLib.Substr(_note,162,35);
      /* mcTipo2.D16 := Substr(_note,197,5) */
      mcTipo2.row.D16 = CPLib.Substr(_note,197,5);
      /* mcTipo2.D17 := Substr(_note,202,16) */
      mcTipo2.row.D17 = CPLib.Substr(_note,202,16);
      /* mcTipo2.D18 := CharToDate(Substr(_note,218,8)) */
      mcTipo2.row.D18 = CPLib.CharToDate(CPLib.Substr(_note,218,8));
      /* mcTipo2.D19 := Substr(_note,226,30) */
      mcTipo2.row.D19 = CPLib.Substr(_note,226,30);
      /* mcTipo2.D21 := Substr(_note,256,3) */
      mcTipo2.row.D21 = CPLib.Substr(_note,256,3);
      /* mcTipo2.D22 := Substr(_note,259,3) */
      mcTipo2.row.D22 = CPLib.Substr(_note,259,3);
      /* mcTipo2.D23 := Substr(_note,262,3) */
      mcTipo2.row.D23 = CPLib.Substr(_note,262,3);
      /* mcTipo2.D31 := Substr(_note,265,25) */
      mcTipo2.row.D31 = CPLib.Substr(_note,265,25);
      /* mcTipo2.D32 := Substr(_note,290,1) */
      mcTipo2.row.D32 = CPLib.Substr(_note,290,1);
      /* mcTipo2.D41 := Substr(_note,291,2) */
      mcTipo2.row.D41 = CPLib.Substr(_note,291,2);
      /* mcTipo2.D42 := Substr(_note,293,15) */
      mcTipo2.row.D42 = CPLib.Substr(_note,293,15);
      /* mcTipo2.D43 := CharToDate(Substr(_note,308,8)) */
      mcTipo2.row.D43 = CPLib.CharToDate(CPLib.Substr(_note,308,8));
      /* mcTipo2.D44 := Substr(_note,316,30) */
      mcTipo2.row.D44 = CPLib.Substr(_note,316,30);
      /* mcTipo2.D45 := Substr(_note,346,1) */
      mcTipo2.row.D45 = CPLib.Substr(_note,346,1);
      /* mcTipo2.PROG := _conta2 */
      mcTipo2.row.PROG = _conta2;
      /* mcTipo2.CFESTERO := iif(Substr(_note,377,4)='NOCF',1,0) */
      mcTipo2.row.CFESTERO = (CPLib.eqr(CPLib.Substr(_note,377,4),"NOCF")?1:0);
      /* mcTipo2.DATAVALI := iif(not(Empty(LRTrim(Substr(_note,369,8)))),CharToDate(Substr(_note,369,8)),NullDate()) */
      mcTipo2.row.DATAVALI = ( ! (CPLib.Empty(CPLib.LRTrim(CPLib.Substr(_note,369,8))))?CPLib.CharToDate(CPLib.Substr(_note,369,8)):CPLib.NullDate());
      /* mcTipo2.SaveRow() */
      mcTipo2.SaveRow();
      /* Case xType='4'  */
    } else if (CPLib.eqr(xType,"4")) {
      /* _conta4 := _conta4 + 1 */
      _conta4 = CPLib.Round(_conta4+1,0);
      /* mcTipo4.AppendBlank() */
      mcTipo4.AppendBlank();
      /* mcTipo4.A01A := Substr(_note,1,2) */
      mcTipo4.row.A01A = CPLib.Substr(_note,1,2);
      /* mcTipo4.A01B := Substr(_note,3,11) */
      mcTipo4.row.A01B = CPLib.Substr(_note,3,11);
      /* mcTipo4.A02 := Substr(_note,14,1) */
      mcTipo4.row.A02 = CPLib.Substr(_note,14,1);
      /* mcTipo4.A03 := Substr(_note,15,20) */
      mcTipo4.row.A03 = CPLib.Substr(_note,15,20);
      /* mcTipo4.C21 := Substr(_note,35,16) */
      mcTipo4.row.C21 = CPLib.Substr(_note,35,16);
      /* mcTipo4.E11 := Substr(_note,51,70) */
      mcTipo4.row.E11 = CPLib.Substr(_note,51,70);
      /* mcTipo4.E13 := Substr(_note,121,3) */
      mcTipo4.row.E13 = CPLib.Substr(_note,121,3);
      /* mcTipo4.E14A := Substr(_note,124,6) */
      mcTipo4.row.E14A = CPLib.Substr(_note,124,6);
      /* mcTipo4.E14B := Substr(_note,130,30) */
      mcTipo4.row.E14B = CPLib.Substr(_note,130,30);
      /* mcTipo4.E14C := Substr(_note,160,2) */
      mcTipo4.row.E14C = CPLib.Substr(_note,160,2);
      /* mcTipo4.E15 := Substr(_note,162,35) */
      mcTipo4.row.E15 = CPLib.Substr(_note,162,35);
      /* mcTipo4.E16 := Substr(_note,197,5) */
      mcTipo4.row.E16 = CPLib.Substr(_note,197,5);
      /* mcTipo4.E17 := Substr(_note,202,16) */
      mcTipo4.row.E17 = CPLib.Substr(_note,202,16);
      /* mcTipo4.E18 := CharToDate(Substr(_note,218,8)) */
      mcTipo4.row.E18 = CPLib.CharToDate(CPLib.Substr(_note,218,8));
      /* mcTipo4.E19 := Substr(_note,226,30) */
      mcTipo4.row.E19 = CPLib.Substr(_note,226,30);
      /* mcTipo4.E41 := Substr(_note,291,2) */
      mcTipo4.row.E41 = CPLib.Substr(_note,291,2);
      /* mcTipo4.E42 := Substr(_note,293,15) */
      mcTipo4.row.E42 = CPLib.Substr(_note,293,15);
      /* mcTipo4.E43 := CharToDate(Substr(_note,308,8)) */
      mcTipo4.row.E43 = CPLib.CharToDate(CPLib.Substr(_note,308,8));
      /* mcTipo4.E44 := Substr(_note,316,30) */
      mcTipo4.row.E44 = CPLib.Substr(_note,316,30);
      /* mcTipo4.E45 := Substr(_note,346,1) */
      mcTipo4.row.E45 = CPLib.Substr(_note,346,1);
      /* mcTipo4.PROG := _conta4 */
      mcTipo4.row.PROG = _conta4;
      /* mcTipo4.CFESTERO := iif(Substr(_note,377,4)='NOCF',1,0) */
      mcTipo4.row.CFESTERO = (CPLib.eqr(CPLib.Substr(_note,377,4),"NOCF")?1:0);
      /* mcTipo4.DATAVALI := iif(not(Empty(LRTrim(Substr(_note,369,8)))),CharToDate(Substr(_note,369,8)),NullDate()) */
      mcTipo4.row.DATAVALI = ( ! (CPLib.Empty(CPLib.LRTrim(CPLib.Substr(_note,369,8))))?CPLib.CharToDate(CPLib.Substr(_note,369,8)):CPLib.NullDate());
      /* mcTipo4.SaveRow() */
      mcTipo4.SaveRow();
      /* Case xType='5' */
    } else if (CPLib.eqr(xType,"5")) {
      /* _conta5 := _conta5 + 1 */
      _conta5 = CPLib.Round(_conta5+1,0);
      /* mcTipo5.AppendBlank() */
      mcTipo5.AppendBlank();
      /* mcTipo5.A01A := Substr(_note,1,2) */
      mcTipo5.row.A01A = CPLib.Substr(_note,1,2);
      /* mcTipo5.A01B := Substr(_note,3,11) */
      mcTipo5.row.A01B = CPLib.Substr(_note,3,11);
      /* mcTipo5.A02 := Substr(_note,14,1) */
      mcTipo5.row.A02 = CPLib.Substr(_note,14,1);
      /* mcTipo5.A03 := Substr(_note,15,20) */
      mcTipo5.row.A03 = CPLib.Substr(_note,15,20);
      /* mcTipo5.C31 := Substr(_note,35,16) */
      mcTipo5.row.C31 = CPLib.Substr(_note,35,16);
      /* mcTipo5.F11 := Substr(_note,51,70) */
      mcTipo5.row.F11 = CPLib.Substr(_note,51,70);
      /* mcTipo5.F13 := Substr(_note,121,3) */
      mcTipo5.row.F13 = CPLib.Substr(_note,121,3);
      /* mcTipo5.F14A := Substr(_note,124,6) */
      mcTipo5.row.F14A = CPLib.Substr(_note,124,6);
      /* mcTipo5.F14B := Substr(_note,130,30) */
      mcTipo5.row.F14B = CPLib.Substr(_note,130,30);
      /* mcTipo5.F14C := Substr(_note,160,2) */
      mcTipo5.row.F14C = CPLib.Substr(_note,160,2);
      /* mcTipo5.F15 := Substr(_note,162,35) */
      mcTipo5.row.F15 = CPLib.Substr(_note,162,35);
      /* mcTipo5.F16 := Substr(_note,197,5) */
      mcTipo5.row.F16 = CPLib.Substr(_note,197,5);
      /* mcTipo5.F31 := Substr(_note,265,25) */
      mcTipo5.row.F31 = CPLib.Substr(_note,265,25);
      /* mcTipo5.PROG := _conta5 */
      mcTipo5.row.PROG = _conta5;
      /* mcTipo5.CFESTERO := iif(Substr(_note,377,4)='NOCF',1,0) */
      mcTipo5.row.CFESTERO = (CPLib.eqr(CPLib.Substr(_note,377,4),"NOCF")?1:0);
      /* mcTipo5.DATAVALI := iif(not(Empty(LRTrim(Substr(_note,369,8)))),CharToDate(Substr(_note,369,8)),NullDate()) */
      mcTipo5.row.DATAVALI = ( ! (CPLib.Empty(CPLib.LRTrim(CPLib.Substr(_note,369,8))))?CPLib.CharToDate(CPLib.Substr(_note,369,8)):CPLib.NullDate());
      /* mcTipo5.SaveRow() */
      mcTipo5.SaveRow();
      /* Case xType='6' */
    } else if (CPLib.eqr(xType,"6")) {
      /* _conta6 := _conta6 + 1 */
      _conta6 = CPLib.Round(_conta6+1,0);
      /* mcTipo6.AppendBlank() */
      mcTipo6.AppendBlank();
      /* mcTipo6.A01A := Substr(_note,1,2) */
      mcTipo6.row.A01A = CPLib.Substr(_note,1,2);
      /* mcTipo6.A01B := Substr(_note,3,11) */
      mcTipo6.row.A01B = CPLib.Substr(_note,3,11);
      /* mcTipo6.A02 := Substr(_note,14,1) */
      mcTipo6.row.A02 = CPLib.Substr(_note,14,1);
      /* mcTipo6.A03 := Substr(_note,15,20) */
      mcTipo6.row.A03 = CPLib.Substr(_note,15,20);
      /* mcTipo6.C41 := Substr(_note,35,16) */
      mcTipo6.row.C41 = CPLib.Substr(_note,35,16);
      /* mcTipo6.G11 := Substr(_note,51,70) */
      mcTipo6.row.G11 = CPLib.Substr(_note,51,70);
      /* mcTipo6.G13 := Substr(_note,121,3) */
      mcTipo6.row.G13 = CPLib.Substr(_note,121,3);
      /* mcTipo6.G14A := Substr(_note,124,6) */
      mcTipo6.row.G14A = CPLib.Substr(_note,124,6);
      /* mcTipo6.G14B := Substr(_note,130,30) */
      mcTipo6.row.G14B = CPLib.Substr(_note,130,30);
      /* mcTipo6.G14C := Substr(_note,160,2) */
      mcTipo6.row.G14C = CPLib.Substr(_note,160,2);
      /* mcTipo6.G15 := Substr(_note,162,35) */
      mcTipo6.row.G15 = CPLib.Substr(_note,162,35);
      /* mcTipo6.G16 := Substr(_note,197,5) */
      mcTipo6.row.G16 = CPLib.Substr(_note,197,5);
      /* mcTipo6.G17 := Substr(_note,202,16) */
      mcTipo6.row.G17 = CPLib.Substr(_note,202,16);
      /* mcTipo6.G18 := CharToDate(Substr(_note,218,8)) */
      mcTipo6.row.G18 = CPLib.CharToDate(CPLib.Substr(_note,218,8));
      /* mcTipo6.G19 := Substr(_note,226,30) */
      mcTipo6.row.G19 = CPLib.Substr(_note,226,30);
      /* mcTipo6.G41 := Substr(_note,291,2) */
      mcTipo6.row.G41 = CPLib.Substr(_note,291,2);
      /* mcTipo6.G42 := Substr(_note,293,15) */
      mcTipo6.row.G42 = CPLib.Substr(_note,293,15);
      /* mcTipo6.G43 := CharToDate(Substr(_note,308,8)) */
      mcTipo6.row.G43 = CPLib.CharToDate(CPLib.Substr(_note,308,8));
      /* mcTipo6.G44 := Substr(_note,316,30) */
      mcTipo6.row.G44 = CPLib.Substr(_note,316,30);
      /* mcTipo6.G45 := Substr(_note,346,1) */
      mcTipo6.row.G45 = CPLib.Substr(_note,346,1);
      /* mcTipo6.PROG := _conta6 */
      mcTipo6.row.PROG = _conta6;
      /* mcTipo6.CFESTERO := iif(Substr(_note,377,4)='NOCF',1,0) */
      mcTipo6.row.CFESTERO = (CPLib.eqr(CPLib.Substr(_note,377,4),"NOCF")?1:0);
      /* mcTipo6.DATAVALI := iif(not(Empty(LRTrim(Substr(_note,369,8)))),CharToDate(Substr(_note,369,8)),NullDate()) */
      mcTipo6.row.DATAVALI = ( ! (CPLib.Empty(CPLib.LRTrim(CPLib.Substr(_note,369,8))))?CPLib.CharToDate(CPLib.Substr(_note,369,8)):CPLib.NullDate());
      /* mcTipo6.SaveRow() */
      mcTipo6.SaveRow();
      /* Case xType='7' */
    } else if (CPLib.eqr(xType,"7")) {
      /* _conta7 := _conta7 + 1 */
      _conta7 = CPLib.Round(_conta7+1,0);
      /* mcTipo7.AppendBlank() */
      mcTipo7.AppendBlank();
      /* mcTipo7.A01A := Substr(_note,1,2) */
      mcTipo7.row.A01A = CPLib.Substr(_note,1,2);
      /* mcTipo7.A01B := Substr(_note,3,11) */
      mcTipo7.row.A01B = CPLib.Substr(_note,3,11);
      /* mcTipo7.A02 := Substr(_note,14,1) */
      mcTipo7.row.A02 = CPLib.Substr(_note,14,1);
      /* mcTipo7.A03 := Substr(_note,15,20) */
      mcTipo7.row.A03 = CPLib.Substr(_note,15,20);
      /* mcTipo7.C11 := Substr(_note,35,16) */
      mcTipo7.row.C11 = CPLib.Substr(_note,35,16);
      /* mcTipo7.D11 := Substr(_note,51,70) */
      mcTipo7.row.D11 = CPLib.Substr(_note,51,70);
      /* mcTipo7.D13 := Substr(_note,121,3) */
      mcTipo7.row.D13 = CPLib.Substr(_note,121,3);
      /* mcTipo7.D14A := Substr(_note,124,6) */
      mcTipo7.row.D14A = CPLib.Substr(_note,124,6);
      /* mcTipo7.D14B := Substr(_note,130,30) */
      mcTipo7.row.D14B = CPLib.Substr(_note,130,30);
      /* mcTipo7.D14C := Substr(_note,160,2) */
      mcTipo7.row.D14C = CPLib.Substr(_note,160,2);
      /* mcTipo7.D15 := Substr(_note,162,35) */
      mcTipo7.row.D15 = CPLib.Substr(_note,162,35);
      /* mcTipo7.D16 := Substr(_note,197,5) */
      mcTipo7.row.D16 = CPLib.Substr(_note,197,5);
      /* mcTipo7.D17 := Substr(_note,202,16) */
      mcTipo7.row.D17 = CPLib.Substr(_note,202,16);
      /* mcTipo7.D18 := CharToDate(Substr(_note,218,8)) */
      mcTipo7.row.D18 = CPLib.CharToDate(CPLib.Substr(_note,218,8));
      /* mcTipo7.D19 := Substr(_note,226,30) */
      mcTipo7.row.D19 = CPLib.Substr(_note,226,30);
      /* mcTipo7.D21 := Substr(_note,256,3) */
      mcTipo7.row.D21 = CPLib.Substr(_note,256,3);
      /* mcTipo7.D22 := Substr(_note,259,3) */
      mcTipo7.row.D22 = CPLib.Substr(_note,259,3);
      /* mcTipo7.D23 := Substr(_note,262,3) */
      mcTipo7.row.D23 = CPLib.Substr(_note,262,3);
      /* mcTipo7.D31 := Substr(_note,265,25) */
      mcTipo7.row.D31 = CPLib.Substr(_note,265,25);
      /* mcTipo7.D32 := Substr(_note,290,1) */
      mcTipo7.row.D32 = CPLib.Substr(_note,290,1);
      /* mcTipo7.D41 := Substr(_note,291,2) */
      mcTipo7.row.D41 = CPLib.Substr(_note,291,2);
      /* mcTipo7.D42 := Substr(_note,293,15) */
      mcTipo7.row.D42 = CPLib.Substr(_note,293,15);
      /* mcTipo7.D43 := CharToDate(Substr(_note,308,8)) */
      mcTipo7.row.D43 = CPLib.CharToDate(CPLib.Substr(_note,308,8));
      /* mcTipo7.D44 := Substr(_note,316,30) */
      mcTipo7.row.D44 = CPLib.Substr(_note,316,30);
      /* mcTipo7.D45 := Substr(_note,346,1) */
      mcTipo7.row.D45 = CPLib.Substr(_note,346,1);
      /* mcTipo7.PROG := _conta7 */
      mcTipo7.row.PROG = _conta7;
      /* mcTipo7.CFESTERO := iif(Substr(_note,377,4)='NOCF',1,0) */
      mcTipo7.row.CFESTERO = (CPLib.eqr(CPLib.Substr(_note,377,4),"NOCF")?1:0);
      /* mcTipo7.DATAVALI := iif(not(Empty(LRTrim(Substr(_note,369,8)))),CharToDate(Substr(_note,369,8)),NullDate()) */
      mcTipo7.row.DATAVALI = ( ! (CPLib.Empty(CPLib.LRTrim(CPLib.Substr(_note,369,8))))?CPLib.CharToDate(CPLib.Substr(_note,369,8)):CPLib.NullDate());
      /* mcTipo7.SaveRow() */
      mcTipo7.SaveRow();
      /* Case xType='8' */
    } else if (CPLib.eqr(xType,"8")) {
      /* _conta8 := _conta8 + 1 */
      _conta8 = CPLib.Round(_conta8+1,0);
      /* mcTipo8.AppendBlank() */
      mcTipo8.AppendBlank();
      /* mcTipo8.A01A := Substr(_note,1,2) */
      mcTipo8.row.A01A = CPLib.Substr(_note,1,2);
      /* mcTipo8.A01B := Substr(_note,3,11) */
      mcTipo8.row.A01B = CPLib.Substr(_note,3,11);
      /* mcTipo8.A02 := Substr(_note,14,1) */
      mcTipo8.row.A02 = CPLib.Substr(_note,14,1);
      /* mcTipo8.A03 := Substr(_note,15,20) */
      mcTipo8.row.A03 = CPLib.Substr(_note,15,20);
      /* mcTipo8.C21 := Substr(_note,35,16) */
      mcTipo8.row.C21 = CPLib.Substr(_note,35,16);
      /* mcTipo8.E11 := Substr(_note,51,70) */
      mcTipo8.row.E11 = CPLib.Substr(_note,51,70);
      /* mcTipo8.E13 := Substr(_note,121,3) */
      mcTipo8.row.E13 = CPLib.Substr(_note,121,3);
      /* mcTipo8.E14A := Substr(_note,124,6) */
      mcTipo8.row.E14A = CPLib.Substr(_note,124,6);
      /* mcTipo8.E14B := Substr(_note,130,30) */
      mcTipo8.row.E14B = CPLib.Substr(_note,130,30);
      /* mcTipo8.E14C := Substr(_note,160,2) */
      mcTipo8.row.E14C = CPLib.Substr(_note,160,2);
      /* mcTipo8.E15 := Substr(_note,162,35) */
      mcTipo8.row.E15 = CPLib.Substr(_note,162,35);
      /* mcTipo8.E16 := Substr(_note,197,5) */
      mcTipo8.row.E16 = CPLib.Substr(_note,197,5);
      /* mcTipo8.E17 := Substr(_note,202,16) */
      mcTipo8.row.E17 = CPLib.Substr(_note,202,16);
      /* mcTipo8.E18 := CharToDate(Substr(_note,218,8)) */
      mcTipo8.row.E18 = CPLib.CharToDate(CPLib.Substr(_note,218,8));
      /* mcTipo8.E19 := Substr(_note,226,30) */
      mcTipo8.row.E19 = CPLib.Substr(_note,226,30);
      /* mcTipo8.E41 := Substr(_note,291,2) */
      mcTipo8.row.E41 = CPLib.Substr(_note,291,2);
      /* mcTipo8.E42 := Substr(_note,293,15) */
      mcTipo8.row.E42 = CPLib.Substr(_note,293,15);
      /* mcTipo8.E43 := CharToDate(Substr(_note,308,8)) */
      mcTipo8.row.E43 = CPLib.CharToDate(CPLib.Substr(_note,308,8));
      /* mcTipo8.E44 := Substr(_note,316,30) */
      mcTipo8.row.E44 = CPLib.Substr(_note,316,30);
      /* mcTipo8.E45 := Substr(_note,346,1) */
      mcTipo8.row.E45 = CPLib.Substr(_note,346,1);
      /* mcTipo8.PROG := _conta8 */
      mcTipo8.row.PROG = _conta8;
      /* mcTipo8.CFESTERO := iif(Substr(_note,377,4)='NOCF',1,0) */
      mcTipo8.row.CFESTERO = (CPLib.eqr(CPLib.Substr(_note,377,4),"NOCF")?1:0);
      /* mcTipo8.DATAVALI := iif(not(Empty(LRTrim(Substr(_note,369,8)))),CharToDate(Substr(_note,369,8)),NullDate()) */
      mcTipo8.row.DATAVALI = ( ! (CPLib.Empty(CPLib.LRTrim(CPLib.Substr(_note,369,8))))?CPLib.CharToDate(CPLib.Substr(_note,369,8)):CPLib.NullDate());
      /* mcTipo8.SaveRow() */
      mcTipo8.SaveRow();
      /* Case xType='9' */
    } else if (CPLib.eqr(xType,"9")) {
      /* _conta9 := _conta9 + 1 */
      _conta9 = CPLib.Round(_conta9+1,0);
      /* mcTipo9.AppendBlank() */
      mcTipo9.AppendBlank();
      /* mcTipo9.A01A := Substr(_note,1,2) */
      mcTipo9.row.A01A = CPLib.Substr(_note,1,2);
      /* mcTipo9.A01B := Substr(_note,3,11) */
      mcTipo9.row.A01B = CPLib.Substr(_note,3,11);
      /* mcTipo9.A02 := Substr(_note,14,1) */
      mcTipo9.row.A02 = CPLib.Substr(_note,14,1);
      /* mcTipo9.A03 := Substr(_note,15,20) */
      mcTipo9.row.A03 = CPLib.Substr(_note,15,20);
      /* mcTipo9.C51 := Substr(_note,35,16) */
      mcTipo9.row.C51 = CPLib.Substr(_note,35,16);
      /* mcTipo9.H11 := Substr(_note,51,70) */
      mcTipo9.row.H11 = CPLib.Substr(_note,51,70);
      /* mcTipo9.H13 := Substr(_note,121,3) */
      mcTipo9.row.H13 = CPLib.Substr(_note,121,3);
      /* mcTipo9.H14A := Substr(_note,124,6) */
      mcTipo9.row.H14A = CPLib.Substr(_note,124,6);
      /* mcTipo9.H14B := Substr(_note,130,30) */
      mcTipo9.row.H14B = CPLib.Substr(_note,130,30);
      /* mcTipo9.H14C := Substr(_note,160,2) */
      mcTipo9.row.H14C = CPLib.Substr(_note,160,2);
      /* mcTipo9.H15 := Substr(_note,162,35) */
      mcTipo9.row.H15 = CPLib.Substr(_note,162,35);
      /* mcTipo9.H16 := Substr(_note,197,5) */
      mcTipo9.row.H16 = CPLib.Substr(_note,197,5);
      /* mcTipo9.H17 := Substr(_note,202,16) */
      mcTipo9.row.H17 = CPLib.Substr(_note,202,16);
      /* mcTipo9.H18 := CharToDate(Substr(_note,218,8)) */
      mcTipo9.row.H18 = CPLib.CharToDate(CPLib.Substr(_note,218,8));
      /* mcTipo9.H19 := Substr(_note,226,30) */
      mcTipo9.row.H19 = CPLib.Substr(_note,226,30);
      /* mcTipo9.H41 := Substr(_note,291,2) */
      mcTipo9.row.H41 = CPLib.Substr(_note,291,2);
      /* mcTipo9.H42 := Substr(_note,293,15) */
      mcTipo9.row.H42 = CPLib.Substr(_note,293,15);
      /* mcTipo9.H43 := CharToDate(Substr(_note,308,8)) */
      mcTipo9.row.H43 = CPLib.CharToDate(CPLib.Substr(_note,308,8));
      /* mcTipo9.H44 := Substr(_note,316,30) */
      mcTipo9.row.H44 = CPLib.Substr(_note,316,30);
      /* mcTipo9.H45 := Substr(_note,346,1) */
      mcTipo9.row.H45 = CPLib.Substr(_note,346,1);
      /* mcTipo9.PROG := _conta9 */
      mcTipo9.row.PROG = _conta9;
      /* mcTipo9.CFESTERO := iif(Substr(_note,377,4)='NOCF',1,0) */
      mcTipo9.row.CFESTERO = (CPLib.eqr(CPLib.Substr(_note,377,4),"NOCF")?1:0);
      /* mcTipo9.DATAVALI := iif(not(Empty(LRTrim(Substr(_note,369,8)))),CharToDate(Substr(_note,369,8)),NullDate()) */
      mcTipo9.row.DATAVALI = ( ! (CPLib.Empty(CPLib.LRTrim(CPLib.Substr(_note,369,8))))?CPLib.CharToDate(CPLib.Substr(_note,369,8)):CPLib.NullDate());
      /* mcTipo9.SaveRow() */
      mcTipo9.SaveRow();
    } // End Case
  }
  void Page_19() throws Exception {
    /* Scrittura in base a destinazione */
    /* If Substr(_note,14,1)='1' */
    if (CPLib.eqr(CPLib.Substr(_note,14,1),"1")) {
      /* _righe := _righe + 1 */
      _righe = CPLib.Round(_righe+1,0);
    } // End If
    /* _righetot := _righetot + 1 */
    _righetot = CPLib.Round(_righetot+1,0);
    /* If w_flgchk='N' and w_flgxls='N' */
    if (CPLib.eqr(w_flgchk,"N") && CPLib.eqr(w_flgxls,"N")) {
      /* If w_multifile='S' */
      if (CPLib.eqr(w_multifile,"S")) {
        /* If _righe > 150000 */
        if (CPLib.gt(_righe,150000)) {
          /* gMsgProc := gMsgProc + 'Ora Inizio Scrittura file per 380: '+ arfn_fdatetime(DateTime()) + NL */
          gMsgProc = gMsgProc+"Ora Inizio Scrittura file per 380: "+arfn_fdatetimeR.Make(m_Ctx,this).Run(CPLib.DateTime())+"\n";
          m_Ctx.SetGlobalString("gMsgProc",gMsgProc);
          /* _numfile := _numfile + 1 */
          _numfile = CPLib.Round(_numfile+1,0);
          /* cOnlyNomeFile := "campione_"+Right('000000'+LRTrim(Str(_numfile,10,0)),6)+".txt" */
          cOnlyNomeFile = "campione_"+CPLib.Right("000000"+CPLib.LRTrim(CPLib.Str(_numfile,10,0)),6)+".txt";
          /* cNomeFile := LRTrim(gPathDoc)+'/flussi/'+LRTrim(gAzienda)+"/"+cOnlyNomeFile */
          cNomeFile = CPLib.LRTrim(gPathDoc)+"/flussi/"+CPLib.LRTrim(gAzienda)+"/"+cOnlyNomeFile;
          // Aggiunge i file nei vettori
          filenames.add(CPLib.LRTrim(cNomeFile));
          fileonames.add(CPLib.LRTrim(cOnlyNomeFile));
          // Provo nuovo metodo
          FileChannel rwChannel= new RandomAccessFile(CPLib.LRTrim(cNomeFile),"rw").getChannel();
          ByteBuffer wrBuf;
          for (MemoryCursorRow_mcdiana_mcrdef rwRigheTXT : mcRigheTXT._iterable_()) {
            /* _riga := rwRigheTXT.RIGA */
            _riga = rwRigheTXT.RIGA;
            // Scrive le righe
            wrBuf = ByteBuffer.wrap(_riga.getBytes(StandardCharsets.UTF_8));
            rwChannel.write(wrBuf);
          }
          /* rwChannel.close() */
          rwChannel.close();
          /* gMsgProc := gMsgProc + 'Ora Fine Scrittura file per 380: '+ arfn_fdatetime(DateTime()) + NL */
          gMsgProc = gMsgProc+"Ora Fine Scrittura file per 380: "+arfn_fdatetimeR.Make(m_Ctx,this).Run(CPLib.DateTime())+"\n";
          m_Ctx.SetGlobalString("gMsgProc",gMsgProc);
          /* Rimetto righe a 1 per scrivere la 150001 riga */
          /* _righe := 1 */
          _righe = CPLib.Round(1,0);
          /* _righetot := 1 */
          _righetot = CPLib.Round(1,0);
          /* mcRigheTXT.Zap() */
          mcRigheTXT.Zap();
        } // End If
      } // End If
      /* mcRigheTXT.AppendBlank() */
      mcRigheTXT.AppendBlank();
      /* mcRigheTXT.RIGA := Left(LRTrim(_note)+Space(380),380) + LibreriaMit.CloseLine() */
      mcRigheTXT.row.RIGA = CPLib.Left(CPLib.LRTrim(_note)+CPLib.Space(380),380)+LibreriaMit.CloseLine();
      /* mcRigheTXT.SaveRow() */
      mcRigheTXT.SaveRow();
      /* ElseIf w_flgchk='S' or w_flgxls='S' */
    } else if (CPLib.eqr(w_flgchk,"S") || CPLib.eqr(w_flgxls,"S")) {
      /* If _righe > 50000 and w_flgchk='S' and w_flgxls='N' */
      if (CPLib.gt(_righe,50000) && CPLib.eqr(w_flgchk,"S") && CPLib.eqr(w_flgxls,"N")) {
        /* Exec "Scrittura diretta su WEBCHK" Page 11:Page_15 */
        Page_15();
        /* ElseIf _righe > 100000 and w_flgchk='N' and w_flgxls='S' */
      } else if (CPLib.gt(_righe,100000) && CPLib.eqr(w_flgchk,"N") && CPLib.eqr(w_flgxls,"S")) {
        /* _numfile := _numfile + 1 */
        _numfile = CPLib.Round(_numfile+1,0);
        /* cOnlyNomeFile := "campione_"+Right('000000'+LRTrim(Str(_numfile,10,0)),6)+".xlsx" */
        cOnlyNomeFile = "campione_"+CPLib.Right("000000"+CPLib.LRTrim(CPLib.Str(_numfile,10,0)),6)+".xlsx";
        /* cNomeFile := LRTrim(gPathDoc)+'/flussi/'+LRTrim(gAzienda)+"/"+cOnlyNomeFile */
        cNomeFile = CPLib.LRTrim(gPathDoc)+"/flussi/"+CPLib.LRTrim(gAzienda)+"/"+cOnlyNomeFile;
        // Aggiunge i file nei vettori
        filenames.add(CPLib.LRTrim(cNomeFile));
        fileonames.add(CPLib.LRTrim(cOnlyNomeFile));
        /* gMsgProc := gMsgProc + 'Ora Inizio Scrittura file '+LRTrim(cOnlyNomeFile) +' per 380 Excel: '+ arfn_fdatetime(DateTime()) + NL */
        gMsgProc = gMsgProc+"Ora Inizio Scrittura file "+CPLib.LRTrim(cOnlyNomeFile)+" per 380 Excel: "+arfn_fdatetimeR.Make(m_Ctx,this).Run(CPLib.DateTime())+"\n";
        m_Ctx.SetGlobalString("gMsgProc",gMsgProc);
        /* Exec "Scrive il file Excel (xlsx)" Page 16:Page_20 */
        Page_20();
        /* gMsgProc := gMsgProc + 'Ora Fine Scrittura file '+LRTrim(cOnlyNomeFile) +' per 380 Excel: '+ arfn_fdatetime(DateTime()) + NL */
        gMsgProc = gMsgProc+"Ora Fine Scrittura file "+CPLib.LRTrim(cOnlyNomeFile)+" per 380 Excel: "+arfn_fdatetimeR.Make(m_Ctx,this).Run(CPLib.DateTime())+"\n";
        m_Ctx.SetGlobalString("gMsgProc",gMsgProc);
      } // End If
      /* If (_righe > 50000 and w_flgchk='S' and w_flgxls='N') or (_righe > 100000 and w_flgchk='N' and w_flgxls='S') */
      if ((CPLib.gt(_righe,50000) && CPLib.eqr(w_flgchk,"S") && CPLib.eqr(w_flgxls,"N")) || (CPLib.gt(_righe,100000) && CPLib.eqr(w_flgchk,"N") && CPLib.eqr(w_flgxls,"S"))) {
        /* mcTipo1.Zap() */
        mcTipo1.Zap();
        /* mcTipo2.Zap() */
        mcTipo2.Zap();
        /* mcTipo4.Zap() */
        mcTipo4.Zap();
        /* mcTipo5.Zap() */
        mcTipo5.Zap();
        /* mcTipo6.Zap() */
        mcTipo6.Zap();
        /* mcTipo7.Zap() */
        mcTipo7.Zap();
        /* mcTipo8.Zap() */
        mcTipo8.Zap();
        /* mcTipo9.Zap() */
        mcTipo9.Zap();
        /* _righe := 1 */
        _righe = CPLib.Round(1,0);
        /* _righetot := 1 */
        _righetot = CPLib.Round(1,0);
      } // End If
      /* Exec "Scrive MC per 380 Excel/WEBCHECK" Page 14:Page_18 */
      Page_18();
    } // End If
  }
  void Page_20() throws Exception {
    /* _cdata1 Char(10) */
    String _cdata1;
    _cdata1 = CPLib.Space(10);
    /* _cdata2 Char(10) */
    String _cdata2;
    _cdata2 = CPLib.Space(10);
    /* _cdata3 Char(10) */
    String _cdata3;
    _cdata3 = CPLib.Space(10);
    /* _imp1 Numeric(15, 2) */
    double _imp1;
    _imp1 = 0;
    /* _imp2 Numeric(15, 2) */
    double _imp2;
    _imp2 = 0;
    // creo il contenitore dei fogli
    wb = new SXSSFWorkbook();
    sheet = (SXSSFSheet) wb.createSheet("Tipo1") ;
    CellStyle cs = wb.createCellStyle();
    cs.setFillForegroundColor(IndexedColors.LIME.getIndex());
    cs.setFillPattern(FillPatternType.SOLID_FOREGROUND);
    Font f = wb.createFont();
    f.setBold(true);
    f.setFontHeightInPoints((short) 11);
    cs.setFont(f);
    //Azzero i contatori di fogli letti e righe scritte
    _i = 0;
    r=0;
    // Per allargare le colonne
    sheet.trackAllColumnsForAutoSizing();
    //Creo il record da scrivere
    row = sheet.createRow(r);
    //scrivo la riga di intestazione
    cell =  row.createCell(0);
    cell.setCellValue("A01.A TIPO INTERMEDIARIO");
    cell.setCellStyle(cs);
    cell =  row.createCell(1);
    cell.setCellValue("A01.B CODICE INTERMEDIARIO");
    cell.setCellStyle(cs);
    cell = row.createCell(2);
    cell.setCellValue("A02 TIPO INFORMAZIONE");
    cell.setCellStyle(cs);
    cell = row.createCell(3);
    cell.setCellValue("A03 IDENTIFICATIVO REGISTRAZIONE");
    cell.setCellStyle(cs);
    cell =  row.createCell(4);
    cell.setCellValue("A11 CODICE INTERNO DELLA DIPENDENZA");
    cell.setCellStyle(cs);
    cell =  row.createCell(5);
    cell.setCellValue("A12.A CODICE CAB COMUNE");
    cell.setCellStyle(cs);
    cell =  row.createCell(6);
    cell.setCellValue("A12.B DESCRIZIONE IN CHIARO");
    cell.setCellStyle(cs);
    cell =  row.createCell(7);
    cell.setCellValue("A12.C SIGLA PROVINCIA");
    cell.setCellStyle(cs);
    cell =  row.createCell(8);
    cell.setCellValue("A21 DATA DELL'OPERAZIONE");
    cell.setCellStyle(cs);
    cell =  row.createCell(9);
    cell.setCellValue("A22 FLAG SINGOLA/MULTIPLA");
    cell.setCellStyle(cs);
    cell =  row.createCell(10);
    cell.setCellValue("A23 FLAG CONTANTI");
    cell.setCellStyle(cs);
    cell =  row.createCell(11);
    cell.setCellValue("A24 CODICE CAUSALE ANALITICA");
    cell.setCellStyle(cs);
    cell =  row.createCell(12);
    cell.setCellValue("A25 CODICE VOCE");
    cell.setCellStyle(cs);
    cell =  row.createCell(13);
    cell.setCellValue("A31.A TIPO INTERMEDIARIO");
    cell.setCellStyle(cs);
    cell =  row.createCell(14);
    cell.setCellValue("A31.B CODICE (SECONDO IL TIPO)");
    cell.setCellStyle(cs);
    cell =  row.createCell(15);
    cell.setCellValue("A32 PAESE ESTERO DELLINTERMEDIARIO");
    cell.setCellStyle(cs);
    cell =  row.createCell(16);
    cell.setCellValue("A33.A CODICE CAB");
    cell.setCellStyle(cs);
    cell =  row.createCell(17);
    cell.setCellValue("A33.B DESCRIZIONE IN CHIARO");
    cell.setCellStyle(cs);
    cell =  row.createCell(18);
    cell.setCellValue("A33.C SIGLA PROVINCIA");
    cell.setCellStyle(cs);
    cell =  row.createCell(19);
    cell.setCellValue("A34 DESCRIZIONE INTERMEDIARIO DELLA CONTROPARTE");
    cell.setCellStyle(cs);
    cell =  row.createCell(20);
    cell.setCellValue("A41 RAPPORTO");
    cell.setCellStyle(cs);
    cell =  row.createCell(21);
    cell.setCellValue("A42 TIPO RAPPORTO");
    cell.setCellStyle(cs);
    cell =  row.createCell(22);
    cell.setCellValue("A43 TIPO LEGAME");
    cell.setCellStyle(cs);
    cell =  row.createCell(23);
    cell.setCellValue("A51 DATA DI REGISTRAZIONE");
    cell.setCellStyle(cs);
    cell =  row.createCell(24);
    cell.setCellValue("A52 TIPO DI REGISTRAZIONE");
    cell.setCellStyle(cs);
    cell =  row.createCell(25);
    cell.setCellValue("A53 CONNESSIONE TRA REGISTRAZIONI");
    cell.setCellStyle(cs);
    cell =  row.createCell(26);
    cell.setCellValue("A54.A CODICE STATO");
    cell.setCellStyle(cs);
    cell =  row.createCell(27);
    cell.setCellValue("A54.B DATA DELLA RETTIFICA");
    cell.setCellStyle(cs);
    cell =  row.createCell(28);
    cell.setCellValue("A54.C IDENTIFICATIVO REGISTRAZIONE MODIFICATA");
    cell.setCellStyle(cs);
    cell =  row.createCell(29);
    cell.setCellValue("B11 EURO O DIVISE NON UEM");
    cell.setCellStyle(cs);
    cell =  row.createCell(30);
    cell.setCellValue("B12 CODICE DIVISA");
    cell.setCellStyle(cs);
    cell =  row.createCell(31);
    cell.setCellValue("B13 SEGNO MONETARIO");
    cell.setCellStyle(cs);
    cell =  row.createCell(32);
    cell.setCellValue("B14 IMPORTO TOTALE");
    cell.setCellStyle(cs);
    cell =  row.createCell(33);
    cell.setCellValue("B15 IMPORTO DI CUI CONTANTE");
    cell.setCellStyle(cs);
    for (int _i = 0; CPLib.ne(_i,34); _i = _i + (1)) {
      //Ridimensiono le colonne in base al contenuto
      sheet.autoSizeColumn(_i);
    }
    // Sposta le righe di 2
    sheet.untrackAllColumnsForAutoSizing();
    r=r+2;
    for (MemoryCursorRow_tipo1 rwTipo1 : mcTipo1._iterable_()) {
      /* _cdata1 := arfn_fdate(rwTipo1.A21) */
      _cdata1 = arfn_fdateR.Make(m_Ctx,this).Run(rwTipo1.A21);
      /* _cdata2 := arfn_fdate(rwTipo1.A51) */
      _cdata2 = arfn_fdateR.Make(m_Ctx,this).Run(rwTipo1.A51);
      /* _cdata3 := arfn_fdate(rwTipo1.A54B) */
      _cdata3 = arfn_fdateR.Make(m_Ctx,this).Run(rwTipo1.A54B);
      /* _imp1 := rwTipo1.B14/100 */
      _imp1 = CPLib.Round(rwTipo1.B14/100,2);
      /* _imp2 := rwTipo1.B15/100 */
      _imp2 = CPLib.Round(rwTipo1.B15/100,2);
      //Creo il record da scrivere
      row = sheet.createRow(r);
      cell = row.createCell(0);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A01A));
      cell = row.createCell(1);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A01B));
      cell = row.createCell(2);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A02));
      cell = row.createCell(3);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A03));
      cell = row.createCell(4);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A11));
      cell = row.createCell(5);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A12A));
      cell = row.createCell(6);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A12B));
      cell = row.createCell(7);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A12C));
      cell = row.createCell(8);
      cell.setCellValue(CPLib.LRTrim(_cdata1));
      cell = row.createCell(9);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A22));
      cell = row.createCell(10);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A23));
      cell = row.createCell(11);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A24));
      cell = row.createCell(12);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A25));
      cell = row.createCell(13);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A31A));
      cell = row.createCell(14);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A31B));
      cell = row.createCell(15);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A32));
      cell = row.createCell(16);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A33A));
      cell = row.createCell(17);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A33B));
      cell = row.createCell(18);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A33C));
      cell = row.createCell(19);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A34));
      cell = row.createCell(20);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A41));
      cell = row.createCell(21);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A42));
      cell = row.createCell(22);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A43));
      cell = row.createCell(23);
      cell.setCellValue(CPLib.LRTrim(_cdata2));
      cell = row.createCell(24);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A52));
      cell = row.createCell(25);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A53));
      cell = row.createCell(26);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A54A));
      cell = row.createCell(27);
      cell.setCellValue(CPLib.LRTrim(_cdata3));
      cell = row.createCell(28);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.A54C));
      cell = row.createCell(29);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.B11));
      cell = row.createCell(30);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.B12));
      cell = row.createCell(31);
      cell.setCellValue(CPLib.LRTrim(rwTipo1.B13));
      cell = row.createCell(32);
      cell.setCellValue(_imp1);
      cell = row.createCell(33);
      cell.setCellValue(_imp2);
      r=r+1;
    }
    /* If _conta2 > 0 */
    if (CPLib.gt(_conta2,0)) {
      //Azzero i contatori di fogli letti e righe scritte
      sheet = (SXSSFSheet) wb.createSheet("Tipo2_3") ;
      _i = 0;
      r=0;
      //Creo il record da scrivere
      row = sheet.createRow(r);
      //scrivo la riga di intestazione
      cell =  row.createCell(0);
      cell.setCellValue("A01A");
      cell.setCellStyle(cs);
      cell =  row.createCell(1);
      cell.setCellValue("A01B");
      cell.setCellStyle(cs);
      cell = row.createCell(2);
      cell.setCellValue("A02");
      cell.setCellStyle(cs);
      cell = row.createCell(3);
      cell.setCellValue("A03");
      cell.setCellStyle(cs);
      cell =  row.createCell(4);
      cell.setCellValue("C11");
      cell.setCellStyle(cs);
      r=r+2;
      for (MemoryCursorRow_tipo2_3 rwTipo2 : mcTipo2._iterable_()) {
        //Creo il record da scrivere
        row = sheet.createRow(r);
        cell = row.createCell(0);
        cell.setCellValue(CPLib.LRTrim(rwTipo2.A01A));
        cell = row.createCell(1);
        cell.setCellValue(CPLib.LRTrim(rwTipo2.A01B));
        cell = row.createCell(2);
        cell.setCellValue(CPLib.LRTrim(rwTipo2.A02));
        cell = row.createCell(3);
        cell.setCellValue(CPLib.LRTrim(rwTipo2.A03));
        cell = row.createCell(4);
        cell.setCellValue(CPLib.LRTrim(rwTipo2.C11));
        r=r+1;
      }
    } // End If
    /* If _conta4 > 0 */
    if (CPLib.gt(_conta4,0)) {
      //Azzero i contatori di fogli letti e righe scritte
      sheet = (SXSSFSheet) wb.createSheet("Tipo4") ;
      _i = 0;
      r=0;
      //Creo il record da scrivere
      row = sheet.createRow(r);
      //scrivo la riga di intestazione
      cell =  row.createCell(0);
      cell.setCellValue("A01A");
      cell.setCellStyle(cs);
      cell =  row.createCell(1);
      cell.setCellValue("A01B");
      cell.setCellStyle(cs);
      cell = row.createCell(2);
      cell.setCellValue("A02");
      cell.setCellStyle(cs);
      cell = row.createCell(3);
      cell.setCellValue("A03");
      cell.setCellStyle(cs);
      cell =  row.createCell(4);
      cell.setCellValue("C21");
      cell.setCellStyle(cs);
      r=r+2;
      for (MemoryCursorRow_tipo4 rwTipo4 : mcTipo4._iterable_()) {
        //Creo il record da scrivere
        row = sheet.createRow(r);
        cell = row.createCell(0);
        cell.setCellValue(CPLib.LRTrim(rwTipo4.A01A));
        cell = row.createCell(1);
        cell.setCellValue(CPLib.LRTrim(rwTipo4.A01B));
        cell = row.createCell(2);
        cell.setCellValue(CPLib.LRTrim(rwTipo4.A02));
        cell = row.createCell(3);
        cell.setCellValue(CPLib.LRTrim(rwTipo4.A03));
        cell = row.createCell(4);
        cell.setCellValue(CPLib.LRTrim(rwTipo4.C21));
        r=r+1;
      }
    } // End If
    /* If _conta5 > 0 */
    if (CPLib.gt(_conta5,0)) {
      //Azzero i contatori di fogli letti e righe scritte
      sheet = (SXSSFSheet) wb.createSheet("Tipo5") ;
      _i = 0;
      r=0;
      // Per allargare le colonne
      sheet.trackAllColumnsForAutoSizing();
      //Creo il record da scrivere
      row = sheet.createRow(r);
      cell =  row.createCell(0);
      cell.setCellValue("A01.A TIPO INTERMEDIARIO");
      cell.setCellStyle(cs);
      cell =  row.createCell(1);
      cell.setCellValue("A01.B CODICE INTERMEDIARIO");
      cell.setCellStyle(cs);
      cell = row.createCell(2);
      cell.setCellValue("A02 TIPO INFORMAZIONE");
      cell.setCellStyle(cs);
      cell = row.createCell(3);
      cell.setCellValue("A03 IDENTIFICATIVO REGISTRAZIONE");
      cell.setCellStyle(cs);
      cell =  row.createCell(4);
      cell.setCellValue("C31 NDG/CONNESSIONE CON ANAGRAFE");
      cell.setCellStyle(cs);
      cell =  row.createCell(5);
      cell.setCellValue("F11 COGNOME E NOME/RAGIONE SOCIALE");
      cell.setCellStyle(cs);
      cell =  row.createCell(6);
      cell.setCellValue("F13 PAESE DI RESIDENZA");
      cell.setCellStyle(cs);
      cell =  row.createCell(7);
      cell.setCellValue("F14.A CODICE CAB COMUNE");
      cell.setCellStyle(cs);
      cell =  row.createCell(8);
      cell.setCellValue("F14.B DESCRIZIONE IN CHIARO");
      cell.setCellStyle(cs);
      cell =  row.createCell(9);
      cell.setCellValue("F14.C SIGLA PROVINCIA");
      cell.setCellStyle(cs);
      cell =  row.createCell(10);
      cell.setCellValue("F15 DOMICILIO/SEDE: INDIRIZZO");
      cell.setCellStyle(cs);
      cell =  row.createCell(11);
      cell.setCellValue("F16 DOMICILIO/SEDE: CAP DI RESIDENZA");
      cell.setCellStyle(cs);
      cell =  row.createCell(12);
      cell.setCellValue("F31 RAPPORTO");
      cell.setCellStyle(cs);
      for (int _i = 0; CPLib.ne(_i,13); _i = _i + (1)) {
        //Ridimensiono le colonne in base al contenuto
        sheet.autoSizeColumn(_i);
      }
      // Sposta le righe di 2
      sheet.untrackAllColumnsForAutoSizing();
      r=r+2;
      for (MemoryCursorRow_tipo5 rwTipo5 : mcTipo5._iterable_()) {
        //Creo il record da scrivere
        row = sheet.createRow(r);
        cell = row.createCell(0);
        cell.setCellValue(CPLib.LRTrim(rwTipo5.A01A));
        cell = row.createCell(1);
        cell.setCellValue(CPLib.LRTrim(rwTipo5.A01B));
        cell = row.createCell(2);
        cell.setCellValue(CPLib.LRTrim(rwTipo5.A02));
        cell = row.createCell(3);
        cell.setCellValue(CPLib.LRTrim(rwTipo5.A03));
        cell = row.createCell(4);
        cell.setCellValue(CPLib.LRTrim(rwTipo5.C31));
        cell = row.createCell(5);
        cell.setCellValue(CPLib.LRTrim(rwTipo5.F11));
        cell = row.createCell(6);
        cell.setCellValue(CPLib.LRTrim(rwTipo5.F13));
        cell = row.createCell(7);
        cell.setCellValue(CPLib.LRTrim(rwTipo5.F14A));
        cell = row.createCell(8);
        cell.setCellValue(CPLib.LRTrim(rwTipo5.F14B));
        cell = row.createCell(9);
        cell.setCellValue(CPLib.LRTrim(rwTipo5.F14C));
        cell = row.createCell(10);
        cell.setCellValue(CPLib.LRTrim(rwTipo5.F15));
        cell = row.createCell(11);
        cell.setCellValue(CPLib.LRTrim(rwTipo5.F16));
        cell = row.createCell(12);
        cell.setCellValue(CPLib.LRTrim(rwTipo5.F31));
        cell = row.createCell(13);
        r=r+1;
      }
    } // End If
    /* If _conta6 > 0 */
    if (CPLib.gt(_conta6,0)) {
      //Azzero i contatori di fogli letti e righe scritte
      sheet = (SXSSFSheet) wb.createSheet("Tipo6") ;
      _i = 0;
      r=0;
      // Per allargare le colonne
      sheet.trackAllColumnsForAutoSizing();
      //Creo il record da scrivere
      row = sheet.createRow(r);
      cell =  row.createCell(0);
      cell.setCellValue("A01.A TIPO INTERMEDIARIO");
      cell.setCellStyle(cs);
      cell =  row.createCell(1);
      cell.setCellValue("A01.B CODICE INTERMEDIARIO");
      cell.setCellStyle(cs);
      cell = row.createCell(2);
      cell.setCellValue("A02 TIPO INFORMAZIONE");
      cell.setCellStyle(cs);
      cell = row.createCell(3);
      cell.setCellValue("A03 IDENTIFICATIVO REGISTRAZIONE");
      cell.setCellStyle(cs);
      cell =  row.createCell(4);
      cell.setCellValue("C41 NDG/CONNESSIONE CON ANAGRAFE");
      cell.setCellStyle(cs);
      cell =  row.createCell(5);
      cell.setCellValue("G11 COGNOME E NOME/RAGIONE SOCIALE");
      cell.setCellStyle(cs);
      cell =  row.createCell(6);
      cell.setCellValue("G13 PAESE DI RESIDENZA");
      cell.setCellStyle(cs);
      cell =  row.createCell(7);
      cell.setCellValue("G14.A CODICE CAB COMUNE");
      cell.setCellStyle(cs);
      cell =  row.createCell(8);
      cell.setCellValue("G14.B DESCRIZIONE IN CHIARO");
      cell.setCellStyle(cs);
      cell =  row.createCell(9);
      cell.setCellValue("G14.C SIGLA PROVINCIA");
      cell.setCellStyle(cs);
      cell =  row.createCell(10);
      cell.setCellValue("G15 DOMICILIO/SEDE: INDIRIZZO");
      cell.setCellStyle(cs);
      cell =  row.createCell(11);
      cell.setCellValue("G16 DOMICILIO/SEDE: CAP DI RESIDENZA");
      cell.setCellStyle(cs);
      cell =  row.createCell(12);
      cell.setCellValue("G17 CODICE FISCALE");
      cell.setCellStyle(cs);
      cell =  row.createCell(13);
      cell.setCellValue("G18 DATA DI NASCITA PERSONE FISICHE");
      cell.setCellStyle(cs);
      cell =  row.createCell(14);
      cell.setCellValue("G19 COMUNE/PAESE DI NASCITA");
      cell.setCellStyle(cs);
      cell =  row.createCell(15);
      cell.setCellValue("G41 TIPO DOCUMENTO PRESENTATO");
      cell.setCellStyle(cs);
      cell =  row.createCell(16);
      cell.setCellValue("G42 NUMERO DOCUMENTO PRESENTATO");
      cell.setCellStyle(cs);
      cell =  row.createCell(17);
      cell.setCellValue("G43 DATA DI RILASCIO");
      cell.setCellStyle(cs);
      cell =  row.createCell(18);
      cell.setCellValue("G44 AUTORITÀ E LOCALITÀ DI RILASCIO");
      cell.setCellStyle(cs);
      cell =  row.createCell(19);
      cell.setCellValue("G45 SESSO");
      cell.setCellStyle(cs);
      for (int _i = 0; CPLib.ne(_i,20); _i = _i + (1)) {
        //Ridimensiono le colonne in base al contenuto
        sheet.autoSizeColumn(_i);
      }
      // Sposta le righe di 2
      sheet.untrackAllColumnsForAutoSizing();
      r=r+2;
      for (MemoryCursorRow_tipo6 rwTipo6 : mcTipo6._iterable_()) {
        /* _cdata1 := arfn_fdate(rwTipo6.G18) */
        _cdata1 = arfn_fdateR.Make(m_Ctx,this).Run(rwTipo6.G18);
        /* _cdata2 := arfn_fdate(rwTipo6.G43) */
        _cdata2 = arfn_fdateR.Make(m_Ctx,this).Run(rwTipo6.G43);
        //Creo il record da scrivere
        row = sheet.createRow(r);
        cell = row.createCell(0);
        cell.setCellValue(CPLib.LRTrim(rwTipo6.A01A));
        cell = row.createCell(1);
        cell.setCellValue(CPLib.LRTrim(rwTipo6.A01B));
        cell = row.createCell(2);
        cell.setCellValue(CPLib.LRTrim(rwTipo6.A02));
        cell = row.createCell(3);
        cell.setCellValue(CPLib.LRTrim(rwTipo6.A03));
        cell = row.createCell(4);
        cell.setCellValue(CPLib.LRTrim(rwTipo6.C41));
        cell = row.createCell(5);
        cell.setCellValue(CPLib.LRTrim(rwTipo6.G11));
        cell = row.createCell(6);
        cell.setCellValue(CPLib.LRTrim(rwTipo6.G13));
        cell = row.createCell(7);
        cell.setCellValue(CPLib.LRTrim(rwTipo6.G14A));
        cell = row.createCell(8);
        cell.setCellValue(CPLib.LRTrim(rwTipo6.G14B));
        cell = row.createCell(9);
        cell.setCellValue(CPLib.LRTrim(rwTipo6.G14C));
        cell = row.createCell(10);
        cell.setCellValue(CPLib.LRTrim(rwTipo6.G15));
        cell = row.createCell(11);
        cell.setCellValue(CPLib.LRTrim(rwTipo6.G16));
        cell = row.createCell(12);
        cell.setCellValue(CPLib.LRTrim(rwTipo6.G17));
        cell = row.createCell(13);
        cell.setCellValue(CPLib.LRTrim(_cdata1));
        cell = row.createCell(14);
        cell.setCellValue(CPLib.LRTrim(rwTipo6.G19));
        cell = row.createCell(15);
        cell.setCellValue(CPLib.LRTrim(rwTipo6.G41));
        cell = row.createCell(16);
        cell.setCellValue(CPLib.LRTrim(rwTipo6.G42));
        cell = row.createCell(17);
        cell.setCellValue(CPLib.LRTrim(_cdata2));
        cell = row.createCell(18);
        cell.setCellValue(CPLib.LRTrim(rwTipo6.G44));
        cell = row.createCell(19);
        cell.setCellValue(CPLib.LRTrim(rwTipo6.G45));
        r=r+1;
      }
    } // End If
    /* If _conta7 > 0 */
    if (CPLib.gt(_conta7,0)) {
      //Azzero i contatori di fogli letti e righe scritte
      sheet = (SXSSFSheet) wb.createSheet("Tipo7") ;
      _i = 0;
      r=0;
      // Per allargare le colonne
      sheet.trackAllColumnsForAutoSizing();
      //Creo il record da scrivere
      row = sheet.createRow(r);
      cell =  row.createCell(0);
      cell.setCellValue("A01.A TIPO INTERMEDIARIO");
      cell.setCellStyle(cs);
      cell =  row.createCell(1);
      cell.setCellValue("A01.B CODICE INTERMEDIARIO");
      cell.setCellStyle(cs);
      cell = row.createCell(2);
      cell.setCellValue("A02 TIPO INFORMAZIONE");
      cell.setCellStyle(cs);
      cell = row.createCell(3);
      cell.setCellValue("A03 IDENTIFICATIVO REGISTRAZIONE");
      cell.setCellStyle(cs);
      cell =  row.createCell(4);
      cell.setCellValue("C11 NDG/CONNESSIONE CON ANAGRAFE");
      cell.setCellStyle(cs);
      cell =  row.createCell(5);
      cell.setCellValue("D11 COGNOME E NOME/RAGIONE SOCIALE");
      cell.setCellStyle(cs);
      cell =  row.createCell(6);
      cell.setCellValue("D13 PAESE DI RESIDENZA");
      cell.setCellStyle(cs);
      cell =  row.createCell(7);
      cell.setCellValue("D14.A CODICE CAB COMUNE");
      cell.setCellStyle(cs);
      cell =  row.createCell(8);
      cell.setCellValue("D14.B DESCRIZIONE IN CHIARO");
      cell.setCellStyle(cs);
      cell =  row.createCell(9);
      cell.setCellValue("D14.C SIGLA PROVINCIA");
      cell.setCellStyle(cs);
      cell =  row.createCell(10);
      cell.setCellValue("D15 DOMICILIO/SEDE: INDIRIZZO");
      cell.setCellStyle(cs);
      cell =  row.createCell(11);
      cell.setCellValue("D16 DOMICILIO/SEDE: CAP DI RESIDENZA");
      cell.setCellStyle(cs);
      cell =  row.createCell(12);
      cell.setCellValue("D17 CODICE FISCALE");
      cell.setCellStyle(cs);
      cell =  row.createCell(13);
      cell.setCellValue("D18 DATA DI NASCITA PERSONE FISICHE");
      cell.setCellStyle(cs);
      cell =  row.createCell(14);
      cell.setCellValue("D19 COMUNE/PAESE DI NASCITA");
      cell.setCellStyle(cs);
      cell =  row.createCell(15);
      cell.setCellValue("D21 SOTTOGRUPPO DI ATTIVITÀ ECONOMICA");
      cell.setCellStyle(cs);
      cell =  row.createCell(16);
      cell.setCellValue("D22 CODICE ATECO");
      cell.setCellStyle(cs);
      cell =  row.createCell(17);
      cell.setCellValue("D23 SETTORIZZAZIONE SINTETICA ECONOMICA");
      cell.setCellStyle(cs);
      cell =  row.createCell(18);
      cell.setCellValue("D31 RAPPORTO");
      cell.setCellStyle(cs);
      cell =  row.createCell(19);
      cell.setCellValue("D32 TIPO RAPPORTO");
      cell.setCellStyle(cs);
      cell =  row.createCell(20);
      cell.setCellValue("D41 TIPO DOCUMENTO PRESENTATO");
      cell.setCellStyle(cs);
      cell =  row.createCell(21);
      cell.setCellValue("D42 NUMERO DOCUMENTO PRESENTATO");
      cell.setCellStyle(cs);
      cell =  row.createCell(22);
      cell.setCellValue("D43 DATA DI RILASCIO");
      cell.setCellStyle(cs);
      cell =  row.createCell(23);
      cell.setCellValue("D44 AUTORITÀ E LOCALITÀ DI RILASCIO");
      cell.setCellStyle(cs);
      cell =  row.createCell(24);
      cell.setCellValue("D45 SESSO");
      cell.setCellStyle(cs);
      for (int _i = 0; CPLib.ne(_i,25); _i = _i + (1)) {
        //Ridimensiono le colonne in base al contenuto
        sheet.autoSizeColumn(_i);
      }
      // Sposta le righe di 2
      sheet.untrackAllColumnsForAutoSizing();
      r=r+2;
      for (MemoryCursorRow_tipo7 rwTipo7 : mcTipo7._iterable_()) {
        /* _cdata1 := arfn_fdate(rwTipo7.D18) */
        _cdata1 = arfn_fdateR.Make(m_Ctx,this).Run(rwTipo7.D18);
        /* _cdata2 := arfn_fdate(rwTipo7.D43) */
        _cdata2 = arfn_fdateR.Make(m_Ctx,this).Run(rwTipo7.D43);
        //Creo il record da scrivere
        row = sheet.createRow(r);
        cell = row.createCell(0);
        cell.setCellValue(CPLib.LRTrim(rwTipo7.A01A));
        cell = row.createCell(1);
        cell.setCellValue(CPLib.LRTrim(rwTipo7.A01B));
        cell = row.createCell(2);
        cell.setCellValue(CPLib.LRTrim(rwTipo7.A02));
        cell = row.createCell(3);
        cell.setCellValue(CPLib.LRTrim(rwTipo7.A03));
        cell = row.createCell(4);
        cell.setCellValue(CPLib.LRTrim(rwTipo7.C11));
        cell = row.createCell(5);
        cell.setCellValue(CPLib.LRTrim(rwTipo7.D11));
        cell = row.createCell(6);
        cell.setCellValue(CPLib.LRTrim(rwTipo7.D13));
        cell = row.createCell(7);
        cell.setCellValue(CPLib.LRTrim(rwTipo7.D14A));
        cell = row.createCell(8);
        cell.setCellValue(CPLib.LRTrim(rwTipo7.D14B));
        cell = row.createCell(9);
        cell.setCellValue(CPLib.LRTrim(rwTipo7.D14C));
        cell = row.createCell(10);
        cell.setCellValue(CPLib.LRTrim(rwTipo7.D15));
        cell = row.createCell(11);
        cell.setCellValue(CPLib.LRTrim(rwTipo7.D16));
        cell = row.createCell(12);
        cell.setCellValue(CPLib.LRTrim(rwTipo7.D17));
        cell = row.createCell(13);
        cell.setCellValue(CPLib.LRTrim(_cdata1));
        cell = row.createCell(14);
        cell.setCellValue(CPLib.LRTrim(rwTipo7.D19));
        cell = row.createCell(15);
        cell.setCellValue(CPLib.LRTrim(rwTipo7.D21));
        cell = row.createCell(16);
        cell.setCellValue(CPLib.LRTrim(rwTipo7.D22));
        cell = row.createCell(17);
        cell.setCellValue(CPLib.LRTrim(rwTipo7.D23));
        cell = row.createCell(18);
        cell.setCellValue(CPLib.LRTrim(rwTipo7.D31));
        cell = row.createCell(19);
        cell.setCellValue(CPLib.LRTrim(rwTipo7.D32));
        cell = row.createCell(20);
        cell.setCellValue(CPLib.LRTrim(rwTipo7.D41));
        cell = row.createCell(21);
        cell.setCellValue(CPLib.LRTrim(rwTipo7.D42));
        cell = row.createCell(22);
        cell.setCellValue(CPLib.LRTrim(_cdata2));
        cell = row.createCell(23);
        cell.setCellValue(CPLib.LRTrim(rwTipo7.D44));
        cell = row.createCell(24);
        cell.setCellValue(CPLib.LRTrim(rwTipo7.D45));
        r=r+1;
      }
    } // End If
    /* If _conta8 > 0 */
    if (CPLib.gt(_conta8,0)) {
      //Azzero i contatori di fogli letti e righe scritte
      sheet = (SXSSFSheet) wb.createSheet("Tipo8") ;
      _i = 0;
      r=0;
      // Per allargare le colonne
      sheet.trackAllColumnsForAutoSizing();
      //Creo il record da scrivere
      row = sheet.createRow(r);
      cell =  row.createCell(0);
      cell.setCellValue("A01.A TIPO INTERMEDIARIO");
      cell.setCellStyle(cs);
      cell =  row.createCell(1);
      cell.setCellValue("A01.B CODICE INTERMEDIARIO");
      cell.setCellStyle(cs);
      cell = row.createCell(2);
      cell.setCellValue("A02 TIPO INFORMAZIONE");
      cell.setCellStyle(cs);
      cell = row.createCell(3);
      cell.setCellValue("A03 IDENTIFICATIVO REGISTRAZIONE");
      cell.setCellStyle(cs);
      cell =  row.createCell(4);
      cell.setCellValue("C21 NDG/CONNESSIONE CON ANAGRAFE");
      cell.setCellStyle(cs);
      cell =  row.createCell(5);
      cell.setCellValue("E11 COGNOME E NOME/RAGIONE SOCIALE");
      cell.setCellStyle(cs);
      cell =  row.createCell(6);
      cell.setCellValue("E13 PAESE DI RESIDENZA");
      cell.setCellStyle(cs);
      cell =  row.createCell(7);
      cell.setCellValue("E14.A CODICE CAB COMUNE");
      cell.setCellStyle(cs);
      cell =  row.createCell(8);
      cell.setCellValue("E14.B DESCRIZIONE IN CHIARO");
      cell.setCellStyle(cs);
      cell =  row.createCell(9);
      cell.setCellValue("E14.C SIGLA PROVINCIA");
      cell.setCellStyle(cs);
      cell =  row.createCell(10);
      cell.setCellValue("E15 DOMICILIO/SEDE: INDIRIZZO");
      cell.setCellStyle(cs);
      cell =  row.createCell(11);
      cell.setCellValue("E16 DOMICILIO/SEDE: CAP DI RESIDENZA");
      cell.setCellStyle(cs);
      cell =  row.createCell(12);
      cell.setCellValue("E17 CODICE FISCALE");
      cell.setCellStyle(cs);
      cell =  row.createCell(13);
      cell.setCellValue("E18 DATA DI NASCITA PERSONE FISICHE");
      cell.setCellStyle(cs);
      cell =  row.createCell(14);
      cell.setCellValue("E19 COMUNE/PAESE DI NASCITA");
      cell.setCellStyle(cs);
      cell =  row.createCell(15);
      cell.setCellValue("E41 TIPO DOCUMENTO PRESENTATO");
      cell.setCellStyle(cs);
      cell =  row.createCell(16);
      cell.setCellValue("E42 NUMERO DOCUMENTO PRESENTATO");
      cell.setCellStyle(cs);
      cell =  row.createCell(17);
      cell.setCellValue("E43 DATA DI RILASCIO");
      cell.setCellStyle(cs);
      cell =  row.createCell(18);
      cell.setCellValue("E44 AUTORITÀ E LOCALITÀ DI RILASCIO");
      cell.setCellStyle(cs);
      cell =  row.createCell(19);
      cell.setCellValue("E45 SESSO");
      cell.setCellStyle(cs);
      for (int _i = 0; CPLib.ne(_i,20); _i = _i + (1)) {
        //Ridimensiono le colonne in base al contenuto
        sheet.autoSizeColumn(_i);
      }
      // Sposta le righe di 2
      sheet.untrackAllColumnsForAutoSizing();
      r=r+2;
      for (MemoryCursorRow_tipo8 rwTipo8 : mcTipo8._iterable_()) {
        /* _cdata1 := arfn_fdate(rwTipo8.E18) */
        _cdata1 = arfn_fdateR.Make(m_Ctx,this).Run(rwTipo8.E18);
        /* _cdata2 := arfn_fdate(rwTipo8.E43) */
        _cdata2 = arfn_fdateR.Make(m_Ctx,this).Run(rwTipo8.E43);
        //Creo il record da scrivere
        row = sheet.createRow(r);
        cell = row.createCell(0);
        cell.setCellValue(CPLib.LRTrim(rwTipo8.A01A));
        cell = row.createCell(1);
        cell.setCellValue(CPLib.LRTrim(rwTipo8.A01B));
        cell = row.createCell(2);
        cell.setCellValue(CPLib.LRTrim(rwTipo8.A02));
        cell = row.createCell(3);
        cell.setCellValue(CPLib.LRTrim(rwTipo8.A03));
        cell = row.createCell(4);
        cell.setCellValue(CPLib.LRTrim(rwTipo8.C21));
        cell = row.createCell(5);
        cell.setCellValue(CPLib.LRTrim(rwTipo8.E11));
        cell = row.createCell(6);
        cell.setCellValue(CPLib.LRTrim(rwTipo8.E13));
        cell = row.createCell(7);
        cell.setCellValue(CPLib.LRTrim(rwTipo8.E14A));
        cell = row.createCell(8);
        cell.setCellValue(CPLib.LRTrim(rwTipo8.E14B));
        cell = row.createCell(9);
        cell.setCellValue(CPLib.LRTrim(rwTipo8.E14C));
        cell = row.createCell(10);
        cell.setCellValue(CPLib.LRTrim(rwTipo8.E15));
        cell = row.createCell(11);
        cell.setCellValue(CPLib.LRTrim(rwTipo8.E16));
        cell = row.createCell(12);
        cell.setCellValue(CPLib.LRTrim(rwTipo8.E17));
        cell = row.createCell(13);
        cell.setCellValue(CPLib.LRTrim(_cdata1));
        cell = row.createCell(14);
        cell.setCellValue(CPLib.LRTrim(rwTipo8.E19));
        cell = row.createCell(15);
        cell.setCellValue(CPLib.LRTrim(rwTipo8.E41));
        cell = row.createCell(16);
        cell.setCellValue(CPLib.LRTrim(rwTipo8.E42));
        cell = row.createCell(17);
        cell.setCellValue(CPLib.LRTrim(_cdata2));
        cell = row.createCell(18);
        cell.setCellValue(CPLib.LRTrim(rwTipo8.E44));
        cell = row.createCell(19);
        cell.setCellValue(CPLib.LRTrim(rwTipo8.E45));
        r=r+1;
      }
    } // End If
    /* If _conta9 > 0 */
    if (CPLib.gt(_conta9,0)) {
      //Azzero i contatori di fogli letti e righe scritte
      sheet = (SXSSFSheet) wb.createSheet("Tipo9") ;
      _i = 0;
      r=0;
      // Per allargare le colonne
      sheet.trackAllColumnsForAutoSizing();
      //Creo il record da scrivere
      row = sheet.createRow(r);
      cell =  row.createCell(0);
      cell.setCellValue("A01.A TIPO INTERMEDIARIO");
      cell.setCellStyle(cs);
      cell =  row.createCell(1);
      cell.setCellValue("A01.B CODICE INTERMEDIARIO");
      cell.setCellStyle(cs);
      cell = row.createCell(2);
      cell.setCellValue("A02 TIPO INFORMAZIONE");
      cell.setCellStyle(cs);
      cell = row.createCell(3);
      cell.setCellValue("A03 IDENTIFICATIVO REGISTRAZIONE");
      cell.setCellStyle(cs);
      cell =  row.createCell(4);
      cell.setCellValue("C51 NDG/CONNESSIONE CON ANAGRAFE");
      cell.setCellStyle(cs);
      cell =  row.createCell(5);
      cell.setCellValue("H11 COGNOME E NOME/RAGIONE SOCIALE");
      cell.setCellStyle(cs);
      cell =  row.createCell(6);
      cell.setCellValue("H13 PAESE DI RESIDENZA");
      cell.setCellStyle(cs);
      cell =  row.createCell(7);
      cell.setCellValue("H14.A CODICE CAB COMUNE");
      cell.setCellStyle(cs);
      cell =  row.createCell(8);
      cell.setCellValue("H14.B DESCRIZIONE IN CHIARO");
      cell.setCellStyle(cs);
      cell =  row.createCell(9);
      cell.setCellValue("H14.C SIGLA PROVINCIA");
      cell.setCellStyle(cs);
      cell =  row.createCell(10);
      cell.setCellValue("H15 DOMICILIO/SEDE: INDIRIZZO");
      cell.setCellStyle(cs);
      cell =  row.createCell(11);
      cell.setCellValue("H16 DOMICILIO/SEDE: CAP DI RESIDENZA");
      cell.setCellStyle(cs);
      cell =  row.createCell(12);
      cell.setCellValue("H17 CODICE FISCALE");
      cell.setCellStyle(cs);
      cell =  row.createCell(13);
      cell.setCellValue("H18 DATA DI NASCITA PERSONE FISICHE");
      cell.setCellStyle(cs);
      cell =  row.createCell(14);
      cell.setCellValue("H19 COMUNE/PAESE DI NASCITA");
      cell.setCellStyle(cs);
      cell =  row.createCell(15);
      cell.setCellValue("H41 TIPO DOCUMENTO PRESENTATO");
      cell.setCellStyle(cs);
      cell =  row.createCell(16);
      cell.setCellValue("H42 NUMERO DOCUMENTO PRESENTATO");
      cell.setCellStyle(cs);
      cell =  row.createCell(17);
      cell.setCellValue("H43 DATA DI RILASCIO");
      cell.setCellStyle(cs);
      cell =  row.createCell(18);
      cell.setCellValue("H44 AUTORITÀ E LOCALITÀ DI RILASCIO");
      cell.setCellStyle(cs);
      cell =  row.createCell(19);
      cell.setCellValue("H45 SESSO");
      cell.setCellStyle(cs);
      for (int _i = 0; CPLib.ne(_i,20); _i = _i + (1)) {
        //Ridimensiono le colonne in base al contenuto
        sheet.autoSizeColumn(_i);
      }
      // Sposta le righe di 2
      sheet.untrackAllColumnsForAutoSizing();
      r=r+2;
      for (MemoryCursorRow_tipo9 rwTipo9 : mcTipo9._iterable_()) {
        /* _cdata1 := arfn_fdate(rwTipo9.H18) */
        _cdata1 = arfn_fdateR.Make(m_Ctx,this).Run(rwTipo9.H18);
        /* _cdata2 := arfn_fdate(rwTipo9.H43) */
        _cdata2 = arfn_fdateR.Make(m_Ctx,this).Run(rwTipo9.H43);
        //Creo il record da scrivere
        row = sheet.createRow(r);
        cell = row.createCell(0);
        cell.setCellValue(CPLib.LRTrim(rwTipo9.A01A));
        cell = row.createCell(1);
        cell.setCellValue(CPLib.LRTrim(rwTipo9.A01B));
        cell = row.createCell(2);
        cell.setCellValue(CPLib.LRTrim(rwTipo9.A02));
        cell = row.createCell(3);
        cell.setCellValue(CPLib.LRTrim(rwTipo9.A03));
        cell = row.createCell(4);
        cell.setCellValue(CPLib.LRTrim(rwTipo9.C51));
        cell = row.createCell(5);
        cell.setCellValue(CPLib.LRTrim(rwTipo9.H11));
        cell = row.createCell(6);
        cell.setCellValue(CPLib.LRTrim(rwTipo9.H13));
        cell = row.createCell(7);
        cell.setCellValue(CPLib.LRTrim(rwTipo9.H14A));
        cell = row.createCell(8);
        cell.setCellValue(CPLib.LRTrim(rwTipo9.H14B));
        cell = row.createCell(9);
        cell.setCellValue(CPLib.LRTrim(rwTipo9.H14C));
        cell = row.createCell(10);
        cell.setCellValue(CPLib.LRTrim(rwTipo9.H15));
        cell = row.createCell(11);
        cell.setCellValue(CPLib.LRTrim(rwTipo9.H16));
        cell = row.createCell(12);
        cell.setCellValue(CPLib.LRTrim(rwTipo9.H17));
        cell = row.createCell(13);
        cell.setCellValue(CPLib.LRTrim(_cdata1));
        cell = row.createCell(14);
        cell.setCellValue(CPLib.LRTrim(rwTipo9.H19));
        cell = row.createCell(15);
        cell.setCellValue(CPLib.LRTrim(rwTipo9.H41));
        cell = row.createCell(16);
        cell.setCellValue(CPLib.LRTrim(rwTipo9.H42));
        cell = row.createCell(17);
        cell.setCellValue(CPLib.LRTrim(_cdata2));
        cell = row.createCell(18);
        cell.setCellValue(CPLib.LRTrim(rwTipo9.H44));
        cell = row.createCell(19);
        cell.setCellValue(CPLib.LRTrim(rwTipo9.H45));
        r=r+1;
      }
    } // End If
    // Chiude il file
    FileOutputStream fileOut = new FileOutputStream(CPLib.LRTrim(cNomeFile));
    //write this workbook to an Outputstream.
    wb.write(fileOut);
    fileOut.flush();
    fileOut.close();
    FileLibMit.Close(fhand);
  }
  void TruncTab(String tblname) throws Exception {
    /* tblname Char(9) // nome tabella */
     // * ---truncate
            m_Sql.RequireTransaction();
            m_cServer = m_Ctx.GetServer(tblname);
            m_cPhName = m_Ctx.GetPhName(tblname);
            m_oWrInfo = CPPhTableWrInfo.GetCPPhTableWrInfo(m_Ctx,tblname,m_Ctx.GetCompany());
            m_oParameters = CPLib.GetParamsForSqlUpdate(m_cServer);
            m_cSql = CPLib.GetSQLPrefixComment("arrt_chkdiana_all",613,"0000003C")+"truncate "+m_oWrInfo.GetTableWriteName();
            m_nUpdatedRows = m_Sql.Update(m_cServer,m_cSql,m_oParameters);
            if (CPLib.lt(m_nUpdatedRows,0)) {
              m_Sql.AbortTransaction();
            }
            m_Sql.CompleteTransaction();
            m_cLastMsgError = m_Sql.TransactionErrorMessage();
            if (CPLib.ne(m_cLastMsgError,"")) {
              m_bError = true;
            }
  }
  void DatiSoggetto() throws Exception {
    CPResultSet Cursor_wersonbo=null;
    try {
      /* cStringa Memo // Stringa di ritorno */
      /* _numsto Char(15) */
      /* _ramate Char(3) */
      /* _tipsot Char(1) */
      /* _dataope Date */
      java.sql.Date _dataope;
      _dataope = CPLib.NullDate();
      /* Verifica il tipo riga */
      /* cStringa := '' // Stringa di ritorno */
      cStringa = "";
      /* _dataope := iif(pSTATO='1',pDatRet,pDatOpe) */
      _dataope = (CPLib.eqr(pSTATO,"1")?pDatRet:pDatOpe);
      /* _numsto := '' */
      _numsto = "";
      // * --- Select from wersonbo
      m_cServer = m_Ctx.GetServer("wersonbo");
      m_cPhName = m_Ctx.GetPhName("wersonbo");
      if (Cursor_wersonbo!=null)
        Cursor_wersonbo.Close();
      Cursor_wersonbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select sanumpro,datamodi  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CONNES="+CPSql.SQLValueAdapter(CPLib.ToSQL(pCli,"?",0,0,m_cServer, m_oParameters),m_cServer,pCli)+" "+")"+(m_Ctx.IsSharedTemp("wersonbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1")+" order by "+"datamodi desc,sanumpro ",m_cServer,m_Ctx,true));
      while ( ! (Cursor_wersonbo.Eof())) {
        /* If wersonbo->datamodi > _dataope */
        if (CPLib.gt(Cursor_wersonbo.GetDate("datamodi"),_dataope)) {
          /* _numsto := wersonbo->sanumpro */
          _numsto = Cursor_wersonbo.GetString("sanumpro");
        } else { // Else
          // Exit Loop
          if (true) {
            break;
          }
        } // End If
        Cursor_wersonbo.Next();
      }
      m_cConnectivityError = Cursor_wersonbo.ErrorMessage();
      Cursor_wersonbo.Close();
      // * --- End Select
      /* If _usemc=1 */
      if (CPLib.eqr(_usemc,1)) {
        /* Exec "Soggetti da MC" Page 19:SoggettiMC */
        SoggettiMC();
      } else { // Else
        /* Exec "Soggetti da DB" Page 20:SoggettiDB */
        SoggettiDB();
      } // End If
      /* _note := _note + cStringa */
      _note = _note+cStringa;
    } finally {
      try {
        if (Cursor_wersonbo!=null)
          Cursor_wersonbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
    }
  }
  void SoggettiMC() throws Exception {
    /* Case pTipoR='2' or pTipoR='7' */
    if (CPLib.eqr(pTipoR,"2") || CPLib.eqr(pTipoR,"7")) {
      /* Record Tipo 2 */
      /* cStringa := cStringa + Left(LRTrim(pCli)+Space(16),16) */
      cStringa = cStringa+CPLib.Left(CPLib.LRTrim(pCli)+CPLib.Space(16),16);
      /* If Empty(LRTrim(_numsto)) */
      if (CPLib.Empty(CPLib.LRTrim(_numsto))) {
        /* If mcPersonbo.GoToKey(LRTrim(pCli)) */
        if (mcPersonbo.GoToKey(CPLib.LRTrim(pCli))) {
          /* _tipsot := '' */
          _tipsot = "";
          /* If mcStgru.GoToKey(mcPersonbo.SOTGRUP) */
          if (mcStgru.GoToKey(mcPersonbo.row.SOTGRUP)) {
            /* _tipsot := mcStgru.TIPOSOT */
            _tipsot = mcStgru.row.TIPOSOT;
          } // End If
          /* _ramate := iif(pRAE='R',LRTrim(mcPersonbo.RAMOGRUP),iif(Left(mcPersonbo.ATTIV,1)='P' or Left(mcPersonbo.ATTIV,3)='999',Space(3),Left(LRTrim(mcPersonbo.ATTIV),3))) */
          _ramate = (CPLib.eqr(pRAE,"R")?CPLib.LRTrim(mcPersonbo.row.RAMOGRUP):(CPLib.eqr(CPLib.Left(mcPersonbo.row.ATTIV,1),"P") || CPLib.eqr(CPLib.Left(mcPersonbo.row.ATTIV,3),"999")?CPLib.Space(3):CPLib.Left(CPLib.LRTrim(mcPersonbo.row.ATTIV),3)));
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.RAGSOC)+Space(70),70) + Left(LRTrim(mcPersonbo.PAESE)+Space(3),3) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.RAGSOC)+CPLib.Space(70),70)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.PAESE)+CPLib.Space(3),3);
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.CODCAB)+Space(6),6) + Left(LRTrim(mcPersonbo.DESCCIT)+Space(30),30) + Left(LRTrim(mcPersonbo.PROVINCIA)+Space(2),2) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.CODCAB)+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.DESCCIT)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.PROVINCIA)+CPLib.Space(2),2);
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.DOMICILIO)+Space(35),35) + Left(LRTrim(mcPersonbo.CAP)+ Space(5),5) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.DOMICILIO)+CPLib.Space(35),35)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.CAP)+CPLib.Space(5),5);
          /* cStringa := cStringa + iif(mcPersonbo.CFESTERO=1,Space(16),Left(LRTrim(mcPersonbo.CODFISC)+Space(16),16)) */
          cStringa = cStringa+(CPLib.eqr(mcPersonbo.row.CFESTERO,1)?CPLib.Space(16):CPLib.Left(CPLib.LRTrim(mcPersonbo.row.CODFISC)+CPLib.Space(16),16));
          /* If Empty(mcPersonbo.DATANASC) or DateToChar(mcPersonbo.DATANASC)='01000101' */
          if (CPLib.Empty(mcPersonbo.row.DATANASC) || CPLib.eqr(CPLib.DateToChar(mcPersonbo.row.DATANASC),"01000101")) {
            /* cStringa := cStringa + Space(8) */
            cStringa = cStringa+CPLib.Space(8);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(DateToChar(mcPersonbo.DATANASC))+Space(8),8) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(mcPersonbo.row.DATANASC))+CPLib.Space(8),8);
          } // End If
          /* If not(Empty(mcPersonbo.NASSTATO)) */
          if ( ! (CPLib.Empty(mcPersonbo.row.NASSTATO))) {
            /* cStringa := cStringa + Left(LRTrim(mcPersonbo.NASSTATO)+Space(30),30) + Left(LRTrim(mcPersonbo.SOTGRUP)+Space(3),3) + iif(_tipsot='1',Left(LRTrim(_ramate)+Space(3),3),Space(3)) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.NASSTATO)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.SOTGRUP)+CPLib.Space(3),3)+(CPLib.eqr(_tipsot,"1")?CPLib.Left(CPLib.LRTrim(_ramate)+CPLib.Space(3),3):CPLib.Space(3));
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(mcPersonbo.NASCOMUN)+Space(30),30) + Left(LRTrim(mcPersonbo.SOTGRUP)+Space(3),3) + iif(_tipsot='1',Left(LRTrim(_ramate)+Space(3),3),Space(3)) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.NASCOMUN)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.SOTGRUP)+CPLib.Space(3),3)+(CPLib.eqr(_tipsot,"1")?CPLib.Left(CPLib.LRTrim(_ramate)+CPLib.Space(3),3):CPLib.Space(3));
          } // End If
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.SETTSINT)+Space(3),3) + Left(LRTrim(pRap)+Space(25),25) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.SETTSINT)+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(pRap)+CPLib.Space(25),25);
          /* cStringa := cStringa + Left(LRTrim(pTRap)+" ",1) + Left(LRTrim(mcPersonbo.TIPODOC)+Space(2),2) + Left(LRTrim(mcPersonbo.NUMDOCUM)+Space(15),15) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(pTRap)+" ",1)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.TIPODOC)+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.NUMDOCUM)+CPLib.Space(15),15);
          /* If Empty(mcPersonbo.DATARILASC) or DateToChar(mcPersonbo.DATARILASC)='01000101' */
          if (CPLib.Empty(mcPersonbo.row.DATARILASC) || CPLib.eqr(CPLib.DateToChar(mcPersonbo.row.DATARILASC),"01000101")) {
            /* cStringa := cStringa + Space(8) */
            cStringa = cStringa+CPLib.Space(8);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(DateToChar(mcPersonbo.DATARILASC))+Space(8),8)  */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(mcPersonbo.row.DATARILASC))+CPLib.Space(8),8);
          } // End If
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.AUTRILASC)+Space(30),30) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.AUTRILASC)+CPLib.Space(30),30);
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.SESSO)+" ",1) + Space(22) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.SESSO)+" ",1)+CPLib.Space(22);
          /* cStringa := cStringa + iif(not(Empty(mcPersonbo.DATAVALI)),DateToChar(mcPersonbo.DATAVALI),Space(8)) */
          cStringa = cStringa+( ! (CPLib.Empty(mcPersonbo.row.DATAVALI))?CPLib.DateToChar(mcPersonbo.row.DATAVALI):CPLib.Space(8));
          /* cStringa := cStringa + iif(mcPersonbo.CFESTERO=1,'NOCF',Space(4)) */
          cStringa = cStringa+(CPLib.eqr(mcPersonbo.row.CFESTERO,1)?"NOCF":CPLib.Space(4));
        } // End If
      } else { // Else
        /* If mcWersonbo.GoToKey(_numsto) */
        if (mcWersonbo.GoToKey(_numsto)) {
          /* _ramate := iif(pRAE='R',LRTrim(mcWersonbo.RAMOGRUP),iif(Left(mcWersonbo.ATTIV,1)='P' or Left(mcWersonbo.ATTIV,3)='999',Space(3),Left(LRTrim(mcWersonbo.ATTIV),3))) */
          _ramate = (CPLib.eqr(pRAE,"R")?CPLib.LRTrim(mcWersonbo.row.RAMOGRUP):(CPLib.eqr(CPLib.Left(mcWersonbo.row.ATTIV,1),"P") || CPLib.eqr(CPLib.Left(mcWersonbo.row.ATTIV,3),"999")?CPLib.Space(3):CPLib.Left(CPLib.LRTrim(mcWersonbo.row.ATTIV),3)));
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.RAGSOC)+Space(70),70) + Left(LRTrim(mcWersonbo.PAESE)+Space(3),3) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.RAGSOC)+CPLib.Space(70),70)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.PAESE)+CPLib.Space(3),3);
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.CODCAB)+Space(6),6) + Left(LRTrim(mcWersonbo.DESCCIT)+Space(30),30) + Left(LRTrim(mcWersonbo.PROVINCIA)+Space(2),2) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.CODCAB)+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.DESCCIT)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.PROVINCIA)+CPLib.Space(2),2);
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.DOMICILIO)+Space(35),35) + Left(LRTrim(mcWersonbo.CAP)+ Space(5),5) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.DOMICILIO)+CPLib.Space(35),35)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.CAP)+CPLib.Space(5),5);
          /* cStringa := cStringa + iif(mcWersonbo.CFESTERO=1,Space(16),Left(LRTrim(mcWersonbo.CODFISC)+Space(16),16)) */
          cStringa = cStringa+(CPLib.eqr(mcWersonbo.row.CFESTERO,1)?CPLib.Space(16):CPLib.Left(CPLib.LRTrim(mcWersonbo.row.CODFISC)+CPLib.Space(16),16));
          /* If Empty(mcWersonbo.DATANASC) or DateToChar(mcWersonbo.DATANASC)='01000101' */
          if (CPLib.Empty(mcWersonbo.row.DATANASC) || CPLib.eqr(CPLib.DateToChar(mcWersonbo.row.DATANASC),"01000101")) {
            /* cStringa := cStringa + Space(8) */
            cStringa = cStringa+CPLib.Space(8);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(DateToChar(mcWersonbo.DATANASC))+Space(8),8) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(mcWersonbo.row.DATANASC))+CPLib.Space(8),8);
          } // End If
          /* If not(Empty(mcWersonbo.NASSTATO)) */
          if ( ! (CPLib.Empty(mcWersonbo.row.NASSTATO))) {
            /* cStringa := cStringa + Left(LRTrim(mcWersonbo.NASSTATO)+Space(30),30) + Left(LRTrim(mcWersonbo.SOTGRUP)+Space(3),3) + Left(LRTrim(_ramate)+Space(3),3) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.NASSTATO)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.SOTGRUP)+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(_ramate)+CPLib.Space(3),3);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(mcWersonbo.NASCOMUN)+Space(30),30) + Left(LRTrim(mcWersonbo.SOTGRUP)+Space(3),3) + Left(LRTrim(_ramate)+Space(3),3) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.NASCOMUN)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.SOTGRUP)+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(_ramate)+CPLib.Space(3),3);
          } // End If
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.SETTSINT)+Space(3),3) + Left(LRTrim(pRap)+Space(25),25) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.SETTSINT)+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(pRap)+CPLib.Space(25),25);
          /* cStringa := cStringa + Left(LRTrim(pTRap)+" ",1) + Left(LRTrim(mcWersonbo.TIPODOC)+Space(2),2) + Left(LRTrim(mcWersonbo.NUMDOCUM)+Space(15),15) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(pTRap)+" ",1)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.TIPODOC)+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.NUMDOCUM)+CPLib.Space(15),15);
          /* If Empty(mcWersonbo.DATARILASC) or DateToChar(mcWersonbo.DATARILASC)='01000101' */
          if (CPLib.Empty(mcWersonbo.row.DATARILASC) || CPLib.eqr(CPLib.DateToChar(mcWersonbo.row.DATARILASC),"01000101")) {
            /* cStringa := cStringa + Space(8) */
            cStringa = cStringa+CPLib.Space(8);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(DateToChar(mcWersonbo.DATARILASC))+Space(8),8)  */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(mcWersonbo.row.DATARILASC))+CPLib.Space(8),8);
          } // End If
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.AUTRILASC)+Space(30),30) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.AUTRILASC)+CPLib.Space(30),30);
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.SESSO)+" ",1) + Space(22) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.SESSO)+" ",1)+CPLib.Space(22);
          /* cStringa := cStringa + iif(not(Empty(mcWersonbo.DATAVALI)),DateToChar(mcWersonbo.DATAVALI),Space(8)) */
          cStringa = cStringa+( ! (CPLib.Empty(mcWersonbo.row.DATAVALI))?CPLib.DateToChar(mcWersonbo.row.DATAVALI):CPLib.Space(8));
          /* cStringa := cStringa + iif(mcWersonbo.CFESTERO=1,'NOCF',Space(4)) */
          cStringa = cStringa+(CPLib.eqr(mcWersonbo.row.CFESTERO,1)?"NOCF":CPLib.Space(4));
        } // End If
      } // End If
      /* Case pTipoR='3' */
    } else if (CPLib.eqr(pTipoR,"3")) {
      /* Record Tipo 3 */
      /* cStringa := cStringa + Left(LRTrim(pCli)+Space(16),16) */
      cStringa = cStringa+CPLib.Left(CPLib.LRTrim(pCli)+CPLib.Space(16),16);
      /* If Empty(LRTrim(_numsto)) */
      if (CPLib.Empty(CPLib.LRTrim(_numsto))) {
        /* If mcPersonbo.GoToKey(LRTrim(pCli)) */
        if (mcPersonbo.GoToKey(CPLib.LRTrim(pCli))) {
          /* _tipsot := '' */
          _tipsot = "";
          /* If mcStgru.GoToKey(mcPersonbo.SOTGRUP) */
          if (mcStgru.GoToKey(mcPersonbo.row.SOTGRUP)) {
            /* _tipsot := mcStgru.TIPOSOT */
            _tipsot = mcStgru.row.TIPOSOT;
          } // End If
          /* _ramate := iif(pRAE='R',LRTrim(mcPersonbo.RAMOGRUP),iif(Left(mcPersonbo.ATTIV,1)='P' or Left(mcPersonbo.ATTIV,3)='999',Space(3),Left(LRTrim(mcPersonbo.ATTIV),3))) */
          _ramate = (CPLib.eqr(pRAE,"R")?CPLib.LRTrim(mcPersonbo.row.RAMOGRUP):(CPLib.eqr(CPLib.Left(mcPersonbo.row.ATTIV,1),"P") || CPLib.eqr(CPLib.Left(mcPersonbo.row.ATTIV,3),"999")?CPLib.Space(3):CPLib.Left(CPLib.LRTrim(mcPersonbo.row.ATTIV),3)));
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.RAGSOC)+Space(70),70) + Left(LRTrim(mcPersonbo.PAESE)+Space(3),3) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.RAGSOC)+CPLib.Space(70),70)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.PAESE)+CPLib.Space(3),3);
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.CODCAB)+Space(6),6) + Left(LRTrim(mcPersonbo.DESCCIT)+Space(30),30) + Left(LRTrim(mcPersonbo.PROVINCIA)+Space(2),2) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.CODCAB)+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.DESCCIT)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.PROVINCIA)+CPLib.Space(2),2);
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.DOMICILIO)+Space(35),35) + Left(LRTrim(mcPersonbo.CAP)+ Space(5),5) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.DOMICILIO)+CPLib.Space(35),35)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.CAP)+CPLib.Space(5),5);
          /* cStringa := cStringa + iif(mcPersonbo.CFESTERO=1,Space(16),Left(LRTrim(mcPersonbo.CODFISC)+Space(16),16)) */
          cStringa = cStringa+(CPLib.eqr(mcPersonbo.row.CFESTERO,1)?CPLib.Space(16):CPLib.Left(CPLib.LRTrim(mcPersonbo.row.CODFISC)+CPLib.Space(16),16));
          /* If Empty(mcPersonbo.DATANASC) or DateToChar(mcPersonbo.DATANASC)='01000101' */
          if (CPLib.Empty(mcPersonbo.row.DATANASC) || CPLib.eqr(CPLib.DateToChar(mcPersonbo.row.DATANASC),"01000101")) {
            /* cStringa := cStringa + Space(8) */
            cStringa = cStringa+CPLib.Space(8);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(DateToChar(mcPersonbo.DATANASC))+Space(8),8) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(mcPersonbo.row.DATANASC))+CPLib.Space(8),8);
          } // End If
          /* If not(Empty(mcPersonbo.NASSTATO)) */
          if ( ! (CPLib.Empty(mcPersonbo.row.NASSTATO))) {
            /* cStringa := cStringa + Left(LRTrim(mcPersonbo.NASSTATO)+Space(30),30) + Left(LRTrim(mcPersonbo.SOTGRUP)+Space(3),3) + iif(_tipsot='1',Left(LRTrim(_ramate)+Space(3),3),Space(3)) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.NASSTATO)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.SOTGRUP)+CPLib.Space(3),3)+(CPLib.eqr(_tipsot,"1")?CPLib.Left(CPLib.LRTrim(_ramate)+CPLib.Space(3),3):CPLib.Space(3));
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(mcPersonbo.NASCOMUN)+Space(30),30) + Left(LRTrim(mcPersonbo.SOTGRUP)+Space(3),3) + iif(_tipsot='1',Left(LRTrim(_ramate)+Space(3),3),Space(3)) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.NASCOMUN)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.SOTGRUP)+CPLib.Space(3),3)+(CPLib.eqr(_tipsot,"1")?CPLib.Left(CPLib.LRTrim(_ramate)+CPLib.Space(3),3):CPLib.Space(3));
          } // End If
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.SETTSINT)+Space(3),3) + Left(LRTrim(pRap)+Space(25),25) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.SETTSINT)+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(pRap)+CPLib.Space(25),25);
          /* cStringa := cStringa + Left(LRTrim(pTRap)+" ",1) + Left(LRTrim(mcPersonbo.TIPODOC)+Space(2),2) + Left(LRTrim(mcPersonbo.NUMDOCUM)+Space(15),15) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(pTRap)+" ",1)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.TIPODOC)+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.NUMDOCUM)+CPLib.Space(15),15);
          /* If Empty(mcPersonbo.DATARILASC) or DateToChar(mcPersonbo.DATARILASC)='01000101' */
          if (CPLib.Empty(mcPersonbo.row.DATARILASC) || CPLib.eqr(CPLib.DateToChar(mcPersonbo.row.DATARILASC),"01000101")) {
            /* cStringa := cStringa + Space(8) */
            cStringa = cStringa+CPLib.Space(8);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(DateToChar(mcPersonbo.DATARILASC))+Space(8),8)  */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(mcPersonbo.row.DATARILASC))+CPLib.Space(8),8);
          } // End If
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.AUTRILASC)+Space(30),30) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.AUTRILASC)+CPLib.Space(30),30);
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.SESSO)+" ",1) + Space(22) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.SESSO)+" ",1)+CPLib.Space(22);
          /* cStringa := cStringa + iif(not(Empty(mcPersonbo.DATAVALI)),DateToChar(mcPersonbo.DATAVALI),Space(8)) */
          cStringa = cStringa+( ! (CPLib.Empty(mcPersonbo.row.DATAVALI))?CPLib.DateToChar(mcPersonbo.row.DATAVALI):CPLib.Space(8));
          /* cStringa := cStringa + iif(mcPersonbo.CFESTERO=1,'NOCF',Space(4)) */
          cStringa = cStringa+(CPLib.eqr(mcPersonbo.row.CFESTERO,1)?"NOCF":CPLib.Space(4));
        } // End If
      } else { // Else
        /* If mcWersonbo.GoToKey(_numsto) */
        if (mcWersonbo.GoToKey(_numsto)) {
          /* _ramate := iif(pRAE='R',LRTrim(mcWersonbo.RAMOGRUP),iif(Left(mcWersonbo.ATTIV,1)='P' or Left(mcWersonbo.ATTIV,3)='999',Space(3),Left(LRTrim(mcWersonbo.ATTIV),3))) */
          _ramate = (CPLib.eqr(pRAE,"R")?CPLib.LRTrim(mcWersonbo.row.RAMOGRUP):(CPLib.eqr(CPLib.Left(mcWersonbo.row.ATTIV,1),"P") || CPLib.eqr(CPLib.Left(mcWersonbo.row.ATTIV,3),"999")?CPLib.Space(3):CPLib.Left(CPLib.LRTrim(mcWersonbo.row.ATTIV),3)));
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.RAGSOC)+Space(70),70) + Left(LRTrim(mcWersonbo.PAESE)+Space(3),3) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.RAGSOC)+CPLib.Space(70),70)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.PAESE)+CPLib.Space(3),3);
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.CODCAB)+Space(6),6) + Left(LRTrim(mcWersonbo.DESCCIT)+Space(30),30) + Left(LRTrim(mcWersonbo.PROVINCIA)+Space(2),2) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.CODCAB)+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.DESCCIT)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.PROVINCIA)+CPLib.Space(2),2);
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.DOMICILIO)+Space(35),35) + Left(LRTrim(mcWersonbo.CAP)+ Space(5),5) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.DOMICILIO)+CPLib.Space(35),35)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.CAP)+CPLib.Space(5),5);
          /* cStringa := cStringa + iif(mcWersonbo.CFESTERO=1,Space(16),Left(LRTrim(mcWersonbo.CODFISC)+Space(16),16)) */
          cStringa = cStringa+(CPLib.eqr(mcWersonbo.row.CFESTERO,1)?CPLib.Space(16):CPLib.Left(CPLib.LRTrim(mcWersonbo.row.CODFISC)+CPLib.Space(16),16));
          /* If Empty(mcWersonbo.DATANASC) or DateToChar(mcWersonbo.DATANASC)='01000101' */
          if (CPLib.Empty(mcWersonbo.row.DATANASC) || CPLib.eqr(CPLib.DateToChar(mcWersonbo.row.DATANASC),"01000101")) {
            /* cStringa := cStringa + Space(8) */
            cStringa = cStringa+CPLib.Space(8);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(DateToChar(mcWersonbo.DATANASC))+Space(8),8) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(mcWersonbo.row.DATANASC))+CPLib.Space(8),8);
          } // End If
          /* If not(Empty(mcWersonbo.NASSTATO)) */
          if ( ! (CPLib.Empty(mcWersonbo.row.NASSTATO))) {
            /* cStringa := cStringa + Left(LRTrim(mcWersonbo.NASSTATO)+Space(30),30) + Left(LRTrim(mcWersonbo.SOTGRUP)+Space(3),3) + Left(LRTrim(_ramate)+Space(3),3) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.NASSTATO)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.SOTGRUP)+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(_ramate)+CPLib.Space(3),3);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(mcWersonbo.NASCOMUN)+Space(30),30) + Left(LRTrim(mcWersonbo.SOTGRUP)+Space(3),3) + Left(LRTrim(_ramate)+Space(3),3) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.NASCOMUN)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.SOTGRUP)+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(_ramate)+CPLib.Space(3),3);
          } // End If
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.SETTSINT)+Space(3),3) + Left(LRTrim(pRap)+Space(25),25) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.SETTSINT)+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(pRap)+CPLib.Space(25),25);
          /* cStringa := cStringa + Left(LRTrim(pTRap)+" ",1) + Left(LRTrim(mcWersonbo.TIPODOC)+Space(2),2) + Left(LRTrim(mcWersonbo.NUMDOCUM)+Space(15),15) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(pTRap)+" ",1)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.TIPODOC)+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.NUMDOCUM)+CPLib.Space(15),15);
          /* If Empty(mcWersonbo.DATARILASC) or DateToChar(mcWersonbo.DATARILASC)='01000101' */
          if (CPLib.Empty(mcWersonbo.row.DATARILASC) || CPLib.eqr(CPLib.DateToChar(mcWersonbo.row.DATARILASC),"01000101")) {
            /* cStringa := cStringa + Space(8) */
            cStringa = cStringa+CPLib.Space(8);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(DateToChar(mcWersonbo.DATARILASC))+Space(8),8)  */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(mcWersonbo.row.DATARILASC))+CPLib.Space(8),8);
          } // End If
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.AUTRILASC)+Space(30),30) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.AUTRILASC)+CPLib.Space(30),30);
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.SESSO)+" ",1) + Space(22) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.SESSO)+" ",1)+CPLib.Space(22);
          /* cStringa := cStringa + iif(not(Empty(mcWersonbo.DATAVALI)),DateToChar(mcWersonbo.DATAVALI),Space(8)) */
          cStringa = cStringa+( ! (CPLib.Empty(mcWersonbo.row.DATAVALI))?CPLib.DateToChar(mcWersonbo.row.DATAVALI):CPLib.Space(8));
          /* cStringa := cStringa + iif(mcWersonbo.CFESTERO=1,'NOCF',Space(4)) */
          cStringa = cStringa+(CPLib.eqr(mcWersonbo.row.CFESTERO,1)?"NOCF":CPLib.Space(4));
        } // End If
      } // End If
      /* Case pTipoR='4' or pTipoR='8' */
    } else if (CPLib.eqr(pTipoR,"4") || CPLib.eqr(pTipoR,"8")) {
      /* Record Tipo 4-8 */
      /* cStringa := cStringa + Left(LRTrim(pCli)+Space(16),16) */
      cStringa = cStringa+CPLib.Left(CPLib.LRTrim(pCli)+CPLib.Space(16),16);
      /* If Empty(LRTrim(_numsto)) */
      if (CPLib.Empty(CPLib.LRTrim(_numsto))) {
        /* If mcPersonbo.GoToKey(LRTrim(pCli)) */
        if (mcPersonbo.GoToKey(CPLib.LRTrim(pCli))) {
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.RAGSOC)+Space(70),70) + Left(LRTrim(mcPersonbo.PAESE)+Space(3),3) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.RAGSOC)+CPLib.Space(70),70)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.PAESE)+CPLib.Space(3),3);
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.CODCAB)+Space(6),6) + Left(LRTrim(mcPersonbo.DESCCIT)+Space(30),30) + Left(LRTrim(mcPersonbo.PROVINCIA)+Space(2),2) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.CODCAB)+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.DESCCIT)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.PROVINCIA)+CPLib.Space(2),2);
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.DOMICILIO)+Space(35),35) + Left(LRTrim(mcPersonbo.CAP)+ Space(5),5) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.DOMICILIO)+CPLib.Space(35),35)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.CAP)+CPLib.Space(5),5);
          /* cStringa := cStringa + iif(mcPersonbo.CFESTERO=1,Space(16),Left(LRTrim(mcPersonbo.CODFISC)+Space(16),16)) */
          cStringa = cStringa+(CPLib.eqr(mcPersonbo.row.CFESTERO,1)?CPLib.Space(16):CPLib.Left(CPLib.LRTrim(mcPersonbo.row.CODFISC)+CPLib.Space(16),16));
          /* If Empty(mcPersonbo.DATANASC) or DateToChar(mcPersonbo.DATANASC)='01000101' */
          if (CPLib.Empty(mcPersonbo.row.DATANASC) || CPLib.eqr(CPLib.DateToChar(mcPersonbo.row.DATANASC),"01000101")) {
            /* cStringa := cStringa + Space(8) */
            cStringa = cStringa+CPLib.Space(8);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(DateToChar(mcPersonbo.DATANASC))+Space(8),8) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(mcPersonbo.row.DATANASC))+CPLib.Space(8),8);
          } // End If
          /* If not(Empty(mcPersonbo.NASSTATO)) */
          if ( ! (CPLib.Empty(mcPersonbo.row.NASSTATO))) {
            /* cStringa := cStringa + Left(LRTrim(mcPersonbo.NASSTATO)+Space(30),30) + Space(35) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.NASSTATO)+CPLib.Space(30),30)+CPLib.Space(35);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(mcPersonbo.NASCOMUN)+Space(30),30) + Space(35) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.NASCOMUN)+CPLib.Space(30),30)+CPLib.Space(35);
          } // End If
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.TIPODOC)+Space(2),2) + Left(LRTrim(mcPersonbo.NUMDOCUM)+Space(15),15) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.TIPODOC)+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.NUMDOCUM)+CPLib.Space(15),15);
          /* If Empty(mcPersonbo.DATARILASC) or DateToChar(mcPersonbo.DATARILASC)='01000101' */
          if (CPLib.Empty(mcPersonbo.row.DATARILASC) || CPLib.eqr(CPLib.DateToChar(mcPersonbo.row.DATARILASC),"01000101")) {
            /* cStringa := cStringa + Space(8) */
            cStringa = cStringa+CPLib.Space(8);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(DateToChar(mcPersonbo.DATARILASC))+Space(8),8)  */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(mcPersonbo.row.DATARILASC))+CPLib.Space(8),8);
          } // End If
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.AUTRILASC)+Space(30),30) + Left(LRTrim(mcPersonbo.SESSO)+" ",1) + Space(22) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.AUTRILASC)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.SESSO)+" ",1)+CPLib.Space(22);
          /* cStringa := cStringa + iif(not(Empty(mcPersonbo.DATAVALI)),DateToChar(mcPersonbo.DATAVALI),Space(8)) */
          cStringa = cStringa+( ! (CPLib.Empty(mcPersonbo.row.DATAVALI))?CPLib.DateToChar(mcPersonbo.row.DATAVALI):CPLib.Space(8));
          /* cStringa := cStringa + iif(mcPersonbo.CFESTERO=1,'NOCF',Space(4)) */
          cStringa = cStringa+(CPLib.eqr(mcPersonbo.row.CFESTERO,1)?"NOCF":CPLib.Space(4));
        } // End If
      } else { // Else
        /* If mcWersonbo.GoToKey(_numsto) */
        if (mcWersonbo.GoToKey(_numsto)) {
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.RAGSOC)+Space(70),70) + Left(LRTrim(mcWersonbo.PAESE)+Space(3),3) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.RAGSOC)+CPLib.Space(70),70)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.PAESE)+CPLib.Space(3),3);
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.CODCAB)+Space(6),6) + Left(LRTrim(mcWersonbo.DESCCIT)+Space(30),30) + Left(LRTrim(mcWersonbo.PROVINCIA)+Space(2),2) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.CODCAB)+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.DESCCIT)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.PROVINCIA)+CPLib.Space(2),2);
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.DOMICILIO)+Space(35),35) + Left(LRTrim(mcWersonbo.CAP)+ Space(5),5) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.DOMICILIO)+CPLib.Space(35),35)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.CAP)+CPLib.Space(5),5);
          /* cStringa := cStringa + iif(mcWersonbo.CFESTERO=1,Space(16),Left(LRTrim(mcWersonbo.CODFISC)+Space(16),16)) */
          cStringa = cStringa+(CPLib.eqr(mcWersonbo.row.CFESTERO,1)?CPLib.Space(16):CPLib.Left(CPLib.LRTrim(mcWersonbo.row.CODFISC)+CPLib.Space(16),16));
          /* If Empty(mcWersonbo.DATANASC) or DateToChar(mcWersonbo.DATANASC)='01000101' */
          if (CPLib.Empty(mcWersonbo.row.DATANASC) || CPLib.eqr(CPLib.DateToChar(mcWersonbo.row.DATANASC),"01000101")) {
            /* cStringa := cStringa + Space(8) */
            cStringa = cStringa+CPLib.Space(8);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(DateToChar(mcWersonbo.DATANASC))+Space(8),8) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(mcWersonbo.row.DATANASC))+CPLib.Space(8),8);
          } // End If
          /* If not(Empty(mcWersonbo.NASSTATO)) */
          if ( ! (CPLib.Empty(mcWersonbo.row.NASSTATO))) {
            /* cStringa := cStringa + Left(LRTrim(mcWersonbo.NASSTATO)+Space(30),30) + Space(35) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.NASSTATO)+CPLib.Space(30),30)+CPLib.Space(35);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(mcWersonbo.NASCOMUN)+Space(30),30) + Space(35) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.NASCOMUN)+CPLib.Space(30),30)+CPLib.Space(35);
          } // End If
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.TIPODOC)+Space(2),2) + Left(LRTrim(mcWersonbo.NUMDOCUM)+Space(15),15) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.TIPODOC)+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.NUMDOCUM)+CPLib.Space(15),15);
          /* If Empty(mcWersonbo.DATARILASC) or DateToChar(mcWersonbo.DATARILASC)='01000101' */
          if (CPLib.Empty(mcWersonbo.row.DATARILASC) || CPLib.eqr(CPLib.DateToChar(mcWersonbo.row.DATARILASC),"01000101")) {
            /* cStringa := cStringa + Space(8) */
            cStringa = cStringa+CPLib.Space(8);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(DateToChar(mcWersonbo.DATARILASC))+Space(8),8)  */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(mcWersonbo.row.DATARILASC))+CPLib.Space(8),8);
          } // End If
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.AUTRILASC)+Space(30),30) + Left(LRTrim(mcWersonbo.SESSO)+" ",1) + Space(22) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.AUTRILASC)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.SESSO)+" ",1)+CPLib.Space(22);
          /* cStringa := cStringa + iif(not(Empty(mcWersonbo.DATAVALI)),DateToChar(mcWersonbo.DATAVALI),Space(8)) */
          cStringa = cStringa+( ! (CPLib.Empty(mcWersonbo.row.DATAVALI))?CPLib.DateToChar(mcWersonbo.row.DATAVALI):CPLib.Space(8));
          /* cStringa := cStringa + iif(mcWersonbo.CFESTERO=1,'NOCF',Space(4)) */
          cStringa = cStringa+(CPLib.eqr(mcWersonbo.row.CFESTERO,1)?"NOCF":CPLib.Space(4));
        } // End If
      } // End If
      /* Case pTipoR='6' */
    } else if (CPLib.eqr(pTipoR,"6")) {
      /* Record Tipo 6 */
      /* cStringa := cStringa + Left(LRTrim(pCli)+Space(16),16) */
      cStringa = cStringa+CPLib.Left(CPLib.LRTrim(pCli)+CPLib.Space(16),16);
      /* If Empty(LRTrim(_numsto)) */
      if (CPLib.Empty(CPLib.LRTrim(_numsto))) {
        /* If mcPersonbo.GoToKey(LRTrim(pCli)) */
        if (mcPersonbo.GoToKey(CPLib.LRTrim(pCli))) {
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.RAGSOC)+Space(70),70) + Left(LRTrim(mcPersonbo.PAESE)+Space(3),3) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.RAGSOC)+CPLib.Space(70),70)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.PAESE)+CPLib.Space(3),3);
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.CODCAB)+Space(6),6) + Left(LRTrim(mcPersonbo.DESCCIT)+Space(30),30) + Left(LRTrim(mcPersonbo.PROVINCIA)+Space(2),2) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.CODCAB)+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.DESCCIT)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.PROVINCIA)+CPLib.Space(2),2);
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.DOMICILIO)+Space(35),35) + Left(LRTrim(mcPersonbo.CAP)+ Space(5),5) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.DOMICILIO)+CPLib.Space(35),35)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.CAP)+CPLib.Space(5),5);
          /* cStringa := cStringa + iif(mcPersonbo.CFESTERO=1,Space(16),Left(LRTrim(mcPersonbo.CODFISC)+Space(16),16)) */
          cStringa = cStringa+(CPLib.eqr(mcPersonbo.row.CFESTERO,1)?CPLib.Space(16):CPLib.Left(CPLib.LRTrim(mcPersonbo.row.CODFISC)+CPLib.Space(16),16));
          /* If Empty(mcPersonbo.DATANASC) or DateToChar(mcPersonbo.DATANASC)='01000101' */
          if (CPLib.Empty(mcPersonbo.row.DATANASC) || CPLib.eqr(CPLib.DateToChar(mcPersonbo.row.DATANASC),"01000101")) {
            /* cStringa := cStringa + Space(8) */
            cStringa = cStringa+CPLib.Space(8);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(DateToChar(mcPersonbo.DATANASC))+Space(8),8) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(mcPersonbo.row.DATANASC))+CPLib.Space(8),8);
          } // End If
          /* If not(Empty(mcPersonbo.NASSTATO)) */
          if ( ! (CPLib.Empty(mcPersonbo.row.NASSTATO))) {
            /* cStringa := cStringa + Left(LRTrim(mcPersonbo.NASSTATO)+Space(30),30) + Space(35) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.NASSTATO)+CPLib.Space(30),30)+CPLib.Space(35);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(mcPersonbo.NASCOMUN)+Space(30),30) + Space(35) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.NASCOMUN)+CPLib.Space(30),30)+CPLib.Space(35);
          } // End If
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.TIPODOC)+Space(2),2) + Left(LRTrim(mcPersonbo.NUMDOCUM)+Space(15),15) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.TIPODOC)+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.NUMDOCUM)+CPLib.Space(15),15);
          /* If Empty(mcPersonbo.DATARILASC) or DateToChar(mcPersonbo.DATARILASC)='01000101' */
          if (CPLib.Empty(mcPersonbo.row.DATARILASC) || CPLib.eqr(CPLib.DateToChar(mcPersonbo.row.DATARILASC),"01000101")) {
            /* cStringa := cStringa + Space(8) */
            cStringa = cStringa+CPLib.Space(8);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(DateToChar(mcPersonbo.DATARILASC))+Space(8),8)  */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(mcPersonbo.row.DATARILASC))+CPLib.Space(8),8);
          } // End If
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.AUTRILASC)+Space(30),30) + Left(LRTrim(mcPersonbo.SESSO)+" ",1) + Space(22) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.AUTRILASC)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.SESSO)+" ",1)+CPLib.Space(22);
          /* cStringa := cStringa + iif(not(Empty(mcPersonbo.DATAVALI)),DateToChar(mcPersonbo.DATAVALI),Space(8)) */
          cStringa = cStringa+( ! (CPLib.Empty(mcPersonbo.row.DATAVALI))?CPLib.DateToChar(mcPersonbo.row.DATAVALI):CPLib.Space(8));
          /* cStringa := cStringa + iif(mcPersonbo.CFESTERO=1,'NOCF',Space(4)) */
          cStringa = cStringa+(CPLib.eqr(mcPersonbo.row.CFESTERO,1)?"NOCF":CPLib.Space(4));
        } // End If
      } else { // Else
        /* If mcWersonbo.GoToKey(_numsto) */
        if (mcWersonbo.GoToKey(_numsto)) {
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.RAGSOC)+Space(70),70) + Left(LRTrim(mcWersonbo.PAESE)+Space(3),3) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.RAGSOC)+CPLib.Space(70),70)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.PAESE)+CPLib.Space(3),3);
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.CODCAB)+Space(6),6) + Left(LRTrim(mcWersonbo.DESCCIT)+Space(30),30) + Left(LRTrim(mcWersonbo.PROVINCIA)+Space(2),2) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.CODCAB)+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.DESCCIT)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.PROVINCIA)+CPLib.Space(2),2);
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.DOMICILIO)+Space(35),35) + Left(LRTrim(mcWersonbo.CAP)+ Space(5),5) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.DOMICILIO)+CPLib.Space(35),35)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.CAP)+CPLib.Space(5),5);
          /* cStringa := cStringa + iif(mcWersonbo.CFESTERO=1,Space(16),Left(LRTrim(mcWersonbo.CODFISC)+Space(16),16)) */
          cStringa = cStringa+(CPLib.eqr(mcWersonbo.row.CFESTERO,1)?CPLib.Space(16):CPLib.Left(CPLib.LRTrim(mcWersonbo.row.CODFISC)+CPLib.Space(16),16));
          /* If Empty(mcWersonbo.DATANASC) or DateToChar(mcWersonbo.DATANASC)='01000101' */
          if (CPLib.Empty(mcWersonbo.row.DATANASC) || CPLib.eqr(CPLib.DateToChar(mcWersonbo.row.DATANASC),"01000101")) {
            /* cStringa := cStringa + Space(8) */
            cStringa = cStringa+CPLib.Space(8);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(DateToChar(mcWersonbo.DATANASC))+Space(8),8) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(mcWersonbo.row.DATANASC))+CPLib.Space(8),8);
          } // End If
          /* If not(Empty(mcWersonbo.NASSTATO)) */
          if ( ! (CPLib.Empty(mcWersonbo.row.NASSTATO))) {
            /* cStringa := cStringa + Left(LRTrim(mcWersonbo.NASSTATO)+Space(30),30) + Space(35) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.NASSTATO)+CPLib.Space(30),30)+CPLib.Space(35);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(mcWersonbo.NASCOMUN)+Space(30),30) + Space(35) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.NASCOMUN)+CPLib.Space(30),30)+CPLib.Space(35);
          } // End If
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.TIPODOC)+Space(2),2) + Left(LRTrim(mcWersonbo.NUMDOCUM)+Space(15),15) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.TIPODOC)+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.NUMDOCUM)+CPLib.Space(15),15);
          /* If Empty(mcWersonbo.DATARILASC) or DateToChar(mcWersonbo.DATARILASC)='01000101' */
          if (CPLib.Empty(mcWersonbo.row.DATARILASC) || CPLib.eqr(CPLib.DateToChar(mcWersonbo.row.DATARILASC),"01000101")) {
            /* cStringa := cStringa + Space(8) */
            cStringa = cStringa+CPLib.Space(8);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(DateToChar(mcWersonbo.DATARILASC))+Space(8),8)  */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(mcWersonbo.row.DATARILASC))+CPLib.Space(8),8);
          } // End If
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.AUTRILASC)+Space(30),30) + Left(LRTrim(mcWersonbo.SESSO)+" ",1) + Space(22) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.AUTRILASC)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.SESSO)+" ",1)+CPLib.Space(22);
          /* cStringa := cStringa + iif(not(Empty(mcWersonbo.DATAVALI)),DateToChar(mcWersonbo.DATAVALI),Space(8)) */
          cStringa = cStringa+( ! (CPLib.Empty(mcWersonbo.row.DATAVALI))?CPLib.DateToChar(mcWersonbo.row.DATAVALI):CPLib.Space(8));
          /* cStringa := cStringa + iif(mcWersonbo.CFESTERO=1,'NOCF',Space(4)) */
          cStringa = cStringa+(CPLib.eqr(mcWersonbo.row.CFESTERO,1)?"NOCF":CPLib.Space(4));
        } // End If
      } // End If
      /* Case pTipoR='9' */
    } else if (CPLib.eqr(pTipoR,"9")) {
      /* Record Tipo 9 */
      /* cStringa := cStringa + Left(LRTrim(pCli)+Space(16),16) */
      cStringa = cStringa+CPLib.Left(CPLib.LRTrim(pCli)+CPLib.Space(16),16);
      /* If Empty(LRTrim(_numsto)) */
      if (CPLib.Empty(CPLib.LRTrim(_numsto))) {
        /* If mcPersonbo.GoToKey(LRTrim(pCli)) */
        if (mcPersonbo.GoToKey(CPLib.LRTrim(pCli))) {
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.RAGSOC)+Space(70),70) + Left(LRTrim(mcPersonbo.PAESE)+Space(3),3) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.RAGSOC)+CPLib.Space(70),70)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.PAESE)+CPLib.Space(3),3);
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.CODCAB)+Space(6),6) + Left(LRTrim(mcPersonbo.DESCCIT)+Space(30),30) + Left(LRTrim(mcPersonbo.PROVINCIA)+Space(2),2) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.CODCAB)+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.DESCCIT)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.PROVINCIA)+CPLib.Space(2),2);
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.DOMICILIO)+Space(35),35) + Left(LRTrim(mcPersonbo.CAP)+ Space(5),5) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.DOMICILIO)+CPLib.Space(35),35)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.CAP)+CPLib.Space(5),5);
          /* cStringa := cStringa + iif(mcPersonbo.CFESTERO=1,Space(16),Left(LRTrim(mcPersonbo.CODFISC)+Space(16),16)) */
          cStringa = cStringa+(CPLib.eqr(mcPersonbo.row.CFESTERO,1)?CPLib.Space(16):CPLib.Left(CPLib.LRTrim(mcPersonbo.row.CODFISC)+CPLib.Space(16),16));
          /* If Empty(mcPersonbo.DATANASC) or DateToChar(mcPersonbo.DATANASC)='01000101' */
          if (CPLib.Empty(mcPersonbo.row.DATANASC) || CPLib.eqr(CPLib.DateToChar(mcPersonbo.row.DATANASC),"01000101")) {
            /* cStringa := cStringa + Space(8) */
            cStringa = cStringa+CPLib.Space(8);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(DateToChar(mcPersonbo.DATANASC))+Space(8),8) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(mcPersonbo.row.DATANASC))+CPLib.Space(8),8);
          } // End If
          /* If not(Empty(mcPersonbo.NASSTATO)) */
          if ( ! (CPLib.Empty(mcPersonbo.row.NASSTATO))) {
            /* cStringa := cStringa + Left(LRTrim(mcPersonbo.NASSTATO)+Space(30),30) + Space(35) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.NASSTATO)+CPLib.Space(30),30)+CPLib.Space(35);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(mcPersonbo.NASCOMUN)+Space(30),30) + Space(35) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.NASCOMUN)+CPLib.Space(30),30)+CPLib.Space(35);
          } // End If
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.TIPODOC)+Space(2),2) + Left(LRTrim(mcPersonbo.NUMDOCUM)+Space(15),15) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.TIPODOC)+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.NUMDOCUM)+CPLib.Space(15),15);
          /* If Empty(mcPersonbo.DATARILASC) or DateToChar(mcPersonbo.DATARILASC)='01000101' */
          if (CPLib.Empty(mcPersonbo.row.DATARILASC) || CPLib.eqr(CPLib.DateToChar(mcPersonbo.row.DATARILASC),"01000101")) {
            /* cStringa := cStringa + Space(8) */
            cStringa = cStringa+CPLib.Space(8);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(DateToChar(mcPersonbo.DATARILASC))+Space(8),8)  */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(mcPersonbo.row.DATARILASC))+CPLib.Space(8),8);
          } // End If
          /* cStringa := cStringa + Left(LRTrim(mcPersonbo.AUTRILASC)+Space(30),30) + Left(LRTrim(mcPersonbo.SESSO)+" ",1) + Space(22) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.AUTRILASC)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcPersonbo.row.SESSO)+" ",1)+CPLib.Space(22);
          /* cStringa := cStringa + iif(not(Empty(mcPersonbo.DATAVALI)),DateToChar(mcPersonbo.DATAVALI),Space(8)) */
          cStringa = cStringa+( ! (CPLib.Empty(mcPersonbo.row.DATAVALI))?CPLib.DateToChar(mcPersonbo.row.DATAVALI):CPLib.Space(8));
          /* cStringa := cStringa + iif(mcPersonbo.CFESTERO=1,'NOCF',Space(4)) */
          cStringa = cStringa+(CPLib.eqr(mcPersonbo.row.CFESTERO,1)?"NOCF":CPLib.Space(4));
        } // End If
      } else { // Else
        /* If mcWersonbo.GoToKey(_numsto) */
        if (mcWersonbo.GoToKey(_numsto)) {
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.RAGSOC)+Space(70),70) + Left(LRTrim(mcWersonbo.PAESE)+Space(3),3) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.RAGSOC)+CPLib.Space(70),70)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.PAESE)+CPLib.Space(3),3);
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.CODCAB)+Space(6),6) + Left(LRTrim(mcWersonbo.DESCCIT)+Space(30),30) + Left(LRTrim(mcWersonbo.PROVINCIA)+Space(2),2) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.CODCAB)+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.DESCCIT)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.PROVINCIA)+CPLib.Space(2),2);
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.DOMICILIO)+Space(35),35) + Left(LRTrim(mcWersonbo.CAP)+ Space(5),5) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.DOMICILIO)+CPLib.Space(35),35)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.CAP)+CPLib.Space(5),5);
          /* cStringa := cStringa + iif(mcWersonbo.CFESTERO=1,Space(16),Left(LRTrim(mcWersonbo.CODFISC)+Space(16),16)) */
          cStringa = cStringa+(CPLib.eqr(mcWersonbo.row.CFESTERO,1)?CPLib.Space(16):CPLib.Left(CPLib.LRTrim(mcWersonbo.row.CODFISC)+CPLib.Space(16),16));
          /* If Empty(mcWersonbo.DATANASC) or DateToChar(mcWersonbo.DATANASC)='01000101' */
          if (CPLib.Empty(mcWersonbo.row.DATANASC) || CPLib.eqr(CPLib.DateToChar(mcWersonbo.row.DATANASC),"01000101")) {
            /* cStringa := cStringa + Space(8) */
            cStringa = cStringa+CPLib.Space(8);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(DateToChar(mcWersonbo.DATANASC))+Space(8),8) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(mcWersonbo.row.DATANASC))+CPLib.Space(8),8);
          } // End If
          /* If not(Empty(mcWersonbo.NASSTATO)) */
          if ( ! (CPLib.Empty(mcWersonbo.row.NASSTATO))) {
            /* cStringa := cStringa + Left(LRTrim(mcWersonbo.NASSTATO)+Space(30),30) + Space(35) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.NASSTATO)+CPLib.Space(30),30)+CPLib.Space(35);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(mcWersonbo.NASCOMUN)+Space(30),30) + Space(35) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.NASCOMUN)+CPLib.Space(30),30)+CPLib.Space(35);
          } // End If
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.TIPODOC)+Space(2),2) + Left(LRTrim(mcWersonbo.NUMDOCUM)+Space(15),15) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.TIPODOC)+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.NUMDOCUM)+CPLib.Space(15),15);
          /* If Empty(mcWersonbo.DATARILASC) or DateToChar(mcWersonbo.DATARILASC)='01000101' */
          if (CPLib.Empty(mcWersonbo.row.DATARILASC) || CPLib.eqr(CPLib.DateToChar(mcWersonbo.row.DATARILASC),"01000101")) {
            /* cStringa := cStringa + Space(8) */
            cStringa = cStringa+CPLib.Space(8);
          } else { // Else
            /* cStringa := cStringa + Left(LRTrim(DateToChar(mcWersonbo.DATARILASC))+Space(8),8)  */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(mcWersonbo.row.DATARILASC))+CPLib.Space(8),8);
          } // End If
          /* cStringa := cStringa + Left(LRTrim(mcWersonbo.AUTRILASC)+Space(30),30) + Left(LRTrim(mcWersonbo.SESSO)+" ",1) + Space(22) */
          cStringa = cStringa+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.AUTRILASC)+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(mcWersonbo.row.SESSO)+" ",1)+CPLib.Space(22);
          /* cStringa := cStringa + iif(not(Empty(mcWersonbo.DATAVALI)),DateToChar(mcWersonbo.DATAVALI),Space(8)) */
          cStringa = cStringa+( ! (CPLib.Empty(mcWersonbo.row.DATAVALI))?CPLib.DateToChar(mcWersonbo.row.DATAVALI):CPLib.Space(8));
          /* cStringa := cStringa + iif(mcWersonbo.CFESTERO=1,'NOCF',Space(4)) */
          cStringa = cStringa+(CPLib.eqr(mcWersonbo.row.CFESTERO,1)?"NOCF":CPLib.Space(4));
        } // End If
      } // End If
    } // End Case
  }
  void SoggettiDB() throws Exception {
    CPResultSet Cursor_personbo=null;
    CPResultSet Cursor_wersonbo=null;
    try {
      /* Case pTipoR='2' or pTipoR='7' */
      if (CPLib.eqr(pTipoR,"2") || CPLib.eqr(pTipoR,"7")) {
        /* Record Tipo 2 */
        /* cStringa := cStringa + Left(LRTrim(pCli)+Space(16),16) */
        cStringa = cStringa+CPLib.Left(CPLib.LRTrim(pCli)+CPLib.Space(16),16);
        /* If Empty(LRTrim(_numsto)) */
        if (CPLib.Empty(CPLib.LRTrim(_numsto))) {
          // * --- Select from personbo
          m_cServer = m_Ctx.GetServer("personbo");
          m_cPhName = m_Ctx.GetPhName("personbo");
          if (Cursor_personbo!=null)
            Cursor_personbo.Close();
          Cursor_personbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CONNES="+CPSql.SQLValueAdapter(CPLib.ToSQL(CPLib.LRTrim(pCli),"?",0,0,m_cServer, m_oParameters),m_cServer,CPLib.LRTrim(pCli))+" "+")"+(m_Ctx.IsSharedTemp("personbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
          while ( ! (Cursor_personbo.Eof())) {
            /* _tipsot := '' */
            _tipsot = "";
            /* If mcStgru.GoToKey(personbo->SOTGRUP) */
            if (mcStgru.GoToKey(Cursor_personbo.GetString("SOTGRUP"))) {
              /* _tipsot := mcStgru.TIPOSOT */
              _tipsot = mcStgru.row.TIPOSOT;
            } // End If
            /* _ramate := iif(pRAE='R',LRTrim(personbo->RAMOGRUP),iif(Left(personbo->ATTIV,1)='P' or Left(personbo->ATTIV,3)='999',Space(3),Left(LRTrim(personbo->ATTIV),3))) */
            _ramate = (CPLib.eqr(pRAE,"R")?CPLib.LRTrim(Cursor_personbo.GetString("RAMOGRUP")):(CPLib.eqr(CPLib.Left(Cursor_personbo.GetString("ATTIV"),1),"P") || CPLib.eqr(CPLib.Left(Cursor_personbo.GetString("ATTIV"),3),"999")?CPLib.Space(3):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("ATTIV")),3)));
            /* cStringa := cStringa + Left(LRTrim(personbo->RAGSOC)+Space(70),70) + Left(LRTrim(personbo->PAESE)+Space(3),3) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("RAGSOC"))+CPLib.Space(70),70)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PAESE"))+CPLib.Space(3),3);
            /* cStringa := cStringa + Left(LRTrim(personbo->CODCAB)+Space(6),6) + Left(LRTrim(personbo->DESCCIT)+Space(30),30) + Left(LRTrim(personbo->PROVINCIA)+Space(2),2) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CODCAB"))+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DESCCIT"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PROVINCIA"))+CPLib.Space(2),2);
            /* cStringa := cStringa + Left(LRTrim(personbo->DOMICILIO)+Space(35),35) + Left(LRTrim(personbo->CAP)+ Space(5),5) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DOMICILIO"))+CPLib.Space(35),35)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CAP"))+CPLib.Space(5),5);
            /* cStringa := cStringa + iif(personbo->CFESTERO=1,Space(16),Left(LRTrim(personbo->CODFISC)+Space(16),16)) */
            cStringa = cStringa+(CPLib.eqr(Cursor_personbo.GetDouble("CFESTERO"),1)?CPLib.Space(16):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CODFISC"))+CPLib.Space(16),16));
            /* If Empty(personbo->DATANASC) or DateToChar(personbo->DATANASC)='01000101' */
            if (CPLib.Empty(Cursor_personbo.GetDate("DATANASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_personbo.GetDate("DATANASC")),"01000101")) {
              /* cStringa := cStringa + Space(8) */
              cStringa = cStringa+CPLib.Space(8);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(DateToChar(personbo->DATANASC))+Space(8),8) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_personbo.GetDate("DATANASC")))+CPLib.Space(8),8);
            } // End If
            /* If not(Empty(personbo->NASSTATO)) */
            if ( ! (CPLib.Empty(Cursor_personbo.GetString("NASSTATO")))) {
              /* cStringa := cStringa + Left(LRTrim(personbo->NASSTATO)+Space(30),30) + Left(LRTrim(personbo->SOTGRUP)+Space(3),3) + iif(_tipsot='1',Left(LRTrim(_ramate)+Space(3),3),Space(3)) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("NASSTATO"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("SOTGRUP"))+CPLib.Space(3),3)+(CPLib.eqr(_tipsot,"1")?CPLib.Left(CPLib.LRTrim(_ramate)+CPLib.Space(3),3):CPLib.Space(3));
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(personbo->NASCOMUN)+Space(30),30) + Left(LRTrim(personbo->SOTGRUP)+Space(3),3) + iif(_tipsot='1',Left(LRTrim(_ramate)+Space(3),3),Space(3)) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("NASCOMUN"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("SOTGRUP"))+CPLib.Space(3),3)+(CPLib.eqr(_tipsot,"1")?CPLib.Left(CPLib.LRTrim(_ramate)+CPLib.Space(3),3):CPLib.Space(3));
            } // End If
            /* cStringa := cStringa + Left(LRTrim(personbo->SETTSINT)+Space(3),3) + Left(LRTrim(pRap)+Space(25),25) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("SETTSINT"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(pRap)+CPLib.Space(25),25);
            /* cStringa := cStringa + Left(LRTrim(pTRap)+" ",1) + Left(LRTrim(personbo->TIPODOC)+Space(2),2) + Left(LRTrim(personbo->NUMDOCUM)+Space(15),15) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(pTRap)+" ",1)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("TIPODOC"))+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("NUMDOCUM"))+CPLib.Space(15),15);
            /* If Empty(personbo->DATARILASC) or DateToChar(personbo->DATARILASC)='01000101' */
            if (CPLib.Empty(Cursor_personbo.GetDate("DATARILASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_personbo.GetDate("DATARILASC")),"01000101")) {
              /* cStringa := cStringa + Space(8) */
              cStringa = cStringa+CPLib.Space(8);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(DateToChar(personbo->DATARILASC))+Space(8),8)  */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_personbo.GetDate("DATARILASC")))+CPLib.Space(8),8);
            } // End If
            /* cStringa := cStringa + Left(LRTrim(personbo->AUTRILASC)+Space(30),30) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("AUTRILASC"))+CPLib.Space(30),30);
            /* cStringa := cStringa + Left(LRTrim(personbo->SESSO)+" ",1) + Space(22) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("SESSO"))+" ",1)+CPLib.Space(22);
            /* cStringa := cStringa + iif(not(Empty(personbo->DATAVALI)),DateToChar(personbo->DATAVALI),Space(8)) */
            cStringa = cStringa+( ! (CPLib.Empty(Cursor_personbo.GetDate("DATAVALI")))?CPLib.DateToChar(Cursor_personbo.GetDate("DATAVALI")):CPLib.Space(8));
            /* cStringa := cStringa + iif(personbo->CFESTERO=1,'NOCF',Space(4)) */
            cStringa = cStringa+(CPLib.eqr(Cursor_personbo.GetDouble("CFESTERO"),1)?"NOCF":CPLib.Space(4));
            Cursor_personbo.Next();
          }
          m_cConnectivityError = Cursor_personbo.ErrorMessage();
          Cursor_personbo.Close();
          // * --- End Select
        } else { // Else
          // * --- Select from wersonbo
          m_cServer = m_Ctx.GetServer("wersonbo");
          m_cPhName = m_Ctx.GetPhName("wersonbo");
          if (Cursor_wersonbo!=null)
            Cursor_wersonbo.Close();
          Cursor_wersonbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"sanumpro="+CPSql.SQLValueAdapter(CPLib.ToSQL(_numsto,"?",0,0,m_cServer, m_oParameters),m_cServer,_numsto)+" "+")"+(m_Ctx.IsSharedTemp("wersonbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
          while ( ! (Cursor_wersonbo.Eof())) {
            /* _ramate := iif(pRAE='R',LRTrim(wersonbo->RAMOGRUP),iif(Left(wersonbo->ATTIV,1)='P' or Left(wersonbo->ATTIV,3)='999',Space(3),Left(LRTrim(wersonbo->ATTIV),3))) */
            _ramate = (CPLib.eqr(pRAE,"R")?CPLib.LRTrim(Cursor_wersonbo.GetString("RAMOGRUP")):(CPLib.eqr(CPLib.Left(Cursor_wersonbo.GetString("ATTIV"),1),"P") || CPLib.eqr(CPLib.Left(Cursor_wersonbo.GetString("ATTIV"),3),"999")?CPLib.Space(3):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("ATTIV")),3)));
            /* cStringa := cStringa + Left(LRTrim(wersonbo->RAGSOC)+Space(70),70) + Left(LRTrim(wersonbo->PAESE)+Space(3),3) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("RAGSOC"))+CPLib.Space(70),70)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PAESE"))+CPLib.Space(3),3);
            /* cStringa := cStringa + Left(LRTrim(wersonbo->CODCAB)+Space(6),6) + Left(LRTrim(wersonbo->DESCCIT)+Space(30),30) + Left(LRTrim(wersonbo->PROVINCIA)+Space(2),2) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CODCAB"))+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DESCCIT"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PROVINCIA"))+CPLib.Space(2),2);
            /* cStringa := cStringa + Left(LRTrim(wersonbo->DOMICILIO)+Space(35),35) + Left(LRTrim(wersonbo->CAP)+ Space(5),5) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DOMICILIO"))+CPLib.Space(35),35)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CAP"))+CPLib.Space(5),5);
            /* cStringa := cStringa + iif(wersonbo->CFESTERO=1,Space(16),Left(LRTrim(wersonbo->CODFISC)+Space(16),16)) */
            cStringa = cStringa+(CPLib.eqr(Cursor_wersonbo.GetDouble("CFESTERO"),1)?CPLib.Space(16):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CODFISC"))+CPLib.Space(16),16));
            /* If Empty(wersonbo->DATANASC) or DateToChar(wersonbo->DATANASC)='01000101' */
            if (CPLib.Empty(Cursor_wersonbo.GetDate("DATANASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_wersonbo.GetDate("DATANASC")),"01000101")) {
              /* cStringa := cStringa + Space(8) */
              cStringa = cStringa+CPLib.Space(8);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(DateToChar(wersonbo->DATANASC))+Space(8),8) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_wersonbo.GetDate("DATANASC")))+CPLib.Space(8),8);
            } // End If
            /* If not(Empty(wersonbo->NASSTATO)) */
            if ( ! (CPLib.Empty(Cursor_wersonbo.GetString("NASSTATO")))) {
              /* cStringa := cStringa + Left(LRTrim(wersonbo->NASSTATO)+Space(30),30) + Left(LRTrim(wersonbo->SOTGRUP)+Space(3),3) + Left(LRTrim(_ramate)+Space(3),3) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("NASSTATO"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("SOTGRUP"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(_ramate)+CPLib.Space(3),3);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(wersonbo->NASCOMUN)+Space(30),30) + Left(LRTrim(wersonbo->SOTGRUP)+Space(3),3) + Left(LRTrim(_ramate)+Space(3),3) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("NASCOMUN"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("SOTGRUP"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(_ramate)+CPLib.Space(3),3);
            } // End If
            /* cStringa := cStringa + Left(LRTrim(wersonbo->SETTSINT)+Space(3),3) + Left(LRTrim(pRap)+Space(25),25) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("SETTSINT"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(pRap)+CPLib.Space(25),25);
            /* cStringa := cStringa + Left(LRTrim(pTRap)+" ",1) + Left(LRTrim(wersonbo->TIPODOC)+Space(2),2) + Left(LRTrim(wersonbo->NUMDOCUM)+Space(15),15) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(pTRap)+" ",1)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("TIPODOC"))+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("NUMDOCUM"))+CPLib.Space(15),15);
            /* If Empty(wersonbo->DATARILASC) or DateToChar(wersonbo->DATARILASC)='01000101' */
            if (CPLib.Empty(Cursor_wersonbo.GetDate("DATARILASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_wersonbo.GetDate("DATARILASC")),"01000101")) {
              /* cStringa := cStringa + Space(8) */
              cStringa = cStringa+CPLib.Space(8);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(DateToChar(wersonbo->DATARILASC))+Space(8),8)  */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_wersonbo.GetDate("DATARILASC")))+CPLib.Space(8),8);
            } // End If
            /* cStringa := cStringa + Left(LRTrim(wersonbo->AUTRILASC)+Space(30),30) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("AUTRILASC"))+CPLib.Space(30),30);
            /* cStringa := cStringa + Left(LRTrim(wersonbo->SESSO)+" ",1) + Space(22) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("SESSO"))+" ",1)+CPLib.Space(22);
            /* cStringa := cStringa + iif(not(Empty(wersonbo->DATAVALI)),DateToChar(wersonbo->DATAVALI),Space(8)) */
            cStringa = cStringa+( ! (CPLib.Empty(Cursor_wersonbo.GetDate("DATAVALI")))?CPLib.DateToChar(Cursor_wersonbo.GetDate("DATAVALI")):CPLib.Space(8));
            /* cStringa := cStringa + iif(wersonbo->CFESTERO=1,'NOCF',Space(4)) */
            cStringa = cStringa+(CPLib.eqr(Cursor_wersonbo.GetDouble("CFESTERO"),1)?"NOCF":CPLib.Space(4));
            Cursor_wersonbo.Next();
          }
          m_cConnectivityError = Cursor_wersonbo.ErrorMessage();
          Cursor_wersonbo.Close();
          // * --- End Select
        } // End If
        /* Case pTipoR='3' */
      } else if (CPLib.eqr(pTipoR,"3")) {
        /* Record Tipo 3 */
        /* cStringa := cStringa + Left(LRTrim(pCli)+Space(16),16) */
        cStringa = cStringa+CPLib.Left(CPLib.LRTrim(pCli)+CPLib.Space(16),16);
        /* If Empty(LRTrim(_numsto)) */
        if (CPLib.Empty(CPLib.LRTrim(_numsto))) {
          // * --- Select from personbo
          m_cServer = m_Ctx.GetServer("personbo");
          m_cPhName = m_Ctx.GetPhName("personbo");
          if (Cursor_personbo!=null)
            Cursor_personbo.Close();
          Cursor_personbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CONNES="+CPSql.SQLValueAdapter(CPLib.ToSQL(CPLib.LRTrim(pCli),"?",0,0,m_cServer, m_oParameters),m_cServer,CPLib.LRTrim(pCli))+" "+")"+(m_Ctx.IsSharedTemp("personbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
          while ( ! (Cursor_personbo.Eof())) {
            /* _tipsot := '' */
            _tipsot = "";
            /* If mcStgru.GoToKey(personbo->SOTGRUP) */
            if (mcStgru.GoToKey(Cursor_personbo.GetString("SOTGRUP"))) {
              /* _tipsot := mcStgru.TIPOSOT */
              _tipsot = mcStgru.row.TIPOSOT;
            } // End If
            /* _ramate := iif(pRAE='R',LRTrim(personbo->RAMOGRUP),iif(Left(personbo->ATTIV,1)='P' or Left(personbo->ATTIV,3)='999',Space(3),Left(LRTrim(personbo->ATTIV),3))) */
            _ramate = (CPLib.eqr(pRAE,"R")?CPLib.LRTrim(Cursor_personbo.GetString("RAMOGRUP")):(CPLib.eqr(CPLib.Left(Cursor_personbo.GetString("ATTIV"),1),"P") || CPLib.eqr(CPLib.Left(Cursor_personbo.GetString("ATTIV"),3),"999")?CPLib.Space(3):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("ATTIV")),3)));
            /* cStringa := cStringa + Left(LRTrim(personbo->RAGSOC)+Space(70),70) + Left(LRTrim(personbo->PAESE)+Space(3),3) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("RAGSOC"))+CPLib.Space(70),70)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PAESE"))+CPLib.Space(3),3);
            /* cStringa := cStringa + Left(LRTrim(personbo->CODCAB)+Space(6),6) + Left(LRTrim(personbo->DESCCIT)+Space(30),30) + Left(LRTrim(personbo->PROVINCIA)+Space(2),2) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CODCAB"))+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DESCCIT"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PROVINCIA"))+CPLib.Space(2),2);
            /* cStringa := cStringa + Left(LRTrim(personbo->DOMICILIO)+Space(35),35) + Left(LRTrim(personbo->CAP)+ Space(5),5) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DOMICILIO"))+CPLib.Space(35),35)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CAP"))+CPLib.Space(5),5);
            /* cStringa := cStringa + iif(personbo->CFESTERO=1,Space(16),Left(LRTrim(personbo->CODFISC)+Space(16),16)) */
            cStringa = cStringa+(CPLib.eqr(Cursor_personbo.GetDouble("CFESTERO"),1)?CPLib.Space(16):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CODFISC"))+CPLib.Space(16),16));
            /* If Empty(personbo->DATANASC) or DateToChar(personbo->DATANASC)='01000101' */
            if (CPLib.Empty(Cursor_personbo.GetDate("DATANASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_personbo.GetDate("DATANASC")),"01000101")) {
              /* cStringa := cStringa + Space(8) */
              cStringa = cStringa+CPLib.Space(8);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(DateToChar(personbo->DATANASC))+Space(8),8) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_personbo.GetDate("DATANASC")))+CPLib.Space(8),8);
            } // End If
            /* If not(Empty(personbo->NASSTATO)) */
            if ( ! (CPLib.Empty(Cursor_personbo.GetString("NASSTATO")))) {
              /* cStringa := cStringa + Left(LRTrim(personbo->NASSTATO)+Space(30),30) + Left(LRTrim(personbo->SOTGRUP)+Space(3),3) + iif(_tipsot='1',Left(LRTrim(_ramate)+Space(3),3),Space(3)) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("NASSTATO"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("SOTGRUP"))+CPLib.Space(3),3)+(CPLib.eqr(_tipsot,"1")?CPLib.Left(CPLib.LRTrim(_ramate)+CPLib.Space(3),3):CPLib.Space(3));
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(personbo->NASCOMUN)+Space(30),30) + Left(LRTrim(personbo->SOTGRUP)+Space(3),3) + iif(_tipsot='1',Left(LRTrim(_ramate)+Space(3),3),Space(3)) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("NASCOMUN"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("SOTGRUP"))+CPLib.Space(3),3)+(CPLib.eqr(_tipsot,"1")?CPLib.Left(CPLib.LRTrim(_ramate)+CPLib.Space(3),3):CPLib.Space(3));
            } // End If
            /* cStringa := cStringa + Left(LRTrim(personbo->SETTSINT)+Space(3),3) + Left(LRTrim(pRap)+Space(25),25) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("SETTSINT"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(pRap)+CPLib.Space(25),25);
            /* cStringa := cStringa + Left(LRTrim(pTRap)+" ",1) + Left(LRTrim(personbo->TIPODOC)+Space(2),2) + Left(LRTrim(personbo->NUMDOCUM)+Space(15),15) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(pTRap)+" ",1)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("TIPODOC"))+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("NUMDOCUM"))+CPLib.Space(15),15);
            /* If Empty(personbo->DATARILASC) or DateToChar(personbo->DATARILASC)='01000101' */
            if (CPLib.Empty(Cursor_personbo.GetDate("DATARILASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_personbo.GetDate("DATARILASC")),"01000101")) {
              /* cStringa := cStringa + Space(8) */
              cStringa = cStringa+CPLib.Space(8);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(DateToChar(personbo->DATARILASC))+Space(8),8)  */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_personbo.GetDate("DATARILASC")))+CPLib.Space(8),8);
            } // End If
            /* cStringa := cStringa + Left(LRTrim(personbo->AUTRILASC)+Space(30),30) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("AUTRILASC"))+CPLib.Space(30),30);
            /* cStringa := cStringa + Left(LRTrim(personbo->SESSO)+" ",1) + Space(22) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("SESSO"))+" ",1)+CPLib.Space(22);
            /* cStringa := cStringa + iif(not(Empty(personbo->DATAVALI)),DateToChar(personbo->DATAVALI),Space(8)) */
            cStringa = cStringa+( ! (CPLib.Empty(Cursor_personbo.GetDate("DATAVALI")))?CPLib.DateToChar(Cursor_personbo.GetDate("DATAVALI")):CPLib.Space(8));
            /* cStringa := cStringa + iif(personbo->CFESTERO=1,'NOCF',Space(4)) */
            cStringa = cStringa+(CPLib.eqr(Cursor_personbo.GetDouble("CFESTERO"),1)?"NOCF":CPLib.Space(4));
            Cursor_personbo.Next();
          }
          m_cConnectivityError = Cursor_personbo.ErrorMessage();
          Cursor_personbo.Close();
          // * --- End Select
        } else { // Else
          // * --- Select from wersonbo
          m_cServer = m_Ctx.GetServer("wersonbo");
          m_cPhName = m_Ctx.GetPhName("wersonbo");
          if (Cursor_wersonbo!=null)
            Cursor_wersonbo.Close();
          Cursor_wersonbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"sanumpro="+CPSql.SQLValueAdapter(CPLib.ToSQL(_numsto,"?",0,0,m_cServer, m_oParameters),m_cServer,_numsto)+" "+")"+(m_Ctx.IsSharedTemp("wersonbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
          while ( ! (Cursor_wersonbo.Eof())) {
            /* _ramate := iif(pRAE='R',LRTrim(wersonbo->RAMOGRUP),iif(Left(wersonbo->ATTIV,1)='P' or Left(wersonbo->ATTIV,3)='999',Space(3),Left(LRTrim(wersonbo->ATTIV),3))) */
            _ramate = (CPLib.eqr(pRAE,"R")?CPLib.LRTrim(Cursor_wersonbo.GetString("RAMOGRUP")):(CPLib.eqr(CPLib.Left(Cursor_wersonbo.GetString("ATTIV"),1),"P") || CPLib.eqr(CPLib.Left(Cursor_wersonbo.GetString("ATTIV"),3),"999")?CPLib.Space(3):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("ATTIV")),3)));
            /* cStringa := cStringa + Left(LRTrim(wersonbo->RAGSOC)+Space(70),70) + Left(LRTrim(wersonbo->PAESE)+Space(3),3) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("RAGSOC"))+CPLib.Space(70),70)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PAESE"))+CPLib.Space(3),3);
            /* cStringa := cStringa + Left(LRTrim(wersonbo->CODCAB)+Space(6),6) + Left(LRTrim(wersonbo->DESCCIT)+Space(30),30) + Left(LRTrim(wersonbo->PROVINCIA)+Space(2),2) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CODCAB"))+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DESCCIT"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PROVINCIA"))+CPLib.Space(2),2);
            /* cStringa := cStringa + Left(LRTrim(wersonbo->DOMICILIO)+Space(35),35) + Left(LRTrim(wersonbo->CAP)+ Space(5),5) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DOMICILIO"))+CPLib.Space(35),35)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CAP"))+CPLib.Space(5),5);
            /* cStringa := cStringa + iif(wersonbo->CFESTERO=1,Space(16),Left(LRTrim(wersonbo->CODFISC)+Space(16),16)) */
            cStringa = cStringa+(CPLib.eqr(Cursor_wersonbo.GetDouble("CFESTERO"),1)?CPLib.Space(16):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CODFISC"))+CPLib.Space(16),16));
            /* If Empty(wersonbo->DATANASC) or DateToChar(wersonbo->DATANASC)='01000101' */
            if (CPLib.Empty(Cursor_wersonbo.GetDate("DATANASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_wersonbo.GetDate("DATANASC")),"01000101")) {
              /* cStringa := cStringa + Space(8) */
              cStringa = cStringa+CPLib.Space(8);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(DateToChar(wersonbo->DATANASC))+Space(8),8) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_wersonbo.GetDate("DATANASC")))+CPLib.Space(8),8);
            } // End If
            /* If not(Empty(wersonbo->NASSTATO)) */
            if ( ! (CPLib.Empty(Cursor_wersonbo.GetString("NASSTATO")))) {
              /* cStringa := cStringa + Left(LRTrim(wersonbo->NASSTATO)+Space(30),30) + Left(LRTrim(wersonbo->SOTGRUP)+Space(3),3) + Left(LRTrim(_ramate)+Space(3),3) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("NASSTATO"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("SOTGRUP"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(_ramate)+CPLib.Space(3),3);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(wersonbo->NASCOMUN)+Space(30),30) + Left(LRTrim(wersonbo->SOTGRUP)+Space(3),3) + Left(LRTrim(_ramate)+Space(3),3) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("NASCOMUN"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("SOTGRUP"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(_ramate)+CPLib.Space(3),3);
            } // End If
            /* cStringa := cStringa + Left(LRTrim(wersonbo->SETTSINT)+Space(3),3) + Left(LRTrim(pRap)+Space(25),25) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("SETTSINT"))+CPLib.Space(3),3)+CPLib.Left(CPLib.LRTrim(pRap)+CPLib.Space(25),25);
            /* cStringa := cStringa + Left(LRTrim(pTRap)+" ",1) + Left(LRTrim(wersonbo->TIPODOC)+Space(2),2) + Left(LRTrim(wersonbo->NUMDOCUM)+Space(15),15) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(pTRap)+" ",1)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("TIPODOC"))+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("NUMDOCUM"))+CPLib.Space(15),15);
            /* If Empty(wersonbo->DATARILASC) or DateToChar(wersonbo->DATARILASC)='01000101' */
            if (CPLib.Empty(Cursor_wersonbo.GetDate("DATARILASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_wersonbo.GetDate("DATARILASC")),"01000101")) {
              /* cStringa := cStringa + Space(8) */
              cStringa = cStringa+CPLib.Space(8);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(DateToChar(wersonbo->DATARILASC))+Space(8),8)  */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_wersonbo.GetDate("DATARILASC")))+CPLib.Space(8),8);
            } // End If
            /* cStringa := cStringa + Left(LRTrim(wersonbo->AUTRILASC)+Space(30),30) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("AUTRILASC"))+CPLib.Space(30),30);
            /* cStringa := cStringa + Left(LRTrim(wersonbo->SESSO)+" ",1) + Space(22) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("SESSO"))+" ",1)+CPLib.Space(22);
            /* cStringa := cStringa + iif(not(Empty(wersonbo->DATAVALI)),DateToChar(wersonbo->DATAVALI),Space(8)) */
            cStringa = cStringa+( ! (CPLib.Empty(Cursor_wersonbo.GetDate("DATAVALI")))?CPLib.DateToChar(Cursor_wersonbo.GetDate("DATAVALI")):CPLib.Space(8));
            /* cStringa := cStringa + iif(wersonbo->CFESTERO=1,'NOCF',Space(4)) */
            cStringa = cStringa+(CPLib.eqr(Cursor_wersonbo.GetDouble("CFESTERO"),1)?"NOCF":CPLib.Space(4));
            Cursor_wersonbo.Next();
          }
          m_cConnectivityError = Cursor_wersonbo.ErrorMessage();
          Cursor_wersonbo.Close();
          // * --- End Select
        } // End If
        /* Case pTipoR='4' or pTipoR='8' */
      } else if (CPLib.eqr(pTipoR,"4") || CPLib.eqr(pTipoR,"8")) {
        /* Record Tipo 4-8 */
        /* cStringa := cStringa + Left(LRTrim(pCli)+Space(16),16) */
        cStringa = cStringa+CPLib.Left(CPLib.LRTrim(pCli)+CPLib.Space(16),16);
        /* If Empty(LRTrim(_numsto)) */
        if (CPLib.Empty(CPLib.LRTrim(_numsto))) {
          // * --- Select from personbo
          m_cServer = m_Ctx.GetServer("personbo");
          m_cPhName = m_Ctx.GetPhName("personbo");
          if (Cursor_personbo!=null)
            Cursor_personbo.Close();
          Cursor_personbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CONNES="+CPSql.SQLValueAdapter(CPLib.ToSQL(CPLib.LRTrim(pCli),"?",0,0,m_cServer, m_oParameters),m_cServer,CPLib.LRTrim(pCli))+" "+")"+(m_Ctx.IsSharedTemp("personbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
          while ( ! (Cursor_personbo.Eof())) {
            /* cStringa := cStringa + Left(LRTrim(personbo->RAGSOC)+Space(70),70) + Left(LRTrim(personbo->PAESE)+Space(3),3) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("RAGSOC"))+CPLib.Space(70),70)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PAESE"))+CPLib.Space(3),3);
            /* cStringa := cStringa + Left(LRTrim(personbo->CODCAB)+Space(6),6) + Left(LRTrim(personbo->DESCCIT)+Space(30),30) + Left(LRTrim(personbo->PROVINCIA)+Space(2),2) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CODCAB"))+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DESCCIT"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PROVINCIA"))+CPLib.Space(2),2);
            /* cStringa := cStringa + Left(LRTrim(personbo->DOMICILIO)+Space(35),35) + Left(LRTrim(personbo->CAP)+ Space(5),5) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DOMICILIO"))+CPLib.Space(35),35)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CAP"))+CPLib.Space(5),5);
            /* cStringa := cStringa + iif(personbo->CFESTERO=1,Space(16),Left(LRTrim(personbo->CODFISC)+Space(16),16)) */
            cStringa = cStringa+(CPLib.eqr(Cursor_personbo.GetDouble("CFESTERO"),1)?CPLib.Space(16):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CODFISC"))+CPLib.Space(16),16));
            /* If Empty(personbo->DATANASC) or DateToChar(personbo->DATANASC)='01000101' */
            if (CPLib.Empty(Cursor_personbo.GetDate("DATANASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_personbo.GetDate("DATANASC")),"01000101")) {
              /* cStringa := cStringa + Space(8) */
              cStringa = cStringa+CPLib.Space(8);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(DateToChar(personbo->DATANASC))+Space(8),8) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_personbo.GetDate("DATANASC")))+CPLib.Space(8),8);
            } // End If
            /* If not(Empty(personbo->NASSTATO)) */
            if ( ! (CPLib.Empty(Cursor_personbo.GetString("NASSTATO")))) {
              /* cStringa := cStringa + Left(LRTrim(personbo->NASSTATO)+Space(30),30) + Space(35) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("NASSTATO"))+CPLib.Space(30),30)+CPLib.Space(35);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(personbo->NASCOMUN)+Space(30),30) + Space(35) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("NASCOMUN"))+CPLib.Space(30),30)+CPLib.Space(35);
            } // End If
            /* cStringa := cStringa + Left(LRTrim(personbo->TIPODOC)+Space(2),2) + Left(LRTrim(personbo->NUMDOCUM)+Space(15),15) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("TIPODOC"))+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("NUMDOCUM"))+CPLib.Space(15),15);
            /* If Empty(personbo->DATARILASC) or DateToChar(personbo->DATARILASC)='01000101' */
            if (CPLib.Empty(Cursor_personbo.GetDate("DATARILASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_personbo.GetDate("DATARILASC")),"01000101")) {
              /* cStringa := cStringa + Space(8) */
              cStringa = cStringa+CPLib.Space(8);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(DateToChar(personbo->DATARILASC))+Space(8),8)  */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_personbo.GetDate("DATARILASC")))+CPLib.Space(8),8);
            } // End If
            /* cStringa := cStringa + Left(LRTrim(personbo->AUTRILASC)+Space(30),30) + Left(LRTrim(personbo->SESSO)+" ",1) + Space(22) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("AUTRILASC"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("SESSO"))+" ",1)+CPLib.Space(22);
            /* cStringa := cStringa + iif(not(Empty(personbo->DATAVALI)),DateToChar(personbo->DATAVALI),Space(8)) */
            cStringa = cStringa+( ! (CPLib.Empty(Cursor_personbo.GetDate("DATAVALI")))?CPLib.DateToChar(Cursor_personbo.GetDate("DATAVALI")):CPLib.Space(8));
            /* cStringa := cStringa + iif(personbo->CFESTERO=1,'NOCF',Space(4)) */
            cStringa = cStringa+(CPLib.eqr(Cursor_personbo.GetDouble("CFESTERO"),1)?"NOCF":CPLib.Space(4));
            Cursor_personbo.Next();
          }
          m_cConnectivityError = Cursor_personbo.ErrorMessage();
          Cursor_personbo.Close();
          // * --- End Select
        } else { // Else
          // * --- Select from wersonbo
          m_cServer = m_Ctx.GetServer("wersonbo");
          m_cPhName = m_Ctx.GetPhName("wersonbo");
          if (Cursor_wersonbo!=null)
            Cursor_wersonbo.Close();
          Cursor_wersonbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"sanumpro="+CPSql.SQLValueAdapter(CPLib.ToSQL(_numsto,"?",0,0,m_cServer, m_oParameters),m_cServer,_numsto)+" "+")"+(m_Ctx.IsSharedTemp("wersonbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
          while ( ! (Cursor_wersonbo.Eof())) {
            /* cStringa := cStringa + Left(LRTrim(wersonbo->RAGSOC)+Space(70),70) + Left(LRTrim(wersonbo->PAESE)+Space(3),3) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("RAGSOC"))+CPLib.Space(70),70)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PAESE"))+CPLib.Space(3),3);
            /* cStringa := cStringa + Left(LRTrim(wersonbo->CODCAB)+Space(6),6) + Left(LRTrim(wersonbo->DESCCIT)+Space(30),30) + Left(LRTrim(wersonbo->PROVINCIA)+Space(2),2) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CODCAB"))+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DESCCIT"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PROVINCIA"))+CPLib.Space(2),2);
            /* cStringa := cStringa + Left(LRTrim(wersonbo->DOMICILIO)+Space(35),35) + Left(LRTrim(wersonbo->CAP)+ Space(5),5) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DOMICILIO"))+CPLib.Space(35),35)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CAP"))+CPLib.Space(5),5);
            /* cStringa := cStringa + iif(wersonbo->CFESTERO=1,Space(16),Left(LRTrim(wersonbo->CODFISC)+Space(16),16)) */
            cStringa = cStringa+(CPLib.eqr(Cursor_wersonbo.GetDouble("CFESTERO"),1)?CPLib.Space(16):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CODFISC"))+CPLib.Space(16),16));
            /* If Empty(wersonbo->DATANASC) or DateToChar(wersonbo->DATANASC)='01000101' */
            if (CPLib.Empty(Cursor_wersonbo.GetDate("DATANASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_wersonbo.GetDate("DATANASC")),"01000101")) {
              /* cStringa := cStringa + Space(8) */
              cStringa = cStringa+CPLib.Space(8);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(DateToChar(wersonbo->DATANASC))+Space(8),8) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_wersonbo.GetDate("DATANASC")))+CPLib.Space(8),8);
            } // End If
            /* If not(Empty(wersonbo->NASSTATO)) */
            if ( ! (CPLib.Empty(Cursor_wersonbo.GetString("NASSTATO")))) {
              /* cStringa := cStringa + Left(LRTrim(wersonbo->NASSTATO)+Space(30),30) + Space(35) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("NASSTATO"))+CPLib.Space(30),30)+CPLib.Space(35);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(wersonbo->NASCOMUN)+Space(30),30) + Space(35) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("NASCOMUN"))+CPLib.Space(30),30)+CPLib.Space(35);
            } // End If
            /* cStringa := cStringa + Left(LRTrim(wersonbo->TIPODOC)+Space(2),2) + Left(LRTrim(wersonbo->NUMDOCUM)+Space(15),15) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("TIPODOC"))+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("NUMDOCUM"))+CPLib.Space(15),15);
            /* If Empty(wersonbo->DATARILASC) or DateToChar(wersonbo->DATARILASC)='01000101' */
            if (CPLib.Empty(Cursor_wersonbo.GetDate("DATARILASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_wersonbo.GetDate("DATARILASC")),"01000101")) {
              /* cStringa := cStringa + Space(8) */
              cStringa = cStringa+CPLib.Space(8);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(DateToChar(wersonbo->DATARILASC))+Space(8),8)  */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_wersonbo.GetDate("DATARILASC")))+CPLib.Space(8),8);
            } // End If
            /* cStringa := cStringa + Left(LRTrim(wersonbo->AUTRILASC)+Space(30),30) + Left(LRTrim(wersonbo->SESSO)+" ",1) + Space(22) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("AUTRILASC"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("SESSO"))+" ",1)+CPLib.Space(22);
            /* cStringa := cStringa + iif(not(Empty(wersonbo->DATAVALI)),DateToChar(wersonbo->DATAVALI),Space(8)) */
            cStringa = cStringa+( ! (CPLib.Empty(Cursor_wersonbo.GetDate("DATAVALI")))?CPLib.DateToChar(Cursor_wersonbo.GetDate("DATAVALI")):CPLib.Space(8));
            /* cStringa := cStringa + iif(wersonbo->CFESTERO=1,'NOCF',Space(4)) */
            cStringa = cStringa+(CPLib.eqr(Cursor_wersonbo.GetDouble("CFESTERO"),1)?"NOCF":CPLib.Space(4));
            Cursor_wersonbo.Next();
          }
          m_cConnectivityError = Cursor_wersonbo.ErrorMessage();
          Cursor_wersonbo.Close();
          // * --- End Select
        } // End If
        /* Case pTipoR='6' */
      } else if (CPLib.eqr(pTipoR,"6")) {
        /* Record Tipo 6 */
        /* cStringa := cStringa + Left(LRTrim(pCli)+Space(16),16) */
        cStringa = cStringa+CPLib.Left(CPLib.LRTrim(pCli)+CPLib.Space(16),16);
        /* If Empty(LRTrim(_numsto)) */
        if (CPLib.Empty(CPLib.LRTrim(_numsto))) {
          // * --- Select from personbo
          m_cServer = m_Ctx.GetServer("personbo");
          m_cPhName = m_Ctx.GetPhName("personbo");
          if (Cursor_personbo!=null)
            Cursor_personbo.Close();
          Cursor_personbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CONNES="+CPSql.SQLValueAdapter(CPLib.ToSQL(CPLib.LRTrim(pCli),"?",0,0,m_cServer, m_oParameters),m_cServer,CPLib.LRTrim(pCli))+" "+")"+(m_Ctx.IsSharedTemp("personbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
          while ( ! (Cursor_personbo.Eof())) {
            /* cStringa := cStringa + Left(LRTrim(personbo->RAGSOC)+Space(70),70) + Left(LRTrim(personbo->PAESE)+Space(3),3) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("RAGSOC"))+CPLib.Space(70),70)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PAESE"))+CPLib.Space(3),3);
            /* cStringa := cStringa + Left(LRTrim(personbo->CODCAB)+Space(6),6) + Left(LRTrim(personbo->DESCCIT)+Space(30),30) + Left(LRTrim(personbo->PROVINCIA)+Space(2),2) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CODCAB"))+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DESCCIT"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PROVINCIA"))+CPLib.Space(2),2);
            /* cStringa := cStringa + Left(LRTrim(personbo->DOMICILIO)+Space(35),35) + Left(LRTrim(personbo->CAP)+ Space(5),5) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DOMICILIO"))+CPLib.Space(35),35)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CAP"))+CPLib.Space(5),5);
            /* cStringa := cStringa + iif(personbo->CFESTERO=1,Space(16),Left(LRTrim(personbo->CODFISC)+Space(16),16)) */
            cStringa = cStringa+(CPLib.eqr(Cursor_personbo.GetDouble("CFESTERO"),1)?CPLib.Space(16):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CODFISC"))+CPLib.Space(16),16));
            /* If Empty(personbo->DATANASC) or DateToChar(personbo->DATANASC)='01000101' */
            if (CPLib.Empty(Cursor_personbo.GetDate("DATANASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_personbo.GetDate("DATANASC")),"01000101")) {
              /* cStringa := cStringa + Space(8) */
              cStringa = cStringa+CPLib.Space(8);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(DateToChar(personbo->DATANASC))+Space(8),8) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_personbo.GetDate("DATANASC")))+CPLib.Space(8),8);
            } // End If
            /* If not(Empty(personbo->NASSTATO)) */
            if ( ! (CPLib.Empty(Cursor_personbo.GetString("NASSTATO")))) {
              /* cStringa := cStringa + Left(LRTrim(personbo->NASSTATO)+Space(30),30) + Space(35) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("NASSTATO"))+CPLib.Space(30),30)+CPLib.Space(35);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(personbo->NASCOMUN)+Space(30),30) + Space(35) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("NASCOMUN"))+CPLib.Space(30),30)+CPLib.Space(35);
            } // End If
            /* cStringa := cStringa + Left(LRTrim(personbo->TIPODOC)+Space(2),2) + Left(LRTrim(personbo->NUMDOCUM)+Space(15),15) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("TIPODOC"))+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("NUMDOCUM"))+CPLib.Space(15),15);
            /* If Empty(personbo->DATARILASC) or DateToChar(personbo->DATARILASC)='01000101' */
            if (CPLib.Empty(Cursor_personbo.GetDate("DATARILASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_personbo.GetDate("DATARILASC")),"01000101")) {
              /* cStringa := cStringa + Space(8) */
              cStringa = cStringa+CPLib.Space(8);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(DateToChar(personbo->DATARILASC))+Space(8),8)  */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_personbo.GetDate("DATARILASC")))+CPLib.Space(8),8);
            } // End If
            /* cStringa := cStringa + Left(LRTrim(personbo->AUTRILASC)+Space(30),30) + Left(LRTrim(personbo->SESSO)+" ",1) + Space(22) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("AUTRILASC"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("SESSO"))+" ",1)+CPLib.Space(22);
            /* cStringa := cStringa + iif(not(Empty(personbo->DATAVALI)),DateToChar(personbo->DATAVALI),Space(8)) */
            cStringa = cStringa+( ! (CPLib.Empty(Cursor_personbo.GetDate("DATAVALI")))?CPLib.DateToChar(Cursor_personbo.GetDate("DATAVALI")):CPLib.Space(8));
            /* cStringa := cStringa + iif(personbo->CFESTERO=1,'NOCF',Space(4)) */
            cStringa = cStringa+(CPLib.eqr(Cursor_personbo.GetDouble("CFESTERO"),1)?"NOCF":CPLib.Space(4));
            Cursor_personbo.Next();
          }
          m_cConnectivityError = Cursor_personbo.ErrorMessage();
          Cursor_personbo.Close();
          // * --- End Select
        } else { // Else
          // * --- Select from wersonbo
          m_cServer = m_Ctx.GetServer("wersonbo");
          m_cPhName = m_Ctx.GetPhName("wersonbo");
          if (Cursor_wersonbo!=null)
            Cursor_wersonbo.Close();
          Cursor_wersonbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"sanumpro="+CPSql.SQLValueAdapter(CPLib.ToSQL(_numsto,"?",0,0,m_cServer, m_oParameters),m_cServer,_numsto)+" "+")"+(m_Ctx.IsSharedTemp("wersonbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
          while ( ! (Cursor_wersonbo.Eof())) {
            /* cStringa := cStringa + Left(LRTrim(wersonbo->RAGSOC)+Space(70),70) + Left(LRTrim(wersonbo->PAESE)+Space(3),3) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("RAGSOC"))+CPLib.Space(70),70)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PAESE"))+CPLib.Space(3),3);
            /* cStringa := cStringa + Left(LRTrim(wersonbo->CODCAB)+Space(6),6) + Left(LRTrim(wersonbo->DESCCIT)+Space(30),30) + Left(LRTrim(wersonbo->PROVINCIA)+Space(2),2) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CODCAB"))+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DESCCIT"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PROVINCIA"))+CPLib.Space(2),2);
            /* cStringa := cStringa + Left(LRTrim(wersonbo->DOMICILIO)+Space(35),35) + Left(LRTrim(wersonbo->CAP)+ Space(5),5) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DOMICILIO"))+CPLib.Space(35),35)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CAP"))+CPLib.Space(5),5);
            /* cStringa := cStringa + iif(wersonbo->CFESTERO=1,Space(16),Left(LRTrim(wersonbo->CODFISC)+Space(16),16)) */
            cStringa = cStringa+(CPLib.eqr(Cursor_wersonbo.GetDouble("CFESTERO"),1)?CPLib.Space(16):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CODFISC"))+CPLib.Space(16),16));
            /* If Empty(wersonbo->DATANASC) or DateToChar(wersonbo->DATANASC)='01000101' */
            if (CPLib.Empty(Cursor_wersonbo.GetDate("DATANASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_wersonbo.GetDate("DATANASC")),"01000101")) {
              /* cStringa := cStringa + Space(8) */
              cStringa = cStringa+CPLib.Space(8);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(DateToChar(wersonbo->DATANASC))+Space(8),8) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_wersonbo.GetDate("DATANASC")))+CPLib.Space(8),8);
            } // End If
            /* If not(Empty(wersonbo->NASSTATO)) */
            if ( ! (CPLib.Empty(Cursor_wersonbo.GetString("NASSTATO")))) {
              /* cStringa := cStringa + Left(LRTrim(wersonbo->NASSTATO)+Space(30),30) + Space(35) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("NASSTATO"))+CPLib.Space(30),30)+CPLib.Space(35);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(wersonbo->NASCOMUN)+Space(30),30) + Space(35) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("NASCOMUN"))+CPLib.Space(30),30)+CPLib.Space(35);
            } // End If
            /* cStringa := cStringa + Left(LRTrim(wersonbo->TIPODOC)+Space(2),2) + Left(LRTrim(wersonbo->NUMDOCUM)+Space(15),15) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("TIPODOC"))+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("NUMDOCUM"))+CPLib.Space(15),15);
            /* If Empty(wersonbo->DATARILASC) or DateToChar(wersonbo->DATARILASC)='01000101' */
            if (CPLib.Empty(Cursor_wersonbo.GetDate("DATARILASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_wersonbo.GetDate("DATARILASC")),"01000101")) {
              /* cStringa := cStringa + Space(8) */
              cStringa = cStringa+CPLib.Space(8);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(DateToChar(wersonbo->DATARILASC))+Space(8),8)  */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_wersonbo.GetDate("DATARILASC")))+CPLib.Space(8),8);
            } // End If
            /* cStringa := cStringa + Left(LRTrim(wersonbo->AUTRILASC)+Space(30),30) + Left(LRTrim(wersonbo->SESSO)+" ",1) + Space(22) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("AUTRILASC"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("SESSO"))+" ",1)+CPLib.Space(22);
            /* cStringa := cStringa + iif(not(Empty(wersonbo->DATAVALI)),DateToChar(wersonbo->DATAVALI),Space(8)) */
            cStringa = cStringa+( ! (CPLib.Empty(Cursor_wersonbo.GetDate("DATAVALI")))?CPLib.DateToChar(Cursor_wersonbo.GetDate("DATAVALI")):CPLib.Space(8));
            /* cStringa := cStringa + iif(wersonbo->CFESTERO=1,'NOCF',Space(4)) */
            cStringa = cStringa+(CPLib.eqr(Cursor_wersonbo.GetDouble("CFESTERO"),1)?"NOCF":CPLib.Space(4));
            Cursor_wersonbo.Next();
          }
          m_cConnectivityError = Cursor_wersonbo.ErrorMessage();
          Cursor_wersonbo.Close();
          // * --- End Select
        } // End If
        /* Case pTipoR='9' */
      } else if (CPLib.eqr(pTipoR,"9")) {
        /* Record Tipo 9 */
        /* cStringa := cStringa + Left(LRTrim(pCli)+Space(16),16) */
        cStringa = cStringa+CPLib.Left(CPLib.LRTrim(pCli)+CPLib.Space(16),16);
        /* If Empty(LRTrim(_numsto)) */
        if (CPLib.Empty(CPLib.LRTrim(_numsto))) {
          // * --- Select from personbo
          m_cServer = m_Ctx.GetServer("personbo");
          m_cPhName = m_Ctx.GetPhName("personbo");
          if (Cursor_personbo!=null)
            Cursor_personbo.Close();
          Cursor_personbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"CONNES="+CPSql.SQLValueAdapter(CPLib.ToSQL(CPLib.LRTrim(pCli),"?",0,0,m_cServer, m_oParameters),m_cServer,CPLib.LRTrim(pCli))+" "+")"+(m_Ctx.IsSharedTemp("personbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
          while ( ! (Cursor_personbo.Eof())) {
            /* cStringa := cStringa + Left(LRTrim(personbo->RAGSOC)+Space(70),70) + Left(LRTrim(personbo->PAESE)+Space(3),3) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("RAGSOC"))+CPLib.Space(70),70)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PAESE"))+CPLib.Space(3),3);
            /* cStringa := cStringa + Left(LRTrim(personbo->CODCAB)+Space(6),6) + Left(LRTrim(personbo->DESCCIT)+Space(30),30) + Left(LRTrim(personbo->PROVINCIA)+Space(2),2) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CODCAB"))+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DESCCIT"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("PROVINCIA"))+CPLib.Space(2),2);
            /* cStringa := cStringa + Left(LRTrim(personbo->DOMICILIO)+Space(35),35) + Left(LRTrim(personbo->CAP)+ Space(5),5) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("DOMICILIO"))+CPLib.Space(35),35)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CAP"))+CPLib.Space(5),5);
            /* cStringa := cStringa + iif(personbo->CFESTERO=1,Space(16),Left(LRTrim(personbo->CODFISC)+Space(16),16)) */
            cStringa = cStringa+(CPLib.eqr(Cursor_personbo.GetDouble("CFESTERO"),1)?CPLib.Space(16):CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("CODFISC"))+CPLib.Space(16),16));
            /* If Empty(personbo->DATANASC) or DateToChar(personbo->DATANASC)='01000101' */
            if (CPLib.Empty(Cursor_personbo.GetDate("DATANASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_personbo.GetDate("DATANASC")),"01000101")) {
              /* cStringa := cStringa + Space(8) */
              cStringa = cStringa+CPLib.Space(8);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(DateToChar(personbo->DATANASC))+Space(8),8) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_personbo.GetDate("DATANASC")))+CPLib.Space(8),8);
            } // End If
            /* If not(Empty(personbo->NASSTATO)) */
            if ( ! (CPLib.Empty(Cursor_personbo.GetString("NASSTATO")))) {
              /* cStringa := cStringa + Left(LRTrim(personbo->NASSTATO)+Space(30),30) + Space(35) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("NASSTATO"))+CPLib.Space(30),30)+CPLib.Space(35);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(personbo->NASCOMUN)+Space(30),30) + Space(35) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("NASCOMUN"))+CPLib.Space(30),30)+CPLib.Space(35);
            } // End If
            /* cStringa := cStringa + Left(LRTrim(personbo->TIPODOC)+Space(2),2) + Left(LRTrim(personbo->NUMDOCUM)+Space(15),15) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("TIPODOC"))+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("NUMDOCUM"))+CPLib.Space(15),15);
            /* If Empty(personbo->DATARILASC) or DateToChar(personbo->DATARILASC)='01000101' */
            if (CPLib.Empty(Cursor_personbo.GetDate("DATARILASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_personbo.GetDate("DATARILASC")),"01000101")) {
              /* cStringa := cStringa + Space(8) */
              cStringa = cStringa+CPLib.Space(8);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(DateToChar(personbo->DATARILASC))+Space(8),8)  */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_personbo.GetDate("DATARILASC")))+CPLib.Space(8),8);
            } // End If
            /* cStringa := cStringa + Left(LRTrim(personbo->AUTRILASC)+Space(30),30) + Left(LRTrim(personbo->SESSO)+" ",1) + Space(22) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("AUTRILASC"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_personbo.GetString("SESSO"))+" ",1)+CPLib.Space(22);
            /* cStringa := cStringa + iif(not(Empty(personbo->DATAVALI)),DateToChar(personbo->DATAVALI),Space(8)) */
            cStringa = cStringa+( ! (CPLib.Empty(Cursor_personbo.GetDate("DATAVALI")))?CPLib.DateToChar(Cursor_personbo.GetDate("DATAVALI")):CPLib.Space(8));
            /* cStringa := cStringa + iif(personbo->CFESTERO=1,'NOCF',Space(4)) */
            cStringa = cStringa+(CPLib.eqr(Cursor_personbo.GetDouble("CFESTERO"),1)?"NOCF":CPLib.Space(4));
            Cursor_personbo.Next();
          }
          m_cConnectivityError = Cursor_personbo.ErrorMessage();
          Cursor_personbo.Close();
          // * --- End Select
        } else { // Else
          // * --- Select from wersonbo
          m_cServer = m_Ctx.GetServer("wersonbo");
          m_cPhName = m_Ctx.GetPhName("wersonbo");
          if (Cursor_wersonbo!=null)
            Cursor_wersonbo.Close();
          Cursor_wersonbo = m_Sql.Query(m_cServer,QueryLoader.SetSqlFunctions("select *  from "+m_cPhName+((m_cPhName).endsWith(CPSecurity.FILTER_QUERY_POSTFIX)?CPLib.NewCPCCCHK():"")+" where "+"("+"sanumpro="+CPSql.SQLValueAdapter(CPLib.ToSQL(_numsto,"?",0,0,m_cServer, m_oParameters),m_cServer,_numsto)+" "+")"+(m_Ctx.IsSharedTemp("wersonbo")?" and context_id='"+m_Ctx.GetTempID()+"'":" and 1=1"),m_cServer,m_Ctx,true));
          while ( ! (Cursor_wersonbo.Eof())) {
            /* cStringa := cStringa + Left(LRTrim(wersonbo->RAGSOC)+Space(70),70) + Left(LRTrim(wersonbo->PAESE)+Space(3),3) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("RAGSOC"))+CPLib.Space(70),70)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PAESE"))+CPLib.Space(3),3);
            /* cStringa := cStringa + Left(LRTrim(wersonbo->CODCAB)+Space(6),6) + Left(LRTrim(wersonbo->DESCCIT)+Space(30),30) + Left(LRTrim(wersonbo->PROVINCIA)+Space(2),2) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CODCAB"))+CPLib.Space(6),6)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DESCCIT"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("PROVINCIA"))+CPLib.Space(2),2);
            /* cStringa := cStringa + Left(LRTrim(wersonbo->DOMICILIO)+Space(35),35) + Left(LRTrim(wersonbo->CAP)+ Space(5),5) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("DOMICILIO"))+CPLib.Space(35),35)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CAP"))+CPLib.Space(5),5);
            /* cStringa := cStringa + iif(wersonbo->CFESTERO=1,Space(16),Left(LRTrim(wersonbo->CODFISC)+Space(16),16)) */
            cStringa = cStringa+(CPLib.eqr(Cursor_wersonbo.GetDouble("CFESTERO"),1)?CPLib.Space(16):CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("CODFISC"))+CPLib.Space(16),16));
            /* If Empty(wersonbo->DATANASC) or DateToChar(wersonbo->DATANASC)='01000101' */
            if (CPLib.Empty(Cursor_wersonbo.GetDate("DATANASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_wersonbo.GetDate("DATANASC")),"01000101")) {
              /* cStringa := cStringa + Space(8) */
              cStringa = cStringa+CPLib.Space(8);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(DateToChar(wersonbo->DATANASC))+Space(8),8) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_wersonbo.GetDate("DATANASC")))+CPLib.Space(8),8);
            } // End If
            /* If not(Empty(wersonbo->NASSTATO)) */
            if ( ! (CPLib.Empty(Cursor_wersonbo.GetString("NASSTATO")))) {
              /* cStringa := cStringa + Left(LRTrim(wersonbo->NASSTATO)+Space(30),30) + Space(35) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("NASSTATO"))+CPLib.Space(30),30)+CPLib.Space(35);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(wersonbo->NASCOMUN)+Space(30),30) + Space(35) */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("NASCOMUN"))+CPLib.Space(30),30)+CPLib.Space(35);
            } // End If
            /* cStringa := cStringa + Left(LRTrim(wersonbo->TIPODOC)+Space(2),2) + Left(LRTrim(wersonbo->NUMDOCUM)+Space(15),15) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("TIPODOC"))+CPLib.Space(2),2)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("NUMDOCUM"))+CPLib.Space(15),15);
            /* If Empty(wersonbo->DATARILASC) or DateToChar(wersonbo->DATARILASC)='01000101' */
            if (CPLib.Empty(Cursor_wersonbo.GetDate("DATARILASC")) || CPLib.eqr(CPLib.DateToChar(Cursor_wersonbo.GetDate("DATARILASC")),"01000101")) {
              /* cStringa := cStringa + Space(8) */
              cStringa = cStringa+CPLib.Space(8);
            } else { // Else
              /* cStringa := cStringa + Left(LRTrim(DateToChar(wersonbo->DATARILASC))+Space(8),8)  */
              cStringa = cStringa+CPLib.Left(CPLib.LRTrim(CPLib.DateToChar(Cursor_wersonbo.GetDate("DATARILASC")))+CPLib.Space(8),8);
            } // End If
            /* cStringa := cStringa + Left(LRTrim(wersonbo->AUTRILASC)+Space(30),30) + Left(LRTrim(wersonbo->SESSO)+" ",1) + Space(22) */
            cStringa = cStringa+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("AUTRILASC"))+CPLib.Space(30),30)+CPLib.Left(CPLib.LRTrim(Cursor_wersonbo.GetString("SESSO"))+" ",1)+CPLib.Space(22);
            /* cStringa := cStringa + iif(not(Empty(wersonbo->DATAVALI)),DateToChar(wersonbo->DATAVALI),Space(8)) */
            cStringa = cStringa+( ! (CPLib.Empty(Cursor_wersonbo.GetDate("DATAVALI")))?CPLib.DateToChar(Cursor_wersonbo.GetDate("DATAVALI")):CPLib.Space(8));
            /* cStringa := cStringa + iif(wersonbo->CFESTERO=1,'NOCF',Space(4)) */
            cStringa = cStringa+(CPLib.eqr(Cursor_wersonbo.GetDouble("CFESTERO"),1)?"NOCF":CPLib.Space(4));
            Cursor_wersonbo.Next();
          }
          m_cConnectivityError = Cursor_wersonbo.ErrorMessage();
          Cursor_wersonbo.Close();
          // * --- End Select
        } // End If
      } // End Case
    } finally {
      try {
        if (Cursor_personbo!=null)
          Cursor_personbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
      try {
        if (Cursor_wersonbo!=null)
          Cursor_wersonbo.Close();
      } catch(Throwable dontCare) {
        // Ogni chiusura del cursore viene racchiusa in una catch per evitare di perdere l'eccezione
        // originata all'interno della try-finally della pagina della routine
      }
    }
  }
  void _init_() {
  }
  public String RunAsync(String p_w_codinter,String p_w_tipinter,String p_w_codage,String p_w_codcli,String p_w_ragben,String p_daope,String p_a_ope,String p_dareg,String p_a_reg,String p_w_tipoarchd,String p_w_tipoarchp,String p_w_stoper,String p_w_flgope,String p_w_flgfrz,String p_w_flgrae,String p_w_flgrap,String p_w_tiprap,String p_w_flgtit,String p_w_tiptit,String p_w_flgint,String p_w_flgdel,String p_w_flgchk,String p_w_flgxls,String p_w_flgsto,String p_w_allsto,String p_w_multifile,String p_w_flg2020) {
    w_codinter = p_w_codinter;
    w_tipinter = p_w_tipinter;
    w_codage = p_w_codage;
    w_codcli = p_w_codcli;
    w_ragben = p_w_ragben;
    daope = p_daope;
    a_ope = p_a_ope;
    dareg = p_dareg;
    a_reg = p_a_reg;
    w_tipoarchd = p_w_tipoarchd;
    w_tipoarchp = p_w_tipoarchp;
    w_stoper = p_w_stoper;
    w_flgope = p_w_flgope;
    w_flgfrz = p_w_flgfrz;
    w_flgrae = p_w_flgrae;
    w_flgrap = p_w_flgrap;
    w_tiprap = p_w_tiprap;
    w_flgtit = p_w_flgtit;
    w_tiptit = p_w_tiptit;
    w_flgint = p_w_flgint;
    w_flgdel = p_w_flgdel;
    w_flgchk = p_w_flgchk;
    w_flgxls = p_w_flgxls;
    w_flgsto = p_w_flgsto;
    w_allsto = p_w_allsto;
    w_multifile = p_w_multifile;
    w_flg2020 = p_w_flg2020;
    return CPAsyncRoutine.CreateAsyncAndStart(
    new CPAsyncRoutine.AsyncRunnable() {
      public void Compute(CPAsyncRoutine.AsyncResult p_oResult) {
        try {
          p_oResult.m_oResult=new Stop(Run());
        } finally {
          //evito di tenere nell'heap della virtual machine riferimenti non piu' usati
          m_Caller = null;
          m_Sql = null;
          m_Ctx = null;
        }
      }
    }
    );
  }
  public String Run(String p_w_codinter,String p_w_tipinter,String p_w_codage,String p_w_codcli,String p_w_ragben,String p_daope,String p_a_ope,String p_dareg,String p_a_reg,String p_w_tipoarchd,String p_w_tipoarchp,String p_w_stoper,String p_w_flgope,String p_w_flgfrz,String p_w_flgrae,String p_w_flgrap,String p_w_tiprap,String p_w_flgtit,String p_w_tiptit,String p_w_flgint,String p_w_flgdel,String p_w_flgchk,String p_w_flgxls,String p_w_flgsto,String p_w_allsto,String p_w_multifile,String p_w_flg2020) {
    w_codinter = p_w_codinter;
    w_tipinter = p_w_tipinter;
    w_codage = p_w_codage;
    w_codcli = p_w_codcli;
    w_ragben = p_w_ragben;
    daope = p_daope;
    a_ope = p_a_ope;
    dareg = p_dareg;
    a_reg = p_a_reg;
    w_tipoarchd = p_w_tipoarchd;
    w_tipoarchp = p_w_tipoarchp;
    w_stoper = p_w_stoper;
    w_flgope = p_w_flgope;
    w_flgfrz = p_w_flgfrz;
    w_flgrae = p_w_flgrae;
    w_flgrap = p_w_flgrap;
    w_tiprap = p_w_tiprap;
    w_flgtit = p_w_flgtit;
    w_tiptit = p_w_tiptit;
    w_flgint = p_w_flgint;
    w_flgdel = p_w_flgdel;
    w_flgchk = p_w_flgchk;
    w_flgxls = p_w_flgxls;
    w_flgsto = p_w_flgsto;
    w_allsto = p_w_allsto;
    w_multifile = p_w_multifile;
    w_flg2020 = p_w_flg2020;
    return Run();
  }
  public String Run() {
    String l_result;
    l_result = "";
    m_Ctx = m_Ctx.DisabledDataFilteringVersion();
    try {
      try {
        try {
          try {
            m_bEventRunning = true;
            com.zucchetti.sitepainter.EventHandler.notifyEvent("Run start",this,m_Ctx,specificEventsHandlers,allEventsHandlers);
          } finally {
            m_bEventRunning = false;
          }
          Page_1();
        } finally {
          try {
            m_bEventRunning = true;
            com.zucchetti.sitepainter.EventHandler.notifyEvent(com.zucchetti.sitepainter.EventHandler.RUN_END,this,m_Ctx,specificEventsHandlers,allEventsHandlers);
          } finally {
            m_bEventRunning = false;
          }
        }
      } catch(Stop stop_value) {
        l_result = stop_value.GetString();
      } catch(RoutineException l_transactionRaise) {
        //non va segnalato come errore
      } catch(Exception fault) {
        l_result = "";
        CPStdCounter.Error(fault);
        CallerExImpl l_oTraceSink;
        l_oTraceSink = new CallerExImpl(m_Caller,"");
        if (l_oTraceSink.HasWorkingVar("m_cFaultTrace")) {
          if ( ! (CPLib.IsAdministrator(m_Ctx)) && m_Ctx.HasAdministeredUsers()) {
            l_oTraceSink.SetString("m_cFaultTrace","C",0,0,"MSG_ADMIN_REQUIRED");
          } else {
            l_oTraceSink.SetString("m_cFaultTrace","C",0,0,CPLib.DumpException(fault));
          }
        }
      }
      m_Caller.CalledBatchEnd();
    } finally {
      m_Ctx.EnableDataFiltering();
    }
    return l_result;
  }
  public static arrt_chkdiana_allR Make(CPContext p_Ctx, Caller p_Caller) {
    return new arrt_chkdiana_allR(p_Ctx, p_Caller);
  }
  public static arrt_chkdiana_allR Make(CPContext p_Ctx) {
    return new arrt_chkdiana_allR(p_Ctx, CPSecurity.EXECUTE_ALL_ROUTINES);
  }
  public void Blank() {
    w_codinter = CPLib.Space(11);
    w_tipinter = CPLib.Space(2);
    w_codage = CPLib.Space(6);
    w_codcli = CPLib.Space(16);
    w_ragben = CPLib.Space(70);
    daope = CPLib.Space(8);
    a_ope = CPLib.Space(8);
    dareg = CPLib.Space(8);
    a_reg = CPLib.Space(8);
    w_tipoarchd = CPLib.Space(1);
    w_tipoarchp = CPLib.Space(1);
    w_stoper = CPLib.Space(1);
    w_flgope = CPLib.Space(1);
    w_flgfrz = CPLib.Space(1);
    w_flgrae = CPLib.Space(1);
    w_flgrap = CPLib.Space(1);
    w_tiprap = CPLib.Space(1);
    w_flgtit = CPLib.Space(1);
    w_tiptit = CPLib.Space(1);
    w_flgint = CPLib.Space(1);
    w_flgdel = CPLib.Space(1);
    w_flgchk = CPLib.Space(1);
    w_flgxls = CPLib.Space(1);
    w_flgsto = CPLib.Space(1);
    w_allsto = CPLib.Space(1);
    w_multifile = CPLib.Space(1);
    w_flg2020 = CPLib.Space(1);
    w_codcab = CPLib.Space(6);
    w_cabcod = CPLib.Space(6);
    w_desccit = CPLib.Space(30);
    w_citdesc = CPLib.Space(30);
    w_provin = CPLib.Space(2);
    w_provind = CPLib.Space(2);
    w_coddipe = CPLib.Space(6);
    w_agente = 0;
    _note = "";
    _rownum = 0;
    fhand = CPLib.Space(10);
    _nomefile = CPLib.Space(15);
    cNomeFile = CPLib.Space(30);
    cOnlyNomeFile = CPLib.Space(30);
    cNomeFileZip = CPLib.Space(30);
    nTotRec = 0;
    nTotReg = 0;
    nNumRec = 0;
    _avanza = 0;
    _codrif = CPLib.Space(16);
    w_cdadata = CPLib.Space(8);
    w_c_adata = CPLib.Space(8);
    w_cdadata_rap = CPLib.Space(8);
    w_c_adata_rap = CPLib.Space(8);
    w_cdareg_rap = CPLib.Space(8);
    w_c_areg_rap = CPLib.Space(8);
    _ctotale = 0;
    _conta = 0;
    _max = 0;
    _min = 0;
    _top = 0;
    _bottom = 0;
    _cicli = 0;
    _contacilci = 0;
    _flagrap = CPLib.Space(1);
    _ciclo = 0;
    _ramate = CPLib.Space(3);
    _numsto = CPLib.Space(15);
    _oldrighe = 0;
    _continua = 0;
    _oldrap = CPLib.Space(25);
    _idereg = CPLib.Space(20);
    xStato = CPLib.Space(1);
    _conta1 = 0;
    _conta2 = 0;
    _conta4 = 0;
    _conta5 = 0;
    _conta6 = 0;
    _conta7 = 0;
    _conta8 = 0;
    _conta9 = 0;
    _tiprec = CPLib.Space(1);
    _raeatc = CPLib.Space(1);
    oldfolder = CPLib.Space(120);
    _tipoag = CPLib.Space(10);
    _datage = CPLib.Space(44);
    _numticket = CPLib.Space(30);
    w_cdareg = CPLib.Space(8);
    w_c_areg = CPLib.Space(8);
    z_codcab = CPLib.Space(6);
    z_desccit = CPLib.Space(30);
    z_provin = CPLib.Space(2);
    z_coddipe = CPLib.Space(6);
    mcANADIP = new MemoryCursor_anadip();
    mcRighe = new MemoryCursor_mcdiana_mcrdef();
    mcRigheTXT = new MemoryCursor_mcdiana_mcrdef();
    mcPersonbo = new MemoryCursor_personbo();
    mcWersonbo = new MemoryCursor_wersonbo();
    mcKnarapbo = new MemoryCursor_knarapbo();
    mcStgru = new MemoryCursor_tbstgru();
    _tiporap = CPLib.Space(1);
    cRitorno = "KO";
    _righe = 0;
    _righetot = 0;
    _numfile = 0;
    _riga = "";
    tblnum = CPLib.Round(1,0);
    tblname_main = CPLib.Space(9);
    _maxrighe = CPLib.Round(25000,0);
    _file1 = CPLib.Space(30);
    _file2 = CPLib.Space(30);
    _oldmc = 0;
    cProg = CPLib.Space(20);
    _mlientiope = false;
    _clientiope = false;
    _mogopebo = false;
    _sogopebo = false;
    _meneficope = false;
    _beneficope = false;
    _merzistiope = false;
    _terzistiope = false;
    _mlientifrz = false;
    _clientifrz = false;
    _mogopefbo = false;
    _sogopefbo = false;
    _meneficfrz = false;
    _beneficfrz = false;
    _merzistifrz = false;
    _terzistifrz = false;
    _rapcoll = false;
    _rapcolleg = false;
    _xlientiope = false;
    _xogopebo = false;
    _xeneficope = false;
    _xerzistiope = false;
    _xlientifrz = false;
    _xogopefbo = false;
    _xeneficfrz = false;
    _xerzistifrz = false;
    _xapcoll = false;
    _xapcolleg = false;
    mcTipo1 = new MemoryCursor_tipo1();
    mcTipo2 = new MemoryCursor_tipo2_3();
    mcTipo4 = new MemoryCursor_tipo4();
    mcTipo5 = new MemoryCursor_tipo5();
    mcTipo6 = new MemoryCursor_tipo6();
    mcTipo7 = new MemoryCursor_tipo7();
    mcTipo8 = new MemoryCursor_tipo8();
    mcTipo9 = new MemoryCursor_tipo9();
    _nfile = CPLib.Space(120);
    pCodDip = CPLib.Space(6);
    pCodCab = CPLib.Space(6);
    pDesCit = CPLib.Space(30);
    pProv = CPLib.Space(2);
    w_DaData = CPLib.NullDate();
    w_AData = CPLib.NullDate();
    w_DaDataReg = CPLib.NullDate();
    w_ADataReg = CPLib.NullDate();
    pCli = CPLib.Space(16);
    pDatOpe = CPLib.NullDate();
    pRap = CPLib.Space(25);
    pTRap = CPLib.Space(1);
    pTipoR = CPLib.Space(1);
    pRAE = CPLib.Space(1);
    pSTATO = CPLib.Space(1);
    pDatRet = CPLib.NullDate();
    _usemc = CPLib.Round(0,0);
    cStringa = "";
    _tipsot = CPLib.Space(1);
    gPathApp=m_Ctx.GetGlobalString("gPathApp");
    gPathDoc=m_Ctx.GetGlobalString("gPathDoc");
    gIntemediario=m_Ctx.GetGlobalString("gIntemediario");
    gUrlApp=m_Ctx.GetGlobalString("gUrlApp");
    gAzienda=m_Ctx.GetGlobalString("gAzienda");
    gNumRec=m_Ctx.GetGlobalNumber("gNumRec");
    gNumReg=m_Ctx.GetGlobalNumber("gNumReg");
    gMsgImp=m_Ctx.GetGlobalString("gMsgImp");
    gMsgProc=m_Ctx.GetGlobalString("gMsgProc");
    gFlgWU=m_Ctx.GetGlobalString("gFlgWU");
    gCodDip=m_Ctx.GetGlobalString("gCodDip");
  }
  // * --- Area Manuale = BO - Methods
  // * --- Fine Area Manuale
  // ENTITY_VQR: ,qbe_personbo_all,qbe_wersonbo_all,qbe_rapd_chkdiana_min_max,qbe_rapd_chkdiana,qbe_rapp_chkdiana,qbe_titd_chkdiana,qbe_oped_chkdiana_limits,qbe_oped_chkdiana,qbe_tab_mmc,qbe_opep_chkdiana_limits,qbe_opep_chkdiana,qbe_tab_mmc,qbe_tab_mmc,qbe_frad_chkdiana_limits,qbe_frad_chkdiana,qbe_frap_chkdiana_limits,qbe_frap_chkdiana,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,
  public static final String m_cVQRList = ",qbe_personbo_all,qbe_wersonbo_all,qbe_rapd_chkdiana_min_max,qbe_rapd_chkdiana,qbe_rapp_chkdiana,qbe_titd_chkdiana,qbe_oped_chkdiana_limits,qbe_oped_chkdiana,qbe_tab_mmc,qbe_opep_chkdiana_limits,qbe_opep_chkdiana,qbe_tab_mmc,qbe_tab_mmc,qbe_frad_chkdiana_limits,qbe_frad_chkdiana,qbe_frap_chkdiana_limits,qbe_frap_chkdiana,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,qbe_tab_mmc,";
  // ENTITY_BATCHES: ,arfn_calc_idereg,arfn_chkspers,arfn_dateminus,arfn_datidip_sol,arfn_fdate,arfn_fdatetime,arfn_flaglire,arrt_chkdiana_all,
  public static final String i_InvokedRoutines = ",arfn_calc_idereg,arfn_chkspers,arfn_dateminus,arfn_datidip_sol,arfn_fdate,arfn_fdatetime,arfn_flaglire,arrt_chkdiana_all,";
  public static String[] m_cRunParameterNames={"w_codinter","w_tipinter","w_codage","w_codcli","w_ragben","daope","a_ope","dareg","a_reg","w_tipoarchd","w_tipoarchp","w_stoper","w_flgope","w_flgfrz","w_flgrae","w_flgrap","w_tiprap","w_flgtit","w_tiptit","w_flgint","w_flgdel","w_flgchk","w_flgxls","w_flgsto","w_allsto","w_multifile","w_flg2020"};
  protected static String GetFieldsName_00000142(CPContext p_Ctx,CPPhTableWrInfo p_oWrInfo) {
    String p_cSql = "";
    p_cSql = p_cSql+"ESCODICE,";
    p_cSql = p_cSql+"ESCODDIP,";
    p_cSql = p_cSql+"ESDATREP,";
    p_cSql = p_cSql+"ESNUMREP,";
    p_cSql = p_cSql+"ESNOMREP,";
    p_cSql = p_cSql+p_oWrInfo.InsertFields();
    p_cSql = CPLib.AddCPCCCHKName(p_Ctx,p_cSql,"cgo_stampeav",true);
    return p_cSql;
  }
  protected static String GetFieldsName_00000156(CPContext p_Ctx,CPPhTableWrInfo p_oWrInfo) {
    String p_cSql = "";
    p_cSql = p_cSql+"LOGCODICE,";
    p_cSql = p_cSql+"LOGDATORA,";
    p_cSql = p_cSql+"LOGUTENTE,";
    p_cSql = p_cSql+"LOGTIPOPE,";
    p_cSql = p_cSql+"LOGTESTO,";
    p_cSql = p_cSql+"LOGTABELLA,";
    p_cSql = p_cSql+"LOGCHIAVE,";
    p_cSql = p_cSql+"LOGFILE,";
    p_cSql = p_cSql+"LOGPATH,";
    p_cSql = p_cSql+"LOGTYPE,";
    p_cSql = p_cSql+p_oWrInfo.InsertFields();
    p_cSql = CPLib.AddCPCCCHKName(p_Ctx,p_cSql,"log_app",true);
    return p_cSql;
  }
  protected static String GetFieldsName_00000D75(CPContext p_Ctx,CPPhTableWrInfo p_oWrInfo) {
    String p_cSql = "";
    p_cSql = p_cSql+"A01A,";
    p_cSql = p_cSql+"A01B,";
    p_cSql = p_cSql+"A02,";
    p_cSql = p_cSql+"A03,";
    p_cSql = p_cSql+"A11,";
    p_cSql = p_cSql+"A12A,";
    p_cSql = p_cSql+"A12B,";
    p_cSql = p_cSql+"A12C,";
    p_cSql = p_cSql+"A21,";
    p_cSql = p_cSql+"A22,";
    p_cSql = p_cSql+"A23,";
    p_cSql = p_cSql+"A24,";
    p_cSql = p_cSql+"A25,";
    p_cSql = p_cSql+"A31A,";
    p_cSql = p_cSql+"A31B,";
    p_cSql = p_cSql+"A32,";
    p_cSql = p_cSql+"A33A,";
    p_cSql = p_cSql+"A33B,";
    p_cSql = p_cSql+"A33C,";
    p_cSql = p_cSql+"A34,";
    p_cSql = p_cSql+"A41,";
    p_cSql = p_cSql+"A42,";
    p_cSql = p_cSql+"A43,";
    p_cSql = p_cSql+"A51,";
    p_cSql = p_cSql+"A52,";
    p_cSql = p_cSql+"A53,";
    p_cSql = p_cSql+"A54A,";
    p_cSql = p_cSql+"A54B,";
    p_cSql = p_cSql+"A54C,";
    p_cSql = p_cSql+"B11,";
    p_cSql = p_cSql+"B12,";
    p_cSql = p_cSql+"B13,";
    p_cSql = p_cSql+"B14,";
    p_cSql = p_cSql+"B15,";
    p_cSql = p_cSql+"PROG,";
    p_cSql = p_cSql+"FONTE,";
    p_cSql = p_cSql+"PRGANTI,";
    p_cSql = p_cSql+"TMOV,";
    p_cSql = p_cSql+"A52L,";
    p_cSql = p_cSql+p_oWrInfo.InsertFields();
    p_cSql = CPLib.AddCPCCCHKName(p_Ctx,p_cSql,"tipo1",true);
    return p_cSql;
  }
  protected static String GetFieldsName_00000D78(CPContext p_Ctx,CPPhTableWrInfo p_oWrInfo) {
    String p_cSql = "";
    p_cSql = p_cSql+"A01A,";
    p_cSql = p_cSql+"A01B,";
    p_cSql = p_cSql+"A02,";
    p_cSql = p_cSql+"A03,";
    p_cSql = p_cSql+"C11,";
    p_cSql = p_cSql+"D11,";
    p_cSql = p_cSql+"D13,";
    p_cSql = p_cSql+"D14A,";
    p_cSql = p_cSql+"D14B,";
    p_cSql = p_cSql+"D14C,";
    p_cSql = p_cSql+"D15,";
    p_cSql = p_cSql+"D16,";
    p_cSql = p_cSql+"D17,";
    p_cSql = p_cSql+"D18,";
    p_cSql = p_cSql+"D19,";
    p_cSql = p_cSql+"D21,";
    p_cSql = p_cSql+"D22,";
    p_cSql = p_cSql+"D23,";
    p_cSql = p_cSql+"D31,";
    p_cSql = p_cSql+"D32,";
    p_cSql = p_cSql+"D41,";
    p_cSql = p_cSql+"D42,";
    p_cSql = p_cSql+"D43,";
    p_cSql = p_cSql+"D44,";
    p_cSql = p_cSql+"D45,";
    p_cSql = p_cSql+"PROG,";
    p_cSql = p_cSql+"CFESTERO,";
    p_cSql = p_cSql+"DATAVALI,";
    p_cSql = p_cSql+p_oWrInfo.InsertFields();
    p_cSql = CPLib.AddCPCCCHKName(p_Ctx,p_cSql,"tipo2_3",true);
    return p_cSql;
  }
  protected static String GetFieldsName_00000D7B(CPContext p_Ctx,CPPhTableWrInfo p_oWrInfo) {
    String p_cSql = "";
    p_cSql = p_cSql+"A01A,";
    p_cSql = p_cSql+"A01B,";
    p_cSql = p_cSql+"A02,";
    p_cSql = p_cSql+"A03,";
    p_cSql = p_cSql+"C21,";
    p_cSql = p_cSql+"E11,";
    p_cSql = p_cSql+"E13,";
    p_cSql = p_cSql+"E14A,";
    p_cSql = p_cSql+"E14B,";
    p_cSql = p_cSql+"E14C,";
    p_cSql = p_cSql+"E15,";
    p_cSql = p_cSql+"E16,";
    p_cSql = p_cSql+"E17,";
    p_cSql = p_cSql+"E18,";
    p_cSql = p_cSql+"E19,";
    p_cSql = p_cSql+"E41,";
    p_cSql = p_cSql+"E42,";
    p_cSql = p_cSql+"E43,";
    p_cSql = p_cSql+"E44,";
    p_cSql = p_cSql+"E45,";
    p_cSql = p_cSql+"PROG,";
    p_cSql = p_cSql+"CFESTERO,";
    p_cSql = p_cSql+"DATAVALI,";
    p_cSql = p_cSql+p_oWrInfo.InsertFields();
    p_cSql = CPLib.AddCPCCCHKName(p_Ctx,p_cSql,"tipo4",true);
    return p_cSql;
  }
  protected static String GetFieldsName_00000D7E(CPContext p_Ctx,CPPhTableWrInfo p_oWrInfo) {
    String p_cSql = "";
    p_cSql = p_cSql+"A01A,";
    p_cSql = p_cSql+"A01B,";
    p_cSql = p_cSql+"A02,";
    p_cSql = p_cSql+"A03,";
    p_cSql = p_cSql+"C31,";
    p_cSql = p_cSql+"F11,";
    p_cSql = p_cSql+"F13,";
    p_cSql = p_cSql+"F14A,";
    p_cSql = p_cSql+"F14B,";
    p_cSql = p_cSql+"F14C,";
    p_cSql = p_cSql+"F15,";
    p_cSql = p_cSql+"F16,";
    p_cSql = p_cSql+"F31,";
    p_cSql = p_cSql+"PROG,";
    p_cSql = p_cSql+"CFESTERO,";
    p_cSql = p_cSql+"DATAVALI,";
    p_cSql = p_cSql+p_oWrInfo.InsertFields();
    p_cSql = CPLib.AddCPCCCHKName(p_Ctx,p_cSql,"tipo5",true);
    return p_cSql;
  }
  protected static String GetFieldsName_00000D81(CPContext p_Ctx,CPPhTableWrInfo p_oWrInfo) {
    String p_cSql = "";
    p_cSql = p_cSql+"A01A,";
    p_cSql = p_cSql+"A01B,";
    p_cSql = p_cSql+"A02,";
    p_cSql = p_cSql+"A03,";
    p_cSql = p_cSql+"C41,";
    p_cSql = p_cSql+"G11,";
    p_cSql = p_cSql+"G13,";
    p_cSql = p_cSql+"G14A,";
    p_cSql = p_cSql+"G14B,";
    p_cSql = p_cSql+"G14C,";
    p_cSql = p_cSql+"G15,";
    p_cSql = p_cSql+"G16,";
    p_cSql = p_cSql+"G17,";
    p_cSql = p_cSql+"G18,";
    p_cSql = p_cSql+"G19,";
    p_cSql = p_cSql+"G41,";
    p_cSql = p_cSql+"G42,";
    p_cSql = p_cSql+"G43,";
    p_cSql = p_cSql+"G44,";
    p_cSql = p_cSql+"G45,";
    p_cSql = p_cSql+"PROG,";
    p_cSql = p_cSql+"CFESTERO,";
    p_cSql = p_cSql+"DATAVALI,";
    p_cSql = p_cSql+p_oWrInfo.InsertFields();
    p_cSql = CPLib.AddCPCCCHKName(p_Ctx,p_cSql,"tipo6",true);
    return p_cSql;
  }
  protected static String GetFieldsName_00000D84(CPContext p_Ctx,CPPhTableWrInfo p_oWrInfo) {
    String p_cSql = "";
    p_cSql = p_cSql+"A01A,";
    p_cSql = p_cSql+"A01B,";
    p_cSql = p_cSql+"A02,";
    p_cSql = p_cSql+"A03,";
    p_cSql = p_cSql+"C11,";
    p_cSql = p_cSql+"D11,";
    p_cSql = p_cSql+"D13,";
    p_cSql = p_cSql+"D14A,";
    p_cSql = p_cSql+"D14B,";
    p_cSql = p_cSql+"D14C,";
    p_cSql = p_cSql+"D15,";
    p_cSql = p_cSql+"D16,";
    p_cSql = p_cSql+"D17,";
    p_cSql = p_cSql+"D18,";
    p_cSql = p_cSql+"D19,";
    p_cSql = p_cSql+"D21,";
    p_cSql = p_cSql+"D22,";
    p_cSql = p_cSql+"D23,";
    p_cSql = p_cSql+"D31,";
    p_cSql = p_cSql+"D32,";
    p_cSql = p_cSql+"D41,";
    p_cSql = p_cSql+"D42,";
    p_cSql = p_cSql+"D43,";
    p_cSql = p_cSql+"D44,";
    p_cSql = p_cSql+"D45,";
    p_cSql = p_cSql+"PROG,";
    p_cSql = p_cSql+"CFESTERO,";
    p_cSql = p_cSql+"DATAVALI,";
    p_cSql = p_cSql+p_oWrInfo.InsertFields();
    p_cSql = CPLib.AddCPCCCHKName(p_Ctx,p_cSql,"tipo7",true);
    return p_cSql;
  }
  protected static String GetFieldsName_00000D87(CPContext p_Ctx,CPPhTableWrInfo p_oWrInfo) {
    String p_cSql = "";
    p_cSql = p_cSql+"A01A,";
    p_cSql = p_cSql+"A01B,";
    p_cSql = p_cSql+"A02,";
    p_cSql = p_cSql+"A03,";
    p_cSql = p_cSql+"C21,";
    p_cSql = p_cSql+"E11,";
    p_cSql = p_cSql+"E13,";
    p_cSql = p_cSql+"E14A,";
    p_cSql = p_cSql+"E14B,";
    p_cSql = p_cSql+"E14C,";
    p_cSql = p_cSql+"E15,";
    p_cSql = p_cSql+"E16,";
    p_cSql = p_cSql+"E17,";
    p_cSql = p_cSql+"E18,";
    p_cSql = p_cSql+"E19,";
    p_cSql = p_cSql+"E41,";
    p_cSql = p_cSql+"E42,";
    p_cSql = p_cSql+"E43,";
    p_cSql = p_cSql+"E44,";
    p_cSql = p_cSql+"E45,";
    p_cSql = p_cSql+"PROG,";
    p_cSql = p_cSql+"CFESTERO,";
    p_cSql = p_cSql+"DATAVALI,";
    p_cSql = p_cSql+p_oWrInfo.InsertFields();
    p_cSql = CPLib.AddCPCCCHKName(p_Ctx,p_cSql,"tipo8",true);
    return p_cSql;
  }
  protected static String GetFieldsName_00000D8A(CPContext p_Ctx,CPPhTableWrInfo p_oWrInfo) {
    String p_cSql = "";
    p_cSql = p_cSql+"A01A,";
    p_cSql = p_cSql+"A01B,";
    p_cSql = p_cSql+"A02,";
    p_cSql = p_cSql+"A03,";
    p_cSql = p_cSql+"C51,";
    p_cSql = p_cSql+"H11,";
    p_cSql = p_cSql+"H13,";
    p_cSql = p_cSql+"H14A,";
    p_cSql = p_cSql+"H14B,";
    p_cSql = p_cSql+"H14C,";
    p_cSql = p_cSql+"H15,";
    p_cSql = p_cSql+"H16,";
    p_cSql = p_cSql+"H17,";
    p_cSql = p_cSql+"H18,";
    p_cSql = p_cSql+"H19,";
    p_cSql = p_cSql+"H41,";
    p_cSql = p_cSql+"H42,";
    p_cSql = p_cSql+"H43,";
    p_cSql = p_cSql+"H44,";
    p_cSql = p_cSql+"H45,";
    p_cSql = p_cSql+"PROG,";
    p_cSql = p_cSql+"CFESTERO,";
    p_cSql = p_cSql+"DATAVALI,";
    p_cSql = p_cSql+p_oWrInfo.InsertFields();
    p_cSql = CPLib.AddCPCCCHKName(p_Ctx,p_cSql,"tipo9",true);
    return p_cSql;
  }
  protected static String GetFieldsName_00000D8B(CPContext p_Ctx,CPPhTableWrInfo p_oWrInfo) {
    String p_cSql = "";
    p_cSql = p_cSql+"CONTA1,";
    p_cSql = p_cSql+"CONTA2,";
    p_cSql = p_cSql+"CONTA4,";
    p_cSql = p_cSql+"CONTA5,";
    p_cSql = p_cSql+"CONTA6,";
    p_cSql = p_cSql+"CONTA7,";
    p_cSql = p_cSql+"CONTA8,";
    p_cSql = p_cSql+"CONTA9,";
    p_cSql = p_cSql+p_oWrInfo.InsertFields();
    p_cSql = CPLib.AddCPCCCHKName(p_Ctx,p_cSql,"contatori",true);
    return p_cSql;
  }
}
