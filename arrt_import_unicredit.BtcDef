* --- CodePainter Revolution Batch Vers. 5.1
￼Icpbatch.CPBatch
Items=[
Icpitembatch.CPBeginEnd
comment='Definizione variabili caller
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili Locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='variabili copia
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili globali
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Legge dati intermediario per metteri su operazbo,fraziobo,rapopebo se mancanti
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPRead
arch='tbmacage
next=Icpitembatch.CPRemark
frm_calc='Import Soggetti
next=Icpitembatch.CPVarDecl
frm_calc='''
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPRemark
frm_calc='Cicla sul file della lista e lancia la pagina appropriata
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_esito
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
obj='Try
pag=1
prev=O19
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O20
fatherSonIndex=0
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumChi
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumSca
next=Icpitembatch.CPVarDecl
frm_calc='0
len=5
name='_numrec
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + LRTrim(w_nomefile) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+"/"+LRTrim(w_nomefile))
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+LRTrim(w_nomefile))
next=Icpitembatch.CPIfElse
frm_calc=[
'_esito=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O35
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O36
fatherSonIndex=0
frm_calc='gMsgProc + "Presente registrazione non valida. Riga "+LRTrim(Str(_numrec,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Rilevati errori nell'impotazione dei file! Ricreare il file segnalato e rieseguire l'import dei dati. La procedura annullera automaticamente l'importazione" + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +LRTrim(w_nomefile) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='"Importazione dati interrotta per presenza errori"
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPTransaction
frm_calc='transaction error
obj='Transaction
pag=1
prev=O44
I
nonlocal=True
obj='Var
pag=1
prev=O43
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O42
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O41
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O36
fatherSonIndex=1
frm_calc='gMsgProc + 'Record Elaborati: '+LRTrim(Str(_numrec,10,0)) + ' dal file '+LRTrim(w_nomefile)+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Nuovi Rapporti: '+LRTrim(Str(cNumNew,10,0)) + ' - Rapporti Aggiornati: '+LRTrim(Str(cNumMod,10,0)) + ' - Rapporti Scartati:'+LRTrim(Str(cNumSca,10,0)) + ' - Rapporti Chiusi:'+LRTrim(Str(cNumChi,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +LRTrim(w_nomefile) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Importazione dati terminata.'
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=1
prev=O50
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O49
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O48
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O47
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=1
prev=O34
I
obj='Exec
pag=1
prev=O32
I
obj='While
pag=1
prev=O31
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O32
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_esito = 1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(_numrec,10,0))+' riferimenti del file '+LRTrim(w_nomefile)
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=1
prev=O59
var_op='asgn
I
obj='If
pag=1
prev=O56
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExitLoop
father=O59
fatherSonIndex=0
obj='ExitLoop
pag=1
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O55
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O56
fatherSonIndex=0
frm_calc='_numrec + 1
len=5
name='_numrec
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,17,16)))  < 16
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O70
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O71
fatherSonIndex=0
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O71
fatherSonIndex=1
frm_calc=[
'Substr(riga,33,1)='1'
'Substr(riga,33,1)='2'
'Substr(riga,33,1)='3'
]
h=[
19
19
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
comment='Nuovo Rapporto
instr=Icpitembatch.CPExec
check='page
father=O78
fatherSonIndex=0
frm_calc='2
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
comment='Modifica Rapporto
instr=Icpitembatch.CPExec
check='page
father=O78
fatherSonIndex=1
frm_calc='3
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=1
prev=O85
var_op='asgn
I
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
comment='Chiusura Rapporto
instr=Icpitembatch.CPExec
check='page
father=O78
fatherSonIndex=2
frm_calc='4
next=Icpitembatch.CPVarDecl
frm_calc='cNumChi + 1
len=10
name='cNumChi
obj='Var
obj_type='N
pag=1
prev=O88
var_op='asgn
I
obj='Exec
pag=1
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O69
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O30
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O29
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O28
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O27
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O26
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O25
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O24
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O20
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=1
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=1
prev=O18
I
obj='Var
obj_type='N
pag=1
prev=O17
var_op='asgn
I
obj='Remark
pag=1
prev=O16
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O15
var_op='asgn
I
obj='Remark
pag=1
prev=O14
I
obj='Read
pag=1
prev=O12
rd_field=[
'MADESCRI
'MAFLGRAP
'MAFLGBON
'MADIPSTD
]
rd_kfield=[
'MACODICE
]
rd_kvar=[
'w_codmage
]
rd_var=[
'w_xMADESCRI
'w_xMAFLGRAP
'w_xMAFLGBON
'w_xMADIPSTD
]
I
obj='Select
pag=1
prev=O11
sel_field='*
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O12
fatherSonIndex=0
frm_calc='intermbo->CODINTER
len=11
name='_codinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->DESCCIT
len=30
name='_citinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->CODCAB
len=6
name='_cabinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->PROVINCIA
len=2
name='_prvinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->TIPINTER
len=2
name='_intertip
obj='Var
pag=1
prev=O106
var_op='asgn
I
obj='Var
pag=1
prev=O105
var_op='asgn
I
obj='Var
pag=1
prev=O104
var_op='asgn
I
obj='Var
pag=1
prev=O103
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=1
prev=O9
I
obj='Begin
pag=1
prev=O7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Path Applicazione
father=O9
fatherSonIndex=0
global=True
len=80
name='gPathApp
next=Icpitembatch.CPVarDecl
comment='Azienda
global=True
len=10
name='gAzienda
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='Messaggio
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O113
I
nonlocal=True
obj='Var
pag=1
prev=O112
I
nonlocal=True
obj='Var
pag=1
prev=O111
I
nonlocal=True
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7
fatherSonIndex=0
len=10
name='ciidbase
next=Icpitembatch.CPVarDecl
len=8
name='cidataini
next=Icpitembatch.CPVarDecl
len=8
name='cidatafine
next=Icpitembatch.CPVarDecl
len=12
name='cicodinter
next=Icpitembatch.CPVarDecl
len=11
name='cinumprog
next=Icpitembatch.CPVarDecl
len=1
name='citiporap
next=Icpitembatch.CPVarDecl
comment='Denominazione
len=60
name='w_xMADESCRI
next=Icpitembatch.CPVarDecl
comment='Dipendenza Default
len=6
name='w_xMADIPSTD
next=Icpitembatch.CPVarDecl
comment='Scrive tipo operazione come bonifico
len=1
name='w_xMAFLGBON
next=Icpitembatch.CPVarDecl
comment='Generazione Rapporti da operazioni
len=1
name='w_xMAFLGRAP
obj='Var
pag=1
prev=O126
I
obj='Var
pag=1
prev=O125
I
obj='Var
pag=1
prev=O124
I
obj='Var
pag=1
prev=O123
I
obj='Var
pag=1
prev=O122
I
obj='Var
pag=1
prev=O121
I
obj='Var
pag=1
prev=O120
I
obj='Var
obj_type='D
pag=1
prev=O119
I
obj='Var
obj_type='D
pag=1
prev=O118
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O3
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O5
fatherSonIndex=0
len=1
name='fhand
next=Icpitembatch.CPVarDecl
len=10
name='riga
next=Icpitembatch.CPVarDecl
len=10
name='eProg
next=Icpitembatch.CPVarDecl
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
len=1
name='_tdest
next=Icpitembatch.CPVarDecl
len=16
name='xCF
next=Icpitembatch.CPVarDecl
len=16
name='xSOCTCon
next=Icpitembatch.CPVarDecl
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
len=30
name='xCitta
next=Icpitembatch.CPVarDecl
len=6
name='cCliProg
next=Icpitembatch.CPVarDecl
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
len=1
name='xSesso
next=Icpitembatch.CPVarDecl
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
len=6
name='xCAB
next=Icpitembatch.CPVarDecl
len=6
name='xDIP
next=Icpitembatch.CPVarDecl
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
len=8
name='xData
next=Icpitembatch.CPVarDecl
len=8
name='xDatF
next=Icpitembatch.CPVarDecl
comment='Contatore record nuovi
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
comment='Contatore record aggiornati
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
comment='Contatore record invariati
len=10
name='cNumChi
next=Icpitembatch.CPVarDecl
comment='Contatore record invariati
len=10
name='cNumSca
next=Icpitembatch.CPVarDecl
len=1
name='cFlagLire
next=Icpitembatch.CPVarDecl
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
len=1
name='xCFE
next=Icpitembatch.CPVarDecl
len=10
name='conta
next=Icpitembatch.CPVarDecl
len=1
name='_esito
next=Icpitembatch.CPVarDecl
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
len=2
name='cPNAS
next=Icpitembatch.CPVarDecl
len=40
name='cSRES
next=Icpitembatch.CPVarDecl
len=3
name='cSRES2
next=Icpitembatch.CPVarDecl
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
len=1
name='_salta
next=Icpitembatch.CPVarDecl
len=1
name='_allineamento
next=Icpitembatch.CPVarDecl
len=1
name='_allineatonomecnome
next=Icpitembatch.CPVarDecl
len=70
name='_ragsocold
next=Icpitembatch.CPVarDecl
len=6
name='_cabold
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
len=10
name='_idbase
next=Icpitembatch.CPVarDecl
len=11
name='_codinter
next=Icpitembatch.CPVarDecl
len=30
name='_citinter
next=Icpitembatch.CPVarDecl
len=6
name='_cabinter
next=Icpitembatch.CPVarDecl
len=2
name='_prvinter
next=Icpitembatch.CPVarDecl
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
len=2
name='_interprv
next=Icpitembatch.CPVarDecl
len=2
name='_intertip
next=Icpitembatch.CPVarDecl
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
len=35
name='_benind
next=Icpitembatch.CPVarDecl
len=5
name='_bencap
next=Icpitembatch.CPVarDecl
len=20
name='_oldreg
next=Icpitembatch.CPVarDecl
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
len=2
name='xProvRes
next=Icpitembatch.CPVarDecl
len=16
name='_connes
next=Icpitembatch.CPVarDecl
len=5
name='_numrec
next=Icpitembatch.CPVarDecl
len=5
name='_nummod
next=Icpitembatch.CPVarDecl
len=5
name='_oldmac
next=Icpitembatch.CPVarDecl
len=70
name='_oldrag
next=Icpitembatch.CPVarDecl
len=70
name='_oldcon
next=Icpitembatch.CPVarDecl
len=1
name='_aggcli
next=Icpitembatch.CPVarDecl
len=10
name='_nriga
next=Icpitembatch.CPVarDecl
len=25
name='_xrapporto
next=Icpitembatch.CPVarDecl
len=5
name='_magecod
obj='Var
pag=1
prev=O211
I
obj='Var
pag=1
prev=O210
I
obj='Var
obj_type='N
pag=1
prev=O209
I
obj='Var
obj_type='N
pag=1
prev=O208
I
obj='Var
pag=1
prev=O207
I
obj='Var
pag=1
prev=O206
I
obj='Var
pag=1
prev=O205
I
obj='Var
obj_type='N
pag=1
prev=O204
I
obj='Var
obj_type='N
pag=1
prev=O203
I
obj='Var
pag=1
prev=O202
I
obj='Var
pag=1
prev=O201
I
obj='Var
pag=1
prev=O200
I
obj='Var
pag=1
prev=O199
I
obj='Var
pag=1
prev=O198
I
obj='Var
pag=1
prev=O197
I
obj='Var
pag=1
prev=O196
I
obj='Var
pag=1
prev=O195
I
obj='Var
pag=1
prev=O194
I
obj='Var
pag=1
prev=O193
I
obj='Var
pag=1
prev=O192
I
obj='Var
pag=1
prev=O191
I
obj='Var
pag=1
prev=O190
I
obj='Var
pag=1
prev=O189
I
obj='Var
pag=1
prev=O188
I
obj='Var
pag=1
prev=O187
I
obj='Var
pag=1
prev=O186
I
obj='Var
pag=1
prev=O185
I
obj='Var
pag=1
prev=O184
I
obj='Var
pag=1
prev=O183
I
obj='Var
pag=1
prev=O182
I
obj='Var
pag=1
prev=O181
I
obj='Var
pag=1
prev=O180
I
obj='Var
obj_type='N
pag=1
prev=O179
I
obj='Var
obj_type='N
pag=1
prev=O178
I
obj='Var
pag=1
prev=O177
I
obj='Var
pag=1
prev=O176
I
obj='Var
obj_type='N
pag=1
prev=O175
I
obj='Var
obj_type='N
pag=1
prev=O174
I
obj='Var
obj_type='N
pag=1
prev=O173
I
obj='Var
pag=1
prev=O172
I
obj='Var
pag=1
prev=O171
I
obj='Var
pag=1
prev=O170
I
obj='Var
pag=1
prev=O169
I
obj='Var
pag=1
prev=O168
I
obj='Var
pag=1
prev=O167
I
obj='Var
obj_type='N
pag=1
prev=O166
I
obj='Var
obj_type='N
pag=1
prev=O165
I
obj='Var
obj_type='N
pag=1
prev=O164
I
obj='Var
pag=1
prev=O163
I
obj='Var
obj_type='N
pag=1
prev=O162
I
obj='Var
pag=1
prev=O161
I
obj='Var
pag=1
prev=O160
I
obj='Var
pag=1
prev=O159
I
obj='Var
obj_type='N
pag=1
prev=O158
I
obj='Var
obj_type='N
pag=1
prev=O157
I
obj='Var
obj_type='N
pag=1
prev=O156
I
obj='Var
obj_type='N
pag=1
prev=O155
I
obj='Var
pag=1
prev=O154
I
obj='Var
pag=1
prev=O153
I
obj='Var
pag=1
prev=O152
I
obj='Var
pag=1
prev=O151
I
obj='Var
pag=1
prev=O150
I
obj='Var
pag=1
prev=O149
I
obj='Var
pag=1
prev=O148
I
obj='Var
pag=1
prev=O147
I
obj='Var
pag=1
prev=O146
I
obj='Var
pag=1
prev=O145
I
obj='Var
pag=1
prev=O144
I
obj='Var
pag=1
prev=O143
I
obj='Var
pag=1
prev=O142
I
obj='Var
pag=1
prev=O141
I
obj='Var
pag=1
prev=O140
I
obj='Var
pag=1
prev=O139
I
obj='Var
pag=1
prev=O138
I
obj='Var
pag=1
prev=O137
I
obj='Var
pag=1
prev=O136
I
obj='Var
pag=1
prev=O135
I
obj='Var
pag=1
prev=O134
I
obj='Var
pag=1
prev=O133
I
obj='Var
obj_type='N
pag=1
prev=O132
I
obj='Var
obj_type='M
pag=1
prev=O131
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3
fatherSonIndex=0
len=1
name='w_tipodest
next=Icpitembatch.CPVarDecl
len=100
name='w_nomefile
next=Icpitembatch.CPVarDecl
len=5
name='w_codmage
obj='Var
pag=1
param=True
prev=O217
I
obj='Var
pag=1
param=True
prev=O216
I
obj='Var
pag=1
param=True
I
I
]
w=[
150
150
]
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Nuovo Rapporto
next=Icpitembatch.CPVarDecl
len=1
name='_nuovo
next=Icpitembatch.CPVarDecl
len=10
name='cProgRap
next=Icpitembatch.CPVarDecl
len=16
name='_codrap
next=Icpitembatch.CPRemark
frm_calc='Verifica Esistenza Rapporto
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='_xrapporto
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_nuovo
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_magecod
next=Icpitembatch.CPIfElse
frm_calc=[
'w_xMAFLGRAP='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_nuovo=0
]
h=[
19
19
]
obj='If
pag=2
prev=O228
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O231
fatherSonIndex=0
frm_calc='''
len=25
name='_xrapporto
next=Icpitembatch.CPRead
arch='knarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_xrapporto))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O237
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Scrittura Rapporto
father=O238
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Scrittura Dati Anagrafici Intestatario
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Scrittura Informazioni
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=2
prev=O247
var_op='asgn
I
obj='Begin
pag=2
prev=O245
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O247
fatherSonIndex=0
frm_calc=[
'Substr(riga,1,8) <> '00010101'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O252
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCon
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc=''3'
len=1
name='cFlagLire
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' informazioni del file '+LRTrim(w_nomefile)
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='D'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O266
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O267
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='rapopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_nummod
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_nummod = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O279
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O281
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='intestbo
h=[
19
19
]
obj='Insert
pag=2
prev=O286
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Substr(riga,1,8))
'cCli1
'cInfProg2
'_codrap
''0'
''0'
'Left(riga,8)+cInfProg2+'0'
'cCli1
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O287
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=2
prev=O294
var_op='asgn
I
obj='Exec
pag=2
prev=O293
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestbo
father=O281
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=2
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'_codrap
'_nummod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O298
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=2
prev=O306
var_op='asgn
I
obj='Exec
pag=2
prev=O305
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'NUMPROG1
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Left(riga,8))
'cInfProg2
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=2
prev=O278
sel_field='*
sel_name='intestbo
sel_order='intestbo->CPROWNUM
sel_where='intestbo->RAPPORTO=Substr(riga,17,16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O279
fatherSonIndex=0
frm_calc=[
'intestbo->CODINTER=cCli1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=2
prev=O315
var_op='asgn
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O315
fatherSonIndex=0
frm_calc='intestbo->CPROWNUM
len=10
name='_nummod
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O277
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O275
var_op='asgn
I
obj='Insert
pag=2
prev=O274
rd_kfield=[
'CDATOPE
'CODCAB
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOOPRAP
'UNIQUECODE
'VALUTA
'CDATREG
'CODDIPE
]
rd_kvar=[
'Substr(riga,1,8)
'_intercab
'_intercod
'xSOCTCF
'CharToDate(Substr(riga,1,8))
'Date()
'_intercit
'cFlagLire
''0'
'cInfProg1
'Left(riga,8)+cInfProg2+'0'
'cInfProg2
''2'
'nProgImp
'_interprv
'_codrap
''0'
''1'
'_intertip
''23'
'''
''242'
'DateToChar(Date())
'w_xMADIPSTD
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O275
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per l'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=2
prev=O329
var_op='asgn
I
obj='Exec
pag=2
prev=O328
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O273
var_op='asgn
I
obj='Var
pag=2
prev=O272
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O267
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGPINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xapopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_nummod
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_nummod = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O340
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O342
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='xntestbo
h=[
19
19
]
obj='Insert
pag=2
prev=O347
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Substr(riga,1,8))
'cCli1
'cInfProg2
'_codrap
''0'
''0'
'Left(riga,8)+cInfProg2+'0'
'cCli1
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O348
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=2
prev=O355
var_op='asgn
I
obj='Exec
pag=2
prev=O354
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestbo
father=O342
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=2
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'_codrap
'_nummod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O359
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=2
prev=O367
var_op='asgn
I
obj='Exec
pag=2
prev=O366
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'NUMPROG1
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Left(riga,8))
'cInfProg2
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=2
prev=O339
sel_field='*
sel_name='xntestbo
sel_order='xntestbo->CPROWNUM
sel_where='xntestbo->RAPPORTO=Substr(riga,17,16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O340
fatherSonIndex=0
frm_calc=[
'xntestbo->CODINTER=cCli1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=2
prev=O376
var_op='asgn
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O376
fatherSonIndex=0
frm_calc='xntestbo->CPROWNUM
len=10
name='_nummod
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O338
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O336
var_op='asgn
I
obj='Insert
pag=2
prev=O335
rd_kfield=[
'CDATOPE
'CODCAB
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOOPRAP
'UNIQUECODE
'VALUTA
'CDATREG
'CODDIPE
]
rd_kvar=[
'Substr(riga,1,8)
'_intercab
'_intercod
'xSOCTCF
'CharToDate(Substr(riga,1,8))
'Date()
'_intercit
'cFlagLire
''0'
'cInfProg1
'Left(riga,8)+cInfProg2+'0'
'cInfProg2
''2'
'nProgImp
'_interprv
'_codrap
''0'
''1'
'_intertip
''23'
'''
''242'
'DateToChar(Date())
'w_xMADIPSTD
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O336
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per l'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=2
prev=O390
var_op='asgn
I
obj='Exec
pag=2
prev=O389
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O334
var_op='asgn
I
obj='Var
pag=2
prev=O333
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O265
var_op='asgn
I
obj='Remark
pag=2
prev=O264
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O263
var_op='asgn
I
obj='Var
pag=2
prev=O262
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O261
var_op='asgn
I
obj='Var
pag=2
prev=O260
var_op='asgn
I
obj='Var
pag=2
prev=O259
var_op='asgn
I
obj='Var
pag=2
prev=O257
var_op='asgn
I
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O257
fatherSonIndex=0
frm_calc='_codinter
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='_citinter
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='_cabinter
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='_prvinter
len=2
name='_interprv
obj='Var
pag=2
prev=O398
var_op='asgn
I
obj='Var
pag=2
prev=O397
var_op='asgn
I
obj='Var
pag=2
prev=O396
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O243
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O245
fatherSonIndex=0
frm_calc='''
len=5
name='_oldmac
next=Icpitembatch.CPVarDecl
frm_calc='''
len=40
name='cSRES
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='cSRES2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,17,16)
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='''
len=70
name='_oldrag
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_oldrag))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,134,1)='M','1',iif(Substr(riga,134,1)='F','2',Substr(riga,134,1)))
len=1
name='xSesso
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,143,30)
len=30
name='xCitta
next=Icpitembatch.CPRead
arch='tbcitta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,143,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'(Substr(riga,506,1) = 'Z' or LRTrim(Substr(riga,193,30)) <> 'ITALIA') and Len(LRTrim(xSesso))=1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='xProvRes
next=Icpitembatch.CPRead
arch='tbcitta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,393,40)
len=40
name='cSRES
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='cSRES2
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPVarDecl
frm_calc='iif(Len(LRTrim(xSesso))=1,'P','G')
len=1
name='_tipper
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_oldrag))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O428
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O429
fatherSonIndex=0
frm_calc='Substr(riga,543,16)
len=16
name='xCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,17,16)
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOCLI\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='personbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_esito=0
]
h=[
19
19
]
obj='If
pag=2
prev=O437
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='personbo_agg
father=O439
fatherSonIndex=0
h=[
19
19
]
obj='Insert
pag=2
rd_kfield=[
'CONNES
'TELEFONO
'FLGEMAIL
'EMAIL
'FLGBANCA
]
rd_kvar=[
'Substr(riga,17,16)
'Substr(riga,668,25)
'iif(At(Upper(Substr(riga,667,1)),'|S|Y') <> 0,'S','N')
'LRTrim(Substr(riga,642,25))
''S'
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O444
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per il soggetto: "+LRTrim(Substr(riga,34,100))+" con codice fiscale: "+LRTrim(Substr(riga,543,16))+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
obj='Exec
pag=2
prev=O452
I
obj='Var
obj_type='N
pag=2
prev=O451
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O450
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=2
prev=O436
rd_kfield=[
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'DATAVALI
'AUTRILASC
'DESCCIT
'PROVINCIA
'CAP
'SESSO
'PAESE
'TIPOPERS
'COGNOME
'NOME
'TIPINTER
'NASSTATO
'ALLINEATO
'ALLINEATONOMECNOME
'PROGIMPORT
]
rd_kvar=[
'Substr(riga,17,16)
'xCodCab
'LRTrim(Substr(riga,34,50))+" "+LRTrim(Substr(riga,84,50))
'Substr(riga,243,35)
'xCF
'CharToDate(Substr(riga,135,8))
'cCNAS
''600'
'''
''600'
'Substr(riga,559,2)
'Substr(riga,561,15)
'CharToDate(Substr(riga,576,8))
'CharToDate(Substr(riga,584,8))
'Substr(riga,592,30)
'Substr(riga,343,30)
'xProvRes
'Substr(riga,443,9)
'xSesso
'cSRES2
'_tipper
'LRTrim(Substr(riga,34,26))
'LRTrim(Substr(riga,84,25))
'cPNAS
'cSNAS
'0
'0
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O437
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per il soggetto: "+LRTrim(Substr(riga,34,100))+" con codice fiscale: "+LRTrim(Substr(riga,543,16))+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
obj='Exec
pag=2
prev=O462
I
obj='Var
obj_type='N
pag=2
prev=O461
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O460
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O435
var_op='asgn
I
obj='Var
pag=2
prev=O434
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O429
fatherSonIndex=1
frm_calc='0
len=1
name='_aggcli
next=Icpitembatch.CPCase
frm_calc=[
'LRTrim(w_codmage)='COSTA'
'w_codmage='FININ'
'w_codmage='BCAUC'
'w_codmage='BCISP'
'w_codmage='BCASS' or LRTrim(w_codmage)='E998' or LRTrim(w_codmage)='EBDSS' or LRTrim(w_codmage)='I999'
'w_codmage='DHLSP'
'w_codmage='TRAVX'
]
h=[
19
19
19
19
19
19
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_aggcli = 1
]
h=[
19
19
]
obj='If
pag=2
prev=O467
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O470
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='personbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_connes
next=Icpitembatch.CPRead
arch='personbo_agg
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_connes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O481
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='personbo_agg
father=O482
fatherSonIndex=0
h=[
19
19
]
obj='Insert
pag=2
rd_kfield=[
'CONNES
'TELEFONO
'FLGEMAIL
'EMAIL
'FLGBANCA
]
rd_kvar=[
'xConnes
'Substr(riga,668,25)
'iif(At(Upper(Substr(riga,667,1)),'|S|Y') <> 0,'S','N')
'LRTrim(Substr(riga,642,25))
''S'
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O487
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per il soggetto: "+LRTrim(Substr(riga,34,100))+" con codice fiscale: "+LRTrim(Substr(riga,543,16))+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
obj='Exec
pag=2
prev=O495
I
obj='Var
obj_type='N
pag=2
prev=O494
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O493
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='personbo_agg
father=O482
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=2
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'xConnes
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O499
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per il soggetto: "+LRTrim(Substr(riga,34,100))+" con codice fiscale: "+LRTrim(Substr(riga,543,16))+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
obj='Exec
pag=2
prev=O508
I
obj='Var
obj_type='N
pag=2
prev=O507
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O506
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'TELEFONO
'FLGEMAIL
'EMAIL
'FLGBANCA
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,668,25)
'iif(At(Upper(Substr(riga,667,1)),'|S|Y') <> 0,'S','N')
'LRTrim(Substr(riga,642,25))
''S'
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O480
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'_connes
]
I
obj='Var
pag=2
prev=O478
var_op='asgn
I
obj='Write
pag=2
prev=O476
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'xConnes
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O478
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per il soggetto: "+LRTrim(Substr(riga,34,100))+" con codice fiscale: "+LRTrim(Substr(riga,543,16))+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
obj='Exec
pag=2
prev=O526
I
obj='Var
obj_type='N
pag=2
prev=O525
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O524
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'CAP
'SESSO
'PAESE
'DATAVALI
'TIPOPERS
'COGNOME
'NOME
'TIPINTER
'NASSTATO
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xCodCab
'Left(LRTrim(Substr(riga,34,50))+" "+LRTrim(Substr(riga,84,50)),70)
'Substr(riga,243,35)
'Substr(riga,543,16)
'CharToDate(Substr(riga,135,8))
'cCNAS
''600'
'''
''600'
'Substr(riga,559,2)
'Substr(riga,561,15)
'CharToDate(Substr(riga,576,8))
'Substr(riga,592,30)
'Substr(riga,343,30)
'xProvRes
'Substr(riga,443,9)
'xSesso
'cSRES2
'CharToDate(Substr(riga,584,8))
'_tipper
'LRTrim(Substr(riga,34,26))
'LRTrim(Substr(riga,84,25))
'cPNAS
'cSNAS
]
I
obj='Select
pag=2
prev=O475
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O476
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'datamodi
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
]
rd_kvar=[
'cProgSto
'xConnes
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'Date()
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Case
pag=2
prev=O466
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O467
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O467
fatherSonIndex=1
frm_calc=[
'_oldmac <> 'COSTA'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O543
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O467
fatherSonIndex=2
frm_calc=[
'_oldmac <> 'COSTA' and _oldmac <> 'FININ'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O551
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O467
fatherSonIndex=3
frm_calc=[
'_oldmac <> 'COSTA' and _oldmac <> 'FININ' and _oldmac <> 'BCAUC'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O559
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O467
fatherSonIndex=4
frm_calc=[
'_oldmac <> 'COSTA' and _oldmac <> 'FININ' and _oldmac <> 'BCAUC' and _oldmac <> 'BCISP'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O567
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O467
fatherSonIndex=5
frm_calc=[
'_oldmac = 'TRAVX' or _oldmac='DHLSP'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O575
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O467
fatherSonIndex=6
frm_calc=[
'_oldmac='TRAVX'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O583
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
150
150
150
150
150
]
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O427
var_op='asgn
I
obj='Read
pag=2
prev=O426
rd_field=[
'CODSTA
]
rd_kfield=[
'DESCRI
]
rd_kvar=[
'cSRES
]
rd_var=[
'cSRES2
]
I
obj='Var
pag=2
prev=O425
var_op='asgn
I
obj='Var
pag=2
prev=O424
var_op='asgn
I
obj='Read
pag=2
prev=O423
rd_field=[
'CAB
'PROV
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'Substr(riga,343,30)
]
rd_var=[
'xCodCab
'xProvRes
]
I
obj='Var
pag=2
prev=O420
var_op='asgn
I
obj='If
pag=2
prev=O419
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O420
fatherSonIndex=0
frm_calc=''EE'
len=2
name='cPNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,193,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=2
prev=O603
var_op='asgn
I
obj='Var
pag=2
prev=O602
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O418
var_op='asgn
I
obj='Var
pag=2
prev=O417
var_op='asgn
I
obj='Read
pag=2
prev=O416
rd_field=[
'PROV
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'xCitta
]
rd_var=[
'cPNAS
]
I
obj='Var
pag=2
prev=O415
var_op='asgn
I
obj='Var
pag=2
prev=O412
var_op='asgn
I
obj='If
pag=2
prev=O411
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O412
fatherSonIndex=0
frm_calc='''
len=70
name='_oldrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xConnes
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=2
prev=O613
rd_field=[
'CODFISC
'MACROAGENTE
'CONNES
'RAGSOC
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'Substr(riga,495,16)
]
rd_var=[
'xCF
'_oldmac
'xConnes
'_oldrag
]
I
obj='Var
pag=2
prev=O612
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=2
prev=O410
rd_field=[
'CODFISC
'MACROAGENTE
'RAGSOC
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,17,16)
]
rd_var=[
'xCF
'_oldmac
'_oldrag
]
I
obj='Var
pag=2
prev=O409
var_op='asgn
I
obj='Var
pag=2
prev=O408
var_op='asgn
I
obj='Var
pag=2
prev=O407
var_op='asgn
I
obj='Var
pag=2
prev=O406
var_op='asgn
I
obj='Var
pag=2
prev=O405
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O243
fatherSonIndex=0
frm_calc=[
'w_xMAFLGRAP='S'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='D'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_esito = 0
]
h=[
19
19
]
obj='If
pag=2
prev=O631
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O634
fatherSonIndex=0
frm_calc='''
len=25
name='_xrapporto
next=Icpitembatch.CPRead
arch='knarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_xrapporto))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O640
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='knarapbo
father=O641
fatherSonIndex=0
h=[
19
19
]
obj='Insert
pag=2
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
]
rd_kvar=[
'_codrap
'Left(LRTrim(Substr(riga,34,50))+" "+LRTrim(Substr(riga,84,50)),50)
'w_tipodest
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O646
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per il rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=2
prev=O653
var_op='asgn
I
obj='Exec
pag=2
prev=O652
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='knarapbo
father=O641
fatherSonIndex=1
obj='Write
pag=2
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'_codrap
]
wr_field=[
'DESCRAP
'TIPORAP
]
wr_op=[
'=
'=
]
wr_var=[
'Left(LRTrim(Substr(riga,34,50))+" "+LRTrim(Substr(riga,84,50)),50)
'w_tipodest
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O639
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Substr(riga,17,16)
]
rd_var=[
'_xrapporto
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O630
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anarapbo
father=O631
fatherSonIndex=0
h=[
19
19
]
obj='Insert
pag=2
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'NOPROT
'PRGIMPRAP
'TIPOAG
'MACODICE
]
rd_kvar=[
'_codrap
'Left(LRTrim(Substr(riga,34,50))+" "+LRTrim(Substr(riga,84,50)),50)
''0'
''E'
''242'
'1
'nProgImp
''99'
'w_codmage
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O672
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per il rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=2
prev=O679
var_op='asgn
I
obj='Exec
pag=2
prev=O678
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xnarapbo
father=O631
fatherSonIndex=1
h=[
19
19
]
obj='Insert
pag=2
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'NOPROT
'PRGIMPRAP
'TIPOAG
'MACODICE
]
rd_kvar=[
'_codrap
'Left(LRTrim(Substr(riga,34,50))+" "+LRTrim(Substr(riga,84,50)),50)
''0'
''E'
''242'
'1
'nProgImp
''99'
'w_codmage
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O683
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per il rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=2
prev=O690
var_op='asgn
I
obj='Exec
pag=2
prev=O689
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O627
var_op='asgn
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O627
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRG"+LRTrim(w_codmage)+"\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProgRap
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(w_codmage)+cProgRap
len=16
name='_codrap
next=Icpitembatch.CPInsert
arch='wurapporti
obj='Insert
pag=2
prev=O697
rd_kfield=[
'RWMACAGE
'RWCODRAP
'RWCODFIS
]
rd_kvar=[
'w_codmage
'cProgRap
'Substr(riga,17,16)
]
I
obj='Var
pag=2
pagelocal=True
prev=O696
var_op='asgn
I
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O627
fatherSonIndex=1
frm_calc='Substr(riga,17,16)
len=16
name='_codrap
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O238
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGWUCHKUNC\'"+LRTrim(gAzienda)+"'",0,10)
len=10
name='eProg
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,143,30)
len=30
name='xCitta
next=Icpitembatch.CPRead
arch='tbcitta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,143,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'(Substr(riga,506,1) = 'Z' or LRTrim(Substr(riga,193,30)) <> 'ITALIA') and Len(LRTrim(xSesso))=1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='xProvRes
next=Icpitembatch.CPRead
arch='tbcitta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,393,40)
len=40
name='cSRES
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='cSRES2
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPInsert
arch='wuchkunicr
next=Icpitembatch.CPVarDecl
frm_calc='cNumSca + 1
len=10
name='cNumSca
obj='Var
obj_type='N
pag=2
prev=O719
var_op='asgn
I
obj='Insert
pag=2
prev=O718
rd_kfield=[
'WUCODICE
'WUNOMEFILE
'WUDATINI
'WUDATFIN
'WUCODRAP
'WUNOMCLI
'WUCOGCLI
'WUCITCLI
'WUCAPCLI
'WUINDCLI
'WUBCITCLI
'WUBSTACLI
'WUDATNAS
'WUSEXCLI
'WUCODFIS
'WUTDOCCLI
'WUNDOCCLI
'WUADOCRIL
'WURDOCCLI
'WUSDOCCLI
'WUPROVCLI
'WUTELEFONO
'WUFLGMAIL
'WUEMAIL
'WUNOTE
'WUSTACLI
]
rd_kvar=[
'eProg
'LRTrim(w_nomefile)
'iif(Substr(riga,1,8)='00010101',NullDate(),CharToDate(Substr(riga,1,8)))
'iif(Substr(riga,9,8)='00010101',NullDate(),CharToDate(Substr(riga,9,8)))
'Substr(riga,17,16)
'LRTrim(Substr(riga,84,25))
'LRTrim(Substr(riga,34,26))
'Substr(riga,343,30)
'Substr(riga,443,5)
'Substr(riga,243,35)
'cCNAS
'cSNAS
'arfn_fdate(iif(Substr(riga,125,8)='00010101',NullDate(),CharToDate(Substr(riga,135,8))))
'Substr(riga,134,1)
'Substr(riga,543,16)
'Substr(riga,559,2)
'Substr(riga,561,15)
'Substr(riga,592,30)
'arfn_fdate(iif(Substr(riga,576,8)='00010101',NullDate(),CharToDate(Substr(riga,576,8))))
'arfn_fdate(iif(Substr(riga,584,8)='00010101',NullDate(),CharToDate(Substr(riga,584,8))))
'xProvRes
'Substr(riga,668,25)
'Substr(riga,667,1)
'LRTrim(Substr(riga,642,25))
''Inserimento di nuovo rapporto già presente su archivio UNICO'
'cSRES
]
I
obj='Read
pag=2
prev=O717
rd_field=[
'CODSTA
]
rd_kfield=[
'DESCRI
]
rd_kvar=[
'cSRES
]
rd_var=[
'cSRES2
]
I
obj='Var
pag=2
prev=O716
var_op='asgn
I
obj='Var
pag=2
prev=O715
var_op='asgn
I
obj='Read
pag=2
prev=O714
rd_field=[
'CAB
'PROV
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'Substr(riga,343,30)
]
rd_var=[
'xCodCab
'xProvRes
]
I
obj='Var
pag=2
prev=O711
var_op='asgn
I
obj='If
pag=2
prev=O710
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O711
fatherSonIndex=0
frm_calc='Substr(riga,193,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=2
prev=O733
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O709
var_op='asgn
I
obj='Var
pag=2
prev=O708
var_op='asgn
I
obj='Read
pag=2
prev=O707
rd_field=[
'PROV
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'xCitta
]
rd_var=[
'cPNAS
]
I
obj='Var
pag=2
prev=O706
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O236
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Substr(riga,17,16)
]
rd_var=[
'_xrapporto
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O227
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O228
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(xRapporto)) <> 0 and Left(xRapporto,5)=w_codmage
]
h=[
19
19
]
obj='If
pag=2
prev=O748
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O750
fatherSonIndex=0
frm_calc='1
len=1
name='_nuovo
obj='Var
obj_type='N
pag=2
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=2
sel_field='*
sel_name='intestbo
sel_where='intestbo->CODINTER=Substr(riga,17,16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anarapbo
father=O748
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'_magecod=w_codmage
]
h=[
19
19
]
obj='If
pag=2
prev=O759
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O760
fatherSonIndex=0
frm_calc='intestbo->RAPPORTO
len=25
name='_xrapporto
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=2
rd_field=[
'MACODICE
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'intestbo->RAPPORTO
]
rd_var=[
'_magecod
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
pagelocal=True
prev=O226
var_op='asgn
I
obj='Var
obj_type='N
pag=2
pagelocal=True
prev=O225
var_op='asgn
I
obj='Var
pag=2
prev=O224
var_op='asgn
I
obj='Remark
pag=2
prev=O223
I
obj='Var
pag=2
pagelocal=True
prev=O222
I
obj='Var
pag=2
pagelocal=True
prev=O221
I
obj='Var
obj_type='N
pag=2
pagelocal=True
prev=O220
I
obj='Remark
pag=2
x=18
y=24
I
Icpitembatch.CPBeginEnd
comment='Definizione variabili di pagina
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Scrittura Informazioni
h=[
19
19
]
obj='Begin
pag=4
prev=O773
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O775
fatherSonIndex=0
frm_calc='''
len=25
name='_xrapclose
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_xtiprap
next=Icpitembatch.CPIfElse
frm_calc=[
'w_xMAFLGRAP='S'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_xrapclose)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
prev=O784
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O786
fatherSonIndex=0
frm_calc=[
'Substr(riga,9,8) <> '00010101'
]
h=[
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Aggiorna Soggetto
father=O791
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Dati intermediario
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xCF
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCon
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc=''3'
len=1
name='cFlagLire
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' informazioni del file '+LRTrim(w_nomefile)
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'_xtiprap='D'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
prev=O809
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O810
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='rapopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_nummod
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_nummod = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
prev=O822
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O824
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='intestbo
h=[
19
19
]
obj='Insert
pag=4
prev=O829
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAFINE
'CODINTER
'NUMPROG2
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Substr(riga,9,8))
'xConnes
'cInfProg2
'Substr(riga,17,16)
''0'
''0'
'Substr(riga,9,8)+cInfProg2+'0'
'cCli1
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O830
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=4
prev=O837
var_op='asgn
I
obj='Exec
pag=4
prev=O836
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestbo
father=O824
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,17,16)
'_nummod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O841
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=4
prev=O849
var_op='asgn
I
obj='Exec
pag=4
prev=O848
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Left(riga,8))
'cInfProg2
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=4
prev=O821
sel_field='*
sel_name='intestbo
sel_order='intestbo->CPROWNUM
sel_where='intestbo->RAPPORTO=Substr(riga,17,16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O822
fatherSonIndex=0
frm_calc=[
'intestbo->CODINTER=xConnes
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=4
prev=O858
var_op='asgn
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O858
fatherSonIndex=0
frm_calc='intestbo->CPROWNUM
len=10
name='_nummod
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O820
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O818
var_op='asgn
I
obj='Insert
pag=4
prev=O817
rd_kfield=[
'CDATOPE
'CODCAB
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'VALUTA
'CDATREG
]
rd_kvar=[
'Substr(riga,9,8)
'_intercab
'_intercod
'xSOCTCF
'CharToDate(Substr(riga,9,8))
'Date()
'_intercit
'cFlagLire
''0'
'cInfProg1
'Substr(riga,9,8)+cInfProg2+'0'
'cInfProg2
''2'
'nProgImp
'_interprv
'Substr(riga,17,16)
''0'
''1'
'_intertip
''0'
''26'
'''
''242'
'DateToChar(Date())
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O818
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per l'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=4
prev=O872
var_op='asgn
I
obj='Exec
pag=4
prev=O871
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O816
var_op='asgn
I
obj='Var
pag=4
prev=O815
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O810
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGPINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xapopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_nummod
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_nummod = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
prev=O883
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O885
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='xntestbo
h=[
19
19
]
obj='Insert
pag=4
prev=O890
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAFINE
'CODINTER
'NUMPROG2
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Substr(riga,9,8))
'xConnes
'cInfProg2
'Substr(riga,17,16)
''0'
''0'
'Substr(riga,9,8)+cInfProg2+'0'
'cCli1
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O891
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=4
prev=O898
var_op='asgn
I
obj='Exec
pag=4
prev=O897
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xntestbo
father=O885
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,17,16)
'_nummod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O902
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=4
prev=O910
var_op='asgn
I
obj='Exec
pag=4
prev=O909
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Substr(riga,9,8))
'cInfProg2
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=4
prev=O882
sel_field='*
sel_name='xntestbo
sel_order='xntestbo->CPROWNUM
sel_where='xntestbo->RAPPORTO=Substr(riga,17,16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O883
fatherSonIndex=0
frm_calc=[
'xntestbo->CODINTER=xConnes
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=4
prev=O919
var_op='asgn
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O919
fatherSonIndex=0
frm_calc='xntestbo->CPROWNUM
len=10
name='_nummod
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O881
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O879
var_op='asgn
I
obj='Insert
pag=4
prev=O878
rd_kfield=[
'CDATOPE
'CODCAB
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'VALUTA
'CDATREG
]
rd_kvar=[
'Substr(riga,9,8)
'_intercab
'_intercod
'xSOCTCF
'CharToDate(Substr(riga,9,8))
'Date()
'_intercit
'cFlagLire
''0'
'cInfProg1
'Substr(riga,9,8)+cInfProg2+'0'
'cInfProg2
''2'
'nProgImp
'_interprv
'Substr(riga,17,16)
''0'
''1'
'_intertip
''0'
''26'
'''
''242'
'DateToChar(Date())
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O879
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per l'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=4
prev=O933
var_op='asgn
I
obj='Exec
pag=4
prev=O932
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O877
var_op='asgn
I
obj='Var
pag=4
prev=O876
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=4
prev=O808
var_op='asgn
I
obj='Remark
pag=4
prev=O807
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O806
var_op='asgn
I
obj='Var
pag=4
prev=O805
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O804
var_op='asgn
I
obj='Var
pag=4
prev=O803
var_op='asgn
I
obj='Var
pag=4
prev=O802
var_op='asgn
I
obj='Var
pag=4
prev=O801
var_op='asgn
I
obj='Read
pag=4
prev=O800
rd_field=[
'CODFISC
'MACROAGENTE
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'xCF
'_oldmac
]
I
obj='Var
pag=4
prev=O798
var_op='asgn
I
obj='Begin
pag=4
prev=O796
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O798
fatherSonIndex=0
frm_calc='_codinter
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='_citinter
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='_cabinter
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='_prvinter
len=2
name='_interprv
obj='Var
pag=4
prev=O945
var_op='asgn
I
obj='Var
pag=4
prev=O944
var_op='asgn
I
obj='Var
pag=4
prev=O943
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O796
fatherSonIndex=0
frm_calc='''
len=5
name='_oldmac
next=Icpitembatch.CPVarDecl
frm_calc='''
len=70
name='_oldrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xCF
next=Icpitembatch.CPVarDecl
frm_calc='''
len=70
name='_oldcon
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,17,16)
len=16
name='xConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_oldrag))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_aggcli
next=Icpitembatch.CPCase
frm_calc=[
'LRTrim(w_codmage)='COSTA'
'w_codmage='FININ'
'w_codmage='BCAUC'
'w_codmage='BCISP'
'w_codmage='BCASS' or LRTrim(w_codmage)='E998' or LRTrim(w_codmage)='EBDSS' or LRTrim(w_codmage)='I999'
'w_codmage='DHLSP'
'w_codmage='TRAVX'
]
h=[
19
19
19
19
19
19
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_aggcli = 1
]
h=[
19
19
]
obj='If
pag=4
prev=O960
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O963
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=40
name='cSRES
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='cSRES2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xCF
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,134,1)='M','1',iif(Substr(riga,134,1)='F','2',Substr(riga,134,1)))
len=1
name='xSesso
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,143,30)
len=30
name='xCitta
next=Icpitembatch.CPRead
arch='tbcitta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,143,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'(Substr(riga,554,1) = 'Z' or LRTrim(Substr(riga,193,30)) <> 'ITALIA') and Len(LRTrim(xSesso))=1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,393,40)
len=40
name='cSRES
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='cSRES2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='xProvRes
next=Icpitembatch.CPRead
arch='tbcitta
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPVarDecl
frm_calc='iif(Len(LRTrim(xSesso))=1,'P','G')
len=1
name='_tipper
next=Icpitembatch.CPWrite
arch='personbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_connes
next=Icpitembatch.CPRead
arch='personbo_agg
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_connes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
prev=O992
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='personbo_agg
father=O993
fatherSonIndex=0
h=[
19
19
]
obj='Insert
pag=4
rd_kfield=[
'CONNES
'TELEFONO
'FLGEMAIL
'EMAIL
'FLGBANCA
]
rd_kvar=[
'xConnes
'Substr(riga,668,25)
'iif(At(Upper(Substr(riga,667,1)),'|S|Y') <> 0,'S','N')
'LRTrim(Substr(riga,642,25))
''S'
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O998
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per il soggetto: "+LRTrim(Substr(riga,34,100))+" con codice fiscale: "+LRTrim(Substr(riga,543,16))+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
obj='Exec
pag=4
prev=O1006
I
obj='Var
obj_type='N
pag=4
prev=O1005
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O1004
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='personbo_agg
father=O993
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=4
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'xConnes
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1010
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per il soggetto: "+LRTrim(Substr(riga,34,100))+" con codice fiscale: "+LRTrim(Substr(riga,543,16))+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
obj='Exec
pag=4
prev=O1019
I
obj='Var
obj_type='N
pag=4
prev=O1018
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O1017
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'FLGBANCA
'TELEFONO
'FLGEMAIL
'EMAIL
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
''S'
'Substr(riga,668,25)
'iif(At(Upper(Substr(riga,667,1)),'|S|Y') <> 0,'S','N')
'LRTrim(Substr(riga,642,25))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=4
prev=O991
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'_connes
]
I
obj='Var
pag=4
prev=O989
var_op='asgn
I
obj='Write
pag=4
prev=O988
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'xConnes
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O989
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per il soggetto: "+LRTrim(Substr(riga,34,100))+" con codice fiscale: "+LRTrim(Substr(riga,543,16))+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
obj='Exec
pag=4
prev=O1037
I
obj='Var
obj_type='N
pag=4
prev=O1036
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O1035
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'CAP
'SESSO
'PAESE
'DATAVALI
'TIPOPERS
'COGNOME
'NOME
'TIPINTER
'NASSTATO
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xCodCab
'Left(LRTrim(Substr(riga,34,50))+" "+LRTrim(Substr(riga,84,50)),70)
'Substr(riga,243,35)
'xCF
'CharToDate(Substr(riga,135,8))
'cCNAS
''600'
'''
''600'
'Substr(riga,559,2)
'Substr(riga,561,15)
'CharToDate(Substr(riga,576,8))
'Substr(riga,592,30)
'Substr(riga,343,30)
'xProvRes
'Substr(riga,443,9)
'xSesso
'cSRES2
'CharToDate(Substr(riga,584,8))
'_tipper
'LRTrim(Substr(riga,34,26))
'LRTrim(Substr(riga,84,25))
'cPNAS
'cSNAS
]
I
obj='Var
pag=4
prev=O987
var_op='asgn
I
obj='Read
pag=4
prev=O986
rd_field=[
'CODSTA
]
rd_kfield=[
'DESCRI
]
rd_kvar=[
'cSRES
]
rd_var=[
'cSRES2
]
I
obj='Read
pag=4
prev=O985
rd_field=[
'CAB
'PROV
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'Substr(riga,343,30)
]
rd_var=[
'xCodCab
'xProvRes
]
I
obj='Var
pag=4
prev=O984
var_op='asgn
I
obj='Var
pag=4
prev=O983
var_op='asgn
I
obj='Var
pag=4
prev=O980
var_op='asgn
I
obj='If
pag=4
prev=O979
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O980
fatherSonIndex=0
frm_calc=''EE'
len=2
name='cPNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,193,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=4
prev=O1054
var_op='asgn
I
obj='Var
pag=4
prev=O1053
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
prev=O978
var_op='asgn
I
obj='Var
pag=4
prev=O977
var_op='asgn
I
obj='Read
pag=4
prev=O976
rd_field=[
'PROV
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'xCitta
]
rd_var=[
'cPNAS
]
I
obj='Var
pag=4
prev=O975
var_op='asgn
I
obj='Var
pag=4
prev=O974
var_op='asgn
I
obj='Read
pag=4
prev=O973
rd_field=[
'CODFISC
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'xCF
]
I
obj='Var
pag=4
prev=O972
var_op='asgn
I
obj='Var
pag=4
prev=O971
var_op='asgn
I
obj='Var
pag=4
prev=O969
var_op='asgn
I
obj='Select
pag=4
prev=O968
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O969
fatherSonIndex=0
obj='Insert
pag=4
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'datamodi
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
]
rd_kvar=[
'cProgSto
'xConnes
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'Date()
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Case
pag=4
prev=O959
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O960
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O960
fatherSonIndex=1
frm_calc=[
'_oldmac <> 'COSTA'
]
h=[
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1076
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O960
fatherSonIndex=2
frm_calc=[
'_oldmac <> 'COSTA' and _oldmac <> 'FININ'
]
h=[
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1084
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O960
fatherSonIndex=3
frm_calc=[
'_oldmac <> 'COSTA' and _oldmac <> 'FININ' and _oldmac <> 'BCAUC'
]
h=[
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1092
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O960
fatherSonIndex=4
frm_calc=[
'_oldmac <> 'COSTA' and _oldmac <> 'FININ' and _oldmac <> 'BCAUC' and _oldmac <> 'BCISP'
]
h=[
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1100
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O960
fatherSonIndex=5
frm_calc=[
'_oldmac = 'TRAVX' or _oldmac='DHLSP'
]
h=[
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1108
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O960
fatherSonIndex=6
frm_calc=[
'_oldmac='TRAVX'
]
h=[
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1116
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
150
150
150
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O956
var_op='asgn
I
obj='If
pag=4
prev=O955
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O956
fatherSonIndex=0
frm_calc='''
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_oldmac
next=Icpitembatch.CPVarDecl
frm_calc='''
len=70
name='_oldrag
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=4
prev=O1128
rd_field=[
'MACROAGENTE
'RAGSOC
'CODFISC
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'Substr(riga,543,16)
]
rd_var=[
'_oldmac
'_oldrag
'xCF
'xConnes
]
I
obj='Var
pag=4
prev=O1127
var_op='asgn
I
obj='Var
pag=4
prev=O1126
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
prev=O954
rd_field=[
'MACROAGENTE
'RAGSOC
'CONNES
'CODFISC
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,17,16)
]
rd_var=[
'_oldmac
'_oldrag
'_oldcon
'xCF
]
I
obj='Var
pag=4
prev=O953
var_op='asgn
I
obj='Var
pag=4
prev=O952
var_op='asgn
I
obj='Var
pag=4
prev=O951
var_op='asgn
I
obj='Var
pag=4
prev=O950
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O786
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGWUCHKUNC\'"+LRTrim(gAzienda)+"'",0,10)
len=10
name='eProg
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,143,30)
len=30
name='xCitta
next=Icpitembatch.CPRead
arch='tbcitta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,143,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'(Substr(riga,506,1) = 'Z' or LRTrim(Substr(riga,193,30)) <> 'ITALIA') and Len(LRTrim(xSesso))=1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='xProvRes
next=Icpitembatch.CPRead
arch='tbcitta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,393,40)
len=40
name='cSRES
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='cSRES2
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPInsert
arch='wuchkunicr
next=Icpitembatch.CPVarDecl
frm_calc='cNumSca + 1
len=10
name='cNumSca
obj='Var
obj_type='N
pag=4
prev=O1155
var_op='asgn
I
obj='Insert
pag=4
prev=O1154
rd_kfield=[
'WUCODICE
'WUNOMEFILE
'WUDATINI
'WUDATFIN
'WUCODRAP
'WUNOMCLI
'WUCOGCLI
'WUCITCLI
'WUCAPCLI
'WUINDCLI
'WUBCITCLI
'WUBSTACLI
'WUDATNAS
'WUSEXCLI
'WUCODFIS
'WUTDOCCLI
'WUNDOCCLI
'WUADOCRIL
'WURDOCCLI
'WUSDOCCLI
'WUPROVCLI
'WUTELEFONO
'WUFLGMAIL
'WUEMAIL
'WUNOTE
'WUSTACLI
]
rd_kvar=[
'eProg
'LRTrim(w_nomefile)
'iif(Substr(riga,1,8)='00010101',NullDate(),CharToDate(Substr(riga,1,8)))
'iif(Substr(riga,9,8)='00010101',NullDate(),CharToDate(Substr(riga,9,8)))
'Substr(riga,17,16)
'LRTrim(Substr(riga,84,25))
'LRTrim(Substr(riga,34,26))
'Substr(riga,343,30)
'Substr(riga,443,5)
'Substr(riga,243,35)
'cCNAS
'cSNAS
'arfn_fdate(iif(Substr(riga,125,8)='00010101',NullDate(),CharToDate(Substr(riga,135,8))))
'Substr(riga,134,1)
'Substr(riga,543,16)
'Substr(riga,559,2)
'Substr(riga,561,15)
'Substr(riga,592,30)
'arfn_fdate(iif(Substr(riga,576,8)='00010101',NullDate(),CharToDate(Substr(riga,576,8))))
'arfn_fdate(iif(Substr(riga,584,8)='00010101',NullDate(),CharToDate(Substr(riga,584,8))))
'xProvRes
'Substr(riga,668,25)
'Substr(riga,667,1)
'LRTrim(Substr(riga,642,25))
''Chiusura di un rapporto non esistente in Archivio Unico'
'cSRES
]
I
obj='Read
pag=4
prev=O1153
rd_field=[
'CODSTA
]
rd_kfield=[
'DESCRI
]
rd_kvar=[
'cSRES
]
rd_var=[
'cSRES2
]
I
obj='Var
pag=4
prev=O1152
var_op='asgn
I
obj='Var
pag=4
prev=O1151
var_op='asgn
I
obj='Read
pag=4
prev=O1150
rd_field=[
'CAB
'PROV
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'Substr(riga,343,30)
]
rd_var=[
'xCodCab
'xProvRes
]
I
obj='Var
pag=4
prev=O1147
var_op='asgn
I
obj='If
pag=4
prev=O1146
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1147
fatherSonIndex=0
frm_calc='Substr(riga,193,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=4
prev=O1169
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
prev=O1145
var_op='asgn
I
obj='Var
pag=4
prev=O1144
var_op='asgn
I
obj='Read
pag=4
prev=O1143
rd_field=[
'PROV
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'xCitta
]
rd_var=[
'cPNAS
]
I
obj='Var
pag=4
prev=O1142
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=4
prev=O781
sel_field='*
sel_name='knarapbo
sel_where='knarapbo->RAPPORTO=_xrapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O784
fatherSonIndex=0
frm_calc='knarapbo->RAPPORTO
len=25
name='_xrapclose
next=Icpitembatch.CPVarDecl
frm_calc='knarapbo->TIPORAP
len=1
name='_xtiprap
obj='Var
pag=4
pagelocal=True
prev=O1179
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O780
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O781
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=4
sel_field='*
sel_name='intestbo
sel_where='intestbo->CODINTER=Substr(riga,17,16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anarapbo
father=O1184
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'_magecod=w_codmage
]
h=[
19
19
]
obj='If
pag=4
prev=O1188
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1189
fatherSonIndex=0
frm_calc='intestbo->RAPPORTO
len=25
name='_xrapporto
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
rd_field=[
'MACODICE
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'intestbo->RAPPORTO
]
rd_var=[
'_magecod
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O781
fatherSonIndex=1
frm_calc='Substr(riga,17,16)
len=25
name='_xrapporto
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=4
pagelocal=True
prev=O779
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O773
fatherSonIndex=0
len=25
name='_xrapclose
next=Icpitembatch.CPVarDecl
len=1
name='_xtiprap
obj='Var
pag=4
pagelocal=True
prev=O1207
I
obj='Var
pag=4
pagelocal=True
I
I
]
w=[
150
150
]
x=21
y=21
I
Icpitembatch.CPBeginEnd
comment='Definizione variabili di pagina
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna Rapporto
h=[
19
19
]
obj='Begin
pag=3
prev=O1210
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1212
fatherSonIndex=0
frm_calc='''
len=25
name='_xrapmod
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_xtipmod
next=Icpitembatch.CPVarDecl
frm_calc=''N'
len=1
name='_errmod
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_errmsg
next=Icpitembatch.CPIfElse
frm_calc=[
'w_xMAFLGRAP='S'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_xrapmod)))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_errmod = 'S'
]
h=[
19
19
]
obj='If
pag=3
prev=O1225
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1228
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGWUCHKUNC\'"+LRTrim(gAzienda)+"'",0,10)
len=10
name='eProg
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,143,30)
len=30
name='xCitta
next=Icpitembatch.CPRead
arch='tbcitta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,143,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'(Substr(riga,554,1) = 'Z' or LRTrim(Substr(riga,193,30)) <> 'ITALIA') and Len(LRTrim(xSesso))=1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='xProvRes
next=Icpitembatch.CPRead
arch='tbcitta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,393,40)
len=40
name='cSRES
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='cSRES2
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPInsert
arch='wuchkunicr
next=Icpitembatch.CPVarDecl
frm_calc='cNumSca + 1
len=10
name='cNumSca
obj='Var
obj_type='N
pag=3
prev=O1246
var_op='asgn
I
obj='Insert
pag=3
prev=O1245
rd_kfield=[
'WUCODICE
'WUNOMEFILE
'WUDATINI
'WUDATFIN
'WUCODRAP
'WUNOMCLI
'WUCOGCLI
'WUCITCLI
'WUCAPCLI
'WUINDCLI
'WUBCITCLI
'WUBSTACLI
'WUDATNAS
'WUSEXCLI
'WUCODFIS
'WUTDOCCLI
'WUNDOCCLI
'WUADOCRIL
'WURDOCCLI
'WUSDOCCLI
'WUPROVCLI
'WUTELEFONO
'WUFLGMAIL
'WUEMAIL
'WUNOTE
'WUSTACLI
]
rd_kvar=[
'eProg
'LRTrim(w_nomefile)
'iif(Substr(riga,1,8)='00010101',NullDate(),CharToDate(Substr(riga,1,8)))
'iif(Substr(riga,9,8)='00010101',NullDate(),CharToDate(Substr(riga,9,8)))
'Substr(riga,17,16)
'LRTrim(Substr(riga,84,25))
'LRTrim(Substr(riga,34,26))
'Substr(riga,343,30)
'Substr(riga,443,5)
'Substr(riga,243,35)
'cCNAS
'cSNAS
'arfn_fdate(iif(Substr(riga,125,8)='00010101',NullDate(),CharToDate(Substr(riga,135,8))))
'Substr(riga,134,1)
'Substr(riga,543,16)
'Substr(riga,559,2)
'Substr(riga,561,15)
'Substr(riga,592,30)
'arfn_fdate(iif(Substr(riga,576,8)='00010101',NullDate(),CharToDate(Substr(riga,576,8))))
'arfn_fdate(iif(Substr(riga,584,8)='00010101',NullDate(),CharToDate(Substr(riga,584,8))))
'xProvRes
'Substr(riga,668,25)
'Substr(riga,667,1)
'LRTrim(Substr(riga,642,25))
'_errmsg
'cSRES
]
I
obj='Read
pag=3
prev=O1244
rd_field=[
'CODSTA
]
rd_kfield=[
'DESCRI
]
rd_kvar=[
'cSRES
]
rd_var=[
'cSRES2
]
I
obj='Var
pag=3
prev=O1243
var_op='asgn
I
obj='Var
pag=3
prev=O1242
var_op='asgn
I
obj='Read
pag=3
prev=O1241
rd_field=[
'CAB
'PROV
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'Substr(riga,343,30)
]
rd_var=[
'xCodCab
'xProvRes
]
I
obj='Var
pag=3
prev=O1238
var_op='asgn
I
obj='If
pag=3
prev=O1237
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1238
fatherSonIndex=0
frm_calc='Substr(riga,193,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=3
prev=O1260
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O1236
var_op='asgn
I
obj='Var
pag=3
prev=O1235
var_op='asgn
I
obj='Read
pag=3
prev=O1234
rd_field=[
'PROV
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'xCitta
]
rd_var=[
'cPNAS
]
I
obj='Var
pag=3
prev=O1233
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1223
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1225
fatherSonIndex=0
frm_calc='NullDate()
len=8
name='_datini
next=Icpitembatch.CPIfElse
frm_calc=[
'_xtipmod ='D'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPRemark
frm_calc='Aggiornamento Rapporto
next=Icpitembatch.CPIfElse
frm_calc=[
'DateToChar(_datini) = Substr(riga,1,8)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O1274
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Aggiorna Rapporto
father=O1275
fatherSonIndex=0
h=[
19
19
]
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='anarapbo
father=O1280
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna Soggetto
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Scrittura Informazioni
h=[
19
19
]
obj='Begin
pag=3
prev=O1286
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1288
fatherSonIndex=0
frm_calc=[
'Substr(riga,1,8) <> '00010101'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,9,8) <> '00010101'
]
h=[
19
19
]
obj='If
pag=3
prev=O1292
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1295
fatherSonIndex=0
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_oldreg
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O1302
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O1304
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xCF
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCon
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc=''3'
len=1
name='cFlagLire
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='rapopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_nummod
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_nummod = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O1326
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1328
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='intestbo
h=[
19
19
]
obj='Insert
pag=3
prev=O1333
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAFINE
'CODINTER
'NUMPROG2
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Substr(riga,9,8))
'_oldcon
'cInfProg2
'Substr(riga,17,16)
''0'
''0'
'Substr(riga,9,8)+cInfProg2+'0'
'cCli1
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1334
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=3
prev=O1341
var_op='asgn
I
obj='Exec
pag=3
prev=O1340
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestbo
father=O1328
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,17,16)
'_nummod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1345
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=3
prev=O1353
var_op='asgn
I
obj='Exec
pag=3
prev=O1352
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Left(riga,8))
'cInfProg2
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=3
prev=O1325
sel_field='*
sel_name='intestbo
sel_order='intestbo->CPROWNUM
sel_where='intestbo->RAPPORTO=Substr(riga,17,16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1326
fatherSonIndex=0
frm_calc=[
'intestbo->CODINTER=_oldcon
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=3
prev=O1362
var_op='asgn
I
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1362
fatherSonIndex=0
frm_calc='intestbo->CPROWNUM
len=10
name='_nummod
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O1324
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1322
var_op='asgn
I
obj='Insert
pag=3
prev=O1321
rd_kfield=[
'CDATOPE
'CODCAB
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'VALUTA
'CDATREG
]
rd_kvar=[
'Substr(riga,9,8)
'_intercab
'_intercod
'xSOCTCF
'CharToDate(Substr(riga,9,8))
'Date()
'_intercit
'cFlagLire
''0'
'cInfProg1
'Substr(riga,9,8)+cInfProg2+'0'
'cInfProg2
''2'
'nProgImp
'_interprv
'Substr(riga,17,16)
''0'
''1'
'_intertip
''0'
''26'
'''
''242'
'DateToChar(Date())
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1322
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per l'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=3
prev=O1376
var_op='asgn
I
obj='Exec
pag=3
prev=O1375
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O1320
var_op='asgn
I
obj='Var
pag=3
prev=O1319
var_op='asgn
I
obj='Var
pag=3
prev=O1318
var_op='asgn
I
obj='Remark
pag=3
prev=O1317
I
obj='Var
pag=3
prev=O1316
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1315
var_op='asgn
I
obj='Var
pag=3
prev=O1314
var_op='asgn
I
obj='Var
pag=3
prev=O1313
var_op='asgn
I
obj='Var
pag=3
prev=O1312
var_op='asgn
I
obj='Read
pag=3
prev=O1311
rd_field=[
'CODFISC
'MACROAGENTE
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'_oldcon
]
rd_var=[
'xCF
'_oldmac
]
I
obj='Var
pag=3
prev=O1309
var_op='asgn
I
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1309
fatherSonIndex=0
frm_calc='_codinter
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='_citinter
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='_cabinter
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='_prvinter
len=2
name='_interprv
obj='Var
pag=3
prev=O1387
var_op='asgn
I
obj='Var
pag=3
prev=O1386
var_op='asgn
I
obj='Var
pag=3
prev=O1385
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1304
fatherSonIndex=1
frm_calc='iif(Empty(_flagrap2),'0',Str(Val(_flagrap2)+1,1,0))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='Left(_idreg,19)+_flagrap2
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='rapopebo
next=Icpitembatch.CPBeginEnd
comment='Scrive il nuovo record
h=[
19
19
]
obj='Begin
pag=3
prev=O1393
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O1394
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xCF
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCon
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc=''3'
len=1
name='cFlagLire
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=3
prev=O1407
sel_field='*
sel_name='rapopebo
sel_where='rapopebo->IDBASE=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='rapopebo
father=O1408
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_nummod = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O1414
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1416
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='intestbo
h=[
19
19
]
obj='Insert
pag=3
prev=O1421
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAFINE
'CODINTER
'NUMPROG2
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Substr(riga,9,8))
'_oldcon
'rapopebo->NUMPROG
'Substr(riga,17,16)
''0'
''1'
'rapopebo->IDEREG
'cCli1
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1422
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=3
prev=O1429
var_op='asgn
I
obj='Exec
pag=3
prev=O1428
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestbo
father=O1416
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,17,16)
'_nummod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1433
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=3
prev=O1441
var_op='asgn
I
obj='Exec
pag=3
prev=O1440
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
]
wr_op=[
'=
]
wr_var=[
'CharToDate(Left(riga,8))
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=3
prev=O1412
sel_field='*
sel_name='intestbo
sel_order='intestbo->CPROWNUM
sel_where='intestbo->RAPPORTO=Substr(riga,17,16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1414
fatherSonIndex=0
frm_calc=[
'intestbo->CODINTER=_oldcon
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=3
prev=O1450
var_op='asgn
I
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1450
fatherSonIndex=0
frm_calc='intestbo->CPROWNUM
len=10
name='_nummod
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=3
rd_kfield=[
'CDATOPE
'CODCAB
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'VALUTA
'CDATREG
'OPERAZMOD
]
rd_kvar=[
'Substr(riga,9,8)
'_intercab
'_intercod
'xSOCTCF
'CharToDate(Substr(riga,9,8))
'rapopebo->DATAREG
'_intercit
'cFlagLire
''0'
'cInfProg1
'rapopebo->IDEREG
'rapopebo->NUMPROG
''2'
'nProgImp
'_interprv
'Substr(riga,17,16)
''1'
''1'
'_intertip
''0'
''26'
'''
''242'
'DateToChar(rapopebo->DATAREG)
'_idreg
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1412
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per l'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=3
prev=O1464
var_op='asgn
I
obj='Exec
pag=3
prev=O1463
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O1406
var_op='asgn
I
obj='Remark
pag=3
prev=O1405
I
obj='Var
pag=3
prev=O1404
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1403
var_op='asgn
I
obj='Var
pag=3
prev=O1402
var_op='asgn
I
obj='Var
pag=3
prev=O1401
var_op='asgn
I
obj='Read
pag=3
prev=O1400
rd_field=[
'CODFISC
'MACROAGENTE
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'_oldcon
]
rd_var=[
'xCF
'_oldmac
]
I
obj='Var
pag=3
prev=O1398
var_op='asgn
I
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1398
fatherSonIndex=0
frm_calc='_codinter
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='_citinter
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='_cabinter
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='_prvinter
len=2
name='_interprv
obj='Var
pag=3
prev=O1476
var_op='asgn
I
obj='Var
pag=3
prev=O1475
var_op='asgn
I
obj='Var
pag=3
prev=O1474
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=3
prev=O1392
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_unicode
]
wr_field=[
'STATOREG
'DATARETT
'IDEREG
'FLAGRAP2
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
''3'
'Date()
'_idreg
'_flagrap2
]
I
obj='Var
pag=3
prev=O1391
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=3
prev=O1301
sel_field='*
sel_name='rapopebo
sel_where='rapopebo->CDATOPE=Substr(riga,9,8) and rapopebo->RAPPORTO=Substr(riga,17,16) and rapopebo->TIPOOPRAP='26' and (rapopebo->STATOREG='0' or rapopebo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1302
fatherSonIndex=0
frm_calc='rapopebo->IDBASE
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
frm_calc='rapopebo->IDEREG
len=20
name='_oldreg
next=Icpitembatch.CPVarDecl
frm_calc='rapopebo->FLAGRAP2
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='rapopebo->IDEREG
len=20
name='_idreg
obj='Var
pag=3
prev=O1491
var_op='asgn
I
obj='Var
pag=3
prev=O1490
var_op='asgn
I
obj='Var
pag=3
prev=O1489
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O1300
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1292
fatherSonIndex=0
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_oldreg
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O1499
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O1501
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xCF
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCon
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc=''3'
len=1
name='cFlagLire
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='rapopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_nummod
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_nummod = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O1523
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1525
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='intestbo
h=[
19
19
]
obj='Insert
pag=3
prev=O1530
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Substr(riga,1,8))
'_oldcon
'cInfProg2
'Substr(riga,17,16)
''0'
''0'
'Left(riga,8)+cInfProg2+'0'
'cCli1
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1531
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=3
prev=O1538
var_op='asgn
I
obj='Exec
pag=3
prev=O1537
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestbo
father=O1525
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,17,16)
'_nummod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1542
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=3
prev=O1550
var_op='asgn
I
obj='Exec
pag=3
prev=O1549
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'NUMPROG1
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Left(riga,8))
'cInfProg2
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=3
prev=O1522
sel_field='*
sel_name='intestbo
sel_order='intestbo->CPROWNUM
sel_where='intestbo->RAPPORTO=Substr(riga,17,16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1523
fatherSonIndex=0
frm_calc=[
'intestbo->CODINTER=_oldcon
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=3
prev=O1559
var_op='asgn
I
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1559
fatherSonIndex=0
frm_calc='intestbo->CPROWNUM
len=10
name='_nummod
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O1521
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1519
var_op='asgn
I
obj='Insert
pag=3
prev=O1518
rd_kfield=[
'CDATOPE
'CODCAB
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'VALUTA
'CDATREG
]
rd_kvar=[
'Substr(riga,1,8)
'_intercab
'_intercod
'xSOCTCF
'CharToDate(Substr(riga,1,8))
'Date()
'_intercit
'cFlagLire
''0'
'cInfProg1
'Left(riga,8)+cInfProg2+'0'
'cInfProg2
''2'
'nProgImp
'_interprv
'Substr(riga,17,16)
''0'
''1'
'_intertip
''0'
''23'
'''
''242'
'DateToChar(Date())
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1519
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per l'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=3
prev=O1573
var_op='asgn
I
obj='Exec
pag=3
prev=O1572
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O1517
var_op='asgn
I
obj='Var
pag=3
prev=O1516
var_op='asgn
I
obj='Var
pag=3
prev=O1515
var_op='asgn
I
obj='Remark
pag=3
prev=O1514
I
obj='Var
pag=3
prev=O1513
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1512
var_op='asgn
I
obj='Var
pag=3
prev=O1511
var_op='asgn
I
obj='Var
pag=3
prev=O1510
var_op='asgn
I
obj='Var
pag=3
prev=O1509
var_op='asgn
I
obj='Read
pag=3
prev=O1508
rd_field=[
'CODFISC
'MACROAGENTE
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'_oldcon
]
rd_var=[
'xCF
'_oldmac
]
I
obj='Var
pag=3
prev=O1506
var_op='asgn
I
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1506
fatherSonIndex=0
frm_calc='_codinter
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='_citinter
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='_cabinter
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='_prvinter
len=2
name='_interprv
obj='Var
pag=3
prev=O1584
var_op='asgn
I
obj='Var
pag=3
prev=O1583
var_op='asgn
I
obj='Var
pag=3
prev=O1582
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1501
fatherSonIndex=1
frm_calc='iif(Empty(_flagrap2),'0',Str(Val(_flagrap2)+1,1,0))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='Left(_idreg,19)+_flagrap2
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='rapopebo
next=Icpitembatch.CPBeginEnd
comment='Scrive il nuovo record
h=[
19
19
]
obj='Begin
pag=3
prev=O1590
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O1591
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xCF
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCon
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc=''3'
len=1
name='cFlagLire
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=3
prev=O1604
sel_field='*
sel_name='rapopebo
sel_where='rapopebo->IDBASE=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='rapopebo
father=O1605
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_nummod = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O1611
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1613
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='intestbo
h=[
19
19
]
obj='Insert
pag=3
prev=O1618
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Substr(riga,1,8))
'_oldcon
'rapopebo->NUMPROG
'Substr(riga,17,16)
''0'
''1'
'rapopebo->IDEREG
'cCli1
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1619
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=3
prev=O1626
var_op='asgn
I
obj='Exec
pag=3
prev=O1625
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestbo
father=O1613
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,17,16)
'_nummod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1630
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=3
prev=O1638
var_op='asgn
I
obj='Exec
pag=3
prev=O1637
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
]
wr_op=[
'=
]
wr_var=[
'CharToDate(Left(riga,8))
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=3
prev=O1609
sel_field='*
sel_name='intestbo
sel_order='intestbo->CPROWNUM
sel_where='intestbo->RAPPORTO=Substr(riga,17,16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1611
fatherSonIndex=0
frm_calc=[
'intestbo->CODINTER=_oldcon
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=3
prev=O1647
var_op='asgn
I
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1647
fatherSonIndex=0
frm_calc='intestbo->CPROWNUM
len=10
name='_nummod
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=3
rd_kfield=[
'CDATOPE
'CODCAB
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'VALUTA
'CDATREG
'OPERAZMOD
]
rd_kvar=[
'Substr(riga,1,8)
'_intercab
'_intercod
'xSOCTCF
'CharToDate(Substr(riga,1,8))
'rapopebo->DATAREG
'_intercit
'cFlagLire
''0'
'cInfProg1
'rapopebo->IDEREG
'rapopebo->IDEREG
''2'
'nProgImp
'_interprv
'Substr(riga,17,16)
''1'
''1'
'_intertip
''0'
''23'
'''
''242'
'DateToChar(rapopebo->DATAREG)
'_idreg
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1609
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per l'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=3
prev=O1661
var_op='asgn
I
obj='Exec
pag=3
prev=O1660
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O1603
var_op='asgn
I
obj='Remark
pag=3
prev=O1602
I
obj='Var
pag=3
prev=O1601
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1600
var_op='asgn
I
obj='Var
pag=3
prev=O1599
var_op='asgn
I
obj='Var
pag=3
prev=O1598
var_op='asgn
I
obj='Read
pag=3
prev=O1597
rd_field=[
'CODFISC
'MACROAGENTE
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'_oldcon
]
rd_var=[
'xCF
'_oldmac
]
I
obj='Var
pag=3
prev=O1595
var_op='asgn
I
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1595
fatherSonIndex=0
frm_calc='_codinter
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='_citinter
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='_cabinter
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='_prvinter
len=2
name='_interprv
obj='Var
pag=3
prev=O1673
var_op='asgn
I
obj='Var
pag=3
prev=O1672
var_op='asgn
I
obj='Var
pag=3
prev=O1671
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=3
prev=O1589
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_unicode
]
wr_field=[
'STATOREG
'DATARETT
'IDEREG
'FLAGRAP2
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
''3'
'Date()
'_idreg
'_flagrap2
]
I
obj='Var
pag=3
prev=O1588
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=3
prev=O1498
sel_field='*
sel_name='rapopebo
sel_where='rapopebo->CDATOPE=Left(riga,8) and rapopebo->RAPPORTO=Substr(riga,17,16) and rapopebo->TIPOOPRAP='23' and (rapopebo->STATOREG='0' or rapopebo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1499
fatherSonIndex=0
frm_calc='rapopebo->IDBASE
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
frm_calc='rapopebo->IDEREG
len=20
name='_oldreg
next=Icpitembatch.CPVarDecl
frm_calc='rapopebo->FLAGRAP2
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='rapopebo->IDEREG
len=20
name='_idreg
obj='Var
pag=3
prev=O1688
var_op='asgn
I
obj='Var
pag=3
prev=O1687
var_op='asgn
I
obj='Var
pag=3
prev=O1686
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O1497
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=3
prev=O1284
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1286
fatherSonIndex=0
frm_calc='''
len=5
name='_oldmac
next=Icpitembatch.CPVarDecl
frm_calc='''
len=70
name='_oldrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=70
name='_oldcon
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_oldrag))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_aggcli
next=Icpitembatch.CPCase
frm_calc=[
'LRTrim(w_codmage)='COSTA'
'w_codmage='FININ'
'w_codmage='BCAUC'
'w_codmage='BCISP'
'w_codmage='BCASS' or LRTrim(w_codmage)='E998' or LRTrim(w_codmage)='EBDSS' or LRTrim(w_codmage)='I999'
'w_codmage='DHLSP'
'w_codmage='TRAVX'
]
h=[
19
19
19
19
19
19
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_aggcli = 1
]
h=[
19
19
]
obj='If
pag=3
prev=O1703
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1706
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=40
name='cSRES
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='cSRES2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xCF
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,134,1)='M','1',iif(Substr(riga,134,1)='F','2',Substr(riga,134,1)))
len=1
name='xSesso
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,143,30)
len=30
name='xCitta
next=Icpitembatch.CPRead
arch='tbcitta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,143,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'(Substr(riga,554,1) = 'Z' or LRTrim(Substr(riga,193,30)) <> 'ITALIA') and Len(LRTrim(xSesso))=1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,393,40)
len=40
name='cSRES
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='cSRES2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='xProvRes
next=Icpitembatch.CPRead
arch='tbcitta
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPVarDecl
frm_calc='iif(Len(LRTrim(xSesso))=1,'P','G')
len=1
name='_tipper
next=Icpitembatch.CPWrite
arch='personbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_connes
next=Icpitembatch.CPRead
arch='personbo_agg
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_connes))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPBeginEnd
comment='Scrive i record 31 e 32
h=[
19
19
]
obj='Begin
pag=3
prev=O1736
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1739
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='rapopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='rapopebo
h=[
19
19
]
obj='Insert
pag=3
prev=O1750
rd_kfield=[
'CDATOPE
'CODCAB
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'VALUTA
'CDATREG
]
rd_kvar=[
'DateToChar(Date())
'_intercab
'_intercod
'xSOCTCF
'Date()
'Date()
'_intercit
'cFlagLire
''0'
'cInfProg1
'Substr(riga,9,8)+cInfProg2+'0'
'cInfProg2
''3'
'nProgImp
'_interprv
'Substr(riga,17,16)
''0'
''1'
'_intertip
''0'
''32'
'''
''242'
'DateToChar(Date())
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1751
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per l'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=3
prev=O1758
var_op='asgn
I
obj='Exec
pag=3
prev=O1757
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O1749
var_op='asgn
I
obj='Var
pag=3
prev=O1748
var_op='asgn
I
obj='Var
pag=3
prev=O1746
var_op='asgn
I
obj='Insert
pag=3
prev=O1745
rd_kfield=[
'CDATOPE
'CODCAB
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'VALUTA
'CDATREG
]
rd_kvar=[
'DateToChar(Date())
'_intercab
'_intercod
'xSOCTCF
'Date()
'Date()
'_intercit
'cFlagLire
''0'
'cInfProg1
'Substr(riga,9,8)+cInfProg2+'0'
'cInfProg2
''3'
'nProgImp
'_interprv
'Substr(riga,17,16)
''0'
''1'
'_intertip
''0'
''31'
'''
''242'
'DateToChar(Date())
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1746
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per l'informazione in data "+CharToDate(Left(riga,8))+" relativa al rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=3
prev=O1766
var_op='asgn
I
obj='Exec
pag=3
prev=O1765
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O1744
var_op='asgn
I
obj='Var
pag=3
prev=O1743
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1735
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='personbo_agg
father=O1736
fatherSonIndex=0
h=[
19
19
]
obj='Insert
pag=3
rd_kfield=[
'CONNES
'TELEFONO
'FLGEMAIL
'EMAIL
'FLGBANCA
]
rd_kvar=[
'_oldcon
'Substr(riga,668,25)
'iif(At(Upper(Substr(riga,667,1)),'|S|Y') <> 0,'S','N')
'LRTrim(Substr(riga,642,25))
''S'
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1772
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per il soggetto: "+LRTrim(Substr(riga,34,100))+" con codice fiscale: "+LRTrim(Substr(riga,543,16))+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
obj='Exec
pag=3
prev=O1780
I
obj='Var
obj_type='N
pag=3
prev=O1779
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1778
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='personbo_agg
father=O1736
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=3
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'_oldcon
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1784
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per il soggetto: "+LRTrim(Substr(riga,34,100))+" con codice fiscale: "+LRTrim(Substr(riga,543,16))+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
obj='Exec
pag=3
prev=O1793
I
obj='Var
obj_type='N
pag=3
prev=O1792
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1791
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'FLGBANCA
'TELEFONO
'FLGEMAIL
'EMAIL
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
''S'
'Substr(riga,668,25)
'iif(At(Upper(Substr(riga,667,1)),'|S|Y') <> 0,'S','N')
'LRTrim(Substr(riga,642,25))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=3
prev=O1734
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'_oldcon
]
rd_var=[
'_connes
]
I
obj='Var
pag=3
prev=O1732
var_op='asgn
I
obj='Write
pag=3
prev=O1731
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'_oldcon
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1732
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+LRTrim(w_nomefile)+" per il soggetto: "+LRTrim(Substr(riga,34,100))+" con codice fiscale: "+LRTrim(Substr(riga,543,16))+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
obj='Exec
pag=3
prev=O1811
I
obj='Var
obj_type='N
pag=3
prev=O1810
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1809
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'CAP
'SESSO
'PAESE
'DATAVALI
'TIPOPERS
'COGNOME
'NOME
'TIPINTER
'NASSTATO
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xCodCab
'Left(LRTrim(Substr(riga,34,50))+" "+LRTrim(Substr(riga,84,50)),70)
'Substr(riga,243,35)
'xCF
'CharToDate(Substr(riga,135,8))
'cCNAS
''600'
'''
''600'
'Substr(riga,559,2)
'Substr(riga,561,15)
'CharToDate(Substr(riga,576,8))
'Substr(riga,592,30)
'Substr(riga,343,30)
'xProvRes
'Substr(riga,443,9)
'xSesso
'cSRES2
'CharToDate(Substr(riga,584,8))
'_tipper
'LRTrim(Substr(riga,34,26))
'LRTrim(Substr(riga,84,25))
'cPNAS
'cSNAS
]
I
obj='Var
pag=3
prev=O1730
var_op='asgn
I
obj='Read
pag=3
prev=O1729
rd_field=[
'CODSTA
]
rd_kfield=[
'DESCRI
]
rd_kvar=[
'cSRES
]
rd_var=[
'cSRES2
]
I
obj='Read
pag=3
prev=O1728
rd_field=[
'CAB
'PROV
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'Substr(riga,343,30)
]
rd_var=[
'xCodCab
'xProvRes
]
I
obj='Var
pag=3
prev=O1727
var_op='asgn
I
obj='Var
pag=3
prev=O1726
var_op='asgn
I
obj='Var
pag=3
prev=O1723
var_op='asgn
I
obj='If
pag=3
prev=O1722
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1723
fatherSonIndex=0
frm_calc=''EE'
len=2
name='cPNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,193,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=3
prev=O1828
var_op='asgn
I
obj='Var
pag=3
prev=O1827
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O1721
var_op='asgn
I
obj='Var
pag=3
prev=O1720
var_op='asgn
I
obj='Read
pag=3
prev=O1719
rd_field=[
'PROV
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'xCitta
]
rd_var=[
'cPNAS
]
I
obj='Var
pag=3
prev=O1718
var_op='asgn
I
obj='Var
pag=3
prev=O1717
var_op='asgn
I
obj='Read
pag=3
prev=O1716
rd_field=[
'CODFISC
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'_oldcon
]
rd_var=[
'xCF
]
I
obj='Var
pag=3
prev=O1715
var_op='asgn
I
obj='Var
pag=3
prev=O1714
var_op='asgn
I
obj='Var
pag=3
prev=O1712
var_op='asgn
I
obj='Select
pag=3
prev=O1711
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=_oldcon
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O1712
fatherSonIndex=0
obj='Insert
pag=3
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'datamodi
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
]
rd_kvar=[
'cProgSto
'Substr(riga,17,16)
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'Date()
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Case
pag=3
prev=O1702
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1703
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1703
fatherSonIndex=1
frm_calc=[
'_oldmac <> 'COSTA'
]
h=[
19
19
]
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1850
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1703
fatherSonIndex=2
frm_calc=[
'_oldmac <> 'COSTA' and _oldmac <> 'FININ'
]
h=[
19
19
]
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1858
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1703
fatherSonIndex=3
frm_calc=[
'_oldmac <> 'COSTA' and _oldmac <> 'FININ' and _oldmac <> 'BCAUC'
]
h=[
19
19
]
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1866
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1703
fatherSonIndex=4
frm_calc=[
'_oldmac <> 'COSTA' and _oldmac <> 'FININ' and _oldmac <> 'BCAUC' and _oldmac <> 'BCISP'
]
h=[
19
19
]
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1874
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1703
fatherSonIndex=5
frm_calc=[
'_oldmac = 'TRAVX' or _oldmac='DHLSP'
]
h=[
19
19
]
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1882
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1703
fatherSonIndex=6
frm_calc=[
'_oldmac='TRAVX'
]
h=[
19
19
]
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1890
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
150
150
150
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O1699
var_op='asgn
I
obj='If
pag=3
prev=O1698
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1699
fatherSonIndex=0
frm_calc='''
len=5
name='_oldmac
next=Icpitembatch.CPVarDecl
frm_calc='''
len=70
name='_oldrag
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=3
prev=O1901
rd_field=[
'MACROAGENTE
'RAGSOC
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'Substr(riga,543,16)
]
rd_var=[
'_oldmac
'_oldrag
'_oldcon
]
I
obj='Var
pag=3
prev=O1900
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=3
prev=O1697
rd_field=[
'MACROAGENTE
'RAGSOC
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,17,16)
]
rd_var=[
'_oldmac
'_oldrag
'_oldcon
]
I
obj='Var
pag=3
prev=O1696
var_op='asgn
I
obj='Var
pag=3
prev=O1695
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'Substr(riga,17,16)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1284
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+w_nomefile+" per il rapporto: "+Substr(riga,17,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=3
prev=O1919
var_op='asgn
I
obj='Exec
pag=3
prev=O1918
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DESCRAP
]
wr_op=[
'=
]
wr_var=[
'Left(LRTrim(Substr(riga,34,50))+" "+LRTrim(Substr(riga,84,50)),50)
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1275
fatherSonIndex=1
frm_calc=''Data di inizio rapporto non coincide'
len=10
name='_errmsg
next=Icpitembatch.CPVarDecl
frm_calc=''S'
len=1
name='_errmod
obj='Var
pag=3
pagelocal=True
prev=O1927
var_op='asgn
I
obj='Var
obj_type='M
pag=3
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=3
prev=O1271
I
obj='If
pag=3
prev=O1270
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1271
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=3
sel_field='*
sel_name='rapopebo
sel_where='rapopebo->RAPPORTO=Substr(riga,17,16) and rapopebo->TIPOOPRAP='23'
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1932
fatherSonIndex=0
frm_calc='rapopebo->DATAOPE
len=8
name='_datini
obj='Var
obj_type='D
pag=3
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1271
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=3
sel_field='*
sel_name='xapopebo
sel_where='xapopebo->RAPPORTO=Substr(riga,17,16) and xapopebo->TIPOOPRAP='23'
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1939
fatherSonIndex=0
frm_calc='xapopebo->DATAOPE
len=8
name='_datini
obj='Var
obj_type='D
pag=3
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='D
pag=3
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1225
fatherSonIndex=1
frm_calc=''Aggiornamento di un rapporto inesistente su archivio UNICO'
len=10
name='_errmsg
next=Icpitembatch.CPVarDecl
frm_calc=''S'
len=1
name='_errmod
obj='Var
pag=3
pagelocal=True
prev=O1947
var_op='asgn
I
obj='Var
obj_type='M
pag=3
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=3
prev=O1220
sel_field='*
sel_name='knarapbo
sel_where='knarapbo->RAPPORTO=_xrapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1223
fatherSonIndex=0
frm_calc='knarapbo->RAPPORTO
len=25
name='_xrapmod
next=Icpitembatch.CPVarDecl
frm_calc='knarapbo->TIPORAP
len=1
name='_xtipmod
obj='Var
pag=3
pagelocal=True
prev=O1952
var_op='asgn
I
obj='Var
pag=3
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1219
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1220
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=3
sel_field='*
sel_name='intestbo
sel_where='intestbo->CODINTER=Substr(riga,17,16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anarapbo
father=O1957
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'_magecod=w_codmage
]
h=[
19
19
]
obj='If
pag=3
prev=O1961
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1962
fatherSonIndex=0
frm_calc='intestbo->RAPPORTO
len=25
name='_xrapporto
obj='Var
pag=3
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=3
rd_field=[
'MACODICE
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'intestbo->RAPPORTO
]
rd_var=[
'_magecod
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1220
fatherSonIndex=1
frm_calc='Substr(riga,17,16)
len=25
name='_xrapporto
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='M
pag=3
pagelocal=True
prev=O1218
var_op='asgn
I
obj='Var
pag=3
pagelocal=True
prev=O1217
var_op='asgn
I
obj='Var
pag=3
pagelocal=True
prev=O1216
var_op='asgn
I
obj='Var
pag=3
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1210
fatherSonIndex=0
len=25
name='_xrapmod
next=Icpitembatch.CPVarDecl
len=1
name='_xtipmod
next=Icpitembatch.CPVarDecl
len=8
name='_datini
next=Icpitembatch.CPVarDecl
len=1
name='_errmod
next=Icpitembatch.CPVarDecl
len=10
name='_errmsg
obj='Var
obj_type='M
pag=3
pagelocal=True
prev=O1983
I
obj='Var
pag=3
pagelocal=True
prev=O1982
I
obj='Var
obj_type='D
pag=3
pagelocal=True
prev=O1981
I
obj='Var
pag=3
pagelocal=True
prev=O1980
I
obj='Var
pag=3
pagelocal=True
I
I
]
w=[
150
150
]
x=24
y=16
I
]
ManualBlocks={
'BO - Properties
Icpmanualblocks.CPManualBlocks
code='public String[] lista;﷯public int conteggio;﷯public int i;﷯public int contanome;
name='BO - Properties
I
}
comment='Importa Rapporti Unicredit
date_creat=#2006-06-20
date_rev=#2018-10-24
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'FileLibMit
'Utilities
'LibreriaMit
]
merge=True
modcnt=610
page_result_class=[
'
'
'
'
]
page_result_type=[
'U
'U
'U
'U
]
page_uid=[
'CMOXGABSUW
'ZIBMFCGMSH
'QVIAJSCPXB
'ITVATLLXTA
]
pagename=[
'Page_1
'Page_2
'Page_3
'Page_4
]
pagenote=[
'
'
'
'
]
pagetitle=[
'Main
'Nuovo Rapporto
'Aggiorna Rapporto
'Chiusura Rapporto
]
runtime_filters=2
tpl_name='Function
work_file=[
'anadip
'anarapbo
'intermbo
'intestbo
'knarapbo
'mtimperr
'personbo
'personbo_agg
'rapopebo
'tbcitta
'tbstati
'tbvalute
'wersonbo
'wuchkimp
'wuchkunicr
'wurapporti
'xapopebo
'xnarapbo
'xntestbo
'tbmacage
]
work_filter=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
I
*--*
*----*
