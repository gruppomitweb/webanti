* --- CodePainter Revolution Batch Vers. 5.1
￼Icpbatch.CPBatch
Items=[
Icpitembatch.CPRemark
frm_calc='Dichiarazione variabili del caller
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili caller
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Definizione variabili locali
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili Locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='variabili per il calcolo del codice fiscale
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili globali
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Legge dati intermediario per metteri su operazbo,fraziobo,rapopebo se mancanti
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Import Soggetti
next=Icpitembatch.CPRemark
frm_calc='Cicla sul file della lista e lancia la pagina appropriata
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_esito
next=Icpitembatch.CPVarDecl
frm_calc='NullDateTime()
len=14
name='_dtimport
next=Icpitembatch.CPExec
check='page
frm_calc='2
next=Ispitembatch.CPReturn
lnk_page='arpg_start_wuchkpas
lnk_type='page
obj='Return
pag=1
page_return=Nil
prev=O20
I
obj='Exec
pag=1
prev=O19
I
obj='Var
obj_type='T
pag=1
prev=O18
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O17
var_op='asgn
I
obj='Remark
pag=1
prev=O16
I
obj='Remark
pag=1
prev=O14
I
obj='Select
pag=1
prev=O13
sel_field='*
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O14
fatherSonIndex=0
frm_calc='intermbo->CODINTER
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->DESCCIT
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->CODCAB
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->PROVINCIA
len=2
name='_interprv
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->TIPINTER
len=2
name='_intertip
obj='Var
pag=1
prev=O27
var_op='asgn
I
obj='Var
pag=1
prev=O26
var_op='asgn
I
obj='Var
pag=1
prev=O25
var_op='asgn
I
obj='Var
pag=1
prev=O24
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=1
prev=O11
I
obj='Begin
pag=1
prev=O9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Path Applicazione
father=O11
fatherSonIndex=0
global=True
len=80
name='gPathApp
next=Icpitembatch.CPVarDecl
comment='Azienda
global=True
len=10
name='gAzienda
next=Icpitembatch.CPVarDecl
comment='Messaggio
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=1
prev=O33
I
nonlocal=True
obj='Var
pag=1
prev=O32
I
nonlocal=True
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O7
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O9
fatherSonIndex=0
len=1
name='_nocf
next=Icpitembatch.CPVarDecl
comment='Codice Fiscale
len=16
name='w_CODFISC
next=Icpitembatch.CPVarDecl
comment='Data Nascita
len=8
name='w_DATANASC
next=Icpitembatch.CPVarDecl
comment='Luogo di Nascita
len=30
name='w_NASCOMUN
next=Icpitembatch.CPVarDecl
comment='Stato di nascita
len=30
name='w_NASSTATO
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
len=26
name='w_COGNOME
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
len=70
name='w_RAGSOC
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
len=25
name='w_NOME
next=Icpitembatch.CPVarDecl
comment='Sesso
len=1
name='w_SESSO
obj='Var
pag=1
prev=O45
I
obj='Var
pag=1
prev=O44
I
obj='Var
pag=1
prev=O43
I
obj='Var
pag=1
prev=O42
I
obj='Var
pag=1
prev=O41
I
obj='Var
pag=1
prev=O40
I
obj='Var
obj_type='D
pag=1
prev=O39
I
obj='Var
pag=1
prev=O38
I
obj='Var
obj_type='N
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O6
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O7
fatherSonIndex=0
len=1
name='fhand
next=Icpitembatch.CPVarDecl
len=10
name='riga
next=Icpitembatch.CPVarDecl
len=10
name='nProg
next=Icpitembatch.CPVarDecl
len=50
name='nomefileimport
next=Icpitembatch.CPVarDecl
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
len=10
name='conta
next=Icpitembatch.CPVarDecl
len=1
name='_tdest
next=Icpitembatch.CPVarDecl
len=1
name='_i
next=Icpitembatch.CPVarDecl
len=2
name='_tipope
next=Icpitembatch.CPVarDecl
len=3
name='_pos
next=Icpitembatch.CPVarDecl
len=1
name='_npos
next=Icpitembatch.CPVarDecl
len=1
name='_tipoop
next=Icpitembatch.CPVarDecl
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
len=10
name='_uniquecode
next=Icpitembatch.CPVarDecl
len=8
name='_datope
next=Icpitembatch.CPVarDecl
len=20
name='_impstr
next=Icpitembatch.CPVarDecl
dec=2
len=10
name='_importo
next=Icpitembatch.CPVarDecl
len=3
name='_statodest
next=Icpitembatch.CPVarDecl
len=3
name='_statores
next=Icpitembatch.CPVarDecl
len=3
name='_isodest
next=Icpitembatch.CPVarDecl
len=26
name='_cognome
next=Icpitembatch.CPVarDecl
len=25
name='_nome
next=Icpitembatch.CPVarDecl
len=40
name='_citta
next=Icpitembatch.CPVarDecl
len=5
name='_cap
next=Icpitembatch.CPVarDecl
len=35
name='_via
next=Icpitembatch.CPVarDecl
len=2
name='_prov
next=Icpitembatch.CPVarDecl
len=6
name='_cab
next=Icpitembatch.CPVarDecl
len=26
name='_cognomecp
next=Icpitembatch.CPVarDecl
len=25
name='_nomecp
next=Icpitembatch.CPVarDecl
len=1
name='_sesso
next=Icpitembatch.CPVarDecl
len=30
name='_nascitta
next=Icpitembatch.CPVarDecl
len=30
name='_nasstato
next=Icpitembatch.CPVarDecl
len=2
name='_nasprov
next=Icpitembatch.CPVarDecl
len=8
name='_nasdata
next=Icpitembatch.CPVarDecl
len=20
name='_tipodoc
next=Icpitembatch.CPVarDecl
len=20
name='_numdoc
next=Icpitembatch.CPVarDecl
len=8
name='_docril
next=Icpitembatch.CPVarDecl
len=30
name='_autril
next=Icpitembatch.CPVarDecl
len=8
name='_docsca
next=Icpitembatch.CPVarDecl
len=16
name='_codfis
next=Icpitembatch.CPVarDecl
len=16
name='_connes
next=Icpitembatch.CPVarDecl
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
len=1
name='xSesso
next=Icpitembatch.CPVarDecl
len=6
name='xCAB
next=Icpitembatch.CPVarDecl
len=6
name='xDIP
next=Icpitembatch.CPVarDecl
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
len=8
name='xData
next=Icpitembatch.CPVarDecl
len=8
name='xDatF
next=Icpitembatch.CPVarDecl
comment='Contatore record nuovi
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
comment='Contatore record aggiornati
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
comment='Contatore record invariati
len=10
name='cNumInv
next=Icpitembatch.CPVarDecl
len=1
name='_esito
next=Icpitembatch.CPVarDecl
len=10
name='_idbase
next=Icpitembatch.CPVarDecl
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
len=2
name='_interprv
next=Icpitembatch.CPVarDecl
len=2
name='_doctype
next=Icpitembatch.CPVarDecl
len=4
name='_codana
next=Icpitembatch.CPVarDecl
len=2
name='_codsin
next=Icpitembatch.CPVarDecl
len=1
name='_segno
next=Icpitembatch.CPVarDecl
len=3
name='_uifdest
next=Icpitembatch.CPVarDecl
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
len=10
name='_prog
next=Icpitembatch.CPVarDecl
len=1
name='_nocf
next=Icpitembatch.CPVarDecl
len=50
name='_condoc
next=Icpitembatch.CPVarDecl
len=60
name='_idfile
next=Icpitembatch.CPVarDecl
len=5
name='_mage
next=Icpitembatch.CPVarDecl
len=20
name='_oldcodfis
next=Icpitembatch.CPVarDecl
len=14
name='_dtimport
next=Icpitembatch.CPVarDecl
len=10
name='_txtope
next=Icpitembatch.CPVarDecl
len=1
name='_errore
next=Icpitembatch.CPVarDecl
len=10
name='_nerrori
next=Icpitembatch.CPVarDecl
len=10
name='eProg
next=Icpitembatch.CPVarDecl
len=3
name='_codstanas
next=Icpitembatch.CPVarDecl
len=100
name='_merr
next=Icpitembatch.CPVarDecl
len=5
name='_oldmac
next=Icpitembatch.CPVarDecl
len=1
name='_aggcli
next=Icpitembatch.CPVarDecl
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
len=5
name='w_codmage
next=Icpitembatch.CPVarDecl
len=15
name='_codrap
next=Icpitembatch.CPVarDecl
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
len=2
name='_intertip
next=Icpitembatch.CPVarDecl
len=1
name='w_xMAFLGRAP
next=Icpitembatch.CPVarDecl
len=1
name='w_xMAFLGBON
next=Icpitembatch.CPVarDecl
len=1
name='w_xMAFLGCKR
next=Icpitembatch.CPVarDecl
len=1
name='w_xMAFLGASR
next=Icpitembatch.CPVarDecl
len=4
name='_siglacit
next=Icpitembatch.CPVarDecl
len=4
name='_siglasta
next=Icpitembatch.CPVarDecl
len=30
name='_citinter
next=Icpitembatch.CPVarDecl
len=6
name='_cabinter
next=Icpitembatch.CPVarDecl
len=2
name='_prvinter
obj='Var
pag=1
prev=O144
I
obj='Var
pag=1
prev=O143
I
obj='Var
pag=1
prev=O142
I
obj='Var
pag=1
prev=O141
I
obj='Var
pag=1
prev=O140
I
obj='Var
pag=1
prev=O139
I
obj='Var
pag=1
prev=O138
I
obj='Var
pag=1
prev=O137
I
obj='Var
pag=1
prev=O136
I
obj='Var
pag=1
prev=O135
I
obj='Var
obj_type='M
pag=1
prev=O134
I
obj='Var
pag=1
prev=O133
I
obj='Var
pag=1
prev=O132
I
obj='Var
pag=1
prev=O131
I
obj='Var
obj_type='N
pag=1
prev=O130
I
obj='Var
pag=1
prev=O129
I
obj='Var
pag=1
prev=O128
I
obj='Var
pag=1
prev=O127
I
obj='Var
obj_type='N
pag=1
prev=O126
I
obj='Var
obj_type='N
pag=1
prev=O125
I
obj='Var
obj_type='N
pag=1
prev=O124
I
obj='Var
obj_type='M
pag=1
prev=O123
I
obj='Var
obj_type='T
pag=1
prev=O122
I
obj='Var
pag=1
prev=O121
I
obj='Var
pag=1
prev=O120
I
obj='Var
pag=1
prev=O119
I
obj='Var
pag=1
prev=O118
I
obj='Var
obj_type='N
pag=1
prev=O117
I
obj='Var
pag=1
prev=O116
I
obj='Var
pag=1
prev=O115
I
obj='Var
pag=1
prev=O114
I
obj='Var
pag=1
prev=O113
I
obj='Var
pag=1
prev=O112
I
obj='Var
pag=1
prev=O111
I
obj='Var
pag=1
prev=O110
I
obj='Var
pag=1
prev=O109
I
obj='Var
pag=1
prev=O108
I
obj='Var
pag=1
prev=O107
I
obj='Var
pag=1
prev=O106
I
obj='Var
pag=1
prev=O105
I
obj='Var
obj_type='N
pag=1
prev=O104
I
obj='Var
obj_type='N
pag=1
prev=O103
I
obj='Var
obj_type='N
pag=1
prev=O102
I
obj='Var
obj_type='N
pag=1
prev=O101
I
obj='Var
pag=1
prev=O100
I
obj='Var
pag=1
prev=O99
I
obj='Var
pag=1
prev=O98
I
obj='Var
pag=1
prev=O97
I
obj='Var
pag=1
prev=O96
I
obj='Var
pag=1
prev=O95
I
obj='Var
pag=1
prev=O94
I
obj='Var
pag=1
prev=O93
I
obj='Var
obj_type='N
pag=1
prev=O92
I
obj='Var
pag=1
prev=O91
I
obj='Var
pag=1
prev=O90
I
obj='Var
pag=1
prev=O89
I
obj='Var
pag=1
prev=O88
I
obj='Var
obj_type='D
pag=1
prev=O87
I
obj='Var
pag=1
prev=O86
I
obj='Var
obj_type='D
pag=1
prev=O85
I
obj='Var
pag=1
prev=O84
I
obj='Var
pag=1
prev=O83
I
obj='Var
obj_type='D
pag=1
prev=O82
I
obj='Var
pag=1
prev=O81
I
obj='Var
pag=1
prev=O80
I
obj='Var
pag=1
prev=O79
I
obj='Var
pag=1
prev=O78
I
obj='Var
pag=1
prev=O77
I
obj='Var
pag=1
prev=O76
I
obj='Var
pag=1
prev=O75
I
obj='Var
pag=1
prev=O74
I
obj='Var
pag=1
prev=O73
I
obj='Var
pag=1
prev=O72
I
obj='Var
pag=1
prev=O71
I
obj='Var
pag=1
prev=O70
I
obj='Var
pag=1
prev=O69
I
obj='Var
pag=1
prev=O68
I
obj='Var
pag=1
prev=O67
I
obj='Var
pag=1
prev=O66
I
obj='Var
obj_type='N
pag=1
prev=O65
I
obj='Var
pag=1
prev=O64
I
obj='Var
obj_type='D
pag=1
prev=O63
I
obj='Var
pag=1
prev=O62
I
obj='Var
pag=1
prev=O61
I
obj='Var
pag=1
prev=O60
I
obj='Var
obj_type='N
pag=1
prev=O59
I
obj='Var
obj_type='N
pag=1
prev=O58
I
obj='Var
pag=1
prev=O57
I
obj='Var
obj_type='N
pag=1
prev=O56
I
obj='Var
pag=1
prev=O55
I
obj='Var
obj_type='N
pag=1
prev=O54
I
obj='Var
pag=1
prev=O53
I
obj='Var
pag=1
prev=O52
I
obj='Var
obj_type='N
pag=1
prev=O51
I
obj='Var
obj_type='M
pag=1
prev=O50
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Remark
pag=1
prev=O4
I
obj='Begin
pag=1
prev=O3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4
fatherSonIndex=0
len=1
name='w_tipodest
next=Icpitembatch.CPVarDecl
len=1
name='w_opextc
next=Icpitembatch.CPVarDecl
comment='Destinazione finale
len=1
name='w_destfin
nonlocal=True
obj='Var
pag=1
prev=O150
I
nonlocal=True
obj='Var
pag=1
prev=O149
I
nonlocal=True
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Remark
pag=1
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumInv
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_nerrori
next=Icpitembatch.CPRemark
frm_calc='Legge il file
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
obj='Try
pag=2
prev=O160
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O161
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=2
prev=O165
I
obj='Select
pag=2
sel_field='*
sel_name='tmp_impwu
sel_where='tmp_impwu->WUFLGSEL='S'
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O165
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='tmp_impwu
obj='Delete
pag=2
prev=O170
rd_kfield=[
'WUNOMEFILE
'WURIFEMTCN
]
rd_kop=[
'=
'=
]
rd_kvar=[
'tmp_impwu->WUNOMEFILE
'tmp_impwu->WURIFEMTCN
]
I
obj='Select
pag=2
sel_field='*
sel_name='wuchkimp
sel_where='wuchkimp->WUNOMEFILE=tmp_impwu->WUNOMEFILE and wuchkimp->WURIFMTCN=tmp_impwu->WURIFEMTCN
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O170
fatherSonIndex=0
frm_calc='wuchkimp->WUNOMEFILE
len=50
name='nomefileimport
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_i
next=Icpitembatch.CPBeginEnd
comment='Azzera variabili Locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='variabili per il calcolo del codice fiscale
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Inserisce i valori nelle variabili
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'wuchkimp->WUFLGFRC='N'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_esito = 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_esito=1
]
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='tmp_impwu
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPDelete
arch='wuchkimp
obj='Delete
pag=2
prev=O196
rd_kfield=[
'WUCODICE
]
rd_kop=[
'=
]
rd_kvar=[
'wuchkimp->WUCODICE
]
I
obj='Var
obj_type='N
pag=2
prev=O195
var_op='asgn
I
obj='Insert
pag=2
prev=O192
rd_kfield=[
'WUNOMEFILE
'WURIFEMTCN
'WUNCLIENTE
'WUCODDIPEN
'WUTIPESITO
]
rd_kvar=[
'nomefileimport
'_uniquecode
'Left(LRTrim(_cognome)+" "+LRTrim(_nome),70)
'_coddip
'_tiperr
]
I
obj='If
pag=2
prev=O189
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O192
fatherSonIndex=0
frm_calc='Scrive l'errore
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGWUCHKIMP\'"+LRTrim(gAzienda)+"'",0,10)
len=10
name='nProg
next=Icpitembatch.CPInsert
arch='wuchkimp
next=Icpitembatch.CPVarDecl
frm_calc='_nerrori + 1
len=10
name='_nerrori
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPERR\'"+LRTrim(gAzienda)+"'",0,10)
len=10
name='eProg
next=Icpitembatch.CPInsert
arch='mtimperr
obj='Insert
pag=2
prev=O209
rd_kfield=[
'EICODICE
'EICODMAG
'EINOMFIL
'EIMTCN
'EIDATIMP
'EITXTFLD
'EIMSGERR
]
rd_kvar=[
'eProg
'w_codmage
'nomefileimport
'_uniquecode
'DateTime()
'_txtope
'_merr
]
I
obj='Var
obj_type='N
pag=2
prev=O208
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O207
var_op='asgn
I
obj='Insert
pag=2
prev=O206
rd_kfield=[
'WUADOCRIL
'WUBCITCLI
'WUBSTACLI
'WUCAPCLI
'WUCITCLI
'WUCODDIP
'WUCODFIS
'WUCODICE
'WUCODMAGE
'WUCOGCLI
'WUCOGCON
'WUDATNAS
'WUDATOPE
'WUFLGALL
'WUIMPORTO
'WUINDCLI
'WUNDOCCLI
'WUNOMCLI
'WUNOMCON
'WUNOMEFILE
'WUNOTE
'WUORIGCF
'WURDOCCLI
'WURIFMTCN
'WUSDOCCLI
'WUSEXCLI
'WUSTADES
'WUTDOCCLI
'WUTIPERR
'WUTIPOPE
'WUFLGFRC
]
rd_kvar=[
'Left(LRTrim(_autril),30)
'Left(LRTrim(_nascitta),40)
'Left(LRTrim(_nasstato),40)
'Left(LRTrim(_cap),5)
'Left(LRTrim(_citta),40)
'Left(LRTrim(_coddip),6)
'Left(LRTrim(_codfis),16)
'nProg
'w_codmage
'Left(LRTrim(_cognome),40)
'Left(LRTrim(_cognomecp),40)
'arfn_fdate(_nasdata)
'arfn_fdate(_datope)
''N'
'(_importo/100)
'Left(LRTrim(_via),60)
'Left(LRTrim(_numdoc),25)
'Left(LRTrim(_nome),40)
'Left(LRTrim(_nomecp),40)
'Left(LRTrim(nomefileimport),20)
'_listerr
'wuchkimp->WUORIGCF
'arfn_fdate(_docril)
'Left(LRTrim(_uniquecode),10)
'arfn_fdate(_docsca)
'Left(LRTrim(_sesso),1)
'Left(LRTrim(_statodest),3)
'Left(LRTrim(_tipodoc),1)
'Left(LRTrim(_tiperr),2)
'Left(LRTrim(_tipoop),1)
''N'
]
I
obj='Var
obj_type='N
pag=2
prev=O205
var_op='asgn
I
obj='Remark
pag=2
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O186
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Scrive dati cliente
father=O189
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Scrive dati operazione
h=[
19
19
]
obj='Begin
pag=2
prev=O218
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Decide causale analitica e sintetica
father=O220
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Dipendenza
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='_codrap
next=Icpitembatch.CPIfElse
frm_calc=[
'w_xMAFLGRAP='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_destfin='O'
'w_destfin='F'
]
h=[
19
19
19
]
obj='If
pag=2
prev=O229
sons=[
Icpitembatch.CPItemSon
comment='Se destinazione operazioni
instr=Icpitembatch.CPVarDecl
father=O232
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O237
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O238
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PPOPER1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPInsert
arch='xperazbo
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xocopebo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_tiperr))
]
h=[
19
19
]
obj='If
pag=2
prev=O247
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O249
fatherSonIndex=0
frm_calc=''+0'
len=2
name='_tiperr
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=2
prev=O245
rd_kfield=[
'NUMPROG
'CONNESCLI
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DATAVALI
'DOMICILIO
'DESCCIT
'PROVINCIA
'CAP
'IDFILE
]
rd_kvar=[
'cOpeProg2
'Left(_connes,16)
'Left(_doctype,2)
'Left(_numdoc,15)
'_docril
'Left(_autril,30)
'_docsca
'Left(_via,35)
'Left(_citta,30)
'Left(_prov,2)
'Left(_cap,5)
'_idfile
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O247
fatherSonIndex=0
frm_calc='gMsgProc +"XOCOPEBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN " + _uniquecode + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O263
I
obj='Var
obj_type='N
pag=2
prev=O262
var_op='asgn
I
obj='Exec
pag=2
prev=O261
I
nonlocal=True
obj='Var
pag=2
prev=O260
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Insert
pag=2
prev=O244
rd_kfield=[
'C_RAG
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CODANA
'CODDIPE
'CODINTER
'CODVOC
'CONNESCLI
'DATAOPE
'DATAREG
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPOPE
'SEGNO
'STATOREG
'TIPOINF
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'MTCN
'CONNESDOC
'IDFILE
'RAPPORTO
'CDATREG
'CODCAB
'DESCCIT
'PROVINCIA
]
rd_kvar=[
'Left(LRTrim(_cognomecp)+" "+LRTrim(_nomecp),70)
'_uifdest
'1
'DateToChar(_datope)
'DateToChar(_datope)
'_codana
'_coddip
'_intercod
'_codsin
'_codfis
'_datope
'Date()
'iif(w_xMAFLGBON='S','0','1')
''0'
''3'
'cOpeProg1
'DateToChar(_datope)+cOpeProg2+'Z'
'cOpeProg2
''1'
'nProgImp
'_segno
''0'
''1'
'_tipope
'iif(w_xMAFLGBON='S',0,_importo)
'_importo
'_uniquecode
''242'
'_uniquecode
'LRTrim(w_codmage)+"_"+_codfis+"_"+LRTrim(_doctype)+"_"+Left(_numdoc,15)
'_idfile
'_codrap
'DateToChar(Date())
'iif(Empty(LRTrim(_cabinter)),_intercab,_cabinter)
'iif(Empty(LRTrim(_citinter)),Left(_intercit,30),Left(_citinter,30))
'iif(Empty(LRTrim(_prvinter)),_interprv,_prvinter)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O245
fatherSonIndex=0
frm_calc='gMsgProc +"XPERAZBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O273
I
obj='Var
obj_type='N
pag=2
prev=O272
var_op='asgn
I
obj='Exec
pag=2
prev=O271
I
nonlocal=True
obj='Var
pag=2
prev=O270
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=2
prev=O243
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O238
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("POPERAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPInsert
arch='operazbo
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='docopebo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_tiperr))
]
h=[
19
19
]
obj='If
pag=2
prev=O281
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O283
fatherSonIndex=0
frm_calc=''+0'
len=2
name='_tiperr
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=2
prev=O279
rd_kfield=[
'NUMPROG
'CONNESCLI
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DATAVALI
'DOMICILIO
'DESCCIT
'PROVINCIA
'CAP
'IDFILE
]
rd_kvar=[
'cOpeProg2
'Left(_connes,16)
'Left(_doctype,2)
'Left(_numdoc,15)
'_docril
'Left(_autril,30)
'_docsca
'Left(_via,35)
'Left(_citta,30)
'Left(_prov,2)
'Left(_cap,5)
'_idfile
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O281
fatherSonIndex=0
frm_calc='gMsgProc +"DOCOPEBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O297
I
obj='Var
obj_type='N
pag=2
prev=O296
var_op='asgn
I
obj='Exec
pag=2
prev=O295
I
nonlocal=True
obj='Var
pag=2
prev=O294
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Insert
pag=2
prev=O278
rd_kfield=[
'C_RAG
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CODANA
'CODDIPE
'CODINTER
'CODVOC
'CONNESCLI
'DATAOPE
'DATAREG
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPOPE
'SEGNO
'STATOREG
'TIPOINF
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'MTCN
'CONNESDOC
'IDFILE
'RAPPORTO
'CDATREG
'CODCAB
'DESCCIT
'PROVINCIA
]
rd_kvar=[
'Left(LRTrim(_cognomecp)+" "+LRTrim(_nomecp),70)
'_uifdest
'1
'DateToChar(_datope)
'DateToChar(_datope)
'_codana
'_coddip
'_intercod
'_codsin
'_codfis
'_datope
'Date()
'iif(w_xMAFLGBON='S','0','1')
''0'
''3'
'cOpeProg1
'DateToChar(_datope)+cOpeProg2+'Z'
'cOpeProg2
''1'
'nProgImp
'_segno
''0'
''1'
'_tipope
'iif(w_xMAFLGBON='S',0,_importo)
'_importo
'_uniquecode
''242'
'_uniquecode
'LRTrim(w_codmage)+"_"+_codfis+"_"+LRTrim(_doctype)+"_"+Left(_numdoc,15)
'_idfile
'_codrap
'DateToChar(Date())
'iif(Empty(LRTrim(_cabinter)),_intercab,_cabinter)
'iif(Empty(LRTrim(_citinter)),Left(_intercit,30),Left(_citinter,30))
'iif(Empty(LRTrim(_prvinter)),_interprv,_prvinter)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O279
fatherSonIndex=0
frm_calc='gMsgProc +"OPERAZBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O307
I
obj='Var
obj_type='N
pag=2
prev=O306
var_op='asgn
I
obj='Exec
pag=2
prev=O305
I
nonlocal=True
obj='Var
pag=2
prev=O304
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=2
prev=O277
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='Se destinazione frazionate
instr=Icpitembatch.CPVarDecl
father=O232
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O312
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O313
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PPFRAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPFRAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPInsert
arch='xraziobo
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xocfrabo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_tiperr))
]
h=[
19
19
]
obj='If
pag=2
prev=O322
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O324
fatherSonIndex=0
frm_calc=''+0'
len=2
name='_tiperr
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=2
prev=O320
rd_kfield=[
'NUMPROG
'CONNESCLI
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DATAVALI
'DOMICILIO
'DESCCIT
'PROVINCIA
'CAP
'IDFILE
]
rd_kvar=[
'cOpeProg2
'Left(_connes,16)
'Left(_doctype,2)
'Left(_numdoc,15)
'_docril
'Left(_autril,30)
'_docsca
'Left(_via,35)
'Left(_citta,30)
'Left(_prov,2)
'Left(_cap,5)
'_idfile
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O322
fatherSonIndex=0
frm_calc='gMsgProc +"XOCFRABO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN " + _uniquecode + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O338
I
obj='Var
obj_type='N
pag=2
prev=O337
var_op='asgn
I
obj='Exec
pag=2
prev=O336
I
nonlocal=True
obj='Var
pag=2
prev=O335
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Insert
pag=2
prev=O319
rd_kfield=[
'C_RAG
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CODANA
'CODDIPE
'CODINTER
'CODVOC
'CONNESCLI
'DATAOPE
'DATAREG
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPFRZ
'SEGNO
'STATOREG
'TIPOINF
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'MTCN
'CONNESDOC
'IDFILE
'RAPPORTO
'CDATREG
'CODCAB
'DESCCIT
'PROVINCIA
]
rd_kvar=[
'Left(LRTrim(_cognomecp)+" "+LRTrim(_nomecp),70)
'_uifdest
'1
'DateToChar(_datope)
'DateToChar(_datope)
'_codana
'_coddip
'_intercod
'_codsin
'_codfis
'_datope
'Date()
'iif(w_xMAFLGBON='S','0','1')
''0'
''3'
'cOpeProg1
'DateToChar(_datope)+cOpeProg2+'Z'
'cOpeProg2
''1'
'nProgImp
'_segno
''0'
''1'
'_tipope
'iif(w_xMAFLGBON='S',0,_importo)
'_importo
'_uniquecode
''242'
'_uniquecode
'LRTrim(w_codmage)+"_"+_codfis+"_"+LRTrim(_doctype)+"_"+Left(_numdoc,15)
'_idfile
'_codrap
'DateToChar(Date())
'iif(Empty(LRTrim(_cabinter)),_intercab,_cabinter)
'iif(Empty(LRTrim(_citinter)),Left(_intercit,30),Left(_citinter,30))
'iif(Empty(LRTrim(_prvinter)),_interprv,_prvinter)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O320
fatherSonIndex=0
frm_calc='gMsgProc +"XRAZIOBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O348
I
obj='Var
obj_type='N
pag=2
prev=O347
var_op='asgn
I
obj='Exec
pag=2
prev=O346
I
nonlocal=True
obj='Var
pag=2
prev=O345
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=2
prev=O318
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O313
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PFRAZIO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPInsert
arch='fraziobo
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='docfrabo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_tiperr))
]
h=[
19
19
]
obj='If
pag=2
prev=O356
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O358
fatherSonIndex=0
frm_calc=''+0'
len=2
name='_tiperr
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=2
prev=O354
rd_kfield=[
'NUMPROG
'CONNESCLI
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DATAVALI
'DOMICILIO
'DESCCIT
'PROVINCIA
'CAP
'IDFILE
]
rd_kvar=[
'cOpeProg2
'Left(_connes,16)
'Left(_doctype,2)
'Left(_numdoc,15)
'_docril
'Left(_autril,30)
'_docsca
'Left(_via,35)
'Left(_citta,30)
'Left(_prov,2)
'Left(_cap,5)
'_idfile
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O356
fatherSonIndex=0
frm_calc='gMsgProc +"DOCFRABO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O372
I
obj='Var
obj_type='N
pag=2
prev=O371
var_op='asgn
I
obj='Exec
pag=2
prev=O370
I
nonlocal=True
obj='Var
pag=2
prev=O369
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Insert
pag=2
prev=O353
rd_kfield=[
'C_RAG
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CODANA
'CODDIPE
'CODINTER
'CODVOC
'CONNESCLI
'DATAOPE
'DATAREG
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPFRZ
'SEGNO
'STATOREG
'TIPOINF
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'MTCN
'CONNESDOC
'IDFILE
'RAPPORTO
'CDATREG
'CODCAB
'DESCCIT
'PROVINCIA
]
rd_kvar=[
'Left(LRTrim(_cognomecp)+" "+LRTrim(_nomecp),70)
'_uifdest
'1
'DateToChar(_datope)
'DateToChar(_datope)
'_codana
'_coddip
'_intercod
'_codsin
'_codfis
'_datope
'Date()
'iif(w_xMAFLGBON='S','0','1')
''0'
''3'
'cOpeProg1
'DateToChar(_datope)+cOpeProg2+'Z'
'cOpeProg2
''1'
'nProgImp
'_segno
''0'
''1'
'_tipope
'iif(w_xMAFLGBON='S',0,_importo)
'_importo
'_uniquecode
''242'
'_uniquecode
'LRTrim(w_codmage)+"_"+_codfis+"_"+LRTrim(_doctype)+"_"+Left(_numdoc,15)
'_idfile
'_codrap
'DateToChar(Date())
'iif(Empty(LRTrim(_cabinter)),_intercab,_cabinter)
'iif(Empty(LRTrim(_citinter)),Left(_intercit,30),Left(_citinter,30))
'iif(Empty(LRTrim(_prvinter)),_interprv,_prvinter)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O354
fatherSonIndex=0
frm_calc='gMsgProc +"FRAZIOBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O382
I
obj='Var
obj_type='N
pag=2
prev=O381
var_op='asgn
I
obj='Exec
pag=2
prev=O380
I
nonlocal=True
obj='Var
pag=2
prev=O379
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=2
prev=O352
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
prev=O228
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O229
fatherSonIndex=0
frm_calc='3
obj='Exec
pag=2
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O226
var_op='asgn
I
obj='Begin
pag=2
prev=O224
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O226
fatherSonIndex=0
frm_calc='''
len=30
name='_citinter
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_cabinter
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_prvinter
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=2
prev=O395
sel_field='*
sel_name='anadip
sel_where='anadip->CODDIP=_coddip
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O396
fatherSonIndex=0
frm_calc='anadip->DESCCIT
len=30
name='_citinter
next=Icpitembatch.CPVarDecl
frm_calc='anadip->CAB
len=6
name='_cabinter
next=Icpitembatch.CPVarDecl
frm_calc='anadip->PROVINCIA
len=2
name='_prvinter
obj='Var
pag=2
prev=O401
var_op='asgn
I
obj='Var
pag=2
prev=O400
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O394
var_op='asgn
I
obj='Var
pag=2
prev=O393
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O224
fatherSonIndex=0
frm_calc=[
'_tipoop='P'
'_tipoop='S'
]
h=[
19
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O407
fatherSonIndex=0
frm_calc=[
'LRTrim(_isodest)='IT'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'w_xMAFLGBON='S'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc=''D'
len=1
name='_segno
obj='Var
pag=2
prev=O415
var_op='asgn
I
obj='If
pag=2
prev=O412
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O415
fatherSonIndex=0
frm_calc=''11'
len=2
name='_tipope
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O415
fatherSonIndex=1
frm_calc=''10'
len=2
name='_tipope
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O412
fatherSonIndex=0
frm_calc=''26'
len=4
name='_codana
next=Icpitembatch.CPVarDecl
frm_calc=''3M'
len=2
name='_codsin
obj='Var
pag=2
prev=O427
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O412
fatherSonIndex=1
frm_calc=''AA'
len=4
name='_codana
next=Icpitembatch.CPVarDecl
frm_calc=''3M'
len=2
name='_codsin
obj='Var
pag=2
prev=O430
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O407
fatherSonIndex=1
frm_calc=[
'LRTrim(_isodest)='IT'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'w_xMAFLGBON='S'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc=''A'
len=1
name='_segno
obj='Var
pag=2
prev=O437
var_op='asgn
I
obj='If
pag=2
prev=O434
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O437
fatherSonIndex=0
frm_calc=''12'
len=2
name='_tipope
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O437
fatherSonIndex=1
frm_calc=''10'
len=2
name='_tipope
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O434
fatherSonIndex=0
frm_calc=''48'
len=4
name='_codana
next=Icpitembatch.CPVarDecl
frm_calc=''4M'
len=2
name='_codsin
obj='Var
pag=2
prev=O449
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O434
fatherSonIndex=1
frm_calc=''AA'
len=4
name='_codana
next=Icpitembatch.CPVarDecl
frm_calc=''4M'
len=2
name='_codsin
obj='Var
pag=2
prev=O452
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O218
fatherSonIndex=0
frm_calc='''
len=1
name='w_xMAFLGRAP
next=Icpitembatch.CPRead
arch='tbmacage
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_connes
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(_codfis,12,1)='Z'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_prov
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_cab
next=Icpitembatch.CPRead
arch='tbcitta
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_connes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O469
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O470
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPOCLI\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='_codfis
len=16
name='_connes
next=Icpitembatch.CPInsert
arch='personbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=50
name='_condoc
next=Icpitembatch.CPRead
arch='kersonbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_condoc))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'w_opextc='S'
]
h=[
19
19
]
obj='If
pag=2
prev=O481
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O484
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGAEOPEXTR\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='_prog
next=Icpitembatch.CPInsert
arch='aeoprig
next=Icpitembatch.CPInsert
arch='opextrbo
obj='Insert
pag=2
prev=O490
rd_kfield=[
'COLLEG
'ANNO
'IDBASE
'DATAOPE
'COINT
'NUMPROG1
'IDFILE
]
rd_kvar=[
'_connes
'Str(Year(_datope),4,0)
'LibreriaMit.UniqueId()
'_datope
''N'
'_prog
'_idfile
]
I
obj='Insert
pag=2
prev=O489
rd_kfield=[
'IDBASE
'CONNESINT
'ADATA
'TIPOAG
'COINT
]
rd_kvar=[
'_prog
'_connes
'_datope
''98'
''2'
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O480
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='kersonbo
father=O481
fatherSonIndex=0
h=[
19
19
]
obj='Insert
pag=2
rd_kfield=[
'CONNES
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'CAP
'SESSO
'DATAVALI
'TIPOPERS
'COGNOME
'NOME
'TIPINTER
'CFESTERO
'NASSTATO
'ALLINEATO
'ALLINEATONOMECNOME
'PROGIMPORT
'PEP
'PROVINCIA
'CODCAB
'IDFILE
'PAESE
]
rd_kvar=[
'LRTrim(w_codmage)+"_"+_codfis+"_"+LRTrim(_doctype)+"_"+Left(_numdoc,15)
'Left(LRTrim(_cognome)+" "+LRTrim(_nome),70)
'Left(_via,35)
'_codfis
'_nasdata
'Left(_nascitta,30)
''600'
'''
''600'
'_doctype
'Left(_numdoc,15)
'_docril
'Left(_autril,30)
'Left(_citta,30)
'Left(_cap,5)
'iif(_sesso='M','1','2')
'_docsca
''P'
'Left(_cognome,26)
'Left(_nome,25)
'Left(_nasprov,2)
'iif((wuchkimp->WUCODCLC+_nocf) >= 1,1,0)
'Left(_nasstato,30)
'0
'0
'nProgImp
''N'
'Left(_prov,2)
'Left(_cab,6)
'_idfile
'_statores
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O499
fatherSonIndex=0
frm_calc='gMsgProc +"KERSONBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O508
I
obj='Exec
pag=2
prev=O507
I
obj='Var
obj_type='N
pag=2
prev=O506
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O505
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='kersonbo
father=O481
fatherSonIndex=1
frm_calc='Errore in aggiornamento ARCHPERS
h=[
19
19
]
obj='Write
pag=2
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(w_codmage)+"_"+_codfis+"_"+LRTrim(_doctype)+"_"+Left(_numdoc,15)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O512
fatherSonIndex=0
frm_calc='gMsgProc +"KERSONBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O522
I
obj='Exec
pag=2
prev=O521
I
obj='Var
obj_type='N
pag=2
prev=O520
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O519
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'CAP
'SESSO
'DATAVALI
'COGNOME
'NOME
'TIPINTER
'NASSTATO
'ALLINEATONOMECNOME
'PEP
'IDFILE
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Left(_cab,6)
'Left(LRTrim(_cognome)+" "+LRTrim(_nome),70)
'Left(_via,35)
'_codfis
'_nasdata
'Left(_nascitta,30)
''600'
'''
''600'
'_doctype
'Left(_numdoc,15)
'_docril
'Left(_autril,30)
'Left(_citta,30)
'Left(_prov,2)
'Left(_cap,5)
'iif(_sesso='M','1','2')
'_docsca
'Left(_cognome,26)
'Left(_nome,25)
'Left(_nasprov,2)
'Left(_nasstato,30)
'0
''N'
'_idfile
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O479
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'w_codmage+"_"+_codfis+"_"+LRTrim(_doctype)+"_"+Left(_numdoc,15)
]
rd_var=[
'_condoc
]
I
obj='Var
pag=2
prev=O477
var_op='asgn
I
obj='Insert
pag=2
prev=O476
rd_kfield=[
'ALLINEATO
'ALLINEATONOMECNOME
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'CONNES
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOMICILIO
'IDFILE
'MACROAGENTE
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'OLDCODFISC
'PAESE
'PEP
'PROGIMPORT
'PROVINCIA
'RAGSOC
'RAMOGRUP
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'TIPOPERS
]
rd_kvar=[
'0
'0
'Left(_autril,30)
'Left(_cap,5)
'iif((wuchkimp->WUCODCLC+_nocf) >= 1,1,0)
'Left(_cab,6)
'_codfis
'Left(_cognome,26)
'_codfis
'_nasdata
'_docril
'_docsca
'Left(_citta,30)
'Left(_via,35)
'_idfile
'w_codmage
'Left(_nascitta,30)
'Left(_nasstato,30)
'Left(_nome,25)
'Left(_numdoc,15)
'_oldcodfis
'_statores
''N'
'nProgImp
'Left(_prov,2)
'Left(LRTrim(_cognome)+" "+LRTrim(_nome),70)
'''
'iif(_sesso='M','1','2')
''600'
''600'
'Left(_nasprov,2)
'_doctype
''P'
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O477
fatherSonIndex=0
frm_calc='gMsgProc +"PERSONBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O540
I
obj='Exec
pag=2
prev=O539
I
obj='Var
obj_type='N
pag=2
prev=O538
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O537
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=2
prev=O475
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O470
fatherSonIndex=1
frm_calc='0
len=1
name='_aggcli
next=Icpitembatch.CPCase
frm_calc=[
'LRTrim(w_codmage)='COSTA'
'w_codmage='FININ'
'w_codmage='BCAUC'
'w_codmage='BCISP'
'w_codmage='BCASS' or LRTrim(w_codmage)='E998' or LRTrim(w_codmage)='EBDSS' or LRTrim(w_codmage)='I999'
'w_codmage='DHLSP'
'w_codmage='TRAVX'
]
h=[
19
19
19
19
19
19
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_aggcli = 1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=50
name='_condoc
next=Icpitembatch.CPRead
arch='kersonbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_condoc))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'w_opextc='S'
]
h=[
19
19
]
obj='If
pag=2
prev=O553
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O556
fatherSonIndex=0
frm_calc='''
len=10
name='_prog
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_prog))
]
h=[
19
19
]
obj='If
pag=2
prev=O562
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O564
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGAEOPEXTR\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='_prog
next=Icpitembatch.CPInsert
arch='aeoprig
next=Icpitembatch.CPInsert
arch='opextrbo
obj='Insert
pag=2
prev=O570
rd_kfield=[
'COLLEG
'ANNO
'IDBASE
'DATAOPE
'COINT
'NUMPROG1
'IDFILE
]
rd_kvar=[
'_connes
'Str(Year(_datope),4,0)
'LibreriaMit.UniqueId()
'_datope
''N'
'_prog
'_idfile
]
I
obj='Insert
pag=2
prev=O569
rd_kfield=[
'IDBASE
'CONNESINT
'ADATA
'TIPOAG
'COINT
]
rd_kvar=[
'_prog
'_connes
'_datope
''98'
''2'
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=2
prev=O561
sel_field='opextrbo->ANNO,opextrbo->IDBASE
sel_name='opextrbo
sel_where='opextrbo->COLLEG=_connes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O562
fatherSonIndex=0
frm_calc=[
'opextrbo->ANNO=Str(Year(_datope),4,0)
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O579
fatherSonIndex=0
frm_calc='opextrbo->IDBASE
len=10
name='_prog
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O552
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='kersonbo
father=O553
fatherSonIndex=0
h=[
19
19
]
obj='Insert
pag=2
rd_kfield=[
'CONNES
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'CAP
'SESSO
'DATAVALI
'TIPOPERS
'COGNOME
'NOME
'TIPINTER
'CFESTERO
'NASSTATO
'ALLINEATO
'ALLINEATONOMECNOME
'PROGIMPORT
'PEP
'PROVINCIA
'CODCAB
'IDFILE
'PAESE
]
rd_kvar=[
'LRTrim(w_codmage)+"_"+_codfis+"_"+LRTrim(_doctype)+"_"+Left(_numdoc,15)
'Left(LRTrim(_cognome)+" "+LRTrim(_nome),70)
'Left(_via,35)
'_codfis
'_nasdata
'Left(_nascitta,30)
''600'
'''
''600'
'_doctype
'Left(_numdoc,15)
'_docril
'Left(_autril,30)
'Left(_citta,30)
'Left(_cap,5)
'iif(_sesso='M','1','2')
'_docsca
''P'
'Left(_cognome,26)
'Left(_nome,25)
'Left(_nasprov,2)
'iif((wuchkimp->WUCODCLC+_nocf) >= 1,1,0)
'Left(_nasstato,30)
'0
'0
'nProgImp
''N'
'Left(_prov,2)
'Left(_cab,6)
'_idfile
'_statores
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O590
fatherSonIndex=0
frm_calc='gMsgProc +"KERSONBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O599
I
obj='Exec
pag=2
prev=O598
I
obj='Var
obj_type='N
pag=2
prev=O597
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O596
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O553
fatherSonIndex=1
frm_calc=[
'_aggcli=1
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='kersonbo
father=O603
fatherSonIndex=0
frm_calc='Errore in aggiornamento ARCHPERS
h=[
19
19
]
obj='Write
pag=2
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(w_codmage)+"_"+_codfis+"_"+LRTrim(_doctype)+"_"+Left(_numdoc,15)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O608
fatherSonIndex=0
frm_calc='gMsgProc +"KERSONBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O618
I
obj='Exec
pag=2
prev=O617
I
obj='Var
obj_type='N
pag=2
prev=O616
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O615
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'CAP
'SESSO
'DATAVALI
'COGNOME
'NOME
'TIPINTER
'NASSTATO
'ALLINEATONOMECNOME
'PEP
'IDFILE
'CFESTERO
'PAESE
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Left(_cab,6)
'Left(LRTrim(_cognome)+" "+LRTrim(_nome),70)
'Left(_via,35)
'_codfis
'_nasdata
'Left(_nascitta,30)
''600'
'''
''600'
'_doctype
'Left(_numdoc,15)
'_docril
'Left(_autril,30)
'Left(_citta,30)
'Left(_prov,2)
'Left(_cap,5)
'iif(_sesso='M','1','2')
'_docsca
'Left(_cognome,26)
'Left(_nome,25)
'Left(_nasprov,2)
'Left(_nasstato,30)
'0
''N'
'_idfile
'iif((wuchkimp->WUCODCLC+_nocf) >= 1,1,0)
'_statores
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O551
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(w_codmage)+"_"+_codfis+"_"+LRTrim(_doctype)+"_"+Left(_numdoc,15)
]
rd_var=[
'_condoc
]
I
obj='Var
pag=2
prev=O548
var_op='asgn
I
obj='If
pag=2
prev=O545
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O548
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='personbo
frm_calc='Errore in aggiornamento ARCHPERS
h=[
19
19
]
obj='Write
pag=2
prev=O633
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'_connes
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O635
fatherSonIndex=0
frm_calc='gMsgProc +"PERSONBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O645
I
obj='Exec
pag=2
prev=O644
I
obj='Var
obj_type='N
pag=2
prev=O643
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O642
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'CAP
'SESSO
'DATAVALI
'COGNOME
'NOME
'TIPINTER
'NASSTATO
'ALLINEATONOMECNOME
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'CFESTERO
'PAESE
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Left(_cab,6)
'Left(LRTrim(_cognome)+" "+LRTrim(_nome),70)
'Left(_via,35)
'_codfis
'_nasdata
'Left(_nascitta,30)
''600'
'''
''600'
'_doctype
'Left(_numdoc,15)
'_docril
'Left(_autril,30)
'Left(_citta,30)
'Left(_prov,2)
'Left(_cap,5)
'iif(_sesso='M','1','2')
'_docsca
'Left(_cognome,26)
'Left(_nome,25)
'Left(_nasprov,2)
'Left(_nasstato,30)
'0
''N'
'_idfile
'_oldcodfis
'w_codmage
'iif((wuchkimp->WUCODCLC+_nocf) >= 1,1,0)
'_statores
]
I
obj='Select
pag=2
prev=O632
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=_connes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O633
fatherSonIndex=0
h=[
19
19
]
obj='Insert
pag=2
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'datamodi
'IDFILE
'OLDCODFISC
'MACROAGENTE
]
rd_kvar=[
'cProgSto
'personbo->CONNES
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'Date()
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O653
fatherSonIndex=0
frm_calc='gMsgProc +"WERSONBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O662
I
obj='Exec
pag=2
prev=O661
I
obj='Var
obj_type='N
pag=2
prev=O660
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O659
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Case
pag=2
prev=O544
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O545
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O545
fatherSonIndex=1
frm_calc=[
'_oldmac <> 'COSTA'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O671
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O545
fatherSonIndex=2
frm_calc=[
'_oldmac <> 'COSTA' and _oldmac <> 'FININ'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O679
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O545
fatherSonIndex=3
frm_calc=[
'_oldmac <> 'COSTA' and _oldmac <> 'FININ' and _oldmac <> 'BCAUC'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O687
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O545
fatherSonIndex=4
frm_calc=[
'_oldmac <> 'COSTA' and _oldmac <> 'FININ' and _oldmac <> 'BCAUC' and _oldmac <> 'BCISP'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O695
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O545
fatherSonIndex=5
frm_calc=[
'_oldmac = 'TRAVX' or _oldmac='DHLSP'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O703
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O545
fatherSonIndex=6
frm_calc=[
'_oldmac='TRAVX'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O711
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
150
150
150
150
150
]
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O468
rd_field=[
'CONNES
'MACROAGENTE
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'_codfis
]
rd_var=[
'_connes
'_oldmac
]
I
obj='Read
pag=2
prev=O467
rd_field=[
'PROV
'CAB
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_citta
]
rd_var=[
'_prov
'_cab
]
I
obj='Var
pag=2
prev=O466
var_op='asgn
I
obj='Var
pag=2
prev=O463
var_op='asgn
I
obj='If
pag=2
prev=O462
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O463
fatherSonIndex=0
frm_calc=''EE'
len=2
name='_nasprov
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O463
fatherSonIndex=1
frm_calc='''
len=2
name='_nasprov
next=Icpitembatch.CPRead
arch='tbcitta
obj='Read
pag=2
prev=O732
rd_field=[
'PROV
]
rd_kfield=[
'SIGLA
]
rd_kvar=[
'Substr(_codfis,12,4)
]
rd_var=[
'_nasprov
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O461
var_op='asgn
I
obj='Read
pag=2
prev=O460
rd_field=[
'MAFLGASR
'MAFLGBON
'MAFLGCKR
'MAFLGRAP
]
rd_kfield=[
'MACODICE
]
rd_kvar=[
'w_codmage
]
rd_var=[
'w_xMAFLGASR
'w_xMAFLGBON
'w_xMAFLGCKR
'w_xMAFLGRAP
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O184
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Verifica dipendenza
father=O186
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Verifica dati anagrafici
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Controlla dati cliente
h=[
19
19
]
obj='Begin
pag=2
prev=O749
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O751
fatherSonIndex=0
frm_calc='0
len=1
name='_nocf
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc='''
len=100
name='_merr
next=Icpitembatch.CPVarDecl
frm_calc='Strtran(_codfis," ","")
len=16
name='_codfis
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_codfis)) or Len(LRTrim(_codfis)) <> 16
'Len(LRTrim(_codfis)) = 16
]
h=[
19
19
19
]
obj='If
pag=2
prev=O758
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O759
fatherSonIndex=0
frm_calc='_codfis
len=20
name='_oldcodfis
next=Icpitembatch.CPBeginEnd
comment='variabili per il calcolo del codice fiscale
h=[
19
19
]
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_calccodfis_mt
next=Icpitembatch.CPVarDecl
frm_calc='w_CODFISC
len=16
name='_codfis
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_codfis)) < 16 or not(arfn_poscodfis(_codfis))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O768
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O769
fatherSonIndex=0
frm_calc=[
'Empty(_nascitta)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(Upper(LRTrim(w_NASSTATO)) = 'ITALIA' or Upper(LRTrim(w_NASSTATO))='ITALY' or Empty(LRTrim(w_NASSTATO))) and Empty(_siglacit)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_nasstato)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(Upper(LRTrim(w_NASSTATO)) <>  'ITALIA' and Upper(LRTrim(w_NASSTATO)) <> 'ITALY' and not(Empty(w_NASSTATO))) and Empty(_siglasta)
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc=''Codice Fiscale Ricalcolato Errato - Probabili dati mancanti'
len=100
name='_merr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Codice Fiscale Ricalcolato Errato - Probabili dati mancanti" + NL
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPVarDecl
frm_calc=''*8'
len=2
name='_tiperr
obj='Var
pag=2
prev=O788
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O787
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O786
var_op='asgn
I
obj='Var
pag=2
prev=O783
var_op='asgn
I
obj='If
pag=2
prev=O780
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O783
fatherSonIndex=0
frm_calc='_listerr + "* Stato di nascita errato" + NL
len=10
name='_listerr
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O777
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O780
fatherSonIndex=0
frm_calc='_listerr + "* Stato di nascita mancante" + NL
len=10
name='_listerr
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O774
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O777
fatherSonIndex=0
frm_calc='_listerr + "* Città di nascita errata" + NL
len=10
name='_listerr
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O774
fatherSonIndex=0
frm_calc='_listerr + "* Città di nascita mancante" + NL
len=10
name='_listerr
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O769
fatherSonIndex=1
frm_calc=''+1'
len=2
name='_tiperr
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O767
var_op='asgn
I
obj='Exec
pag=2
prev=O765
I
obj='Begin
pag=2
prev=O764
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O765
fatherSonIndex=0
frm_calc='1
len=1
name='_nocf
next=Icpitembatch.CPVarDecl
comment='Codice Fiscale
frm_calc='''
len=16
name='w_CODFISC
next=Icpitembatch.CPVarDecl
comment='Data Nascita
frm_calc='_nasdata
len=8
name='w_DATANASC
next=Icpitembatch.CPVarDecl
comment='Luogo di Nascita
frm_calc='_nascitta
len=30
name='w_NASCOMUN
next=Icpitembatch.CPVarDecl
comment='Stato di nascita
frm_calc='_nasstato
len=30
name='w_NASSTATO
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_codstanas
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='_siglacit
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='_siglasta
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(wuchkimp->WUNBSTACLI))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_codstanas))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(w_NASSTATO)) and (Upper(LRTrim(w_NASSTATO)) = 'ITALIA' or Upper(LRTrim(w_NASSTATO))='ITALY')
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(w_NASSTATO)) and Upper(LRTrim(w_NASSTATO)) <> 'ITALIA' and Upper(LRTrim(w_NASSTATO)) <> 'ITALY'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
frm_calc='_cognome
len=26
name='w_COGNOME
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
frm_calc='LRTrim(_cognome)+" "+LRTrim(_nome)
len=70
name='w_RAGSOC
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
frm_calc='_nome
len=25
name='w_NOME
next=Icpitembatch.CPVarDecl
comment='Sesso
frm_calc='iif(_sesso='M','1',iif(_sesso='F','2',_sesso))
len=1
name='w_SESSO
obj='Var
pag=2
prev=O833
var_op='asgn
I
obj='Var
pag=2
prev=O832
var_op='asgn
I
obj='Var
pag=2
prev=O831
var_op='asgn
I
obj='Var
pag=2
prev=O828
var_op='asgn
I
obj='If
pag=2
prev=O825
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbstati
father=O828
fatherSonIndex=0
obj='Read
pag=2
rd_field=[
'SIGLA
]
rd_kfield=[
'DESCRI
]
rd_kvar=[
'_nasstato
]
rd_var=[
'_siglasta
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O822
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O825
fatherSonIndex=0
obj='Read
pag=2
rd_field=[
'SIGLA
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_nascitta
]
rd_var=[
'_siglacit
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O819
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O822
fatherSonIndex=0
frm_calc=[
'Substr(_codfis,12,1)='Z'
'not(Empty(Substr(_codfis,12,1))) and Substr(_codfis,12,1) <> 'Z'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
comment='Stato di nascita
frm_calc='_nasstato
len=30
name='w_NASSTATO
obj='Var
pag=2
prev=O853
var_op='asgn
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbstati
father=O853
fatherSonIndex=0
obj='Read
pag=2
rd_field=[
'DESCRI
'SIGLA
]
rd_kfield=[
'SIGLA
]
rd_kvar=[
'Substr(_codfis,12,4)
]
rd_var=[
'_nasstato
'_siglasta
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O853
fatherSonIndex=1
frm_calc=''ITALIA'
len=30
name='_nasstato
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O818
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='mtstati
father=O819
fatherSonIndex=0
obj='Read
pag=2
rd_field=[
'SIGLA
]
rd_kfield=[
'DESCRI
]
rd_kvar=[
'Upper(_nasstato)
]
rd_var=[
'_codstanas
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbstati
father=O819
fatherSonIndex=1
obj='Read
pag=2
rd_field=[
'SIGLA
]
rd_kfield=[
'DESCRI
]
rd_kvar=[
'Upper(_nasstato)
]
rd_var=[
'_codstanas
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O817
var_op='asgn
I
obj='Var
pag=2
prev=O816
var_op='asgn
I
obj='Var
pag=2
prev=O815
var_op='asgn
I
obj='Var
pag=2
prev=O814
var_op='asgn
I
obj='Var
pag=2
prev=O813
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O812
var_op='asgn
I
obj='Var
pag=2
prev=O811
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O759
fatherSonIndex=1
frm_calc=[
'not(arfn_poscodfis(_codfis))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O884
fatherSonIndex=0
frm_calc='_codfis
len=20
name='_oldcodfis
next=Icpitembatch.CPBeginEnd
comment='variabili per il calcolo del codice fiscale
h=[
19
19
]
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_calccodfis_mt
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(w_CODFISC)) < 16 or not(arfn_poscodfis(w_CODFISC))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O892
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O893
fatherSonIndex=0
frm_calc=[
'Empty(_nascitta)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(Upper(LRTrim(w_NASSTATO)) = 'ITALIA' or Upper(LRTrim(w_NASSTATO))='ITALY' or Empty(LRTrim(w_NASSTATO))) and Empty(_siglacit)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_nasstato)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(Upper(LRTrim(w_NASSTATO)) <>  'ITALIA' and Upper(LRTrim(w_NASSTATO)) <> 'ITALY' and not(Empty(w_NASSTATO))) and Empty(_siglasta)
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc=''Codice Fiscale Ricalcolato - Probabili dati anagrafici errati o mancanti'
len=100
name='_merr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Codice Fiscale Ricalcolato - Probabili dati anagrafici errati o mancanti" + NL
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPVarDecl
frm_calc=''*9'
len=2
name='_tiperr
obj='Var
pag=2
prev=O912
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O911
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O910
var_op='asgn
I
obj='Var
pag=2
prev=O907
var_op='asgn
I
obj='If
pag=2
prev=O904
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O907
fatherSonIndex=0
frm_calc='_listerr + "* Stato di nascita errato" + NL
len=10
name='_listerr
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O901
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O904
fatherSonIndex=0
frm_calc='_listerr + "* Stato di nascita mancante" + NL
len=10
name='_listerr
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O898
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O901
fatherSonIndex=0
frm_calc='_listerr + "* Città di nascita errata" + NL
len=10
name='_listerr
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O898
fatherSonIndex=0
frm_calc='_listerr + "* Città di nascita mancante" + NL
len=10
name='_listerr
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O893
fatherSonIndex=1
frm_calc=''+1'
len=2
name='_tiperr
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=2
prev=O890
I
obj='Begin
pag=2
prev=O889
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O890
fatherSonIndex=0
frm_calc='1
len=1
name='_nocf
next=Icpitembatch.CPVarDecl
comment='Codice Fiscale
frm_calc='''
len=16
name='w_CODFISC
next=Icpitembatch.CPVarDecl
comment='Data Nascita
frm_calc='_nasdata
len=8
name='w_DATANASC
next=Icpitembatch.CPVarDecl
comment='Luogo di Nascita
frm_calc='_nascitta
len=30
name='w_NASCOMUN
next=Icpitembatch.CPVarDecl
comment='Stato di nascita
frm_calc='_nasstato
len=30
name='w_NASSTATO
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_codstanas
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='_siglacit
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='_siglasta
next=Icpitembatch.CPRead
arch='mtstati
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_codstanas))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(w_NASSTATO)) and (Upper(LRTrim(w_NASSTATO)) = 'ITALIA' or Upper(LRTrim(w_NASSTATO))='ITALY')
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(w_NASSTATO)) and Upper(LRTrim(w_NASSTATO)) <> 'ITALIA' and Upper(LRTrim(w_NASSTATO)) <> 'ITALY'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
frm_calc='_cognome
len=26
name='w_COGNOME
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
frm_calc='LRTrim(_cognome)+" "+LRTrim(_nome)
len=70
name='w_RAGSOC
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
frm_calc='_nome
len=25
name='w_NOME
next=Icpitembatch.CPVarDecl
comment='Sesso
frm_calc='iif(_sesso='M','1',iif(_sesso='F','2',_sesso))
len=1
name='w_SESSO
obj='Var
pag=2
prev=O955
var_op='asgn
I
obj='Var
pag=2
prev=O954
var_op='asgn
I
obj='Var
pag=2
prev=O953
var_op='asgn
I
obj='Var
pag=2
prev=O950
var_op='asgn
I
obj='If
pag=2
prev=O947
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbstati
father=O950
fatherSonIndex=0
obj='Read
pag=2
rd_field=[
'SIGLA
]
rd_kfield=[
'DESCRI
]
rd_kvar=[
'_nasstato
]
rd_var=[
'_siglasta
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O944
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O947
fatherSonIndex=0
obj='Read
pag=2
rd_field=[
'SIGLA
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_nascitta
]
rd_var=[
'_siglacit
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O943
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O944
fatherSonIndex=0
frm_calc=[
'Substr(_codfis,12,1)='Z'
'not(Empty(Substr(_codfis,12,1))) and Substr(_codfis,12,1) <> 'Z'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
comment='Stato di nascita
frm_calc='_nasstato
len=30
name='w_NASSTATO
obj='Var
pag=2
prev=O975
var_op='asgn
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbstati
father=O975
fatherSonIndex=0
obj='Read
pag=2
rd_field=[
'DESCRI
'SIGLA
]
rd_kfield=[
'SIGLA
]
rd_kvar=[
'Substr(_codfis,12,4)
]
rd_var=[
'_nasstato
'_siglasta
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O975
fatherSonIndex=1
frm_calc=''ITALIA'
len=30
name='_nasstato
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=2
prev=O942
rd_field=[
'SIGLA
]
rd_kfield=[
'DESCRI
]
rd_kvar=[
'Upper(_nasstato)
]
rd_var=[
'_codstanas
]
I
obj='Var
pag=2
prev=O941
var_op='asgn
I
obj='Var
pag=2
prev=O940
var_op='asgn
I
obj='Var
pag=2
prev=O939
var_op='asgn
I
obj='Var
pag=2
prev=O938
var_op='asgn
I
obj='Var
pag=2
prev=O937
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O936
var_op='asgn
I
obj='Var
pag=2
prev=O935
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O884
fatherSonIndex=1
frm_calc=[
'Substr(_codfis,12,1)='Z'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbstati
father=O996
fatherSonIndex=0
obj='Read
pag=2
rd_field=[
'DESCRI
]
rd_kfield=[
'SIGLA
]
rd_kvar=[
'Substr(_codfis,12,4)
]
rd_var=[
'_nasstato
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O996
fatherSonIndex=1
frm_calc=''ITALIA'
len=30
name='_nasstato
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O757
var_op='asgn
I
obj='Var
pag=2
prev=O756
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O755
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O747
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O749
fatherSonIndex=0
frm_calc=[
'Year(_datope) < 1900
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_nasdata)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_docril)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_docsca)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_sesso)
]
h=[
19
19
]
obj='If
pag=2
prev=O1023
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1026
fatherSonIndex=0
frm_calc=''*7'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Manca il genere della persona" + NL
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=2
prev=O1032
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1031
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O1020
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1023
fatherSonIndex=0
frm_calc=''*C'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Data di scadenza del documento assente" + NL
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=2
prev=O1038
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1037
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1023
fatherSonIndex=1
frm_calc=[
'Year(_docsca) < 1900
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_datope > _docsca
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_docril > _docsca
]
h=[
19
19
]
obj='If
pag=2
prev=O1044
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1047
fatherSonIndex=0
frm_calc=''*7'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Data di scadenza del documento inferiore alla data di rilascio" + NL
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=2
prev=O1053
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1052
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O1041
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1044
fatherSonIndex=0
frm_calc=''*7'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Data di scadenza del documento inferiore alla data dell'operazione" + NL
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=2
prev=O1059
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1058
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1041
fatherSonIndex=0
frm_calc=''*6'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Data di scadenza del documento errata" + NL
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=2
prev=O1065
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1064
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
prev=O1017
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1020
fatherSonIndex=0
frm_calc=''*B'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Data di rilascio del documento assente" + NL
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=2
prev=O1072
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1071
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1020
fatherSonIndex=1
frm_calc=[
'Year(_docril) < 1900
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1075
fatherSonIndex=0
frm_calc=''*5'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Data di rilascio del documento errata" + NL
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=2
prev=O1081
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1080
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
prev=O1014
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1017
fatherSonIndex=0
frm_calc=''*A'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Data di nascita non presente" + NL
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=2
prev=O1088
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1087
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1017
fatherSonIndex=1
frm_calc=[
'Year(_nasdata) < 1900
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1091
fatherSonIndex=0
frm_calc=''*4'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Data di nascita errata" + NL
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=2
prev=O1097
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1096
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1014
fatherSonIndex=0
frm_calc=''*3'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Data operazione non valida" + NL
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=2
prev=O1104
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1103
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O747
fatherSonIndex=0
frm_calc='''
len=5
name='_mage
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_prog
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_prog))
'LRTrim(_mage) <> LRTrim(w_codmage)
]
h=[
19
19
19
]
obj='If
pag=2
prev=O1112
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1113
fatherSonIndex=0
frm_calc=''*1'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Agenzia non ancora censita" + NL
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=2
prev=O1119
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1118
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1113
fatherSonIndex=1
frm_calc=''*2'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Agenzia collegata ad un altro MacroAgente" + NL
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=2
prev=O1123
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1122
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O1111
rd_field=[
'CODDIP
'MACROAGENTE
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'_coddip
]
rd_var=[
'_prog
'_mage
]
I
obj='Var
pag=2
prev=O1110
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O182
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O184
fatherSonIndex=0
frm_calc='wuchkimp->WUCODMAGE
len=5
name='w_codmage
next=Icpitembatch.CPVarDecl
frm_calc='wuchkimp->WUTIPOPE
len=1
name='_tipoop
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(w_codmage)+"-"+LRTrim(wuchkimp->WUNOMEFILE)
len=60
name='_idfile
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(wuchkimp->WUNCODDIP))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='wuchkimp->WURIFMTCN
len=10
name='_uniquecode
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(wuchkimp->WUNDATOPE)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
dec=2
frm_calc='wuchkimp->WUIMPORTO *  100
len=10
name='_importo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(wuchkimp->WUNSTADES))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_uifdest
next=Icpitembatch.CPRead
arch='wucodes
next=Icpitembatch.CPVarDecl
frm_calc='wuchkimp->WUNOMCLI
len=25
name='_nome
next=Icpitembatch.CPVarDecl
frm_calc='wuchkimp->WUCOGCLI
len=26
name='_cognome
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(wuchkimp->WUNCITCLI))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(wuchkimp->WUNCAPCLI))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_statores
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(wuchkimp->WUNSTACLI))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='wuchkimp->WUINDCLI
len=35
name='_via
next=Icpitembatch.CPVarDecl
frm_calc='wuchkimp->WUNOMCON
len=25
name='_nomecp
next=Icpitembatch.CPVarDecl
frm_calc='wuchkimp->WUCOGCON
len=26
name='_cognomecp
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(wuchkimp->WUNSEXCLI)),wuchkimp->WUNSEXCLI,wuchkimp->WUSEXCLI)
len=1
name='_sesso
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(wuchkimp->WUNCAPCLI))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(wuchkimp->WUNBSTACLI))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(wuchkimp->WUNBCITCLI))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(wuchkimp->WUNDATNAS)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(wuchkimp->WUNRDOCCLI)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(wuchkimp->WUNTDOCCLI))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPBeginEnd
comment='Tipo Documento
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='wuchkimp->WUNDOCCLI
len=20
name='_numdoc
next=Icpitembatch.CPVarDecl
frm_calc='wuchkimp->WUADOCRIL
len=30
name='_autril
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(wuchkimp->WUNSDOCCLI)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(wuchkimp->WUNCODFIS))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O1188
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1191
fatherSonIndex=0
frm_calc='wuchkimp->WUCODFIS
len=16
name='_codfis
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1191
fatherSonIndex=1
frm_calc='wuchkimp->WUNCODFIS
len=16
name='_codfis
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
prev=O1187
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1188
fatherSonIndex=0
frm_calc='CharToDate(Right(wuchkimp->WUSDOCCLI,4)+Substr(wuchkimp->WUSDOCCLI,4,2)+Left(wuchkimp->WUSDOCCLI,2))
len=8
name='_docsca
obj='Var
obj_type='D
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1188
fatherSonIndex=1
frm_calc='wuchkimp->WUNSDOCCLI
len=8
name='_docsca
obj='Var
obj_type='D
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O1186
var_op='asgn
I
obj='Var
pag=2
prev=O1184
var_op='asgn
I
obj='Begin
pag=2
prev=O1181
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O1184
fatherSonIndex=0
frm_calc=[
'LRTrim(_tipodoc)='A'
'LRTrim(_tipodoc)='B' or LRTrim(_tipodoc)='F'
'LRTrim(_tipodoc)='C'
'LRTrim(_tipodoc)='I'
]
h=[
19
19
19
19
19
19
]
haselse=True
obj='Case
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1208
fatherSonIndex=0
frm_calc=''03'
len=2
name='_doctype
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1208
fatherSonIndex=1
frm_calc=''01'
len=2
name='_doctype
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1208
fatherSonIndex=2
frm_calc=''02'
len=2
name='_doctype
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1208
fatherSonIndex=3
frm_calc=''04'
len=2
name='_doctype
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1208
fatherSonIndex=4
frm_calc=''06'
len=2
name='_doctype
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O1178
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1181
fatherSonIndex=0
frm_calc='wuchkimp->WUTDOCCLI
len=20
name='_tipodoc
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1181
fatherSonIndex=1
frm_calc='wuchkimp->WUNTDOCCLI
len=20
name='_tipodoc
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
prev=O1175
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1178
fatherSonIndex=0
frm_calc='CharToDate(Right(wuchkimp->WURDOCCLI,4)+Substr(wuchkimp->WURDOCCLI,4,2)+Left(wuchkimp->WURDOCCLI,2))
len=8
name='_docril
obj='Var
obj_type='D
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1178
fatherSonIndex=1
frm_calc='wuchkimp->WUNRDOCCLI
len=8
name='_docril
obj='Var
obj_type='D
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
prev=O1172
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1175
fatherSonIndex=0
frm_calc='CharToDate(Right(wuchkimp->WUDATNAS,4)+Substr(wuchkimp->WUDATNAS,4,2)+Left(wuchkimp->WUDATNAS,2))
len=8
name='_nasdata
obj='Var
obj_type='D
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1175
fatherSonIndex=1
frm_calc='wuchkimp->WUNDATNAS
len=8
name='_nasdata
obj='Var
obj_type='D
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
prev=O1169
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1172
fatherSonIndex=0
frm_calc='wuchkimp->WUBCITCLI
len=30
name='_nascitta
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1172
fatherSonIndex=1
frm_calc='wuchkimp->WUNBCITCLI
len=30
name='_nascitta
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
prev=O1166
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1169
fatherSonIndex=0
frm_calc='wuchkimp->WUBSTACLI
len=30
name='_nasstato
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1169
fatherSonIndex=1
frm_calc='wuchkimp->WUNBSTACLI
len=30
name='_nasstato
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
prev=O1165
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1166
fatherSonIndex=0
frm_calc='wuchkimp->WUCAPCLI
len=5
name='_cap
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1166
fatherSonIndex=1
frm_calc='wuchkimp->WUNCAPCLI
len=5
name='_cap
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O1164
var_op='asgn
I
obj='Var
pag=2
prev=O1163
var_op='asgn
I
obj='Var
pag=2
prev=O1162
var_op='asgn
I
obj='Var
pag=2
prev=O1159
var_op='asgn
I
obj='If
pag=2
prev=O1158
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbstati
father=O1159
fatherSonIndex=0
obj='Read
pag=2
rd_field=[
'CODSTA
]
rd_kfield=[
'DESCRI
]
rd_kvar=[
'wuchkimp->WUSTACLI
]
rd_var=[
'_statores
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbstati
father=O1159
fatherSonIndex=1
obj='Read
pag=2
rd_field=[
'CODSTA
]
rd_kfield=[
'DESCRI
]
rd_kvar=[
'wuchkimp->WUNSTACLI
]
rd_var=[
'_statores
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O1155
var_op='asgn
I
obj='If
pag=2
prev=O1152
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1155
fatherSonIndex=0
frm_calc='wuchkimp->WUCAPCLI
len=5
name='_cap
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1155
fatherSonIndex=1
frm_calc='wuchkimp->WUNCAPCLI
len=5
name='_cap
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
prev=O1151
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1152
fatherSonIndex=0
frm_calc='wuchkimp->WUCITCLI
len=40
name='_citta
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1152
fatherSonIndex=1
frm_calc='wuchkimp->WUCITCLI
len=40
name='_citta
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O1150
var_op='asgn
I
obj='Var
pag=2
prev=O1149
var_op='asgn
I
obj='Read
pag=2
prev=O1148
rd_field=[
'WUCODISO
'WUCODUIF
]
rd_kfield=[
'WUCODSTA
]
rd_kvar=[
'_statodest
]
rd_var=[
'_isodest
'_uifdest
]
I
obj='Var
pag=2
prev=O1145
var_op='asgn
I
obj='If
pag=2
prev=O1144
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1145
fatherSonIndex=0
frm_calc='wuchkimp->WUSTADES
len=3
name='_statodest
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1145
fatherSonIndex=1
frm_calc='wuchkimp->WUNSTADES
len=3
name='_statodest
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O1141
var_op='asgn
I
obj='If
pag=2
prev=O1140
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1141
fatherSonIndex=0
frm_calc='CharToDate(Right(wuchkimp->WUDATOPE,4)+Substr(wuchkimp->WUDATOPE,4,2)+Left(wuchkimp->WUDATOPE,2))
len=8
name='_datope
obj='Var
obj_type='D
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1141
fatherSonIndex=1
frm_calc='wuchkimp->WUNDATOPE
len=8
name='_datope
obj='Var
obj_type='D
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O1137
var_op='asgn
I
obj='If
pag=2
prev=O1136
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1137
fatherSonIndex=0
frm_calc='wuchkimp->WUCODDIP
len=6
name='_coddip
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1137
fatherSonIndex=1
frm_calc='wuchkimp->WUNCODDIP
len=6
name='_coddip
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O1135
var_op='asgn
I
obj='Var
pag=2
prev=O1134
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O180
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
comment='Codice Fiscale
father=O182
fatherSonIndex=0
frm_calc='''
len=16
name='w_CODFISC
next=Icpitembatch.CPVarDecl
comment='Data Nascita
frm_calc='NullDate()
len=8
name='w_DATANASC
next=Icpitembatch.CPVarDecl
comment='Luogo di Nascita
frm_calc='''
len=30
name='w_NASCOMUN
next=Icpitembatch.CPVarDecl
comment='Stato di nascita
frm_calc='''
len=30
name='w_NASSTATO
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
frm_calc='''
len=26
name='w_COGNOME
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
frm_calc='''
len=70
name='w_RAGSOC
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
frm_calc='''
len=25
name='w_NOME
next=Icpitembatch.CPVarDecl
comment='Sesso
frm_calc='''
len=1
name='w_SESSO
obj='Var
pag=2
prev=O1317
var_op='asgn
I
obj='Var
pag=2
prev=O1316
var_op='asgn
I
obj='Var
pag=2
prev=O1315
var_op='asgn
I
obj='Var
pag=2
prev=O1314
var_op='asgn
I
obj='Var
pag=2
prev=O1313
var_op='asgn
I
obj='Var
pag=2
prev=O1312
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O1311
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O179
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O180
fatherSonIndex=0
frm_calc='0
len=1
name='_esito
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_tipoop
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='w_codmage
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_uniquecode
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datope
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_impstr
next=Icpitembatch.CPVarDecl
dec=2
frm_calc='0
len=10
name='_importo
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_statodest
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_isodest
next=Icpitembatch.CPVarDecl
frm_calc='''
len=26
name='_cognome
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='_nome
next=Icpitembatch.CPVarDecl
frm_calc='''
len=40
name='_citta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_cap
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_via
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_prov
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_cab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=26
name='_cognomecp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='_nomecp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_sesso
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_nascitta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_nasstato
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_nasprov
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_nasdata
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_tipodoc
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_numdoc
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_docril
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_autril
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_docsca
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_codfis
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_connes
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_doctype
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='_codana
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_codsin
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_segno
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_nocf
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_txtope
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_oldcodfis
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_oldmac
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_listerr
obj='Var
obj_type='M
pag=2
prev=O1362
var_op='asgn
I
obj='Var
pag=2
prev=O1361
var_op='asgn
I
obj='Var
pag=2
prev=O1360
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1359
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O1358
var_op='asgn
I
obj='Var
pag=2
prev=O1357
var_op='asgn
I
obj='Var
pag=2
prev=O1356
var_op='asgn
I
obj='Var
pag=2
prev=O1355
var_op='asgn
I
obj='Var
pag=2
prev=O1354
var_op='asgn
I
obj='Var
pag=2
prev=O1353
var_op='asgn
I
obj='Var
pag=2
prev=O1352
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O1351
var_op='asgn
I
obj='Var
pag=2
prev=O1350
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O1349
var_op='asgn
I
obj='Var
pag=2
prev=O1348
var_op='asgn
I
obj='Var
pag=2
prev=O1347
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O1346
var_op='asgn
I
obj='Var
pag=2
prev=O1345
var_op='asgn
I
obj='Var
pag=2
prev=O1344
var_op='asgn
I
obj='Var
pag=2
prev=O1343
var_op='asgn
I
obj='Var
pag=2
prev=O1342
var_op='asgn
I
obj='Var
pag=2
prev=O1341
var_op='asgn
I
obj='Var
pag=2
prev=O1340
var_op='asgn
I
obj='Var
pag=2
prev=O1339
var_op='asgn
I
obj='Var
pag=2
prev=O1338
var_op='asgn
I
obj='Var
pag=2
prev=O1337
var_op='asgn
I
obj='Var
pag=2
prev=O1336
var_op='asgn
I
obj='Var
pag=2
prev=O1335
var_op='asgn
I
obj='Var
pag=2
prev=O1334
var_op='asgn
I
obj='Var
pag=2
prev=O1333
var_op='asgn
I
obj='Var
pag=2
prev=O1332
var_op='asgn
I
obj='Var
pag=2
prev=O1331
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O1330
var_op='asgn
I
obj='Var
pag=2
prev=O1329
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O1328
var_op='asgn
I
obj='Var
pag=2
prev=O1327
var_op='asgn
I
obj='Var
pag=2
prev=O1326
var_op='asgn
I
obj='Var
pag=2
prev=O1325
var_op='asgn
I
obj='Var
pag=2
prev=O1324
var_op='asgn
I
obj='Var
pag=2
prev=O1323
var_op='asgn
I
obj='Var
pag=2
prev=O1322
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O178
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O161
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=2
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=2
prev=O159
I
obj='Remark
pag=2
prev=O158
I
obj='Var
obj_type='N
pag=2
prev=O157
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O156
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O155
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O154
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O153
var_op='asgn
I
obj='Remark
pag=2
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Variabili loclai
next=Icpitembatch.CPVarDecl
len=1
name='_rap
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
len=10
name='cProgRap
next=Icpitembatch.CPRemark
frm_calc='Verifica se il rapporto continuativo esiste già
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='_codrap
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_rap
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=3
prev=O1385
sel_field='*
sel_name='rapopebo
sel_where='rapopebo->RAPPORTO=_codrap
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1387
fatherSonIndex=0
frm_calc=[
'rapopebo->DATAOPE > _datope
]
h=[
19
19
]
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='rapopebo
father=O1391
fatherSonIndex=0
next=Icpitembatch.CPWrite
arch='intestbo
obj='Write
pag=3
prev=O1396
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'_codrap
]
wr_field=[
'DATAINI
]
wr_op=[
'=
]
wr_var=[
'_datope
]
I
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'_codrap
]
wr_field=[
'DATAOPE
]
wr_op=[
'=
]
wr_var=[
'_datope
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=3
prev=O1382
sel_field='*
sel_name='xapopebo
sel_where='xapopebo->RAPPORTO=_codrap
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1385
fatherSonIndex=0
frm_calc=[
'xapopebo->DATAOPE > _datope
]
h=[
19
19
]
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xapopebo
father=O1414
fatherSonIndex=0
next=Icpitembatch.CPWrite
arch='xntestbo
obj='Write
pag=3
prev=O1419
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'_codrap
]
wr_field=[
'DATAINI
]
wr_op=[
'=
]
wr_var=[
'_datope
]
I
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'_codrap
]
wr_field=[
'DATAOPE
]
wr_op=[
'=
]
wr_var=[
'_datope
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1380
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1382
fatherSonIndex=0
frm_calc=[
'_rap = 0
]
h=[
19
19
]
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1437
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRG"+LRTrim(w_codmage)+"\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProgRap
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(w_codmage)+cProgRap
len=15
name='_codrap
next=Icpitembatch.CPInsert
arch='wurapporti
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xnarapbo
next=Icpitembatch.CPInsert
arch='knarapbo
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xapopebo
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='xntestbo
obj='Insert
pag=3
prev=O1452
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'1
'_datope
''P'
'_connes
'cInfProg2
'_codrap
''0'
''0'
'DateToChar(_datope)+cInfProg2+'0'
'_connes
'nProgImp2
]
I
obj='Var
obj_type='N
pag=3
pagelocal=True
prev=O1451
var_op='asgn
I
obj='Insert
pag=3
prev=O1450
rd_kfield=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'VALUTA
]
rd_kvar=[
'DateToChar(_datope)
'_intercab
'_coddip
'_intercod
'_datope
'Date()
'_intercit
'Substr(riga,169,50)
''3'
''0'
'cInfProg1
'DateToChar(_datope)+cInfProg1+'0'
'cInfProg2
''3'
'nProgImp
'_interprv
'_codrap
''0'
''1'
'_intertip
''0'
''23'
'_uniquecode
''242'
]
I
obj='Var
obj_type='N
pag=3
prev=O1449
var_op='asgn
I
obj='Var
pag=3
pagelocal=True
prev=O1448
var_op='asgn
I
obj='Var
pag=3
pagelocal=True
prev=O1447
var_op='asgn
I
obj='Insert
pag=3
prev=O1446
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
]
rd_kvar=[
'_codrap
'LRTrim(_cognome) + " " + LRTrim(_nome)
''P'
]
I
obj='Insert
pag=3
prev=O1445
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
]
rd_kvar=[
'_codrap
'LRTrim(_cognome) + " " + LRTrim(_nome)
''0'
''E'
''242'
''99'
]
I
obj='Var
obj_type='N
pag=3
pagelocal=True
prev=O1444
var_op='asgn
I
obj='Insert
pag=3
prev=O1443
rd_kfield=[
'RWMACAGE
'RWCODRAP
'RWCODFIS
]
rd_kvar=[
'w_codmage
'cProgRap
'_connes
]
I
obj='Var
pag=3
prev=O1442
var_op='asgn
I
obj='Var
pag=3
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1382
fatherSonIndex=1
frm_calc=[
'_rap = 0
]
h=[
19
19
]
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1466
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRG"+LRTrim(w_codmage)+"\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProgRap
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(w_codmage)+cProgRap
len=15
name='_codrap
next=Icpitembatch.CPInsert
arch='wurapporti
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='anarapbo
next=Icpitembatch.CPInsert
arch='knarapbo
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='rapopebo
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='intestbo
obj='Insert
pag=3
prev=O1481
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'1
'_datope
''P'
'_connes
'cInfProg2
'_codrap
''0'
''0'
'DateToChar(_datope)+cInfProg2+'0'
'_connes
'nProgImp2
]
I
obj='Var
obj_type='N
pag=3
pagelocal=True
prev=O1480
var_op='asgn
I
obj='Insert
pag=3
prev=O1479
rd_kfield=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'VALUTA
]
rd_kvar=[
'DateToChar(_datope)
'_intercab
'_coddip
'_intercod
'_datope
'Date()
'_intercit
'Substr(riga,169,50)
''3'
''0'
'cInfProg1
'DateToChar(_datope)+cInfProg1+'0'
'cInfProg2
''3'
'nProgImp
'_interprv
'_codrap
''0'
''1'
'_intertip
''0'
''23'
'_uniquecode
''242'
]
I
obj='Var
obj_type='N
pag=3
prev=O1478
var_op='asgn
I
obj='Var
pag=3
pagelocal=True
prev=O1477
var_op='asgn
I
obj='Var
pag=3
pagelocal=True
prev=O1476
var_op='asgn
I
obj='Insert
pag=3
prev=O1475
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
]
rd_kvar=[
'_codrap
'LRTrim(_cognome) + " " + LRTrim(_nome)
''D'
]
I
obj='Insert
pag=3
prev=O1474
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
]
rd_kvar=[
'_codrap
'LRTrim(_cognome) + " " + LRTrim(_nome)
''0'
''E'
''242'
''99'
]
I
obj='Var
obj_type='N
pag=3
pagelocal=True
prev=O1473
var_op='asgn
I
obj='Insert
pag=3
prev=O1472
rd_kfield=[
'RWMACAGE
'RWCODRAP
'RWCODFIS
]
rd_kvar=[
'w_codmage
'cProgRap
'_connes
]
I
obj='Var
pag=3
prev=O1471
var_op='asgn
I
obj='Var
pag=3
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=3
prev=O1379
sel_field='*
sel_name='wurapporti
sel_where='wurapporti->RWCODFIS=_connes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1380
fatherSonIndex=0
frm_calc='1
len=1
name='_rap
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(wurapporti->RWMACAGE)+wurapporti->RWCODRAP
len=15
name='_codrap
obj='Var
pag=3
prev=O1497
var_op='asgn
I
obj='Var
obj_type='N
pag=3
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
pagelocal=True
prev=O1378
var_op='asgn
I
obj='Var
pag=3
prev=O1377
var_op='asgn
I
obj='Remark
pag=3
prev=O1376
I
obj='Var
pag=3
pagelocal=True
prev=O1375
I
obj='Var
pag=3
pagelocal=True
prev=O1374
I
obj='Var
pag=3
pagelocal=True
prev=O1373
I
obj='Var
obj_type='N
pag=3
pagelocal=True
prev=O1372
I
obj='Var
obj_type='N
pag=3
pagelocal=True
prev=O1371
I
obj='Var
obj_type='N
pag=3
pagelocal=True
prev=O1370
I
obj='Remark
pag=3
x=17
y=21
I
]
ManualBlocks={
'BO - Properties
Icpmanualblocks.CPManualBlocks
code='public String[] lista;﷯public int conteggio;﷯public int i;﷯public int contanome;
name='BO - Properties
I
}
comment='Importa i dati (TIPO AC - Correzione errori)
date_creat=#2006-06-20
date_rev=#2019-10-17
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'Utilities
'LibreriaMit
]
merge=True
modcnt=687
page_result_class=[
'
'
'
]
page_result_type=[
'U
'U
'U
]
page_uid=[
'RMWVIFOICH
'YNMJFTDDFE
'RUANTKPKYT
]
pagename=[
'Page_1
'Page_2
'Page_3
]
pagenote=[
'
'
'
]
pagetitle=[
'Main
'Elabora il file AC
'Crea Rapporti
]
runtime_filters=2
tpl_name='Routine
work_file=[
'aeoprig
'anadip
'anarapbo
'docfrabo
'docopebo
'fraziobo
'intermbo
'intestbo
'kersonbo
'knarapbo
'mtimperr
'mtstati
'operazbo
'opextrbo
'personbo
'rapopebo
'tbcauana
'tbcitta
'tbmacage
'tbstati
'tmp_impwu
'wersonbo
'wuchkimp
'wucodes
'wurapporti
'xapopebo
'xnarapbo
'xntestbo
'xocfrabo
'xocopebo
'xperazbo
'xraziobo
]
work_filter=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
I
*--*
*----*
