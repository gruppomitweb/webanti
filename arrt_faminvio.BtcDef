* --- CodePainter Revolution Batch Vers. 5.1
￼Icpbatch.CPBatch
Items=[
Icpitembatch.CPBeginEnd
comment='Variabili del caller
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili globali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili per la creazione dei file
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Verifica se deve lanciare il SID
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc=''Ora Inizio Elaborazione: '+ arfn_fdatetime(DateTime()) + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPBeginEnd
comment='Crea il file per l'elenco
h=[
19
19
]
next=Ispitembatch.CPClearCache
cache_name='chOpex
next=Icpitembatch.CPExec
check='page
frm_calc='7
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Fine Elaborazione: '+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=1
prev=O19
var_op='asgn
I
obj='Try
pag=1
prev=O18
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O19
fatherSonIndex=0
frm_calc='0
len=9
name='_tipo1
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo2
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo3
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo4
next=Icpitembatch.CPVarDecl
frm_calc='Str(w_anno,4,0)
len=4
name='w_annoc
next=Icpitembatch.CPVarDecl
frm_calc='w_dadata
len=8
name='_dataini
next=Icpitembatch.CPVarDecl
frm_calc='w_a_data
len=8
name='_datafin
next=Icpitembatch.CPVarDecl
frm_calc='w_mese
len=2
name='_mese
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgnew='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgagg='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgdel='S'
]
h=[
19
19
]
next=Icpitembatch.CPTransaction
frm_calc='commit
next=Icpitembatch.CPIfElse
frm_calc=[
'_nosid=1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Premere il tasto con la nuvola per prelevare i file'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=1
prev=O42
var_op='asgn
I
obj='If
pag=1
prev=O41
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Crea lo zip con i filein chiaro se non c'è il SID
father=O42
fatherSonIndex=0
h=[
19
19
]
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O48
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathDoc)+'/flussi/'+LRTrim(gAzienda)+"/File_SID_"+w_annoc+_mese+".zip"
len=100
name='cNomeFileZip
next=Icpitembatch.CPExec
check='page
frm_calc='8
next=Icpitembatch.CPInsert
arch='tmp_listafile
obj='Insert
pag=1
prev=O55
rd_kfield=[
'nomefile
]
rd_kvar=[
'"File_SID_"+w_annoc+_mese+".zip"
]
I
obj='Exec
pag=1
prev=O54
I
obj='Var
pag=1
prev=O52
var_op='asgn
I
obj='Select
pag=1
sel_field='*
sel_name='tmp_list_imprich
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O52
fatherSonIndex=0
frm_calc='LRTrim(gPathDoc)+'/SID/INVII/DAP/'+LRTrim(gAzienda)+"/"+LRTrim(tmp_list_imprich->hyperlynk)
len=100
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(tmp_list_imprich->hyperlynk)
len=100
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc='// Aggiunge i file nei vettori﷯filenames.add(CPLib.LRTrim(cNomeFile));﷯fileonames.add(CPLib.LRTrim(cOnlyNomeFile));
obj='Exec
pag=1
prev=O62
I
obj='Var
pag=1
prev=O61
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Transaction
pag=1
prev=O38
I
obj='If
pag=1
prev=O35
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O38
fatherSonIndex=0
frm_calc='0
len=9
name='_tipo1
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo2
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo3
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo4
next=Icpitembatch.CPBeginEnd
comment='Azzera i cursori
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_nosid=0
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='page
frm_calc='6
obj='Exec
pag=1
prev=O75
I
obj='If
pag=1
prev=O73
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O75
fatherSonIndex=0
frm_calc='7
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O72
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O73
fatherSonIndex=0
frm_seek='Zap
name='mcSID0
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID1
obj='Var
obj_type='MC
pag=1
prev=O85
var_op='meth
I
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O71
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O70
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O69
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O35
fatherSonIndex=0
frm_calc='0
len=9
name='_tipo1
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo2
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo3
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo4
next=Icpitembatch.CPBeginEnd
comment='Azzera i cursori
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_nosid=0
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='page
frm_calc='3
obj='Exec
pag=1
prev=O97
I
obj='If
pag=1
prev=O95
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O97
fatherSonIndex=0
frm_calc='7
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O94
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O95
fatherSonIndex=0
frm_seek='Zap
name='mcSID0
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID1
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID2
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID3
obj='Var
obj_type='MC
pag=1
prev=O109
var_op='meth
I
obj='Var
obj_type='MC
pag=1
prev=O108
var_op='meth
I
obj='Var
obj_type='MC
pag=1
prev=O107
var_op='meth
I
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O93
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O92
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O91
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O31
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Azzera i cursori
father=O32
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Inizio Elaborazione Nuovi Rapporti: '+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'_nosid=0
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='page
frm_calc='2
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Fine Elaborazione Nuovi Rapporti: '+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo1
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo2
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo3
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo4
next=Icpitembatch.CPIfElse
frm_calc=[
'_nosid=0
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='page
frm_calc='5
obj='Exec
pag=1
prev=O127
I
obj='If
pag=1
prev=O126
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O127
fatherSonIndex=0
frm_calc='7
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O125
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O124
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O123
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O122
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
prev=O121
var_op='asgn
I
obj='Exec
pag=1
prev=O118
I
obj='If
pag=1
prev=O117
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O118
fatherSonIndex=0
frm_calc='7
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=1
prev=O115
var_op='asgn
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O115
fatherSonIndex=0
frm_seek='Zap
name='mcSID0
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID1
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID2
obj='Var
obj_type='MC
pag=1
prev=O142
var_op='meth
I
obj='Var
obj_type='MC
pag=1
prev=O141
var_op='meth
I
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O30
var_op='asgn
I
obj='Var
obj_type='D
pag=1
prev=O29
var_op='asgn
I
obj='Var
obj_type='D
pag=1
prev=O28
var_op='asgn
I
obj='Var
pag=1
prev=O27
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O26
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O25
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O24
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O19
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPTransaction
frm_calc='rollback
next=Icpitembatch.CPBeginEnd
comment='Cancella eventuali altri file creati
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Elaborazione Terminata con errori. Consultare l'assistenza"
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=1
prev=O150
var_op='asgn
I
obj='Begin
pag=1
prev=O149
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O150
fatherSonIndex=0
frm_calc='// Legge i file degli esiti﷯File di = new File(CPLib.LRTrim(gPathDoc)+"/SID/INVII/DAP/"+CPLib.LRTrim(gAzienda)+"/");﷯File fl[] = di.listFiles();﷯int _i;﷯int count=0;﷯for (_i=0; _i < fl.length; _i++)  {﷯  fl[_i].delete();﷯}﷯di = new File(CPLib.LRTrim(gPathDoc)+"/SID/INVII/PRE/"+CPLib.LRTrim(gAzienda)+"/");﷯File fl1[] = di.listFiles();﷯count=0;﷯for (_i=0; _i < fl1.length; _i++)  {﷯  fl1[_i].delete();﷯}
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Transaction
pag=1
prev=O147
I
obj='Select
pag=1
sel_name='tmp_listafile
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O147
fatherSonIndex=0
frm_calc='LRTrim(gPathDoc)+'/flussi/'+LRTrim(gAzienda)+"/"+LRTrim(tmp_listafile->nomefile)+".zip"
len=100
name='cNomeFile
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(cNomeFile)
obj='Exec
pag=1
prev=O159
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=1
prev=O17
I
obj='Exec
pag=1
prev=O16
I
obj='ClearCache
pag=1
prev=O14
type_action='CREATE
I
obj='Begin
pag=1
prev=O13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDropTemporaryTable
father=O14
fatherSonIndex=0
next=Icpitembatch.CPDropTemporaryTable
next=Icpitembatch.CPServerTemporaryTable
next=Icpitembatch.CPServerTemporaryTable
obj='TempTable
pag=1
prev=O167
sel_type='def
server_table='tmp_list_imprich
I
obj='TempTable
pag=1
prev=O166
sel_type='def
server_table='tmp_listafile
I
obj='DropTempTable
pag=1
prev=O165
server_table='tmp_list_imprich
I
obj='DropTempTable
pag=1
server_table='tmp_listafile
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=1
prev=O11
var_op='asgn
I
obj='Begin
pag=1
prev=O9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O11
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=1
sel_field='*
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O172
fatherSonIndex=0
frm_calc='intermbo->FLGSIDAUTO
len=1
name='_nosid
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9
fatherSonIndex=0
len=10
name='fhand
next=Icpitembatch.CPVarDecl
len=10
name='_nomefile
next=Icpitembatch.CPVarDecl
len=100
name='cNomeFile
next=Icpitembatch.CPVarDecl
len=100
name='cOnlyNomeFile
next=Icpitembatch.CPVarDecl
len=100
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
len=2
name='_mese
next=Icpitembatch.CPVarDecl
len=398
name='_riga
next=Icpitembatch.CPVarDecl
len=9
name='_tipo1
next=Icpitembatch.CPVarDecl
len=9
name='_tipo2
next=Icpitembatch.CPVarDecl
len=9
name='_tipo3
next=Icpitembatch.CPVarDecl
len=9
name='_tipo4
next=Icpitembatch.CPVarDecl
len=100
name='_oldmsg
next=Icpitembatch.CPVarDecl
len=16
name='_cfinter
next=Icpitembatch.CPVarDecl
len=16
name='_intercod
next=Icpitembatch.CPVarDecl
len=5
name='_intercab
next=Icpitembatch.CPVarDecl
len=30
name='_file1
next=Icpitembatch.CPVarDecl
len=30
name='_file2
obj='Var
pag=1
prev=O196
I
obj='Var
pag=1
prev=O195
I
obj='Var
pag=1
prev=O194
I
obj='Var
pag=1
prev=O193
I
obj='Var
pag=1
prev=O192
I
obj='Var
pag=1
prev=O191
I
obj='Var
obj_type='N
pag=1
prev=O190
I
obj='Var
obj_type='N
pag=1
prev=O189
I
obj='Var
obj_type='N
pag=1
prev=O188
I
obj='Var
obj_type='N
pag=1
prev=O187
I
obj='Var
pag=1
prev=O186
I
obj='Var
pag=1
prev=O185
I
obj='Var
pag=1
prev=O184
I
obj='Var
pag=1
prev=O183
I
obj='Var
pag=1
prev=O182
I
obj='Var
pag=1
prev=O181
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7
fatherSonIndex=0
len=10
name='_conta
next=Icpitembatch.CPVarDecl
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_seek='tmp_stpperiodo
name='mcTemp
next=Icpitembatch.CPVarDecl
frm_seek='tmp_stpperiodo
name='rowTemp
next=Icpitembatch.CPVarDecl
frm_seek='sid_invio
name='mcSID0
next=Icpitembatch.CPVarDecl
frm_seek='sid_invio
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_seek='sid_invio1
name='mcSID1
next=Icpitembatch.CPVarDecl
frm_seek='sid_invio1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_seek='sid_invio2
name='mcSID2
next=Icpitembatch.CPVarDecl
frm_seek='sid_invio2
name='rowSID2
next=Icpitembatch.CPVarDecl
frm_seek='sid_invio2
name='mcSID2r
next=Icpitembatch.CPVarDecl
frm_seek='sid_invio3
name='mcSID3
next=Icpitembatch.CPVarDecl
frm_seek='sid_invio3
name='rowSID3
next=Icpitembatch.CPVarDecl
frm_seek='sid_invio3
name='mcSID3r
next=Icpitembatch.CPVarDecl
frm_seek='sid_invio4
name='mcSID4
next=Icpitembatch.CPVarDecl
frm_seek='sid_invio4
name='rowSID4
next=Icpitembatch.CPVarDecl
len=1
name='_crea
next=Icpitembatch.CPVarDecl
len=8
name='_dataini
next=Icpitembatch.CPVarDecl
len=8
name='_datafin
next=Icpitembatch.CPVarDecl
len=8
name='_datamin
next=Icpitembatch.CPVarDecl
len=8
name='_datamax
next=Icpitembatch.CPVarDecl
len=10
name='_invio
next=Icpitembatch.CPVarDecl
comment='Errori del sid
frm_seek='mcMessaggi.MCRDef
name='_sid
next=Icpitembatch.CPVarDecl
len=15
name='_max
next=Icpitembatch.CPVarDecl
len=15
name='_min
next=Icpitembatch.CPVarDecl
len=15
name='_tot
next=Icpitembatch.CPVarDecl
len=1
name='_mono
next=Icpitembatch.CPVarDecl
len=15
name='_contacicli
next=Icpitembatch.CPVarDecl
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
len=15
name='_top
next=Icpitembatch.CPVarDecl
len=15
name='_cicli
next=Icpitembatch.CPVarDecl
len=10
name='_totrecord
next=Icpitembatch.CPVarDecl
name='_reccount
next=Icpitembatch.CPVarDecl
len=50
name='_unique
next=Icpitembatch.CPVarDecl
len=1
name='_newuc
next=Icpitembatch.CPVarDecl
len=4
name='w_annoc
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
len=10
name='cProg
next=Icpitembatch.CPVarDecl
len=4
name='_asaldi
next=Icpitembatch.CPVarDecl
len=5
name='_cabinter
next=Icpitembatch.CPVarDecl
len=1
name='_tipinvio
next=Icpitembatch.CPVarDecl
name='chOpex
next=Icpitembatch.CPVarDecl
len=10
name='_contarighe
next=Icpitembatch.CPVarDecl
len=1
name='_numfile
next=Icpitembatch.CPVarDecl
len=10
name='_contarec
next=Icpitembatch.CPVarDecl
len=1
name='_tipinvioc
next=Icpitembatch.CPVarDecl
len=1
name='_nosid
next=Icpitembatch.CPVarDecl
len=3
name='_ison
obj='Var
pag=1
prev=O247
I
obj='Var
obj_type='N
pag=1
prev=O246
I
obj='Var
pag=1
prev=O245
I
obj='Var
obj_type='N
pag=1
prev=O244
I
obj='Var
obj_type='N
pag=1
prev=O243
I
obj='Var
obj_type='N
pag=1
prev=O242
I
obj='Var
pag=1
prev=O241
I
obj='Var
pag=1
prev=O240
I
obj='Var
pag=1
prev=O239
I
obj='Var
obj_type='N
pag=1
prev=O238
I
obj='Var
pag=1
prev=O237
I
obj='Var
obj_type='N
pag=1
prev=O236
I
obj='Var
pag=1
prev=O235
I
obj='Var
pag=1
prev=O234
I
obj='Var
pag=1
prev=O233
I
obj='Var
obj_type='N
pag=1
prev=O232
I
obj='Var
obj_type='N
pag=1
prev=O231
I
obj='Var
obj_type='N
pag=1
prev=O230
I
obj='Var
obj_type='N
pag=1
prev=O229
I
obj='Var
obj_type='N
pag=1
prev=O228
I
obj='Var
obj_type='N
pag=1
prev=O227
I
obj='Var
obj_type='N
pag=1
prev=O226
I
obj='Var
obj_type='N
pag=1
prev=O225
I
obj='Var
obj_type='N
pag=1
prev=O224
I
obj='Var
obj_type='N
pag=1
prev=O223
I
obj='Var
obj_type='MC
pag=1
prev=O222
I
obj='Var
pag=1
prev=O221
I
obj='Var
obj_type='D
pag=1
prev=O220
I
obj='Var
obj_type='D
pag=1
prev=O219
I
obj='Var
obj_type='D
pag=1
prev=O218
I
obj='Var
obj_type='D
pag=1
prev=O217
I
obj='Var
obj_type='N
pag=1
prev=O216
I
obj='Var
obj_type='R
pag=1
prev=O215
I
obj='Var
obj_type='MC
pag=1
prev=O214
I
obj='Var
obj_type='MC
pag=1
prev=O213
I
obj='Var
obj_type='R
pag=1
prev=O212
I
obj='Var
obj_type='MC
pag=1
prev=O211
I
obj='Var
obj_type='MC
pag=1
prev=O210
I
obj='Var
obj_type='R
pag=1
prev=O209
I
obj='Var
obj_type='MC
pag=1
prev=O208
I
obj='Var
obj_type='R
pag=1
prev=O207
I
obj='Var
obj_type='MC
pag=1
prev=O206
I
obj='Var
obj_type='R
pag=1
prev=O205
I
obj='Var
obj_type='MC
pag=1
prev=O204
I
obj='Var
obj_type='R
pag=1
prev=O203
I
obj='Var
obj_type='MC
pag=1
prev=O202
I
obj='Var
obj_type='M
pag=1
prev=O201
I
obj='Var
obj_type='N
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Azienda
father=O5
fatherSonIndex=0
global=True
len=10
name='gAzienda
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='Messaggio
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Intermediario
global=True
len=11
name='gIntemediario
next=Icpitembatch.CPVarDecl
comment='Path Applicazione
global=True
len=80
name='gPathApp
next=Icpitembatch.CPVarDecl
comment='Path Applicazione
global=True
len=80
name='gPathDoc
next=Icpitembatch.CPVarDecl
comment='Scadenza Invio Saldi
global=True
len=8
name='gScadSaldi
nonlocal=True
obj='Var
obj_type='D
pag=1
prev=O257
I
nonlocal=True
obj='Var
pag=1
prev=O256
I
nonlocal=True
obj='Var
pag=1
prev=O255
I
nonlocal=True
obj='Var
pag=1
prev=O254
I
nonlocal=True
obj='Var
pag=1
prev=O253
I
nonlocal=True
obj='Var
pag=1
prev=O252
I
nonlocal=True
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Anno RIferimento
father=O3
fatherSonIndex=0
len=4
name='w_anno
next=Icpitembatch.CPVarDecl
comment='Mese Riferimento
len=2
name='w_mese
next=Icpitembatch.CPVarDecl
comment='Data Inizio Periodo
len=8
name='w_dadata
next=Icpitembatch.CPVarDecl
comment='Data Fine Periodo
len=8
name='w_a_data
next=Icpitembatch.CPVarDecl
comment='Aggiornamenti/Rettifiche
len=1
name='w_flgagg
next=Icpitembatch.CPVarDecl
comment='Annullamento/Cancellazione
len=1
name='w_flgdel
next=Icpitembatch.CPVarDecl
comment='Nuovi Rapporti/Chiusure
len=1
name='w_flgnew
next=Icpitembatch.CPVarDecl
comment='Registrazione record per file stampa
len=1
name='w_flgstp
next=Icpitembatch.CPVarDecl
comment='Dettaglio su chiusure
len=1
name='w_flgdett
next=Icpitembatch.CPVarDecl
comment='Chiusura straordinaria
len=1
name='w_flagchiu
obj='Var
pag=1
param=True
prev=O270
I
obj='Var
pag=1
param=True
prev=O269
I
obj='Var
pag=1
param=True
prev=O268
I
obj='Var
pag=1
param=True
prev=O267
I
obj='Var
pag=1
param=True
prev=O266
I
obj='Var
pag=1
param=True
prev=O265
I
obj='Var
obj_type='D
pag=1
param=True
prev=O264
I
obj='Var
obj_type='D
pag=1
param=True
prev=O263
I
obj='Var
pag=1
param=True
prev=O262
I
obj='Var
obj_type='N
pag=1
param=True
I
I
]
w=[
150
150
]
x=17
y=26
I
Icpitembatch.CPBeginEnd
comment='Legge i dati e effettua le verifiche
h=[
19
19
]
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O273
fatherSonIndex=0
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Inizio Elaborazione periodo '+w_annoc+"-"+_mese+" : "+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPBeginEnd
comment='Ordinario - Nuovi Rapporti (1-1)
h=[
19
19
]
obj='Begin
pag=2
prev=O278
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O279
fatherSonIndex=0
frm_calc='"Attendere. Estrazione dati per il periodo ..."
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_totrecord
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_totrecord > 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Fine Elaborazione periodo '+w_annoc+'-'+_mese+" : "+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=2
prev=O287
var_op='asgn
I
obj='If
pag=2
prev=O285
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Azzera i cursori
father=O287
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Apre il file di scrittura
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Crea Testata
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Rapporti Continuativi
h=[
19
19
]
next=Icpitembatch.CPExec
check='page
frm_calc='4
next=Icpitembatch.CPBeginEnd
comment='Crea Piede
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='aesaldi
next=Icpitembatch.CPIfElse
frm_calc=[
'_nosid=0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_sid.IsEmpty()
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Sono stati generati '+LRTrim(Str(_conta,10,0))+" record" +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Fine controllo periodo: '+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=2
prev=O311
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O308
var_op='asgn
I
obj='If
pag=2
prev=O305
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Azzera se avevo scritto qualcosa
father=O308
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Inizio Aggiornamento Dati: '+arfn_fdatetime(DateTime())+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_oldmsg
next=Icpitembatch.CPForEach
for_variable='rowSID1
for_variable_type='sid_invio1
h=[
19
19
]
iterator_expr='mcSID1
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgstp='N'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + NL + 'Ora Fine Aggiornamento Dati: '+arfn_fdatetime(DateTime())+NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O322
var_op='asgn
I
obj='If
pag=2
prev=O320
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O322
fatherSonIndex=0
for_variable='rowSID2
for_variable_type='sid_invio2
h=[
19
19
]
iterator_expr='mcSID2
next=Icpitembatch.CPIfElse
frm_calc=[
'_tipinvio='2'
]
h=[
19
19
]
obj='If
pag=2
prev=O328
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O330
fatherSonIndex=0
for_variable='rowSID3
for_variable_type='sid_invio3
h=[
19
19
]
iterator_expr='mcSID3
obj='ForEach
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sid_invio3
father=O335
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'CODINVIO3
'RAPINVIO3
'TPRINVIO3
'ANNINVIO3
'VALINVIO3
'IM1INVIO3
'FI1INVIO3
'IM2INVIO3
'FI2INVIO3
'IM3INVIO3
'FI3INVIO3
'IM4INVIO3
'FI4INVIO3
'IM5INVIO3
'FI5INVIO3
'IM6INVIO3
'FI6INVIO3
'UNIQUE3
'FLGUNQ3
]
rd_kvar=[
'rowSID3.CODINVIO3
'rowSID3.RAPINVIO3
'rowSID3.TPRINVIO3
'rowSID3.ANNINVIO3
'rowSID3.VALINVIO3
'rowSID3.IM1INVIO3
'rowSID3.FI1INVIO3
'rowSID3.IM2INVIO3
'rowSID3.FI2INVIO3
'rowSID3.IM3INVIO3
'rowSID3.FI3INVIO3
'rowSID3.IM4INVIO3
'rowSID3.FI4INVIO3
'rowSID3.IM5INVIO3
'rowSID3.FI5INVIO3
'rowSID3.IM6INVIO3
'rowSID3.FI6INVIO3
'rowSID3.UNIQUE3
'rowSID3.FLGUNQ3
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sid_invio2
father=O328
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'CODINVIO2
'RAPINVIO2
'APRINVIO2
'INIINVIO2
'FININVIO2
'FCFINVIO2
'CFSINVIO2
'RUOINVIO2
'COGINVIO2
'NOMINVIO2
'SEXINVIO2
'DNSINVIO2
'CNSINVIO2
'PNSINVIO2
'RGSINVIO2
'CSLINVIO2
'PLSINVIO2
]
rd_kvar=[
'rowSID2.CODINVIO2
'rowSID2.RAPINVIO2
'rowSID2.APRINVIO2
'rowSID2.INIINVIO2
'rowSID2.FININVIO2
'rowSID2.FCFINVIO2
'rowSID2.CFSINVIO2
'rowSID2.RUOINVIO2
'rowSID2.COGINVIO2
'rowSID2.NOMINVIO2
'rowSID2.SEXINVIO2
'rowSID2.DNSINVIO2
'rowSID2.CNSINVIO2
'rowSID2.PNSINVIO2
'rowSID2.RGSINVIO2
'rowSID2.CSLINVIO2
'rowSID2.PLSINVIO2
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=2
prev=O319
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O320
fatherSonIndex=0
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Sto aggiornando l'operazione " + LRTrim(Str(_conta,10,0)) + " su " + LRTrim(Str(_totrecord,10,0))
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_oldmsg)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='"Sto aggiornando l'operazione " + LRTrim(Str(_conta,10,0)) + " su " + LRTrim(Str(_totrecord,10,0))
len=10
name='_oldmsg
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgstp='N'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'rowSID1.TPRINVIO1='98'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Ho aggiornato l'operazione " + LRTrim(Str(_conta,10,0)) + " su " + LRTrim(Str(_totrecord,10,0))
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_oldmsg)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gMsgImp)
len=10
name='_oldmsg
obj='Var
obj_type='M
pag=2
prev=O366
var_op='asgn
I
obj='If
pag=2
prev=O365
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O366
fatherSonIndex=0
frm_calc='gMsgProc + LRTrim(gMsgImp)
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O366
fatherSonIndex=1
frm_calc='Strtran(gMsgProc,LRTrim(_oldmsg),LRTrim(gMsgImp))
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
pag=2
prev=O362
var_op='asgn
I
obj='If
pag=2
prev=O359
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O362
fatherSonIndex=0
frm_calc='"Sto aggiornando l'operazione con codice: "+rowSID1.RAPINVIO1
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='opextrbo
obj='Write
pag=2
prev=O378
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'INVIATO
'DATAINVIO
'UNIQUER
]
wr_op=[
'=
'=
'=
]
wr_var=[
'1
'Date()
'rowSID1.UNIQUE1
]
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O362
fatherSonIndex=1
frm_calc='"Sto aggiornando il rapporto: "+rowSID1.RAPINVIO1
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='aetesta
next=Icpitembatch.CPIfElse
frm_calc=[
'_tipinvio='2' and not(Empty(rowSID1.FININVIO1))
]
h=[
19
19
]
obj='If
pag=2
prev=O388
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aetesta
father=O389
fatherSonIndex=0
obj='Write
pag=2
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'INVIATOC
'DATAINVIOC
]
wr_op=[
'=
'=
]
wr_var=[
'1
'Date()
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=2
prev=O387
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'INVIATO
'DATAINVIO
'UNIQUER
'UNIQUECODE
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'1
'Date()
'rowSID1.UNIQUE1
'rowSID1.UNIQUE1
]
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
prev=O358
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sid_invio1
father=O359
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'CODINVIO1
'RAPINVIO1
'TPRINVIO1
'INIINVIO1
'FININVIO1
'TIPINVIO1
'TPCINVIO1
]
rd_kvar=[
'rowSID1.CODINVIO1
'rowSID1.RAPINVIO1
'rowSID1.TPRINVIO1
'rowSID1.INIINVIO1
'rowSID1.FININVIO1
'rowSID1.TIPINVIO1
'rowSID1.TPCINVIO1
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
prev=O355
var_op='asgn
I
obj='If
pag=2
prev=O354
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O355
fatherSonIndex=0
frm_calc='gMsgProc + LRTrim(gMsgImp)
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O355
fatherSonIndex=1
frm_calc='Strtran(gMsgProc,LRTrim(_oldmsg),LRTrim(gMsgImp))
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
pag=2
prev=O353
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
prev=O318
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O317
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O315
var_op='asgn
I
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O315
fatherSonIndex=0
frm_calc=[
'_tipinvio='2'
]
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='sid_invio2
next=Icpitembatch.CPDelete
arch='sid_invio1
obj='Delete
pag=2
prev=O427
rd_kfield=[
'CODINVIO1
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='Delete
pag=2
prev=O424
rd_kfield=[
'CODINVIO2
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='sid_invio3
father=O424
fatherSonIndex=0
obj='Delete
pag=2
rd_kfield=[
'CODINVIO3
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O304
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O305
fatherSonIndex=0
frm_calc='arfn_exec_sid(_nomefile,w_annoc)
name='_sid
next=Icpitembatch.CPIfElse
frm_calc=[
'_sid.RecCount() > 0
]
h=[
19
19
]
obj='If
pag=2
prev=O446
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O447
fatherSonIndex=0
for_variable='rowErrore
for_variable_type='mcMessaggi.MCRDef
h=[
19
19
]
iterator_expr='_sid
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''Rilevati errori durante il controllo da parte del SID - Nuovi'
obj='Transaction
pag=2
prev=O452
raise_on_trans_err=True
I
obj='ForEach
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O452
fatherSonIndex=0
frm_calc='gMsgProc + LRTrim(rowErrore.testata) + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=2
prev=O302
rd_kfield=[
'IDBASE
'NOMEFILE
'ANNO
'MESE
'TIPOINVIO
'TIPOCOMU
'CODINVIO
]
rd_kvar=[
'LibreriaMit.UniqueId()
'Left(_nomefile,50)
'w_annoc
'_mese
''1'
''1'
'_invio
]
I
obj='Begin
pag=2
prev=O301
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Scrive Ultima riga
father=O302
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
obj='Exec
pag=2
prev=O465
I
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O465
fatherSonIndex=0
frm_calc=''9'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo1,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo2,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo3,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo4,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + Space(360)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=2
prev=O476
I
obj='Var
pag=2
prev=O475
var_op='asgn
I
obj='Var
pag=2
prev=O474
var_op='asgn
I
obj='Var
pag=2
prev=O473
var_op='asgn
I
obj='Var
pag=2
prev=O472
var_op='asgn
I
obj='Var
pag=2
prev=O471
var_op='asgn
I
obj='Var
pag=2
prev=O470
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=2
prev=O299
I
obj='Begin
pag=2
prev=O297
sons=[
Icpitembatch.CPItemSon
instr=Ispitembatch.CPMemoryCursor
data_source='tmp_stpperiodo
expected_rows=100000
father=O299
fatherSonIndex=0
mem_curs_name='mcTemp
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTemp.RecCount() > 0
]
h=[
19
19
]
obj='If
pag=2
prev=O482
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O483
fatherSonIndex=0
for_variable='rowTemp
for_variable_type='tmp_stpperiodo
h=[
19
19
]
iterator_expr='mcTemp
obj='ForEach
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Record Tipo 1
father=O488
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fam_mesefile02(rowSID1,_dataini,_datafin,rowTemp.TIPO)
name='mcSID2r
next=Icpitembatch.CPForEach
for_variable='rowSID2
for_variable_type='sid_invio2
h=[
19
19
]
iterator_expr='mcSID2r
next=Icpitembatch.CPIfElse
frm_calc=[
'_tipinvio='2'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGAGESID\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProg
next=Icpitembatch.CPInsert
arch='aefaminvio
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati generati '+LRTrim(Str(_conta,10,0))+" record"
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=2
prev=O502
var_op='asgn
I
obj='Insert
pag=2
prev=O501
rd_kfield=[
'IDBASE
'TIPO
'TIPOINVIO
'ANNO
'MESE
'TIPOCOM
'RAPPORTO
'NOMEFILE
'PROG
'IDIDBASE
]
rd_kvar=[
'cProg
'rowTemp.TIPO
''2'
'w_annoc
'_mese
''1'
'rowTemp.RAPPORTO
'_nomefile
'_conta
'_invio
]
I
obj='Var
pag=2
prev=O500
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O497
var_op='asgn
I
obj='If
pag=2
prev=O495
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O497
fatherSonIndex=0
frm_calc=[
'At(rowTemp.TIPOAG,"08;11;13;16;17;18;19;20;21;22;97,99") = 0
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O508
fatherSonIndex=0
frm_calc=[
'(Year(Date()) -Year(rowTemp.DATAINI)=1 and Date() <= gScadSaldi) or (Year(Date()) -Year(rowTemp.DATAINI)=0)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fam_mesefile03(rowSID1,_asaldi,rowTemp.TIPO,rowTemp.VALUTA)
name='mcSID3r
next=Icpitembatch.CPForEach
for_variable='rowSID3
for_variable_type='sid_invio3
h=[
19
19
]
iterator_expr='mcSID3r
obj='ForEach
pag=2
prev=O516
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O517
fatherSonIndex=0
frm_calc='rowSID3
frm_seek='AppendRow
name='mcSID3
next=Icpitembatch.CPVarDecl
frm_calc='_tipo3 + 1
len=9
name='_tipo3
next=Icpitembatch.CPVarDecl
frm_calc=''3'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + rowTemp.TIPOAG
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.ANNINVIO3,4,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM1INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM1INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM1INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI1INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM2INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM2INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM2INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI2INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM3INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM3INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM3INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI3INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM4INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM4INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM4INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI4INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM5INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM5INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM5INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI5INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM6INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM6INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM6INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI6INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + rowTemp.VALUTA
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(229)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=2
prev=O541
I
obj='Var
pag=2
prev=O540
var_op='asgn
I
obj='Var
pag=2
prev=O539
var_op='asgn
I
obj='Var
pag=2
prev=O538
var_op='asgn
I
obj='Var
pag=2
prev=O537
var_op='asgn
I
obj='Var
pag=2
prev=O536
var_op='asgn
I
obj='Var
pag=2
prev=O535
var_op='asgn
I
obj='Var
pag=2
prev=O534
var_op='asgn
I
obj='Var
pag=2
prev=O533
var_op='asgn
I
obj='Var
pag=2
prev=O532
var_op='asgn
I
obj='Var
pag=2
prev=O531
var_op='asgn
I
obj='Var
pag=2
prev=O530
var_op='asgn
I
obj='Var
pag=2
prev=O529
var_op='asgn
I
obj='Var
pag=2
prev=O528
var_op='asgn
I
obj='Var
pag=2
prev=O527
var_op='asgn
I
obj='Var
pag=2
prev=O526
var_op='asgn
I
obj='Var
pag=2
prev=O525
var_op='asgn
I
obj='Var
pag=2
prev=O524
var_op='asgn
I
obj='Var
pag=2
prev=O523
var_op='asgn
I
obj='Var
pag=2
prev=O522
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O521
var_op='asgn
I
obj='Var
obj_type='MC
pag=2
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=2
prev=O513
var_op='asgn
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O513
fatherSonIndex=0
frm_calc='0
len=4
name='_asaldi
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O513
fatherSonIndex=1
frm_calc='Year(rowTemp.DATAINI)
len=4
name='_asaldi
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=2
prev=O494
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O495
fatherSonIndex=0
frm_calc=[
'w_flgstp='N'
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Scrive la riga
h=[
19
19
]
obj='Begin
pag=2
prev=O554
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O557
fatherSonIndex=0
frm_calc='_tipo2 + 1
len=9
name='_tipo2
next=Icpitembatch.CPVarDecl
frm_calc=''2'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(rowSID2.APRINVIO2,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + arfn_fdate_nd(rowSID2.INIINVIO2,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + arfn_fdate_nd(rowSID2.FININVIO2,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID2.FCFINVIO2,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(Upper(rowSID2.CFSINVIO2)),16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + rowSID2.RUOINVIO2
len=398
name='_riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(rowSID2.SEXINVIO2))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(99)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=2
prev=O574
I
obj='Var
pag=2
prev=O573
var_op='asgn
I
obj='Var
pag=2
prev=O570
var_op='asgn
I
obj='If
pag=2
prev=O569
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O570
fatherSonIndex=0
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(rowSID2.COGINVIO2,' '),26)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(rowSID2.NOMINVIO2,' '),25)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(rowSID2.SEXINVIO2,1)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +arfn_fdate_nd(rowSID2.DNSINVIO2,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(arfn_agechar(rowSID2.CNSINVIO2,' ')),40)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(rowSID2.PNSINVIO2,2)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(102)
len=398
name='_riga
obj='Var
pag=2
prev=O583
var_op='asgn
I
obj='Var
pag=2
prev=O582
var_op='asgn
I
obj='Var
pag=2
prev=O581
var_op='asgn
I
obj='Var
pag=2
prev=O580
var_op='asgn
I
obj='Var
pag=2
prev=O579
var_op='asgn
I
obj='Var
pag=2
prev=O578
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O570
fatherSonIndex=1
frm_calc='_riga +Space(102)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(arfn_agechar(rowSID2.RGSINVIO2,' ')),60)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(arfn_agechar(rowSID2.CSLINVIO2,' ')),40)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(rowSID2.PLSINVIO2),2)
len=398
name='_riga
obj='Var
pag=2
prev=O588
var_op='asgn
I
obj='Var
pag=2
prev=O587
var_op='asgn
I
obj='Var
pag=2
prev=O586
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O568
var_op='asgn
I
obj='Var
pag=2
prev=O567
var_op='asgn
I
obj='Var
pag=2
prev=O566
var_op='asgn
I
obj='Var
pag=2
prev=O565
var_op='asgn
I
obj='Var
pag=2
prev=O564
var_op='asgn
I
obj='Var
pag=2
prev=O563
var_op='asgn
I
obj='Var
pag=2
prev=O562
var_op='asgn
I
obj='Var
pag=2
prev=O561
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O554
fatherSonIndex=0
frm_calc='rowSID2
frm_seek='AppendRow
name='mcSID2
obj='Var
obj_type='MC
pag=2
var_op='meth
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=2
prev=O492
var_op='asgn
I
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Aggiorna codice Univoco
father=O492
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_invio
frm_seek='CODINVIO1
name='rowSID1
next=Icpitembatch.CPCase
frm_calc=[
'At(rowTemp.TIPOAG,"01;02;03;12;13") <> 0
'At(rowTemp.TIPOAG,"96;97;") <> 0
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.RAPPORTO
frm_seek='RAPINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.TIPOAG
frm_seek='TPRINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAINI
frm_seek='INIINVIO1
name='rowSID1
next=Icpitembatch.CPIfElse
frm_calc=[
'_tipinvio='2'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_tipinvio
frm_seek='TIPINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc=''1'
frm_seek='TPCINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_unique
frm_seek='UNIQUE1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_newuc
frm_seek='FLGUNQ1
name='rowSID1
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgstp='N'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_tipo1 + 1
len=9
name='_tipo1
next=Icpitembatch.CPBeginEnd
comment='Scrive la riga
h=[
19
19
]
obj='Begin
pag=2
prev=O618
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O619
fatherSonIndex=0
frm_calc=''1'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowTemp.TIPOAG),2)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowTemp.TIPOAG='99',LibreriaMit.SpacePad(LRTrim(Upper(arfn_agechar(rowTemp.DESCRAP,' '))),24),Space(24))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + arfn_fdate_nd(rowTemp.DATAINI,'N')
len=398
name='_riga
next=Icpitembatch.CPIfElse
frm_calc=[
'_tipinvio='2'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPCase
frm_calc=[
'At(rowTemp.TIPOAG,"01;02;03;12;13") <> 0
'At(rowTemp.TIPOAG,"96;97;") <> 0
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(_tipinvio='2' and not(Empty(rowTemp.IDESITO)), LibreriaMit.SpacePad(LRTrim(rowTemp.IDESITO),13),Space(13))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(286)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=2
prev=O636
I
obj='Var
pag=2
prev=O635
var_op='asgn
I
obj='Var
pag=2
prev=O634
var_op='asgn
I
obj='Var
pag=2
prev=O631
var_op='asgn
I
obj='Case
pag=2
prev=O628
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O631
fatherSonIndex=0
frm_calc='_riga + iif(Empty(LRTrim(rowTemp.CAB)),LibreriaMit.SpacePad(LRTrim(_cabinter),5),LibreriaMit.SpacePad(LRTrim(rowTemp.CAB),5))
len=398
name='_riga
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O631
fatherSonIndex=1
frm_calc='''
len=3
name='_ison
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_ison),5)
len=398
name='_riga
obj='Var
pag=2
prev=O643
var_op='asgn
I
obj='Read
pag=2
prev=O642
rd_field=[
'ISON
]
rd_kfield=[
'ISO
]
rd_kvar=[
'rowTemp.ISOAGE
]
rd_var=[
'_ison
]
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O631
fatherSonIndex=2
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowTemp.CAB),5)
len=398
name='_riga
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='If
pag=2
prev=O627
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O628
fatherSonIndex=0
frm_calc='_riga + iif(not(Empty(rowTemp.DATAFINE)),arfn_fdate_nd(rowTemp.DATAFINE,'N'),'01010001')
len=398
name='_riga
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O628
fatherSonIndex=1
frm_calc='_riga + iif(rowTemp.DATAFINE>= _dataini and rowTemp.DATAFINE<= _datafin,arfn_fdate_nd(rowTemp.DATAFINE,'N'),'01010001')
len=398
name='_riga
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O626
var_op='asgn
I
obj='Var
pag=2
prev=O625
var_op='asgn
I
obj='Var
pag=2
prev=O624
var_op='asgn
I
obj='Var
pag=2
prev=O623
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O615
var_op='asgn
I
obj='If
pag=2
prev=O614
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O615
fatherSonIndex=0
frm_calc='rowSID1
frm_seek='AppendRow
name='mcSID1
obj='Var
obj_type='MC
pag=2
var_op='meth
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aetesta
father=O615
fatherSonIndex=1
obj='Write
pag=2
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'UNIQUER
'UNIQUECODE
'INVIATO
'DATAINVIO
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'_unique
'_unique
'1
'Date()
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='R
pag=2
prev=O613
var_op='prop
I
obj='Var
obj_type='R
pag=2
prev=O612
var_op='prop
I
obj='Var
obj_type='R
pag=2
prev=O611
var_op='prop
I
obj='Var
obj_type='R
pag=2
prev=O608
var_op='prop
I
obj='If
pag=2
prev=O607
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O608
fatherSonIndex=0
frm_calc='iif(not(Empty(rowTemp.DATAFINE)),rowTemp.DATAFINE,NullDate())
frm_seek='FININVIO1
name='rowSID1
obj='Var
obj_type='R
pag=2
var_op='prop
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O608
fatherSonIndex=1
frm_calc='iif(rowTemp.DATAFINE>= _dataini and rowTemp.DATAFINE<= _datafin,rowTemp.DATAFINE,NullDate())
frm_seek='FININVIO1
name='rowSID1
obj='Var
obj_type='R
pag=2
var_op='prop
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='R
pag=2
prev=O606
var_op='prop
I
obj='Var
obj_type='R
pag=2
prev=O605
var_op='prop
I
obj='Var
obj_type='R
pag=2
prev=O602
var_op='prop
I
obj='Case
pag=2
prev=O601
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O602
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(rowTemp.CAB)),LRTrim(_cabinter),LRTrim(rowTemp.CAB))
frm_seek='CABINVIO1
name='rowSID1
obj='Var
obj_type='R
pag=2
var_op='prop
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O602
fatherSonIndex=1
frm_calc='''
len=3
name='_ison
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPVarDecl
frm_calc='_ison
frm_seek='CABINVIO1
name='rowSID1
obj='Var
obj_type='R
pag=2
prev=O682
var_op='prop
I
obj='Read
pag=2
prev=O681
rd_field=[
'ISON
]
rd_kfield=[
'ISO
]
rd_kvar=[
'rowTemp.ISOAGE
]
rd_var=[
'_ison
]
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O602
fatherSonIndex=2
frm_calc='rowTemp.CAB
frm_seek='CABINVIO1
name='rowSID1
obj='Var
obj_type='R
pag=2
var_op='prop
I
I
]
w=[
150
150
150
150
]
I
obj='Var
obj_type='R
pag=2
prev=O599
var_op='prop
I
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O599
fatherSonIndex=0
frm_calc='iif(not(Empty(rowTemp.UNIQUECODE)),rowTemp.UNIQUECODE,iif(Empty(rowTemp.OLDINTER),LRTrim(_cfinter),LRTrim(rowTemp.OLDINTER))+"_"+w_annoc+"_"+(LRTrim(rowTemp.RAPPORTO)))
len=50
name='_unique
next=Icpitembatch.CPVarDecl
frm_calc='arfn_agechar(_unique,"_")
len=50
name='_unique
next=Icpitembatch.CPVarDecl
frm_calc='Strtran(LRTrim(_unique)," ","_")
len=50
name='_unique
next=Icpitembatch.CPVarDecl
frm_calc='Strtran(LRTrim(_unique),"-","_")
len=50
name='_unique
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(rowTemp.UNIQUECODE)),'N','S')
len=1
name='_newuc
obj='Var
pag=2
prev=O696
var_op='asgn
I
obj='Var
pag=2
prev=O695
var_op='asgn
I
obj='Var
pag=2
prev=O694
var_op='asgn
I
obj='Var
pag=2
prev=O693
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='MemoryCursor
pag=2
par_expr=[
'_dataini
'_datafin
'0
]
par_name=[
'_dadata
'_adata
'_inviato
]
sel_name='qbe_fam_periodo01
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O295
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O297
fatherSonIndex=0
frm_calc='_invio
frm_seek='CODINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='_tipinvio
frm_seek='TIPINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc=''1'
frm_seek='TPCINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='w_annoc
frm_seek='ANNINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='_mese
frm_seek='MESINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='_nomefile
frm_seek='FLEINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='rowSID0
frm_seek='AppendRow
name='mcSID0
next=Icpitembatch.CPDelete
arch='sid_invio
next=Icpitembatch.CPInsert
arch='sid_invio
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_crea
next=Icpitembatch.CPBeginEnd
comment='Scrive testata
h=[
19
19
]
obj='Begin
pag=2
prev=O716
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O717
fatherSonIndex=0
frm_calc=''0'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'ARU00'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + _tipinvio
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '1'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + w_annoc
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + _mese
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(24)
len=398
name='_riga
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +'0'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + Space(112)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=2
prev=O733
I
obj='Var
pag=2
prev=O732
var_op='asgn
I
obj='Var
pag=2
prev=O731
var_op='asgn
I
obj='Var
pag=2
prev=O730
var_op='asgn
I
obj='Var
pag=2
prev=O728
var_op='asgn
I
obj='Select
pag=2
prev=O727
sel_field='*
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O728
fatherSonIndex=0
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(intermbo->CODFISC),16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(intermbo->CODFISC)
len=16
name='_cfinter
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(intermbo->CODCAB),5)
len=5
name='_cabinter
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(intermbo->CODFISC)) = 16
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O739
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O740
fatherSonIndex=0
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->COGNOME,26)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->NOME,25)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->SESSO,1)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +arfn_fdate_nd(intermbo->DATANASC,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->NASCOMUN,40)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->PROVNA,2)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(112)
len=10
name='_riga
obj='Var
obj_type='M
pag=2
prev=O750
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O749
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O748
var_op='asgn
I
obj='Var
pag=2
prev=O747
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O746
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O745
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O740
fatherSonIndex=1
frm_calc='_riga +Space(102)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(intermbo->RAGSOC,' '),70)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(intermbo->DESCCIT,' '),40)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->PROVINCIA,2)
len=10
name='_riga
obj='Var
obj_type='M
pag=2
prev=O755
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O754
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O753
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O738
var_op='asgn
I
obj='Var
pag=2
prev=O737
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O726
var_op='asgn
I
obj='Var
pag=2
prev=O725
var_op='asgn
I
obj='Var
pag=2
prev=O724
var_op='asgn
I
obj='Var
pag=2
prev=O723
var_op='asgn
I
obj='Var
pag=2
prev=O722
var_op='asgn
I
obj='Var
pag=2
prev=O721
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O715
var_op='asgn
I
obj='Insert
pag=2
prev=O714
rd_kfield=[
'CODINVIO
'TIPINVIO
'TPCINVIO
'DATINVIO
'ANNINVIO
'MESINVIO
'FLEINVIO
]
rd_kvar=[
'_invio
''1'
''1'
'Date()
'w_annoc
'w_mese
'_invio
]
I
obj='Delete
pag=2
prev=O713
rd_kfield=[
'CODINVIO
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='Var
obj_type='MC
pag=2
prev=O712
var_op='meth
I
obj='Var
obj_type='R
pag=2
prev=O711
var_op='prop
I
obj='Var
obj_type='R
pag=2
prev=O710
var_op='prop
I
obj='Var
obj_type='R
pag=2
prev=O709
var_op='prop
I
obj='Var
obj_type='R
pag=2
prev=O708
var_op='prop
I
obj='Var
obj_type='R
pag=2
prev=O707
var_op='prop
I
obj='Var
obj_type='R
pag=2
var_op='prop
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O293
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O295
fatherSonIndex=0
frm_calc=''1'
len=1
name='_tipinvio
next=Icpitembatch.CPIfElse
frm_calc=[
'Date() >  arfn_finemese(arfn_datesum(w_a_data,1))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_annoc='2020' and At(_mese,'|02|03|04') > 0 and Date() <= CharToDate('20200630')
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='w_annoc+_mese+"_"+_tipinvio+"_1"
len=10
name='_invio
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gIntemediario)+"_"+_invio+"_"+DateTimeToChar(DateTime())
len=10
name='_nomefile
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWritePath(LRTrim(gPathDoc)+'/SID/INVII/DAP/'+LRTrim(gAzienda)+"/"+LRTrim(_nomefile))
len=10
name='fhand
next=Icpitembatch.CPInsert
arch='tmp_list_imprich
obj='Insert
pag=2
prev=O777
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
'_invio
'_nomefile
]
I
obj='Var
pag=2
prev=O776
var_op='asgn
I
obj='Var
pag=2
prev=O775
var_op='asgn
I
obj='Var
pag=2
prev=O772
var_op='asgn
I
obj='If
pag=2
prev=O769
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O772
fatherSonIndex=0
frm_calc=''1'
len=1
name='_tipinvio
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O768
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O769
fatherSonIndex=0
frm_calc=''2'
len=1
name='_tipinvio
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O293
fatherSonIndex=0
frm_seek='Zap
name='mcSID0
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID1
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID2
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID2r
obj='Var
obj_type='MC
pag=2
prev=O794
var_op='meth
I
obj='Var
obj_type='MC
pag=2
prev=O793
var_op='meth
I
obj='Var
obj_type='MC
pag=2
prev=O792
var_op='meth
I
obj='Var
obj_type='MC
pag=2
var_op='meth
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O287
fatherSonIndex=1
frm_calc='gMsgProc + 'Non ci sono dati per il periodo considerato: '+arfn_fdate(_dataini)+" - " +arfn_fdate(_datafin)+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=2
par_expr=[
'_dataini
'_datafin
'0
]
par_name=[
'_dadata
'_adata
'_inviato
]
prev=O284
sel_name='qbe_fam_periodo01_minmax
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O285
fatherSonIndex=0
frm_calc='_totrecord + qbe_fam_periodo01_minmax->TOTPRG
len=10
name='_totrecord
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O283
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=2
prev=O277
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
x=9
y=22
I
Icpitembatch.CPBeginEnd
comment='Legge i dati e effettua le verifiche
h=[
19
19
]
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O808
fatherSonIndex=0
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Inizio Elaborazione Cancellazioni '+w_annoc+"-"+w_mese+" :"+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPBeginEnd
comment='Ordinario - Cancellazioni (2-4)
h=[
19
19
]
obj='Begin
pag=6
prev=O813
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O814
fatherSonIndex=0
frm_calc='"Attendere. Estrazione dati per il periodo ..."
global=True
len=120
name='gMsgImp
next=Ispitembatch.CPMemoryCursor
data_source='tmp_stpperiodo
mem_curs_name='mcTemp
next=Icpitembatch.CPVarDecl
frm_calc='mcTemp.RecCount()
len=10
name='_totrecord
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTemp.RecCount() > 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Fine Elaborazione Cancellazioni '+w_annoc+"-"+w_mese+" :"+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=6
prev=O821
var_op='asgn
I
obj='If
pag=6
prev=O820
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Azzera i cursori
father=O821
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Apre il file di scrittura
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Crea Testata
h=[
19
19
]
next=Icpitembatch.CPForEach
for_variable='rowTemp
for_variable_type='tmp_stpperiodo
h=[
19
19
]
iterator_expr='mcTemp
next=Icpitembatch.CPBeginEnd
comment='Crea Piede
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPInsert
arch='aesaldi
next=Icpitembatch.CPIfElse
frm_calc=[
'_nosid=0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_sid.IsEmpty()
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Sono stati generati '+LRTrim(Str(_conta,10,0))+" record" +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Fine controllo periodo: '+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=6
prev=O845
var_op='asgn
I
nonlocal=True
obj='Var
pag=6
prev=O842
var_op='asgn
I
obj='If
pag=6
prev=O839
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Azzera se avevo scritto qualcosa
father=O842
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Inizio Aggiornamento Dati: '+arfn_fdatetime(DateTime())+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_oldmsg
next=Icpitembatch.CPForEach
for_variable='rowSID1
for_variable_type='sid_invio1
h=[
19
19
]
iterator_expr='mcSID1
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + NL + 'Ora Fine Aggiornamento Dati: '+arfn_fdatetime(DateTime())+NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O854
var_op='asgn
I
obj='ForEach
pag=6
prev=O853
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O854
fatherSonIndex=0
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Sto aggiornando l'operazione " + LRTrim(Str(_conta,10,0)) + " su " + LRTrim(Str(_totrecord,10,0))
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_oldmsg)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='"Sto aggiornando l'operazione " + LRTrim(Str(_conta,10,0)) + " su " + LRTrim(Str(_totrecord,10,0))
len=10
name='_oldmsg
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgstp='N'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'rowSID1.TPRINVIO1='98'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Ho aggiornato l'operazione " + LRTrim(Str(_conta,10,0)) + " su " + LRTrim(Str(_totrecord,10,0))
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_oldmsg)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gMsgImp)
len=10
name='_oldmsg
obj='Var
obj_type='M
pag=6
prev=O872
var_op='asgn
I
obj='If
pag=6
prev=O871
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O872
fatherSonIndex=0
frm_calc='gMsgProc + LRTrim(gMsgImp)
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O872
fatherSonIndex=1
frm_calc='Strtran(gMsgProc,LRTrim(_oldmsg),LRTrim(gMsgImp))
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
pag=6
prev=O868
var_op='asgn
I
obj='If
pag=6
prev=O865
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O868
fatherSonIndex=0
frm_calc='"Sto aggiornando l'operazione con codice: "+rowSID1.RAPINVIO1
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='opextrbo
obj='Write
pag=6
prev=O884
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'ANNULLA
'DATAMODI
]
wr_op=[
'=
'=
]
wr_var=[
'1
'NullDate()
]
I
nonlocal=True
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O868
fatherSonIndex=1
frm_calc='"Sto aggiornando il rapporto: "+rowSID1.RAPINVIO1
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='aetesta
obj='Write
pag=6
prev=O893
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'ANNULLA
]
wr_op=[
'=
]
wr_var=[
'1
]
I
nonlocal=True
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=6
prev=O864
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sid_invio1
father=O865
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'CODINVIO1
'RAPINVIO1
'TPRINVIO1
'INIINVIO1
'FININVIO1
'TIPINVIO1
'TPCINVIO1
'MODINVIO1
]
rd_kvar=[
'rowSID1.CODINVIO1
'rowSID1.RAPINVIO1
'rowSID1.TPRINVIO1
'rowSID1.INIINVIO1
'rowSID1.FININVIO1
'rowSID1.TIPINVIO1
'rowSID1.TPCINVIO1
'rowSID1.MODINVIO1
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=6
prev=O861
var_op='asgn
I
obj='If
pag=6
prev=O860
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O861
fatherSonIndex=0
frm_calc='gMsgProc + LRTrim(gMsgImp)
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O861
fatherSonIndex=1
frm_calc='Strtran(gMsgProc,LRTrim(_oldmsg),LRTrim(gMsgImp))
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
pag=6
prev=O859
var_op='asgn
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=6
prev=O852
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O851
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O849
var_op='asgn
I
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='sid_invio1
father=O849
fatherSonIndex=0
obj='Delete
pag=6
rd_kfield=[
'CODINVIO1
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O838
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O839
fatherSonIndex=0
frm_calc='arfn_exec_sid(_nomefile,w_annoc)
name='_sid
next=Icpitembatch.CPIfElse
frm_calc=[
'_sid.RecCount() > 0
]
h=[
19
19
]
obj='If
pag=6
prev=O925
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O926
fatherSonIndex=0
for_variable='rowErrore
for_variable_type='mcMessaggi.MCRDef
h=[
19
19
]
iterator_expr='_sid
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''Rilevati errori durante il controllo da parte del SID - Cancellazioni'
obj='Transaction
pag=6
prev=O931
raise_on_trans_err=True
I
obj='ForEach
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O931
fatherSonIndex=0
frm_calc='gMsgProc + LRTrim(rowErrore.testata) + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=6
prev=O837
rd_kfield=[
'IDBASE
'NOMEFILE
'ANNO
'MESE
'TIPOINVIO
'TIPOCOMU
'CODINVIO
]
rd_kvar=[
'LibreriaMit.UniqueId()
'Left(_nomefile,50)
'w_annoc
'_mese
''2'
''4'
'_invio
]
I
obj='Exec
pag=6
prev=O835
I
obj='Begin
pag=6
prev=O833
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Scrive Ultima riga
father=O835
fatherSonIndex=0
h=[
19
19
]
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O944
fatherSonIndex=0
frm_calc=''9'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo1,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo2,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo3,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo4,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + Space(360)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=6
prev=O954
I
obj='Var
pag=6
prev=O953
var_op='asgn
I
obj='Var
pag=6
prev=O952
var_op='asgn
I
obj='Var
pag=6
prev=O951
var_op='asgn
I
obj='Var
pag=6
prev=O950
var_op='asgn
I
obj='Var
pag=6
prev=O949
var_op='asgn
I
obj='Var
pag=6
prev=O948
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=6
prev=O831
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Record Tipo 1
father=O833
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGAGESID\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProg
next=Icpitembatch.CPInsert
arch='aefaminvio
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati generati '+LRTrim(Str(_conta,10,0))+" record"
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=6
prev=O964
var_op='asgn
I
obj='Insert
pag=6
prev=O963
rd_kfield=[
'IDBASE
'TIPO
'TIPOINVIO
'ANNO
'MESE
'TIPOCOM
'RAPPORTO
'NOMEFILE
'PROG
'IDIDBASE
]
rd_kvar=[
'cProg
'rowTemp.TIPO
''2'
'w_annoc
'_mese
''4'
'rowTemp.RAPPORTO
'_nomefile
'_conta
'_invio
]
I
obj='Var
pag=6
prev=O962
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O960
var_op='asgn
I
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Aggiorna codice Univoco
father=O960
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_invio
frm_seek='CODINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.RAPPORTO
frm_seek='RAPINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.TIPOAG
frm_seek='TPRINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAINI
frm_seek='INIINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAFINE
frm_seek='FININVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc=''2'
frm_seek='TIPINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc=''4'
frm_seek='TPCINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_unique
frm_seek='UNIQUE1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_newuc
frm_seek='FLGUNQ1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAMODI
frm_seek='MODINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowSID1
frm_seek='AppendRow
name='mcSID1
next=Icpitembatch.CPVarDecl
frm_calc='_tipo1 + 1
len=9
name='_tipo1
next=Icpitembatch.CPBeginEnd
comment='Scrive la riga
h=[
19
19
]
obj='Begin
pag=6
prev=O983
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O984
fatherSonIndex=0
frm_calc=''1'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowTemp.TIPOAG),2)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowTemp.TIPOAG='99',LibreriaMit.SpacePad(LRTrim(Upper(arfn_agechar(rowTemp.DESCRAP,' '))),24),Space(24))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + arfn_fdate_nd(rowTemp.DATAINI,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowTemp.TIPOAG='98' or Empty(rowTemp.DATAFINE),'01010001',arfn_fdate_nd(rowTemp.DATAFINE,'N'))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowTemp.CAB),5)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(_tipinvio='2' and not(Empty(rowTemp.IDESITO)), LibreriaMit.SpacePad(LRTrim(rowTemp.IDESITO),13),Space(13))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(286)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=6
prev=O997
I
obj='Var
pag=6
prev=O996
var_op='asgn
I
obj='Var
pag=6
prev=O995
var_op='asgn
I
obj='Var
pag=6
prev=O994
var_op='asgn
I
obj='Var
pag=6
prev=O993
var_op='asgn
I
obj='Var
pag=6
prev=O992
var_op='asgn
I
obj='Var
pag=6
prev=O991
var_op='asgn
I
obj='Var
pag=6
prev=O990
var_op='asgn
I
obj='Var
pag=6
prev=O989
var_op='asgn
I
obj='Var
pag=6
prev=O988
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O982
var_op='asgn
I
obj='Var
obj_type='MC
pag=6
prev=O981
var_op='meth
I
obj='Var
obj_type='R
pag=6
prev=O980
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O979
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O978
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O977
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O976
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O975
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O974
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O973
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O972
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O970
var_op='prop
I
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O970
fatherSonIndex=0
frm_calc='arfn_agechar(LRTrim(rowTemp.UNIQUECODE),"_")
len=50
name='_unique
next=Icpitembatch.CPVarDecl
frm_calc=''N'
len=1
name='_newuc
obj='Var
pag=6
prev=O1002
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
prev=O829
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O831
fatherSonIndex=0
frm_calc='_invio
frm_seek='CODINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc=''2'
frm_seek='TIPINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc=''4'
frm_seek='TPCINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='w_annoc
frm_seek='ANNINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='_mese
frm_seek='MESINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='_nomefile
frm_seek='FLEINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='rowSID0
frm_seek='AppendRow
name='mcSID0
next=Icpitembatch.CPDelete
arch='sid_invio
next=Icpitembatch.CPInsert
arch='sid_invio
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_crea
next=Icpitembatch.CPBeginEnd
comment='Scrive testata
h=[
19
19
]
obj='Begin
pag=6
prev=O1018
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1019
fatherSonIndex=0
frm_calc=''0'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'ARU00'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '2'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '4'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '0000'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '00'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(24)
len=398
name='_riga
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +'0'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + Space(112)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=6
prev=O1035
I
obj='Var
pag=6
prev=O1034
var_op='asgn
I
obj='Var
pag=6
prev=O1033
var_op='asgn
I
obj='Var
pag=6
prev=O1032
var_op='asgn
I
obj='Var
pag=6
prev=O1030
var_op='asgn
I
obj='Select
pag=6
prev=O1029
sel_field='*
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1030
fatherSonIndex=0
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(intermbo->CODFISC),16)
len=398
name='_riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(intermbo->CODFISC)) = 16
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
prev=O1039
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O1040
fatherSonIndex=0
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->COGNOME,26)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->NOME,25)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->SESSO,1)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +arfn_fdate_nd(intermbo->DATANASC,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->NASCOMUN,40)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->PROVNA,2)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(112)
len=10
name='_riga
obj='Var
obj_type='M
pag=6
prev=O1050
var_op='asgn
I
obj='Var
obj_type='M
pag=6
prev=O1049
var_op='asgn
I
obj='Var
obj_type='M
pag=6
prev=O1048
var_op='asgn
I
obj='Var
pag=6
prev=O1047
var_op='asgn
I
obj='Var
obj_type='M
pag=6
prev=O1046
var_op='asgn
I
obj='Var
obj_type='M
pag=6
prev=O1045
var_op='asgn
I
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O1040
fatherSonIndex=1
frm_calc='_riga +Space(102)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(intermbo->RAGSOC,' '),70)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(intermbo->DESCCIT,' '),40)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->PROVINCIA,2)
len=10
name='_riga
obj='Var
obj_type='M
pag=6
prev=O1055
var_op='asgn
I
obj='Var
obj_type='M
pag=6
prev=O1054
var_op='asgn
I
obj='Var
obj_type='M
pag=6
prev=O1053
var_op='asgn
I
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O1028
var_op='asgn
I
obj='Var
pag=6
prev=O1027
var_op='asgn
I
obj='Var
pag=6
prev=O1026
var_op='asgn
I
obj='Var
pag=6
prev=O1025
var_op='asgn
I
obj='Var
pag=6
prev=O1024
var_op='asgn
I
obj='Var
pag=6
prev=O1023
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O1017
var_op='asgn
I
obj='Insert
pag=6
prev=O1016
rd_kfield=[
'CODINVIO
'TIPINVIO
'TPCINVIO
'DATINVIO
'ANNINVIO
'MESINVIO
'FLEINVIO
]
rd_kvar=[
'_invio
''2'
''4'
'Date()
''0000'
''00'
'_invio
]
I
obj='Delete
pag=6
prev=O1015
rd_kfield=[
'CODINVIO
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='Var
obj_type='MC
pag=6
prev=O1014
var_op='meth
I
obj='Var
obj_type='R
pag=6
prev=O1013
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O1012
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O1011
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O1010
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O1009
var_op='prop
I
obj='Var
obj_type='R
pag=6
var_op='prop
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
prev=O827
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O829
fatherSonIndex=0
frm_calc='w_annoc+w_mese+'_2_4'
len=10
name='_invio
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gIntemediario)+"_"+_invio+"_"+DateTimeToChar(DateTime())
len=10
name='_nomefile
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWritePath(LRTrim(gPathDoc)+'/SID/INVII/DAP/'+LRTrim(gAzienda)+"/"+LRTrim(_nomefile))
len=10
name='fhand
next=Icpitembatch.CPInsert
arch='tmp_list_imprich
obj='Insert
pag=6
prev=O1070
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
'_invio
'_nomefile
]
I
obj='Var
pag=6
prev=O1069
var_op='asgn
I
obj='Var
pag=6
prev=O1068
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O827
fatherSonIndex=0
frm_seek='Zap
name='mcSID0
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID1
obj='Var
obj_type='MC
pag=6
prev=O1077
var_op='meth
I
obj='Var
obj_type='MC
pag=6
var_op='meth
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O821
fatherSonIndex=1
frm_calc='gMsgProc + 'Non ci sono cancellazioni per il periodo considerato: '+arfn_fdate(_dataini)+" - " +arfn_fdate(_datafin)+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O819
var_op='asgn
I
obj='MemoryCursor
pag=6
par_expr=[
'_dataini
'_datafin
]
par_name=[
'_dadata
'_adata
]
prev=O818
sel_name='qbe_fam_delete_rap
I
nonlocal=True
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=6
prev=O812
var_op='asgn
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
x=13
y=25
I
Icpitembatch.CPBeginEnd
comment='Cerca i limiti di selezione
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_tot > 0
]
h=[
19
19
]
obj='If
pag=4
prev=O1087
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Azzera variabili
father=O1089
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Calcola il numero dei cicli
h=[
19
19
]
next=Icpitembatch.CPWhile
frm_calc='_contacicli <= _cicli
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=4
prev=O1098
var_op='asgn
I
obj='While
pag=4
prev=O1096
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1098
fatherSonIndex=0
frm_calc=[
'_mono = 1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Lettura operazioni extraconto in corso ... Ciclo N. '+LRTrim(Str(_contacicli,10,0)) + " su " +LRTrim(Str(_cicli,10,0))
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_oldmsg)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc=''Periodo: '+w_annoc+'-'+_mese+' - Lettura operazioni extraconto in corso ... Ciclo N. '+LRTrim(Str(_contacicli,10,0)) + " su " +LRTrim(Str(_cicli,10,0))
len=100
name='_oldmsg
next=Icpitembatch.CPIfElse
frm_calc=[
'_top>=_min
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_contacicli+1
len=15
name='_contacicli
obj='Var
obj_type='N
pag=4
prev=O1111
var_op='asgn
I
obj='If
pag=4
prev=O1110
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Operazioni Extraconto
father=O1111
fatherSonIndex=0
h=[
19
19
]
obj='Begin
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O1117
fatherSonIndex=0
frm_calc=''Lettura operazioni extraconto in corso ...'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcTemp
next=Ispitembatch.CPMemoryCursor
cache_name='chOpex
data_source='tmp_stpperiodo
expected_rows=5000
mem_curs_name='mcTemp
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTemp.RecCount() > 0
]
h=[
19
19
]
obj='If
pag=4
prev=O1123
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O1124
fatherSonIndex=0
for_variable='rowTemp
for_variable_type='tmp_stpperiodo
h=[
19
19
]
iterator_expr='mcTemp
obj='ForEach
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Record Tipo 1
father=O1129
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fam_mesefile02(rowSID1,_dataini,_datafin,rowTemp.TIPO)
name='mcSID2r
next=Icpitembatch.CPForEach
for_variable='rowSID2
for_variable_type='sid_invio2
h=[
19
19
]
iterator_expr='mcSID2r
next=Icpitembatch.CPIfElse
frm_calc=[
'_tipinvio='2'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGAGESID\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProg
next=Icpitembatch.CPInsert
arch='aefaminvio
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati generati '+LRTrim(Str(_conta,10,0))+" record su un totale di "+LRTrim(Str(_tot,10,0))
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=4
prev=O1143
var_op='asgn
I
obj='Insert
pag=4
prev=O1142
rd_kfield=[
'IDBASE
'TIPO
'TIPOINVIO
'ANNO
'MESE
'TIPOCOM
'RAPPORTO
'NOMEFILE
'PROG
'IDIDBASE
]
rd_kvar=[
'cProg
'rowTemp.TIPO
''1'
'w_annoc
'_mese
''1'
'rowTemp.RAPPORTO
'_nomefile
'_conta
'_invio
]
I
obj='Var
pag=4
prev=O1141
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1138
var_op='asgn
I
obj='If
pag=4
prev=O1136
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1138
fatherSonIndex=0
frm_calc=[
'(Year(Date()) -Year(rowTemp.DATAINI)=1 and Date() <= gScadSaldi) or (Year(Date()) -Year(rowTemp.DATAINI)=0)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fam_mesefile03(rowSID1,_asaldi,rowTemp.TIPO,rowTemp.VALUTA)
name='mcSID3r
next=Icpitembatch.CPForEach
for_variable='rowSID3
for_variable_type='sid_invio3
h=[
19
19
]
iterator_expr='mcSID3r
obj='ForEach
pag=4
prev=O1152
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1153
fatherSonIndex=0
frm_calc='rowSID3
frm_seek='AppendRow
name='mcSID3
next=Icpitembatch.CPVarDecl
frm_calc='_tipo3 + 1
len=9
name='_tipo3
next=Icpitembatch.CPVarDecl
frm_calc=''3'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + rowTemp.TIPOAG
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.ANNINVIO3,4,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM1INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM1INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM1INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI1INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM2INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM2INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM2INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI2INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM3INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM3INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM3INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI3INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM4INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM4INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM4INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI4INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM5INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM5INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM5INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI5INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM6INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM6INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM6INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI6INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + rowTemp.VALUTA
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(229)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=4
prev=O1177
I
obj='Var
pag=4
prev=O1176
var_op='asgn
I
obj='Var
pag=4
prev=O1175
var_op='asgn
I
obj='Var
pag=4
prev=O1174
var_op='asgn
I
obj='Var
pag=4
prev=O1173
var_op='asgn
I
obj='Var
pag=4
prev=O1172
var_op='asgn
I
obj='Var
pag=4
prev=O1171
var_op='asgn
I
obj='Var
pag=4
prev=O1170
var_op='asgn
I
obj='Var
pag=4
prev=O1169
var_op='asgn
I
obj='Var
pag=4
prev=O1168
var_op='asgn
I
obj='Var
pag=4
prev=O1167
var_op='asgn
I
obj='Var
pag=4
prev=O1166
var_op='asgn
I
obj='Var
pag=4
prev=O1165
var_op='asgn
I
obj='Var
pag=4
prev=O1164
var_op='asgn
I
obj='Var
pag=4
prev=O1163
var_op='asgn
I
obj='Var
pag=4
prev=O1162
var_op='asgn
I
obj='Var
pag=4
prev=O1161
var_op='asgn
I
obj='Var
pag=4
prev=O1160
var_op='asgn
I
obj='Var
pag=4
prev=O1159
var_op='asgn
I
obj='Var
pag=4
prev=O1158
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1157
var_op='asgn
I
obj='Var
obj_type='MC
pag=4
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=4
prev=O1149
var_op='asgn
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1149
fatherSonIndex=0
frm_calc='0
len=4
name='_asaldi
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1149
fatherSonIndex=1
frm_calc='Year(rowTemp.DATAINI)
len=4
name='_asaldi
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=4
prev=O1135
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1136
fatherSonIndex=0
frm_calc=[
'w_flgstp='N'
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Scrive la riga
h=[
19
19
]
obj='Begin
pag=4
prev=O1189
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1192
fatherSonIndex=0
frm_calc='_tipo2 + 1
len=9
name='_tipo2
next=Icpitembatch.CPVarDecl
frm_calc=''2'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(rowSID2.APRINVIO2,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + arfn_fdate_nd(rowSID2.INIINVIO2,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '01010001'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID2.FCFINVIO2,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(Upper(rowSID2.CFSINVIO2)),16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + rowSID2.RUOINVIO2
len=398
name='_riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(rowSID2.SEXINVIO2))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(99)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=4
prev=O1209
I
obj='Var
pag=4
prev=O1208
var_op='asgn
I
obj='Var
pag=4
prev=O1205
var_op='asgn
I
obj='If
pag=4
prev=O1204
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O1205
fatherSonIndex=0
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(rowSID2.COGINVIO2,' '),26)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(rowSID2.NOMINVIO2,' '),25)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(rowSID2.SEXINVIO2,1)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +arfn_fdate_nd(rowSID2.DNSINVIO2,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(arfn_agechar(rowSID2.CNSINVIO2,' ')),40)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(rowSID2.PNSINVIO2,2)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(102)
len=398
name='_riga
obj='Var
pag=4
prev=O1218
var_op='asgn
I
obj='Var
pag=4
prev=O1217
var_op='asgn
I
obj='Var
pag=4
prev=O1216
var_op='asgn
I
obj='Var
pag=4
prev=O1215
var_op='asgn
I
obj='Var
pag=4
prev=O1214
var_op='asgn
I
obj='Var
pag=4
prev=O1213
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O1205
fatherSonIndex=1
frm_calc='_riga +Space(102)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(arfn_agechar(rowSID2.RGSINVIO2,' ')),60)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(arfn_agechar(rowSID2.CSLINVIO2,' ')),40)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(rowSID2.PLSINVIO2),2)
len=398
name='_riga
obj='Var
pag=4
prev=O1223
var_op='asgn
I
obj='Var
pag=4
prev=O1222
var_op='asgn
I
obj='Var
pag=4
prev=O1221
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=4
prev=O1203
var_op='asgn
I
obj='Var
pag=4
prev=O1202
var_op='asgn
I
obj='Var
pag=4
prev=O1201
var_op='asgn
I
obj='Var
pag=4
prev=O1200
var_op='asgn
I
obj='Var
pag=4
prev=O1199
var_op='asgn
I
obj='Var
pag=4
prev=O1198
var_op='asgn
I
obj='Var
pag=4
prev=O1197
var_op='asgn
I
obj='Var
pag=4
prev=O1196
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1189
fatherSonIndex=0
frm_calc='rowSID2
frm_seek='AppendRow
name='mcSID2
obj='Var
obj_type='MC
pag=4
var_op='meth
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=4
prev=O1133
var_op='asgn
I
obj='Begin
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Aggiorna codice Univoco
father=O1133
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_invio
frm_seek='CODINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.RAPPORTO
frm_seek='RAPINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.TIPOAG
frm_seek='TPRINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAINI
frm_seek='INIINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAFINE
frm_seek='FININVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_tipinvio
frm_seek='TIPINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc=''1'
frm_seek='TPCINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_unique
frm_seek='UNIQUE1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_newuc
frm_seek='FLGUNQ1
name='rowSID1
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgstp='S'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_tipo1 + 1
len=9
name='_tipo1
next=Icpitembatch.CPBeginEnd
comment='Scrive la riga
h=[
19
19
]
obj='Begin
pag=4
prev=O1248
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1249
fatherSonIndex=0
frm_calc=''1'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowTemp.TIPOAG),2)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowTemp.TIPOAG='99',LibreriaMit.SpacePad(LRTrim(Upper(arfn_agechar(rowTemp.DESCRAP,' '))),24),Space(24))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + arfn_fdate_nd(rowTemp.DATAINI,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '01010001'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowTemp.CAB),5)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(_tipinvio='2' and not(Empty(rowTemp.IDESITO)), LibreriaMit.SpacePad(LRTrim(rowTemp.IDESITO),13),Space(13))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(286)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=4
prev=O1262
I
obj='Var
pag=4
prev=O1261
var_op='asgn
I
obj='Var
pag=4
prev=O1260
var_op='asgn
I
obj='Var
pag=4
prev=O1259
var_op='asgn
I
obj='Var
pag=4
prev=O1258
var_op='asgn
I
obj='Var
pag=4
prev=O1257
var_op='asgn
I
obj='Var
pag=4
prev=O1256
var_op='asgn
I
obj='Var
pag=4
prev=O1255
var_op='asgn
I
obj='Var
pag=4
prev=O1254
var_op='asgn
I
obj='Var
pag=4
prev=O1253
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O1245
var_op='asgn
I
obj='If
pag=4
prev=O1244
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O1245
fatherSonIndex=0
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'INVIATO
'DATAINVIO
'UNIQUER
]
wr_op=[
'=
'=
'=
]
wr_var=[
'1
'Date()
'_unique
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1245
fatherSonIndex=1
frm_calc='rowSID1
frm_seek='AppendRow
name='mcSID1
obj='Var
obj_type='MC
pag=4
var_op='meth
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='R
pag=4
prev=O1243
var_op='prop
I
obj='Var
obj_type='R
pag=4
prev=O1242
var_op='prop
I
obj='Var
obj_type='R
pag=4
prev=O1241
var_op='prop
I
obj='Var
obj_type='R
pag=4
prev=O1240
var_op='prop
I
obj='Var
obj_type='R
pag=4
prev=O1239
var_op='prop
I
obj='Var
obj_type='R
pag=4
prev=O1238
var_op='prop
I
obj='Var
obj_type='R
pag=4
prev=O1237
var_op='prop
I
obj='Var
obj_type='R
pag=4
prev=O1236
var_op='prop
I
obj='Var
obj_type='R
pag=4
prev=O1234
var_op='prop
I
obj='Begin
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1234
fatherSonIndex=0
frm_calc='iif(not(Empty(rowTemp.UNIQUECODE)),rowTemp.UNIQUECODE,iif(Empty(rowTemp.OLDINTER),LRTrim(_cfinter),LRTrim(rowTemp.OLDINTER))+"_"+LRTrim(rowTemp.RAPPORTO))
len=50
name='_unique
next=Icpitembatch.CPVarDecl
frm_calc='arfn_agechar(_unique,"_")
len=50
name='_unique
next=Icpitembatch.CPVarDecl
frm_calc='Strtran(LRTrim(_unique)," ","_")
len=50
name='_unique
next=Icpitembatch.CPVarDecl
frm_calc='Strtran(LRTrim(_unique),"-","_")
len=50
name='_unique
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(rowTemp.UNIQUECODE)),'N','S')
len=1
name='_newuc
obj='Var
pag=4
prev=O1282
var_op='asgn
I
obj='Var
pag=4
prev=O1281
var_op='asgn
I
obj='Var
pag=4
prev=O1280
var_op='asgn
I
obj='Var
pag=4
prev=O1279
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='MemoryCursor
pag=4
par_expr=[
'_dataini
'_datafin
'0
'_bottom
'_top
]
par_name=[
'_dadata
'_adata
'_inviato
'_bottom
'_top
]
prev=O1122
sel_name='qbe_famperiodo_opx01
I
obj='Var
obj_type='MC
pag=4
prev=O1121
var_op='meth
I
nonlocal=True
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O1111
fatherSonIndex=1
frm_calc=''Lettura operazioni extraconto in corso ...'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=4
prev=O1107
var_op='asgn
I
obj='If
pag=4
prev=O1106
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O1107
fatherSonIndex=0
frm_calc='gMsgProc + 'Periodo: '+w_annoc+'-'+_mese+' - Lettura operazioni extraconto in corso ... Ciclo N. '+LRTrim(Str(_contacicli,10,0)) + " su " +LRTrim(Str(_cicli,10,0))
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O1107
fatherSonIndex=1
frm_calc='Strtran(gMsgProc,_oldmsg,'Periodo: '+w_annoc+'-'+_mese+" - " + LRTrim(gMsgImp))
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
pag=4
prev=O1103
var_op='asgn
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1103
fatherSonIndex=0
frm_calc='_min
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_max
len=15
name='_top
obj='Var
obj_type='N
pag=4
prev=O1302
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1103
fatherSonIndex=1
frm_calc=[
'_contacicli=1
'_contacicli = _cicli
]
h=[
19
19
19
19
]
haselse=True
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1305
fatherSonIndex=0
frm_calc='_min
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_min + 999
len=15
name='_top
obj='Var
obj_type='N
pag=4
prev=O1310
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1305
fatherSonIndex=1
frm_calc='_top + 1
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_max
len=15
name='_top
obj='Var
obj_type='N
pag=4
prev=O1313
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1305
fatherSonIndex=2
frm_calc='_top + 1
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_bottom + 999
len=15
name='_top
obj='Var
obj_type='N
pag=4
prev=O1316
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=4
prev=O1094
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1096
fatherSonIndex=0
frm_calc='iif(_tot > 5000,0,1)
len=1
name='_mono
next=Icpitembatch.CPIfElse
frm_calc=[
'_mono = 1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='1
len=15
name='_contacicli
obj='Var
obj_type='N
pag=4
prev=O1324
var_op='asgn
I
obj='If
pag=4
prev=O1323
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1324
fatherSonIndex=0
frm_calc=[
'_tot = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1330
fatherSonIndex=0
frm_calc='0
len=15
name='_cicli
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1330
fatherSonIndex=1
frm_calc='1
len=15
name='_cicli
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1324
fatherSonIndex=1
frm_calc='_max - _min
name='_reccount
next=Icpitembatch.CPVarDecl
frm_calc='iif(Mod(_reccount,1000) <> 0,Int(_reccount/1000) + 1,Int(_reccount/1000))
len=15
name='_cicli
obj='Var
obj_type='N
pag=4
prev=O1340
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1094
fatherSonIndex=0
frm_calc='0
len=1
name='_mono
next=Icpitembatch.CPVarDecl
frm_calc='''
len=100
name='_oldmsg
obj='Var
pag=4
prev=O1346
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1087
fatherSonIndex=0
frm_calc='0
len=15
name='_max
next=Icpitembatch.CPVarDecl
frm_calc='0
len=15
name='_min
next=Icpitembatch.CPVarDecl
frm_calc='0
len=15
name='_tot
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=4
par_expr=[
'_dataini
'_datafin
'0
]
par_name=[
'_dadata
'_adata
'_inviato
]
prev=O1354
sel_name='qbe_famperiodo_opx_min_max
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1355
fatherSonIndex=0
frm_calc='qbe_famperiodo_opx_min_max->MINPRG
len=15
name='_min
next=Icpitembatch.CPVarDecl
frm_calc='qbe_famperiodo_opx_min_max->MAXPRG
len=15
name='_max
next=Icpitembatch.CPVarDecl
frm_calc='qbe_famperiodo_opx_min_max->TOTPRG
len=15
name='_tot
obj='Var
obj_type='N
pag=4
prev=O1362
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1361
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O1353
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1352
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
x=14
y=18
I
Icpitembatch.CPBeginEnd
comment='Legge i dati e effettua le chiusure
h=[
19
19
]
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1366
fatherSonIndex=0
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Inizio Elaborazione Chiusure '+w_annoc+"-"+w_mese+" :"+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPBeginEnd
comment='Ordinario - Chiusure
h=[
19
19
]
obj='Begin
pag=5
prev=O1371
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1372
fatherSonIndex=0
frm_calc='Date()
len=8
name='_datamin
next=Icpitembatch.CPVarDecl
frm_calc='arfn_finemese(arfn_datesum(_datafin,1))
len=8
name='_datamax
next=Icpitembatch.CPVarDecl
frm_calc='iif(_datamin > _datamax,'S','O')
len=1
name='_tipinvioc
next=Icpitembatch.CPIfElse
frm_calc=[
'w_annoc='2020' and At(_mese,'|02|03|04') > 0 and Date() <= CharToDate('20200630')
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Attendere. Estrazione dati per il periodo ..."
global=True
len=120
name='gMsgImp
next=Ispitembatch.CPMemoryCursor
data_source='tmp_stpperiodo
mem_curs_name='mcTemp
next=Icpitembatch.CPVarDecl
frm_calc='mcTemp.RecCount()
len=10
name='_totrecord
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTemp.RecCount() > 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Fine Elaborazione Chiusure '+w_annoc+"-"+w_mese+" :"+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=5
prev=O1385
var_op='asgn
I
obj='If
pag=5
prev=O1384
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1385
fatherSonIndex=0
frm_calc=[
'_tipinvioc='O' or (_tipinvioc='S' and w_flagchiu='S')
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Sono stati generati '+LRTrim(Str(_conta,10,0))+" record" +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Fine controllo periodo: '+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=5
prev=O1394
var_op='asgn
I
nonlocal=True
obj='Var
pag=5
prev=O1391
var_op='asgn
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Azzera i cursori
father=O1391
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Apre il file di scrittura
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Crea Testata
h=[
19
19
]
next=Icpitembatch.CPForEach
for_variable='rowTemp
for_variable_type='tmp_stpperiodo
h=[
19
19
]
iterator_expr='mcTemp
next=Icpitembatch.CPBeginEnd
comment='Crea Piede
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPInsert
arch='aesaldi
next=Icpitembatch.CPIfElse
frm_calc=[
'_nosid=0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_sid.IsEmpty()
]
h=[
19
19
]
obj='If
pag=5
prev=O1410
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Azzera se avevo scritto qualcosa
father=O1413
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Inizio Aggiornamento Dati: '+arfn_fdatetime(DateTime())+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_oldmsg
next=Icpitembatch.CPForEach
for_variable='rowSID1
for_variable_type='sid_invio1
h=[
19
19
]
iterator_expr='mcSID1
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgdett='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + NL + 'Ora Fine Aggiornamento Dati: '+arfn_fdatetime(DateTime())+NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1425
var_op='asgn
I
obj='If
pag=5
prev=O1423
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O1425
fatherSonIndex=0
for_variable='rowSID2
for_variable_type='sid_invio2
h=[
19
19
]
iterator_expr='mcSID2
obj='ForEach
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sid_invio2
father=O1431
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'CODINVIO2
'RAPINVIO2
'APRINVIO2
'INIINVIO2
'FININVIO2
'FCFINVIO2
'CFSINVIO2
'RUOINVIO2
'COGINVIO2
'NOMINVIO2
'DNSINVIO2
'CNSINVIO2
'PNSINVIO2
'RGSINVIO2
'CSLINVIO2
'PLSINVIO2
'SEXINVIO2
]
rd_kvar=[
'rowSID2.CODINVIO2
'rowSID2.RAPINVIO2
'rowSID2.APRINVIO2
'rowSID2.INIINVIO2
'rowSID2.FININVIO2
'rowSID2.FCFINVIO2
'rowSID2.CFSINVIO2
'rowSID2.RUOINVIO2
'rowSID2.COGINVIO2
'rowSID2.NOMINVIO2
'rowSID2.DNSINVIO2
'rowSID2.CNSINVIO2
'rowSID2.PNSINVIO2
'rowSID2.RGSINVIO2
'rowSID2.CSLINVIO2
'rowSID2.PLSINVIO2
'rowSID2.SEXINVIO2
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=5
prev=O1422
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1423
fatherSonIndex=0
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Sto aggiornando l'operazione " + LRTrim(Str(_conta,10,0)) + " su " + LRTrim(Str(_totrecord,10,0))
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_oldmsg)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='"Sto aggiornando l'operazione " + LRTrim(Str(_conta,10,0)) + " su " + LRTrim(Str(_totrecord,10,0))
len=10
name='_oldmsg
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgstp='N'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Sto aggiornando il rapporto: "+rowSID1.RAPINVIO1
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='aetesta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Ho aggiornato l'operazione " + LRTrim(Str(_conta,10,0)) + " su " + LRTrim(Str(_totrecord,10,0))
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_oldmsg)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gMsgImp)
len=10
name='_oldmsg
obj='Var
obj_type='M
pag=5
prev=O1454
var_op='asgn
I
obj='If
pag=5
prev=O1453
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O1454
fatherSonIndex=0
frm_calc='gMsgProc + LRTrim(gMsgImp)
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O1454
fatherSonIndex=1
frm_calc='Strtran(gMsgProc,LRTrim(_oldmsg),LRTrim(gMsgImp))
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
pag=5
prev=O1452
var_op='asgn
I
obj='Write
pag=5
prev=O1451
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'DATAINVIOC
'INVIATOC
]
wr_op=[
'=
'=
]
wr_var=[
'Date()
'1
]
I
nonlocal=True
obj='Var
pag=5
prev=O1448
var_op='asgn
I
obj='If
pag=5
prev=O1447
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sid_invio1
father=O1448
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'CODINVIO1
'RAPINVIO1
'TPRINVIO1
'INIINVIO1
'FININVIO1
'TIPINVIO1
'TPCINVIO1
]
rd_kvar=[
'rowSID1.CODINVIO1
'rowSID1.RAPINVIO1
'rowSID1.TPRINVIO1
'rowSID1.INIINVIO1
'rowSID1.FININVIO1
'rowSID1.TIPINVIO1
'rowSID1.TPCINVIO1
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=5
prev=O1444
var_op='asgn
I
obj='If
pag=5
prev=O1443
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O1444
fatherSonIndex=0
frm_calc='gMsgProc + LRTrim(gMsgImp)
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O1444
fatherSonIndex=1
frm_calc='Strtran(gMsgProc,LRTrim(_oldmsg),LRTrim(gMsgImp))
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
pag=5
prev=O1442
var_op='asgn
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=5
prev=O1421
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1420
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1418
var_op='asgn
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='sid_invio1
father=O1418
fatherSonIndex=0
obj='Delete
pag=5
rd_kfield=[
'CODINVIO1
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1409
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1410
fatherSonIndex=0
frm_calc='arfn_exec_sid(_nomefile,w_annoc)
name='_sid
next=Icpitembatch.CPIfElse
frm_calc=[
'_sid.RecCount() > 0
]
h=[
19
19
]
obj='If
pag=5
prev=O1493
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O1494
fatherSonIndex=0
for_variable='rowErrore
for_variable_type='mcMessaggi.MCRDef
h=[
19
19
]
iterator_expr='_sid
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''Rilevati errori durante il controllo da parte del SID - Chiusure'
obj='Transaction
pag=5
prev=O1499
raise_on_trans_err=True
I
obj='ForEach
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O1499
fatherSonIndex=0
frm_calc='gMsgProc + LRTrim(rowErrore.testata) + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=5
prev=O1408
rd_kfield=[
'IDBASE
'NOMEFILE
'ANNO
'MESE
'TIPOINVIO
'TIPOCOMU
'CODINVIO
]
rd_kvar=[
'LibreriaMit.UniqueId()
'Left(_nomefile,50)
'w_annoc
'_mese
''1'
''5'
'_invio
]
I
obj='Exec
pag=5
prev=O1406
I
obj='Begin
pag=5
prev=O1404
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Scrive Ultima riga
father=O1406
fatherSonIndex=0
h=[
19
19
]
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1512
fatherSonIndex=0
frm_calc=''9'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo1,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo2,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo3,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo4,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + Space(360)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=5
prev=O1522
I
obj='Var
pag=5
prev=O1521
var_op='asgn
I
obj='Var
pag=5
prev=O1520
var_op='asgn
I
obj='Var
pag=5
prev=O1519
var_op='asgn
I
obj='Var
pag=5
prev=O1518
var_op='asgn
I
obj='Var
pag=5
prev=O1517
var_op='asgn
I
obj='Var
pag=5
prev=O1516
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=5
prev=O1402
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1404
fatherSonIndex=0
frm_calc=[
'not(Month(mcTemp.DATAINI) = Month(mcTemp.DATAFINE) and Year(mcTemp.DATAINI) = Year(mcTemp.DATAFINE))
]
h=[
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Record Tipo 1
father=O1528
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGAGESID\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProg
next=Icpitembatch.CPInsert
arch='aefaminvio
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati generati '+LRTrim(Str(_conta,10,0))+" record"
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=5
prev=O1537
var_op='asgn
I
obj='Insert
pag=5
prev=O1536
rd_kfield=[
'IDBASE
'TIPO
'TIPOINVIO
'ANNO
'MESE
'TIPOCOM
'RAPPORTO
'NOMEFILE
'PROG
'IDIDBASE
]
rd_kvar=[
'cProg
'rowTemp.TIPO
''1'
'w_annoc
'_mese
''5'
'rowTemp.RAPPORTO
'_nomefile
'_conta
'_invio
]
I
obj='Var
pag=5
prev=O1535
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1533
var_op='asgn
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Aggiorna codice Univoco
father=O1533
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_invio
frm_seek='CODINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.RAPPORTO
frm_seek='RAPINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.TIPOAG
frm_seek='TPRINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAINI
frm_seek='INIINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAFINE
frm_seek='FININVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='iif(w_flagchiu='S','2','1')
frm_seek='TIPINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc=''5'
frm_seek='TPCINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_unique
frm_seek='UNIQUE1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_newuc
frm_seek='FLGUNQ1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowSID1
frm_seek='AppendRow
name='mcSID1
next=Icpitembatch.CPVarDecl
frm_calc='_tipo1 + 1
len=9
name='_tipo1
next=Icpitembatch.CPBeginEnd
comment='Scrive la riga
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgdett='S'
]
h=[
19
19
]
obj='If
pag=5
prev=O1556
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1558
fatherSonIndex=0
frm_calc='arfn_fam_mesefile02(rowSID1,_dataini,_datafin,rowTemp.TIPO)
name='mcSID2r
next=Icpitembatch.CPForEach
for_variable='rowSID2
for_variable_type='sid_invio2
h=[
19
19
]
iterator_expr='mcSID2r
obj='ForEach
pag=5
prev=O1563
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1564
fatherSonIndex=0
frm_calc='rowSID2
frm_seek='AppendRow
name='mcSID2
next=Icpitembatch.CPVarDecl
frm_calc='_tipo2 + 1
len=9
name='_tipo2
obj='Var
obj_type='N
pag=5
prev=O1568
var_op='asgn
I
obj='Var
obj_type='MC
pag=5
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
prev=O1555
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1556
fatherSonIndex=0
frm_calc=''1'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowTemp.TIPOAG),2)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowTemp.TIPOAG='99',LibreriaMit.SpacePad(LRTrim(Upper(arfn_agechar(rowTemp.DESCRAP,' '))),24),Space(24))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + arfn_fdate_nd(rowTemp.DATAINI,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowTemp.TIPOAG='98' or Empty(rowTemp.DATAFINE),'01010001',arfn_fdate_nd(rowTemp.DATAFINE,'N'))
len=398
name='_riga
next=Icpitembatch.CPCase
frm_calc=[
'At(rowTemp.TIPOAG,"01;02;03;12;13") <> 0
'At(rowTemp.TIPOAG,"96;97;") <> 0
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(13)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(286)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=5
prev=O1585
I
obj='Var
pag=5
prev=O1584
var_op='asgn
I
obj='Var
pag=5
prev=O1583
var_op='asgn
I
obj='Var
pag=5
prev=O1580
var_op='asgn
I
obj='Case
pag=5
prev=O1579
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1580
fatherSonIndex=0
frm_calc='_riga + iif(Empty(LRTrim(rowTemp.CAB)),LibreriaMit.SpacePad(LRTrim(_cabinter),5),LibreriaMit.SpacePad(LRTrim(rowTemp.CAB),5))
len=398
name='_riga
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1580
fatherSonIndex=1
frm_calc='''
len=3
name='_ison
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_ison),5)
len=398
name='_riga
obj='Var
pag=5
prev=O1592
var_op='asgn
I
obj='Read
pag=5
prev=O1591
rd_field=[
'ISON
]
rd_kfield=[
'ISO
]
rd_kvar=[
'rowTemp.ISOAGE
]
rd_var=[
'_ison
]
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1580
fatherSonIndex=2
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowTemp.CAB),5)
len=398
name='_riga
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=5
prev=O1578
var_op='asgn
I
obj='Var
pag=5
prev=O1577
var_op='asgn
I
obj='Var
pag=5
prev=O1576
var_op='asgn
I
obj='Var
pag=5
prev=O1575
var_op='asgn
I
obj='Var
pag=5
prev=O1574
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1554
var_op='asgn
I
obj='Var
obj_type='MC
pag=5
prev=O1553
var_op='meth
I
obj='Var
obj_type='R
pag=5
prev=O1552
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1551
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1550
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1549
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1548
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1547
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1546
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1545
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1543
var_op='prop
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1543
fatherSonIndex=0
frm_calc='arfn_agechar(LRTrim(rowTemp.UNIQUECODE),"_")
len=50
name='_unique
next=Icpitembatch.CPVarDecl
frm_calc=''N'
len=1
name='_newuc
obj='Var
pag=5
prev=O1604
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
prev=O1400
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1402
fatherSonIndex=0
frm_calc='_invio
frm_seek='CODINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='iif(w_flagchiu='S','2','1')
frm_seek='TIPINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc=''5'
frm_seek='TPCINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='w_annoc
frm_seek='ANNINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='w_mese
frm_seek='MESINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='_nomefile
frm_seek='FLEINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='rowSID0
frm_seek='AppendRow
name='mcSID0
next=Icpitembatch.CPDelete
arch='sid_invio
next=Icpitembatch.CPInsert
arch='sid_invio
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_crea
next=Icpitembatch.CPBeginEnd
comment='Scrive testata
h=[
19
19
]
obj='Begin
pag=5
prev=O1621
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1622
fatherSonIndex=0
frm_calc=''0'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'ARU00'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(w_flagchiu='S','2','1')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '5'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + w_annoc
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + w_mese
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(24)
len=398
name='_riga
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +'0'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + Space(112)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=5
prev=O1638
I
obj='Var
pag=5
prev=O1637
var_op='asgn
I
obj='Var
pag=5
prev=O1636
var_op='asgn
I
obj='Var
pag=5
prev=O1635
var_op='asgn
I
obj='Var
pag=5
prev=O1633
var_op='asgn
I
obj='Select
pag=5
prev=O1632
sel_field='*
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1633
fatherSonIndex=0
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(intermbo->CODFISC),16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(intermbo->CODCAB),5)
len=5
name='_cabinter
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(intermbo->CODFISC)) = 16
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1643
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O1644
fatherSonIndex=0
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->COGNOME,26)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->NOME,25)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->SESSO,1)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +arfn_fdate_nd(intermbo->DATANASC,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->NASCOMUN,40)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->PROVNA,2)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(112)
len=10
name='_riga
obj='Var
obj_type='M
pag=5
prev=O1654
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O1653
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O1652
var_op='asgn
I
obj='Var
pag=5
prev=O1651
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O1650
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O1649
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O1644
fatherSonIndex=1
frm_calc='_riga +Space(102)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(intermbo->RAGSOC,' '),70)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(intermbo->DESCCIT,' '),40)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->PROVINCIA,2)
len=10
name='_riga
obj='Var
obj_type='M
pag=5
prev=O1659
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O1658
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O1657
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=5
prev=O1642
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1631
var_op='asgn
I
obj='Var
pag=5
prev=O1630
var_op='asgn
I
obj='Var
pag=5
prev=O1629
var_op='asgn
I
obj='Var
pag=5
prev=O1628
var_op='asgn
I
obj='Var
pag=5
prev=O1627
var_op='asgn
I
obj='Var
pag=5
prev=O1626
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1620
var_op='asgn
I
obj='Insert
pag=5
prev=O1619
rd_kfield=[
'CODINVIO
'TIPINVIO
'TPCINVIO
'DATINVIO
'ANNINVIO
'MESINVIO
'FLEINVIO
]
rd_kvar=[
'_invio
''1'
''5'
'Date()
'w_annoc
'w_mese
'_invio
]
I
obj='Delete
pag=5
prev=O1618
rd_kfield=[
'CODINVIO
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='Var
obj_type='MC
pag=5
prev=O1617
var_op='meth
I
obj='Var
obj_type='R
pag=5
prev=O1616
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1615
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1614
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1613
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1612
var_op='prop
I
obj='Var
obj_type='R
pag=5
var_op='prop
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
prev=O1398
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1400
fatherSonIndex=0
frm_calc='iif(w_flagchiu='S',w_annoc+w_mese+'_2_5',w_annoc+w_mese+'_1_5')
len=10
name='_invio
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gIntemediario)+"_"+_invio+"_"+DateTimeToChar(DateTime())
len=10
name='_nomefile
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWritePath(LRTrim(gPathDoc)+'/SID/INVII/DAP/'+LRTrim(gAzienda)+"/"+LRTrim(_nomefile))
len=10
name='fhand
next=Icpitembatch.CPInsert
arch='tmp_list_imprich
obj='Insert
pag=5
prev=O1674
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
'_invio
'_nomefile
]
I
obj='Var
pag=5
prev=O1673
var_op='asgn
I
obj='Var
pag=5
prev=O1672
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1398
fatherSonIndex=0
frm_seek='Zap
name='mcSID0
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID1
obj='Var
obj_type='MC
pag=5
prev=O1681
var_op='meth
I
obj='Var
obj_type='MC
pag=5
var_op='meth
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O1385
fatherSonIndex=1
frm_calc='gMsgProc + 'Non ci sono chiusure per il periodo considerato: '+arfn_fdate(_dataini)+" - " +arfn_fdate(_datafin)+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1383
var_op='asgn
I
obj='MemoryCursor
pag=5
par_expr=[
'_dataini
'_datafin
]
par_name=[
'_dadata
'_adata
]
prev=O1382
sel_name='qbe_fam_chiudi_aui
I
nonlocal=True
obj='Var
pag=5
prev=O1379
var_op='asgn
I
obj='If
pag=5
prev=O1378
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1379
fatherSonIndex=0
frm_calc=''O'
len=1
name='_tipinvioc
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1377
var_op='asgn
I
obj='Var
obj_type='D
pag=5
prev=O1376
var_op='asgn
I
obj='Var
obj_type='D
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=5
prev=O1370
var_op='asgn
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
x=12
y=16
I
Icpitembatch.CPBeginEnd
comment='Legge i dati e effettua le verifiche
h=[
19
19
]
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1696
fatherSonIndex=0
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='_contarighe
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_numfile
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Inizio Elaborazione Modifiche '+w_annoc+"-"+w_mese+' : '+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPBeginEnd
comment='Straordinario - Rettifiche (2-2)
h=[
19
19
]
obj='Begin
pag=3
prev=O1703
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O1704
fatherSonIndex=0
frm_calc='"Attendere. Estrazione dati per il periodo ..."
global=True
len=120
name='gMsgImp
next=Ispitembatch.CPMemoryCursor
data_source='tmp_stpperiodo
mem_curs_name='mcTemp
next=Icpitembatch.CPVarDecl
frm_calc='mcTemp.RecCount()
len=10
name='_contarec
next=Icpitembatch.CPIfElse
frm_calc=[
'_contarec > 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Fine Elaborazione Modifiche 2015: '+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=3
prev=O1711
var_op='asgn
I
obj='If
pag=3
prev=O1710
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O1711
fatherSonIndex=0
for_variable='rowTemp
for_variable_type='tmp_stpperiodo
h=[
19
19
]
iterator_expr='mcTemp
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Sono stati generati '+LRTrim(Str(_conta,10,0))+" record" +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Fine controllo periodo: '+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=3
prev=O1719
var_op='asgn
I
nonlocal=True
obj='Var
pag=3
prev=O1717
var_op='asgn
I
obj='ForEach
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1717
fatherSonIndex=0
frm_calc=[
'_contarighe=1
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Record Tipo 1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fam_mesefile02(rowSID1,_dataini,_datafin,rowTemp.TIPO)
name='mcSID2r
next=Icpitembatch.CPForEach
for_variable='rowSID2
for_variable_type='sid_invio2
h=[
19
19
]
iterator_expr='mcSID2r
next=Icpitembatch.CPIfElse
frm_calc=[
'At(rowTemp.TIPOAG,"08;11;13;16;17;18;19;20;21;22;97,99") = 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGAGESID\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProg
next=Icpitembatch.CPInsert
arch='aefaminvio
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati generati '+LRTrim(Str(_conta,10,0))+" record"
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='_contarighe + 1
len=10
name='_contarighe
next=Icpitembatch.CPIfElse
frm_calc=[
'_contarighe=100000 or _conta=_contarec
]
h=[
19
19
]
obj='If
pag=3
prev=O1738
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Crea Piede
father=O1739
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPInsert
arch='aesaldi
next=Icpitembatch.CPIfElse
frm_calc=[
'_nosid=0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_sid.IsEmpty()
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='_contarighe
obj='Var
obj_type='N
pag=3
prev=O1751
var_op='asgn
I
obj='If
pag=3
prev=O1748
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Azzera se avevo scritto qualcosa
father=O1751
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPForEach
for_variable='rowSID1
for_variable_type='sid_invio1
h=[
19
19
]
iterator_expr='mcSID1
next=Icpitembatch.CPForEach
for_variable='rowSID2
for_variable_type='sid_invio2
h=[
19
19
]
iterator_expr='mcSID2
next=Icpitembatch.CPForEach
for_variable='rowSID3
for_variable_type='sid_invio3
h=[
19
19
]
iterator_expr='mcSID3
obj='ForEach
pag=3
prev=O1761
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sid_invio3
father=O1763
fatherSonIndex=0
obj='Insert
pag=3
rd_kfield=[
'CODINVIO3
'RAPINVIO3
'TPRINVIO3
'ANNINVIO3
'VALINVIO3
'NATINVIO3
'IM1INVIO3
'FI1INVIO3
'IM2INVIO3
'FI2INVIO3
'IM3INVIO3
'FI3INVIO3
'IM4INVIO3
'FI4INVIO3
'IM5INVIO3
'FI5INVIO3
'IM6INVIO3
'FI6INVIO3
]
rd_kvar=[
'rowSID3.CODINVIO3
'rowSID3.RAPINVIO3
'rowSID3.TPRINVIO3
'rowSID3.ANNINVIO3
'rowSID3.VALINVIO3
'rowSID3.NATINVIO3
'rowSID3.IM1INVIO3
'rowSID3.FI1INVIO3
'rowSID3.IM2INVIO3
'rowSID3.FI2INVIO3
'rowSID3.IM3INVIO3
'rowSID3.FI3INVIO3
'rowSID3.IM4INVIO3
'rowSID3.FI4INVIO3
'rowSID3.IM5INVIO3
'rowSID3.FI5INVIO3
'rowSID3.IM6INVIO3
'rowSID3.FI6INVIO3
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=3
prev=O1759
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sid_invio2
father=O1761
fatherSonIndex=0
obj='Insert
pag=3
rd_kfield=[
'CODINVIO2
'RAPINVIO2
'APRINVIO2
'INIINVIO2
'FININVIO2
'FCFINVIO2
'CFSINVIO2
'RUOINVIO2
'COGINVIO2
'NOMINVIO2
'DNSINVIO2
'CNSINVIO2
'PNSINVIO2
'RGSINVIO2
'CSLINVIO2
'PLSINVIO2
'SEXINVIO2
]
rd_kvar=[
'rowSID2.CODINVIO2
'rowSID2.RAPINVIO2
'rowSID2.APRINVIO2
'rowSID2.INIINVIO2
'rowSID2.FININVIO2
'rowSID2.FCFINVIO2
'rowSID2.CFSINVIO2
'rowSID2.RUOINVIO2
'rowSID2.COGINVIO2
'rowSID2.NOMINVIO2
'rowSID2.DNSINVIO2
'rowSID2.CNSINVIO2
'rowSID2.PNSINVIO2
'rowSID2.RGSINVIO2
'rowSID2.CSLINVIO2
'rowSID2.PLSINVIO2
'rowSID2.SEXINVIO2
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=3
prev=O1757
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sid_invio1
father=O1759
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'rowSID1.TPRINVIO1='98'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O1779
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O1780
fatherSonIndex=0
frm_calc='"Sto aggiornando l'operazione con codice: "+rowSID1.RAPINVIO1
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='opextrbo
obj='Write
pag=3
prev=O1785
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'DATAMODI
]
wr_op=[
'=
]
wr_var=[
'NullDate()
]
I
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O1780
fatherSonIndex=1
frm_calc='"Sto aggiornando il rapporto: "+rowSID1.RAPINVIO1
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='aetesta
obj='Write
pag=3
prev=O1794
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'DATAMODI
]
wr_op=[
'=
]
wr_var=[
'NullDate()
]
I
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=3
rd_kfield=[
'CODINVIO1
'RAPINVIO1
'TPRINVIO1
'INIINVIO1
'FININVIO1
'TIPINVIO1
'TPCINVIO1
'MODINVIO1
]
rd_kvar=[
'rowSID1.CODINVIO1
'rowSID1.RAPINVIO1
'rowSID1.TPRINVIO1
'rowSID1.INIINVIO1
'rowSID1.FININVIO1
'rowSID1.TIPINVIO1
'rowSID1.TPCINVIO1
'rowSID1.MODINVIO1
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='sid_invio3
father=O1757
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='sid_invio2
next=Icpitembatch.CPDelete
arch='sid_invio1
obj='Delete
pag=3
prev=O1809
rd_kfield=[
'CODINVIO1
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='Delete
pag=3
prev=O1808
rd_kfield=[
'CODINVIO2
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='Delete
pag=3
rd_kfield=[
'CODINVIO3
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1747
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1748
fatherSonIndex=0
frm_calc='arfn_exec_sid(_nomefile,w_annoc)
name='_sid
next=Icpitembatch.CPIfElse
frm_calc=[
'_sid.RecCount() > 0
]
h=[
19
19
]
obj='If
pag=3
prev=O1824
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O1825
fatherSonIndex=0
for_variable='rowErrore
for_variable_type='mcMessaggi.MCRDef
h=[
19
19
]
iterator_expr='_sid
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''Rilevati errori durante il controllo da parte del SID - Modifiche'
obj='Transaction
pag=3
prev=O1830
raise_on_trans_err=True
I
obj='ForEach
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O1830
fatherSonIndex=0
frm_calc='gMsgProc + LRTrim(rowErrore.testata) + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=3
prev=O1746
rd_kfield=[
'IDBASE
'NOMEFILE
'ANNO
'MESE
'TIPOINVIO
'TIPOCOMU
'CODINVIO
]
rd_kvar=[
'LibreriaMit.UniqueId()
'Left(_nomefile,50)
'w_annoc
'_mese
''2'
''2'
'_invio
]
I
obj='Exec
pag=3
prev=O1744
I
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Scrive Ultima riga
father=O1744
fatherSonIndex=0
h=[
19
19
]
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1843
fatherSonIndex=0
frm_calc=''9'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo1,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo2,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo3,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo4,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + Space(360)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=3
prev=O1853
I
obj='Var
pag=3
prev=O1852
var_op='asgn
I
obj='Var
pag=3
prev=O1851
var_op='asgn
I
obj='Var
pag=3
prev=O1850
var_op='asgn
I
obj='Var
pag=3
prev=O1849
var_op='asgn
I
obj='Var
pag=3
prev=O1848
var_op='asgn
I
obj='Var
pag=3
prev=O1847
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O1737
var_op='asgn
I
nonlocal=True
obj='Var
pag=3
prev=O1736
var_op='asgn
I
obj='Insert
pag=3
prev=O1735
rd_kfield=[
'IDBASE
'TIPO
'TIPOINVIO
'ANNO
'MESE
'TIPOCOM
'RAPPORTO
'NOMEFILE
'PROG
'IDIDBASE
'OLDDATA
]
rd_kvar=[
'cProg
'rowTemp.TIPO
''2'
''0000'
''00'
''2'
'rowTemp.RAPPORTO
'_nomefile
'_conta
'_invio
'rowTemp.DATAMODI
]
I
obj='Var
pag=3
prev=O1734
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1731
var_op='asgn
I
obj='If
pag=3
prev=O1729
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1731
fatherSonIndex=0
frm_calc=[
'rowTemp.TIPOAG <> '98'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fam_mesefile03(rowSID1,_asaldi,rowTemp.TIPO,rowTemp.VALUTA)
name='mcSID3r
next=Icpitembatch.CPForEach
for_variable='rowSID3
for_variable_type='sid_invio3
h=[
19
19
]
iterator_expr='mcSID3r
obj='ForEach
pag=3
prev=O1865
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1866
fatherSonIndex=0
frm_calc='rowSID3
frm_seek='AppendRow
name='mcSID3
next=Icpitembatch.CPVarDecl
frm_calc='_tipo3 + 1
len=9
name='_tipo3
next=Icpitembatch.CPVarDecl
frm_calc=''3'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + rowTemp.TIPOAG
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.ANNINVIO3,4,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM1INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM1INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM1INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI1INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM2INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM2INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM2INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI2INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM3INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM3INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM3INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI3INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM4INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM4INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM4INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI4INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM5INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM5INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM5INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI5INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM6INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM6INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM6INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI6INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + rowTemp.VALUTA
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowSID3.NATINVIO3),2)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(227)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=3
prev=O1891
I
obj='Var
pag=3
prev=O1890
var_op='asgn
I
obj='Var
pag=3
prev=O1889
var_op='asgn
I
obj='Var
pag=3
prev=O1888
var_op='asgn
I
obj='Var
pag=3
prev=O1887
var_op='asgn
I
obj='Var
pag=3
prev=O1886
var_op='asgn
I
obj='Var
pag=3
prev=O1885
var_op='asgn
I
obj='Var
pag=3
prev=O1884
var_op='asgn
I
obj='Var
pag=3
prev=O1883
var_op='asgn
I
obj='Var
pag=3
prev=O1882
var_op='asgn
I
obj='Var
pag=3
prev=O1881
var_op='asgn
I
obj='Var
pag=3
prev=O1880
var_op='asgn
I
obj='Var
pag=3
prev=O1879
var_op='asgn
I
obj='Var
pag=3
prev=O1878
var_op='asgn
I
obj='Var
pag=3
prev=O1877
var_op='asgn
I
obj='Var
pag=3
prev=O1876
var_op='asgn
I
obj='Var
pag=3
prev=O1875
var_op='asgn
I
obj='Var
pag=3
prev=O1874
var_op='asgn
I
obj='Var
pag=3
prev=O1873
var_op='asgn
I
obj='Var
pag=3
prev=O1872
var_op='asgn
I
obj='Var
pag=3
prev=O1871
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1870
var_op='asgn
I
obj='Var
obj_type='MC
pag=3
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=3
prev=O1862
var_op='asgn
I
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1862
fatherSonIndex=0
frm_calc='iif(Date() <= gScadSaldi,Year(Date())-2,Year(Date())-1)
len=4
name='_asaldi
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1862
fatherSonIndex=1
frm_calc=[
'(Year(Date()) -Year(rowTemp.DATAINI)=1 and Date() <= gScadSaldi) or (Year(Date()) -Year(rowTemp.DATAINI)=0)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1898
fatherSonIndex=0
frm_calc='0
len=4
name='_asaldi
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1898
fatherSonIndex=1
frm_calc='Year(rowTemp.DATAINI)
len=4
name='_asaldi
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=3
prev=O1728
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1729
fatherSonIndex=0
frm_calc='rowSID2
frm_seek='AppendRow
name='mcSID2
next=Icpitembatch.CPVarDecl
frm_calc='_tipo2 + 1
len=9
name='_tipo2
next=Icpitembatch.CPBeginEnd
comment='Scrive la riga
h=[
19
19
]
obj='Begin
pag=3
prev=O1912
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1913
fatherSonIndex=0
frm_calc=''2'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(rowSID2.APRINVIO2,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + arfn_fdate_nd(rowSID2.INIINVIO2,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowTemp.TIPO='O','01010001',arfn_fdate_nd(rowSID2.FININVIO2,'N'))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID2.FCFINVIO2,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowSID2.CFSINVIO2),16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + rowSID2.RUOINVIO2
len=398
name='_riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(rowSID2.SEXINVIO2))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(99)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=3
prev=O1929
I
obj='Var
pag=3
prev=O1928
var_op='asgn
I
obj='Var
pag=3
prev=O1925
var_op='asgn
I
obj='If
pag=3
prev=O1924
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O1925
fatherSonIndex=0
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(rowSID2.COGINVIO2,' '),26)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(rowSID2.NOMINVIO2,' '),25)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(rowSID2.SEXINVIO2,1)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +arfn_fdate_nd(rowSID2.DNSINVIO2,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(arfn_agechar(rowSID2.CNSINVIO2,' ')),40)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(rowSID2.PNSINVIO2,2)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(102)
len=398
name='_riga
obj='Var
pag=3
prev=O1938
var_op='asgn
I
obj='Var
pag=3
prev=O1937
var_op='asgn
I
obj='Var
pag=3
prev=O1936
var_op='asgn
I
obj='Var
pag=3
prev=O1935
var_op='asgn
I
obj='Var
pag=3
prev=O1934
var_op='asgn
I
obj='Var
pag=3
prev=O1933
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O1925
fatherSonIndex=1
frm_calc='_riga +Space(102)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(arfn_agechar(rowSID2.RGSINVIO2,' ')),60)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(arfn_agechar(rowSID2.CSLINVIO2,' ')),40)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(rowSID2.PLSINVIO2),2)
len=398
name='_riga
obj='Var
pag=3
prev=O1943
var_op='asgn
I
obj='Var
pag=3
prev=O1942
var_op='asgn
I
obj='Var
pag=3
prev=O1941
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=3
prev=O1923
var_op='asgn
I
obj='Var
pag=3
prev=O1922
var_op='asgn
I
obj='Var
pag=3
prev=O1921
var_op='asgn
I
obj='Var
pag=3
prev=O1920
var_op='asgn
I
obj='Var
pag=3
prev=O1919
var_op='asgn
I
obj='Var
pag=3
prev=O1918
var_op='asgn
I
obj='Var
pag=3
prev=O1917
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O1911
var_op='asgn
I
obj='Var
obj_type='MC
pag=3
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=3
prev=O1726
var_op='asgn
I
obj='Begin
pag=3
prev=O1723
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Aggiorna codice Univoco
father=O1726
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_invio
frm_seek='CODINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.RAPPORTO
frm_seek='RAPINVIO1
name='rowSID1
next=Icpitembatch.CPCase
frm_calc=[
'At(rowTemp.TIPOAG,"01;02;03;12;13") <> 0
'At(rowTemp.TIPOAG,"96;97;") <> 0
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.TIPOAG
frm_seek='TPRINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAINI
frm_seek='INIINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAFINE
frm_seek='FININVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc=''2'
frm_seek='TIPINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc=''2'
frm_seek='TPCINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_unique
frm_seek='UNIQUE1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_newuc
frm_seek='FLGUNQ1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAMODI
frm_seek='MODINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowSID1
frm_seek='AppendRow
name='mcSID1
next=Icpitembatch.CPVarDecl
frm_calc='_tipo1 + 1
len=9
name='_tipo1
next=Icpitembatch.CPBeginEnd
comment='Scrive la riga
h=[
19
19
]
obj='Begin
pag=3
prev=O1966
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1967
fatherSonIndex=0
frm_calc=''1'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowTemp.TIPOAG),2)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowTemp.TIPOAG='99',LibreriaMit.SpacePad(LRTrim(Upper(arfn_agechar(rowTemp.DESCRAP,' '))),24),Space(24))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + arfn_fdate_nd(rowTemp.DATAINI,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowTemp.TIPO='O','01010001',arfn_fdate_nd(rowTemp.DATAFINE,'N'))
len=398
name='_riga
next=Icpitembatch.CPCase
frm_calc=[
'At(rowTemp.TIPOAG,"01;02;03;12;13") <> 0
'At(rowTemp.TIPOAG,"96;97;") <> 0
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(_tipinvio='2' and not(Empty(rowTemp.IDESITO)), LibreriaMit.SpacePad(LRTrim(rowTemp.IDESITO),13),Space(13))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(286)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=3
prev=O1982
I
obj='Var
pag=3
prev=O1981
var_op='asgn
I
obj='Var
pag=3
prev=O1980
var_op='asgn
I
obj='Var
pag=3
prev=O1977
var_op='asgn
I
obj='Case
pag=3
prev=O1976
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1977
fatherSonIndex=0
frm_calc='_riga + iif(Empty(LRTrim(rowTemp.CAB)),LibreriaMit.SpacePad(LRTrim(_cabinter),5),LibreriaMit.SpacePad(LRTrim(rowTemp.CAB),5))
len=398
name='_riga
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1977
fatherSonIndex=1
frm_calc='''
len=3
name='_ison
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_ison),5)
len=398
name='_riga
obj='Var
pag=3
prev=O1989
var_op='asgn
I
obj='Read
pag=3
prev=O1988
rd_field=[
'ISON
]
rd_kfield=[
'ISO
]
rd_kvar=[
'rowTemp.ISOAGE
]
rd_var=[
'_ison
]
I
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1977
fatherSonIndex=2
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowTemp.CAB),5)
len=398
name='_riga
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=3
prev=O1975
var_op='asgn
I
obj='Var
pag=3
prev=O1974
var_op='asgn
I
obj='Var
pag=3
prev=O1973
var_op='asgn
I
obj='Var
pag=3
prev=O1972
var_op='asgn
I
obj='Var
pag=3
prev=O1971
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O1965
var_op='asgn
I
obj='Var
obj_type='MC
pag=3
prev=O1964
var_op='meth
I
obj='Var
obj_type='R
pag=3
prev=O1963
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O1962
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O1961
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O1960
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O1959
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O1958
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O1957
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O1954
var_op='prop
I
obj='Case
pag=3
prev=O1953
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1954
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(rowTemp.CAB)),LRTrim(_cabinter),LRTrim(rowTemp.CAB))
frm_seek='CABINVIO1
name='rowSID1
obj='Var
obj_type='R
pag=3
var_op='prop
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1954
fatherSonIndex=1
frm_calc='''
len=3
name='_ison
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPVarDecl
frm_calc='_ison
frm_seek='CABINVIO1
name='rowSID1
obj='Var
obj_type='R
pag=3
prev=O2004
var_op='prop
I
obj='Read
pag=3
prev=O2003
rd_field=[
'ISON
]
rd_kfield=[
'ISO
]
rd_kvar=[
'rowTemp.ISOAGE
]
rd_var=[
'_ison
]
I
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1954
fatherSonIndex=2
frm_calc='rowTemp.CAB
frm_seek='CABINVIO1
name='rowSID1
obj='Var
obj_type='R
pag=3
var_op='prop
I
I
]
w=[
150
150
150
150
]
I
obj='Var
obj_type='R
pag=3
prev=O1952
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O1950
var_op='prop
I
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1950
fatherSonIndex=0
frm_calc='arfn_agechar(LRTrim(rowTemp.UNIQUECODE),"_")
len=50
name='_unique
next=Icpitembatch.CPVarDecl
frm_calc=''N'
len=1
name='_newuc
obj='Var
pag=3
prev=O2015
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1723
fatherSonIndex=0
frm_calc='_numfile + 1
len=1
name='_numfile
next=Icpitembatch.CPBeginEnd
comment='Azzera i cursori
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Apre il file di scrittura
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Crea Testata
h=[
19
19
]
obj='Begin
pag=3
prev=O2024
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2026
fatherSonIndex=0
frm_calc='_invio
frm_seek='CODINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc=''2'
frm_seek='TIPINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc=''2'
frm_seek='TPCINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='w_annoc
frm_seek='ANNINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='_mese
frm_seek='MESINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='_nomefile
frm_seek='FLEINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='rowSID0
frm_seek='AppendRow
name='mcSID0
next=Icpitembatch.CPDelete
arch='sid_invio
next=Icpitembatch.CPInsert
arch='sid_invio
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_crea
next=Icpitembatch.CPBeginEnd
comment='Scrive testata
h=[
19
19
]
obj='Begin
pag=3
prev=O2039
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2040
fatherSonIndex=0
frm_calc=''0'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'ARU00'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '2'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '2'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '0000'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '00'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(24)
len=398
name='_riga
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +'0'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + Space(112)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=3
prev=O2056
I
obj='Var
pag=3
prev=O2055
var_op='asgn
I
obj='Var
pag=3
prev=O2054
var_op='asgn
I
obj='Var
pag=3
prev=O2053
var_op='asgn
I
obj='Var
pag=3
prev=O2051
var_op='asgn
I
obj='Select
pag=3
prev=O2050
sel_field='*
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2051
fatherSonIndex=0
frm_calc='_riga + LibreriaMit.SpacePad(Upper(LRTrim(intermbo->CODFISC)),16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(intermbo->CODFISC)
len=16
name='_cfinter
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(intermbo->CODCAB),5)
len=5
name='_cabinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->FLGSIDAUTO
len=1
name='_nosid
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(intermbo->CODFISC)) = 16
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O2063
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O2064
fatherSonIndex=0
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->COGNOME,26)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->NOME,25)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->SESSO,1)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +arfn_fdate_nd(intermbo->DATANASC,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->NASCOMUN,40)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->PROVNA,2)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(112)
len=10
name='_riga
obj='Var
obj_type='M
pag=3
prev=O2074
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O2073
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O2072
var_op='asgn
I
obj='Var
pag=3
prev=O2071
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O2070
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O2069
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O2064
fatherSonIndex=1
frm_calc='_riga +Space(102)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(intermbo->RAGSOC,' '),70)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(intermbo->DESCCIT,' '),40)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->PROVINCIA,2)
len=10
name='_riga
obj='Var
obj_type='M
pag=3
prev=O2079
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O2078
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O2077
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O2062
var_op='asgn
I
obj='Var
pag=3
prev=O2061
var_op='asgn
I
obj='Var
pag=3
prev=O2060
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O2049
var_op='asgn
I
obj='Var
pag=3
prev=O2048
var_op='asgn
I
obj='Var
pag=3
prev=O2047
var_op='asgn
I
obj='Var
pag=3
prev=O2046
var_op='asgn
I
obj='Var
pag=3
prev=O2045
var_op='asgn
I
obj='Var
pag=3
prev=O2044
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O2038
var_op='asgn
I
obj='Insert
pag=3
prev=O2037
rd_kfield=[
'CODINVIO
'TIPINVIO
'TPCINVIO
'DATINVIO
'ANNINVIO
'MESINVIO
'FLEINVIO
]
rd_kvar=[
'_invio
''2'
''2'
'Date()
''0000'
''00'
'_nomefile
]
I
obj='Delete
pag=3
prev=O2036
rd_kfield=[
'CODINVIO
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='Var
obj_type='MC
pag=3
prev=O2035
var_op='meth
I
obj='Var
obj_type='R
pag=3
prev=O2034
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2033
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2032
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2031
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2030
var_op='prop
I
obj='Var
obj_type='R
pag=3
var_op='prop
I
I
]
w=[
150
150
]
I
obj='Begin
pag=3
prev=O2022
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2024
fatherSonIndex=0
frm_calc='w_annoc+w_mese+'_2_2_'+Str(_numfile,1,0)
len=10
name='_invio
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gIntemediario)+"_"+_invio+"_"+DateTimeToChar(DateTime())
len=10
name='_nomefile
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWritePath(LRTrim(gPathDoc)+'/SID/INVII/DAP/'+LRTrim(gAzienda)+"/"+LRTrim(_nomefile))
len=10
name='fhand
next=Icpitembatch.CPInsert
arch='tmp_list_imprich
obj='Insert
pag=3
prev=O2094
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
'_invio
'_nomefile
]
I
obj='Var
pag=3
prev=O2093
var_op='asgn
I
obj='Var
pag=3
prev=O2092
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=3
prev=O2021
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2022
fatherSonIndex=0
frm_seek='Zap
name='mcSID0
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID1
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID2
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID2r
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID3
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID3r
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo1
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo2
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo3
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo4
obj='Var
obj_type='N
pag=3
prev=O2109
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O2108
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O2107
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O2106
var_op='asgn
I
obj='Var
obj_type='MC
pag=3
prev=O2105
var_op='meth
I
obj='Var
obj_type='MC
pag=3
prev=O2104
var_op='meth
I
obj='Var
obj_type='MC
pag=3
prev=O2103
var_op='meth
I
obj='Var
obj_type='MC
pag=3
prev=O2102
var_op='meth
I
obj='Var
obj_type='MC
pag=3
prev=O2101
var_op='meth
I
obj='Var
obj_type='MC
pag=3
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O1711
fatherSonIndex=1
frm_calc='gMsgProc + 'Non ci sono modifiche per il periodo considerato: '+arfn_fdate(_dataini)+" - " +arfn_fdate(_datafin)+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O1709
var_op='asgn
I
obj='MemoryCursor
pag=3
par_expr=[
'_dataini
'_datafin
]
par_name=[
'_dadata
'_adata
]
prev=O1708
sel_name='qbe_fam_periodo05
I
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=3
prev=O1702
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1701
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1700
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
x=16
y=18
I
Icpitembatch.CPBeginEnd
comment='Cancella i file vecchi
h=[
19
19
]
obj='Begin
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O2121
fatherSonIndex=0
frm_calc='// Legge i file degli esiti﷯File di = new File(CPLib.LRTrim(gPathDoc)+"/SID/INVII/DAP/"+CPLib.LRTrim(gAzienda)+"/");﷯File fl[] = di.listFiles();﷯int _i;﷯int count=0;﷯for (_i=0; _i < fl.length; _i++)  {﷯  fl[_i].delete();﷯}﷯di = new File(CPLib.LRTrim(gPathDoc)+"/SID/INVII/PRE/"+CPLib.LRTrim(gAzienda)+"/");﷯File fl1[] = di.listFiles();﷯count=0;﷯for (_i=0; _i < fl1.length; _i++)  {﷯  fl1[_i].delete();﷯}
obj='Exec
pag=7
I
I
]
w=[
150
150
]
x=15
y=27
I
Icpitembatch.CPVarDecl
frm_calc='w_annoc+_mese+"_"+_tipinvio+"_1"
len=10
name='_invio
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gIntemediario)+"_"+_invio+"_"+DateTimeToChar(DateTime())
len=10
name='_nomefile
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWritePath(LRTrim(gPathDoc)+'/SID/INVII/DAP/'+LRTrim(gAzienda)+"/"+LRTrim(_nomefile))
len=10
name='fhand
obj='Var
pag=1
prev=O2128
var_op='asgn
I
obj='Var
pag=1
prev=O2127
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
x=887
y=4038
I
Icpitembatch.CPExec
check='man
frm_calc='// Create a buffer for reading the files﷯    byte[] buf = new byte[1024];﷯    ﷯    try {﷯        // Create the ZIP file﷯        String outFilename = cNomeFileZip;﷯        java.util.zip.ZipOutputStream out = new java.util.zip.ZipOutputStream(new java.io.FileOutputStream(outFilename));﷯    ﷯        // Compress the files﷯        for (int i=0; i<filenames.size(); i++) {﷯            _file1=(String)filenames.elementAt(i);﷯            _file2=(String)fileonames.elementAt(i);﷯            java.io.FileInputStream in = new java.io.FileInputStream(_file1);﷯    ﷯            // Add ZIP entry to output stream.﷯            out.putNextEntry(new java.util.zip.ZipEntry(_file2));﷯    ﷯            // Transfer bytes from the file to the ZIP file﷯            int len;﷯            while ((len = in.read(buf)) > 0) {﷯                out.write(buf, 0, len);﷯            }﷯    ﷯            // Complete the entry﷯            out.closeEntry();﷯            in.close();﷯        }﷯    ﷯        // Complete the ZIP file﷯        out.close();﷯        filenames.removeAllElements();﷯        fileonames.removeAllElements();﷯    } catch (java.io.IOException e) {﷯    }﷯
obj='Exec
pag=8
x=13
y=16
I
]
ManualBlocks={
'BO - Header
Icpmanualblocks.CPManualBlocks
code='import java.io.*;﷯import java.util.*;
name='BO - Header
I
'BO - Properties
Icpmanualblocks.CPManualBlocks
code='public int _r;﷯Vector filenames = new Vector();﷯Vector fileonames = new Vector();﷯public byte[] buffer;
name='BO - Properties
I
}
comment='Lancia la creazione dei file SID per il periodo
date_creat=#2016-03-01
date_rev=#2024-04-30
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'FileLibMit
'Utilities
'LibreriaMit
]
modcnt=279
page_result_class=[
'
'
'
'
'
'
'
'
]
page_result_type=[
'U
'U
'U
'U
'U
'U
'U
'U
]
page_uid=[
'ZBJRUTRGEM
'WUQMDVOIKS
'ZVAAMYAXSC
'PCJYYHNAJH
'RLWJUUNFCU
'BHJPFBFXSM
'ZPGXSRRYPM
'SCUSOGDDDD
]
pagename=[
'Page_1
'Page_2
'Page_3
'Page_4
'Page_5
'Page_6
'Page_7
'Page_8
]
pagenote=[
'
'
'
'
'
'
'
'
]
pagetitle=[
'Main
'Nuovi Rapporti
'Modifiche
'Operazioni Extraconto
'Chiusure
'Cancellazioni
'Cancella File in DAP
'Crea lo zip in caso di assenza SID
]
runtime_filters=2
tpl_name='Function
work_file=[
'aesaldi
'aetesta
'intermbo
'opextrbo
'sid_invio
'sid_invio1
'sid_invio2
'sid_invio3
'sid_invio4
'tmp_listafile
'tmp_list_imprich
'aefaminvio
'anarapbo
'tbstati
]
work_filter=[
'
'
'
'
'
'
'
'
]
I
*--*
*----*
