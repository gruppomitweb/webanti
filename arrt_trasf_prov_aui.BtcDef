* --- CodePainter Revolution Batch Vers. 5.1
￼Icpbatch.CPBatch
Items=[
Icpitembatch.CPIfElse
frm_calc=[
'_conta<>0
'_conta=0
]
h=[
19
19
19
]
next=Ispitembatch.CPReturn
lnk_expr=True
lnk_op='start
lnk_page='_nomereport
lnk_type='report
lnk_values=[
'_rotate
'_reportname
'w_c_dadataope
'w_c_adataope
'w_c_dadatareg
'w_c_adatareg
'w_c_dadataret
'w_c_adataret
'w_CONNES
'w_Dipendenza
'w_OrderBy
'_tipo_arch
'_fonte_arch
'False
'gDescAzi
'w_Stato
]
lnk_vars=[
'rotation
'FileName
'w_c_dadataope
'w_c_adataope
'w_c_dadatareg
'w_c_adatareg
'w_c_dadataret
'w_c_adataret
'w_CodCli
'w_CodDip
'w_OrderBy
'tipo_arch
'fonte_arch
'showParameterMask
'DescAzi
'stato
]
obj='Return
pag=1
page_return=Nil
prev=O3
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
comment='Stampa positiva
instr=Icpitembatch.CPVarDecl
father=O3
fatherSonIndex=0
frm_calc=''|PDF|XLS|XLSX|CSV'
len=20
name='_ftypes
next=Icpitembatch.CPVarDecl
frm_calc=''PORTRAIT'
len=20
name='_rotate
next=Icpitembatch.CPVarDecl
comment='Dettaglio Anagrafico
frm_calc=''arrp_stpfraz_sa.vrp'
len=50
name='_nomereport
obj='Var
pag=1
prev=O12
var_op='asgn
I
obj='Var
pag=1
prev=O11
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='Stampa negativa
instr=Icpitembatch.CPVarDecl
father=O3
fatherSonIndex=1
frm_calc=''PDF'
len=20
name='_ftypes
next=Icpitembatch.CPVarDecl
frm_calc=''PORTRAIT'
len=20
name='_rotate
next=Icpitembatch.CPVarDecl
comment='stampa negativa (non ci sono elementi da mostrare)
frm_calc=''arrp_stpoper_neg.vrp'
len=50
name='_nomereport
obj='Var
pag=1
prev=O16
var_op='asgn
I
obj='Var
pag=1
prev=O15
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
x=1817
y=308
I
Icpitembatch.CPBeginEnd
comment='Dichiarazione Variabili del caller
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Dichiarazione variabili globali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Definizione Variabili Locali OPERAZIONI
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Dichiarazione variabili ELIA
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_date_oggi
next=Icpitembatch.CPVarDecl
frm_seek='mcErrMCF.MCRDef
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc=''Ora Inizio Trasferimento: '+ arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Trasferimento: '+ arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'mcErrori.RecCount()=0
'mcErrori.RecCount()=1 and _aborted
'mcErrori.RecCount()>0 and not(_aborted)
]
h=[
19
19
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cActLog='S'
]
h=[
19
19
]
next=Ispitembatch.CPReturn
frm_calc='mcErrori
obj='Return
pag=1
prev=O37
I
obj='If
pag=1
prev=O34
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='bat
father=O37
fatherSonIndex=0
frm_calc='arrt_writelog("Trasferimento AUI",iif(pSource='o','Operazioni',iif(pSource='f','Frazionate',iif(pSource='r','Rapporti','Legami'))),'',gMsgProc)
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O33
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O34
fatherSonIndex=0
frm_seek='AppendBlank
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='""
frm_seek='ERCODICE
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='"TRASFERIMENTO AVVENUTO SENZA ERRORI  "
frm_seek='ERDESCRI
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcErrori
obj='Var
obj_type='MC
pag=1
prev=O49
var_op='meth
I
obj='Var
obj_type='MC
pag=1
prev=O48
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O47
var_op='prop
I
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O34
fatherSonIndex=1
frm_calc='"Elaborazione Terminata. Trasferimento abortito."
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O34
fatherSonIndex=2
frm_calc='"Elaborazione Terminata con presenza di anomalie. Prelevare il file generato"
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O31
var_op='asgn
I
obj='Try
pag=1
prev=O30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O31
fatherSonIndex=0
frm_calc=[
'pSource="o"
'pSource="f"
'pSource="r"
'pSource="t"
]
h=[
19
19
19
19
19
]
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=1
prev=O58
I
obj='Case
pag=1
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPBeginEnd
comment='Caricamento dati per i controlli
father=O58
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPExec
check='page
frm_calc='2
next=Icpitembatch.CPForEach
for_variable='rwImp
for_variable_type='storico_import
h=[
19
19
]
iterator_expr='mcNumimp_incontrati
obj='ForEach
pag=1
prev=O66
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O67
fatherSonIndex=0
frm_calc=[
'not(arfn_delete_import_numimp_check(rwImp.NUMIMP))
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='storico_import
father=O71
fatherSonIndex=0
obj='Delete
pag=1
rd_kfield=[
'NUMIMP
]
rd_kop=[
'=
]
rd_kvar=[
'rwImp.NUMIMP
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=1
prev=O64
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O64
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='""
name='_tmp
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=1
prev=O86
sel_field='xperazbo->NUMIMP
sel_group='xperazbo->NUMIMP
sel_name='xperazbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='MC di NUMIMP che ho incontrato lungo il trasferimento (possono essere più di uno)
father=O87
fatherSonIndex=0
frm_seek='AppendBlank
name='mcNumimp_incontrati
next=Icpitembatch.CPVarDecl
comment='MC di NUMIMP che ho incontrato lungo il trasferimento (possono essere più di uno)
frm_calc='xperazbo->NUMIMP
frm_seek='NUMIMP
name='mcNumimp_incontrati
obj='Var
obj_type='MC
pag=1
prev=O91
var_op='prop
I
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O84
var_op='asgn
I
obj='Select
pag=1
sel_name='QBE_TBCAUANA
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O84
fatherSonIndex=0
frm_seek='mcStringa.MCRDef
name='rwCauana
next=Icpitembatch.CPVarDecl
comment='uso come chiave la concatenazione di: causale_analitica+causale_sintetica+segno    es. "15"+"6S"+"D" = "156SD"
frm_calc='""+LRTrim(QBE_TBCAUANA->CODCAU)+LRTrim(QBE_TBCAUANA->CAUSINT)+LRTrim(QBE_TBCAUANA->SEGNO)
name='_tmp
next=Icpitembatch.CPVarDecl
frm_calc='_tmp
frm_seek='CODICE
name='rwCauana
next=Icpitembatch.CPVarDecl
frm_calc='QBE_TBCAUANA->idbase
frm_seek='ps_rowstatus
name='rwCauana
next=Icpitembatch.CPIfElse
frm_calc=[
'not(mcCauana.HasKey(_tmp))
]
h=[
19
19
]
obj='If
pag=1
prev=O99
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='MC dei codici Causali Analitiche+Sintetiche+Segno
father=O100
fatherSonIndex=0
frm_calc='_tmp,rwCauana 
frm_seek='AppendRowWithKey
name='mcCauana
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='R
pag=1
prev=O98
var_op='prop
I
obj='Var
obj_type='R
pag=1
prev=O97
var_op='prop
I
obj='Var
pag=1
prev=O96
var_op='asgn
I
obj='Var
obj_type='R
pag=1
var_op='new
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPSelect
father=O58
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='""
name='_tmp
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPExec
check='page
frm_calc='3
next=Icpitembatch.CPForEach
for_variable='rwImp
for_variable_type='storico_import
h=[
19
19
]
iterator_expr='mcNumimp_incontrati
obj='ForEach
pag=1
prev=O115
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O116
fatherSonIndex=0
frm_calc=[
'not(arfn_delete_import_numimp_check(rwImp.NUMIMP))
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='storico_import
father=O120
fatherSonIndex=0
obj='Delete
pag=1
rd_kfield=[
'NUMIMP
]
rd_kop=[
'=
]
rd_kvar=[
'rwImp.NUMIMP
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=1
prev=O113
I
obj='Select
pag=1
prev=O112
sel_field='xraziobo->NUMIMP
sel_group='xraziobo->NUMIMP
sel_name='xraziobo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='MC di NUMIMP che ho incontrato lungo il trasferimento (possono essere più di uno)
father=O113
fatherSonIndex=0
frm_seek='AppendBlank
name='mcNumimp_incontrati
next=Icpitembatch.CPVarDecl
comment='MC di NUMIMP che ho incontrato lungo il trasferimento (possono essere più di uno)
frm_calc='xraziobo->NUMIMP
frm_seek='NUMIMP
name='mcNumimp_incontrati
obj='Var
obj_type='MC
pag=1
prev=O133
var_op='prop
I
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O110
var_op='asgn
I
obj='Select
pag=1
sel_name='QBE_TBCAUANA
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O110
fatherSonIndex=0
frm_seek='mcStringa.MCRDef
name='rwCauana
next=Icpitembatch.CPVarDecl
comment='uso come chiave la concatenazione di: causale_analitica+causale_sintetica+segno    es. "15"+"6S"+"D" = "156SD"
frm_calc='""+LRTrim(QBE_TBCAUANA->CODCAU)+LRTrim(QBE_TBCAUANA->CAUSINT)+LRTrim(QBE_TBCAUANA->SEGNO)
name='_tmp
next=Icpitembatch.CPVarDecl
frm_calc='_tmp
frm_seek='CODICE
name='rwCauana
next=Icpitembatch.CPVarDecl
frm_calc='QBE_TBCAUANA->idbase
frm_seek='ps_rowstatus
name='rwCauana
next=Icpitembatch.CPIfElse
frm_calc=[
'not(mcCauana.HasKey(_tmp))
]
h=[
19
19
]
obj='If
pag=1
prev=O141
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='MC dei codici Causali Analitiche+Sintetiche+Segno
father=O142
fatherSonIndex=0
frm_calc='_tmp,rwCauana 
frm_seek='AppendRowWithKey
name='mcCauana
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='R
pag=1
prev=O140
var_op='prop
I
obj='Var
obj_type='R
pag=1
prev=O139
var_op='prop
I
obj='Var
pag=1
prev=O138
var_op='asgn
I
obj='Var
obj_type='R
pag=1
var_op='new
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O58
fatherSonIndex=2
frm_calc='4
next=Icpitembatch.CPExec
check='page
frm_calc='5
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=1
prev=O152
sel_field='storico_import->NUMIMP
sel_name='storico_import
sel_where='[NOTEMPTYDATE(ELIM_IMP)]=0
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O153
fatherSonIndex=0
frm_calc=[
'not(arfn_delete_import_numimp_check(storico_import->NUMIMP))
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='storico_import
father=O157
fatherSonIndex=0
obj='Delete
pag=1
rd_kfield=[
'NUMIMP
]
rd_kop=[
'=
]
rd_kvar=[
'storico_import->NUMIMP
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=1
prev=O151
I
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O58
fatherSonIndex=3
frm_calc='6
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=1
prev=O169
sel_field='storico_import->NUMIMP
sel_name='storico_import
sel_where='[NOTEMPTYDATE(ELIM_IMP)]=0
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O170
fatherSonIndex=0
frm_calc=[
'not(arfn_delete_import_numimp_check(storico_import->NUMIMP))
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='storico_import
father=O174
fatherSonIndex=0
obj='Delete
pag=1
rd_kfield=[
'NUMIMP
]
rd_kop=[
'=
]
rd_kvar=[
'storico_import->NUMIMP
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=1
I
I
]
w=[
150
150
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O31
fatherSonIndex=1
frm_calc='True
len=1
name='_aborted
next=Icpitembatch.CPVarDecl
frm_seek='AppendBlank
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='""
frm_seek='ERCODICE
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='"Il trasferimento è stato bloccato!"+NL+NL+'Errore SQL: ' + m_Sql.TransactionErrorMessage()
frm_seek='ERDESCRI
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Errore SQL: ' + m_Sql.TransactionErrorMessage() + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Elaborazione Terminata con errori Non è stata trasferita alcuna operazione"
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPTransaction
frm_calc='rollback
obj='Transaction
pag=1
prev=O193
I
nonlocal=True
obj='Var
pag=1
prev=O192
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O191
var_op='asgn
I
obj='Var
obj_type='MC
pag=1
prev=O190
var_op='meth
I
obj='Var
obj_type='MC
pag=1
prev=O189
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O188
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O187
var_op='meth
I
obj='Var
obj_type='L
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=1
prev=O29
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O28
var_op='asgn
I
obj='Var
obj_type='MC
pag=1
prev=O27
var_op='new
I
obj='Var
obj_type='D
pag=1
prev=O25
var_op='asgn
I
obj='Begin
pag=1
prev=O23
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O25
fatherSonIndex=0
len=8
name='_date_oggi
next=Icpitembatch.CPVarDecl
frm_calc='iif(pDoCheck="N",False,True)
len=1
name='fai_controlli
next=Icpitembatch.CPVarDecl
frm_calc='""
name='_error_string
next=Icpitembatch.CPVarDecl
frm_calc='0
name='_conta_err
next=Icpitembatch.CPVarDecl
comment='mc errori generico
frm_seek='mcErrMCF.MCRDef
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_aborted
next=Icpitembatch.CPVarDecl
len=1
name='_passato_il_check
next=Icpitembatch.CPVarDecl
len=1
name='_passato_il_sub_check
next=Icpitembatch.CPVarDecl
name='_tmp
next=Icpitembatch.CPVarDecl
comment='MC dei codici Causali Analitiche+Sintetiche+Segno
frm_seek='mcStringa.MCRDef
name='mcCauana
next=Icpitembatch.CPVarDecl
frm_seek='mcStringa.MCRDef
name='rwCauana
next=Icpitembatch.CPVarDecl
comment='MC di NUMIMP che ho incontrato lungo il trasferimento (possono essere più di uno)
frm_seek='storico_import
name='mcNumimp_incontrati
next=Icpitembatch.CPVarDecl
frm_seek='storico_import
name='rwNumimp
obj='Var
obj_type='R
pag=1
prev=O209
I
obj='Var
obj_type='MC
pag=1
prev=O208
I
obj='Var
obj_type='R
pag=1
prev=O207
I
obj='Var
obj_type='MC
pag=1
prev=O206
I
obj='Var
pag=1
prev=O205
I
obj='Var
obj_type='L
pag=1
prev=O204
I
obj='Var
obj_type='L
pag=1
prev=O203
I
obj='Var
obj_type='L
pag=1
prev=O202
I
obj='Var
obj_type='MC
pag=1
prev=O201
I
obj='Var
obj_type='N
pag=1
prev=O200
I
obj='Var
pag=1
prev=O199
I
obj='Var
obj_type='L
pag=1
prev=O198
I
obj='Var
obj_type='D
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O21
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O23
fatherSonIndex=0
len=10
name='cProg1
next=Icpitembatch.CPVarDecl
len=11
name='cProg2
next=Icpitembatch.CPVarDecl
len=10
name='cProg3
next=Icpitembatch.CPVarDecl
len=10
name='cIDB2
next=Icpitembatch.CPVarDecl
len=10
name='w_idbase
next=Icpitembatch.CPVarDecl
len=10
name='_conta
next=Icpitembatch.CPVarDecl
len=10
name='_contano
next=Icpitembatch.CPVarDecl
len=8
name='w_cdaope
next=Icpitembatch.CPVarDecl
len=8
name='w_c_aope
next=Icpitembatch.CPVarDecl
len=8
name='w_cdareg
next=Icpitembatch.CPVarDecl
len=8
name='w_c_areg
next=Icpitembatch.CPVarDecl
len=8
name='w_datreg
next=Icpitembatch.CPVarDecl
len=25
name='w_RAPPORTO
next=Icpitembatch.CPVarDecl
len=10
name='_min
next=Icpitembatch.CPVarDecl
len=10
name='_max
next=Icpitembatch.CPVarDecl
len=10
name='_tot
next=Icpitembatch.CPVarDecl
len=10
name='_cicli
next=Icpitembatch.CPVarDecl
len=10
name='_contacicli
next=Icpitembatch.CPVarDecl
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
len=15
name='_top
next=Icpitembatch.CPVarDecl
len=8
name='_maxreg
next=Icpitembatch.CPVarDecl
len=8
name='_minreg
next=Icpitembatch.CPVarDecl
len=10
name='idb2
next=Icpitembatch.CPVarDecl
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
len=10
name='_idrif
next=Icpitembatch.CPVarDecl
len=10
name='_totale
next=Icpitembatch.CPVarDecl
len=8
name='w_DaDatOpe
next=Icpitembatch.CPVarDecl
len=8
name='w_ADatOpe
next=Icpitembatch.CPVarDecl
len=1
name='w_flgforce
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
len=10
name='_crap
next=Icpitembatch.CPVarDecl
len=10
name='_cinf
next=Icpitembatch.CPVarDecl
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_seek='xnarapbo
name='mcRapporti
next=Icpitembatch.CPVarDecl
len=3
name='_contarow
next=Icpitembatch.CPVarDecl
len=25
name='_rapporto
next=Icpitembatch.CPVarDecl
len=11
name='_numprog
next=Icpitembatch.CPVarDecl
len=10
name='_maxdel
next=Icpitembatch.CPVarDecl
len=8
name='_flgdatareg
next=Icpitembatch.CPVarDecl
len=11
name='_oldprog
next=Icpitembatch.CPVarDecl
len=11
name='_nprog
next=Icpitembatch.CPVarDecl
len=8
name='_datafine
next=Icpitembatch.CPVarDecl
len=1
name='_nx
next=Icpitembatch.CPVarDecl
len=1
name='_sx
obj='Var
obj_type='N
pag=1
prev=O256
I
obj='Var
obj_type='N
pag=1
prev=O255
I
obj='Var
obj_type='D
pag=1
prev=O254
I
obj='Var
pag=1
prev=O253
I
obj='Var
pag=1
prev=O252
I
obj='Var
obj_type='N
pag=1
prev=O251
I
obj='Var
obj_type='N
pag=1
prev=O250
I
obj='Var
pag=1
prev=O249
I
obj='Var
pag=1
prev=O248
I
obj='Var
obj_type='N
pag=1
prev=O247
I
obj='Var
obj_type='MC
pag=1
prev=O246
I
obj='Var
obj_type='D
pag=1
prev=O245
I
obj='Var
obj_type='N
pag=1
prev=O244
I
obj='Var
obj_type='N
pag=1
prev=O243
I
obj='Var
obj_type='N
pag=1
prev=O242
I
obj='Var
pag=1
prev=O241
I
obj='Var
obj_type='D
pag=1
prev=O240
I
obj='Var
obj_type='D
pag=1
prev=O239
I
obj='Var
obj_type='N
pag=1
prev=O238
I
obj='Var
pag=1
prev=O237
I
obj='Var
obj_type='D
pag=1
prev=O236
I
obj='Var
pag=1
prev=O235
I
obj='Var
obj_type='D
pag=1
prev=O234
I
obj='Var
obj_type='D
pag=1
prev=O233
I
obj='Var
obj_type='N
pag=1
prev=O232
I
obj='Var
obj_type='N
pag=1
prev=O231
I
obj='Var
obj_type='N
pag=1
prev=O230
I
obj='Var
obj_type='N
pag=1
prev=O229
I
obj='Var
obj_type='N
pag=1
prev=O228
I
obj='Var
obj_type='N
pag=1
prev=O227
I
obj='Var
obj_type='N
pag=1
prev=O226
I
obj='Var
pag=1
prev=O225
I
obj='Var
pag=1
prev=O224
I
obj='Var
pag=1
prev=O223
I
obj='Var
pag=1
prev=O222
I
obj='Var
pag=1
prev=O221
I
obj='Var
pag=1
prev=O220
I
obj='Var
obj_type='N
pag=1
prev=O219
I
obj='Var
obj_type='N
pag=1
prev=O218
I
obj='Var
pag=1
prev=O217
I
obj='Var
pag=1
prev=O216
I
obj='Var
pag=1
prev=O215
I
obj='Var
pag=1
prev=O214
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O19
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Azienda
father=O21
fatherSonIndex=0
global=True
len=10
name='gAzienda
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='Messaggio
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Forza Data Trasferimento Provvisorie
global=True
len=1
name='gFlgDTP
next=Icpitembatch.CPVarDecl
comment='Dipendenza
global=True
len=6
name='gCodDip
next=Icpitembatch.CPVarDecl
comment='Log Applicazione
global=True
len=1
name='cActLog
nonlocal=True
obj='Var
pag=1
prev=O265
I
nonlocal=True
obj='Var
pag=1
prev=O264
I
nonlocal=True
obj='Var
obj_type='N
pag=1
prev=O263
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O262
I
nonlocal=True
obj='Var
pag=1
prev=O261
I
nonlocal=True
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O19
fatherSonIndex=0
len=8
name='pDatIni
next=Icpitembatch.CPVarDecl
len=8
name='pDatFin
next=Icpitembatch.CPVarDecl
len=1
name='pForza
next=Icpitembatch.CPVarDecl
comment='annotazioni varie / Rifimp esteso (9X)
len=30
name='pInform
next=Icpitembatch.CPVarDecl
comment='Sorgente della chiamata (o=opera, f=fraz, r=rapp, i=informazioni)
name='pSource
next=Icpitembatch.CPVarDecl
comment='S = Si, N = No (Default = S) 
name='pDoCheck
obj='Var
pag=1
param=True
prev=O274
I
obj='Var
pag=1
param=True
prev=O273
I
obj='Var
pag=1
param=True
prev=O272
I
obj='Var
pag=1
param=True
prev=O271
I
obj='Var
obj_type='D
pag=1
param=True
prev=O270
I
obj='Var
obj_type='D
pag=1
param=True
I
I
]
w=[
150
150
]
x=14
y=19
I
Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=3
par_expr=[
'w_cdaope
'w_c_aope
'pInform
]
par_name=[
'w_cdaope
'w_c_aope
'pInform
]
sel_name='qbe_trasffra_controllo_totale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O277
fatherSonIndex=0
frm_calc='qbe_trasffra_controllo_totale->TOTALE
len=10
name='_totale
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
x=725
y=319
I
Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Selezionare il flag Forza Trasferimento in caso si voglia comunque proseguire' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
x=1080
y=3486
I
Icpitembatch.CPRemark
frm_calc='Scorre la query e trasferisce i dati
next=Icpitembatch.CPBeginEnd
h=[
19
19
]
obj='Begin
pag=4
prev=O286
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O287
fatherSonIndex=0
frm_calc='0
len=10
name='_crap
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_cinf
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPForEach
for_variable='rowRapporto
for_variable_type='xnarapbo
h=[
19
19
]
iterator_expr='mcRapporti
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + "Sono stati trasferiti "+LRTrim(Str(_crap,10,0))+" rapporti" + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'_conta_err>0
]
h=[
19
19
]
obj='If
pag=4
prev=O297
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O298
fatherSonIndex=0
frm_calc='gMsgProc + 'Bloccati '+LRTrim(Str(_conta_err,10,0))+" rapporti per anomalie riscontrate. Consultare la stampa dei errori" + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O295
var_op='asgn
I
obj='ForEach
pag=4
prev=O293
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O295
fatherSonIndex=0
frm_calc='Elimino i soli rapporti trasferiti
next=Icpitembatch.CPDelete
arch='xnarapbo
obj='Delete
pag=4
prev=O307
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowRapporto.RAPPORTO
]
I
obj='Remark
pag=4
I
I
]
w=[
150
150
]
I
obj='Select
pag=4
prev=O292
sel_field='*
sel_name='xnarapbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O293
fatherSonIndex=0
frm_calc='True 
len=1
name='_passato_il_check
next=Icpitembatch.CPIfElse
frm_calc=[
'fai_controlli
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_passato_il_check
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
prev=O316
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O319
fatherSonIndex=0
frm_calc=[
'Empty(xnarapbo->CODDIPE) or xnarapbo->CODDIPE=gCodDip or Empty(gCodDip)
]
h=[
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O324
fatherSonIndex=0
frm_calc='_crap + 1
len=10
name='_crap
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Trasferimento dati base del rapporto: '+xnarapbo->RAPPORTO
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_seek='AppendBlank
name='mcRapporti
next=Icpitembatch.CPVarDecl
frm_calc='xnarapbo->RAPPORTO
frm_seek='RAPPORTO
name='mcRapporti
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcRapporti
next=Icpitembatch.CPVarDecl
frm_calc='xnarapbo->RAPPORTO
len=25
name='_rapporto
next=Icpitembatch.CPMerge
arch='anarapbo
next=Icpitembatch.CPWrite
arch='knarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'xnarapbo->NOPROT<>1
]
h=[
19
19
]
obj='If
pag=4
prev=O337
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O338
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PROGAET\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aetesta
obj='Insert
pag=4
prev=O343
rd_kfield=[
'RAPPORTO
'TIPOAG
'COINT
'DESCRI
'VALUTA
'PROGAET
'RIFANA
]
rd_kvar=[
'xnarapbo->RAPPORTO
'xnarapbo->TIPOAG
'iif(xnarapbo->TIPORAP='1','1','2')
'iif(xnarapbo->TIPOAG='99',Upper(Left(xnarapbo->DESCRAP,24)),'')
'xnarapbo->VALUTA
'nProgImp
''A'
]
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Write
pag=4
prev=O336
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xnarapbo->RAPPORTO
]
wr_field=[
'TIPORAP
'FLAGRAP
]
wr_op=[
'=
'=
]
wr_var=[
''D'
'xnarapbo->TIPORAP
]
I
obj='Merge
pag=4
prev=O335
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xnarapbo->RAPPORTO
]
wr_field=[
'AREAGEO
'CONTINUA
'DATAMOD
'DESCRAP
'DOCFILE
'FLAGLIRE
'IDBASE
'IDRAPPORTO
'MODSVOL
'NATURA
'NOPROT
'PRGIMPRAP
'RAGIO
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'TIPMOD
'TIPO
'TIPOAG
'TIPORAP
'VALUTA
'IMPAPE
'IMPCHIU
'SPLITCODE
'MACODICE
'CODDIP
'CODICELR
'MITIG
'MITGDOC
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
'CODDIPE
'DAC6
'FLAGDAC6
'IBAN
'CODOGG
'RISGLOB
'DATAPROF
'DATAREVPROF
'NOCANC
]
wr_mode=[
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xnarapbo->AREAGEO
'xnarapbo->CONTINUA
'xnarapbo->DATAMOD
'xnarapbo->DESCRAP
'xnarapbo->DOCFILE
'xnarapbo->FLAGLIRE
'xnarapbo->IDBASE
'xnarapbo->IDRAPPORTO
'xnarapbo->MODSVOL
'xnarapbo->NATURA
'xnarapbo->NOPROT
'nProgImp
'xnarapbo->RAGIO
'xnarapbo->RAPPORTO
'xnarapbo->RAREA
'xnarapbo->RCOMP
'xnarapbo->RFREQ
'xnarapbo->RIMP
'xnarapbo->RRAGIO
'xnarapbo->RTIPO
'xnarapbo->SCOPO
'xnarapbo->TIPMOD
'xnarapbo->TIPO
'xnarapbo->TIPOAG
'xnarapbo->TIPORAP
'xnarapbo->VALUTA
'xnarapbo->IMPAPE
'xnarapbo->IMPCHIU
'xnarapbo->SPLITCODE
'xnarapbo->MACODICE
'xnarapbo->CODDIP
'xnarapbo->CODICELR
'xnarapbo->MITIG
'xnarapbo->MITGDOC
'xnarapbo->CATEG01
'xnarapbo->CATEG02
'xnarapbo->CATEG03
'xnarapbo->CATEG04
'xnarapbo->CATEG05
'xnarapbo->CATEGORIA
'xnarapbo->CODDIP
'xnarapbo->DAC6
'xnarapbo->FLAGDAC6
'xnarapbo->IBAN
'xnarapbo->CODOGG
'xnarapbo->RISGLOB
'xnarapbo->DATAPROF
'xnarapbo->DATAREVPROF
'xnarapbo->NOCANC
]
I
obj='Var
pag=4
prev=O334
var_op='asgn
I
obj='Var
obj_type='MC
pag=4
prev=O333
var_op='meth
I
obj='Var
obj_type='MC
pag=4
prev=O332
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O331
var_op='meth
I
obj='Var
obj_type='N
pag=4
prev=O330
var_op='asgn
I
nonlocal=True
obj='Var
pag=4
prev=O329
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O319
fatherSonIndex=1
frm_calc='Check non passato :(
next=Icpitembatch.CPVarDecl
frm_calc='_conta_err+1
name='_conta_err
next=Icpitembatch.CPVarDecl
frm_seek='AppendBlank
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='xnarapbo->RAPPORTO
frm_seek='ERCODICE
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='_error_string
frm_seek='ERDESCRI
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcErrori
obj='Var
obj_type='MC
pag=4
prev=O367
var_op='meth
I
obj='Var
obj_type='MC
pag=4
prev=O366
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O365
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O364
var_op='meth
I
obj='Var
obj_type='N
pag=4
prev=O363
var_op='asgn
I
obj='Remark
pag=4
I
I
]
w=[
150
150
150
]
I
obj='If
pag=4
prev=O315
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='controlli vari
father=O316
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Substr(_error_string,2,Len(_error_string)-2)+"."
name='_error_string
obj='Var
pag=4
prev=O372
var_op='asgn
I
obj='Begin
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O372
fatherSonIndex=0
frm_calc='''
name='_error_string
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xnarapbo->RAPPORTO)
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='xnarapbo->TIPORAP
name='_tmp
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_tmp) or (_tmp<>"0" and _tmp<>"1" and _tmp<>"2" and _tmp<>"3")
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='""
name='_tmp
obj='Var
pag=4
prev=O382
var_op='asgn
I
obj='If
pag=4
prev=O381
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O382
fatherSonIndex=0
frm_calc='_error_string+ " anomalia Tipo Rapporto,"+NL
name='_error_string
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_passato_il_check
obj='Var
obj_type='L
pag=4
prev=O388
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
prev=O378
var_op='asgn
I
obj='If
pag=4
prev=O377
sons=[
Icpitembatch.CPItemSon
comment='Data Operazione più vecchia di 20 Anni
instr=Icpitembatch.CPVarDecl
father=O378
fatherSonIndex=0
frm_calc='' non presente il Codice Rapporto,'
name='_error_string
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_passato_il_check
obj='Var
obj_type='L
pag=4
prev=O393
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='L
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O291
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=4
x=11
y=16
I
Icpitembatch.CPRemark
frm_calc='Scorre la query e trasferisce i dati
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Selezione record da elaborare..."
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(w_DaDatOpe) or DateToChar(w_DaDatOpe)='01000101','',DateToChar(w_DaDatOpe))
len=8
name='w_cdaope
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(w_ADatOpe) or DateToChar(w_ADatOpe)='01000101','',DateToChar(w_ADatOpe))
len=8
name='w_c_aope
next=Icpitembatch.CPVarDecl
frm_calc='''
len=8
name='w_cdareg
next=Icpitembatch.CPVarDecl
frm_calc='''
len=8
name='w_c_areg
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
h=[
19
19
]
obj='Begin
pag=5
prev=O406
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O408
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Elaborazione Terminata con successo. Trasferite "+LRTrim(Str(_conta,10,0))+" - Escluse "+LRTrim(Str(_contano,10,0))+" informazioni"
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'_conta_err>0
]
h=[
19
19
]
obj='If
pag=5
prev=O414
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O415
fatherSonIndex=0
frm_calc='gMsgProc + 'Bloccate '+LRTrim(Str(_conta_err,10,0))+" informazioni per anomalie riscontrate. Consultare la stampa dei errori" + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=5
prev=O412
var_op='asgn
I
obj='Select
pag=5
par_expr=[
'w_cdaope
'w_c_aope
'w_cdareg
'w_c_areg
]
par_name=[
'w_cdaope
'w_c_aope
'w_cdareg
'w_c_areg
]
sel_name='qbe_trasfinfo_datope
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O412
fatherSonIndex=0
frm_calc='DateToChar(qbe_trasfinfo_datope->DATAOPE)
len=8
name='w_datreg
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_tot < 5000
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='_contacicli
next=Icpitembatch.CPWhile
frm_calc='_contacicli<=_cicli
h=[
19
19
]
obj='While
pag=5
prev=O432
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O433
fatherSonIndex=0
frm_calc=[
'_cicli = 1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Lettura informazioni in corso ... Ciclo N. '+LRTrim(Str(_contacicli,10,0))
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'_top>=_min
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_contacicli+1
len=10
name='_contacicli
obj='Var
obj_type='N
pag=5
prev=O441
var_op='asgn
I
obj='If
pag=5
prev=O440
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O441
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_name='qbe_trasfinfo_idbase_inf
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O447
fatherSonIndex=0
frm_calc='qbe_trasfinfo_idbase_inf->IDBASE
len=10
name='w_idbase
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_passato_il_check
]
h=[
19
19
]
obj='If
pag=5
prev=O452
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O454
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_field='rapopebo->DATAOPE,rapopebo->TIPOOPRAP
sel_name='rapopebo
sel_order='rapopebo->DATAOPE
sel_where='rapopebo->RAPPORTO= _rapporto and (rapopebo->STATOREG='0' or rapopebo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O459
fatherSonIndex=0
frm_calc=[
'At(rapopebo->TIPOOPRAP,'|26|36|38|43|44|46') > 0
'At(rapopebo->TIPOOPRAP,'|23|24|27|33|34|35|43|44|45') > 0
]
h=[
19
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='knarapbo
father=O463
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'_rapporto
]
wr_field=[
'DATAFIN
]
wr_op=[
'=
]
wr_var=[
'rapopebo->DATAOPE
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='knarapbo
father=O463
fatherSonIndex=1
obj='Write
pag=5
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'_rapporto
]
wr_field=[
'DATAINI
]
wr_op=[
'=
]
wr_var=[
'rapopebo->DATAOPE
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O451
sel_field='*
sel_name='xapopebo
sel_where='xapopebo->IDBASE=w_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O452
fatherSonIndex=0
frm_calc=[
'Empty(xapopebo->CODDIPE) or xapopebo->CODDIPE=gCodDip or Empty(gCodDip)
]
h=[
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O488
fatherSonIndex=0
frm_calc='True 
len=1
name='_passato_il_check
next=Icpitembatch.CPIfElse
frm_calc=[
'fai_controlli
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_passato_il_check
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O494
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O497
fatherSonIndex=0
frm_calc='''
len=25
name='_rapporto
next=Icpitembatch.CPRead
arch='anarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_rapporto)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O503
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O504
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cProg2
next=Icpitembatch.CPCase
frm_calc=[
'At(xapopebo->TIPOOPRAP,'|25|28|39|40|41|47') <> 0
'At(xapopebo->TIPOOPRAP,'|26|36|38|43|44|46') <> 0
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='cIDB2
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datareg
next=Icpitembatch.CPInsert
arch='rapopebo
next=Icpitembatch.CPDelete
arch='xapopebo
next=Icpitembatch.CPVarDecl
frm_calc='_conta + 1
len=10
name='_conta
obj='Var
obj_type='N
pag=5
prev=O517
var_op='asgn
I
obj='Delete
pag=5
prev=O516
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'w_idbase
]
I
obj='Insert
pag=5
prev=O515
rd_kfield=[
'AUTOM
'CAMBIO
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAAGE
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'IDEREG
'INFORM
'NUMPROG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PRGIMPINF
'PROV2
'PROVINCIA
'RAPPORTBEN
'RAPPORTO
'RESPINS
'SEGNO
'STATOREG
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'IDBASE2
'CONNALTRO
'FLAGTIT
]
rd_kvar=[
'xapopebo->AUTOM
'xapopebo->CAMBIO
'xapopebo->CDATOPE
'DateToChar(Date())
'xapopebo->CODANA
'xapopebo->CODCAB
'xapopebo->CODCAB2
'xapopebo->CODDIPE
'xapopebo->CODINT2
'xapopebo->CODINTER
'xapopebo->CODVOC
'xapopebo->COLLEG
'xapopebo->CONNESBEN
'xapopebo->CONNESCLI
'xapopebo->CONNESOPER
'xapopebo->DATAAGE
'xapopebo->DATAOPE
'_datareg
'xapopebo->DATARETT
'xapopebo->DESC2
'xapopebo->DESCCIT
'xapopebo->DESCINTER
'xapopebo->FLAGCONT
'xapopebo->FLAGFRAZ
'xapopebo->FLAGLIRE
'xapopebo->FLAGRAP
'xapopebo->FLAGRAP2
'cProg1
''I'+Right(cProg2,9)+cIDB2
'xapopebo->INFORM
'cProg2
'xapopebo->OPERATORE
'xapopebo->OPERAZMOD
'xapopebo->OPRAP
'xapopebo->PAESE
'xapopebo->PRGIMPINF
'xapopebo->PROV2
'xapopebo->PROVINCIA
'xapopebo->RAPPORTBEN
'xapopebo->RAPPORTO
'xapopebo->RESPINS
'xapopebo->SEGNO
'xapopebo->STATOREG
'xapopebo->TIPOINF
'xapopebo->TIPOINT2
'xapopebo->TIPOINTER
'xapopebo->TIPOLEG
'xapopebo->TIPOOPRAP
'xapopebo->TOTCONT
'xapopebo->TOTLIRE
'xapopebo->UCODE
'xapopebo->UNIQUECODE
'xapopebo->VALUTA
'cIDB2
'xapopebo->CONNALTRO
'xapopebo->FLAGTIT
]
I
obj='Var
obj_type='D
pag=5
prev=O514
var_op='asgn
I
obj='Var
pag=5
prev=O511
var_op='asgn
I
obj='Case
pag=5
prev=O510
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O511
fatherSonIndex=0
frm_calc=[
'At(xapopebo->TIPOOPRAP,'|25|39|40') <> 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O526
fatherSonIndex=0
frm_calc='0
len=10
name='_maxdel
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='xelegabo
obj='Delete
pag=5
prev=O534
rd_kfield=[
'RAPPORTO
'NUMPROG1
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xapopebo->RAPPORTO
'xapopebo->NUMPROG
]
I
obj='Select
pag=5
prev=O532
sel_field='*
sel_name='xelegabo
sel_where='xelegabo->RAPPORTO=xapopebo->RAPPORTO and xelegabo->NUMPROG1=xapopebo->NUMPROG
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O534
fatherSonIndex=0
frm_calc='_maxdel + 1
len=10
name='_maxdel
next=Icpitembatch.CPInsert
arch='delegabo
obj='Insert
pag=5
prev=O542
rd_kfield=[
'RAPPORTO
'CPROWNUM
'CODINTER
'DESCINTER
'DATAINI
'TIPORAP
'TIPOPERS
'STATOREG
'OPERAZMOD
'DATARETT
'IDEREG
'COLLEGAMEN
'DATAFINE
'NUMPROG1
'NUMPROG2
'IDBASE
'UCODE
'NOAGE
]
rd_kvar=[
'xelegabo->RAPPORTO
'_maxdel + 1
'xelegabo->CODINTER
'xelegabo->DESCINTER
'xelegabo->DATAINI
'xelegabo->TIPORAP
'xelegabo->TIPOPERS
''0'
'xelegabo->OPERAZMOD
'xelegabo->DATARETT
'xelegabo->IDEREG
'xelegabo->COLLEGAMEN
'xelegabo->DATAFINE
'cProg2
'xelegabo->NUMPROG2
'xelegabo->IDBASE
'xelegabo->UCODE
'xelegabo->NOAGE
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O531
sel_field='delegabo->CPROWNUM
sel_name='delegabo
sel_order='delegabo->CPROWNUM
sel_where='delegabo->RAPPORTO=xapopebo->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O532
fatherSonIndex=0
frm_calc='delegabo->CPROWNUM
len=10
name='_maxdel
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O526
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='xelegabo
obj='Delete
pag=5
prev=O552
rd_kfield=[
'RAPPORTO
'NUMPROG2
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xapopebo->RAPPORTO
'xapopebo->NUMPROG
]
I
obj='Select
pag=5
sel_field='*
sel_name='xelegabo
sel_where='xelegabo->RAPPORTO=xapopebo->RAPPORTO and xelegabo->NUMPROG2=xapopebo->NUMPROG
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='delegabo
father=O552
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xapopebo->RAPPORTO
'xelegabo->CODINTER
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'xapopebo->DATAOPE
'cProg2
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestbo
father=O511
fatherSonIndex=1
next=Icpitembatch.CPDelete
arch='xntestbo
obj='Delete
pag=5
prev=O570
rd_kfield=[
'RAPPORTO
'NUMPROG2
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xapopebo->RAPPORTO
'xapopebo->NUMPROG
]
I
obj='Write
pag=5
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xapopebo->RAPPORTO
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'xapopebo->DATAOPE
'cProg2
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O511
fatherSonIndex=2
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='xntestbo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O587
sel_field='*
sel_name='xerzistirap
sel_where='xerzistirap->RAPCOL=xapopebo->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistirap
father=O589
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='xerzistirap
obj='Delete
pag=5
prev=O593
rd_kfield=[
'IDFILEBO
'CODSOG
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xerzistirap->IDFILEBO
'xerzistirap->CODSOG
]
I
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'cProg1
'xerzistirap->CODSOG
'xerzistirap->TIPOFILE
'xerzistirap->NUMCOL
'xerzistirap->LEGAME
'xerzistirap->RAPCOL
'xerzistirap->UCODE
'xerzistirap->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O585
sel_field='*
sel_name='xiduciabo
sel_where='xiduciabo->RAPCOL=xapopebo->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='fiduciabo
father=O587
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='xiduciabo
obj='Delete
pag=5
prev=O603
rd_kfield=[
'IDFILEBO
'CODSOG
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xiduciabo->IDFILEBO
'xiduciabo->CODSOG
]
I
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'cProg1
'xiduciabo->CODSOG
'xiduciabo->TIPOFILE
'xiduciabo->NUMCOL
'xiduciabo->LEGAME
'xiduciabo->RAPCOL
'xiduciabo->UCODE
'xiduciabo->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O584
sel_field='*
sel_name='xoginfo
sel_where='xoginfo->IDFILEBO=xapopebo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='soginfo
father=O585
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='xoginfo
obj='Delete
pag=5
prev=O613
rd_kfield=[
'IDFILEBO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xoginfo->IDFILEBO
'xoginfo->CPROWNUM
]
I
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UNIQUECODE
]
rd_kvar=[
'cProg1
'xoginfo->CPROWNUM
'xoginfo->CODSOG
'xoginfo->LEGAME
'xoginfo->IDBASE
'xoginfo->NUMCOL
'xoginfo->TIPOFILE
'xoginfo->RAPCOL
'xoginfo->UNIQUECODE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=5
prev=O582
rd_kfield=[
'RAPPORTO
'NUMPROG1
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xapopebo->RAPPORTO
'xapopebo->NUMPROG
]
I
obj='Select
pag=5
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=xapopebo->RAPPORTO and xntestbo->NUMPROG1=xapopebo->NUMPROG
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O582
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='cProg3
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='intestbo
obj='Insert
pag=5
prev=O627
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'DATAFINE
'TIPOPERS
'NUMPROG1
'NUMPROG2
'CODINTER
'RAPPORTO
'TIPORAP
'STATOREG
'DESCINTER
'OPERAZMOD
'DATARETT
'IDEREG
'COLLEGAMEN
'UCODE
'ABBINATO
'PRGIMPSOG
]
rd_kvar=[
'cProg3
'xntestbo->CPROWNUM
'xntestbo->DATAINI
'xntestbo->DATAFINE
'xntestbo->TIPOPERS
'cProg2
'xntestbo->NUMPROG2
'xntestbo->CODINTER
'xntestbo->RAPPORTO
'xntestbo->TIPORAP
''0'
'xntestbo->DESCINTER
'xntestbo->OPERAZMOD
'xntestbo->DATARETT
'xntestbo->IDEREG
'xntestbo->COLLEGAMEN
'xntestbo->UCODE
'xntestbo->ABBINATO
'nProgImp
]
I
obj='Var
obj_type='N
pag=5
prev=O626
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=5
prev=O509
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O504
fatherSonIndex=1
frm_calc='_contano + 1
len=10
name='_contano
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=5
prev=O502
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'xapopebo->RAPPORTO
]
rd_var=[
'_rapporto
]
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O497
fatherSonIndex=1
frm_calc='Check non passato :(
next=Icpitembatch.CPVarDecl
frm_calc='_conta_err+1
name='_conta_err
next=Icpitembatch.CPVarDecl
frm_seek='AppendBlank
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='xapopebo->RAPPORTO
frm_seek='ERCODICE
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='_error_string
frm_seek='ERDESCRI
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcErrori
obj='Var
obj_type='MC
pag=5
prev=O645
var_op='meth
I
obj='Var
obj_type='MC
pag=5
prev=O644
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O643
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O642
var_op='meth
I
obj='Var
obj_type='N
pag=5
prev=O641
var_op='asgn
I
obj='Remark
pag=5
I
I
]
w=[
150
150
150
]
I
obj='If
pag=5
prev=O493
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='controlli vari
father=O494
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Substr(_error_string,2,Len(_error_string)-2)+"."
name='_error_string
obj='Var
pag=5
prev=O650
var_op='asgn
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O650
fatherSonIndex=0
frm_calc='''
name='_error_string
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xapopebo->RAPPORTO))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(DateDiff(xapopebo->DATAOPE, _date_oggi))>(20*365)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xapopebo->DATAOPE>_date_oggi
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xapopebo->FLAGRAP))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xapopebo->TIPOOPRAP)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'At(xapopebo->TIPOOPRAP,'|26|36|38|43|44|46') <> 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xapopebo->TIPOOPRAP='28'
]
h=[
19
19
]
obj='If
pag=5
prev=O671
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O674
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_field='*
sel_name='xelegabo
sel_where='xelegabo->RAPPORTO=xapopebo->RAPPORTO and xelegabo->NUMPROG2=xapopebo->NUMPROG
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O679
fatherSonIndex=0
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPRead
arch='delegabo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_numprog)
]
h=[
19
19
]
obj='If
pag=5
prev=O684
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O685
fatherSonIndex=0
frm_calc='_error_string+ " Manca Apertura per chiusura delega,"+NL
name='_error_string
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_passato_il_check
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O691
I
obj='Var
obj_type='L
pag=5
prev=O690
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O683
rd_field=[
'NUMPROG1
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'xapopebo->RAPPORTO
'xelegabo->CODINTER
]
rd_var=[
'_numprog
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O668
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O671
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=xapopebo->RAPPORTO and xntestbo->NUMPROG2=xapopebo->NUMPROG
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O702
fatherSonIndex=0
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPRead
arch='intestbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_numprog)
]
h=[
19
19
]
obj='If
pag=5
prev=O707
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O708
fatherSonIndex=0
frm_calc='_error_string+ " Manca Apertura per chiusura rapporto,"+NL
name='_error_string
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_passato_il_check
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O714
I
obj='Var
obj_type='L
pag=5
prev=O713
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O706
rd_field=[
'NUMPROG1
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'xapopebo->RAPPORTO
'xntestbo->CODINTER
]
rd_var=[
'_numprog
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O665
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O668
fatherSonIndex=0
frm_calc='_error_string+ " anomalia Tipo Registrazione,"+NL
name='_error_string
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_passato_il_check
obj='Var
obj_type='L
pag=5
prev=O725
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O662
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O665
fatherSonIndex=0
frm_calc='_error_string+ " anomalia Tipo Rapporto,"+NL
name='_error_string
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_passato_il_check
obj='Var
obj_type='L
pag=5
prev=O730
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O659
sons=[
Icpitembatch.CPItemSon
comment='Data Operazione maggiore della Data odierna
instr=Icpitembatch.CPVarDecl
father=O662
fatherSonIndex=0
frm_calc='_error_string+' Data Operazione Informazione maggiore della Data odierna,'
name='_error_string
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_passato_il_check
obj='Var
obj_type='L
pag=5
prev=O735
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O656
sons=[
Icpitembatch.CPItemSon
comment='Data Operazione più vecchia di 20 Anni
instr=Icpitembatch.CPVarDecl
father=O659
fatherSonIndex=0
frm_calc='_error_string+' Data Operazione Informazione più vecchia di 20 Anni,'
name='_error_string
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_passato_il_check
obj='Var
obj_type='L
pag=5
prev=O740
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O655
sons=[
Icpitembatch.CPItemSon
comment='Data Operazione più vecchia di 20 Anni
instr=Icpitembatch.CPVarDecl
father=O656
fatherSonIndex=0
frm_calc='' Rapporto non presente,'
name='_error_string
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_passato_il_check
obj='Var
obj_type='L
pag=5
prev=O745
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='L
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O441
fatherSonIndex=1
frm_calc=''Lettura operazioni in corso ...'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
pag=5
prev=O437
var_op='asgn
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O437
fatherSonIndex=0
frm_calc='_min
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_max
len=15
name='_top
obj='Var
obj_type='N
pag=5
prev=O758
var_op='asgn
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O437
fatherSonIndex=1
frm_calc='((_contacicli -1 ) * 5000) + 1
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_contacicli * 5000
len=15
name='_top
obj='Var
obj_type='N
pag=5
prev=O761
var_op='asgn
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O429
var_op='asgn
I
obj='If
pag=5
prev=O427
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O429
fatherSonIndex=0
frm_calc='iif(_tot=0,0,1)
len=10
name='_cicli
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O429
fatherSonIndex=1
frm_calc='iif(Mod(_max,5000) <> 0,Int(_max/5000) + 1,Int(_max/5000))
len=10
name='_cicli
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=5
par_expr=[
'w_datreg
]
par_name=[
'w_datreg
]
prev=O426
sel_name='qbe_trasfinfo_count_inf
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O427
fatherSonIndex=0
frm_calc='qbe_trasfinfo_count_inf->MININF
len=10
name='_min
next=Icpitembatch.CPVarDecl
frm_calc='qbe_trasfinfo_count_inf->MAXINF
len=10
name='_max
next=Icpitembatch.CPVarDecl
frm_calc='qbe_trasfinfo_count_inf->TOTINF
len=10
name='_tot
obj='Var
obj_type='N
pag=5
prev=O776
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O775
var_op='asgn
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O405
sel_field='*
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O406
fatherSonIndex=0
frm_calc='intermbo->FLGDATATP
len=8
name='_flgdatareg
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O404
var_op='asgn
I
obj='Var
pag=5
prev=O403
var_op='asgn
I
obj='Var
pag=5
prev=O402
var_op='asgn
I
obj='Var
pag=5
prev=O401
var_op='asgn
I
nonlocal=True
obj='Var
pag=5
prev=O400
var_op='asgn
I
obj='Remark
pag=5
x=17
y=21
I
Icpitembatch.CPNote
frm_calc='Tale bottone è stato disabilitato in maschera in quanto permetteva l'inserimento in definitivo più operazioni con lo il medesimo RIFIMP/INFORM﷯12.07.2021
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Selezionare il flag Forza Trasferimento in caso si voglia comunque proseguire' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O785
var_op='asgn
I
obj='Note
pag=2
x=1034
y=3700
I
Icpitembatch.CPRemark
frm_calc='Scorre la query e trasferisce i dati
next=Icpitembatch.CPBeginEnd
h=[
19
19
]
obj='Begin
pag=6
prev=O787
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O788
fatherSonIndex=0
frm_calc='0
len=10
name='_cinf
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + "Sono state trasferite "+LRTrim(Str(_cinf,10,0))+" informazioni" + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Trasferimento: '+ arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O795
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O793
var_op='asgn
I
obj='Select
pag=6
prev=O792
sel_field='*
sel_name='xapotit
sel_order='xapotit->DATAREG,xapotit->DATAOPE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O793
fatherSonIndex=0
frm_calc=[
'Empty(xapotit->CODDIPE) or xapotit->CODDIPE=gCodDip or Empty(gCodDip)
]
h=[
19
19
]
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O799
fatherSonIndex=0
frm_calc='True 
len=1
name='_passato_il_check
next=Icpitembatch.CPIfElse
frm_calc=[
'fai_controlli
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_passato_il_check
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
prev=O805
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O808
fatherSonIndex=0
frm_calc='_cinf + 1
len=10
name='_cinf
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Trasferimento dati  informazioni n. '+xapotit->NUMPROG+' del soggetto: '+xapotit->CONNESCLI
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPRemark
frm_calc='Calcol i nuovi progressivi
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_oldprog
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGTITO1\'"+LRTrim(gAzienda)+"'",Space(10),10)
len=10
name='cProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGTITO2\'"+LRTrim(gAzienda)+"'",Space(11),11)
len=11
name='cProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTIT\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='idb2
next=Icpitembatch.CPInsert
arch='rapotit
next=Icpitembatch.CPVarDecl
frm_calc='cProg2
len=11
name='_oldprog
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_ae_agg_aetesta_tit(xapotit->CONNESCLI)
next=Icpitembatch.CPDelete
arch='xapotit
obj='Delete
pag=6
prev=O826
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'xapotit->IDBASE
]
I
obj='Exec
pag=6
prev=O824
I
obj='Select
pag=6
prev=O823
sel_field='*
sel_name='xntestit
sel_where='xntestit->CODCLI=xapotit->CONNESCLI and (xntestit->NUMPROG1=xapotit->NUMPROG or xntestit->NUMPROG2=xapotit->NUMPROG)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O824
fatherSonIndex=0
frm_calc=[
'xapotit->TIPOOPRAP='50' or xapotit->TIPOOPRAP='52' or xapotit->TIPOOPRAP='58'
'xapotit->TIPOOPRAP='51' or xapotit->TIPOOPRAP='53'
]
h=[
19
19
19
]
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O833
fatherSonIndex=0
frm_calc='''
len=11
name='_nprog
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datafine
next=Icpitembatch.CPRead
arch='intestit
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_nprog)) or (not(Empty(LRTrim(_nprog))) and not(Empty(_datafine)))
]
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='xntestit
obj='Delete
pag=6
prev=O841
rd_kfield=[
'CODCLI
'CODINTER
'NUMPROG1
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'xntestit->CODCLI
'xntestit->CODINTER
'xntestit->NUMPROG1
]
I
obj='If
pag=6
prev=O840
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='intestit
father=O841
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'CODCLI
'RAPPORTO
'CODINTER
'DESCINTER
'DATAINI
'TIPORAP
'TIPOPERS
'STATOREG
'OPERAZMOD
'DATARETT
'IDEREG
'COLLEGAMEN
'DATAFINE
'NUMPROG1
'IDBASE
'UCODE
'ABBINATO
'PRGIMPTITE
'NOAGE
]
rd_kvar=[
'xntestit->CODCLI
'xntestit->RAPPORTO
'xntestit->CODINTER
'xntestit->DESCINTER
'xntestit->DATAINI
'xntestit->TIPORAP
'xntestit->TIPOPERS
''0'
'xntestit->OPERAZMOD
'xntestit->DATARETT
'xntestit->IDEREG
'xntestit->COLLEGAMEN
'xntestit->DATAFINE
'_oldprog
'xntestit->IDBASE
'xntestit->UCODE
'xntestit->ABBINATO
'xntestit->PRGIMPTITE
'xntestit->NOAGE
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O839
rd_field=[
'NUMPROG1
'DATAFINE
]
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kvar=[
'xntestit->CODCLI
'xntestit->CODINTER
]
rd_var=[
'_nprog
'_datafine
]
I
obj='Var
obj_type='D
pag=6
prev=O838
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestit
father=O833
fatherSonIndex=1
next=Icpitembatch.CPDelete
arch='xntestit
obj='Delete
pag=6
prev=O859
rd_kfield=[
'CODCLI
'CODINTER
'NUMPROG2
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'xntestit->CODCLI
'xntestit->CODINTER
'xntestit->NUMPROG2
]
I
obj='Write
pag=6
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xntestit->CODCLI
'xntestit->CODINTER
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'xapotit->DATAOPE
'_oldprog
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O822
var_op='asgn
I
obj='Insert
pag=6
prev=O821
rd_kfield=[
'AUTOM
'CAMBIO
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNESBEN
'CONNESCLI
'DATAAGE
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'IDBASE2
'IDEREG
'INFORM
'NUMPROG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PRGIMPTIT
'PROV2
'PROVINCIA
'RAPPORTBEN
'RAPPORTO
'RESPINS
'SEGNO
'STATOREG
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'VALUTA
]
rd_kvar=[
'xapotit->AUTOM
'xapotit->CAMBIO
'xapotit->CDATOPE
'DateToChar(_datareg)
'xapotit->CODANA
'xapotit->CODCAB
'xapotit->CODCAB2
'xapotit->CODDIPE
'xapotit->CODINT2
'xapotit->CODINTER
'xapotit->CODVOC
'xapotit->COLLEG
'xapotit->CONNESBEN
'xapotit->CONNESCLI
'xapotit->DATAAGE
'xapotit->DATAOPE
'_datareg
'xapotit->DATARETT
'xapotit->DESC2
'xapotit->DESCCIT
'xapotit->DESCINTER
'xapotit->FLAGCONT
'xapotit->FLAGFRAZ
'xapotit->FLAGLIRE
'xapotit->FLAGRAP
'xapotit->FLAGRAP2
'cProg1
'idb2
''T'+Right(cProg2,9)+idb2
'xapotit->INFORM
'cProg2
'xapotit->OPERATORE
'xapotit->OPERAZMOD
'xapotit->OPRAP
'xapotit->PAESE
'nProgImp
'xapotit->PROV2
'xapotit->PROVINCIA
'xapotit->RAPPORTBEN
'xapotit->RAPPORTO
'xapotit->RESPINS
'xapotit->SEGNO
'xapotit->STATOREG
'xapotit->TIPOINF
'xapotit->TIPOINT2
'xapotit->TIPOINTER
'xapotit->TIPOLEG
'xapotit->TIPOOPRAP
'xapotit->TOTCONT
'xapotit->TOTLIRE
'xapotit->UCODE
'xapotit->VALUTA
]
I
obj='Var
pag=6
prev=O820
var_op='asgn
I
obj='Var
obj_type='D
pag=6
prev=O819
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O818
var_op='asgn
I
obj='Var
pag=6
prev=O817
var_op='asgn
I
obj='Var
pag=6
prev=O816
var_op='asgn
I
obj='Var
pag=6
prev=O815
var_op='asgn
I
obj='Remark
pag=6
prev=O814
I
nonlocal=True
obj='Var
pag=6
prev=O813
var_op='asgn
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O808
fatherSonIndex=1
frm_calc='Check non passato :(
next=Icpitembatch.CPVarDecl
frm_calc='_conta_err+1
name='_conta_err
next=Icpitembatch.CPVarDecl
frm_seek='AppendBlank
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='xapotit->CONNESOPER
frm_seek='ERCODICE
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='_error_string
frm_seek='ERDESCRI
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcErrori
obj='Var
obj_type='MC
pag=6
prev=O879
var_op='meth
I
obj='Var
obj_type='MC
pag=6
prev=O878
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O877
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O876
var_op='meth
I
obj='Var
obj_type='N
pag=6
prev=O875
var_op='asgn
I
obj='Remark
pag=6
I
I
]
w=[
150
150
150
]
I
obj='If
pag=6
prev=O804
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='controlli vari
father=O805
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Substr(_error_string,2,Len(_error_string)-2)+"."
name='_error_string
obj='Var
pag=6
prev=O884
var_op='asgn
I
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O884
fatherSonIndex=0
frm_calc='''
name='_error_string
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xapotit->DATAOPE)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(DateDiff(xapotit->DATAOPE, _date_oggi))>(20*365)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xapotit->DATAOPE>_date_oggi
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xapotit->TIPOLEG)) or not(xapotit->TIPOLEG='5' or xapotit->TIPOLEG='7' or xapotit->TIPOLEG='8')
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xapotit->TIPOOPRAP)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xapotit->TIPOOPRAP='51' or xapotit->TIPOOPRAP='53'
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifica presenza dei Titolare in Anagrafica
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_passato_il_sub_check
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifica presenza del Società controllato da titolari effettivi / Società Fiduciante in Anagrafica
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_passato_il_sub_check
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(_passato_il_sub_check)
]
h=[
19
19
]
obj='If
pag=6
prev=O914
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O916
fatherSonIndex=0
frm_calc='_error_string+ " Società controllata da titolari effettivi / Società Fiduciante non presente in Anagrafica,"+NL
name='_error_string
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_passato_il_check
obj='Var
obj_type='L
pag=6
prev=O921
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=6
prev=O913
sel_name='personbo
sel_where='xapotit->CONNESCLI=personbo->CONNES
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O914
fatherSonIndex=0
frm_calc='True
len=1
name='_passato_il_sub_check
obj='Var
obj_type='L
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='L
pag=6
prev=O912
var_op='asgn
I
obj='Remark
pag=6
prev=O910
I
obj='Select
pag=6
prev=O909
sel_name='xntestit
sel_where='xntestit->CODCLI=xapotit->CONNESCLI and (xntestit->NUMPROG1=xapotit->NUMPROG or xntestit->NUMPROG2=xapotit->NUMPROG)﷯
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O910
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(_passato_il_sub_check)
]
h=[
19
19
]
obj='If
pag=6
prev=O930
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O932
fatherSonIndex=0
frm_calc='_error_string+ " Titolare Effettivo "+xntestit->CODINTER+" non presente in Anagrafica,"+NL
name='_error_string
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_passato_il_check
obj='Var
obj_type='L
pag=6
prev=O937
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=6
sel_name='personbo
sel_where='xntestit->CODINTER=personbo->CONNES
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O930
fatherSonIndex=0
frm_calc='True
len=1
name='_passato_il_sub_check
obj='Var
obj_type='L
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='L
pag=6
prev=O908
var_op='asgn
I
obj='Remark
pag=6
prev=O905
I
obj='If
pag=6
prev=O902
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O905
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=6
sel_field='*
sel_name='xntestit
sel_where='xntestit->CODCLI=xapotit->CONNESCLI and xntestit->NUMPROG2=xapotit->NUMPROG
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O947
fatherSonIndex=0
frm_calc='''
len=11
name='_nprog
next=Icpitembatch.CPRead
arch='intestit
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_nprog)
]
h=[
19
19
]
obj='If
pag=6
prev=O952
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O953
fatherSonIndex=0
frm_calc='_error_string+ " Manca Apertura per chiusura legame,"+NL
name='_error_string
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_passato_il_check
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=6
prev=O959
I
obj='Var
obj_type='L
pag=6
prev=O958
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O951
rd_field=[
'NUMPROG1
]
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kvar=[
'xntestit->CODCLI
'xntestit->CODINTER
]
rd_var=[
'_nprog
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O899
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O902
fatherSonIndex=0
frm_calc='_error_string+ " anomalia Tipo Registrazione,"+NL
name='_error_string
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_passato_il_check
obj='Var
obj_type='L
pag=6
prev=O970
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O896
sons=[
Icpitembatch.CPItemSon
comment='Empty(LRTrim(xapotit->TIPOLEG)) or not(xapotit->TIPOLEG='5' or xapotit->TIPOLEG='6')
instr=Icpitembatch.CPVarDecl
father=O899
fatherSonIndex=0
frm_calc='_error_string+ " anomalia Tipo Legame,"+NL
name='_error_string
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_passato_il_check
obj='Var
obj_type='L
pag=6
prev=O975
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O893
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Data Inizio Legame maggiore della Data odierna
instr=Icpitembatch.CPVarDecl
father=O896
fatherSonIndex=0
frm_calc='_error_string+' Data Inizio Legame maggiore della Data odierna,'
name='_error_string
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_passato_il_check
obj='Var
obj_type='L
pag=6
prev=O980
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O890
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Data Legame più vecchia di 20 Anni
instr=Icpitembatch.CPRemark
father=O893
fatherSonIndex=0
frm_calc='ATTENZIONE: La data di inizio titolarià può essere più vecchia di 20 anni!
obj='Remark
pag=6
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O889
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Data Inizio Legame vuota
instr=Icpitembatch.CPVarDecl
father=O890
fatherSonIndex=0
frm_calc='' Data Inizio Legame non presente,'
name='_error_string
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_passato_il_check
obj='Var
obj_type='L
pag=6
prev=O989
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='L
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=6
x=6
y=18
I
Icpitembatch.CPNote
frm_calc='Trasferisce da provvisorio a definitivo le Operazioni.﷯﷯In caso di stessi riferimenti -> Non trasferisce NULLA﷯﷯In caso di controlli falliti -> Trasferisce tutto tranne le operazioni con errori (le lascia nel provvisorio)﷯in tal caso nel file di errori trovi la causa dell'errore + numprog dell'operazione fallata﷯﷯In caso di errore SQL -> Rollback
obj='Note
pag=2
x=699
y=24
I
Icpitembatch.CPVarDecl
comment='Operazioni definitive con lo stesso rifimp o inform
frm_seek='qbe_trasfope_controllo_totale.vqr
name='mcqbe_trasfope_controllo_totale
next=Icpitembatch.CPRemark
frm_calc='Scorre la query e trasferisce i dati
next=Icpitembatch.CPVarDecl
frm_calc='pDatIni
len=8
name='w_DaDatOpe
next=Icpitembatch.CPVarDecl
frm_calc='pDatFin
len=8
name='w_ADatOpe
next=Icpitembatch.CPVarDecl
frm_calc='pForza
len=1
name='w_flgforce
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Selezione record da elaborare..."
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(w_DaDatOpe) or DateToChar(w_DaDatOpe)='01000101','',DateToChar(w_DaDatOpe))
len=8
name='w_cdaope
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(w_ADatOpe) or DateToChar(w_ADatOpe)='01000101','',DateToChar(w_ADatOpe))
len=8
name='w_c_aope
next=Icpitembatch.CPVarDecl
frm_calc='''
len=8
name='w_cdareg
next=Icpitembatch.CPVarDecl
frm_calc='''
len=8
name='w_c_areg
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_totale
next=Icpitembatch.CPBeginEnd
comment='Verifica quale tipo di riferimento utilizzare per il controllo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgforce <> 'S' and (_nx=1 or _sx=1)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'mcqbe_trasfope_controllo_totale.IsEmpty()
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O1011
sons=[
Icpitembatch.CPItemSon
comment='_totale=0
instr=Icpitembatch.CPSelect
father=O1014
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Trasferite '+LRTrim(Str(_conta,10,0))+" operazioni" + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'_conta_err>0
]
h=[
19
19
]
obj='If
pag=2
prev=O1021
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1022
fatherSonIndex=0
frm_calc='gMsgProc + 'Bloccate '+LRTrim(Str(_conta_err,10,0))+" operazioni per anomalie riscontrate. Consultare la stampa dei errori" + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O1019
var_op='asgn
I
obj='Select
pag=2
par_expr=[
'w_cdaope
'w_c_aope
'pInform
]
par_name=[
'w_cdaope
'w_c_aope
'pInform
]
sel_name='qbe_trasfope_datope
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1019
fatherSonIndex=0
frm_calc='DateToChar(qbe_trasfope_datope->DATAOPE)
len=8
name='w_datreg
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_tot < 5000
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='_contacicli
next=Icpitembatch.CPWhile
frm_calc='_contacicli<=_cicli
h=[
19
19
]
obj='While
pag=2
prev=O1039
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1040
fatherSonIndex=0
frm_calc=[
'_cicli = 1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Lettura operazioni in corso ... Ciclo N. '+LRTrim(Str(_contacicli,10,0))
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'_top>=_min
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_contacicli+1
len=10
name='_contacicli
obj='Var
obj_type='N
pag=2
prev=O1048
var_op='asgn
I
obj='If
pag=2
prev=O1047
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1048
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=2
sel_name='qbe_trasfope_idbase_ope
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1054
fatherSonIndex=0
frm_calc='qbe_trasfope_idbase_ope->IDBASE
len=10
name='w_idbase
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=2
prev=O1058
sel_field='*
sel_name='xperazbo
sel_where='xperazbo->IDBASE=w_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1059
fatherSonIndex=0
frm_calc='True 
len=1
name='_passato_il_check
next=Icpitembatch.CPIfElse
frm_calc=[
'fai_controlli
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_passato_il_check
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O1064
sons=[
Icpitembatch.CPItemSon
comment='Trasferisco l'operazione
instr=Icpitembatch.CPRemark
father=O1067
fatherSonIndex=0
frm_calc='Calcol i nuovi progressivi
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='idb2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",Space(10),10)
len=10
name='cProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("POPERAZ2\'"+LRTrim(gAzienda)+"'",Space(11),11)
len=11
name='cProg2
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datareg
next=Icpitembatch.CPInsert
arch='operazbo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='xperazbo
next=Icpitembatch.CPVarDecl
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Sono state trasferite "+LRTrim(Str(_conta,10,0))+" operazioni"
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=2
prev=O1093
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O1092
var_op='asgn
I
obj='Delete
pag=2
prev=O1090
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'xperazbo->IDBASE
]
I
obj='Select
pag=2
prev=O1088
sel_field='*
sel_name='xapcoll
sel_where='xapcoll->IDFILEBO=xperazbo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='rapcoll
father=O1090
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='xapcoll
obj='Delete
pag=2
prev=O1100
rd_kfield=[
'IDFILEBO
'RAPPORTO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xapcoll->IDFILEBO
'xapcoll->RAPPORTO
]
I
obj='Insert
pag=2
rd_kfield=[
'IDFILEBO
'RAPPORTO
'IDBASE
]
rd_kvar=[
'cProg1
'xapcoll->RAPPORTO
'xapcoll->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=2
prev=O1086
sel_field='*
sel_name='xocopebo
sel_where='xocopebo->NUMPROG=xperazbo->NUMPROG
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='docopebo
father=O1088
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='xocopebo
obj='Delete
pag=2
prev=O1110
rd_kfield=[
'NUMPROG
'CONNESCLI
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xocopebo->NUMPROG
'xocopebo->CONNESCLI
]
I
obj='Insert
pag=2
rd_kfield=[
'NUMPROG
'CONNESCLI
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DATAVALI
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kvar=[
'cProg2
'xocopebo->CONNESCLI
'xocopebo->TIPODOC
'xocopebo->NUMDOCUM
'xocopebo->DATARILASC
'xocopebo->AUTRILASC
'xocopebo->DATAVALI
'xocopebo->DOMICILIO
'xocopebo->DESCCIT
'xocopebo->PROVINCIA
'xocopebo->PAESE
'xocopebo->CAP
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=2
prev=O1084
sel_field='*
sel_name='xerzistiope
sel_where='xerzistiope->IDFILEBO=xperazbo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistiope
father=O1086
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='xerzistiope
obj='Delete
pag=2
prev=O1120
rd_kfield=[
'IDFILEBO
'CODSOG
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xerzistiope->IDFILEBO
'xerzistiope->CODSOG
]
I
obj='Insert
pag=2
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'cProg1
'xerzistiope->CODSOG
'xerzistiope->TIPOFILE
'xerzistiope->NUMCOL
'xerzistiope->LEGAME
'xerzistiope->RAPCOL
'xerzistiope->UCODE
'xerzistiope->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=2
prev=O1082
sel_field='*
sel_name='xeneficope
sel_where='xeneficope->IDFILEBO=xperazbo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficope
father=O1084
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='xeneficope
obj='Delete
pag=2
prev=O1130
rd_kfield=[
'IDFILEBO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xeneficope->IDFILEBO
'xeneficope->CPROWNUM
]
I
obj='Insert
pag=2
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
rd_kvar=[
'cProg1
'xeneficope->CPROWNUM
'xeneficope->CODSOG
'xeneficope->TIPOFILE
'xeneficope->NUMCOL
'xeneficope->LEGAME
'xeneficope->RAPCOL
'xeneficope->UCODE
'xeneficope->IDBASE
'xeneficope->C_RAG
'xeneficope->C_STA
'xeneficope->C_CTA
'xeneficope->C_CAB
'xeneficope->C_PRV
'xeneficope->C_IND
'xeneficope->C_CAP
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=2
prev=O1080
sel_field='*
sel_name='xlientiope
sel_where='xlientiope->IDFILEBO=xperazbo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O1082
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='xlientiope
obj='Delete
pag=2
prev=O1140
rd_kfield=[
'IDFILEBO
'CODSOG
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xlientiope->IDFILEBO
'xlientiope->CODSOG
]
I
obj='Insert
pag=2
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'cProg1
'xlientiope->CODSOG
'xlientiope->TIPOFILE
'xlientiope->NUMCOL
'xlientiope->LEGAME
'xlientiope->RAPCOL
'xlientiope->UCODE
'xlientiope->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=2
prev=O1078
sel_field='*
sel_name='xogopebo
sel_where='xogopebo->IDFILEBO=xperazbo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sogopebo
father=O1080
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='xogopebo
obj='Delete
pag=2
prev=O1150
rd_kfield=[
'IDFILEBO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xogopebo->IDFILEBO
'xogopebo->CPROWNUM
]
I
obj='Insert
pag=2
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
]
rd_kvar=[
'cProg1
'xogopebo->CPROWNUM
'xogopebo->CODSOG
'xogopebo->LEGAME
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=2
prev=O1077
sel_field='*
sel_name='xperazbo_agg
sel_where='xperazbo_agg->IDBASE=w_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='operazbo_agg
father=O1078
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='xperazbo_agg
obj='Delete
pag=2
prev=O1160
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'w_idbase
]
I
obj='Insert
pag=2
rd_kfield=[
'IDBASE
'CODLOB
'TIPOGIOCO
'CACODICE
'IDBIGLIETTO
'CADATAORA
'CATIPGIO
'CATIPCON
'CAPV_COD
'IDDOCALL
'VPCODICE
'WUDATRET
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
'FLAGFRAUD
'SV58724
'SV58726SCA
'SV58726SA
'SV58726PISP
'C_COGNOME
'C_NOME
'SOSPAGAM
]
rd_kvar=[
'cProg1
'xperazbo_agg->CODLOB
'xperazbo_agg->TIPOGIOCO
'xperazbo_agg->CACODICE
'xperazbo_agg->IDBIGLIETTO
'xperazbo_agg->CADATAORA
'xperazbo_agg->CATIPGIO
'xperazbo_agg->CATIPCON
'xperazbo_agg->CAPV_COD
'xperazbo_agg->IDDOCALL
'xperazbo_agg->VPCODICE
'xperazbo_agg->WUDATRET
'xperazbo_agg->CATEG01
'xperazbo_agg->CATEG02
'xperazbo_agg->CATEG03
'xperazbo_agg->CATEG04
'xperazbo_agg->CATEG05
'xperazbo_agg->CATEGORIA
'xperazbo_agg->FLAGFRAUD
'xperazbo_agg->SV58724
'xperazbo_agg->SV58726SCA
'xperazbo_agg->SV58726SA
'xperazbo_agg->SV58726PISP
'xperazbo_agg->C_COGNOME
'xperazbo_agg->C_NOME
'xperazbo_agg->SOSPAGAM
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=2
prev=O1076
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'AUTOM
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESDOC
'CONNESOPER
'DAC6
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGDAC6
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'IDBASE2
'idcauana
'IDEREG
'IDFILE
'IMPIN
'IMPOUT
'IMPSARA
'INFORM
'IPCOLLEG
'MITIG
'MITIGDOC
'MODSVOL
'MTCN
'NATURA
'NOPROT
'NOSARA
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROQUOTA
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RISGLOB
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'SV58550
'SV58550MA
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TIPOORO
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
'MEZPAG
'PRESTAZ
'CAUSALE
'VASP
]
rd_kvar=[
'xperazbo->AMMONT
'xperazbo->ANNOOPE
'xperazbo->AREAGEO
'xperazbo->AUTOM
'xperazbo->C_CAB
'xperazbo->C_CAP
'xperazbo->C_CTA
'xperazbo->C_IND
'xperazbo->C_PRV
'xperazbo->C_RAG
'xperazbo->C_RAPPORTO
'xperazbo->C_STA
'xperazbo->CAMBIO
'xperazbo->CDATAOPE
'xperazbo->CDATOPE
'DateToChar(_datareg)
'xperazbo->CODANA
'xperazbo->CODCAB
'xperazbo->CODCAB2
'xperazbo->CODDIPE
'xperazbo->CODINT2
'xperazbo->CODINTER
'xperazbo->CODVOC
'xperazbo->COLLEG
'xperazbo->CONNALTRO
'xperazbo->CONNESBEN
'xperazbo->CONNESCLI
'xperazbo->CONNESDOC
'xperazbo->CONNESOPER
'xperazbo->DAC6
'xperazbo->DATAIMP
'xperazbo->DATAOPE
'_datareg
'xperazbo->DATARETT
'xperazbo->DESC2
'xperazbo->DESCCIT
'xperazbo->DESCINTER
'xperazbo->DOCFILE
'xperazbo->DUCOLLEG
'xperazbo->DURAT
'xperazbo->FLAGCONT
'xperazbo->FLAGDAC6
'xperazbo->FLAGFRAZ
'xperazbo->FLAGLIRE
'xperazbo->FLAGRAP
'xperazbo->FLAGRAP2
'cProg1
'idb2
'xperazbo->idcauana
''O'+Right(cProg2,9)+idb2
'xperazbo->IDFILE
'xperazbo->IMPIN
'xperazbo->IMPOUT
'xperazbo->IMPSARA
'xperazbo->INFORM
'xperazbo->IPCOLLEG
'xperazbo->MITIG
'xperazbo->MITIGDOC
'xperazbo->MODSVOL
'xperazbo->MTCN
'xperazbo->NATURA
'xperazbo->NOPROT
'xperazbo->NOSARA
'cProg2
'xperazbo->OPERAG
'xperazbo->OPERATORE
'xperazbo->OPERAZMOD
'xperazbo->OPRAP
'xperazbo->ORACOLLEG
'xperazbo->PAESE
'xperazbo->PAGASOGOP
'xperazbo->PRGIMPOPE
'xperazbo->PROQUOTA
'xperazbo->PROV2
'xperazbo->PROVINCIA
'xperazbo->RAGIO
'xperazbo->RAPPORTBEN
'xperazbo->RAPPORTO
'xperazbo->RAREA
'xperazbo->RCOMP
'xperazbo->RESPINS
'xperazbo->RFREQ
'xperazbo->RIFIMP
'xperazbo->RIMP
'xperazbo->RISGLOB
'xperazbo->RRAGIO
'xperazbo->RTIPO
'xperazbo->SCOPO
'xperazbo->SEGNO
'xperazbo->STATOREG
'xperazbo->SV58550
'xperazbo->SV58550MA
'xperazbo->TIPO
'xperazbo->TIPOINF
'xperazbo->TIPOINT2
'xperazbo->TIPOINTER
'xperazbo->TIPOLEG
'xperazbo->TIPOOPRAP
'xperazbo->TIPOORO
'xperazbo->TOTCONT
'xperazbo->TOTLIRE
'xperazbo->UCODE
'xperazbo->UNIQUECODE
'xperazbo->VALUTA
'xperazbo->ZCPARTE
'xperazbo->MEZPAG
'xperazbo->PRESTAZ
'xperazbo->CAUSALE
'xperazbo->VASP
]
I
obj='Var
obj_type='D
pag=2
prev=O1075
var_op='asgn
I
obj='Var
pag=2
prev=O1074
var_op='asgn
I
obj='Var
pag=2
prev=O1073
var_op='asgn
I
obj='Var
pag=2
prev=O1072
var_op='asgn
I
obj='Remark
pag=2
I
I
Icpitembatch.CPItemSon
comment='Segno l'errore e il numprog nel mcErrori
instr=Icpitembatch.CPRemark
father=O1067
fatherSonIndex=1
frm_calc='Check non passato :(
next=Icpitembatch.CPVarDecl
frm_calc='_conta_err+1
name='_conta_err
next=Icpitembatch.CPVarDecl
frm_seek='AppendBlank
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='xperazbo->NUMPROG
frm_seek='ERCODICE
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='_error_string
frm_seek='ERDESCRI
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcErrori
obj='Var
obj_type='MC
pag=2
prev=O1175
var_op='meth
I
obj='Var
obj_type='MC
pag=2
prev=O1174
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O1173
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O1172
var_op='meth
I
obj='Var
obj_type='N
pag=2
prev=O1171
var_op='asgn
I
obj='Remark
pag=2
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
prev=O1063
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='controlli vari
father=O1064
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Substr(_error_string,2,Len(_error_string)-2)+"."
name='_error_string
obj='Var
pag=2
prev=O1180
var_op='asgn
I
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1180
fatherSonIndex=0
frm_calc='''
name='_error_string
next=Icpitembatch.CPIfElse
frm_calc=[
'(DateDiff(xperazbo->DATAOPE, _date_oggi))>(20*365)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xperazbo->DATAOPE>_date_oggi
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='CODANA+CODVOC+SEGNO
frm_calc='""+LRTrim(xperazbo->CODANA)+LRTrim(xperazbo->CODVOC)+LRTrim(xperazbo->SEGNO)
name='_tmp
next=Icpitembatch.CPIfElse
frm_calc=[
'not(mcCauana.HasKey(_tmp))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='""
name='_tmp
obj='Var
pag=2
prev=O1193
var_op='asgn
I
obj='If
pag=2
prev=O1192
sons=[
Icpitembatch.CPItemSon
comment='Causale Analitica o Causale Sintetica o Segno
instr=Icpitembatch.CPVarDecl
father=O1193
fatherSonIndex=0
frm_calc='_error_string+' Anomalia sui campi Causale Analitica e/o Causale Sintetica e/o Segno,'
name='_error_string
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_passato_il_check
obj='Var
obj_type='L
pag=2
prev=O1199
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O1189
var_op='asgn
I
obj='If
pag=2
prev=O1186
sons=[
Icpitembatch.CPItemSon
comment='Data Operazione maggiore della Data odierna
instr=Icpitembatch.CPVarDecl
father=O1189
fatherSonIndex=0
frm_calc='_error_string+' Data Operazione maggiore della Data odierna,'
name='_error_string
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_passato_il_check
obj='Var
obj_type='L
pag=2
prev=O1204
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O1185
sons=[
Icpitembatch.CPItemSon
comment='Data Operazione più vecchia di 20 Anni
instr=Icpitembatch.CPVarDecl
father=O1186
fatherSonIndex=0
frm_calc='' Data Operazione più vecchia di 20 Anni,'
name='_error_string
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_passato_il_check
obj='Var
obj_type='L
pag=2
prev=O1209
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='L
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O1048
fatherSonIndex=1
frm_calc=''Lettura operazioni in corso ...'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
pag=2
prev=O1044
var_op='asgn
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1044
fatherSonIndex=0
frm_calc='_min
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_max
len=15
name='_top
obj='Var
obj_type='N
pag=2
prev=O1221
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1044
fatherSonIndex=1
frm_calc='((_contacicli -1 ) * 5000) + 1
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_contacicli * 5000
len=15
name='_top
obj='Var
obj_type='N
pag=2
prev=O1224
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O1036
var_op='asgn
I
obj='If
pag=2
prev=O1034
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1036
fatherSonIndex=0
frm_calc='iif(_tot=0,0,1)
len=10
name='_cicli
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1036
fatherSonIndex=1
frm_calc='iif(Mod(_max,5000) <> 0,Int(_max/5000) + 1,Int(_max/5000))
len=10
name='_cicli
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=2
par_expr=[
'w_datreg
]
par_name=[
'w_datreg
]
prev=O1033
sel_name='qbe_trasfope_count_ope
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1034
fatherSonIndex=0
frm_calc='qbe_trasfope_count_ope->MINOPE
len=10
name='_min
next=Icpitembatch.CPVarDecl
frm_calc='qbe_trasfope_count_ope->MAXOPE
len=10
name='_max
next=Icpitembatch.CPVarDecl
frm_calc='qbe_trasfope_count_ope->TOTOPE
len=10
name='_tot
obj='Var
obj_type='N
pag=2
prev=O1239
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O1238
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Vecchio inserimento
father=O1014
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPForEach
for_variable='rwqbe_trasfope_controllo_totale
for_variable_type='qbe_trasfope_controllo_totale.vqr
h=[
19
19
]
iterator_expr='mcqbe_trasfope_controllo_totale
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Il trasferimento è stato bloccato in quanto sono state trovate operazioni con gli stessi riferimenti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Elaborazione Abortita."
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
pag=2
prev=O1248
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O1246
var_op='asgn
I
obj='ForEach
pag=2
prev=O1244
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1246
fatherSonIndex=0
frm_seek='AppendBlank
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='""
frm_seek='ERCODICE
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='"Riferimento1: "+LRTrim(rwqbe_trasfope_controllo_totale.RIFIMP)+" Riferimento2: "+LRTrim(rwqbe_trasfope_controllo_totale.INFORM)+" Riscontrati sull'operazione definitiva con numero progressivo: "+LRTrim(rwqbe_trasfope_controllo_totale.NUMPROG)
frm_seek='ERDESCRI
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcErrori
obj='Var
obj_type='MC
pag=2
prev=O1254
var_op='meth
I
obj='Var
obj_type='MC
pag=2
prev=O1253
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O1252
var_op='prop
I
obj='Var
obj_type='MC
pag=2
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1244
fatherSonIndex=0
frm_seek='AppendBlank
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='""
frm_seek='ERCODICE
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='"Il trasferimento è stato bloccato in quanto sono state trovate operazioni con gli stessi riferimenti"
frm_seek='ERDESCRI
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcErrori
obj='Var
obj_type='MC
pag=2
prev=O1261
var_op='meth
I
obj='Var
obj_type='MC
pag=2
prev=O1260
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O1259
var_op='prop
I
obj='Var
obj_type='MC
pag=2
var_op='meth
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
prev=O1009
sons=[
Icpitembatch.CPItemSon
instr=Ispitembatch.CPMemoryCursor
data_source='qbe_trasfope_controllo_totale.vqr
father=O1011
fatherSonIndex=0
mem_curs_name='mcqbe_trasfope_controllo_totale
obj='MemoryCursor
pag=2
par_expr=[
'w_cdaope
'w_c_aope
'pInform
'_nx
'_sx
]
par_name=[
'w_cdaope
'w_c_aope
'pInform
'_nx
'_sx
]
sel_name='qbe_trasfope_controllo_totale
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O1008
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1009
fatherSonIndex=0
frm_calc='0
len=1
name='_nx
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_sx
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=2
prev=O1275
sel_name='qbe_trasf_ope_sx
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1277
fatherSonIndex=0
frm_calc='iif(qbe_trasf_ope_sx->TOTALE>0,1,0)
len=1
name='_sx
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=2
prev=O1274
sel_name='qbe_trasf_ope_nx
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1275
fatherSonIndex=0
frm_calc='iif(qbe_trasf_ope_nx->TOTALE>0,1,0)
len=1
name='_nx
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O1273
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O1007
var_op='asgn
I
obj='Var
pag=2
prev=O1006
var_op='asgn
I
obj='Var
pag=2
prev=O1005
var_op='asgn
I
obj='Var
pag=2
prev=O1004
var_op='asgn
I
obj='Var
pag=2
prev=O1003
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O1002
var_op='asgn
I
obj='Var
pag=2
prev=O1001
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O1000
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O999
var_op='asgn
I
obj='Remark
pag=2
prev=O998
I
obj='Var
obj_type='MC
pag=2
pagelocal=True
x=8
y=7
I
Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=2
par_expr=[
'w_cdaope
'w_c_aope
'pInform
]
par_name=[
'w_cdaope
'w_c_aope
'pInform
]
sel_name='qbe_trasfope_controllo_totale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1288
fatherSonIndex=0
frm_calc='qbe_trasfope_controllo_totale->TOTALE
len=10
name='_totale
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
x=681
y=312
I
Icpitembatch.CPVarDecl
comment='Frazionate definitive con lo stesso rifimp o inform
frm_seek='qbe_trasffra_controllo_totale.vqr
name='mcqbe_trasffra_controllo_totale
next=Icpitembatch.CPRemark
frm_calc='Scorre la query e trasferisce i dati
next=Icpitembatch.CPVarDecl
frm_calc='pDatIni
len=8
name='w_DaDatOpe
next=Icpitembatch.CPVarDecl
frm_calc='pDatFin
len=8
name='w_ADatOpe
next=Icpitembatch.CPVarDecl
frm_calc='pForza
len=1
name='w_flgforce
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Selezione record da elaborare..."
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(w_DaDatOpe) or DateToChar(w_DaDatOpe)='01000101','',DateToChar(w_DaDatOpe))
len=8
name='w_cdaope
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(w_ADatOpe) or DateToChar(w_ADatOpe)='01000101','',DateToChar(w_ADatOpe))
len=8
name='w_c_aope
next=Icpitembatch.CPVarDecl
frm_calc='''
len=8
name='w_cdareg
next=Icpitembatch.CPVarDecl
frm_calc='''
len=8
name='w_c_areg
next=Icpitembatch.CPBeginEnd
h=[
19
19
]
obj='Begin
pag=3
prev=O1305
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1306
fatherSonIndex=0
frm_calc='0
len=10
name='_totale
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgforce <> 'S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'mcqbe_trasffra_controllo_totale.IsEmpty()
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O1311
sons=[
Icpitembatch.CPItemSon
comment='_totale=0
instr=Icpitembatch.CPSelect
father=O1314
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Trasferite '+LRTrim(Str(_conta,10,0))+" frazionate" + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'_conta_err>0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Elaborazione Terminata con successo."
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
pag=3
prev=O1322
var_op='asgn
I
obj='If
pag=3
prev=O1321
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1322
fatherSonIndex=0
frm_calc='gMsgProc + 'Bloccate '+LRTrim(Str(_conta_err,10,0))+" frazionate per anomalie riscontrate. Consultare la stampa dei errori" + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1319
var_op='asgn
I
obj='Select
pag=3
par_expr=[
'w_cdaope
'w_c_aope
'pInform
]
par_name=[
'w_cdaope
'w_c_aope
'pInform
]
sel_name='qbe_trasffra_datope
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1319
fatherSonIndex=0
frm_calc='DateToChar(qbe_trasffra_datope->DATAOPE)
len=8
name='w_datreg
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_tot < 5000
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='_contacicli
next=Icpitembatch.CPWhile
frm_calc='_contacicli<=_cicli
h=[
19
19
]
obj='While
pag=3
prev=O1340
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1341
fatherSonIndex=0
frm_calc=[
'_cicli = 1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Lettura frazionate in corso ... Ciclo N. '+LRTrim(Str(_contacicli,10,0))
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'_top>=_min
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_contacicli+1
len=10
name='_contacicli
obj='Var
obj_type='N
pag=3
prev=O1349
var_op='asgn
I
obj='If
pag=3
prev=O1348
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1349
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=3
sel_name='qbe_trasffra_idbase_fra
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1355
fatherSonIndex=0
frm_calc='qbe_trasffra_idbase_fra->IDBASE
len=10
name='w_idbase
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=3
prev=O1359
sel_field='*
sel_name='xraziobo
sel_where='xraziobo->IDBASE=w_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1360
fatherSonIndex=0
frm_calc='True 
len=1
name='_passato_il_check
next=Icpitembatch.CPIfElse
frm_calc=[
'fai_controlli
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_passato_il_check
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O1365
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O1368
fatherSonIndex=0
frm_calc='Calcol i nuovi progressivi
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='idb2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(gAzienda)+"'",Space(10),10)
len=10
name='cProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PFRAZIO2\'"+LRTrim(gAzienda)+"'",Space(11),11)
len=11
name='cProg2
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datareg
next=Icpitembatch.CPInsert
arch='fraziobo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='xraziobo
next=Icpitembatch.CPVarDecl
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Sono state trasferite "+LRTrim(Str(_conta,10,0))+"  frazionate"
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
pag=3
prev=O1392
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1391
var_op='asgn
I
obj='Delete
pag=3
prev=O1389
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'w_idbase
]
I
obj='Select
pag=3
prev=O1387
sel_field='*
sel_name='xocfrabo
sel_where='xocfrabo->NUMPROG=xraziobo->NUMPROG
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='docfrabo
father=O1389
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='xocfrabo
obj='Delete
pag=3
prev=O1399
rd_kfield=[
'NUMPROG
'CONNESCLI
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xocfrabo->NUMPROG
'xocfrabo->CONNESCLI
]
I
obj='Insert
pag=3
rd_kfield=[
'NUMPROG
'CONNESCLI
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DATAVALI
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kvar=[
'cProg2
'xocfrabo->CONNESCLI
'xocfrabo->TIPODOC
'xocfrabo->NUMDOCUM
'xocfrabo->DATARILASC
'xocfrabo->AUTRILASC
'xocfrabo->DATAVALI
'xocfrabo->DOMICILIO
'xocfrabo->DESCCIT
'xocfrabo->PROVINCIA
'xocfrabo->PAESE
'xocfrabo->CAP
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=3
prev=O1385
sel_field='*
sel_name='xerzistifrz
sel_where='xerzistifrz->IDFILEBO=xraziobo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistifrz
father=O1387
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='xerzistifrz
obj='Delete
pag=3
prev=O1409
rd_kfield=[
'IDFILEBO
'CODSOG
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xerzistifrz->IDFILEBO
'xerzistifrz->CODSOG
]
I
obj='Insert
pag=3
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'cProg1
'xerzistifrz->CODSOG
'xerzistifrz->TIPOFILE
'xerzistifrz->NUMCOL
'xerzistifrz->LEGAME
'xerzistifrz->RAPCOL
'xerzistifrz->UCODE
'xerzistifrz->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=3
prev=O1383
sel_field='*
sel_name='xeneficfrz
sel_where='xeneficfrz->IDFILEBO=xraziobo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficfrz
father=O1385
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='xeneficfrz
obj='Delete
pag=3
prev=O1419
rd_kfield=[
'IDFILEBO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xeneficfrz->IDFILEBO
'xeneficfrz->CPROWNUM
]
I
obj='Insert
pag=3
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
rd_kvar=[
'cProg1
'xeneficfrz->CPROWNUM
'xeneficfrz->CODSOG
'xeneficfrz->TIPOFILE
'xeneficfrz->NUMCOL
'xeneficfrz->LEGAME
'xeneficfrz->RAPCOL
'xeneficfrz->UCODE
'xeneficfrz->IDBASE
'xeneficfrz->C_RAG
'xeneficfrz->C_STA
'xeneficfrz->C_CTA
'xeneficfrz->C_CAB
'xeneficfrz->C_PRV
'xeneficfrz->C_IND
'xeneficfrz->C_CAP
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=3
prev=O1381
sel_field='*
sel_name='xlientifrz
sel_where='xlientifrz->IDFILEBO=xraziobo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientifrz
father=O1383
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='xlientifrz
obj='Delete
pag=3
prev=O1429
rd_kfield=[
'IDFILEBO
'CODSOG
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xlientifrz->IDFILEBO
'xlientifrz->CODSOG
]
I
obj='Insert
pag=3
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'cProg1
'xlientifrz->CODSOG
'xlientifrz->TIPOFILE
'xlientifrz->NUMCOL
'xlientifrz->LEGAME
'xlientifrz->RAPCOL
'xlientifrz->UCODE
'xlientifrz->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=3
prev=O1379
sel_field='*
sel_name='xogopefbo
sel_where='xogopefbo->IDFILEBO=xraziobo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sogopefbo
father=O1381
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='xogopebo
obj='Delete
pag=3
prev=O1439
rd_kfield=[
'IDFILEBO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xogopefbo->IDFILEBO
'xogopefbo->CPROWNUM
]
I
obj='Insert
pag=3
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
]
rd_kvar=[
'cProg1
'xogopefbo->CPROWNUM
'xogopefbo->CODSOG
'xogopefbo->LEGAME
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=3
prev=O1378
sel_field='*
sel_name='xraziobo_agg
sel_where='xraziobo_agg->IDBASE=w_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='fraziobo_agg
father=O1379
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='xraziobo_agg
obj='Delete
pag=3
prev=O1449
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'w_idbase
]
I
obj='Insert
pag=3
rd_kfield=[
'IDBASE
'CODLOB
'TIPOGIOCO
'CACODICE
'IDBIGLIETTO
'CADATAORA
'CATIPGIO
'CATIPCON
'CAPV_COD
'IDDOCALL
'VPCODICE
'WUDATRET
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
'FLAGFRAUD
'SV58724
'SV58726SCA
'SV58726SA
'SV58726PISP
'C_COGNOME
'C_NOME
'SOSPAGAM
]
rd_kvar=[
'cProg1
'xraziobo_agg->CODLOB
'xraziobo_agg->TIPOGIOCO
'xraziobo_agg->CACODICE
'xraziobo_agg->IDBIGLIETTO
'xraziobo_agg->CADATAORA
'xraziobo_agg->CATIPGIO
'xraziobo_agg->CATIPCON
'xraziobo_agg->CAPV_COD
'xraziobo_agg->IDDOCALL
'xraziobo_agg->VPCODICE
'xraziobo_agg->WUDATRET
'xraziobo_agg->CATEG01
'xraziobo_agg->CATEG02
'xraziobo_agg->CATEG03
'xraziobo_agg->CATEG04
'xraziobo_agg->CATEG05
'xraziobo_agg->CATEGORIA
'xraziobo_agg->FLAGFRAUD
'xraziobo_agg->SV58724
'xraziobo_agg->SV58726SCA
'xraziobo_agg->SV58726SA
'xraziobo_agg->SV58726PISP
'xraziobo_agg->C_COGNOME
'xraziobo_agg->C_NOME
'xraziobo_agg->SOSPAGAM
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=3
prev=O1377
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'AUTOM
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESDOC
'CONNESOPER
'DAC6
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGDAC6
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'IDBASE2
'idcauana
'IDEREG
'IDFILE
'IMPIN
'IMPOUT
'IMPSARA
'INFORM
'IPCOLLEG
'MITIGDOC
'MITIG
'MODSVOL
'MTCN
'NATURA
'NOPROT
'NOSARA
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPFRZ
'PROQUOTA
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RISGLOB
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'SV58550
'SV58550MA
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TIPOORO
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
'MEZPAG
'PRESTAZ
'CAUSALE
'VASP
]
rd_kvar=[
'xraziobo->AMMONT
'xraziobo->ANNOOPE
'xraziobo->AREAGEO
'xraziobo->AUTOM
'xraziobo->C_CAB
'xraziobo->C_CAP
'xraziobo->C_CTA
'xraziobo->C_IND
'xraziobo->C_PRV
'xraziobo->C_RAG
'xraziobo->C_RAPPORTO
'xraziobo->C_STA
'xraziobo->CAMBIO
'xraziobo->CDATAOPE
'xraziobo->CDATOPE
'DateToChar(_datareg)
'xraziobo->CODANA
'xraziobo->CODCAB
'xraziobo->CODCAB2
'xraziobo->CODDIPE
'xraziobo->CODINT2
'xraziobo->CODINTER
'xraziobo->CODVOC
'xraziobo->COLLEG
'xraziobo->CONNALTRO
'xraziobo->CONNESBEN
'xraziobo->CONNESCLI
'xraziobo->CONNESDOC
'xraziobo->CONNESOPER
'xraziobo->DAC6
'xraziobo->DATAOPE
'_datareg
'xraziobo->DATARETT
'xraziobo->DESC2
'xraziobo->DESCCIT
'xraziobo->DESCINTER
'xraziobo->DOCFILE
'xraziobo->DUCOLLEG
'xraziobo->DURAT
'xraziobo->FLAGCONT
'xraziobo->FLAGDAC6
'xraziobo->FLAGFRAZ
'xraziobo->FLAGLIRE
'xraziobo->FLAGRAP
'xraziobo->FLAGRAP2
'cProg1
'idb2
'xraziobo->idcauana
''F'+Right(cProg2,9)+idb2
'xraziobo->IDFILE
'xraziobo->IMPIN
'xraziobo->IMPOUT
'xraziobo->IMPSARA
'xraziobo->INFORM
'xraziobo->IPCOLLEG
'xraziobo->MITIGDOC
'xraziobo->MITIG
'xraziobo->MODSVOL
'xraziobo->MTCN
'xraziobo->NATURA
'xraziobo->NOPROT
'xraziobo->NOSARA
'cProg2
'xraziobo->OPERAG
'xraziobo->OPERATORE
'xraziobo->OPERAZMOD
'xraziobo->OPRAP
'xraziobo->ORACOLLEG
'xraziobo->PAESE
'xraziobo->PAGASOGOP
'xraziobo->PRGIMPFRZ
'xraziobo->PROQUOTA
'xraziobo->PROV2
'xraziobo->PROVINCIA
'xraziobo->RAGIO
'xraziobo->RAPPORTBEN
'xraziobo->RAPPORTO
'xraziobo->RAREA
'xraziobo->RCOMP
'xraziobo->RESPINS
'xraziobo->RFREQ
'xraziobo->RIFIMP
'xraziobo->RIMP
'xraziobo->RISGLOB
'xraziobo->RRAGIO
'xraziobo->RTIPO
'xraziobo->SCOPO
'xraziobo->SEGNO
'xraziobo->STATOREG
'xraziobo->SV58550
'xraziobo->SV58550MA
'xraziobo->TIPO
'xraziobo->TIPOINF
'xraziobo->TIPOINT2
'xraziobo->TIPOINTER
'xraziobo->TIPOLEG
'xraziobo->TIPOOPRAP
'xraziobo->TIPOORO
'xraziobo->TOTCONT
'xraziobo->TOTLIRE
'xraziobo->UCODE
'xraziobo->UNIQUECODE
'xraziobo->VALUTA
'xraziobo->ZCPARTE
'xraziobo->MEZPAG
'xraziobo->PRESTAZ
'xraziobo->CAUSALE
'xraziobo->VASP
]
I
obj='Var
obj_type='D
pag=3
prev=O1376
var_op='asgn
I
obj='Var
pag=3
prev=O1375
var_op='asgn
I
obj='Var
pag=3
prev=O1374
var_op='asgn
I
obj='Var
pag=3
prev=O1373
var_op='asgn
I
obj='Remark
pag=3
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O1368
fatherSonIndex=1
frm_calc='Check non passato :(
next=Icpitembatch.CPVarDecl
frm_calc='_conta_err+1
name='_conta_err
next=Icpitembatch.CPVarDecl
frm_seek='AppendBlank
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='xraziobo->NUMPROG
frm_seek='ERCODICE
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='_error_string
frm_seek='ERDESCRI
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcErrori
obj='Var
obj_type='MC
pag=3
prev=O1464
var_op='meth
I
obj='Var
obj_type='MC
pag=3
prev=O1463
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O1462
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O1461
var_op='meth
I
obj='Var
obj_type='N
pag=3
prev=O1460
var_op='asgn
I
obj='Remark
pag=3
I
I
]
w=[
150
150
150
]
I
obj='If
pag=3
prev=O1364
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='controlli vari
father=O1365
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Substr(_error_string,2,Len(_error_string)-2)+"."
name='_error_string
obj='Var
pag=3
prev=O1469
var_op='asgn
I
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1469
fatherSonIndex=0
frm_calc='''
name='_error_string
next=Icpitembatch.CPIfElse
frm_calc=[
'(DateDiff(xraziobo->DATAOPE, _date_oggi))>(20*365)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xraziobo->DATAOPE>_date_oggi
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='CODANA+CODVOC+SEGNO
frm_calc='""+LRTrim(xraziobo->CODANA)+LRTrim(xraziobo->CODVOC)+LRTrim(xraziobo->SEGNO)
name='_tmp
next=Icpitembatch.CPIfElse
frm_calc=[
'not(mcCauana.HasKey(_tmp))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='""
name='_tmp
obj='Var
pag=3
prev=O1482
var_op='asgn
I
obj='If
pag=3
prev=O1481
sons=[
Icpitembatch.CPItemSon
comment='Causale Analitica o Causale Sintetica o Segno
instr=Icpitembatch.CPVarDecl
father=O1482
fatherSonIndex=0
frm_calc='_error_string+' Anomalia sui campi Causale Analitica e/o Causale Sintetica e/o Segno,'
name='_error_string
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_passato_il_check
obj='Var
obj_type='L
pag=3
prev=O1488
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O1478
var_op='asgn
I
obj='If
pag=3
prev=O1475
sons=[
Icpitembatch.CPItemSon
comment='Data Operazione maggiore della Data odierna
instr=Icpitembatch.CPVarDecl
father=O1478
fatherSonIndex=0
frm_calc='_error_string+' Data Operazione maggiore della Data odierna,'
name='_error_string
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_passato_il_check
obj='Var
obj_type='L
pag=3
prev=O1493
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1474
sons=[
Icpitembatch.CPItemSon
comment='Data Operazione più vecchia di 20 Anni
instr=Icpitembatch.CPVarDecl
father=O1475
fatherSonIndex=0
frm_calc='' Data Operazione più vecchia di 20 Anni,'
name='_error_string
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='_passato_il_check
obj='Var
obj_type='L
pag=3
prev=O1498
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='L
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O1349
fatherSonIndex=1
frm_calc=''Lettura frazionate in corso ...'
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
pag=3
prev=O1345
var_op='asgn
I
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1345
fatherSonIndex=0
frm_calc='_min
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_max
len=15
name='_top
obj='Var
obj_type='N
pag=3
prev=O1510
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1345
fatherSonIndex=1
frm_calc='((_contacicli -1 ) * 5000) + 1
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_contacicli * 5000
len=15
name='_top
obj='Var
obj_type='N
pag=3
prev=O1513
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O1337
var_op='asgn
I
obj='If
pag=3
prev=O1335
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1337
fatherSonIndex=0
frm_calc='iif(_tot=0,0,1)
len=10
name='_cicli
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1337
fatherSonIndex=1
frm_calc='iif(Mod(_max,5000) <> 0,Int(_max/5000) + 1,Int(_max/5000))
len=10
name='_cicli
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=3
par_expr=[
'w_datreg
]
par_name=[
'w_datreg
]
prev=O1334
sel_name='qbe_trasffra_count_fra
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1335
fatherSonIndex=0
frm_calc='qbe_trasffra_count_fra->MINOPE
len=10
name='_min
next=Icpitembatch.CPVarDecl
frm_calc='qbe_trasffra_count_fra->MAXOPE
len=10
name='_max
next=Icpitembatch.CPVarDecl
frm_calc='qbe_trasffra_count_fra->TOTOPE
len=10
name='_tot
obj='Var
obj_type='N
pag=3
prev=O1528
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1527
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Vecchio inserimento
father=O1314
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPForEach
for_variable='rwqbe_trasffra_controllo_totale
for_variable_type='qbe_trasffra_controllo_totale.vqr
h=[
19
19
]
iterator_expr='mcqbe_trasffra_controllo_totale
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Il trasferimento è stato bloccato in quanto sono state trovate operazioni frazionate con gli stessi riferimenti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Elaborazione Abortita."
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
pag=3
prev=O1537
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1535
var_op='asgn
I
obj='ForEach
pag=3
prev=O1533
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1535
fatherSonIndex=0
frm_seek='AppendBlank
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='""
frm_seek='ERCODICE
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='"Riferimento1: "+LRTrim(rwqbe_trasffra_controllo_totale.RIFIMP)+" Riferimento2: "+LRTrim(rwqbe_trasffra_controllo_totale.INFORM)+" Riscontrati sull'operazione definitiva con numero progressivo: "+LRTrim(rwqbe_trasffra_controllo_totale.NUMPROG)
frm_seek='ERDESCRI
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcErrori
obj='Var
obj_type='MC
pag=3
prev=O1543
var_op='meth
I
obj='Var
obj_type='MC
pag=3
prev=O1542
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O1541
var_op='prop
I
obj='Var
obj_type='MC
pag=3
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1533
fatherSonIndex=0
frm_seek='AppendBlank
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='""
frm_seek='ERCODICE
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='"Il trasferimento è stato bloccato in quanto sono state trovate operazioni frazionate con gli stessi riferimenti"
frm_seek='ERDESCRI
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcErrori
obj='Var
obj_type='MC
pag=3
prev=O1550
var_op='meth
I
obj='Var
obj_type='MC
pag=3
prev=O1549
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O1548
var_op='prop
I
obj='Var
obj_type='MC
pag=3
var_op='meth
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=3
prev=O1310
sons=[
Icpitembatch.CPItemSon
instr=Ispitembatch.CPMemoryCursor
data_source='qbe_trasffra_controllo_totale.vqr
father=O1311
fatherSonIndex=0
mem_curs_name='mcqbe_trasffra_controllo_totale
obj='MemoryCursor
pag=3
par_expr=[
'w_cdaope
'w_c_aope
'pInform
]
par_name=[
'w_cdaope
'w_c_aope
'pInform
]
sel_name='qbe_trasffra_controllo_totale
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O1304
var_op='asgn
I
obj='Var
pag=3
prev=O1303
var_op='asgn
I
obj='Var
pag=3
prev=O1302
var_op='asgn
I
obj='Var
pag=3
prev=O1301
var_op='asgn
I
nonlocal=True
obj='Var
pag=3
prev=O1300
var_op='asgn
I
obj='Var
pag=3
prev=O1299
var_op='asgn
I
obj='Var
obj_type='D
pag=3
prev=O1298
var_op='asgn
I
obj='Var
obj_type='D
pag=3
prev=O1297
var_op='asgn
I
obj='Remark
pag=3
prev=O1296
I
obj='Var
obj_type='MC
pag=3
pagelocal=True
x=2
y=7
I
]
comment='Trasferimento da provvisorio a definitivo con stampa errori
date_creat=#2021-07-05
date_rev=#2023-11-13
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'Utilities
]
modcnt=87
page_result_class=[
'
'
'
'
'
'
]
page_result_type=[
'U
'U
'U
'U
'U
'U
]
page_uid=[
'PIGKNZUFIB
'XHZNNGZKRP
'WFRBHWXCVY
'UHJMLCEJVZ
'ZFTEKFMWCP
'WAFQMJQWFQ
]
pagename=[
'main
'ope
'fraz
'rapp
'info
'tito
]
pagenote=[
'
'
'
'
'
'
]
pagetitle=[
'Main
'Operazioni
'Frazionate
'Rapporti
'Informazioni
'Titolari
]
result_class='mcErrMCF.MCRDef
result_type='MC
runtime_filters=2
tpl_name='Function
work_file=[
'aetesta
'anarapbo
'beneficfrz
'beneficope
'clientifrz
'clientiope
'delegabo
'docfrabo
'docopebo
'fiduciabo
'fraziobo
'fraziobo_agg
'intermbo
'intestbo
'intestit
'knarapbo
'operazbo
'operazbo_agg
'personbo
'rapcoll
'rapopebo
'rapotit
'soginfo
'sogopebo
'sogopefbo
'storico_import
'terzistifrz
'terzistiope
'terzistirap
'xapcoll
'xapopebo
'xapotit
'xelegabo
'xeneficfrz
'xeneficope
'xerzistifrz
'xerzistiope
'xerzistirap
'xiduciabo
'xlientifrz
'xlientiope
'xnarapbo
'xntestbo
'xntestit
'xocfrabo
'xocopebo
'xoginfo
'xogopebo
'xogopefbo
'xperazbo
'xperazbo_agg
'xraziobo
'xraziobo_agg
]
work_filter=[
'
'
'
'
]
I
*--*
*----*
