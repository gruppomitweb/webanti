* --- CodePainter Revolution Batch Vers. 4.7
Icpbatch.CPBatch
Items=[
Icpitembatch.CPRemark
frm_calc='Dichiarazione variabili del caller
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili caller
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Definizione variabili locali
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili Locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='variabili copia
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='variabili locali per decoprimere il file
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili globali
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Legge dati intermediario per metteri su operazbo,fraziobo,rapopebo se mancanti
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Import Soggetti
next=Icpitembatch.CPVarDecl
frm_calc='''
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPRemark
frm_calc='Cicla sul file della lista e lancia la pagina appropriata
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_esito
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_opeerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_frzerr
next=Icpitembatch.CPIfElse
frm_calc=[
'w_impzip=1
]
h=[
19
19
]
obj='If
pag=1
prev=O25
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDropTemporaryTable
father=O26
fatherSonIndex=0
next=Icpitembatch.CPServerTemporaryTable
next=Icpitembatch.CPExec
check='page
frm_calc='27
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_chkerr
next=Icpitembatch.CPIfElse
frm_calc=[
'w_chkaui='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_chkaui = 'N' or (w_chkaui='S' and w_imperr='S') or  (w_chkaui='S' and w_imperr='N' and _chkerr=0)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O35
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O38
fatherSonIndex=0
frm_calc='FileLibMit.OpenWrite('./output/'+LRTrim(gAzienda)+'/archope_scarti')
len=1
name='ohand
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWrite('./output/'+LRTrim(gAzienda)+'/archfraz_scarti')
len=1
name='zhand
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWrite('./output/'+LRTrim(gAzienda)+'/opex_scarti')
len=1
name='xhand
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWrite('./output/'+LRTrim(gAzienda)+'/saldopex_scarti')
len=1
name='shand
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
obj='Try
pag=1
prev=O47
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O48
fatherSonIndex=0
frm_calc=[
'gFlgRet='S'
]
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione dati. Inizio fase di commit. Attendere prego...'
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'_esito=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPBeginEnd
comment='Scrittura file con errori
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Importazione dati terminata.'
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O61
var_op='asgn
I
obj='Begin
pag=1
prev=O58
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O61
fatherSonIndex=0
frm_calc='FileLibMit.Close(ohand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(zhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(xhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(shand)
next=Icpitembatch.CPIfElse
frm_calc=[
'_opeerr=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_frzerr=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_opxerr=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_soxerr=0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O76
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPExec
father=O79
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/saldopex_scarti')
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O79
fatherSonIndex=1
frm_calc='1
len=1
name='w_fscarti
next=Icpitembatch.CPVarDecl
frm_calc='"saldopex_scarti.zip"
len=20
name='_czip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/"+_czip
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/saldopex_scarti"
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='"saldopex_scarti"
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc="// These are the files to include in the ZIP file
filenames.clear();
fileonames.clear();
filenames.add(cNomeFile);
fileonames.add(cOnlyNomeFile);
°--°
next=Icpitembatch.CPExec
check='page
frm_calc='36
next=Icpitembatch.CPInsert
arch='tmp_listafile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevate operazioni extraconto senza i dati del soggetto. Prelevare il file opex_scarti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/opex_scarti')
obj='Exec
pag=1
prev=O94
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O93
var_op='asgn
I
obj='Insert
pag=1
prev=O92
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
''opex_scarti'
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/opex_scarti.zip"
]
I
obj='Exec
pag=1
prev=O91
I
obj='Exec
pag=1
prev=O90
I
obj='Var
pag=1
prev=O89
var_op='asgn
I
obj='Var
pag=1
prev=O88
var_op='asgn
I
obj='Var
pag=1
prev=O87
var_op='asgn
I
obj='Var
pag=1
prev=O86
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=1
prev=O73
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O76
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/opex_scarti')
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O76
fatherSonIndex=1
frm_calc='1
len=1
name='w_fscarti
next=Icpitembatch.CPVarDecl
frm_calc='"opex_scarti.zip"
len=20
name='_czip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/"+_czip
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/opex_scarti"
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='"opex_scarti"
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc="// These are the files to include in the ZIP file
filenames.clear();
fileonames.clear();
filenames.add(cNomeFile);
fileonames.add(cOnlyNomeFile);
°--°
next=Icpitembatch.CPExec
check='page
frm_calc='36
next=Icpitembatch.CPInsert
arch='tmp_listafile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevate operazioni extraconto senza i dati del soggetto. Prelevare il file opex_scarti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/opex_scarti')
obj='Exec
pag=1
prev=O111
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O110
var_op='asgn
I
obj='Insert
pag=1
prev=O109
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
''opex_scarti'
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/opex_scarti.zip"
]
I
obj='Exec
pag=1
prev=O108
I
obj='Exec
pag=1
prev=O107
I
obj='Var
pag=1
prev=O106
var_op='asgn
I
obj='Var
pag=1
prev=O105
var_op='asgn
I
obj='Var
pag=1
prev=O104
var_op='asgn
I
obj='Var
pag=1
prev=O103
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=1
prev=O70
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O73
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/archfraz_scarti')
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O73
fatherSonIndex=1
frm_calc='1
len=1
name='w_fscarti
next=Icpitembatch.CPVarDecl
frm_calc='"archfraz_scarti.zip"
len=20
name='_czip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/"+_czip
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/archfraz_scarti"
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='"archfraz_scarti"
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc="// These are the files to include in the ZIP file
filenames.clear();
fileonames.clear();
filenames.add(cNomeFile);
fileonames.add(cOnlyNomeFile);
°--°
next=Icpitembatch.CPExec
check='page
frm_calc='36
next=Icpitembatch.CPInsert
arch='tmp_listafile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevate frazionate senza i dati del soggetto. Prelevare il file archfraz_scarti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/archfraz_scarti')
obj='Exec
pag=1
prev=O128
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O127
var_op='asgn
I
obj='Insert
pag=1
prev=O126
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
''archfraz_scarti'
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/archfraz_scarti.zip"
]
I
obj='Exec
pag=1
prev=O125
I
obj='Exec
pag=1
prev=O124
I
obj='Var
pag=1
prev=O123
var_op='asgn
I
obj='Var
pag=1
prev=O122
var_op='asgn
I
obj='Var
pag=1
prev=O121
var_op='asgn
I
obj='Var
pag=1
prev=O120
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=1
prev=O69
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O70
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/archope_scarti')
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O70
fatherSonIndex=1
frm_calc='1
len=1
name='w_fscarti
next=Icpitembatch.CPVarDecl
frm_calc='"archope_scarti.zip"
len=20
name='_czip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/"+_czip
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/archope_scarti"
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='"archope_scarti"
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc="// These are the files to include in the ZIP file
filenames.clear();
fileonames.clear();
filenames.add(cNomeFile);
fileonames.add(cOnlyNomeFile);
°--°
next=Icpitembatch.CPExec
check='page
frm_calc='36
next=Icpitembatch.CPInsert
arch='tmp_listafile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevate operazioni senza i dati del soggetto. Prelevare il file archope_scarti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/archope_scarti')
obj='Exec
pag=1
prev=O145
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O144
var_op='asgn
I
obj='Insert
pag=1
prev=O143
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
''archope_scarti'
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/archope_scarti.zip"
]
I
obj='Exec
pag=1
prev=O142
I
obj='Exec
pag=1
prev=O141
I
obj='Var
pag=1
prev=O140
var_op='asgn
I
obj='Var
pag=1
prev=O139
var_op='asgn
I
obj='Var
pag=1
prev=O138
var_op='asgn
I
obj='Var
pag=1
prev=O137
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=1
prev=O68
I
obj='Exec
pag=1
prev=O67
I
obj='Exec
pag=1
prev=O66
I
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O57
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O58
fatherSonIndex=0
frm_calc='commit
obj='Transaction
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O58
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=1
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O55
var_op='asgn
I
obj='Select
pag=1
prev=O52
sel_field='*
sel_name='tmp_list_imprich
sel_order='tmp_list_imprich->priorita,tmp_list_imprich->nomefile
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O55
fatherSonIndex=0
frm_calc=[
'_esito = 0
]
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='tmp_list_imprich
obj='Delete
pag=1
prev=O159
rd_kfield=[
'nomefile
]
rd_kop=[
'=
]
rd_kvar=[
'tmp_list_imprich->nomefile
]
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O159
fatherSonIndex=0
frm_calc='LRTrim(tmp_list_imprich->nomefile)
len=50
name='nomefileimport
next=Icpitembatch.CPCase
frm_calc=[
'At('archpers.txt',Lower(nomefileimport)) <> 0
'At('archdip.txt',Lower(nomefileimport)) <> 0
'At('archtito.txt',Lower(nomefileimport)) <> 0
'At('sogcli.txt',Lower(nomefileimport)) <> 0
'At('archrap.txt',Lower(nomefileimport)) <> 0
'At('archinf.txt',Lower(nomefileimport)) <> 0
'At('archope.txt',Lower(nomefileimport)) <> 0
'At('archfraz.txt',Lower(nomefileimport)) <> 0
'At('intest.txt',Lower(nomefileimport)) <> 0
'At('rapage.txt',Lower(nomefileimport)) <> 0
'At('infage.txt',Lower(nomefileimport)) <> 0
'At('opeage.txt',Lower(nomefileimport)) <> 0
'At('procdel.txt',Lower(nomefileimport)) <> 0
'At('procage.txt',Lower(nomefileimport)) <> 0
'At('sogope.txt',Lower(nomefileimport)) <> 0
'At('sogage.txt',Lower(nomefileimport)) <> 0
'At('intage.txt',Lower(nomefileimport)) <> 0
'At('sogben.txt',Lower(nomefileimport)) <> 0
'At('sogaltro.txt',Lower(nomefileimport)) <> 0
'At('persnew.txt',Lower(nomefileimport)) <> 0
'At('saldopex.txt',Lower(nomefileimport)) <> 0
'At('saldrapp.txt',Lower(nomefileimport)) <> 0
'At('opex.txt',Lower(nomefileimport)) <> 0
'At('titosupp.txt',Lower(nomefileimport)) <> 0
]
h=[
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
]
obj='Case
pag=1
prev=O168
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O169
fatherSonIndex=0
frm_calc='2
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O169
fatherSonIndex=1
frm_calc='14
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O169
fatherSonIndex=2
frm_calc='15
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O169
fatherSonIndex=3
frm_calc='26
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O169
fatherSonIndex=4
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O182
fatherSonIndex=0
frm_calc='7
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O182
fatherSonIndex=1
frm_calc='3
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O169
fatherSonIndex=5
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O192
fatherSonIndex=0
frm_calc='8
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O192
fatherSonIndex=1
frm_calc='4
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O169
fatherSonIndex=6
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O202
fatherSonIndex=0
frm_calc='9
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O202
fatherSonIndex=1
frm_calc='5
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O169
fatherSonIndex=7
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O212
fatherSonIndex=0
frm_calc='10
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O212
fatherSonIndex=1
frm_calc='6
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O169
fatherSonIndex=8
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O222
fatherSonIndex=0
frm_calc='22
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O222
fatherSonIndex=1
frm_calc='19
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O169
fatherSonIndex=9
frm_calc='11
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O169
fatherSonIndex=10
frm_calc='12
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O169
fatherSonIndex=11
frm_calc='13
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O169
fatherSonIndex=12
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O238
fatherSonIndex=0
frm_calc='20
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O238
fatherSonIndex=1
frm_calc='17
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O169
fatherSonIndex=13
frm_calc='23
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O169
fatherSonIndex=14
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O250
fatherSonIndex=0
frm_calc='21
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O250
fatherSonIndex=1
frm_calc='18
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O169
fatherSonIndex=15
frm_calc='24
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O169
fatherSonIndex=16
frm_calc='25
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O169
fatherSonIndex=17
frm_calc='28
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O169
fatherSonIndex=18
frm_calc='29
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O169
fatherSonIndex=19
frm_calc='30
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O169
fatherSonIndex=20
frm_calc='33
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O169
fatherSonIndex=21
frm_calc='34
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O169
fatherSonIndex=22
frm_calc='16
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O169
fatherSonIndex=23
frm_calc='35
obj='Exec
pag=1
I
I
]
w=[
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
]
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intermbo
father=O52
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='xersonbo
next=Icpitembatch.CPDelete
arch='xarchope
next=Icpitembatch.CPDelete
arch='xarchfraz
next=Icpitembatch.CPDelete
arch='xnadip
obj='Delete
pag=1
prev=O285
sel_type='all
I
obj='Delete
pag=1
prev=O284
sel_type='all
I
obj='Delete
pag=1
prev=O283
sel_type='all
I
obj='Delete
pag=1
prev=O282
sel_type='all
I
obj='Write
pag=1
sel_type='all
wr_field=[
'SBLRITORNO
]
wr_op=[
'=
]
wr_var=[
''N'
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O48
fatherSonIndex=1
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Rilevati errori nell'impotazione dei file! Ricreare il file segnalato e rieseguire l'import dei dati. La procedura annullera automaticamente l'importazione" + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Errore SQL: ' + m_Sql.TransactionErrorMessage() + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='rollback
obj='Transaction
pag=1
prev=O294
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O293
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O292
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=1
prev=O46
I
obj='Var
pag=1
prev=O45
var_op='asgn
I
obj='Var
pag=1
prev=O44
var_op='asgn
I
obj='Var
pag=1
prev=O43
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O38
fatherSonIndex=1
frm_calc='gMsgProc + 'Sono stati rilevati errori nei dati anagrafici. Effettuare la stampa' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Elaborazione terminata.'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=1
prev=O298
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=1
prev=O34
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O35
fatherSonIndex=0
frm_calc='32
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O33
var_op='asgn
I
obj='Exec
pag=1
prev=O32
I
obj='TempTable
pag=1
prev=O31
sel_type='def
server_table='tmp_listafile
I
obj='DropTempTable
pag=1
server_table='tmp_listafile
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O24
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O23
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O22
var_op='asgn
I
obj='Remark
pag=1
prev=O21
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O20
var_op='asgn
I
obj='Remark
pag=1
prev=O18
I
obj='Select
pag=1
prev=O17
sel_field='*
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O18
fatherSonIndex=0
frm_calc='intermbo->CODINTER
len=11
name='_codinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->DESCCIT
len=30
name='_citinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->CODCAB
len=6
name='_cabinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->PROVINCIA
len=2
name='_prvinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->FLGOPEXTR
len=1
name='_flgmodi
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->FLGDATAIM
len=1
name='_flgdataim
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->FLGRAPCLI
len=1
name='_frapcli
obj='Var
pag=1
prev=O313
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O312
var_op='asgn
I
obj='Var
pag=1
prev=O311
var_op='asgn
I
obj='Var
pag=1
prev=O310
var_op='asgn
I
obj='Var
pag=1
prev=O309
var_op='asgn
I
obj='Var
pag=1
prev=O308
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=1
prev=O15
I
obj='Begin
pag=1
prev=O13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Path Applicazione
father=O15
fatherSonIndex=0
global=True
len=80
name='gPathApp
next=Icpitembatch.CPVarDecl
comment='URL Applicazione
global=True
len=80
name='gUrlApp
next=Icpitembatch.CPVarDecl
comment='Azienda
global=True
len=10
name='gAzienda
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Flag Creazione File di Ritorno
global=True
len=1
name='gFlgRet
nonlocal=True
obj='Var
pag=1
prev=O322
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O321
I
nonlocal=True
obj='Var
pag=1
prev=O320
I
nonlocal=True
obj='Var
pag=1
prev=O319
I
nonlocal=True
obj='Var
pag=1
prev=O318
I
nonlocal=True
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O11
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O13
fatherSonIndex=0
len=25
name='column01
next=Icpitembatch.CPVarDecl
len=25
name='column02
next=Icpitembatch.CPVarDecl
len=25
name='column03
next=Icpitembatch.CPVarDecl
len=25
name='column04
next=Icpitembatch.CPVarDecl
len=25
name='column05
next=Icpitembatch.CPVarDecl
len=25
name='column06
next=Icpitembatch.CPVarDecl
len=25
name='column07
next=Icpitembatch.CPVarDecl
len=25
name='column08
next=Icpitembatch.CPVarDecl
len=25
name='column09
next=Icpitembatch.CPVarDecl
len=25
name='column10
obj='Var
pag=1
prev=O335
I
obj='Var
pag=1
prev=O334
I
obj='Var
pag=1
prev=O333
I
obj='Var
pag=1
prev=O332
I
obj='Var
pag=1
prev=O331
I
obj='Var
pag=1
prev=O330
I
obj='Var
pag=1
prev=O329
I
obj='Var
pag=1
prev=O328
I
obj='Var
pag=1
prev=O327
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O9
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O11
fatherSonIndex=0
len=100
name='czipfile
next=Icpitembatch.CPVarDecl
len=200
name='cpercorsozip
next=Icpitembatch.CPVarDecl
len=200
name='cdirectoryfile
next=Icpitembatch.CPVarDecl
len=100
name='buffernomefile
next=Icpitembatch.CPVarDecl
len=50
name='nomefileimport
next=Icpitembatch.CPVarDecl
len=3
name='_priorita
obj='Var
obj_type='N
pag=1
prev=O344
I
obj='Var
pag=1
prev=O343
I
obj='Var
pag=1
prev=O342
I
obj='Var
pag=1
prev=O341
I
obj='Var
pag=1
prev=O340
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O7
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O9
fatherSonIndex=0
len=10
name='ciidbase
next=Icpitembatch.CPVarDecl
len=8
name='cidataini
next=Icpitembatch.CPVarDecl
len=8
name='cidatafine
next=Icpitembatch.CPVarDecl
len=12
name='cicodinter
next=Icpitembatch.CPVarDecl
len=11
name='cinumprog
next=Icpitembatch.CPVarDecl
len=1
name='citiporap
obj='Var
pag=1
prev=O353
I
obj='Var
pag=1
prev=O352
I
obj='Var
pag=1
prev=O351
I
obj='Var
obj_type='D
pag=1
prev=O350
I
obj='Var
obj_type='D
pag=1
prev=O349
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O6
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O7
fatherSonIndex=0
len=1
name='fhand
next=Icpitembatch.CPVarDecl
len=1
name='ohand
next=Icpitembatch.CPVarDecl
len=1
name='zhand
next=Icpitembatch.CPVarDecl
len=1
name='xhand
next=Icpitembatch.CPVarDecl
len=1
name='shand
next=Icpitembatch.CPVarDecl
len=10
name='riga
next=Icpitembatch.CPVarDecl
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
len=1
name='_tdest
next=Icpitembatch.CPVarDecl
len=16
name='xCF
next=Icpitembatch.CPVarDecl
len=16
name='xSOCTCon
next=Icpitembatch.CPVarDecl
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
len=30
name='xCitta
next=Icpitembatch.CPVarDecl
len=6
name='cCliProg
next=Icpitembatch.CPVarDecl
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
len=1
name='xSesso
next=Icpitembatch.CPVarDecl
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
len=6
name='xCAB
next=Icpitembatch.CPVarDecl
len=6
name='xDIP
next=Icpitembatch.CPVarDecl
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
len=8
name='xData
next=Icpitembatch.CPVarDecl
len=8
name='xDatF
next=Icpitembatch.CPVarDecl
comment='Contatore record nuovi
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
comment='Contatore record aggiornati
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
comment='Contatore record invariati
len=10
name='cNumInv
next=Icpitembatch.CPVarDecl
len=1
name='cFlagLire
next=Icpitembatch.CPVarDecl
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
len=1
name='xCFE
next=Icpitembatch.CPVarDecl
len=10
name='conta
next=Icpitembatch.CPVarDecl
len=1
name='_esito
next=Icpitembatch.CPVarDecl
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
len=1
name='_salta
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
len=10
name='nProgSto
next=Icpitembatch.CPVarDecl
len=10
name='_idbase
next=Icpitembatch.CPVarDecl
len=11
name='_codinter
next=Icpitembatch.CPVarDecl
len=30
name='_citinter
next=Icpitembatch.CPVarDecl
len=6
name='_cabinter
next=Icpitembatch.CPVarDecl
len=2
name='_prvinter
next=Icpitembatch.CPVarDecl
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
len=2
name='_interprv
next=Icpitembatch.CPVarDecl
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
len=35
name='_benind
next=Icpitembatch.CPVarDecl
len=5
name='_bencap
next=Icpitembatch.CPVarDecl
len=1
name='_flgmodi
next=Icpitembatch.CPVarDecl
len=16
name='_conadd
next=Icpitembatch.CPVarDecl
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
len=1
name='_flgdataim
next=Icpitembatch.CPVarDecl
len=1
name='_chkerr
next=Icpitembatch.CPVarDecl
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
len=8
name='_datarett
next=Icpitembatch.CPVarDecl
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
len=8
name='_datvarage
next=Icpitembatch.CPVarDecl
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
len=1
name='_opeerr
next=Icpitembatch.CPVarDecl
len=1
name='_frzerr
next=Icpitembatch.CPVarDecl
len=1
name='_opxerr
next=Icpitembatch.CPVarDecl
len=1
name='_soxerr
next=Icpitembatch.CPVarDecl
len=11
name='_numprog
next=Icpitembatch.CPVarDecl
len=11
name='_colleg
next=Icpitembatch.CPVarDecl
len=1
name='_frapcli
next=Icpitembatch.CPVarDecl
len=1
name='_tiporap
next=Icpitembatch.CPVarDecl
len=20
name='_czip
next=Icpitembatch.CPVarDecl
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPVarDecl
len=30
name='_file1
next=Icpitembatch.CPVarDecl
len=30
name='_file2
next=Icpitembatch.CPVarDecl
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
len=1
name='_oldest
next=Icpitembatch.CPVarDecl
len=1
name='_newest
obj='Var
obj_type='N
pag=1
prev=O449
I
obj='Var
obj_type='N
pag=1
prev=O448
I
obj='Var
pag=1
prev=O447
I
obj='Var
pag=1
prev=O446
I
obj='Var
pag=1
prev=O445
I
obj='Var
pag=1
prev=O444
I
obj='Var
pag=1
prev=O443
I
obj='Var
pag=1
prev=O442
I
obj='Var
pag=1
prev=O441
I
obj='Var
pag=1
prev=O440
I
obj='Var
pag=1
prev=O439
I
obj='Var
pag=1
prev=O438
I
obj='Var
pag=1
prev=O437
I
obj='Var
obj_type='N
pag=1
prev=O436
I
obj='Var
obj_type='N
pag=1
prev=O435
I
obj='Var
obj_type='N
pag=1
prev=O434
I
obj='Var
obj_type='N
pag=1
prev=O433
I
obj='Var
obj_type='N
pag=1
prev=O432
I
obj='Var
obj_type='D
pag=1
prev=O431
I
obj='Var
pag=1
prev=O430
I
obj='Var
pag=1
prev=O429
I
obj='Var
obj_type='D
pag=1
prev=O428
I
obj='Var
pag=1
prev=O427
I
obj='Var
pag=1
prev=O426
I
obj='Var
pag=1
prev=O425
I
obj='Var
pag=1
prev=O424
I
obj='Var
obj_type='N
pag=1
prev=O423
I
obj='Var
obj_type='N
pag=1
prev=O422
I
obj='Var
obj_type='D
pag=1
prev=O421
I
obj='Var
pag=1
prev=O420
I
obj='Var
pag=1
prev=O419
I
obj='Var
pag=1
prev=O418
I
obj='Var
pag=1
prev=O417
I
obj='Var
pag=1
prev=O416
I
obj='Var
pag=1
prev=O415
I
obj='Var
pag=1
prev=O414
I
obj='Var
pag=1
prev=O413
I
obj='Var
pag=1
prev=O412
I
obj='Var
pag=1
prev=O411
I
obj='Var
pag=1
prev=O410
I
obj='Var
pag=1
prev=O409
I
obj='Var
pag=1
prev=O408
I
obj='Var
pag=1
prev=O407
I
obj='Var
pag=1
prev=O406
I
obj='Var
pag=1
prev=O405
I
obj='Var
pag=1
prev=O404
I
obj='Var
pag=1
prev=O403
I
obj='Var
pag=1
prev=O402
I
obj='Var
obj_type='N
pag=1
prev=O401
I
obj='Var
obj_type='N
pag=1
prev=O400
I
obj='Var
obj_type='N
pag=1
prev=O399
I
obj='Var
obj_type='N
pag=1
prev=O398
I
obj='Var
pag=1
prev=O397
I
obj='Var
pag=1
prev=O396
I
obj='Var
pag=1
prev=O395
I
obj='Var
obj_type='N
pag=1
prev=O394
I
obj='Var
obj_type='N
pag=1
prev=O393
I
obj='Var
obj_type='N
pag=1
prev=O392
I
obj='Var
pag=1
prev=O391
I
obj='Var
obj_type='N
pag=1
prev=O390
I
obj='Var
pag=1
prev=O389
I
obj='Var
pag=1
prev=O388
I
obj='Var
pag=1
prev=O387
I
obj='Var
obj_type='N
pag=1
prev=O386
I
obj='Var
obj_type='N
pag=1
prev=O385
I
obj='Var
obj_type='N
pag=1
prev=O384
I
obj='Var
pag=1
prev=O383
I
obj='Var
pag=1
prev=O382
I
obj='Var
pag=1
prev=O381
I
obj='Var
pag=1
prev=O380
I
obj='Var
pag=1
prev=O379
I
obj='Var
pag=1
prev=O378
I
obj='Var
pag=1
prev=O377
I
obj='Var
pag=1
prev=O376
I
obj='Var
pag=1
prev=O375
I
obj='Var
pag=1
prev=O374
I
obj='Var
pag=1
prev=O373
I
obj='Var
pag=1
prev=O372
I
obj='Var
pag=1
prev=O371
I
obj='Var
pag=1
prev=O370
I
obj='Var
pag=1
prev=O369
I
obj='Var
pag=1
prev=O368
I
obj='Var
pag=1
prev=O367
I
obj='Var
pag=1
prev=O366
I
obj='Var
pag=1
prev=O365
I
obj='Var
pag=1
prev=O364
I
obj='Var
pag=1
prev=O363
I
obj='Var
obj_type='M
pag=1
prev=O362
I
obj='Var
pag=1
prev=O361
I
obj='Var
pag=1
prev=O360
I
obj='Var
pag=1
prev=O359
I
obj='Var
pag=1
prev=O358
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Remark
pag=1
prev=O4
I
obj='Begin
pag=1
prev=O3
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O4
fatherSonIndex=0
len=1
name='w_tipodest
next=Icpitembatch.CPVarDecl
len=1
name='w_impzip
next=Icpitembatch.CPVarDecl
len=4
name='w_annorif
next=Icpitembatch.CPVarDecl
len=120
name='w_msgimp
next=Icpitembatch.CPVarDecl
len=1
name='w_chkaui
next=Icpitembatch.CPVarDecl
len=1
name='w_imperr
next=Icpitembatch.CPVarDecl
len=1
name='w_creamo
next=Icpitembatch.CPVarDecl
len=1
name='w_fscarti
nonlocal=True
obj='Var
obj_type='N
pag=1
prev=O460
I
nonlocal=True
obj='Var
pag=1
prev=O459
I
nonlocal=True
obj='Var
pag=1
prev=O458
I
nonlocal=True
obj='Var
pag=1
prev=O457
I
nonlocal=True
obj='Var
pag=1
prev=O456
I
nonlocal=True
obj='Var
obj_type='N
pag=1
prev=O455
I
nonlocal=True
obj='Var
obj_type='N
pag=1
prev=O454
I
nonlocal=True
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Remark
pag=1
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumInv
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Soggetti Inseriti: '+LRTrim(Str(cNumNew,10,0)) + ' - Soggetti Aggiornati: '+LRTrim(Str(cNumMod,10,0)) + ' - Soggetti Invariati: '+LRTrim(Str(cNumInv,10,0)) + ' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O475
var_op='asgn
I
obj='Exec
pag=2
prev=O474
I
obj='Exec
pag=2
prev=O473
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O472
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O470
var_op='asgn
I
obj='While
pag=2
prev=O469
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O470
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=2
prev=O479
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O480
fatherSonIndex=0
frm_calc='NullDate()
len=8
name='_datvarage
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgRet='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' nominativi del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='gMsgImp
len=120
name='w_msgimp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,112,16))
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,112,16))
len=16
name='xCF
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,488,16))
len=16
name='_conadd
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(_conadd)),cCli1,_conadd)
len=16
name='cCli1
next=Icpitembatch.CPRemark
frm_calc='Prima la Read si faceva per CF
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,288,1))),'G','P')
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,288,1)='M','1',iif(Substr(riga,288,1)='F','2',Substr(riga,288,1)))
len=1
name='xSesso
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,450,1)='0' or Substr(riga,450,1)='1' or Substr(riga,450,1) = ''
'Substr(riga,450,1)='N' or Substr(riga,450,1)='S'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,6)
len=6
name='xCodCab
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCodCab))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,136,30))
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'(Substr(xCF,12,1) = 'Z' or Substr(riga,448,2)='EE') and (Substr(riga,288,1)='M' or Substr(riga,288,1)='F')
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico se il soggetto in esame non è già presente l'inserisco
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xConnes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O514
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O515
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPOCLI\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='personbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=2
prev=O521
var_op='asgn
I
obj='Insert
pag=2
prev=O520
rd_kfield=[
'ALLINEATO
'ALLINEATONOMECNOME
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'CONNES
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROGIMPORT
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'TIPOPERS
'DATAVARAGE
]
rd_kvar=[
'0
'0
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,470,5)),3))
'Substr(riga,460,10)
'Upper(Substr(riga,200,30))
'Substr(riga,265,9)
'xCFE
'xCodCab
'LRTrim(Substr(riga,112,16))
'Upper(Substr(riga,297,26))
'Substr(riga,455,5)
'LRTrim(cCli1)
'CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Upper(Substr(riga,230,30))
'Substr(riga,348,100)
'Upper(Substr(riga,77,35))
'cCNAS
'cSNAS
'Upper(Substr(riga,323,25))
'Upper(Substr(riga,177,15))
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'iif(Empty(Substr(riga,487,1)),'N',Substr(riga,487,1))
'Substr(riga,451,4)
'nProgImp
'Upper(Substr(riga,260,2))
'Upper(Substr(riga,7,70))
'Upper(Substr(riga,7,70))
'Substr(riga,169,3)
'Val(Substr(riga,484,3))
'Val(Substr(riga,481,3))
'Val(Substr(riga,478,3))
'Val(Substr(riga,475,3))
'xSesso
'Substr(riga,172,3)
'Substr(riga,166,3)
'Substr(riga,448,2)
'Substr(riga,175,2)
'_tipper
'_datvarage
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O521
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+LRTrim(Substr(riga,7,70))+" con codice fiscale: "+LRTrim(Substr(riga,112,16))+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O531
I
obj='Exec
pag=2
prev=O530
I
obj='Var
obj_type='N
pag=2
prev=O529
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O528
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPVarDecl
father=O515
fatherSonIndex=1
frm_calc='CharToDate(Substr(riga,508,4)+Substr(riga,506,2)+Substr(riga,504,2))
len=8
name='_datvarage
next=Icpitembatch.CPRemark
frm_calc='Verifico se il soggetto è una persona fisica
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,288,1)='M' or Substr(riga,288,1)='F'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O536
sons=[
Icpitembatch.CPItemSon
comment='se persona fisica
instr=Icpitembatch.CPWrite
arch='personbo
father=O537
fatherSonIndex=0
frm_calc='Errore in aggiornamento ARCHPERS
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=2
prev=O542
var_op='asgn
I
obj='Write
pag=2
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(xConnes)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O542
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
frm_calc='m_cLastMsgError = ""
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O552
I
obj='Exec
pag=2
prev=O551
I
obj='Var
obj_type='N
pag=2
prev=O550
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'DATANASC
'DATARILASC
'DATAVALI
'DATAVARAGE
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'DATAVARAGE
'PEP
'AREAGEO
'RAREA
'RATTIV
'RCOMP
'RNATGIU
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,460,10)
'Upper(Substr(riga,200,30))
'Substr(riga,265,9)
'xCFE
'xCodCab
'LRTrim(Substr(riga,112,16))
'Upper(Substr(riga,297,26))
'Substr(riga,455,5)
'CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'_datvarage
'Upper(Substr(riga,230,30))
'Substr(riga,348,100)
'Upper(Substr(riga,77,35))
'cCNAS
'cSNAS
'Upper(Substr(riga,323,25))
'Upper(Substr(riga,177,15))
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'iif(Empty(Substr(riga,487,1)),'N',Substr(riga,487,1))
'Substr(riga,451,4)
'Upper(Substr(riga,260,2))
'Upper(Substr(riga,7,70))
'Upper(Substr(riga,7,70))
'Substr(riga,169,3)
'xSesso
'Substr(riga,172,3)
'Substr(riga,166,3)
'Substr(riga,448,2)
'Substr(riga,175,2)
'_datvarage
'iif(Empty(Substr(riga,487,1)),'N',Substr(riga,487,1))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,470,5)),3))
'Val(Substr(riga,484,3))
'Val(Substr(riga,481,3))
'Val(Substr(riga,478,3))
'Val(Substr(riga,475,3))
]
I
I
Icpitembatch.CPItemSon
comment='se persona giuridica
instr=Icpitembatch.CPRemark
father=O537
fatherSonIndex=1
frm_calc='Se non è persona fisica
next=Icpitembatch.CPWrite
arch='personbo
frm_calc='Errore in aggiornamento ARCHPERS
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=2
prev=O560
var_op='asgn
I
obj='Write
pag=2
prev=O559
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(xConnes)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O560
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O569
I
obj='Var
obj_type='N
pag=2
prev=O568
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'DATAVARAGE
'PEP
'AREAGEO
'RAREA
'RATTIV
'RCOMP
'RNATGIU
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,460,10)
'Upper(Substr(riga,200,30))
'Substr(riga,265,9)
'xCFE
'xCodCab
'LRTrim(Substr(riga,112,16))
'Upper(Substr(riga,297,26))
'Substr(riga,455,5)
'CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Upper(Substr(riga,230,30))
'Substr(riga,348,100)
'Upper(Substr(riga,77,35))
'cCNAS
'cSNAS
'Upper(Substr(riga,323,25))
'Upper(Substr(riga,177,15))
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'Substr(riga,451,4)
'Upper(Substr(riga,260,2))
'Upper(Substr(riga,7,70))
'Upper(Substr(riga,7,70))
'Substr(riga,169,3)
'xSesso
'Substr(riga,172,3)
'Substr(riga,166,3)
'Substr(riga,448,2)
'Substr(riga,175,2)
'_datvarage
'iif(Empty(Substr(riga,487,1)),'N',Substr(riga,487,1))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,470,5)),3))
'Val(Substr(riga,484,3))
'Val(Substr(riga,481,3))
'Val(Substr(riga,478,3))
'Val(Substr(riga,475,3))
]
I
obj='Remark
pag=2
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=2
prev=O535
I
obj='Var
obj_type='D
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=2
prev=O511
I
obj='If
pag=2
prev=O510
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O511
fatherSonIndex=0
frm_calc='Upper(Substr(riga,136,30))
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=2
prev=O579
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O509
var_op='asgn
I
obj='Var
pag=2
prev=O506
var_op='asgn
I
obj='If
pag=2
prev=O505
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O506
fatherSonIndex=0
frm_calc='Upper(Substr(riga,230,30))
len=30
name='xCitta
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Upper(Substr(riga,260,2)))))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O584
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O585
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xCodCab)
]
h=[
19
19
]
obj='If
pag=2
prev=O590
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O591
fatherSonIndex=0
obj='Read
pag=2
rd_field=[
'CAB
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'xCitta
]
rd_var=[
'xCodCab
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=2
rd_field=[
'CAB
]
rd_kfield=[
'CITTA
'PROV
]
rd_kvar=[
'xCitta
'Upper(Substr(riga,260,2))
]
rd_var=[
'xCodCab
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O585
fatherSonIndex=1
obj='Read
pag=2
rd_field=[
'CAB
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'xCitta
]
rd_var=[
'xCodCab
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O502
var_op='asgn
I
obj='If
pag=2
prev=O501
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O502
fatherSonIndex=0
frm_calc='iif(LRTrim(Substr(riga,450,1))='1',1,0)
len=1
name='xCFE
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O502
fatherSonIndex=1
frm_calc='iif(LRTrim(Substr(riga,450,1))='S',1,0)
len=1
name='xCFE
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O500
var_op='asgn
I
obj='Var
pag=2
prev=O499
var_op='asgn
I
obj='Read
pag=2
prev=O498
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(cCli1)
]
rd_var=[
'xConnes
]
I
obj='Remark
pag=2
prev=O497
I
obj='Var
pag=2
prev=O496
var_op='asgn
I
obj='Var
pag=2
prev=O495
var_op='asgn
I
obj='Var
pag=2
prev=O494
var_op='asgn
I
obj='Var
pag=2
prev=O493
var_op='asgn
I
obj='Var
pag=2
prev=O492
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O491
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O488
var_op='asgn
I
obj='If
pag=2
prev=O487
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xersonbo
father=O488
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'CONNES
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'IDPROG
]
rd_kvar=[
'Substr(riga,470,3)
'Substr(riga,460,10)
'Substr(riga,200,30)
'Substr(riga,265,9)
'Substr(riga,450,1)
'Left(riga,6)
'Substr(riga,112,16)
'Substr(riga,297,26)
'Substr(riga,455,5)
'Substr(riga,488,16)
'Substr(riga,128,8)
'Substr(riga,192,8)
'Substr(riga,289,8)
'Substr(riga,230,30)
'Substr(riga,348,100)
'Substr(riga,77,35)
'Substr(riga,136,30)
'Substr(riga,323,25)
'Substr(riga,177,15)
'Substr(riga,262,3)
'Substr(riga,274,14)
'Substr(riga,487,1)
'Substr(riga,451,4)
'Substr(riga,260,2)
'Substr(riga,7,70)
'Substr(riga,7,70)
'Substr(riga,169,3)
'Substr(riga,484,3)
'Substr(riga,481,3)
'Substr(riga,478,3)
'Substr(riga,475,3)
'Substr(riga,288,1)
'Substr(riga,172,3)
'Substr(riga,166,3)
'Substr(riga,448,2)
'Substr(riga,175,2)
'conta
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O486
var_op='asgn
I
obj='Var
pag=2
prev=O485
var_op='asgn
I
obj='Var
obj_type='D
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O468
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O467
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O466
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O465
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O464
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O463
var_op='asgn
I
obj='Remark
pag=2
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime())  + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Rapporti Inseriti: '+LRTrim(Str(cNumNew,10,0)) +' - Rapporti Aggiornati: '+LRTrim(Str(cNumMod,10,0))+' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O643
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O642
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O641
var_op='asgn
I
obj='Exec
pag=3
prev=O640
I
obj='Exec
pag=3
prev=O638
I
obj='While
pag=3
prev=O637
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O638
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' rapporti del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='cFlagLire
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,77,1)='S' or Substr(riga,77,1)='1' or Substr(riga,77,1)='7'
'Substr(riga,77,1)='E' or Substr(riga,77,1)='3' or Substr(riga,77,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='xRapporto
next=Icpitembatch.CPRead
arch='anarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xRapporto))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O655
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O656
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='anarapbo
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='knarapbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=3
prev=O664
var_op='asgn
I
obj='Insert
pag=3
prev=O662
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
''D'
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O664
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O673
I
obj='Var
obj_type='N
pag=3
prev=O672
var_op='asgn
I
obj='Exec
pag=3
prev=O671
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Insert
pag=3
prev=O661
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
'PRGIMPRAP
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'Substr(riga,94,5)
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O662
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O682
I
obj='Var
obj_type='N
pag=3
prev=O681
var_op='asgn
I
obj='Exec
pag=3
prev=O680
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='anarapbo
father=O656
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=3
prev=O686
var_op='asgn
I
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O686
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O696
I
obj='Var
obj_type='N
pag=3
prev=O695
var_op='asgn
I
obj='Exec
pag=3
prev=O694
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'Substr(riga,94,5)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=3
prev=O654
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Left(riga,25)
]
rd_var=[
'xRapporto
]
I
obj='Var
pag=3
prev=O651
var_op='asgn
I
obj='Case
pag=3
prev=O650
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O651
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O651
fatherSonIndex=1
frm_calc=[
'Substr(riga,77,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O711
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O711
fatherSonIndex=1
frm_calc='Substr(riga,77,1)
len=1
name='cFlagLire
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O651
fatherSonIndex=2
frm_calc='Substr(riga,77,1)
len=1
name='cFlagLire
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=3
prev=O649
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O648
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O647
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O636
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O635
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O634
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O633
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O632
var_op='asgn
I
obj='Remark
pag=3
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Informazione Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O734
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O733
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O732
var_op='asgn
I
obj='Exec
pag=4
prev=O731
I
obj='Exec
pag=4
prev=O729
I
obj='While
pag=4
prev=O728
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O729
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPBeginEnd
comment='Dati intermediario
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,75,16)
len=16
name='xConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,50,16)
len=16
name='xSOCTCon
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xSOCTCon)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' informazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,46,1)='S' or Substr(riga,46,1)='1' or Substr(riga,46,1)='7'
'Substr(riga,46,1)='E' or Substr(riga,46,1)='3' or Substr(riga,46,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,159,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,36,8))) or _flgdataim=1,Date(),CharToDate(Right(Substr(riga,36,8),4)+Substr(Substr(riga,36,8),3,2)+Left(Substr(riga,36,8),2)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='rapopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
prev=O770
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O772
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='intestbo
h=[
19
19
]
obj='Insert
pag=4
prev=O777
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'Left(riga,8)+cInfProg2+'0'
'cCli1
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O778
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O786
I
obj='Var
obj_type='N
pag=4
prev=O785
var_op='asgn
I
obj='Exec
pag=4
prev=O784
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O772
fatherSonIndex=1
frm_calc=[
'Substr(riga,44,2)='23'
'Substr(riga,44,2)='26'
]
h=[
19
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPWrite
arch='intestbo
father=O790
fatherSonIndex=0
h=[
19
19
]
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cNumMod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O795
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O804
I
obj='Var
obj_type='N
pag=4
prev=O803
var_op='asgn
I
obj='Exec
pag=4
prev=O802
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'NUMPROG1
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPWrite
arch='intestbo
father=O790
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cNumMod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O811
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O820
I
obj='Var
obj_type='N
pag=4
prev=O819
var_op='asgn
I
obj='Exec
pag=4
prev=O818
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=4
prev=O769
sel_field='*
sel_name='intestbo
sel_order='intestbo->CPROWNUM
sel_where='intestbo->RAPPORTO=Substr(riga,9,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O770
fatherSonIndex=0
frm_calc=[
'intestbo->CODINTER=cCli1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=4
prev=O830
var_op='asgn
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O830
fatherSonIndex=0
frm_calc='intestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O768
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O767
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O765
var_op='asgn
I
obj='Insert
pag=4
prev=O764
rd_kfield=[
'CDATOPE
'CDATREG
'CODCAB
'CODDIPE
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'VALUTA
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'_intercab
'Substr(riga,115,6)
'_intercod
'xSOCTCF
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_intercit
'Substr(riga,169,50)
'cFlagLire
'Substr(riga,34,1)
'cInfProg1
'Left(riga,8)+cInfProg1+'0'
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,159,10)
'Substr(riga,47,3)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O765
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O845
I
obj='Var
obj_type='N
pag=4
prev=O844
var_op='asgn
I
obj='Exec
pag=4
prev=O843
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O763
var_op='asgn
I
obj='Var
pag=4
prev=O762
var_op='asgn
I
obj='Var
pag=4
prev=O761
var_op='asgn
I
obj='Var
obj_type='D
pag=4
prev=O758
var_op='asgn
I
obj='If
pag=4
prev=O757
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='rapopebo
father=O758
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'_unicode<>''
]
h=[
19
19
]
obj='If
pag=4
prev=O850
sons=[
Icpitembatch.CPItemSon
comment='In caso di _unicode doppio blocco l'importazione
instr=Icpitembatch.CPVarDecl
father=O851
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O857
I
obj='Var
obj_type='N
pag=4
prev=O856
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,159,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
prev=O756
var_op='asgn
I
obj='Remark
pag=4
prev=O753
I
obj='Case
pag=4
prev=O752
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O753
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O753
fatherSonIndex=1
frm_calc=[
'Substr(riga,46,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O869
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O869
fatherSonIndex=1
frm_calc='Substr(riga,46,1)
len=1
name='cFlagLire
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O753
fatherSonIndex=2
frm_calc='Substr(riga,46,1)
len=1
name='cFlagLire
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O751
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O748
var_op='asgn
I
obj='If
pag=4
prev=O747
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O748
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=4
prev=O883
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O884
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=4
prev=O889
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O890
fatherSonIndex=0
frm_calc='xSOCTCon
len=16
name='xSOCTCF
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
prev=O746
var_op='asgn
I
obj='Var
pag=4
prev=O743
var_op='asgn
I
obj='If
pag=4
prev=O742
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O743
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
obj='If
pag=4
prev=O909
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O910
fatherSonIndex=0
frm_calc='xConnes
len=16
name='cCli1
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
prev=O741
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
obj='Var
pag=4
prev=O739
var_op='asgn
I
obj='Begin
pag=4
prev=O738
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O739
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,104,11))),_codinter,Substr(riga,104,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,121,30))),_citinter,Substr(riga,121,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,153,6))),_cabinter,Substr(riga,153,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,151,2))),_prvinter,Substr(riga,151,2))
len=2
name='_interprv
obj='Var
pag=4
prev=O930
var_op='asgn
I
obj='Var
pag=4
prev=O929
var_op='asgn
I
obj='Var
pag=4
prev=O928
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O727
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O726
var_op='asgn
I
obj='Var
pag=4
prev=O725
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O724
var_op='asgn
I
obj='Remark
pag=4
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Rapporti Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Rapporti Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=7
prev=O945
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=7
prev=O944
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=7
prev=O943
var_op='asgn
I
obj='Exec
pag=7
prev=O942
I
obj='Exec
pag=7
prev=O940
I
obj='While
pag=7
prev=O939
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O940
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' rapporti del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='cFlagLire
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,77,1)='S' or Substr(riga,77,1)='1' or Substr(riga,77,1)='7'
'Substr(riga,77,1)='E' or Substr(riga,77,1)='3' or Substr(riga,77,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='xRapporto
next=Icpitembatch.CPRead
arch='xnarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xRapporto))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=7
prev=O957
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O958
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xnarapbo
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='knarapbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=7
prev=O966
var_op='asgn
I
obj='Insert
pag=7
prev=O964
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
''P'
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O966
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=7
prev=O975
I
obj='Var
obj_type='N
pag=7
prev=O974
var_op='asgn
I
obj='Exec
pag=7
prev=O973
I
nonlocal=True
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Insert
pag=7
prev=O963
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
'PRGIMPRAP
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'Substr(riga,94,5)
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O964
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=7
prev=O984
I
obj='Var
obj_type='N
pag=7
prev=O983
var_op='asgn
I
obj='Exec
pag=7
prev=O982
I
nonlocal=True
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='xnarapbo
father=O958
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=7
prev=O988
var_op='asgn
I
obj='Write
pag=7
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O988
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=7
prev=O998
I
obj='Var
obj_type='N
pag=7
prev=O997
var_op='asgn
I
obj='Exec
pag=7
prev=O996
I
nonlocal=True
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'Substr(riga,94,5)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=7
prev=O956
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Left(riga,25)
]
rd_var=[
'xRapporto
]
I
obj='Var
pag=7
prev=O953
var_op='asgn
I
obj='Case
pag=7
prev=O952
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O953
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O953
fatherSonIndex=1
frm_calc=[
'Substr(riga,77,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1013
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1013
fatherSonIndex=1
frm_calc='Substr(riga,77,1)
len=1
name='cFlagLire
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O953
fatherSonIndex=2
frm_calc='Substr(riga,77,1)
len=1
name='cFlagLire
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=7
prev=O951
var_op='asgn
I
obj='Var
obj_type='M
pag=7
prev=O950
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=7
prev=O949
var_op='asgn
I
obj='Var
obj_type='N
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=7
prev=O938
var_op='asgn
I
obj='Var
pag=7
prev=O937
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=7
prev=O936
var_op='asgn
I
obj='Var
obj_type='N
pag=7
prev=O935
var_op='asgn
I
obj='Var
obj_type='N
pag=7
prev=O934
var_op='asgn
I
obj='Remark
pag=7
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Informazione Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O1036
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O1035
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O1034
var_op='asgn
I
obj='Exec
pag=8
prev=O1033
I
obj='Exec
pag=8
prev=O1031
I
obj='While
pag=8
prev=O1030
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1031
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPBeginEnd
comment='Dati intermediario
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,75,16)
len=16
name='xConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,50,16)
len=16
name='xSOCTCon
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xSOCTCon)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' informazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,46,1)='S' or Substr(riga,46,1)='1' or Substr(riga,46,1)='7'
'Substr(riga,46,1)='E' or Substr(riga,46,1)='3' or Substr(riga,46,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,159,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,36,8))) or _flgdataim=1,Date(),CharToDate(Right(Substr(riga,36,8),4)+Substr(Substr(riga,36,8),3,2)+Left(Substr(riga,36,8),2)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xapopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
prev=O1072
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1074
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,44,2)='23'
'Substr(riga,44,2)='26'
]
h=[
19
19
19
]
obj='If
pag=8
prev=O1079
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xntestbo
father=O1080
fatherSonIndex=0
h=[
19
19
]
obj='Insert
pag=8
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'Left(riga,8)+cInfProg2+'O'
'cCli1
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1085
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O1093
I
obj='Var
obj_type='N
pag=8
prev=O1092
var_op='asgn
I
obj='Exec
pag=8
prev=O1091
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xntestbo
father=O1080
fatherSonIndex=1
h=[
19
19
]
obj='Insert
pag=8
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAFINE
'TIPOPERS
'CODINTER
'NUMPROG2
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'Left(riga,8)+cInfProg2+'O'
'cCli1
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1097
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O1105
I
obj='Var
obj_type='N
pag=8
prev=O1104
var_op='asgn
I
obj='Exec
pag=8
prev=O1103
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1074
fatherSonIndex=1
frm_calc=[
'Substr(riga,44,2)='23'
'Substr(riga,44,2)='26'
]
h=[
19
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPWrite
arch='xntestbo
father=O1110
fatherSonIndex=0
h=[
19
19
]
obj='Write
pag=8
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cNumMod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1115
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O1124
I
obj='Var
obj_type='N
pag=8
prev=O1123
var_op='asgn
I
obj='Exec
pag=8
prev=O1122
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
]
wr_op=[
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPWrite
arch='xntestbo
father=O1110
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=8
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cNumMod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1131
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O1140
I
obj='Var
obj_type='N
pag=8
prev=O1139
var_op='asgn
I
obj='Exec
pag=8
prev=O1138
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
]
wr_op=[
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=8
prev=O1071
sel_field='*
sel_name='xntestbo
sel_order='xntestbo->CPROWNUM
sel_where='xntestbo->RAPPORTO=Substr(riga,9,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1072
fatherSonIndex=0
frm_calc=[
'xntestbo->CODINTER=cCli1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=8
prev=O1150
var_op='asgn
I
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1150
fatherSonIndex=0
frm_calc='xntestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
prev=O1070
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O1069
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O1067
var_op='asgn
I
obj='Insert
pag=8
prev=O1066
rd_kfield=[
'CDATOPE
'CDATREG
'CODCAB
'CODDIPE
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'VALUTA
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'_cabinter
'Substr(riga,115,6)
'_intercod
'xSOCTCF
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_intercit
'Substr(riga,169,50)
'cFlagLire
'Substr(riga,34,1)
'cInfProg1
'Left(riga,8)+cInfProg1+'0'
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,159,10)
'Substr(riga,47,3)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1067
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O1165
I
obj='Var
obj_type='N
pag=8
prev=O1164
var_op='asgn
I
obj='Exec
pag=8
prev=O1163
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
prev=O1065
var_op='asgn
I
obj='Var
pag=8
prev=O1064
var_op='asgn
I
obj='Var
pag=8
prev=O1063
var_op='asgn
I
obj='Var
obj_type='D
pag=8
prev=O1060
var_op='asgn
I
obj='If
pag=8
prev=O1059
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xapopebo
father=O1060
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'_unicode<>''
]
h=[
19
19
]
obj='If
pag=8
prev=O1170
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1171
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O1177
I
obj='Var
obj_type='N
pag=8
prev=O1176
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,159,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
prev=O1058
var_op='asgn
I
obj='Remark
pag=8
prev=O1055
I
obj='Case
pag=8
prev=O1054
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1055
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1055
fatherSonIndex=1
frm_calc=[
'Substr(riga,46,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1189
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1189
fatherSonIndex=1
frm_calc='Substr(riga,46,1)
len=1
name='cFlagLire
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1055
fatherSonIndex=2
frm_calc='Substr(riga,46,1)
len=1
name='cFlagLire
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O1053
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O1050
var_op='asgn
I
obj='If
pag=8
prev=O1049
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O1050
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=8
prev=O1203
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O1204
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=8
prev=O1209
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1210
fatherSonIndex=0
frm_calc='xSOCTCon
len=16
name='xSOCTCF
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
prev=O1048
var_op='asgn
I
obj='Var
pag=8
prev=O1045
var_op='asgn
I
obj='If
pag=8
prev=O1044
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O1045
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
obj='If
pag=8
prev=O1229
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1230
fatherSonIndex=0
frm_calc='xConnes
len=16
name='cCli1
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
prev=O1043
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
obj='Var
pag=8
prev=O1041
var_op='asgn
I
obj='Begin
pag=8
prev=O1040
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1041
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,104,11))),_codinter,Substr(riga,104,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,121,30))),_citinter,Substr(riga,121,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,153,6))),_cabinter,Substr(riga,153,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,151,2))),_prvinter,Substr(riga,151,2))
len=2
name='_interprv
obj='Var
pag=8
prev=O1250
var_op='asgn
I
obj='Var
pag=8
prev=O1249
var_op='asgn
I
obj='Var
pag=8
prev=O1248
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
prev=O1029
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O1028
var_op='asgn
I
obj='Var
pag=8
prev=O1027
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O1026
var_op='asgn
I
obj='Remark
pag=8
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=9
prev=O1264
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=9
prev=O1263
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=9
prev=O1262
var_op='asgn
I
obj='Exec
pag=9
prev=O1261
I
obj='Exec
pag=9
prev=O1259
I
obj='While
pag=9
prev=O1258
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1259
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=9
prev=O1268
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1269
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgRet='S'
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
prev=O1278
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O1280
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,257,6))))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,318,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,155,1)='S' or Substr(riga,155,1)='1' or Substr(riga,155,1)='7'
'Substr(riga,155,1)='E' or Substr(riga,155,1)='3' or Substr(riga,155,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,9,1)='1' or Substr(riga,9,1)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,301,1)),'0',iif(Substr(riga,301,1)='S','1',iif(Substr(riga,301,1)='N','1',Substr(riga,301,1))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,231,11))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPRead
arch='tbcauana
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,147,8))) or _flgdataim=1,Date(),CharToDate(Right(Substr(riga,147,8),4)+Substr(Substr(riga,147,8),3,2)+Left(Substr(riga,147,8),2)))
len=8
name='_datareg
next=Icpitembatch.CPInsert
arch='xperazbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=9
prev=O1312
var_op='asgn
I
obj='Insert
pag=9
prev=O1311
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
]
rd_kvar=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'Substr(riga,10,4)
'_intercab
'Substr(riga,64,6)
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'Substr(riga,484,16)
'Substr(riga,302,16)
'Substr(riga,190,16)
'Substr(riga,206,16)
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'Substr(riga,32,30)
'_intercit
'Substr(riga,70,50)
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'cOpeProg1
'cIdCau
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)+cOpeProg2+'S'
'Substr(riga,424,30)
'Substr(riga,813,15)
'Substr(riga,414,5)
'Substr(riga,662,50)
'cOpeProg2
'Substr(riga,328,3)
''1'
'CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6))
'arfn_conv_stato_uic(Substr(riga,29,3))
'Substr(riga,812,1)
'nProgImp
'Substr(riga,62,2)
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
''0'
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'_colleg
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1312
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=9
prev=O1321
I
obj='Var
obj_type='N
pag=9
prev=O1320
var_op='asgn
I
obj='Exec
pag=9
prev=O1319
I
nonlocal=True
obj='Var
obj_type='M
pag=9
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='D
pag=9
prev=O1309
var_op='asgn
I
obj='Begin
pag=9
prev=O1308
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1309
fatherSonIndex=0
frm_calc='Upper(Substr(riga,511,70))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,581,3))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,584,30))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,614,6)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,620,2))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,622,35))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,657,5))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,302,16))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=9
prev=O1336
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1339
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,120,25))))
]
h=[
19
19
]
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1344
fatherSonIndex=0
frm_calc='''
len=1
name='_tiporap
next=Icpitembatch.CPRead
arch='knarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'_tiporap='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
prev=O1350
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1351
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=9
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1356
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=9
prev=O1367
I
obj='Read
pag=9
prev=O1366
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xntestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=9
prev=O1365
var_op='asgn
I
obj='Var
pag=9
prev=O1364
var_op='asgn
I
obj='Var
pag=9
prev=O1363
var_op='asgn
I
obj='Var
pag=9
prev=O1362
var_op='asgn
I
obj='Var
pag=9
prev=O1361
var_op='asgn
I
obj='Var
pag=9
prev=O1360
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1351
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=9
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1375
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=9
prev=O1386
I
obj='Read
pag=9
prev=O1385
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=9
prev=O1384
var_op='asgn
I
obj='Var
pag=9
prev=O1383
var_op='asgn
I
obj='Var
pag=9
prev=O1382
var_op='asgn
I
obj='Var
pag=9
prev=O1381
var_op='asgn
I
obj='Var
pag=9
prev=O1380
var_op='asgn
I
obj='Var
pag=9
prev=O1379
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=9
prev=O1349
rd_field=[
'TIPORAP
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Substr(riga,120,25)
]
rd_var=[
'_tiporap
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O1333
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1336
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=9
prev=O1408
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,302,16)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=9
prev=O1407
var_op='asgn
I
obj='Var
pag=9
prev=O1406
var_op='asgn
I
obj='Var
pag=9
prev=O1405
var_op='asgn
I
obj='Var
pag=9
prev=O1404
var_op='asgn
I
obj='Var
pag=9
prev=O1403
var_op='asgn
I
obj='Var
pag=9
prev=O1402
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O1332
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O1333
fatherSonIndex=0
obj='Read
pag=9
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O1331
var_op='asgn
I
obj='Var
pag=9
prev=O1330
var_op='asgn
I
obj='Var
pag=9
prev=O1329
var_op='asgn
I
obj='Var
pag=9
prev=O1328
var_op='asgn
I
obj='Var
pag=9
prev=O1327
var_op='asgn
I
obj='Var
pag=9
prev=O1326
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=9
prev=O1307
var_op='asgn
I
obj='Var
obj_type='N
pag=9
prev=O1306
var_op='asgn
I
obj='Var
obj_type='N
pag=9
prev=O1305
var_op='asgn
I
obj='Read
pag=9
prev=O1304
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,10,4)
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
I
obj='Var
pag=9
prev=O1303
var_op='asgn
I
obj='Var
pag=9
prev=O1302
var_op='asgn
I
obj='Var
pag=9
prev=O1301
var_op='asgn
I
obj='Var
pag=9
prev=O1300
var_op='asgn
I
obj='Var
pag=9
prev=O1297
var_op='asgn
I
obj='Case
pag=9
prev=O1296
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1297
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1297
fatherSonIndex=1
frm_calc=[
'Substr(riga,155,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1432
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1432
fatherSonIndex=1
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1297
fatherSonIndex=2
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=9
prev=O1295
var_op='asgn
I
obj='Var
pag=9
prev=O1292
var_op='asgn
I
obj='If
pag=9
prev=O1291
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='xperazbo
father=O1292
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=9
prev=O1446
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1447
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=9
prev=O1453
I
obj='Var
obj_type='N
pag=9
prev=O1452
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=9
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,318,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O1290
var_op='asgn
I
obj='Remark
pag=9
prev=O1287
I
obj='If
pag=9
prev=O1285
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1287
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Substr(riga,263,30))+LRTrim(Substr(riga,295,6))+LRTrim(Substr(riga,293,2)))
]
h=[
19
19
]
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anadip
father=O1463
fatherSonIndex=0
obj='Read
pag=9
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'Substr(riga,257,6)
]
rd_var=[
'_intercit
'_intercab
'_interprv
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=9
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1285
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,246,11))),_codinter,Substr(riga,246,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,263,30))),_citinter,Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,295,6))),_cabinter,Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,293,2))),_prvinter,Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=9
prev=O1479
var_op='asgn
I
obj='Var
pag=9
prev=O1478
var_op='asgn
I
obj='Var
pag=9
prev=O1477
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1280
fatherSonIndex=1
frm_calc='1
len=1
name='_opeerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(ohand,riga+" - "+_descerr)
obj='Exec
pag=9
prev=O1483
I
obj='Var
obj_type='N
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=9
prev=O1275
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1278
fatherSonIndex=0
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,190,16))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,206,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,484,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,190,16))) and Empty(LRTrim(Substr(riga,120,25))) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=9
prev=O1499
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1502
fatherSonIndex=0
frm_calc=''Rapporto continuativo Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=9
prev=O1507
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O1496
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1499
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=9
prev=O1513
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1514
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto per conto del quale assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=9
prev=O1519
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=9
prev=O1512
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,484,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O1493
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1496
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=9
prev=O1530
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1531
fatherSonIndex=0
frm_calc=''Anagrafica Controparte Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=9
prev=O1536
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=9
prev=O1529
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,302,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O1490
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1493
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=9
prev=O1547
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1548
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto Operante Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=9
prev=O1553
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=9
prev=O1546
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,206,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O1489
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1490
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=9
prev=O1564
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1565
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=9
prev=O1570
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=9
prev=O1563
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,190,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=9
prev=O1488
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O1274
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xarchope
father=O1275
fatherSonIndex=0
obj='Insert
pag=9
rd_kfield=[
'IDPROG
'DATAOPE
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'CONNESCLI
'CONNESOPER
'CAMBIO
'NUMPROG
'TIPOOPRAP
'TIPOINTER
'CODINTER
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'CONNESBEN
'UNIQUECODE
'AGOPER
'RIFIMP
'ZCPARTE
'RAGIO
'MODSVOL
'AREAGEO
'INFORM
'AMMONT
'DURAT
'TIPO
'RRAGIO
'RCOMP
'RAREA
'RIMP
'RFREQ
'CONNALTRO
'DATAIMP
'RTIPO
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'NATURA
'SCOPO
'C_RAPPORTO
'RAPPORTBEN
'PAGASOGOP
'IPCOLLEG
'ORACOLLEG
'DUCOLLEG
]
rd_kvar=[
'conta
'Substr(riga,1,8)        
'Substr(riga,9,1)        
'Substr(riga,10,4)       
'Substr(riga,14,2)       
'Substr(riga,16,2)       
'Substr(riga,18,11)      
'Substr(riga,29,3)       
'Substr(riga,32,30)      
'Substr(riga,62,2)       
'Substr(riga,64,6)       
'Substr(riga,70,50)      
'Substr(riga,120,25)     
'Substr(riga,145,1)      
'Substr(riga,146,1)      
'Substr(riga,147,8)      
'Substr(riga,155,1)      
'Substr(riga,156,3)      
'Substr(riga,159,1)      
'Substr(riga,160,15)     
'Substr(riga,175,15)     
'Substr(riga,190,16)     
'Substr(riga,206,16)     
'Substr(riga,222,9)      
'Substr(riga,231,11)     
'Substr(riga,242,2)      
'Substr(riga,244,2)      
'Substr(riga,246,11)     
'Substr(riga,257,6)      
'Substr(riga,263,30)     
'Substr(riga,293,2)      
'Substr(riga,295,6)      
'Substr(riga,301,1)      
'Substr(riga,302,16)     
'Substr(riga,318,10)     
'Substr(riga,328,3)      
'Substr(riga,331,9)      
'Substr(riga,340,69)     
'Substr(riga,409,5)      
'Substr(riga,414,5)      
'Substr(riga,419,5)      
'Substr(riga,424,30)     
'Substr(riga,454,5)      
'Substr(riga,459,5)      
'Substr(riga,464,5)      
'Substr(riga,469,3)      
'Substr(riga,472,3)      
'Substr(riga,475,3)      
'Substr(riga,478,3)      
'Substr(riga,481,3)      
'Substr(riga,484,16)     
'Substr(riga,500,8)      
'Substr(riga,508,3)      
'Substr(riga,511,70)     
'Substr(riga,581,3)      
'Substr(riga,584,30)     
'Substr(riga,614,6)      
'Substr(riga,620,2)      
'Substr(riga,622,35)     
'Substr(riga,657,5)      
'Substr(riga,662,50)     
'Substr(riga,712,50)     
'Substr(riga,762,25)     
'Substr(riga,787,25)     
'Substr(riga,812,1)      
'Substr(riga,813,15)     
'Substr(riga,828,14)     
'Substr(riga,842,10)     
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=9
prev=O1257
var_op='asgn
I
obj='Var
pag=9
prev=O1256
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=9
prev=O1255
var_op='asgn
I
obj='Var
obj_type='N
pag=9
prev=O1254
var_op='asgn
I
obj='Remark
pag=9
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Frazionate Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=10
prev=O1597
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=10
prev=O1596
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=10
prev=O1595
var_op='asgn
I
obj='Exec
pag=10
prev=O1594
I
obj='Exec
pag=10
prev=O1592
I
obj='While
pag=10
prev=O1591
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1592
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=10
prev=O1601
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1602
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgRet='S'
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
prev=O1611
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O1613
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,257,6))))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,318,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPFRAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPFRAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,155,1)='S' or Substr(riga,155,1)='1' or Substr(riga,155,1)='7'
'Substr(riga,155,1)='E' or Substr(riga,155,1)='3' or Substr(riga,155,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,147,8))) or _flgdataim=1,Date(),CharToDate(Right(Substr(riga,147,8),4)+Substr(Substr(riga,147,8),3,2)+Left(Substr(riga,147,8),2)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,9,1)='1' or Substr(riga,9,1)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,301,1)),'0',iif(Substr(riga,301,1)='S','1',iif(Substr(riga,301,1)='N','1',Substr(riga,301,1))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,231,11))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPRead
arch='tbcauana
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' frazionate del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xraziobo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=10
prev=O1645
var_op='asgn
I
obj='Insert
pag=10
prev=O1643
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
]
rd_kvar=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'Substr(riga,10,4)
'_intercab
'Substr(riga,64,6)
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'Substr(riga,484,16)
'Substr(riga,302,16)
'Substr(riga,190,16)
'Substr(riga,206,16)
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'Substr(riga,32,30)
'_intercit
'Substr(riga,70,50)
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'cOpeProg1
'cIdCau
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)+cOpeProg2+'Z'
'Substr(riga,424,30)
'Substr(riga,813,15)
'Substr(riga,414,5)
'Substr(riga,662,50)
'cOpeProg2
'Substr(riga,328,3)
''1'
'CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6))
'arfn_conv_stato_uic(Substr(riga,29,3))
'Substr(riga,812,1)
'nProgImp
'Substr(riga,62,2)
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
''0'
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'_colleg
]
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1645
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=10
prev=O1654
I
obj='Var
obj_type='N
pag=10
prev=O1653
var_op='asgn
I
obj='Exec
pag=10
prev=O1652
I
nonlocal=True
obj='Var
obj_type='M
pag=10
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Begin
pag=10
prev=O1642
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1643
fatherSonIndex=0
frm_calc='Upper(Substr(riga,511,70))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,581,3))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,584,30))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,614,6)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,620,2))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,622,35))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,657,5))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,302,16))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=10
prev=O1669
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1672
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,120,25))))
]
h=[
19
19
]
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1677
fatherSonIndex=0
frm_calc='''
len=1
name='_tiporap
next=Icpitembatch.CPRead
arch='knarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'_tiporap='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
prev=O1683
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1684
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=10
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1689
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=10
prev=O1700
I
obj='Read
pag=10
prev=O1699
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xntestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=10
prev=O1698
var_op='asgn
I
obj='Var
pag=10
prev=O1697
var_op='asgn
I
obj='Var
pag=10
prev=O1696
var_op='asgn
I
obj='Var
pag=10
prev=O1695
var_op='asgn
I
obj='Var
pag=10
prev=O1694
var_op='asgn
I
obj='Var
pag=10
prev=O1693
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1684
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=10
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1708
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=10
prev=O1719
I
obj='Read
pag=10
prev=O1718
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=10
prev=O1717
var_op='asgn
I
obj='Var
pag=10
prev=O1716
var_op='asgn
I
obj='Var
pag=10
prev=O1715
var_op='asgn
I
obj='Var
pag=10
prev=O1714
var_op='asgn
I
obj='Var
pag=10
prev=O1713
var_op='asgn
I
obj='Var
pag=10
prev=O1712
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=10
prev=O1682
rd_field=[
'TIPORAP
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Substr(riga,120,25)
]
rd_var=[
'_tiporap
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O1666
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1669
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=10
prev=O1741
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,302,16)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=10
prev=O1740
var_op='asgn
I
obj='Var
pag=10
prev=O1739
var_op='asgn
I
obj='Var
pag=10
prev=O1738
var_op='asgn
I
obj='Var
pag=10
prev=O1737
var_op='asgn
I
obj='Var
pag=10
prev=O1736
var_op='asgn
I
obj='Var
pag=10
prev=O1735
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O1665
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O1666
fatherSonIndex=0
obj='Read
pag=10
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
prev=O1664
var_op='asgn
I
obj='Var
pag=10
prev=O1663
var_op='asgn
I
obj='Var
pag=10
prev=O1662
var_op='asgn
I
obj='Var
pag=10
prev=O1661
var_op='asgn
I
obj='Var
pag=10
prev=O1660
var_op='asgn
I
obj='Var
pag=10
prev=O1659
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=10
prev=O1641
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O1640
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O1639
var_op='asgn
I
obj='Read
pag=10
prev=O1638
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,10,4)
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
I
obj='Var
pag=10
prev=O1637
var_op='asgn
I
obj='Var
pag=10
prev=O1636
var_op='asgn
I
obj='Var
pag=10
prev=O1635
var_op='asgn
I
obj='Var
pag=10
prev=O1634
var_op='asgn
I
obj='Var
pag=10
prev=O1633
var_op='asgn
I
obj='Var
obj_type='D
pag=10
prev=O1630
var_op='asgn
I
obj='Case
pag=10
prev=O1629
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1630
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1630
fatherSonIndex=1
frm_calc=[
'Substr(riga,155,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1765
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1765
fatherSonIndex=1
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1630
fatherSonIndex=2
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=10
prev=O1628
var_op='asgn
I
obj='Var
pag=10
prev=O1625
var_op='asgn
I
obj='If
pag=10
prev=O1624
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='xraziobo
father=O1625
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=10
prev=O1779
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1780
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=10
prev=O1786
I
obj='Var
obj_type='N
pag=10
prev=O1785
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,318,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
prev=O1623
var_op='asgn
I
obj='Remark
pag=10
prev=O1620
I
obj='If
pag=10
prev=O1618
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1620
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Substr(riga,263,30))+LRTrim(Substr(riga,295,6))+LRTrim(Substr(riga,293,2)))
]
h=[
19
19
]
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anadip
father=O1796
fatherSonIndex=0
obj='Read
pag=10
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'Substr(riga,257,6)
]
rd_var=[
'_intercit
'_intercab
'_interprv
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=10
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1618
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,246,11))),_codinter,Substr(riga,246,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,263,30))),_citinter,Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,295,6))),_cabinter,Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,293,2))),_prvinter,Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=10
prev=O1812
var_op='asgn
I
obj='Var
pag=10
prev=O1811
var_op='asgn
I
obj='Var
pag=10
prev=O1810
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1613
fatherSonIndex=1
frm_calc='1
len=1
name='_frzerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(zhand,riga+" - "+_descerr)
obj='Exec
pag=10
prev=O1816
I
obj='Var
obj_type='N
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=10
prev=O1608
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1611
fatherSonIndex=0
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,190,16))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,206,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,484,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,190,16))) and Empty(LRTrim(Substr(riga,120,25))) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=10
prev=O1832
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1835
fatherSonIndex=0
frm_calc=''Rapporto continuativo Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=10
prev=O1840
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O1829
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1832
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=10
prev=O1846
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1847
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto per conto del quale assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=10
prev=O1852
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
prev=O1845
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,484,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O1826
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1829
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=10
prev=O1863
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1864
fatherSonIndex=0
frm_calc=''Anagrafica Controparte Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=10
prev=O1869
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
prev=O1862
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,302,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O1823
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1826
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=10
prev=O1880
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1881
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto Operante Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=10
prev=O1886
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
prev=O1879
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,206,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O1822
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1823
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=10
prev=O1897
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1898
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=10
prev=O1903
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
prev=O1896
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,190,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
prev=O1821
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O1607
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xarchfraz
father=O1608
fatherSonIndex=0
obj='Insert
pag=10
rd_kfield=[
'IDPROG
'DATAOPE
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'CONNESCLI
'CONNESOPER
'CAMBIO
'NUMPROG
'TIPOOPRAP
'TIPOINTER
'CODINTER
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'CONNESBEN
'UNIQUECODE
'AGOPER
'RIFIMP
'ZCPARTE
'RAGIO
'MODSVOL
'AREAGEO
'INFORM
'AMMONT
'DURAT
'TIPO
'RRAGIO
'RCOMP
'RAREA
'RIMP
'RFREQ
'CONNALTRO
'DATAIMP
'RTIPO
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'NATURA
'SCOPO
'C_RAPPORTO
'RAPPORTBEN
'PAGASOGOP
'IPCOLLEG
'ORACOLLEG
'DUCOLLEG
]
rd_kvar=[
'conta
'Substr(riga,1,8)        
'Substr(riga,9,1)        
'Substr(riga,10,4)       
'Substr(riga,14,2)       
'Substr(riga,16,2)       
'Substr(riga,18,11)      
'Substr(riga,29,3)       
'Substr(riga,32,30)      
'Substr(riga,62,2)       
'Substr(riga,64,6)       
'Substr(riga,70,50)      
'Substr(riga,120,25)     
'Substr(riga,145,1)      
'Substr(riga,146,1)      
'Substr(riga,147,8)      
'Substr(riga,155,1)      
'Substr(riga,156,3)      
'Substr(riga,159,1)      
'Substr(riga,160,15)     
'Substr(riga,175,15)     
'Substr(riga,190,16)     
'Substr(riga,206,16)     
'Substr(riga,222,9)      
'Substr(riga,231,11)     
'Substr(riga,242,2)      
'Substr(riga,244,2)      
'Substr(riga,246,11)     
'Substr(riga,257,6)      
'Substr(riga,263,30)     
'Substr(riga,293,2)      
'Substr(riga,295,6)      
'Substr(riga,301,1)      
'Substr(riga,302,16)     
'Substr(riga,318,10)     
'Substr(riga,328,3)      
'Substr(riga,331,9)      
'Substr(riga,340,69)     
'Substr(riga,409,5)      
'Substr(riga,414,5)      
'Substr(riga,419,5)      
'Substr(riga,424,30)     
'Substr(riga,454,5)      
'Substr(riga,459,5)      
'Substr(riga,464,5)      
'Substr(riga,469,3)      
'Substr(riga,472,3)      
'Substr(riga,475,3)      
'Substr(riga,478,3)      
'Substr(riga,481,3)      
'Substr(riga,484,16)     
'Substr(riga,500,8)      
'Substr(riga,508,3)      
'Substr(riga,511,70)     
'Substr(riga,581,3)      
'Substr(riga,584,30)     
'Substr(riga,614,6)      
'Substr(riga,620,2)      
'Substr(riga,622,35)     
'Substr(riga,657,5)      
'Substr(riga,662,50)     
'Substr(riga,712,50)     
'Substr(riga,762,25)     
'Substr(riga,787,25)     
'Substr(riga,812,1)      
'Substr(riga,813,15)     
'Substr(riga,828,14)     
'Substr(riga,842,10)     
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
prev=O1590
var_op='asgn
I
obj='Var
pag=10
prev=O1589
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=10
prev=O1588
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O1587
var_op='asgn
I
obj='Remark
pag=10
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Rapporti AGE Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Rapporti AGE Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=11
prev=O1931
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=11
prev=O1930
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=11
prev=O1929
var_op='asgn
I
obj='Exec
pag=11
prev=O1928
I
obj='Exec
pag=11
prev=O1926
I
obj='While
pag=11
prev=O1925
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1926
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='cFlagLire
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,77,1)='S' or Substr(riga,77,1)='1' or Substr(riga,77,1)='7'
'Substr(riga,77,1)='E' or Substr(riga,77,1)='3' or Substr(riga,77,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='xRapporto
next=Icpitembatch.CPRead
arch='jnarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xRapporto))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=11
prev=O1941
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O1942
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPRAPAGE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='jnarapbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=11
prev=O1948
var_op='asgn
I
obj='Insert
pag=11
prev=O1947
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
'PRGIMPRAP
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'Substr(riga,94,5)
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1948
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=11
prev=O1957
I
obj='Var
obj_type='N
pag=11
prev=O1956
var_op='asgn
I
obj='Exec
pag=11
prev=O1955
I
nonlocal=True
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='jnarapbo
father=O1942
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=11
prev=O1961
var_op='asgn
I
obj='Write
pag=11
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1961
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=11
prev=O1971
I
obj='Var
obj_type='N
pag=11
prev=O1970
var_op='asgn
I
obj='Exec
pag=11
prev=O1969
I
nonlocal=True
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'Substr(riga,94,5)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=11
prev=O1940
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Left(riga,25)
]
rd_var=[
'xRapporto
]
I
obj='Var
pag=11
prev=O1937
var_op='asgn
I
obj='Case
pag=11
prev=O1936
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1937
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1937
fatherSonIndex=1
frm_calc=[
'Substr(riga,77,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=11
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1986
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1986
fatherSonIndex=1
frm_calc='Substr(riga,77,1)
len=1
name='cFlagLire
obj='Var
pag=11
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1937
fatherSonIndex=2
frm_calc='Substr(riga,77,1)
len=1
name='cFlagLire
obj='Var
pag=11
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=11
prev=O1935
var_op='asgn
I
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=11
prev=O1924
var_op='asgn
I
obj='Var
pag=11
prev=O1923
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=11
prev=O1922
var_op='asgn
I
obj='Var
obj_type='N
pag=11
prev=O1921
var_op='asgn
I
obj='Var
obj_type='N
pag=11
prev=O1920
var_op='asgn
I
obj='Remark
pag=11
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Informazione Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O2009
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O2008
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O2007
var_op='asgn
I
obj='Exec
pag=12
prev=O2006
I
obj='Exec
pag=12
prev=O2004
I
obj='While
pag=12
prev=O2003
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2004
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPBeginEnd
comment='Dati intermediario
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,75,16)
len=16
name='xConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,50,16)
len=16
name='xSOCTCon
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xSOCTCon)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' informazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,46,1)='S' or Substr(riga,46,1)='1' or Substr(riga,46,1)='7'
'Substr(riga,46,1)='E' or Substr(riga,46,1)='3' or Substr(riga,46,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPRemark
frm_calc="Da sentire Bruno sembra che l'importazione dei soggetti operanti in agenzia delle entrate non sia più attiva.
Ma sul tracciato c'è ancora.
°--°
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,36,8))) or _flgdataim=1,Date(),CharToDate(Right(Substr(riga,36,8),4)+Substr(Substr(riga,36,8),3,2)+Left(Substr(riga,36,8),2)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,159,10)),Utilities.GetAutonumber("PRGINFAGE1\'"+LRTrim(gAzienda)+"'",'',10),Substr(riga,159,10))
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFAGE2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINFAGE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='japopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=12
prev=O2041
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2043
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOGAGE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='jntestbo
h=[
19
19
]
obj='Insert
pag=12
prev=O2048
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'Left(riga,8)+cInfProg2+'O'
'cCli1
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2049
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=12
prev=O2057
I
obj='Var
obj_type='N
pag=12
prev=O2056
var_op='asgn
I
obj='Exec
pag=12
prev=O2055
I
nonlocal=True
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O2043
fatherSonIndex=1
frm_calc=[
'Substr(riga,44,2)='23'
'Substr(riga,44,2)='26'
]
h=[
19
19
19
]
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPWrite
arch='jntestbo
father=O2061
fatherSonIndex=0
h=[
19
19
]
obj='Write
pag=12
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cNumMod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2066
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=12
prev=O2075
I
obj='Var
obj_type='N
pag=12
prev=O2074
var_op='asgn
I
obj='Exec
pag=12
prev=O2073
I
nonlocal=True
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
]
wr_op=[
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPWrite
arch='jntestbo
father=O2061
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=12
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cNumMod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2082
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=12
prev=O2091
I
obj='Var
obj_type='N
pag=12
prev=O2090
var_op='asgn
I
obj='Exec
pag=12
prev=O2089
I
nonlocal=True
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
]
wr_op=[
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=12
prev=O2040
sel_field='*
sel_name='jntestbo
sel_order='jntestbo->CPROWNUM
sel_where='jntestbo->RAPPORTO=Substr(riga,9,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2041
fatherSonIndex=0
frm_calc=[
'jntestbo->CODINTER=cCli1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=12
prev=O2101
var_op='asgn
I
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2101
fatherSonIndex=0
frm_calc='jntestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
prev=O2039
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O2038
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O2036
var_op='asgn
I
obj='Insert
pag=12
prev=O2035
rd_kfield=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'VALUTA
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'_intercab
'Substr(riga,115,6)
'_intercod
'xSOCTCF
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'CharToDate(Right(Substr(riga,36,8),4)+Substr(Substr(riga,36,8),3,2)+Left(Substr(riga,36,8),2))
'_intercit
'Substr(riga,169,50)
'cFlagLire
'Substr(riga,34,1)
'cInfProg1
'Left(riga,8)+cInfProg1+'0'
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,47,3)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2036
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=12
prev=O2116
I
obj='Var
obj_type='N
pag=12
prev=O2115
var_op='asgn
I
obj='Exec
pag=12
prev=O2114
I
nonlocal=True
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
prev=O2034
var_op='asgn
I
obj='Var
pag=12
prev=O2033
var_op='asgn
I
obj='Var
pag=12
prev=O2032
var_op='asgn
I
obj='Var
obj_type='D
pag=12
prev=O2031
var_op='asgn
I
obj='Remark
pag=12
prev=O2028
I
obj='Case
pag=12
prev=O2027
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2028
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O2028
fatherSonIndex=1
frm_calc=[
'Substr(riga,46,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2123
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2123
fatherSonIndex=1
frm_calc='Substr(riga,46,1)
len=1
name='cFlagLire
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2028
fatherSonIndex=2
frm_calc='Substr(riga,46,1)
len=1
name='cFlagLire
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O2026
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O2023
var_op='asgn
I
obj='If
pag=12
prev=O2022
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O2023
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=12
prev=O2137
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O2138
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=12
prev=O2143
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2144
fatherSonIndex=0
frm_calc='xSOCTCon
len=16
name='xSOCTCF
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=12
prev=O2021
var_op='asgn
I
obj='Var
pag=12
prev=O2018
var_op='asgn
I
obj='If
pag=12
prev=O2017
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O2018
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
obj='If
pag=12
prev=O2163
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2164
fatherSonIndex=0
frm_calc='xConnes
len=16
name='cCli1
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
prev=O2016
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
obj='Var
pag=12
prev=O2014
var_op='asgn
I
obj='Begin
pag=12
prev=O2013
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2014
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,104,11))),_codinter,Substr(riga,104,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,121,30))),_citinter,Substr(riga,121,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,153,6))),_cabinter,Substr(riga,153,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,151,2))),_prvinter,Substr(riga,151,2))
len=2
name='_interprv
obj='Var
pag=12
prev=O2184
var_op='asgn
I
obj='Var
pag=12
prev=O2183
var_op='asgn
I
obj='Var
pag=12
prev=O2182
var_op='asgn
I
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
prev=O2002
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O2001
var_op='asgn
I
obj='Var
pag=12
prev=O2000
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O1999
var_op='asgn
I
obj='Remark
pag=12
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni AGE Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O2198
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O2197
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O2196
var_op='asgn
I
obj='Exec
pag=13
prev=O2195
I
obj='Exec
pag=13
prev=O2193
I
obj='While
pag=13
prev=O2192
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2193
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPBeginEnd
comment='Dati intermediario
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,318,10)),Utilities.GetAutonumber("POPERAGE1\'"+LRTrim(gAzienda)+"'",'',10),Substr(riga,318,10))
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("POPERAGE2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,155,1)='S' or Substr(riga,155,1)='1' or Substr(riga,155,1)='7'
'Substr(riga,155,1)='E' or Substr(riga,155,1)='3' or Substr(riga,155,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,147,8))) or _flgdataim=1,Date(),CharToDate(Right(Substr(riga,147,8),4)+Substr(Substr(riga,147,8),3,2)+Left(Substr(riga,147,8),2)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,9,1)='1' or Substr(riga,9,1)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,301,1)),'0',iif(Substr(riga,301,1)='S','1',iif(Substr(riga,301,1)='N','1',Substr(riga,301,1))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,231,11))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPRead
arch='tbcauana
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPEAGE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPInsert
arch='jperazbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=13
prev=O2220
var_op='asgn
I
obj='Insert
pag=13
prev=O2219
rd_kfield=[
'AREAGEO
'CAMBIO
'CDATAOPE
'CDATOPE
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAOPE
'DATAREG
'DESC2
'DESCCIT
'DESCINTER
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'idcauana
'IDEREG
'INFORM
'MODSVOL
'NUMPROG
'OPERAG
'OPRAP
'PAESE
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'SEGNO
'STATOREG
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
'COLLEG
]
rd_kvar=[
'Substr(riga,419,5)
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Substr(riga,10,4)
'_intercab
'Substr(riga,64,6)
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'Substr(riga,302,16)
'Substr(riga,302,16)
'Substr(riga,190,16)
'Substr(riga,206,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'Substr(riga,32,30)
'_intercit
'Substr(riga,70,50)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'cOpeProg1
'cIdCau
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)+cOpeProg2+'O'
'Substr(riga,331,9)
'Substr(riga,414,5)
'cOpeProg2
'Substr(riga,328,3)
''1'
'arfn_conv_stato_uic(Substr(riga,29,3))
'nProgImp
'Substr(riga,62,2)
'_interprv
'Substr(riga,409,5)
'Substr(riga,222,9)
'Substr(riga,120,25)
'Substr(riga,159,1)
''0'
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,156,3)
'_colleg
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2220
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=13
prev=O2229
I
obj='Var
obj_type='N
pag=13
prev=O2228
var_op='asgn
I
obj='Exec
pag=13
prev=O2227
I
nonlocal=True
obj='Var
obj_type='M
pag=13
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O2218
var_op='asgn
I
obj='Var
obj_type='N
pag=13
prev=O2217
var_op='asgn
I
obj='Var
obj_type='N
pag=13
prev=O2216
var_op='asgn
I
obj='Read
pag=13
prev=O2215
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,10,4)
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
I
obj='Var
pag=13
prev=O2214
var_op='asgn
I
obj='Var
pag=13
prev=O2213
var_op='asgn
I
obj='Var
pag=13
prev=O2212
var_op='asgn
I
obj='Var
pag=13
prev=O2211
var_op='asgn
I
obj='Var
pag=13
prev=O2210
var_op='asgn
I
obj='Var
obj_type='D
pag=13
prev=O2207
var_op='asgn
I
obj='Case
pag=13
prev=O2206
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2207
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O2207
fatherSonIndex=1
frm_calc=[
'Substr(riga,155,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2240
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2240
fatherSonIndex=1
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2207
fatherSonIndex=2
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=13
prev=O2205
var_op='asgn
I
obj='Var
pag=13
prev=O2203
var_op='asgn
I
obj='Begin
pag=13
prev=O2202
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2203
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,246,11))),_codinter,Substr(riga,246,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,263,30))),_citinter,Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,295,6))),_cabinter,Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,293,2))),_prvinter,Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=13
prev=O2256
var_op='asgn
I
obj='Var
pag=13
prev=O2255
var_op='asgn
I
obj='Var
pag=13
prev=O2254
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=13
prev=O2191
var_op='asgn
I
obj='Var
pag=13
prev=O2190
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O2189
var_op='asgn
I
obj='Var
obj_type='N
pag=13
prev=O2188
var_op='asgn
I
obj='Remark
pag=13
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Titolari Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Titolari Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=15
prev=O2270
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=15
prev=O2269
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=15
prev=O2268
var_op='asgn
I
obj='Exec
pag=15
prev=O2267
I
obj='Exec
pag=15
prev=O2265
I
obj='While
pag=15
prev=O2264
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2265
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPBeginEnd
comment='Dati intermediario
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,159,10)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
prev=O2278
sons=[
Icpitembatch.CPItemSon
comment='Unicode Assente o vuoto
instr=Icpitembatch.CPVarDecl
father=O2281
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,36,8))) or _flgdataim=1,Date(),CharToDate(Right(Substr(riga,36,8),4)+Substr(Substr(riga,36,8),3,2)+Left(Substr(riga,36,8),2)))
len=8
name='_datareg
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
prev=O2286
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2287
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGPTIT1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPTIT2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTIT\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xapotit
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=15
prev=O2295
var_op='asgn
I
obj='Insert
pag=15
prev=O2294
rd_kfield=[
'CDATOPE
'CDATREG
'CODCAB
'CODDIPE
'CODINTER
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPTIT
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'_intercab
'Substr(riga,115,6)
'_intercod
'Substr(riga,75,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'cInfProg1
'Left(riga,8)+cInfProg1+'0'
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,159,10)
]
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2295
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=15
prev=O2304
I
obj='Var
obj_type='N
pag=15
prev=O2303
var_op='asgn
I
obj='Exec
pag=15
prev=O2302
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=15
prev=O2293
var_op='asgn
I
obj='Var
pag=15
prev=O2292
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2287
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGTITO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGTITO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTIT\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='rapotit
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=15
prev=O2311
var_op='asgn
I
obj='Insert
pag=15
prev=O2310
rd_kfield=[
'CDATOPE
'CDATREG
'CODCAB
'CODDIPE
'CODINTER
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPTIT
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'_intercab
'Substr(riga,115,6)
'_intercod
'Substr(riga,75,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'cInfProg1
'Left(riga,8)+cInfProg1+'0'
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,159,10)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2311
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=15
prev=O2320
I
obj='Var
obj_type='N
pag=15
prev=O2319
var_op='asgn
I
obj='Exec
pag=15
prev=O2318
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=15
prev=O2309
var_op='asgn
I
obj='Var
pag=15
prev=O2308
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='D
pag=15
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='Aggiornamento
instr=Icpitembatch.CPIfElse
father=O2281
fatherSonIndex=1
frm_calc=[
'_tdest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2325
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=15
sel_field='*
sel_name='xapotit
sel_where='xapotit->IDBASE=_unicode and (xapotit->STATOREG='0' or xapotit->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2330
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGPTIT1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPInsert
arch='xapotit
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='xapotit
obj='Write
pag=15
prev=O2335
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_unicode
]
wr_field=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDEREG
'OPRAP
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'CONNESCLI
'DATARETT
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'_intercab
'Substr(riga,115,6)
'_intercod
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'CharToDate(Right(Substr(riga,36,8),4)+Substr(Substr(riga,36,8),3,2)+Left(Substr(riga,36,8),2))
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'xapotit->IDEREG
'Left(Substr(riga,44,2),1)
'_interprv
'Substr(riga,9,25)
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,75,16)
'Date()
]
I
obj='Insert
pag=15
prev=O2334
rd_kfield=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPTIT
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
]
rd_kvar=[
'xapotit->CDATOPE
'xapotit->CODCAB
'xapotit->CODDIPE
'xapotit->CODINTER
'xapotit->CONNESCLI
'xapotit->DATAOPE
'xapotit->DATAREG
'xapotit->DESCCIT
'xapotit->DESCINTER
'xapotit->FLAGRAP
'cInfProg1
'xapotit->IDEREG
'xapotit->NUMPROG
'xapotit->OPRAP
'xapotit->PRGIMPTIT
'xapotit->PROVINCIA
'xapotit->RAPPORTO
''3'
''1'
'xapotit->TIPOINTER
'xapotit->TIPOLEG
'xapotit->TIPOOPRAP
'xapotit->UNIQUECODE
]
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2335
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=15
prev=O2350
I
obj='Var
obj_type='N
pag=15
prev=O2349
var_op='asgn
I
obj='Exec
pag=15
prev=O2348
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2325
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=15
sel_field='*
sel_name='rapotit
sel_where='rapotit->IDBASE=_unicode and (rapotit->STATOREG='0' or rapotit->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2355
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGTITO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPInsert
arch='rapotit
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='rapotit
obj='Write
pag=15
prev=O2360
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_unicode
]
wr_field=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDEREG
'OPRAP
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'CONNESCLI
'DATARETT
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'_intercab
'Substr(riga,115,6)
'_intercod
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'CharToDate(Right(Substr(riga,36,8),4)+Substr(Substr(riga,36,8),3,2)+Left(Substr(riga,36,8),2))
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'rapotit->IDEREG
'Left(Substr(riga,44,2),1)
'_interprv
'Substr(riga,9,25)
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,75,16)
'Date()
]
I
obj='Insert
pag=15
prev=O2359
rd_kfield=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPTIT
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
]
rd_kvar=[
'rapotit->CDATOPE
'rapotit->CODCAB
'rapotit->CODDIPE
'rapotit->CODINTER
'rapotit->CONNESCLI
'rapotit->DATAOPE
'rapotit->DATAREG
'rapotit->DESCCIT
'rapotit->DESCINTER
'rapotit->FLAGRAP
'cInfProg1
'rapotit->IDEREG
'rapotit->NUMPROG
'rapotit->OPRAP
'rapotit->PRGIMPTIT
'rapotit->PROVINCIA
'rapotit->RAPPORTO
''3'
''1'
'rapotit->TIPOINTER
'rapotit->TIPOLEG
'rapotit->TIPOOPRAP
'rapotit->UNIQUECODE
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2360
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=15
prev=O2375
I
obj='Var
obj_type='N
pag=15
prev=O2374
var_op='asgn
I
obj='Exec
pag=15
prev=O2373
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=15
prev=O2277
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2278
fatherSonIndex=0
frm_calc='''
len=1
name='_tdest
next=Icpitembatch.CPRead
arch='xapotit
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_unicode)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
prev=O2384
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='rapotit
father=O2385
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_unicode))
]
h=[
19
19
]
obj='If
pag=15
prev=O2390
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2391
fatherSonIndex=0
frm_calc=''D'
len=1
name='_tdest
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=15
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,159,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2385
fatherSonIndex=1
frm_calc=''P'
len=1
name='_tdest
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=15
prev=O2383
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,159,10)
]
rd_var=[
'_unicode
]
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=15
prev=O2275
var_op='asgn
I
obj='Begin
pag=15
prev=O2274
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2275
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,104,11))),_codinter,Substr(riga,104,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,121,30))),_citinter,Substr(riga,121,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,153,6))),_cabinter,Substr(riga,153,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,151,2))),_prvinter,Substr(riga,151,2))
len=2
name='_interprv
obj='Var
pag=15
prev=O2414
var_op='asgn
I
obj='Var
pag=15
prev=O2413
var_op='asgn
I
obj='Var
pag=15
prev=O2412
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=15
prev=O2263
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=15
prev=O2262
var_op='asgn
I
obj='Var
obj_type='N
pag=15
prev=O2261
var_op='asgn
I
obj='Var
obj_type='N
pag=15
prev=O2260
var_op='asgn
I
obj='Remark
pag=15
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella (Operazioni ExtraConto)
next=Icpitembatch.CPBeginEnd
comment='Variabili di pagina
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni ExtraConto Inserite: '+LRTrim(Str(cNumNew,10,0)) + " - Operazioni ExtraConto Aggiornati: "+LRTrim(Str(cNumMod,10,0))+' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=16
prev=O2430
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=16
prev=O2429
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=16
prev=O2428
var_op='asgn
I
obj='Exec
pag=16
prev=O2427
I
obj='Exec
pag=16
prev=O2425
I
obj='While
pag=16
prev=O2424
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2425
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=16
prev=O2434
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2435
fatherSonIndex=0
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datx
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,16)
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,25,4)+Substr(riga,23,2)+Substr(riga,21,2)
len=8
name='xData
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,1,16)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=16
prev=O2443
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2444
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,30,30))))
]
h=[
19
19
]
obj='If
pag=16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='opextrbo
father=O2449
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xIDB)))
]
h=[
19
19
]
obj='If
pag=16
prev=O2454
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2455
fatherSonIndex=0
frm_calc='''
len=25
name='_aprog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='_afile
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='_dprog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='_dfile
next=Icpitembatch.CPRead
arch='aeoprig
next=Icpitembatch.CPRead
arch='aeopcanc
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_afile)+LRTrim(_aprog)) or (not(Empty(LRTrim(_afile)+LRTrim(_aprog))) and not(Empty(LRTrim(_dfile)+LRTrim(_dprog))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=16
prev=O2466
var_op='asgn
I
obj='If
pag=16
prev=O2465
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='opextrbo
father=O2466
fatherSonIndex=0
obj='Delete
pag=16
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'xIDB
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2466
fatherSonIndex=1
frm_calc='gMsgProc +"Impossibile cancellare operazione con riferimento "+LRTrim(Substr(riga,30,30))+" perché già inviata all'agenzia delle entrate"+ NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=16
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=16
prev=O2464
rd_field=[
'APROG
'AFILE
]
rd_kfield=[
'CONNESINT
'ADATA
]
rd_kvar=[
'cCli1
'_datx
]
rd_var=[
'_dprog
'_dfile
]
I
obj='Read
pag=16
prev=O2463
rd_field=[
'APROG
'AFILE
]
rd_kfield=[
'CONNESINT
'ADATA
]
rd_kvar=[
'cCli1
'_datx
]
rd_var=[
'_aprog
'_afile
]
I
obj='Var
pag=16
pagelocal=True
prev=O2462
var_op='asgn
I
obj='Var
pag=16
pagelocal=True
prev=O2461
var_op='asgn
I
obj='Var
pag=16
pagelocal=True
prev=O2460
var_op='asgn
I
obj='Var
pag=16
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=16
rd_field=[
'IDBASE
'COLLEG
'DATAOPE
]
rd_kfield=[
'RIFIMP
]
rd_kvar=[
'Substr(riga,30,30)
]
rd_var=[
'xIDB
'cCli1
'_datx
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2444
fatherSonIndex=1
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=16
prev=O2497
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='opextrbo
father=O2500
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=16
prev=O2505
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O2506
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGOPEX\'"+LRTrim(gAzienda)+"'",0,10)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='opextrbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=16
prev=O2513
var_op='asgn
I
obj='Insert
pag=16
prev=O2512
rd_kfield=[
'COLLEG
'ANNO
'IDBASE
'DATAOPE
'COINT
'RIFIMP
'PROGOPEX
]
rd_kvar=[
'cCli1
'Substr(riga,17,4)
'xIDB
'CharToDate(xData)
'Substr(riga,29,1)
'Substr(riga,30,30)
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2513
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,1,16)+" per l'operazione extraconto in data: "+Substr(riga,21,8)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=16
prev=O2522
I
obj='Var
obj_type='N
pag=16
prev=O2521
var_op='asgn
I
obj='Exec
pag=16
prev=O2520
I
nonlocal=True
obj='Var
obj_type='M
pag=16
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=16
prev=O2511
var_op='asgn
I
obj='Var
pag=16
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2506
fatherSonIndex=1
frm_calc='gMsgProc +"Esiste già una operazione per il soggetto con codice "+cCli1+ NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=16
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=16
rd_field=[
'IDBASE
]
rd_kfield=[
'COLLEG
'ANNO
]
rd_kvar=[
'cCli1
'Substr(riga,17,4)
]
rd_var=[
'xIDB
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2500
fatherSonIndex=1
frm_calc='1
len=1
name='_opxerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(xhand,riga+" - Intestatario operazione Extraconto non presente")
obj='Exec
pag=16
prev=O2533
I
obj='Var
obj_type='N
pag=16
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=16
prev=O2496
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2497
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=16
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=16
prev=O2495
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,1,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=16
prev=O2494
var_op='asgn
I
obj='Var
obj_type='N
pag=16
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=16
prev=O2442
var_op='asgn
I
obj='Var
pag=16
prev=O2441
var_op='asgn
I
obj='Var
obj_type='D
pag=16
pagelocal=True
prev=O2440
var_op='asgn
I
obj='Var
pag=16
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=16
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=16
prev=O2423
var_op='asgn
I
obj='Var
obj_type='N
pag=16
prev=O2422
var_op='asgn
I
obj='Var
obj_type='N
pag=16
prev=O2421
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=16
prev=O2419
var_op='asgn
I
obj='Begin
pag=16
prev=O2418
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2419
fatherSonIndex=0
len=25
name='_aprog
next=Icpitembatch.CPVarDecl
len=15
name='_afile
next=Icpitembatch.CPVarDecl
len=25
name='_dprog
next=Icpitembatch.CPVarDecl
len=15
name='_dfile
next=Icpitembatch.CPVarDecl
len=8
name='_datx
obj='Var
obj_type='D
pag=16
pagelocal=True
prev=O2552
I
obj='Var
pag=16
pagelocal=True
prev=O2551
I
obj='Var
pag=16
pagelocal=True
prev=O2550
I
obj='Var
pag=16
pagelocal=True
prev=O2549
I
obj='Var
pag=16
pagelocal=True
I
I
]
w=[
150
150
]
I
obj='Remark
pag=16
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Deleghe sui rapporti
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Deleghe Rapporti Inserite: '+LRTrim(Str(cNumNew,10,0)) + " - Deleghe Rapporti Aggiornate: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=17
prev=O2565
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=17
prev=O2564
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=17
prev=O2563
var_op='asgn
I
obj='Exec
pag=17
prev=O2562
I
obj='Exec
pag=17
prev=O2560
I
obj='While
pag=17
prev=O2559
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2560
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPRead
arch='delegabo
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,46,4)+Substr(riga,44,2)+Substr(riga,42,2)
len=8
name='xData
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,55,4)+Substr(riga,53,2)+Substr(riga,51,2)
len=8
name='xDatF
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=17
prev=O2573
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPSelect
father=O2574
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='delegabo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=17
prev=O2582
var_op='asgn
I
obj='Insert
pag=17
prev=O2581
rd_kfield=[
'RAPPORTO
'CPROWNUM
'CODINTER
'DATAINI
'TIPORAP
'DATAFINE
'IDBASE
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
'Substr(riga,26,16)
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
'LibreriaMit.UniqueId()
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2582
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=17
prev=O2591
I
obj='Var
obj_type='N
pag=17
prev=O2590
var_op='asgn
I
obj='Exec
pag=17
prev=O2589
I
nonlocal=True
obj='Var
obj_type='M
pag=17
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=17
prev=O2579
var_op='asgn
I
obj='Select
pag=17
sel_field='*
sel_name='delegabo
sel_order='delegabo->CPROWNUM
sel_where='delegabo->RAPPORTO=Left(riga,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2579
fatherSonIndex=0
frm_calc='delegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=17
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='delegabo
father=O2574
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=17
prev=O2599
var_op='asgn
I
obj='Write
pag=17
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2599
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=17
prev=O2609
I
obj='Var
obj_type='N
pag=17
prev=O2608
var_op='asgn
I
obj='Exec
pag=17
prev=O2607
I
nonlocal=True
obj='Var
obj_type='M
pag=17
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'TIPORAP
'DATAFINE
]
wr_op=[
'=
'=
'=
]
wr_var=[
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=17
prev=O2572
var_op='asgn
I
obj='Var
pag=17
prev=O2571
var_op='asgn
I
obj='Read
pag=17
prev=O2570
rd_field=[
'CPROWNUM
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,16)
]
rd_var=[
'cMaxRow
]
I
obj='Var
obj_type='N
pag=17
prev=O2569
var_op='asgn
I
obj='Var
obj_type='M
pag=17
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=17
prev=O2558
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=17
prev=O2557
var_op='asgn
I
obj='Var
obj_type='N
pag=17
prev=O2556
var_op='asgn
I
obj='Var
obj_type='N
pag=17
prev=O2555
var_op='asgn
I
obj='Remark
pag=17
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file SOGOPE.TXT altri soggetti operanti
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport')
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Soggetti operanti inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Soggetti operanti aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=18
prev=O2631
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=18
prev=O2630
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=18
prev=O2629
var_op='asgn
I
obj='Exec
pag=18
prev=O2628
I
obj='Exec
pag=18
prev=O2626
I
obj='While
pag=18
prev=O2625
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2626
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_salta
next=Icpitembatch.CPRemark
frm_calc='Verfico la presenza di _unicode nelle tabelle rapopebo/operazbo/fraziobo
next=Icpitembatch.CPRead
arch='rapopebo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=18
prev=O2640
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2642
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='soginfo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=18
prev=O2649
var_op='asgn
I
obj='Insert
pag=18
prev=O2647
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cInfProg2
'Substr(riga,48,1)
'Substr(riga,50,25)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2649
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=18
prev=O2658
I
obj='Var
obj_type='N
pag=18
prev=O2657
var_op='asgn
I
obj='Exec
pag=18
prev=O2656
I
nonlocal=True
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=18
sel_field='*
sel_name='soginfo
sel_where='soginfo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2647
fatherSonIndex=0
frm_calc='soginfo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=18
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=18
prev=O2639
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cOpeProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O2640
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=18
prev=O2672
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2674
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='sogopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=18
prev=O2681
var_op='asgn
I
obj='Insert
pag=18
prev=O2679
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cOpeProg2
'Substr(riga,48,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2681
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=18
prev=O2690
I
obj='Var
obj_type='N
pag=18
prev=O2689
var_op='asgn
I
obj='Exec
pag=18
prev=O2688
I
nonlocal=True
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=18
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2679
fatherSonIndex=0
frm_calc='sogopebo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=18
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=18
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cOpeProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O2672
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=18
prev=O2704
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2706
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='sogopefbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_salta
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=18
prev=O2715
var_op='asgn
I
obj='Var
obj_type='N
pag=18
prev=O2713
var_op='asgn
I
obj='Insert
pag=18
prev=O2711
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cOpeProg2
'Substr(riga,48,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2713
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=18
prev=O2723
I
obj='Var
obj_type='N
pag=18
prev=O2722
var_op='asgn
I
obj='Exec
pag=18
prev=O2721
I
nonlocal=True
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=18
sel_field='*
sel_name='sogopefbo
sel_where='sogopefbo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2711
fatherSonIndex=0
frm_calc='sogopefbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=18
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=18
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cOpeProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
comment='se non trova il valore nelle tre tabelle da errore e stoppa la procedura
instr=Icpitembatch.CPVarDecl
father=O2704
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errore nella valorizazione del campo IDFILEBO nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,21,16)+" non risulta associabile a nessuna informazione/operazione.  Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_salta
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=18
prev=O2740
I
obj='Var
obj_type='N
pag=18
prev=O2739
var_op='asgn
I
obj='Var
obj_type='N
pag=18
prev=O2738
var_op='asgn
I
obj='Exec
pag=18
prev=O2737
I
nonlocal=True
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Remark
pag=18
prev=O2638
I
obj='Var
obj_type='N
pag=18
prev=O2637
var_op='asgn
I
obj='Var
pag=18
prev=O2636
var_op='asgn
I
obj='Var
obj_type='N
pag=18
prev=O2635
var_op='asgn
I
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=18
prev=O2624
var_op='asgn
I
obj='Var
obj_type='N
pag=18
prev=O2623
var_op='asgn
I
obj='Var
pag=18
prev=O2622
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=18
prev=O2621
var_op='asgn
I
obj='Remark
pag=18
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file INTEST.TXT altri intestatari
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Intestatari inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Intestatari aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=19
prev=O2756
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=19
prev=O2755
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=19
prev=O2754
var_op='asgn
I
obj='Exec
pag=19
prev=O2753
I
obj='Exec
pag=19
prev=O2751
I
obj='While
pag=19
prev=O2750
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2751
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPRemark
frm_calc='Verifico in intestbo che ci sia già un recod con lo stesso codice rapporto e memorizzo i dati della riga necessari per crearne una nuova.
next=Icpitembatch.CPSelect
h=[
19
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Se trovo il record inserisco il nuovo intestatario
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
]
obj='If
pag=19
prev=O2766
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='intestbo
father=O2767
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=19
prev=O2772
var_op='asgn
I
obj='Insert
pag=19
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
]
rd_kvar=[
'ciidbase
'cMaxRow + 1
'cidataini
'iif(Empty(Substr(riga,121,1)) ,'P',Substr(riga,121,1))
'Substr(riga,26,16)
'cinumprog
'Substr(riga,1,25)
'citiporap
''0'
'DateToChar(cidataini)+cinumprog+'O'
'Left(LRTrim(Substr(riga,26,16))+Space(5),16)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2772
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=19
prev=O2781
I
obj='Var
obj_type='N
pag=19
prev=O2780
var_op='asgn
I
obj='Exec
pag=19
prev=O2779
I
nonlocal=True
obj='Var
obj_type='M
pag=19
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=19
prev=O2764
I
obj='Select
pag=19
prev=O2763
sel_field='*
sel_name='intestbo
sel_order='intestbo->CPROWNUM
sel_where='intestbo->RAPPORTO=Substr(riga,1,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2764
fatherSonIndex=0
frm_calc=[
'Substr(riga,26,16)=intestbo->CODINTER
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->CPROWNUM
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->IDBASE
len=10
name='ciidbase
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->DATAINI
len=8
name='cidataini
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->DATAFINE
len=8
name='cidatafine
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->CODINTER
len=12
name='cicodinter
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->NUMPROG1
len=11
name='cinumprog
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->TIPORAP
len=1
name='citiporap
obj='Var
pag=19
prev=O2795
var_op='asgn
I
obj='Var
pag=19
prev=O2794
var_op='asgn
I
obj='Var
pag=19
prev=O2793
var_op='asgn
I
obj='Var
obj_type='D
pag=19
prev=O2792
var_op='asgn
I
obj='Var
obj_type='D
pag=19
prev=O2791
var_op='asgn
I
obj='Var
pag=19
prev=O2790
var_op='asgn
I
obj='Var
obj_type='N
pag=19
prev=O2787
var_op='asgn
I
obj='If
pag=19
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2787
fatherSonIndex=0
frm_calc='intestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=19
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2764
fatherSonIndex=1
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=19
prev=O2804
I
obj='Var
obj_type='N
pag=19
prev=O2803
var_op='asgn
I
obj='Exec
pag=19
prev=O2802
I
nonlocal=True
obj='Var
obj_type='M
pag=19
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
150
]
I
obj='Remark
pag=19
prev=O2762
I
obj='Var
obj_type='N
pag=19
prev=O2761
var_op='asgn
I
obj='Var
obj_type='N
pag=19
prev=O2760
var_op='asgn
I
obj='Var
obj_type='M
pag=19
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=19
prev=O2749
var_op='asgn
I
obj='Var
obj_type='N
pag=19
prev=O2748
var_op='asgn
I
obj='Var
pag=19
prev=O2747
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=19
prev=O2746
var_op='asgn
I
obj='Remark
pag=19
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Deleghe sui rapporti
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Deleghe Rapporti Inserite: '+LRTrim(Str(cNumNew,10,0)) + " - Deleghe Rapporti Aggiornate: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=20
prev=O2818
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=20
prev=O2817
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=20
prev=O2816
var_op='asgn
I
obj='Exec
pag=20
prev=O2815
I
obj='Exec
pag=20
prev=O2813
I
obj='While
pag=20
prev=O2812
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2813
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPRead
arch='xelegabo
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,46,4)+Substr(riga,44,2)+Substr(riga,42,2)
len=8
name='xData
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,55,4)+Substr(riga,53,2)+Substr(riga,51,2)
len=8
name='xDatF
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=20
prev=O2826
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPSelect
father=O2827
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='xelegabo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=20
prev=O2835
var_op='asgn
I
obj='Insert
pag=20
prev=O2834
rd_kfield=[
'RAPPORTO
'CPROWNUM
'CODINTER
'DATAINI
'TIPORAP
'DATAFINE
'IDBASE
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
'Substr(riga,26,16)
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
'LibreriaMit.UniqueId()
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2835
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=20
prev=O2844
I
obj='Var
obj_type='N
pag=20
prev=O2843
var_op='asgn
I
obj='Exec
pag=20
prev=O2842
I
nonlocal=True
obj='Var
obj_type='M
pag=20
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=20
prev=O2832
var_op='asgn
I
obj='Select
pag=20
sel_field='*
sel_name='xelegabo
sel_order='xelegabo->CPROWNUM
sel_where='xelegabo->RAPPORTO=Left(riga,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2832
fatherSonIndex=0
frm_calc='xelegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=20
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='xelegabo
father=O2827
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=20
prev=O2852
var_op='asgn
I
obj='Write
pag=20
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2852
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=20
prev=O2862
I
obj='Exec
pag=20
prev=O2861
I
obj='Var
obj_type='N
pag=20
prev=O2860
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=20
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'TIPORAP
'DATAFINE
]
wr_op=[
'=
'=
'=
]
wr_var=[
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=20
prev=O2825
var_op='asgn
I
obj='Var
pag=20
prev=O2824
var_op='asgn
I
obj='Read
pag=20
prev=O2823
rd_field=[
'CPROWNUM
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,16)
]
rd_var=[
'cMaxRow
]
I
obj='Var
obj_type='N
pag=20
prev=O2822
var_op='asgn
I
obj='Var
obj_type='M
pag=20
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=20
prev=O2811
var_op='asgn
I
obj='Var
obj_type='N
pag=20
prev=O2810
var_op='asgn
I
obj='Var
obj_type='N
pag=20
prev=O2809
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=20
prev=O2808
var_op='asgn
I
obj='Remark
pag=20
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file SOGOPE.TXT altri soggetti operanti in Provvisorio
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport')
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Soggetti operanti inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Soggetti operanti aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=21
prev=O2884
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=21
prev=O2883
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=21
prev=O2882
var_op='asgn
I
obj='Exec
pag=21
prev=O2881
I
obj='Exec
pag=21
prev=O2879
I
obj='While
pag=21
prev=O2878
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2879
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_salta
next=Icpitembatch.CPRemark
frm_calc='Verfico la presenza di _unicode nelle tabelle rapopebo/operazbo/fraziobo
next=Icpitembatch.CPRead
arch='xapopebo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=21
prev=O2893
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2895
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xoginfo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=21
prev=O2902
var_op='asgn
I
obj='Insert
pag=21
prev=O2900
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cInfProg2
'Substr(riga,48,1)
'Substr(riga,50,25)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2902
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=21
prev=O2911
I
obj='Var
obj_type='N
pag=21
prev=O2910
var_op='asgn
I
obj='Exec
pag=21
prev=O2909
I
nonlocal=True
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=21
sel_field='*
sel_name='xoginfo
sel_where='xoginfo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2900
fatherSonIndex=0
frm_calc='xoginfo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=21
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=21
prev=O2892
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cInfProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O2893
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=21
prev=O2925
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2927
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xogopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=21
prev=O2934
var_op='asgn
I
obj='Insert
pag=21
prev=O2932
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cOpeProg2
'Substr(riga,48,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2934
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=21
prev=O2943
I
obj='Var
obj_type='N
pag=21
prev=O2942
var_op='asgn
I
obj='Exec
pag=21
prev=O2941
I
nonlocal=True
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=21
sel_field='*
sel_name='xogopebo
sel_where='xogopebo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2932
fatherSonIndex=0
frm_calc='xogopebo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=21
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=21
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_idbase
'cInfProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O2925
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=21
prev=O2957
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2959
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xogopefbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_salta
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=21
prev=O2968
var_op='asgn
I
obj='Var
obj_type='N
pag=21
prev=O2966
var_op='asgn
I
obj='Insert
pag=21
prev=O2964
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cOpeProg2
'Substr(riga,48,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2966
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=21
prev=O2976
I
obj='Var
obj_type='N
pag=21
prev=O2975
var_op='asgn
I
obj='Exec
pag=21
prev=O2974
I
nonlocal=True
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=21
sel_field='*
sel_name='xogopefbo
sel_where='xogopefbo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2964
fatherSonIndex=0
frm_calc='xogopefbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=21
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=21
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cInfProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
comment='se non trova il valore nelle tre tabelle da errore e stoppa la procedura
instr=Icpitembatch.CPVarDecl
father=O2957
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errore nella valorizazione del campo IDFILEBO nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,21,16)+" non risulta associabile a nessuna informazione/operazione.  Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_salta
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=21
prev=O2993
I
obj='Var
obj_type='N
pag=21
prev=O2992
var_op='asgn
I
obj='Exec
pag=21
prev=O2991
I
obj='Var
obj_type='N
pag=21
prev=O2990
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Remark
pag=21
prev=O2891
I
obj='Var
obj_type='N
pag=21
prev=O2890
var_op='asgn
I
obj='Var
pag=21
prev=O2889
var_op='asgn
I
obj='Var
obj_type='N
pag=21
prev=O2888
var_op='asgn
I
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=21
prev=O2877
var_op='asgn
I
obj='Var
obj_type='N
pag=21
prev=O2876
var_op='asgn
I
obj='Var
pag=21
prev=O2875
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=21
prev=O2874
var_op='asgn
I
obj='Remark
pag=21
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file INTEST.TXT altri intestatari
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Intestatari inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Intestatari aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=22
prev=O3009
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=22
prev=O3008
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=22
prev=O3007
var_op='asgn
I
obj='Exec
pag=22
prev=O3006
I
obj='Exec
pag=22
prev=O3004
I
obj='While
pag=22
prev=O3003
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3004
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPRemark
frm_calc='Verifico in intestbo che ci sia già un recod con lo stesso codice rapporto e memorizzo i dati della riga necessari per crearne una nuova.
next=Icpitembatch.CPSelect
h=[
19
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Se trovo il record inserisco il nuovo intestatario
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
]
obj='If
pag=22
prev=O3019
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xntestbo
father=O3020
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=22
prev=O3025
var_op='asgn
I
obj='Insert
pag=22
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
]
rd_kvar=[
'ciidbase
'cMaxRow + 1
'cidataini
'iif(Empty(Substr(riga,121,1)) ,'P',Substr(riga,121,1))
'Substr(riga,26,16)
'cinumprog
'Substr(riga,1,25)
'citiporap
''0'
'DateToChar(cidataini)+cinumprog+'O'
'Left(LRTrim(Substr(riga,26,16))+Space(5),16)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3025
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=22
prev=O3034
I
obj='Var
obj_type='N
pag=22
prev=O3033
var_op='asgn
I
obj='Exec
pag=22
prev=O3032
I
nonlocal=True
obj='Var
obj_type='M
pag=22
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=22
prev=O3017
I
obj='Select
pag=22
prev=O3016
sel_field='*
sel_name='xntestbo
sel_order='xntestbo->CPROWNUM
sel_where='xntestbo->RAPPORTO=Substr(riga,1,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3017
fatherSonIndex=0
frm_calc=[
'Substr(riga,26,16)=xntestbo->CODINTER
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->CPROWNUM
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->IDBASE
len=10
name='ciidbase
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->DATAINI
len=8
name='cidataini
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->DATAFINE
len=8
name='cidatafine
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->CODINTER
len=12
name='cicodinter
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->NUMPROG1
len=11
name='cinumprog
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->TIPORAP
len=1
name='citiporap
obj='Var
pag=22
prev=O3048
var_op='asgn
I
obj='Var
pag=22
prev=O3047
var_op='asgn
I
obj='Var
pag=22
prev=O3046
var_op='asgn
I
obj='Var
obj_type='D
pag=22
prev=O3045
var_op='asgn
I
obj='Var
obj_type='D
pag=22
prev=O3044
var_op='asgn
I
obj='Var
pag=22
prev=O3043
var_op='asgn
I
obj='Var
obj_type='N
pag=22
prev=O3040
var_op='asgn
I
obj='If
pag=22
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3040
fatherSonIndex=0
frm_calc='xntestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=22
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3017
fatherSonIndex=1
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=22
prev=O3057
I
obj='Var
obj_type='N
pag=22
prev=O3056
var_op='asgn
I
obj='Exec
pag=22
prev=O3055
I
nonlocal=True
obj='Var
obj_type='M
pag=22
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
150
]
I
obj='Remark
pag=22
prev=O3015
I
obj='Var
obj_type='N
pag=22
prev=O3014
var_op='asgn
I
obj='Var
obj_type='N
pag=22
prev=O3013
var_op='asgn
I
obj='Var
obj_type='M
pag=22
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=22
prev=O3002
var_op='asgn
I
obj='Var
obj_type='N
pag=22
prev=O3001
var_op='asgn
I
obj='Var
pag=22
prev=O3000
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=22
prev=O2999
var_op='asgn
I
obj='Remark
pag=22
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Deleghe sui rapporti
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Deleghe Rapporti Inserite: '+LRTrim(Str(cNumNew,10,0)) + " - Deleghe Rapporti Aggiornate: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=23
prev=O3071
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=23
prev=O3070
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=23
prev=O3069
var_op='asgn
I
obj='Exec
pag=23
prev=O3068
I
obj='Exec
pag=23
prev=O3066
I
obj='While
pag=23
prev=O3065
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3066
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPRead
arch='jelegabo
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,46,4)+Substr(riga,44,2)+Substr(riga,42,2)
len=8
name='xData
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,55,4)+Substr(riga,53,2)+Substr(riga,51,2)
len=8
name='xDatF
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=23
prev=O3079
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPSelect
father=O3080
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='jelegabo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=23
prev=O3088
var_op='asgn
I
obj='Insert
pag=23
prev=O3087
rd_kfield=[
'RAPPORTO
'CPROWNUM
'CODINTER
'DATAINI
'TIPORAP
'DATAFINE
'IDBASE
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
'Substr(riga,26,16)
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
'LibreriaMit.UniqueId()
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3088
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=23
prev=O3097
I
obj='Var
obj_type='N
pag=23
prev=O3096
var_op='asgn
I
obj='Exec
pag=23
prev=O3095
I
nonlocal=True
obj='Var
obj_type='M
pag=23
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=23
prev=O3085
var_op='asgn
I
obj='Select
pag=23
sel_field='*
sel_name='jelegabo
sel_order='jelegabo->CPROWNUM
sel_where='jelegabo->RAPPORTO=Left(riga,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3085
fatherSonIndex=0
frm_calc='jelegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=23
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='jelegabo
father=O3080
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=23
prev=O3105
var_op='asgn
I
obj='Write
pag=23
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3105
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=23
prev=O3115
I
obj='Var
obj_type='N
pag=23
prev=O3114
var_op='asgn
I
obj='Exec
pag=23
prev=O3113
I
nonlocal=True
obj='Var
obj_type='M
pag=23
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'TIPORAP
'DATAFINE
]
wr_op=[
'=
'=
'=
]
wr_var=[
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=23
prev=O3078
var_op='asgn
I
obj='Var
pag=23
prev=O3077
var_op='asgn
I
obj='Read
pag=23
prev=O3076
rd_field=[
'CPROWNUM
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,16)
]
rd_var=[
'cMaxRow
]
I
obj='Var
obj_type='N
pag=23
prev=O3075
var_op='asgn
I
obj='Var
obj_type='M
pag=23
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=23
prev=O3064
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=23
prev=O3063
var_op='asgn
I
obj='Var
obj_type='N
pag=23
prev=O3062
var_op='asgn
I
obj='Var
obj_type='N
pag=23
prev=O3061
var_op='asgn
I
obj='Remark
pag=23
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file SOGAGE.TXT altri soggetti operanti in Provvisorio
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport')
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Soggetti operanti inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Soggetti operanti aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=24
prev=O3137
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=24
prev=O3136
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=24
prev=O3135
var_op='asgn
I
obj='Exec
pag=24
prev=O3134
I
obj='Exec
pag=24
prev=O3132
I
obj='While
pag=24
prev=O3131
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3132
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_salta
next=Icpitembatch.CPRemark
frm_calc='Verfico la presenza di _unicode nelle tabelle rapopebo/operazbo/fraziobo
next=Icpitembatch.CPRead
arch='japopebo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=24
prev=O3146
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3148
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='joginfo
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=24
prev=O3155
var_op='asgn
I
obj='Insert
pag=24
prev=O3153
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
]
rd_kvar=[
'_unicode
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'_unicode
'cInfProg2
'Substr(riga,48,1)
'Substr(riga,50,25)
]
I
obj='Select
pag=24
sel_field='*
sel_name='joginfo
sel_where='joginfo->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3153
fatherSonIndex=0
frm_calc='joginfo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=24
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=24
prev=O3145
rd_field=[
'IDBASE
'NUMPROG
]
rd_kfield=[
'IDBASE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_unicode
'cInfProg2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='jperazbo
father=O3146
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=24
prev=O3170
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3172
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='jogopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=24
prev=O3179
var_op='asgn
I
obj='Insert
pag=24
prev=O3177
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
]
rd_kvar=[
'_unicode
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'_unicode
'cOpeProg2
'Substr(riga,48,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3179
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=24
prev=O3188
I
obj='Var
obj_type='N
pag=24
prev=O3187
var_op='asgn
I
obj='Exec
pag=24
prev=O3186
I
nonlocal=True
obj='Var
obj_type='M
pag=24
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=24
sel_field='*
sel_name='jogopebo
sel_where='jogopebo->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3177
fatherSonIndex=0
frm_calc='jogopebo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=24
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=24
rd_field=[
'IDBASE
'NUMPROG
]
rd_kfield=[
'IDBASE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
'cOpeProg2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3170
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errore nella valorizazione del campo IDFILEBO nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,21,16)+" non risulta associabile a nessuna informazione/operazione.  Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_salta
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=24
prev=O3205
I
obj='Var
obj_type='N
pag=24
prev=O3204
var_op='asgn
I
obj='Exec
pag=24
prev=O3203
I
obj='Var
obj_type='N
pag=24
prev=O3202
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=24
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Remark
pag=24
prev=O3144
I
obj='Var
obj_type='N
pag=24
prev=O3143
var_op='asgn
I
obj='Var
pag=24
prev=O3142
var_op='asgn
I
obj='Var
obj_type='N
pag=24
prev=O3141
var_op='asgn
I
obj='Var
obj_type='M
pag=24
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=24
prev=O3130
var_op='asgn
I
obj='Var
obj_type='N
pag=24
prev=O3129
var_op='asgn
I
obj='Var
obj_type='N
pag=24
prev=O3128
var_op='asgn
I
obj='Var
pag=24
prev=O3127
var_op='asgn
I
obj='Remark
pag=24
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file INTAGE.TXT altri intestatari
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Intestatari inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Intestatari aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=25
prev=O3220
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=25
prev=O3219
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=25
prev=O3218
var_op='asgn
I
obj='Exec
pag=25
prev=O3217
I
obj='Exec
pag=25
prev=O3215
I
obj='While
pag=25
prev=O3214
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3215
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPRemark
frm_calc='Verifico in intestbo che ci sia già un recod con lo stesso codice rapporto e memorizzo i dati della riga necessari per crearne una nuova.
next=Icpitembatch.CPSelect
h=[
19
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Se trovo il record inserisco il nuovo intestatario
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
]
obj='If
pag=25
prev=O3230
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='jntestbo
father=O3231
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=25
prev=O3236
var_op='asgn
I
obj='Insert
pag=25
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
]
rd_kvar=[
'ciidbase
'cMaxRow + 1
'cidataini
'iif(Empty(Substr(riga,121,1)) ,'P',Substr(riga,121,1))
'Substr(riga,26,16)
'cinumprog
'Substr(riga,1,25)
'citiporap
''0'
'DateToChar(cidataini)+cinumprog+'O'
'Left(LRTrim(Substr(riga,26,16))+Space(5),16)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3236
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=25
prev=O3245
I
obj='Var
obj_type='N
pag=25
prev=O3244
var_op='asgn
I
obj='Exec
pag=25
prev=O3243
I
nonlocal=True
obj='Var
obj_type='M
pag=25
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=25
prev=O3228
I
obj='Select
pag=25
prev=O3227
sel_field='*
sel_name='jntestbo
sel_order='jntestbo->CPROWNUM
sel_where='jntestbo->RAPPORTO=Substr(riga,1,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3228
fatherSonIndex=0
frm_calc=[
'Substr(riga,26,16)=jntestbo->CODINTER
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->CPROWNUM
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->IDBASE
len=10
name='ciidbase
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->DATAINI
len=8
name='cidataini
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->DATAFINE
len=8
name='cidatafine
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->CODINTER
len=12
name='cicodinter
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->NUMPROG1
len=11
name='cinumprog
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->TIPORAP
len=1
name='citiporap
obj='Var
pag=25
prev=O3259
var_op='asgn
I
obj='Var
pag=25
prev=O3258
var_op='asgn
I
obj='Var
pag=25
prev=O3257
var_op='asgn
I
obj='Var
obj_type='D
pag=25
prev=O3256
var_op='asgn
I
obj='Var
obj_type='D
pag=25
prev=O3255
var_op='asgn
I
obj='Var
pag=25
prev=O3254
var_op='asgn
I
obj='Var
obj_type='N
pag=25
prev=O3251
var_op='asgn
I
obj='If
pag=25
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3251
fatherSonIndex=0
frm_calc='jntestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=25
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3228
fatherSonIndex=1
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=25
prev=O3268
I
obj='Var
obj_type='N
pag=25
prev=O3267
var_op='asgn
I
obj='Exec
pag=25
prev=O3266
I
nonlocal=True
obj='Var
obj_type='M
pag=25
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
150
]
I
obj='Remark
pag=25
prev=O3226
I
obj='Var
obj_type='N
pag=25
prev=O3225
var_op='asgn
I
obj='Var
obj_type='N
pag=25
prev=O3224
var_op='asgn
I
obj='Var
obj_type='M
pag=25
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=25
prev=O3213
var_op='asgn
I
obj='Var
obj_type='N
pag=25
prev=O3212
var_op='asgn
I
obj='Var
obj_type='N
pag=25
prev=O3211
var_op='asgn
I
obj='Var
pag=25
prev=O3210
var_op='asgn
I
obj='Remark
pag=25
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Intestatari Operazioni Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Intestatari Operazioni Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=26
prev=O3282
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=26
prev=O3281
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=26
prev=O3280
var_op='asgn
I
obj='Exec
pag=26
prev=O3279
I
obj='Exec
pag=26
prev=O3277
I
obj='While
pag=26
prev=O3276
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3277
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,48,1)='F'
'Substr(riga,48,1)='O'
]
h=[
19
19
19
]
obj='If
pag=26
prev=O3289
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O3290
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=26
prev=O3295
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O3296
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=26
prev=O3301
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientifrz
father=O3302
fatherSonIndex=0
obj='Insert
pag=26
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=26
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientifrz
father=O3296
fatherSonIndex=1
obj='Insert
pag=26
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=26
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O3290
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=26
prev=O3325
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O3326
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=26
prev=O3331
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O3332
fatherSonIndex=0
obj='Insert
pag=26
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=26
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientiope
father=O3326
fatherSonIndex=1
obj='Insert
pag=26
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=26
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=26
prev=O3288
var_op='asgn
I
obj='Var
obj_type='N
pag=26
prev=O3287
var_op='asgn
I
obj='Var
obj_type='N
pag=26
prev=O3286
var_op='asgn
I
obj='Var
obj_type='M
pag=26
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=26
prev=O3275
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=26
prev=O3274
var_op='asgn
I
obj='Var
obj_type='N
pag=26
prev=O3273
var_op='asgn
I
obj='Var
obj_type='N
pag=26
prev=O3272
var_op='asgn
I
obj='Remark
pag=26
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Altri Soggetti Operazioni Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Altri Soggetti Operazioni Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=29
prev=O3366
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=29
prev=O3365
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=29
prev=O3364
var_op='asgn
I
obj='Exec
pag=29
prev=O3363
I
obj='Exec
pag=29
prev=O3361
I
obj='While
pag=29
prev=O3360
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3361
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,48,1)='F'
'Substr(riga,48,1)='O'
]
h=[
19
19
19
]
obj='If
pag=29
prev=O3373
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O3374
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=29
prev=O3379
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O3380
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=29
prev=O3385
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistifrz
father=O3386
fatherSonIndex=0
obj='Insert
pag=29
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=29
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xerzistifrz
father=O3380
fatherSonIndex=1
obj='Insert
pag=29
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=29
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O3374
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=29
prev=O3409
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O3410
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=29
prev=O3415
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistiope
father=O3416
fatherSonIndex=0
obj='Insert
pag=29
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=29
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xerzistiope
father=O3410
fatherSonIndex=1
obj='Insert
pag=29
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=29
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=29
prev=O3372
var_op='asgn
I
obj='Var
obj_type='N
pag=29
prev=O3371
var_op='asgn
I
obj='Var
obj_type='N
pag=29
prev=O3370
var_op='asgn
I
obj='Var
obj_type='M
pag=29
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=29
prev=O3359
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=29
prev=O3358
var_op='asgn
I
obj='Var
obj_type='N
pag=29
prev=O3357
var_op='asgn
I
obj='Var
obj_type='N
pag=29
prev=O3356
var_op='asgn
I
obj='Remark
pag=29
x=23
y=25
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Beneficiari Operazioni Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Beneficiari Operazioni Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=28
prev=O3450
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=28
prev=O3449
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=28
prev=O3448
var_op='asgn
I
obj='Exec
pag=28
prev=O3447
I
obj='Exec
pag=28
prev=O3445
I
obj='While
pag=28
prev=O3444
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3445
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=28
prev=O3454
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3455
fatherSonIndex=0
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,48,1)='F'
'Substr(riga,48,1)='O'
]
h=[
19
19
19
]
obj='If
pag=28
prev=O3462
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O3463
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=28
prev=O3468
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O3469
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=28
prev=O3474
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3475
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='beneficfrz
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O3483
var_op='asgn
I
obj='Insert
pag=28
prev=O3482
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'Substr(riga,75,70)
'Substr(riga,145,3)
'Substr(riga,148,30)
'Substr(riga,178,6)
'Substr(riga,184,2)
'Substr(riga,186,35)
'Substr(riga,221,5)
'cMaxRow
]
I
obj='Var
obj_type='N
pag=28
prev=O3480
var_op='asgn
I
obj='Select
pag=28
sel_field='*
sel_name='beneficfrz
sel_order='beneficfrz->CPROWNUM
sel_where='beneficfrz->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3480
fatherSonIndex=0
frm_calc='beneficfrz->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3469
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='xeneficfrz
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O3500
var_op='asgn
I
obj='Insert
pag=28
prev=O3499
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'Substr(riga,75,70)
'Substr(riga,145,3)
'Substr(riga,148,30)
'Substr(riga,178,6)
'Substr(riga,184,2)
'Substr(riga,186,35)
'Substr(riga,221,5)
'cMaxRow
]
I
obj='Var
obj_type='N
pag=28
prev=O3497
var_op='asgn
I
obj='Select
pag=28
sel_field='*
sel_name='xeneficfrz
sel_order='xeneficfrz->CPROWNUM
sel_where='xeneficfrz->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3497
fatherSonIndex=0
frm_calc='xeneficfrz->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O3463
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=28
prev=O3514
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O3515
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=28
prev=O3520
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3521
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='beneficope
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O3529
var_op='asgn
I
obj='Insert
pag=28
prev=O3528
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'Substr(riga,75,70)
'Substr(riga,145,3)
'Substr(riga,148,30)
'Substr(riga,178,6)
'Substr(riga,184,2)
'Substr(riga,186,35)
'Substr(riga,221,5)
'cMaxRow
]
I
obj='Var
obj_type='N
pag=28
prev=O3526
var_op='asgn
I
obj='Select
pag=28
sel_field='*
sel_name='beneficope
sel_order='beneficope->CPROWNUM
sel_where='beneficope->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3526
fatherSonIndex=0
frm_calc='beneficope->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3515
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='xeneficope
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O3546
var_op='asgn
I
obj='Insert
pag=28
prev=O3545
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'Substr(riga,75,70)
'Substr(riga,145,3)
'Substr(riga,148,30)
'Substr(riga,178,6)
'Substr(riga,184,2)
'Substr(riga,186,35)
'Substr(riga,221,5)
'cMaxRow
]
I
obj='Var
obj_type='N
pag=28
prev=O3543
var_op='asgn
I
obj='Select
pag=28
sel_field='*
sel_name='xeneficope
sel_order='xeneficope->CPROWNUM
sel_where='xeneficope->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3543
fatherSonIndex=0
frm_calc='xeneficope->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=28
prev=O3461
var_op='asgn
I
obj='Var
obj_type='N
pag=28
prev=O3460
var_op='asgn
I
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=28
prev=O3443
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=28
prev=O3442
var_op='asgn
I
obj='Var
obj_type='N
pag=28
prev=O3441
var_op='asgn
I
obj='Var
obj_type='N
pag=28
prev=O3440
var_op='asgn
I
obj='Remark
pag=28
x=21
y=20
I
Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + czipfile + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Inizio estrazione del file '+ czipfile
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/appo/"+czipfile
len=200
name='cpercorsozip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/appo/"
len=200
name='cdirectoryfile
next=Icpitembatch.CPExec
check='man
frm_calc="try {
      // Apro il file zip
      java.util.zip.ZipFile zf = new java.util.zip.ZipFile(cpercorsozip);

      //Conto il numero di file all interno del file zip e creo un array di stringhe per memorizzare i nomi file
      conteggio=zf.size();
      lista=new String[conteggio];
      
      // Enumerate each entry
      i=0;
      for (java.util.Enumeration entries = zf.entries(); entries.hasMoreElements();) {
          // Get the entry name
          lista[i] = ((java.util.zip.ZipEntry)entries.nextElement()).getName();
          i++;
      }
     zf.close();
     } catch (java.io.IOException e) {
     }
try {
      // Apro il file zip
      java.util.zip.ZipFile zf = new java.util.zip.ZipFile(cpercorsozip);

      byte[] buffer = new byte[1024]; 
      java.util.Enumeration entries = zf.entries();
      while(entries.hasMoreElements() ) {
        java.util.zip.ZipEntry entry = (java.util.zip.ZipEntry)entries.nextElement();
        java.io.InputStream in =zf.getInputStream(entry);
        java.io.OutputStream out = new java.io.BufferedOutputStream(new java.io.FileOutputStream(cdirectoryfile+entry.getName()));

        int len;

        while((len = in.read(buffer)) >= 0){
          out.write(buffer, 0, len);
        }

          in.close();
          out.close();
      }

      zf.close();
} catch (java.io.IOException ioe) {
      System.err.println("Unhandled exception:");
      ioe.printStackTrace();
      return;
}
°--°
next=Icpitembatch.CPDelete
arch='tmp_list_imprich
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='contanome
next=Icpitembatch.CPVarDecl
frm_calc='0
len=3
name='_priorita
next=Icpitembatch.CPWhile
frm_calc='contanome<conteggio
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+czipfile)
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine estrazione del file '+ czipfile
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +czipfile + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=27
prev=O3575
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=27
prev=O3574
var_op='asgn
I
obj='Exec
pag=27
prev=O3572
I
obj='While
pag=27
prev=O3571
sons=[
Icpitembatch.CPItemSon
comment='Assegnal apriorità ad ogni file e lo inserisce in tmp_list
instr=Icpitembatch.CPExec
check='man
father=O3572
fatherSonIndex=0
frm_calc='buffernomefile=lista[contanome];
next=Icpitembatch.CPCase
frm_calc=[
'At('archdip.txt',Lower(buffernomefile)) <> 0
'At('archpers.txt',Lower(buffernomefile)) <> 0
'At('archrap.txt',Lower(buffernomefile)) <> 0
'At('archinf.txt',Lower(buffernomefile)) <> 0
'At('archope.txt',Lower(buffernomefile)) <> 0
'At('archfraz.txt',Lower(buffernomefile)) <> 0
'At('opex.txt',Lower(buffernomefile)) <> 0
'At('archtito.txt',Lower(buffernomefile)) <> 0
'At('procdel.txt',Lower(buffernomefile)) <> 0
'At('sogope.txt',Lower(buffernomefile)) <> 0
'At('intest.txt',Lower(buffernomefile)) <> 0
'At('stopers.txt',Lower(buffernomefile)) <> 0
'At('persnew.txt',Lower(buffernomefile)) <> 0
'At('rapage.txt',Lower(buffernomefile)) <> 0
'At('infage.txt',Lower(buffernomefile)) <> 0
'At('intage.txt',Lower(buffernomefile)) <> 0
'At('opeage.txt',Lower(buffernomefile)) <> 0
'At('procage.txt',Lower(buffernomefile)) <> 0
'At('sogcli.txt',Lower(buffernomefile)) <> 0
'At('sogben.txt',Lower(buffernomefile)) <> 0
'At('sogaltro.txt',Lower(buffernomefile)) <> 0
'At('saldopex.txt',Lower(buffernomefile)) <> 0 or At('saldopex.xls',Lower(buffernomefile)) <> 0
'At('saldrapp.txt',Lower(buffernomefile)) <> 0 or At('saldrapp.xls',Lower(buffernomefile)) <> 0
'Lower(LRTrim(tmp_list_imprich->nomefile))='titosupp.txt'
]
h=[
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
]
next=Icpitembatch.CPInsert
arch='tmp_list_imprich
next=Icpitembatch.CPVarDecl
frm_calc='contanome+1
len=10
name='contanome
obj='Var
obj_type='N
pag=27
prev=O3583
var_op='asgn
I
obj='Insert
pag=27
prev=O3580
rd_kfield=[
'nomefile
'priorita
]
rd_kvar=[
'buffernomefile
'_priorita
]
I
obj='Case
pag=27
prev=O3579
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3580
fatherSonIndex=0
frm_calc='1
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3580
fatherSonIndex=1
frm_calc='2
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3580
fatherSonIndex=2
frm_calc='5
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3580
fatherSonIndex=3
frm_calc='6
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3580
fatherSonIndex=4
frm_calc='7
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3580
fatherSonIndex=5
frm_calc='8
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3580
fatherSonIndex=6
frm_calc='9
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3580
fatherSonIndex=7
frm_calc='10
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3580
fatherSonIndex=8
frm_calc='11
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3580
fatherSonIndex=9
frm_calc='12
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3580
fatherSonIndex=10
frm_calc='13
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3580
fatherSonIndex=11
frm_calc='3
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3580
fatherSonIndex=12
frm_calc='4
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3580
fatherSonIndex=13
frm_calc='14
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3580
fatherSonIndex=14
frm_calc='15
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3580
fatherSonIndex=15
frm_calc='16
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3580
fatherSonIndex=16
frm_calc='17
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3580
fatherSonIndex=17
frm_calc='18
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3580
fatherSonIndex=18
frm_calc='19
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3580
fatherSonIndex=19
frm_calc='20
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3580
fatherSonIndex=20
frm_calc='21
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3580
fatherSonIndex=21
frm_calc='22
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3580
fatherSonIndex=22
frm_calc='23
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3580
fatherSonIndex=23
frm_calc='24
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
]
w=[
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
]
I
obj='Exec
pag=27
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=27
prev=O3570
var_op='asgn
I
obj='Var
obj_type='N
pag=27
prev=O3569
var_op='asgn
I
obj='Delete
pag=27
prev=O3568
rd_kfield=[
'nomefile
]
rd_kop=[
'=
]
rd_kvar=[
'czipfile
]
I
obj='Exec
pag=27
prev=O3567
I
obj='Var
pag=27
prev=O3566
var_op='asgn
I
obj='Var
pag=27
prev=O3565
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=27
prev=O3564
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=27
prev=O3562
var_op='asgn
I
obj='Select
pag=27
sel_field='*
sel_name='tmp_list_imprich
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3562
fatherSonIndex=0
frm_calc='LRTrim(tmp_list_imprich->nomefile)
len=100
name='czipfile
obj='Var
pag=27
var_op='asgn
I
I
]
w=[
150
150
]
x=11
y=21
I
Icpitembatch.CPVarDecl
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
len=10
name='cNewProg
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumInv
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='cpwarn
next=Icpitembatch.CPWrite
arch='cpwarn
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Soggetti Inseriti: '+LRTrim(Str(cNumNew,10,0)) + ' - Soggetti Aggiornati: '+LRTrim(Str(cNumMod,10,0)) + ' - Soggetti Invariati: '+LRTrim(Str(cNumInv,10,0)) + ' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O3666
var_op='asgn
I
obj='Exec
pag=30
prev=O3665
I
obj='Exec
pag=30
prev=O3664
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O3663
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O3662
var_op='asgn
I
obj='Write
pag=30
prev=O3661
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'nProgSto + 1
]
I
obj='Write
pag=30
prev=O3659
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'nProgImp + 1
]
I
obj='While
pag=30
prev=O3658
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3659
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=30
prev=O3682
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3683
fatherSonIndex=0
frm_calc=[
'w_creamo='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datvarage
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' nominativi del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,112,16)
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,112,16)
len=16
name='xCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,496,16)
len=16
name='_conadd
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(_conadd)),cCli1,_conadd)
len=16
name='cCli1
next=Icpitembatch.CPRemark
frm_calc='Prima la Read si faceva per CF
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_oldest
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,288,1))),'G','P')
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,288,1)='M','1',iif(Substr(riga,288,1)='F','2',Substr(riga,288,1)))
len=1
name='xSesso
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,458,1)='0' or Substr(riga,458,1)='1' or Substr(riga,458,1) = ''
'Substr(riga,458,1)='N' or Substr(riga,458,1)='S'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,6)
len=6
name='xCodCab
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCodCab))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,136,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'(Substr(xCF,12,1) = 'Z' or Substr(riga,456,2)='EE') and (Substr(riga,288,1)='M' or Substr(riga,288,1)='F')
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xConnes)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=30
prev=O3718
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3721
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPOCLI\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='personbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=30
prev=O3727
var_op='asgn
I
obj='Insert
pag=30
prev=O3726
rd_kfield=[
'ALLINEATO
'ALLINEATONOMECNOME
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'CONNES
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROGIMPORT
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'TIPOPERS
'DATAVARAGE
]
rd_kvar=[
'0
'0
'LRTrim(Substr(riga,478,5))
'Substr(riga,468,10)
'Substr(riga,200,30)
'Substr(riga,265,9)
'xCFE
'xCodCab
'Substr(riga,112,16)
'Substr(riga,305,26)
'Substr(riga,463,5)
'cCli1
'CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Substr(riga,230,30)
'Substr(riga,356,100)
'Substr(riga,77,35)
'cCNAS
'cSNAS
'Substr(riga,331,25)
'Substr(riga,177,15)
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'iif(Empty(Substr(riga,495,1)),'N',Substr(riga,495,1))
'Substr(riga,459,4)
'nProgImp
'Substr(riga,260,2)
'Substr(riga,7,70)
'Substr(riga,7,70)
'Substr(riga,169,3)
'Val(Substr(riga,492,3))
'Val(Substr(riga,489,3))
'Val(Substr(riga,486,3))
'Val(Substr(riga,483,3))
'xSesso
'Substr(riga,172,3)
'Substr(riga,166,3)
'Substr(riga,456,2)
'Substr(riga,175,2)
'_tipper
'_datvarage
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3727
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+LRTrim(Substr(riga,7,70))+" con codice fiscale: "+LRTrim(Substr(riga,112,16))+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=30
prev=O3737
I
obj='Exec
pag=30
prev=O3736
I
obj='Var
obj_type='N
pag=30
prev=O3735
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O3734
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3721
fatherSonIndex=1
frm_calc='Upper(xCF)+Substr(riga,7,70)+Substr(riga,77,35)+Substr(riga,230,30)+Substr(riga,260,2)+LibreriaMit.SpacePad(LRTrim(Substr(riga,265,9)),5)+Substr(riga,262,3)+Substr(riga,166,3)+Substr(riga,169,3)+Substr(riga,172,3)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+LibreriaMit.SpacePad(Left(cCNAS,30),30)+Substr(riga,456,2)+LibreriaMit.SpacePad(Left(cSNAS,30),30)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+Substr(riga,175,2)+Substr(riga,177,15)+Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2)+Substr(riga,200,30)+Substr(riga,274,14)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='Upper(xCF)+Substr(riga,7,70)+Substr(riga,230,30)+Substr(riga,260,2)
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='xRiga3+LibreriaMit.SpacePad(Left(cCNAS,30),30)+Substr(riga,456,2)+LibreriaMit.SpacePad(Left(cSNAS,30),30)
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='xRiga3+CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))+xSesso
len=10
name='xRiga3
next=Icpitembatch.CPRemark
frm_calc='Crea la riga di confronto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico se il soggetto è una persona fisica
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Substr(riga,516,4)+Substr(riga,514,2)+Substr(riga,512,2))
len=8
name='_datvarage
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,288,1)='M' or Substr(riga,288,1)='F'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=30
prev=O3752
sons=[
Icpitembatch.CPItemSon
comment='se persona fisica
instr=Icpitembatch.CPWrite
arch='personbo
father=O3753
fatherSonIndex=0
frm_calc='Errore in aggiornamento PERSNEW
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=30
prev=O3758
var_op='asgn
I
obj='Write
pag=30
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'xConnes
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3758
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
frm_calc='m_cLastMsgError = ""
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=30
prev=O3768
I
obj='Exec
pag=30
prev=O3767
I
obj='Var
obj_type='N
pag=30
prev=O3766
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'DATAVARAGE
'PEP
'AREAGEO
'RAREA
'RATTIV
'RCOMP
'RNATGIU
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,468,10)
'Substr(riga,200,30)
'Substr(riga,265,9)
'xCFE
'xCodCab
'Substr(riga,112,16)
'Substr(riga,305,26)
'Substr(riga,463,5)
'CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Substr(riga,230,30)
'Substr(riga,356,100)
'Substr(riga,77,35)
'cCNAS
'cSNAS
'Substr(riga,331,25)
'Substr(riga,177,15)
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'Substr(riga,459,4)
'Substr(riga,260,2)
'Substr(riga,7,70)
'Substr(riga,7,70)
'Substr(riga,169,3)
'xSesso
'Substr(riga,172,3)
'Substr(riga,166,3)
'Substr(riga,456,2)
'Substr(riga,175,2)
'_datvarage
'iif(Empty(Substr(riga,495,1)),'N',Substr(riga,495,1))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,478,5)),3))
'Val(Substr(riga,492,3))
'Val(Substr(riga,489,3))
'Val(Substr(riga,486,3))
'Val(Substr(riga,483,3))
]
I
I
Icpitembatch.CPItemSon
comment='se persona giuridica
instr=Icpitembatch.CPRemark
father=O3753
fatherSonIndex=1
frm_calc='Se non è persona fisica
next=Icpitembatch.CPWrite
arch='personbo
frm_calc='Errore in aggiornamento PERSNEW
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=30
prev=O3776
var_op='asgn
I
obj='Write
pag=30
prev=O3775
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'xConnes
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3776
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=30
prev=O3785
I
obj='Var
obj_type='N
pag=30
prev=O3784
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'DATAVARAGE
'PEP
'AREAGEO
'RAREA
'RATTIV
'RCOMP
'RNATGIU
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,468,10)
'Substr(riga,200,30)
'Substr(riga,265,9)
'xCFE
'xCodCab
'Substr(riga,112,16)
'Substr(riga,305,26)
'Substr(riga,463,5)
'CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Substr(riga,230,30)
'Substr(riga,356,100)
'Substr(riga,77,35)
'cCNAS
'cSNAS
'Substr(riga,331,25)
'Substr(riga,177,15)
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'Substr(riga,459,4)
'Substr(riga,260,2)
'Substr(riga,7,70)
'Substr(riga,7,70)
'Substr(riga,169,3)
'xSesso
'Substr(riga,172,3)
'Substr(riga,166,3)
'Substr(riga,456,2)
'Substr(riga,175,2)
'_datvarage
'iif(Empty(Substr(riga,495,1)),'N',Substr(riga,495,1))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,478,5)),3))
'Val(Substr(riga,492,3))
'Val(Substr(riga,489,3))
'Val(Substr(riga,486,3))
'Val(Substr(riga,483,3))
]
I
obj='Remark
pag=30
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='D
pag=30
prev=O3751
var_op='asgn
I
obj='Remark
pag=30
prev=O3749
I
obj='Select
pag=30
prev=O3748
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3749
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad(personbo->CODFISC,16)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->RAGSOC,70)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->DOMICILIO,35)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->DESCCIT,30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->PROVINCIA,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(LRTrim(personbo->CAP),5)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->PAESE,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->SOTGRUP,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->RAMOGRUP,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->SETTSINT,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(Left(personbo->NASCOMUN,30),30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->TIPINTER,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(Left(personbo->NASSTATO,30),30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + iif(DateToChar(personbo->DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATANASC),8),Space(8))
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->TIPODOC,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->NUMDOCUM,15)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + iif(DateToChar(personbo->DATARILASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATARILASC),8),Space(8))
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->AUTRILASC,30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->PARTIVA,14)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.SpacePad(personbo->CODFISC,16)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->RAGSOC,70)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->DESCCIT,30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->PROVINCIA,2)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(Left(personbo->NASCOMUN,30),30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->TIPINTER,2)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(Left(personbo->NASSTATO,30),30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + iif(DateToChar(personbo->DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATANASC),8),Space(8))
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->SESSO,1)
len=10
name='xRiga4
next=Icpitembatch.CPRemark
frm_calc='Se le due stringhe sono diverse, ci sono delle modifiche da fare. Quindi storicizzo in wersonbo le modifche.
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(xRiga1) <> LRTrim(xRiga2)
]
h=[
19
19
]
obj='If
pag=30
prev=O3822
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O3823
fatherSonIndex=0
frm_calc='Verifico se c'è già una variazione
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Substr(riga,301,4)+Substr(riga,299,2)+Substr(riga,297,2))
len=8
name='_datarett
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
obj='If
pag=30
prev=O3831
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O3833
fatherSonIndex=0
frm_calc='Calcola il progressivo di registrazione
next=Icpitembatch.CPVarDecl
frm_calc='nProgSto + 1
len=10
name='nProgSto
next=Icpitembatch.CPVarDecl
frm_calc='Right('000000000000000'+LRTrim(Str(nProgSto,15,0)),15)
len=15
name='cProgSto
next=Icpitembatch.CPInsert
arch='wersonbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_flgmodi='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_creamo='S'
]
h=[
19
19
]
obj='If
pag=30
prev=O3843
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3846
fatherSonIndex=0
frm_calc=[
'LRTrim(xRiga3) <> LRTrim(xRiga4)
]
h=[
19
19
]
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3851
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=30
prev=O3856
sel_field='fraziobo->IDBASE
sel_name='fraziobo
sel_where='fraziobo->CONNESCLI=xConnes or fraziobo->CONNESOPER=xConnes or fraziobo->CONNESBEN=xConnes
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3858
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(gAzienda)+"'",Space(10),10)
len=10
name='cNewProg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc=''JLMNOTUV?'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='fraziobo->IDBASE
len=10
name='_idbase
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=30
prev=O3865
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_idbase
]
wr_field=[
'OPERAZMOD
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
'=
]
wr_var=[
'_idreg
''1'
'Date()
]
I
obj='Select
pag=30
prev=O3864
sel_field='*
sel_name='fraziobo
sel_where='fraziobo->IDBASE=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3865
fatherSonIndex=0
frm_calc='iif(Empty(fraziobo->FLAGRAP2),Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(fraziobo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(fraziobo->DATAOPE)+fraziobo->NUMPROG+_flagrap2
len=20
name='_idreg
next=Icpitembatch.CPInsert
arch='fraziobo
obj='Insert
pag=30
prev=O3877
rd_kfield=[
'AREAGEO
'AUTOM
'CAMBIO
'CDATAOPE
'CDATOPE
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'MODSVOL
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
'CONNALTRO
'CONNESDOC
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'DATAIMP
'C_RAPPORTO
'PAGASOGOP
'MTCN
'IDFILE
'CDATREG
'IPCOLLEG
'ORACOLLEG
'DUCOLLEG
'ANNOOPE
]
rd_kvar=[
'fraziobo->AREAGEO
'fraziobo->AUTOM
'fraziobo->CAMBIO
'fraziobo->CDATAOPE
'fraziobo->CDATOPE
'fraziobo->CODANA
'fraziobo->CODCAB
'fraziobo->CODCAB2
'fraziobo->CODDIPE
'fraziobo->CODINT2
'fraziobo->CODINTER
'fraziobo->CODVOC
'fraziobo->COLLEG
'fraziobo->CONNESBEN
'fraziobo->CONNESCLI
'fraziobo->CONNESOPER
'fraziobo->DATAOPE
'fraziobo->DATAREG
'Date()
'fraziobo->DESC2
'fraziobo->DESCCIT
'fraziobo->DESCINTER
'fraziobo->DOCFILE
'fraziobo->FLAGCONT
'fraziobo->FLAGFRAZ
'fraziobo->FLAGLIRE
'fraziobo->FLAGRAP
'_flagrap2
'cNewProg
'fraziobo->idcauana
'_idreg
'fraziobo->INFORM
'fraziobo->MODSVOL
'fraziobo->NATURA
'fraziobo->NOPROT
'fraziobo->NUMPROG
'fraziobo->OPERAG
'fraziobo->OPERATORE
'fraziobo->OPERAZMOD
'fraziobo->OPRAP
'fraziobo->PAESE
'fraziobo->PRGIMPFRZ
'fraziobo->PROV2
'fraziobo->PROVINCIA
'fraziobo->RAGIO
'fraziobo->RAPPORTBEN
'fraziobo->RAPPORTO
'fraziobo->RAREA
'fraziobo->RCOMP
'fraziobo->RESPINS
'fraziobo->RFREQ
'fraziobo->RIFIMP
'fraziobo->RIMP
'fraziobo->RRAGIO
'fraziobo->RTIPO
'fraziobo->SCOPO
'fraziobo->SEGNO
''3'
'fraziobo->TIPO
'fraziobo->TIPOINF
'fraziobo->TIPOINT2
'fraziobo->TIPOINTER
'fraziobo->TIPOLEG
'fraziobo->TIPOOPRAP
'fraziobo->TOTCONT
'fraziobo->TOTLIRE
'fraziobo->UCODE
'fraziobo->UNIQUECODE
'fraziobo->VALUTA
'fraziobo->ZCPARTE
'fraziobo->CONNALTRO
'fraziobo->CONNESDOC
'fraziobo->C_RAG
'fraziobo->C_STA
'fraziobo->C_CTA
'fraziobo->C_CAB
'fraziobo->C_PRV
'fraziobo->C_IND
'fraziobo->C_CAP
'fraziobo->DATAIMP
'fraziobo->C_RAPPORTO
'fraziobo->PAGASOGOP
'fraziobo->MTCN
'fraziobo->IDFILE
'fraziobo->CDATREG
'fraziobo->IPCOLLEG
'fraziobo->ORACOLLEG
'fraziobo->DUCOLLEG
'fraziobo->ANNOOPE
]
I
obj='Var
pag=30
prev=O3876
var_op='asgn
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=30
prev=O3863
var_op='asgn
I
obj='Var
pag=30
prev=O3862
var_op='asgn
I
obj='Var
pag=30
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=30
sel_field='operazbo->IDBASE
sel_name='operazbo
sel_where='operazbo->CONNESCLI=xConnes or operazbo->CONNESOPER=xConnes or operazbo->CONNESBEN=xConnes
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3856
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",Space(10),10)
len=10
name='cNewProg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='fraziobo->IDBASE
len=10
name='_idbase
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=30
prev=O3888
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'operazbo->IDBASE
]
wr_field=[
'OPERAZMOD
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
'=
]
wr_var=[
'_idreg
''1'
'Date()
]
I
obj='Select
pag=30
prev=O3887
sel_field='*
sel_name='operazbo
sel_where='operazbo->IDBASE=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3888
fatherSonIndex=0
frm_calc='iif(Empty(operazbo->FLAGRAP2),Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(operazbo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(operazbo->DATAOPE)+operazbo->NUMPROG+_flagrap2
len=20
name='_idreg
next=Icpitembatch.CPInsert
arch='operazbo
obj='Insert
pag=30
prev=O3900
rd_kfield=[
'AMMONT
'AREAGEO
'AUTOM
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESDOC
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'IDFILE
'INFORM
'IPCOLLEG
'MODSVOL
'MTCN
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
]
rd_kvar=[
'operazbo->AMMONT
'operazbo->AREAGEO
'operazbo->AUTOM
'operazbo->C_CAB
'operazbo->C_CAP
'operazbo->C_CTA
'operazbo->C_IND
'operazbo->C_PRV
'operazbo->C_RAG
'operazbo->C_RAPPORTO
'operazbo->C_STA
'operazbo->CAMBIO
'operazbo->CDATAOPE
'operazbo->CDATOPE
'operazbo->CDATREG
'operazbo->CODANA
'operazbo->CODCAB
'operazbo->CODCAB2
'operazbo->CODDIPE
'operazbo->CODINT2
'operazbo->CODINTER
'operazbo->CODVOC
'operazbo->COLLEG
'operazbo->CONNALTRO
'operazbo->CONNESBEN
'operazbo->CONNESCLI
'operazbo->CONNESDOC
'operazbo->CONNESOPER
'operazbo->DATAIMP
'operazbo->DATAOPE
'operazbo->DATAREG
'Date()
'operazbo->DESC2
'operazbo->DESCCIT
'operazbo->DESCINTER
'operazbo->DOCFILE
'operazbo->DUCOLLEG
'operazbo->DURAT
'operazbo->FLAGCONT
'operazbo->FLAGFRAZ
'operazbo->FLAGLIRE
'operazbo->FLAGRAP
'_flagrap2
'cNewProg
'operazbo->idcauana
'_idreg
'operazbo->IDFILE
'operazbo->INFORM
'operazbo->IPCOLLEG
'operazbo->MODSVOL
'operazbo->MTCN
'operazbo->NATURA
'operazbo->NOPROT
'operazbo->NUMPROG
'operazbo->OPERAG
'operazbo->OPERATORE
'operazbo->OPERAZMOD
'operazbo->OPRAP
'operazbo->ORACOLLEG
'operazbo->PAESE
'operazbo->PAGASOGOP
'operazbo->PRGIMPOPE
'operazbo->PROV2
'operazbo->PROVINCIA
'operazbo->RAGIO
'operazbo->RAPPORTBEN
'operazbo->RAPPORTO
'operazbo->RAREA
'operazbo->RCOMP
'operazbo->RESPINS
'operazbo->RFREQ
'operazbo->RIFIMP
'operazbo->RIMP
'operazbo->RRAGIO
'operazbo->RTIPO
'operazbo->SCOPO
'operazbo->SEGNO
''3'
'operazbo->TIPO
'operazbo->TIPOINF
'operazbo->TIPOINT2
'operazbo->TIPOINTER
'operazbo->TIPOLEG
'operazbo->TIPOOPRAP
'operazbo->TOTCONT
'operazbo->TOTLIRE
'operazbo->UCODE
'operazbo->UNIQUECODE
'operazbo->VALUTA
'operazbo->ZCPARTE
]
I
obj='Var
pag=30
prev=O3899
var_op='asgn
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=30
prev=O3886
var_op='asgn
I
obj='Var
pag=30
prev=O3885
var_op='asgn
I
obj='Var
pag=30
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=30
prev=O3841
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3843
fatherSonIndex=0
frm_calc=[
'LRTrim(xRiga3) <> LRTrim(xRiga4)
]
h=[
19
19
]
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3910
fatherSonIndex=0
frm_calc='xCFE
len=1
name='_newest
next=Icpitembatch.CPExec
check='page
frm_calc='31
obj='Exec
pag=30
prev=O3915
I
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=30
prev=O3840
rd_kfield=[
'ALLINEATO
'ALLINEATONOMECNOME
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODDIPE
'CODFISC
'CODINTER
'COGNOME
'COMPORT
'CONNES
'datamodi
'DATANASC
'DATARILASC
'DATASEGN
'DATAVALI
'DATEXTRA
'DESCCIT
'DOCFILE
'DOMICILIO
'idcitta
'IDFILE
'MACROAGENTE
'NASCOMUN
'NASSTATO
'NOME
'NOTE
'NUMDOCUM
'OLDCODFISC
'OLDCONNES
'OLDSETSIN
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROGIMP_C
'PROGIMPORT
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'sanumpro
'SESSO
'SETTSINT
'SOSPMAF
'SOTGRUP
'SPOTID
'TIPINTER
'TIPODOC
'TIPOPERS
]
rd_kvar=[
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->AREAGEO
'personbo->ATTIV
'personbo->AUTRILASC
'personbo->CAP
'personbo->CFESTERO
'personbo->CODCAB
'personbo->CODDIPE
'personbo->CODFISC
'personbo->CODINTER
'personbo->COGNOME
'personbo->COMPORT
'xConnes
'CharToDate(Substr(riga,301,4)+Substr(riga,299,2)+Substr(riga,297,2))
'personbo->DATANASC
'personbo->DATARILASC
'personbo->DATASEGN
'personbo->DATAVALI
'personbo->DATEXTRA
'personbo->DESCCIT
'personbo->DOCFILE
'personbo->DOMICILIO
'personbo->idcitta
'personbo->IDFILE
'personbo->MACROAGENTE
'personbo->NASCOMUN
'personbo->NASSTATO
'personbo->NOME
'personbo->NOTE
'personbo->NUMDOCUM
'personbo->OLDCODFISC
'personbo->OLDCONNES
'personbo->OLDSETSIN
'personbo->PAESE
'personbo->PARTIVA
'personbo->PEP
'personbo->PKTBSPECIE
'personbo->PROGIMP_C
'personbo->PROGIMPORT
'personbo->PROVINCIA
'personbo->RAGSOC
'personbo->RAGSOCOLD
'personbo->RAMOGRUP
'personbo->RAREA
'personbo->RATTIV
'personbo->RCOMP
'personbo->RNATGIU
'cProgSto
'personbo->SESSO
'personbo->SETTSINT
'personbo->SOSPMAF
'personbo->SOTGRUP
'personbo->SPOTID
'personbo->TIPINTER
'personbo->TIPODOC
'personbo->TIPOPERS
]
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3841
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
frm_calc='m_cLastMsgError = ""
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=30
prev=O3925
I
obj='Exec
pag=30
prev=O3924
I
obj='Var
obj_type='N
pag=30
prev=O3923
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=30
pagelocal=True
prev=O3839
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O3838
var_op='asgn
I
obj='Remark
pag=30
I
I
]
w=[
150
150
]
I
obj='Select
pag=30
prev=O3830
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=xConnes and wersonbo->datamodi=_datarett
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3831
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='D
pag=30
prev=O3829
var_op='asgn
I
obj='Var
pag=30
prev=O3828
var_op='asgn
I
obj='Remark
pag=30
I
I
]
w=[
150
150
]
I
obj='Remark
pag=30
prev=O3821
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3820
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3819
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3818
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3817
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3816
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3815
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3814
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3813
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3812
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3811
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3810
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3809
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3808
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3807
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3806
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3805
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3804
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3803
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3802
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3801
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3800
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3799
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3798
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3797
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3796
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3795
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3794
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=30
prev=O3747
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3746
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3745
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3744
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3743
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3742
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3741
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=30
prev=O3717
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3718
fatherSonIndex=0
frm_calc='Substr(riga,136,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=30
prev=O3938
var_op='asgn
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=30
prev=O3716
var_op='asgn
I
obj='Var
pag=30
prev=O3713
var_op='asgn
I
obj='If
pag=30
prev=O3712
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3713
fatherSonIndex=0
frm_calc='Substr(riga,230,30)
len=30
name='xCitta
next=Icpitembatch.CPRead
arch='tbcitta
obj='Read
pag=30
prev=O3943
rd_field=[
'CAB
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'xCitta
]
rd_var=[
'xCodCab
]
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=30
prev=O3709
var_op='asgn
I
obj='If
pag=30
prev=O3708
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3709
fatherSonIndex=0
frm_calc='iif(LRTrim(Substr(riga,458,1))='1',1,0)
len=1
name='xCFE
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3709
fatherSonIndex=1
frm_calc='iif(LRTrim(Substr(riga,458,1))='S',1,0)
len=1
name='xCFE
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=30
prev=O3707
var_op='asgn
I
obj='Var
pag=30
prev=O3706
var_op='asgn
I
obj='Read
pag=30
prev=O3705
rd_field=[
'CONNES
'CFESTERO
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'cCli1
]
rd_var=[
'xConnes
'_oldest
]
I
obj='Var
obj_type='N
pag=30
prev=O3704
var_op='asgn
I
obj='Remark
pag=30
prev=O3703
I
obj='Var
pag=30
prev=O3702
var_op='asgn
I
obj='Var
pag=30
prev=O3701
var_op='asgn
I
obj='Var
pag=30
prev=O3700
var_op='asgn
I
obj='Var
pag=30
prev=O3699
var_op='asgn
I
obj='Var
pag=30
prev=O3698
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O3697
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O3696
var_op='asgn
I
obj='Var
pag=30
prev=O3695
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3694
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3693
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3692
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3691
var_op='asgn
I
obj='Var
obj_type='D
pag=30
prev=O3688
var_op='asgn
I
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3688
fatherSonIndex=0
frm_calc='Substr(riga,112,16)
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,496,16)
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xConnes)
]
h=[
19
19
]
obj='If
pag=30
prev=O3964
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='personbo
father=O3965
fatherSonIndex=0
obj='Insert
pag=30
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=30
prev=O3963
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'_conadd
]
rd_var=[
'xConnes
]
I
obj='Var
pag=30
prev=O3962
var_op='asgn
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=30
prev=O3657
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
rd_var=[
'nProgSto
]
I
obj='Read
pag=30
prev=O3656
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
rd_var=[
'nProgImp
]
I
obj='Var
pag=30
prev=O3655
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O3654
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O3653
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O3652
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O3651
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O3650
var_op='asgn
I
obj='Var
pag=30
pagelocal=True
prev=O3649
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3648
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3647
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3646
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O3645
I
obj='Var
pag=30
pagelocal=True
x=9
y=5
I
Icpitembatch.CPBeginEnd
comment='Definizione variabili locali
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Aggiorna le righe
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=31
prev=O3991
sel_field='*
sel_name='aeoprig
sel_where='aeoprig->CONNESINT=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3992
fatherSonIndex=0
frm_calc=[
'Year(aeoprig->ADATA) = w_annorif or w_annorif=0
]
h=[
19
19
]
obj='If
pag=31
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3996
fatherSonIndex=0
frm_calc=[
'_oldest = _newest
]
h=[
19
19
19
]
haselse=True
obj='If
pag=31
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4001
fatherSonIndex=0
frm_calc=[
'not(Empty(aeoprig->APROG))
]
h=[
19
19
]
obj='If
pag=31
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4006
fatherSonIndex=0
frm_calc='''
len=10
name='_opep
next=Icpitembatch.CPRead
arch='aeopcanc
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_opep))
]
h=[
19
19
]
obj='If
pag=31
prev=O4012
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4013
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOAGE\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProg
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='cIDBase
next=Icpitembatch.CPInsert
arch='aeopstor
next=Icpitembatch.CPWrite
arch='aeoprig
obj='Write
pag=31
prev=O4020
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'aeoprig->IDBASE
]
wr_field=[
'AOLDPROG
'AOLDFILE
'ADATARET
'RSPEDITO
'COLDPROG
'COLDFILE
]
wr_op=[
'=
'=
'=
'=
'=
'=
]
wr_var=[
'aeoprig->APROG
'aeoprig->AFILE
'Date()
'0
'''
'''
]
I
obj='Insert
pag=31
prev=O4019
rd_kfield=[
'PROGRES
'IDBASE
'RAPPORTO
'CONNESINT
'ASPEDITO
'ADATA
'APROG
'AOLDPROG
'AFILE
'AOLDFILE
'ADATARET
'CSPEDITO
'CDATA
'CPROG
'COLDPROG
'CFILE
'COLDFILE
'CDATARET
'IDRIF
'NOCODFISC
'ADTPRE
'CDTPRE
'TIPOAG
'COINT
'PROGOPX
'ABBINATO
'IDESITO
'DATESITO
'RSPEDITO
'SALDO
'QUANTITA
'VALUTA
'ANNO
'PROG1
'PROG2
'ESITOANNO
'UNIQUECODE
'PROGREC
'PROGBASE
'FILEANNO
'ABBSALDI
'OLDINTER
'ANNOOPE
]
rd_kvar=[
'cProg
'aeoprig->IDBASE
'aeoprig->RAPPORTO
'aeoprig->CONNESINT
'aeoprig->ASPEDITO
'aeoprig->ADATA
'aeoprig->APROG
'aeoprig->AOLDPROG
'aeoprig->AFILE
'aeoprig->AOLDFILE
'aeoprig->ADATARET
'aeoprig->CSPEDITO
'aeoprig->CDATA
'aeoprig->CPROG
'aeoprig->COLDPROG
'aeoprig->CFILE
'aeoprig->COLDFILE
'aeoprig->CDATARET
'aeoprig->IDRIF
'aeoprig->NOCODFISC
'aeoprig->ADTPRE
'aeoprig->CDTPRE
'aeoprig->TIPOAG
'aeoprig->COINT
'aeoprig->PROGOPX
'aeoprig->ABBINATO
'aeoprig->IDESITO
'aeoprig->DATESITO
'aeoprig->RSPEDITO
'aeoprig->SALDO
'aeoprig->QUANTITA
'aeoprig->VALUTA
'aeoprig->ANNO
'aeoprig->PROG1
'aeoprig->PROG2
'aeoprig->ESITOANNO
'aeoprig->UNIQUECODE
'aeoprig->PROGREC
'aeoprig->PROGBASE
'aeoprig->FILEANNO
'aeoprig->ABBSALDI
'aeoprig->OLDINTER
'aeoprig->ANNOOPE
]
I
obj='Var
pag=31
pagelocal=True
prev=O4018
var_op='asgn
I
obj='Var
pag=31
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=31
prev=O4011
rd_field=[
'PROGRES
]
rd_kfield=[
'IDBASE
]
rd_kvar=[
'aeoprig->IDBASE
]
rd_var=[
'_opep
]
I
obj='Var
pag=31
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4001
fatherSonIndex=1
frm_calc=[
'aeoprig->ASPEDITO=0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=31
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aeoprig
father=O4037
fatherSonIndex=0
obj='Write
pag=31
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'aeoprig->IDBASE
]
wr_field=[
'NOCODFISC
]
wr_op=[
'=
]
wr_var=[
'iif(_newest=1,'S','N')
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4037
fatherSonIndex=1
frm_calc='''
len=10
name='_opep
next=Icpitembatch.CPRead
arch='aeopcanc
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_opep)
]
h=[
19
19
]
obj='If
pag=31
prev=O4051
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4052
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOAGE\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProg
next=Icpitembatch.CPInsert
arch='aeopstor
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PDELAGE\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cCanc
next=Icpitembatch.CPInsert
arch='aeopcanc
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGAEOPEXTR\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='_prog
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGAED\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aeoprig
next=Icpitembatch.CPWrite
arch='opextrbo
obj='Write
pag=31
prev=O4063
rd_kfield=[
'COLLEG
'DATAOPE
]
rd_kop=[
'=
'=
]
rd_kvar=[
'aeoprig->CONNESINT
'aeoprig->ADATA
]
wr_field=[
'NUMPROG1
]
wr_op=[
'=
]
wr_var=[
'_prog
]
I
obj='Insert
pag=31
prev=O4062
rd_kfield=[
'IDBASE
'CONNESINT
'ADATA
'TIPOAG
'COINT
'PROGOPX
'NOCODFISC
'ANNOOPE
]
rd_kvar=[
'_prog
'aeoprig->CONNESINT
'aeoprig->ADATA
'aeoprig->TIPOAG
'aeoprig->COINT
'nProgImp
'iif(_newest=1,'S','N')
'Year(aeoprig->ADATA)
]
I
obj='Var
obj_type='N
pag=31
prev=O4061
var_op='asgn
I
obj='Var
pag=31
pagelocal=True
prev=O4060
var_op='asgn
I
obj='Insert
pag=31
prev=O4059
rd_kfield=[
'ADATA
'ADATARET
'AFILE
'APROG
'ASPEDITO
'CDATA
'CDATARET
'CFILE
'COLDPROG
'COINT
'COLDFILE
'CONNESINT
'CPROG
'CSPEDITO
'DATARIF
'IDBASE
'IDRIF
'NOCODFISC
'PROGRES
'RAPPORTO
'RIFSTOR
'TIPOAG
'TIPOCAN
]
rd_kvar=[
'aeoprig->ADATA
'Date()
'aeoprig->AFILE
'aeoprig->APROG
'aeoprig->ASPEDITO
'aeoprig->CDATA
'aeoprig->CDATARET
'aeoprig->CFILE
'aeoprig->COLDPROG
'aeoprig->COINT
'aeoprig->COLDFILE
'aeoprig->CONNESINT
'aeoprig->CPROG
'aeoprig->CSPEDITO
'Date()
'aeoprig->IDBASE
'aeoprig->IDRIF
'aeoprig->NOCODFISC
'cCanc
'aeoprig->RAPPORTO
'cProg
'aeoprig->TIPOAG
''C'
]
I
obj='Var
pag=31
pagelocal=True
prev=O4058
var_op='asgn
I
obj='Insert
pag=31
prev=O4057
rd_kfield=[
'PROGRES
'IDBASE
'RAPPORTO
'CONNESINT
'ASPEDITO
'ADATA
'APROG
'AOLDPROG
'AFILE
'AOLDFILE
'ADATARET
'CSPEDITO
'CDATA
'CPROG
'COLDPROG
'CFILE
'COLDFILE
'CDATARET
'IDRIF
'NOCODFISC
'ADTPRE
'CDTPRE
'TIPOAG
'COINT
'PROGOPX
'ABBINATO
'IDESITO
'DATESITO
'RSPEDITO
'SALDO
'QUANTITA
'VALUTA
'ANNO
'PROG1
'PROG2
'ESITOANNO
'UNIQUECODE
'PROGREC
'PROGBASE
'FILEANNO
'ABBSALDI
'OLDINTER
'ANNOOPE
]
rd_kvar=[
'cProg
'aeoprig->IDBASE
'aeoprig->RAPPORTO
'aeoprig->CONNESINT
'aeoprig->ASPEDITO
'aeoprig->ADATA
'aeoprig->APROG
'aeoprig->AOLDPROG
'aeoprig->AFILE
'aeoprig->AOLDFILE
'aeoprig->ADATARET
'aeoprig->CSPEDITO
'aeoprig->CDATA
'aeoprig->CPROG
'aeoprig->COLDPROG
'aeoprig->CFILE
'aeoprig->COLDFILE
'aeoprig->CDATARET
'aeoprig->IDRIF
'aeoprig->NOCODFISC
'aeoprig->ADTPRE
'aeoprig->CDTPRE
'aeoprig->TIPOAG
'aeoprig->COINT
'aeoprig->PROGOPX
'aeoprig->ABBINATO
'aeoprig->IDESITO
'aeoprig->DATESITO
'aeoprig->RSPEDITO
'aeoprig->SALDO
'aeoprig->QUANTITA
'aeoprig->VALUTA
'aeoprig->ANNO
'aeoprig->PROG1
'aeoprig->PROG2
'aeoprig->ESITOANNO
'aeoprig->UNIQUECODE
'aeoprig->PROGREC
'aeoprig->PROGBASE
'aeoprig->FILEANNO
'aeoprig->ABBSALDI
'aeoprig->OLDINTER
'aeoprig->ANNOOPE
]
I
obj='Var
pag=31
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=31
prev=O4050
rd_field=[
'PROGRES
]
rd_kfield=[
'AFILE
'APROG
]
rd_kvar=[
'aeoprig->AFILE
'aeoprig->APROG
]
rd_var=[
'_opep
]
I
obj='Var
pag=31
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=31
prev=O3989
I
obj='Begin
pag=31
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3989
fatherSonIndex=0
len=10
name='cProg
next=Icpitembatch.CPVarDecl
len=10
name='cIDBase
next=Icpitembatch.CPVarDecl
len=10
name='_opep
next=Icpitembatch.CPVarDecl
len=10
name='cCanc
next=Icpitembatch.CPVarDecl
len=10
name='_prog
obj='Var
pag=31
pagelocal=True
prev=O4091
I
obj='Var
pag=31
pagelocal=True
prev=O4090
I
obj='Var
pag=31
pagelocal=True
prev=O4089
I
obj='Var
pag=31
pagelocal=True
prev=O4088
I
obj='Var
pag=31
pagelocal=True
I
I
]
w=[
150
150
]
x=13
y=22
I
Icpitembatch.CPBeginEnd
comment='Definizine variabili locali
h=[
19
19
]
next=Icpitembatch.CPDropTemporaryTable
next=Icpitembatch.CPServerTemporaryTable
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=32
prev=O4097
sel_field='*
sel_name='tmp_list_imprich
sel_order='tmp_list_imprich->priorita,tmp_list_imprich->nomefile
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4098
fatherSonIndex=0
frm_calc='LRTrim(tmp_list_imprich->nomefile)
len=50
name='nomefileimport
next=Icpitembatch.CPIfElse
frm_calc=[
'At('archpers.txt',Lower(nomefileimport)) <> 0 or At('persnew.txt',Lower(nomefileimport)) <> 0 or At('stopers.txt',Lower(nomefileimport)) <> 0
]
h=[
19
19
]
obj='If
pag=32
prev=O4102
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4103
fatherSonIndex=0
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
obj='Exec
pag=32
prev=O4110
I
obj='While
pag=32
prev=O4109
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4110
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=32
prev=O4116
var_op='asgn
I
obj='If
pag=32
prev=O4115
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4116
fatherSonIndex=0
frm_calc='''
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='''
len=128
name='_testata
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_ferr
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati controllati '+LRTrim(Str(conta,10,0))+' nominativi del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='"Codice: "+ LRTrim(Substr(riga,112,16)) + " - Soggetto "+LRTrim(Upper(Substr(riga,7,70)))
len=128
name='_testata
next=Icpitembatch.CPBeginEnd
comment='Effettua Controlli
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_ferr = 1
]
h=[
19
19
]
obj='If
pag=32
prev=O4127
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4129
fatherSonIndex=0
frm_calc='1
len=1
name='_chkerr
next=Icpitembatch.CPInsert
arch='tmp_errimp
obj='Insert
pag=32
prev=O4134
rd_kfield=[
'nomearch
'numriga
'errore
'txtini
]
rd_kvar=[
'LRTrim(nomefileimport)
'conta
'_listaerr
'_testata
]
I
obj='Var
obj_type='N
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=32
prev=O4126
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4127
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Upper(Substr(riga,7,70))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,112,16)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,262,3)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(Substr(riga,262,3)) = '086' or Empty(LRTrim(Substr(riga,262,3)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,166,3)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,172,3)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'At("archpers.txt",Lower(nomefileimport)) <> 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,169,3))) and not(Empty(LRTrim(Substr(riga,166,3))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,288,1)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=32
prev=O4162
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4165
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Substr(riga,136,30)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,128,8)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,175,2)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,177,15)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,192,8)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,200,30)))
]
h=[
19
19
]
obj='If
pag=32
prev=O4182
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4185
fatherSonIndex=0
frm_calc='_listaerr + "non è presente l'autorità di rilascio del documento" + NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4190
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O4179
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4182
fatherSonIndex=0
frm_calc='_listaerr + "non è presente la data rilascio del documento"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4195
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O4176
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4179
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il numero documento" + NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4200
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O4173
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4176
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il tipo di documento"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4205
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O4170
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4173
fatherSonIndex=0
frm_calc='_listaerr + "non è presente la data di nascita"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4210
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4170
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il luogo di nascita"
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4215
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4165
fatherSonIndex=1
frm_calc=[
'not(Empty(LRTrim(Substr(riga,136,30))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,128,8))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,175,2))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,177,15))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,192,8))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,200,30))))
]
h=[
19
19
]
obj='If
pag=32
prev=O4231
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4234
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente l'autorità di rilascio del documento" + NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4239
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O4228
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4231
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente la data rilascio del documento"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4244
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O4225
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4228
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente il numero documento" + NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4249
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O4222
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4225
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente il tipo di documento"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4254
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O4219
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4222
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente la data di nascita"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4259
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4219
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente il luogo di nascita"
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4264
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=32
prev=O4159
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4162
fatherSonIndex=0
frm_calc='''
len=1
name='_tiposot
next=Icpitembatch.CPRead
arch='tbstgru
next=Icpitembatch.CPIfElse
frm_calc=[
'_tiposot='1'
]
h=[
19
19
]
obj='If
pag=32
prev=O4271
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4272
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice RAE"
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4277
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=32
prev=O4270
rd_field=[
'TIPOSOT
]
rd_kfield=[
'SOTGRU
]
rd_kvar=[
'Substr(riga,166,3)
]
rd_var=[
'_tiposot
]
I
obj='Var
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O4156
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4159
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Substr(riga,460,10))) and Empty(LRTrim(Substr(riga,288,1)))
]
h=[
19
19
]
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4287
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice Ateco"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4292
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4159
fatherSonIndex=1
frm_calc=[
'Empty(LRTrim(Substr(riga,468,10))) and Empty(LRTrim(Substr(riga,288,1)))
]
h=[
19
19
]
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4296
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice Ateco"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4301
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=32
prev=O4153
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4156
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice Settorizzazione sintetica"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4307
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O4150
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4153
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice SAE"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4312
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O4147
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4150
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Substr(riga,1,6))) and Empty(LRTrim(Substr(riga,230,30)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,230,30)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,260,2)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,77,35)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,265,9)))
]
h=[
19
19
]
obj='If
pag=32
prev=O4326
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4329
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il cap di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4334
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O4323
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4326
fatherSonIndex=0
frm_calc='_listaerr + "non è presente l'indirizzo di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4339
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O4320
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4323
fatherSonIndex=0
frm_calc='_listaerr + "non è presente la provincia di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4344
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O4317
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4320
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il comune di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4349
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4317
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice CAB (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4354
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O4144
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4147
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice stato di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4360
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O4141
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4144
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice fiscale (ASSOLUTAMENTE OBBLIGATORIO)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4365
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4141
fatherSonIndex=0
frm_calc='_listaerr + " non è presente la ragione sociale (ASSOLUTAMENTE OBBLIGATORIO)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4370
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=32
pagelocal=True
prev=O4125
var_op='asgn
I
nonlocal=True
obj='Var
pag=32
prev=O4124
var_op='asgn
I
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4123
var_op='asgn
I
obj='Var
pag=32
pagelocal=True
prev=O4122
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=32
prev=O4108
var_op='asgn
I
obj='Var
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='TempTable
pag=32
prev=O4096
sel_type='def
server_table='tmp_errimp
I
obj='DropTempTable
pag=32
prev=O4094
server_table='tmp_errimp
I
obj='Begin
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4094
fatherSonIndex=0
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
len=128
name='_testata
next=Icpitembatch.CPVarDecl
len=1
name='_ferr
next=Icpitembatch.CPVarDecl
len=1
name='_tiposot
obj='Var
pag=32
pagelocal=True
prev=O4382
I
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O4381
I
obj='Var
pag=32
pagelocal=True
prev=O4380
I
obj='Var
obj_type='M
pag=32
pagelocal=True
I
I
]
w=[
150
150
]
x=13
y=19
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'Lower(LRTrim(nomefileimport))='saldopex.txt'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Saldi operazioni extraconto Inseriti: '+LRTrim(Str(cNumNew,10,0))  +  NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Saldi operazioni extraconto Aggiornati: '+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O4394
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O4393
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O4392
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O4389
var_op='asgn
I
obj='If
pag=33
prev=O4388
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4389
fatherSonIndex=0
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
obj='Exec
pag=33
prev=O4401
I
obj='Exec
pag=33
prev=O4399
I
obj='While
pag=33
prev=O4398
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4399
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record dei saldi opex del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=33
prev=O4409
var_op='asgn
I
nonlocal=True
obj='Var
pag=33
prev=O4406
var_op='asgn
I
obj='If
pag=33
prev=O4405
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O4406
fatherSonIndex=0
frm_calc='Substr(riga,1,16)
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Val(Substr(riga,21,17))=0 and Val(Substr(riga,38,6))=0 and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Val(Substr(riga,21,17))=0 and Val(Substr(riga,38,6)) <> 0 and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Val(Substr(riga,21,17))<>0 and Val(Substr(riga,38,6))=0 and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub = 1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=33
prev=O4430
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O4433
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=33
prev=O4438
var_op='asgn
I
obj='Write
pag=33
rd_kfield=[
'COLLEG
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,16)
'Substr(riga,17,4)
]
wr_field=[
'SALDO
'QUANTITA
'VALUTA
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Val(Substr(riga,21,17))
'Val(Substr(riga,38,6))
'iif(Empty(LRTrim(Substr(riga,44,3))),'242',Substr(riga,44,3))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4433
fatherSonIndex=1
frm_calc='1
len=1
name='_soxerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(shand,riga+" - "+_descerr)
obj='Exec
pag=33
prev=O4447
I
obj='Var
obj_type='N
pag=33
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=33
prev=O4427
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4430
fatherSonIndex=0
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPRead
arch='opextrbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
]
obj='If
pag=33
prev=O4453
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4454
fatherSonIndex=0
frm_calc='"Assente operazione extraconto per l'anno indicato"
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O4459
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=33
prev=O4452
rd_field=[
'IDBASE
]
rd_kfield=[
'COLLEG
'ANNO
]
rd_kvar=[
'cCli1
'Substr(riga,17,4)
]
rd_var=[
'xIDB
]
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=33
prev=O4424
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4427
fatherSonIndex=0
frm_calc=''Numero Operazioni non valorizzato'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O4469
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=33
prev=O4421
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4424
fatherSonIndex=0
frm_calc=''Saldo non valorizzato'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O4474
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=33
prev=O4418
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O4421
fatherSonIndex=0
frm_calc=''Saldo e Numero operazioni entrambi non valorizzati'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O4479
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=33
prev=O4417
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O4418
fatherSonIndex=0
frm_calc=''Anagrafica soggetto non presente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O4484
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=33
prev=O4416
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,1,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=33
prev=O4415
var_op='asgn
I
obj='Var
pag=33
prev=O4414
var_op='asgn
I
obj='Var
obj_type='N
pag=33
prev=O4413
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=33
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Apro il foglio e verifico quante pagine ha
father=O4389
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='_i = 0
next=Icpitembatch.CPWhile
frm_calc='_i < _conta
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='workbook.close()
obj='Exec
pag=33
prev=O4497
I
obj='While
pag=33
prev=O4496
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O4497
fatherSonIndex=0
frm_calc="_righe = 0;
Sheet sheet = workbook.getSheet(_i);
_righe = sheet.getRows();
_y = 1;
°--°
next=Icpitembatch.CPWhile
frm_calc='_y < _righe
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=33
prev=O4503
I
obj='While
pag=33
prev=O4502
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Legge le colonne e scrive i dati nelle variabili appoggio
father=O4503
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column06)))
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_y++;
obj='Exec
pag=33
prev=O4510
I
obj='If
pag=33
prev=O4508
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O4510
fatherSonIndex=0
frm_calc=''Elaborazione Foglio N.'+LRTrim(Str(_i+1,2,0))+' - Riga N. '+LRTrim(Str(_y+1,7,0))+' - Rapporto N. : '+LRTrim(column01)
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPRead
arch='opextrbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record dei saldi opex del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=33
prev=O4522
var_op='asgn
I
nonlocal=True
obj='Var
pag=33
prev=O4519
var_op='asgn
I
obj='If
pag=33
prev=O4518
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O4519
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGOPEX\'"+LRTrim(gAzienda)+"'",0,10)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='opextrbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=33
prev=O4528
var_op='asgn
I
obj='Insert
pag=33
prev=O4527
rd_kfield=[
'COLLEG
'ANNO
'IDBASE
'SALDO
'QUANTITA
'VALUTA
'PROGOPEX
]
rd_kvar=[
'Left(LRTrim(column01),16)
'Left(LRTrim(column02),4)
'xIDB
'Val(LRTrim(column03))
'Val(LRTrim(column04))
'iif(Empty(LRTrim(column05)),'242',Left(LRTrim(column05),3))
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4528
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,1,16)+" per l'operazione extraconto in data: "+Substr(riga,21,8)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=33
prev=O4537
I
obj='Var
obj_type='N
pag=33
prev=O4536
var_op='asgn
I
obj='Exec
pag=33
prev=O4535
I
nonlocal=True
obj='Var
obj_type='M
pag=33
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=33
prev=O4526
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O4519
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=33
prev=O4541
var_op='asgn
I
obj='Write
pag=33
rd_kfield=[
'COLLEG
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(LRTrim(column01),16)
'Left(LRTrim(column02),4)
]
wr_field=[
'SALDO
'QUANTITA
'VALUTA
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Val(LRTrim(column03))
'Val(LRTrim(column04))
'iif(Empty(LRTrim(column05)),'242',Left(LRTrim(column05),3))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=33
prev=O4517
rd_field=[
'IDBASE
]
rd_kfield=[
'COLLEG
'ANNO
]
rd_kvar=[
'Left(LRTrim(column01),16)
'Left(LRTrim(column02),4)
]
rd_var=[
'xIDB
]
I
obj='Var
pag=33
prev=O4516
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=33
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O4508
fatherSonIndex=0
frm_calc="// Legge il contenuto delle celle
Cell a01 = sheet.getCell(0,_y);
Cell a02 = sheet.getCell(1,_y);
Cell a03 = sheet.getCell(2,_y);
Cell a04 = sheet.getCell(3,_y);
Cell a05 = sheet.getCell(4,_y);
Cell a06 = sheet.getCell(5,_y);
°--°
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
obj='Begin
pag=33
prev=O4557
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4558
fatherSonIndex=0
frm_calc='a01.getContents()
len=25
name='column01
next=Icpitembatch.CPVarDecl
frm_calc='a02.getContents()
len=25
name='column02
next=Icpitembatch.CPVarDecl
frm_calc='a03.getContents()
len=25
name='column03
next=Icpitembatch.CPVarDecl
frm_calc='a04.getContents()
len=25
name='column04
next=Icpitembatch.CPVarDecl
frm_calc='a05.getContents()
len=25
name='column05
next=Icpitembatch.CPVarDecl
frm_calc='a06.getContents()
len=25
name='column06
obj='Var
pag=33
prev=O4566
var_op='asgn
I
obj='Var
pag=33
prev=O4565
var_op='asgn
I
obj='Var
pag=33
prev=O4564
var_op='asgn
I
obj='Var
pag=33
prev=O4563
var_op='asgn
I
obj='Var
pag=33
prev=O4562
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Exec
pag=33
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=33
I
I
]
w=[
150
150
]
I
obj='Exec
pag=33
prev=O4494
I
obj='Begin
pag=33
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O4494
fatherSonIndex=0
frm_calc="//base
Workbook workbook = Workbook.getWorkbook(new File(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(nomefileimport)));
_conta = workbook.getNumberOfSheets();
°--°
obj='Exec
pag=33
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O4387
var_op='asgn
I
obj='Var
obj_type='N
pag=33
prev=O4386
var_op='asgn
I
obj='Var
obj_type='N
pag=33
prev=O4385
var_op='asgn
I
obj='Remark
pag=33
x=9
y=19
I
Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=33
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O4577
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGOPEX\'"+LRTrim(gAzienda)+"'",0,10)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='opextrbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=33
prev=O4584
var_op='asgn
I
obj='Insert
pag=33
prev=O4583
rd_kfield=[
'COLLEG
'ANNO
'IDBASE
'SALDO
'QUANTITA
'VALUTA
'PROGOPEX
]
rd_kvar=[
'cCli1
'Substr(riga,17,4)
'xIDB
'Val(Substr(riga,21,17))
'Val(Substr(riga,38,6))
'iif(Empty(LRTrim(Substr(riga,44,3))),'242',Substr(riga,44,3))
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4584
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,1,16)+" per l'operazione extraconto in data: "+Substr(riga,21,8)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=33
prev=O4593
I
obj='Var
obj_type='N
pag=33
prev=O4592
var_op='asgn
I
obj='Exec
pag=33
prev=O4591
I
nonlocal=True
obj='Var
obj_type='M
pag=33
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=33
prev=O4582
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
Icpitembatch.CPItemSon
I
]
w=[
150
150
150
]
x=1308
y=1242
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'Lower(LRTrim(nomefileimport))='saldrapp.txt'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Saldi Rapporti Creati: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Saldi Rapporti Aggiornati: '+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O4607
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O4606
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O4605
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O4602
var_op='asgn
I
obj='If
pag=34
prev=O4601
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4602
fatherSonIndex=0
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
obj='Exec
pag=34
prev=O4614
I
obj='Exec
pag=34
prev=O4612
I
obj='While
pag=34
prev=O4611
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4612
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,25)
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPRead
arch='aeannora
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPWrite
arch='aetesta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record dei saldi rapporti del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=34
prev=O4626
var_op='asgn
I
nonlocal=True
obj='Var
pag=34
prev=O4625
var_op='asgn
I
obj='Write
pag=34
prev=O4622
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'VALUTA
'CAB
]
wr_op=[
'=
'=
]
wr_var=[
'iif(Empty(LRTrim(Substr(riga,104,3))),'242',Substr(riga,104,3))
'Substr(riga,107,5)
]
I
obj='If
pag=34
prev=O4621
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O4622
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGSAR\'"+LRTrim(gAzienda)+"'",0,10)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aeannora
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=34
prev=O4638
var_op='asgn
I
obj='Insert
pag=34
prev=O4637
rd_kfield=[
'RAPPORTO
'ANNO
'IDBASE
'IMPORTO1
'IMPORTO2
'IMPORTO3
'IMPORTO4
'IMPORTO5
]
rd_kvar=[
'xRapporto
'Substr(riga,26,4)
'xIDB
'Val(Substr(riga,30,17))
'Val(Substr(riga,47,17))
'Val(Substr(riga,64,17))
'Val(Substr(riga,81,17))
'Val(Substr(riga,98,6))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4638
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,1,16)+" per il rapporto in data: "+Substr(riga,21,8)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=34
prev=O4647
I
obj='Var
obj_type='N
pag=34
prev=O4646
var_op='asgn
I
obj='Exec
pag=34
prev=O4645
I
nonlocal=True
obj='Var
obj_type='M
pag=34
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=34
prev=O4636
var_op='asgn
I
obj='Var
pag=34
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aeannora
father=O4622
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=34
prev=O4651
var_op='asgn
I
obj='Write
pag=34
rd_kfield=[
'RAPPORTO
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,4)
]
wr_field=[
'IMPORTO1
'IMPORTO2
'IMPORTO3
'IMPORTO4
'IMPORTO5
]
wr_op=[
'=
'=
'=
'=
'=
]
wr_var=[
'Val(Substr(riga,30,17))
'Val(Substr(riga,47,17))
'Val(Substr(riga,64,17))
'Val(Substr(riga,81,17))
'Val(Substr(riga,98,6))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=34
prev=O4620
rd_field=[
'IDBASE
]
rd_kfield=[
'RAPPORTO
'ANNO
]
rd_kvar=[
'xRapporto
'Substr(riga,26,4)
]
rd_var=[
'xIDB
]
I
obj='Var
pag=34
prev=O4619
var_op='asgn
I
obj='Var
pag=34
prev=O4618
var_op='asgn
I
obj='Var
obj_type='M
pag=34
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=34
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Apro il foglio e verifico quante pagine ha
father=O4602
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='_i = 0
next=Icpitembatch.CPWhile
frm_calc='_i < _conta
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='workbook.close()
obj='Exec
pag=34
prev=O4669
I
obj='While
pag=34
prev=O4668
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O4669
fatherSonIndex=0
frm_calc="_righe = 0;
Sheet sheet = workbook.getSheet(_i);
_righe = sheet.getRows();
_y = 1;
°--°
next=Icpitembatch.CPWhile
frm_calc='_y < _righe
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=34
prev=O4675
I
obj='While
pag=34
prev=O4674
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Legge le colonne e scrive i dati nelle variabili appoggio
father=O4675
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column10)))
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_y++;
obj='Exec
pag=34
prev=O4682
I
obj='If
pag=34
prev=O4680
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O4682
fatherSonIndex=0
frm_calc=''Elaborazione Foglio N.'+LRTrim(Str(_i+1,2,0))+' - Riga N. '+LRTrim(Str(_y+1,7,0))+' - Rapporto N. : '+LRTrim(column01)
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='column01
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPRead
arch='aeannora
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPWrite
arch='aetesta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record dei saldi rapporti del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=34
prev=O4696
var_op='asgn
I
nonlocal=True
obj='Var
pag=34
prev=O4695
var_op='asgn
I
obj='Write
pag=34
prev=O4692
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'VALUTA
'CAB
]
wr_op=[
'=
'=
]
wr_var=[
'iif(Empty(LRTrim(column08)),'242',Left(LRTrim(column08),3))
'Left(LRTrim(column09),5)
]
I
obj='If
pag=34
prev=O4691
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O4692
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGSAR\'"+LRTrim(gAzienda)+"'",0,10)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aeannora
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=34
prev=O4708
var_op='asgn
I
obj='Insert
pag=34
prev=O4707
rd_kfield=[
'RAPPORTO
'ANNO
'IDBASE
'IMPORTO1
'IMPORTO2
'IMPORTO3
'IMPORTO4
'IMPORTO5
]
rd_kvar=[
'Left(LRTrim(column01),25)
'Left(LRTrim(column02),4)
'xIDB
'Val(LRTrim(column03))
'Val(LRTrim(column04))
'Val(LRTrim(column05))
'Val(LRTrim(column06))
'Val(LRTrim(column07))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4708
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,1,16)+" per il rapporto in data: "+Substr(riga,21,8)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=34
prev=O4717
I
obj='Var
obj_type='N
pag=34
prev=O4716
var_op='asgn
I
obj='Exec
pag=34
prev=O4715
I
nonlocal=True
obj='Var
obj_type='M
pag=34
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=34
prev=O4706
var_op='asgn
I
obj='Var
pag=34
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aeannora
father=O4692
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=34
prev=O4721
var_op='asgn
I
obj='Write
pag=34
rd_kfield=[
'RAPPORTO
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(LRTrim(column01),25)
'Left(LRTrim(column02),4)
]
wr_field=[
'IMPORTO1
'IMPORTO2
'IMPORTO3
'IMPORTO4
'IMPORTO5
]
wr_op=[
'=
'=
'=
'=
'=
]
wr_var=[
'Val(LRTrim(column03))
'Val(LRTrim(column04))
'Val(LRTrim(column05))
'Val(LRTrim(column06))
'Val(LRTrim(column07))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=34
prev=O4690
rd_field=[
'IDBASE
]
rd_kfield=[
'RAPPORTO
'ANNO
]
rd_kvar=[
'Left(LRTrim(column01),25)
'Left(LRTrim(column02),4)
]
rd_var=[
'xIDB
]
I
obj='Var
pag=34
prev=O4689
var_op='asgn
I
obj='Var
pag=34
prev=O4688
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=34
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=34
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O4680
fatherSonIndex=0
frm_calc="// Legge il contenuto delle celle
Cell a01 = sheet.getCell(0,_y);
Cell a02 = sheet.getCell(1,_y);
Cell a03 = sheet.getCell(2,_y);
Cell a04 = sheet.getCell(3,_y);
Cell a05 = sheet.getCell(4,_y);
Cell a06 = sheet.getCell(5,_y);
Cell a07 = sheet.getCell(6,_y);
Cell a08 = sheet.getCell(7,_y);
Cell a09 = sheet.getCell(8,_y);
Cell a10 = sheet.getCell(9,_y);
°--°
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
obj='Begin
pag=34
prev=O4737
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4738
fatherSonIndex=0
frm_calc='a01.getContents()
len=25
name='column01
next=Icpitembatch.CPVarDecl
frm_calc='a02.getContents()
len=25
name='column02
next=Icpitembatch.CPVarDecl
frm_calc='a03.getContents()
len=25
name='column03
next=Icpitembatch.CPVarDecl
frm_calc='a04.getContents()
len=25
name='column04
next=Icpitembatch.CPVarDecl
frm_calc='a05.getContents()
len=25
name='column05
next=Icpitembatch.CPVarDecl
frm_calc='a06.getContents()
len=25
name='column06
next=Icpitembatch.CPVarDecl
frm_calc='a07.getContents()
len=25
name='column07
next=Icpitembatch.CPVarDecl
frm_calc='a08.getContents()
len=25
name='column08
next=Icpitembatch.CPVarDecl
frm_calc='a09.getContents()
len=25
name='column09
next=Icpitembatch.CPVarDecl
frm_calc='a10.getContents()
len=25
name='column10
obj='Var
pag=34
prev=O4750
var_op='asgn
I
obj='Var
pag=34
prev=O4749
var_op='asgn
I
obj='Var
pag=34
prev=O4748
var_op='asgn
I
obj='Var
pag=34
prev=O4747
var_op='asgn
I
obj='Var
pag=34
prev=O4746
var_op='asgn
I
obj='Var
pag=34
prev=O4745
var_op='asgn
I
obj='Var
pag=34
prev=O4744
var_op='asgn
I
obj='Var
pag=34
prev=O4743
var_op='asgn
I
obj='Var
pag=34
prev=O4742
var_op='asgn
I
obj='Var
pag=34
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Exec
pag=34
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=34
I
I
]
w=[
150
150
]
I
obj='Exec
pag=34
prev=O4666
I
obj='Begin
pag=34
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O4666
fatherSonIndex=0
frm_calc="//base
Workbook workbook = Workbook.getWorkbook(new File(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(nomefileimport)));
_conta = workbook.getNumberOfSheets();
°--°
obj='Exec
pag=34
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O4600
var_op='asgn
I
obj='Var
obj_type='N
pag=34
prev=O4599
var_op='asgn
I
obj='Var
obj_type='N
pag=34
prev=O4598
var_op='asgn
I
obj='Remark
pag=34
x=12
y=19
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Inserite o modificate: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O4772
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O4771
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O4770
var_op='asgn
I
obj='Exec
pag=5
prev=O4769
I
obj='Exec
pag=5
prev=O4767
I
obj='While
pag=5
prev=O4766
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4767
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=5
prev=O4776
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
father=O4777
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O4782
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O4784
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,257,6))))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,318,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc='_flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,331,9))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))) or Empty(LRTrim(_numprog))
]
h=[
19
19
]
obj='If
pag=5
prev=O4806
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4809
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,155,1)='S' or Substr(riga,155,1)='1' or Substr(riga,155,1)='7'
'Substr(riga,155,1)='E' or Substr(riga,155,1)='3' or Substr(riga,155,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,147,8))) or _flgdataim=1,Date(),CharToDate(Right(Substr(riga,147,8),4)+Substr(Substr(riga,147,8),3,2)+Left(Substr(riga,147,8),2)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,9,1)='1' or Substr(riga,9,1)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,301,1)),'0',iif(Substr(riga,301,1)='S','1',iif(Substr(riga,301,1)='N','1',Substr(riga,301,1))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,231,11))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPRead
arch='tbcauana
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='operazbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_oldidb)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=5
prev=O4835
var_op='asgn
I
obj='If
pag=5
prev=O4833
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4835
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='sogopebo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='clientiope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='beneficope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='terzistiope
obj='Delete
pag=5
prev=O4850
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=5
prev=O4849
sel_field='*
sel_name='terzistiope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistiope
father=O4850
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'cOpeProg1
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=5
prev=O4847
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=5
prev=O4846
sel_field='*
sel_name='beneficope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficope
father=O4847
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
]
rd_kvar=[
'cOpeProg1
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=5
prev=O4844
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=5
prev=O4843
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O4844
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=5
prev=O4841
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=5
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sogopebo
father=O4841
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=5
prev=O4831
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
]
rd_kvar=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'Substr(riga,10,4)
'_intercab
'Substr(riga,64,6)
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'Substr(riga,484,16)
'Substr(riga,302,16)
'Substr(riga,190,16)
'Substr(riga,206,16)
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_datarett
'Substr(riga,32,30)
'_intercit
'Substr(riga,70,50)
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'_flagrap2
'cOpeProg1
'cIdCau
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)+cOpeProg2+'S'
'Substr(riga,424,30)
'Substr(riga,813,15)
'Substr(riga,414,5)
'Substr(riga,662,50)
'cOpeProg2
'Substr(riga,328,3)
'_idreg
''1'
'CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6))
'arfn_conv_stato_uic(Substr(riga,29,3))
'Substr(riga,812,1)
'nProgImp
'Substr(riga,62,2)
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
'_statoreg
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'_colleg
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4833
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O4896
I
obj='Var
obj_type='N
pag=5
prev=O4895
var_op='asgn
I
obj='Exec
pag=5
prev=O4894
I
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Begin
pag=5
prev=O4830
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4831
fatherSonIndex=0
frm_calc='Upper(Substr(riga,511,70))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,581,3))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,584,30))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,614,6)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,620,2))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,622,35))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,657,5))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,302,16))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=5
prev=O4911
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4914
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,120,25))))
]
h=[
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4919
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4924
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O4935
I
obj='Read
pag=5
prev=O4934
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=5
prev=O4933
var_op='asgn
I
obj='Var
pag=5
prev=O4932
var_op='asgn
I
obj='Var
pag=5
prev=O4931
var_op='asgn
I
obj='Var
pag=5
prev=O4930
var_op='asgn
I
obj='Var
pag=5
prev=O4929
var_op='asgn
I
obj='Var
pag=5
prev=O4928
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O4908
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4911
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=5
prev=O4952
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,302,16)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=5
prev=O4951
var_op='asgn
I
obj='Var
pag=5
prev=O4950
var_op='asgn
I
obj='Var
pag=5
prev=O4949
var_op='asgn
I
obj='Var
pag=5
prev=O4948
var_op='asgn
I
obj='Var
pag=5
prev=O4947
var_op='asgn
I
obj='Var
pag=5
prev=O4946
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O4907
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O4908
fatherSonIndex=0
obj='Read
pag=5
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O4906
var_op='asgn
I
obj='Var
pag=5
prev=O4905
var_op='asgn
I
obj='Var
pag=5
prev=O4904
var_op='asgn
I
obj='Var
pag=5
prev=O4903
var_op='asgn
I
obj='Var
pag=5
prev=O4902
var_op='asgn
I
obj='Var
pag=5
prev=O4901
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O4829
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O4828
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O4827
var_op='asgn
I
obj='Read
pag=5
prev=O4826
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,10,4)
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
I
obj='Var
pag=5
prev=O4825
var_op='asgn
I
obj='Var
pag=5
prev=O4824
var_op='asgn
I
obj='Var
pag=5
prev=O4823
var_op='asgn
I
obj='Var
pag=5
prev=O4822
var_op='asgn
I
obj='Var
pag=5
prev=O4821
var_op='asgn
I
obj='Var
obj_type='D
pag=5
prev=O4818
var_op='asgn
I
obj='Case
pag=5
prev=O4817
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4818
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4818
fatherSonIndex=1
frm_calc=[
'Substr(riga,155,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4976
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4976
fatherSonIndex=1
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4818
fatherSonIndex=2
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=5
prev=O4814
var_op='asgn
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4814
fatherSonIndex=0
frm_calc='_numprog
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''1'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
obj='Var
obj_type='D
pag=5
prev=O4991
var_op='asgn
I
obj='Var
pag=5
prev=O4990
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4814
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("POPERAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''0'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datarett
obj='Var
obj_type='D
pag=5
prev=O4995
var_op='asgn
I
obj='Var
pag=5
prev=O4994
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O4803
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4806
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Left(riga,8)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5001
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O5006
sel_field='operazbo->IDBASE
sel_name='operazbo
sel_where='operazbo->NUMPROG=_numprog and (operazbo->STATOREG='0'  or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O5007
fatherSonIndex=0
frm_calc='"E' stata cancellata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=5
prev=O5011
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'operazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
]
wr_var=[
''2'
'Date()
]
I
nonlocal=True
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
father=O5001
fatherSonIndex=1
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"E' stata variata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O5022
sel_field='operazbo->IDBASE,operazbo->NUMPROG,operazbo->DATAOPE,operazbo->FLAGRAP2
sel_name='operazbo
sel_where='operazbo->NUMPROG=_numprog and (operazbo->STATOREG='0'  or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5023
fatherSonIndex=0
frm_calc='operazbo->IDBASE
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(operazbo->FLAGRAP2),Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(operazbo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(operazbo->DATAOPE)+operazbo->NUMPROG+_flagrap2
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='operazbo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O5035
sel_field='*
sel_name='terzistiope
sel_where='terzistiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='merzistiope
father=O5037
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'IDREG
]
rd_kvar=[
'_oldidb
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O5033
sel_field='*
sel_name='beneficope
sel_where='beneficope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='meneficope
father=O5035
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
'IDREG
]
rd_kvar=[
'_oldidb
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O5031
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mlientiope
father=O5033
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O5030
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mogopebo
father=O5031
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=5
prev=O5029
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'operazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
'FLAGRAP2
'IDEREG
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
''3'
'Date()
'_flagrap2
'_idreg
]
I
obj='Var
pag=5
prev=O5028
var_op='asgn
I
obj='Var
pag=5
prev=O5027
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=5
prev=O5021
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O4802
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4803
fatherSonIndex=0
frm_calc=[
'Upper(Substr(riga,331,9))='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5074
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_field='operazbo->NUMPROG
sel_name='operazbo
sel_where='operazbo->INFORM = Substr(riga,424,30) and (operazbo->STATOREG='0' or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5079
fatherSonIndex=0
frm_calc='operazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5074
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=5
sel_field='operazbo->NUMPROG
sel_name='operazbo
sel_where='operazbo->RIFIMP = Substr(riga,331,9) and (operazbo->STATOREG='0' or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5086
fatherSonIndex=0
frm_calc='operazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O4801
var_op='asgn
I
obj='Var
pag=5
prev=O4800
var_op='asgn
I
obj='Var
pag=5
prev=O4799
var_op='asgn
I
obj='Var
pag=5
prev=O4796
var_op='asgn
I
obj='If
pag=5
prev=O4795
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O4796
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=5
prev=O5096
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5097
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O5103
I
obj='Var
obj_type='N
pag=5
prev=O5102
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,318,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O4794
var_op='asgn
I
obj='Remark
pag=5
prev=O4791
I
obj='If
pag=5
prev=O4789
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4791
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,263,30))+LRTrim(Substr(riga,295,6))+LRTrim(Substr(riga,293,2))))
]
h=[
19
19
]
obj='If
pag=5
prev=O5115
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5118
fatherSonIndex=0
frm_calc='LRTrim(Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=5
prev=O5124
var_op='asgn
I
obj='Var
pag=5
prev=O5123
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O5114
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5115
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(Substr(riga,257,6))+" non è prensente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O5130
I
obj='Var
obj_type='N
pag=5
prev=O5129
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O5113
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'Substr(riga,257,6)
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4789
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,246,11))),_codinter,Substr(riga,246,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,263,30))),_citinter,Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,295,6))),_cabinter,Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,293,2))),_prvinter,Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=5
prev=O5142
var_op='asgn
I
obj='Var
pag=5
prev=O5141
var_op='asgn
I
obj='Var
pag=5
prev=O5140
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4784
fatherSonIndex=1
frm_calc='1
len=1
name='_opeerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(ohand,riga+" - "+_descerr)
obj='Exec
pag=5
prev=O5146
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O4782
fatherSonIndex=0
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,190,16))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,206,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,484,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,190,16))) and Empty(LRTrim(Substr(riga,120,25))) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=5
prev=O5162
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5165
fatherSonIndex=0
frm_calc=''Rapporto continuativo Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O5170
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O5159
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5162
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=5
prev=O5176
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5177
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto per conto del quale assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O5182
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O5175
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,484,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O5156
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5159
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=5
prev=O5193
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5194
fatherSonIndex=0
frm_calc=''Anagrafica Controparte Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O5199
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O5192
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,302,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O5153
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5156
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=5
prev=O5210
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5211
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto Operante Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O5216
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O5209
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,206,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O5152
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5153
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=5
prev=O5227
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5228
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O5233
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O5226
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,190,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O5151
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O4765
var_op='asgn
I
obj='Var
pag=5
prev=O4764
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O4763
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O4762
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
prev=O4761
I
obj='Remark
pag=5
x=14
y=18
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Frazionate Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O5254
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O5253
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O5252
var_op='asgn
I
obj='Exec
pag=6
prev=O5250
I
obj='While
pag=6
prev=O5249
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5250
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=6
prev=O5258
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
father=O5259
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
prev=O5264
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O5266
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,257,6))))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,318,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc='_flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,331,9))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))) or Empty(LRTrim(_numprog))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=6
prev=O5291
var_op='asgn
I
obj='If
pag=6
prev=O5288
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5291
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,155,1)='S' or Substr(riga,155,1)='1' or Substr(riga,155,1)='7'
'Substr(riga,155,1)='E' or Substr(riga,155,1)='3' or Substr(riga,155,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,147,8))) or _flgdataim=1,Date(),CharToDate(Right(Substr(riga,147,8),4)+Substr(Substr(riga,147,8),3,2)+Left(Substr(riga,147,8),2)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,9,1)='1' or Substr(riga,9,1)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,301,1)),'0',iif(Substr(riga,301,1)='S','1',iif(Substr(riga,301,1)='N','1',Substr(riga,301,1))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,231,11))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPRead
arch='tbcauana
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' frazionate del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='fraziobo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_oldidb)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=6
prev=O5318
var_op='asgn
I
obj='If
pag=6
prev=O5316
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5318
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='sogopebo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='clientiope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='beneficope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='terzistiope
obj='Delete
pag=6
prev=O5333
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=6
prev=O5332
sel_field='*
sel_name='terzistiope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistiope
father=O5333
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'cOpeProg1
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=6
prev=O5330
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=6
prev=O5329
sel_field='*
sel_name='beneficope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficope
father=O5330
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
]
rd_kvar=[
'cOpeProg1
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=6
prev=O5327
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=6
prev=O5326
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O5327
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=6
prev=O5324
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=6
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sogopebo
father=O5324
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=6
prev=O5314
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
]
rd_kvar=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'Substr(riga,10,4)
'_intercab
'Substr(riga,64,6)
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'Substr(riga,484,16)
'Substr(riga,302,16)
'Substr(riga,190,16)
'Substr(riga,206,16)
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_datarett
'Substr(riga,32,30)
'_intercit
'Substr(riga,70,50)
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'_flagrap2
'cOpeProg1
'cIdCau
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)+cOpeProg2+'Z'
'Substr(riga,424,30)
'Substr(riga,813,15)
'Substr(riga,414,5)
'Substr(riga,662,50)
'cOpeProg2
'Substr(riga,328,3)
'_idreg
''1'
'CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6))
'arfn_conv_stato_uic(Substr(riga,29,3))
'Substr(riga,812,1)
'nProgImp
'Substr(riga,62,2)
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
'_statoreg
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'_colleg
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5316
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=6
prev=O5379
I
obj='Var
obj_type='N
pag=6
prev=O5378
var_op='asgn
I
obj='Exec
pag=6
prev=O5377
I
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Begin
pag=6
prev=O5313
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5314
fatherSonIndex=0
frm_calc='Upper(Substr(riga,511,70))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,581,3))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,584,30))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,614,6)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,620,2))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,622,35))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,657,5))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,302,16))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=6
prev=O5394
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5397
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,120,25))))
]
h=[
19
19
]
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5402
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=6
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5407
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=6
prev=O5418
I
obj='Read
pag=6
prev=O5417
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=6
prev=O5416
var_op='asgn
I
obj='Var
pag=6
prev=O5415
var_op='asgn
I
obj='Var
pag=6
prev=O5414
var_op='asgn
I
obj='Var
pag=6
prev=O5413
var_op='asgn
I
obj='Var
pag=6
prev=O5412
var_op='asgn
I
obj='Var
pag=6
prev=O5411
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O5391
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5394
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=6
prev=O5435
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,302,16)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=6
prev=O5434
var_op='asgn
I
obj='Var
pag=6
prev=O5433
var_op='asgn
I
obj='Var
pag=6
prev=O5432
var_op='asgn
I
obj='Var
pag=6
prev=O5431
var_op='asgn
I
obj='Var
pag=6
prev=O5430
var_op='asgn
I
obj='Var
pag=6
prev=O5429
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O5390
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O5391
fatherSonIndex=0
obj='Read
pag=6
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O5389
var_op='asgn
I
obj='Var
pag=6
prev=O5388
var_op='asgn
I
obj='Var
pag=6
prev=O5387
var_op='asgn
I
obj='Var
pag=6
prev=O5386
var_op='asgn
I
obj='Var
pag=6
prev=O5385
var_op='asgn
I
obj='Var
pag=6
prev=O5384
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O5312
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O5311
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O5310
var_op='asgn
I
obj='Read
pag=6
prev=O5309
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,10,4)
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
I
obj='Var
pag=6
prev=O5308
var_op='asgn
I
obj='Var
pag=6
prev=O5307
var_op='asgn
I
obj='Var
pag=6
prev=O5306
var_op='asgn
I
obj='Var
pag=6
prev=O5305
var_op='asgn
I
obj='Var
pag=6
prev=O5304
var_op='asgn
I
obj='Var
obj_type='D
pag=6
prev=O5301
var_op='asgn
I
obj='Case
pag=6
prev=O5300
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5301
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5301
fatherSonIndex=1
frm_calc=[
'Substr(riga,155,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5459
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5459
fatherSonIndex=1
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5301
fatherSonIndex=2
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=6
prev=O5297
var_op='asgn
I
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5297
fatherSonIndex=0
frm_calc='_numprog
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''1'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
obj='Var
obj_type='D
pag=6
prev=O5474
var_op='asgn
I
obj='Var
pag=6
prev=O5473
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5297
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PFRAZIO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''0'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datarett
obj='Var
obj_type='D
pag=6
prev=O5478
var_op='asgn
I
obj='Var
pag=6
prev=O5477
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O5285
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5288
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Left(riga,8)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5484
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=6
prev=O5489
sel_field='fraziobo->IDBASE
sel_name='fraziobo
sel_where='fraziobo->NUMPROG=_numprog and (fraziobo->STATOREG='0'  or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O5490
fatherSonIndex=0
frm_calc='"E' stata cancellata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=6
prev=O5494
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'fraziobo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
]
wr_var=[
''2'
'Date()
]
I
nonlocal=True
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
father=O5484
fatherSonIndex=1
frm_calc=''JLMNOTUV?'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"E' stata variata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=6
prev=O5505
sel_field='fraziobo->IDBASE,fraziobo->NUMPROG,fraziobo->DATAOPE,fraziobo->FLAGRAP2
sel_name='fraziobo
sel_where='fraziobo->NUMPROG=_numprog and (fraziobo->STATOREG='0'  or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5506
fatherSonIndex=0
frm_calc='fraziobo->IDBASE
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(fraziobo->FLAGRAP2),Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(fraziobo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(fraziobo->DATAOPE)+fraziobo->NUMPROG+_flagrap2
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='fraziobo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=6
prev=O5518
sel_field='*
sel_name='terzistifrz
sel_where='terzistifrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='merzistifrz
father=O5520
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'IDREG
]
rd_kvar=[
'_oldidb
'terzistifrz->CODSOG
'terzistifrz->TIPOFILE
'terzistifrz->NUMCOL
'terzistifrz->LEGAME
'terzistifrz->RAPCOL
'terzistifrz->UCODE
'terzistifrz->IDBASE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=6
prev=O5516
sel_field='*
sel_name='beneficfrz
sel_where='beneficfrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='meneficfrz
father=O5518
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
'IDREG
]
rd_kvar=[
'_oldidb
'beneficfrz->CPROWNUM
'beneficfrz->CODSOG
'beneficfrz->TIPOFILE
'beneficfrz->NUMCOL
'beneficfrz->LEGAME
'beneficfrz->RAPCOL
'beneficfrz->UCODE
'beneficfrz->IDBASE
'beneficfrz->C_RAG
'beneficfrz->C_STA
'beneficfrz->C_CTA
'beneficfrz->C_CAB
'beneficfrz->C_PRV
'beneficfrz->C_IND
'beneficfrz->C_CAP
'beneficfrz->C_RAPPORTO
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=6
prev=O5514
sel_field='*
sel_name='clientifrz
sel_where='clientifrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mlientifrz
father=O5516
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'clientifrz->CODSOG
'clientifrz->LEGAME
'clientifrz->IDBASE
'clientifrz->NUMCOL
'clientifrz->TIPOFILE
'clientifrz->RAPCOL
'clientifrz->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=6
prev=O5513
sel_field='*
sel_name='sogopefbo
sel_where='sogopefbo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mogopefbo
father=O5514
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'sogopefbo->CPROWNUM
'sogopefbo->CODSOG
'sogopefbo->LEGAME
'sogopefbo->IDBASE
'sogopefbo->NUMCOL
'sogopefbo->TIPOFILE
'sogopefbo->RAPCOL
'sogopefbo->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=6
prev=O5512
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'fraziobo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
'FLAGRAP2
'IDEREG
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
''3'
'Date()
'_flagrap2
'_idreg
]
I
obj='Var
pag=6
prev=O5511
var_op='asgn
I
obj='Var
pag=6
prev=O5510
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=6
prev=O5504
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O5284
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5285
fatherSonIndex=0
frm_calc=[
'Upper(Substr(riga,331,9))='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5557
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=6
sel_field='fraziobo->NUMPROG
sel_name='fraziobo
sel_where='fraziobo->INFORM = Substr(riga,424,30) and (fraziobo->STATOREG='0' or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5562
fatherSonIndex=0
frm_calc='fraziobo->NUMPROG
len=11
name='_numprog
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5557
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=6
sel_field='fraziobo->NUMPROG
sel_name='fraziobo
sel_where='fraziobo->RIFIMP = Substr(riga,331,9) and (fraziobo->STATOREG='0' or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5569
fatherSonIndex=0
frm_calc='fraziobo->NUMPROG
len=11
name='_numprog
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O5283
var_op='asgn
I
obj='Var
pag=6
prev=O5282
var_op='asgn
I
obj='Var
pag=6
prev=O5281
var_op='asgn
I
obj='Var
pag=6
prev=O5278
var_op='asgn
I
obj='If
pag=6
prev=O5277
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O5278
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=6
prev=O5579
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5580
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=6
prev=O5586
I
obj='Var
obj_type='N
pag=6
prev=O5585
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,318,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O5276
var_op='asgn
I
obj='Remark
pag=6
prev=O5273
I
obj='If
pag=6
prev=O5271
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5273
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,263,30))+LRTrim(Substr(riga,295,6))+LRTrim(Substr(riga,293,2))))
]
h=[
19
19
]
obj='If
pag=6
prev=O5598
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5601
fatherSonIndex=0
frm_calc='LRTrim(Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=6
prev=O5607
var_op='asgn
I
obj='Var
pag=6
prev=O5606
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O5597
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5598
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(Substr(riga,257,6))+" non è prensente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=6
prev=O5613
I
obj='Var
obj_type='N
pag=6
prev=O5612
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O5596
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'Substr(riga,257,6)
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=6
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5271
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,246,11))),_codinter,Substr(riga,246,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,263,30))),_citinter,Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,295,6))),_cabinter,Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,293,2))),_prvinter,Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=6
prev=O5625
var_op='asgn
I
obj='Var
pag=6
prev=O5624
var_op='asgn
I
obj='Var
pag=6
prev=O5623
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5266
fatherSonIndex=1
frm_calc='1
len=1
name='_frzerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(zhand,riga+" - "+_descerr)
obj='Exec
pag=6
prev=O5629
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5264
fatherSonIndex=0
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,190,16))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,206,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,484,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,190,16))) and Empty(LRTrim(Substr(riga,120,25))) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=6
prev=O5645
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5648
fatherSonIndex=0
frm_calc=''Rapporto continuativo Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O5653
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O5642
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5645
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=6
prev=O5659
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5660
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto per conto del quale assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O5665
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O5658
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,484,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O5639
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5642
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=6
prev=O5676
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5677
fatherSonIndex=0
frm_calc=''Anagrafica Controparte Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O5682
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O5675
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,302,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O5636
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5639
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=6
prev=O5693
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5694
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto Operante Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O5699
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O5692
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,206,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O5635
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5636
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=6
prev=O5710
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5711
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O5716
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O5709
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,190,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O5634
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O5248
var_op='asgn
I
obj='Var
pag=6
prev=O5247
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O5246
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O5245
var_op='asgn
I
obj='Var
pag=6
pagelocal=True
prev=O5244
I
obj='Remark
pag=6
x=20
y=14
I
Icpitembatch.CPRemark
frm_calc='Import Dipendenze
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumNew <> 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod <> 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=14
prev=O5742
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=14
prev=O5739
var_op='asgn
I
obj='If
pag=14
prev=O5736
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5739
fatherSonIndex=0
frm_calc='gMsgProc + 'Dipendenze Aggiornate: '+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O5735
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5736
fatherSonIndex=0
frm_calc='gMsgProc + 'Dipendenze Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Exec
pag=14
prev=O5734
I
obj='Exec
pag=14
prev=O5732
I
obj='While
pag=14
prev=O5731
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5732
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,6)
len=6
name='xDIP
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,69,6)
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Caricamento dipendenza con codice '+xDIP
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCodCab))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgRet='S'
]
h=[
19
19
]
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDIPx))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
prev=O5765
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPInsert
arch='anadip
father=O5766
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=14
prev=O5771
var_op='asgn
I
obj='Insert
pag=14
rd_kfield=[
'CODDIP
'DESCRIZ
'DESCCIT
'PROVINCIA
'CAB
'AGENTE
'IDBASE
]
rd_kvar=[
'xDIP
'Substr(riga,7,30)
'Substr(riga,37,30)
'Substr(riga,67,2)
'xCodCab
'iif(Upper(Substr(riga,85,1))='S','S','N')
'LibreriaMit.UniqueId()
]
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='anadip
father=O5766
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=14
prev=O5776
var_op='asgn
I
obj='Write
pag=14
rd_kfield=[
'CODDIP
]
rd_kop=[
'=
]
rd_kvar=[
'xDIP
]
wr_field=[
'DESCRIZ
'DESCCIT
'PROVINCIA
'CAB
'AGENTE
]
wr_op=[
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,7,30)
'Substr(riga,37,30)
'Substr(riga,67,2)
'xCodCab
'iif(Upper(Substr(riga,85,1))='S','S','N')
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=14
prev=O5762
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'xDIP
]
rd_var=[
'xDIPx
]
I
obj='If
pag=14
prev=O5759
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xnadip
father=O5762
fatherSonIndex=0
obj='Insert
pag=14
rd_kfield=[
'IDPROG
'CODDIP
'DESCRIZ
'DESCCIT
'PROVINCIA
'CAB
'AGENTE
]
rd_kvar=[
'conta
'xDIP
'Substr(riga,7,30)
'Substr(riga,37,30)
'Substr(riga,67,2)
'Substr(riga,69,6)
'Substr(riga,85,1)
]
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O5758
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5759
fatherSonIndex=0
frm_calc='Substr(riga,37,30)
len=30
name='xCitta
next=Icpitembatch.CPRead
arch='tbcitta
obj='Read
pag=14
prev=O5797
rd_field=[
'CAB
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'xCitta
]
rd_var=[
'xCodCab
]
I
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=14
prev=O5757
var_op='asgn
I
nonlocal=True
obj='Var
pag=14
prev=O5756
var_op='asgn
I
obj='Var
pag=14
prev=O5755
var_op='asgn
I
obj='Var
pag=14
prev=O5754
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=14
prev=O5730
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=14
prev=O5729
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O5728
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O5727
var_op='asgn
I
obj='Remark
pag=14
x=17
y=16
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Titolari Effettivi Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Titolari Effettivi Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=35
prev=O5815
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=35
prev=O5814
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=35
prev=O5813
var_op='asgn
I
obj='Exec
pag=35
prev=O5812
I
obj='Exec
pag=35
prev=O5810
I
obj='While
pag=35
prev=O5809
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5810
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
obj='Var
pag=35
prev=O5821
var_op='asgn
I
obj='If
pag=35
prev=O5820
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5821
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=35
prev=O5827
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xntestit
father=O5829
fatherSonIndex=0
obj='Write
pag=35
rd_kfield=[
'CODINTER
'CODCLI
'RAPPORTO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'Left(riga,25)
]
wr_field=[
'DESCINTER
'DATAINI
]
wr_op=[
'=
'=
]
wr_var=[
'Substr(riga,66,30)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5829
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xntestit
obj='Insert
pag=35
prev=O5842
rd_kfield=[
'CODCLI
'CODINTER
'DATAINI
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'Substr(riga,66,30)
'Left(riga,25)
'nProgImp
'LibreriaMit.UniqueId()
]
I
obj='Var
obj_type='N
pag=35
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=35
sel_field='xntestit->IDBASE
sel_name='xntestit
sel_where='xntestit->CODCLI=Substr(riga,26,16) and xntestit->CODINTER=Substr(riga,42,16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5827
fatherSonIndex=0
frm_calc='1
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=35
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5821
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=35
prev=O5852
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestit
father=O5854
fatherSonIndex=0
obj='Write
pag=35
rd_kfield=[
'CODINTER
'CODCLI
'RAPPORTO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'Left(riga,25)
]
wr_field=[
'DESCINTER
'DATAINI
]
wr_op=[
'=
'=
]
wr_var=[
'Substr(riga,66,30)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5854
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='intestit
obj='Insert
pag=35
prev=O5867
rd_kfield=[
'CODCLI
'CODINTER
'DATAINI
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'Substr(riga,66,30)
'Left(riga,25)
'nProgImp
'LibreriaMit.UniqueId()
]
I
obj='Var
obj_type='N
pag=35
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=35
sel_field='intestit->IDBASE
sel_name='intestit
sel_where='intestit->CODCLI=Substr(riga,26,16) and intestit->CODINTER=Substr(riga,42,16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5852
fatherSonIndex=0
frm_calc='1
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=35
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=35
prev=O5819
var_op='asgn
I
obj='Var
obj_type='M
pag=35
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=35
prev=O5808
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=35
prev=O5807
var_op='asgn
I
obj='Var
obj_type='N
pag=35
prev=O5806
var_op='asgn
I
obj='Var
obj_type='N
pag=35
prev=O5805
var_op='asgn
I
obj='Remark
pag=35
x=11
y=20
I
Icpitembatch.CPExec
check='man
frm_calc="// Create a buffer for reading the files
    byte[] buf = new byte[1024];
    
    try {
        // Create the ZIP file
        String outFilename = cNomeFileZip;
        java.util.zip.ZipOutputStream out = new java.util.zip.ZipOutputStream(new java.io.FileOutputStream(outFilename));
    
        // Compress the files
        for (int i=0; i<filenames.size(); i++) {
            _file1=(String)filenames.elementAt(i);
            _file2=(String)fileonames.elementAt(i);
            java.io.FileInputStream in = new java.io.FileInputStream(_file1);
    
            // Add ZIP entry to output stream.
            out.putNextEntry(new java.util.zip.ZipEntry(_file2));
    
            // Transfer bytes from the file to the ZIP file
            int len;
            while ((len = in.read(buf)) > 0) {
                out.write(buf, 0, len);
            }
    
            // Complete the entry
            out.closeEntry();
            in.close();
        }
    
        // Complete the ZIP file
        out.close();
        filenames.removeAllElements();
        fileonames.removeAllElements();
    } catch (java.io.IOException e) {
    }

°--°
obj='Exec
pag=36
x=10
y=20
I
]
ManualBlocks={
BO - Header
Icpmanualblocks.CPManualBlocks
code="import java.io.File; 
import java.lang.Double;
import java.util.*;
import jxl.*;
°--°
name='BO - Header
I
BO - Properties
Icpmanualblocks.CPManualBlocks
code="public String[] lista;
public int conteggio;
public int i;
public int contanome;
public int _i;
public int _y;
public int _righe;
public int _conta;
// These are the files to include in the ZIP file
Vector filenames = new Vector();
Vector fileonames = new Vector();
°--°
name='BO - Properties
I
}
comment='Importa i dati ( ZIP)
date_creat=#2006-06-20
date_rev=#2015-07-21
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'FileLibMit
'Utilities
'LibreriaMit
]
merge=True
modcnt=645
page_result_class=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
page_result_type=[
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
]
page_uid=[
'AHVZNXKOOX
'UKNWCURIZP
'VVERNPVGUJ
'NJDAPTIXHB
'NFQSTSMLAX
'RCTYUXDSQE
'CWXSSFAJKR
'VNWRBRKHOR
'LXYVCNDGXJ
'KBUDYHROVZ
'LYNZFJMARF
'BCDDIGVWEI
'NUVUGANGKH
'BCDBVDAIGN
'YWNGYQEOIM
'ODNUMZRUDM
'UQWVLYOUPO
'XYQTYCJDVF
'WPSSXVVPRN
'LCTYRIXNIR
'QFVUWDOVQJ
'EHJFKSDXAO
'KQLYCRCEND
'VWJMLMOSBD
'CRYCRJTMVP
'WXKLUXETTU
'TQQWCTNMUY
'WFXJLTAYZL
'JUYFDWZDHT
'FPPFVQERKU
'OSCWQGODLN
'XUCBNRIQJX
'YDIMCDDVVL
'KXSUXGSGRU
'BHPTSJZNZQ
'FSKQXUUBMA
]
pagename=[
'Page_1
'Page_2
'Page_3
'Page_4
'Page_5
'Page_6
'Page_7
'Page_8
'Page_9
'Page_10
'Page_11
'Page_12
'Page_13
'Page_14
'Page_15
'Page_16
'Page_17
'Page_18
'Page_19
'Page_20
'Page_21
'Page_22
'Page_23
'Page_24
'Page_25
'Page_26
'Page_27
'Page_28
'Page_29
'Page_30
'Page_31
'Page_32
'Page_33
'Page_34
'Page_35
'Page_36
]
pagenote=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
pagetitle=[
'Main
'Soggetti
'Rapporti
'Informazioni
'Operazioni
'Frazionate
'Rapporti Provvisorio
'Informazioni Provvisorio
'Operazioni Provvisorio
'Frazionarie Provvisorio
'Rapporti Agenzia Entrate
'Informazioni Agenzia Entrate
'Operazioni Agenzia Entrate
'Dipendenze
'Titolari Effettivi
'Operazioni extraconto
'Procuratori/delegati su rapporto
'Soggetti operanti
'Intestatari
'Procuratori/delegati su rapporto Provvisorio
'Soggetti operanti Provvisorio
'Intestatari Provvisorio
'Procuratori/delegati su rapporto Agenzia Entrate
'Soggetti operanti Agenzia Entrate
'Intestatari Agenzia Entrate
'Altri Intestatari Rapporti
'Estrai ZIP
'Altri Beneficiari Operazioni
'Altri Soggetti Operanti Operazioni
'Modifiche Soggetti
'Movimento per AGE
'Controllo Anagrafiche
'Saldi operazioni extraconto
'Saldi rapporti continuativi
'Altri Titolari Effettivi
'Crea File Zip
]
runtime_filters=2
tpl_name='Routine
work_file=[
'aeannora
'aeopcanc
'aeoprig
'aeopstor
'aetesta
'anadip
'anarapbo
'beneficfrz
'beneficope
'clientifrz
'clientiope
'cpwarn
'delegabo
'fraziobo
'intermbo
'intestbo
'intestit
'japopebo
'jelegabo
'jnarapbo
'jntestbo
'joginfo
'jogopebo
'jperazbo
'knarapbo
'meneficfrz
'meneficope
'merzistifrz
'merzistiope
'mlientifrz
'mlientiope
'mogopebo
'mogopefbo
'operazbo
'opextrbo
'personbo
'rapopebo
'rapotit
'soginfo
'sogopebo
'sogopefbo
'tbcauana
'tbcitta
'tbstgru
'tbvalute
'terzistifrz
'terzistiope
'titolabo
'titopers
'tmp_errimp
'tmp_list_imprich
'tmp_listafile
'wersonbo
'xapopebo
'xapotit
'xarchfraz
'xarchope
'xelegabo
'xeneficfrz
'xeneficope
'xersonbo
'xerzistifrz
'xerzistiope
'xlientifrz
'xlientiope
'xnadip
'xnarapbo
'xntestbo
'xntestit
'xoginfo
'xogopebo
'xogopefbo
'xperazbo
'xraziobo
]
work_filter=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
I
*--*
*----*
