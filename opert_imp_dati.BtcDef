* --- CodePainter Revolution Batch Vers. 5.1
￼Icpbatch.CPBatch
Items=[
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPBeginEnd
comment='Legge il file di testo (TXT o CSV) e scrive nel MC
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Cicla sul file temporaneo e se tutti i dati sono uguali salta il record
next=Icpitembatch.CPBeginEnd
comment='Cicla sul MC e scrive i dati
h=[
19
19
]
obj='Begin
pag=2
prev=O8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Log
father=O9
fatherSonIndex=0
frm_calc='gMsgProc + 'Inizio Import File alle ore '+arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
comment='Log
frm_calc='gMsgProc + 'Termine Import File alle ore '+arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Fine Elaborazione del file '+LRTrim(w_nomefile)+" alle ore "+arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Terminato Import Soggetti'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'cActLog='S'
]
h=[
19
19
]
obj='If
pag=2
prev=O19
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='bat
father=O20
fatherSonIndex=0
frm_calc='arrt_writelog('IMPORT','Soggetti',LRTrim(w_nomefile),gMsgProc)
obj='Exec
pag=2
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=2
prev=O18
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O17
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O15
var_op='asgn
I
obj='Try
pag=2
prev=O14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O15
fatherSonIndex=0
for_variable='rowSoggetti
for_variable_type='tmp_imp_sog
h=[
19
19
]
iterator_expr='mcSoggetti
next=Icpitembatch.CPVarDecl
comment='Log
frm_calc='gMsgProc + 'Sono stati importati '+LRTrim(Str(_rownum,10,0))+' Soggetti ...' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Import dei dati concluso con successo" + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=2
prev=O32
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O31
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O29
var_op='asgn
I
obj='ForEach
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O29
fatherSonIndex=0
frm_calc='''
len=10
name='xIDBASE
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='cCliProg
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(rowSoggetti.CODFISC))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(rowSoggetti.SESSO='M','1',iif(rowSoggetti.SESSO='F','2','0'))
len=1
name='xSesso
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(rowSoggetti.DATAIDENT),NullDate(),CharToDate(Right(rowSoggetti.DATAIDENT,4)+Substr(rowSoggetti.DATAIDENT,3,2)+Left(rowSoggetti.DATAIDENT,2)))
len=8
name='cData1
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(rowSoggetti.DATANASC),NullDate(),CharToDate(Right(rowSoggetti.DATANASC,4)+Substr(rowSoggetti.DATANASC,3,2)+Left(rowSoggetti.DATANASC,2)))
len=8
name='cData2
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(rowSoggetti.DATARETT),NullDate(),CharToDate(Right(rowSoggetti.DATARETT,4)+Substr(rowSoggetti.DATARETT,3,2)+Left(rowSoggetti.DATARETT,2)))
len=8
name='cData3
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(rowSoggetti.DATARILASC),NullDate(),CharToDate(Right(rowSoggetti.DATARILASC,4)+Substr(rowSoggetti.DATARILASC,3,2)+Left(rowSoggetti.DATARILASC,2)))
len=8
name='cData4
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(rowSoggetti.DATAVALI),NullDate(),CharToDate(Right(rowSoggetti.DATAVALI,4)+Substr(rowSoggetti.DATAVALI,3,2)+Left(rowSoggetti.DATAVALI,2)))
len=8
name='cData5
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='xPaese
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(rowSoggetti.SPECIE) and xSesso <> '0','PF',rowSoggetti.SPECIE)
len=4
name='_specie
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(rowSoggetti.PAESE)) = 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(rowSoggetti.AREAGEO)),rowSoggetti.AREAGEO,iif(xPaese='086',rowSoggetti.PROVINCIA,xPaese))
len=5
name='_area
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCliProg))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_rownum + 1
len=10
name='_rownum
next=Icpitembatch.CPInsert
arch='tmp_erroriimp
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Sono stati importati '+LRTrim(Str(_rownum,10,0))+' Soggetti ...'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=2
prev=O57
var_op='asgn
I
obj='Insert
pag=2
prev=O56
rd_kfield=[
'numriga
'errormsg
]
rd_kvar=[
'_rownum
''Inserito record '+ rowSoggetti.CODFISC
]
I
obj='Var
obj_type='N
pag=2
prev=O53
var_op='asgn
I
obj='If
pag=2
prev=O52
sons=[
Icpitembatch.CPItemSon
comment='Se il codice non c'è
instr=Icpitembatch.CPVarDecl
father=O53
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGCLIENTE\'"+LRTrim(gAzienda)+"'",'',6)
len=6
name='cCliProg
next=Icpitembatch.CPInsert
arch='personbo
obj='Insert
pag=2
prev=O63
rd_kfield=[
'IDBASE
'CONNES
'IDENT
'RAGSOC
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'CODFISC
'NASCOMUN
'TIPODOC
'NUMDOCUM
'AUTRILASC
'SESSO
'TIPINTER
'DATAIDENT
'DATANASC
'DATARILASC
'DATAVALI
'TIPOPERS
'PKTBSPECIE
'ATTIV
'COMPORT
'AREAGEO
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'RAPSEGNA
'PARTIVA
'PEP
'TIPOSOGGETTO
]
rd_kvar=[
'xIDBASE
'cCliProg
'LRTrim(rowSoggetti.TIPOIDEN)
'LRTrim(rowSoggetti.RAGSOC)
'xPaese
'LRTrim(rowSoggetti.DESCCIT)
'LRTrim(rowSoggetti.PROVINCIA)
'LRTrim(rowSoggetti.DOMICILIO)
'rowSoggetti.CAP
'LRTrim(rowSoggetti.CODFISC)
'LRTrim(rowSoggetti.NASCOMUN)
'rowSoggetti.TIPODOC
'rowSoggetti.NUMDOCUM
'rowSoggetti.AUTRILASC
'xSesso
'rowSoggetti.PROVNASC
'cData1
'cData2
'cData4
'cData5
'iif(xSesso='1' or xSesso='2','F','G')
'_specie
'rowSoggetti.ATTIV
'rowSoggetti.COMPORT
'LRTrim(_area)
'rowSoggetti.RNATGIU
'rowSoggetti.RATTIV
'rowSoggetti.RCOMP
'rowSoggetti.RAREA
'rowSoggetti.RAPSEGNA
'rowSoggetti.PIVA
'rowSoggetti.PEP
'rowSoggetti.TIPSOG
]
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='Verifica se ci sono modifiche
instr=Icpitembatch.CPVarDecl
father=O53
fatherSonIndex=1
frm_calc='0
len=1
name='bModifica
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'bModifica = 1
]
h=[
19
19
]
obj='If
pag=2
prev=O69
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O71
fatherSonIndex=0
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
len=8
name='_datarett
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='personbo
obj='Write
pag=2
prev=O80
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'cCliProg
]
wr_field=[
'IDENT
'DATAIDENT
'RAGSOC
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'CODFISC
'DATANASC
'NASCOMUN
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'SESSO
'DATAVALI
'TIPINTER
'TIPOPERS
'PKTBSPECIE
'ATTIV
'COMPORT
'AREAGEO
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'RAPSEGNA
'PARTIVA
'PEP
'TIPOSOGGETTO
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(rowSoggetti.TIPOIDEN)
'cData1
'rowSoggetti.RAGSOC
'xPaese
'LRTrim(rowSoggetti.DESCCIT)
'rowSoggetti.PROVINCIA
'LRTrim(rowSoggetti.DOMICILIO)
'rowSoggetti.CAP
'LRTrim(rowSoggetti.CODFISC)
'cData2
'LRTrim(rowSoggetti.NASCOMUN)
'rowSoggetti.TIPODOC
'rowSoggetti.NUMDOCUM
'cData4
'rowSoggetti.AUTRILASC
'xSesso
'cData5
'rowSoggetti.PROVNASC
'iif(xSesso='1' or xSesso='2','F','G')
'_specie
'rowSoggetti.ATTIV
'rowSoggetti.COMPORT
'LRTrim(_area)
'rowSoggetti.RNATGIU
'rowSoggetti.RATTIV
'rowSoggetti.RCOMP
'rowSoggetti.RAREA
'rowSoggetti.RAPSEGNA
'rowSoggetti.PIVA
'rowSoggetti.PEP
'rowSoggetti.TIPSOG
]
I
obj='If
pag=2
prev=O78
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O80
fatherSonIndex=0
frm_calc='Calcola il progressivo di registrazione
next=Icpitembatch.CPVarDecl
frm_calc='nProgSto + 1
len=15
name='nProgSto
next=Icpitembatch.CPVarDecl
frm_calc='Right('000000000000000'+LRTrim(Str(nProgSto,15,0)),15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=2
prev=O94
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=cCliProg
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O95
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'datamodi
'sanumpro
'CAUSALE
'CODLEGRAP
'DATAFINE
'DATAIDENT
'DATAINI
'DATARAUT
'DISATTIVO
'FATTURATO
'FLGNOTRIM
'FREQUENZA
'IMPORTOMAX
'NUMOPERAZ
'RAPSEGNA
'SOGAFFIDATARIO
'TIPOSOGGETTO
'ALLINEATO
'ALLINEATONOMECNOME
'ALTROCAP
'ALTRODOM
'AREAGEO
'ATTIV
'AUTRILASC
'BANCABEN
'CAP
'CFESTERO
'CITTADIN1
'CITTADIN2
'CODCAB
'CODDIPE
'CODFISC
'CODINTER
'CODORO
'COGNOME
'COMPORT
'CRIME
'CRIMEDATE
'DAC6
'DATANASC
'DATAPROF
'DATAREVPROF
'DATARILASC
'DATASEGN
'DATAVALI
'DATEXTRA
'DESCCIT
'DOCFILE
'DOMICILIO
'FATCA
'FLAGDAC6
'FLGVALIDO
'IDBASE
'idcitta
'IDENT
'IDFILE
'IDNASCOMUN
'IDNASSTATO
'MACROAGENTE
'MITIG
'MITGDOC
'NASCOMUN
'NASSTATO
'NOME
'NOSARA
'NOTE
'NOTIT
'NUMDOCUM
'ODB
'OLDCODFISC
'OLDCONNES
'OLDSETSIN
'PAESE
'PARTIVA
'PEP
'PEPDATE
'PKTBSPECIE
'PROGIMP_C
'PROGIMPORT
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RESFISC
'RISGLOB
'RNATGIU
'SESSO
'SETTSINT
'SETTSINT2
'SOSPMAF
'SOTGRUP
'SPOTID
'TELEF
'TIN
'TIPINTER
'TIPODOC
'TIPOORO
'TIPOPERS
'CONNES
]
rd_kvar=[
'_datarett
'cProgSto
'personbo->CAUSALE
'personbo->CODLEGRAP
'personbo->DATAFINE
'personbo->DATAIDENT
'personbo->DATAINI
'personbo->DATARAUT
'personbo->DISATTIVO
'personbo->FATTURATO
'personbo->FLGNOTRIM
'personbo->FREQUENZA
'personbo->IMPORTOMAX
'personbo->NUMOPERAZ
'personbo->RAPSEGNA
'personbo->SOGAFFIDATARIO
'personbo->TIPOSOGGETTO
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->ALTROCAP
'personbo->ALTRODOM
'personbo->AREAGEO
'personbo->ATTIV
'personbo->AUTRILASC
'personbo->BANCABEN
'personbo->CAP
'personbo->CFESTERO
'personbo->CITTADIN1
'personbo->CITTADIN2
'personbo->CODCAB
'personbo->CODDIPE
'personbo->CODFISC
'personbo->CODINTER
'personbo->CODORO
'personbo->COGNOME
'personbo->COMPORT
'personbo->CRIME
'personbo->CRIMEDATE
'personbo->DAC6
'personbo->DATANASC
'personbo->DATAPROF
'personbo->DATAREVPROF
'personbo->DATARILASC
'personbo->DATASEGN
'personbo->DATAVALI
'personbo->DATEXTRA
'personbo->DESCCIT
'personbo->DOCFILE
'personbo->DOMICILIO
'personbo->FATCA
'personbo->FLAGDAC6
'personbo->FLGVALIDO
'personbo->IDBASE
'personbo->idcitta
'personbo->IDENT
'personbo->IDFILE
'personbo->IDNASCOMUN
'personbo->IDNASSTATO
'personbo->MACROAGENTE
'personbo->MITIG
'personbo->MITIGDOC
'personbo->NASCOMUN
'personbo->NASSTATO
'personbo->NOME
'personbo->NOSARA
'personbo->NOTE
'personbo->NOTIT
'personbo->NUMDOCUM
'personbo->ODB
'personbo->OLDCODFISC
'personbo->OLDCONNES
'personbo->OLDSETSIN
'personbo->PAESE
'personbo->PARTIVA
'personbo->PEP
'personbo->PEPDATE
'personbo->PKTBSPECIE
'personbo->PROGIMP_C
'personbo->PROGIMPORT
'personbo->PROVINCIA
'personbo->RAGSOC
'personbo->RAGSOCOLD
'personbo->RAMOGRUP
'personbo->RAREA
'personbo->RATTIV
'personbo->RCOMP
'personbo->RESFISC
'personbo->RISGLOB
'personbo->RNATGIU
'personbo->SESSO
'personbo->SETTSINT
'personbo->SETTSINT2
'personbo->SOSPMAF
'personbo->SOTGRUP
'personbo->SPOTID
'personbo->TELEF
'personbo->TIN
'personbo->TIPINTER
'personbo->TIPODOC
'personbo->TIPOORO
'personbo->TIPOPERS
'cCliProg
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O93
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O92
var_op='asgn
I
obj='Remark
pag=2
I
I
]
w=[
150
150
]
I
obj='Select
pag=2
prev=O77
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=cCliProg and wersonbo->datamodi=_datarett
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O78
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='D
pag=2
prev=O76
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=2
prev=O68
sel_field='*
sel_name='personbo
sel_where='personbo->CODFISC=rowSoggetti.CODFISC and (personbo->STATOREG='0' or personbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
comment='Verifica se ci sono stati ei dati modificati
instr=Icpitembatch.CPVarDecl
father=O69
fatherSonIndex=0
frm_calc='personbo->CONNES
len=6
name='cCliProg
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(personbo->AUTRILASC) <> LRTrim(rowSoggetti.AUTRILASC)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(personbo->CAP) <> LRTrim(rowSoggetti.CAP)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(personbo->CODFISC) <> LRTrim(rowSoggetti.CODFISC)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'personbo->DATAIDENT <> CharToDate(rowSoggetti.DATAIDENT)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'personbo->DATANASC <> CharToDate(rowSoggetti.DATANASC)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'personbo->DATARILASC <> CharToDate(rowSoggetti.DATARILASC)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'personbo->DATAVALI <> CharToDate(rowSoggetti.DATAVALI)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(personbo->DESCCIT) <> LRTrim(rowSoggetti.DESCCIT)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(personbo->DOMICILIO) <> LRTrim(rowSoggetti.DOMICILIO)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(personbo->NASCOMUN) <> LRTrim(rowSoggetti.NASCOMUN)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(personbo->NUMDOCUM) <> LRTrim(rowSoggetti.NUMDOCUM)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(personbo->PAESE) <> LRTrim(rowSoggetti.PAESE)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(personbo->PROVINCIA) <> LRTrim(rowSoggetti.PROVINCIA)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(personbo->TIPINTER) <> LRTrim(rowSoggetti.PROVNASC)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(personbo->RAGSOC) <> LRTrim(rowSoggetti.RAGSOC)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'personbo->SESSO <> xSesso
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(personbo->TIPODOC) <> LRTrim(rowSoggetti.TIPODOC)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(personbo->IDENT) <> LRTrim(rowSoggetti.TIPOIDEN)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'personbo->PKTBSPECIE <> _specie
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'personbo->PARTIVA <> rowSoggetti.PIVA
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'personbo->PEP <> rowSoggetti.PEP
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'personbo->TIPOSOGGETTO <> rowSoggetti.TIPSOG
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'personbo->RAPSEGNA <> rowSoggetti.RAPSEGNA
]
h=[
19
19
]
obj='If
pag=2
prev=O175
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O178
fatherSonIndex=0
frm_calc='1
len=1
name='bModifica
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O172
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O175
fatherSonIndex=0
frm_calc='1
len=1
name='bModifica
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O169
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O172
fatherSonIndex=0
frm_calc='1
len=1
name='bModifica
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O166
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O169
fatherSonIndex=0
frm_calc='1
len=1
name='bModifica
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O163
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O166
fatherSonIndex=0
frm_calc='1
len=1
name='bModifica
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O160
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O163
fatherSonIndex=0
frm_calc='1
len=1
name='bModifica
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O157
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O160
fatherSonIndex=0
frm_calc='1
len=1
name='bModifica
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O154
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O157
fatherSonIndex=0
frm_calc='1
len=1
name='bModifica
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O151
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O154
fatherSonIndex=0
frm_calc='1
len=1
name='bModifica
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O148
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O151
fatherSonIndex=0
frm_calc='1
len=1
name='bModifica
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O145
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O148
fatherSonIndex=0
frm_calc='1
len=1
name='bModifica
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O142
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O145
fatherSonIndex=0
frm_calc='1
len=1
name='bModifica
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O139
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O142
fatherSonIndex=0
frm_calc='1
len=1
name='bModifica
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O136
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O139
fatherSonIndex=0
frm_calc='1
len=1
name='bModifica
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O133
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O136
fatherSonIndex=0
frm_calc='1
len=1
name='bModifica
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O130
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O133
fatherSonIndex=0
frm_calc='1
len=1
name='bModifica
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O127
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O130
fatherSonIndex=0
frm_calc='1
len=1
name='bModifica
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O124
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O127
fatherSonIndex=0
frm_calc='1
len=1
name='bModifica
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O121
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O124
fatherSonIndex=0
frm_calc='1
len=1
name='bModifica
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O118
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O121
fatherSonIndex=0
frm_calc='1
len=1
name='bModifica
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O115
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O118
fatherSonIndex=0
frm_calc='1
len=1
name='bModifica
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O112
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O115
fatherSonIndex=0
frm_calc='1
len=1
name='bModifica
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O111
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O112
fatherSonIndex=0
frm_calc='1
len=1
name='bModifica
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O49
var_op='asgn
I
obj='If
pag=2
prev=O48
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O49
fatherSonIndex=0
obj='Read
pag=2
rd_field=[
'PKTBSTATI
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'rowSoggetti.DESCCIT
]
rd_var=[
'xPaese
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbstati
father=O49
fatherSonIndex=1
obj='Read
pag=2
rd_field=[
'CODSTA
]
rd_kfield=[
'DESCRI
]
rd_kvar=[
'rowSoggetti.PAESE
]
rd_var=[
'xPaese
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O47
var_op='asgn
I
obj='Var
pag=2
prev=O46
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O45
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O44
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O43
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O42
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O41
var_op='asgn
I
obj='Var
pag=2
prev=O38
var_op='asgn
I
obj='If
pag=2
prev=O37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O38
fatherSonIndex=0
obj='Read
pag=2
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'LRTrim(rowSoggetti.CODFISC)
]
rd_var=[
'cCliProg
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O36
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O15
fatherSonIndex=1
frm_calc=''KO'
name='cRitorno
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Errore nell'import definitivo dei dati: "+ NL + m_cLastMsgError + NL
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='rollback
obj='Transaction
pag=2
prev=O300
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O299
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=2
prev=O13
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=2
prev=O6
I
obj='Begin
pag=2
prev=O5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Log
father=O6
fatherSonIndex=0
frm_calc='gMsgProc + 'Inizio Controllo File alle ore '+arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipoform = 'C'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Log
frm_calc='gMsgProc + 'Sono stati controllati '+LRTrim(Str(_rownum,10,0))+' Soggetti ...' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Log
frm_calc='gMsgProc + 'Termine Controllo File alle ore '+arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Terminato Controllo Soggetti'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=2
prev=O311
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O310
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O307
var_op='asgn
I
obj='If
pag=2
prev=O306
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O307
fatherSonIndex=0
frm_calc='-1
len=10
name='_rownum
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+"/"+LRTrim(w_nomefile)
len=80
name='filename
next=Icpitembatch.CPExec
check='man
frm_calc='FileReader freader=new FileReader(filename);﷯CSVReader reader = new CSVReader(freader);﷯String [] nextLine;﷯while ((nextLine = reader.readNext()) != null) {
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Sono stati controllati '+LRTrim(Str(_rownum,10,0))+' Soggetti ...'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPExec
check='man
frm_calc='}﷯// Chiuse il file﷯reader.close();
obj='Exec
pag=2
prev=O320
I
nonlocal=True
obj='Var
pag=2
prev=O318
var_op='asgn
I
obj='Try
pag=2
prev=O317
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O318
fatherSonIndex=0
frm_calc=[
'_rownum >= 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_rownum + 1
len=10
name='_rownum
obj='Var
obj_type='N
pag=2
prev=O324
var_op='asgn
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O324
fatherSonIndex=0
frm_seek='AppendBlank
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[0]
frm_seek='TIPOOPER
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[1]
frm_seek='CODSTUDIO
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[2]
frm_seek='TIPOIDEN
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[3]
frm_seek='CONNES
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[4]
frm_seek='DATAIDENT
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[5]
frm_seek='RAGSOC
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[6]
frm_seek='PAESE
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[7]
frm_seek='DESCCIT
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[8]
frm_seek='PROVINCIA
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[9]
frm_seek='DOMICILIO
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[10]
frm_seek='CAP
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[11]
frm_seek='CODFISC
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[12]
frm_seek='DATANASC
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[13]
frm_seek='NASCOMUN
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[14]
frm_seek='TIPODOC
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[15]
frm_seek='NUMDOCUM
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[16]
frm_seek='DATARILASC
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[17]
frm_seek='AUTRILASC
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[18]
frm_seek='SESSO
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[19]
frm_seek='STATOREG
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[20]
frm_seek='DATARETT
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[21]
frm_seek='DATAVALI
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[22]
frm_seek='PROVNASC
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[23]
frm_seek='RESPINS
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[24]
frm_seek='CODCLI
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[25]
frm_seek='SPECIE
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[26]
frm_seek='COMPORT
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[27]
frm_seek='ATTIV
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[28]
frm_seek='AREAGEO
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Val(nextLine[29])
frm_seek='RNATGIU
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Val(nextLine[30])
frm_seek='RCOMP
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Val(nextLine[31])
frm_seek='RATTIV
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Val(nextLine[32])
frm_seek='RAREA
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[33]
frm_seek='RAPSEGNA
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[34]
frm_seek='PIVA
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[35]
frm_seek='PEP
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[36]
frm_seek='TIPSOG
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcSoggetti
obj='Var
obj_type='MC
pag=2
prev=O367
var_op='meth
I
obj='Var
obj_type='MC
pag=2
prev=O366
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O365
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O364
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O363
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O362
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O361
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O360
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O359
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O358
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O357
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O356
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O355
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O354
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O353
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O352
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O351
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O350
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O349
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O348
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O347
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O346
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O345
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O344
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O343
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O342
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O341
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O340
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O339
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O338
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O337
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O336
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O335
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O334
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O333
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O332
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O331
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O330
var_op='prop
I
obj='Var
obj_type='MC
pag=2
var_op='meth
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O318
fatherSonIndex=1
frm_calc='gMsgProc + 'Errore alla Riga Numero: '+LRTrim(Str(_rownum,10,0)) + " " + m_cLastMsgError + NL
len=10
name='gMsgProc
next=Icpitembatch.CPInsert
arch='tmp_erroriimp
next=Icpitembatch.CPTransaction
frm_calc='accept error
obj='Transaction
pag=2
prev=O372
I
obj='Insert
pag=2
prev=O371
rd_kfield=[
'numriga
'errormsg
]
rd_kvar=[
'_rownum
'm_cLastMsgError
]
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=2
prev=O316
I
obj='Var
pag=2
prev=O315
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O307
fatherSonIndex=1
frm_calc='FileLibrary.OpenRead('./appo/'+LRTrim(w_nomefile))
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibrary.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibrary.Close(fhand)
obj='Exec
pag=2
prev=O379
I
obj='While
pag=2
prev=O378
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O379
fatherSonIndex=0
frm_calc='FileLibrary.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Sono stati controllati '+LRTrim(Str(_rownum,10,0))+' Soggetti ...'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=2
prev=O385
var_op='asgn
I
obj='Try
pag=2
prev=O384
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O385
fatherSonIndex=0
frm_calc=[
'_rownum > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_rownum + 1
len=10
name='_rownum
obj='Var
obj_type='N
pag=2
prev=O390
var_op='asgn
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O390
fatherSonIndex=0
frm_seek='AppendBlank
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Left(riga,2)
frm_seek='TIPOOPER
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,3,11)
frm_seek='CODSTUDIO
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,14,2)
frm_seek='TIPOIDEN
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,16,6)
frm_seek='CONNES
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,22,8)
frm_seek='DATAIDENT
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,30,70)
frm_seek='RAGSOC
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,100,30)
frm_seek='PAESE
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,130,30)
frm_seek='DESCCIT
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,160,15)
frm_seek='PROVINCIA
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,175,35)
frm_seek='DOMICILIO
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,210,5)
frm_seek='CAP
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,215,16)
frm_seek='CODFISC
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,231,8)
frm_seek='DATANASC
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,239,30)
frm_seek='NASCOMUN
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,269,2)
frm_seek='TIPODOC
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,271,15)
frm_seek='NUMDOCUM
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,286,8)
frm_seek='DATARILASC
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,295,30)
frm_seek='AUTRILASC
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,325,1)
frm_seek='SESSO
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,326,1)
frm_seek='STATOREG
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,327,8)
frm_seek='DATARETT
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,335,8)
frm_seek='DATAVALI
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,342,2)
frm_seek='PROVNASC
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,343,30)
frm_seek='RESPINS
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,374,6)
frm_seek='CODCLI
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,380,4)
frm_seek='SPECIE
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,384,5)
frm_seek='COMPORT
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,389,10)
frm_seek='ATTIV
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,399,5)
frm_seek='AREAGEO
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Val(Substr(riga,404,3))
frm_seek='RNATGIU
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Val(Substr(riga,407,3))
frm_seek='RCOMP
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Val(Substr(riga,410,3))
frm_seek='RATTIV
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Val(Substr(riga,413,3))
frm_seek='RAREA
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,416,1)
frm_seek='RAPSEGNA
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,417,11)
frm_seek='PIVA
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,428,1)
frm_seek='PEP
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,429,1)
frm_seek='TIPSOG
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcSoggetti
obj='Var
obj_type='MC
pag=2
prev=O433
var_op='meth
I
obj='Var
obj_type='MC
pag=2
prev=O432
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O431
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O430
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O429
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O428
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O427
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O426
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O425
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O424
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O423
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O422
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O421
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O420
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O419
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O418
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O417
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O416
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O415
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O414
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O413
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O412
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O411
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O410
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O409
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O408
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O407
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O406
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O405
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O404
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O403
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O402
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O401
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O400
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O399
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O398
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O397
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O396
var_op='prop
I
obj='Var
obj_type='MC
pag=2
var_op='meth
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O385
fatherSonIndex=1
frm_calc='gMsgProc + 'Riga Numero: '+LRTrim(Str(_rownum,10,0)) + " " + m_cLastMsgError + NL
len=10
name='gMsgProc
next=Icpitembatch.CPInsert
arch='tmp_erroriimp
next=Icpitembatch.CPTransaction
frm_calc='accept error
obj='Transaction
pag=2
prev=O438
I
obj='Insert
pag=2
prev=O437
rd_kfield=[
'numriga
'errormsg
]
rd_kvar=[
'_rownum
'm_cLastMsgError
]
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=2
prev=O4
I
obj='Var
obj_type='N
pag=2
prev=O3
var_op='asgn
I
obj='Remark
pag=2
x=15
y=22
I
Icpitembatch.CPRemark
frm_calc='Import Operazioni
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Inizio Importazione Operazioni ...'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcContante
next=Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPBeginEnd
comment='Legge il file di test (CSV o TXT) e mette i dati nel MC
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Cicla sul file transitorio e scrive i record
next=Icpitembatch.CPBeginEnd
comment='Cicla sul MC e scrive
h=[
19
19
]
obj='Begin
pag=3
prev=O453
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O454
fatherSonIndex=0
frm_calc='0
len=10
name='_rownum
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_errrow
next=Icpitembatch.CPVarDecl
comment='Log
frm_calc='gMsgProc + 'Inizio Import File alle ore '+arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'pScheduler='S'
]
h=[
19
19
]
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
comment='Log
frm_calc='gMsgProc + 'Termine Import File alle ore '+arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Fine Elaborazione del file '+LRTrim(w_nomefile)+" alle ore "+arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'pScheduler='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Terminato Import Operazioni'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'cActLog='S'
]
h=[
19
19
]
obj='If
pag=3
prev=O472
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='bat
father=O473
fatherSonIndex=0
frm_calc='arrt_writelog('IMPORT','Prestazioni/O',LRTrim(w_nomefile),gMsgProc)
obj='Exec
pag=3
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=3
prev=O469
var_op='asgn
I
obj='If
pag=3
prev=O468
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Log
father=O469
fatherSonIndex=0
frm_calc='_logmsg + 'Termine Import File alle ore '+arfn_fdatetime(DateTime()) + "<br>"
len=10
name='_logmsg
next=Icpitembatch.CPVarDecl
frm_calc='_logmsg + 'Fine Elaborazione del file '+LRTrim(w_nomefile)+" alle ore "+arfn_fdatetime(DateTime()) + "<br>"
len=10
name='_logmsg
obj='Var
obj_type='M
pag=3
prev=O482
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O467
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O465
var_op='asgn
I
obj='Try
pag=3
prev=O464
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O465
fatherSonIndex=0
frm_calc='''
len=7
name='xRif
next=Icpitembatch.CPForEach
for_variable='rowOperazioni
for_variable_type='tmp_imp_oper
h=[
19
19
]
iterator_expr='mcOperazioni
next=Icpitembatch.CPTransaction
frm_calc='commit
next=Icpitembatch.CPVarDecl
comment='Log
frm_calc='gMsgProc + 'Sono state importate '+LRTrim(Str(_rownum,10,0))+' Operazioni ...' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Log
frm_calc='gMsgProc + 'Sono state scartate '+LRTrim(Str(_errrow,10,0))+' Operazioni ...' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Import definitivo dei dati concluso con successo" + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'pScheduler='S'
]
h=[
19
19
]
obj='If
pag=3
prev=O493
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Log
father=O494
fatherSonIndex=0
frm_calc='_logmsg + 'Sono state importate '+LRTrim(Str(_rownum,10,0))+' Operazioni ...' + "<br>"
len=10
name='_logmsg
next=Icpitembatch.CPVarDecl
comment='Log
frm_calc='_logmsg + 'Sono state scartate '+LRTrim(Str(_errrow,10,0))+' Operazioni ...' + "<br>"
len=10
name='_logmsg
next=Icpitembatch.CPVarDecl
frm_calc='_logmsg + "Import definitivo dei dati concluso con successo" + "<br>"
len=10
name='_logmsg
obj='Var
obj_type='M
pag=3
prev=O500
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O499
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O492
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O491
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O490
var_op='asgn
I
obj='Transaction
pag=3
prev=O488
I
obj='ForEach
pag=3
prev=O487
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Controlla che non esista già la prestazione
father=O488
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xIDBASE)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O505
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O507
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='0
len=5
name='_cauint
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='_cauaui
next=Icpitembatch.CPVarDecl
frm_calc='''
len=50
name='_finalita
next=Icpitembatch.CPVarDecl
frm_calc='0
len=3
name='_caurischio
next=Icpitembatch.CPRemark
frm_calc='Trasforma le date
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(rowOperazioni.DATAOPE),NullDate(),CharToDate(Right(rowOperazioni.DATAOPE,4)+Substr(rowOperazioni.DATAOPE,3,2)+Left(rowOperazioni.DATAOPE,2)))
len=8
name='cData1
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(rowOperazioni.DATAREG),NullDate(),CharToDate(Right(rowOperazioni.DATAREG,4)+Substr(rowOperazioni.DATAREG,3,2)+Left(rowOperazioni.DATAREG,2)))
len=8
name='cData2
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(rowOperazioni.DATARETT),NullDate(),CharToDate(Right(rowOperazioni.DATARETT,4)+Substr(rowOperazioni.DATARETT,3,2)+Left(rowOperazioni.DATARETT,2)))
len=8
name='cData3
next=Icpitembatch.CPRemark
frm_calc='Legge la valuta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='cValuta
next=Icpitembatch.CPForEach
for_variable='rowValuta
for_variable_type='tbvalute
h=[
19
19
]
iterator_expr='mcTBVALUTE
next=Icpitembatch.CPVarDecl
frm_calc='''
len=7
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=7
name='cCli2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=7
name='cCli3
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(rowOperazioni.CONNESCLI)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(rowOperazioni.CONNESREAL)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(rowOperazioni.CONNESBEN)))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifica il tipo di operazione
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cCli1)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Sono state importate '+LRTrim(Str(_rownum,10,0))+' Operazioni ...'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=3
prev=O540
var_op='asgn
I
obj='If
pag=3
prev=O539
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O540
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPOPER\'"+LRTrim(gAzienda)+"'",0,10)
len=10
name='_imperr
next=Icpitembatch.CPInsert
arch='scarti_import
next=Icpitembatch.CPVarDecl
frm_calc='_errrow + 1
len=10
name='_errrow
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Sono state scartate '+LRTrim(Str(_rownum,10,0))+' Operazioni ...'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=3
prev=O548
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O547
var_op='asgn
I
obj='Insert
pag=3
prev=O546
rd_kfield=[
'IMPPROG
'TIPOOPER
'CODSTUDIO
'CODDIPE
'NUMPROG
'DATAOPE
'FLAGFRAZ
'CAUOPER
'CONNESCLI
'CONNESREAL
'CONNESBEN
'DATAREG
'STATOREG
'DATARETT
'VALUTA
'IMPORTO
'CONTANTI
'MEZPAG
'PRESTAZ
'POSIZ
'RAGIO
'MODSVOL
'AREAGEO
'TIPO
'AMMONT
'DURAT
'RAREA
'RRAGIO
'RCOMP
'RTIPO
'RFREQ
'RIMP
'CODABI
'CODCAB
'CONNALTRO
'IMPPROG13
'DESPUNTO
'TXTERR
]
rd_kvar=[
'_imperr
'rowOperazioni.TIPOOPER
'rowOperazioni.CODSTUDIO
'rowOperazioni.CODDIPE
'rowOperazioni.NUMPROG
'rowOperazioni.DATAOPE
'rowOperazioni.FLAGFRAZ
'rowOperazioni.CAUOPER
'rowOperazioni.CONNESCLI
'rowOperazioni.CONNESREAL
'rowOperazioni.CONNESBEN
'rowOperazioni.DATAREG
'rowOperazioni.STATOREG
'rowOperazioni.DATARETT
'rowOperazioni.VALUTA
'rowOperazioni.IMPORTO
'rowOperazioni.CONTANTI
'rowOperazioni.MEZPAG
'rowOperazioni.PRESTAZ
'rowOperazioni.POSIZ
'rowOperazioni.RAGIO
'rowOperazioni.MODSVOL
'rowOperazioni.AREAGEO
'rowOperazioni.TIPO
'rowOperazioni.AMMONT
'rowOperazioni.DURAT
'rowOperazioni.RAREA
'rowOperazioni.RRAGIO
'rowOperazioni.RCOMP
'rowOperazioni.RTIPO
'rowOperazioni.RFREQ
'rowOperazioni.RIMP
'rowOperazioni.CODABI
'rowOperazioni.CODCAB
'rowOperazioni.CONNALTRO
'rowOperazioni.IMPPROG
'rowOperazioni.DESPUNTO
''Cliente non rilevato'
]
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O540
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_rownum + 1
len=10
name='_rownum
obj='Var
obj_type='N
pag=3
prev=O554
var_op='asgn
I
obj='If
pag=3
prev=O553
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O554
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PPOPER2\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='xIDBASE
next=Icpitembatch.CPInsert
arch='xperazbo
obj='Insert
pag=3
prev=O560
rd_kfield=[
'AMMONT
'AREAGEO
'CODANA
'CODDIPE
'CODINTER
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAOPE
'DATAREG
'DATARETT
'DESPUNTO
'DURAT
'FLAGCONT
'FLAGFRAZ
'IDBASE
'IMPPROG
'MEZPAG
'MODSVOL
'NOTE
'NUMPROG
'PRESTAZ
'RAGIO
'RAREA
'RCOMP
'RFREQ
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'STATOREG
'TIPO
'TIPOINTER
'TOTCONT
'TOTLIRE
'VALUTA
'PRGIMPOPE
'TIPOOPRAP
]
rd_kvar=[
'rowOperazioni.AMMONT
'rowOperazioni.AREAGEO
'_cauaui
'rowOperazioni.CODDIPE
'iif(Empty(rowOperazioni.CODSTUDIO),LRTrim(_cfinter),rowOperazioni.CODSTUDIO)
'cCli3
'cCli1
'cCli2
'cData1
'cData2
'cData3
'rowOperazioni.DESPUNTO
'rowOperazioni.DURAT
'iif(rowOperazioni.CONTANTI>0,'S,','N')
'rowOperazioni.FLAGFRAZ
'xIDBASE
'LRTrim(rowOperazioni.IMPPROG)
'w_PAGMEZ
'rowOperazioni.MODSVOL
''N° Pratica '+LRTrim(rowOperazioni.IMPPROG)
'cOpePrg
'rowOperazioni.PRESTAZ
'rowOperazioni.RAGIO
'rowOperazioni.RAREA
'rowOperazioni.RCOMP
'rowOperazioni.RFREQ
'rowOperazioni.RIMP
'rowOperazioni.RRAGIO
'rowOperazioni.RTIPO
'_finalita
'rowOperazioni.STATOREG
'rowOperazioni.TIPO
'gTipInter
'rowOperazioni.CONTANTI*100
'rowOperazioni.IMPORTO*100
'cValuta
'nProgImp
''10'
]
I
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O554
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='xIDBASE
next=Icpitembatch.CPInsert
arch='operazbo
obj='Insert
pag=3
prev=O565
rd_kfield=[
'AMMONT
'AREAGEO
'CODANA
'CODDIPE
'CODINTER
'CONNESBEN
'CONNESCLI
'CONNESOPER
'TOTCONT
'DATAOPE
'DATAREG
'DATARETT
'DESPUNTO
'DURAT
'FLAGCONT
'FLAGFRAZ
'IDBASE
'TOTLIRE
'IMPPROG
'MEZPAG
'MODSVOL
'NOTE
'NUMPROG
'PRESTAZ
'RAGIO
'RAREA
'RCOMP
'RFREQ
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'STATOREG
'TIPO
'TIPOINTER
'VALUTA
'PRGIMPOPE
'TIPOOPRAP
]
rd_kvar=[
'rowOperazioni.AMMONT
'rowOperazioni.AREAGEO
'_cauaui
'rowOperazioni.CODDIPE
'iif(Empty(rowOperazioni.CODSTUDIO),LRTrim(_cfinter),rowOperazioni.CODSTUDIO)
'cCli3
'cCli1
'cCli2
'rowOperazioni.CONTANTI*100
'cData1
'cData2
'cData3
'rowOperazioni.DESPUNTO
'rowOperazioni.DURAT
'iif(rowOperazioni.CONTANTI>0,'S,','N')
'rowOperazioni.FLAGFRAZ
'xIDBASE
'rowOperazioni.IMPORTO*100
'LRTrim(rowOperazioni.IMPPROG)
'w_PAGMEZ
'rowOperazioni.MODSVOL
''N° Pratica '+LRTrim(rowOperazioni.IMPPROG)
'cOpePrg
'rowOperazioni.PRESTAZ
'rowOperazioni.RAGIO
'rowOperazioni.RAREA
'rowOperazioni.RCOMP
'rowOperazioni.RFREQ
'rowOperazioni.RIMP
'rowOperazioni.RRAGIO
'rowOperazioni.RTIPO
'_finalita
'rowOperazioni.STATOREG
'rowOperazioni.TIPO
'gTipInter
'cValuta
'nProgImp
''10'
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=3
prev=O536
I
obj='If
pag=3
prev=O533
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O536
fatherSonIndex=0
frm_calc='''
len=16
name='_clinew
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rowOperazioni.CONNESBEN)
len=16
name='_cliente
next=Icpitembatch.CPVarDecl
frm_calc='rowOperazioni.CAUOPER
len=4
name='_cautmp
next=Icpitembatch.CPVarDecl
frm_calc=''N'
len=1
name='_flgcau
next=Icpitembatch.CPExec
check='page
frm_calc='6
next=Icpitembatch.CPVarDecl
frm_calc='_clinew
len=7
name='cCli3
obj='Var
pag=3
prev=O577
var_op='asgn
I
obj='Exec
pag=3
prev=O576
I
obj='Var
pag=3
prev=O575
var_op='asgn
I
obj='Var
pag=3
prev=O574
var_op='asgn
I
obj='Var
pag=3
prev=O573
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O530
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O533
fatherSonIndex=0
frm_calc='''
len=16
name='_clinew
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rowOperazioni.CONNESREAL)
len=16
name='_cliente
next=Icpitembatch.CPVarDecl
frm_calc='rowOperazioni.CAUOPER
len=4
name='_cautmp
next=Icpitembatch.CPVarDecl
frm_calc=''N'
len=1
name='_flgcau
next=Icpitembatch.CPExec
check='page
frm_calc='6
next=Icpitembatch.CPVarDecl
frm_calc='_clinew
len=7
name='cCli2
obj='Var
pag=3
prev=O586
var_op='asgn
I
obj='Exec
pag=3
prev=O585
I
obj='Var
pag=3
prev=O584
var_op='asgn
I
obj='Var
pag=3
prev=O583
var_op='asgn
I
obj='Var
pag=3
prev=O582
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O529
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O530
fatherSonIndex=0
frm_calc='''
len=16
name='_clinew
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rowOperazioni.CONNESCLI)
len=16
name='_cliente
next=Icpitembatch.CPVarDecl
frm_calc=''S'
len=1
name='_flgcau
next=Icpitembatch.CPVarDecl
frm_calc='rowOperazioni.CAUOPER
len=4
name='_cautmp
next=Icpitembatch.CPExec
check='page
frm_calc='6
next=Icpitembatch.CPVarDecl
frm_calc='_clinew
len=7
name='cCli1
obj='Var
pag=3
prev=O595
var_op='asgn
I
obj='Exec
pag=3
prev=O594
I
obj='Var
pag=3
prev=O593
var_op='asgn
I
obj='Var
pag=3
prev=O592
var_op='asgn
I
obj='Var
pag=3
prev=O591
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O528
var_op='asgn
I
obj='Var
pag=3
prev=O527
var_op='asgn
I
obj='Var
pag=3
prev=O525
var_op='asgn
I
obj='ForEach
pag=3
prev=O524
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O525
fatherSonIndex=0
frm_calc=[
'rowValuta.CODVAL=rowOperazioni.VALUTA or rowValuta.ISO=rowOperazioni.VALUTA
]
h=[
19
19
]
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O600
fatherSonIndex=0
frm_calc='rowValuta.CODVAL
len=3
name='cValuta
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O605
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O523
var_op='asgn
I
obj='Remark
pag=3
prev=O522
I
obj='Var
obj_type='D
pag=3
prev=O521
var_op='asgn
I
obj='Var
obj_type='D
pag=3
prev=O520
var_op='asgn
I
obj='Var
obj_type='D
pag=3
prev=O519
var_op='asgn
I
obj='Remark
pag=3
prev=O518
I
obj='Var
obj_type='N
pag=3
prev=O517
var_op='asgn
I
obj='Var
pag=3
prev=O516
var_op='asgn
I
obj='Var
pag=3
prev=O515
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O512
var_op='asgn
I
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O512
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PPOPER2\'"+LRTrim(gAzienda)+"'",'',11)
len=7
name='cOpePrg
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O512
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("POPERAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=7
name='cOpePrg
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O507
fatherSonIndex=1
frm_calc='transaction error
frm_seek='Import bloccato. Sono state trovate operazioni già presenti con lo stesso codice"+rowOperazioni.NUMPROG+"
obj='Transaction
pag=3
raise_on_trans_err=True
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O505
fatherSonIndex=0
frm_calc='''
len=10
name='xIDBASE
next=Icpitembatch.CPRead
arch='operazbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xIDBASE) or (At(xStatoReg,'|0|1')=0 and not(Empty(xIDBASE)))
]
h=[
19
19
]
obj='If
pag=3
prev=O621
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O622
fatherSonIndex=0
frm_calc='''
len=10
name='xIDBASE
next=Icpitembatch.CPRead
arch='xperazbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xIDBASE)
]
h=[
19
19
]
obj='If
pag=3
prev=O628
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O629
fatherSonIndex=0
frm_calc='''
len=1
name='xStatoReg
next=Icpitembatch.CPRead
arch='fraziobo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xIDBASE) or (At(xStatoReg,'|0|1')=0 and not(Empty(xIDBASE)))
]
h=[
19
19
]
obj='If
pag=3
prev=O635
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O636
fatherSonIndex=0
frm_calc='''
len=10
name='xIDBASE
next=Icpitembatch.CPRead
arch='xraziobo
obj='Read
pag=3
prev=O641
rd_field=[
'IDBASE
]
rd_kfield=[
'IMPPROG
]
rd_kvar=[
'LRTrim(rowOperazioni.IMPPROG)
]
rd_var=[
'xIDBASE
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=3
prev=O634
rd_field=[
'IDBASE
]
rd_kfield=[
'IMPPROG
]
rd_kvar=[
'LRTrim(rowOperazioni.IMPPROG)
]
rd_var=[
'xIDBASE
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=3
prev=O627
rd_field=[
'IDBASE
]
rd_kfield=[
'IMPPROG
]
rd_kvar=[
'LRTrim(rowOperazioni.IMPPROG)
]
rd_var=[
'xIDBASE
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=3
prev=O620
rd_field=[
'IDBASE
'STATOREG
]
rd_kfield=[
'IMPPROG
]
rd_kvar=[
'LRTrim(rowOperazioni.IMPPROG)
]
rd_var=[
'xIDBASE
'xStatoReg
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O465
fatherSonIndex=1
frm_calc=''KO'
name='cRitorno
next=Icpitembatch.CPTransaction
frm_calc='rollback
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Errore nell'import definitivo dei dati: " + m_cLastMsgError + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'pScheduler='S'
]
h=[
19
19
]
obj='If
pag=3
prev=O667
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O668
fatherSonIndex=0
frm_calc='_logmsg +  "Errore nell'import definitivo dei dati: " + m_cLastMsgError + "<br>"
len=10
name='_logmsg
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O666
var_op='asgn
I
obj='Transaction
pag=3
prev=O665
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=3
prev=O461
I
obj='If
pag=3
prev=O460
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Log
father=O461
fatherSonIndex=0
frm_calc='_logmsg + 'Inizio Import File alle ore '+arfn_fdatetime(DateTime()) + "<br>"
len=10
name='_logmsg
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O459
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O458
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=3
prev=O451
I
obj='Begin
pag=3
prev=O450
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Log
father=O451
fatherSonIndex=0
frm_calc='gMsgProc + 'Inizio Controllo File alle ore '+arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'pScheduler='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='-1
len=10
name='_rownum
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_errrow
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipoform = 'C'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Log
frm_calc='gMsgProc + 'Sono state controllate '+LRTrim(Str(_rownum,10,0))+' Operazioni ...' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Log
frm_calc='gMsgProc + 'Termine Controllo File alle ore '+arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'pScheduler='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Terminato Controllo Operazioni'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=3
prev=O694
var_op='asgn
I
obj='If
pag=3
prev=O693
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O694
fatherSonIndex=0
frm_calc='_logmsg +  'Sono state controllate '+LRTrim(Str(_rownum,10,0))+' Operazioni ...' + "<br>"
len=10
name='_logmsg
next=Icpitembatch.CPVarDecl
frm_calc='_logmsg + 'Termine Controllo File alle ore '+arfn_fdatetime(DateTime()) + "<br>"
len=10
name='_logmsg
obj='Var
obj_type='M
pag=3
prev=O700
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O692
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O689
var_op='asgn
I
obj='If
pag=3
prev=O688
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O689
fatherSonIndex=0
frm_calc='LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+"/"+LRTrim(w_nomefile)
len=80
name='filename
next=Icpitembatch.CPExec
check='man
frm_calc='FileReader freader=new FileReader(filename);﷯CSVReader reader = new CSVReader(freader);﷯String [] nextLine;﷯while ((nextLine = reader.readNext()) != null) {
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Sono state controllate '+LRTrim(Str(_rownum,10,0))+' Operazioni ...'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPExec
check='man
frm_calc='}﷯// Chiuse il file﷯reader.close();
obj='Exec
pag=3
prev=O709
I
nonlocal=True
obj='Var
pag=3
prev=O707
var_op='asgn
I
obj='Try
pag=3
prev=O706
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O707
fatherSonIndex=0
frm_calc=[
'_rownum >= 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_rownum + 1
len=10
name='_rownum
obj='Var
obj_type='N
pag=3
prev=O713
var_op='asgn
I
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O713
fatherSonIndex=0
frm_seek='AppendBlank
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[0]
frm_seek='TIPOOPER
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[1]
frm_seek='CODSTUDIO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[2]
frm_seek='CODDIPE
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[3]
frm_seek='NUMPROG
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[4]
frm_seek='DATAOPE
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[5]
frm_seek='FLAGFRAZ
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[6]
frm_seek='CAUOPER
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[7]
frm_seek='CONNESCLI
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[8]
frm_seek='CONNESREAL
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[9]
frm_seek='CONNESBEN
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[10]
frm_seek='DATAREG
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[11]
frm_seek='STATOREG
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[12]
frm_seek='DATARETT
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[13]
frm_seek='VALUTA
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(nextLine[14])
frm_seek='IMPORTO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(nextLine[15])
frm_seek='CONTANTI
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[16]
frm_seek='MEZPAG
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[17]
frm_seek='PRESTAZ
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[21]
frm_seek='POSIZ
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[22]
frm_seek='RAGIO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[23]
frm_seek='MODSVOL
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[24]
frm_seek='AREAGEO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[25]
frm_seek='AMMONT
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[26]
frm_seek='DURAT
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[27]
frm_seek='TIPO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(nextLine[28])
frm_seek='RRAGIO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(nextLine[29])
frm_seek='RCOMP
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(nextLine[30])
frm_seek='RAREA
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(nextLine[31])
frm_seek='RIMP
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(nextLine[32])
frm_seek='RFREQ
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(nextLine[33])
frm_seek='RTIPO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[34]
frm_seek='IMPPROG
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[35]
frm_seek='DESPUNTO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcContante
obj='Var
obj_type='MC
pag=3
prev=O752
var_op='meth
I
obj='Var
obj_type='MC
pag=3
prev=O751
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O750
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O749
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O748
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O747
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O746
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O745
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O744
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O743
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O742
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O741
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O740
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O739
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O738
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O737
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O736
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O735
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O734
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O733
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O732
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O731
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O730
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O729
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O728
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O727
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O726
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O725
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O724
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O723
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O722
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O721
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O720
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O719
var_op='prop
I
obj='Var
obj_type='MC
pag=3
var_op='meth
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O707
fatherSonIndex=1
frm_calc='gMsgProc + 'Riga Numero: '+LRTrim(Str(_rownum,10,0)) + " " + m_cLastMsgError + NL
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'pScheduler='S'
]
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='tmp_erroriimp
next=Icpitembatch.CPTransaction
frm_calc='accept error
obj='Transaction
pag=3
prev=O760
I
obj='Insert
pag=3
prev=O757
rd_kfield=[
'numriga
'errormsg
]
rd_kvar=[
'_rownum
'm_cLastMsgError
]
I
obj='If
pag=3
prev=O756
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O757
fatherSonIndex=0
frm_calc='_logmsg + 'Riga Numero: '+LRTrim(Str(_rownum,10,0)) + " " + m_cLastMsgError + "<br>"
len=10
name='_logmsg
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=3
prev=O705
I
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O689
fatherSonIndex=1
frm_calc='FileLibrary.OpenRead('appo/'+LRTrim(gAzienda)+"/"+LRTrim(w_nomefile))
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibrary.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibrary.Close(fhand)
obj='Exec
pag=3
prev=O771
I
obj='While
pag=3
prev=O770
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O771
fatherSonIndex=0
frm_calc='FileLibrary.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Sono state controllate '+LRTrim(Str(_rownum,10,0))+' Operazioni ...'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=3
prev=O777
var_op='asgn
I
obj='Try
pag=3
prev=O776
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O777
fatherSonIndex=0
frm_calc='_rownum + 1
len=10
name='_rownum
next=Icpitembatch.CPVarDecl
frm_seek='AppendBlank
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Left(riga,2)
frm_seek='TIPOOPER
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,3,11)
frm_seek='CODSTUDIO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,14,6)
frm_seek='CODDIPE
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,20,11)
frm_seek='NUMPROG
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,31,8)
frm_seek='DATAOPE
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,39,1)
frm_seek='FLAGFRAZ
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,40,4)
frm_seek='CAUOPER
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,44,16)
frm_seek='CONNESCLI
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,60,16)
frm_seek='CONNESREAL
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,76,16)
frm_seek='CONNESBEN
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,92,8)
frm_seek='DATAREG
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,100,1)
frm_seek='STATOREG
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,101,8)
frm_seek='DATARETT
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,109,3)
frm_seek='VALUTA
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(Substr(riga,112,15)) / 100
frm_seek='IMPORTO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(Substr(riga,127,15)) / 100
frm_seek='CONTANTI
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,142,30)
frm_seek='MEZPAG
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,172,30)
frm_seek='PRESTAZ
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,220,1)
frm_seek='POSIZ
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,221,5)
frm_seek='RAGIO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,226,5)
frm_seek='MODSVOL
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,231,5)
frm_seek='AREAGEO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,236,5)
frm_seek='AMMONT
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,241,5)
frm_seek='DURAT
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,246,5)
frm_seek='TIPO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(Substr(riga,251,3))
frm_seek='RRAGIO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(Substr(riga,254,3))
frm_seek='RCOMP
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(Substr(riga,257,3))
frm_seek='RAREA
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(Substr(riga,260,3))
frm_seek='RIMP
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(Substr(riga,263,3))
frm_seek='RFREQ
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(Substr(riga,266,3))
frm_seek='RTIPO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,269,13)
frm_seek='IMPPROG
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,282,80)
frm_seek='DESPUNTO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcContante
obj='Var
obj_type='MC
pag=3
prev=O816
var_op='meth
I
obj='Var
obj_type='MC
pag=3
prev=O815
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O814
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O813
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O812
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O811
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O810
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O809
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O808
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O807
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O806
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O805
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O804
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O803
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O802
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O801
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O800
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O799
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O798
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O797
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O796
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O795
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O794
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O793
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O792
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O791
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O790
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O789
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O788
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O787
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O786
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O785
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O784
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O783
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O782
var_op='meth
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O777
fatherSonIndex=1
frm_calc='gMsgProc + 'Riga Numero: '+LRTrim(Str(_rownum,10,0)) + " " + m_cLastMsgError + NL
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'pScheduler='S'
]
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='tmp_erroriimp
next=Icpitembatch.CPTransaction
frm_calc='accept error
obj='Transaction
pag=3
prev=O823
I
obj='Insert
pag=3
prev=O820
rd_kfield=[
'numriga
'errormsg
]
rd_kvar=[
'_rownum
'm_cLastMsgError
]
I
obj='If
pag=3
prev=O819
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O820
fatherSonIndex=0
frm_calc='_logmsg +  'Riga Numero: '+LRTrim(Str(_rownum,10,0)) + " " + m_cLastMsgError + "<br>"
len=10
name='_logmsg
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O687
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O684
var_op='asgn
I
obj='If
pag=3
prev=O683
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O684
fatherSonIndex=0
frm_calc='_logmsg + 'Inizio Controllo File alle ore '+arfn_fdatetime(DateTime()) + "<br>"
len=10
name='_logmsg
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=3
prev=O449
I
obj='Var
obj_type='MC
pag=3
prev=O448
var_op='meth
I
nonlocal=True
obj='Var
pag=3
prev=O447
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O446
var_op='asgn
I
obj='Remark
pag=3
x=20
y=18
I
Icpitembatch.CPRemark
frm_calc='Import Frazionate
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Inizio Importazione Frazionate ...'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPBeginEnd
comment='Legge il file di test (CSV o TXT) e mette i dati nel MC
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Cicla sul MC e scrive
h=[
19
19
]
obj='Begin
pag=4
prev=O841
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Log
father=O843
fatherSonIndex=0
frm_calc='gMsgProc + 'Inizio Import File alle ore '+arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
comment='Log
frm_calc='gMsgProc + 'Termine Import File alle ore '+arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Fine Elaborazione del file '+LRTrim(w_nomefile)+" alle ore "+arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Terminato Import Frazionate'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'cActLog='S'
]
h=[
19
19
]
obj='If
pag=4
prev=O853
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='bat
father=O854
fatherSonIndex=0
frm_calc='arrt_writelog('IMPORT','Prestazioni/F',LRTrim(w_nomefile),gMsgProc)
obj='Exec
pag=4
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=4
prev=O852
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O851
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O849
var_op='asgn
I
obj='Try
pag=4
prev=O848
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O849
fatherSonIndex=0
frm_calc='''
len=7
name='xRif
next=Icpitembatch.CPForEach
for_variable='rowOperazioni
for_variable_type='tmp_imp_oper
h=[
19
19
]
iterator_expr='mcOperazioni
next=Icpitembatch.CPTransaction
frm_calc='commit
next=Icpitembatch.CPVarDecl
comment='Log
frm_calc='gMsgProc + 'Sono state importate '+LRTrim(Str(_rownum,10,0))+' Frazionate ...' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Log
frm_calc='gMsgProc + 'Sono state scartate '+LRTrim(Str(_errrow,10,0))+' Frazionate ...' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Import definitivo dei dati concluso con successo" + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O868
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O867
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O866
var_op='asgn
I
obj='Transaction
pag=4
prev=O864
I
obj='ForEach
pag=4
prev=O863
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Controlla che non esista già la prestazione
father=O864
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xIDBASE)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
prev=O872
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O874
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='0
len=5
name='_cauint
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='_cauaui
next=Icpitembatch.CPVarDecl
frm_calc='''
len=50
name='_finalita
next=Icpitembatch.CPVarDecl
frm_calc='0
len=3
name='_caurischio
next=Icpitembatch.CPRemark
frm_calc='Trasforma le date
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(rowOperazioni.DATAOPE),NullDate(),CharToDate(Right(rowOperazioni.DATAOPE,4)+Substr(rowOperazioni.DATAOPE,3,2)+Left(rowOperazioni.DATAOPE,2)))
len=8
name='cData1
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(rowOperazioni.DATAREG),NullDate(),CharToDate(Right(rowOperazioni.DATAREG,4)+Substr(rowOperazioni.DATAREG,3,2)+Left(rowOperazioni.DATAREG,2)))
len=8
name='cData2
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(rowOperazioni.DATARETT),NullDate(),CharToDate(Right(rowOperazioni.DATARETT,4)+Substr(rowOperazioni.DATARETT,3,2)+Left(rowOperazioni.DATARETT,2)))
len=8
name='cData3
next=Icpitembatch.CPRemark
frm_calc='Legge la valuta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='cValuta
next=Icpitembatch.CPForEach
for_variable='rowValuta
for_variable_type='tbvalute
h=[
19
19
]
iterator_expr='mcTBVALUTE
next=Icpitembatch.CPVarDecl
frm_calc='''
len=7
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=7
name='cCli2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=7
name='cCli3
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(rowOperazioni.CONNESCLI)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(rowOperazioni.CONNESREAL)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(rowOperazioni.CONNESBEN)))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifica il tipo di operazione
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cCli1)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Sono state importate '+LRTrim(Str(_rownum,10,0))+' Frazionate ...'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=4
prev=O907
var_op='asgn
I
obj='If
pag=4
prev=O906
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O907
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPOPER\'"+LRTrim(gAzienda)+"'",0,10)
len=10
name='_imperr
next=Icpitembatch.CPInsert
arch='scarti_import
next=Icpitembatch.CPVarDecl
frm_calc='_errrow + 1
len=10
name='_errrow
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Sono state scartate '+LRTrim(Str(_rownum,10,0))+' Operazioni ...'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=4
prev=O915
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O914
var_op='asgn
I
obj='Insert
pag=4
prev=O913
rd_kfield=[
'IMPPROG
'TIPOOPER
'CODSTUDIO
'CODDIPE
'NUMPROG
'DATAOPE
'FLAGFRAZ
'CAUOPER
'CONNESCLI
'CONNESREAL
'CONNESBEN
'DATAREG
'STATOREG
'DATARETT
'VALUTA
'IMPORTO
'CONTANTI
'MEZPAG
'PRESTAZ
'POSIZ
'RAGIO
'MODSVOL
'AREAGEO
'TIPO
'AMMONT
'DURAT
'RAREA
'RRAGIO
'RCOMP
'RTIPO
'RFREQ
'RIMP
'CODABI
'CODCAB
'CONNALTRO
'TXTERR
'IMPPROG13
'DESPUNTO
]
rd_kvar=[
'_imperr
'rowOperazioni.TIPOOPER
'rowOperazioni.CODSTUDIO
'rowOperazioni.CODDIPE
'rowOperazioni.NUMPROG
'rowOperazioni.DATAOPE
'rowOperazioni.FLAGFRAZ
'rowOperazioni.CAUOPER
'rowOperazioni.CONNESCLI
'rowOperazioni.CONNESREAL
'rowOperazioni.CONNESBEN
'rowOperazioni.DATAREG
'rowOperazioni.STATOREG
'rowOperazioni.DATARETT
'rowOperazioni.VALUTA
'rowOperazioni.IMPORTO
'rowOperazioni.CONTANTI
'rowOperazioni.MEZPAG
'rowOperazioni.PRESTAZ
'rowOperazioni.POSIZ
'rowOperazioni.RAGIO
'rowOperazioni.MODSVOL
'rowOperazioni.AREAGEO
'rowOperazioni.TIPO
'rowOperazioni.AMMONT
'rowOperazioni.DURAT
'rowOperazioni.RAREA
'rowOperazioni.RRAGIO
'rowOperazioni.RCOMP
'rowOperazioni.RTIPO
'rowOperazioni.RFREQ
'rowOperazioni.RIMP
'rowOperazioni.CODABI
'rowOperazioni.CODCAB
'rowOperazioni.CONNALTRO
''Cliente non rilevato'
'rowOperazioni.IMPPROG
'rowOperazioni.DESPUNTO
]
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O907
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_rownum + 1
len=10
name='_rownum
obj='Var
obj_type='N
pag=4
prev=O921
var_op='asgn
I
obj='If
pag=4
prev=O920
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O921
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PPFRAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='xIDBASE
next=Icpitembatch.CPInsert
arch='xraziobo
obj='Insert
pag=4
prev=O927
rd_kfield=[
'AMMONT
'AREAGEO
'CODANA
'CODDIPE
'CODINTER
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAOPE
'DATAREG
'DATARETT
'DESPUNTO
'DURAT
'FLAGCONT
'FLAGFRAZ
'IDBASE
'IMPPROG
'MEZPAG
'MODSVOL
'NOTE
'NUMPROG
'PRESTAZ
'RAGIO
'RAREA
'RCOMP
'RFREQ
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'STATOREG
'TIPO
'TIPOINTER
'TOTCONT
'TOTLIRE
'VALUTA
'PRGIMPFRZ
'TIPOOPRAP
]
rd_kvar=[
'rowOperazioni.AMMONT
'rowOperazioni.AREAGEO
'_cauaui
'rowOperazioni.CODDIPE
'iif(Empty(rowOperazioni.CODSTUDIO),LRTrim(_cfinter),rowOperazioni.CODSTUDIO)
'cCli3
'cCli1
'cCli2
'cData1
'cData2
'cData3
'rowOperazioni.DESPUNTO
'rowOperazioni.DURAT
'iif(rowOperazioni.CONTANTI>0,'S,','N')
'rowOperazioni.FLAGFRAZ
'xIDBASE
'LRTrim(rowOperazioni.IMPPROG)
'w_PAGMEZ
'rowOperazioni.MODSVOL
''N° Pratica '+LRTrim(rowOperazioni.IMPPROG)
'cOpePrg
'rowOperazioni.PRESTAZ
'rowOperazioni.RAGIO
'rowOperazioni.RAREA
'rowOperazioni.RCOMP
'rowOperazioni.RFREQ
'rowOperazioni.RIMP
'rowOperazioni.RRAGIO
'rowOperazioni.RTIPO
'_finalita
'rowOperazioni.STATOREG
'rowOperazioni.TIPO
'gTipInter
'rowOperazioni.CONTANTI*100
'rowOperazioni.IMPORTO*100
'cValuta
'nProgImp
''10'
]
I
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O921
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='xIDBASE
next=Icpitembatch.CPInsert
arch='fraziobo
obj='Insert
pag=4
prev=O932
rd_kfield=[
'AMMONT
'AREAGEO
'CODANA
'CODDIPE
'CODINTER
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAOPE
'DATAREG
'DATARETT
'DESPUNTO
'DURAT
'FLAGCONT
'FLAGFRAZ
'IDBASE
'IMPPROG
'MEZPAG
'MODSVOL
'NOTE
'NUMPROG
'PRESTAZ
'RAGIO
'RAREA
'RCOMP
'RFREQ
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'STATOREG
'TIPO
'TIPOINTER
'TOTCONT
'TOTLIRE
'VALUTA
'PRGIMPFRZ
'TIPOOPRAP
]
rd_kvar=[
'rowOperazioni.AMMONT
'rowOperazioni.AREAGEO
'_cauaui
'rowOperazioni.CODDIPE
'iif(Empty(rowOperazioni.CODSTUDIO),LRTrim(_cfinter),rowOperazioni.CODSTUDIO)
'cCli3
'cCli1
'cCli2
'cData1
'cData2
'cData3
'rowOperazioni.DESPUNTO
'rowOperazioni.DURAT
'iif(rowOperazioni.CONTANTI>0,'S,','N')
'rowOperazioni.FLAGFRAZ
'xIDBASE
'LRTrim(rowOperazioni.IMPPROG)
'iif(Empty(LRTrim(rowOperazioni.MEZPAG)),w_PAGMEZ,rowOperazioni.MEZPAG)
'rowOperazioni.MODSVOL
''N° Pratica '+LRTrim(rowOperazioni.IMPPROG)
'cOpePrg
'rowOperazioni.PRESTAZ
'rowOperazioni.RAGIO
'rowOperazioni.RAREA
'rowOperazioni.RCOMP
'rowOperazioni.RFREQ
'rowOperazioni.RIMP
'rowOperazioni.RRAGIO
'rowOperazioni.RTIPO
'_finalita
'rowOperazioni.STATOREG
'rowOperazioni.TIPO
'gTipInter
'rowOperazioni.CONTANTI*100
'rowOperazioni.IMPORTO*100
'cValuta
'nProgImp
''10'
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=4
prev=O903
I
obj='If
pag=4
prev=O900
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O903
fatherSonIndex=0
frm_calc='''
len=16
name='_clinew
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rowOperazioni.CONNESBEN)
len=16
name='_cliente
next=Icpitembatch.CPVarDecl
frm_calc='rowOperazioni.CAUOPER
len=4
name='_cautmp
next=Icpitembatch.CPVarDecl
frm_calc=''N'
len=1
name='_flgcau
next=Icpitembatch.CPExec
check='page
frm_calc='6
next=Icpitembatch.CPVarDecl
frm_calc='_clinew
len=7
name='cCli3
obj='Var
pag=4
prev=O944
var_op='asgn
I
obj='Exec
pag=4
prev=O943
I
obj='Var
pag=4
prev=O942
var_op='asgn
I
obj='Var
pag=4
prev=O941
var_op='asgn
I
obj='Var
pag=4
prev=O940
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O897
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O900
fatherSonIndex=0
frm_calc='''
len=16
name='_clinew
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rowOperazioni.CONNESREAL)
len=16
name='_cliente
next=Icpitembatch.CPVarDecl
frm_calc='rowOperazioni.CAUOPER
len=4
name='_cautmp
next=Icpitembatch.CPVarDecl
frm_calc=''S'
len=1
name='_flgcau
next=Icpitembatch.CPExec
check='page
frm_calc='6
next=Icpitembatch.CPVarDecl
frm_calc='_clinew
len=7
name='cCli2
obj='Var
pag=4
prev=O953
var_op='asgn
I
obj='Exec
pag=4
prev=O952
I
obj='Var
pag=4
prev=O951
var_op='asgn
I
obj='Var
pag=4
prev=O950
var_op='asgn
I
obj='Var
pag=4
prev=O949
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O896
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O897
fatherSonIndex=0
frm_calc='''
len=16
name='_clinew
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rowOperazioni.CONNESCLI)
len=16
name='_cliente
next=Icpitembatch.CPVarDecl
frm_calc=''N'
len=1
name='_flgcau
next=Icpitembatch.CPVarDecl
frm_calc='rowOperazioni.CAUOPER
len=4
name='_cautmp
next=Icpitembatch.CPExec
check='page
frm_calc='6
next=Icpitembatch.CPVarDecl
frm_calc='_clinew
len=7
name='cCli1
obj='Var
pag=4
prev=O962
var_op='asgn
I
obj='Exec
pag=4
prev=O961
I
obj='Var
pag=4
prev=O960
var_op='asgn
I
obj='Var
pag=4
prev=O959
var_op='asgn
I
obj='Var
pag=4
prev=O958
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
prev=O895
var_op='asgn
I
obj='Var
pag=4
prev=O894
var_op='asgn
I
obj='Var
pag=4
prev=O892
var_op='asgn
I
obj='ForEach
pag=4
prev=O891
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O892
fatherSonIndex=0
frm_calc=[
'rowValuta.CODVAL=rowOperazioni.VALUTA or rowValuta.ISO=rowOperazioni.VALUTA
]
h=[
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O967
fatherSonIndex=0
frm_calc='rowValuta.CODVAL
len=3
name='cValuta
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O972
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
prev=O890
var_op='asgn
I
obj='Remark
pag=4
prev=O889
I
obj='Var
obj_type='D
pag=4
prev=O888
var_op='asgn
I
obj='Var
obj_type='D
pag=4
prev=O887
var_op='asgn
I
obj='Var
obj_type='D
pag=4
prev=O886
var_op='asgn
I
obj='Remark
pag=4
prev=O885
I
obj='Var
obj_type='N
pag=4
prev=O884
var_op='asgn
I
obj='Var
pag=4
prev=O883
var_op='asgn
I
obj='Var
pag=4
prev=O882
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O879
var_op='asgn
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O879
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PPFRAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=7
name='cOpePrg
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O879
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PFRAZIO2\'"+LRTrim(gAzienda)+"'",'',11)
len=7
name='cOpePrg
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O874
fatherSonIndex=1
frm_calc='transaction error
frm_seek='Import bloccato. Sono state trovate operazioni/frazionate già presenti con lo stesso codice
obj='Transaction
pag=4
raise_on_trans_err=True
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O872
fatherSonIndex=0
frm_calc='''
len=10
name='xIDBASE
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='xStatoReg
next=Icpitembatch.CPRead
arch='operazbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xIDBASE) or (At(xStatoReg,'|0|1')=0 and not(Empty(xIDBASE)))
]
h=[
19
19
]
obj='If
pag=4
prev=O989
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O990
fatherSonIndex=0
frm_calc='''
len=10
name='xIDBASE
next=Icpitembatch.CPRead
arch='xperazbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xIDBASE)
]
h=[
19
19
]
obj='If
pag=4
prev=O996
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O997
fatherSonIndex=0
frm_calc='''
len=1
name='xStatoReg
next=Icpitembatch.CPRead
arch='fraziobo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xIDBASE) or (At(xStatoReg,'|0|1')=0 and not(Empty(xIDBASE)))
]
h=[
19
19
]
obj='If
pag=4
prev=O1003
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1004
fatherSonIndex=0
frm_calc='''
len=10
name='xIDBASE
next=Icpitembatch.CPRead
arch='xraziobo
obj='Read
pag=4
prev=O1009
rd_field=[
'IDBASE
]
rd_kfield=[
'IMPPROG
]
rd_kvar=[
'LRTrim(rowOperazioni.IMPPROG)
]
rd_var=[
'xIDBASE
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
prev=O1002
rd_field=[
'IDBASE
'STATOREG
]
rd_kfield=[
'IMPPROG
]
rd_kvar=[
'LRTrim(rowOperazioni.IMPPROG)
]
rd_var=[
'xIDBASE
'xStatoReg
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
prev=O995
rd_field=[
'IDBASE
]
rd_kfield=[
'IMPPROG
]
rd_kvar=[
'LRTrim(rowOperazioni.IMPPROG)
]
rd_var=[
'xIDBASE
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
prev=O988
rd_field=[
'IDBASE
'STATOREG
]
rd_kfield=[
'IMPPROG
]
rd_kvar=[
'LRTrim(rowOperazioni.IMPPROG)
]
rd_var=[
'xIDBASE
'xStatoReg
]
I
obj='Var
pag=4
prev=O987
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O849
fatherSonIndex=1
frm_calc=''KO'
name='cRitorno
next=Icpitembatch.CPTransaction
frm_calc='rollback
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Errore nell'import definitivo dei dati: "+ NL + m_cLastMsgError + NL
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O1034
var_op='asgn
I
obj='Transaction
pag=4
prev=O1033
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=4
prev=O847
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=4
prev=O840
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
comment='Log
father=O841
fatherSonIndex=0
frm_calc='gMsgProc + 'Inizio Controllo File alle ore '+arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_rownum
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_errrow
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipoform = 'C'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Log
frm_calc='gMsgProc + 'Sono state controllate '+LRTrim(Str(_rownum,10,0))+' Operazioni ...' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Log
frm_calc='gMsgProc + 'Termine Controllo File alle ore '+arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Terminato Controllo Operazioni'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=4
prev=O1047
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O1046
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O1043
var_op='asgn
I
obj='If
pag=4
prev=O1042
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1043
fatherSonIndex=0
frm_calc='LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+"/"+LRTrim(w_nomefile)
len=80
name='filename
next=Icpitembatch.CPExec
check='man
frm_calc='FileReader freader=new FileReader(filename);﷯CSVReader reader = new CSVReader(freader);﷯String [] nextLine;﷯while ((nextLine = reader.readNext()) != null) {
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Sono state controllate '+LRTrim(Str(_rownum,10,0))+' Operazioni ...'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPExec
check='man
frm_calc='}﷯// Chiuse il file﷯reader.close();
obj='Exec
pag=4
prev=O1055
I
nonlocal=True
obj='Var
pag=4
prev=O1053
var_op='asgn
I
obj='Try
pag=4
prev=O1052
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1053
fatherSonIndex=0
frm_calc=[
'_rownum > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_rownum + 1
len=10
name='_rownum
obj='Var
obj_type='N
pag=4
prev=O1059
var_op='asgn
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1059
fatherSonIndex=0
frm_seek='AppendBlank
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[0]
frm_seek='TIPOOPER
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[1]
frm_seek='CODSTUDIO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[2]
frm_seek='CODDIPE
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[3]
frm_seek='NUMPROG
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[4]
frm_seek='DATAOPE
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[5]
frm_seek='FLAGFRAZ
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[6]
frm_seek='CAUOPER
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[7]
frm_seek='CONNESCLI
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[8]
frm_seek='CONNESREAL
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[9]
frm_seek='CONNESBEN
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[10]
frm_seek='DATAREG
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[11]
frm_seek='STATOREG
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[12]
frm_seek='DATARETT
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[13]
frm_seek='VALUTA
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(nextLine[14])
frm_seek='IMPORTO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(nextLine[15])
frm_seek='CONTANTI
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[16]
frm_seek='MEZPAG
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[17]
frm_seek='PRESTAZ
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[21]
frm_seek='POSIZ
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[22]
frm_seek='RAGIO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[23]
frm_seek='MODSVOL
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[24]
frm_seek='AREAGEO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[25]
frm_seek='AMMONT
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[26]
frm_seek='DURAT
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[27]
frm_seek='TIPO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(nextLine[28])
frm_seek='RRAGIO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(nextLine[29])
frm_seek='RCOMP
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(nextLine[30])
frm_seek='RAREA
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(nextLine[31])
frm_seek='RIMP
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(nextLine[32])
frm_seek='RFREQ
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(nextLine[33])
frm_seek='RTIPO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[34]
frm_seek='IMPPROG
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[35]
frm_seek='DESPUNTO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcContante
obj='Var
obj_type='MC
pag=4
prev=O1098
var_op='meth
I
obj='Var
obj_type='MC
pag=4
prev=O1097
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1096
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1095
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1094
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1093
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1092
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1091
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1090
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1089
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1088
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1087
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1086
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1085
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1084
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1083
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1082
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1081
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1080
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1079
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1078
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1077
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1076
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1075
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1074
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1073
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1072
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1071
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1070
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1069
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1068
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1067
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1066
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1065
var_op='prop
I
obj='Var
obj_type='MC
pag=4
var_op='meth
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1053
fatherSonIndex=1
frm_calc='gMsgProc + 'Riga Numero: '+LRTrim(Str(_rownum,10,0)) + " " + m_cLastMsgError + NL
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'pScheduler='S'
]
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='tmp_erroriimp
next=Icpitembatch.CPTransaction
frm_calc='accept error
obj='Transaction
pag=4
prev=O1106
I
obj='Insert
pag=4
prev=O1103
rd_kfield=[
'numriga
'errormsg
]
rd_kvar=[
'_rownum
'm_cLastMsgError
]
I
obj='If
pag=4
prev=O1102
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1103
fatherSonIndex=0
frm_calc='_logmsg + 'Riga Numero: '+LRTrim(Str(_rownum,10,0)) + " " + m_cLastMsgError + "<br>"
len=10
name='_logmsg
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=4
prev=O1051
I
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1043
fatherSonIndex=1
frm_calc='FileLibrary.OpenRead('appo/'+LRTrim(gAzienda)+"/"+LRTrim(w_nomefile))
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibrary.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibrary.Close(fhand)
obj='Exec
pag=4
prev=O1117
I
obj='While
pag=4
prev=O1116
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1117
fatherSonIndex=0
frm_calc='FileLibrary.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Sono state controllate '+LRTrim(Str(_rownum,10,0))+' Operazioni ...'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=4
prev=O1123
var_op='asgn
I
obj='Try
pag=4
prev=O1122
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1123
fatherSonIndex=0
frm_calc='_rownum + 1
len=10
name='_rownum
next=Icpitembatch.CPVarDecl
frm_seek='AppendBlank
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Left(riga,2)
frm_seek='TIPOOPER
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,3,11)
frm_seek='CODSTUDIO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,14,6)
frm_seek='CODDIPE
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,20,11)
frm_seek='NUMPROG
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,31,8)
frm_seek='DATAOPE
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,39,1)
frm_seek='FLAGFRAZ
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,40,4)
frm_seek='CAUOPER
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,44,16)
frm_seek='CONNESCLI
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,60,16)
frm_seek='CONNESREAL
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,76,16)
frm_seek='CONNESBEN
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,92,8)
frm_seek='DATAREG
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,100,1)
frm_seek='STATOREG
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,101,8)
frm_seek='DATARETT
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,109,3)
frm_seek='VALUTA
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(Substr(riga,112,15)) / 100
frm_seek='IMPORTO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(Substr(riga,127,15)) / 100
frm_seek='CONTANTI
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,142,30)
frm_seek='MEZPAG
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,172,30)
frm_seek='PRESTAZ
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,220,1)
frm_seek='POSIZ
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,221,5)
frm_seek='RAGIO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,226,5)
frm_seek='MODSVOL
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,231,5)
frm_seek='AREAGEO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,236,5)
frm_seek='AMMONT
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,241,5)
frm_seek='DURAT
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,246,5)
frm_seek='TIPO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(Substr(riga,251,3))
frm_seek='RRAGIO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(Substr(riga,254,3))
frm_seek='RCOMP
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(Substr(riga,257,3))
frm_seek='RAREA
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(Substr(riga,260,3))
frm_seek='RIMP
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(Substr(riga,263,3))
frm_seek='RFREQ
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Val(Substr(riga,266,3))
frm_seek='RTIPO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,269,13)
frm_seek='IMPPROG
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,282,80)
frm_seek='DESPUNTO
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcContante
obj='Var
obj_type='MC
pag=4
prev=O1162
var_op='meth
I
obj='Var
obj_type='MC
pag=4
prev=O1161
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1160
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1159
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1158
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1157
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1156
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1155
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1154
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1153
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1152
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1151
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1150
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1149
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1148
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1147
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1146
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1145
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1144
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1143
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1142
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1141
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1140
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1139
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1138
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1137
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1136
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1135
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1134
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1133
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1132
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1131
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1130
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1129
var_op='prop
I
obj='Var
obj_type='MC
pag=4
prev=O1128
var_op='meth
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1123
fatherSonIndex=1
frm_calc='gMsgProc + 'Riga Numero: '+LRTrim(Str(_rownum,10,0)) + " " + m_cLastMsgError + NL
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'pScheduler='S'
]
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='tmp_erroriimp
next=Icpitembatch.CPTransaction
frm_calc='accept error
obj='Transaction
pag=4
prev=O1169
I
obj='Insert
pag=4
prev=O1166
rd_kfield=[
'numriga
'errormsg
]
rd_kvar=[
'_rownum
'm_cLastMsgError
]
I
obj='If
pag=4
prev=O1165
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1166
fatherSonIndex=0
frm_calc='_logmsg + 'Riga Numero: '+LRTrim(Str(_rownum,10,0)) + " " + m_cLastMsgError + "<br>"
len=10
name='_logmsg
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O1041
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1040
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=4
prev=O839
var_op='asgn
I
obj='Remark
pag=4
x=15
y=16
I
Icpitembatch.CPBeginEnd
comment='Parametri
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili Globali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge i dati dell'intermediario
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Legge path applicazione
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Attendere. Elaborazione in corso ...'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='gMsgProc
next=Icpitembatch.CPRemark
frm_calc='Verifica il tipo di file che si sta importando
next=Icpitembatch.CPVarDecl
frm_calc=''OK'
name='cRitorno
next=Icpitembatch.CPDropTemporaryTable
next=Icpitembatch.CPServerTemporaryTable
next=Icpitembatch.CPIfElse
frm_calc=[
'(w_tipofile='O' or w_tipofile='F')
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc=''Inizio Elaborazione del file '+LRTrim(w_nomefile)+" alle ore "+arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'pScheduler='S'
]
h=[
19
19
]
next=Icpitembatch.CPCase
frm_calc=[
'w_tipofile = 'P'
'w_tipofile = 'O'
'w_tipofile = 'F'
'w_tipofile='C'
]
h=[
19
19
19
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.MoveFile(LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+"/"+LRTrim(w_nomefile),LRTrim(gPathDoc)+"/import/"+LRTrim(gAzienda)+"/"+LRTrim(w_nomefile)+"_"+DateToChar(Date()))
next=Icpitembatch.CPIfElse
frm_calc=[
'pScheduler='S'
]
h=[
19
19
]
next=Ispitembatch.CPReturn
frm_calc='cRitorno
obj='Return
pag=1
prev=O1207
I
obj='If
pag=1
prev=O1206
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1207
fatherSonIndex=0
frm_calc='_logmsg
name='cRitorno
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Exec
pag=1
prev=O1203
I
obj='Case
pag=1
prev=O1200
sons=[
Icpitembatch.CPItemSon
comment='Soggetti
instr=Icpitembatch.CPExec
check='page
father=O1203
fatherSonIndex=0
frm_calc='2
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
comment='Operazioni
instr=Icpitembatch.CPExec
check='page
father=O1203
fatherSonIndex=1
frm_calc='3
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
comment='Frazionate
instr=Icpitembatch.CPExec
check='page
father=O1203
fatherSonIndex=2
frm_calc='4
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1203
fatherSonIndex=3
frm_calc='5
obj='Exec
pag=1
I
I
]
w=[
150
150
150
150
150
]
I
obj='If
pag=1
prev=O1199
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1200
fatherSonIndex=0
frm_calc=''<b>Inizio Elaborazione del file '+LRTrim(w_nomefile)+" alle ore "+arfn_fdatetime(DateTime()) + "</b><br>"
len=10
name='_logmsg
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O1196
var_op='asgn
I
obj='If
pag=1
prev=O1195
sons=[
Icpitembatch.CPItemSon
instr=Ispitembatch.CPMemoryCursor
data_source='tbcauint
father=O1196
fatherSonIndex=0
mem_curs_name='mcTBCAUINT
next=Ispitembatch.CPMemoryCursor
data_source='tbvalute
mem_curs_name='mcTBVALUTE
next=Ispitembatch.CPMemoryCursor
data_source='qbe_personbo_ope.vqr
expected_rows=5000
mem_curs_name='mcPERSONBO
obj='MemoryCursor
pag=1
prev=O1232
sel_name='qbe_personbo_ope
I
obj='MemoryCursor
pag=1
prev=O1231
sel_field='*
sel_name='tbvalute
sel_type='fltb
I
obj='MemoryCursor
pag=1
sel_field='*
sel_name='tbcauint
sel_type='fltb
I
I
]
w=[
150
150
]
I
obj='TempTable
pag=1
prev=O1194
sel_type='def
server_table='tmp_erroriimp
I
obj='DropTempTable
pag=1
prev=O1193
server_table='tmp_erroriimp
I
obj='Var
pag=1
prev=O1192
var_op='asgn
I
obj='Remark
pag=1
prev=O1191
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O1190
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
prev=O1189
var_op='asgn
I
obj='Remark
pag=1
prev=O1187
I
obj='Begin
pag=1
prev=O1185
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1187
fatherSonIndex=0
frm_calc='''
len=2
name='_tipointer
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_cfinter
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=1
prev=O1238
sel_field='intermbo->CODICE,intermbo->CODFISC,intermbo->TIPOOPER
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1239
fatherSonIndex=0
frm_calc='intermbo->TIPINTER
len=2
name='_tipointer
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->CODFISC
len=16
name='_cfinter
obj='Var
pag=1
prev=O1243
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O1237
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O1183
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1185
fatherSonIndex=0
len=1
name='fhand
next=Icpitembatch.CPVarDecl
len=80
name='filename
next=Icpitembatch.CPVarDecl
len=10
name='riga
next=Icpitembatch.CPVarDecl
len=10
name='xIDBASE
next=Icpitembatch.CPVarDecl
len=6
name='cCliProg
next=Icpitembatch.CPVarDecl
len=1
name='xSesso
next=Icpitembatch.CPVarDecl
len=1
name='bModifica
next=Icpitembatch.CPVarDecl
len=8
name='cData1
next=Icpitembatch.CPVarDecl
len=8
name='cData2
next=Icpitembatch.CPVarDecl
len=8
name='cData3
next=Icpitembatch.CPVarDecl
len=8
name='cData4
next=Icpitembatch.CPVarDecl
len=8
name='cData5
next=Icpitembatch.CPVarDecl
len=7
name='cOpePrg
next=Icpitembatch.CPVarDecl
len=7
name='cCli1
next=Icpitembatch.CPVarDecl
len=7
name='cCli2
next=Icpitembatch.CPVarDecl
len=7
name='cCli3
next=Icpitembatch.CPVarDecl
len=3
name='cValuta
next=Icpitembatch.CPVarDecl
len=7
name='xRif
next=Icpitembatch.CPVarDecl
len=7
name='xPrg
next=Icpitembatch.CPVarDecl
len=3
name='xPaese
next=Icpitembatch.CPVarDecl
len=128
name='_path
next=Icpitembatch.CPVarDecl
len=10
name='_rownum
next=Icpitembatch.CPVarDecl
len=10
name='_errrow
next=Icpitembatch.CPVarDecl
len=10
name='_conta
next=Icpitembatch.CPVarDecl
name='cRitorno
next=Icpitembatch.CPVarDecl
len=2
name='_tipointer
next=Icpitembatch.CPVarDecl
len=16
name='_cfinter
next=Icpitembatch.CPVarDecl
len=4
name='_specie
next=Icpitembatch.CPVarDecl
len=5
name='_area
next=Icpitembatch.CPVarDecl
len=10
name='_ateco
next=Icpitembatch.CPVarDecl
len=6
name='_istat
next=Icpitembatch.CPVarDecl
len=5
name='_cauint
next=Icpitembatch.CPVarDecl
len=4
name='_cautmp
next=Icpitembatch.CPVarDecl
len=4
name='_cauaui
next=Icpitembatch.CPVarDecl
len=50
name='_finalita
next=Icpitembatch.CPVarDecl
len=3
name='_caurischio
next=Icpitembatch.CPVarDecl
len=16
name='_cliente
next=Icpitembatch.CPVarDecl
len=16
name='_clinew
next=Icpitembatch.CPVarDecl
len=1
name='_flgcau
next=Icpitembatch.CPVarDecl
frm_seek='tbcauint
name='mcTBCAUINT
next=Icpitembatch.CPVarDecl
frm_seek='tbvalute
name='mcTBVALUTE
next=Icpitembatch.CPVarDecl
frm_seek='qbe_personbo_ope.vqr
name='mcPERSONBO
next=Icpitembatch.CPVarDecl
frm_seek='tmp_imp_sog
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_seek='tmp_imp_oper
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_seek='tmp_contante
name='mcContante
next=Icpitembatch.CPVarDecl
len=10
name='_imperr
next=Icpitembatch.CPVarDecl
len=1
name='xStatoReg
next=Icpitembatch.CPVarDecl
len=13
name='_numprog
next=Icpitembatch.CPVarDecl
dec=2
len=12
name='_totgen
next=Icpitembatch.CPVarDecl
len=10
name='xIMPPROG
next=Icpitembatch.CPVarDecl
len=10
name='_logmsg
next=Icpitembatch.CPVarDecl
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
len=15
name='nProgSto
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp
obj='Var
obj_type='N
pag=1
prev=O1302
I
obj='Var
obj_type='D
pag=1
prev=O1301
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O1300
I
obj='Var
pag=1
prev=O1299
I
obj='Var
obj_type='M
pag=1
prev=O1298
I
obj='Var
obj_type='N
pag=1
prev=O1297
I
obj='Var
obj_type='N
pag=1
prev=O1296
I
obj='Var
pag=1
prev=O1295
I
obj='Var
pag=1
prev=O1294
I
obj='Var
obj_type='N
pag=1
prev=O1293
I
obj='Var
obj_type='MC
pag=1
prev=O1292
I
obj='Var
obj_type='MC
pag=1
prev=O1291
I
obj='Var
obj_type='MC
pag=1
prev=O1290
I
obj='Var
obj_type='MC
pag=1
prev=O1289
I
obj='Var
obj_type='MC
pag=1
prev=O1288
I
obj='Var
obj_type='MC
pag=1
prev=O1287
I
obj='Var
pag=1
prev=O1286
I
obj='Var
pag=1
prev=O1285
I
obj='Var
pag=1
prev=O1284
I
obj='Var
obj_type='N
pag=1
prev=O1283
I
obj='Var
pag=1
prev=O1282
I
obj='Var
pag=1
prev=O1281
I
obj='Var
pag=1
prev=O1280
I
obj='Var
obj_type='N
pag=1
prev=O1279
I
obj='Var
pag=1
prev=O1278
I
obj='Var
pag=1
prev=O1277
I
obj='Var
pag=1
prev=O1276
I
obj='Var
pag=1
prev=O1275
I
obj='Var
pag=1
prev=O1274
I
obj='Var
pag=1
prev=O1273
I
obj='Var
pag=1
prev=O1272
I
obj='Var
obj_type='N
pag=1
prev=O1271
I
obj='Var
obj_type='N
pag=1
prev=O1270
I
obj='Var
obj_type='N
pag=1
prev=O1269
I
obj='Var
pag=1
prev=O1268
I
obj='Var
pag=1
prev=O1267
I
obj='Var
pag=1
prev=O1266
I
obj='Var
pag=1
prev=O1265
I
obj='Var
pag=1
prev=O1264
I
obj='Var
pag=1
prev=O1263
I
obj='Var
pag=1
prev=O1262
I
obj='Var
pag=1
prev=O1261
I
obj='Var
pag=1
prev=O1260
I
obj='Var
obj_type='D
pag=1
prev=O1259
I
obj='Var
obj_type='D
pag=1
prev=O1258
I
obj='Var
obj_type='D
pag=1
prev=O1257
I
obj='Var
obj_type='D
pag=1
prev=O1256
I
obj='Var
obj_type='D
pag=1
prev=O1255
I
obj='Var
obj_type='N
pag=1
prev=O1254
I
obj='Var
pag=1
prev=O1253
I
obj='Var
pag=1
prev=O1252
I
obj='Var
pag=1
prev=O1251
I
obj='Var
obj_type='M
pag=1
prev=O1250
I
obj='Var
pag=1
prev=O1249
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O1181
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
father=O1183
fatherSonIndex=0
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='Log
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Intermediario
global=True
len=11
name='gIntemediario
next=Icpitembatch.CPVarDecl
comment='Azienda
global=True
len=10
name='gAzienda
next=Icpitembatch.CPVarDecl
comment='Path Applicazione
global=True
len=80
name='gPathApp
next=Icpitembatch.CPVarDecl
comment='Path Documenti
global=True
len=80
name='gPathDoc
next=Icpitembatch.CPVarDecl
comment='Log Applicazione
global=True
len=1
name='cActLog
next=Icpitembatch.CPVarDecl
comment='Tipo Intermediario
global=True
len=2
name='gTipInter
nonlocal=True
obj='Var
pag=1
prev=O1313
I
nonlocal=True
obj='Var
pag=1
prev=O1312
I
nonlocal=True
obj='Var
pag=1
prev=O1311
I
nonlocal=True
obj='Var
pag=1
prev=O1310
I
nonlocal=True
obj='Var
pag=1
prev=O1309
I
nonlocal=True
obj='Var
pag=1
prev=O1308
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O1307
I
nonlocal=True
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1181
fatherSonIndex=0
len=100
name='w_nomefile
next=Icpitembatch.CPVarDecl
len=1
name='w_tipodest
next=Icpitembatch.CPVarDecl
len=1
name='w_tipofile
next=Icpitembatch.CPVarDecl
len=1
name='w_tipoform
next=Icpitembatch.CPVarDecl
len=30
name='w_PAGMEZ
next=Icpitembatch.CPVarDecl
len=1
name='pScheduler
obj='Var
pag=1
param=True
prev=O1322
I
obj='Var
pag=1
param=True
prev=O1321
I
obj='Var
pag=1
param=True
prev=O1320
I
obj='Var
pag=1
param=True
prev=O1319
I
obj='Var
pag=1
param=True
prev=O1318
I
obj='Var
pag=1
param=True
I
I
]
w=[
150
150
]
x=10
y=13
I
Icpitembatch.CPRemark
frm_calc='Import Contante
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Inizio Importazione Frazionate ...'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPBeginEnd
comment='Legge il file di testo (CSV o TXT) e lo importa nel MC
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Cicla sul MC e Scrive
h=[
19
19
]
obj='Begin
pag=5
prev=O1328
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Log
father=O1330
fatherSonIndex=0
frm_calc='gMsgProc + 'Inizio Import File alle ore '+arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'pScheduler='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_rownum
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
comment='Log
frm_calc='gMsgProc + 'Termine Import File alle ore '+arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Fine Elaborazione del file '+LRTrim(w_nomefile)+" alle ore "+arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'pScheduler='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Terminato Import Contante'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'cActLog='S'
]
h=[
19
19
]
obj='If
pag=5
prev=O1347
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='bat
father=O1348
fatherSonIndex=0
frm_calc='arrt_writelog('IMPORT','Contanti',LRTrim(w_nomefile),gMsgProc)
obj='Exec
pag=5
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=5
prev=O1344
var_op='asgn
I
obj='If
pag=5
prev=O1343
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Log
father=O1344
fatherSonIndex=0
frm_calc='_logmsg + 'Termine Import File alle ore '+arfn_fdatetime(DateTime()) + "<br>"
len=10
name='_logmsg
next=Icpitembatch.CPVarDecl
frm_calc='_logmsg + 'Fine Elaborazione del file '+LRTrim(w_nomefile)+" alle ore "+arfn_fdatetime(DateTime()) + "<br>"
len=10
name='_logmsg
obj='Var
obj_type='M
pag=5
prev=O1357
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1342
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1340
var_op='asgn
I
obj='Try
pag=5
prev=O1339
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1340
fatherSonIndex=0
frm_calc='''
len=13
name='_numprog
next=Icpitembatch.CPVarDecl
dec=2
frm_calc='0
len=12
name='_totgen
next=Icpitembatch.CPForEach
for_variable='rowContante
for_variable_type='tmp_contante
h=[
19
19
]
iterator_expr='mcContante
next=Icpitembatch.CPCase
frm_calc=[
'xRif='OD'
'xRif='OP'
'xRif='FD'
'xRif='FP'
]
h=[
19
19
19
19
19
]
next=Icpitembatch.CPTransaction
frm_calc='commit
next=Icpitembatch.CPVarDecl
comment='Log
frm_calc='gMsgProc + 'Sono state importate '+LRTrim(Str(_rownum,10,0))+' Righe Contante ...' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Log
frm_calc='gMsgProc + 'Sono state scartate '+LRTrim(Str(_errrow,10,0))+' Righe Contante ...' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Import definitivo dei dati concluso con successo" + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'pScheduler='S'
]
h=[
19
19
]
obj='If
pag=5
prev=O1372
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Log
father=O1373
fatherSonIndex=0
frm_calc='_logmsg + 'Sono state importate '+LRTrim(Str(_rownum,10,0))+' Righe Contante ...' + "<br>"
len=10
name='_logmsg
next=Icpitembatch.CPVarDecl
comment='Log
frm_calc='_logmsg + 'Sono state scartate '+LRTrim(Str(_errrow,10,0))+' Righe Contante ...' + "<br>"
len=10
name='_logmsg
next=Icpitembatch.CPVarDecl
frm_calc='_logmsg + "Import definitivo dei dati concluso con successo" + "<br>"
len=10
name='_logmsg
obj='Var
obj_type='M
pag=5
prev=O1379
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O1378
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1371
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1370
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1369
var_op='asgn
I
obj='Transaction
pag=5
prev=O1366
I
obj='Case
pag=5
prev=O1364
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='ope_contante
father=O1366
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'IDOPE
]
rd_kop=[
'=
]
rd_kvar=[
'xIDBASE
]
wr_field=[
'TOTALEGEN
]
wr_op=[
'=
]
wr_var=[
'_totgen
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xpe_contante
father=O1366
fatherSonIndex=1
obj='Write
pag=5
rd_kfield=[
'IDOPE
]
rd_kop=[
'=
]
rd_kvar=[
'xIDBASE
]
wr_field=[
'TOTALEGEN
]
wr_op=[
'=
]
wr_var=[
'_totgen
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='frz_contante
father=O1366
fatherSonIndex=2
obj='Write
pag=5
rd_kfield=[
'IDOPE
]
rd_kop=[
'=
]
rd_kvar=[
'xIDBASE
]
wr_field=[
'TOTALEGEN
]
wr_op=[
'=
]
wr_var=[
'_totgen
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xrz_contante
father=O1366
fatherSonIndex=3
obj='Write
pag=5
rd_kfield=[
'IDOPE
]
rd_kop=[
'=
]
rd_kvar=[
'xIDBASE
]
wr_field=[
'TOTALEGEN
]
wr_op=[
'=
]
wr_var=[
'_totgen
]
I
I
]
w=[
150
150
150
150
150
]
I
obj='ForEach
pag=5
prev=O1363
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Cerca l'operazione a cui collegare i contanti
father=O1364
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(xIDBASE))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1418
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1420
fatherSonIndex=0
frm_calc='iif(not(Empty(LRTrim(rowContante.ATECO_CON))),Left(LRTrim(rowContante.ATECO_CON)+"0000000000",6),'')
len=10
name='_ateco
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(rowContante.CODCOMCON))),Right('000000'+LRTrim(rowContante.CODCOMCON),6),'')
len=6
name='_istat
next=Icpitembatch.CPCase
frm_calc=[
'xRif='OD'
'xRif='OP'
'xRif='FD'
'xRif='FP'
]
h=[
19
19
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_rownum + 1
len=10
name='_rownum
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Sono state importate '+LRTrim(Str(_rownum,10,0))+' Righe Contante ...'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=5
prev=O1430
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1427
var_op='asgn
I
obj='Case
pag=5
prev=O1426
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='ope_contante
father=O1427
fatherSonIndex=0
obj='Merge
pag=5
rd_kfield=[
'IDOPE
'TAGLIO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xIDBASE
'rowContante.TAGLIO
]
wr_field=[
'IDOPE
'BILLSRIT
'BILLSSOV
'TIPATT
'TIPOATTIV
'CODICEGLN
'TAGLIO
'NBANCONOTE
'ABIINTER
'ABIPROPR
'GLNALTROSOG
'GLNALTRASC
'CODCLICON
'CODCOMCON
'ATECO_CON
'TOTALERIG
]
wr_mode=[
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xIDBASE
'iif(rowContante.TIPATT='RIT',rowContante.TOTBANKNOTE,0)
'iif(rowContante.TIPATT='SOV',rowContante.TOTBANKNOTE,0)
'rowContante.TIPATT
'rowContante.TIPOATTIV
'rowContante.CODICEGLN
'rowContante.TAGLIO
'rowContante.NBANCONOTE
'rowContante.ABIINTER
'rowContante.ABIPROPR
'rowContante.GLNALTROSOG
'rowContante.GLNALTRASC
'rowContante.CODCLICON
'_istat
'_ateco
'rowContante.TOTRIGA
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='xpe_contante
father=O1427
fatherSonIndex=1
obj='Merge
pag=5
rd_kfield=[
'IDOPE
'TAGLIO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xIDBASE
'rowContante.TAGLIO
]
wr_field=[
'IDOPE
'BILLSRIT
'BILLSSOV
'TIPATT
'TIPOATTIV
'CODICEGLN
'TAGLIO
'NBANCONOTE
'ABIINTER
'ABIPROPR
'GLNALTROSOG
'GLNALTRASC
'CODCLICON
'CODCOMCON
'ATECO_CON
'TOTALERIG
]
wr_mode=[
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xIDBASE
'iif(rowContante.TIPATT='RIT',rowContante.TOTBANKNOTE,0)
'iif(rowContante.TIPATT='SOV',rowContante.TOTBANKNOTE,0)
'rowContante.TIPATT
'rowContante.TIPOATTIV
'rowContante.CODICEGLN
'rowContante.TAGLIO
'rowContante.NBANCONOTE
'rowContante.ABIINTER
'rowContante.ABIPROPR
'rowContante.GLNALTROSOG
'rowContante.GLNALTRASC
'rowContante.CODCLICON
'_istat
'_ateco
'rowContante.TOTRIGA
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='frz_contante
father=O1427
fatherSonIndex=2
obj='Merge
pag=5
rd_kfield=[
'IDOPE
'TAGLIO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xIDBASE
'rowContante.TAGLIO
]
wr_field=[
'IDOPE
'BILLSRIT
'BILLSSOV
'TIPATT
'TIPOATTIV
'CODICEGLN
'TAGLIO
'NBANCONOTE
'ABIINTER
'ABIPROPR
'GLNALTROSOG
'GLNALTRASC
'CODCLICON
'CODCOMCON
'ATECO_CON
'TOTALERIG
]
wr_mode=[
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xIDBASE
'iif(rowContante.TIPATT='RIT',rowContante.TOTBANKNOTE,0)
'iif(rowContante.TIPATT='SOV',rowContante.TOTBANKNOTE,0)
'rowContante.TIPATT
'rowContante.TIPOATTIV
'rowContante.CODICEGLN
'rowContante.TAGLIO
'rowContante.NBANCONOTE
'rowContante.ABIINTER
'rowContante.ABIPROPR
'rowContante.GLNALTROSOG
'rowContante.GLNALTRASC
'rowContante.CODCLICON
'_istat
'_ateco
'rowContante.TOTRIGA
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='xrz_contante
father=O1427
fatherSonIndex=3
obj='Merge
pag=5
rd_kfield=[
'IDOPE
'TAGLIO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xIDBASE
'rowContante.TAGLIO
]
wr_field=[
'IDOPE
'BILLSRIT
'BILLSSOV
'TIPATT
'TIPOATTIV
'CODICEGLN
'TAGLIO
'NBANCONOTE
'ABIINTER
'ABIPROPR
'GLNALTROSOG
'GLNALTRASC
'CODCLICON
'CODCOMCON
'ATECO_CON
'TOTALERIG
]
wr_mode=[
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xIDBASE
'iif(rowContante.TIPATT='RIT',rowContante.TOTBANKNOTE,0)
'iif(rowContante.TIPATT='SOV',rowContante.TOTBANKNOTE,0)
'rowContante.TIPATT
'rowContante.TIPOATTIV
'rowContante.CODICEGLN
'rowContante.TAGLIO
'rowContante.NBANCONOTE
'rowContante.ABIINTER
'rowContante.ABIPROPR
'rowContante.GLNALTROSOG
'rowContante.GLNALTRASC
'rowContante.CODCLICON
'_istat
'_ateco
'rowContante.TOTRIGA
]
I
I
]
w=[
150
150
150
150
150
]
I
obj='Var
pag=5
prev=O1425
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1420
fatherSonIndex=1
frm_calc='0
len=10
name='xIMPPROG
next=Icpitembatch.CPRead
arch='scarti_import
next=Icpitembatch.CPIfElse
frm_calc=[
'xIMPPROG <> 0
]
h=[
19
19
]
obj='If
pag=5
prev=O1472
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='scarto_contante
father=O1473
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='_errrow + 1
len=10
name='_errrow
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Sono state scartate '+LRTrim(Str(_errrow,10,0))+' Righe Contante ...'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=5
prev=O1479
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1478
var_op='asgn
I
obj='Insert
pag=5
rd_kfield=[
'NUMPROG
'TIPATT
'TIPOATTIV
'CODICEGLN
'TOTBANKNOTE
'TAGLIO
'NBANCONOTE
'ABIINTER
'ABIPROPR
'GLNALTROSOG
'GLNALTRASC
'CODCLICON
'CODCOMCON
'ATECO_CON
'CODDIPE
'IMPPROG
'TOTRIGA
]
rd_kvar=[
'rowContante.NUMPROG
'rowContante.TIPATT
'rowContante.TIPOATTIV
'rowContante.CODICEGLN
'rowContante.TOTBANKNOTE
'rowContante.TAGLIO
'rowContante.NBANCONOTE
'rowContante.ABIINTER
'rowContante.ABIPROPR
'rowContante.GLNALTROSOG
'rowContante.GLNALTRASC
'rowContante.CODCLICON
'rowContante.CODCOMCON
'rowContante.ATECO_CON
'rowContante.CODDIPE
'rowContante.IMPPROG
'rowContante.TOTRIGA
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O1471
rd_field=[
'IMPPROG
]
rd_kfield=[
'IMPPROG13
]
rd_kvar=[
'LRTrim(rowContante.IMPPROG)
]
rd_var=[
'xIMPPROG
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1418
fatherSonIndex=0
frm_calc=[
'_numprog <> rowContante.IMPPROG
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xIDBASE
next=Icpitembatch.CPVarDecl
frm_calc='''
len=7
name='xRif
next=Icpitembatch.CPRead
arch='operazbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xIDBASE)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1496
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O1497
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xIDBASE)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1502
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O1503
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xIDBASE)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1508
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O1509
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(xIDBASE))
]
h=[
19
19
]
obj='If
pag=5
prev=O1514
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1515
fatherSonIndex=0
frm_calc=''FP'
len=7
name='xRif
next=Icpitembatch.CPWrite
arch='xraziobo
obj='Write
pag=5
prev=O1520
rd_kfield=[
'IMPPROG
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(rowContante.IMPPROG)
]
wr_field=[
'TIPATT
'CODCLICON
'CODANA
]
wr_op=[
'=
'=
'=
]
wr_var=[
'rowContante.TIPATT
'rowContante.CODCLICON
'iif(rowContante.TIPATT='SOV','8199','8101')
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
rd_field=[
'IDBASE
]
rd_kfield=[
'IMPPROG
]
rd_kvar=[
'LRTrim(rowContante.IMPPROG)
]
rd_var=[
'xIDBASE
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1509
fatherSonIndex=1
frm_calc=''FD'
len=7
name='xRif
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=5
prev=O1534
rd_kfield=[
'IMPPROG
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(rowContante.IMPPROG)
]
wr_field=[
'TIPATT
'CODCLICON
'CODANA
]
wr_op=[
'=
'=
'=
]
wr_var=[
'rowContante.TIPATT
'rowContante.CODCLICON
'iif(rowContante.TIPATT='SOV','8199','8101')
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=5
rd_field=[
'IDBASE
]
rd_kfield=[
'IMPPROG
]
rd_kvar=[
'LRTrim(rowContante.IMPPROG)
]
rd_var=[
'xIDBASE
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1503
fatherSonIndex=1
frm_calc=''OP'
len=7
name='xRif
next=Icpitembatch.CPWrite
arch='xperazbo
obj='Write
pag=5
prev=O1548
rd_kfield=[
'IMPPROG
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(rowContante.IMPPROG)
]
wr_field=[
'TIPATT
'CODCLICON
'CODANA
]
wr_op=[
'=
'=
'=
]
wr_var=[
'rowContante.TIPATT
'rowContante.CODCLICON
'iif(rowContante.TIPATT='SOV','8199','8101')
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=5
rd_field=[
'IDBASE
]
rd_kfield=[
'IMPPROG
]
rd_kvar=[
'LRTrim(rowContante.IMPPROG)
]
rd_var=[
'xIDBASE
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1497
fatherSonIndex=1
frm_calc=''OD'
len=7
name='xRif
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=5
prev=O1562
rd_kfield=[
'IMPPROG
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(rowContante.IMPPROG)
]
wr_field=[
'TIPATT
'CODCLICON
'CODANA
]
wr_op=[
'=
'=
'=
]
wr_var=[
'rowContante.TIPATT
'rowContante.CODCLICON
'iif(rowContante.TIPATT='SOV','8199','8101')
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=5
prev=O1495
rd_field=[
'IDBASE
]
rd_kfield=[
'IMPPROG
]
rd_kvar=[
'LRTrim(rowContante.IMPPROG)
]
rd_var=[
'xIDBASE
]
I
obj='Var
pag=5
prev=O1494
var_op='asgn
I
obj='Var
pag=5
prev=O1491
var_op='asgn
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1491
fatherSonIndex=0
frm_calc=[
'_numprog <> ''
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='rowContante.IMPPROG
len=13
name='_numprog
next=Icpitembatch.CPVarDecl
dec=2
frm_calc='rowContante.TOTRIGA
len=12
name='_totgen
obj='Var
obj_type='N
pag=5
prev=O1580
var_op='asgn
I
obj='Var
pag=5
prev=O1577
var_op='asgn
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O1577
fatherSonIndex=0
frm_calc=[
'xRif='OD'
'xRif='OP'
'xRif='FD'
'xRif='FP'
]
h=[
19
19
19
19
19
]
obj='Case
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='ope_contante
father=O1584
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'IDOPE
]
rd_kop=[
'=
]
rd_kvar=[
'xIDBASE
]
wr_field=[
'TOTALEGEN
]
wr_op=[
'=
]
wr_var=[
'_totgen
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xpe_contante
father=O1584
fatherSonIndex=1
obj='Write
pag=5
rd_kfield=[
'IDOPE
]
rd_kop=[
'=
]
rd_kvar=[
'xIDBASE
]
wr_field=[
'TOTALEGEN
]
wr_op=[
'=
]
wr_var=[
'_totgen
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='frz_contante
father=O1584
fatherSonIndex=2
obj='Write
pag=5
rd_kfield=[
'IDOPE
]
rd_kop=[
'=
]
rd_kvar=[
'xIDBASE
]
wr_field=[
'TOTALEGEN
]
wr_op=[
'=
]
wr_var=[
'_totgen
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xrz_contante
father=O1584
fatherSonIndex=3
obj='Write
pag=5
rd_kfield=[
'IDOPE
]
rd_kop=[
'=
]
rd_kvar=[
'xIDBASE
]
wr_field=[
'TOTALEGEN
]
wr_op=[
'=
]
wr_var=[
'_totgen
]
I
I
]
w=[
150
150
150
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
dec=2
father=O1491
fatherSonIndex=1
frm_calc='_totgen + rowContante.TOTRIGA
len=12
name='_totgen
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1362
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1340
fatherSonIndex=1
frm_calc=''KO'
name='cRitorno
next=Icpitembatch.CPTransaction
frm_calc='rollback
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Errore nell'import definitivo dei dati: "+ NL + m_cLastMsgError + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'pScheduler='S'
]
h=[
19
19
]
obj='If
pag=5
prev=O1630
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1631
fatherSonIndex=0
frm_calc='_logmsg +  "Errore nell'import definitivo dei dati: " + m_cLastMsgError + "<br>"
len=10
name='_logmsg
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1629
var_op='asgn
I
obj='Transaction
pag=5
prev=O1628
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=5
prev=O1338
I
obj='Var
obj_type='N
pag=5
prev=O1335
var_op='asgn
I
obj='If
pag=5
prev=O1334
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Log
father=O1335
fatherSonIndex=0
frm_calc='_logmsg + 'Inizio Import File alle ore '+arfn_fdatetime(DateTime()) + "<br>"
len=10
name='_logmsg
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
prev=O1327
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Log
father=O1328
fatherSonIndex=0
frm_calc='gMsgProc + 'Inizio Controllo File alle ore '+arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'pScheduler='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='-1
len=10
name='_rownum
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_errrow
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipoform = 'C'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Log
frm_calc='gMsgProc + 'Sono state controllate '+LRTrim(Str(_rownum,10,0))+' Righe Contanti ...' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Log
frm_calc='gMsgProc + 'Termine Controllo File alle ore '+arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'pScheduler='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Terminato Controllo Frazionate'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=5
prev=O1657
var_op='asgn
I
obj='If
pag=5
prev=O1656
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1657
fatherSonIndex=0
frm_calc='_logmsg +  'Sono state controllate '+LRTrim(Str(_rownum,10,0))+' Righe Contanti ...' + "<br>"
len=10
name='_logmsg
next=Icpitembatch.CPVarDecl
frm_calc='_logmsg + 'Termine Controllo File alle ore '+arfn_fdatetime(DateTime()) + "<br>"
len=10
name='_logmsg
obj='Var
obj_type='M
pag=5
prev=O1663
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1655
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1652
var_op='asgn
I
obj='If
pag=5
prev=O1651
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1652
fatherSonIndex=0
frm_calc='LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+"/"+LRTrim(w_nomefile)
len=80
name='filename
next=Icpitembatch.CPExec
check='man
frm_calc='FileReader freader=new FileReader(filename);﷯CSVReader reader = new CSVReader(freader);﷯String [] nextLine;﷯while ((nextLine = reader.readNext()) != null) {
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Sono state controllate '+LRTrim(Str(_rownum,10,0))+' Righe Contanti ...'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPExec
check='man
frm_calc='}﷯// Chiuse il file﷯reader.close();
obj='Exec
pag=5
prev=O1672
I
nonlocal=True
obj='Var
pag=5
prev=O1670
var_op='asgn
I
obj='Try
pag=5
prev=O1669
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1670
fatherSonIndex=0
frm_calc=[
'_rownum >= 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_rownum + 1
len=10
name='_rownum
obj='Var
obj_type='N
pag=5
prev=O1676
var_op='asgn
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1676
fatherSonIndex=0
frm_seek='AppendBlank
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[0]
frm_seek='NUMPROG
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[1]
frm_seek='TIPATT
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[2]
frm_seek='TIPOATTIV
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[3]
frm_seek='CODICEGLN
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='Val(nextLine[4])
frm_seek='TOTBANKNOTE
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='Val(nextLine[5])
frm_seek='TAGLIO
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='Val(nextLine[6])
frm_seek='NBANCONOTE
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[7]
frm_seek='ABIINTER
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[8]
frm_seek='ABIPROPR
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[9]
frm_seek='GLNALTROSOG
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[10]
frm_seek='GLNALTRASC
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[11]
frm_seek='CODCLICON
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[12]
frm_seek='CODCOMCON
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[13]
frm_seek='ATECO_CON
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[14]
frm_seek='IMPPROG
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='Val(nextLine[15])
frm_seek='TOTRIGA
name='mcContante
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcContante
obj='Var
obj_type='MC
pag=5
prev=O1698
var_op='meth
I
obj='Var
obj_type='MC
pag=5
prev=O1697
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1696
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1695
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1694
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1693
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1692
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1691
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1690
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1689
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1688
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1687
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1686
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1685
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1684
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1683
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1682
var_op='prop
I
obj='Var
obj_type='MC
pag=5
var_op='meth
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1670
fatherSonIndex=1
frm_calc='gMsgProc + 'Riga Numero: '+LRTrim(Str(_rownum,10,0)) + " " + m_cLastMsgError + NL
len=10
name='gMsgProc
next=Icpitembatch.CPInsert
arch='tmp_erroriimp
next=Icpitembatch.CPTransaction
frm_calc='accept error
obj='Transaction
pag=5
prev=O1703
I
obj='Insert
pag=5
prev=O1702
rd_kfield=[
'numriga
'errormsg
]
rd_kvar=[
'_rownum
'm_cLastMsgError
]
I
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=5
prev=O1668
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1652
fatherSonIndex=1
frm_calc='FileLibrary.OpenRead('appo/'+LRTrim(gAzienda)+LRTrim(w_nomefile))
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibrary.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibrary.Close(fhand)
obj='Exec
pag=5
prev=O1710
I
obj='While
pag=5
prev=O1709
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1710
fatherSonIndex=0
frm_calc='FileLibrary.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Trasferimento
frm_calc=''Sono state controllate '+LRTrim(Str(_rownum,10,0))+' righe Contante ...'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=5
prev=O1716
var_op='asgn
I
obj='Try
pag=5
prev=O1715
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1716
fatherSonIndex=0
frm_calc='_rownum + 1
len=10
name='_rownum
next=Icpitembatch.CPVarDecl
frm_seek='AppendBlank
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='Left(riga,11)
frm_seek='NUMPROG
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,12,3)
frm_seek='TIPATT
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,15,2)
frm_seek='TIPOATTIV
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,17,13)
frm_seek='CODICEGLN
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='Val(Substr(riga,30,10))
frm_seek='TOTBANKNOTE
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='Val(Substr(riga,40,4))
frm_seek='TAGLIO
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='Val(Substr(riga,44,10))
frm_seek='NBANCONOTE
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,54,5)
frm_seek='ABIINTER
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,59,5)
frm_seek='ABIPROPR
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,64,13)
frm_seek='GLNALTROSOG
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,77,13)
frm_seek='GLNALTRASC
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,90,20)
frm_seek='CODCLICON
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,110,6)
frm_seek='CODCOMCON
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,116,10)
frm_seek='ATECO_CON
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,126,13)
frm_seek='IMPPROG
name='mcContante
next=Icpitembatch.CPVarDecl
frm_calc='Val(Substr(riga,139,12))
frm_seek='TOTRIGA
name='mcContante
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcContante
obj='Var
obj_type='MC
pag=5
prev=O1738
var_op='meth
I
obj='Var
obj_type='MC
pag=5
prev=O1737
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1736
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1735
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1734
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1733
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1732
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1731
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1730
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1729
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1728
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1727
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1726
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1725
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1724
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1723
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1722
var_op='prop
I
obj='Var
obj_type='MC
pag=5
prev=O1721
var_op='meth
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1716
fatherSonIndex=1
frm_calc='gMsgProc + 'Riga Numero: '+LRTrim(Str(_rownum,10,0)) + " " + m_cLastMsgError + NL
len=10
name='gMsgProc
next=Icpitembatch.CPInsert
arch='tmp_erroriimp
next=Icpitembatch.CPTransaction
frm_calc='accept error
obj='Transaction
pag=5
prev=O1742
I
obj='Insert
pag=5
prev=O1741
rd_kfield=[
'numriga
'errormsg
]
rd_kvar=[
'_rownum
'm_cLastMsgError
]
I
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1650
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1647
var_op='asgn
I
obj='If
pag=5
prev=O1646
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1647
fatherSonIndex=0
frm_calc='_logmsg + 'Inizio Controllo File alle ore '+arfn_fdatetime(DateTime()) + "<br>"
len=10
name='_logmsg
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=5
prev=O1326
I
nonlocal=True
obj='Var
pag=5
prev=O1325
var_op='asgn
I
obj='Remark
pag=5
x=10
y=20
I
Icpitembatch.CPBeginEnd
comment='Variabili locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Trova il codice cliente (se esiste)
h=[
19
19
]
obj='Begin
pag=6
prev=O1754
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1756
fatherSonIndex=0
frm_calc='''
len=16
name='_clinew
next=Icpitembatch.CPVarDecl
frm_calc=''S'
len=1
name='_flgfind
next=Icpitembatch.CPForEach
for_variable='rowPersonbo
for_variable_type='qbe_personbo_ope.vqr
h=[
19
19
]
iterator_expr='mcPERSONBO
next=Icpitembatch.CPIfElse
frm_calc=[
'_flgcau='S' and _flgfind='S' and not(Empty(_clinew))
]
h=[
19
19
]
obj='If
pag=6
prev=O1762
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1764
fatherSonIndex=0
frm_calc='iif(Empty(_cautmp),_cauint,Val(_cautmp))
len=5
name='_cauint
next=Icpitembatch.CPIfElse
frm_calc=[
'_cauint <> 0
]
h=[
19
19
]
obj='If
pag=6
prev=O1769
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O1770
fatherSonIndex=0
for_variable='rowCausale
for_variable_type='tbcauint
h=[
19
19
]
iterator_expr='mcTBCAUINT
obj='ForEach
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1775
fatherSonIndex=0
frm_calc=[
'rowCausale.CICODICE=_cauint
]
h=[
19
19
]
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1779
fatherSonIndex=0
frm_calc='rowCausale.CICAUCOD
len=4
name='_cauaui
next=Icpitembatch.CPVarDecl
frm_calc='rowCausale.CIFINALIT
len=50
name='_finalita
next=Icpitembatch.CPVarDecl
frm_calc='rowCausale.CIRISCHIO
len=3
name='_caurischio
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=6
prev=O1786
I
obj='Var
obj_type='N
pag=6
prev=O1785
var_op='asgn
I
obj='Var
pag=6
prev=O1784
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=6
prev=O1761
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1762
fatherSonIndex=0
frm_calc=[
'(rowPersonbo.CONNES=_cliente or rowPersonbo.CODFISC=_cliente or rowPersonbo.PARTIVA=_cliente)
]
h=[
19
19
]
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1794
fatherSonIndex=0
frm_calc='rowPersonbo.CONNES
len=16
name='_clinew
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=6
prev=O1799
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
pagelocal=True
prev=O1760
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1754
fatherSonIndex=0
len=1
name='_flgfind
obj='Var
pag=6
pagelocal=True
I
I
]
w=[
150
150
]
x=14
y=21
I
]
ManualBlocks={
'BO - Header
Icpmanualblocks.CPManualBlocks
code='import java.io.FileReader;﷯import java.io.IOException;﷯import java.io.StringWriter;﷯import java.util.List;﷯import com.opencsv.CSVWriter;﷯import com.opencsv.CSVReader;
name='BO - Header
I
}
comment='Importa i dati
date_creat=#2006-06-20
date_rev=#2023-03-09
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'FileLibrary
'Utilities
]
modcnt=327
page_result_class=[
'
'
'
'
'
'
]
page_result_type=[
'U
'U
'U
'U
'U
'U
]
page_uid=[
'NFFBQZAASH
'LDRQGITJBK
'NLHAOARMZB
'BQFOYVFGOS
'YPOWHCAPGP
'DCVNUBVKWV
]
pagename=[
'Page_1
'Page_2
'Page_3
'Page_4
'Page_5
'Page_6
]
pagenote=[
'
'
'
'
'
'
]
pagetitle=[
'Main
'Soggetti
'Operazioni
'Frazionate
'Contante
'Trova codice cliente
]
result_type='C
runtime_filters=2
tpl_name='Function
work_file=[
'fraziobo
'frz_contante
'intermbo
'ope_contante
'operazbo
'personbo
'scarti_import
'scarto_contante
'tbcauint
'tbcitta
'tbstati
'tbvalute
'tmp_erroriimp
'xpe_contante
'xrz_contante
'xperazbo
'xraziobo
'wersonbo
'zperazbo
]
work_filter=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
I
*--*
*----*
