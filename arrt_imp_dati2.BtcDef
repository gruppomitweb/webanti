* --- CodePainter Revolution Batch Vers. 5.1
￼Icpbatch.CPBatch
Items=[
Icpitembatch.CPBeginEnd
comment='Definizione variabili caller
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili Locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='variabili copia
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='variabili locali per decoprimere il file
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili globali
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Legge dati intermediario per metteri su operazbo,fraziobo,rapopebo se mancanti
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Import Soggetti
next=Icpitembatch.CPVarDecl
frm_calc='''
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPRemark
frm_calc='Cicla sul file della lista e lancia la pagina appropriata
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_esito
next=Icpitembatch.CPExec
check='page
frm_calc='27
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_chkerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_opeerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_frzerr
next=Icpitembatch.CPIfElse
frm_calc=[
'w_chkaui='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_chkaui = 'N' or (w_chkaui='S' and w_imperr='S') or  (w_chkaui='S' and w_imperr='N' and _chkerr=0)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O28
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDropTemporaryTable
father=O31
fatherSonIndex=0
next=Icpitembatch.CPServerTemporaryTable
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWrite('./output/'+LRTrim(gAzienda)+'/archope_scarti')
len=1
name='ohand
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWrite('./output/'+LRTrim(gAzienda)+'/archfraz_scarti')
len=1
name='zhand
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWrite('./output/'+LRTrim(gAzienda)+'/opex_scarti')
len=1
name='xhand
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWrite('./output/'+LRTrim(gAzienda)+'/saldopex_scarti')
len=1
name='shand
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
obj='Try
pag=1
prev=O42
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O43
fatherSonIndex=0
frm_calc=[
'gFlgRet='S'
]
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione dati. Inizio fase di commit. Attendere prego...'
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'_esito=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPBeginEnd
comment='Scrittura file con errori
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Importazione dati terminata.'
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O56
var_op='asgn
I
obj='Begin
pag=1
prev=O53
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O56
fatherSonIndex=0
frm_calc='FileLibMit.Close(ohand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(zhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(xhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(shand)
next=Icpitembatch.CPIfElse
frm_calc=[
'_opeerr=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_frzerr=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_opxerr=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_soxerr=0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O71
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O74
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/saldopex_scarti')
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O74
fatherSonIndex=1
frm_calc='1
len=1
name='w_fscarti
next=Icpitembatch.CPVarDecl
frm_calc='"saldopex_scarti.zip"
len=20
name='_czip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/"+_czip
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/saldopex_scarti"
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='"saldopex_scarti"
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc='// These are the files to include in the ZIP file﷯filenames.clear();﷯fileonames.clear();﷯filenames.add(cNomeFile);﷯fileonames.add(cOnlyNomeFile);
next=Icpitembatch.CPExec
check='page
frm_calc='36
next=Icpitembatch.CPInsert
arch='tmp_listafile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevate operazioni extraconto senza i dati del soggetto. Prelevare il file opex_scarti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/opex_scarti')
obj='Exec
pag=1
prev=O89
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O88
var_op='asgn
I
obj='Insert
pag=1
prev=O87
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
''opex_scarti'
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/opex_scarti.zip"
]
I
obj='Exec
pag=1
prev=O86
I
obj='Exec
pag=1
prev=O85
I
obj='Var
pag=1
prev=O84
var_op='asgn
I
obj='Var
pag=1
prev=O83
var_op='asgn
I
obj='Var
pag=1
prev=O82
var_op='asgn
I
obj='Var
pag=1
prev=O81
var_op='asgn
I
obj='Var
obj_type='N
pag=1
param=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=1
prev=O68
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O71
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/opex_scarti')
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O71
fatherSonIndex=1
frm_calc='1
len=1
name='w_fscarti
next=Icpitembatch.CPVarDecl
frm_calc='"opex_scarti.zip"
len=20
name='_czip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/"+_czip
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/opex_scarti"
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='"opex_scarti"
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc='// These are the files to include in the ZIP file﷯filenames.clear();﷯fileonames.clear();﷯filenames.add(cNomeFile);﷯fileonames.add(cOnlyNomeFile);
next=Icpitembatch.CPExec
check='page
frm_calc='36
next=Icpitembatch.CPInsert
arch='tmp_listafile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevate operazioni extraconto senza i dati del soggetto. Prelevare il file opex_scarti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/opex_scarti')
obj='Exec
pag=1
prev=O106
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O105
var_op='asgn
I
obj='Insert
pag=1
prev=O104
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
''opex_scarti'
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/opex_scarti.zip"
]
I
obj='Exec
pag=1
prev=O103
I
obj='Exec
pag=1
prev=O102
I
obj='Var
pag=1
prev=O101
var_op='asgn
I
obj='Var
pag=1
prev=O100
var_op='asgn
I
obj='Var
pag=1
prev=O99
var_op='asgn
I
obj='Var
pag=1
prev=O98
var_op='asgn
I
obj='Var
obj_type='N
pag=1
param=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=1
prev=O65
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O68
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/archfraz_scarti')
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O68
fatherSonIndex=1
frm_calc='1
len=1
name='w_fscarti
next=Icpitembatch.CPVarDecl
frm_calc='"archfraz_scarti.zip"
len=20
name='_czip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/"+_czip
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/archfraz_scarti"
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='"archfraz_scarti"
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc='// These are the files to include in the ZIP file﷯filenames.clear();﷯fileonames.clear();﷯filenames.add(cNomeFile);﷯fileonames.add(cOnlyNomeFile);
next=Icpitembatch.CPExec
check='page
frm_calc='36
next=Icpitembatch.CPInsert
arch='tmp_listafile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevate frazionate senza i dati del soggetto. Prelevare il file archfraz_scarti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/archfraz_scarti')
obj='Exec
pag=1
prev=O123
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O122
var_op='asgn
I
obj='Insert
pag=1
prev=O121
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
''archfraz_scarti'
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/archfraz_scarti.zip"
]
I
obj='Exec
pag=1
prev=O120
I
obj='Exec
pag=1
prev=O119
I
obj='Var
pag=1
prev=O118
var_op='asgn
I
obj='Var
pag=1
prev=O117
var_op='asgn
I
obj='Var
pag=1
prev=O116
var_op='asgn
I
obj='Var
pag=1
prev=O115
var_op='asgn
I
obj='Var
obj_type='N
pag=1
param=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=1
prev=O64
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O65
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/archope_scarti')
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O65
fatherSonIndex=1
frm_calc='1
len=1
name='w_fscarti
next=Icpitembatch.CPVarDecl
frm_calc='"archope_scarti.zip"
len=20
name='_czip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/"+_czip
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/archope_scarti"
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='"archope_scarti"
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc='// These are the files to include in the ZIP file﷯filenames.clear();﷯fileonames.clear();﷯filenames.add(cNomeFile);﷯fileonames.add(cOnlyNomeFile);
next=Icpitembatch.CPExec
check='page
frm_calc='36
next=Icpitembatch.CPInsert
arch='tmp_listafile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevate operazioni senza i dati del soggetto. Prelevare il file archope_scarti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/archope_scarti')
obj='Exec
pag=1
prev=O140
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O139
var_op='asgn
I
obj='Insert
pag=1
prev=O138
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
''archope_scarti'
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/archope_scarti.zip"
]
I
obj='Exec
pag=1
prev=O137
I
obj='Exec
pag=1
prev=O136
I
obj='Var
pag=1
prev=O135
var_op='asgn
I
obj='Var
pag=1
prev=O134
var_op='asgn
I
obj='Var
pag=1
prev=O133
var_op='asgn
I
obj='Var
pag=1
prev=O132
var_op='asgn
I
obj='Var
obj_type='N
pag=1
param=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=1
prev=O63
I
obj='Exec
pag=1
prev=O62
I
obj='Exec
pag=1
prev=O61
I
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O52
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O53
fatherSonIndex=0
frm_calc='commit
obj='Transaction
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O53
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=1
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O50
var_op='asgn
I
obj='Select
pag=1
prev=O47
sel_field='*
sel_name='tmp_list_imprich
sel_order='tmp_list_imprich->priorita,tmp_list_imprich->nomefile
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O50
fatherSonIndex=0
frm_calc=[
'_esito = 0
]
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='tmp_list_imprich
obj='Delete
pag=1
prev=O154
rd_kfield=[
'nomefile
]
rd_kop=[
'=
]
rd_kvar=[
'tmp_list_imprich->nomefile
]
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O154
fatherSonIndex=0
frm_calc='LRTrim(tmp_list_imprich->nomefile)
len=50
name='nomefileimport
next=Icpitembatch.CPCase
frm_calc=[
'At('archpers.txt',Lower(nomefileimport)) <> 0
'At('archdip.txt',Lower(nomefileimport)) <> 0
'At('archtito.txt',Lower(nomefileimport)) <> 0
'At('sogcli.txt',Lower(nomefileimport)) <> 0
'At('archrap.txt',Lower(nomefileimport)) <> 0
'At('archinf.txt',Lower(nomefileimport)) <> 0
'At('archope.txt',Lower(nomefileimport)) <> 0
'At('archfraz.txt',Lower(nomefileimport)) <> 0
'At('intest.txt',Lower(nomefileimport)) <> 0
'At('rapage.txt',Lower(nomefileimport)) <> 0
'At('infage.txt',Lower(nomefileimport)) <> 0
'At('opeage.txt',Lower(nomefileimport)) <> 0
'At('procdel.txt',Lower(nomefileimport)) <> 0
'At('procage.txt',Lower(nomefileimport)) <> 0
'At('sogope.txt',Lower(nomefileimport)) <> 0
'At('sogage.txt',Lower(nomefileimport)) <> 0
'At('intage.txt',Lower(nomefileimport)) <> 0
'At('sogben.txt',Lower(nomefileimport)) <> 0
'At('sogaltro.txt',Lower(nomefileimport)) <> 0
'At('persnew.txt',Lower(nomefileimport)) <> 0
'At('saldopex.txt',Lower(nomefileimport)) <> 0 or At('saldopex.xls',Lower(nomefileimport)) <> 0
'At('saldrapp.txt',Lower(nomefileimport)) <> 0 or At('saldrapp.xls',Lower(nomefileimport)) <> 0
'At('opex.txt',Lower(nomefileimport)) <> 0
'At('titosupp.txt',Lower(nomefileimport)) <> 0
'At('archope.xls',Lower(nomefileimport)) <> 0
'At('agetit.txt',Lower(nomefileimport)) <> 0
'At('agetsupp.txt',Lower(nomefileimport)) <> 0
'At('saldisv.txt',Lower(nomefileimport)) <> 0
]
h=[
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
]
obj='Case
pag=1
prev=O163
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O164
fatherSonIndex=0
frm_calc='2
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O164
fatherSonIndex=1
frm_calc='14
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O164
fatherSonIndex=2
frm_calc='15
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O164
fatherSonIndex=3
frm_calc='26
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O164
fatherSonIndex=4
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O177
fatherSonIndex=0
frm_calc='7
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O177
fatherSonIndex=1
frm_calc='3
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O164
fatherSonIndex=5
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O187
fatherSonIndex=0
frm_calc='8
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O187
fatherSonIndex=1
frm_calc='4
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O164
fatherSonIndex=6
frm_calc=[
'w_flgimposv='S'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O197
fatherSonIndex=0
frm_calc='43
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O197
fatherSonIndex=1
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O204
fatherSonIndex=0
frm_calc='9
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O204
fatherSonIndex=1
frm_calc='5
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O164
fatherSonIndex=7
frm_calc=[
'w_flgimposv='S'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O215
fatherSonIndex=0
frm_calc='43
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O215
fatherSonIndex=1
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O222
fatherSonIndex=0
frm_calc='10
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O222
fatherSonIndex=1
frm_calc='6
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O164
fatherSonIndex=8
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O233
fatherSonIndex=0
frm_calc='22
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O233
fatherSonIndex=1
frm_calc='19
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O164
fatherSonIndex=9
frm_calc='11
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O164
fatherSonIndex=10
frm_calc='12
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O164
fatherSonIndex=11
frm_calc='13
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O164
fatherSonIndex=12
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O249
fatherSonIndex=0
frm_calc='20
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O249
fatherSonIndex=1
frm_calc='17
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O164
fatherSonIndex=13
frm_calc='23
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O164
fatherSonIndex=14
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O261
fatherSonIndex=0
frm_calc='21
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O261
fatherSonIndex=1
frm_calc='18
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O164
fatherSonIndex=15
frm_calc='24
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O164
fatherSonIndex=16
frm_calc='25
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O164
fatherSonIndex=17
frm_calc='28
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O164
fatherSonIndex=18
frm_calc='29
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O164
fatherSonIndex=19
frm_calc='30
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O164
fatherSonIndex=20
frm_calc='33
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O164
fatherSonIndex=21
frm_calc='34
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O164
fatherSonIndex=22
frm_calc='16
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O164
fatherSonIndex=23
frm_calc='35
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O164
fatherSonIndex=24
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O289
fatherSonIndex=0
frm_calc='38
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O289
fatherSonIndex=1
frm_calc='37
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O164
fatherSonIndex=25
frm_calc='40
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O164
fatherSonIndex=26
frm_calc='41
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O164
fatherSonIndex=27
frm_calc='42
obj='Exec
pag=1
I
I
]
w=[
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
]
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intermbo
father=O47
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='xersonbo
next=Icpitembatch.CPDelete
arch='xarchope
next=Icpitembatch.CPDelete
arch='xarchfraz
next=Icpitembatch.CPDelete
arch='xnadip
obj='Delete
pag=1
prev=O312
sel_type='all
I
obj='Delete
pag=1
prev=O311
sel_type='all
I
obj='Delete
pag=1
prev=O310
sel_type='all
I
obj='Delete
pag=1
prev=O309
sel_type='all
I
obj='Write
pag=1
sel_type='all
wr_field=[
'SBLRITORNO
]
wr_op=[
'=
]
wr_var=[
''N'
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O43
fatherSonIndex=1
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Rilevati errori nell'impotazione dei file! Ricreare il file segnalato e rieseguire l'import dei dati. La procedura annullera automaticamente l'importazione" + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Errore SQL: ' + m_Sql.TransactionErrorMessage() + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='rollback
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(ohand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(zhand)
obj='Exec
pag=1
prev=O323
I
obj='Exec
pag=1
prev=O322
I
obj='Transaction
pag=1
prev=O321
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O320
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O319
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=1
prev=O41
I
obj='Var
pag=1
prev=O40
var_op='asgn
I
obj='Var
pag=1
prev=O39
var_op='asgn
I
obj='Var
pag=1
prev=O38
var_op='asgn
I
obj='Var
pag=1
prev=O37
var_op='asgn
I
obj='TempTable
pag=1
prev=O36
sel_type='def
server_table='tmp_listafile
I
obj='DropTempTable
pag=1
server_table='tmp_listafile
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O31
fatherSonIndex=1
frm_calc='gMsgProc + 'Sono state rilevati errori nei dati anagrafici. Effettuare la stampa' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Elaborazione terminata.'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=1
prev=O327
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=1
prev=O27
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O28
fatherSonIndex=0
frm_calc='32
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O26
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O25
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O24
var_op='asgn
I
obj='Exec
pag=1
prev=O23
I
obj='Var
obj_type='N
pag=1
prev=O21
var_op='asgn
I
obj='Select
pag=1
prev=O20
sel_field='*
sel_name='tmp_list_imprich
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O21
fatherSonIndex=0
frm_calc=[
'At('.zip',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O336
fatherSonIndex=0
frm_calc='LRTrim(tmp_list_imprich->nomefile)
len=100
name='czipfile
next=Icpitembatch.CPExec
check='page
frm_calc='39
obj='Exec
pag=1
prev=O341
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=1
prev=O19
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O18
var_op='asgn
I
obj='Remark
pag=1
prev=O16
I
obj='Select
pag=1
prev=O15
sel_field='*
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O16
fatherSonIndex=0
frm_calc='intermbo->CODINTER
len=11
name='_codinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->DESCCIT
len=30
name='_citinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->CODCAB
len=6
name='_cabinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->PROVINCIA
len=2
name='_prvinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->FLGOPEXTR
len=1
name='_flgmodi
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->FLGDATAIM
len=1
name='_flgdataim
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->FLGRAPCLI
len=1
name='_frapcli
obj='Var
pag=1
prev=O352
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O351
var_op='asgn
I
obj='Var
pag=1
prev=O350
var_op='asgn
I
obj='Var
pag=1
prev=O349
var_op='asgn
I
obj='Var
pag=1
prev=O348
var_op='asgn
I
obj='Var
pag=1
prev=O347
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=1
prev=O13
I
obj='Begin
pag=1
prev=O11
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
comment='Path Applicazione
father=O13
fatherSonIndex=0
global=True
len=80
name='gPathApp
next=Icpitembatch.CPVarDecl
comment='Azienda
global=True
len=10
name='gAzienda
next=Icpitembatch.CPVarDecl
comment='URL Applicazione
global=True
len=80
name='gUrlApp
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='Messaggio
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Flag Creazione File di Ritorno
global=True
len=1
name='gFlgRet
next=Icpitembatch.CPVarDecl
comment='Tipo Intermediario
global=True
len=2
name='gTipInter
nonlocal=True
obj='Var
pag=1
prev=O362
I
nonlocal=True
obj='Var
pag=1
prev=O361
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O360
I
nonlocal=True
obj='Var
pag=1
prev=O359
I
nonlocal=True
obj='Var
pag=1
prev=O358
I
nonlocal=True
obj='Var
pag=1
prev=O357
I
nonlocal=True
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O9
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O11
fatherSonIndex=0
len=25
name='column01
next=Icpitembatch.CPVarDecl
len=25
name='column02
next=Icpitembatch.CPVarDecl
len=25
name='column03
next=Icpitembatch.CPVarDecl
len=25
name='column04
next=Icpitembatch.CPVarDecl
len=25
name='column05
next=Icpitembatch.CPVarDecl
len=25
name='column06
next=Icpitembatch.CPVarDecl
len=25
name='column07
next=Icpitembatch.CPVarDecl
len=25
name='column08
next=Icpitembatch.CPVarDecl
len=25
name='column09
next=Icpitembatch.CPVarDecl
len=25
name='column10
next=Icpitembatch.CPVarDecl
len=25
name='column11
next=Icpitembatch.CPVarDecl
len=25
name='column12
next=Icpitembatch.CPVarDecl
len=25
name='column13
next=Icpitembatch.CPVarDecl
len=25
name='column14
next=Icpitembatch.CPVarDecl
len=25
name='column15
next=Icpitembatch.CPVarDecl
len=25
name='column16
next=Icpitembatch.CPVarDecl
len=25
name='column17
next=Icpitembatch.CPVarDecl
len=25
name='column18
next=Icpitembatch.CPVarDecl
len=25
name='column19
next=Icpitembatch.CPVarDecl
len=25
name='column20
next=Icpitembatch.CPVarDecl
len=25
name='column21
next=Icpitembatch.CPVarDecl
len=25
name='column22
next=Icpitembatch.CPVarDecl
len=25
name='column23
next=Icpitembatch.CPVarDecl
len=25
name='column24
next=Icpitembatch.CPVarDecl
len=25
name='column25
next=Icpitembatch.CPVarDecl
len=25
name='column26
next=Icpitembatch.CPVarDecl
len=25
name='column27
next=Icpitembatch.CPVarDecl
len=25
name='column28
next=Icpitembatch.CPVarDecl
len=25
name='column29
next=Icpitembatch.CPVarDecl
len=25
name='column30
next=Icpitembatch.CPVarDecl
len=25
name='column31
next=Icpitembatch.CPVarDecl
len=25
name='column32
next=Icpitembatch.CPVarDecl
len=25
name='column33
next=Icpitembatch.CPVarDecl
len=25
name='column34
next=Icpitembatch.CPVarDecl
len=25
name='column35
next=Icpitembatch.CPVarDecl
len=25
name='column36
next=Icpitembatch.CPVarDecl
len=25
name='column37
next=Icpitembatch.CPVarDecl
len=25
name='column38
next=Icpitembatch.CPVarDecl
len=25
name='column39
next=Icpitembatch.CPVarDecl
len=25
name='column40
next=Icpitembatch.CPVarDecl
len=25
name='column41
next=Icpitembatch.CPVarDecl
len=25
name='column42
next=Icpitembatch.CPVarDecl
len=25
name='column43
next=Icpitembatch.CPVarDecl
len=25
name='column44
next=Icpitembatch.CPVarDecl
len=25
name='column45
next=Icpitembatch.CPVarDecl
len=25
name='column46
next=Icpitembatch.CPVarDecl
len=25
name='column47
next=Icpitembatch.CPVarDecl
len=25
name='column48
next=Icpitembatch.CPVarDecl
len=25
name='column49
next=Icpitembatch.CPVarDecl
len=25
name='column50
next=Icpitembatch.CPVarDecl
len=25
name='column51
next=Icpitembatch.CPVarDecl
len=25
name='column52
next=Icpitembatch.CPVarDecl
len=25
name='column53
next=Icpitembatch.CPVarDecl
len=25
name='column54
next=Icpitembatch.CPVarDecl
len=25
name='column55
next=Icpitembatch.CPVarDecl
len=25
name='column56
next=Icpitembatch.CPVarDecl
len=25
name='column57
next=Icpitembatch.CPVarDecl
len=25
name='column58
next=Icpitembatch.CPVarDecl
len=25
name='column59
next=Icpitembatch.CPVarDecl
len=25
name='column60
next=Icpitembatch.CPVarDecl
len=25
name='column61
next=Icpitembatch.CPVarDecl
len=25
name='column62
next=Icpitembatch.CPVarDecl
len=25
name='column63
next=Icpitembatch.CPVarDecl
len=25
name='column64
next=Icpitembatch.CPVarDecl
len=25
name='column65
next=Icpitembatch.CPVarDecl
len=25
name='column66
next=Icpitembatch.CPVarDecl
len=25
name='column67
obj='Var
pag=1
prev=O432
I
obj='Var
pag=1
prev=O431
I
obj='Var
pag=1
prev=O430
I
obj='Var
pag=1
prev=O429
I
obj='Var
pag=1
prev=O428
I
obj='Var
pag=1
prev=O427
I
obj='Var
pag=1
prev=O426
I
obj='Var
pag=1
prev=O425
I
obj='Var
pag=1
prev=O424
I
obj='Var
pag=1
prev=O423
I
obj='Var
pag=1
prev=O422
I
obj='Var
pag=1
prev=O421
I
obj='Var
pag=1
prev=O420
I
obj='Var
pag=1
prev=O419
I
obj='Var
pag=1
prev=O418
I
obj='Var
pag=1
prev=O417
I
obj='Var
pag=1
prev=O416
I
obj='Var
pag=1
prev=O415
I
obj='Var
pag=1
prev=O414
I
obj='Var
pag=1
prev=O413
I
obj='Var
pag=1
prev=O412
I
obj='Var
pag=1
prev=O411
I
obj='Var
pag=1
prev=O410
I
obj='Var
pag=1
prev=O409
I
obj='Var
pag=1
prev=O408
I
obj='Var
pag=1
prev=O407
I
obj='Var
pag=1
prev=O406
I
obj='Var
pag=1
prev=O405
I
obj='Var
pag=1
prev=O404
I
obj='Var
pag=1
prev=O403
I
obj='Var
pag=1
prev=O402
I
obj='Var
pag=1
prev=O401
I
obj='Var
pag=1
prev=O400
I
obj='Var
pag=1
prev=O399
I
obj='Var
pag=1
prev=O398
I
obj='Var
pag=1
prev=O397
I
obj='Var
pag=1
prev=O396
I
obj='Var
pag=1
prev=O395
I
obj='Var
pag=1
prev=O394
I
obj='Var
pag=1
prev=O393
I
obj='Var
pag=1
prev=O392
I
obj='Var
pag=1
prev=O391
I
obj='Var
pag=1
prev=O390
I
obj='Var
pag=1
prev=O389
I
obj='Var
pag=1
prev=O388
I
obj='Var
pag=1
prev=O387
I
obj='Var
pag=1
prev=O386
I
obj='Var
pag=1
prev=O385
I
obj='Var
pag=1
prev=O384
I
obj='Var
pag=1
prev=O383
I
obj='Var
pag=1
prev=O382
I
obj='Var
pag=1
prev=O381
I
obj='Var
pag=1
prev=O380
I
obj='Var
pag=1
prev=O379
I
obj='Var
pag=1
prev=O378
I
obj='Var
pag=1
prev=O377
I
obj='Var
pag=1
prev=O376
I
obj='Var
pag=1
prev=O375
I
obj='Var
pag=1
prev=O374
I
obj='Var
pag=1
prev=O373
I
obj='Var
pag=1
prev=O372
I
obj='Var
pag=1
prev=O371
I
obj='Var
pag=1
prev=O370
I
obj='Var
pag=1
prev=O369
I
obj='Var
pag=1
prev=O368
I
obj='Var
pag=1
prev=O367
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9
fatherSonIndex=0
len=100
name='czipfile
next=Icpitembatch.CPVarDecl
len=200
name='cpercorsozip
next=Icpitembatch.CPVarDecl
len=200
name='cdirectoryfile
next=Icpitembatch.CPVarDecl
len=100
name='buffernomefile
next=Icpitembatch.CPVarDecl
len=50
name='nomefileimport
next=Icpitembatch.CPVarDecl
len=3
name='_priorita
obj='Var
obj_type='N
pag=1
prev=O441
I
obj='Var
pag=1
prev=O440
I
obj='Var
pag=1
prev=O439
I
obj='Var
pag=1
prev=O438
I
obj='Var
pag=1
prev=O437
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O5
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O7
fatherSonIndex=0
len=10
name='ciidbase
next=Icpitembatch.CPVarDecl
len=8
name='cidataini
next=Icpitembatch.CPVarDecl
len=8
name='cidatafine
next=Icpitembatch.CPVarDecl
len=12
name='cicodinter
next=Icpitembatch.CPVarDecl
len=11
name='cinumprog
next=Icpitembatch.CPVarDecl
len=1
name='citiporap
obj='Var
pag=1
prev=O450
I
obj='Var
pag=1
prev=O449
I
obj='Var
pag=1
prev=O448
I
obj='Var
obj_type='D
pag=1
prev=O447
I
obj='Var
obj_type='D
pag=1
prev=O446
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O3
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O5
fatherSonIndex=0
len=10
name='_z
next=Icpitembatch.CPVarDecl
len=1
name='fhand
next=Icpitembatch.CPVarDecl
len=1
name='ohand
next=Icpitembatch.CPVarDecl
len=1
name='zhand
next=Icpitembatch.CPVarDecl
len=1
name='xhand
next=Icpitembatch.CPVarDecl
len=1
name='shand
next=Icpitembatch.CPVarDecl
len=10
name='riga
next=Icpitembatch.CPVarDecl
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
len=1
name='_tdest
next=Icpitembatch.CPVarDecl
len=16
name='xCF
next=Icpitembatch.CPVarDecl
len=16
name='xSOCTCon
next=Icpitembatch.CPVarDecl
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
len=30
name='xCitta
next=Icpitembatch.CPVarDecl
len=6
name='cCliProg
next=Icpitembatch.CPVarDecl
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
len=1
name='xSesso
next=Icpitembatch.CPVarDecl
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
len=6
name='xCAB
next=Icpitembatch.CPVarDecl
len=2
name='xPrv
next=Icpitembatch.CPVarDecl
len=6
name='xDIP
next=Icpitembatch.CPVarDecl
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
len=8
name='xData
next=Icpitembatch.CPVarDecl
len=8
name='xDatF
next=Icpitembatch.CPVarDecl
comment='Contatore record nuovi
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
comment='Contatore record aggiornati
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
comment='Contatore record invariati
len=10
name='cNumInv
next=Icpitembatch.CPVarDecl
len=1
name='cFlagLire
next=Icpitembatch.CPVarDecl
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
len=1
name='xCFE
next=Icpitembatch.CPVarDecl
len=10
name='conta
next=Icpitembatch.CPVarDecl
len=1
name='_esito
next=Icpitembatch.CPVarDecl
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
len=1
name='_salta
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
len=10
name='nProgSto
next=Icpitembatch.CPVarDecl
len=10
name='_idbase
next=Icpitembatch.CPVarDecl
len=11
name='_codinter
next=Icpitembatch.CPVarDecl
len=30
name='_citinter
next=Icpitembatch.CPVarDecl
len=6
name='_cabinter
next=Icpitembatch.CPVarDecl
len=2
name='_prvinter
next=Icpitembatch.CPVarDecl
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
len=2
name='_interprv
next=Icpitembatch.CPVarDecl
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
len=35
name='_benind
next=Icpitembatch.CPVarDecl
len=5
name='_bencap
next=Icpitembatch.CPVarDecl
len=1
name='_flgmodi
next=Icpitembatch.CPVarDecl
len=16
name='_conadd
next=Icpitembatch.CPVarDecl
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
len=8
name='_datvarage
next=Icpitembatch.CPVarDecl
len=1
name='_flgdataim
next=Icpitembatch.CPVarDecl
len=1
name='_chkerr
next=Icpitembatch.CPVarDecl
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
len=8
name='_datarett
next=Icpitembatch.CPVarDecl
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
len=1
name='_opeerr
next=Icpitembatch.CPVarDecl
len=1
name='_frzerr
next=Icpitembatch.CPVarDecl
len=1
name='_opxerr
next=Icpitembatch.CPVarDecl
len=1
name='_soxerr
next=Icpitembatch.CPVarDecl
len=11
name='_numprog
next=Icpitembatch.CPVarDecl
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
len=1
name='_frapcli
next=Icpitembatch.CPVarDecl
len=1
name='_tiporap
next=Icpitembatch.CPVarDecl
len=20
name='_czip
next=Icpitembatch.CPVarDecl
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPVarDecl
len=30
name='_file1
next=Icpitembatch.CPVarDecl
len=30
name='_file2
next=Icpitembatch.CPVarDecl
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
len=1
name='_oldest
next=Icpitembatch.CPVarDecl
len=1
name='_newest
next=Icpitembatch.CPVarDecl
len=10
name='_idb2
next=Icpitembatch.CPVarDecl
len=15
name='_totin
next=Icpitembatch.CPVarDecl
len=15
name='_totout
next=Icpitembatch.CPVarDecl
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
len=70
name='_icrag
next=Icpitembatch.CPVarDecl
frm_seek='mcConnes.MCRDef
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_seek='mcConnes.MCRDef
name='rowSoggetti
next=Icpitembatch.CPVarDecl
len=1
name='_flgvali
next=Icpitembatch.CPVarDecl
len=1
name='_flganag
next=Icpitembatch.CPVarDecl
len=16
name='_oldcf
next=Icpitembatch.CPVarDecl
len=26
name='_oldcog
next=Icpitembatch.CPVarDecl
len=26
name='_oldnom
next=Icpitembatch.CPVarDecl
len=70
name='_oldrgs
next=Icpitembatch.CPVarDecl
len=30
name='_oldncm
next=Icpitembatch.CPVarDecl
len=30
name='_oldnst
next=Icpitembatch.CPVarDecl
len=8
name='_oldndt
next=Icpitembatch.CPVarDecl
len=2
name='_oldnpv
next=Icpitembatch.CPVarDecl
len=1
name='_oldnsx
next=Icpitembatch.CPVarDecl
len=1
name='_oldncf
next=Icpitembatch.CPVarDecl
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
len=10
name='cNewProg
obj='Var
pag=1
prev=O579
I
obj='Var
obj_type='M
pag=1
prev=O578
I
obj='Var
obj_type='M
pag=1
prev=O577
I
obj='Var
obj_type='M
pag=1
prev=O576
I
obj='Var
obj_type='M
pag=1
prev=O575
I
obj='Var
obj_type='M
pag=1
prev=O574
I
obj='Var
obj_type='M
pag=1
prev=O573
I
obj='Var
pag=1
prev=O572
I
obj='Var
obj_type='N
pag=1
prev=O571
I
obj='Var
pag=1
prev=O570
I
obj='Var
pag=1
prev=O569
I
obj='Var
obj_type='D
pag=1
prev=O568
I
obj='Var
pag=1
prev=O567
I
obj='Var
pag=1
prev=O566
I
obj='Var
pag=1
prev=O565
I
obj='Var
pag=1
prev=O564
I
obj='Var
pag=1
prev=O563
I
obj='Var
pag=1
prev=O562
I
obj='Var
pag=1
prev=O561
I
obj='Var
pag=1
prev=O560
I
obj='Var
obj_type='R
pag=1
prev=O559
I
obj='Var
obj_type='MC
pag=1
prev=O558
I
obj='Var
pag=1
prev=O557
I
obj='Var
pag=1
prev=O556
I
obj='Var
pag=1
prev=O555
I
obj='Var
pag=1
prev=O554
I
obj='Var
pag=1
prev=O553
I
obj='Var
obj_type='N
pag=1
prev=O552
I
obj='Var
obj_type='N
pag=1
prev=O551
I
obj='Var
pag=1
prev=O550
I
obj='Var
obj_type='N
pag=1
prev=O549
I
obj='Var
obj_type='N
pag=1
prev=O548
I
obj='Var
pag=1
prev=O547
I
obj='Var
pag=1
prev=O546
I
obj='Var
pag=1
prev=O545
I
obj='Var
pag=1
prev=O544
I
obj='Var
pag=1
prev=O543
I
obj='Var
pag=1
prev=O542
I
obj='Var
pag=1
prev=O541
I
obj='Var
pag=1
prev=O540
I
obj='Var
pag=1
prev=O539
I
obj='Var
pag=1
prev=O538
I
obj='Var
pag=1
prev=O537
I
obj='Var
obj_type='N
pag=1
prev=O536
I
obj='Var
obj_type='N
pag=1
prev=O535
I
obj='Var
obj_type='N
pag=1
prev=O534
I
obj='Var
obj_type='N
pag=1
prev=O533
I
obj='Var
obj_type='N
pag=1
prev=O532
I
obj='Var
pag=1
prev=O531
I
obj='Var
pag=1
prev=O530
I
obj='Var
obj_type='D
pag=1
prev=O529
I
obj='Var
pag=1
prev=O528
I
obj='Var
pag=1
prev=O527
I
obj='Var
pag=1
prev=O526
I
obj='Var
pag=1
prev=O525
I
obj='Var
obj_type='N
pag=1
prev=O524
I
obj='Var
obj_type='N
pag=1
prev=O523
I
obj='Var
obj_type='D
pag=1
prev=O522
I
obj='Var
obj_type='D
pag=1
prev=O521
I
obj='Var
obj_type='D
pag=1
prev=O520
I
obj='Var
pag=1
prev=O519
I
obj='Var
pag=1
prev=O518
I
obj='Var
pag=1
prev=O517
I
obj='Var
pag=1
prev=O516
I
obj='Var
pag=1
prev=O515
I
obj='Var
pag=1
prev=O514
I
obj='Var
pag=1
prev=O513
I
obj='Var
pag=1
prev=O512
I
obj='Var
pag=1
prev=O511
I
obj='Var
pag=1
prev=O510
I
obj='Var
pag=1
prev=O509
I
obj='Var
pag=1
prev=O508
I
obj='Var
pag=1
prev=O507
I
obj='Var
pag=1
prev=O506
I
obj='Var
pag=1
prev=O505
I
obj='Var
pag=1
prev=O504
I
obj='Var
pag=1
prev=O503
I
obj='Var
pag=1
prev=O502
I
obj='Var
pag=1
prev=O501
I
obj='Var
obj_type='N
pag=1
prev=O500
I
obj='Var
obj_type='N
pag=1
prev=O499
I
obj='Var
obj_type='N
pag=1
prev=O498
I
obj='Var
obj_type='N
pag=1
prev=O497
I
obj='Var
pag=1
prev=O496
I
obj='Var
pag=1
prev=O495
I
obj='Var
pag=1
prev=O494
I
obj='Var
obj_type='N
pag=1
prev=O493
I
obj='Var
obj_type='N
pag=1
prev=O492
I
obj='Var
obj_type='N
pag=1
prev=O491
I
obj='Var
pag=1
prev=O490
I
obj='Var
obj_type='N
pag=1
prev=O489
I
obj='Var
pag=1
prev=O488
I
obj='Var
pag=1
prev=O487
I
obj='Var
pag=1
prev=O486
I
obj='Var
obj_type='N
pag=1
prev=O485
I
obj='Var
obj_type='N
pag=1
prev=O484
I
obj='Var
obj_type='N
pag=1
prev=O483
I
obj='Var
pag=1
prev=O482
I
obj='Var
pag=1
prev=O481
I
obj='Var
pag=1
prev=O480
I
obj='Var
pag=1
prev=O479
I
obj='Var
pag=1
prev=O478
I
obj='Var
pag=1
prev=O477
I
obj='Var
pag=1
prev=O476
I
obj='Var
pag=1
prev=O475
I
obj='Var
pag=1
prev=O474
I
obj='Var
pag=1
prev=O473
I
obj='Var
pag=1
prev=O472
I
obj='Var
pag=1
prev=O471
I
obj='Var
pag=1
prev=O470
I
obj='Var
pag=1
prev=O469
I
obj='Var
pag=1
prev=O468
I
obj='Var
pag=1
prev=O467
I
obj='Var
pag=1
prev=O466
I
obj='Var
pag=1
prev=O465
I
obj='Var
pag=1
prev=O464
I
obj='Var
pag=1
prev=O463
I
obj='Var
pag=1
prev=O462
I
obj='Var
pag=1
prev=O461
I
obj='Var
obj_type='M
pag=1
prev=O460
I
obj='Var
pag=1
prev=O459
I
obj='Var
pag=1
prev=O458
I
obj='Var
pag=1
prev=O457
I
obj='Var
pag=1
prev=O456
I
obj='Var
pag=1
prev=O455
I
obj='Var
obj_type='N
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3
fatherSonIndex=0
len=1
name='w_tipodest
next=Icpitembatch.CPVarDecl
len=1
name='w_impzip
next=Icpitembatch.CPVarDecl
len=4
name='w_annorif
next=Icpitembatch.CPVarDecl
len=1
name='w_chkaui
next=Icpitembatch.CPVarDecl
len=1
name='w_imperr
next=Icpitembatch.CPVarDecl
len=1
name='w_creamo
next=Icpitembatch.CPVarDecl
len=1
name='w_fscarti
next=Icpitembatch.CPVarDecl
len=1
name='w_flgaggfam
next=Icpitembatch.CPVarDecl
len=1
name='w_flgimposv
obj='Var
pag=1
param=True
prev=O591
I
obj='Var
pag=1
param=True
prev=O590
I
obj='Var
obj_type='N
pag=1
param=True
prev=O589
I
obj='Var
pag=1
param=True
prev=O588
I
obj='Var
pag=1
param=True
prev=O587
I
obj='Var
pag=1
param=True
prev=O586
I
obj='Var
obj_type='N
pag=1
param=True
prev=O585
I
obj='Var
obj_type='N
pag=1
param=True
prev=O584
I
obj='Var
pag=1
param=True
I
I
]
w=[
150
150
]
x=13
y=16
I
Icpitembatch.CPIfElse
frm_calc=[
'mcSoggetti.RecCount() > 0
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O594
fatherSonIndex=0
frm_calc='FileLibMit.OpenWrite('./output/'+LRTrim(gAzienda)+'/ndg_sovrascritti')
len=1
name='fhand
next=Icpitembatch.CPForEach
for_variable='rowSoggetti
for_variable_type='mcConnes.MCRDef
h=[
19
19
]
iterator_expr='mcSoggetti
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='w_fscarti
next=Icpitembatch.CPVarDecl
frm_calc='"ndg_sovrascritti.zip"
len=20
name='_czip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/"+_czip
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/ndg_sovrascritti"
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='"ndg_sovrascritti"
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc='// These are the files to include in the ZIP file﷯filenames.clear();﷯fileonames.clear();﷯filenames.add(cNomeFile);﷯fileonames.add(cOnlyNomeFile);
next=Icpitembatch.CPExec
check='page
frm_calc='36
next=Icpitembatch.CPInsert
arch='tmp_listafile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevati soggetti che hanno sovrascritto anagrafiche esistenti. Prelevare il file ndg_sovrascritti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/opex_scarti')
obj='Exec
pag=1
prev=O611
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O610
var_op='asgn
I
obj='Insert
pag=1
prev=O609
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
''ndg_sovraSCRITTI'
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/ndg_sovrascritti.zip"
]
I
obj='Exec
pag=1
prev=O608
I
obj='Exec
pag=1
prev=O607
I
obj='Var
pag=1
prev=O606
var_op='asgn
I
obj='Var
pag=1
prev=O605
var_op='asgn
I
obj='Var
pag=1
prev=O604
var_op='asgn
I
obj='Var
pag=1
prev=O603
var_op='asgn
I
obj='Var
obj_type='N
pag=1
param=True
prev=O602
var_op='asgn
I
obj='Exec
pag=1
prev=O600
I
obj='ForEach
pag=1
prev=O599
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O600
fatherSonIndex=0
frm_calc='FileLibMit.WriteLine(fhand,rowSoggetti.connes)
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
x=1190
y=7126
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumInv
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='nProgSto
next=Icpitembatch.CPVarDecl
frm_calc='0
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'nProgImp > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'nProgSto > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Soggetti Nuovi: '+LRTrim(Str(cNumNew,10,0)) + ' - Soggetti Modificati: '+LRTrim(Str(cNumMod,10,0)) + ' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','ARCHPERS','Soggetti Corretti: '+LRTrim(Str(cNumNew,10,0)) + ' - Soggetti Errati: '+LRTrim(Str(cNumMod,10,0)))
obj='Exec
pag=2
prev=O643
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O642
var_op='asgn
I
obj='Exec
pag=2
prev=O641
I
obj='Exec
pag=2
prev=O640
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O639
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O636
var_op='asgn
I
obj='If
pag=2
prev=O633
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O636
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'm_nUpdatedRows=0
]
h=[
19
19
]
obj='If
pag=2
prev=O647
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O648
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'tablecode
'warncode
'autonum
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
'nProgSto + 1
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=2
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'nProgSto + 1
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O631
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O633
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'm_nUpdatedRows=0
]
h=[
19
19
]
obj='If
pag=2
prev=O666
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O667
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'tablecode
'warncode
'autonum
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
'nProgImp + 1
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=2
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'nProgImp + 1
]
I
I
]
w=[
150
150
]
I
obj='While
pag=2
prev=O630
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O631
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=2
prev=O685
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O686
fatherSonIndex=0
frm_calc='''
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,504,8)),NullDate(),CharToDate(Substr(riga,508,4)+Substr(riga,506,2)+Substr(riga,504,2)))
len=8
name='_datvarage
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgRet='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' nominativi del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,112,16))
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,488,16))
len=16
name='_conadd
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(_conadd)),cCli1,_conadd)
len=16
name='cCli1
next=Icpitembatch.CPRemark
frm_calc='Prima la Read si faceva per CF
next=Icpitembatch.CPBeginEnd
comment='Azzera vecchi valori
h=[
19
19
]
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_flgvali
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_flganag
next=Icpitembatch.CPRead
arch='personbo_agg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,288,1))),'G','P')
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,288,1)='M','1',iif(Substr(riga,288,1)='F','2',Substr(riga,288,1)))
len=1
name='xSesso
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,450,1)='0' or Substr(riga,450,1)='1' or Substr(riga,450,1) = ''
'Substr(riga,450,1)='N' or Substr(riga,450,1)='S'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgvali='S',0,xCFE)
len=1
name='xCFE
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgvali='S',Upper(_oldcf),Upper(LRTrim(Substr(riga,112,16))))
len=16
name='xCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,6)
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,260,2))
len=2
name='xPrv
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCodCab))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,136,30))
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'(Substr(xCF,12,1) = 'Z' or Substr(riga,448,2)='EE') and (Substr(riga,288,1)='M' or Substr(riga,288,1)='F')
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Assegna Valori in base a flag
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico se il soggetto in esame non è già presente l'inserisco
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xConnes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O734
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O735
fatherSonIndex=0
frm_calc='nProgImp + 1
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='personbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=2
prev=O741
var_op='asgn
I
obj='Insert
pag=2
prev=O740
rd_kfield=[
'ALLINEATO
'ALLINEATONOMECNOME
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'CONNES
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROGIMPORT
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'TIPOPERS
'DATAVARAGE
]
rd_kvar=[
'0
'0
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,470,5)),3))
'Substr(riga,460,10)
'Upper(Substr(riga,200,30))
'Substr(riga,265,9)
'xCFE
'xCodCab
'xCF
'_oldcog
'Substr(riga,455,5)
'LRTrim(cCli1)
'_oldndt
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Upper(Substr(riga,230,30))
'Substr(riga,348,100)
'Upper(Substr(riga,77,35))
'_oldncm
'_oldnst
'_oldnom
'Upper(Substr(riga,177,15))
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'iif(Empty(Substr(riga,487,1)),'N',Substr(riga,487,1))
'Substr(riga,451,4)
'nProgImp
'xPrv
'_oldrgs
'_oldrgs
'Substr(riga,169,3)
'Val(Substr(riga,484,3))
'Val(Substr(riga,481,3))
'Val(Substr(riga,478,3))
'Val(Substr(riga,475,3))
'_oldnsx
'Substr(riga,172,3)
'Substr(riga,166,3)
'_oldnpv
'Substr(riga,175,2)
'_tipper
'_datvarage
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O741
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+LRTrim(Substr(riga,7,70))+" con codice fiscale: "+LRTrim(Substr(riga,112,16))+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O751
I
obj='Exec
pag=2
prev=O750
I
obj='Var
obj_type='N
pag=2
prev=O749
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O748
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPVarDecl
father=O735
fatherSonIndex=1
frm_calc='Upper(xCF)+Substr(riga,7,70)+Substr(riga,77,35)+Substr(riga,230,30)+Substr(riga,260,2)+LibreriaMit.SpacePad(LRTrim(Substr(riga,265,9)),5)+Substr(riga,262,3)+Substr(riga,166,3)+Substr(riga,169,3)+Substr(riga,172,3)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+LibreriaMit.SpacePad(Left(cCNAS,30),30)+Substr(riga,448,2)+LibreriaMit.SpacePad(Left(cSNAS,30),30)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+Substr(riga,175,2)+Substr(riga,177,15)+Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2)+Substr(riga,200,30)+Substr(riga,274,14)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='Upper(xCF)+Substr(riga,7,70)+Substr(riga,230,30)+Substr(riga,260,2)
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='xRiga3+LibreriaMit.SpacePad(Left(cCNAS,30),30)+Substr(riga,448,2)+LibreriaMit.SpacePad(Left(cSNAS,30),30)
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='xRiga3+CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))+xSesso
len=10
name='xRiga3
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgaggfam='S'
]
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico se il soggetto è una persona fisica
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,288,1)='M' or Substr(riga,288,1)='F'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=2
par_expr=[
'xConnes
]
par_name=[
'w_CONNES
]
prev=O768
sel_name='qbe_aggfam_opextrbo_new
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O771
fatherSonIndex=0
obj='Write
pag=2
rd_kfield=[
'ANNO
'COLLEG
]
rd_kop=[
'=
'=
]
rd_kvar=[
'qbe_aggfam_opextrbo_new->ANNO
'qbe_aggfam_opextrbo_new->COLLEG
]
wr_field=[
'CFESTERO
]
wr_op=[
'=
]
wr_var=[
'iif(_oldest=1,'S','N')
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O767
sons=[
Icpitembatch.CPItemSon
comment='se persona fisica
instr=Icpitembatch.CPWrite
arch='personbo
father=O768
fatherSonIndex=0
frm_calc='Errore in aggiornamento ARCHPERS
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=2
prev=O787
var_op='asgn
I
obj='Write
pag=2
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(xConnes)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O787
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
frm_calc='m_cLastMsgError = ""
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O797
I
obj='Exec
pag=2
prev=O796
I
obj='Var
obj_type='N
pag=2
prev=O795
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'DATAVARAGE
'AREAGEO
'RAREA
'RATTIV
'RCOMP
'RNATGIU
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,460,10)
'Upper(Substr(riga,200,30))
'Substr(riga,265,9)
'_oldest
'xCodCab
'xCF
'_oldcog
'Substr(riga,455,5)
'_oldndt
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Upper(Substr(riga,230,30))
'Substr(riga,348,100)
'Upper(Substr(riga,77,35))
'_oldncm
'_oldnst
'_oldnom
'Upper(Substr(riga,177,15))
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'Substr(riga,451,4)
'xPrv
'_oldrgs
'_oldrgs
'Substr(riga,169,3)
'_oldnsx
'Substr(riga,172,3)
'Substr(riga,166,3)
'_oldnpv
'Substr(riga,175,2)
'_datvarage
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,470,5)),3))
'Val(Substr(riga,484,3))
'Val(Substr(riga,481,3))
'Val(Substr(riga,478,3))
'Val(Substr(riga,475,3))
]
I
I
Icpitembatch.CPItemSon
comment='se persona giuridica
instr=Icpitembatch.CPRemark
father=O768
fatherSonIndex=1
frm_calc='Se non è persona fisica
next=Icpitembatch.CPWrite
arch='personbo
frm_calc='Errore in aggiornamento ARCHPERS
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=2
prev=O805
var_op='asgn
I
obj='Write
pag=2
prev=O804
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(xConnes)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O805
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O814
I
obj='Var
obj_type='N
pag=2
prev=O813
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'DATAVARAGE
'AREAGEO
'RAREA
'RATTIV
'RCOMP
'RNATGIU
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,460,10)
'Upper(Substr(riga,200,30))
'Substr(riga,265,9)
'_oldest
'xCodCab
'xCF
'_oldcog
'Substr(riga,455,5)
'_oldndt
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Upper(Substr(riga,230,30))
'Substr(riga,348,100)
'Upper(Substr(riga,77,35))
'_oldncm
'_oldnst
'_oldnom
'Upper(Substr(riga,177,15))
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'Substr(riga,451,4)
'xPrv
'_oldrgs
'_oldrgs
'Substr(riga,169,3)
'_oldnsx
'Substr(riga,172,3)
'Substr(riga,166,3)
'_oldnpv
'Substr(riga,175,2)
'_datvarage
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,470,5)),3))
'Val(Substr(riga,484,3))
'Val(Substr(riga,481,3))
'Val(Substr(riga,478,3))
'Val(Substr(riga,475,3))
]
I
obj='Remark
pag=2
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=2
prev=O765
I
obj='Select
pag=2
prev=O762
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O765
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad(personbo->CODFISC,16)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->RAGSOC,70)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->DOMICILIO,35)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->DESCCIT,30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->PROVINCIA,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(LRTrim(personbo->CAP),5)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->PAESE,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->SOTGRUP,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->RAMOGRUP,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->SETTSINT,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(Left(personbo->NASCOMUN,30),30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->TIPINTER,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(Left(personbo->NASSTATO,30),30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + iif(DateToChar(personbo->DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATANASC),8),Space(8))
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->TIPODOC,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->NUMDOCUM,15)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + iif(DateToChar(personbo->DATARILASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATARILASC),8),Space(8))
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->AUTRILASC,30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->PARTIVA,14)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.SpacePad(personbo->CODFISC,16)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->RAGSOC,70)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->DESCCIT,30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->PROVINCIA,2)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(Left(personbo->NASCOMUN,30),30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->TIPINTER,2)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(Left(personbo->NASSTATO,30),30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + iif(DateToChar(personbo->DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATANASC),8),Space(8))
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->SESSO,1)
len=10
name='xRiga4
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgaggfam='S'
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Se le due stringhe sono diverse, ci sono delle modifiche da fare. Quindi storicizzo in wersonbo le modifche.
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(xRiga1) <> LRTrim(xRiga2)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgaggfam='S'
]
h=[
19
19
]
obj='If
pag=2
prev=O855
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O858
fatherSonIndex=0
frm_calc=[
'LRTrim(xRiga5) <> LRTrim(xRiga6)
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='bat
father=O863
fatherSonIndex=0
frm_calc='arrt_ae_agg_aetesta_sog(xConnes,_oldest)
obj='Exec
pag=2
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O854
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O855
fatherSonIndex=0
frm_calc='Verifico se c'è già una variazione
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
obj='If
pag=2
prev=O876
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O878
fatherSonIndex=0
frm_calc='Calcola il progressivo di registrazione
next=Icpitembatch.CPVarDecl
frm_calc='nProgSto + 1
len=10
name='nProgSto
next=Icpitembatch.CPVarDecl
frm_calc='Right('000000000000000'+LRTrim(Str(nProgSto,15,0)),15)
len=15
name='cProgSto
next=Icpitembatch.CPInsert
arch='wersonbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_creamo='S'
]
h=[
19
19
]
obj='If
pag=2
prev=O886
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O888
fatherSonIndex=0
frm_calc=[
'LRTrim(xRiga3) <> LRTrim(xRiga4)
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O893
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=2
prev=O898
sel_field='fraziobo->IDBASE
sel_name='fraziobo
sel_where='fraziobo->CONNESCLI=xConnes or fraziobo->CONNESOPER=xConnes or fraziobo->CONNESBEN=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O900
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(gAzienda)+"'",Space(10),10)
len=10
name='cNewProg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc=''JLMNOTUV?'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='fraziobo->IDBASE
len=10
name='_idbase
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=2
prev=O906
sel_field='*
sel_name='fraziobo
sel_where='fraziobo->IDBASE=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O907
fatherSonIndex=0
frm_calc='iif(Empty(fraziobo->FLAGRAP2),Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(fraziobo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPInsert
arch='fraziobo
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(operazbo->DATAOPE)+"F"+LibreriaMit.UniqueId()+"X"
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=2
prev=O913
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_idbase
]
wr_field=[
'OPERAZMOD
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
'=
]
wr_var=[
'fraziobo->IDEREG
''1'
'Date()
]
I
obj='Var
pag=2
prev=O912
var_op='asgn
I
obj='Insert
pag=2
prev=O911
rd_kfield=[
'AREAGEO
'AUTOM
'CAMBIO
'CDATAOPE
'CDATOPE
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'MODSVOL
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
'CONNALTRO
'CONNESDOC
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'DATAIMP
'C_RAPPORTO
'PAGASOGOP
'MTCN
'IDFILE
'CDATREG
'IPCOLLEG
'ORACOLLEG
'DUCOLLEG
'ANNOOPE
]
rd_kvar=[
'fraziobo->AREAGEO
'fraziobo->AUTOM
'fraziobo->CAMBIO
'fraziobo->CDATAOPE
'fraziobo->CDATOPE
'fraziobo->CODANA
'fraziobo->CODCAB
'fraziobo->CODCAB2
'fraziobo->CODDIPE
'fraziobo->CODINT2
'fraziobo->CODINTER
'fraziobo->CODVOC
'fraziobo->COLLEG
'fraziobo->CONNESBEN
'fraziobo->CONNESCLI
'fraziobo->CONNESOPER
'fraziobo->DATAOPE
'fraziobo->DATAREG
'Date()
'fraziobo->DESC2
'fraziobo->DESCCIT
'fraziobo->DESCINTER
'fraziobo->DOCFILE
'fraziobo->FLAGCONT
'fraziobo->FLAGFRAZ
'fraziobo->FLAGLIRE
'fraziobo->FLAGRAP
'_flagrap2
'cNewProg
'fraziobo->idcauana
'fraziobo->IDEREG
'fraziobo->INFORM
'fraziobo->MODSVOL
'fraziobo->NATURA
'fraziobo->NOPROT
'fraziobo->NUMPROG
'fraziobo->OPERAG
'fraziobo->OPERATORE
'fraziobo->OPERAZMOD
'fraziobo->OPRAP
'fraziobo->PAESE
'fraziobo->PRGIMPFRZ
'fraziobo->PROV2
'fraziobo->PROVINCIA
'fraziobo->RAGIO
'fraziobo->RAPPORTBEN
'fraziobo->RAPPORTO
'fraziobo->RAREA
'fraziobo->RCOMP
'fraziobo->RESPINS
'fraziobo->RFREQ
'fraziobo->RIFIMP
'fraziobo->RIMP
'fraziobo->RRAGIO
'fraziobo->RTIPO
'fraziobo->SCOPO
'fraziobo->SEGNO
''3'
'fraziobo->TIPO
'fraziobo->TIPOINF
'fraziobo->TIPOINT2
'fraziobo->TIPOINTER
'fraziobo->TIPOLEG
'fraziobo->TIPOOPRAP
'fraziobo->TOTCONT
'fraziobo->TOTLIRE
'fraziobo->UCODE
'fraziobo->UNIQUECODE
'fraziobo->VALUTA
'fraziobo->ZCPARTE
'fraziobo->CONNALTRO
'fraziobo->CONNESDOC
'fraziobo->C_RAG
'fraziobo->C_STA
'fraziobo->C_CTA
'fraziobo->C_CAB
'fraziobo->C_PRV
'fraziobo->C_IND
'fraziobo->C_CAP
'fraziobo->DATAIMP
'fraziobo->C_RAPPORTO
'fraziobo->PAGASOGOP
'fraziobo->MTCN
'fraziobo->IDFILE
'fraziobo->CDATREG
'fraziobo->IPCOLLEG
'fraziobo->ORACOLLEG
'fraziobo->DUCOLLEG
'fraziobo->ANNOOPE
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O905
var_op='asgn
I
obj='Var
pag=2
prev=O904
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=2
sel_field='operazbo->IDBASE
sel_name='operazbo
sel_where='operazbo->CONNESCLI=xConnes or operazbo->CONNESOPER=xConnes or operazbo->CONNESBEN=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O898
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",Space(10),10)
len=10
name='cNewProg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='operazbo->IDBASE
len=10
name='_idbase
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=2
prev=O929
sel_field='*
sel_name='operazbo
sel_where='operazbo->IDBASE=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O930
fatherSonIndex=0
frm_calc='iif(Empty(operazbo->FLAGRAP2),Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(operazbo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPInsert
arch='operazbo
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(operazbo->DATAOPE)+"O"+LibreriaMit.UniqueId()+"X"
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=2
prev=O936
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_idbase
]
wr_field=[
'OPERAZMOD
'STATOREG
'DATARETT
'IDEREG
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'operazbo->IDEREG
''1'
'Date()
'_idreg
]
I
obj='Var
pag=2
prev=O935
var_op='asgn
I
obj='Insert
pag=2
prev=O934
rd_kfield=[
'AMMONT
'AREAGEO
'AUTOM
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESDOC
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'IDFILE
'INFORM
'IPCOLLEG
'MODSVOL
'MTCN
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
'ANNOOPE
]
rd_kvar=[
'operazbo->AMMONT
'operazbo->AREAGEO
'operazbo->AUTOM
'operazbo->C_CAB
'operazbo->C_CAP
'operazbo->C_CTA
'operazbo->C_IND
'operazbo->C_PRV
'operazbo->C_RAG
'operazbo->C_RAPPORTO
'operazbo->C_STA
'operazbo->CAMBIO
'operazbo->CDATAOPE
'operazbo->CDATOPE
'operazbo->CDATREG
'operazbo->CODANA
'operazbo->CODCAB
'operazbo->CODCAB2
'operazbo->CODDIPE
'operazbo->CODINT2
'operazbo->CODINTER
'operazbo->CODVOC
'operazbo->COLLEG
'operazbo->CONNALTRO
'operazbo->CONNESBEN
'operazbo->CONNESCLI
'operazbo->CONNESDOC
'operazbo->CONNESOPER
'operazbo->DATAIMP
'operazbo->DATAOPE
'operazbo->DATAREG
'Date()
'operazbo->DESC2
'operazbo->DESCCIT
'operazbo->DESCINTER
'operazbo->DOCFILE
'operazbo->DUCOLLEG
'operazbo->DURAT
'operazbo->FLAGCONT
'operazbo->FLAGFRAZ
'operazbo->FLAGLIRE
'operazbo->FLAGRAP
'_flagrap2
'cNewProg
'operazbo->idcauana
'operazbo->IDEREG
'operazbo->IDFILE
'operazbo->INFORM
'operazbo->IPCOLLEG
'operazbo->MODSVOL
'operazbo->MTCN
'operazbo->NATURA
'operazbo->NOPROT
'operazbo->NUMPROG
'operazbo->OPERAG
'operazbo->OPERATORE
'operazbo->OPERAZMOD
'operazbo->OPRAP
'operazbo->ORACOLLEG
'operazbo->PAESE
'operazbo->PAGASOGOP
'operazbo->PRGIMPOPE
'operazbo->PROV2
'operazbo->PROVINCIA
'operazbo->RAGIO
'operazbo->RAPPORTBEN
'operazbo->RAPPORTO
'operazbo->RAREA
'operazbo->RCOMP
'operazbo->RESPINS
'operazbo->RFREQ
'operazbo->RIFIMP
'operazbo->RIMP
'operazbo->RRAGIO
'operazbo->RTIPO
'operazbo->SCOPO
'operazbo->SEGNO
''3'
'operazbo->TIPO
'operazbo->TIPOINF
'operazbo->TIPOINT2
'operazbo->TIPOINTER
'operazbo->TIPOLEG
'operazbo->TIPOOPRAP
'operazbo->TOTCONT
'operazbo->TOTLIRE
'operazbo->UCODE
'operazbo->UNIQUECODE
'operazbo->VALUTA
'operazbo->ZCPARTE
'operazbo->ANNOOPE
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O928
var_op='asgn
I
obj='Var
pag=2
prev=O927
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=2
prev=O885
rd_kfield=[
'ALLINEATO
'ALLINEATONOMECNOME
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODDIPE
'CODFISC
'CODINTER
'COGNOME
'COMPORT
'CONNES
'datamodi
'DATANASC
'DATARILASC
'DATASEGN
'DATAVALI
'DATEXTRA
'DESCCIT
'DOCFILE
'DOMICILIO
'idcitta
'IDFILE
'MACROAGENTE
'NASCOMUN
'NASSTATO
'NOME
'NOTE
'NUMDOCUM
'OLDCODFISC
'OLDCONNES
'OLDSETSIN
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROGIMP_C
'PROGIMPORT
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'sanumpro
'SESSO
'SETTSINT
'SOSPMAF
'SOTGRUP
'SPOTID
'TIPINTER
'TIPODOC
'TIPOPERS
]
rd_kvar=[
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->AREAGEO
'personbo->ATTIV
'personbo->AUTRILASC
'personbo->CAP
'personbo->CFESTERO
'personbo->CODCAB
'personbo->CODDIPE
'personbo->CODFISC
'personbo->CODINTER
'personbo->COGNOME
'personbo->COMPORT
'xConnes
'_datarett
'personbo->DATANASC
'personbo->DATARILASC
'personbo->DATASEGN
'personbo->DATAVALI
'personbo->DATEXTRA
'personbo->DESCCIT
'personbo->DOCFILE
'personbo->DOMICILIO
'personbo->idcitta
'personbo->IDFILE
'personbo->MACROAGENTE
'personbo->NASCOMUN
'personbo->NASSTATO
'personbo->NOME
'personbo->NOTE
'personbo->NUMDOCUM
'personbo->OLDCODFISC
'personbo->OLDCONNES
'personbo->OLDSETSIN
'personbo->PAESE
'personbo->PARTIVA
'personbo->PEP
'personbo->PKTBSPECIE
'personbo->PROGIMP_C
'personbo->PROGIMPORT
'personbo->PROVINCIA
'personbo->RAGSOC
'personbo->RAGSOCOLD
'personbo->RAMOGRUP
'personbo->RAREA
'personbo->RATTIV
'personbo->RCOMP
'personbo->RNATGIU
'cProgSto
'personbo->SESSO
'personbo->SETTSINT
'personbo->SOSPMAF
'personbo->SOTGRUP
'personbo->SPOTID
'personbo->TIPINTER
'personbo->TIPODOC
'personbo->TIPOPERS
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O886
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
frm_calc='m_cLastMsgError = ""
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O956
I
obj='Exec
pag=2
prev=O955
I
obj='Var
obj_type='N
pag=2
prev=O954
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=2
prev=O884
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O883
var_op='asgn
I
obj='Remark
pag=2
I
I
]
w=[
150
150
]
I
obj='Select
pag=2
prev=O875
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=xConnes and wersonbo->datamodi=_datarett
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O876
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='D
pag=2
prev=O874
var_op='asgn
I
obj='Var
pag=2
prev=O873
var_op='asgn
I
obj='Remark
pag=2
I
I
]
w=[
150
150
]
I
obj='Remark
pag=2
prev=O851
I
obj='If
pag=2
prev=O850
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O851
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad(personbo->CODFISC,16)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->RAGSOC,70)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->DESCCIT,30)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->PAESE,3)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->PROVINCIA,2)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->COGNOME,26)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->NOME,25)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->SESSO,1)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + iif(DateToChar(personbo->DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATANASC),8),Space(8))
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(Left(personbo->NASCOMUN,30),30)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->TIPINTER,2)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(Left(personbo->NASSTATO,30),30)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='iif(personbo->CFESTERO=1,'1','0')
len=10
name='xRiga6
obj='Var
obj_type='M
pag=2
prev=O978
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O977
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O976
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O975
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O974
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O973
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O972
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O971
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O970
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O969
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O968
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O967
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
prev=O849
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O848
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O847
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O846
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O845
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O844
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O843
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O842
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O841
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O840
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O839
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O838
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O837
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O836
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O835
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O834
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O833
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O832
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O831
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O830
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O829
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O828
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O827
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O826
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O825
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O824
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O823
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O761
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O762
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad(Upper(xCF),16)+Substr(riga,7,70)+Substr(riga,230,30)+Substr(riga,262,3)+Substr(riga,260,2)
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+Substr(riga,297,26)+Substr(riga,323,25)+xSesso
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2)+LibreriaMit.SpacePad(Left(cCNAS,30),30)+Substr(riga,448,2)
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+LibreriaMit.SpacePad(Left(cSNAS,30),30)+xCFE
len=10
name='xRiga5
obj='Var
obj_type='M
pag=2
prev=O986
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O985
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O984
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
prev=O760
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O759
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O758
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O757
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O756
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O755
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=2
prev=O732
I
obj='Begin
pag=2
prev=O729
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O732
fatherSonIndex=0
frm_calc='iif(_flganag='S',_oldcog,Upper(Substr(riga,297,26)))
len=26
name='_oldcog
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnom,Upper(Substr(riga,323,25)))
len=26
name='_oldnom
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldrgs,Upper(Substr(riga,7,70)))
len=70
name='_oldrgs
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldncm,cCNAS)
len=30
name='_oldncm
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnst,cSNAS)
len=30
name='_oldnst
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldndt,CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2)))
len=8
name='_oldndt
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnpv,Upper(Substr(riga,448,2)))
len=2
name='_oldnpv
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnsx,xSesso)
len=1
name='_oldnsx
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgvali='S',_oldest,xCFE)
len=1
name='_oldest
obj='Var
obj_type='N
pag=2
prev=O999
var_op='asgn
I
obj='Var
pag=2
prev=O998
var_op='asgn
I
obj='Var
pag=2
prev=O997
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O996
var_op='asgn
I
obj='Var
pag=2
prev=O995
var_op='asgn
I
obj='Var
pag=2
prev=O994
var_op='asgn
I
obj='Var
pag=2
prev=O993
var_op='asgn
I
obj='Var
pag=2
prev=O992
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O728
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O729
fatherSonIndex=0
frm_calc='Upper(Substr(riga,136,30))
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=2
prev=O1004
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O727
var_op='asgn
I
obj='Var
pag=2
prev=O724
var_op='asgn
I
obj='If
pag=2
prev=O723
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O724
fatherSonIndex=0
frm_calc='Upper(Substr(riga,230,30))
len=30
name='xCitta
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xPrv)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O1009
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O1010
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xCodCab)
]
h=[
19
19
]
obj='If
pag=2
prev=O1015
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O1016
fatherSonIndex=0
obj='Read
pag=2
rd_field=[
'CAB
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'xCitta
]
rd_var=[
'xCodCab
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=2
rd_field=[
'CAB
]
rd_kfield=[
'CITTA
'PROV
]
rd_kvar=[
'xCitta
'xPrv
]
rd_var=[
'xCodCab
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O1010
fatherSonIndex=1
obj='Read
pag=2
rd_field=[
'CAB
'PROV
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'xCitta
]
rd_var=[
'xCodCab
'xPrv
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O722
var_op='asgn
I
obj='Var
pag=2
prev=O721
var_op='asgn
I
obj='Var
pag=2
prev=O720
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O717
var_op='asgn
I
obj='If
pag=2
prev=O716
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O717
fatherSonIndex=0
frm_calc='iif(LRTrim(Substr(riga,450,1))='1',1,0)
len=1
name='xCFE
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O717
fatherSonIndex=1
frm_calc='iif(LRTrim(Substr(riga,450,1))='S',1,0)
len=1
name='xCFE
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O715
var_op='asgn
I
obj='Var
pag=2
prev=O714
var_op='asgn
I
obj='Read
pag=2
prev=O713
rd_field=[
'FLGVALIDO
'FLGANAVAL
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'cCli1
]
rd_var=[
'_flgvali
'_flganag
]
I
obj='Var
pag=2
prev=O712
var_op='asgn
I
obj='Var
pag=2
prev=O711
var_op='asgn
I
obj='Read
pag=2
prev=O709
rd_field=[
'CONNES
'CFESTERO
'CODFISC
'COGNOME
'NOME
'RAGSOC
'NASCOMUN
'NASSTATO
'DATANASC
'TIPINTER
'SESSO
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'cCli1
]
rd_var=[
'xConnes
'_oldest
'_oldcf
'_oldcog
'_oldnom
'_oldrgs
'_oldncm
'_oldnst
'_oldndt
'_oldnpv
'_oldnsx
]
I
obj='Begin
pag=2
prev=O708
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O709
fatherSonIndex=0
frm_calc='0
len=1
name='_oldest
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_oldcf
next=Icpitembatch.CPVarDecl
frm_calc='''
len=26
name='_oldcog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=26
name='_oldnom
next=Icpitembatch.CPVarDecl
frm_calc='''
len=70
name='_oldrgs
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_oldncm
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_oldnst
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_oldndt
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_oldnpv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_oldnsx
obj='Var
pag=2
prev=O1063
var_op='asgn
I
obj='Var
pag=2
prev=O1062
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O1061
var_op='asgn
I
obj='Var
pag=2
prev=O1060
var_op='asgn
I
obj='Var
pag=2
prev=O1059
var_op='asgn
I
obj='Var
pag=2
prev=O1058
var_op='asgn
I
obj='Var
pag=2
prev=O1057
var_op='asgn
I
obj='Var
pag=2
prev=O1056
var_op='asgn
I
obj='Var
pag=2
prev=O1055
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=2
prev=O707
I
obj='Var
pag=2
prev=O706
var_op='asgn
I
obj='Var
pag=2
prev=O705
var_op='asgn
I
obj='Var
pag=2
prev=O704
var_op='asgn
I
obj='Var
pag=2
prev=O703
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O700
var_op='asgn
I
obj='If
pag=2
prev=O699
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xersonbo
father=O700
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'CONNES
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'IDPROG
]
rd_kvar=[
'Substr(riga,470,3)
'Substr(riga,460,10)
'Substr(riga,200,30)
'Substr(riga,265,9)
'Substr(riga,450,1)
'Left(riga,6)
'Substr(riga,112,16)
'Substr(riga,297,26)
'Substr(riga,455,5)
'Substr(riga,488,16)
'Substr(riga,128,8)
'Substr(riga,192,8)
'Substr(riga,289,8)
'Substr(riga,230,30)
'Substr(riga,348,100)
'Substr(riga,77,35)
'Substr(riga,136,30)
'Substr(riga,323,25)
'Substr(riga,177,15)
'Substr(riga,262,3)
'Substr(riga,274,14)
'Substr(riga,487,1)
'Substr(riga,451,4)
'Substr(riga,260,2)
'Substr(riga,7,70)
'Substr(riga,7,70)
'Substr(riga,169,3)
'Substr(riga,484,3)
'Substr(riga,481,3)
'Substr(riga,478,3)
'Substr(riga,475,3)
'Substr(riga,288,1)
'Substr(riga,172,3)
'Substr(riga,166,3)
'Substr(riga,448,2)
'Substr(riga,175,2)
'conta
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O698
var_op='asgn
I
obj='Var
pag=2
prev=O697
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O696
var_op='asgn
I
obj='Var
obj_type='M
pag=2
pagelocal=True
prev=O695
var_op='asgn
I
obj='Var
obj_type='M
pag=2
pagelocal=True
prev=O694
var_op='asgn
I
obj='Var
obj_type='M
pag=2
pagelocal=True
prev=O693
var_op='asgn
I
obj='Var
obj_type='M
pag=2
pagelocal=True
prev=O692
var_op='asgn
I
obj='Var
obj_type='M
pag=2
pagelocal=True
prev=O691
var_op='asgn
I
obj='Var
obj_type='M
pag=2
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O629
var_op='asgn
I
obj='Read
pag=2
prev=O628
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
rd_var=[
'nProgSto
]
I
obj='Read
pag=2
prev=O627
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
rd_var=[
'nProgImp
]
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O626
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O625
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O624
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O623
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O622
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O621
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O620
var_op='asgn
I
obj='Remark
pag=2
x=15
y=15
I
Icpitembatch.CPVarDecl
frm_seek='AppendBlank
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(xConnes)
frm_seek='connes
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcSoggetti
obj='Var
obj_type='MC
pag=2
prev=O1083
var_op='meth
I
obj='Var
obj_type='MC
pag=2
prev=O1082
var_op='prop
I
obj='Var
obj_type='MC
pag=2
var_op='meth
x=1403
y=6599
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime())  + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Rapporti Inseriti: '+LRTrim(Str(cNumNew,10,0)) +' - Rapporti Aggiornati: '+LRTrim(Str(cNumMod,10,0))+' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1096
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1095
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1094
var_op='asgn
I
obj='Exec
pag=3
prev=O1093
I
obj='Exec
pag=3
prev=O1091
I
obj='While
pag=3
prev=O1090
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1091
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=3
prev=O1100
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1101
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' rapporti del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='cFlagLire
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,77,1)='S' or Substr(riga,77,1)='1' or Substr(riga,77,1)='7'
'Substr(riga,77,1)='E' or Substr(riga,77,1)='3' or Substr(riga,77,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='xRapporto
next=Icpitembatch.CPRead
arch='anarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xRapporto))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O1113
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O1114
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='anarapbo
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='knarapbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,83,1)<>'1'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=3
prev=O1124
var_op='asgn
I
obj='If
pag=3
prev=O1122
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1124
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PROGAET\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aetesta
h=[
19
19
]
obj='Insert
pag=3
prev=O1130
rd_kfield=[
'RAPPORTO
'TIPOAG
'COINT
'DESCRI
'VALUTA
'PROGAET
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,81,2)
'iif(Substr(riga,76,1)='1','1','2')
'iif(Substr(riga,81,2)='99',Upper(Substr(riga,26,24)),'')
'Substr(riga,78,3)
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1131
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O1139
I
obj='Var
obj_type='N
pag=3
prev=O1138
var_op='asgn
I
obj='Exec
pag=3
prev=O1137
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=3
prev=O1120
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGRAP
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
''D'
'Substr(riga,76,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1122
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O1149
I
obj='Var
obj_type='N
pag=3
prev=O1148
var_op='asgn
I
obj='Exec
pag=3
prev=O1147
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Insert
pag=3
prev=O1119
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
'PRGIMPRAP
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,94,5)),3))
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1120
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O1158
I
obj='Var
obj_type='N
pag=3
prev=O1157
var_op='asgn
I
obj='Exec
pag=3
prev=O1156
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='anarapbo
father=O1114
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='knarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,83,1)<>'1'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=3
prev=O1165
var_op='asgn
I
obj='If
pag=3
prev=O1164
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aetesta
father=O1165
fatherSonIndex=0
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'TIPOAG
'COINT
'DESCRI
'VALUTA
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,81,2)
'iif(Substr(riga,76,1)='1','1','2')
'iif(Substr(riga,81,2)='99',Upper(Substr(riga,26,24)),'')
'Substr(riga,78,3)
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=3
prev=O1162
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'DESCRAP
'FLAGRAP
'TIPORAP
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Substr(riga,26,50)
'Substr(riga,76,1)
''D'
]
I
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1162
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O1192
I
obj='Var
obj_type='N
pag=3
prev=O1191
var_op='asgn
I
obj='Exec
pag=3
prev=O1190
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,94,5)),3))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=3
prev=O1112
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Left(riga,25)
]
rd_var=[
'xRapporto
]
I
obj='Var
pag=3
prev=O1109
var_op='asgn
I
obj='Case
pag=3
prev=O1108
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1109
fatherSonIndex=0
frm_calc=''L'
len=1
name='cFlagLire
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1109
fatherSonIndex=1
frm_calc=''E'
len=1
name='cFlagLire
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1109
fatherSonIndex=2
frm_calc=''V'
len=1
name='cFlagLire
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=3
prev=O1107
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1106
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O1089
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1088
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1087
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1086
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1085
var_op='asgn
I
obj='Remark
pag=3
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Informazione Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O1223
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O1222
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O1221
var_op='asgn
I
obj='Exec
pag=4
prev=O1220
I
obj='Exec
pag=4
prev=O1218
I
obj='While
pag=4
prev=O1217
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1218
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=4
prev=O1227
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O1228
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,75,16)
len=16
name='xConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,50,16)
len=16
name='xSOCTCon
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xSOCTCon)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' informazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,46,1)='S' or Substr(riga,46,1)='1' or Substr(riga,46,1)='7'
'Substr(riga,46,1)='E' or Substr(riga,46,1)='3' or Substr(riga,46,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,159,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,36,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPInsert
arch='rapopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,44,2) <> '25' and Substr(riga,44,2) <> '28'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
prev=O1266
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1269
fatherSonIndex=0
frm_calc=[
'not(Empty(cCli1))
]
h=[
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1274
fatherSonIndex=0
frm_calc=[
'Substr(riga,44,2)  = '25'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='delegabo
father=O1279
fatherSonIndex=0
h=[
19
19
]
obj='Insert
pag=4
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1284
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1292
I
obj='Var
obj_type='N
pag=4
prev=O1291
var_op='asgn
I
obj='Exec
pag=4
prev=O1290
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1279
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='intestbo
h=[
19
19
]
obj='Insert
pag=4
prev=O1296
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1297
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1305
I
obj='Var
obj_type='N
pag=4
prev=O1304
var_op='asgn
I
obj='Exec
pag=4
prev=O1303
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1269
fatherSonIndex=1
frm_calc=[
'Substr(riga,44,2)='28'
'Substr(riga,45,1)='6' or Substr(riga,44,2)='38'
]
h=[
19
19
19
19
]
haselse=True
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='delegabo
father=O1311
fatherSonIndex=0
h=[
19
19
]
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cCli1
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1316
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1325
I
obj='Var
obj_type='N
pag=4
prev=O1324
var_op='asgn
I
obj='Exec
pag=4
prev=O1323
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestbo
father=O1311
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'Substr(riga,9,25)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1332
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1341
I
obj='Var
obj_type='N
pag=4
prev=O1340
var_op='asgn
I
obj='Exec
pag=4
prev=O1339
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestbo
father=O1311
fatherSonIndex=2
h=[
19
19
]
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cCli1
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1348
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1357
I
obj='Var
obj_type='N
pag=4
prev=O1356
var_op='asgn
I
obj='Exec
pag=4
prev=O1355
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'NUMPROG1
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
]
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=4
prev=O1265
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1266
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=4
sel_field='*
sel_name='intestbo
sel_order='intestbo->CPROWNUM
sel_where='intestbo->RAPPORTO=Substr(riga,9,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1367
fatherSonIndex=0
frm_calc=[
'intestbo->CODINTER=cCli1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=4
prev=O1371
var_op='asgn
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1371
fatherSonIndex=0
frm_calc='intestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1266
fatherSonIndex=1
frm_calc=[
'Substr(riga,44,2)  = '25'
'Substr(riga,44,2) = '28'
]
h=[
19
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1381
fatherSonIndex=0
frm_calc='0
len=10
name='cNumMod
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1381
fatherSonIndex=1
frm_calc='1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O1264
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1263
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1261
var_op='asgn
I
obj='Insert
pag=4
prev=O1260
rd_kfield=[
'CDATOPE
'CDATREG
'CODCAB
'CODDIPE
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'VALUTA
'IDBASE2
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'_intercab
'Substr(riga,115,6)
'_intercod
'iif((_dataope < CharToDate('20100601') or _dataope > CharToDate('20131231')),xSOCTCF,'')
'_dataope
'_datareg
'_intercit
'Substr(riga,169,50)
'cFlagLire
'Substr(riga,34,1)
'cInfProg1
'"I"+Right(cInfProg2,9)+_idb2
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'iif((_dataope < CharToDate('20100601') or _dataope > CharToDate('20131231')),Substr(riga,35,1),' ')
'Substr(riga,44,2)
'Substr(riga,159,10)
'Substr(riga,47,3)
'_idb2
]
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1261
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1397
I
obj='Var
obj_type='N
pag=4
prev=O1396
var_op='asgn
I
obj='Exec
pag=4
prev=O1395
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=4
prev=O1259
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1258
var_op='asgn
I
obj='Var
pag=4
prev=O1257
var_op='asgn
I
obj='Var
pag=4
prev=O1256
var_op='asgn
I
obj='Var
obj_type='D
pag=4
prev=O1255
var_op='asgn
I
obj='Var
obj_type='D
pag=4
prev=O1252
var_op='asgn
I
obj='If
pag=4
prev=O1251
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='rapopebo
father=O1252
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'_unicode<>''
]
h=[
19
19
]
obj='If
pag=4
prev=O1402
sons=[
Icpitembatch.CPItemSon
comment='In caso di _unicode doppio blocco l'importazione
instr=Icpitembatch.CPVarDecl
father=O1403
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1409
I
obj='Var
obj_type='N
pag=4
prev=O1408
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,159,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
prev=O1250
var_op='asgn
I
obj='Remark
pag=4
prev=O1247
I
obj='Case
pag=4
prev=O1246
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1247
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1247
fatherSonIndex=1
frm_calc=[
'Substr(riga,46,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1421
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1421
fatherSonIndex=1
frm_calc='Substr(riga,46,1)
len=1
name='cFlagLire
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1247
fatherSonIndex=2
frm_calc='Substr(riga,46,1)
len=1
name='cFlagLire
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O1245
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1242
var_op='asgn
I
obj='If
pag=4
prev=O1241
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='personbo
father=O1242
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=4
prev=O1435
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O1436
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=4
prev=O1441
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1442
fatherSonIndex=0
frm_calc='xSOCTCon
len=16
name='xSOCTCF
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
prev=O1240
var_op='asgn
I
obj='Var
pag=4
prev=O1237
var_op='asgn
I
obj='If
pag=4
prev=O1236
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='personbo
father=O1237
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
obj='If
pag=4
prev=O1461
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1462
fatherSonIndex=0
frm_calc='xConnes
len=16
name='cCli1
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
prev=O1235
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
obj='Var
pag=4
prev=O1233
var_op='asgn
I
obj='Begin
pag=4
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1233
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,104,11))),_codinter,Substr(riga,104,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,121,30))),_citinter,Substr(riga,121,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,153,6))),_cabinter,Substr(riga,153,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,151,2))),_prvinter,Substr(riga,151,2))
len=2
name='_interprv
obj='Var
pag=4
prev=O1482
var_op='asgn
I
obj='Var
pag=4
prev=O1481
var_op='asgn
I
obj='Var
pag=4
prev=O1480
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O1216
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1215
var_op='asgn
I
obj='Var
pag=4
prev=O1214
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O1213
var_op='asgn
I
obj='Remark
pag=4
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Inserite o modificate: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','OPERAZBO','Operazioni Inserite o modificate: '+LRTrim(Str(cNumNew,10,0)))
obj='Exec
pag=5
prev=O1499
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1498
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1497
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1496
var_op='asgn
I
obj='Exec
pag=5
prev=O1495
I
obj='Exec
pag=5
prev=O1493
I
obj='While
pag=5
prev=O1492
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1493
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=5
prev=O1503
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
father=O1504
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1509
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O1511
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,257,6))))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,318,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc='_flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,331,9))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))) or (Empty(LRTrim(_numprog)) and not(Empty(LRTrim(Left(riga,8)))))
]
h=[
19
19
]
obj='If
pag=5
prev=O1533
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1536
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,155,1)='S' or Substr(riga,155,1)='1' or Substr(riga,155,1)='7'
'Substr(riga,155,1)='E' or Substr(riga,155,1)='3' or Substr(riga,155,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,147,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,9,1)='1' or Substr(riga,9,1)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,301,1)),'0',iif(Substr(riga,301,1)='S','1',iif(Substr(riga,301,1)='N','1',Substr(riga,301,1))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,231,11))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,852,19))),0,Val(LRTrim(Substr(riga,852,19))))
len=15
name='_totin
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,871,19))),0,Val(LRTrim(Substr(riga,871,19))))
len=15
name='_totout
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge i dati dell'intermediario controparte
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='operazbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_oldidb)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=5
prev=O1568
var_op='asgn
I
obj='If
pag=5
prev=O1566
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1568
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='sogopebo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='clientiope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='beneficope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='terzistiope
obj='Delete
pag=5
prev=O1583
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=5
prev=O1582
sel_field='*
sel_name='terzistiope
sel_where='terzistiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistiope
father=O1583
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'cOpeProg1
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=5
prev=O1580
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=5
prev=O1579
sel_field='*
sel_name='beneficope
sel_where='beneficope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficope
father=O1580
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
]
rd_kvar=[
'cOpeProg1
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=5
prev=O1577
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=5
prev=O1576
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O1577
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=5
prev=O1574
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=5
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sogopebo
father=O1574
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=5
prev=O1564
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
'IMPIN
'IMPOUT
'MITIG
]
rd_kvar=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'Substr(riga,10,4)
'_intercab
'_iccab
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'LRTrim(Substr(riga,484,16))
'LRTrim(Substr(riga,302,16))
'LRTrim(Substr(riga,190,16))
'LRTrim(Substr(riga,206,16))
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_datarett
'_iccit
'_intercit
'_icrag
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'_flagrap2
'cOpeProg1
'cIdCau
'"O"+Right(cOpeProg2,9)+_idb2
'Substr(riga,424,30)
'Substr(riga,813,15)
'Substr(riga,414,5)
'Substr(riga,662,50)
'cOpeProg2
'Substr(riga,328,3)
'_idreg
''1'
'iif(Empty(Substr(riga,828,14)) or Substr(riga,828,14)='01010001000000',NullDateTime(),CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6)))
'_icsta
'Substr(riga,812,1)
'nProgImp
'_icprv
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
'_statoreg
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'_colleg
'_idb2
'_totin / 100
'_totout / 100
'Val(Substr(riga,893,4))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1566
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O1629
I
obj='Var
obj_type='N
pag=5
prev=O1628
var_op='asgn
I
obj='Exec
pag=5
prev=O1627
I
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Begin
pag=5
prev=O1562
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1564
fatherSonIndex=0
frm_calc='''
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=70
name='_icrag
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,18,11)))) and Len(LRTrim(Substr(riga,64,6)+Substr(riga,70,50)+Substr(riga,29,3)+Substr(riga,62,2)+Substr(riga,32,30))) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1638
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O1639
fatherSonIndex=0
obj='Read
pag=5
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'Substr(riga,18,11)
]
rd_var=[
'_iccab
'_iccit
'_icprv
'_icsta
'_icrag
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1639
fatherSonIndex=1
frm_calc='Substr(riga,64,6)
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,32,30)
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,62,2)
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,29,3))
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,70,50)
len=70
name='_icrag
obj='Var
pag=5
prev=O1653
var_op='asgn
I
obj='Var
pag=5
prev=O1652
var_op='asgn
I
obj='Var
pag=5
prev=O1651
var_op='asgn
I
obj='Var
pag=5
prev=O1650
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=5
prev=O1637
var_op='asgn
I
obj='Var
pag=5
prev=O1636
var_op='asgn
I
obj='Var
pag=5
prev=O1635
var_op='asgn
I
obj='Var
pag=5
prev=O1634
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
prev=O1561
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1562
fatherSonIndex=0
frm_calc='Upper(Substr(riga,511,70))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,581,3))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,584,30))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,614,6)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,620,2))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,622,35))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,657,5))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,302,16))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=5
prev=O1669
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1672
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,120,25))))
]
h=[
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1677
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1682
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O1693
I
obj='Read
pag=5
prev=O1692
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=5
prev=O1691
var_op='asgn
I
obj='Var
pag=5
prev=O1690
var_op='asgn
I
obj='Var
pag=5
prev=O1689
var_op='asgn
I
obj='Var
pag=5
prev=O1688
var_op='asgn
I
obj='Var
pag=5
prev=O1687
var_op='asgn
I
obj='Var
pag=5
prev=O1686
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1666
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1669
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=5
prev=O1710
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,302,16)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=5
prev=O1709
var_op='asgn
I
obj='Var
pag=5
prev=O1708
var_op='asgn
I
obj='Var
pag=5
prev=O1707
var_op='asgn
I
obj='Var
pag=5
prev=O1706
var_op='asgn
I
obj='Var
pag=5
prev=O1705
var_op='asgn
I
obj='Var
pag=5
prev=O1704
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1665
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O1666
fatherSonIndex=0
obj='Read
pag=5
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1664
var_op='asgn
I
obj='Var
pag=5
prev=O1663
var_op='asgn
I
obj='Var
pag=5
prev=O1662
var_op='asgn
I
obj='Var
pag=5
prev=O1661
var_op='asgn
I
obj='Var
pag=5
prev=O1660
var_op='asgn
I
obj='Var
pag=5
prev=O1659
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1560
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1559
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1558
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1557
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1555
var_op='asgn
I
obj='Select
pag=5
par_expr=[
'Substr(riga,10,4)
'Substr(riga,14,2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O1554
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1555
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1553
var_op='asgn
I
obj='Var
pag=5
prev=O1552
var_op='asgn
I
obj='Var
pag=5
prev=O1551
var_op='asgn
I
obj='Var
pag=5
prev=O1550
var_op='asgn
I
obj='Var
pag=5
prev=O1549
var_op='asgn
I
obj='Var
obj_type='D
pag=5
prev=O1546
var_op='asgn
I
obj='Case
pag=5
prev=O1545
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1546
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1546
fatherSonIndex=1
frm_calc=[
'Substr(riga,155,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1736
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1736
fatherSonIndex=1
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1546
fatherSonIndex=2
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=5
prev=O1544
var_op='asgn
I
obj='Var
pag=5
prev=O1541
var_op='asgn
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1541
fatherSonIndex=0
frm_calc='_numprog
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''1'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
obj='Var
obj_type='D
pag=5
prev=O1751
var_op='asgn
I
obj='Var
pag=5
prev=O1750
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1541
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("POPERAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''0'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datarett
obj='Var
obj_type='D
pag=5
prev=O1755
var_op='asgn
I
obj='Var
pag=5
prev=O1754
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1530
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1533
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Left(riga,8)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1761
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1766
sel_field='operazbo->IDBASE
sel_name='operazbo
sel_where='operazbo->NUMPROG=_numprog and (operazbo->STATOREG='0'  or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O1767
fatherSonIndex=0
frm_calc='"E' stata cancellata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=5
prev=O1771
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'operazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
]
wr_var=[
''2'
'Date()
]
I
nonlocal=True
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
father=O1761
fatherSonIndex=1
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"E' stata variata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1782
sel_field='operazbo->IDBASE,operazbo->NUMPROG,operazbo->DATAOPE,operazbo->FLAGRAP2,operazbo->IDEREG
sel_name='operazbo
sel_where='operazbo->NUMPROG=_numprog and (operazbo->STATOREG='0'  or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1783
fatherSonIndex=0
frm_calc='operazbo->IDBASE
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(operazbo->FLAGRAP2) or operazbo->FLAGRAP2='S',Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(operazbo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='operazbo->IDEREG
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='operazbo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1795
sel_field='*
sel_name='terzistiope
sel_where='terzistiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='merzistiope
father=O1797
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'IDREG
]
rd_kvar=[
'_oldidb
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1793
sel_field='*
sel_name='beneficope
sel_where='beneficope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='meneficope
father=O1795
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
'IDREG
]
rd_kvar=[
'_oldidb
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1791
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mlientiope
father=O1793
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1790
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mogopebo
father=O1791
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=5
prev=O1789
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'operazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
'FLAGRAP2
]
wr_op=[
'=
'=
'=
]
wr_var=[
''3'
'Date()
'_flagrap2
]
I
obj='Var
pag=5
prev=O1788
var_op='asgn
I
obj='Var
pag=5
prev=O1787
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=5
prev=O1781
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1529
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1530
fatherSonIndex=0
frm_calc=[
'Upper(Substr(riga,331,9))='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1834
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_field='operazbo->NUMPROG
sel_name='operazbo
sel_where='operazbo->INFORM = Substr(riga,424,30) and (operazbo->STATOREG='0' or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1839
fatherSonIndex=0
frm_calc='operazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1834
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=5
sel_field='operazbo->NUMPROG
sel_name='operazbo
sel_where='operazbo->RIFIMP = Substr(riga,331,9) and (operazbo->STATOREG='0' or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1846
fatherSonIndex=0
frm_calc='operazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1528
var_op='asgn
I
obj='Var
pag=5
prev=O1527
var_op='asgn
I
obj='Var
pag=5
prev=O1526
var_op='asgn
I
obj='Var
pag=5
prev=O1523
var_op='asgn
I
obj='If
pag=5
prev=O1522
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O1523
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=5
prev=O1856
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1857
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O1863
I
obj='Var
obj_type='N
pag=5
prev=O1862
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,318,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1521
var_op='asgn
I
obj='Remark
pag=5
prev=O1518
I
obj='If
pag=5
prev=O1516
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1518
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,263,30))+LRTrim(Substr(riga,295,6))+LRTrim(Substr(riga,293,2))))
]
h=[
19
19
]
obj='If
pag=5
prev=O1875
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1878
fatherSonIndex=0
frm_calc='LRTrim(Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=5
prev=O1884
var_op='asgn
I
obj='Var
pag=5
prev=O1883
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1874
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1875
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(Substr(riga,257,6))+" non è presente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O1890
I
obj='Var
obj_type='N
pag=5
prev=O1889
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O1873
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'Substr(riga,257,6)
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1516
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,246,11))),_codinter,Substr(riga,246,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,263,30))),_citinter,Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,295,6))),_cabinter,Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,293,2))),_prvinter,Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=5
prev=O1902
var_op='asgn
I
obj='Var
pag=5
prev=O1901
var_op='asgn
I
obj='Var
pag=5
prev=O1900
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1511
fatherSonIndex=1
frm_calc='1
len=1
name='_opeerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(ohand,riga+" - "+_descerr)
obj='Exec
pag=5
prev=O1906
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1509
fatherSonIndex=0
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,190,16))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,206,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,484,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,190,16))) and Empty(LRTrim(Substr(riga,120,25))) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=5
prev=O1922
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1925
fatherSonIndex=0
frm_calc=''Rapporto continuativo o Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O1930
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1919
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1922
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=5
prev=O1936
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1937
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto per conto del quale assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O1942
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O1935
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,484,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1916
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1919
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=5
prev=O1953
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1954
fatherSonIndex=0
frm_calc=''Anagrafica Controparte Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O1959
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O1952
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,302,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1913
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1916
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=5
prev=O1970
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1971
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto Operante Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O1976
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O1969
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,206,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1912
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1913
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=5
prev=O1987
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1988
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O1993
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O1986
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,190,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1911
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1491
var_op='asgn
I
obj='Var
pag=5
prev=O1490
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1489
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1488
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
prev=O1487
I
obj='Remark
pag=5
x=15
y=15
I
Icpitembatch.CPRead
arch='tbcauana
obj='Read
pag=5
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,10,4)
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
x=607
y=4557
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Frazionate Inserite o Modificate: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','FRAZIOBO','Frazionate Inserite o modificate: '+LRTrim(Str(cNumNew,10,0)))
obj='Exec
pag=6
prev=O2021
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O2020
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O2019
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O2018
var_op='asgn
I
obj='Exec
pag=6
prev=O2017
I
obj='Exec
pag=6
prev=O2015
I
obj='While
pag=6
prev=O2014
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2015
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=6
prev=O2025
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
father=O2026
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
prev=O2031
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O2033
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,257,6))))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,318,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc='_flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,331,9))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))) or (Empty(LRTrim(_numprog)) and not(Empty(LRTrim(Left(riga,8)))))
]
h=[
19
19
]
obj='If
pag=6
prev=O2055
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2058
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,155,1)='S' or Substr(riga,155,1)='1' or Substr(riga,155,1)='7'
'Substr(riga,155,1)='E' or Substr(riga,155,1)='3' or Substr(riga,155,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,147,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,9,1)='1' or Substr(riga,9,1)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,301,1)),'0',iif(Substr(riga,301,1)='S','1',iif(Substr(riga,301,1)='N','1',Substr(riga,301,1))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,231,11))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' frazionate del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,852,19))),0,Val(LRTrim(Substr(riga,852,19))))
len=15
name='_totin
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,871,19))),0,Val(LRTrim(Substr(riga,871,19))))
len=15
name='_totout
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge i dati dell'intermediario controparte
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='fraziobo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_oldidb)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=6
prev=O2090
var_op='asgn
I
obj='If
pag=6
prev=O2088
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2090
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='sogopefbo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='clientifrz
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='beneficfrz
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='terzistifrz
obj='Delete
pag=6
prev=O2105
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=6
prev=O2104
sel_field='*
sel_name='terzistifrz
sel_where='terzistifrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistifrz
father=O2105
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'cOpeProg1
'terzistifrz->CODSOG
'terzistifrz->TIPOFILE
'terzistifrz->NUMCOL
'terzistifrz->LEGAME
'terzistifrz->RAPCOL
'terzistifrz->UCODE
'terzistifrz->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=6
prev=O2102
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=6
prev=O2101
sel_field='*
sel_name='beneficfrz
sel_where='beneficfrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficfrz
father=O2102
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
]
rd_kvar=[
'cOpeProg1
'beneficfrz->CPROWNUM
'beneficfrz->CODSOG
'beneficfrz->TIPOFILE
'beneficfrz->NUMCOL
'beneficfrz->LEGAME
'beneficfrz->RAPCOL
'beneficfrz->UCODE
'beneficfrz->IDBASE
'beneficfrz->C_RAG
'beneficfrz->C_STA
'beneficfrz->C_CTA
'beneficfrz->C_CAB
'beneficfrz->C_PRV
'beneficfrz->C_IND
'beneficfrz->C_CAP
'beneficfrz->C_RAPPORTO
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=6
prev=O2099
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=6
prev=O2098
sel_field='*
sel_name='clientifrz
sel_where='clientifrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientifrz
father=O2099
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'clientifrz->CODSOG
'clientifrz->LEGAME
'clientifrz->IDBASE
'clientifrz->NUMCOL
'clientifrz->TIPOFILE
'clientifrz->RAPCOL
'clientifrz->UCODE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=6
prev=O2096
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=6
sel_field='*
sel_name='sogopefbo
sel_where='sogopefbo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sogopefbo
father=O2096
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'sogopefbo->CPROWNUM
'sogopefbo->CODSOG
'sogopefbo->LEGAME
'sogopefbo->IDBASE
'sogopefbo->NUMCOL
'sogopefbo->TIPOFILE
'sogopefbo->RAPCOL
'sogopefbo->UCODE
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=6
prev=O2086
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
'IMPIN
'IMPOUT
'MITIG
]
rd_kvar=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'Substr(riga,10,4)
'_intercab
'_iccab
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'LRTrim(Substr(riga,484,16))
'LRTrim(Substr(riga,302,16))
'LRTrim(Substr(riga,190,16))
'LRTrim(Substr(riga,206,16))
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_datarett
'_iccit
'_intercit
'_icrag
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'_flagrap2
'cOpeProg1
'cIdCau
'"F"+Right(cOpeProg2,9)+_idb2
'Substr(riga,424,30)
'Substr(riga,813,15)
'Substr(riga,414,5)
'Substr(riga,662,50)
'cOpeProg2
'Substr(riga,328,3)
'_idreg
''1'
'iif(Empty(Substr(riga,828,14)) or Substr(riga,828,14)='01010001000000',NullDateTime(),CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6)))
'_icsta
'Substr(riga,812,1)
'nProgImp
'_icprv
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
'_statoreg
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'_colleg
'_idb2
'_totin / 100
'_totout / 100
'Val(Substr(riga,893,4))
]
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2088
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=6
prev=O2151
I
obj='Var
obj_type='N
pag=6
prev=O2150
var_op='asgn
I
obj='Exec
pag=6
prev=O2149
I
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Begin
pag=6
prev=O2084
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2086
fatherSonIndex=0
frm_calc='''
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=70
name='_icrag
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,18,11)))) and Len(LRTrim(Substr(riga,64,6)+Substr(riga,70,50)+Substr(riga,29,3)+Substr(riga,62,2)+Substr(riga,32,30))) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
prev=O2160
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O2161
fatherSonIndex=0
obj='Read
pag=6
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'Substr(riga,18,11)
]
rd_var=[
'_iccab
'_iccit
'_icprv
'_icsta
'_icrag
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2161
fatherSonIndex=1
frm_calc='Substr(riga,64,6)
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,32,30)
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,62,2)
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,29,3))
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,70,50)
len=70
name='_icrag
obj='Var
pag=6
prev=O2175
var_op='asgn
I
obj='Var
pag=6
prev=O2174
var_op='asgn
I
obj='Var
pag=6
prev=O2173
var_op='asgn
I
obj='Var
pag=6
prev=O2172
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=6
prev=O2159
var_op='asgn
I
obj='Var
pag=6
prev=O2158
var_op='asgn
I
obj='Var
pag=6
prev=O2157
var_op='asgn
I
obj='Var
pag=6
prev=O2156
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
prev=O2083
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2084
fatherSonIndex=0
frm_calc='Upper(Substr(riga,511,70))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,581,3))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,584,30))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,614,6)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,620,2))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,622,35))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,657,5))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,302,16))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=6
prev=O2191
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2194
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,120,25))))
]
h=[
19
19
]
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2199
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=6
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2204
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=6
prev=O2215
I
obj='Read
pag=6
prev=O2214
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=6
prev=O2213
var_op='asgn
I
obj='Var
pag=6
prev=O2212
var_op='asgn
I
obj='Var
pag=6
prev=O2211
var_op='asgn
I
obj='Var
pag=6
prev=O2210
var_op='asgn
I
obj='Var
pag=6
prev=O2209
var_op='asgn
I
obj='Var
pag=6
prev=O2208
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O2188
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2191
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=6
prev=O2232
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,302,16)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=6
prev=O2231
var_op='asgn
I
obj='Var
pag=6
prev=O2230
var_op='asgn
I
obj='Var
pag=6
prev=O2229
var_op='asgn
I
obj='Var
pag=6
prev=O2228
var_op='asgn
I
obj='Var
pag=6
prev=O2227
var_op='asgn
I
obj='Var
pag=6
prev=O2226
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O2187
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O2188
fatherSonIndex=0
obj='Read
pag=6
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O2186
var_op='asgn
I
obj='Var
pag=6
prev=O2185
var_op='asgn
I
obj='Var
pag=6
prev=O2184
var_op='asgn
I
obj='Var
pag=6
prev=O2183
var_op='asgn
I
obj='Var
pag=6
prev=O2182
var_op='asgn
I
obj='Var
pag=6
prev=O2181
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O2082
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O2081
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O2080
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O2079
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O2077
var_op='asgn
I
obj='Select
pag=6
par_expr=[
'Substr(riga,10,4)
'Substr(riga,14,2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O2076
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2077
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O2075
var_op='asgn
I
obj='Var
pag=6
prev=O2074
var_op='asgn
I
obj='Var
pag=6
prev=O2073
var_op='asgn
I
obj='Var
pag=6
prev=O2072
var_op='asgn
I
obj='Var
pag=6
prev=O2071
var_op='asgn
I
obj='Var
obj_type='D
pag=6
prev=O2068
var_op='asgn
I
obj='Case
pag=6
prev=O2067
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2068
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O2068
fatherSonIndex=1
frm_calc=[
'Substr(riga,155,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2258
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2258
fatherSonIndex=1
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2068
fatherSonIndex=2
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=6
prev=O2066
var_op='asgn
I
obj='Var
pag=6
prev=O2063
var_op='asgn
I
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2063
fatherSonIndex=0
frm_calc='_numprog
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''1'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
obj='Var
obj_type='D
pag=6
prev=O2273
var_op='asgn
I
obj='Var
pag=6
prev=O2272
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2063
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PFRAZIO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''0'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datarett
obj='Var
obj_type='D
pag=6
prev=O2277
var_op='asgn
I
obj='Var
pag=6
prev=O2276
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O2052
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2055
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Left(riga,8)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2283
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=6
prev=O2288
sel_field='fraziobo->IDBASE
sel_name='fraziobo
sel_where='fraziobo->NUMPROG=_numprog and (fraziobo->STATOREG='0'  or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O2289
fatherSonIndex=0
frm_calc='"E' stata cancellata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=6
prev=O2293
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'fraziobo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
]
wr_var=[
''2'
'Date()
]
I
nonlocal=True
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
father=O2283
fatherSonIndex=1
frm_calc=''JLMNOTUV?'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"E' stata variata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=6
prev=O2304
sel_field='fraziobo->IDBASE,fraziobo->NUMPROG,fraziobo->DATAOPE,fraziobo->FLAGRAP2,fraziobo->IDEREG
sel_name='fraziobo
sel_where='fraziobo->NUMPROG=_numprog and (fraziobo->STATOREG='0'  or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2305
fatherSonIndex=0
frm_calc='fraziobo->IDBASE
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(fraziobo->FLAGRAP2) or fraziobo->FLAGRAP2='Z',Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(fraziobo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='fraziobo->IDEREG
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='fraziobo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=6
prev=O2317
sel_field='*
sel_name='terzistifrz
sel_where='terzistifrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='merzistifrz
father=O2319
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'IDREG
]
rd_kvar=[
'_oldidb
'terzistifrz->CODSOG
'terzistifrz->TIPOFILE
'terzistifrz->NUMCOL
'terzistifrz->LEGAME
'terzistifrz->RAPCOL
'terzistifrz->UCODE
'terzistifrz->IDBASE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=6
prev=O2315
sel_field='*
sel_name='beneficfrz
sel_where='beneficfrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='meneficfrz
father=O2317
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
'IDREG
]
rd_kvar=[
'_oldidb
'beneficfrz->CPROWNUM
'beneficfrz->CODSOG
'beneficfrz->TIPOFILE
'beneficfrz->NUMCOL
'beneficfrz->LEGAME
'beneficfrz->RAPCOL
'beneficfrz->UCODE
'beneficfrz->IDBASE
'beneficfrz->C_RAG
'beneficfrz->C_STA
'beneficfrz->C_CTA
'beneficfrz->C_CAB
'beneficfrz->C_PRV
'beneficfrz->C_IND
'beneficfrz->C_CAP
'beneficfrz->C_RAPPORTO
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=6
prev=O2313
sel_field='*
sel_name='clientifrz
sel_where='clientifrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mlientifrz
father=O2315
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'clientifrz->CODSOG
'clientifrz->LEGAME
'clientifrz->IDBASE
'clientifrz->NUMCOL
'clientifrz->TIPOFILE
'clientifrz->RAPCOL
'clientifrz->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=6
prev=O2312
sel_field='*
sel_name='sogopefbo
sel_where='sogopefbo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mogopefbo
father=O2313
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'sogopefbo->CPROWNUM
'sogopefbo->CODSOG
'sogopefbo->LEGAME
'sogopefbo->IDBASE
'sogopefbo->NUMCOL
'sogopefbo->TIPOFILE
'sogopefbo->RAPCOL
'sogopefbo->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=6
prev=O2311
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'fraziobo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
'FLAGRAP2
]
wr_op=[
'=
'=
'=
]
wr_var=[
''3'
'Date()
'_flagrap2
]
I
obj='Var
pag=6
prev=O2310
var_op='asgn
I
obj='Var
pag=6
prev=O2309
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=6
prev=O2303
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O2051
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2052
fatherSonIndex=0
frm_calc=[
'Upper(Substr(riga,331,9))='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2356
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=6
sel_field='fraziobo->NUMPROG
sel_name='fraziobo
sel_where='fraziobo->INFORM = Substr(riga,424,30) and (fraziobo->STATOREG='0' or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2361
fatherSonIndex=0
frm_calc='fraziobo->NUMPROG
len=11
name='_numprog
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2356
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=6
sel_field='fraziobo->NUMPROG
sel_name='fraziobo
sel_where='fraziobo->RIFIMP = Substr(riga,331,9) and (fraziobo->STATOREG='0' or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2368
fatherSonIndex=0
frm_calc='fraziobo->NUMPROG
len=11
name='_numprog
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O2050
var_op='asgn
I
obj='Var
pag=6
prev=O2049
var_op='asgn
I
obj='Var
pag=6
prev=O2048
var_op='asgn
I
obj='Var
pag=6
prev=O2045
var_op='asgn
I
obj='If
pag=6
prev=O2044
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='fraziobo
father=O2045
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=6
prev=O2378
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2379
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=6
prev=O2385
I
obj='Var
obj_type='N
pag=6
prev=O2384
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,318,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O2043
var_op='asgn
I
obj='Remark
pag=6
prev=O2040
I
obj='If
pag=6
prev=O2038
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2040
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,263,30))+LRTrim(Substr(riga,295,6))+LRTrim(Substr(riga,293,2))))
]
h=[
19
19
]
obj='If
pag=6
prev=O2397
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2400
fatherSonIndex=0
frm_calc='LRTrim(Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=6
prev=O2406
var_op='asgn
I
obj='Var
pag=6
prev=O2405
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O2396
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2397
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(Substr(riga,257,6))+" non è presente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=6
prev=O2412
I
obj='Var
obj_type='N
pag=6
prev=O2411
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O2395
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'Substr(riga,257,6)
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=6
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2038
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,246,11))),_codinter,Substr(riga,246,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,263,30))),_citinter,Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,295,6))),_cabinter,Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,293,2))),_prvinter,Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=6
prev=O2424
var_op='asgn
I
obj='Var
pag=6
prev=O2423
var_op='asgn
I
obj='Var
pag=6
prev=O2422
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2033
fatherSonIndex=1
frm_calc='1
len=1
name='_frzerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(zhand,riga+" - "+_descerr)
obj='Exec
pag=6
prev=O2428
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2031
fatherSonIndex=0
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,190,16))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,206,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,484,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,190,16))) and Empty(LRTrim(Substr(riga,120,25))) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=6
prev=O2444
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2447
fatherSonIndex=0
frm_calc=''Rapporto continuativo Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O2452
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O2441
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2444
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=6
prev=O2458
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2459
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto per conto del quale assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O2464
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O2457
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,484,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O2438
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2441
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=6
prev=O2475
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2476
fatherSonIndex=0
frm_calc=''Anagrafica Controparte Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O2481
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O2474
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,302,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O2435
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2438
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=6
prev=O2492
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2493
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto Operante Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O2498
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O2491
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,206,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O2434
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2435
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=6
prev=O2509
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2510
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O2515
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O2508
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,190,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O2433
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O2013
var_op='asgn
I
obj='Var
pag=6
prev=O2012
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O2011
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O2010
var_op='asgn
I
obj='Var
pag=6
pagelocal=True
prev=O2009
I
obj='Remark
pag=6
x=15
y=15
I
Icpitembatch.CPRead
arch='tbcauana
obj='Read
pag=6
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,10,4)
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
x=696
y=2867
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Rapporti Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Rapporti Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=7
prev=O2542
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=7
prev=O2541
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=7
prev=O2540
var_op='asgn
I
obj='Exec
pag=7
prev=O2539
I
obj='Exec
pag=7
prev=O2537
I
obj='While
pag=7
prev=O2536
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2537
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=7
prev=O2546
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2547
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' rapporti del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='cFlagLire
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,77,1)='S' or Substr(riga,77,1)='1' or Substr(riga,77,1)='7'
'Substr(riga,77,1)='E' or Substr(riga,77,1)='3' or Substr(riga,77,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='xRapporto
next=Icpitembatch.CPRead
arch='xnarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xRapporto))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=7
prev=O2559
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O2560
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xnarapbo
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='knarapbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=7
prev=O2568
var_op='asgn
I
obj='Insert
pag=7
prev=O2566
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGRAP
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
''P'
'Substr(riga,76,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2568
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=7
prev=O2577
I
obj='Var
obj_type='N
pag=7
prev=O2576
var_op='asgn
I
obj='Exec
pag=7
prev=O2575
I
nonlocal=True
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Insert
pag=7
prev=O2565
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
'PRGIMPRAP
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,94,5)),3))
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2566
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=7
prev=O2586
I
obj='Var
obj_type='N
pag=7
prev=O2585
var_op='asgn
I
obj='Exec
pag=7
prev=O2584
I
nonlocal=True
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='xnarapbo
father=O2560
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='knarapbo
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=7
prev=O2592
var_op='asgn
I
obj='Write
pag=7
prev=O2590
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'DESCRAP
'FLAGRAP
'TIPORAP
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Substr(riga,26,50)
'Substr(riga,76,1)
''P'
]
I
obj='Write
pag=7
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2590
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=7
prev=O2607
I
obj='Var
obj_type='N
pag=7
prev=O2606
var_op='asgn
I
obj='Exec
pag=7
prev=O2605
I
nonlocal=True
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,94,5)),3))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=7
prev=O2558
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Left(riga,25)
]
rd_var=[
'xRapporto
]
I
obj='Var
pag=7
prev=O2555
var_op='asgn
I
obj='Case
pag=7
prev=O2554
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2555
fatherSonIndex=0
frm_calc=''L'
len=1
name='cFlagLire
obj='Var
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2555
fatherSonIndex=1
frm_calc=''E'
len=1
name='cFlagLire
obj='Var
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2555
fatherSonIndex=2
frm_calc=''V'
len=1
name='cFlagLire
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=7
prev=O2553
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=7
prev=O2552
var_op='asgn
I
obj='Var
obj_type='N
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=7
prev=O2535
var_op='asgn
I
obj='Var
pag=7
prev=O2534
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=7
prev=O2533
var_op='asgn
I
obj='Var
obj_type='N
pag=7
prev=O2532
var_op='asgn
I
obj='Var
obj_type='N
pag=7
prev=O2531
var_op='asgn
I
obj='Remark
pag=7
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Informazione Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O2638
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O2637
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O2636
var_op='asgn
I
obj='Exec
pag=8
prev=O2635
I
obj='Exec
pag=8
prev=O2633
I
obj='While
pag=8
prev=O2632
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2633
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=8
prev=O2642
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O2643
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='cCli1
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,75,16)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,50,16)
len=16
name='xSOCTCon
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xSOCTCon)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' informazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,46,1)='S' or Substr(riga,46,1)='1' or Substr(riga,46,1)='7'
'Substr(riga,46,1)='E' or Substr(riga,46,1)='3' or Substr(riga,46,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,159,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,36,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPInsert
arch='xapopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,44,2) <> '25' and Substr(riga,44,2) <> '28'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
prev=O2680
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2683
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(cCli1))
]
h=[
19
19
]
obj='If
pag=8
prev=O2688
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2689
fatherSonIndex=0
frm_calc=[
'Substr(riga,44,2)='25' or Substr(riga,44,2)='28'
'Substr(riga,45,1)='6' or Substr(riga,44,2)='38'
]
h=[
19
19
19
19
]
haselse=True
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2694
fatherSonIndex=0
frm_calc=[
'Substr(riga,44,2)='25'
'Substr(riga,44,2)='28'
]
h=[
19
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xelegabo
father=O2699
fatherSonIndex=0
h=[
19
19
]
obj='Insert
pag=8
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2704
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O2712
I
obj='Var
obj_type='N
pag=8
prev=O2711
var_op='asgn
I
obj='Exec
pag=8
prev=O2710
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xelegabo
father=O2699
fatherSonIndex=1
h=[
19
19
]
obj='Insert
pag=8
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAFINE
'TIPOPERS
'CODINTER
'NUMPROG2
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2716
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O2724
I
obj='Var
obj_type='N
pag=8
prev=O2723
var_op='asgn
I
obj='Exec
pag=8
prev=O2722
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPInsert
arch='xntestbo
father=O2694
fatherSonIndex=1
h=[
19
19
]
obj='Insert
pag=8
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAFINE
'TIPOPERS
'CODINTER
'NUMPROG2
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2729
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O2737
I
obj='Var
obj_type='N
pag=8
prev=O2736
var_op='asgn
I
obj='Exec
pag=8
prev=O2735
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPInsert
arch='xntestbo
father=O2694
fatherSonIndex=2
h=[
19
19
]
obj='Insert
pag=8
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2741
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O2749
I
obj='Var
obj_type='N
pag=8
prev=O2748
var_op='asgn
I
obj='Exec
pag=8
prev=O2747
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2683
fatherSonIndex=1
frm_calc=[
'Substr(riga,44,2)='25' or Substr(riga,44,2)='28'
'Substr(riga,45,1)='6' or Substr(riga,44,2)='38'
]
h=[
19
19
19
19
]
haselse=True
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xntestbo
father=O2755
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=8
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cNumMod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2761
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O2770
I
obj='Var
obj_type='N
pag=8
prev=O2769
var_op='asgn
I
obj='Exec
pag=8
prev=O2768
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
]
wr_op=[
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xntestbo
father=O2755
fatherSonIndex=2
h=[
19
19
]
obj='Write
pag=8
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cNumMod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2777
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O2786
I
obj='Var
obj_type='N
pag=8
prev=O2785
var_op='asgn
I
obj='Exec
pag=8
prev=O2784
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
]
wr_op=[
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
]
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=8
prev=O2679
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2680
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=8
sel_field='*
sel_name='xntestbo
sel_order='xntestbo->CPROWNUM
sel_where='xntestbo->RAPPORTO=Substr(riga,9,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2796
fatherSonIndex=0
frm_calc=[
'xntestbo->CODINTER=cCli1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=8
prev=O2800
var_op='asgn
I
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2800
fatherSonIndex=0
frm_calc='xntestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
prev=O2678
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O2677
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O2675
var_op='asgn
I
obj='Insert
pag=8
prev=O2674
rd_kfield=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'VALUTA
'CDATREG
'IDBASE2
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'_cabinter
'Substr(riga,115,6)
'_intercod
'iif((_dataope < CharToDate('20100601') or _dataope > CharToDate('20131231')),xSOCTCF,'')
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_intercit
'Substr(riga,169,50)
'cFlagLire
'Substr(riga,34,1)
'cInfProg1
''I'+Right(cInfProg2,9)+_idb2
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'iif((_dataope < CharToDate('20100601') or _dataope > CharToDate('20131231')),Substr(riga,35,1),' ')
'Substr(riga,44,2)
'Substr(riga,159,10)
'Substr(riga,47,3)
'DateToChar(_datareg)
'_idb2
]
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2675
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O2816
I
obj='Var
obj_type='N
pag=8
prev=O2815
var_op='asgn
I
obj='Exec
pag=8
prev=O2814
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=8
prev=O2673
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O2672
var_op='asgn
I
obj='Var
pag=8
prev=O2671
var_op='asgn
I
obj='Var
pag=8
prev=O2670
var_op='asgn
I
obj='Var
obj_type='D
pag=8
prev=O2669
var_op='asgn
I
obj='Var
obj_type='D
pag=8
prev=O2666
var_op='asgn
I
obj='If
pag=8
prev=O2665
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='xapopebo
father=O2666
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'_unicode<>''
]
h=[
19
19
]
obj='If
pag=8
prev=O2821
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2822
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O2828
I
obj='Var
obj_type='N
pag=8
prev=O2827
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,159,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
prev=O2664
var_op='asgn
I
obj='Remark
pag=8
prev=O2661
I
obj='Case
pag=8
prev=O2660
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2661
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O2661
fatherSonIndex=1
frm_calc=[
'Substr(riga,46,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2840
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2840
fatherSonIndex=1
frm_calc='Substr(riga,46,1)
len=1
name='cFlagLire
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2661
fatherSonIndex=2
frm_calc='Substr(riga,46,1)
len=1
name='cFlagLire
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O2659
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O2656
var_op='asgn
I
obj='If
pag=8
prev=O2655
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='personbo
father=O2656
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=8
prev=O2854
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O2855
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=8
prev=O2860
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2861
fatherSonIndex=0
frm_calc='xSOCTCon
len=16
name='xSOCTCF
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
prev=O2654
var_op='asgn
I
obj='Var
pag=8
prev=O2651
var_op='asgn
I
obj='If
pag=8
prev=O2650
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2651
fatherSonIndex=0
frm_calc='Substr(riga,75,16)
len=16
name='xConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
obj='If
pag=8
prev=O2881
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O2882
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
obj='If
pag=8
prev=O2887
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2888
fatherSonIndex=0
frm_calc='xConnes
len=16
name='cCli1
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
prev=O2880
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
prev=O2648
var_op='asgn
I
obj='Begin
pag=8
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2648
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,104,11))),_codinter,Substr(riga,104,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,121,30))),_citinter,Substr(riga,121,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,153,6))),_cabinter,Substr(riga,153,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,151,2))),_prvinter,Substr(riga,151,2))
len=2
name='_interprv
obj='Var
pag=8
prev=O2909
var_op='asgn
I
obj='Var
pag=8
prev=O2908
var_op='asgn
I
obj='Var
pag=8
prev=O2907
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
prev=O2631
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O2630
var_op='asgn
I
obj='Var
pag=8
prev=O2629
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O2628
var_op='asgn
I
obj='Remark
pag=8
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','XPERAZBO','Operazioni Inserite: '+LRTrim(Str(cNumNew,10,0)))
obj='Exec
pag=9
prev=O2925
I
nonlocal=True
obj='Var
obj_type='M
pag=9
prev=O2924
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=9
prev=O2923
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=9
prev=O2922
var_op='asgn
I
obj='Exec
pag=9
prev=O2921
I
obj='Exec
pag=9
prev=O2919
I
obj='While
pag=9
prev=O2918
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2919
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=9
prev=O2929
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2930
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgRet='S'
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
prev=O2939
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O2941
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,257,6))))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,318,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,155,1)='S' or Substr(riga,155,1)='1' or Substr(riga,155,1)='7'
'Substr(riga,155,1)='E' or Substr(riga,155,1)='3' or Substr(riga,155,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,9,1)='1' or Substr(riga,9,1)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,301,1)),'0',iif(Substr(riga,301,1)='S','1',iif(Substr(riga,301,1)='N','1',Substr(riga,301,1))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,231,11))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,852,19))),0,Val(LRTrim(Substr(riga,852,19))))
len=15
name='_totin
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,871,19))),0,Val(LRTrim(Substr(riga,871,19))))
len=15
name='_totout
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge i dati dell'intermediario controparte
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,147,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPInsert
arch='xperazbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=9
prev=O2978
var_op='asgn
I
obj='Insert
pag=9
prev=O2977
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
'IMPIN
'IMPOUT
'MITIG
]
rd_kvar=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'Substr(riga,10,4)
'_intercab
'_iccab
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'LRTrim(Substr(riga,484,16))
'LRTrim(Substr(riga,302,16))
'LRTrim(Substr(riga,190,16))
'LRTrim(Substr(riga,206,16))
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_iccit
'_intercit
'_icrag
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'cOpeProg1
'cIdCau
'"O"+Right(cOpeProg2,9)+_idb2
'Substr(riga,424,30)
'Substr(riga,813,15)
'Substr(riga,414,5)
'Substr(riga,662,50)
'cOpeProg2
'Substr(riga,328,3)
''1'
'iif(Empty(Substr(riga,828,14)) or Substr(riga,828,14)='01010001000000',NullDateTime(),CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6)))
'_icsta
'Substr(riga,812,1)
'nProgImp
'_icprv
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
''0'
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'_colleg
'_idb2
'_totin / 100
'_totout / 100
'Val(Substr(riga,893,4))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2978
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=9
prev=O2987
I
obj='Var
obj_type='N
pag=9
prev=O2986
var_op='asgn
I
obj='Exec
pag=9
prev=O2985
I
nonlocal=True
obj='Var
obj_type='M
pag=9
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=9
prev=O2976
var_op='asgn
I
obj='Var
obj_type='D
pag=9
prev=O2974
var_op='asgn
I
obj='Begin
pag=9
prev=O2972
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2974
fatherSonIndex=0
frm_calc='''
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=70
name='_icrag
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,18,11)))) and Len(LRTrim(Substr(riga,64,6)+Substr(riga,70,50)+Substr(riga,29,3)+Substr(riga,62,2)+Substr(riga,32,30))) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
prev=O2996
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O2997
fatherSonIndex=0
obj='Read
pag=9
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'Substr(riga,18,11)
]
rd_var=[
'_iccab
'_iccit
'_icprv
'_icsta
'_icrag
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2997
fatherSonIndex=1
frm_calc='Substr(riga,64,6)
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,32,30)
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,62,2)
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,29,3))
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,70,50)
len=70
name='_icrag
obj='Var
pag=9
prev=O3011
var_op='asgn
I
obj='Var
pag=9
prev=O3010
var_op='asgn
I
obj='Var
pag=9
prev=O3009
var_op='asgn
I
obj='Var
pag=9
prev=O3008
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=9
prev=O2995
var_op='asgn
I
obj='Var
pag=9
prev=O2994
var_op='asgn
I
obj='Var
pag=9
prev=O2993
var_op='asgn
I
obj='Var
pag=9
prev=O2992
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=9
prev=O2971
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2972
fatherSonIndex=0
frm_calc='Upper(Substr(riga,511,70))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,581,3))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,584,30))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,614,6)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,620,2))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,622,35))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,657,5))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,302,16))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=9
prev=O3027
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3030
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,120,25))))
]
h=[
19
19
]
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3035
fatherSonIndex=0
frm_calc='''
len=1
name='_tiporap
next=Icpitembatch.CPRead
arch='knarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'_tiporap='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
prev=O3041
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3042
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=9
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3047
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=9
prev=O3058
I
obj='Read
pag=9
prev=O3057
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xntestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=9
prev=O3056
var_op='asgn
I
obj='Var
pag=9
prev=O3055
var_op='asgn
I
obj='Var
pag=9
prev=O3054
var_op='asgn
I
obj='Var
pag=9
prev=O3053
var_op='asgn
I
obj='Var
pag=9
prev=O3052
var_op='asgn
I
obj='Var
pag=9
prev=O3051
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3042
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=9
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3066
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=9
prev=O3077
I
obj='Read
pag=9
prev=O3076
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=9
prev=O3075
var_op='asgn
I
obj='Var
pag=9
prev=O3074
var_op='asgn
I
obj='Var
pag=9
prev=O3073
var_op='asgn
I
obj='Var
pag=9
prev=O3072
var_op='asgn
I
obj='Var
pag=9
prev=O3071
var_op='asgn
I
obj='Var
pag=9
prev=O3070
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=9
prev=O3040
rd_field=[
'TIPORAP
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Substr(riga,120,25)
]
rd_var=[
'_tiporap
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O3024
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3027
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=9
prev=O3099
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,302,16)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=9
prev=O3098
var_op='asgn
I
obj='Var
pag=9
prev=O3097
var_op='asgn
I
obj='Var
pag=9
prev=O3096
var_op='asgn
I
obj='Var
pag=9
prev=O3095
var_op='asgn
I
obj='Var
pag=9
prev=O3094
var_op='asgn
I
obj='Var
pag=9
prev=O3093
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O3023
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O3024
fatherSonIndex=0
obj='Read
pag=9
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O3022
var_op='asgn
I
obj='Var
pag=9
prev=O3021
var_op='asgn
I
obj='Var
pag=9
prev=O3020
var_op='asgn
I
obj='Var
pag=9
prev=O3019
var_op='asgn
I
obj='Var
pag=9
prev=O3018
var_op='asgn
I
obj='Var
pag=9
prev=O3017
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=9
prev=O2970
var_op='asgn
I
obj='Var
obj_type='N
pag=9
prev=O2969
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=9
prev=O2968
var_op='asgn
I
obj='Var
obj_type='N
pag=9
prev=O2966
var_op='asgn
I
obj='Select
pag=9
par_expr=[
'Substr(riga,10,4)
'Substr(riga,14,2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O2965
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2966
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O2964
var_op='asgn
I
obj='Var
pag=9
prev=O2963
var_op='asgn
I
obj='Var
pag=9
prev=O2962
var_op='asgn
I
obj='Var
pag=9
prev=O2961
var_op='asgn
I
obj='Var
pag=9
prev=O2958
var_op='asgn
I
obj='Case
pag=9
prev=O2957
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2958
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O2958
fatherSonIndex=1
frm_calc=[
'Substr(riga,155,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3125
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3125
fatherSonIndex=1
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2958
fatherSonIndex=2
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=9
prev=O2956
var_op='asgn
I
obj='Var
pag=9
prev=O2953
var_op='asgn
I
obj='If
pag=9
prev=O2952
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='xperazbo
father=O2953
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=9
prev=O3139
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3140
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=9
prev=O3146
I
obj='Var
obj_type='N
pag=9
prev=O3145
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=9
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,318,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O2951
var_op='asgn
I
obj='Remark
pag=9
prev=O2948
I
obj='If
pag=9
prev=O2946
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2948
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Substr(riga,263,30))+LRTrim(Substr(riga,295,6))+LRTrim(Substr(riga,293,2)))
]
h=[
19
19
]
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anadip
father=O3156
fatherSonIndex=0
obj='Read
pag=9
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'Substr(riga,257,6)
]
rd_var=[
'_intercit
'_intercab
'_interprv
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=9
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2946
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,246,11))),_codinter,Substr(riga,246,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,263,30))),_citinter,Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,295,6))),_cabinter,Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,293,2))),_prvinter,Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=9
prev=O3172
var_op='asgn
I
obj='Var
pag=9
prev=O3171
var_op='asgn
I
obj='Var
pag=9
prev=O3170
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2941
fatherSonIndex=1
frm_calc='1
len=1
name='_opeerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(ohand,riga+" - "+_descerr)
obj='Exec
pag=9
prev=O3176
I
obj='Var
obj_type='N
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=9
prev=O2936
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2939
fatherSonIndex=0
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,190,16))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,206,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,484,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,190,16))) and Empty(LRTrim(Substr(riga,120,25))) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=9
prev=O3192
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3195
fatherSonIndex=0
frm_calc=''Rapporto continuativo Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=9
prev=O3200
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O3189
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3192
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=9
prev=O3206
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3207
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto per conto del quale assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=9
prev=O3212
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=9
prev=O3205
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,484,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O3186
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3189
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=9
prev=O3223
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3224
fatherSonIndex=0
frm_calc=''Anagrafica Controparte Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=9
prev=O3229
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=9
prev=O3222
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,302,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O3183
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3186
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=9
prev=O3240
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3241
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto Operante Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=9
prev=O3246
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=9
prev=O3239
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,206,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O3182
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3183
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=9
prev=O3257
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3258
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=9
prev=O3263
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=9
prev=O3256
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,190,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=9
prev=O3181
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O2935
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xarchope
father=O2936
fatherSonIndex=0
obj='Insert
pag=9
rd_kfield=[
'IDPROG
'DATAOPE
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'CONNESCLI
'CONNESOPER
'CAMBIO
'NUMPROG
'TIPOOPRAP
'TIPOINTER
'CODINTER
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'CONNESBEN
'UNIQUECODE
'AGOPER
'RIFIMP
'ZCPARTE
'RAGIO
'MODSVOL
'AREAGEO
'INFORM
'AMMONT
'DURAT
'TIPO
'RRAGIO
'RCOMP
'RAREA
'RIMP
'RFREQ
'CONNALTRO
'DATAIMP
'RTIPO
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'NATURA
'SCOPO
'C_RAPPORTO
'RAPPORTBEN
'PAGASOGOP
'IPCOLLEG
'ORACOLLEG
'DUCOLLEG
]
rd_kvar=[
'conta
'Substr(riga,1,8)        
'Substr(riga,9,1)        
'Substr(riga,10,4)       
'Substr(riga,14,2)       
'Substr(riga,16,2)       
'Substr(riga,18,11)      
'Substr(riga,29,3)       
'Substr(riga,32,30)      
'Substr(riga,62,2)       
'Substr(riga,64,6)       
'Substr(riga,70,50)      
'Substr(riga,120,25)     
'Substr(riga,145,1)      
'Substr(riga,146,1)      
'Substr(riga,147,8)      
'Substr(riga,155,1)      
'Substr(riga,156,3)      
'Substr(riga,159,1)      
'Substr(riga,160,15)     
'Substr(riga,175,15)     
'Substr(riga,190,16)     
'Substr(riga,206,16)     
'Substr(riga,222,9)      
'Substr(riga,231,11)     
'Substr(riga,242,2)      
'Substr(riga,244,2)      
'Substr(riga,246,11)     
'Substr(riga,257,6)      
'Substr(riga,263,30)     
'Substr(riga,293,2)      
'Substr(riga,295,6)      
'Substr(riga,301,1)      
'Substr(riga,302,16)     
'Substr(riga,318,10)     
'Substr(riga,328,3)      
'Substr(riga,331,9)      
'Substr(riga,340,69)     
'Substr(riga,409,5)      
'Substr(riga,414,5)      
'Substr(riga,419,5)      
'Substr(riga,424,30)     
'Substr(riga,454,5)      
'Substr(riga,459,5)      
'Substr(riga,464,5)      
'Substr(riga,469,3)      
'Substr(riga,472,3)      
'Substr(riga,475,3)      
'Substr(riga,478,3)      
'Substr(riga,481,3)      
'Substr(riga,484,16)     
'Substr(riga,500,8)      
'Substr(riga,508,3)      
'Substr(riga,511,70)     
'Substr(riga,581,3)      
'Substr(riga,584,30)     
'Substr(riga,614,6)      
'Substr(riga,620,2)      
'Substr(riga,622,35)     
'Substr(riga,657,5)      
'Substr(riga,662,50)     
'Substr(riga,712,50)     
'Substr(riga,762,25)     
'Substr(riga,787,25)     
'Substr(riga,812,1)      
'Substr(riga,813,15)     
'Substr(riga,828,14)     
'Substr(riga,842,10)     
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=9
prev=O2917
var_op='asgn
I
obj='Var
pag=9
prev=O2916
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=9
prev=O2915
var_op='asgn
I
obj='Var
obj_type='N
pag=9
prev=O2914
var_op='asgn
I
obj='Remark
pag=9
x=15
y=15
I
Icpitembatch.CPRead
arch='tbcauana
obj='Read
pag=9
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,10,4)
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
x=703
y=1319
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Frazionate Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','XRAZIOBO','Frazionate Inserite: '+LRTrim(Str(cNumNew,10,0)))
obj='Exec
pag=10
prev=O3296
I
nonlocal=True
obj='Var
obj_type='M
pag=10
prev=O3295
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=10
prev=O3294
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=10
prev=O3293
var_op='asgn
I
obj='Exec
pag=10
prev=O3292
I
obj='Exec
pag=10
prev=O3290
I
obj='While
pag=10
prev=O3289
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3290
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=10
prev=O3300
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3301
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgRet='S'
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
prev=O3310
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O3312
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,257,6))))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,318,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPFRAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPFRAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,155,1)='S' or Substr(riga,155,1)='1' or Substr(riga,155,1)='7'
'Substr(riga,155,1)='E' or Substr(riga,155,1)='3' or Substr(riga,155,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,9,1)='1' or Substr(riga,9,1)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,301,1)),'0',iif(Substr(riga,301,1)='S','1',iif(Substr(riga,301,1)='N','1',Substr(riga,301,1))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,231,11))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' frazionate del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,852,19))),0,Val(LRTrim(Substr(riga,852,19))))
len=15
name='_totin
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,871,19))),0,Val(LRTrim(Substr(riga,871,19))))
len=15
name='_totout
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge i dati dell'intermediario controparte
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,147,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPInsert
arch='xraziobo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=10
prev=O3350
var_op='asgn
I
obj='Insert
pag=10
prev=O3349
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
'IMPIN
'IMPOUT
'MITIG
]
rd_kvar=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'Substr(riga,10,4)
'_intercab
'_iccab
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'LRTrim(Substr(riga,484,16))
'LRTrim(Substr(riga,302,16))
'LRTrim(Substr(riga,190,16))
'LRTrim(Substr(riga,206,16))
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_iccit
'_intercit
'_icrag
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'cOpeProg1
'cIdCau
''F'+Right(cOpeProg2,9)+_idb2
'Substr(riga,424,30)
'Substr(riga,813,15)
'Substr(riga,414,5)
'Substr(riga,662,50)
'cOpeProg2
'Substr(riga,328,3)
''1'
'iif(Empty(Substr(riga,828,14)) or Substr(riga,828,14)='01010001000000',NullDateTime(),CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6)))
'_icsta
'Substr(riga,812,1)
'nProgImp
'_icprv
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
''0'
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'_colleg
'_idb2
'_totin / 100
'_totout / 100
'Val(Substr(riga,893,4))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3350
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=10
prev=O3359
I
obj='Var
obj_type='N
pag=10
prev=O3358
var_op='asgn
I
obj='Exec
pag=10
prev=O3357
I
nonlocal=True
obj='Var
obj_type='M
pag=10
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=10
prev=O3348
var_op='asgn
I
obj='Var
obj_type='D
pag=10
prev=O3346
var_op='asgn
I
obj='Begin
pag=10
prev=O3344
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3346
fatherSonIndex=0
frm_calc='''
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=70
name='_icrag
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,18,11)))) and Len(LRTrim(Substr(riga,64,6)+Substr(riga,70,50)+Substr(riga,29,3)+Substr(riga,62,2)+Substr(riga,32,30))) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
prev=O3368
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O3369
fatherSonIndex=0
obj='Read
pag=10
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'Substr(riga,18,11)
]
rd_var=[
'_iccab
'_iccit
'_icprv
'_icsta
'_icrag
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3369
fatherSonIndex=1
frm_calc='Substr(riga,64,6)
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,32,30)
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,62,2)
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,29,3))
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,70,50)
len=70
name='_icrag
obj='Var
pag=10
prev=O3383
var_op='asgn
I
obj='Var
pag=10
prev=O3382
var_op='asgn
I
obj='Var
pag=10
prev=O3381
var_op='asgn
I
obj='Var
pag=10
prev=O3380
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=10
prev=O3367
var_op='asgn
I
obj='Var
pag=10
prev=O3366
var_op='asgn
I
obj='Var
pag=10
prev=O3365
var_op='asgn
I
obj='Var
pag=10
prev=O3364
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=10
prev=O3343
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3344
fatherSonIndex=0
frm_calc='Upper(Substr(riga,511,70))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,581,3))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,584,30))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,614,6)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,620,2))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,622,35))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,657,5))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,302,16))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=10
prev=O3399
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3402
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,120,25))))
]
h=[
19
19
]
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3407
fatherSonIndex=0
frm_calc='''
len=1
name='_tiporap
next=Icpitembatch.CPRead
arch='knarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'_tiporap='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
prev=O3413
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3414
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=10
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3419
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=10
prev=O3430
I
obj='Read
pag=10
prev=O3429
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xntestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=10
prev=O3428
var_op='asgn
I
obj='Var
pag=10
prev=O3427
var_op='asgn
I
obj='Var
pag=10
prev=O3426
var_op='asgn
I
obj='Var
pag=10
prev=O3425
var_op='asgn
I
obj='Var
pag=10
prev=O3424
var_op='asgn
I
obj='Var
pag=10
prev=O3423
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3414
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=10
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3438
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=10
prev=O3449
I
obj='Read
pag=10
prev=O3448
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=10
prev=O3447
var_op='asgn
I
obj='Var
pag=10
prev=O3446
var_op='asgn
I
obj='Var
pag=10
prev=O3445
var_op='asgn
I
obj='Var
pag=10
prev=O3444
var_op='asgn
I
obj='Var
pag=10
prev=O3443
var_op='asgn
I
obj='Var
pag=10
prev=O3442
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=10
prev=O3412
rd_field=[
'TIPORAP
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Substr(riga,120,25)
]
rd_var=[
'_tiporap
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O3396
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3399
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=10
prev=O3471
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,302,16)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=10
prev=O3470
var_op='asgn
I
obj='Var
pag=10
prev=O3469
var_op='asgn
I
obj='Var
pag=10
prev=O3468
var_op='asgn
I
obj='Var
pag=10
prev=O3467
var_op='asgn
I
obj='Var
pag=10
prev=O3466
var_op='asgn
I
obj='Var
pag=10
prev=O3465
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O3395
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O3396
fatherSonIndex=0
obj='Read
pag=10
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
prev=O3394
var_op='asgn
I
obj='Var
pag=10
prev=O3393
var_op='asgn
I
obj='Var
pag=10
prev=O3392
var_op='asgn
I
obj='Var
pag=10
prev=O3391
var_op='asgn
I
obj='Var
pag=10
prev=O3390
var_op='asgn
I
obj='Var
pag=10
prev=O3389
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
prev=O3342
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O3341
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=10
prev=O3340
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O3338
var_op='asgn
I
obj='Select
pag=10
par_expr=[
'Substr(riga,10,4)
'Substr(riga,14,2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O3337
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3338
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
prev=O3336
var_op='asgn
I
obj='Var
pag=10
prev=O3335
var_op='asgn
I
obj='Var
pag=10
prev=O3334
var_op='asgn
I
obj='Var
pag=10
prev=O3333
var_op='asgn
I
obj='Var
pag=10
prev=O3332
var_op='asgn
I
obj='Var
obj_type='D
pag=10
prev=O3329
var_op='asgn
I
obj='Case
pag=10
prev=O3328
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3329
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O3329
fatherSonIndex=1
frm_calc=[
'Substr(riga,155,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3497
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3497
fatherSonIndex=1
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3329
fatherSonIndex=2
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=10
prev=O3327
var_op='asgn
I
obj='Var
pag=10
prev=O3324
var_op='asgn
I
obj='If
pag=10
prev=O3323
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O3324
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=10
prev=O3511
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3512
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=10
prev=O3518
I
obj='Var
obj_type='N
pag=10
prev=O3517
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,318,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
prev=O3322
var_op='asgn
I
obj='Remark
pag=10
prev=O3319
I
obj='If
pag=10
prev=O3317
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3319
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Substr(riga,263,30))+LRTrim(Substr(riga,295,6))+LRTrim(Substr(riga,293,2)))
]
h=[
19
19
]
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anadip
father=O3528
fatherSonIndex=0
obj='Read
pag=10
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'Substr(riga,257,6)
]
rd_var=[
'_intercit
'_intercab
'_interprv
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=10
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3317
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,246,11))),_codinter,Substr(riga,246,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,263,30))),_citinter,Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,295,6))),_cabinter,Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,293,2))),_prvinter,Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=10
prev=O3544
var_op='asgn
I
obj='Var
pag=10
prev=O3543
var_op='asgn
I
obj='Var
pag=10
prev=O3542
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3312
fatherSonIndex=1
frm_calc='1
len=1
name='_frzerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(zhand,riga+" - "+_descerr)
obj='Exec
pag=10
prev=O3548
I
obj='Var
obj_type='N
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=10
prev=O3307
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3310
fatherSonIndex=0
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,190,16))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,206,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,484,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,190,16))) and Empty(LRTrim(Substr(riga,120,25))) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=10
prev=O3564
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3567
fatherSonIndex=0
frm_calc=''Rapporto continuativo Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=10
prev=O3572
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O3561
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3564
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=10
prev=O3578
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3579
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto per conto del quale assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=10
prev=O3584
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
prev=O3577
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,484,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O3558
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3561
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=10
prev=O3595
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3596
fatherSonIndex=0
frm_calc=''Anagrafica Controparte Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=10
prev=O3601
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
prev=O3594
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,302,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O3555
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3558
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=10
prev=O3612
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3613
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto Operante Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=10
prev=O3618
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
prev=O3611
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,206,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O3554
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3555
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=10
prev=O3629
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3630
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=10
prev=O3635
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
prev=O3628
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,190,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
prev=O3553
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O3306
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xarchfraz
father=O3307
fatherSonIndex=0
obj='Insert
pag=10
rd_kfield=[
'IDPROG
'DATAOPE
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'CONNESCLI
'CONNESOPER
'CAMBIO
'NUMPROG
'TIPOOPRAP
'TIPOINTER
'CODINTER
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'CONNESBEN
'UNIQUECODE
'AGOPER
'RIFIMP
'ZCPARTE
'RAGIO
'MODSVOL
'AREAGEO
'INFORM
'AMMONT
'DURAT
'TIPO
'RRAGIO
'RCOMP
'RAREA
'RIMP
'RFREQ
'CONNALTRO
'DATAIMP
'RTIPO
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'NATURA
'SCOPO
'C_RAPPORTO
'RAPPORTBEN
'PAGASOGOP
'IPCOLLEG
'ORACOLLEG
'DUCOLLEG
]
rd_kvar=[
'conta
'Substr(riga,1,8)        
'Substr(riga,9,1)        
'Substr(riga,10,4)       
'Substr(riga,14,2)       
'Substr(riga,16,2)       
'Substr(riga,18,11)      
'Substr(riga,29,3)       
'Substr(riga,32,30)      
'Substr(riga,62,2)       
'Substr(riga,64,6)       
'Substr(riga,70,50)      
'Substr(riga,120,25)     
'Substr(riga,145,1)      
'Substr(riga,146,1)      
'Substr(riga,147,8)      
'Substr(riga,155,1)      
'Substr(riga,156,3)      
'Substr(riga,159,1)      
'Substr(riga,160,15)     
'Substr(riga,175,15)     
'Substr(riga,190,16)     
'Substr(riga,206,16)     
'Substr(riga,222,9)      
'Substr(riga,231,11)     
'Substr(riga,242,2)      
'Substr(riga,244,2)      
'Substr(riga,246,11)     
'Substr(riga,257,6)      
'Substr(riga,263,30)     
'Substr(riga,293,2)      
'Substr(riga,295,6)      
'Substr(riga,301,1)      
'Substr(riga,302,16)     
'Substr(riga,318,10)     
'Substr(riga,328,3)      
'Substr(riga,331,9)      
'Substr(riga,340,69)     
'Substr(riga,409,5)      
'Substr(riga,414,5)      
'Substr(riga,419,5)      
'Substr(riga,424,30)     
'Substr(riga,454,5)      
'Substr(riga,459,5)      
'Substr(riga,464,5)      
'Substr(riga,469,3)      
'Substr(riga,472,3)      
'Substr(riga,475,3)      
'Substr(riga,478,3)      
'Substr(riga,481,3)      
'Substr(riga,484,16)     
'Substr(riga,500,8)      
'Substr(riga,508,3)      
'Substr(riga,511,70)     
'Substr(riga,581,3)      
'Substr(riga,584,30)     
'Substr(riga,614,6)      
'Substr(riga,620,2)      
'Substr(riga,622,35)     
'Substr(riga,657,5)      
'Substr(riga,662,50)     
'Substr(riga,712,50)     
'Substr(riga,762,25)     
'Substr(riga,787,25)     
'Substr(riga,812,1)      
'Substr(riga,813,15)     
'Substr(riga,828,14)     
'Substr(riga,842,10)     
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
prev=O3288
var_op='asgn
I
obj='Var
pag=10
prev=O3287
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=10
prev=O3286
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O3285
var_op='asgn
I
obj='Remark
pag=10
x=15
y=15
I
Icpitembatch.CPRead
arch='tbcauana
obj='Read
pag=10
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,10,4)
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
x=628
y=1370
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Rapporti AGE Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Rapporti AGE Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=11
prev=O3668
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=11
prev=O3667
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=11
prev=O3666
var_op='asgn
I
obj='Exec
pag=11
prev=O3665
I
obj='Exec
pag=11
prev=O3663
I
obj='While
pag=11
prev=O3662
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3663
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='cFlagLire
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,77,1)='S' or Substr(riga,77,1)='1' or Substr(riga,77,1)='7'
'Substr(riga,77,1)='E' or Substr(riga,77,1)='3' or Substr(riga,77,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='xRapporto
next=Icpitembatch.CPRead
arch='jnarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xRapporto))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=11
prev=O3678
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O3679
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPRAPAGE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='jnarapbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,83,1)<>'1'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=11
prev=O3687
var_op='asgn
I
obj='If
pag=11
prev=O3685
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3687
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PROGAET\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aetesta
h=[
19
19
]
obj='Insert
pag=11
prev=O3693
rd_kfield=[
'RAPPORTO
'TIPOAG
'COINT
'DESCRI
'VALUTA
'PROGAET
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,81,2)
'iif(Substr(riga,76,1)='1','1','2')
'iif(Substr(riga,81,2)='99',Upper(Substr(riga,26,24)),'')
'Substr(riga,78,3)
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3694
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=11
prev=O3702
I
obj='Var
obj_type='N
pag=11
prev=O3701
var_op='asgn
I
obj='Exec
pag=11
prev=O3700
I
nonlocal=True
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=11
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=11
prev=O3684
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
'PRGIMPRAP
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,94,5)),3))
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3685
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=11
prev=O3712
I
obj='Var
obj_type='N
pag=11
prev=O3711
var_op='asgn
I
obj='Exec
pag=11
prev=O3710
I
nonlocal=True
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='jnarapbo
father=O3679
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,83,1)<>'1'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=11
prev=O3718
var_op='asgn
I
obj='If
pag=11
prev=O3716
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aetesta
father=O3718
fatherSonIndex=0
obj='Write
pag=11
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'TIPOAG
'COINT
'DESCRI
'VALUTA
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,81,2)
'iif(Substr(riga,76,1)='1','1','2')
'iif(Substr(riga,81,2)='99',Upper(Substr(riga,26,24)),'')
'Substr(riga,78,3)
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=11
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3716
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=11
prev=O3739
I
obj='Var
obj_type='N
pag=11
prev=O3738
var_op='asgn
I
obj='Exec
pag=11
prev=O3737
I
nonlocal=True
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,94,5)),3))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=11
prev=O3677
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Left(riga,25)
]
rd_var=[
'xRapporto
]
I
obj='Var
pag=11
prev=O3674
var_op='asgn
I
obj='Case
pag=11
prev=O3673
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3674
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3674
fatherSonIndex=1
frm_calc=[
'Substr(riga,77,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=11
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3754
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3754
fatherSonIndex=1
frm_calc='Substr(riga,77,1)
len=1
name='cFlagLire
obj='Var
pag=11
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3674
fatherSonIndex=2
frm_calc='Substr(riga,77,1)
len=1
name='cFlagLire
obj='Var
pag=11
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=11
prev=O3672
var_op='asgn
I
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=11
prev=O3661
var_op='asgn
I
obj='Var
pag=11
prev=O3660
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=11
prev=O3659
var_op='asgn
I
obj='Var
obj_type='N
pag=11
prev=O3658
var_op='asgn
I
obj='Var
obj_type='N
pag=11
prev=O3657
var_op='asgn
I
obj='Remark
pag=11
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Informazione Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O3777
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O3776
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O3775
var_op='asgn
I
obj='Exec
pag=12
prev=O3774
I
obj='Exec
pag=12
prev=O3772
I
obj='While
pag=12
prev=O3771
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3772
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPBeginEnd
comment='Dati intermediario
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,75,16)
len=16
name='xConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,50,16)
len=16
name='xSOCTCon
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xSOCTCon)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' informazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,46,1)='S' or Substr(riga,46,1)='1' or Substr(riga,46,1)='7'
'Substr(riga,46,1)='E' or Substr(riga,46,1)='3' or Substr(riga,46,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPRemark
frm_calc='Da sentire Bruno sembra che l'importazione dei soggetti operanti in agenzia delle entrate non sia più attiva.﷯Ma sul tracciato c'è ancora.
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,36,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,159,10)),Utilities.GetAutonumber("PRGINFAGE1\'"+LRTrim(gAzienda)+"'",'',10),Substr(riga,159,10))
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFAGE2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINFAGE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='japopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=12
prev=O3809
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3811
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOGAGE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='jntestbo
h=[
19
19
]
obj='Insert
pag=12
prev=O3816
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3817
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=12
prev=O3825
I
obj='Var
obj_type='N
pag=12
prev=O3824
var_op='asgn
I
obj='Exec
pag=12
prev=O3823
I
nonlocal=True
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3811
fatherSonIndex=1
frm_calc=[
'Substr(riga,44,2)='23'
'Substr(riga,44,2)='26'
]
h=[
19
19
19
]
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='jntestbo
father=O3829
fatherSonIndex=0
h=[
19
19
]
obj='Write
pag=12
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cNumMod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3834
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=12
prev=O3843
I
obj='Var
obj_type='N
pag=12
prev=O3842
var_op='asgn
I
obj='Exec
pag=12
prev=O3841
I
nonlocal=True
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'NUMPROG1
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='jntestbo
father=O3829
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=12
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'Substr(riga,9,25)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3850
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=12
prev=O3859
I
obj='Var
obj_type='N
pag=12
prev=O3858
var_op='asgn
I
obj='Exec
pag=12
prev=O3857
I
nonlocal=True
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=12
prev=O3808
sel_field='*
sel_name='jntestbo
sel_order='jntestbo->CPROWNUM
sel_where='jntestbo->RAPPORTO=Substr(riga,9,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3809
fatherSonIndex=0
frm_calc=[
'jntestbo->CODINTER=cCli1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=12
prev=O3869
var_op='asgn
I
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3869
fatherSonIndex=0
frm_calc='jntestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
prev=O3807
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O3806
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O3804
var_op='asgn
I
obj='Insert
pag=12
prev=O3803
rd_kfield=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'VALUTA
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'_intercab
'Substr(riga,115,6)
'_intercod
'xSOCTCF
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_intercit
'Substr(riga,169,50)
'cFlagLire
'Substr(riga,34,1)
'cInfProg1
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)+"J"+LibreriaMit.UniqueId()+"X"
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,47,3)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3804
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=12
prev=O3884
I
obj='Var
obj_type='N
pag=12
prev=O3883
var_op='asgn
I
obj='Exec
pag=12
prev=O3882
I
nonlocal=True
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
prev=O3802
var_op='asgn
I
obj='Var
pag=12
prev=O3801
var_op='asgn
I
obj='Var
pag=12
prev=O3800
var_op='asgn
I
obj='Var
obj_type='D
pag=12
prev=O3799
var_op='asgn
I
obj='Remark
pag=12
prev=O3796
I
obj='Case
pag=12
prev=O3795
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3796
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O3796
fatherSonIndex=1
frm_calc=[
'Substr(riga,46,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3891
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3891
fatherSonIndex=1
frm_calc='Substr(riga,46,1)
len=1
name='cFlagLire
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3796
fatherSonIndex=2
frm_calc='Substr(riga,46,1)
len=1
name='cFlagLire
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O3794
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O3791
var_op='asgn
I
obj='If
pag=12
prev=O3790
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O3791
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=12
prev=O3905
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O3906
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=12
prev=O3911
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3912
fatherSonIndex=0
frm_calc='xSOCTCon
len=16
name='xSOCTCF
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=12
prev=O3789
var_op='asgn
I
obj='Var
pag=12
prev=O3786
var_op='asgn
I
obj='If
pag=12
prev=O3785
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O3786
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
obj='If
pag=12
prev=O3931
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3932
fatherSonIndex=0
frm_calc='xConnes
len=16
name='cCli1
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
prev=O3784
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
obj='Var
pag=12
prev=O3782
var_op='asgn
I
obj='Begin
pag=12
prev=O3781
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3782
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,104,11))),_codinter,Substr(riga,104,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,121,30))),_citinter,Substr(riga,121,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,153,6))),_cabinter,Substr(riga,153,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,151,2))),_prvinter,Substr(riga,151,2))
len=2
name='_interprv
obj='Var
pag=12
prev=O3952
var_op='asgn
I
obj='Var
pag=12
prev=O3951
var_op='asgn
I
obj='Var
pag=12
prev=O3950
var_op='asgn
I
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
prev=O3770
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O3769
var_op='asgn
I
obj='Var
pag=12
prev=O3768
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O3767
var_op='asgn
I
obj='Remark
pag=12
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni AGE Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','JPERAZBO','Operazioni AGE Inserite: '+LRTrim(Str(cNumNew,10,0)))
obj='Exec
pag=13
prev=O3968
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O3967
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O3966
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O3965
var_op='asgn
I
obj='Exec
pag=13
prev=O3964
I
obj='Exec
pag=13
prev=O3962
I
obj='While
pag=13
prev=O3961
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3962
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=13
prev=O3972
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
father=O3973
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
prev=O3978
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O3980
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,257,6))))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,318,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc='_flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,331,9))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))) or (Empty(LRTrim(_numprog)) and not(Empty(LRTrim(Left(riga,8)))))
]
h=[
19
19
]
obj='If
pag=13
prev=O4002
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4005
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,318,10)),Utilities.GetAutonumber("POPERAGE1\'"+LRTrim(gAzienda)+"'",'',10),Substr(riga,318,10))
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,155,1)='S' or Substr(riga,155,1)='1' or Substr(riga,155,1)='7'
'Substr(riga,155,1)='E' or Substr(riga,155,1)='3' or Substr(riga,155,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,147,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,9,1)='1' or Substr(riga,9,1)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,301,1)),'0',iif(Substr(riga,301,1)='S','1',iif(Substr(riga,301,1)='N','1',Substr(riga,301,1))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,231,11))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPEAGE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,852,19))),0,Val(LRTrim(Substr(riga,852,19))))
len=15
name='_totin
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,871,19))),0,Val(LRTrim(Substr(riga,871,19))))
len=15
name='_totout
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge i dati dell'intermediario controparte
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='jperazbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=13
prev=O4035
var_op='asgn
I
obj='Insert
pag=13
prev=O4033
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
'IMPIN
'IMPOUT
]
rd_kvar=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'Substr(riga,10,4)
'_intercab
'_iccab
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'Substr(riga,484,16)
'Substr(riga,302,16)
'Substr(riga,190,16)
'Substr(riga,206,16)
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_datarett
'_iccit
'_intercit
'_icrag
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'_flagrap2
'cOpeProg1
'cIdCau
'"O"+Right(cOpeProg2,9)+_idb2
'Substr(riga,424,30)
'Substr(riga,813,15)
'Substr(riga,414,5)
'Substr(riga,662,50)
'cOpeProg2
'Substr(riga,328,3)
'_idreg
''1'
'iif(Empty(Substr(riga,828,14)) or Substr(riga,828,14)='01010001000000',NullDateTime(),CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6)))
'_icsta
'Substr(riga,812,1)
'nProgImp
'_icprv
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
'_statoreg
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'_colleg
'_idb2
'_totin / 100
'_totout / 100
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4035
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=13
prev=O4044
I
obj='Var
obj_type='N
pag=13
prev=O4043
var_op='asgn
I
obj='Exec
pag=13
prev=O4042
I
nonlocal=True
obj='Var
obj_type='M
pag=13
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Begin
pag=13
prev=O4031
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4033
fatherSonIndex=0
frm_calc='''
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=70
name='_icrag
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,18,11)))) and Len(LRTrim(Substr(riga,64,6)+Substr(riga,70,50)+Substr(riga,29,3)+Substr(riga,62,2)+Substr(riga,32,30))) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
prev=O4053
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O4054
fatherSonIndex=0
obj='Read
pag=13
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'Substr(riga,18,11)
]
rd_var=[
'_iccab
'_iccit
'_icprv
'_icsta
'_icrag
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4054
fatherSonIndex=1
frm_calc='Substr(riga,64,6)
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,32,30)
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,62,2)
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,29,3))
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,70,50)
len=70
name='_icrag
obj='Var
pag=13
prev=O4068
var_op='asgn
I
obj='Var
pag=13
prev=O4067
var_op='asgn
I
obj='Var
pag=13
prev=O4066
var_op='asgn
I
obj='Var
pag=13
prev=O4065
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=13
prev=O4052
var_op='asgn
I
obj='Var
pag=13
prev=O4051
var_op='asgn
I
obj='Var
pag=13
prev=O4050
var_op='asgn
I
obj='Var
pag=13
prev=O4049
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=13
prev=O4030
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4031
fatherSonIndex=0
frm_calc='Upper(Substr(riga,511,70))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,581,3))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,584,30))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,614,6)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,620,2))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,622,35))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,657,5))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,302,16))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=13
prev=O4084
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4087
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,120,25))))
]
h=[
19
19
]
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4092
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=13
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4097
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=13
prev=O4108
I
obj='Read
pag=13
prev=O4107
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=13
prev=O4106
var_op='asgn
I
obj='Var
pag=13
prev=O4105
var_op='asgn
I
obj='Var
pag=13
prev=O4104
var_op='asgn
I
obj='Var
pag=13
prev=O4103
var_op='asgn
I
obj='Var
pag=13
prev=O4102
var_op='asgn
I
obj='Var
pag=13
prev=O4101
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4081
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4084
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=13
prev=O4125
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,302,16)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=13
prev=O4124
var_op='asgn
I
obj='Var
pag=13
prev=O4123
var_op='asgn
I
obj='Var
pag=13
prev=O4122
var_op='asgn
I
obj='Var
pag=13
prev=O4121
var_op='asgn
I
obj='Var
pag=13
prev=O4120
var_op='asgn
I
obj='Var
pag=13
prev=O4119
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4080
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O4081
fatherSonIndex=0
obj='Read
pag=13
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
prev=O4079
var_op='asgn
I
obj='Var
pag=13
prev=O4078
var_op='asgn
I
obj='Var
pag=13
prev=O4077
var_op='asgn
I
obj='Var
pag=13
prev=O4076
var_op='asgn
I
obj='Var
pag=13
prev=O4075
var_op='asgn
I
obj='Var
pag=13
prev=O4074
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=13
prev=O4029
var_op='asgn
I
obj='Var
obj_type='N
pag=13
prev=O4028
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O4027
var_op='asgn
I
obj='Var
obj_type='N
pag=13
prev=O4026
var_op='asgn
I
obj='Var
obj_type='N
pag=13
prev=O4024
var_op='asgn
I
obj='Select
pag=13
par_expr=[
'Substr(riga,10,4)
'Substr(riga,14,2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O4023
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4024
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
prev=O4022
var_op='asgn
I
obj='Var
pag=13
prev=O4021
var_op='asgn
I
obj='Var
pag=13
prev=O4020
var_op='asgn
I
obj='Var
pag=13
prev=O4019
var_op='asgn
I
obj='Var
pag=13
prev=O4018
var_op='asgn
I
obj='Var
obj_type='D
pag=13
prev=O4015
var_op='asgn
I
obj='Case
pag=13
prev=O4014
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4015
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4015
fatherSonIndex=1
frm_calc=[
'Substr(riga,155,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4151
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4151
fatherSonIndex=1
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4015
fatherSonIndex=2
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=13
prev=O4013
var_op='asgn
I
obj='Var
pag=13
prev=O4010
var_op='asgn
I
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4010
fatherSonIndex=0
frm_calc='_numprog
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''1'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
obj='Var
obj_type='D
pag=13
prev=O4166
var_op='asgn
I
obj='Var
pag=13
prev=O4165
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4010
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("POPERAGE2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''0'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datarett
obj='Var
obj_type='D
pag=13
prev=O4170
var_op='asgn
I
obj='Var
pag=13
prev=O4169
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O3999
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4002
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Left(riga,8)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4176
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=13
prev=O4181
sel_field='jperazbo->IDBASE
sel_name='jperazbo
sel_where='jperazbo->NUMPROG=_numprog and (jperazbo->STATOREG='0'  or jperazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O4182
fatherSonIndex=0
frm_calc='"E' stata cancellata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='jperazbo
obj='Write
pag=13
prev=O4186
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'jperazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
]
wr_var=[
''2'
'Date()
]
I
nonlocal=True
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
father=O4176
fatherSonIndex=1
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"E' stata variata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=13
prev=O4197
sel_field='jperazbo->IDBASE,jperazbo->NUMPROG,jperazbo->DATAOPE,jperazbo->FLAGRAP2
sel_name='jperazbo
sel_where='jperazbo->NUMPROG=_numprog and (jperazbo->STATOREG='0'  or jperazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4198
fatherSonIndex=0
frm_calc='jperazbo->IDBASE
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(jperazbo->FLAGRAP2) or jperazbo->FLAGRAP2='S',Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(jperazbo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='jperazbo->IDEREG
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='jperazbo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=13
prev=O4210
sel_field='*
sel_name='terzistiope
sel_where='terzistiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='merzistiope
father=O4212
fatherSonIndex=0
obj='Insert
pag=13
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'IDREG
]
rd_kvar=[
'_oldidb
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=13
prev=O4208
sel_field='*
sel_name='beneficope
sel_where='beneficope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='meneficope
father=O4210
fatherSonIndex=0
obj='Insert
pag=13
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
'IDREG
]
rd_kvar=[
'_oldidb
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=13
prev=O4206
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mlientiope
father=O4208
fatherSonIndex=0
obj='Insert
pag=13
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=13
prev=O4205
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mogopebo
father=O4206
fatherSonIndex=0
obj='Insert
pag=13
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=13
prev=O4204
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'jperazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
'FLAGRAP2
]
wr_op=[
'=
'=
'=
]
wr_var=[
''3'
'Date()
'_flagrap2
]
I
obj='Var
pag=13
prev=O4203
var_op='asgn
I
obj='Var
pag=13
prev=O4202
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=13
prev=O4196
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O3998
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3999
fatherSonIndex=0
frm_calc=[
'Upper(Substr(riga,331,9))='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4249
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=13
sel_field='jperazbo->NUMPROG
sel_name='jperazbo
sel_where='jperazbo->INFORM = Substr(riga,424,30) and (jperazbo->STATOREG='0' or jperazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4254
fatherSonIndex=0
frm_calc='jperazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4249
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=13
sel_field='jperazbo->NUMPROG
sel_name='jperazbo
sel_where='jperazbo->RIFIMP = Substr(riga,331,9) and (jperazbo->STATOREG='0' or jperazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4261
fatherSonIndex=0
frm_calc='jperazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
prev=O3997
var_op='asgn
I
obj='Var
pag=13
prev=O3996
var_op='asgn
I
obj='Var
pag=13
prev=O3995
var_op='asgn
I
obj='Var
pag=13
prev=O3992
var_op='asgn
I
obj='If
pag=13
prev=O3991
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O3992
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=13
prev=O4271
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4272
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=13
prev=O4278
I
obj='Var
obj_type='N
pag=13
prev=O4277
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,318,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
prev=O3990
var_op='asgn
I
obj='Remark
pag=13
prev=O3987
I
obj='If
pag=13
prev=O3985
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3987
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,263,30))+LRTrim(Substr(riga,295,6))+LRTrim(Substr(riga,293,2))))
]
h=[
19
19
]
obj='If
pag=13
prev=O4290
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4293
fatherSonIndex=0
frm_calc='LRTrim(Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=13
prev=O4299
var_op='asgn
I
obj='Var
pag=13
prev=O4298
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4289
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4290
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(Substr(riga,257,6))+" non è presente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=13
prev=O4305
I
obj='Var
obj_type='N
pag=13
prev=O4304
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
prev=O4288
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'Substr(riga,257,6)
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=13
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3985
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,246,11))),_codinter,Substr(riga,246,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,263,30))),_citinter,Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,295,6))),_cabinter,Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,293,2))),_prvinter,Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=13
prev=O4317
var_op='asgn
I
obj='Var
pag=13
prev=O4316
var_op='asgn
I
obj='Var
pag=13
prev=O4315
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3980
fatherSonIndex=1
frm_calc='1
len=1
name='_opeerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(ohand,riga+" - "+_descerr)
obj='Exec
pag=13
prev=O4321
I
obj='Var
obj_type='N
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=13
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3978
fatherSonIndex=0
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,190,16))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,206,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,484,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,190,16))) and Empty(LRTrim(Substr(riga,120,25))) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=13
prev=O4337
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4340
fatherSonIndex=0
frm_calc=''Rapporto continuativo o Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=13
prev=O4345
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4334
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4337
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=13
prev=O4351
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4352
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto per conto del quale assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=13
prev=O4357
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
prev=O4350
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,484,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4331
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4334
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=13
prev=O4368
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4369
fatherSonIndex=0
frm_calc=''Anagrafica Controparte Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=13
prev=O4374
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
prev=O4367
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,302,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4328
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4331
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=13
prev=O4385
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4386
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto Operante Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=13
prev=O4391
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
prev=O4384
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,206,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4327
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4328
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=13
prev=O4402
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4403
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=13
prev=O4408
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
prev=O4401
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,190,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=13
prev=O4326
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=13
prev=O3960
var_op='asgn
I
obj='Var
pag=13
prev=O3959
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O3958
var_op='asgn
I
obj='Var
obj_type='N
pag=13
prev=O3957
var_op='asgn
I
obj='Var
pag=13
pagelocal=True
prev=O3956
I
obj='Remark
pag=13
x=15
y=15
I
Icpitembatch.CPRead
arch='tbcauana
obj='Read
pag=13
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,10,4)
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
x=522
y=720
I
Icpitembatch.CPRemark
frm_calc='Import Dipendenze
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumNew <> 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod <> 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','ANADIP','Dipendenze Inserite: '+LRTrim(Str(cNumNew,10,0)) + ' - Dipendenze Aggiornate: '+LRTrim(Str(cNumMod,10,0)))
obj='Exec
pag=14
prev=O4441
I
nonlocal=True
obj='Var
obj_type='M
pag=14
prev=O4440
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=14
prev=O4437
var_op='asgn
I
obj='If
pag=14
prev=O4434
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4437
fatherSonIndex=0
frm_calc='gMsgProc + 'Dipendenze Aggiornate: '+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O4433
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4434
fatherSonIndex=0
frm_calc='gMsgProc + 'Dipendenze Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Exec
pag=14
prev=O4432
I
obj='Exec
pag=14
prev=O4430
I
obj='While
pag=14
prev=O4429
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4430
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,6)
len=6
name='xDIP
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,69,6)
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Caricamento dipendenza con codice '+xDIP
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCodCab))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgRet='S'
]
h=[
19
19
]
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDIPx))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
prev=O4464
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPInsert
arch='anadip
father=O4465
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=14
prev=O4470
var_op='asgn
I
obj='Insert
pag=14
rd_kfield=[
'CODDIP
'DESCRIZ
'DESCCIT
'PROVINCIA
'CAB
'AGENTE
'IDBASE
'CAP
'TIPOSV
]
rd_kvar=[
'xDIP
'Substr(riga,7,30)
'Substr(riga,37,30)
'Substr(riga,67,2)
'xCodCab
'iif(Upper(Substr(riga,85,1))='S','S','N')
'LibreriaMit.UniqueId()
'Substr(riga,86,5)
'Substr(riga,91,3)
]
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='anadip
father=O4465
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=14
prev=O4475
var_op='asgn
I
obj='Write
pag=14
rd_kfield=[
'CODDIP
]
rd_kop=[
'=
]
rd_kvar=[
'xDIP
]
wr_field=[
'DESCRIZ
'DESCCIT
'PROVINCIA
'CAB
'AGENTE
'CAP
'TIPOSV
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,7,30)
'Substr(riga,37,30)
'Substr(riga,67,2)
'xCodCab
'iif(Upper(Substr(riga,85,1))='S','S','N')
'Substr(riga,86,5)
'Substr(riga,91,3)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=14
prev=O4461
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'xDIP
]
rd_var=[
'xDIPx
]
I
obj='If
pag=14
prev=O4458
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xnadip
father=O4461
fatherSonIndex=0
obj='Insert
pag=14
rd_kfield=[
'IDPROG
'CODDIP
'DESCRIZ
'DESCCIT
'PROVINCIA
'CAB
'AGENTE
]
rd_kvar=[
'conta
'xDIP
'Substr(riga,7,30)
'Substr(riga,37,30)
'Substr(riga,67,2)
'Substr(riga,69,6)
'Substr(riga,85,1)
]
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O4457
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4458
fatherSonIndex=0
frm_calc='Substr(riga,37,30)
len=30
name='xCitta
next=Icpitembatch.CPRead
arch='tbcitta
obj='Read
pag=14
prev=O4496
rd_field=[
'CAB
]
rd_kfield=[
'CITTA
'PROV
]
rd_kvar=[
'xCitta
'Substr(riga,67,2)
]
rd_var=[
'xCodCab
]
I
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=14
prev=O4456
var_op='asgn
I
nonlocal=True
obj='Var
pag=14
prev=O4455
var_op='asgn
I
obj='Var
pag=14
prev=O4454
var_op='asgn
I
obj='Var
pag=14
prev=O4453
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=14
prev=O4428
var_op='asgn
I
obj='Var
pag=14
prev=O4427
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=14
prev=O4426
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O4425
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O4424
var_op='asgn
I
obj='Remark
pag=14
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Titolari Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Titolari Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=15
prev=O4514
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=15
prev=O4513
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=15
prev=O4512
var_op='asgn
I
obj='Exec
pag=15
prev=O4511
I
obj='Exec
pag=15
prev=O4509
I
obj='While
pag=15
prev=O4508
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4509
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=15
prev=O4518
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O4519
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,159,10)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
prev=O4527
sons=[
Icpitembatch.CPItemSon
comment='Unicode Assente o vuoto
instr=Icpitembatch.CPVarDecl
father=O4530
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,36,8)))
len=8
name='_datareg
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
prev=O4536
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4537
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGPTIT1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPTIT2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTIT\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xapotit
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xntestit
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=15
prev=O4548
var_op='asgn
I
obj='Insert
pag=15
prev=O4547
rd_kfield=[
'CODCLI
'CODINTER
'DATAINI
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
]
rd_kvar=[
'Substr(riga,75,16)
'Substr(riga,50,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'Substr(riga,219,30)
'Substr(riga,9,25)
'nProgImp
'LibreriaMit.UniqueId()
]
I
obj='Var
obj_type='N
pag=15
prev=O4545
var_op='asgn
I
obj='Insert
pag=15
prev=O4544
rd_kfield=[
'CDATOPE
'CDATREG
'CODCAB
'CODDIPE
'CODINTER
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPTIT
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'IDBASE2
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'_intercab
'Substr(riga,115,6)
'_intercod
'Substr(riga,75,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'cInfProg1
'"T"+Right(cInfProg2,9)+_idb2
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,159,10)
'_idb2
]
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O4545
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=15
prev=O4558
I
obj='Var
obj_type='N
pag=15
prev=O4557
var_op='asgn
I
obj='Exec
pag=15
prev=O4556
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=15
prev=O4543
var_op='asgn
I
obj='Var
pag=15
prev=O4542
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4537
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGTITO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGTITO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTIT\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='rapotit
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='intestit
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=15
prev=O4568
var_op='asgn
I
obj='Insert
pag=15
prev=O4567
rd_kfield=[
'CODCLI
'CODINTER
'DATAINI
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
'STATOREG
]
rd_kvar=[
'Substr(riga,75,16)
'Substr(riga,50,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'Substr(riga,219,30)
'Substr(riga,9,25)
'nProgImp
'LibreriaMit.UniqueId()
''0'
]
I
obj='Var
obj_type='N
pag=15
prev=O4565
var_op='asgn
I
obj='Insert
pag=15
prev=O4564
rd_kfield=[
'CDATOPE
'CDATREG
'CODCAB
'CODDIPE
'CODINTER
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPTIT
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'IDBASE2
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'_intercab
'Substr(riga,115,6)
'_intercod
'Substr(riga,75,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'cInfProg1
'"T"+Right(cInfProg2,9)+_idb2
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,159,10)
'_idb2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4565
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=15
prev=O4578
I
obj='Var
obj_type='N
pag=15
prev=O4577
var_op='asgn
I
obj='Exec
pag=15
prev=O4576
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=15
prev=O4563
var_op='asgn
I
obj='Var
pag=15
prev=O4562
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='D
pag=15
prev=O4535
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='Aggiornamento
instr=Icpitembatch.CPIfElse
father=O4530
fatherSonIndex=1
frm_calc=[
'_tdest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4583
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=15
sel_field='*
sel_name='xapotit
sel_where='xapotit->IDBASE=_unicode and (xapotit->STATOREG='0' or xapotit->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4588
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGPTIT1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPInsert
arch='xapotit
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='xapotit
obj='Write
pag=15
prev=O4593
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_unicode
]
wr_field=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDEREG
'OPRAP
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'CONNESCLI
'DATARETT
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'_intercab
'Substr(riga,115,6)
'_intercod
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'CharToDate(Right(Substr(riga,36,8),4)+Substr(Substr(riga,36,8),3,2)+Left(Substr(riga,36,8),2))
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'xapotit->IDEREG
'Left(Substr(riga,44,2),1)
'_interprv
'Substr(riga,9,25)
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,75,16)
'Date()
]
I
obj='Insert
pag=15
prev=O4592
rd_kfield=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPTIT
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
]
rd_kvar=[
'xapotit->CDATOPE
'xapotit->CODCAB
'xapotit->CODDIPE
'xapotit->CODINTER
'xapotit->CONNESCLI
'xapotit->DATAOPE
'xapotit->DATAREG
'xapotit->DESCCIT
'xapotit->DESCINTER
'xapotit->FLAGRAP
'cInfProg1
'xapotit->IDEREG
'xapotit->NUMPROG
'xapotit->OPRAP
'xapotit->PRGIMPTIT
'xapotit->PROVINCIA
'xapotit->RAPPORTO
''3'
''1'
'xapotit->TIPOINTER
'xapotit->TIPOLEG
'xapotit->TIPOOPRAP
'xapotit->UNIQUECODE
]
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O4593
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=15
prev=O4608
I
obj='Var
obj_type='N
pag=15
prev=O4607
var_op='asgn
I
obj='Exec
pag=15
prev=O4606
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4583
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=15
sel_field='*
sel_name='rapotit
sel_where='rapotit->IDBASE=_unicode and (rapotit->STATOREG='0' or rapotit->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4613
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGTITO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPInsert
arch='rapotit
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='rapotit
obj='Write
pag=15
prev=O4618
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_unicode
]
wr_field=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDEREG
'OPRAP
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'CONNESCLI
'DATARETT
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'_intercab
'Substr(riga,115,6)
'_intercod
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'CharToDate(Right(Substr(riga,36,8),4)+Substr(Substr(riga,36,8),3,2)+Left(Substr(riga,36,8),2))
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'rapotit->IDEREG
'Left(Substr(riga,44,2),1)
'_interprv
'Substr(riga,9,25)
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,75,16)
'Date()
]
I
obj='Insert
pag=15
prev=O4617
rd_kfield=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPTIT
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
]
rd_kvar=[
'rapotit->CDATOPE
'rapotit->CODCAB
'rapotit->CODDIPE
'rapotit->CODINTER
'rapotit->CONNESCLI
'rapotit->DATAOPE
'rapotit->DATAREG
'rapotit->DESCCIT
'rapotit->DESCINTER
'rapotit->FLAGRAP
'cInfProg1
'rapotit->IDEREG
'rapotit->NUMPROG
'rapotit->OPRAP
'rapotit->PRGIMPTIT
'rapotit->PROVINCIA
'rapotit->RAPPORTO
''3'
''1'
'rapotit->TIPOINTER
'rapotit->TIPOLEG
'rapotit->TIPOOPRAP
'rapotit->UNIQUECODE
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4618
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=15
prev=O4633
I
obj='Var
obj_type='N
pag=15
prev=O4632
var_op='asgn
I
obj='Exec
pag=15
prev=O4631
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=15
prev=O4526
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O4527
fatherSonIndex=0
frm_calc='''
len=1
name='_tdest
next=Icpitembatch.CPRead
arch='xapotit
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_unicode)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
prev=O4642
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='rapotit
father=O4643
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_unicode))
]
h=[
19
19
]
obj='If
pag=15
prev=O4648
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4649
fatherSonIndex=0
frm_calc=''D'
len=1
name='_tdest
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=15
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,159,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4643
fatherSonIndex=1
frm_calc=''P'
len=1
name='_tdest
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=15
prev=O4641
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,159,10)
]
rd_var=[
'_unicode
]
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=15
prev=O4524
var_op='asgn
I
obj='Begin
pag=15
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O4524
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,104,11))),_codinter,Substr(riga,104,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,121,30))),_citinter,Substr(riga,121,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,153,6))),_cabinter,Substr(riga,153,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,151,2))),_prvinter,Substr(riga,151,2))
len=2
name='_interprv
obj='Var
pag=15
prev=O4672
var_op='asgn
I
obj='Var
pag=15
prev=O4671
var_op='asgn
I
obj='Var
pag=15
prev=O4670
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=15
prev=O4507
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=15
prev=O4506
var_op='asgn
I
obj='Var
obj_type='N
pag=15
prev=O4505
var_op='asgn
I
obj='Var
obj_type='N
pag=15
prev=O4504
var_op='asgn
I
obj='Remark
pag=15
x=15
y=15
I
Icpitembatch.CPBeginEnd
comment='Variabili di pagina
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella (Operazioni ExtraConto)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_opxerr
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Inizio Elaborazione File Operazioni Extraconto (OPEX.TXT)"+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni ExtraConto Inserite: '+LRTrim(Str(cNumNew,10,0)) + " - Operazioni ExtraConto Scartate: "+LRTrim(Str(cNumMod,10,0))+' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=16
prev=O4692
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=16
prev=O4691
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=16
prev=O4690
var_op='asgn
I
obj='Exec
pag=16
prev=O4689
I
obj='Exec
pag=16
prev=O4687
I
obj='While
pag=16
prev=O4686
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O4687
fatherSonIndex=0
frm_calc=''Sono state elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=16
prev=O4698
var_op='asgn
I
obj='If
pag=16
prev=O4697
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4698
fatherSonIndex=0
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datx
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,16)
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,25,4)+Substr(riga,23,2)+Substr(riga,21,2)
len=8
name='xData
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,1,16)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=16
prev=O4707
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4708
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,30,30))))
]
h=[
19
19
]
obj='If
pag=16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='opextrbo
father=O4713
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xIDB)))
]
h=[
19
19
]
obj='If
pag=16
prev=O4718
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4719
fatherSonIndex=0
frm_calc='''
len=25
name='_aprog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='_afile
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='_dprog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='_dfile
next=Icpitembatch.CPRead
arch='aeoprig
next=Icpitembatch.CPRead
arch='aeopcanc
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_afile)+LRTrim(_aprog)) or (not(Empty(LRTrim(_afile)+LRTrim(_aprog))) and not(Empty(LRTrim(_dfile)+LRTrim(_dprog))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=16
prev=O4730
var_op='asgn
I
obj='If
pag=16
prev=O4729
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='opextrbo
father=O4730
fatherSonIndex=0
obj='Delete
pag=16
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'xIDB
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4730
fatherSonIndex=1
frm_calc='gMsgProc +"Impossibile cancellare operazione con riferimento "+LRTrim(Substr(riga,30,30))+" perché già inviata all'agenzia delle entrate"+ NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=16
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=16
prev=O4728
rd_field=[
'APROG
'AFILE
]
rd_kfield=[
'CONNESINT
'ADATA
]
rd_kvar=[
'cCli1
'_datx
]
rd_var=[
'_dprog
'_dfile
]
I
obj='Read
pag=16
prev=O4727
rd_field=[
'APROG
'AFILE
]
rd_kfield=[
'CONNESINT
'ADATA
]
rd_kvar=[
'cCli1
'_datx
]
rd_var=[
'_aprog
'_afile
]
I
obj='Var
pag=16
pagelocal=True
prev=O4726
var_op='asgn
I
obj='Var
pag=16
pagelocal=True
prev=O4725
var_op='asgn
I
obj='Var
pag=16
pagelocal=True
prev=O4724
var_op='asgn
I
obj='Var
pag=16
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=16
rd_field=[
'IDBASE
'COLLEG
'DATAOPE
]
rd_kfield=[
'RIFIMP
]
rd_kvar=[
'Substr(riga,30,30)
]
rd_var=[
'xIDB
'cCli1
'_datx
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4708
fatherSonIndex=1
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=16
prev=O4761
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='opextrbo
father=O4764
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=16
prev=O4769
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O4770
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGOPEX\'"+LRTrim(gAzienda)+"'",0,10)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='opextrbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=16
prev=O4777
var_op='asgn
I
obj='Insert
pag=16
prev=O4776
rd_kfield=[
'COLLEG
'ANNO
'IDBASE
'DATAOPE
'COINT
'RIFIMP
'PROGOPEX
'RAPPORTO
]
rd_kvar=[
'cCli1
'Substr(riga,17,4)
'xIDB
'CharToDate(xData)
'Substr(riga,29,1)
'Substr(riga,30,30)
'nProgImp
'Substr(riga,17,4)+"_"+LRTrim(cCli1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4777
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,1,16)+" per l'operazione extraconto in data: "+Substr(riga,21,8)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=16
prev=O4786
I
obj='Var
obj_type='N
pag=16
prev=O4785
var_op='asgn
I
obj='Exec
pag=16
prev=O4784
I
nonlocal=True
obj='Var
obj_type='M
pag=16
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=16
prev=O4775
var_op='asgn
I
obj='Var
pag=16
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4770
fatherSonIndex=1
frm_calc='gMsgProc +"Esiste già una operazione per il soggetto con codice "+cCli1+ NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=16
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=16
rd_field=[
'IDBASE
]
rd_kfield=[
'COLLEG
'ANNO
]
rd_kvar=[
'cCli1
'Substr(riga,17,4)
]
rd_var=[
'xIDB
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4764
fatherSonIndex=1
frm_calc='1
len=1
name='_opxerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(xhand,riga+" - Intestatario operazione extraconto non esiste")
obj='Exec
pag=16
prev=O4797
I
obj='Var
obj_type='N
pag=16
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=16
prev=O4760
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4761
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=16
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=16
prev=O4759
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,1,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=16
prev=O4758
var_op='asgn
I
obj='Var
obj_type='N
pag=16
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=16
prev=O4706
var_op='asgn
I
obj='Var
pag=16
prev=O4705
var_op='asgn
I
obj='Var
obj_type='D
pag=16
pagelocal=True
prev=O4704
var_op='asgn
I
obj='Var
pag=16
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=16
prev=O4696
var_op='asgn
I
nonlocal=True
obj='Var
pag=16
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=16
prev=O4685
var_op='asgn
I
obj='Var
pag=16
prev=O4684
var_op='asgn
I
obj='Var
obj_type='N
pag=16
prev=O4683
var_op='asgn
I
obj='Var
obj_type='N
pag=16
prev=O4682
var_op='asgn
I
obj='Var
obj_type='N
pag=16
prev=O4681
var_op='asgn
I
obj='Var
obj_type='N
pag=16
prev=O4680
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=16
prev=O4679
var_op='asgn
I
obj='Remark
pag=16
prev=O4677
I
obj='Begin
pag=16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4677
fatherSonIndex=0
len=25
name='_aprog
next=Icpitembatch.CPVarDecl
len=15
name='_afile
next=Icpitembatch.CPVarDecl
len=25
name='_dprog
next=Icpitembatch.CPVarDecl
len=15
name='_dfile
next=Icpitembatch.CPVarDecl
len=8
name='_datx
obj='Var
obj_type='D
pag=16
pagelocal=True
prev=O4816
I
obj='Var
pag=16
pagelocal=True
prev=O4815
I
obj='Var
pag=16
pagelocal=True
prev=O4814
I
obj='Var
pag=16
pagelocal=True
prev=O4813
I
obj='Var
pag=16
pagelocal=True
I
I
]
w=[
150
150
]
x=18
y=18
I
Icpitembatch.CPRemark
frm_calc='Deleghe sui rapporti
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Deleghe Rapporti Inserite: '+LRTrim(Str(cNumNew,10,0)) + " - Deleghe Rapporti Aggiornate: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=17
prev=O4829
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=17
prev=O4828
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=17
prev=O4827
var_op='asgn
I
obj='Exec
pag=17
prev=O4826
I
obj='Exec
pag=17
prev=O4824
I
obj='While
pag=17
prev=O4823
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4824
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPRead
arch='delegabo
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,46,4)+Substr(riga,44,2)+Substr(riga,42,2)
len=8
name='xData
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,55,4)+Substr(riga,53,2)+Substr(riga,51,2)
len=8
name='xDatF
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=17
prev=O4837
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPSelect
father=O4838
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='delegabo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=17
prev=O4846
var_op='asgn
I
obj='Insert
pag=17
prev=O4845
rd_kfield=[
'RAPPORTO
'CPROWNUM
'CODINTER
'DATAINI
'TIPORAP
'DATAFINE
'IDBASE
'NOAGE
'STATOREG
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
'Substr(riga,26,16)
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
'LibreriaMit.UniqueId()
'iif(Empty(LRTrim(Substr(riga,59,1))),'N',Substr(riga,59,1))
''0'
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4846
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=17
prev=O4855
I
obj='Var
obj_type='N
pag=17
prev=O4854
var_op='asgn
I
obj='Exec
pag=17
prev=O4853
I
nonlocal=True
obj='Var
obj_type='M
pag=17
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=17
prev=O4843
var_op='asgn
I
obj='Select
pag=17
sel_field='*
sel_name='delegabo
sel_order='delegabo->CPROWNUM
sel_where='delegabo->RAPPORTO=Left(riga,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4843
fatherSonIndex=0
frm_calc='delegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=17
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='delegabo
father=O4838
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=17
prev=O4863
var_op='asgn
I
obj='Write
pag=17
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4863
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=17
prev=O4873
I
obj='Var
obj_type='N
pag=17
prev=O4872
var_op='asgn
I
obj='Exec
pag=17
prev=O4871
I
nonlocal=True
obj='Var
obj_type='M
pag=17
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'TIPORAP
'DATAFINE
]
wr_op=[
'=
'=
'=
]
wr_var=[
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=17
prev=O4836
var_op='asgn
I
obj='Var
pag=17
prev=O4835
var_op='asgn
I
obj='Read
pag=17
prev=O4834
rd_field=[
'CPROWNUM
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,16)
]
rd_var=[
'cMaxRow
]
I
obj='Var
obj_type='N
pag=17
prev=O4833
var_op='asgn
I
obj='Var
obj_type='M
pag=17
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=17
prev=O4822
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=17
prev=O4821
var_op='asgn
I
obj='Var
obj_type='N
pag=17
prev=O4820
var_op='asgn
I
obj='Var
obj_type='N
pag=17
prev=O4819
var_op='asgn
I
obj='Remark
pag=17
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file SOGOPE.TXT altri soggetti operanti
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport')
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Soggetti operanti inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Soggetti operanti aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=18
prev=O4895
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=18
prev=O4894
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=18
prev=O4893
var_op='asgn
I
obj='Exec
pag=18
prev=O4892
I
obj='Exec
pag=18
prev=O4890
I
obj='While
pag=18
prev=O4889
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4890
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_salta
next=Icpitembatch.CPRemark
frm_calc='Verfico la presenza di _unicode nelle tabelle rapopebo/operazbo/fraziobo
next=Icpitembatch.CPRead
arch='rapopebo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=18
prev=O4904
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4906
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='soginfo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=18
prev=O4913
var_op='asgn
I
obj='Insert
pag=18
prev=O4911
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cInfProg2
'Substr(riga,48,1)
'Substr(riga,50,25)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4913
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=18
prev=O4922
I
obj='Var
obj_type='N
pag=18
prev=O4921
var_op='asgn
I
obj='Exec
pag=18
prev=O4920
I
nonlocal=True
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=18
sel_field='*
sel_name='soginfo
sel_where='soginfo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4911
fatherSonIndex=0
frm_calc='soginfo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=18
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=18
prev=O4903
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cOpeProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O4904
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=18
prev=O4936
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4938
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='sogopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=18
prev=O4945
var_op='asgn
I
obj='Insert
pag=18
prev=O4943
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cOpeProg2
'Substr(riga,48,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4945
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=18
prev=O4954
I
obj='Var
obj_type='N
pag=18
prev=O4953
var_op='asgn
I
obj='Exec
pag=18
prev=O4952
I
nonlocal=True
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=18
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4943
fatherSonIndex=0
frm_calc='sogopebo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=18
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=18
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cOpeProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O4936
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=18
prev=O4968
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4970
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='sogopefbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_salta
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=18
prev=O4979
var_op='asgn
I
obj='Var
obj_type='N
pag=18
prev=O4977
var_op='asgn
I
obj='Insert
pag=18
prev=O4975
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cOpeProg2
'Substr(riga,48,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4977
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=18
prev=O4987
I
obj='Var
obj_type='N
pag=18
prev=O4986
var_op='asgn
I
obj='Exec
pag=18
prev=O4985
I
nonlocal=True
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=18
sel_field='*
sel_name='sogopefbo
sel_where='sogopefbo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4975
fatherSonIndex=0
frm_calc='sogopefbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=18
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=18
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cOpeProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
comment='se non trova il valore nelle tre tabelle da errore e stoppa la procedura
instr=Icpitembatch.CPVarDecl
father=O4968
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errore nella valorizazione del campo IDFILEBO nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,21,16)+" non risulta associabile a nessuna informazione/operazione.  Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_salta
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=18
prev=O5004
I
obj='Var
obj_type='N
pag=18
prev=O5003
var_op='asgn
I
obj='Var
obj_type='N
pag=18
prev=O5002
var_op='asgn
I
obj='Exec
pag=18
prev=O5001
I
nonlocal=True
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Remark
pag=18
prev=O4902
I
obj='Var
obj_type='N
pag=18
prev=O4901
var_op='asgn
I
obj='Var
pag=18
prev=O4900
var_op='asgn
I
obj='Var
obj_type='N
pag=18
prev=O4899
var_op='asgn
I
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=18
prev=O4888
var_op='asgn
I
obj='Var
obj_type='N
pag=18
prev=O4887
var_op='asgn
I
obj='Var
pag=18
prev=O4886
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=18
prev=O4885
var_op='asgn
I
obj='Remark
pag=18
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file INTEST.TXT altri intestatari
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Intestatari inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Intestatari aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=19
prev=O5020
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=19
prev=O5019
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=19
prev=O5018
var_op='asgn
I
obj='Exec
pag=19
prev=O5017
I
obj='Exec
pag=19
prev=O5015
I
obj='While
pag=19
prev=O5014
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5015
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPRemark
frm_calc='Verifico in intestbo che ci sia già un recod con lo stesso codice rapporto e memorizzo i dati della riga necessari per crearne una nuova.
next=Icpitembatch.CPSelect
h=[
19
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Se trovo il record inserisco il nuovo intestatario
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
]
obj='If
pag=19
prev=O5030
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='intestbo
father=O5031
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=19
prev=O5036
var_op='asgn
I
obj='Insert
pag=19
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
]
rd_kvar=[
'ciidbase
'cMaxRow + 1
'cidataini
'iif(Empty(Substr(riga,121,1)) ,'P',Substr(riga,121,1))
'Substr(riga,26,16)
'cinumprog
'Substr(riga,1,25)
'citiporap
''0'
'DateToChar(cidataini)+cinumprog+'O'
'Left(LRTrim(Substr(riga,26,16))+Space(5),16)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5036
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=19
prev=O5045
I
obj='Var
obj_type='N
pag=19
prev=O5044
var_op='asgn
I
obj='Exec
pag=19
prev=O5043
I
nonlocal=True
obj='Var
obj_type='M
pag=19
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=19
prev=O5028
I
obj='Select
pag=19
prev=O5027
sel_field='*
sel_name='intestbo
sel_order='intestbo->CPROWNUM
sel_where='intestbo->RAPPORTO=Substr(riga,1,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5028
fatherSonIndex=0
frm_calc=[
'Substr(riga,26,16)=intestbo->CODINTER
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->CPROWNUM
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->IDBASE
len=10
name='ciidbase
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->DATAINI
len=8
name='cidataini
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->DATAFINE
len=8
name='cidatafine
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->CODINTER
len=12
name='cicodinter
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->NUMPROG1
len=11
name='cinumprog
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->TIPORAP
len=1
name='citiporap
obj='Var
pag=19
prev=O5059
var_op='asgn
I
obj='Var
pag=19
prev=O5058
var_op='asgn
I
obj='Var
pag=19
prev=O5057
var_op='asgn
I
obj='Var
obj_type='D
pag=19
prev=O5056
var_op='asgn
I
obj='Var
obj_type='D
pag=19
prev=O5055
var_op='asgn
I
obj='Var
pag=19
prev=O5054
var_op='asgn
I
obj='Var
obj_type='N
pag=19
prev=O5051
var_op='asgn
I
obj='If
pag=19
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5051
fatherSonIndex=0
frm_calc='intestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=19
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5028
fatherSonIndex=1
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=19
prev=O5068
I
obj='Var
obj_type='N
pag=19
prev=O5067
var_op='asgn
I
obj='Exec
pag=19
prev=O5066
I
nonlocal=True
obj='Var
obj_type='M
pag=19
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
150
]
I
obj='Remark
pag=19
prev=O5026
I
obj='Var
obj_type='N
pag=19
prev=O5025
var_op='asgn
I
obj='Var
obj_type='N
pag=19
prev=O5024
var_op='asgn
I
obj='Var
obj_type='M
pag=19
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=19
prev=O5013
var_op='asgn
I
obj='Var
obj_type='N
pag=19
prev=O5012
var_op='asgn
I
obj='Var
pag=19
prev=O5011
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=19
prev=O5010
var_op='asgn
I
obj='Remark
pag=19
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Deleghe sui rapporti
next=Icpitembatch.CPVarDecl
len=11
name='_nprg1
next=Icpitembatch.CPVarDecl
len=11
name='_nprg2
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Deleghe Rapporti Inserite: '+LRTrim(Str(cNumNew,10,0)) + " - Deleghe Rapporti Aggiornate: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=20
prev=O5084
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=20
prev=O5083
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=20
prev=O5082
var_op='asgn
I
obj='Exec
pag=20
prev=O5081
I
obj='Exec
pag=20
prev=O5079
I
obj='While
pag=20
prev=O5078
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5079
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPRead
arch='xelegabo
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,46,4)+Substr(riga,44,2)+Substr(riga,42,2)
len=8
name='xData
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,55,4)+Substr(riga,53,2)+Substr(riga,51,2)
len=8
name='xDatF
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_nprg1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_nprg2
next=Icpitembatch.CPRead
arch='xapopebo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_numprog)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=20
prev=O5096
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPSelect
father=O5099
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='xelegabo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=20
prev=O5107
var_op='asgn
I
obj='Insert
pag=20
prev=O5106
rd_kfield=[
'RAPPORTO
'CPROWNUM
'CODINTER
'DATAINI
'TIPORAP
'DATAFINE
'IDBASE
'NOAGE
'NUMPROG1
'NUMPROG2
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
'Substr(riga,26,16)
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
'LibreriaMit.UniqueId()
'iif(Empty(LRTrim(Substr(riga,59,1))),'N',Substr(riga,59,1))
'_nprg1
'_nprg2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5107
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=20
prev=O5116
I
obj='Var
obj_type='N
pag=20
prev=O5115
var_op='asgn
I
obj='Exec
pag=20
prev=O5114
I
nonlocal=True
obj='Var
obj_type='M
pag=20
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=20
prev=O5104
var_op='asgn
I
obj='Select
pag=20
sel_field='*
sel_name='xelegabo
sel_order='xelegabo->CPROWNUM
sel_where='xelegabo->RAPPORTO=Left(riga,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5104
fatherSonIndex=0
frm_calc='xelegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=20
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='xelegabo
father=O5099
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=20
prev=O5124
var_op='asgn
I
obj='Write
pag=20
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5124
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=20
prev=O5134
I
obj='Exec
pag=20
prev=O5133
I
obj='Var
obj_type='N
pag=20
prev=O5132
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=20
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'TIPORAP
'DATAFINE
'NOAGE
'NUMPROG1
'NUMPROG2
]
wr_op=[
'=
'=
'=
'=
'=
'=
]
wr_var=[
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
'iif(Empty(LRTrim(Substr(riga,59,1))),'N',Substr(riga,59,1))
'_nprg1
'_nprg2
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=20
prev=O5095
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xapopebo
father=O5096
fatherSonIndex=0
obj='Read
pag=20
rd_field=[
'NUMPROG
]
rd_kfield=[
'DATAOPE
'RAPPORTO
]
rd_kvar=[
'CharToDate(xDatF)
'Left(riga,25)
]
rd_var=[
'_nprg2
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=20
prev=O5094
rd_field=[
'NUMPROG
]
rd_kfield=[
'DATAOPE
'RAPPORTO
]
rd_kvar=[
'CharToDate(xData)
'Left(riga,25)
]
rd_var=[
'_nprg1
]
I
obj='Var
pag=20
pagelocal=True
prev=O5093
var_op='asgn
I
obj='Var
pag=20
pagelocal=True
prev=O5092
var_op='asgn
I
obj='Var
pag=20
prev=O5091
var_op='asgn
I
obj='Var
pag=20
prev=O5090
var_op='asgn
I
obj='Read
pag=20
prev=O5089
rd_field=[
'CPROWNUM
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,16)
]
rd_var=[
'cMaxRow
]
I
obj='Var
obj_type='N
pag=20
prev=O5088
var_op='asgn
I
obj='Var
obj_type='M
pag=20
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=20
prev=O5077
var_op='asgn
I
obj='Var
obj_type='N
pag=20
prev=O5076
var_op='asgn
I
obj='Var
obj_type='N
pag=20
prev=O5075
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=20
prev=O5074
var_op='asgn
I
obj='Var
pag=20
pagelocal=True
prev=O5073
I
obj='Var
pag=20
pagelocal=True
prev=O5072
I
obj='Remark
pag=20
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file SOGOPE.TXT altri soggetti operanti in Provvisorio
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport')
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Soggetti operanti inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Soggetti operanti aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=21
prev=O5168
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=21
prev=O5167
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=21
prev=O5166
var_op='asgn
I
obj='Exec
pag=21
prev=O5165
I
obj='Exec
pag=21
prev=O5163
I
obj='While
pag=21
prev=O5162
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5163
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_salta
next=Icpitembatch.CPRemark
frm_calc='Verfico la presenza di _unicode nelle tabelle rapopebo/operazbo/fraziobo
next=Icpitembatch.CPRead
arch='xapopebo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=21
prev=O5177
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5179
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xoginfo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=21
prev=O5186
var_op='asgn
I
obj='Insert
pag=21
prev=O5184
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cInfProg2
'Substr(riga,48,1)
'Substr(riga,50,25)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5186
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=21
prev=O5195
I
obj='Var
obj_type='N
pag=21
prev=O5194
var_op='asgn
I
obj='Exec
pag=21
prev=O5193
I
nonlocal=True
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=21
sel_field='*
sel_name='xoginfo
sel_where='xoginfo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5184
fatherSonIndex=0
frm_calc='xoginfo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=21
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=21
prev=O5176
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cInfProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O5177
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=21
prev=O5209
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5211
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xogopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=21
prev=O5218
var_op='asgn
I
obj='Insert
pag=21
prev=O5216
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cOpeProg2
'Substr(riga,48,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5218
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=21
prev=O5227
I
obj='Var
obj_type='N
pag=21
prev=O5226
var_op='asgn
I
obj='Exec
pag=21
prev=O5225
I
nonlocal=True
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=21
sel_field='*
sel_name='xogopebo
sel_where='xogopebo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5216
fatherSonIndex=0
frm_calc='xogopebo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=21
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=21
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_idbase
'cInfProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O5209
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=21
prev=O5241
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5243
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xogopefbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_salta
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=21
prev=O5252
var_op='asgn
I
obj='Var
obj_type='N
pag=21
prev=O5250
var_op='asgn
I
obj='Insert
pag=21
prev=O5248
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cOpeProg2
'Substr(riga,48,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5250
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=21
prev=O5260
I
obj='Var
obj_type='N
pag=21
prev=O5259
var_op='asgn
I
obj='Exec
pag=21
prev=O5258
I
nonlocal=True
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=21
sel_field='*
sel_name='xogopefbo
sel_where='xogopefbo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5248
fatherSonIndex=0
frm_calc='xogopefbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=21
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=21
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cInfProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
comment='se non trova il valore nelle tre tabelle da errore e stoppa la procedura
instr=Icpitembatch.CPVarDecl
father=O5241
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errore nella valorizazione del campo IDFILEBO nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,21,16)+" non risulta associabile a nessuna informazione/operazione.  Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_salta
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=21
prev=O5277
I
obj='Var
obj_type='N
pag=21
prev=O5276
var_op='asgn
I
obj='Exec
pag=21
prev=O5275
I
obj='Var
obj_type='N
pag=21
prev=O5274
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Remark
pag=21
prev=O5175
I
obj='Var
obj_type='N
pag=21
prev=O5174
var_op='asgn
I
obj='Var
pag=21
prev=O5173
var_op='asgn
I
obj='Var
obj_type='N
pag=21
prev=O5172
var_op='asgn
I
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=21
prev=O5161
var_op='asgn
I
obj='Var
obj_type='N
pag=21
prev=O5160
var_op='asgn
I
obj='Var
pag=21
prev=O5159
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=21
prev=O5158
var_op='asgn
I
obj='Remark
pag=21
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file INTEST.TXT altri intestatari
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Intestatari inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Intestatari aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=22
prev=O5293
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=22
prev=O5292
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=22
prev=O5291
var_op='asgn
I
obj='Exec
pag=22
prev=O5290
I
obj='Exec
pag=22
prev=O5288
I
obj='While
pag=22
prev=O5287
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5288
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPRemark
frm_calc='Verifico in intestbo che ci sia già un recod con lo stesso codice rapporto e memorizzo i dati della riga necessari per crearne una nuova.
next=Icpitembatch.CPSelect
h=[
19
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Se trovo il record inserisco il nuovo intestatario
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
]
obj='If
pag=22
prev=O5303
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xntestbo
father=O5304
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=22
prev=O5309
var_op='asgn
I
obj='Insert
pag=22
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
]
rd_kvar=[
'ciidbase
'cMaxRow + 1
'cidataini
'iif(Empty(Substr(riga,121,1)) ,'P',Substr(riga,121,1))
'Substr(riga,26,16)
'cinumprog
'Substr(riga,1,25)
'citiporap
''0'
'DateToChar(cidataini)+cinumprog+'O'
'Left(LRTrim(Substr(riga,26,16))+Space(5),16)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5309
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=22
prev=O5318
I
obj='Var
obj_type='N
pag=22
prev=O5317
var_op='asgn
I
obj='Exec
pag=22
prev=O5316
I
nonlocal=True
obj='Var
obj_type='M
pag=22
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=22
prev=O5301
I
obj='Select
pag=22
prev=O5300
sel_field='*
sel_name='xntestbo
sel_order='xntestbo->CPROWNUM
sel_where='xntestbo->RAPPORTO=Substr(riga,1,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5301
fatherSonIndex=0
frm_calc=[
'Substr(riga,26,16)=xntestbo->CODINTER
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->CPROWNUM
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->IDBASE
len=10
name='ciidbase
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->DATAINI
len=8
name='cidataini
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->DATAFINE
len=8
name='cidatafine
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->CODINTER
len=12
name='cicodinter
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->NUMPROG1
len=11
name='cinumprog
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->TIPORAP
len=1
name='citiporap
obj='Var
pag=22
prev=O5332
var_op='asgn
I
obj='Var
pag=22
prev=O5331
var_op='asgn
I
obj='Var
pag=22
prev=O5330
var_op='asgn
I
obj='Var
obj_type='D
pag=22
prev=O5329
var_op='asgn
I
obj='Var
obj_type='D
pag=22
prev=O5328
var_op='asgn
I
obj='Var
pag=22
prev=O5327
var_op='asgn
I
obj='Var
obj_type='N
pag=22
prev=O5324
var_op='asgn
I
obj='If
pag=22
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5324
fatherSonIndex=0
frm_calc='xntestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=22
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5301
fatherSonIndex=1
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=22
prev=O5341
I
obj='Var
obj_type='N
pag=22
prev=O5340
var_op='asgn
I
obj='Exec
pag=22
prev=O5339
I
nonlocal=True
obj='Var
obj_type='M
pag=22
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
150
]
I
obj='Remark
pag=22
prev=O5299
I
obj='Var
obj_type='N
pag=22
prev=O5298
var_op='asgn
I
obj='Var
obj_type='N
pag=22
prev=O5297
var_op='asgn
I
obj='Var
obj_type='M
pag=22
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=22
prev=O5286
var_op='asgn
I
obj='Var
obj_type='N
pag=22
prev=O5285
var_op='asgn
I
obj='Var
pag=22
prev=O5284
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=22
prev=O5283
var_op='asgn
I
obj='Remark
pag=22
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Deleghe sui rapporti
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Deleghe Rapporti Inserite: '+LRTrim(Str(cNumNew,10,0)) + " - Deleghe Rapporti Aggiornate: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=23
prev=O5355
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=23
prev=O5354
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=23
prev=O5353
var_op='asgn
I
obj='Exec
pag=23
prev=O5352
I
obj='Exec
pag=23
prev=O5350
I
obj='While
pag=23
prev=O5349
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5350
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPRead
arch='jelegabo
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,46,4)+Substr(riga,44,2)+Substr(riga,42,2)
len=8
name='xData
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,55,4)+Substr(riga,53,2)+Substr(riga,51,2)
len=8
name='xDatF
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=23
prev=O5363
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPSelect
father=O5364
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='jelegabo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=23
prev=O5372
var_op='asgn
I
obj='Insert
pag=23
prev=O5371
rd_kfield=[
'RAPPORTO
'CPROWNUM
'CODINTER
'DATAINI
'TIPORAP
'DATAFINE
'IDBASE
'NOAGE
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
'Substr(riga,26,16)
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
'LibreriaMit.UniqueId()
'iif(Empty(LRTrim(Substr(riga,59,1))),'N',Substr(riga,59,1))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5372
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=23
prev=O5381
I
obj='Var
obj_type='N
pag=23
prev=O5380
var_op='asgn
I
obj='Exec
pag=23
prev=O5379
I
nonlocal=True
obj='Var
obj_type='M
pag=23
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=23
prev=O5369
var_op='asgn
I
obj='Select
pag=23
sel_field='*
sel_name='jelegabo
sel_order='jelegabo->CPROWNUM
sel_where='jelegabo->RAPPORTO=Left(riga,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5369
fatherSonIndex=0
frm_calc='jelegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=23
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='jelegabo
father=O5364
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=23
prev=O5389
var_op='asgn
I
obj='Write
pag=23
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5389
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=23
prev=O5399
I
obj='Var
obj_type='N
pag=23
prev=O5398
var_op='asgn
I
obj='Exec
pag=23
prev=O5397
I
nonlocal=True
obj='Var
obj_type='M
pag=23
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'TIPORAP
'DATAFINE
]
wr_op=[
'=
'=
'=
]
wr_var=[
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=23
prev=O5362
var_op='asgn
I
obj='Var
pag=23
prev=O5361
var_op='asgn
I
obj='Read
pag=23
prev=O5360
rd_field=[
'CPROWNUM
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,16)
]
rd_var=[
'cMaxRow
]
I
obj='Var
obj_type='N
pag=23
prev=O5359
var_op='asgn
I
obj='Var
obj_type='M
pag=23
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=23
prev=O5348
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=23
prev=O5347
var_op='asgn
I
obj='Var
obj_type='N
pag=23
prev=O5346
var_op='asgn
I
obj='Var
obj_type='N
pag=23
prev=O5345
var_op='asgn
I
obj='Remark
pag=23
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file SOGAGE.TXT altri soggetti operanti in Provvisorio
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport')
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Soggetti operanti inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Soggetti operanti aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=24
prev=O5421
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=24
prev=O5420
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=24
prev=O5419
var_op='asgn
I
obj='Exec
pag=24
prev=O5418
I
obj='Exec
pag=24
prev=O5416
I
obj='While
pag=24
prev=O5415
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5416
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_salta
next=Icpitembatch.CPRemark
frm_calc='Verfico la presenza di _unicode nelle tabelle rapopebo/operazbo/fraziobo
next=Icpitembatch.CPRead
arch='japopebo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=24
prev=O5430
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5432
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='joginfo
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=24
prev=O5439
var_op='asgn
I
obj='Insert
pag=24
prev=O5437
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
]
rd_kvar=[
'_unicode
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'_unicode
'cInfProg2
'Substr(riga,48,1)
'Substr(riga,50,25)
]
I
obj='Select
pag=24
sel_field='*
sel_name='joginfo
sel_where='joginfo->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5437
fatherSonIndex=0
frm_calc='joginfo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=24
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=24
prev=O5429
rd_field=[
'IDBASE
'NUMPROG
]
rd_kfield=[
'IDBASE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_unicode
'cInfProg2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='jperazbo
father=O5430
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=24
prev=O5454
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5456
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='jogopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=24
prev=O5463
var_op='asgn
I
obj='Insert
pag=24
prev=O5461
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
]
rd_kvar=[
'_unicode
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'_unicode
'cOpeProg2
'Substr(riga,48,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5463
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=24
prev=O5472
I
obj='Var
obj_type='N
pag=24
prev=O5471
var_op='asgn
I
obj='Exec
pag=24
prev=O5470
I
nonlocal=True
obj='Var
obj_type='M
pag=24
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=24
sel_field='*
sel_name='jogopebo
sel_where='jogopebo->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5461
fatherSonIndex=0
frm_calc='jogopebo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=24
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=24
rd_field=[
'IDBASE
'NUMPROG
]
rd_kfield=[
'IDBASE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
'cOpeProg2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5454
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errore nella valorizazione del campo IDFILEBO nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,21,16)+" non risulta associabile a nessuna informazione/operazione.  Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_salta
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=24
prev=O5489
I
obj='Var
obj_type='N
pag=24
prev=O5488
var_op='asgn
I
obj='Exec
pag=24
prev=O5487
I
obj='Var
obj_type='N
pag=24
prev=O5486
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=24
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Remark
pag=24
prev=O5428
I
obj='Var
obj_type='N
pag=24
prev=O5427
var_op='asgn
I
obj='Var
pag=24
prev=O5426
var_op='asgn
I
obj='Var
obj_type='N
pag=24
prev=O5425
var_op='asgn
I
obj='Var
obj_type='M
pag=24
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=24
prev=O5414
var_op='asgn
I
obj='Var
obj_type='N
pag=24
prev=O5413
var_op='asgn
I
obj='Var
obj_type='N
pag=24
prev=O5412
var_op='asgn
I
obj='Var
pag=24
prev=O5411
var_op='asgn
I
obj='Remark
pag=24
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file INTAGE.TXT altri intestatari
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Intestatari inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Intestatari aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=25
prev=O5504
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=25
prev=O5503
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=25
prev=O5502
var_op='asgn
I
obj='Exec
pag=25
prev=O5501
I
obj='Exec
pag=25
prev=O5499
I
obj='While
pag=25
prev=O5498
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5499
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPRemark
frm_calc='Verifico in intestbo che ci sia già un recod con lo stesso codice rapporto e memorizzo i dati della riga necessari per crearne una nuova.
next=Icpitembatch.CPSelect
h=[
19
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Se trovo il record inserisco il nuovo intestatario
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
]
obj='If
pag=25
prev=O5514
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='jntestbo
father=O5515
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=25
prev=O5520
var_op='asgn
I
obj='Insert
pag=25
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
]
rd_kvar=[
'ciidbase
'cMaxRow + 1
'cidataini
'iif(Empty(Substr(riga,121,1)) ,'P',Substr(riga,121,1))
'Substr(riga,26,16)
'cinumprog
'Substr(riga,1,25)
'citiporap
''0'
'DateToChar(cidataini)+cinumprog+'O'
'Left(LRTrim(Substr(riga,26,16))+Space(5),16)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5520
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=25
prev=O5529
I
obj='Var
obj_type='N
pag=25
prev=O5528
var_op='asgn
I
obj='Exec
pag=25
prev=O5527
I
nonlocal=True
obj='Var
obj_type='M
pag=25
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=25
prev=O5512
I
obj='Select
pag=25
prev=O5511
sel_field='*
sel_name='jntestbo
sel_order='jntestbo->CPROWNUM
sel_where='jntestbo->RAPPORTO=Substr(riga,1,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5512
fatherSonIndex=0
frm_calc=[
'Substr(riga,26,16)=jntestbo->CODINTER
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->CPROWNUM
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->IDBASE
len=10
name='ciidbase
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->DATAINI
len=8
name='cidataini
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->DATAFINE
len=8
name='cidatafine
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->CODINTER
len=12
name='cicodinter
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->NUMPROG1
len=11
name='cinumprog
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->TIPORAP
len=1
name='citiporap
obj='Var
pag=25
prev=O5543
var_op='asgn
I
obj='Var
pag=25
prev=O5542
var_op='asgn
I
obj='Var
pag=25
prev=O5541
var_op='asgn
I
obj='Var
obj_type='D
pag=25
prev=O5540
var_op='asgn
I
obj='Var
obj_type='D
pag=25
prev=O5539
var_op='asgn
I
obj='Var
pag=25
prev=O5538
var_op='asgn
I
obj='Var
obj_type='N
pag=25
prev=O5535
var_op='asgn
I
obj='If
pag=25
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5535
fatherSonIndex=0
frm_calc='jntestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=25
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5512
fatherSonIndex=1
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=25
prev=O5552
I
obj='Var
obj_type='N
pag=25
prev=O5551
var_op='asgn
I
obj='Exec
pag=25
prev=O5550
I
nonlocal=True
obj='Var
obj_type='M
pag=25
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
150
]
I
obj='Remark
pag=25
prev=O5510
I
obj='Var
obj_type='N
pag=25
prev=O5509
var_op='asgn
I
obj='Var
obj_type='N
pag=25
prev=O5508
var_op='asgn
I
obj='Var
obj_type='M
pag=25
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=25
prev=O5497
var_op='asgn
I
obj='Var
obj_type='N
pag=25
prev=O5496
var_op='asgn
I
obj='Var
obj_type='N
pag=25
prev=O5495
var_op='asgn
I
obj='Var
pag=25
prev=O5494
var_op='asgn
I
obj='Remark
pag=25
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Intestatari Operazioni Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Intestatari Operazioni Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=26
prev=O5566
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=26
prev=O5565
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=26
prev=O5564
var_op='asgn
I
obj='Exec
pag=26
prev=O5563
I
obj='Exec
pag=26
prev=O5561
I
obj='While
pag=26
prev=O5560
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5561
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,48,1)='F'
'Substr(riga,48,1)='O'
]
h=[
19
19
19
]
obj='If
pag=26
prev=O5573
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O5574
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=26
prev=O5579
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O5580
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=26
prev=O5585
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientifrz
father=O5586
fatherSonIndex=0
obj='Insert
pag=26
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=26
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientifrz
father=O5580
fatherSonIndex=1
obj='Insert
pag=26
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=26
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O5574
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=26
prev=O5609
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O5610
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=26
prev=O5615
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O5616
fatherSonIndex=0
obj='Insert
pag=26
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=26
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientiope
father=O5610
fatherSonIndex=1
obj='Insert
pag=26
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=26
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=26
prev=O5572
var_op='asgn
I
obj='Var
obj_type='N
pag=26
prev=O5571
var_op='asgn
I
obj='Var
obj_type='N
pag=26
prev=O5570
var_op='asgn
I
obj='Var
obj_type='M
pag=26
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=26
prev=O5559
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=26
prev=O5558
var_op='asgn
I
obj='Var
obj_type='N
pag=26
prev=O5557
var_op='asgn
I
obj='Var
obj_type='N
pag=26
prev=O5556
var_op='asgn
I
obj='Remark
pag=26
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Altri Soggetti Operazioni Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Altri Soggetti Operazioni Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=29
prev=O5650
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=29
prev=O5649
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=29
prev=O5648
var_op='asgn
I
obj='Exec
pag=29
prev=O5647
I
obj='Exec
pag=29
prev=O5645
I
obj='While
pag=29
prev=O5644
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5645
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,48,1)='F'
'Substr(riga,48,1)='O'
]
h=[
19
19
19
]
obj='If
pag=29
prev=O5657
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O5658
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=29
prev=O5663
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O5664
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=29
prev=O5669
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistifrz
father=O5670
fatherSonIndex=0
obj='Insert
pag=29
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=29
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xerzistifrz
father=O5664
fatherSonIndex=1
obj='Insert
pag=29
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=29
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O5658
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=29
prev=O5693
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O5694
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=29
prev=O5699
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistiope
father=O5700
fatherSonIndex=0
obj='Insert
pag=29
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=29
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xerzistiope
father=O5694
fatherSonIndex=1
obj='Insert
pag=29
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=29
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=29
prev=O5656
var_op='asgn
I
obj='Var
obj_type='N
pag=29
prev=O5655
var_op='asgn
I
obj='Var
obj_type='N
pag=29
prev=O5654
var_op='asgn
I
obj='Var
obj_type='M
pag=29
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=29
prev=O5643
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=29
prev=O5642
var_op='asgn
I
obj='Var
obj_type='N
pag=29
prev=O5641
var_op='asgn
I
obj='Var
obj_type='N
pag=29
prev=O5640
var_op='asgn
I
obj='Remark
pag=29
x=23
y=25
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Beneficiari Operazioni Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Beneficiari Operazioni Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=28
prev=O5734
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=28
prev=O5733
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=28
prev=O5732
var_op='asgn
I
obj='Exec
pag=28
prev=O5731
I
obj='Exec
pag=28
prev=O5729
I
obj='While
pag=28
prev=O5728
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5729
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=28
prev=O5738
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5739
fatherSonIndex=0
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,48,1)='F'
'Substr(riga,48,1)='O'
'Substr(riga,48,1)='I'
]
h=[
19
19
19
19
]
obj='If
pag=28
prev=O5746
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O5747
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=28
prev=O5752
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O5753
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=28
prev=O5758
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5759
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='beneficfrz
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O5767
var_op='asgn
I
obj='Insert
pag=28
prev=O5766
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'Substr(riga,75,70)
'Substr(riga,145,3)
'Substr(riga,148,30)
'Substr(riga,178,6)
'Substr(riga,184,2)
'Substr(riga,186,35)
'Substr(riga,221,5)
'cMaxRow
]
I
obj='Var
obj_type='N
pag=28
prev=O5764
var_op='asgn
I
obj='Select
pag=28
sel_field='*
sel_name='beneficfrz
sel_order='beneficfrz->CPROWNUM
sel_where='beneficfrz->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5764
fatherSonIndex=0
frm_calc='beneficfrz->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5753
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='xeneficfrz
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O5784
var_op='asgn
I
obj='Insert
pag=28
prev=O5783
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'Substr(riga,75,70)
'Substr(riga,145,3)
'Substr(riga,148,30)
'Substr(riga,178,6)
'Substr(riga,184,2)
'Substr(riga,186,35)
'Substr(riga,221,5)
'cMaxRow
]
I
obj='Var
obj_type='N
pag=28
prev=O5781
var_op='asgn
I
obj='Select
pag=28
sel_field='*
sel_name='xeneficfrz
sel_order='xeneficfrz->CPROWNUM
sel_where='xeneficfrz->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5781
fatherSonIndex=0
frm_calc='xeneficfrz->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='xperazbo
father=O5747
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=28
prev=O5798
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O5799
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=28
prev=O5804
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5805
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='beneficope
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O5813
var_op='asgn
I
obj='Insert
pag=28
prev=O5812
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'Substr(riga,75,70)
'Substr(riga,145,3)
'Substr(riga,148,30)
'Substr(riga,178,6)
'Substr(riga,184,2)
'Substr(riga,186,35)
'Substr(riga,221,5)
'cMaxRow
]
I
obj='Var
obj_type='N
pag=28
prev=O5810
var_op='asgn
I
obj='Select
pag=28
sel_field='*
sel_name='beneficope
sel_order='beneficope->CPROWNUM
sel_where='beneficope->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5810
fatherSonIndex=0
frm_calc='beneficope->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5799
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='xeneficope
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O5830
var_op='asgn
I
obj='Insert
pag=28
prev=O5829
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'Substr(riga,75,70)
'Substr(riga,145,3)
'Substr(riga,148,30)
'Substr(riga,178,6)
'Substr(riga,184,2)
'Substr(riga,186,35)
'Substr(riga,221,5)
'cMaxRow
]
I
obj='Var
obj_type='N
pag=28
prev=O5827
var_op='asgn
I
obj='Select
pag=28
sel_field='*
sel_name='xeneficope
sel_order='xeneficope->CPROWNUM
sel_where='xeneficope->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5827
fatherSonIndex=0
frm_calc='xeneficope->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xapopebo
father=O5747
fatherSonIndex=2
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=28
prev=O5844
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='rapopebo
father=O5845
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=28
prev=O5850
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='fiduciabo
father=O5851
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O5856
var_op='asgn
I
obj='Insert
pag=28
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xiduciabo
father=O5845
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O5866
var_op='asgn
I
obj='Insert
pag=28
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=28
prev=O5745
var_op='asgn
I
obj='Var
obj_type='N
pag=28
prev=O5744
var_op='asgn
I
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=28
prev=O5727
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=28
prev=O5726
var_op='asgn
I
obj='Var
obj_type='N
pag=28
prev=O5725
var_op='asgn
I
obj='Var
obj_type='N
pag=28
prev=O5724
var_op='asgn
I
obj='Remark
pag=28
x=21
y=20
I
Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumInv
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='nProgSto
next=Icpitembatch.CPVarDecl
frm_calc='0
len=15
name='nProgImp
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'nProgImp > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'nProgSto > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Soggetti Inseriti: '+LRTrim(Str(cNumNew,10,0)) + ' - Soggetti Aggiornati: '+LRTrim(Str(cNumMod,10,0)) + ' - Soggetti Invariati: '+LRTrim(Str(cNumInv,10,0)) + ' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','PERSNEW','Soggetti Inseriti: '+LRTrim(Str(cNumNew,10,0)) + ' - Soggetti Aggiornati: '+LRTrim(Str(cNumMod,10,0)) + ' - Soggetti Invariati: '+LRTrim(Str(cNumInv,10,0)))
obj='Exec
pag=30
prev=O5900
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O5899
var_op='asgn
I
obj='Exec
pag=30
prev=O5898
I
obj='Exec
pag=30
prev=O5897
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O5896
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O5893
var_op='asgn
I
obj='If
pag=30
prev=O5890
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O5893
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'm_nUpdatedRows=0
]
h=[
19
19
]
obj='If
pag=30
prev=O5904
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O5905
fatherSonIndex=0
obj='Insert
pag=30
rd_kfield=[
'tablecode
'warncode
'autonum
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
'nProgSto + 1
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=30
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'nProgSto + 1
]
I
I
]
w=[
150
150
]
I
obj='If
pag=30
prev=O5888
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O5890
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'm_nUpdatedRows=0
]
h=[
19
19
]
obj='If
pag=30
prev=O5923
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O5924
fatherSonIndex=0
obj='Insert
pag=30
rd_kfield=[
'tablecode
'warncode
'autonum
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
'nProgImp + 1
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=30
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'nProgImp + 1
]
I
I
]
w=[
150
150
]
I
obj='While
pag=30
prev=O5887
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5888
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=30
prev=O5942
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5943
fatherSonIndex=0
frm_calc=[
'w_creamo='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datvarage
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' nominativi del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,112,16)
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,112,16)
len=16
name='xCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,496,16)
len=16
name='_conadd
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(_conadd)),cCli1,_conadd)
len=16
name='cCli1
next=Icpitembatch.CPRemark
frm_calc='Prima la Read si faceva per CF
next=Icpitembatch.CPBeginEnd
comment='Azzera vecchi valori
h=[
19
19
]
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_flgvali
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_flganag
next=Icpitembatch.CPRead
arch='personbo_agg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,288,1))),'G','P')
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,288,1)='M','1',iif(Substr(riga,288,1)='F','2',Substr(riga,288,1)))
len=1
name='xSesso
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,458,1)='0' or Substr(riga,458,1)='1' or Substr(riga,458,1) = ''
'Substr(riga,458,1)='N' or Substr(riga,458,1)='S'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgvali='S',0,xCFE)
len=1
name='xCFE
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgvali='S',Upper(_oldcf),Upper(LRTrim(Substr(riga,112,16))))
len=16
name='xCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,6)
len=6
name='xCodCab
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCodCab))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,136,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'(Substr(xCF,12,1) = 'Z' or Substr(riga,456,2)='EE') and (Substr(riga,288,1)='M' or Substr(riga,288,1)='F')
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Assegna Valori in base a flag
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xConnes)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=30
prev=O5989
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5991
fatherSonIndex=0
frm_calc='nProgImp + 1
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='personbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=30
prev=O5997
var_op='asgn
I
obj='Insert
pag=30
prev=O5996
rd_kfield=[
'ALLINEATO
'ALLINEATONOMECNOME
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'CONNES
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROGIMPORT
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'TIPOPERS
'DATAVARAGE
]
rd_kvar=[
'0
'0
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,478,5)),3))
'Substr(riga,468,10)
'Substr(riga,200,30)
'Substr(riga,265,9)
'xCFE
'xCodCab
'xCF
'_oldcog
'Upper(Substr(riga,463,5))
'cCli1
'_oldndt
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Upper(Substr(riga,230,30))
'Substr(riga,356,100)
'Substr(riga,77,35)
'_oldncm
'_oldnst
'_oldnom
'Substr(riga,177,15)
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'iif(Empty(Substr(riga,495,1)),'N',Substr(riga,495,1))
'Substr(riga,459,4)
'nProgImp
'Upper(Substr(riga,260,2))
'_oldrgs
'_oldrgs
'Substr(riga,169,3)
'Val(Substr(riga,492,3))
'Val(Substr(riga,489,3))
'Val(Substr(riga,486,3))
'Val(Substr(riga,483,3))
'_oldnsx
'Substr(riga,172,3)
'Substr(riga,166,3)
'_oldnpv
'Substr(riga,175,2)
'_tipper
'_datvarage
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5997
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+LRTrim(Substr(riga,7,70))+" con codice fiscale: "+LRTrim(Substr(riga,112,16))+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore Import file PersNew.txt. Operazione Abortita. Non sono stati importati dati
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=30
prev=O6008
I
obj='Transaction
pag=30
prev=O6007
I
obj='Exec
pag=30
prev=O6006
I
obj='Var
obj_type='N
pag=30
prev=O6005
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O6004
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5991
fatherSonIndex=1
frm_calc='Upper(xCF)+Substr(riga,7,70)+Substr(riga,77,35)+Substr(riga,230,30)+Substr(riga,260,2)+LibreriaMit.SpacePad(LRTrim(Substr(riga,265,9)),5)+Substr(riga,262,3)+Substr(riga,166,3)+Substr(riga,169,3)+Substr(riga,172,3)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+LibreriaMit.SpacePad(Left(cCNAS,30),30)+Substr(riga,456,2)+LibreriaMit.SpacePad(Left(cSNAS,30),30)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+Substr(riga,175,2)+Substr(riga,177,15)+Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2)+Substr(riga,200,30)+Substr(riga,274,14)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='Upper(xCF)+Substr(riga,7,70)+Substr(riga,230,30)+Substr(riga,260,2)
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='xRiga3+LibreriaMit.SpacePad(Left(cCNAS,30),30)+Substr(riga,456,2)+LibreriaMit.SpacePad(Left(cSNAS,30),30)
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='xRiga3+CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))+xSesso
len=10
name='xRiga3
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgaggfam='S'
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Crea la riga di confronto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico se il soggetto è una persona fisica
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Substr(riga,516,4)+Substr(riga,514,2)+Substr(riga,512,2))
len=8
name='_datvarage
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,288,1)='M' or Substr(riga,288,1)='F'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=30
par_expr=[
'xConnes
]
par_name=[
'w_CONNES
]
prev=O6027
sel_name='qbe_aggfam_opextrbo_new
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O6030
fatherSonIndex=0
obj='Write
pag=30
rd_kfield=[
'ANNO
'COLLEG
]
rd_kop=[
'=
'=
]
rd_kvar=[
'qbe_aggfam_opextrbo_new->ANNO
'qbe_aggfam_opextrbo_new->COLLEG
]
wr_field=[
'CFESTERO
]
wr_op=[
'=
]
wr_var=[
'iif(_oldest=1,'S','N')
]
I
I
]
w=[
150
150
]
I
obj='If
pag=30
prev=O6026
sons=[
Icpitembatch.CPItemSon
comment='se persona fisica
instr=Icpitembatch.CPWrite
arch='personbo
father=O6027
fatherSonIndex=0
frm_calc='Errore in aggiornamento PERSNEW
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=30
prev=O6046
var_op='asgn
I
obj='Write
pag=30
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'xConnes
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6046
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
frm_calc='m_cLastMsgError = ""
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=30
prev=O6056
I
obj='Exec
pag=30
prev=O6055
I
obj='Var
obj_type='N
pag=30
prev=O6054
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'DATAVARAGE
'PEP
'AREAGEO
'RAREA
'RATTIV
'RCOMP
'RNATGIU
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,468,10)
'Substr(riga,200,30)
'Substr(riga,265,9)
'_oldest
'xCodCab
'xCF
'_oldcog
'Substr(riga,463,5)
'_oldndt
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Upper(Substr(riga,230,30))
'Substr(riga,356,100)
'Substr(riga,77,35)
'_oldncm
'_oldnst
'_oldnom
'Substr(riga,177,15)
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'Substr(riga,459,4)
'Upper(Substr(riga,260,2))
'_oldrgs
'_oldrgs
'Substr(riga,169,3)
'_oldnsx
'Substr(riga,172,3)
'Substr(riga,166,3)
'_oldnpv
'Substr(riga,175,2)
'_datvarage
'iif(Empty(Substr(riga,495,1)),'N',Substr(riga,495,1))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,478,5)),3))
'Val(Substr(riga,492,3))
'Val(Substr(riga,489,3))
'Val(Substr(riga,486,3))
'Val(Substr(riga,483,3))
]
I
I
Icpitembatch.CPItemSon
comment='se persona giuridica
instr=Icpitembatch.CPRemark
father=O6027
fatherSonIndex=1
frm_calc='Se non è persona fisica
next=Icpitembatch.CPWrite
arch='personbo
frm_calc='Errore in aggiornamento PERSNEW
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=30
prev=O6064
var_op='asgn
I
obj='Write
pag=30
prev=O6063
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'xConnes
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6064
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=30
prev=O6073
I
obj='Var
obj_type='N
pag=30
prev=O6072
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'DATAVARAGE
'PEP
'AREAGEO
'RAREA
'RATTIV
'RCOMP
'RNATGIU
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,468,10)
'Substr(riga,200,30)
'Substr(riga,265,9)
'_oldest
'xCodCab
'xCF
'_oldcog
'Substr(riga,463,5)
'_oldndt
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Upper(Substr(riga,230,30))
'Substr(riga,356,100)
'Substr(riga,77,35)
'_oldncm
'_oldnst
'_oldnom
'Substr(riga,177,15)
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'Substr(riga,459,4)
'Upper(Substr(riga,260,2))
'_oldrgs
'_oldrgs
'Substr(riga,169,3)
'_oldnsx
'Substr(riga,172,3)
'Substr(riga,166,3)
'_oldnpv
'Substr(riga,175,2)
'_datvarage
'iif(Empty(Substr(riga,495,1)),'N',Substr(riga,495,1))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,478,5)),3))
'Val(Substr(riga,492,3))
'Val(Substr(riga,489,3))
'Val(Substr(riga,486,3))
'Val(Substr(riga,483,3))
]
I
obj='Remark
pag=30
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='D
pag=30
prev=O6025
var_op='asgn
I
obj='Remark
pag=30
prev=O6023
I
obj='Select
pag=30
prev=O6022
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6023
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad(personbo->CODFISC,16)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->RAGSOC,70)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->DOMICILIO,35)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->DESCCIT,30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->PROVINCIA,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(LRTrim(personbo->CAP),5)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->PAESE,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->SOTGRUP,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->RAMOGRUP,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->SETTSINT,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(Left(personbo->NASCOMUN,30),30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->TIPINTER,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(Left(personbo->NASSTATO,30),30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + iif(DateToChar(personbo->DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATANASC),8),Space(8))
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->TIPODOC,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->NUMDOCUM,15)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + iif(DateToChar(personbo->DATARILASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATARILASC),8),Space(8))
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->AUTRILASC,30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->PARTIVA,14)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.SpacePad(personbo->CODFISC,16)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->RAGSOC,70)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->DESCCIT,30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->PROVINCIA,2)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(Left(personbo->NASCOMUN,30),30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->TIPINTER,2)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(Left(personbo->NASSTATO,30),30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + iif(DateToChar(personbo->DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATANASC),8),Space(8))
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->SESSO,1)
len=10
name='xRiga4
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgaggfam='S'
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Se le due stringhe sono diverse, ci sono delle modifiche da fare. Quindi storicizzo in wersonbo le modifche.
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(xRiga1) <> LRTrim(xRiga2)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgaggfam='S'
]
h=[
19
19
]
obj='If
pag=30
prev=O6114
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6117
fatherSonIndex=0
frm_calc=[
'LRTrim(xRiga5) <> LRTrim(xRiga6)
]
h=[
19
19
]
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='bat
father=O6122
fatherSonIndex=0
frm_calc='arrt_ae_agg_aetesta_sog(xConnes,_oldest)
obj='Exec
pag=30
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=30
prev=O6113
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O6114
fatherSonIndex=0
frm_calc='Verifico se c'è già una variazione
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Substr(riga,301,4)+Substr(riga,299,2)+Substr(riga,297,2))
len=8
name='_datarett
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
obj='If
pag=30
prev=O6135
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O6137
fatherSonIndex=0
frm_calc='Calcola il progressivo di registrazione
next=Icpitembatch.CPVarDecl
frm_calc='nProgSto + 1
len=10
name='nProgSto
next=Icpitembatch.CPVarDecl
frm_calc='Right('000000000000000'+LRTrim(Str(nProgSto,15,0)),15)
len=15
name='cProgSto
next=Icpitembatch.CPInsert
arch='wersonbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_creamo='S'
]
h=[
19
19
]
obj='If
pag=30
prev=O6145
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6147
fatherSonIndex=0
frm_calc=[
'LRTrim(xRiga3) <> LRTrim(xRiga4)
]
h=[
19
19
]
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O6152
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=30
prev=O6157
sel_field='fraziobo->IDBASE
sel_name='fraziobo
sel_where='fraziobo->CONNESCLI=xConnes or fraziobo->CONNESOPER=xConnes or fraziobo->CONNESBEN=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6159
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(gAzienda)+"'",Space(10),10)
len=10
name='cNewProg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc=''JLMNOTUV?'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='fraziobo->IDBASE
len=10
name='_idbase
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=30
prev=O6165
sel_field='*
sel_name='fraziobo
sel_where='fraziobo->IDBASE=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6166
fatherSonIndex=0
frm_calc='iif(Empty(fraziobo->FLAGRAP2),Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(fraziobo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPInsert
arch='fraziobo
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(operazbo->DATAOPE)+"F"+LibreriaMit.UniqueId()+"X"
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=30
prev=O6172
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_idbase
]
wr_field=[
'OPERAZMOD
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
'=
]
wr_var=[
'fraziobo->IDEREG
''1'
'Date()
]
I
obj='Var
pag=30
prev=O6171
var_op='asgn
I
obj='Insert
pag=30
prev=O6170
rd_kfield=[
'AREAGEO
'AUTOM
'CAMBIO
'CDATAOPE
'CDATOPE
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'MODSVOL
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
'CONNALTRO
'CONNESDOC
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'DATAIMP
'C_RAPPORTO
'PAGASOGOP
'MTCN
'IDFILE
'CDATREG
'IPCOLLEG
'ORACOLLEG
'DUCOLLEG
'ANNOOPE
]
rd_kvar=[
'fraziobo->AREAGEO
'fraziobo->AUTOM
'fraziobo->CAMBIO
'fraziobo->CDATAOPE
'fraziobo->CDATOPE
'fraziobo->CODANA
'fraziobo->CODCAB
'fraziobo->CODCAB2
'fraziobo->CODDIPE
'fraziobo->CODINT2
'fraziobo->CODINTER
'fraziobo->CODVOC
'fraziobo->COLLEG
'fraziobo->CONNESBEN
'fraziobo->CONNESCLI
'fraziobo->CONNESOPER
'fraziobo->DATAOPE
'fraziobo->DATAREG
'Date()
'fraziobo->DESC2
'fraziobo->DESCCIT
'fraziobo->DESCINTER
'fraziobo->DOCFILE
'fraziobo->FLAGCONT
'fraziobo->FLAGFRAZ
'fraziobo->FLAGLIRE
'fraziobo->FLAGRAP
'_flagrap2
'cNewProg
'fraziobo->idcauana
'fraziobo->IDEREG
'fraziobo->INFORM
'fraziobo->MODSVOL
'fraziobo->NATURA
'fraziobo->NOPROT
'fraziobo->NUMPROG
'fraziobo->OPERAG
'fraziobo->OPERATORE
'fraziobo->OPERAZMOD
'fraziobo->OPRAP
'fraziobo->PAESE
'fraziobo->PRGIMPFRZ
'fraziobo->PROV2
'fraziobo->PROVINCIA
'fraziobo->RAGIO
'fraziobo->RAPPORTBEN
'fraziobo->RAPPORTO
'fraziobo->RAREA
'fraziobo->RCOMP
'fraziobo->RESPINS
'fraziobo->RFREQ
'fraziobo->RIFIMP
'fraziobo->RIMP
'fraziobo->RRAGIO
'fraziobo->RTIPO
'fraziobo->SCOPO
'fraziobo->SEGNO
''3'
'fraziobo->TIPO
'fraziobo->TIPOINF
'fraziobo->TIPOINT2
'fraziobo->TIPOINTER
'fraziobo->TIPOLEG
'fraziobo->TIPOOPRAP
'fraziobo->TOTCONT
'fraziobo->TOTLIRE
'fraziobo->UCODE
'fraziobo->UNIQUECODE
'fraziobo->VALUTA
'fraziobo->ZCPARTE
'fraziobo->CONNALTRO
'fraziobo->CONNESDOC
'fraziobo->C_RAG
'fraziobo->C_STA
'fraziobo->C_CTA
'fraziobo->C_CAB
'fraziobo->C_PRV
'fraziobo->C_IND
'fraziobo->C_CAP
'fraziobo->DATAIMP
'fraziobo->C_RAPPORTO
'fraziobo->PAGASOGOP
'fraziobo->MTCN
'fraziobo->IDFILE
'fraziobo->CDATREG
'fraziobo->IPCOLLEG
'fraziobo->ORACOLLEG
'fraziobo->DUCOLLEG
'fraziobo->ANNOOPE
]
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=30
prev=O6164
var_op='asgn
I
obj='Var
pag=30
prev=O6163
var_op='asgn
I
obj='Var
pag=30
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=30
sel_field='operazbo->IDBASE
sel_name='operazbo
sel_where='operazbo->CONNESCLI=xConnes or operazbo->CONNESOPER=xConnes or operazbo->CONNESBEN=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6157
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",Space(10),10)
len=10
name='cNewProg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='operazbo->IDBASE
len=10
name='_idbase
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=30
prev=O6188
sel_field='*
sel_name='operazbo
sel_where='operazbo->IDBASE=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6189
fatherSonIndex=0
frm_calc='iif(Empty(operazbo->FLAGRAP2),Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(operazbo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPInsert
arch='operazbo
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(operazbo->DATAOPE)+"O"+LibreriaMit.UniqueId()+"X"
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=30
prev=O6195
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_idbase
]
wr_field=[
'OPERAZMOD
'STATOREG
'DATARETT
'IDEREG
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'operazbo->IDEREG
''1'
'Date()
'_idreg
]
I
obj='Var
pag=30
prev=O6194
var_op='asgn
I
obj='Insert
pag=30
prev=O6193
rd_kfield=[
'AMMONT
'AREAGEO
'AUTOM
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESDOC
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'IDFILE
'INFORM
'IPCOLLEG
'MODSVOL
'MTCN
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
'ANNOOPE
]
rd_kvar=[
'operazbo->AMMONT
'operazbo->AREAGEO
'operazbo->AUTOM
'operazbo->C_CAB
'operazbo->C_CAP
'operazbo->C_CTA
'operazbo->C_IND
'operazbo->C_PRV
'operazbo->C_RAG
'operazbo->C_RAPPORTO
'operazbo->C_STA
'operazbo->CAMBIO
'operazbo->CDATAOPE
'operazbo->CDATOPE
'operazbo->CDATREG
'operazbo->CODANA
'operazbo->CODCAB
'operazbo->CODCAB2
'operazbo->CODDIPE
'operazbo->CODINT2
'operazbo->CODINTER
'operazbo->CODVOC
'operazbo->COLLEG
'operazbo->CONNALTRO
'operazbo->CONNESBEN
'operazbo->CONNESCLI
'operazbo->CONNESDOC
'operazbo->CONNESOPER
'operazbo->DATAIMP
'operazbo->DATAOPE
'operazbo->DATAREG
'Date()
'operazbo->DESC2
'operazbo->DESCCIT
'operazbo->DESCINTER
'operazbo->DOCFILE
'operazbo->DUCOLLEG
'operazbo->DURAT
'operazbo->FLAGCONT
'operazbo->FLAGFRAZ
'operazbo->FLAGLIRE
'operazbo->FLAGRAP
'_flagrap2
'cNewProg
'operazbo->idcauana
'operazbo->IDEREG
'operazbo->IDFILE
'operazbo->INFORM
'operazbo->IPCOLLEG
'operazbo->MODSVOL
'operazbo->MTCN
'operazbo->NATURA
'operazbo->NOPROT
'operazbo->NUMPROG
'operazbo->OPERAG
'operazbo->OPERATORE
'operazbo->OPERAZMOD
'operazbo->OPRAP
'operazbo->ORACOLLEG
'operazbo->PAESE
'operazbo->PAGASOGOP
'operazbo->PRGIMPOPE
'operazbo->PROV2
'operazbo->PROVINCIA
'operazbo->RAGIO
'operazbo->RAPPORTBEN
'operazbo->RAPPORTO
'operazbo->RAREA
'operazbo->RCOMP
'operazbo->RESPINS
'operazbo->RFREQ
'operazbo->RIFIMP
'operazbo->RIMP
'operazbo->RRAGIO
'operazbo->RTIPO
'operazbo->SCOPO
'operazbo->SEGNO
''3'
'operazbo->TIPO
'operazbo->TIPOINF
'operazbo->TIPOINT2
'operazbo->TIPOINTER
'operazbo->TIPOLEG
'operazbo->TIPOOPRAP
'operazbo->TOTCONT
'operazbo->TOTLIRE
'operazbo->UCODE
'operazbo->UNIQUECODE
'operazbo->VALUTA
'operazbo->ZCPARTE
'operazbo->ANNOOPE
]
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=30
prev=O6187
var_op='asgn
I
obj='Var
pag=30
prev=O6186
var_op='asgn
I
obj='Var
pag=30
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=30
prev=O6144
rd_kfield=[
'ALLINEATO
'ALLINEATONOMECNOME
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODDIPE
'CODFISC
'CODINTER
'COGNOME
'COMPORT
'CONNES
'datamodi
'DATANASC
'DATARILASC
'DATASEGN
'DATAVALI
'DATEXTRA
'DESCCIT
'DOCFILE
'DOMICILIO
'idcitta
'IDFILE
'MACROAGENTE
'NASCOMUN
'NASSTATO
'NOME
'NOTE
'NUMDOCUM
'OLDCODFISC
'OLDCONNES
'OLDSETSIN
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROGIMP_C
'PROGIMPORT
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'sanumpro
'SESSO
'SETTSINT
'SOSPMAF
'SOTGRUP
'SPOTID
'TIPINTER
'TIPODOC
'TIPOPERS
]
rd_kvar=[
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->AREAGEO
'personbo->ATTIV
'personbo->AUTRILASC
'personbo->CAP
'personbo->CFESTERO
'personbo->CODCAB
'personbo->CODDIPE
'personbo->CODFISC
'personbo->CODINTER
'personbo->COGNOME
'personbo->COMPORT
'xConnes
'_datarett
'personbo->DATANASC
'personbo->DATARILASC
'personbo->DATASEGN
'personbo->DATAVALI
'personbo->DATEXTRA
'personbo->DESCCIT
'personbo->DOCFILE
'personbo->DOMICILIO
'personbo->idcitta
'personbo->IDFILE
'personbo->MACROAGENTE
'personbo->NASCOMUN
'personbo->NASSTATO
'personbo->NOME
'personbo->NOTE
'personbo->NUMDOCUM
'personbo->OLDCODFISC
'personbo->OLDCONNES
'personbo->OLDSETSIN
'personbo->PAESE
'personbo->PARTIVA
'personbo->PEP
'personbo->PKTBSPECIE
'personbo->PROGIMP_C
'personbo->PROGIMPORT
'personbo->PROVINCIA
'personbo->RAGSOC
'personbo->RAGSOCOLD
'personbo->RAMOGRUP
'personbo->RAREA
'personbo->RATTIV
'personbo->RCOMP
'personbo->RNATGIU
'cProgSto
'personbo->SESSO
'personbo->SETTSINT
'personbo->SOSPMAF
'personbo->SOTGRUP
'personbo->SPOTID
'personbo->TIPINTER
'personbo->TIPODOC
'personbo->TIPOPERS
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6145
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
frm_calc='m_cLastMsgError = ""
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=30
prev=O6215
I
obj='Exec
pag=30
prev=O6214
I
obj='Var
obj_type='N
pag=30
prev=O6213
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=30
pagelocal=True
prev=O6143
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O6142
var_op='asgn
I
obj='Remark
pag=30
I
I
]
w=[
150
150
]
I
obj='Select
pag=30
prev=O6134
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=xConnes and wersonbo->datamodi=_datarett
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6135
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='D
pag=30
prev=O6133
var_op='asgn
I
obj='Var
pag=30
prev=O6132
var_op='asgn
I
obj='Remark
pag=30
I
I
]
w=[
150
150
]
I
obj='Remark
pag=30
prev=O6110
I
obj='If
pag=30
prev=O6109
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6110
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad(personbo->CODFISC,16)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->RAGSOC,70)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->DESCCIT,30)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->PAESE,3)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->PROVINCIA,2)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->COGNOME,26)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->NOME,25)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->SESSO,1)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + iif(DateToChar(personbo->DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATANASC),8),Space(8))
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(Left(personbo->NASCOMUN,30),30)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->TIPINTER,2)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(Left(personbo->NASSTATO,30),30)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='iif(personbo->CFESTERO=1,'1','0')
len=10
name='xRiga6
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6237
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6236
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6235
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6234
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6233
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6232
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6231
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6230
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6229
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6228
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6227
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6226
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6108
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6107
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6106
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6105
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6104
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6103
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6102
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6101
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6100
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6099
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6098
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6097
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6096
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6095
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6094
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6093
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6092
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6091
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6090
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6089
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6088
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6087
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6086
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6085
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6084
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6083
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6082
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=30
prev=O6019
I
obj='If
pag=30
prev=O6018
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6019
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad(Upper(xCF),16)+Substr(riga,7,70)+Substr(riga,230,30)+Substr(riga,262,3)+Substr(riga,260,2)
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+Substr(riga,305,26)+Substr(riga,331,25)+xSesso
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2)+LibreriaMit.SpacePad(Left(cCNAS,30),30)+Substr(riga,456,2)
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+LibreriaMit.SpacePad(Left(cSNAS,30),30)+xCFE
len=10
name='xRiga5
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6245
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6244
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6243
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6017
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6016
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6015
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6014
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6013
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6012
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=30
prev=O5986
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5989
fatherSonIndex=0
frm_calc='iif(_flganag='S',_oldcog,Upper(Substr(riga,305,26)))
len=26
name='_oldcog
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnom,Upper(Substr(riga,331,25)))
len=26
name='_oldnom
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldrgs,Upper(Substr(riga,7,70)))
len=70
name='_oldrgs
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldncm,cCNAS)
len=30
name='_oldncm
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnst,cSNAS)
len=30
name='_oldnst
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldndt,CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2)))
len=8
name='_oldndt
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnpv,Upper(Substr(riga,456,2)))
len=2
name='_oldnpv
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnsx,xSesso)
len=1
name='_oldnsx
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgvali='S',_oldest,xCFE)
len=1
name='_oldest
obj='Var
obj_type='N
pag=30
prev=O6258
var_op='asgn
I
obj='Var
pag=30
prev=O6257
var_op='asgn
I
obj='Var
pag=30
prev=O6256
var_op='asgn
I
obj='Var
obj_type='D
pag=30
prev=O6255
var_op='asgn
I
obj='Var
pag=30
prev=O6254
var_op='asgn
I
obj='Var
pag=30
prev=O6253
var_op='asgn
I
obj='Var
pag=30
prev=O6252
var_op='asgn
I
obj='Var
pag=30
prev=O6251
var_op='asgn
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=30
prev=O5985
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5986
fatherSonIndex=0
frm_calc='Substr(riga,136,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=30
prev=O6263
var_op='asgn
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=30
prev=O5984
var_op='asgn
I
obj='Var
pag=30
prev=O5981
var_op='asgn
I
obj='If
pag=30
prev=O5980
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5981
fatherSonIndex=0
frm_calc='Substr(riga,230,30)
len=30
name='xCitta
next=Icpitembatch.CPRead
arch='tbcitta
obj='Read
pag=30
prev=O6268
rd_field=[
'CAB
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'xCitta
]
rd_var=[
'xCodCab
]
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=30
prev=O5979
var_op='asgn
I
obj='Var
pag=30
prev=O5978
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O5975
var_op='asgn
I
obj='If
pag=30
prev=O5974
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5975
fatherSonIndex=0
frm_calc='iif(LRTrim(Substr(riga,458,1))='1',1,0)
len=1
name='xCFE
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5975
fatherSonIndex=1
frm_calc='iif(LRTrim(Substr(riga,458,1))='S',1,0)
len=1
name='xCFE
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=30
prev=O5973
var_op='asgn
I
obj='Var
pag=30
prev=O5972
var_op='asgn
I
obj='Read
pag=30
prev=O5971
rd_field=[
'FLGVALIDO
'FLGANAVAL
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'cCli1
]
rd_var=[
'_flgvali
'_flganag
]
I
obj='Var
pag=30
prev=O5970
var_op='asgn
I
obj='Var
pag=30
prev=O5969
var_op='asgn
I
obj='Read
pag=30
prev=O5967
rd_field=[
'CONNES
'CFESTERO
'CODFISC
'COGNOME
'NOME
'RAGSOC
'NASCOMUN
'NASSTATO
'DATANASC
'TIPINTER
'SESSO
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'cCli1
]
rd_var=[
'xConnes
'_oldest
'_oldcf
'_oldcog
'_oldnom
'_oldrgs
'_oldncm
'_oldnst
'_oldndt
'_oldnpv
'_oldnsx
]
I
obj='Begin
pag=30
prev=O5966
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5967
fatherSonIndex=0
frm_calc='0
len=1
name='_oldest
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_oldcf
next=Icpitembatch.CPVarDecl
frm_calc='''
len=26
name='_oldcog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=26
name='_oldnom
next=Icpitembatch.CPVarDecl
frm_calc='''
len=70
name='_oldrgs
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_oldncm
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_oldnst
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_oldndt
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_oldnpv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_oldnsx
obj='Var
pag=30
prev=O6299
var_op='asgn
I
obj='Var
pag=30
prev=O6298
var_op='asgn
I
obj='Var
obj_type='D
pag=30
prev=O6297
var_op='asgn
I
obj='Var
pag=30
prev=O6296
var_op='asgn
I
obj='Var
pag=30
prev=O6295
var_op='asgn
I
obj='Var
pag=30
prev=O6294
var_op='asgn
I
obj='Var
pag=30
prev=O6293
var_op='asgn
I
obj='Var
pag=30
prev=O6292
var_op='asgn
I
obj='Var
pag=30
prev=O6291
var_op='asgn
I
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=30
prev=O5965
I
obj='Var
pag=30
prev=O5964
var_op='asgn
I
obj='Var
pag=30
prev=O5963
var_op='asgn
I
obj='Var
pag=30
prev=O5962
var_op='asgn
I
obj='Var
pag=30
prev=O5961
var_op='asgn
I
obj='Var
pag=30
prev=O5960
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O5959
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O5958
var_op='asgn
I
obj='Var
pag=30
prev=O5957
var_op='asgn
I
obj='Var
obj_type='D
pag=30
prev=O5956
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O5955
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O5954
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O5953
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O5952
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O5951
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O5948
var_op='asgn
I
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5948
fatherSonIndex=0
frm_calc='Substr(riga,112,16)
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,496,16)
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xConnes)
]
h=[
19
19
]
obj='If
pag=30
prev=O6306
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='personbo
father=O6307
fatherSonIndex=0
obj='Insert
pag=30
rd_kfield=[
'CONNES
]
rd_kvar=[
'_conadd
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=30
prev=O6305
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'_conadd
]
rd_var=[
'xConnes
]
I
obj='Var
pag=30
prev=O6304
var_op='asgn
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=30
prev=O5886
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
rd_var=[
'nProgSto
]
I
obj='Read
pag=30
prev=O5885
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
rd_var=[
'nProgImp
]
I
obj='Var
obj_type='N
pag=30
prev=O5884
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O5883
var_op='asgn
I
obj='Var
pag=30
prev=O5882
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O5881
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O5880
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O5879
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O5878
var_op='asgn
I
obj='Var
obj_type='N
pag=30
var_op='asgn
x=8
y=16
I
Icpitembatch.CPRemark
frm_calc='Inserisce priorità sui nomi file
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=27
prev=O6331
sel_name='tmp_list_imprich
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O6332
fatherSonIndex=0
frm_calc=[
'At('archdip.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('archpers.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('archrap.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('archinf.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('archope.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('archfraz.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('opex.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('archtito.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('procdel.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('sogope.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('intest.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('stopers.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('persnew.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('rapage.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('infage.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('intage.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('opeage.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('procage.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('sogcli.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('sogben.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('sogaltro.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('saldopex.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0 or At('saldopex.xls',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('saldrapp.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0 or At('saldrapp.xls',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('titosupp.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
]
h=[
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
]
next=Icpitembatch.CPWrite
arch='tmp_list_imprich
obj='Write
pag=27
prev=O6336
rd_kfield=[
'nomefile
]
rd_kop=[
'=
]
rd_kvar=[
'tmp_list_imprich->nomefile
]
wr_field=[
'priorita
]
wr_op=[
'=
]
wr_var=[
'_priorita
]
I
obj='Case
pag=27
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6336
fatherSonIndex=0
frm_calc='1
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6336
fatherSonIndex=1
frm_calc='2
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6336
fatherSonIndex=2
frm_calc='5
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6336
fatherSonIndex=3
frm_calc='6
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6336
fatherSonIndex=4
frm_calc='7
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6336
fatherSonIndex=5
frm_calc='8
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6336
fatherSonIndex=6
frm_calc='9
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6336
fatherSonIndex=7
frm_calc='10
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6336
fatherSonIndex=8
frm_calc='11
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6336
fatherSonIndex=9
frm_calc='12
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6336
fatherSonIndex=10
frm_calc='13
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6336
fatherSonIndex=11
frm_calc='3
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6336
fatherSonIndex=12
frm_calc='4
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6336
fatherSonIndex=13
frm_calc='14
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6336
fatherSonIndex=14
frm_calc='15
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6336
fatherSonIndex=15
frm_calc='16
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6336
fatherSonIndex=16
frm_calc='17
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6336
fatherSonIndex=17
frm_calc='18
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6336
fatherSonIndex=18
frm_calc='19
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6336
fatherSonIndex=19
frm_calc='20
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6336
fatherSonIndex=20
frm_calc='21
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6336
fatherSonIndex=21
frm_calc='22
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6336
fatherSonIndex=22
frm_calc='23
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6336
fatherSonIndex=23
frm_calc='24
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
]
w=[
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=27
x=18
y=21
I
Icpitembatch.CPBeginEnd
comment='Definizione variabili locali
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Aggiorna le righe
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=31
prev=O6399
sel_field='*
sel_name='aeoprig
sel_where='aeoprig->CONNESINT=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6400
fatherSonIndex=0
frm_calc=[
'Year(aeoprig->ADATA) = w_annorif or w_annorif=0
]
h=[
19
19
]
obj='If
pag=31
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6404
fatherSonIndex=0
frm_calc=[
'_oldest = _newest
]
h=[
19
19
19
]
haselse=True
obj='If
pag=31
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6409
fatherSonIndex=0
frm_calc=[
'not(Empty(aeoprig->APROG))
]
h=[
19
19
]
obj='If
pag=31
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6414
fatherSonIndex=0
frm_calc='''
len=10
name='_opep
next=Icpitembatch.CPRead
arch='aeopcanc
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_opep))
]
h=[
19
19
]
obj='If
pag=31
prev=O6420
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6421
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOAGE\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProg
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='cIDBase
next=Icpitembatch.CPInsert
arch='aeopstor
next=Icpitembatch.CPWrite
arch='aeoprig
obj='Write
pag=31
prev=O6428
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'aeoprig->IDBASE
]
wr_field=[
'AOLDPROG
'AOLDFILE
'ADATARET
'RSPEDITO
'COLDPROG
'COLDFILE
]
wr_op=[
'=
'=
'=
'=
'=
'=
]
wr_var=[
'aeoprig->APROG
'aeoprig->AFILE
'Date()
'0
'''
'''
]
I
obj='Insert
pag=31
prev=O6427
rd_kfield=[
'PROGRES
'IDBASE
'RAPPORTO
'CONNESINT
'ASPEDITO
'ADATA
'APROG
'AOLDPROG
'AFILE
'AOLDFILE
'ADATARET
'CSPEDITO
'CDATA
'CPROG
'COLDPROG
'CFILE
'COLDFILE
'CDATARET
'IDRIF
'NOCODFISC
'ADTPRE
'CDTPRE
'TIPOAG
'COINT
'PROGOPX
'ABBINATO
'IDESITO
'DATESITO
'RSPEDITO
'SALDO
'QUANTITA
'VALUTA
'ANNO
'PROG1
'PROG2
'ESITOANNO
'UNIQUECODE
'PROGREC
'PROGBASE
'FILEANNO
'ABBSALDI
'OLDINTER
'ANNOOPE
]
rd_kvar=[
'cProg
'aeoprig->IDBASE
'aeoprig->RAPPORTO
'aeoprig->CONNESINT
'aeoprig->ASPEDITO
'aeoprig->ADATA
'aeoprig->APROG
'aeoprig->AOLDPROG
'aeoprig->AFILE
'aeoprig->AOLDFILE
'aeoprig->ADATARET
'aeoprig->CSPEDITO
'aeoprig->CDATA
'aeoprig->CPROG
'aeoprig->COLDPROG
'aeoprig->CFILE
'aeoprig->COLDFILE
'aeoprig->CDATARET
'aeoprig->IDRIF
'aeoprig->NOCODFISC
'aeoprig->ADTPRE
'aeoprig->CDTPRE
'aeoprig->TIPOAG
'aeoprig->COINT
'aeoprig->PROGOPX
'aeoprig->ABBINATO
'aeoprig->IDESITO
'aeoprig->DATESITO
'aeoprig->RSPEDITO
'aeoprig->SALDO
'aeoprig->QUANTITA
'aeoprig->VALUTA
'aeoprig->ANNO
'aeoprig->PROG1
'aeoprig->PROG2
'aeoprig->ESITOANNO
'aeoprig->UNIQUECODE
'aeoprig->PROGREC
'aeoprig->PROGBASE
'aeoprig->FILEANNO
'aeoprig->ABBSALDI
'aeoprig->OLDINTER
'aeoprig->ANNOOPE
]
I
obj='Var
pag=31
pagelocal=True
prev=O6426
var_op='asgn
I
obj='Var
pag=31
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=31
prev=O6419
rd_field=[
'PROGRES
]
rd_kfield=[
'IDBASE
]
rd_kvar=[
'aeoprig->IDBASE
]
rd_var=[
'_opep
]
I
obj='Var
pag=31
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6409
fatherSonIndex=1
frm_calc=[
'aeoprig->ASPEDITO=0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=31
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aeoprig
father=O6445
fatherSonIndex=0
obj='Write
pag=31
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'aeoprig->IDBASE
]
wr_field=[
'NOCODFISC
]
wr_op=[
'=
]
wr_var=[
'iif(_newest=1,'S','N')
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6445
fatherSonIndex=1
frm_calc='''
len=10
name='_opep
next=Icpitembatch.CPRead
arch='aeopcanc
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_opep)
]
h=[
19
19
]
obj='If
pag=31
prev=O6459
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6460
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOAGE\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProg
next=Icpitembatch.CPInsert
arch='aeopstor
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PDELAGE\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cCanc
next=Icpitembatch.CPInsert
arch='aeopcanc
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGAEOPEXTR\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='_prog
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGAED\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aeoprig
next=Icpitembatch.CPWrite
arch='opextrbo
obj='Write
pag=31
prev=O6471
rd_kfield=[
'COLLEG
'DATAOPE
]
rd_kop=[
'=
'=
]
rd_kvar=[
'aeoprig->CONNESINT
'aeoprig->ADATA
]
wr_field=[
'NUMPROG1
]
wr_op=[
'=
]
wr_var=[
'_prog
]
I
obj='Insert
pag=31
prev=O6470
rd_kfield=[
'IDBASE
'CONNESINT
'ADATA
'TIPOAG
'COINT
'PROGOPX
'NOCODFISC
'ANNOOPE
]
rd_kvar=[
'_prog
'aeoprig->CONNESINT
'aeoprig->ADATA
'aeoprig->TIPOAG
'aeoprig->COINT
'nProgImp
'iif(_newest=1,'S','N')
'Year(aeoprig->ADATA)
]
I
obj='Var
obj_type='N
pag=31
prev=O6469
var_op='asgn
I
obj='Var
pag=31
pagelocal=True
prev=O6468
var_op='asgn
I
obj='Insert
pag=31
prev=O6467
rd_kfield=[
'ADATA
'ADATARET
'AFILE
'APROG
'ASPEDITO
'CDATA
'CDATARET
'CFILE
'COLDPROG
'COINT
'COLDFILE
'CONNESINT
'CPROG
'CSPEDITO
'DATARIF
'IDBASE
'IDRIF
'NOCODFISC
'PROGRES
'RAPPORTO
'RIFSTOR
'TIPOAG
'TIPOCAN
]
rd_kvar=[
'aeoprig->ADATA
'Date()
'aeoprig->AFILE
'aeoprig->APROG
'aeoprig->ASPEDITO
'aeoprig->CDATA
'aeoprig->CDATARET
'aeoprig->CFILE
'aeoprig->COLDPROG
'aeoprig->COINT
'aeoprig->COLDFILE
'aeoprig->CONNESINT
'aeoprig->CPROG
'aeoprig->CSPEDITO
'Date()
'aeoprig->IDBASE
'aeoprig->IDRIF
'aeoprig->NOCODFISC
'cCanc
'aeoprig->RAPPORTO
'cProg
'aeoprig->TIPOAG
''C'
]
I
obj='Var
pag=31
pagelocal=True
prev=O6466
var_op='asgn
I
obj='Insert
pag=31
prev=O6465
rd_kfield=[
'PROGRES
'IDBASE
'RAPPORTO
'CONNESINT
'ASPEDITO
'ADATA
'APROG
'AOLDPROG
'AFILE
'AOLDFILE
'ADATARET
'CSPEDITO
'CDATA
'CPROG
'COLDPROG
'CFILE
'COLDFILE
'CDATARET
'IDRIF
'NOCODFISC
'ADTPRE
'CDTPRE
'TIPOAG
'COINT
'PROGOPX
'ABBINATO
'IDESITO
'DATESITO
'RSPEDITO
'SALDO
'QUANTITA
'VALUTA
'ANNO
'PROG1
'PROG2
'ESITOANNO
'UNIQUECODE
'PROGREC
'PROGBASE
'FILEANNO
'ABBSALDI
'OLDINTER
'ANNOOPE
]
rd_kvar=[
'cProg
'aeoprig->IDBASE
'aeoprig->RAPPORTO
'aeoprig->CONNESINT
'aeoprig->ASPEDITO
'aeoprig->ADATA
'aeoprig->APROG
'aeoprig->AOLDPROG
'aeoprig->AFILE
'aeoprig->AOLDFILE
'aeoprig->ADATARET
'aeoprig->CSPEDITO
'aeoprig->CDATA
'aeoprig->CPROG
'aeoprig->COLDPROG
'aeoprig->CFILE
'aeoprig->COLDFILE
'aeoprig->CDATARET
'aeoprig->IDRIF
'aeoprig->NOCODFISC
'aeoprig->ADTPRE
'aeoprig->CDTPRE
'aeoprig->TIPOAG
'aeoprig->COINT
'aeoprig->PROGOPX
'aeoprig->ABBINATO
'aeoprig->IDESITO
'aeoprig->DATESITO
'aeoprig->RSPEDITO
'aeoprig->SALDO
'aeoprig->QUANTITA
'aeoprig->VALUTA
'aeoprig->ANNO
'aeoprig->PROG1
'aeoprig->PROG2
'aeoprig->ESITOANNO
'aeoprig->UNIQUECODE
'aeoprig->PROGREC
'aeoprig->PROGBASE
'aeoprig->FILEANNO
'aeoprig->ABBSALDI
'aeoprig->OLDINTER
'aeoprig->ANNOOPE
]
I
obj='Var
pag=31
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=31
prev=O6458
rd_field=[
'PROGRES
]
rd_kfield=[
'AFILE
'APROG
]
rd_kvar=[
'aeoprig->AFILE
'aeoprig->APROG
]
rd_var=[
'_opep
]
I
obj='Var
pag=31
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=31
prev=O6397
I
obj='Begin
pag=31
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6397
fatherSonIndex=0
len=10
name='cProg
next=Icpitembatch.CPVarDecl
len=10
name='cIDBase
next=Icpitembatch.CPVarDecl
len=10
name='_opep
next=Icpitembatch.CPVarDecl
len=10
name='cCanc
next=Icpitembatch.CPVarDecl
len=10
name='_prog
obj='Var
pag=31
pagelocal=True
prev=O6499
I
obj='Var
pag=31
pagelocal=True
prev=O6498
I
obj='Var
pag=31
pagelocal=True
prev=O6497
I
obj='Var
pag=31
pagelocal=True
prev=O6496
I
obj='Var
pag=31
pagelocal=True
I
I
]
w=[
150
150
]
x=9
y=17
I
Icpitembatch.CPBeginEnd
comment='Definizine variabili locali
h=[
19
19
]
next=Icpitembatch.CPDropTemporaryTable
next=Icpitembatch.CPServerTemporaryTable
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=32
prev=O6505
sel_field='*
sel_name='tmp_list_imprich
sel_order='tmp_list_imprich->priorita,tmp_list_imprich->nomefile
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6506
fatherSonIndex=0
frm_calc='LRTrim(tmp_list_imprich->nomefile)
len=50
name='nomefileimport
next=Icpitembatch.CPIfElse
frm_calc=[
'At('archpers.txt',Lower(nomefileimport)) <> 0 or At('persnew.txt',Lower(nomefileimport)) <> 0 or At('stopers.txt',Lower(nomefileimport)) <> 0
]
h=[
19
19
]
obj='If
pag=32
prev=O6510
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6511
fatherSonIndex=0
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
obj='Exec
pag=32
prev=O6518
I
obj='While
pag=32
prev=O6517
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6518
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=32
prev=O6524
var_op='asgn
I
obj='If
pag=32
prev=O6523
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6524
fatherSonIndex=0
frm_calc='''
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='''
len=128
name='_testata
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_ferr
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati controllati '+LRTrim(Str(conta,10,0))+' nominativi del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='"Codice: "+ LRTrim(Substr(riga,112,16)) + " - Soggetto "+LRTrim(Upper(Substr(riga,7,70)))
len=128
name='_testata
next=Icpitembatch.CPBeginEnd
comment='Effettua Controlli
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_ferr = 1
]
h=[
19
19
]
obj='If
pag=32
prev=O6535
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6537
fatherSonIndex=0
frm_calc='1
len=1
name='_chkerr
next=Icpitembatch.CPInsert
arch='tmp_errimp
obj='Insert
pag=32
prev=O6542
rd_kfield=[
'nomearch
'numriga
'errore
'txtini
]
rd_kvar=[
'LRTrim(nomefileimport)
'conta
'_listaerr
'_testata
]
I
obj='Var
obj_type='N
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=32
prev=O6534
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6535
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Upper(Substr(riga,7,70))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,112,16))) and Substr(riga,450,1)<>'S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,262,3)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(Substr(riga,262,3)) = '086' or Empty(LRTrim(Substr(riga,262,3)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,166,3)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,172,3)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'At("archpers.txt",Lower(nomefileimport)) <> 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,460,10))) and not(Empty(LRTrim(Substr(riga,166,3))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,288,1)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=32
prev=O6570
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6573
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Substr(riga,136,30)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,128,8)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,175,2)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,177,15)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,192,8)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,200,30)))
]
h=[
19
19
]
obj='If
pag=32
prev=O6590
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6593
fatherSonIndex=0
frm_calc='_listaerr + "non è presente l'autorità di rilascio del documento" + NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6598
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6587
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6590
fatherSonIndex=0
frm_calc='_listaerr + "non è presente la data rilascio del documento"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6603
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6584
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6587
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il numero documento" + NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6608
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6581
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6584
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il tipo di documento"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6613
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6578
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6581
fatherSonIndex=0
frm_calc='_listaerr + "non è presente la data di nascita"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6618
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6578
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il luogo di nascita"
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6623
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6573
fatherSonIndex=1
frm_calc=[
'not(Empty(LRTrim(Substr(riga,136,30))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,128,8))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,175,2))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,177,15))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,192,8))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,200,30))))
]
h=[
19
19
]
obj='If
pag=32
prev=O6639
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6642
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente l'autorità di rilascio del documento" + NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6647
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6636
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6639
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente la data rilascio del documento"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6652
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6633
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6636
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente il numero documento" + NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6657
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6630
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6633
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente il tipo di documento"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6662
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6627
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6630
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente la data di nascita"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6667
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6627
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente il luogo di nascita"
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6672
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=32
prev=O6567
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6570
fatherSonIndex=0
frm_calc='''
len=1
name='_tiposot
next=Icpitembatch.CPRead
arch='tbstgru
next=Icpitembatch.CPIfElse
frm_calc=[
'_tiposot='1'
]
h=[
19
19
]
obj='If
pag=32
prev=O6679
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6680
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice ATECO"
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6685
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=32
prev=O6678
rd_field=[
'TIPOSOT
]
rd_kfield=[
'SOTGRU
]
rd_kvar=[
'Substr(riga,166,3)
]
rd_var=[
'_tiposot
]
I
obj='Var
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6564
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6567
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Substr(riga,460,10))) and Empty(LRTrim(Substr(riga,288,1)))
]
h=[
19
19
]
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6695
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice Ateco"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6700
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6567
fatherSonIndex=1
frm_calc=[
'Empty(LRTrim(Substr(riga,468,10))) and Empty(LRTrim(Substr(riga,288,1)))
]
h=[
19
19
]
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6704
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice Ateco"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6709
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=32
prev=O6561
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6564
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice Settorizzazione sintetica"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6715
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6558
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6561
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice SAE"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6720
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6555
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6558
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Substr(riga,1,6))) and Empty(LRTrim(Substr(riga,230,30)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,230,30)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,260,2)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,77,35)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,265,9)))
]
h=[
19
19
]
obj='If
pag=32
prev=O6734
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6737
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il cap di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6742
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6731
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6734
fatherSonIndex=0
frm_calc='_listaerr + "non è presente l'indirizzo di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6747
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6728
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6731
fatherSonIndex=0
frm_calc='_listaerr + "non è presente la provincia di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6752
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6725
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6728
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il comune di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6757
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6725
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice CAB (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6762
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6552
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O6555
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice stato di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6768
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6549
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6552
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice fiscale (ASSOLUTAMENTE OBBLIGATORIO)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6773
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O6549
fatherSonIndex=0
frm_calc='_listaerr + " non è presente la ragione sociale (ASSOLUTAMENTE OBBLIGATORIO)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6778
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=32
pagelocal=True
prev=O6533
var_op='asgn
I
nonlocal=True
obj='Var
pag=32
prev=O6532
var_op='asgn
I
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6531
var_op='asgn
I
obj='Var
pag=32
pagelocal=True
prev=O6530
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=32
prev=O6516
var_op='asgn
I
obj='Var
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='TempTable
pag=32
prev=O6504
sel_type='def
server_table='tmp_errimp
I
obj='DropTempTable
pag=32
prev=O6502
server_table='tmp_errimp
I
obj='Begin
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6502
fatherSonIndex=0
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
len=128
name='_testata
next=Icpitembatch.CPVarDecl
len=1
name='_ferr
next=Icpitembatch.CPVarDecl
len=1
name='_tiposot
obj='Var
pag=32
pagelocal=True
prev=O6790
I
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6789
I
obj='Var
pag=32
pagelocal=True
prev=O6788
I
obj='Var
obj_type='M
pag=32
pagelocal=True
I
I
]
w=[
150
150
]
x=17
y=18
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'Lower(LRTrim(nomefileimport))='saldopex.txt'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Saldi operazioni extraconto Inseriti: '+LRTrim(Str(cNumNew,10,0))  +  NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Saldi operazioni extraconto Aggiornati: '+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O6802
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O6801
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O6800
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O6797
var_op='asgn
I
obj='If
pag=33
prev=O6796
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6797
fatherSonIndex=0
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
obj='Exec
pag=33
prev=O6809
I
obj='Exec
pag=33
prev=O6807
I
obj='While
pag=33
prev=O6806
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6807
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record dei saldi opex del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=33
prev=O6817
var_op='asgn
I
nonlocal=True
obj='Var
pag=33
prev=O6814
var_op='asgn
I
obj='If
pag=33
prev=O6813
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6814
fatherSonIndex=0
frm_calc='Substr(riga,1,16)
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Val(Substr(riga,21,17))=0 and Val(Substr(riga,38,6))=0 and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Val(Substr(riga,21,17))=0 and Val(Substr(riga,38,6)) <> 0 and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Val(Substr(riga,21,17))<>0 and Val(Substr(riga,38,6))=0 and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub = 1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=33
prev=O6838
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O6841
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=33
prev=O6846
var_op='asgn
I
obj='Write
pag=33
rd_kfield=[
'COLLEG
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,16)
'Substr(riga,17,4)
]
wr_field=[
'SALDO
'QUANTITA
'VALUTA
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Val(Substr(riga,21,17))
'Val(Substr(riga,38,6))
'iif(Empty(LRTrim(Substr(riga,44,3))),'242',Substr(riga,44,3))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6841
fatherSonIndex=1
frm_calc='1
len=1
name='_soxerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(shand,riga+" - "+_descerr)
obj='Exec
pag=33
prev=O6855
I
obj='Var
obj_type='N
pag=33
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=33
prev=O6835
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6838
fatherSonIndex=0
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPRead
arch='opextrbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
]
obj='If
pag=33
prev=O6861
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6862
fatherSonIndex=0
frm_calc='"Assente operazione extraconto per l'anno indicato"
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O6867
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=33
prev=O6860
rd_field=[
'IDBASE
]
rd_kfield=[
'COLLEG
'ANNO
]
rd_kvar=[
'cCli1
'Substr(riga,17,4)
]
rd_var=[
'xIDB
]
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=33
prev=O6832
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6835
fatherSonIndex=0
frm_calc=''Numero Operazioni non valorizzato'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O6877
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=33
prev=O6829
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6832
fatherSonIndex=0
frm_calc=''Saldo non valorizzato'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O6882
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=33
prev=O6826
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6829
fatherSonIndex=0
frm_calc=''Saldo e Numero operazioni entrambi non valorizzati'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O6887
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=33
prev=O6825
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6826
fatherSonIndex=0
frm_calc=''Anagrafica soggetto non presente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O6892
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=33
prev=O6824
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,1,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=33
prev=O6823
var_op='asgn
I
obj='Var
pag=33
prev=O6822
var_op='asgn
I
obj='Var
obj_type='N
pag=33
prev=O6821
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=33
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Apro il foglio e verifico quante pagine ha
father=O6797
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='_i = 0
next=Icpitembatch.CPWhile
frm_calc='_i < _conta
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='workbook.close()
obj='Exec
pag=33
prev=O6905
I
obj='While
pag=33
prev=O6904
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O6905
fatherSonIndex=0
frm_calc='_righe = 0;﷯Sheet sheet = workbook.getSheet(_i);﷯_righe = sheet.getRows();﷯_y = 1;
next=Icpitembatch.CPWhile
frm_calc='_y < _righe
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=33
prev=O6911
I
obj='While
pag=33
prev=O6910
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Legge le colonne e scrive i dati nelle variabili appoggio
father=O6911
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column06)))
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_y++;
obj='Exec
pag=33
prev=O6918
I
obj='If
pag=33
prev=O6916
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O6918
fatherSonIndex=0
frm_calc=''Elaborazione Foglio N.'+LRTrim(Str(_i+1,2,0))+' - Riga N. '+LRTrim(Str(_y+1,7,0))+' - Rapporto N. : '+LRTrim(column01)
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPRead
arch='opextrbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record dei saldi opex del file '+nomefileimport
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=33
prev=O6927
var_op='asgn
I
obj='If
pag=33
prev=O6926
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O6927
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGOPEX\'"+LRTrim(gAzienda)+"'",0,10)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='opextrbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=33
prev=O6935
var_op='asgn
I
obj='Insert
pag=33
prev=O6934
rd_kfield=[
'COLLEG
'ANNO
'IDBASE
'SALDO
'QUANTITA
'VALUTA
'PROGOPEX
]
rd_kvar=[
'Left(LRTrim(column01),16)
'Left(LRTrim(column02),4)
'xIDB
'Val(LRTrim(column03))
'Val(LRTrim(column04))
'iif(Empty(LRTrim(column05)),'242',Left(LRTrim(column05),3))
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6935
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,1,16)+" per l'operazione extraconto in data: "+Substr(riga,21,8)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=33
prev=O6944
I
obj='Var
obj_type='N
pag=33
prev=O6943
var_op='asgn
I
obj='Exec
pag=33
prev=O6942
I
nonlocal=True
obj='Var
obj_type='M
pag=33
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=33
prev=O6933
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O6927
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=33
prev=O6948
var_op='asgn
I
obj='Write
pag=33
rd_kfield=[
'COLLEG
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(LRTrim(column01),16)
'Left(LRTrim(column02),4)
]
wr_field=[
'SALDO
'QUANTITA
'VALUTA
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Val(LRTrim(column03))
'Val(LRTrim(column04))
'iif(Empty(LRTrim(column05)),'242',Left(LRTrim(column05),3))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=33
prev=O6925
rd_field=[
'IDBASE
]
rd_kfield=[
'COLLEG
'ANNO
]
rd_kvar=[
'Left(LRTrim(column01),16)
'Left(LRTrim(column02),4)
]
rd_var=[
'xIDB
]
I
obj='Var
pag=33
prev=O6924
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=33
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O6916
fatherSonIndex=0
frm_calc='// Legge il contenuto delle celle﷯Cell a01 = sheet.getCell(0,_y);﷯Cell a02 = sheet.getCell(1,_y);﷯Cell a03 = sheet.getCell(2,_y);﷯Cell a04 = sheet.getCell(3,_y);﷯Cell a05 = sheet.getCell(4,_y);﷯Cell a06 = sheet.getCell(5,_y);
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
obj='Begin
pag=33
prev=O6964
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6965
fatherSonIndex=0
frm_calc='a01.getContents()
len=25
name='column01
next=Icpitembatch.CPVarDecl
frm_calc='a02.getContents()
len=25
name='column02
next=Icpitembatch.CPVarDecl
frm_calc='a03.getContents()
len=25
name='column03
next=Icpitembatch.CPVarDecl
frm_calc='a04.getContents()
len=25
name='column04
next=Icpitembatch.CPVarDecl
frm_calc='a05.getContents()
len=25
name='column05
next=Icpitembatch.CPVarDecl
frm_calc='a06.getContents()
len=25
name='column06
obj='Var
pag=33
prev=O6973
var_op='asgn
I
obj='Var
pag=33
prev=O6972
var_op='asgn
I
obj='Var
pag=33
prev=O6971
var_op='asgn
I
obj='Var
pag=33
prev=O6970
var_op='asgn
I
obj='Var
pag=33
prev=O6969
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Exec
pag=33
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=33
I
I
]
w=[
150
150
]
I
obj='Exec
pag=33
prev=O6902
I
obj='Begin
pag=33
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O6902
fatherSonIndex=0
frm_calc='//base﷯Workbook workbook = Workbook.getWorkbook(new File(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(gAzienda)+"/"+CPLib.LRTrim(nomefileimport)));﷯_conta = workbook.getNumberOfSheets();
obj='Exec
pag=33
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O6795
var_op='asgn
I
obj='Var
obj_type='N
pag=33
prev=O6794
var_op='asgn
I
obj='Var
obj_type='N
pag=33
prev=O6793
var_op='asgn
I
obj='Remark
pag=33
x=12
y=20
I
Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOCLI\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
obj='Var
obj_type='N
pag=30
var_op='asgn
x=1165
y=1413
I
Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
obj='Var
pag=30
pagelocal=True
var_op='asgn
x=954
y=2841
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
len=2
name='_tipoag
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'Lower(LRTrim(nomefileimport))='saldrapp.txt'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Saldi Rapporti Creati: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Saldi Rapporti Aggiornati: '+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O6996
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O6995
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O6994
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O6991
var_op='asgn
I
obj='If
pag=34
prev=O6990
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O6991
fatherSonIndex=0
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
obj='Exec
pag=34
prev=O7003
I
obj='Exec
pag=34
prev=O7001
I
obj='While
pag=34
prev=O7000
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7001
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,25)
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_tipoag
next=Icpitembatch.CPRead
arch='aetesta
next=Icpitembatch.CPRead
arch='aeannora
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPWrite
arch='aetesta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record dei saldi rapporti del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=34
prev=O7017
var_op='asgn
I
nonlocal=True
obj='Var
pag=34
prev=O7016
var_op='asgn
I
obj='Write
pag=34
prev=O7013
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'VALUTA
'CAB
]
wr_op=[
'=
'=
]
wr_var=[
'iif(Empty(LRTrim(Substr(riga,104,3))),'242',Substr(riga,104,3))
'Substr(riga,107,5)
]
I
obj='If
pag=34
prev=O7012
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O7013
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGSAR\'"+LRTrim(gAzienda)+"'",0,10)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aeannora
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=34
prev=O7029
var_op='asgn
I
obj='Insert
pag=34
prev=O7028
rd_kfield=[
'RAPPORTO
'ANNO
'IDBASE
'IMPORTO1
'IMPORTO2
'IMPORTO3
'IMPORTO4
'IMPORTO5
'TIPRAP
]
rd_kvar=[
'xRapporto
'Substr(riga,26,4)
'xIDB
'Val(Substr(riga,30,17))
'Val(Substr(riga,47,17))
'Val(Substr(riga,64,17))
'Val(Substr(riga,81,17))
'Val(Substr(riga,98,6))
'_tipoag
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7029
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,1,16)+" per il rapporto in data: "+Substr(riga,21,8)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=34
prev=O7038
I
obj='Var
obj_type='N
pag=34
prev=O7037
var_op='asgn
I
obj='Exec
pag=34
prev=O7036
I
nonlocal=True
obj='Var
obj_type='M
pag=34
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=34
prev=O7027
var_op='asgn
I
obj='Var
pag=34
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aeannora
father=O7013
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=34
prev=O7042
var_op='asgn
I
obj='Write
pag=34
rd_kfield=[
'RAPPORTO
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,4)
]
wr_field=[
'IMPORTO1
'IMPORTO2
'IMPORTO3
'IMPORTO4
'IMPORTO5
'TIPRAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Val(Substr(riga,30,17))
'Val(Substr(riga,47,17))
'Val(Substr(riga,64,17))
'Val(Substr(riga,81,17))
'Val(Substr(riga,98,6))
'_tipoag
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=34
prev=O7011
rd_field=[
'IDBASE
]
rd_kfield=[
'RAPPORTO
'ANNO
]
rd_kvar=[
'xRapporto
'Substr(riga,26,4)
]
rd_var=[
'xIDB
]
I
obj='Read
pag=34
prev=O7010
rd_field=[
'TIPOAG
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'xRapporto
]
rd_var=[
'_tipoag
]
I
obj='Var
pag=34
pagelocal=True
prev=O7009
var_op='asgn
I
obj='Var
pag=34
prev=O7008
var_op='asgn
I
obj='Var
pag=34
prev=O7007
var_op='asgn
I
obj='Var
obj_type='M
pag=34
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=34
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Apro il foglio e verifico quante pagine ha
father=O6991
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='_i = 0
next=Icpitembatch.CPWhile
frm_calc='_i < _conta
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='workbook.close()
obj='Exec
pag=34
prev=O7064
I
obj='While
pag=34
prev=O7063
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O7064
fatherSonIndex=0
frm_calc='_righe = 0;﷯Sheet sheet = workbook.getSheet(_i);﷯_righe = sheet.getRows();﷯_y = 1;
next=Icpitembatch.CPWhile
frm_calc='_y < _righe
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=34
prev=O7070
I
obj='While
pag=34
prev=O7069
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Legge le colonne e scrive i dati nelle variabili appoggio
father=O7070
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column11)))
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_y++;
obj='Exec
pag=34
prev=O7077
I
obj='If
pag=34
prev=O7075
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O7077
fatherSonIndex=0
frm_calc=''Elaborazione Foglio N.'+LRTrim(Str(_i+1,2,0))+' - Riga N. '+LRTrim(Str(_y+1,7,0))+' - Rapporto N. : '+LRTrim(column01)
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='column01
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_tipoag
next=Icpitembatch.CPRead
arch='aetesta
next=Icpitembatch.CPRead
arch='aeannora
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPWrite
arch='aetesta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record dei saldi rapporti del file '+nomefileimport
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=34
prev=O7092
var_op='asgn
I
obj='Write
pag=34
prev=O7089
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'VALUTA
'CAB
]
wr_op=[
'=
'=
]
wr_var=[
'iif(Empty(LRTrim(column09)),'242',Left(LRTrim(column08),3))
'Left(LRTrim(column10),5)
]
I
obj='If
pag=34
prev=O7088
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O7089
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGSAR\'"+LRTrim(gAzienda)+"'",0,10)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aeannora
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=34
prev=O7104
var_op='asgn
I
obj='Insert
pag=34
prev=O7103
rd_kfield=[
'RAPPORTO
'ANNO
'IDBASE
'IMPORTO1
'IMPORTO2
'IMPORTO3
'IMPORTO4
'IMPORTO5
'IMPORTO6
'TIPRAP
]
rd_kvar=[
'Left(LRTrim(column01),25)
'Left(LRTrim(column02),4)
'xIDB
'Val(LRTrim(column03))
'Val(LRTrim(column04))
'Val(LRTrim(column05))
'Val(LRTrim(column06))
'Val(LRTrim(column07))
'Val(LRTrim(column08))
'_tipoag
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7104
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,1,16)+" per il rapporto in data: "+Substr(riga,21,8)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=34
prev=O7113
I
obj='Var
obj_type='N
pag=34
prev=O7112
var_op='asgn
I
obj='Exec
pag=34
prev=O7111
I
nonlocal=True
obj='Var
obj_type='M
pag=34
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=34
prev=O7102
var_op='asgn
I
obj='Var
pag=34
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aeannora
father=O7089
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=34
prev=O7117
var_op='asgn
I
obj='Write
pag=34
rd_kfield=[
'RAPPORTO
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(LRTrim(column01),25)
'Left(LRTrim(column02),4)
]
wr_field=[
'IMPORTO1
'IMPORTO2
'IMPORTO3
'IMPORTO4
'IMPORTO5
'IMPORTO6
'TIPRAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Val(LRTrim(column03))
'Val(LRTrim(column04))
'Val(LRTrim(column05))
'Val(LRTrim(column06))
'Val(LRTrim(column07))
'Val(LRTrim(column08))
'_tipoag
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=34
prev=O7087
rd_field=[
'IDBASE
]
rd_kfield=[
'RAPPORTO
'ANNO
]
rd_kvar=[
'Left(LRTrim(column01),25)
'Left(LRTrim(column02),4)
]
rd_var=[
'xIDB
]
I
obj='Read
pag=34
prev=O7086
rd_field=[
'TIPOAG
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Left(LRTrim(column01),25)
]
rd_var=[
'_tipoag
]
I
obj='Var
pag=34
pagelocal=True
prev=O7085
var_op='asgn
I
obj='Var
pag=34
prev=O7084
var_op='asgn
I
obj='Var
pag=34
prev=O7083
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=34
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=34
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O7075
fatherSonIndex=0
frm_calc='// Legge il contenuto delle celle﷯Cell a01 = sheet.getCell(0,_y);﷯Cell a02 = sheet.getCell(1,_y);﷯Cell a03 = sheet.getCell(2,_y);﷯Cell a04 = sheet.getCell(3,_y);﷯Cell a05 = sheet.getCell(4,_y);﷯Cell a06 = sheet.getCell(5,_y);﷯Cell a07 = sheet.getCell(6,_y);﷯Cell a08 = sheet.getCell(7,_y);﷯Cell a09 = sheet.getCell(8,_y);﷯Cell a10 = sheet.getCell(9,_y);﷯Cell a11 = sheet.getCell(10,_y);
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
obj='Begin
pag=34
prev=O7137
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7138
fatherSonIndex=0
frm_calc='a01.getContents()
len=25
name='column01
next=Icpitembatch.CPVarDecl
frm_calc='a02.getContents()
len=25
name='column02
next=Icpitembatch.CPVarDecl
frm_calc='a03.getContents()
len=25
name='column03
next=Icpitembatch.CPVarDecl
frm_calc='a04.getContents()
len=25
name='column04
next=Icpitembatch.CPVarDecl
frm_calc='a05.getContents()
len=25
name='column05
next=Icpitembatch.CPVarDecl
frm_calc='a06.getContents()
len=25
name='column06
next=Icpitembatch.CPVarDecl
frm_calc='a07.getContents()
len=25
name='column07
next=Icpitembatch.CPVarDecl
frm_calc='a08.getContents()
len=25
name='column08
next=Icpitembatch.CPVarDecl
frm_calc='a09.getContents()
len=25
name='column09
next=Icpitembatch.CPVarDecl
frm_calc='a10.getContents()
len=25
name='column10
next=Icpitembatch.CPVarDecl
frm_calc='a11.getContents()
len=25
name='column11
obj='Var
pag=34
prev=O7151
var_op='asgn
I
obj='Var
pag=34
prev=O7150
var_op='asgn
I
obj='Var
pag=34
prev=O7149
var_op='asgn
I
obj='Var
pag=34
prev=O7148
var_op='asgn
I
obj='Var
pag=34
prev=O7147
var_op='asgn
I
obj='Var
pag=34
prev=O7146
var_op='asgn
I
obj='Var
pag=34
prev=O7145
var_op='asgn
I
obj='Var
pag=34
prev=O7144
var_op='asgn
I
obj='Var
pag=34
prev=O7143
var_op='asgn
I
obj='Var
pag=34
prev=O7142
var_op='asgn
I
obj='Var
pag=34
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Exec
pag=34
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=34
I
I
]
w=[
150
150
]
I
obj='Exec
pag=34
prev=O7061
I
obj='Begin
pag=34
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O7061
fatherSonIndex=0
frm_calc='//base﷯Workbook workbook = Workbook.getWorkbook(new File(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(gAzienda)+"/"+CPLib.LRTrim(nomefileimport)));﷯_conta = workbook.getNumberOfSheets();
obj='Exec
pag=34
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O6989
var_op='asgn
I
obj='Var
obj_type='N
pag=34
prev=O6988
var_op='asgn
I
obj='Var
obj_type='N
pag=34
prev=O6987
var_op='asgn
I
obj='Var
pag=34
pagelocal=True
prev=O6986
I
obj='Remark
pag=34
x=10
y=22
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Titolari Effettivi Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Titolari Effettivi Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=35
prev=O7172
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=35
prev=O7171
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=35
prev=O7170
var_op='asgn
I
obj='Exec
pag=35
prev=O7169
I
obj='Exec
pag=35
prev=O7167
I
obj='While
pag=35
prev=O7166
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7167
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
obj='Var
pag=35
prev=O7178
var_op='asgn
I
obj='If
pag=35
prev=O7177
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7178
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=35
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O7184
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=35
prev=O7189
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xntestit
father=O7191
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=35
prev=O7196
var_op='asgn
I
obj='Write
pag=35
rd_kfield=[
'CODCLI
'CODINTER
'RAPPORTO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'Left(riga,25)
]
wr_field=[
'DESCINTER
'DATAINI
]
wr_op=[
'=
'=
]
wr_var=[
'Substr(riga,66,30)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7191
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xntestit
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=35
prev=O7206
var_op='asgn
I
obj='Insert
pag=35
prev=O7205
rd_kfield=[
'CODCLI
'CODINTER
'DATAINI
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'Substr(riga,66,30)
'Left(riga,25)
'nProgImp
'LibreriaMit.UniqueId()
]
I
obj='Var
obj_type='N
pag=35
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=35
sel_field='xntestit->IDBASE
sel_name='xntestit
sel_where='xntestit->CODCLI=Substr(riga,26,16) and xntestit->CODINTER=Substr(riga,42,16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7189
fatherSonIndex=0
frm_calc='1
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=35
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O7184
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=35
prev=O7216
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestit
father=O7218
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=35
prev=O7223
var_op='asgn
I
obj='Write
pag=35
rd_kfield=[
'CODCLI
'CODINTER
'RAPPORTO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'Left(riga,25)
]
wr_field=[
'DESCINTER
'DATAINI
]
wr_op=[
'=
'=
]
wr_var=[
'Substr(riga,66,30)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7218
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='intestit
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=35
prev=O7233
var_op='asgn
I
obj='Insert
pag=35
prev=O7232
rd_kfield=[
'CODCLI
'CODINTER
'DATAINI
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
'STATOREG
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'Substr(riga,66,30)
'Left(riga,25)
'nProgImp
'LibreriaMit.UniqueId()
''0'
]
I
obj='Var
obj_type='N
pag=35
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=35
sel_field='intestit->IDBASE
sel_name='intestit
sel_where='intestit->CODCLI=Substr(riga,26,16) and intestit->CODINTER=Substr(riga,42,16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7216
fatherSonIndex=0
frm_calc='1
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=35
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=35
prev=O7176
var_op='asgn
I
obj='Var
obj_type='M
pag=35
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=35
prev=O7165
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=35
prev=O7164
var_op='asgn
I
obj='Var
obj_type='N
pag=35
prev=O7163
var_op='asgn
I
obj='Var
obj_type='N
pag=35
prev=O7162
var_op='asgn
I
obj='Remark
pag=35
x=13
y=21
I
Icpitembatch.CPExec
check='man
frm_calc='// Create a buffer for reading the files﷯    byte[] buf = new byte[1024];﷯    ﷯    try {﷯        // Create the ZIP file﷯        String outFilename = cNomeFileZip;﷯        java.util.zip.ZipOutputStream out = new java.util.zip.ZipOutputStream(new java.io.FileOutputStream(outFilename));﷯    ﷯        // Compress the files﷯        for (int i=0; i<filenames.size(); i++) {﷯            _file1=(String)filenames.elementAt(i);﷯            _file2=(String)fileonames.elementAt(i);﷯            java.io.FileInputStream in = new java.io.FileInputStream(_file1);﷯    ﷯            // Add ZIP entry to output stream.﷯            out.putNextEntry(new java.util.zip.ZipEntry(_file2));﷯    ﷯            // Transfer bytes from the file to the ZIP file﷯            int len;﷯            while ((len = in.read(buf)) > 0) {﷯                out.write(buf, 0, len);﷯            }﷯    ﷯            // Complete the entry﷯            out.closeEntry();﷯            in.close();﷯            FileLibMit.DeleteFile(CPLib.LRTrim(gPathApp)+"/output/"+CPLib.LRTrim(gAzienda)+"/"+CPLib.LRTrim(_file2));﷯        }﷯    ﷯        // Complete the ZIP file﷯        out.close();﷯        filenames.removeAllElements();﷯        fileonames.removeAllElements();﷯    } catch (java.io.IOException e) {﷯    }﷯
obj='Exec
pag=36
x=15
y=21
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPBeginEnd
comment='Apro il foglio e verifico quante pagine ha
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='_i = 0
next=Icpitembatch.CPWhile
frm_calc='_i < _conta
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='workbook.close()
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Modificate: '+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=37
prev=O7259
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=37
prev=O7258
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=37
prev=O7257
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=37
prev=O7256
var_op='asgn
I
obj='Exec
pag=37
prev=O7254
I
obj='While
pag=37
prev=O7253
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O7254
fatherSonIndex=0
frm_calc='_righe = 0;﷯Sheet sheet = workbook.getSheet(_i);﷯_righe = sheet.getRows();﷯_y = 1;
next=Icpitembatch.CPWhile
frm_calc='_y < _righe
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=37
prev=O7264
I
obj='While
pag=37
prev=O7263
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Legge le colonne e scrive i dati nelle variabili appoggio
father=O7264
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPExec
check='man
frm_calc='_y++;
obj='Exec
pag=37
prev=O7275
I
obj='If
pag=37
prev=O7273
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O7275
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column28)))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(column34)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc='_flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(column36)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(LRTrim(column01))))) or Empty(LRTrim(_numprog))
]
h=[
19
19
]
obj='If
pag=37
prev=O7298
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7301
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(LRTrim(column01))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPCase
frm_calc=[
'LRTrim(column16)='S' or LRTrim(column16)='1' or LRTrim(column16)='7'
'LRTrim(column16)='E' or LRTrim(column16)='3' or LRTrim(column16)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Left(column15,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPVarDecl
frm_calc='iif(LRTrim(column02)='1' or LRTrim(column02)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column32)),'0',iif(LRTrim(column32)='S','1',iif(LRTrim(column32)='N','1',LRTrim(column32))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(LRTrim(column24))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column06)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_z
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='operazbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_oldidb)))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=37
prev=O7335
var_op='asgn
I
obj='If
pag=37
prev=O7333
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O7335
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='sogopebo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='clientiope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='beneficope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='terzistiope
obj='Delete
pag=37
prev=O7350
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=37
prev=O7349
sel_field='*
sel_name='terzistiope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistiope
father=O7350
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'cOpeProg1
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=37
prev=O7347
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=37
prev=O7346
sel_field='*
sel_name='beneficope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficope
father=O7347
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
]
rd_kvar=[
'cOpeProg1
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=37
prev=O7344
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=37
prev=O7343
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O7344
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=37
prev=O7341
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=37
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sogopebo
father=O7341
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7335
fatherSonIndex=1
frm_calc=[
'Empty(LRTrim(column21)) and not(Empty(LRTrim(column12)))
]
h=[
19
19
]
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O7390
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=37
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=LRTrim(column12)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7395
fatherSonIndex=0
frm_calc=[
'LRTrim(intestbo->CODINTER) <> LRTrim(column21)
]
h=[
19
19
]
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O7399
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'RAPCOL
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
'LRTrim(column12)
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=37
prev=O7331
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
]
rd_kvar=[
'LRTrim(column42)
'Val(Right(LRTrim(column01),4))
'arfn_conv_stato_uic(Left(LRTrim(column40),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'LRTrim(column62)
'_bensta
'Val(LRTrim(column23)) / 10000
'Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2)
'Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2)
'DateToChar(_datareg)
'LRTrim(column03)
'_intercab
'LRTrim(column10)
'column28
'LRTrim(column06)
'_intercod
'LRTrim(column04)
'LRTrim(column50)
'LRTrim(column33)
'LRTrim(column21)
'LRTrim(column22)
'CharToDate(Right(LRTrim(column51),4)+Substr(LRTrim(column51),3,2)+Left(LRTrim(column51),2))
'CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))
'_datareg
'_datarett
'LRTrim(column08)
'_intercit
'Left(LRTrim(column11),50)
'Val(LRTrim(column67))
'LRTrim(column43)
'cFlagCont
'cFlagFraz
'cFlagLire
'LRTrim(column13)
'_flagrap2
'cOpeProg1
'cIdCau
'"O"+Right(cOpeProg2,9)+_idb2
'column41
'LRTrim(column65)
'LRTrim(column39)
'LRTrim(column60)
'cOpeProg2
'LRTrim(column35)
'_idreg
''1'
'CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6))
'arfn_conv_stato_uic(LRTrim(column07))
'LRTrim(column64)
'nProgImp
'LRTrim(column09)
'_interprv
'LRTrim(column38)
'LRTrim(column63)
'LRTrim(column12)
'Val(LRTrim(column47))
'Val(LRTrim(column46))
'Val(LRTrim(column49))
'column36
'Val(LRTrim(column48))
'Val(LRTrim(column45))
'Val(LRTrim(column52))
'LRTrim(column61)
'LRTrim(column18)
'_statoreg
'LRTrim(column44)
''1'
'LRTrim(column05)
'LRTrim(column26)
'LRTrim(column14)
'LRTrim(column25)
'Val(LRTrim(column20))
'Val(column19)
'column34
'LRTrim(column17)
'LRTrim(column37)
'_colleg
'_idb2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7333
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))+" con importo "+Str((Val(column19))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=37
prev=O7417
I
obj='Var
obj_type='N
pag=37
prev=O7416
var_op='asgn
I
obj='Exec
pag=37
prev=O7415
I
nonlocal=True
obj='Var
obj_type='M
pag=37
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=37
prev=O7330
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=LRTrim(column12)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7331
fatherSonIndex=0
frm_calc=[
'_z=0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_z + 1
len=10
name='_z
obj='Var
obj_type='N
pag=37
prev=O7422
var_op='asgn
I
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7422
fatherSonIndex=0
frm_calc='intestbo->CODINTER
len=25
name='column21
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=37
prev=O7327
var_op='asgn
I
obj='If
pag=37
prev=O7325
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O7327
fatherSonIndex=0
obj='Read
pag=37
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'LRTrim(column06)
]
rd_var=[
'column10
'column08
'column09
'column07
'column11
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=37
prev=O7324
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O7325
fatherSonIndex=0
frm_calc='Upper(LRTrim(column53))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(LRTrim(column54))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column55))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(column56)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column57))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column58))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column59))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(LRTrim(column33)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(LRTrim(column33))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=37
prev=O7451
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7454
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(column12)))
]
h=[
19
19
]
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O7459
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=37
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=LRTrim(column12)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7464
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=37
prev=O7475
I
obj='Read
pag=37
prev=O7474
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=37
prev=O7473
var_op='asgn
I
obj='Var
pag=37
prev=O7472
var_op='asgn
I
obj='Var
pag=37
prev=O7471
var_op='asgn
I
obj='Var
pag=37
prev=O7470
var_op='asgn
I
obj='Var
pag=37
prev=O7469
var_op='asgn
I
obj='Var
pag=37
prev=O7468
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O7448
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7451
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=37
prev=O7492
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column33)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=37
prev=O7491
var_op='asgn
I
obj='Var
pag=37
prev=O7490
var_op='asgn
I
obj='Var
pag=37
prev=O7489
var_op='asgn
I
obj='Var
pag=37
prev=O7488
var_op='asgn
I
obj='Var
pag=37
prev=O7487
var_op='asgn
I
obj='Var
pag=37
prev=O7486
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O7447
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O7448
fatherSonIndex=0
obj='Read
pag=37
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=37
prev=O7446
var_op='asgn
I
obj='Var
pag=37
prev=O7445
var_op='asgn
I
obj='Var
pag=37
prev=O7444
var_op='asgn
I
obj='Var
pag=37
prev=O7443
var_op='asgn
I
obj='Var
pag=37
prev=O7442
var_op='asgn
I
obj='Var
pag=37
prev=O7441
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=37
prev=O7323
var_op='asgn
I
obj='Var
obj_type='N
pag=37
prev=O7322
var_op='asgn
I
obj='Var
obj_type='N
pag=37
prev=O7320
var_op='asgn
I
obj='Select
pag=37
par_expr=[
'Left(LRTrim(column03),4)
'Left(LRTrim(column04),2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O7319
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7320
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=37
prev=O7318
var_op='asgn
I
obj='Var
pag=37
prev=O7317
var_op='asgn
I
obj='Var
pag=37
prev=O7316
var_op='asgn
I
obj='Var
pag=37
prev=O7315
var_op='asgn
I
obj='Var
pag=37
prev=O7314
var_op='asgn
I
obj='Var
pag=37
prev=O7313
var_op='asgn
I
obj='Var
obj_type='D
pag=37
prev=O7310
var_op='asgn
I
obj='Case
pag=37
prev=O7309
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7310
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=37
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7310
fatherSonIndex=1
frm_calc=[
'LRTrim(column16) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7518
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=37
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7518
fatherSonIndex=1
frm_calc='LRTrim(column16)
len=1
name='cFlagLire
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7310
fatherSonIndex=2
frm_calc='LRTrim(column16)
len=1
name='cFlagLire
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=37
prev=O7306
var_op='asgn
I
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7306
fatherSonIndex=0
frm_calc='_numprog
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''1'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
obj='Var
obj_type='D
pag=37
prev=O7533
var_op='asgn
I
obj='Var
pag=37
prev=O7532
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7306
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("POPERAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''0'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datarett
obj='Var
obj_type='D
pag=37
prev=O7537
var_op='asgn
I
obj='Var
pag=37
prev=O7536
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O7295
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7298
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(LRTrim(column01)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7543
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=37
prev=O7548
sel_field='operazbo->IDBASE
sel_name='operazbo
sel_where='operazbo->NUMPROG=_numprog and (operazbo->STATOREG='0'  or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O7549
fatherSonIndex=0
frm_calc='"E' stata cancellata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=37
prev=O7553
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'operazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
]
wr_var=[
''2'
'Date()
]
I
nonlocal=True
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
father=O7543
fatherSonIndex=1
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"E' stata variata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=37
prev=O7564
sel_field='operazbo->IDBASE,operazbo->NUMPROG,operazbo->DATAOPE,operazbo->FLAGRAP2
sel_name='operazbo
sel_where='operazbo->NUMPROG=_numprog and (operazbo->STATOREG='0'  or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7565
fatherSonIndex=0
frm_calc='operazbo->IDBASE
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(operazbo->FLAGRAP2) or operazbo->FLAGRAP2='S',Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(operazbo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='operazbo->IDEREG
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='operazbo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=37
prev=O7577
sel_field='*
sel_name='terzistiope
sel_where='terzistiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='merzistiope
father=O7579
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'IDREG
]
rd_kvar=[
'_oldidb
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=37
prev=O7575
sel_field='*
sel_name='beneficope
sel_where='beneficope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='meneficope
father=O7577
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
'IDREG
]
rd_kvar=[
'_oldidb
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=37
prev=O7573
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mlientiope
father=O7575
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=37
prev=O7572
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mogopebo
father=O7573
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=37
prev=O7571
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'operazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
'FLAGRAP2
]
wr_op=[
'=
'=
'=
]
wr_var=[
''3'
'Date()
'_flagrap2
]
I
obj='Var
pag=37
prev=O7570
var_op='asgn
I
obj='Var
pag=37
prev=O7569
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=37
prev=O7563
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O7294
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7295
fatherSonIndex=0
frm_calc=[
'Upper(column36)='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O7616
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=37
sel_field='operazbo->NUMPROG
sel_name='operazbo
sel_where='operazbo->INFORM = column41 and (operazbo->STATOREG='0' or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7621
fatherSonIndex=0
frm_calc='operazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O7616
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=37
sel_field='operazbo->NUMPROG
sel_name='operazbo
sel_where='operazbo->RIFIMP = column36 and (operazbo->STATOREG='0' or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7628
fatherSonIndex=0
frm_calc='operazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=37
prev=O7293
var_op='asgn
I
obj='Var
pag=37
prev=O7292
var_op='asgn
I
obj='Var
pag=37
prev=O7291
var_op='asgn
I
obj='Var
pag=37
prev=O7288
var_op='asgn
I
obj='If
pag=37
prev=O7287
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O7288
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=37
prev=O7638
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7639
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))+" con importo "+Str((Val(column19))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=37
prev=O7645
I
obj='Var
obj_type='N
pag=37
prev=O7644
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=37
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'column34
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=37
prev=O7286
var_op='asgn
I
obj='Remark
pag=37
prev=O7283
I
obj='If
pag=37
prev=O7281
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7283
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column29)+LRTrim(column31)+LRTrim(column30)))
]
h=[
19
19
]
obj='If
pag=37
prev=O7657
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7660
fatherSonIndex=0
frm_calc='LRTrim(column29)
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(column31)
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(column30)
len=2
name='_interprv
obj='Var
pag=37
prev=O7666
var_op='asgn
I
obj='Var
pag=37
prev=O7665
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O7656
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7657
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))+" con importo "+Str((Val(column19))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(column28)+" non è presente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=37
prev=O7672
I
obj='Var
obj_type='N
pag=37
prev=O7671
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=37
prev=O7655
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'column28
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=37
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7281
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(column27)),_codinter,column27)
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column29)),_citinter,column29)
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column31)),_cabinter,column31)
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column30)),_prvinter,column30)
len=2
name='_interprv
obj='Var
pag=37
prev=O7684
var_op='asgn
I
obj='Var
pag=37
prev=O7683
var_op='asgn
I
obj='Var
pag=37
prev=O7682
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7275
fatherSonIndex=1
frm_calc='1
len=1
name='_opeerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(ohand,riga)
obj='Exec
pag=37
prev=O7688
I
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=37
prev=O7271
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O7273
fatherSonIndex=0
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column21)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column22))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column33))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column50))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(column21)) and Empty(LRTrim(column12)) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=37
prev=O7703
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7706
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O7700
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7703
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=37
prev=O7716
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7717
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=37
prev=O7715
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column50)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O7697
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7700
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=37
prev=O7732
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7733
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=37
prev=O7731
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column33)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O7694
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7697
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=37
prev=O7748
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7749
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=37
prev=O7747
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column22)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O7693
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7694
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=37
prev=O7764
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7765
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=37
prev=O7763
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column21)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=37
prev=O7269
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O7271
fatherSonIndex=0
frm_calc='a01.getContents()
len=25
name='column01
next=Icpitembatch.CPVarDecl
frm_calc='a02.getContents()
len=25
name='column02
next=Icpitembatch.CPVarDecl
frm_calc='a03.getContents()
len=25
name='column03
next=Icpitembatch.CPVarDecl
frm_calc='a04.getContents()
len=25
name='column04
next=Icpitembatch.CPVarDecl
frm_calc='a05.getContents()
len=25
name='column05
next=Icpitembatch.CPVarDecl
frm_calc='a06.getContents()
len=25
name='column06
next=Icpitembatch.CPVarDecl
frm_calc='a07.getContents()
len=25
name='column07
next=Icpitembatch.CPVarDecl
frm_calc='a08.getContents()
len=25
name='column08
next=Icpitembatch.CPVarDecl
frm_calc='a09.getContents()
len=25
name='column09
next=Icpitembatch.CPVarDecl
frm_calc='a10.getContents()
len=25
name='column10
next=Icpitembatch.CPVarDecl
frm_calc='a11.getContents()
len=25
name='column11
next=Icpitembatch.CPVarDecl
frm_calc='a12.getContents()
len=25
name='column12
next=Icpitembatch.CPVarDecl
frm_calc='a13.getContents()
len=25
name='column13
next=Icpitembatch.CPVarDecl
frm_calc='a14.getContents()
len=25
name='column14
next=Icpitembatch.CPVarDecl
frm_calc='a15.getContents()
len=25
name='column15
next=Icpitembatch.CPVarDecl
frm_calc='a16.getContents()
len=25
name='column16
next=Icpitembatch.CPVarDecl
frm_calc='a17.getContents()
len=25
name='column17
next=Icpitembatch.CPVarDecl
frm_calc='a18.getContents()
len=25
name='column18
next=Icpitembatch.CPVarDecl
frm_calc='a19.getContents()
len=25
name='column19
next=Icpitembatch.CPVarDecl
frm_calc='a20.getContents()
len=25
name='column20
next=Icpitembatch.CPVarDecl
frm_calc='a21.getContents()
len=25
name='column21
next=Icpitembatch.CPVarDecl
frm_calc='a22.getContents()
len=25
name='column22
next=Icpitembatch.CPVarDecl
frm_calc='a23.getContents()
len=25
name='column23
next=Icpitembatch.CPVarDecl
frm_calc='a24.getContents()
len=25
name='column24
next=Icpitembatch.CPVarDecl
frm_calc='a25.getContents()
len=25
name='column25
next=Icpitembatch.CPVarDecl
frm_calc='a26.getContents()
len=25
name='column26
next=Icpitembatch.CPVarDecl
frm_calc='a27.getContents()
len=25
name='column27
next=Icpitembatch.CPVarDecl
frm_calc='a28.getContents()
len=25
name='column28
next=Icpitembatch.CPVarDecl
frm_calc='a29.getContents()
len=25
name='column29
next=Icpitembatch.CPVarDecl
frm_calc='a30.getContents()
len=25
name='column30
next=Icpitembatch.CPVarDecl
frm_calc='a31.getContents()
len=25
name='column31
next=Icpitembatch.CPVarDecl
frm_calc='a32.getContents()
len=25
name='column32
next=Icpitembatch.CPVarDecl
frm_calc='a33.getContents()
len=25
name='column33
next=Icpitembatch.CPVarDecl
frm_calc='a34.getContents()
len=25
name='column34
next=Icpitembatch.CPVarDecl
frm_calc='a35.getContents()
len=25
name='column35
next=Icpitembatch.CPVarDecl
frm_calc='a36.getContents()
len=25
name='column36
next=Icpitembatch.CPVarDecl
frm_calc='a37.getContents()
len=25
name='column37
next=Icpitembatch.CPVarDecl
frm_calc='a38.getContents()
len=25
name='column38
next=Icpitembatch.CPVarDecl
frm_calc='a39.getContents()
len=25
name='column39
next=Icpitembatch.CPVarDecl
frm_calc='a40.getContents()
len=25
name='column40
next=Icpitembatch.CPVarDecl
frm_calc='a41.getContents()
len=25
name='column41
next=Icpitembatch.CPVarDecl
frm_calc='a42.getContents()
len=25
name='column42
next=Icpitembatch.CPVarDecl
frm_calc='a43.getContents()
len=25
name='column43
next=Icpitembatch.CPVarDecl
frm_calc='a44.getContents()
len=25
name='column44
next=Icpitembatch.CPVarDecl
frm_calc='a45.getContents()
len=25
name='column45
next=Icpitembatch.CPVarDecl
frm_calc='a46.getContents()
len=25
name='column46
next=Icpitembatch.CPVarDecl
frm_calc='a47.getContents()
len=25
name='column47
next=Icpitembatch.CPVarDecl
frm_calc='a48.getContents()
len=25
name='column48
next=Icpitembatch.CPVarDecl
frm_calc='a49.getContents()
len=25
name='column49
next=Icpitembatch.CPVarDecl
frm_calc='a50.getContents()
len=25
name='column50
next=Icpitembatch.CPVarDecl
frm_calc='a51.getContents()
len=25
name='column51
next=Icpitembatch.CPVarDecl
frm_calc='a52.getContents()
len=25
name='column52
next=Icpitembatch.CPVarDecl
frm_calc='a53.getContents()
len=25
name='column53
next=Icpitembatch.CPVarDecl
frm_calc='a54.getContents()
len=25
name='column54
next=Icpitembatch.CPVarDecl
frm_calc='a55.getContents()
len=25
name='column55
next=Icpitembatch.CPVarDecl
frm_calc='a56.getContents()
len=25
name='column56
next=Icpitembatch.CPVarDecl
frm_calc='a57.getContents()
len=25
name='column57
next=Icpitembatch.CPVarDecl
frm_calc='a58.getContents()
len=25
name='column58
next=Icpitembatch.CPVarDecl
frm_calc='a59.getContents()
len=25
name='column59
next=Icpitembatch.CPVarDecl
frm_calc='a60.getContents()
len=25
name='column60
next=Icpitembatch.CPVarDecl
frm_calc='a61.getContents()
len=25
name='column61
next=Icpitembatch.CPVarDecl
frm_calc='a62.getContents()
len=25
name='column62
next=Icpitembatch.CPVarDecl
frm_calc='a63.getContents()
len=25
name='column63
next=Icpitembatch.CPVarDecl
frm_calc='a64.getContents()
len=25
name='column64
next=Icpitembatch.CPVarDecl
frm_calc='a65.getContents()
len=25
name='column65
next=Icpitembatch.CPVarDecl
frm_calc='a66.getContents()
len=25
name='column66
next=Icpitembatch.CPVarDecl
frm_calc='a67.getContents()
len=25
name='column67
obj='Var
pag=37
prev=O7845
var_op='asgn
I
obj='Var
pag=37
prev=O7844
var_op='asgn
I
obj='Var
pag=37
prev=O7843
var_op='asgn
I
obj='Var
pag=37
prev=O7842
var_op='asgn
I
obj='Var
pag=37
prev=O7841
var_op='asgn
I
obj='Var
pag=37
prev=O7840
var_op='asgn
I
obj='Var
pag=37
prev=O7839
var_op='asgn
I
obj='Var
pag=37
prev=O7838
var_op='asgn
I
obj='Var
pag=37
prev=O7837
var_op='asgn
I
obj='Var
pag=37
prev=O7836
var_op='asgn
I
obj='Var
pag=37
prev=O7835
var_op='asgn
I
obj='Var
pag=37
prev=O7834
var_op='asgn
I
obj='Var
pag=37
prev=O7833
var_op='asgn
I
obj='Var
pag=37
prev=O7832
var_op='asgn
I
obj='Var
pag=37
prev=O7831
var_op='asgn
I
obj='Var
pag=37
prev=O7830
var_op='asgn
I
obj='Var
pag=37
prev=O7829
var_op='asgn
I
obj='Var
pag=37
prev=O7828
var_op='asgn
I
obj='Var
pag=37
prev=O7827
var_op='asgn
I
obj='Var
pag=37
prev=O7826
var_op='asgn
I
obj='Var
pag=37
prev=O7825
var_op='asgn
I
obj='Var
pag=37
prev=O7824
var_op='asgn
I
obj='Var
pag=37
prev=O7823
var_op='asgn
I
obj='Var
pag=37
prev=O7822
var_op='asgn
I
obj='Var
pag=37
prev=O7821
var_op='asgn
I
obj='Var
pag=37
prev=O7820
var_op='asgn
I
obj='Var
pag=37
prev=O7819
var_op='asgn
I
obj='Var
pag=37
prev=O7818
var_op='asgn
I
obj='Var
pag=37
prev=O7817
var_op='asgn
I
obj='Var
pag=37
prev=O7816
var_op='asgn
I
obj='Var
pag=37
prev=O7815
var_op='asgn
I
obj='Var
pag=37
prev=O7814
var_op='asgn
I
obj='Var
pag=37
prev=O7813
var_op='asgn
I
obj='Var
pag=37
prev=O7812
var_op='asgn
I
obj='Var
pag=37
prev=O7811
var_op='asgn
I
obj='Var
pag=37
prev=O7810
var_op='asgn
I
obj='Var
pag=37
prev=O7809
var_op='asgn
I
obj='Var
pag=37
prev=O7808
var_op='asgn
I
obj='Var
pag=37
prev=O7807
var_op='asgn
I
obj='Var
pag=37
prev=O7806
var_op='asgn
I
obj='Var
pag=37
prev=O7805
var_op='asgn
I
obj='Var
pag=37
prev=O7804
var_op='asgn
I
obj='Var
pag=37
prev=O7803
var_op='asgn
I
obj='Var
pag=37
prev=O7802
var_op='asgn
I
obj='Var
pag=37
prev=O7801
var_op='asgn
I
obj='Var
pag=37
prev=O7800
var_op='asgn
I
obj='Var
pag=37
prev=O7799
var_op='asgn
I
obj='Var
pag=37
prev=O7798
var_op='asgn
I
obj='Var
pag=37
prev=O7797
var_op='asgn
I
obj='Var
pag=37
prev=O7796
var_op='asgn
I
obj='Var
pag=37
prev=O7795
var_op='asgn
I
obj='Var
pag=37
prev=O7794
var_op='asgn
I
obj='Var
pag=37
prev=O7793
var_op='asgn
I
obj='Var
pag=37
prev=O7792
var_op='asgn
I
obj='Var
pag=37
prev=O7791
var_op='asgn
I
obj='Var
pag=37
prev=O7790
var_op='asgn
I
obj='Var
pag=37
prev=O7789
var_op='asgn
I
obj='Var
pag=37
prev=O7788
var_op='asgn
I
obj='Var
pag=37
prev=O7787
var_op='asgn
I
obj='Var
pag=37
prev=O7786
var_op='asgn
I
obj='Var
pag=37
prev=O7785
var_op='asgn
I
obj='Var
pag=37
prev=O7784
var_op='asgn
I
obj='Var
pag=37
prev=O7783
var_op='asgn
I
obj='Var
pag=37
prev=O7782
var_op='asgn
I
obj='Var
pag=37
prev=O7781
var_op='asgn
I
obj='Var
pag=37
prev=O7780
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=37
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPExec
check='man
father=O7269
fatherSonIndex=0
frm_calc='// Legge il contenuto delle celle﷯Cell a01 = sheet.getCell(0,_y);﷯Cell a02 = sheet.getCell(1,_y);﷯Cell a03 = sheet.getCell(2,_y);﷯Cell a04 = sheet.getCell(3,_y);﷯Cell a05 = sheet.getCell(4,_y);﷯Cell a06 = sheet.getCell(5,_y);﷯Cell a07 = sheet.getCell(6,_y);﷯Cell a08 = sheet.getCell(7,_y);﷯Cell a09 = sheet.getCell(8,_y);﷯Cell a10 = sheet.getCell(9,_y);﷯Cell a11 = sheet.getCell(10,_y);﷯Cell a12 = sheet.getCell(11,_y);﷯Cell a13 = sheet.getCell(12,_y);﷯Cell a14 = sheet.getCell(13,_y);﷯Cell a15 = sheet.getCell(14,_y);﷯Cell a16 = sheet.getCell(15,_y);﷯Cell a17 = sheet.getCell(16,_y);﷯Cell a18 = sheet.getCell(17,_y);﷯Cell a19 = sheet.getCell(18,_y);﷯Cell a20 = sheet.getCell(19,_y);﷯Cell a21 = sheet.getCell(20,_y);﷯Cell a22 = sheet.getCell(21,_y);﷯Cell a23 = sheet.getCell(22,_y);﷯Cell a24 = sheet.getCell(23,_y);﷯Cell a25 = sheet.getCell(24,_y);﷯Cell a26 = sheet.getCell(25,_y);﷯Cell a27 = sheet.getCell(26,_y);﷯Cell a28 = sheet.getCell(27,_y);﷯Cell a29 = sheet.getCell(28,_y);﷯Cell a30 = sheet.getCell(29,_y);﷯Cell a31 = sheet.getCell(30,_y);﷯Cell a32 = sheet.getCell(31,_y);﷯Cell a33 = sheet.getCell(32,_y);﷯Cell a34 = sheet.getCell(33,_y);﷯Cell a35 = sheet.getCell(34,_y);﷯Cell a36 = sheet.getCell(35,_y);﷯Cell a37 = sheet.getCell(36,_y);﷯Cell a38 = sheet.getCell(37,_y);﷯Cell a39 = sheet.getCell(38,_y);﷯Cell a40 = sheet.getCell(39,_y);﷯Cell a41 = sheet.getCell(40,_y);﷯Cell a42 = sheet.getCell(41,_y);﷯Cell a43 = sheet.getCell(42,_y);﷯Cell a44 = sheet.getCell(43,_y);﷯Cell a45 = sheet.getCell(44,_y);﷯Cell a46 = sheet.getCell(45,_y);﷯Cell a47 = sheet.getCell(46,_y);﷯Cell a48 = sheet.getCell(47,_y);﷯Cell a49 = sheet.getCell(48,_y);﷯Cell a50 = sheet.getCell(49,_y);﷯Cell a51 = sheet.getCell(50,_y);﷯Cell a52 = sheet.getCell(51,_y);﷯Cell a53 = sheet.getCell(52,_y);﷯Cell a54 = sheet.getCell(53,_y);﷯Cell a55 = sheet.getCell(54,_y);﷯Cell a56 = sheet.getCell(55,_y);﷯Cell a57 = sheet.getCell(56,_y);﷯Cell a58 = sheet.getCell(57,_y);﷯Cell a59 = sheet.getCell(58,_y);﷯Cell a60 = sheet.getCell(59,_y);﷯Cell a61 = sheet.getCell(60,_y);﷯Cell a62 = sheet.getCell(61,_y);﷯Cell a63 = sheet.getCell(62,_y);﷯Cell a64 = sheet.getCell(63,_y);﷯Cell a65 = sheet.getCell(64,_y);﷯Cell a66 = sheet.getCell(65,_y);﷯Cell a67 = sheet.getCell(66,_y);
obj='Exec
pag=37
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=37
I
I
]
w=[
150
150
]
I
obj='Exec
pag=37
prev=O7251
I
obj='Begin
pag=37
prev=O7250
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O7251
fatherSonIndex=0
frm_calc='//base﷯Workbook workbook = Workbook.getWorkbook(new File(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(gAzienda)+"/"+CPLib.LRTrim(nomefileimport)));﷯_conta = workbook.getNumberOfSheets();
obj='Exec
pag=37
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=37
prev=O7249
var_op='asgn
I
obj='Var
obj_type='N
pag=37
prev=O7248
var_op='asgn
I
obj='Var
obj_type='N
pag=37
prev=O7247
var_op='asgn
I
obj='Var
pag=37
pagelocal=True
prev=O7246
I
obj='Remark
pag=37
x=13
y=29
I
Icpitembatch.CPRead
arch='tbcauana
obj='Read
pag=37
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,10,4)
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
x=463
y=3942
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPBeginEnd
comment='Apro il foglio e verifico quante pagine ha
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='_i = 0
next=Icpitembatch.CPWhile
frm_calc='_i < _conta
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='workbook.close()
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Modificate: '+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=38
prev=O7876
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=38
prev=O7875
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=38
prev=O7874
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=38
prev=O7873
var_op='asgn
I
obj='Exec
pag=38
prev=O7871
I
obj='While
pag=38
prev=O7870
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O7871
fatherSonIndex=0
frm_calc='_righe = 0;﷯Sheet sheet = workbook.getSheet(_i);﷯_righe = sheet.getRows();﷯_y = 1;
next=Icpitembatch.CPWhile
frm_calc='_y < _righe
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=38
prev=O7881
I
obj='While
pag=38
prev=O7880
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Legge le colonne e scrive i dati nelle variabili appoggio
father=O7881
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPExec
check='man
frm_calc='_y++;
obj='Exec
pag=38
prev=O7892
I
obj='If
pag=38
prev=O7890
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O7892
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column28)))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(column34)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPCase
frm_calc=[
'LRTrim(column16)='S' or LRTrim(column16)='1' or LRTrim(column16)='7'
'LRTrim(column16)='E' or LRTrim(column16)='3' or LRTrim(column16)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Left(column15,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(LRTrim(column02)='1' or LRTrim(column02)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column32)),'0',iif(LRTrim(column32)='S','1',iif(LRTrim(column32)='N','1',LRTrim(column32))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(LRTrim(column24))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column06)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_z
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xperazbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=38
prev=O7933
var_op='asgn
I
obj='Insert
pag=38
prev=O7931
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
]
rd_kvar=[
'LRTrim(column42)
'Val(Right(LRTrim(column01),4))
'arfn_conv_stato_uic(Left(LRTrim(column40),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'LRTrim(column62)
'_bensta
'Val(LRTrim(column23)) / 10000
'Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2)
'Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2)
'DateToChar(_datareg)
'LRTrim(column03)
'_intercab
'LRTrim(column10)
'column28
'LRTrim(column06)
'_intercod
'LRTrim(column04)
'LRTrim(column50)
'LRTrim(column33)
'LRTrim(column21)
'LRTrim(column22)
'CharToDate(Right(LRTrim(column51),4)+Substr(LRTrim(column51),3,2)+Left(LRTrim(column51),2))
'CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))
'_datareg
'_datarett
'LRTrim(column08)
'_intercit
'Left(LRTrim(column11),50)
'Val(LRTrim(column67))
'LRTrim(column43)
'cFlagCont
'cFlagFraz
'cFlagLire
'LRTrim(column13)
'_flagrap2
'cOpeProg1
'cIdCau
'"O"+Right(cOpeProg2,9)+_idb2
'column41
'LRTrim(column65)
'LRTrim(column39)
'LRTrim(column60)
'cOpeProg2
'LRTrim(column35)
'_idreg
''1'
'CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6))
'arfn_conv_stato_uic(LRTrim(column07))
'LRTrim(column64)
'nProgImp
'LRTrim(column09)
'_interprv
'LRTrim(column38)
'LRTrim(column63)
'LRTrim(column12)
'Val(LRTrim(column47))
'Val(LRTrim(column46))
'Val(LRTrim(column49))
'column36
'Val(LRTrim(column48))
'Val(LRTrim(column45))
'Val(LRTrim(column52))
'LRTrim(column61)
'LRTrim(column18)
'_statoreg
'LRTrim(column44)
''1'
'LRTrim(column05)
'LRTrim(column26)
'LRTrim(column14)
'LRTrim(column25)
'Val(LRTrim(column20))
'Val(column19)
'column34
'LRTrim(column17)
'LRTrim(column37)
'_colleg
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7933
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))+" con importo "+Str((Val(column19))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=38
prev=O7942
I
obj='Var
obj_type='N
pag=38
prev=O7941
var_op='asgn
I
obj='Exec
pag=38
prev=O7940
I
nonlocal=True
obj='Var
obj_type='M
pag=38
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=38
prev=O7930
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=LRTrim(column12)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7931
fatherSonIndex=0
frm_calc=[
'_z=0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_z + 1
len=10
name='_z
obj='Var
obj_type='N
pag=38
prev=O7947
var_op='asgn
I
obj='If
pag=38
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7947
fatherSonIndex=0
frm_calc='intestbo->CODINTER
len=25
name='column21
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=38
prev=O7927
var_op='asgn
I
obj='If
pag=38
prev=O7925
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O7927
fatherSonIndex=0
obj='Read
pag=38
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'LRTrim(column06)
]
rd_var=[
'column10
'column08
'column09
'column07
'column11
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=38
prev=O7924
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O7925
fatherSonIndex=0
frm_calc='Upper(LRTrim(column53))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(LRTrim(column54))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column55))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(column56)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column57))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column58))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column59))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(LRTrim(column33)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(LRTrim(column33))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=38
prev=O7976
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7979
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(column12)))
]
h=[
19
19
]
obj='If
pag=38
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O7984
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=38
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=LRTrim(column12)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7989
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=38
prev=O8000
I
obj='Read
pag=38
prev=O7999
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=38
prev=O7998
var_op='asgn
I
obj='Var
pag=38
prev=O7997
var_op='asgn
I
obj='Var
pag=38
prev=O7996
var_op='asgn
I
obj='Var
pag=38
prev=O7995
var_op='asgn
I
obj='Var
pag=38
prev=O7994
var_op='asgn
I
obj='Var
pag=38
prev=O7993
var_op='asgn
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O7973
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7976
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=38
prev=O8017
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column33)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=38
prev=O8016
var_op='asgn
I
obj='Var
pag=38
prev=O8015
var_op='asgn
I
obj='Var
pag=38
prev=O8014
var_op='asgn
I
obj='Var
pag=38
prev=O8013
var_op='asgn
I
obj='Var
pag=38
prev=O8012
var_op='asgn
I
obj='Var
pag=38
prev=O8011
var_op='asgn
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O7972
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O7973
fatherSonIndex=0
obj='Read
pag=38
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=38
prev=O7971
var_op='asgn
I
obj='Var
pag=38
prev=O7970
var_op='asgn
I
obj='Var
pag=38
prev=O7969
var_op='asgn
I
obj='Var
pag=38
prev=O7968
var_op='asgn
I
obj='Var
pag=38
prev=O7967
var_op='asgn
I
obj='Var
pag=38
prev=O7966
var_op='asgn
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=38
prev=O7923
var_op='asgn
I
obj='Var
obj_type='N
pag=38
prev=O7922
var_op='asgn
I
obj='Var
obj_type='N
pag=38
prev=O7920
var_op='asgn
I
obj='Select
pag=38
par_expr=[
'Left(LRTrim(column03),4)
'Left(LRTrim(column04),2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O7919
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7920
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=38
prev=O7918
var_op='asgn
I
obj='Var
pag=38
prev=O7917
var_op='asgn
I
obj='Var
pag=38
prev=O7916
var_op='asgn
I
obj='Var
pag=38
prev=O7915
var_op='asgn
I
obj='Var
pag=38
prev=O7914
var_op='asgn
I
obj='Var
obj_type='D
pag=38
prev=O7911
var_op='asgn
I
obj='Case
pag=38
prev=O7910
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7911
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=38
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7911
fatherSonIndex=1
frm_calc=[
'LRTrim(column16) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=38
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8043
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=38
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8043
fatherSonIndex=1
frm_calc='LRTrim(column16)
len=1
name='cFlagLire
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7911
fatherSonIndex=2
frm_calc='LRTrim(column16)
len=1
name='cFlagLire
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=38
prev=O7909
var_op='asgn
I
obj='Var
pag=38
prev=O7908
var_op='asgn
I
obj='Var
pag=38
prev=O7905
var_op='asgn
I
obj='If
pag=38
prev=O7904
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O7905
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=38
prev=O8057
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8058
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))+" con importo "+Str((Val(column19))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=38
prev=O8064
I
obj='Var
obj_type='N
pag=38
prev=O8063
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=38
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'column34
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=38
prev=O7903
var_op='asgn
I
obj='Remark
pag=38
prev=O7900
I
obj='If
pag=38
prev=O7898
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7900
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column29)+LRTrim(column31)+LRTrim(column30)))
]
h=[
19
19
]
obj='If
pag=38
prev=O8076
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8079
fatherSonIndex=0
frm_calc='LRTrim(column29)
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(column31)
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(column30)
len=2
name='_interprv
obj='Var
pag=38
prev=O8085
var_op='asgn
I
obj='Var
pag=38
prev=O8084
var_op='asgn
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O8075
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8076
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))+" con importo "+Str((Val(column19))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(column28)+" non è presente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=38
prev=O8091
I
obj='Var
obj_type='N
pag=38
prev=O8090
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=38
prev=O8074
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'column28
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=38
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=38
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7898
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(column27)),_codinter,column27)
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column29)),_citinter,column29)
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column31)),_cabinter,column31)
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column30)),_prvinter,column30)
len=2
name='_interprv
obj='Var
pag=38
prev=O8103
var_op='asgn
I
obj='Var
pag=38
prev=O8102
var_op='asgn
I
obj='Var
pag=38
prev=O8101
var_op='asgn
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7892
fatherSonIndex=1
frm_calc='1
len=1
name='_opeerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(ohand,riga)
obj='Exec
pag=38
prev=O8107
I
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=38
prev=O7888
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O7890
fatherSonIndex=0
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column21)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column22))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column33))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column50))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(column21)) and Empty(LRTrim(column12)) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=38
prev=O8122
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8125
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O8119
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8122
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=38
prev=O8135
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8136
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=38
prev=O8134
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column50)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O8116
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8119
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=38
prev=O8151
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8152
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=38
prev=O8150
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column33)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O8113
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8116
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=38
prev=O8167
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8168
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=38
prev=O8166
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column22)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O8112
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8113
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=38
prev=O8183
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8184
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=38
prev=O8182
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column21)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=38
prev=O7886
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O7888
fatherSonIndex=0
frm_calc='a01.getContents()
len=25
name='column01
next=Icpitembatch.CPVarDecl
frm_calc='a02.getContents()
len=25
name='column02
next=Icpitembatch.CPVarDecl
frm_calc='a03.getContents()
len=25
name='column03
next=Icpitembatch.CPVarDecl
frm_calc='a04.getContents()
len=25
name='column04
next=Icpitembatch.CPVarDecl
frm_calc='a05.getContents()
len=25
name='column05
next=Icpitembatch.CPVarDecl
frm_calc='a06.getContents()
len=25
name='column06
next=Icpitembatch.CPVarDecl
frm_calc='a07.getContents()
len=25
name='column07
next=Icpitembatch.CPVarDecl
frm_calc='a08.getContents()
len=25
name='column08
next=Icpitembatch.CPVarDecl
frm_calc='a09.getContents()
len=25
name='column09
next=Icpitembatch.CPVarDecl
frm_calc='a10.getContents()
len=25
name='column10
next=Icpitembatch.CPVarDecl
frm_calc='a11.getContents()
len=25
name='column11
next=Icpitembatch.CPVarDecl
frm_calc='a12.getContents()
len=25
name='column12
next=Icpitembatch.CPVarDecl
frm_calc='a13.getContents()
len=25
name='column13
next=Icpitembatch.CPVarDecl
frm_calc='a14.getContents()
len=25
name='column14
next=Icpitembatch.CPVarDecl
frm_calc='a15.getContents()
len=25
name='column15
next=Icpitembatch.CPVarDecl
frm_calc='a16.getContents()
len=25
name='column16
next=Icpitembatch.CPVarDecl
frm_calc='a17.getContents()
len=25
name='column17
next=Icpitembatch.CPVarDecl
frm_calc='a18.getContents()
len=25
name='column18
next=Icpitembatch.CPVarDecl
frm_calc='a19.getContents()
len=25
name='column19
next=Icpitembatch.CPVarDecl
frm_calc='a20.getContents()
len=25
name='column20
next=Icpitembatch.CPVarDecl
frm_calc='a21.getContents()
len=25
name='column21
next=Icpitembatch.CPVarDecl
frm_calc='a22.getContents()
len=25
name='column22
next=Icpitembatch.CPVarDecl
frm_calc='a23.getContents()
len=25
name='column23
next=Icpitembatch.CPVarDecl
frm_calc='a24.getContents()
len=25
name='column24
next=Icpitembatch.CPVarDecl
frm_calc='a25.getContents()
len=25
name='column25
next=Icpitembatch.CPVarDecl
frm_calc='a26.getContents()
len=25
name='column26
next=Icpitembatch.CPVarDecl
frm_calc='a27.getContents()
len=25
name='column27
next=Icpitembatch.CPVarDecl
frm_calc='a28.getContents()
len=25
name='column28
next=Icpitembatch.CPVarDecl
frm_calc='a29.getContents()
len=25
name='column29
next=Icpitembatch.CPVarDecl
frm_calc='a30.getContents()
len=25
name='column30
next=Icpitembatch.CPVarDecl
frm_calc='a31.getContents()
len=25
name='column31
next=Icpitembatch.CPVarDecl
frm_calc='a32.getContents()
len=25
name='column32
next=Icpitembatch.CPVarDecl
frm_calc='a33.getContents()
len=25
name='column33
next=Icpitembatch.CPVarDecl
frm_calc='a34.getContents()
len=25
name='column34
next=Icpitembatch.CPVarDecl
frm_calc='a35.getContents()
len=25
name='column35
next=Icpitembatch.CPVarDecl
frm_calc='a36.getContents()
len=25
name='column36
next=Icpitembatch.CPVarDecl
frm_calc='a37.getContents()
len=25
name='column37
next=Icpitembatch.CPVarDecl
frm_calc='a38.getContents()
len=25
name='column38
next=Icpitembatch.CPVarDecl
frm_calc='a39.getContents()
len=25
name='column39
next=Icpitembatch.CPVarDecl
frm_calc='a40.getContents()
len=25
name='column40
next=Icpitembatch.CPVarDecl
frm_calc='a41.getContents()
len=25
name='column41
next=Icpitembatch.CPVarDecl
frm_calc='a42.getContents()
len=25
name='column42
next=Icpitembatch.CPVarDecl
frm_calc='a43.getContents()
len=25
name='column43
next=Icpitembatch.CPVarDecl
frm_calc='a44.getContents()
len=25
name='column44
next=Icpitembatch.CPVarDecl
frm_calc='a45.getContents()
len=25
name='column45
next=Icpitembatch.CPVarDecl
frm_calc='a46.getContents()
len=25
name='column46
next=Icpitembatch.CPVarDecl
frm_calc='a47.getContents()
len=25
name='column47
next=Icpitembatch.CPVarDecl
frm_calc='a48.getContents()
len=25
name='column48
next=Icpitembatch.CPVarDecl
frm_calc='a49.getContents()
len=25
name='column49
next=Icpitembatch.CPVarDecl
frm_calc='a50.getContents()
len=25
name='column50
next=Icpitembatch.CPVarDecl
frm_calc='a51.getContents()
len=25
name='column51
next=Icpitembatch.CPVarDecl
frm_calc='a52.getContents()
len=25
name='column52
next=Icpitembatch.CPVarDecl
frm_calc='a53.getContents()
len=25
name='column53
next=Icpitembatch.CPVarDecl
frm_calc='a54.getContents()
len=25
name='column54
next=Icpitembatch.CPVarDecl
frm_calc='a55.getContents()
len=25
name='column55
next=Icpitembatch.CPVarDecl
frm_calc='a56.getContents()
len=25
name='column56
next=Icpitembatch.CPVarDecl
frm_calc='a57.getContents()
len=25
name='column57
next=Icpitembatch.CPVarDecl
frm_calc='a58.getContents()
len=25
name='column58
next=Icpitembatch.CPVarDecl
frm_calc='a59.getContents()
len=25
name='column59
next=Icpitembatch.CPVarDecl
frm_calc='a60.getContents()
len=25
name='column60
next=Icpitembatch.CPVarDecl
frm_calc='a61.getContents()
len=25
name='column61
next=Icpitembatch.CPVarDecl
frm_calc='a62.getContents()
len=25
name='column62
next=Icpitembatch.CPVarDecl
frm_calc='a63.getContents()
len=25
name='column63
next=Icpitembatch.CPVarDecl
frm_calc='a64.getContents()
len=25
name='column64
next=Icpitembatch.CPVarDecl
frm_calc='a65.getContents()
len=25
name='column65
next=Icpitembatch.CPVarDecl
frm_calc='a66.getContents()
len=25
name='column66
next=Icpitembatch.CPVarDecl
frm_calc='a67.getContents()
len=25
name='column67
obj='Var
pag=38
prev=O8264
var_op='asgn
I
obj='Var
pag=38
prev=O8263
var_op='asgn
I
obj='Var
pag=38
prev=O8262
var_op='asgn
I
obj='Var
pag=38
prev=O8261
var_op='asgn
I
obj='Var
pag=38
prev=O8260
var_op='asgn
I
obj='Var
pag=38
prev=O8259
var_op='asgn
I
obj='Var
pag=38
prev=O8258
var_op='asgn
I
obj='Var
pag=38
prev=O8257
var_op='asgn
I
obj='Var
pag=38
prev=O8256
var_op='asgn
I
obj='Var
pag=38
prev=O8255
var_op='asgn
I
obj='Var
pag=38
prev=O8254
var_op='asgn
I
obj='Var
pag=38
prev=O8253
var_op='asgn
I
obj='Var
pag=38
prev=O8252
var_op='asgn
I
obj='Var
pag=38
prev=O8251
var_op='asgn
I
obj='Var
pag=38
prev=O8250
var_op='asgn
I
obj='Var
pag=38
prev=O8249
var_op='asgn
I
obj='Var
pag=38
prev=O8248
var_op='asgn
I
obj='Var
pag=38
prev=O8247
var_op='asgn
I
obj='Var
pag=38
prev=O8246
var_op='asgn
I
obj='Var
pag=38
prev=O8245
var_op='asgn
I
obj='Var
pag=38
prev=O8244
var_op='asgn
I
obj='Var
pag=38
prev=O8243
var_op='asgn
I
obj='Var
pag=38
prev=O8242
var_op='asgn
I
obj='Var
pag=38
prev=O8241
var_op='asgn
I
obj='Var
pag=38
prev=O8240
var_op='asgn
I
obj='Var
pag=38
prev=O8239
var_op='asgn
I
obj='Var
pag=38
prev=O8238
var_op='asgn
I
obj='Var
pag=38
prev=O8237
var_op='asgn
I
obj='Var
pag=38
prev=O8236
var_op='asgn
I
obj='Var
pag=38
prev=O8235
var_op='asgn
I
obj='Var
pag=38
prev=O8234
var_op='asgn
I
obj='Var
pag=38
prev=O8233
var_op='asgn
I
obj='Var
pag=38
prev=O8232
var_op='asgn
I
obj='Var
pag=38
prev=O8231
var_op='asgn
I
obj='Var
pag=38
prev=O8230
var_op='asgn
I
obj='Var
pag=38
prev=O8229
var_op='asgn
I
obj='Var
pag=38
prev=O8228
var_op='asgn
I
obj='Var
pag=38
prev=O8227
var_op='asgn
I
obj='Var
pag=38
prev=O8226
var_op='asgn
I
obj='Var
pag=38
prev=O8225
var_op='asgn
I
obj='Var
pag=38
prev=O8224
var_op='asgn
I
obj='Var
pag=38
prev=O8223
var_op='asgn
I
obj='Var
pag=38
prev=O8222
var_op='asgn
I
obj='Var
pag=38
prev=O8221
var_op='asgn
I
obj='Var
pag=38
prev=O8220
var_op='asgn
I
obj='Var
pag=38
prev=O8219
var_op='asgn
I
obj='Var
pag=38
prev=O8218
var_op='asgn
I
obj='Var
pag=38
prev=O8217
var_op='asgn
I
obj='Var
pag=38
prev=O8216
var_op='asgn
I
obj='Var
pag=38
prev=O8215
var_op='asgn
I
obj='Var
pag=38
prev=O8214
var_op='asgn
I
obj='Var
pag=38
prev=O8213
var_op='asgn
I
obj='Var
pag=38
prev=O8212
var_op='asgn
I
obj='Var
pag=38
prev=O8211
var_op='asgn
I
obj='Var
pag=38
prev=O8210
var_op='asgn
I
obj='Var
pag=38
prev=O8209
var_op='asgn
I
obj='Var
pag=38
prev=O8208
var_op='asgn
I
obj='Var
pag=38
prev=O8207
var_op='asgn
I
obj='Var
pag=38
prev=O8206
var_op='asgn
I
obj='Var
pag=38
prev=O8205
var_op='asgn
I
obj='Var
pag=38
prev=O8204
var_op='asgn
I
obj='Var
pag=38
prev=O8203
var_op='asgn
I
obj='Var
pag=38
prev=O8202
var_op='asgn
I
obj='Var
pag=38
prev=O8201
var_op='asgn
I
obj='Var
pag=38
prev=O8200
var_op='asgn
I
obj='Var
pag=38
prev=O8199
var_op='asgn
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=38
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPExec
check='man
father=O7886
fatherSonIndex=0
frm_calc='// Legge il contenuto delle celle﷯Cell a01 = sheet.getCell(0,_y);﷯Cell a02 = sheet.getCell(1,_y);﷯Cell a03 = sheet.getCell(2,_y);﷯Cell a04 = sheet.getCell(3,_y);﷯Cell a05 = sheet.getCell(4,_y);﷯Cell a06 = sheet.getCell(5,_y);﷯Cell a07 = sheet.getCell(6,_y);﷯Cell a08 = sheet.getCell(7,_y);﷯Cell a09 = sheet.getCell(8,_y);﷯Cell a10 = sheet.getCell(9,_y);﷯Cell a11 = sheet.getCell(10,_y);﷯Cell a12 = sheet.getCell(11,_y);﷯Cell a13 = sheet.getCell(12,_y);﷯Cell a14 = sheet.getCell(13,_y);﷯Cell a15 = sheet.getCell(14,_y);﷯Cell a16 = sheet.getCell(15,_y);﷯Cell a17 = sheet.getCell(16,_y);﷯Cell a18 = sheet.getCell(17,_y);﷯Cell a19 = sheet.getCell(18,_y);﷯Cell a20 = sheet.getCell(19,_y);﷯Cell a21 = sheet.getCell(20,_y);﷯Cell a22 = sheet.getCell(21,_y);﷯Cell a23 = sheet.getCell(22,_y);﷯Cell a24 = sheet.getCell(23,_y);﷯Cell a25 = sheet.getCell(24,_y);﷯Cell a26 = sheet.getCell(25,_y);﷯Cell a27 = sheet.getCell(26,_y);﷯Cell a28 = sheet.getCell(27,_y);﷯Cell a29 = sheet.getCell(28,_y);﷯Cell a30 = sheet.getCell(29,_y);﷯Cell a31 = sheet.getCell(30,_y);﷯Cell a32 = sheet.getCell(31,_y);﷯Cell a33 = sheet.getCell(32,_y);﷯Cell a34 = sheet.getCell(33,_y);﷯Cell a35 = sheet.getCell(34,_y);﷯Cell a36 = sheet.getCell(35,_y);﷯Cell a37 = sheet.getCell(36,_y);﷯Cell a38 = sheet.getCell(37,_y);﷯Cell a39 = sheet.getCell(38,_y);﷯Cell a40 = sheet.getCell(39,_y);﷯Cell a41 = sheet.getCell(40,_y);﷯Cell a42 = sheet.getCell(41,_y);﷯Cell a43 = sheet.getCell(42,_y);﷯Cell a44 = sheet.getCell(43,_y);﷯Cell a45 = sheet.getCell(44,_y);﷯Cell a46 = sheet.getCell(45,_y);﷯Cell a47 = sheet.getCell(46,_y);﷯Cell a48 = sheet.getCell(47,_y);﷯Cell a49 = sheet.getCell(48,_y);﷯Cell a50 = sheet.getCell(49,_y);﷯Cell a51 = sheet.getCell(50,_y);﷯Cell a52 = sheet.getCell(51,_y);﷯Cell a53 = sheet.getCell(52,_y);﷯Cell a54 = sheet.getCell(53,_y);﷯Cell a55 = sheet.getCell(54,_y);﷯Cell a56 = sheet.getCell(55,_y);﷯Cell a57 = sheet.getCell(56,_y);﷯Cell a58 = sheet.getCell(57,_y);﷯Cell a59 = sheet.getCell(58,_y);﷯Cell a60 = sheet.getCell(59,_y);﷯Cell a61 = sheet.getCell(60,_y);﷯Cell a62 = sheet.getCell(61,_y);﷯Cell a63 = sheet.getCell(62,_y);﷯Cell a64 = sheet.getCell(63,_y);﷯Cell a65 = sheet.getCell(64,_y);﷯Cell a66 = sheet.getCell(65,_y);﷯Cell a67 = sheet.getCell(66,_y);
obj='Exec
pag=38
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=38
I
I
]
w=[
150
150
]
I
obj='Exec
pag=38
prev=O7868
I
obj='Begin
pag=38
prev=O7867
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O7868
fatherSonIndex=0
frm_calc='//base﷯Workbook workbook = Workbook.getWorkbook(new File(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(gAzienda)+"/"+CPLib.LRTrim(nomefileimport)));﷯_conta = workbook.getNumberOfSheets();
obj='Exec
pag=38
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=38
prev=O7866
var_op='asgn
I
obj='Var
obj_type='N
pag=38
prev=O7865
var_op='asgn
I
obj='Var
obj_type='N
pag=38
prev=O7864
var_op='asgn
I
obj='Var
pag=38
pagelocal=True
prev=O7863
I
obj='Remark
pag=38
x=14
y=20
I
Icpitembatch.CPRead
arch='tbcauana
obj='Read
pag=38
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,10,4)
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
x=666
y=2343
I
Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + czipfile + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Inizio estrazione del file '+ czipfile
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+"/"+czipfile
len=200
name='cpercorsozip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+"/"
len=200
name='cdirectoryfile
next=Icpitembatch.CPExec
check='man
frm_calc='try {﷯      // Apro il file zip﷯      java.util.zip.ZipFile zf = new java.util.zip.ZipFile(cpercorsozip);﷯﷯      //Conto il numero di file all interno del file zip e creo un array di stringhe per memorizzare i nomi file﷯      conteggio=zf.size();﷯      lista=new String[conteggio];﷯      ﷯      // Enumerate each entry﷯      i=0;﷯      for (java.util.Enumeration entries = zf.entries(); entries.hasMoreElements();) {﷯          // Get the entry name﷯          lista[i] = ((java.util.zip.ZipEntry)entries.nextElement()).getName();﷯          i++;﷯      }﷯     zf.close();﷯     } catch (java.io.IOException e) {﷯     }﷯try {﷯      // Apro il file zip﷯      java.util.zip.ZipFile zf = new java.util.zip.ZipFile(cpercorsozip);﷯﷯      byte[] buffer = new byte[1024]; ﷯      java.util.Enumeration entries = zf.entries();﷯      while(entries.hasMoreElements() ) {﷯        java.util.zip.ZipEntry entry = (java.util.zip.ZipEntry)entries.nextElement();﷯        java.io.InputStream in =zf.getInputStream(entry);﷯        java.io.OutputStream out = new java.io.BufferedOutputStream(new java.io.FileOutputStream(cdirectoryfile+entry.getName()));﷯﷯        int len;﷯﷯        while((len = in.read(buffer)) >= 0){﷯          out.write(buffer, 0, len);﷯        }﷯﷯          in.close();﷯          out.close();﷯      }﷯﷯      zf.close();﷯} catch (java.io.IOException ioe) {﷯      System.err.println("Unhandled exception:");﷯      ioe.printStackTrace();﷯      return;﷯}
next=Icpitembatch.CPDelete
arch='tmp_list_imprich
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='contanome
next=Icpitembatch.CPVarDecl
frm_calc='0
len=3
name='_priorita
next=Icpitembatch.CPWhile
frm_calc='contanome<conteggio
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+czipfile)
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine estrazione del file '+ czipfile
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +czipfile + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=39
prev=O8293
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=39
prev=O8292
var_op='asgn
I
obj='Exec
pag=39
prev=O8290
I
obj='While
pag=39
prev=O8289
sons=[
Icpitembatch.CPItemSon
comment='Assegnal apriorità ad ogni file e lo inserisce in tmp_list
instr=Icpitembatch.CPExec
check='man
father=O8290
fatherSonIndex=0
frm_calc='buffernomefile=lista[contanome];
next=Icpitembatch.CPInsert
arch='tmp_list_imprich
next=Icpitembatch.CPVarDecl
frm_calc='contanome+1
len=10
name='contanome
obj='Var
obj_type='N
pag=39
prev=O8298
var_op='asgn
I
obj='Insert
pag=39
prev=O8297
rd_kfield=[
'nomefile
]
rd_kvar=[
'buffernomefile
]
I
obj='Exec
pag=39
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=39
prev=O8288
var_op='asgn
I
obj='Var
obj_type='N
pag=39
prev=O8287
var_op='asgn
I
obj='Delete
pag=39
prev=O8286
rd_kfield=[
'nomefile
]
rd_kop=[
'=
]
rd_kvar=[
'czipfile
]
I
obj='Exec
pag=39
prev=O8285
I
obj='Var
pag=39
prev=O8284
var_op='asgn
I
obj='Var
pag=39
prev=O8283
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=39
prev=O8282
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=39
var_op='asgn
x=11
y=18
I
Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=4
sel_field='*
sel_name='xntestbo
sel_order='xntestbo->CPROWNUM
sel_where='xntestbo->RAPPORTO=Substr(riga,9,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O8306
fatherSonIndex=0
frm_calc=[
'xntestbo->CODINTER=cCli1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=4
prev=O8310
var_op='asgn
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8310
fatherSonIndex=0
frm_calc='xntestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
x=1155
y=2003
I
Icpitembatch.CPIfElse
frm_calc=[
'_flgmodi='S'
]
h=[
19
19
]
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O8319
fatherSonIndex=0
frm_calc=[
'LRTrim(xRiga3) <> LRTrim(xRiga4)
]
h=[
19
19
]
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8324
fatherSonIndex=0
frm_calc='xCFE
len=1
name='_newest
next=Icpitembatch.CPExec
check='page
frm_calc='31
obj='Exec
pag=30
prev=O8329
I
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
x=1425
y=4437
I
Icpitembatch.CPIfElse
frm_calc=[
'Empty(_conadd)
]
h=[
19
19
]
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O8333
fatherSonIndex=0
frm_calc='System.out.println('Riga '+Str(conta+1,10,0)+" - Codice "+_conadd)
obj='Exec
pag=30
I
I
]
w=[
150
150
]
x=1194
y=550
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Titolari AGE Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Titolari AGE Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=40
prev=O8350
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=40
prev=O8349
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=40
prev=O8348
var_op='asgn
I
obj='Exec
pag=40
prev=O8347
I
obj='Exec
pag=40
prev=O8345
I
obj='While
pag=40
prev=O8344
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8345
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=40
prev=O8354
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O8355
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,159,10)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=40
prev=O8363
sons=[
Icpitembatch.CPItemSon
comment='Unicode Assente o vuoto
instr=Icpitembatch.CPVarDecl
father=O8366
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,36,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGATIT1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGATIT2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTIT\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='japotit
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='jntestit
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=40
prev=O8379
var_op='asgn
I
obj='Insert
pag=40
prev=O8378
rd_kfield=[
'CODCLI
'CODINTER
'DATAINI
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
]
rd_kvar=[
'Substr(riga,75,16)
'Substr(riga,50,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'Substr(riga,219,30)
'Substr(riga,9,25)
'nProgImp
'LibreriaMit.UniqueId()
]
I
obj='Var
obj_type='N
pag=40
prev=O8376
var_op='asgn
I
obj='Insert
pag=40
prev=O8375
rd_kfield=[
'CDATOPE
'CDATREG
'CODCAB
'CODDIPE
'CODINTER
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPTIT
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'IDBASE2
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'_intercab
'Substr(riga,115,6)
'_intercod
'Substr(riga,75,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'cInfProg1
'"T"+Right(cInfProg2,9)+_idb2
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,159,10)
'_idb2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8376
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=40
prev=O8389
I
obj='Var
obj_type='N
pag=40
prev=O8388
var_op='asgn
I
obj='Exec
pag=40
prev=O8387
I
nonlocal=True
obj='Var
obj_type='M
pag=40
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=40
prev=O8374
var_op='asgn
I
obj='Var
pag=40
prev=O8373
var_op='asgn
I
obj='Var
pag=40
prev=O8372
var_op='asgn
I
obj='Var
obj_type='D
pag=40
prev=O8371
var_op='asgn
I
obj='Var
pag=40
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='Aggiornamento
instr=Icpitembatch.CPWrite
arch='japotit
father=O8366
fatherSonIndex=1
obj='Write
pag=40
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_unicode
]
wr_field=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'OPRAP
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'CONNESCLI
'DATARETT
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'_intercab
'Substr(riga,115,6)
'_intercod
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'CharToDate(Right(Substr(riga,36,8),4)+Substr(Substr(riga,36,8),3,2)+Left(Substr(riga,36,8),2))
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'Left(Substr(riga,44,2),1)
'_interprv
'Substr(riga,9,25)
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,75,16)
'Date()
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=40
prev=O8362
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8363
fatherSonIndex=0
frm_calc='''
len=1
name='_tdest
next=Icpitembatch.CPRead
arch='japotit
obj='Read
pag=40
prev=O8403
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,159,10)
]
rd_var=[
'_unicode
]
I
obj='Var
pag=40
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=40
prev=O8360
var_op='asgn
I
obj='Begin
pag=40
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8360
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,104,11))),_codinter,Substr(riga,104,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,121,30))),_citinter,Substr(riga,121,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,153,6))),_cabinter,Substr(riga,153,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,151,2))),_prvinter,Substr(riga,151,2))
len=2
name='_interprv
obj='Var
pag=40
prev=O8414
var_op='asgn
I
obj='Var
pag=40
prev=O8413
var_op='asgn
I
obj='Var
pag=40
prev=O8412
var_op='asgn
I
obj='Var
pag=40
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=40
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=40
prev=O8343
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=40
prev=O8342
var_op='asgn
I
obj='Var
obj_type='N
pag=40
prev=O8341
var_op='asgn
I
obj='Var
obj_type='N
pag=40
prev=O8340
var_op='asgn
I
obj='Remark
pag=40
x=14
y=18
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Titolari Effettivi AGE Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Titolari Effettivi AGE Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=41
prev=O8429
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=41
prev=O8428
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=41
prev=O8427
var_op='asgn
I
obj='Exec
pag=41
prev=O8426
I
obj='Exec
pag=41
prev=O8424
I
obj='While
pag=41
prev=O8423
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8424
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
obj='Var
pag=41
prev=O8435
var_op='asgn
I
obj='If
pag=41
prev=O8434
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O8435
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=41
prev=O8441
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='jntestit
father=O8443
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=41
prev=O8448
var_op='asgn
I
obj='Write
pag=41
rd_kfield=[
'CODCLI
'CODINTER
'RAPPORTO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'Left(riga,25)
]
wr_field=[
'DESCINTER
'DATAINI
]
wr_op=[
'=
'=
]
wr_var=[
'Substr(riga,66,30)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8443
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='jntestit
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=41
prev=O8458
var_op='asgn
I
obj='Insert
pag=41
prev=O8457
rd_kfield=[
'CODCLI
'CODINTER
'DATAINI
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'Substr(riga,66,30)
'Left(riga,25)
'nProgImp
'LibreriaMit.UniqueId()
]
I
obj='Var
obj_type='N
pag=41
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=41
sel_field='jntestit->IDBASE
sel_name='jntestit
sel_where='jntestit->CODCLI=Substr(riga,26,16) and jntestit->CODINTER=Substr(riga,42,16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8441
fatherSonIndex=0
frm_calc='1
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=41
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=41
prev=O8433
var_op='asgn
I
obj='Var
obj_type='M
pag=41
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=41
prev=O8422
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=41
prev=O8421
var_op='asgn
I
obj='Var
obj_type='N
pag=41
prev=O8420
var_op='asgn
I
obj='Var
obj_type='N
pag=41
prev=O8419
var_op='asgn
I
obj='Remark
pag=41
x=16
y=18
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Saldi SV Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Saldi SV Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=42
prev=O8479
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=42
prev=O8478
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=42
prev=O8477
var_op='asgn
I
obj='Exec
pag=42
prev=O8476
I
obj='Exec
pag=42
prev=O8474
I
obj='While
pag=42
prev=O8473
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8474
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
obj='Var
pag=42
prev=O8485
var_op='asgn
I
obj='If
pag=42
prev=O8484
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='saldi_idp
father=O8485
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'm_nUpdatedRows=0
]
h=[
19
19
]
obj='If
pag=42
prev=O8491
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='saldi_idp
father=O8492
fatherSonIndex=0
obj='Insert
pag=42
rd_kfield=[
'RAPPORTO
'ANNO
'TRIMESTRE
'IMPORTO
'IDBASE
]
rd_kvar=[
'LRTrim(Left(riga,25))
'LRTrim(Substr(riga,26,4))
'LRTrim(Substr(riga,30,1))
'Val(LRTrim(Substr(riga,31,15)))/100
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=42
rd_kfield=[
'RAPPORTO
'ANNO
'TRIMESTRE
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'LRTrim(Left(riga,25))
'LRTrim(Substr(riga,26,4))
'LRTrim(Substr(riga,30,1))
]
wr_field=[
'IMPORTO
]
wr_op=[
'=
]
wr_var=[
'Val(LRTrim(Substr(riga,31,15)))/100
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=42
prev=O8483
var_op='asgn
I
obj='Var
obj_type='M
pag=42
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=42
prev=O8472
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=42
prev=O8471
var_op='asgn
I
obj='Var
obj_type='N
pag=42
prev=O8470
var_op='asgn
I
obj='Var
obj_type='N
pag=42
prev=O8469
var_op='asgn
I
obj='Remark
pag=42
x=15
y=25
I
Icpitembatch.CPBeginEnd
comment='Scrive Importo
h=[
19
19
]
obj='Begin
pag=43
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8509
fatherSonIndex=0
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPIfElse
frm_calc=[
'At('archope.txt',Lower(nomefileimport)) <> 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=43
prev=O8513
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O8514
fatherSonIndex=0
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni modificate: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','OPERAZBO','Operazioni modificate: '+LRTrim(Str(cNumNew,10,0)))
obj='Exec
pag=43
prev=O8529
I
nonlocal=True
obj='Var
obj_type='M
pag=43
prev=O8528
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=43
prev=O8527
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=43
prev=O8526
var_op='asgn
I
obj='Exec
pag=43
prev=O8525
I
obj='Exec
pag=43
prev=O8523
I
obj='While
pag=43
prev=O8522
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8523
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=43
prev=O8533
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O8534
fatherSonIndex=0
frm_calc=[
'Len(LRTrim(Substr(riga,331,9))) > 0
]
h=[
19
19
]
obj='If
pag=43
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8539
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,871,19))),0,Val(LRTrim(Substr(riga,871,19))))
len=15
name='_totout
next=Icpitembatch.CPIfElse
frm_calc=[
'Upper(Substr(riga,331,9))='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=43
prev=O8545
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O8546
fatherSonIndex=0
obj='Write
pag=43
rd_kfield=[
'RIFIMP
'INFORM
]
rd_kop=[
'=
'=
]
rd_kvar=[
''XXXXXXXXX'
'Substr(riga,424,30)
]
wr_field=[
'IMPOUT
]
wr_op=[
'=
]
wr_var=[
'_totout/100
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O8546
fatherSonIndex=1
obj='Write
pag=43
rd_kfield=[
'RIFIMP
]
rd_kop=[
'=
]
rd_kvar=[
'Substr(riga,331,9)
]
wr_field=[
'IMPOUT
]
wr_op=[
'=
]
wr_var=[
'_totout/100
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=43
prev=O8544
var_op='asgn
I
obj='Var
obj_type='N
pag=43
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=43
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=43
prev=O8521
var_op='asgn
I
obj='Var
pag=43
prev=O8520
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=43
prev=O8519
var_op='asgn
I
obj='Remark
pag=43
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O8514
fatherSonIndex=1
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Frazionate modificate: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','FRAZIOBO','Frazionate modificate: '+LRTrim(Str(cNumNew,10,0)))
obj='Exec
pag=43
prev=O8581
I
nonlocal=True
obj='Var
obj_type='M
pag=43
prev=O8580
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=43
prev=O8579
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=43
prev=O8578
var_op='asgn
I
obj='Exec
pag=43
prev=O8577
I
obj='Exec
pag=43
prev=O8575
I
obj='While
pag=43
prev=O8574
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8575
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=43
prev=O8585
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O8586
fatherSonIndex=0
frm_calc=[
'Len(LRTrim(Substr(riga,331,9))) > 0
]
h=[
19
19
]
obj='If
pag=43
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8591
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,871,19))),0,Val(LRTrim(Substr(riga,871,19))))
len=15
name='_totout
next=Icpitembatch.CPIfElse
frm_calc=[
'Upper(Substr(riga,331,9))='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=43
prev=O8597
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='fraziobo
father=O8598
fatherSonIndex=0
obj='Write
pag=43
rd_kfield=[
'RIFIMP
'INFORM
]
rd_kop=[
'=
'=
]
rd_kvar=[
''XXXXXXXXX'
'Substr(riga,424,30)
]
wr_field=[
'IMPOUT
]
wr_op=[
'=
]
wr_var=[
'_totout/100
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='fraziobo
father=O8598
fatherSonIndex=1
obj='Write
pag=43
rd_kfield=[
'RIFIMP
]
rd_kop=[
'=
]
rd_kvar=[
'Substr(riga,331,9)
]
wr_field=[
'IMPOUT
]
wr_op=[
'=
]
wr_var=[
'_totout/100
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=43
prev=O8596
var_op='asgn
I
obj='Var
obj_type='N
pag=43
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=43
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=43
prev=O8573
var_op='asgn
I
obj='Var
pag=43
prev=O8572
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=43
prev=O8571
var_op='asgn
I
obj='Remark
pag=43
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=43
var_op='asgn
I
I
]
w=[
150
150
]
x=17
y=20
I
]
ManualBlocks={
'BO - Header
Icpmanualblocks.CPManualBlocks
code='import java.io.File; ﷯import java.lang.Double;﷯import java.util.*;﷯import jxl.*;
name='BO - Header
I
'BO - Properties
Icpmanualblocks.CPManualBlocks
code='public String[] lista;﷯public int conteggio;﷯public int i;﷯public int _i;﷯public int _y;﷯public int contanome;﷯public int _righe;﷯public int _conta;﷯// These are the files to include in the ZIP file﷯Vector filenames = new Vector();﷯Vector fileonames = new Vector();
name='BO - Properties
I
}
comment='Importa i dati (NOZIP)
date_creat=#2006-06-20
date_rev=#2018-07-03
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'Utilities
'LibreriaMit
'FileLibMit
]
merge=True
modcnt=889
page_result_class=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
page_result_type=[
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
]
page_uid=[
'AHVZNXKOOX
'UKNWCURIZP
'VVERNPVGUJ
'NJDAPTIXHB
'NFQSTSMLAX
'RCTYUXDSQE
'CWXSSFAJKR
'VNWRBRKHOR
'LXYVCNDGXJ
'KBUDYHROVZ
'LYNZFJMARF
'BCDDIGVWEI
'NUVUGANGKH
'BCDBVDAIGN
'YWNGYQEOIM
'ODNUMZRUDM
'UQWVLYOUPO
'XYQTYCJDVF
'WPSSXVVPRN
'LCTYRIXNIR
'QFVUWDOVQJ
'EHJFKSDXAO
'KQLYCRCEND
'VWJMLMOSBD
'CRYCRJTMVP
'WXKLUXETTU
'TQQWCTNMUY
'WFXJLTAYZL
'JUYFDWZDHT
'FPPFVQERKU
'DHMUHURINX
'WYHNUACAYF
'DUMJTRBFGI
'RECUSIAFWL
'FOQQGPLWGB
'LBCELHVYJS
'QIPRKRDCMO
'GIQREITNVH
'JBOYCPPZUI
'TEKDKQDIEN
'JDJFXRYRYA
'KJQXTVBEBH
'DMTAFLPTEW
]
pagename=[
'Page_1
'Page_2
'Page_3
'Page_4
'Page_5
'Page_6
'Page_7
'Page_8
'Page_9
'Page_10
'Page_11
'Page_12
'Page_13
'Page_14
'Page_15
'Page_16
'Page_17
'Page_18
'Page_19
'Page_20
'Page_21
'Page_22
'Page_23
'Page_24
'Page_25
'Page_26
'Page_27
'Page_28
'Page_29
'Page_30
'Page_31
'Page_32
'Page_33
'Page_34
'Page_35
'Page_36
'Page_37
'Page_38
'Page_39
'Page_40
'Page_41
'Page_42
'Page_43
]
pagenote=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
pagetitle=[
'Main
'Soggetti
'Rapporti
'Informazioni
'Operazioni
'Frazionate
'Rapporti Provvisorio
'Informazioni Provvisorio
'Operazioni Provvisorio
'Frazionarie Provvisorio
'Rapporti Agenzia Entrate
'Informazioni Agenzia Entrate
'Operazioni Agenzia Entrate
'Dipendenze
'Titolari Effettivi
'Operazioni extraconto
'Procuratori/delegati su rapporto
'Soggetti operanti
'Intestatari
'Procuratori/delegati su rapporto Provvisorio
'Soggetti operanti Provvisorio
'Intestatari Provvisorio
'Procuratori/delegati su rapporto Agenzia Entrate
'Soggetti operanti Agenzia Entrate
'Intestatari Agenzia Entrate
'Altri Intestatari Rapporti
'Inserisce priorità sui nomi file
'Altri Beneficiari Operazioni
'Altri Soggetti Operanti Operazioni
'Modifiche Soggetti
'Movimento per AGE
'Controllo Anagrafiche
'Saldi Operazioni Extraconto
'Saldi Rapporti Continuativi
'Altri Titolari Effettivi
'Crea il file Zip
'Operazioni Definitive XLS
'Operazioni Provvisorie XLS
'Estrai zip
'Titolari AGE
'Altri Titolari AGE
'SALDI SV
'Importo Netto Operazioni
]
runtime_filters=2
tpl_name='Function
work_file=[
'aeannora
'aeopcanc
'aeoprig
'aeopstor
'aetesta
'anadip
'anarapbo
'beneficfrz
'beneficope
'clientifrz
'clientiope
'cpwarn
'delegabo
'fiduciabo
'fraziobo
'intermbo
'intestbo
'intestit
'japopebo
'jelegabo
'jnarapbo
'jntestbo
'joginfo
'jogopebo
'jperazbo
'knarapbo
'meneficfrz
'meneficope
'merzistifrz
'merzistiope
'mlientifrz
'mlientiope
'mogopebo
'mogopefbo
'operazbo
'opextrbo
'personbo
'rapopebo
'rapotit
'soginfo
'sogopebo
'sogopefbo
'tbcauana
'tbcitta
'tbstgru
'tbvalute
'terzistifrz
'terzistiope
'titolabo
'titopers
'tmp_errimp
'tmp_list_imprich
'tmp_listafile
'wersonbo
'xapopebo
'xapotit
'xelegabo
'xeneficfrz
'xeneficope
'xerzistifrz
'xerzistiope
'xiduciabo
'xlientifrz
'xlientiope
'xnarapbo
'xntestbo
'xntestit
'xoginfo
'xogopebo
'xogopefbo
'xperazbo
'xraziobo
'inter2bo
'xersonbo
'xnadip
'xarchope
'xarchfraz
'japotit
'jntestit
'personbo_agg
'saldi_idp
]
work_filter=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
I
*--*
*----*
