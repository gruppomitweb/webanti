* --- CodePainter Revolution Batch Vers. 5.1
￼Icpbatch.CPBatch
Items=[
Icpitembatch.CPRemark
frm_calc='Cicla su operazbo e seleziona i record nel range definito
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Operazioni Società Quotate' +NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_cope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_cope=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Operazioni Società Quotate' +NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O8
var_op='asgn
I
obj='If
pag=4
prev=O6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8
fatherSonIndex=0
frm_calc='gMsgProc + NL + 'Non sono presenti dati da elaborare nel file Operazioni Società Quotate' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8
fatherSonIndex=1
frm_calc='gMsgProc + NL + 'Sono stati elaborati '+LRTrim(Str(_cope,10,0))+' record del file Operazioni Società Quotate' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=4
par_expr=[
'_datini
'_datfin
]
par_name=[
'cdadata
'c_adata
]
prev=O5
sel_name='qbe_kpeuif
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6
fatherSonIndex=0
frm_calc='_contaop + 1
len=10
name='_contaop
next=Icpitembatch.CPVarDecl
frm_calc='_cope + 1
len=10
name='_cope
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Elaboro Operazione N. '+ LRTrim(Str(_contaop,10,0))
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPBeginEnd
comment='Inizializza variabili
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(qbe_kpeuif->RAPPORTO))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
prev=O25
sons=[
Icpitembatch.CPItemSon
comment='Se c'è il codice rapporto
instr=Icpitembatch.CPSelect
father=O27
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=4
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=LRTrim(qbe_kpeuif->RAPPORTO)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O32
fatherSonIndex=0
frm_calc=[
'intestbo->DATAINI <= qbe_kpeuif->DATAOPE and (Empty(intestbo->DATAFINE) or intestbo->DATAFINE >= qbe_kpeuif->DATAOPE)
]
h=[
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O36
fatherSonIndex=0
frm_calc='''
len=1
name='_sesso
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_perpaese)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'(Empty(_perpaese) and Empty(_percab)) or (_perpaese='086' and Empty(_percab))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_settsint)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_sesso))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_settsint)) and _settsint='999'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(qbe_kpeuif->CODDIPE)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_codcab) and not(Empty(qbe_kpeuif->CODDIPE))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(qbe_kpeuif->CODVOC)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(qbe_kpeuif->SEGNO)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'At(LRTrim(qbe_kpeuif->CODVOC),'|1B|2B|3B|4B|5B|6B|3M|4M|5M|6M|1R|2R') > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_errore)))
]
h=[
19
19
]
obj='If
pag=4
prev=O70
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O73
fatherSonIndex=0
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPIfElse
frm_calc=[
'pTipo='Z'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
prev=O78
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O79
fatherSonIndex=0
frm_calc='-- Inserimento per reimport dei errori corretti
next=Icpitembatch.CPInsert
arch='tmp_stpoperazioni
obj='Insert
pag=4
prev=O84
rd_kfield=[
'AUTOM
'C_CAB
'C_CTA
'C_IND
'C_STA
'CABICP
'CAMBIO
'CDATOPE
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNESBEN
'CONNESCLI
'CONNESCOL
'CONNESOPER
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'ERR01
'ERR02
'ERR03
'ERR04
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'IDFILE
'INFORM
'IPCOLLEG
'MODSVOL
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PAESECP
'PROV2
'PROVINCIA
'RAGCLI
'RAPPORTBEN
'RAPPORTO
'RESPINS
'RIFIMP
'SCOPO
'SEGNO
'SETTSINTAGG
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'TXTNOTE
'UCODE
'VALUTA
]
rd_kvar=[
'qbe_kpeuif->AUTOM
'qbe_kpeuif->C_CAB
'qbe_kpeuif->DESCRIZ
'qbe_kpeuif->CODDIP
'qbe_kpeuif->C_STA
'qbe_kpeuif->CABCLI
'qbe_kpeuif->CAMBIO
'qbe_kpeuif->CDATOPE
'qbe_kpeuif->CODANA
'qbe_kpeuif->CODCAB
'qbe_kpeuif->CODCAB2
'qbe_kpeuif->CODDIPE
'qbe_kpeuif->CODINT2
'qbe_kpeuif->CODINTER
'qbe_kpeuif->CODVOC
'qbe_kpeuif->COLLEG
'qbe_kpeuif->CONNESBEN
'qbe_kpeuif->CONNESCLI
'qbe_kpeuif->CONNESCLI
'qbe_kpeuif->CONNESOPER
'qbe_kpeuif->DATAOPE
'qbe_kpeuif->DATAREG
'qbe_kpeuif->DATARETT
'qbe_kpeuif->DESCCITCLI
'qbe_kpeuif->DESCCIT
'qbe_kpeuif->DESCINTER
'qbe_kpeuif->DOCFILE
''N'
''N'
''N'
''N'
'qbe_kpeuif->FLAGCONT
'qbe_kpeuif->FLAGFRAZ
'qbe_kpeuif->FLAGLIRE
'qbe_kpeuif->FLAGRAP
'qbe_kpeuif->FLAGRAP2
'qbe_kpeuif->IDBASE
'qbe_kpeuif->idcauana
'qbe_kpeuif->IDEREG
'qbe_kpeuif->DESCCITD
'qbe_kpeuif->INFORM
'qbe_kpeuif->CODFISC
'qbe_kpeuif->MODSVOL
'qbe_kpeuif->NUMPROG
'qbe_kpeuif->OPERAG
'qbe_kpeuif->OPERATORE
'qbe_kpeuif->OPERAZMOD
'qbe_kpeuif->OPRAP
'qbe_kpeuif->PAESE
'qbe_kpeuif->PAESECLI
'qbe_kpeuif->PROV2
'qbe_kpeuif->PROVINCIA
'qbe_kpeuif->RAGSOC
'qbe_kpeuif->RAPPORTBEN
'qbe_kpeuif->RAPPORTO
'qbe_kpeuif->RESPINS
'qbe_kpeuif->RIFIMP
'qbe_kpeuif->CABDIP
'qbe_kpeuif->SEGNO
'qbe_kpeuif->SETTSINT
'qbe_kpeuif->STATOREG
''KPE'
'qbe_kpeuif->TIPOINF
'qbe_kpeuif->TIPOINT2
'qbe_kpeuif->TIPOINTER
'qbe_kpeuif->TIPOLEG
'qbe_kpeuif->TIPOOPRAP
'qbe_kpeuif->TOTCONT/100
'qbe_kpeuif->TOTLIRE/100
'_errore
'qbe_kpeuif->SOTGRUP
'qbe_kpeuif->VALUTA
]
I
obj='Remark
pag=4
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O79
fatherSonIndex=1
frm_calc='-- classico inserimento
next=Icpitembatch.CPInsert
arch='tmp_stpoperazioni
obj='Insert
pag=4
prev=O89
rd_kfield=[
'AUTOM
'CAMBIO
'CDATOPE
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNESBEN
'CONNESCLI
'CONNESCOL
'CONNESOPER
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'ERR01
'ERR02
'ERR03
'ERR04
'ERR05
'ERR06
'ERR07
'ERR08
'ERR09
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'MODSVOL
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PROV2
'PROVINCIA
'RAPPORTBEN
'RAPPORTO
'RESPINS
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'TXTNOTE
'VALUTA
]
rd_kvar=[
'qbe_kpeuif->AUTOM
'qbe_kpeuif->CAMBIO
'qbe_kpeuif->CDATOPE
'qbe_kpeuif->CODANA
'qbe_kpeuif->CODCAB
'qbe_kpeuif->CODCAB2
'qbe_kpeuif->CODDIPE
'qbe_kpeuif->CODINT2
'qbe_kpeuif->CODINTER
'qbe_kpeuif->CODVOC
'qbe_kpeuif->COLLEG
'qbe_kpeuif->CONNESBEN
'qbe_kpeuif->CONNESCLI
'qbe_kpeuif->CONNESCLI
'qbe_kpeuif->CONNESOPER
'qbe_kpeuif->DATAOPE
'qbe_kpeuif->DATAREG
'qbe_kpeuif->DATARETT
'qbe_kpeuif->DESC2
'qbe_kpeuif->DESCCIT
'qbe_kpeuif->DESCINTER
'qbe_kpeuif->DOCFILE
'_err01
'_err02
'_err03
'_err04
'_err05
'_err06
'_err07
'_err08
'_err09
'qbe_kpeuif->FLAGCONT
'qbe_kpeuif->FLAGFRAZ
'qbe_kpeuif->FLAGLIRE
'qbe_kpeuif->FLAGRAP
'qbe_kpeuif->FLAGRAP2
'qbe_kpeuif->IDBASE
'qbe_kpeuif->idcauana
'qbe_kpeuif->IDEREG
'qbe_kpeuif->INFORM
'qbe_kpeuif->MODSVOL
'qbe_kpeuif->NUMPROG
'qbe_kpeuif->OPERAG
'qbe_kpeuif->OPERATORE
'qbe_kpeuif->OPERAZMOD
'qbe_kpeuif->OPRAP
'qbe_kpeuif->PAESE
'qbe_kpeuif->PROV2
'qbe_kpeuif->PROVINCIA
'qbe_kpeuif->RAPPORTBEN
'qbe_kpeuif->RAPPORTO
'qbe_kpeuif->RESPINS
'qbe_kpeuif->SEGNO
'qbe_kpeuif->STATOREG
''KPE'
'qbe_kpeuif->TIPOINF
'qbe_kpeuif->TIPOINT2
'qbe_kpeuif->TIPOINTER
'qbe_kpeuif->TIPOLEG
'qbe_kpeuif->TIPOOPRAP
'qbe_kpeuif->TOTCONT/100
'qbe_kpeuif->TOTLIRE/100
'_errore
'qbe_kpeuif->VALUTA
]
I
obj='Remark
pag=4
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O67
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O70
fatherSonIndex=0
frm_calc=[
'Empty(qbe_kpeuif->C_STA)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(qbe_kpeuif->PAESE)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
prev=O97
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O100
fatherSonIndex=0
frm_calc='_errore + 'Manca Paese Intermediario Controparte' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err08
obj='Var
pag=4
prev=O105
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O100
fatherSonIndex=1
frm_calc='''
len=3
name='_stato
next=Icpitembatch.CPIfElse
frm_calc=[
'mcStati.GoToKey(qbe_kpeuif->PAESE)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_stato)
]
h=[
19
19
]
obj='If
pag=4
prev=O109
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O112
fatherSonIndex=0
frm_calc='_errore + 'Paese Intermediario Controparte Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err08
obj='Var
pag=4
prev=O117
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O108
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O109
fatherSonIndex=0
frm_calc='mcStati.CODSTA
len=3
name='_stato
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O97
fatherSonIndex=0
frm_calc='_errore + 'Manca Paese Residenza Controparte' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err06
obj='Var
pag=4
prev=O127
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O97
fatherSonIndex=1
frm_calc='''
len=3
name='_stato
next=Icpitembatch.CPIfElse
frm_calc=[
'mcStati.GoToKey(qbe_kpeuif->C_STA)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_stato)
]
h=[
19
19
]
obj='If
pag=4
prev=O131
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O134
fatherSonIndex=0
frm_calc='_errore + 'Paese Residenza Controparte Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err06
obj='Var
pag=4
prev=O139
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O130
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O131
fatherSonIndex=0
frm_calc='mcStati.CODSTA
len=3
name='_stato
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O64
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O67
fatherSonIndex=0
frm_calc='_errore + 'Manca Segno Operazione' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err11
obj='Var
pag=4
prev=O150
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O61
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O64
fatherSonIndex=0
frm_calc='_errore + 'Manca CAUSALE SINTETICA' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err10
obj='Var
pag=4
prev=O155
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O58
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O61
fatherSonIndex=0
frm_calc='_errore + 'Manca CAB Dipendeza / Agenzia' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err05
obj='Var
pag=4
prev=O160
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O55
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O58
fatherSonIndex=0
frm_calc='_errore + 'Manca Codce Agenzia' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err05
obj='Var
pag=4
prev=O165
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O52
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O55
fatherSonIndex=0
frm_calc='_errore +  'Settore sintetico 999 non valido per SARA'
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err04
obj='Var
pag=4
prev=O170
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O49
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O52
fatherSonIndex=0
frm_calc=[
'(_settsint<>'600' or _settsint<>'601') and _perpaese='086'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_settsint<>'711' and _perpaese<>'086'
]
h=[
19
19
]
obj='If
pag=4
prev=O175
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O178
fatherSonIndex=0
frm_calc='_errore + "Settore Sintetico Cliente Residente all'Estero Errato"
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err03
obj='Var
pag=4
prev=O183
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O175
fatherSonIndex=0
frm_calc='_errore + 'Settore Sintetico Cliente Residente in Italia Errato'
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err03
obj='Var
pag=4
prev=O188
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O46
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O49
fatherSonIndex=0
frm_calc='_errore + 'Manca Settore Sintetico Cliente'
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err03
obj='Var
pag=4
prev=O194
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O43
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O46
fatherSonIndex=0
frm_calc='_errore + 'Manca CAB Residenza Cliente' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err02
obj='Var
pag=4
prev=O199
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O42
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O43
fatherSonIndex=0
frm_calc='_errore + 'Manca Paese Residenza Cliente' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err01
obj='Var
pag=4
prev=O204
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O43
fatherSonIndex=1
frm_calc='''
len=3
name='_stato
next=Icpitembatch.CPIfElse
frm_calc=[
'mcStati.GoToKey(_perpaese)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_stato)
]
h=[
19
19
]
obj='If
pag=4
prev=O208
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O211
fatherSonIndex=0
frm_calc='_errore + 'Paese Residenza Cliente Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err01
obj='Var
pag=4
prev=O216
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O207
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O208
fatherSonIndex=0
frm_calc='mcStati.CODSTA
len=3
name='_stato
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=4
prev=O41
rd_field=[
'CODCAB
'PAESE
'SETTSINT
'SESSO
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(intestbo->CODINTER)
]
rd_var=[
'_percab
'_perpaese
'_settsint
'_sesso
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O27
fatherSonIndex=1
frm_calc=[
'Empty(_perpaese)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_perpaese)) and _perpaese='030'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(Empty(_perpaese) and Empty(_percab)) or (_perpaese='086' and Empty(_percab))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_settsint)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_sesso))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_settsint)) and _settsint='999'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(qbe_kpeuif->CODDIPE)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_codcab) and not(Empty(qbe_kpeuif->CODDIPE))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'At(LRTrim(qbe_kpeuif->CODVOC),'|1B|2B|3B|4B|5B|6B|3M|4M|5M|6M|1R|2R') > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_errore)))
]
h=[
19
19
]
obj='If
pag=4
prev=O255
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O258
fatherSonIndex=0
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPIfElse
frm_calc=[
'pTipo='Z'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
prev=O263
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O264
fatherSonIndex=0
frm_calc='-- Inserimento per reimport dei errori corretti
next=Icpitembatch.CPInsert
arch='tmp_stpoperazioni
obj='Insert
pag=4
prev=O269
rd_kfield=[
'AUTOM
'C_CAB
'C_CTA
'C_IND
'C_STA
'CABICP
'CAMBIO
'CDATOPE
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNESBEN
'CONNESCLI
'CONNESCOL
'CONNESOPER
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'ERR01
'ERR02
'ERR03
'ERR04
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'IDFILE
'INFORM
'IPCOLLEG
'MODSVOL
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PAESECP
'PROV2
'PROVINCIA
'RAGCLI
'RAPPORTBEN
'RAPPORTO
'RESPINS
'RIFIMP
'SCOPO
'SEGNO
'SETTSINTAGG
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'TXTNOTE
'UCODE
'VALUTA
]
rd_kvar=[
'qbe_kpeuif->AUTOM
'qbe_kpeuif->C_CAB
'qbe_kpeuif->DESCRIZ
'qbe_kpeuif->CODDIP
'qbe_kpeuif->C_STA
'qbe_kpeuif->CABCLI
'qbe_kpeuif->CAMBIO
'qbe_kpeuif->CDATOPE
'qbe_kpeuif->CODANA
'qbe_kpeuif->CODCAB
'qbe_kpeuif->CODCAB2
'qbe_kpeuif->CODDIPE
'qbe_kpeuif->CODINT2
'qbe_kpeuif->CODINTER
'qbe_kpeuif->CODVOC
'qbe_kpeuif->COLLEG
'qbe_kpeuif->CONNESBEN
'qbe_kpeuif->CONNESCLI
'qbe_kpeuif->CONNESCLI
'qbe_kpeuif->CONNESOPER
'qbe_kpeuif->DATAOPE
'qbe_kpeuif->DATAREG
'qbe_kpeuif->DATARETT
'qbe_kpeuif->DESCCITCLI
'qbe_kpeuif->DESCCIT
'qbe_kpeuif->DESCINTER
'qbe_kpeuif->DOCFILE
''N'
''N'
''N'
''N'
'qbe_kpeuif->FLAGCONT
'qbe_kpeuif->FLAGFRAZ
'qbe_kpeuif->FLAGLIRE
'qbe_kpeuif->FLAGRAP
'qbe_kpeuif->FLAGRAP2
'qbe_kpeuif->IDBASE
'qbe_kpeuif->idcauana
'qbe_kpeuif->IDEREG
'qbe_kpeuif->DESCCITD
'qbe_kpeuif->INFORM
'qbe_kpeuif->CODFISC
'qbe_kpeuif->MODSVOL
'qbe_kpeuif->NUMPROG
'qbe_kpeuif->OPERAG
'qbe_kpeuif->OPERATORE
'qbe_kpeuif->OPERAZMOD
'qbe_kpeuif->OPRAP
'qbe_kpeuif->PAESE
'qbe_kpeuif->PAESECLI
'qbe_kpeuif->PROV2
'qbe_kpeuif->PROVINCIA
'qbe_kpeuif->RAGSOC
'qbe_kpeuif->RAPPORTBEN
'qbe_kpeuif->RAPPORTO
'qbe_kpeuif->RESPINS
'qbe_kpeuif->RIFIMP
'qbe_kpeuif->CABDIP
'qbe_kpeuif->SEGNO
'qbe_kpeuif->SETTSINT
'qbe_kpeuif->STATOREG
''KPE'
'qbe_kpeuif->TIPOINF
'qbe_kpeuif->TIPOINT2
'qbe_kpeuif->TIPOINTER
'qbe_kpeuif->TIPOLEG
'qbe_kpeuif->TIPOOPRAP
'qbe_kpeuif->TOTCONT/100
'qbe_kpeuif->TOTLIRE/100
'_errore
'qbe_kpeuif->SOTGRUP
'qbe_kpeuif->VALUTA
]
I
obj='Remark
pag=4
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O264
fatherSonIndex=1
frm_calc='-- classico inserimento
next=Icpitembatch.CPInsert
arch='tmp_stpoperazioni
obj='Insert
pag=4
prev=O274
rd_kfield=[
'AUTOM
'CAMBIO
'CDATOPE
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNESBEN
'CONNESCLI
'CONNESCOL
'CONNESOPER
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'ERR01
'ERR02
'ERR03
'ERR04
'ERR05
'ERR06
'ERR07
'ERR08
'ERR09
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'MODSVOL
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PROV2
'PROVINCIA
'RAPPORTBEN
'RAPPORTO
'RESPINS
'RIFIMP
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'TXTNOTE
'VALUTA
]
rd_kvar=[
'qbe_kpeuif->AUTOM
'qbe_kpeuif->CAMBIO
'qbe_kpeuif->CDATOPE
'qbe_kpeuif->CODANA
'qbe_kpeuif->CODCAB
'qbe_kpeuif->CODCAB2
'qbe_kpeuif->CODDIPE
'qbe_kpeuif->CODINT2
'qbe_kpeuif->CODINTER
'qbe_kpeuif->CODVOC
'qbe_kpeuif->COLLEG
'qbe_kpeuif->CONNESBEN
'qbe_kpeuif->CONNESCLI
'qbe_kpeuif->CONNESCLI
'qbe_kpeuif->CONNESOPER
'qbe_kpeuif->DATAOPE
'qbe_kpeuif->DATAREG
'qbe_kpeuif->DATARETT
'qbe_kpeuif->DESC2
'qbe_kpeuif->DESCCIT
'qbe_kpeuif->DESCINTER
'qbe_kpeuif->DOCFILE
'_err01
'_err02
'_err03
'_err04
'_err05
'_err06
'_err07
'_err08
'_err09
'qbe_kpeuif->FLAGCONT
'qbe_kpeuif->FLAGFRAZ
'qbe_kpeuif->FLAGLIRE
'qbe_kpeuif->FLAGRAP
'qbe_kpeuif->FLAGRAP2
'qbe_kpeuif->IDBASE
'qbe_kpeuif->idcauana
'qbe_kpeuif->IDEREG
'qbe_kpeuif->INFORM
'qbe_kpeuif->MODSVOL
'qbe_kpeuif->NUMPROG
'qbe_kpeuif->OPERAG
'qbe_kpeuif->OPERATORE
'qbe_kpeuif->OPERAZMOD
'qbe_kpeuif->OPRAP
'qbe_kpeuif->PAESE
'qbe_kpeuif->PROV2
'qbe_kpeuif->PROVINCIA
'qbe_kpeuif->RAPPORTBEN
'qbe_kpeuif->RAPPORTO
'qbe_kpeuif->RESPINS
'qbe_kpeuif->RIFIMP
'qbe_kpeuif->SEGNO
'qbe_kpeuif->STATOREG
''KPE'
'qbe_kpeuif->TIPOINF
'qbe_kpeuif->TIPOINT2
'qbe_kpeuif->TIPOINTER
'qbe_kpeuif->TIPOLEG
'qbe_kpeuif->TIPOOPRAP
'qbe_kpeuif->TOTCONT/100
'qbe_kpeuif->TOTLIRE/100
'_errore
'qbe_kpeuif->VALUTA
]
I
obj='Remark
pag=4
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O252
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O255
fatherSonIndex=0
frm_calc=[
'Empty(qbe_kpeuif->C_STA)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(qbe_kpeuif->PAESE)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
prev=O282
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O285
fatherSonIndex=0
frm_calc='_errore + 'Manca Paese Intermediario Controparte' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err08
obj='Var
pag=4
prev=O290
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O285
fatherSonIndex=1
frm_calc='''
len=3
name='_stato
next=Icpitembatch.CPIfElse
frm_calc=[
'mcStati.GoToKey(qbe_kpeuif->PAESE)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_stato)
]
h=[
19
19
]
obj='If
pag=4
prev=O294
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O297
fatherSonIndex=0
frm_calc='_errore + 'Paese Intermediario Controparte Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err08
obj='Var
pag=4
prev=O302
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O293
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O294
fatherSonIndex=0
frm_calc='mcStati.CODSTA
len=3
name='_stato
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O282
fatherSonIndex=0
frm_calc='_errore + 'Manca Paese Residenza Controparte' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err06
obj='Var
pag=4
prev=O312
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O282
fatherSonIndex=1
frm_calc='''
len=3
name='_stato
next=Icpitembatch.CPIfElse
frm_calc=[
'mcStati.GoToKey(qbe_kpeuif->C_STA)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_stato)
]
h=[
19
19
]
obj='If
pag=4
prev=O316
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O319
fatherSonIndex=0
frm_calc='_errore + 'Paese Residenza Controparte Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err06
obj='Var
pag=4
prev=O324
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O315
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O316
fatherSonIndex=0
frm_calc='mcStati.CODSTA
len=3
name='_stato
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O249
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O252
fatherSonIndex=0
frm_calc='_errore + 'Manca CAB Dipendenza / Agenzia' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err05
obj='Var
pag=4
prev=O335
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O246
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O249
fatherSonIndex=0
frm_calc='_errore + 'Manca Codce Agenzia' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err05
obj='Var
pag=4
prev=O340
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O243
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O246
fatherSonIndex=0
frm_calc='_errore + 'Settore sintetico 999 non valido per SARA'
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err04
obj='Var
pag=4
prev=O345
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O240
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O243
fatherSonIndex=0
frm_calc=[
'_settsint<>'600' and _perpaese='086'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_settsint<>'711' and _perpaese<>'086'
]
h=[
19
19
]
obj='If
pag=4
prev=O350
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O353
fatherSonIndex=0
frm_calc='_errore + "Settore Sintetico Cliente Residente all'Estero Errato"
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err03
obj='Var
pag=4
prev=O358
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O350
fatherSonIndex=0
frm_calc='_errore + 'Settore Sintetico Cliente Residente in Italia Errato'
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err03
obj='Var
pag=4
prev=O363
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O237
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O240
fatherSonIndex=0
frm_calc='_errore + 'Manca Settore Sintetico Cliente'
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err03
obj='Var
pag=4
prev=O369
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O234
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O237
fatherSonIndex=0
frm_calc='_errore + 'Manca CAB Residenza Cliente' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err02
obj='Var
pag=4
prev=O374
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O231
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O234
fatherSonIndex=0
frm_calc=''X'
len=1
name='_err01
next=Icpitembatch.CPVarDecl
frm_calc='_errore + 'Paese di residenza non valido (030)' + NL
len=10
name='_errore
obj='Var
obj_type='M
pag=4
prev=O379
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O231
fatherSonIndex=0
frm_calc='_errore + 'Manca Paese Residenza Cliente' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err01
obj='Var
pag=4
prev=O384
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O231
fatherSonIndex=1
frm_calc='''
len=3
name='_stato
next=Icpitembatch.CPIfElse
frm_calc=[
'mcStati.GoToKey(_perpaese)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_stato) or (not(Empty(_stato)) and _stato='030')
]
h=[
19
19
]
obj='If
pag=4
prev=O388
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O391
fatherSonIndex=0
frm_calc='_errore + 'Paese Residenza Cliente Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err01
obj='Var
pag=4
prev=O396
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O387
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O388
fatherSonIndex=0
frm_calc='mcStati.CODSTA
len=3
name='_stato
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=4
prev=O24
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O25
fatherSonIndex=0
frm_calc='''
len=1
name='_err01
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err02
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err03
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err04
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err05
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err06
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err07
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err08
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err09
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err10
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err11
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc='qbe_kpeuif->PAESECLI
len=3
name='_perpaese
next=Icpitembatch.CPVarDecl
frm_calc='qbe_kpeuif->CABCLI
len=6
name='_percab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(qbe_kpeuif->CODCAB),qbe_kpeuif->CABDIP,qbe_kpeuif->CODCAB)
len=6
name='_codcab
next=Icpitembatch.CPVarDecl
frm_calc='qbe_kpeuif->SETTSINT
len=3
name='_settsint
next=Icpitembatch.CPVarDecl
frm_calc='qbe_kpeuif->SESSO
len=1
name='_sesso
obj='Var
pag=4
prev=O422
var_op='asgn
I
obj='Var
pag=4
prev=O421
var_op='asgn
I
obj='Var
pag=4
prev=O420
var_op='asgn
I
obj='Var
pag=4
prev=O419
var_op='asgn
I
obj='Var
pag=4
prev=O418
var_op='asgn
I
obj='Var
obj_type='M
pag=4
prev=O417
var_op='asgn
I
obj='Var
pag=4
prev=O416
var_op='asgn
I
obj='Var
pag=4
prev=O415
var_op='asgn
I
obj='Var
pag=4
prev=O414
var_op='asgn
I
obj='Var
pag=4
prev=O413
var_op='asgn
I
obj='Var
pag=4
prev=O412
var_op='asgn
I
obj='Var
pag=4
prev=O411
var_op='asgn
I
obj='Var
pag=4
prev=O410
var_op='asgn
I
obj='Var
pag=4
prev=O409
var_op='asgn
I
obj='Var
pag=4
prev=O408
var_op='asgn
I
obj='Var
pag=4
prev=O407
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=4
prev=O23
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O22
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O4
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O3
var_op='asgn
I
obj='Remark
pag=4
x=18
y=21
I
Icpitembatch.CPBeginEnd
comment='Parametri
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Variabili Globali
next=Icpitembatch.CPVarDecl
comment='Path Applicazione
global=True
len=80
name='gPathApp
next=Icpitembatch.CPVarDecl
comment='Tipo Intermediario
global=True
len=2
name='gTipInter
next=Icpitembatch.CPVarDecl
comment='Intermediario
global=True
len=11
name='gIntemediario
next=Icpitembatch.CPVarDecl
comment='Azienda
global=True
len=10
name='gAzienda
next=Icpitembatch.CPVarDecl
comment='Descrizione Intermediario
global=True
len=70
name='gDescAzi
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Definizione MC e Row
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Assegna valore a variabili
next=Icpitembatch.CPVarDecl
frm_calc='w_DaDatOpe
len=8
name='_ddatini
next=Icpitembatch.CPVarDecl
frm_calc='w_ADatOpe
len=8
name='_ddatfin
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(_ddatini)
len=8
name='_datini
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(_ddatfin)
len=8
name='_datfin
next=Icpitembatch.CPVarDecl
frm_calc='w_DaDatOpe
len=8
name='w_dadata
next=Icpitembatch.CPVarDecl
frm_calc='w_ADatOpe
len=8
name='w_adata
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(w_DaDatOpe)
len=8
name='cdadata
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(w_ADatOpe)
len=8
name='c_adata
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(w_tipocr),gTipInter,w_tipocr)
len=2
name='_tipcentro
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(w_codcr),gIntemediario,w_codcr)
len=11
name='_codcentro
next=Icpitembatch.CPBeginEnd
comment='Crea i file appoggio e carica il memory cursor
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifica le operazioni da trasportare
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Ora Inizio Estrazione Dati:'+arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'pTipo='R'
'pTipo='X' or pTipo='Z'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='gMsgProc + 'Record con presenza di anomalie:'+LRTrim(Str(_conta,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='gMsgProc + 'Ora Fine Estrazione Dati:'+arfn_fdatetime(DateTime())
global=True
len=10
name='gMsgProc
next=Ispitembatch.CPReturn
frm_calc='_conta
obj='Return
pag=1
prev=O463
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O462
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O459
var_op='asgn
I
obj='If
pag=1
prev=O457
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O459
fatherSonIndex=0
frm_calc=[
'_conta=0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Estrazione dati terminata! Procedere con la stampa'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=1
prev=O467
var_op='asgn
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tmp_stpoperazioni
father=O467
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'IDBASE
]
rd_kvar=[
''0123456789'
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O459
fatherSonIndex=1
frm_calc=[
'_conta=0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Estrazione dati terminata! Procedere con l'estrazione del file Excel"
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=1
prev=O478
var_op='asgn
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tmp_stpoperazioni
father=O478
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'IDBASE
]
rd_kvar=[
''0123456789'
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Try
pag=1
prev=O456
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O457
fatherSonIndex=0
frm_calc='2
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgfrazionate='S'
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='page
frm_calc='4
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=1
prev=O495
I
obj='Exec
pag=1
prev=O492
I
obj='If
pag=1
prev=O491
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O492
fatherSonIndex=0
frm_calc='3
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O457
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=1
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=1
prev=O455
I
obj='Var
obj_type='N
pag=1
prev=O454
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O453
var_op='asgn
I
obj='Remark
pag=1
prev=O451
I
obj='Begin
pag=1
prev=O450
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDropTemporaryTable
father=O451
fatherSonIndex=0
next=Icpitembatch.CPServerTemporaryTable
next=Ispitembatch.CPMemoryCursor
data_source='tbcitta
key_expression='tbcitta->CAB
mem_curs_name='mcCitta
next=Ispitembatch.CPMemoryCursor
data_source='tbstati
key_expression='tbstati->CODSTA
mem_curs_name='mcStati
obj='MemoryCursor
pag=1
prev=O508
sel_field='*
sel_name='tbstati
sel_type='fltb
I
obj='MemoryCursor
pag=1
prev=O507
sel_field='*
sel_name='tbcitta
sel_type='fltb
I
obj='TempTable
pag=1
prev=O506
sel_type='def
server_table='tmp_stpoperazioni
I
obj='DropTempTable
pag=1
server_table='tmp_stpoperazioni
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O449
var_op='asgn
I
obj='Var
pag=1
prev=O448
var_op='asgn
I
obj='Var
pag=1
prev=O447
var_op='asgn
I
obj='Var
pag=1
prev=O446
var_op='asgn
I
obj='Var
obj_type='D
pag=1
prev=O445
var_op='asgn
I
obj='Var
obj_type='D
pag=1
prev=O444
var_op='asgn
I
obj='Var
pag=1
prev=O443
var_op='asgn
I
obj='Var
pag=1
prev=O442
var_op='asgn
I
obj='Var
obj_type='D
pag=1
prev=O441
var_op='asgn
I
obj='Var
obj_type='D
pag=1
prev=O440
var_op='asgn
I
obj='Remark
pag=1
prev=O438
I
obj='Begin
pag=1
prev=O436
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O438
fatherSonIndex=0
frm_seek='tbcitta
name='mcCitta
next=Icpitembatch.CPVarDecl
frm_seek='tbstati
name='mcStati
obj='Var
obj_type='MC
pag=1
prev=O513
I
obj='Var
obj_type='MC
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O435
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O436
fatherSonIndex=0
len=2
name='_tipcentro
next=Icpitembatch.CPVarDecl
len=11
name='_codcentro
next=Icpitembatch.CPVarDecl
len=3
name='_settsint
next=Icpitembatch.CPVarDecl
len=3
name='_ramogrp
next=Icpitembatch.CPVarDecl
len=3
name='_sotgru
next=Icpitembatch.CPVarDecl
len=10
name='_appconta
next=Icpitembatch.CPVarDecl
len=10
name='_totconta
next=Icpitembatch.CPVarDecl
len=10
name='_conta
next=Icpitembatch.CPVarDecl
len=6
name='_codcab
next=Icpitembatch.CPVarDecl
len=2
name='_provin
next=Icpitembatch.CPVarDecl
len=3
name='_paese
next=Icpitembatch.CPVarDecl
len=10
name='_testo
next=Icpitembatch.CPVarDecl
len=20
name='_file
next=Icpitembatch.CPVarDecl
len=8
name='cdadata
next=Icpitembatch.CPVarDecl
len=8
name='c_adata
next=Icpitembatch.CPVarDecl
len=8
name='w_dadata
next=Icpitembatch.CPVarDecl
len=8
name='w_adata
next=Icpitembatch.CPVarDecl
len=12
name='_mesi
next=Icpitembatch.CPVarDecl
len=1
name='_mese
next=Icpitembatch.CPVarDecl
len=6
name='_codcab2
next=Icpitembatch.CPVarDecl
len=2
name='_provin2
next=Icpitembatch.CPVarDecl
len=3
name='_perpaese
next=Icpitembatch.CPVarDecl
len=6
name='_percab
next=Icpitembatch.CPVarDecl
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPVarDecl
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
len=10
name='cProg
next=Icpitembatch.CPVarDecl
len=10
name='fhand
next=Icpitembatch.CPVarDecl
len=15
name='_max
next=Icpitembatch.CPVarDecl
len=15
name='_min
next=Icpitembatch.CPVarDecl
len=15
name='_tot
next=Icpitembatch.CPVarDecl
len=1
name='_mono
next=Icpitembatch.CPVarDecl
len=15
name='_cicli
next=Icpitembatch.CPVarDecl
len=15
name='_contacilci
next=Icpitembatch.CPVarDecl
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
len=15
name='_top
next=Icpitembatch.CPVarDecl
len=3
name='_stato
next=Icpitembatch.CPVarDecl
len=10
name='_errore
next=Icpitembatch.CPVarDecl
len=1
name='_err01
next=Icpitembatch.CPVarDecl
len=1
name='_err02
next=Icpitembatch.CPVarDecl
len=1
name='_err03
next=Icpitembatch.CPVarDecl
len=1
name='_err04
next=Icpitembatch.CPVarDecl
len=1
name='_err05
next=Icpitembatch.CPVarDecl
len=1
name='_err06
next=Icpitembatch.CPVarDecl
len=1
name='_err07
next=Icpitembatch.CPVarDecl
len=1
name='_err08
next=Icpitembatch.CPVarDecl
len=1
name='_err09
next=Icpitembatch.CPVarDecl
len=1
name='_err10
next=Icpitembatch.CPVarDecl
len=1
name='_err11
next=Icpitembatch.CPVarDecl
len=10
name='_contaop
next=Icpitembatch.CPVarDecl
len=8
name='_datini
next=Icpitembatch.CPVarDecl
len=8
name='_datfin
next=Icpitembatch.CPVarDecl
len=8
name='_ddatini
next=Icpitembatch.CPVarDecl
len=8
name='_ddatfin
next=Icpitembatch.CPVarDecl
len=8
name='_dataoggi
next=Icpitembatch.CPVarDecl
len=8
name='_cdataoggi
next=Icpitembatch.CPVarDecl
len=15
name='_contarow
next=Icpitembatch.CPVarDecl
len=10
name='_oldmsg
next=Icpitembatch.CPVarDecl
len=1
name='_sesso
next=Icpitembatch.CPVarDecl
len=10
name='_cope
obj='Var
obj_type='N
pag=1
prev=O576
I
obj='Var
pag=1
prev=O575
I
obj='Var
obj_type='M
pag=1
prev=O574
I
obj='Var
obj_type='N
pag=1
prev=O573
I
obj='Var
pag=1
prev=O572
I
obj='Var
obj_type='D
pag=1
prev=O571
I
obj='Var
obj_type='D
pag=1
prev=O570
I
obj='Var
obj_type='D
pag=1
prev=O569
I
obj='Var
pag=1
prev=O568
I
obj='Var
pag=1
prev=O567
I
obj='Var
obj_type='N
pag=1
prev=O566
I
obj='Var
pag=1
prev=O565
I
obj='Var
pag=1
prev=O564
I
obj='Var
pag=1
prev=O563
I
obj='Var
pag=1
prev=O562
I
obj='Var
pag=1
prev=O561
I
obj='Var
pag=1
prev=O560
I
obj='Var
pag=1
prev=O559
I
obj='Var
pag=1
prev=O558
I
obj='Var
pag=1
prev=O557
I
obj='Var
pag=1
prev=O556
I
obj='Var
pag=1
prev=O555
I
obj='Var
obj_type='M
pag=1
prev=O554
I
obj='Var
pag=1
prev=O553
I
obj='Var
obj_type='N
pag=1
prev=O552
I
obj='Var
obj_type='N
pag=1
prev=O551
I
obj='Var
obj_type='N
pag=1
prev=O550
I
obj='Var
obj_type='N
pag=1
prev=O549
I
obj='Var
obj_type='N
pag=1
prev=O548
I
obj='Var
obj_type='N
pag=1
prev=O547
I
obj='Var
obj_type='N
pag=1
prev=O546
I
obj='Var
obj_type='N
pag=1
prev=O545
I
obj='Var
pag=1
prev=O544
I
obj='Var
pag=1
prev=O543
I
obj='Var
pag=1
prev=O542
I
obj='Var
pag=1
prev=O541
I
obj='Var
pag=1
prev=O540
I
obj='Var
pag=1
prev=O539
I
obj='Var
pag=1
prev=O538
I
obj='Var
pag=1
prev=O537
I
obj='Var
pag=1
prev=O536
I
obj='Var
pag=1
prev=O535
I
obj='Var
pag=1
prev=O534
I
obj='Var
obj_type='D
pag=1
prev=O533
I
obj='Var
obj_type='D
pag=1
prev=O532
I
obj='Var
pag=1
prev=O531
I
obj='Var
pag=1
prev=O530
I
obj='Var
pag=1
prev=O529
I
obj='Var
obj_type='M
pag=1
prev=O528
I
obj='Var
pag=1
prev=O527
I
obj='Var
pag=1
prev=O526
I
obj='Var
pag=1
prev=O525
I
obj='Var
obj_type='N
pag=1
prev=O524
I
obj='Var
obj_type='N
pag=1
prev=O523
I
obj='Var
obj_type='N
pag=1
prev=O522
I
obj='Var
pag=1
prev=O521
I
obj='Var
pag=1
prev=O520
I
obj='Var
pag=1
prev=O519
I
obj='Var
pag=1
prev=O518
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O434
I
nonlocal=True
obj='Var
pag=1
prev=O433
I
nonlocal=True
obj='Var
pag=1
prev=O432
I
nonlocal=True
obj='Var
pag=1
prev=O431
I
nonlocal=True
obj='Var
pag=1
prev=O430
I
nonlocal=True
obj='Var
pag=1
prev=O429
I
nonlocal=True
obj='Var
pag=1
prev=O428
I
obj='Remark
pag=1
prev=O426
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='R = Report (pdf)     X = Excel (Vecchio)    Z = Excel (Nuovo per reimport)
father=O426
fatherSonIndex=0
len=1
name='pTipo
next=Icpitembatch.CPVarDecl
len=8
name='w_DaDatOpe
next=Icpitembatch.CPVarDecl
len=8
name='w_ADatOpe
next=Icpitembatch.CPVarDecl
comment='Tipo di intermediario
len=2
name='w_tipocr
next=Icpitembatch.CPVarDecl
comment='Codice intermediario
len=11
name='w_codcr
next=Icpitembatch.CPVarDecl
comment='Considera frazionate
len=1
name='w_flgfrazionate
obj='Var
pag=1
param=True
prev=O585
I
obj='Var
pag=1
param=True
prev=O584
I
obj='Var
pag=1
param=True
prev=O583
I
obj='Var
obj_type='D
pag=1
param=True
prev=O582
I
obj='Var
obj_type='D
pag=1
param=True
prev=O581
I
obj='Var
pag=1
param=True
I
I
]
w=[
150
150
]
x=10
y=13
I
Icpitembatch.CPRemark
frm_calc='Cicla su operazbo e seleziona i record nel range definito
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Operazioni' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPRemark
frm_calc='Cicla su operazbo e seleziona i record nel range definito
next=Icpitembatch.CPVarDecl
frm_calc='0
len=15
name='_contarow
next=Icpitembatch.CPVarDecl
frm_calc='_ddatini
len=8
name='_dataoggi
next=Icpitembatch.CPVarDecl
frm_calc='_datini
len=8
name='_cdataoggi
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_oldmsg
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_contaop
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_cope
next=Icpitembatch.CPWhile
frm_calc='_dataoggi <= _ddatfin
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_cope=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Operazioni' +NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O599
var_op='asgn
I
obj='If
pag=2
prev=O597
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O599
fatherSonIndex=0
frm_calc='gMsgProc + NL + 'Non sono presenti dati da elaborare nel file Operazioni' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O599
fatherSonIndex=1
frm_calc='gMsgProc + NL + 'Sono stati elaborati '+LRTrim(Str(_cope,10,0))+' record del file Operazioni' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='While
pag=2
prev=O596
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O597
fatherSonIndex=0
frm_calc=[
'Empty(_oldmsg)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc=''Sto elaborando il giorno: '+arfn_fdate(_dataoggi) + " del file operazioni"
len=10
name='_oldmsg
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='arfn_datesum(_dataoggi,1)
len=8
name='_dataoggi
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(_dataoggi)
len=8
name='_cdataoggi
obj='Var
pag=2
prev=O617
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O615
var_op='asgn
I
obj='Select
pag=2
par_expr=[
'_cdataoggi
]
par_name=[
'cdadata
]
prev=O614
sel_name='qbe_opeuif
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O615
fatherSonIndex=0
frm_calc='_contaop + 1
len=10
name='_contaop
next=Icpitembatch.CPVarDecl
frm_calc='_cope + 1
len=10
name='_cope
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Elaboro Operazione N. '+ LRTrim(Str(_contaop,10,0))
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPBeginEnd
comment='Inizializza variabili
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(qbe_opeuif->RAPPORTO))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O626
sons=[
Icpitembatch.CPItemSon
comment='Se c'è il codice rapporto
instr=Icpitembatch.CPSelect
father=O628
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=2
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=LRTrim(qbe_opeuif->RAPPORTO)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O633
fatherSonIndex=0
frm_calc=[
'intestbo->DATAINI <= qbe_opeuif->DATAOPE and (Empty(intestbo->DATAFINE) or intestbo->DATAFINE >= qbe_opeuif->DATAOPE)
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O637
fatherSonIndex=0
frm_calc='''
len=1
name='_sesso
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_perpaese)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'(Empty(_perpaese) and Empty(_percab)) or (_perpaese='086' and Empty(_percab))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_percab)) and not(mcCitta.GoToKey(LRTrim(_percab)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_settsint)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_sesso))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_settsint)) and _settsint='999'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(qbe_opeuif->CODDIPE)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_codcab) and not(Empty(qbe_opeuif->CODDIPE))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_codcab)) and not(mcCitta.GoToKey(LRTrim(_codcab)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'At(LRTrim(qbe_opeuif->CODVOC),'|1B|2B|3B|4B|5B|6B|3M|4M|5M|6M|1R|2R') > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(qbe_opeuif->C_CAB)) and not(mcCitta.GoToKey(LRTrim(qbe_opeuif->C_CAB)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(qbe_opeuif->CODCAB2)) and not(mcCitta.GoToKey(LRTrim(qbe_opeuif->CODCAB2)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_errore)))
]
h=[
19
19
]
obj='If
pag=2
prev=O677
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O680
fatherSonIndex=0
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPIfElse
frm_calc=[
'pTipo='Z'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O685
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O686
fatherSonIndex=0
frm_calc='-- inseriemnto per reimport dei errori corretti
next=Icpitembatch.CPInsert
arch='tmp_stpoperazioni
obj='Insert
pag=2
prev=O691
rd_kfield=[
'AUTOM
'C_CAB
'C_CTA
'C_IND
'C_STA
'CABICP
'CAMBIO
'CDATOPE
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNESBEN
'CONNESCLI
'CONNESCOL
'CONNESOPER
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'ERR01
'ERR02
'ERR03
'ERR04
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'IDFILE
'INFORM
'IPCOLLEG
'MODSVOL
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PAESECP
'PROV2
'PROVINCIA
'RAGCLI
'RAPPORTBEN
'RAPPORTO
'RESPINS
'RIFIMP
'SCOPO
'SEGNO
'SETTSINTAGG
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'TXTNOTE
'UCODE
'VALUTA
]
rd_kvar=[
'qbe_opeuif->AUTOM
'qbe_opeuif->C_CAB
'qbe_opeuif->DESCRIZ
'qbe_opeuif->CODDIP
'qbe_opeuif->C_STA
'qbe_opeuif->CABCLI
'qbe_opeuif->CAMBIO
'qbe_opeuif->CDATOPE
'qbe_opeuif->CODANA
'qbe_opeuif->CODCAB
'qbe_opeuif->CODCAB2
'qbe_opeuif->CODDIPE
'qbe_opeuif->CODINT2
'qbe_opeuif->CODINTER
'qbe_opeuif->CODVOC
'qbe_opeuif->COLLEG
'qbe_opeuif->CONNESBEN
'qbe_opeuif->CONNESCLI
'qbe_opeuif->CONNESCLI
'qbe_opeuif->CONNESOPER
'qbe_opeuif->DATAOPE
'qbe_opeuif->DATAREG
'qbe_opeuif->DATARETT
'qbe_opeuif->DESCCITCLI
'qbe_opeuif->DESCCIT
'qbe_opeuif->DESCINTER
'qbe_opeuif->DOCFILE
''N'
''N'
''N'
''N'
'qbe_opeuif->FLAGCONT
'qbe_opeuif->FLAGFRAZ
'qbe_opeuif->FLAGLIRE
'qbe_opeuif->FLAGRAP
'qbe_opeuif->FLAGRAP2
'qbe_opeuif->IDBASE
'qbe_opeuif->idcauana
'qbe_opeuif->IDEREG
'qbe_opeuif->DESCCITD
'qbe_opeuif->INFORM
'qbe_opeuif->CODFISC
'qbe_opeuif->MODSVOL
'qbe_opeuif->NUMPROG
'qbe_opeuif->OPERAG
'qbe_opeuif->OPERATORE
'qbe_opeuif->OPERAZMOD
'qbe_opeuif->OPRAP
'qbe_opeuif->PAESE
'qbe_opeuif->PAESECLI
'qbe_opeuif->PROV2
'qbe_opeuif->PROVINCIA
'qbe_opeuif->RAGSOC
'qbe_opeuif->RAPPORTBEN
'qbe_opeuif->RAPPORTO
'qbe_opeuif->RESPINS
'qbe_opeuif->RIFIMP
'qbe_opeuif->CABDIP
'qbe_opeuif->SEGNO
'qbe_opeuif->SETTSINT
'qbe_opeuif->STATOREG
''OPE'
'qbe_opeuif->TIPOINF
'qbe_opeuif->TIPOINT2
'qbe_opeuif->TIPOINTER
'qbe_opeuif->TIPOLEG
'qbe_opeuif->TIPOOPRAP
'qbe_opeuif->TOTCONT/100
'qbe_opeuif->TOTLIRE/100
'_errore
'qbe_opeuif->SOTGRUP
'qbe_opeuif->VALUTA
]
I
obj='Remark
pag=2
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O686
fatherSonIndex=1
frm_calc='-- classico inserimento
next=Icpitembatch.CPInsert
arch='tmp_stpoperazioni
obj='Insert
pag=2
prev=O696
rd_kfield=[
'AUTOM
'CAMBIO
'CDATOPE
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNESBEN
'CONNESCLI
'CONNESCOL
'CONNESOPER
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'ERR01
'ERR02
'ERR03
'ERR04
'ERR05
'ERR06
'ERR07
'ERR08
'ERR09
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'MODSVOL
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PROV2
'PROVINCIA
'RAPPORTBEN
'RAPPORTO
'RESPINS
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'TXTNOTE
'VALUTA
]
rd_kvar=[
'qbe_opeuif->AUTOM
'qbe_opeuif->CAMBIO
'qbe_opeuif->CDATOPE
'qbe_opeuif->CODANA
'qbe_opeuif->CODCAB
'qbe_opeuif->CODCAB2
'qbe_opeuif->CODDIPE
'qbe_opeuif->CODINT2
'qbe_opeuif->CODINTER
'qbe_opeuif->CODVOC
'qbe_opeuif->COLLEG
'qbe_opeuif->CONNESBEN
'qbe_opeuif->CONNESCLI
'qbe_opeuif->CONNESCLI
'qbe_opeuif->CONNESOPER
'qbe_opeuif->DATAOPE
'qbe_opeuif->DATAREG
'qbe_opeuif->DATARETT
'qbe_opeuif->DESC2
'qbe_opeuif->DESCCIT
'qbe_opeuif->DESCINTER
'qbe_opeuif->DOCFILE
'_err01
'_err02
'_err03
'_err04
'_err05
'_err06
'_err07
'_err08
'_err09
'qbe_opeuif->FLAGCONT
'qbe_opeuif->FLAGFRAZ
'qbe_opeuif->FLAGLIRE
'qbe_opeuif->FLAGRAP
'qbe_opeuif->FLAGRAP2
'qbe_opeuif->IDBASE
'qbe_opeuif->idcauana
'qbe_opeuif->IDEREG
'qbe_opeuif->INFORM
'qbe_opeuif->MODSVOL
'qbe_opeuif->NUMPROG
'qbe_opeuif->OPERAG
'qbe_opeuif->OPERATORE
'qbe_opeuif->OPERAZMOD
'qbe_opeuif->OPRAP
'qbe_opeuif->PAESE
'qbe_opeuif->PROV2
'qbe_opeuif->PROVINCIA
'qbe_opeuif->RAPPORTBEN
'qbe_opeuif->RAPPORTO
'qbe_opeuif->RESPINS
'qbe_opeuif->SEGNO
'qbe_opeuif->STATOREG
''OPE'
'qbe_opeuif->TIPOINF
'qbe_opeuif->TIPOINT2
'qbe_opeuif->TIPOINTER
'qbe_opeuif->TIPOLEG
'qbe_opeuif->TIPOOPRAP
'qbe_opeuif->TOTCONT/100
'qbe_opeuif->TOTLIRE/100
'_errore
'qbe_opeuif->VALUTA
]
I
obj='Remark
pag=2
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O674
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O677
fatherSonIndex=0
frm_calc='_errore + 'CAB Intermediario Controparte Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err09
obj='Var
pag=2
prev=O704
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O671
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O674
fatherSonIndex=0
frm_calc='_errore + 'CAB Controparte Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err07
obj='Var
pag=2
prev=O709
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O668
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O671
fatherSonIndex=0
frm_calc=[
'Empty(qbe_opeuif->C_STA)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(qbe_opeuif->PAESE)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O714
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O717
fatherSonIndex=0
frm_calc='_errore + 'Manca Paese Intermediario Controparte' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err08
obj='Var
pag=2
prev=O722
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O717
fatherSonIndex=1
frm_calc=[
'mcStati.GoToKey(qbe_opeuif->PAESE)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_stato) or (not(Empty(_stato)) and _stato='030')
]
h=[
19
19
]
obj='If
pag=2
prev=O725
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O728
fatherSonIndex=0
frm_calc='_errore + 'Paese Intermediario Controparte Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err08
obj='Var
pag=2
prev=O733
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O725
fatherSonIndex=0
frm_calc='mcStati.CODSTA
len=3
name='_stato
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O714
fatherSonIndex=0
frm_calc='_errore + 'Manca Paese Residenza Controparte' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err06
obj='Var
pag=2
prev=O743
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O714
fatherSonIndex=1
frm_calc='''
len=3
name='_stato
next=Icpitembatch.CPIfElse
frm_calc=[
'mcStati.GoToKey(qbe_opeuif->C_STA)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_stato) or (not(Empty(_stato)) and _stato='030')
]
h=[
19
19
]
obj='If
pag=2
prev=O747
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O750
fatherSonIndex=0
frm_calc='_errore + 'Paese Residenza Controparte Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err06
obj='Var
pag=2
prev=O755
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O746
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O747
fatherSonIndex=0
frm_calc='mcStati.CODSTA
len=3
name='_stato
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O665
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O668
fatherSonIndex=0
frm_calc='_errore + 'CAB Dipendenza / Agenzia Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err05
obj='Var
pag=2
prev=O766
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O662
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O665
fatherSonIndex=0
frm_calc='_errore + 'Manca CAB Dipendenza / Agenzia' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err05
obj='Var
pag=2
prev=O771
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O659
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O662
fatherSonIndex=0
frm_calc='_errore + 'Manca Codice Agenzia' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err05
obj='Var
pag=2
prev=O776
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O656
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O659
fatherSonIndex=0
frm_calc='_errore + 'Settore sintetico 999 non valido per SARA'
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err04
obj='Var
pag=2
prev=O781
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O653
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O656
fatherSonIndex=0
frm_calc=[
'(_settsint<>'600' and _settsint<>'601') and _perpaese='086'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_settsint<>'711' and _perpaese<>'086'
]
h=[
19
19
]
obj='If
pag=2
prev=O786
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O789
fatherSonIndex=0
frm_calc='_errore + "Settore Sintetico Cliente Residente all'Estero Errato"
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err03
obj='Var
pag=2
prev=O794
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O786
fatherSonIndex=0
frm_calc='_errore + 'Settore Sintetico Cliente Residente in Italia Errato'
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err03
obj='Var
pag=2
prev=O799
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O650
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O653
fatherSonIndex=0
frm_calc='_errore + 'Manca Settore Sintetico Cliente'
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err03
obj='Var
pag=2
prev=O805
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O647
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O650
fatherSonIndex=0
frm_calc='_errore + 'CAB Residenza Cliente Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err02
obj='Var
pag=2
prev=O810
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O644
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O647
fatherSonIndex=0
frm_calc='_errore + 'Manca CAB Residenza Cliente' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err02
obj='Var
pag=2
prev=O815
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O643
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O644
fatherSonIndex=0
frm_calc=''X'
len=1
name='_err01
next=Icpitembatch.CPVarDecl
frm_calc='_errore + 'Manca Paese Residenza Cliente' + NL
len=10
name='_errore
obj='Var
obj_type='M
pag=2
prev=O820
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O644
fatherSonIndex=1
frm_calc='''
len=3
name='_stato
next=Icpitembatch.CPIfElse
frm_calc=[
'mcStati.GoToKey(_perpaese)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_stato) or (not(Empty(_stato)) and _stato='030')
]
h=[
19
19
]
obj='If
pag=2
prev=O824
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O827
fatherSonIndex=0
frm_calc='_errore + 'Paese Residenza Cliente Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err01
obj='Var
pag=2
prev=O832
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O823
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O824
fatherSonIndex=0
frm_calc='mcStati.CODSTA
len=3
name='_stato
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O642
rd_field=[
'CODCAB
'PAESE
'SETTSINT
'SESSO
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(intestbo->CODINTER)
]
rd_var=[
'_percab
'_perpaese
'_settsint
'_sesso
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O628
fatherSonIndex=1
frm_calc=[
'Empty(_perpaese)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'(Empty(_perpaese) and Empty(_percab)) or (_perpaese='086' and Empty(_percab))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_percab)) and not(mcCitta.GoToKey(LRTrim(_percab)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_settsint)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_sesso))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_settsint)) and _settsint='999'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(qbe_opeuif->CODDIPE)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_codcab) and not(Empty(qbe_opeuif->CODDIPE))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_codcab)) and not(mcCitta.GoToKey(LRTrim(_codcab)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(qbe_opeuif->CODVOC)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(qbe_opeuif->SEGNO)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'At(LRTrim(qbe_opeuif->CODVOC),'|1B|2B|3B|4B|5B|6B|3M|4M|5M|6M|1R|2R') > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(qbe_opeuif->C_CAB)) and not(mcCitta.GoToKey(LRTrim(qbe_opeuif->C_CAB)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(qbe_opeuif->CODCAB2)) and not(mcCitta.GoToKey(LRTrim(qbe_opeuif->CODCAB2)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_errore)))
]
h=[
19
19
]
obj='If
pag=2
prev=O886
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O889
fatherSonIndex=0
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPIfElse
frm_calc=[
'pTipo='Z'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O894
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O895
fatherSonIndex=0
frm_calc='-- Inserimento per reimport dei errori corretti
next=Icpitembatch.CPInsert
arch='tmp_stpoperazioni
obj='Insert
pag=2
prev=O900
rd_kfield=[
'AUTOM
'C_CAB
'C_CTA
'C_IND
'C_STA
'CABICP
'CAMBIO
'CDATOPE
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNESBEN
'CONNESCLI
'CONNESCOL
'CONNESOPER
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'ERR01
'ERR02
'ERR03
'ERR04
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'IDFILE
'INFORM
'IPCOLLEG
'MODSVOL
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PAESECP
'PROV2
'PROVINCIA
'RAGCLI
'RAPPORTBEN
'RAPPORTO
'RESPINS
'RIFIMP
'SCOPO
'SEGNO
'SETTSINTAGG
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'TXTNOTE
'UCODE
'VALUTA
]
rd_kvar=[
'qbe_opeuif->AUTOM
'qbe_opeuif->C_CAB
'qbe_opeuif->DESCRIZ
'qbe_opeuif->CODDIP
'qbe_opeuif->C_STA
'qbe_opeuif->CABCLI
'qbe_opeuif->CAMBIO
'qbe_opeuif->CDATOPE
'qbe_opeuif->CODANA
'qbe_opeuif->CODCAB
'qbe_opeuif->CODCAB2
'qbe_opeuif->CODDIPE
'qbe_opeuif->CODINT2
'qbe_opeuif->CODINTER
'qbe_opeuif->CODVOC
'qbe_opeuif->COLLEG
'qbe_opeuif->CONNESBEN
'qbe_opeuif->CONNESCLI
'qbe_opeuif->CONNESCLI
'qbe_opeuif->CONNESOPER
'qbe_opeuif->DATAOPE
'qbe_opeuif->DATAREG
'qbe_opeuif->DATARETT
'qbe_opeuif->DESCCITCLI
'qbe_opeuif->DESCCIT
'qbe_opeuif->DESCINTER
'qbe_opeuif->DOCFILE
''N'
''N'
''N'
''N'
'qbe_opeuif->FLAGCONT
'qbe_opeuif->FLAGFRAZ
'qbe_opeuif->FLAGLIRE
'qbe_opeuif->FLAGRAP
'qbe_opeuif->FLAGRAP2
'qbe_opeuif->IDBASE
'qbe_opeuif->idcauana
'qbe_opeuif->IDEREG
'qbe_opeuif->DESCCITD
'qbe_opeuif->INFORM
'qbe_opeuif->CODFISC
'qbe_opeuif->MODSVOL
'qbe_opeuif->NUMPROG
'qbe_opeuif->OPERAG
'qbe_opeuif->OPERATORE
'qbe_opeuif->OPERAZMOD
'qbe_opeuif->OPRAP
'qbe_opeuif->PAESE
'qbe_opeuif->PAESECLI
'qbe_opeuif->PROV2
'qbe_opeuif->PROVINCIA
'qbe_opeuif->RAGSOC
'qbe_opeuif->RAPPORTBEN
'qbe_opeuif->RAPPORTO
'qbe_opeuif->RESPINS
'qbe_opeuif->RIFIMP
'qbe_opeuif->CABDIP
'qbe_opeuif->SEGNO
'qbe_opeuif->SETTSINT
'qbe_opeuif->STATOREG
''OPE'
'qbe_opeuif->TIPOINF
'qbe_opeuif->TIPOINT2
'qbe_opeuif->TIPOINTER
'qbe_opeuif->TIPOLEG
'qbe_opeuif->TIPOOPRAP
'qbe_opeuif->TOTCONT/100
'qbe_opeuif->TOTLIRE/100
'_errore
'qbe_opeuif->SOTGRUP
'qbe_opeuif->VALUTA
]
I
obj='Remark
pag=2
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O895
fatherSonIndex=1
frm_calc='-- classico inserimento
next=Icpitembatch.CPInsert
arch='tmp_stpoperazioni
obj='Insert
pag=2
prev=O905
rd_kfield=[
'AUTOM
'CAMBIO
'CDATOPE
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNESBEN
'CONNESCLI
'CONNESCOL
'CONNESOPER
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'ERR01
'ERR02
'ERR03
'ERR04
'ERR05
'ERR06
'ERR07
'ERR08
'ERR09
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'MODSVOL
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PROV2
'PROVINCIA
'RAPPORTBEN
'RAPPORTO
'RESPINS
'RIFIMP
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'TXTNOTE
'VALUTA
]
rd_kvar=[
'qbe_opeuif->AUTOM
'qbe_opeuif->CAMBIO
'qbe_opeuif->CDATOPE
'qbe_opeuif->CODANA
'qbe_opeuif->CODCAB
'qbe_opeuif->CODCAB2
'qbe_opeuif->CODDIPE
'qbe_opeuif->CODINT2
'qbe_opeuif->CODINTER
'qbe_opeuif->CODVOC
'qbe_opeuif->COLLEG
'qbe_opeuif->CONNESBEN
'qbe_opeuif->CONNESCLI
'qbe_opeuif->CONNESCLI
'qbe_opeuif->CONNESOPER
'qbe_opeuif->DATAOPE
'qbe_opeuif->DATAREG
'qbe_opeuif->DATARETT
'qbe_opeuif->DESC2
'qbe_opeuif->DESCCIT
'qbe_opeuif->DESCINTER
'qbe_opeuif->DOCFILE
'_err01
'_err02
'_err03
'_err04
'_err05
'_err06
'_err07
'_err08
'_err09
'qbe_opeuif->FLAGCONT
'qbe_opeuif->FLAGFRAZ
'qbe_opeuif->FLAGLIRE
'qbe_opeuif->FLAGRAP
'qbe_opeuif->FLAGRAP2
'qbe_opeuif->IDBASE
'qbe_opeuif->idcauana
'qbe_opeuif->IDEREG
'qbe_opeuif->INFORM
'qbe_opeuif->MODSVOL
'qbe_opeuif->NUMPROG
'qbe_opeuif->OPERAG
'qbe_opeuif->OPERATORE
'qbe_opeuif->OPERAZMOD
'qbe_opeuif->OPRAP
'qbe_opeuif->PAESE
'qbe_opeuif->PROV2
'qbe_opeuif->PROVINCIA
'qbe_opeuif->RAPPORTBEN
'qbe_opeuif->RAPPORTO
'qbe_opeuif->RESPINS
'qbe_opeuif->RIFIMP
'qbe_opeuif->SEGNO
'qbe_opeuif->STATOREG
''OPE'
'qbe_opeuif->TIPOINF
'qbe_opeuif->TIPOINT2
'qbe_opeuif->TIPOINTER
'qbe_opeuif->TIPOLEG
'qbe_opeuif->TIPOOPRAP
'qbe_opeuif->TOTCONT/100
'qbe_opeuif->TOTLIRE/100
'_errore
'qbe_opeuif->VALUTA
]
I
obj='Remark
pag=2
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O883
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O886
fatherSonIndex=0
frm_calc='_errore + 'CAB Intermediario Controparte Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err09
obj='Var
pag=2
prev=O913
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O880
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O883
fatherSonIndex=0
frm_calc='_errore + 'CAB Controparte Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err07
obj='Var
pag=2
prev=O918
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O877
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O880
fatherSonIndex=0
frm_calc=[
'Empty(qbe_opeuif->C_STA)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(qbe_opeuif->PAESE)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O923
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O926
fatherSonIndex=0
frm_calc='_errore + 'Manca Paese Intermediario Controparte' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err08
obj='Var
pag=2
prev=O931
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O926
fatherSonIndex=1
frm_calc='''
len=3
name='_stato
next=Icpitembatch.CPIfElse
frm_calc=[
'mcStati.GoToKey(qbe_opeuif->PAESE)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_stato) or (not(Empty(_stato)) and _stato='030')
]
h=[
19
19
]
obj='If
pag=2
prev=O935
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O938
fatherSonIndex=0
frm_calc='_errore + 'Paese Intermediario Controparte Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err08
obj='Var
pag=2
prev=O943
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O934
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O935
fatherSonIndex=0
frm_calc='mcStati.CODSTA
len=3
name='_stato
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O923
fatherSonIndex=0
frm_calc='_errore + 'Manca Paese Residenza Controparte' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err06
obj='Var
pag=2
prev=O953
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O923
fatherSonIndex=1
frm_calc='''
len=3
name='_stato
next=Icpitembatch.CPIfElse
frm_calc=[
'mcStati.GoToKey(qbe_opeuif->C_STA)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_stato) or (not(Empty(_stato)) and _stato='030')
]
h=[
19
19
]
obj='If
pag=2
prev=O957
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O960
fatherSonIndex=0
frm_calc='_errore + 'Paese Residenza Controparte Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err06
obj='Var
pag=2
prev=O965
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O956
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O957
fatherSonIndex=0
frm_calc='mcStati.CODSTA
len=3
name='_stato
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O874
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O877
fatherSonIndex=0
frm_calc='_errore + 'Manca Segno Operazione' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err11
obj='Var
pag=2
prev=O976
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O871
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O874
fatherSonIndex=0
frm_calc='_errore + 'Manca CAUSALE SINTETICA' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err10
obj='Var
pag=2
prev=O981
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O868
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O871
fatherSonIndex=0
frm_calc='_errore + 'CAB Dipendenza / Agenzia Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err05
obj='Var
pag=2
prev=O986
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O865
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O868
fatherSonIndex=0
frm_calc='_errore + 'Manca CAB Dipendeza / Agenzia' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err05
obj='Var
pag=2
prev=O991
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O862
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O865
fatherSonIndex=0
frm_calc='_errore + 'Manca Codce Agenzia' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err05
obj='Var
pag=2
prev=O996
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O859
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O862
fatherSonIndex=0
frm_calc='_errore + 'Settore sintetico 999 non valido per SARA'
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err04
obj='Var
pag=2
prev=O1001
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O856
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O859
fatherSonIndex=0
frm_calc=[
'_settsint<>'600' and _perpaese='086'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_settsint<>'711' and _perpaese<>'086'
]
h=[
19
19
]
obj='If
pag=2
prev=O1006
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1009
fatherSonIndex=0
frm_calc='_errore + "Settore Sintetico Cliente Residente all'Estero Errato"
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err03
obj='Var
pag=2
prev=O1014
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1006
fatherSonIndex=0
frm_calc='_errore + 'Settore Sintetico Cliente Residente in Italia Errato'
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err03
obj='Var
pag=2
prev=O1019
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O853
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O856
fatherSonIndex=0
frm_calc='_errore + 'Manca Settore Sintetico Cliente'
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err03
obj='Var
pag=2
prev=O1025
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O850
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O853
fatherSonIndex=0
frm_calc='_errore + 'CAB Residenza Cliente Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err02
obj='Var
pag=2
prev=O1030
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O847
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O850
fatherSonIndex=0
frm_calc='_errore + 'Manca CAB Residenza Cliente' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err02
obj='Var
pag=2
prev=O1035
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O847
fatherSonIndex=0
frm_calc='_errore + 'Manca Paese Residenza Cliente' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err01
obj='Var
pag=2
prev=O1040
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O847
fatherSonIndex=1
frm_calc='''
len=3
name='_stato
next=Icpitembatch.CPIfElse
frm_calc=[
'mcStati.GoToKey(_perpaese)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_stato) or (not(Empty(_stato)) and _stato='030')
]
h=[
19
19
]
obj='If
pag=2
prev=O1044
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1047
fatherSonIndex=0
frm_calc='_errore + 'Paese Residenza Cliente Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err01
obj='Var
pag=2
prev=O1052
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O1043
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1044
fatherSonIndex=0
frm_calc='mcStati.CODSTA
len=3
name='_stato
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=2
prev=O625
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O626
fatherSonIndex=0
frm_calc='''
len=1
name='_err01
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err02
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err03
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err04
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err05
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err06
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err07
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err08
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err09
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err10
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err11
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc='qbe_opeuif->PAESECLI
len=3
name='_perpaese
next=Icpitembatch.CPVarDecl
frm_calc='qbe_opeuif->CABCLI
len=6
name='_percab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(qbe_opeuif->CODCAB),qbe_opeuif->CABDIP,qbe_opeuif->CODCAB)
len=6
name='_codcab
next=Icpitembatch.CPVarDecl
frm_calc='qbe_opeuif->SETTSINT
len=3
name='_settsint
next=Icpitembatch.CPVarDecl
frm_calc='qbe_opeuif->SESSO
len=1
name='_sesso
obj='Var
pag=2
prev=O1078
var_op='asgn
I
obj='Var
pag=2
prev=O1077
var_op='asgn
I
obj='Var
pag=2
prev=O1076
var_op='asgn
I
obj='Var
pag=2
prev=O1075
var_op='asgn
I
obj='Var
pag=2
prev=O1074
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1073
var_op='asgn
I
obj='Var
pag=2
prev=O1072
var_op='asgn
I
obj='Var
pag=2
prev=O1071
var_op='asgn
I
obj='Var
pag=2
prev=O1070
var_op='asgn
I
obj='Var
pag=2
prev=O1069
var_op='asgn
I
obj='Var
pag=2
prev=O1068
var_op='asgn
I
obj='Var
pag=2
prev=O1067
var_op='asgn
I
obj='Var
pag=2
prev=O1066
var_op='asgn
I
obj='Var
pag=2
prev=O1065
var_op='asgn
I
obj='Var
pag=2
prev=O1064
var_op='asgn
I
obj='Var
pag=2
prev=O1063
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=2
prev=O624
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O623
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
prev=O611
var_op='asgn
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O611
fatherSonIndex=0
frm_calc='gMsgProc + 'Sto elaborando il giorno: '+arfn_fdate(_dataoggi) + " del file operazioni"
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O611
fatherSonIndex=1
frm_calc='Strtran(gMsgProc,_oldmsg,'Sto elaborando il giorno: '+arfn_fdate(_dataoggi) + " del file operazioni")
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O595
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O594
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O593
var_op='asgn
I
obj='Var
pag=2
prev=O592
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O591
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O590
var_op='asgn
I
obj='Remark
pag=2
prev=O589
I
nonlocal=True
obj='Var
pag=2
prev=O588
var_op='asgn
I
obj='Remark
pag=2
x=12
y=15
I
Icpitembatch.CPRemark
frm_calc='Cicla su fraziobo e seleziona i record nel range definito
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Frazionate' +NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPRemark
frm_calc='Cicla su operazbo e seleziona i record nel range definito
next=Icpitembatch.CPVarDecl
frm_calc='0
len=15
name='_contarow
next=Icpitembatch.CPVarDecl
frm_calc='_ddatini
len=8
name='_dataoggi
next=Icpitembatch.CPVarDecl
frm_calc='_datini
len=8
name='_cdataoggi
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_oldmsg
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_contaop
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_cope
next=Icpitembatch.CPWhile
frm_calc='_dataoggi <= _ddatfin
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_cope=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Frazionate' +NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1100
var_op='asgn
I
obj='If
pag=3
prev=O1098
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1100
fatherSonIndex=0
frm_calc='gMsgProc + NL + 'Non sono presenti dati da elaborare nel file Frazionate' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1100
fatherSonIndex=1
frm_calc='gMsgProc + NL + 'Sono stati elaborati '+LRTrim(Str(_cope,10,0))+' record del file Frazionate' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='While
pag=3
prev=O1097
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1098
fatherSonIndex=0
frm_calc=[
'Empty(_oldmsg)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc=''Sto elaborando il giorno: '+arfn_fdate(_dataoggi) + " del file frazionate"
len=10
name='_oldmsg
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='arfn_datesum(_dataoggi,1)
len=8
name='_dataoggi
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(_dataoggi)
len=8
name='_cdataoggi
obj='Var
pag=3
prev=O1118
var_op='asgn
I
obj='Var
obj_type='D
pag=3
prev=O1116
var_op='asgn
I
obj='Select
pag=3
par_expr=[
'_cdataoggi
]
par_name=[
'cdadata
]
prev=O1115
sel_name='qbe_frauif
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1116
fatherSonIndex=0
frm_calc='_cope + 1
len=10
name='_cope
next=Icpitembatch.CPVarDecl
frm_calc='_contaop + 1
len=10
name='_contaop
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Elaboro Operazione N. '+ LRTrim(Str(_contaop,10,0))
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPBeginEnd
comment='Inizializza variabili
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(qbe_frauif->RAPPORTO))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O1127
sons=[
Icpitembatch.CPItemSon
comment='Se c'è il codice rapporto
instr=Icpitembatch.CPSelect
father=O1129
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=3
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=LRTrim(qbe_frauif->RAPPORTO)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1134
fatherSonIndex=0
frm_calc=[
'intestbo->DATAINI <= qbe_frauif->DATAOPE and (Empty(intestbo->DATAFINE) or intestbo->DATAFINE >= qbe_frauif->DATAOPE) 
]
h=[
19
19
]
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1138
fatherSonIndex=0
frm_calc='''
len=1
name='_sesso
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_perpaese)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'(Empty(_perpaese) and Empty(_percab)) or (_perpaese='086' and Empty(_percab))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_percab)) and not(mcCitta.GoToKey(LRTrim(_percab)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_settsint)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_sesso))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_settsint)) and _settsint='999'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(qbe_frauif->CODDIPE)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_codcab) and not(Empty(qbe_frauif->CODDIPE))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_codcab)) and not(mcCitta.GoToKey(LRTrim(_codcab)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(qbe_frauif->CODVOC)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(qbe_frauif->SEGNO)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'At(LRTrim(qbe_frauif->CODVOC),'|1B|2B|3B|4B|5B|6B|3M|4M|5M|6M|1R|2R') > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(qbe_frauif->C_CAB)) and not(mcCitta.GoToKey(LRTrim(qbe_frauif->C_CAB)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(qbe_frauif->CODCAB2)) and not(mcCitta.GoToKey(LRTrim(qbe_frauif->CODCAB2)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_errore)))
]
h=[
19
19
]
obj='If
pag=3
prev=O1184
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1187
fatherSonIndex=0
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPIfElse
frm_calc=[
'pTipo='Z'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O1192
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O1193
fatherSonIndex=0
frm_calc='-- Inserimento per reimport dei errori corretti
next=Icpitembatch.CPInsert
arch='tmp_stpoperazioni
obj='Insert
pag=3
prev=O1198
rd_kfield=[
'AUTOM
'C_CAB
'C_CTA
'C_IND
'C_STA
'CABICP
'CAMBIO
'CDATOPE
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNESBEN
'CONNESCLI
'CONNESCOL
'CONNESOPER
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'ERR01
'ERR02
'ERR03
'ERR04
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'IDFILE
'INFORM
'IPCOLLEG
'MODSVOL
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PAESECP
'PROV2
'PROVINCIA
'RAGCLI
'RAPPORTBEN
'RAPPORTO
'RESPINS
'RIFIMP
'SCOPO
'SEGNO
'SETTSINTAGG
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'TXTNOTE
'UCODE
'VALUTA
]
rd_kvar=[
'qbe_frauif->AUTOM
'qbe_frauif->C_CAB
'qbe_frauif->DESCRIZ
'qbe_frauif->CODDIP
'qbe_frauif->C_STA
'qbe_frauif->CABCLI
'qbe_frauif->CAMBIO
'qbe_frauif->CDATOPE
'qbe_frauif->CODANA
'qbe_frauif->CODCAB
'qbe_frauif->CODCAB2
'qbe_frauif->CODDIPE
'qbe_frauif->CODINT2
'qbe_frauif->CODINTER
'qbe_frauif->CODVOC
'qbe_frauif->COLLEG
'qbe_frauif->CONNESBEN
'qbe_frauif->CONNESCLI
'qbe_frauif->CONNESCLI
'qbe_frauif->CONNESOPER
'qbe_frauif->DATAOPE
'qbe_frauif->DATAREG
'qbe_frauif->DATARETT
'qbe_frauif->DESCCITCLI
'qbe_frauif->DESCCIT
'qbe_frauif->DESCINTER
'qbe_frauif->DOCFILE
''N'
''N'
''N'
''N'
'qbe_frauif->FLAGCONT
'qbe_frauif->FLAGFRAZ
'qbe_frauif->FLAGLIRE
'qbe_frauif->FLAGRAP
'qbe_frauif->FLAGRAP2
'qbe_frauif->IDBASE
'qbe_frauif->idcauana
'qbe_frauif->IDEREG
'qbe_frauif->DESCCITD
'qbe_frauif->INFORM
'qbe_frauif->CODFISC
'qbe_frauif->MODSVOL
'qbe_frauif->NUMPROG
'qbe_frauif->OPERAG
'qbe_frauif->OPERATORE
'qbe_frauif->OPERAZMOD
'qbe_frauif->OPRAP
'qbe_frauif->PAESE
'qbe_frauif->PAESECLI
'qbe_frauif->PROV2
'qbe_frauif->PROVINCIA
'qbe_frauif->RAGSOC
'qbe_frauif->RAPPORTBEN
'qbe_frauif->RAPPORTO
'qbe_frauif->RESPINS
'qbe_frauif->RIFIMP
'qbe_frauif->CABDIP
'qbe_frauif->SEGNO
'qbe_frauif->SETTSINT
'qbe_frauif->STATOREG
''FRZ'
'qbe_frauif->TIPOINF
'qbe_frauif->TIPOINT2
'qbe_frauif->TIPOINTER
'qbe_frauif->TIPOLEG
'qbe_frauif->TIPOOPRAP
'qbe_frauif->TOTCONT/100
'qbe_frauif->TOTLIRE/100
'_errore
'qbe_frauif->SOTGRUP
'qbe_frauif->VALUTA
]
I
obj='Remark
pag=3
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O1193
fatherSonIndex=1
frm_calc='-- classico inserimento
next=Icpitembatch.CPInsert
arch='tmp_stpoperazioni
obj='Insert
pag=3
prev=O1203
rd_kfield=[
'AUTOM
'CAMBIO
'CDATOPE
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNESBEN
'CONNESCLI
'CONNESCOL
'CONNESOPER
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'ERR01
'ERR02
'ERR03
'ERR04
'ERR05
'ERR06
'ERR07
'ERR08
'ERR09
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'MODSVOL
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PROV2
'PROVINCIA
'RAPPORTBEN
'RAPPORTO
'RESPINS
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'TXTNOTE
'VALUTA
]
rd_kvar=[
'qbe_frauif->AUTOM
'qbe_frauif->CAMBIO
'qbe_frauif->CDATOPE
'qbe_frauif->CODANA
'qbe_frauif->CODCAB
'qbe_frauif->CODCAB2
'qbe_frauif->CODDIPE
'qbe_frauif->CODINT2
'qbe_frauif->CODINTER
'qbe_frauif->CODVOC
'qbe_frauif->COLLEG
'qbe_frauif->CONNESBEN
'qbe_frauif->CONNESCLI
'qbe_frauif->CONNESCLI
'qbe_frauif->CONNESOPER
'qbe_frauif->DATAOPE
'qbe_frauif->DATAREG
'qbe_frauif->DATARETT
'qbe_frauif->DESC2
'qbe_frauif->DESCCIT
'qbe_frauif->DESCINTER
'qbe_frauif->DOCFILE
'_err01
'_err02
'_err03
'_err04
'_err05
'_err06
'_err07
'_err08
'_err09
'qbe_frauif->FLAGCONT
'qbe_frauif->FLAGFRAZ
'qbe_frauif->FLAGLIRE
'qbe_frauif->FLAGRAP
'qbe_frauif->FLAGRAP2
'qbe_frauif->IDBASE
'qbe_frauif->idcauana
'qbe_frauif->IDEREG
'qbe_frauif->INFORM
'qbe_frauif->MODSVOL
'qbe_frauif->NUMPROG
'qbe_frauif->OPERAG
'qbe_frauif->OPERATORE
'qbe_frauif->OPERAZMOD
'qbe_frauif->OPRAP
'qbe_frauif->PAESE
'qbe_frauif->PROV2
'qbe_frauif->PROVINCIA
'qbe_frauif->RAPPORTBEN
'qbe_frauif->RAPPORTO
'qbe_frauif->RESPINS
'qbe_frauif->SEGNO
'qbe_frauif->STATOREG
''FRZ'
'qbe_frauif->TIPOINF
'qbe_frauif->TIPOINT2
'qbe_frauif->TIPOINTER
'qbe_frauif->TIPOLEG
'qbe_frauif->TIPOOPRAP
'qbe_frauif->TOTCONT/100
'qbe_frauif->TOTLIRE/100
'_errore
'qbe_frauif->VALUTA
]
I
obj='Remark
pag=3
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1181
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1184
fatherSonIndex=0
frm_calc='_errore + 'CAB Intermediario Controparte Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err09
obj='Var
pag=3
prev=O1211
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1178
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1181
fatherSonIndex=0
frm_calc='_errore + 'CAB Controparte Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err07
obj='Var
pag=3
prev=O1216
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1175
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1178
fatherSonIndex=0
frm_calc=[
'Empty(qbe_frauif->C_STA)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(qbe_frauif->PAESE)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O1221
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1224
fatherSonIndex=0
frm_calc='_errore + 'Manca Paese Intermediario Controparte' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err08
obj='Var
pag=3
prev=O1229
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1224
fatherSonIndex=1
frm_calc='''
len=3
name='_stato
next=Icpitembatch.CPIfElse
frm_calc=[
'mcStati.GoToKey(qbe_frauif->PAESE)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_stato) or (not(Empty(_stato)) and _stato='030')
]
h=[
19
19
]
obj='If
pag=3
prev=O1233
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1236
fatherSonIndex=0
frm_calc='_errore + 'Paese Intermediario Controparte Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err08
obj='Var
pag=3
prev=O1241
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1232
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1233
fatherSonIndex=0
frm_calc='mcStati.CODSTA
len=3
name='_stato
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1221
fatherSonIndex=0
frm_calc='_errore + 'Manca Paese Residenza Controparte' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err06
obj='Var
pag=3
prev=O1251
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1221
fatherSonIndex=1
frm_calc='''
len=3
name='_stato
next=Icpitembatch.CPIfElse
frm_calc=[
'mcStati.GoToKey(qbe_frauif->C_STA)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_stato) or (not(Empty(_stato)) and _stato='030')
]
h=[
19
19
]
obj='If
pag=3
prev=O1255
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1258
fatherSonIndex=0
frm_calc='_errore + 'Paese Residenza Controparte Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err06
obj='Var
pag=3
prev=O1263
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1254
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1255
fatherSonIndex=0
frm_calc='mcStati.CODSTA
len=3
name='_stato
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1172
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1175
fatherSonIndex=0
frm_calc='_errore + 'Manca Segno Operazione' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err11
obj='Var
pag=3
prev=O1274
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1169
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1172
fatherSonIndex=0
frm_calc='_errore + 'Manca CAUSALE SINTETICA' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err10
obj='Var
pag=3
prev=O1279
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1166
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1169
fatherSonIndex=0
frm_calc='_errore + 'CAB Dipendenza / Agenzia Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err05
obj='Var
pag=3
prev=O1284
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1163
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1166
fatherSonIndex=0
frm_calc='_errore + 'Manca CAB Dipendeza / Agenzia' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err05
obj='Var
pag=3
prev=O1289
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1160
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1163
fatherSonIndex=0
frm_calc='_errore + 'Manca Codce Agenzia' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err05
obj='Var
pag=3
prev=O1294
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1157
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1160
fatherSonIndex=0
frm_calc='_errore + 'Settore sintetico 999 non valido per SARA'
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err04
obj='Var
pag=3
prev=O1299
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1154
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1157
fatherSonIndex=0
frm_calc=[
'(_settsint<>'600' and _settsint<>'601') and _perpaese='086'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_settsint<>'711' and _perpaese<>'086'
]
h=[
19
19
]
obj='If
pag=3
prev=O1304
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1307
fatherSonIndex=0
frm_calc='_errore + "Settore Sintetico Cliente Residente all'Estero Errato"
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err03
obj='Var
pag=3
prev=O1312
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1304
fatherSonIndex=0
frm_calc='_errore + 'Settore Sintetico Cliente Residente in Italia Errato'
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err03
obj='Var
pag=3
prev=O1317
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1151
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1154
fatherSonIndex=0
frm_calc='_errore +  'Manca Settore Sintetico Cliente'
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err03
obj='Var
pag=3
prev=O1323
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1148
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1151
fatherSonIndex=0
frm_calc='_errore + 'CAB Residenza Cliente Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err02
obj='Var
pag=3
prev=O1328
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1145
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1148
fatherSonIndex=0
frm_calc='_errore + 'Manca CAB Residenza Cliente' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err02
obj='Var
pag=3
prev=O1333
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1144
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1145
fatherSonIndex=0
frm_calc='_errore + 'Manca Paese Residenza Cliente' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err01
obj='Var
pag=3
prev=O1338
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1145
fatherSonIndex=1
frm_calc='''
len=3
name='_stato
next=Icpitembatch.CPIfElse
frm_calc=[
'mcStati.GoToKey(_perpaese)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_stato) or (not(Empty(_stato)) and _stato='030')
]
h=[
19
19
]
obj='If
pag=3
prev=O1342
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1345
fatherSonIndex=0
frm_calc='_errore + 'Paese Residenza Cliente Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err01
obj='Var
pag=3
prev=O1350
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1341
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1342
fatherSonIndex=0
frm_calc='mcStati.CODSTA
len=3
name='_stato
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=3
prev=O1143
rd_field=[
'CODCAB
'PAESE
'SETTSINT
'SESSO
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(intestbo->CODINTER)
]
rd_var=[
'_percab
'_perpaese
'_settsint
'_sesso
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1129
fatherSonIndex=1
frm_calc=[
'Empty(_perpaese)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_perpaese)) and _perpaese='030'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(Empty(_perpaese) and Empty(_percab)) or (_perpaese='086' and Empty(_percab))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_percab)) and not(mcCitta.GoToKey(LRTrim(_percab)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_settsint)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_sesso))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_settsint)) and _settsint='999'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(qbe_frauif->CODDIPE)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_codcab) and not(Empty(qbe_frauif->CODDIPE))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_codcab)) and not(mcCitta.GoToKey(LRTrim(_codcab)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'At(LRTrim(qbe_frauif->CODVOC),'|1B|2B|3B|4B|5B|6B|3M|4M|5M|6M|1R|2R') > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(qbe_frauif->C_CAB)) and not(mcCitta.GoToKey(LRTrim(qbe_frauif->C_CAB)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(qbe_frauif->CODCAB2)) and not(mcCitta.GoToKey(LRTrim(qbe_frauif->CODCAB2)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_errore)))
]
h=[
19
19
]
obj='If
pag=3
prev=O1401
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1404
fatherSonIndex=0
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPIfElse
frm_calc=[
'pTipo='Z'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O1409
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O1410
fatherSonIndex=0
frm_calc='-- Inserimento per reimport dei errori corretti
next=Icpitembatch.CPInsert
arch='tmp_stpoperazioni
obj='Insert
pag=3
prev=O1415
rd_kfield=[
'AUTOM
'C_CAB
'C_CTA
'C_IND
'C_STA
'CABICP
'CAMBIO
'CDATOPE
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNESBEN
'CONNESCLI
'CONNESCOL
'CONNESOPER
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'ERR01
'ERR02
'ERR03
'ERR04
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'IDFILE
'INFORM
'IPCOLLEG
'MODSVOL
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PAESECP
'PROV2
'PROVINCIA
'RAGCLI
'RAPPORTBEN
'RAPPORTO
'RESPINS
'RIFIMP
'SCOPO
'SEGNO
'SETTSINTAGG
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'TXTNOTE
'UCODE
'VALUTA
]
rd_kvar=[
'qbe_frauif->AUTOM
'qbe_frauif->C_CAB
'qbe_frauif->DESCRIZ
'qbe_frauif->CODDIP
'qbe_frauif->C_STA
'qbe_frauif->CABCLI
'qbe_frauif->CAMBIO
'qbe_frauif->CDATOPE
'qbe_frauif->CODANA
'qbe_frauif->CODCAB
'qbe_frauif->CODCAB2
'qbe_frauif->CODDIPE
'qbe_frauif->CODINT2
'qbe_frauif->CODINTER
'qbe_frauif->CODVOC
'qbe_frauif->COLLEG
'qbe_frauif->CONNESBEN
'qbe_frauif->CONNESCLI
'qbe_frauif->CONNESCLI
'qbe_frauif->CONNESOPER
'qbe_frauif->DATAOPE
'qbe_frauif->DATAREG
'qbe_frauif->DATARETT
'qbe_frauif->DESCCITCLI
'qbe_frauif->DESCCIT
'qbe_frauif->DESCINTER
'qbe_frauif->DOCFILE
''N'
''N'
''N'
''N'
'qbe_frauif->FLAGCONT
'qbe_frauif->FLAGFRAZ
'qbe_frauif->FLAGLIRE
'qbe_frauif->FLAGRAP
'qbe_frauif->FLAGRAP2
'qbe_frauif->IDBASE
'qbe_frauif->idcauana
'qbe_frauif->IDEREG
'qbe_frauif->DESCCITD
'qbe_frauif->INFORM
'qbe_frauif->CODFISC
'qbe_frauif->MODSVOL
'qbe_frauif->NUMPROG
'qbe_frauif->OPERAG
'qbe_frauif->OPERATORE
'qbe_frauif->OPERAZMOD
'qbe_frauif->OPRAP
'qbe_frauif->PAESE
'qbe_frauif->PAESECLI
'qbe_frauif->PROV2
'qbe_frauif->PROVINCIA
'qbe_frauif->RAGSOC
'qbe_frauif->RAPPORTBEN
'qbe_frauif->RAPPORTO
'qbe_frauif->RESPINS
'qbe_frauif->RIFIMP
'qbe_frauif->CABDIP
'qbe_frauif->SEGNO
'qbe_frauif->SETTSINT
'qbe_frauif->STATOREG
''FRZ'
'qbe_frauif->TIPOINF
'qbe_frauif->TIPOINT2
'qbe_frauif->TIPOINTER
'qbe_frauif->TIPOLEG
'qbe_frauif->TIPOOPRAP
'qbe_frauif->TOTCONT/100
'qbe_frauif->TOTLIRE/100
'_errore
'qbe_frauif->SOTGRUP
'qbe_frauif->VALUTA
]
I
obj='Remark
pag=3
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O1410
fatherSonIndex=1
frm_calc='-- classico inserimento
next=Icpitembatch.CPInsert
arch='tmp_stpoperazioni
obj='Insert
pag=3
prev=O1420
rd_kfield=[
'AUTOM
'CAMBIO
'CDATOPE
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNESBEN
'CONNESCLI
'CONNESCOL
'CONNESOPER
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'ERR01
'ERR02
'ERR03
'ERR04
'ERR05
'ERR06
'ERR07
'ERR08
'ERR09
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'MODSVOL
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PROV2
'PROVINCIA
'RAPPORTBEN
'RAPPORTO
'RESPINS
'RIFIMP
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'TXTNOTE
'VALUTA
]
rd_kvar=[
'qbe_frauif->AUTOM
'qbe_frauif->CAMBIO
'qbe_frauif->CDATOPE
'qbe_frauif->CODANA
'qbe_frauif->CODCAB
'qbe_frauif->CODCAB2
'qbe_frauif->CODDIPE
'qbe_frauif->CODINT2
'qbe_frauif->CODINTER
'qbe_frauif->CODVOC
'qbe_frauif->COLLEG
'qbe_frauif->CONNESBEN
'qbe_frauif->CONNESCLI
'qbe_frauif->CONNESCLI
'qbe_frauif->CONNESOPER
'qbe_frauif->DATAOPE
'qbe_frauif->DATAREG
'qbe_frauif->DATARETT
'qbe_frauif->DESC2
'qbe_frauif->DESCCIT
'qbe_frauif->DESCINTER
'qbe_frauif->DOCFILE
'_err01
'_err02
'_err03
'_err04
'_err05
'_err06
'_err07
'_err08
'_err09
'qbe_frauif->FLAGCONT
'qbe_frauif->FLAGFRAZ
'qbe_frauif->FLAGLIRE
'qbe_frauif->FLAGRAP
'qbe_frauif->FLAGRAP2
'qbe_frauif->IDBASE
'qbe_frauif->idcauana
'qbe_frauif->IDEREG
'qbe_frauif->INFORM
'qbe_frauif->MODSVOL
'qbe_frauif->NUMPROG
'qbe_frauif->OPERAG
'qbe_frauif->OPERATORE
'qbe_frauif->OPERAZMOD
'qbe_frauif->OPRAP
'qbe_frauif->PAESE
'qbe_frauif->PROV2
'qbe_frauif->PROVINCIA
'qbe_frauif->RAPPORTBEN
'qbe_frauif->RAPPORTO
'qbe_frauif->RESPINS
'qbe_frauif->RIFIMP
'qbe_frauif->SEGNO
'qbe_frauif->STATOREG
''FRZ'
'qbe_frauif->TIPOINF
'qbe_frauif->TIPOINT2
'qbe_frauif->TIPOINTER
'qbe_frauif->TIPOLEG
'qbe_frauif->TIPOOPRAP
'qbe_frauif->TOTCONT/100
'qbe_frauif->TOTLIRE/100
'_errore
'qbe_frauif->VALUTA
]
I
obj='Remark
pag=3
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1398
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1401
fatherSonIndex=0
frm_calc='_errore + 'CAB Intermediario Controparte Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err09
obj='Var
pag=3
prev=O1428
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1395
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1398
fatherSonIndex=0
frm_calc='_errore + 'CAB Controparte Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err07
obj='Var
pag=3
prev=O1433
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1392
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1395
fatherSonIndex=0
frm_calc=[
'Empty(qbe_frauif->C_STA)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(qbe_frauif->PAESE)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O1438
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1441
fatherSonIndex=0
frm_calc='_errore + 'Manca Paese Intermediario Controparte' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err08
obj='Var
pag=3
prev=O1446
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1441
fatherSonIndex=1
frm_calc='''
len=3
name='_stato
next=Icpitembatch.CPIfElse
frm_calc=[
'mcStati.GoToKey(qbe_frauif->PAESE)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_stato) or (not(Empty(_stato)) and _stato='030')
]
h=[
19
19
]
obj='If
pag=3
prev=O1450
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1453
fatherSonIndex=0
frm_calc='_errore + 'Paese Intermediario Controparte Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err08
obj='Var
pag=3
prev=O1458
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1449
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1450
fatherSonIndex=0
frm_calc='mcStati.CODSTA
len=3
name='_stato
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1438
fatherSonIndex=0
frm_calc='_errore + 'Manca Paese Residenza Controparte' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err06
obj='Var
pag=3
prev=O1468
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1438
fatherSonIndex=1
frm_calc='''
len=3
name='_stato
next=Icpitembatch.CPIfElse
frm_calc=[
'mcStati.GoToKey(qbe_frauif->C_STA)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_stato) or (not(Empty(_stato)) and _stato='030')
]
h=[
19
19
]
obj='If
pag=3
prev=O1472
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1475
fatherSonIndex=0
frm_calc='_errore + 'Paese Residenza Controparte Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err06
obj='Var
pag=3
prev=O1480
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1471
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1472
fatherSonIndex=0
frm_calc='mcStati.CODSTA
len=3
name='_stato
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1389
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1392
fatherSonIndex=0
frm_calc='_errore + 'CAB Dipendenza / Agenzia Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err05
obj='Var
pag=3
prev=O1491
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1386
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1389
fatherSonIndex=0
frm_calc='_errore + 'Manca CAB Dipendenza / Agenzia' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err05
obj='Var
pag=3
prev=O1496
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1383
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1386
fatherSonIndex=0
frm_calc='_errore + 'Manca Codce Agenzia' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err05
obj='Var
pag=3
prev=O1501
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1380
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1383
fatherSonIndex=0
frm_calc='_errore + 'Settore sintetico 999 non valido per SARA'
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err04
obj='Var
pag=3
prev=O1506
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1377
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1380
fatherSonIndex=0
frm_calc=[
'_settsint<>'600' and _perpaese='086'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_settsint<>'711' and _perpaese<>'086'
]
h=[
19
19
]
obj='If
pag=3
prev=O1511
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1514
fatherSonIndex=0
frm_calc='_errore + "Settore Sintetico Cliente Residente all'Estero Errato"
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err03
obj='Var
pag=3
prev=O1519
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1511
fatherSonIndex=0
frm_calc='_errore + 'Settore Sintetico Cliente Residente in Italia Errato'
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err03
obj='Var
pag=3
prev=O1524
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1374
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1377
fatherSonIndex=0
frm_calc='_errore + 'Manca Settore Sintetico Cliente'
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err03
obj='Var
pag=3
prev=O1530
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1371
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1374
fatherSonIndex=0
frm_calc='_errore + 'CAB Residenza Cliente Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err02
obj='Var
pag=3
prev=O1535
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1368
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1371
fatherSonIndex=0
frm_calc='_errore + 'Manca CAB Residenza Cliente' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err02
obj='Var
pag=3
prev=O1540
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1365
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1368
fatherSonIndex=0
frm_calc=''X'
len=1
name='_err01
next=Icpitembatch.CPVarDecl
frm_calc='_errore + 'Paese di residenza non valido' + NL
len=10
name='_errore
obj='Var
obj_type='M
pag=3
prev=O1545
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1365
fatherSonIndex=0
frm_calc='_errore + 'Manca Paese Residenza Cliente' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err01
obj='Var
pag=3
prev=O1550
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1365
fatherSonIndex=1
frm_calc='''
len=3
name='_stato
next=Icpitembatch.CPIfElse
frm_calc=[
'mcStati.GoToKey(_perpaese)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_stato) or (not(Empty(_stato)) and _stato='030')
]
h=[
19
19
]
obj='If
pag=3
prev=O1554
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1557
fatherSonIndex=0
frm_calc='_errore + 'Paese Residenza Cliente Errato' + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_err01
obj='Var
pag=3
prev=O1562
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O1553
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1554
fatherSonIndex=0
frm_calc='mcStati.CODSTA
len=3
name='_stato
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=3
prev=O1126
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1127
fatherSonIndex=0
frm_calc='''
len=1
name='_err01
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err02
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err03
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err04
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err05
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err06
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err07
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err08
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err09
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err10
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_err11
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc='qbe_frauif->PAESECLI
len=3
name='_perpaese
next=Icpitembatch.CPVarDecl
frm_calc='qbe_frauif->CABCLI
len=6
name='_percab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(qbe_frauif->CODCAB),qbe_frauif->CABDIP,qbe_frauif->CODCAB)
len=6
name='_codcab
next=Icpitembatch.CPVarDecl
frm_calc='qbe_frauif->SETTSINT
len=3
name='_settsint
next=Icpitembatch.CPVarDecl
frm_calc='qbe_frauif->SESSO
len=1
name='_sesso
obj='Var
pag=3
prev=O1588
var_op='asgn
I
obj='Var
pag=3
prev=O1587
var_op='asgn
I
obj='Var
pag=3
prev=O1586
var_op='asgn
I
obj='Var
pag=3
prev=O1585
var_op='asgn
I
obj='Var
pag=3
prev=O1584
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O1583
var_op='asgn
I
obj='Var
pag=3
prev=O1582
var_op='asgn
I
obj='Var
pag=3
prev=O1581
var_op='asgn
I
obj='Var
pag=3
prev=O1580
var_op='asgn
I
obj='Var
pag=3
prev=O1579
var_op='asgn
I
obj='Var
pag=3
prev=O1578
var_op='asgn
I
obj='Var
pag=3
prev=O1577
var_op='asgn
I
obj='Var
pag=3
prev=O1576
var_op='asgn
I
obj='Var
pag=3
prev=O1575
var_op='asgn
I
obj='Var
pag=3
prev=O1574
var_op='asgn
I
obj='Var
pag=3
prev=O1573
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=3
prev=O1125
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1124
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=3
prev=O1112
var_op='asgn
I
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O1112
fatherSonIndex=0
frm_calc='gMsgProc + 'Sto elaborando il giorno: '+arfn_fdate(_dataoggi) + " del file frazionate"
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O1112
fatherSonIndex=1
frm_calc='Strtran(gMsgProc,_oldmsg,'Sto elaborando il giorno: '+arfn_fdate(_dataoggi) + " del file frazionate")
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O1096
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1095
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O1094
var_op='asgn
I
obj='Var
pag=3
prev=O1093
var_op='asgn
I
obj='Var
obj_type='D
pag=3
prev=O1092
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1091
var_op='asgn
I
obj='Remark
pag=3
prev=O1090
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1089
var_op='asgn
I
obj='Remark
pag=3
x=10
y=14
I
]
comment='Check Operazioni per SARA (XBRL)
date_creat=#2006-09-14
date_rev=#2022-07-05
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'Utilities
]
modcnt=168
page_result_class=[
'
'
'
'
]
page_result_type=[
'U
'U
'U
'U
]
page_uid=[
'AIEVJSWYSY
'FRYVUJHBWP
'IDPWAPEBJT
'KTEQQNLNWB
]
pagename=[
'Page_1
'Page_2
'Page_3
'Page_4
]
pagenote=[
'
'
'
'
]
pagetitle=[
'Main
'Operazioni
'Frazionate
'Operazioni Società Quotate
]
result_type='N
runtime_filters=2
tpl_name='Function
work_file=[
'anadip
'clientifrz
'clientiope
'filedatiuic
'intestbo
'personbo
'tbstati
'tmp_stpoperazioni
'tbcitta
]
work_filter=[
'
'
'
'
'
'
'
'
'
'
'
'
'
]
I
*--*
*----*
