<html>
 <head>
  <title>Tables</title>
  <meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
  <link rel="stylesheet" href="extender.css" type="text/css">
  <script src="../stdFunctions.js"></script>
  <script src="../spadministration_help.js"></script>
  <script>
var tables=null;
var m_cProgName="spadministration_table_extender_relation_table";

function DoLoad() {
  tables = GetOpener().tables;

  for (var i=0; i<tables.length; i++) {
    document.getElementById("objectlist").options[document.getElementById("objectlist").options.length] =
                new Option(tables[i][1]+" ("+tables[i][0]+")", i, false);
  }
  document.getElementById("objectlist").options.selectedIndex = GetOpener().foreignTableIdx;
  document.getElementById("objectlist").focus();
}
function SelectTable() {
  GetOpener().SetLinkedTable(tables[document.getElementById("objectlist").options[document.getElementById("objectlist").options.selectedIndex].value][0],
                               document.getElementById("objectlist").options[document.getElementById("objectlist").options.selectedIndex].value);
  WindowClose();
}
function CloseWindow() {
  WindowClose();
}
function ManageKeys(e) {
  if(e.keyCode==13) SelectTable();
  else if(e.keyCode==27) CloseWindow();
}
function CancelEvent(e){
 e.cancelBubble=true
 if(e.stopPropagation) e.stopPropagation();
 e.returnValue=false
}
function CancelHelp(e) {
 CancelEvent(e);
 Help();
}
  </script>
 </head>

 <body onload="DoLoad()" onhelp="CancelHelp(event)" onkeydown="ManageKeys(event)" bgcolor="#D6D3CE" topmargin="0" leftmargin="0" marginwidth="0" marginheight="0" scroll="no" style="border:0px;overflow:hidden;margin:0pt">
  <table border="1" width="380" height="338" cellpadding="0" cellspacing="1" align="center">
   <tr style="height:20">
    <td class="titoli" onselectstart="return false">A<u>v</u>ailable <span id="AvailableObjects">tables</span></td>
   </tr>
   <tr>
    <td>
     <select class="expression_textarea" id="objectlist" size="25" style="width:100%;height:100%" ondblclick="SelectTable()" accesskey="v">
     </select>
    </td>
   </tr>
   <tr>
    <td colspan="2" height="20" class="footer-button-container">
     <button onclick="SelectTable()" accesskey="o" class="bottoni confirm"><u>O</u>K</button>&nbsp;
     <button onclick="WindowClose()" accesskey="c" class="bottoni"><u>C</u>ancel</button>
    </td>
   </tr>
  </table>
 </body>
</html>
