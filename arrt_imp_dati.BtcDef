* --- CodePainter Revolution Batch Vers. 5.1
￼Icpbatch.CPBatch
Items=[
Icpitembatch.CPBeginEnd
comment='Definizione variabili caller
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Cursori Lettura Tabelle
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili Locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='variabili copia
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='variabili locali per decoprimere il file
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili globali
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Legge dati intermediario per metteri su operazbo,fraziobo,rapopebo se mancanti
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='gestione storico import
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_date_oggi
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(""+Day(_date_oggi)+Month(_date_oggi)+(Year(_date_oggi)-20))
len=8
name='_date_oggi_venti_anni_fa
next=Icpitembatch.CPRemark
frm_calc='Import Soggetti
next=Icpitembatch.CPVarDecl
frm_calc='''
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPRemark
frm_calc='Cicla sul file della lista e lancia la pagina appropriata
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_esito
next=Icpitembatch.CPExec
check='page
frm_calc='27
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_chkerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_opeerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_frzerr
next=Icpitembatch.CPIfElse
frm_calc=[
'w_chkaui='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_chkaui = 'N' or (w_chkaui='S' and w_imperr='S') or  (w_chkaui='S' and w_imperr='N' and _chkerr=0)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPExec
frm_calc='LibreriaMit.FreeMem()
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog('IMPORT','IMPORT','',gMsgProc)
next=Ispitembatch.CPReturn
frm_calc='_chkerr
obj='Return
pag=1
prev=O41
I
obj='Exec
pag=1
prev=O40
I
obj='Exec
pag=1
prev=O37
I
obj='If
pag=1
prev=O34
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDropTemporaryTable
father=O37
fatherSonIndex=0
next=Icpitembatch.CPServerTemporaryTable
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWrite('output/'+LRTrim(gAzienda)+'/archope_scarti')
len=1
name='ohand
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWrite('output/'+LRTrim(gAzienda)+'/archfraz_scarti')
len=1
name='zhand
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWrite('output/'+LRTrim(gAzienda)+'/opex_scarti')
len=1
name='xhand
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWrite('output/'+LRTrim(gAzienda)+'/saldopex_scarti')
len=1
name='shand
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Scrittura file con errori
h=[
19
19
]
obj='Begin
pag=1
prev=O52
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O54
fatherSonIndex=0
frm_calc='FileLibMit.Close(ohand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(zhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(xhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(shand)
next=Icpitembatch.CPIfElse
frm_calc=[
'_opeerr=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_frzerr=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_opxerr=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_soxerr=0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O68
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O71
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('output/'+LRTrim(gAzienda)+'/saldopex_scarti')
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O71
fatherSonIndex=1
frm_calc='2
len=1
name='_chkerr
next=Icpitembatch.CPVarDecl
frm_calc='"saldopex_scarti.zip"
len=20
name='_czip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/"+_czip
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/saldopex_scarti"
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='"saldopex_scarti"
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc='// These are the files to include in the ZIP file﷯filenames.clear();﷯fileonames.clear();﷯filenames.add(cNomeFile);﷯fileonames.add(cOnlyNomeFile);
next=Icpitembatch.CPExec
check='page
frm_calc='36
next=Icpitembatch.CPInsert
arch='tmp_listafile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevate operazioni extraconto senza i dati del soggetto. Prelevare il file saldopex_scarti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('output/'+LRTrim(gAzienda)+'/saldopex_scarti')
obj='Exec
pag=1
prev=O86
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O85
var_op='asgn
I
obj='Insert
pag=1
prev=O84
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
''saldopex_scarti'
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/saldopex_scarti.zip"
]
I
obj='Exec
pag=1
prev=O83
I
obj='Exec
pag=1
prev=O82
I
obj='Var
pag=1
prev=O81
var_op='asgn
I
obj='Var
pag=1
prev=O80
var_op='asgn
I
obj='Var
pag=1
prev=O79
var_op='asgn
I
obj='Var
pag=1
prev=O78
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=1
prev=O65
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O68
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('output/'+LRTrim(gAzienda)+'/opex_scarti')
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O68
fatherSonIndex=1
frm_calc='2
len=1
name='_chkerr
next=Icpitembatch.CPVarDecl
frm_calc='"opex_scarti.zip"
len=20
name='_czip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/"+_czip
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/opex_scarti"
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='"opex_scarti"
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc='// These are the files to include in the ZIP file﷯filenames.clear();﷯fileonames.clear();﷯filenames.add(cNomeFile);﷯fileonames.add(cOnlyNomeFile);
next=Icpitembatch.CPExec
check='page
frm_calc='36
next=Icpitembatch.CPInsert
arch='tmp_listafile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevate operazioni extraconto senza i dati del soggetto. Prelevare il file opex_scarti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('output/'+LRTrim(gAzienda)+'/opex_scarti')
obj='Exec
pag=1
prev=O103
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O102
var_op='asgn
I
obj='Insert
pag=1
prev=O101
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
''opex_scarti'
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/opex_scarti.zip"
]
I
obj='Exec
pag=1
prev=O100
I
obj='Exec
pag=1
prev=O99
I
obj='Var
pag=1
prev=O98
var_op='asgn
I
obj='Var
pag=1
prev=O97
var_op='asgn
I
obj='Var
pag=1
prev=O96
var_op='asgn
I
obj='Var
pag=1
prev=O95
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=1
prev=O62
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O65
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('output/'+LRTrim(gAzienda)+'/archfraz_scarti')
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O65
fatherSonIndex=1
frm_calc='2
len=1
name='_chkerr
next=Icpitembatch.CPVarDecl
frm_calc='"archfraz_scarti.zip"
len=20
name='_czip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/"+_czip
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/archfraz_scarti"
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='"archfraz_scarti"
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc='// These are the files to include in the ZIP file﷯filenames.clear();﷯fileonames.clear();﷯filenames.add(cNomeFile);﷯fileonames.add(cOnlyNomeFile);
next=Icpitembatch.CPExec
check='page
frm_calc='36
next=Icpitembatch.CPInsert
arch='tmp_listafile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevate frazionate senza i dati del soggetto. Prelevare il file archfraz_scarti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('output/'+LRTrim(gAzienda)+'/archfraz_scarti')
obj='Exec
pag=1
prev=O120
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O119
var_op='asgn
I
obj='Insert
pag=1
prev=O118
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
''archfraz_scarti'
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/archfraz_scarti.zip"
]
I
obj='Exec
pag=1
prev=O117
I
obj='Exec
pag=1
prev=O116
I
obj='Var
pag=1
prev=O115
var_op='asgn
I
obj='Var
pag=1
prev=O114
var_op='asgn
I
obj='Var
pag=1
prev=O113
var_op='asgn
I
obj='Var
pag=1
prev=O112
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=1
prev=O61
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O62
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('output/'+LRTrim(gAzienda)+'/archope_scarti')
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O62
fatherSonIndex=1
frm_calc='2
len=1
name='_chkerr
next=Icpitembatch.CPVarDecl
frm_calc='"archope_scarti.zip"
len=20
name='_czip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/"+_czip
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/archope_scarti"
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='"archope_scarti"
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc='// These are the files to include in the ZIP file﷯filenames.clear();﷯fileonames.clear();﷯filenames.add(cNomeFile);﷯fileonames.add(cOnlyNomeFile);
next=Icpitembatch.CPExec
check='page
frm_calc='36
next=Icpitembatch.CPInsert
arch='tmp_listafile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevate operazioni senza i dati del soggetto. Prelevare il file archope_scarti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('output/'+LRTrim(gAzienda)+'/archope_scarti')
obj='Exec
pag=1
prev=O137
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O136
var_op='asgn
I
obj='Insert
pag=1
prev=O135
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
''archope_scarti'
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/archope_scarti.zip"
]
I
obj='Exec
pag=1
prev=O134
I
obj='Exec
pag=1
prev=O133
I
obj='Var
pag=1
prev=O132
var_op='asgn
I
obj='Var
pag=1
prev=O131
var_op='asgn
I
obj='Var
pag=1
prev=O130
var_op='asgn
I
obj='Var
pag=1
prev=O129
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=1
prev=O60
I
obj='Exec
pag=1
prev=O59
I
obj='Exec
pag=1
prev=O58
I
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Try
pag=1
prev=O51
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O52
fatherSonIndex=0
frm_calc=[
'gFlgRet='S'
]
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_esito=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Importazione dati terminata.'
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O150
var_op='asgn
I
obj='If
pag=1
prev=O148
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O150
fatherSonIndex=0
frm_calc=''Fine importazione dati. Scrittura dati definitiva. Attendere prego...'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPTransaction
frm_calc='commit
next=Icpitembatch.CPBeginEnd
comment='Gestione storico import
h=[
19
19
]
obj='Begin
pag=1
prev=O157
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='storico_import
father=O158
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'NUMIMP
'TABELLE
]
rd_kvar=[
'_numimp
'"{"+Substr(_tabelle,1,(Len(_tabelle)-1))+"}"
]
I
I
]
w=[
150
150
]
I
obj='Transaction
pag=1
prev=O156
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O150
fatherSonIndex=1
frm_calc='transaction error
frm_seek='Errore durante la scrittura dei dati
obj='Transaction
pag=1
raise_on_trans_err=True
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=1
prev=O145
sel_field='*
sel_name='tmp_list_imprich
sel_order='tmp_list_imprich->priorita,tmp_list_imprich->nomefile
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O148
fatherSonIndex=0
frm_calc=[
'_esito = 0
]
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='tmp_list_imprich
obj='Delete
pag=1
prev=O171
rd_kfield=[
'nomefile
]
rd_kop=[
'=
]
rd_kvar=[
'tmp_list_imprich->nomefile
]
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O171
fatherSonIndex=0
frm_calc='LRTrim(tmp_list_imprich->nomefile)
len=50
name='nomefileimport
next=Icpitembatch.CPCase
frm_calc=[
'At('archpers.txt',Lower(nomefileimport)) <> 0
'At('archdip.txt',Lower(nomefileimport)) <> 0
'At('archtito.txt',Lower(nomefileimport)) <> 0
'At('sogcli.txt',Lower(nomefileimport)) <> 0
'At('archrap.txt',Lower(nomefileimport)) <> 0
'At('archinf.txt',Lower(nomefileimport)) <> 0
'At('archope.txt',Lower(nomefileimport)) <> 0
'At('archfraz.txt',Lower(nomefileimport)) <> 0
'At('intest.txt',Lower(nomefileimport)) <> 0
'At('rapage.txt',Lower(nomefileimport)) <> 0
'At('infage.txt',Lower(nomefileimport)) <> 0
'At('opeage.txt',Lower(nomefileimport)) <> 0
'At('procdel.txt',Lower(nomefileimport)) <> 0
'At('procage.txt',Lower(nomefileimport)) <> 0
'At('sogope.txt',Lower(nomefileimport)) <> 0
'At('sogage.txt',Lower(nomefileimport)) <> 0
'At('intage.txt',Lower(nomefileimport)) <> 0
'At('sogben.txt',Lower(nomefileimport)) <> 0
'At('sogaltro.txt',Lower(nomefileimport)) <> 0
'At('persnew.txt',Lower(nomefileimport)) <> 0
'At('saldopex.txt',Lower(nomefileimport)) <> 0 or At('saldopex.xls',Lower(nomefileimport)) <> 0
'At('saldrapp.txt',Lower(nomefileimport)) <> 0 or At('saldrapp.xls',Lower(nomefileimport)) <> 0
'At('opex.txt',Lower(nomefileimport)) <> 0
'At('titosupp.txt',Lower(nomefileimport)) <> 0
'At('archope.xls',Lower(nomefileimport)) <> 0
'At('agetit.txt',Lower(nomefileimport)) <> 0
'At('agetsupp.txt',Lower(nomefileimport)) <> 0
'At('saldisv.txt',Lower(nomefileimport)) <> 0
'At('archpers.xls',Lower(nomefileimport)) <> 0
'At('archmacroagenti.txt',Lower(nomefileimport)) <> 0 or At('archresleg.txt',Lower(nomefileimport)) <> 0 or At('archpreposti.txt',Lower(nomefileimport)) <> 0
]
h=[
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
]
obj='Case
pag=1
prev=O180
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O181
fatherSonIndex=0
frm_calc='2
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O181
fatherSonIndex=1
frm_calc='14
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O181
fatherSonIndex=2
frm_calc='15
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O181
fatherSonIndex=3
frm_calc='26
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O181
fatherSonIndex=4
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O194
fatherSonIndex=0
frm_calc='7
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O194
fatherSonIndex=1
frm_calc='3
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O181
fatherSonIndex=5
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O204
fatherSonIndex=0
frm_calc='8
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O204
fatherSonIndex=1
frm_calc='4
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O181
fatherSonIndex=6
frm_calc=[
'w_flgimposv='S'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O214
fatherSonIndex=0
frm_calc='31
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O214
fatherSonIndex=1
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O221
fatherSonIndex=0
frm_calc='9
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O221
fatherSonIndex=1
frm_calc='5
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O181
fatherSonIndex=7
frm_calc=[
'w_flgimposv='S'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O232
fatherSonIndex=0
frm_calc='31
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O232
fatherSonIndex=1
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O239
fatherSonIndex=0
frm_calc='Page_10("")
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O239
fatherSonIndex=1
frm_calc='Page_6("")
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O181
fatherSonIndex=8
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O250
fatherSonIndex=0
frm_calc='22
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O250
fatherSonIndex=1
frm_calc='19
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O181
fatherSonIndex=9
frm_calc='11
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O181
fatherSonIndex=10
frm_calc='12
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O181
fatherSonIndex=11
frm_calc='13
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O181
fatherSonIndex=12
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O266
fatherSonIndex=0
frm_calc='20
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O266
fatherSonIndex=1
frm_calc='17
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O181
fatherSonIndex=13
frm_calc='23
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O181
fatherSonIndex=14
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O278
fatherSonIndex=0
frm_calc='21
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O278
fatherSonIndex=1
frm_calc='18
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O181
fatherSonIndex=15
frm_calc='24
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O181
fatherSonIndex=16
frm_calc='25
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O181
fatherSonIndex=17
frm_calc='28
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O181
fatherSonIndex=18
frm_calc='29
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O181
fatherSonIndex=19
frm_calc='30
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O181
fatherSonIndex=20
frm_calc='33
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O181
fatherSonIndex=21
frm_calc='34
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O181
fatherSonIndex=22
frm_calc='16
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O181
fatherSonIndex=23
frm_calc='35
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O181
fatherSonIndex=24
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O306
fatherSonIndex=0
frm_calc='38
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O306
fatherSonIndex=1
frm_calc='37
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O181
fatherSonIndex=25
frm_calc='40
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O181
fatherSonIndex=26
frm_calc='41
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O181
fatherSonIndex=27
frm_calc='42
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O181
fatherSonIndex=28
frm_calc='44
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O181
fatherSonIndex=29
frm_calc='46
obj='Exec
pag=1
I
I
]
w=[
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
]
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intermbo
father=O145
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='xersonbo
next=Icpitembatch.CPDelete
arch='xarchope
next=Icpitembatch.CPDelete
arch='xarchfraz
next=Icpitembatch.CPDelete
arch='xnadip
obj='Delete
pag=1
prev=O333
sel_type='all
I
obj='Delete
pag=1
prev=O332
sel_type='all
I
obj='Delete
pag=1
prev=O331
sel_type='all
I
obj='Delete
pag=1
prev=O330
sel_type='all
I
obj='Write
pag=1
sel_type='all
wr_field=[
'SBLRITORNO
]
wr_op=[
'=
]
wr_var=[
''N'
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O52
fatherSonIndex=1
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Elaborazione dati terminata per la presenza di errori!'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Rilevati errori nell'impotazione dei file! Ricreare il file segnalato e rieseguire l'import dei dati. La procedura annullera automaticamente l'importazione" + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Errore SQL: ' + m_Sql.TransactionErrorMessage() + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='rollback
obj='Transaction
pag=1
prev=O343
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O342
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O341
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
prev=O340
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=1
prev=O50
I
obj='Var
pag=1
prev=O49
var_op='asgn
I
obj='Var
pag=1
prev=O48
var_op='asgn
I
obj='Var
pag=1
prev=O47
var_op='asgn
I
obj='Var
pag=1
prev=O46
var_op='asgn
I
obj='TempTable
pag=1
prev=O45
sel_type='def
server_table='tmp_listafile
I
obj='DropTempTable
pag=1
server_table='tmp_listafile
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O37
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='tmp_list_imprich
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevati errori nei dati anagrafici. Effettuare la stampa' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Elaborazione terminata.'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=1
prev=O350
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O349
var_op='asgn
I
obj='Delete
pag=1
prev=O347
I
obj='Select
pag=1
sel_field='tmp_list_imprich->nomefile
sel_name='tmp_list_imprich
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O347
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+LRTrim(tmp_list_imprich->nomefile))
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=1
prev=O33
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O34
fatherSonIndex=0
frm_calc='32
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O32
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O31
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O30
var_op='asgn
I
obj='Exec
pag=1
prev=O29
I
obj='Var
obj_type='N
pag=1
prev=O27
var_op='asgn
I
obj='Select
pag=1
prev=O26
sel_field='*
sel_name='tmp_list_imprich
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O27
fatherSonIndex=0
frm_calc=[
'At('.zip',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O363
fatherSonIndex=0
frm_calc='LRTrim(tmp_list_imprich->nomefile)
len=100
name='czipfile
next=Icpitembatch.CPExec
check='page
frm_calc='39
obj='Exec
pag=1
prev=O368
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=1
prev=O25
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O24
var_op='asgn
I
obj='Remark
pag=1
prev=O23
I
obj='Var
obj_type='D
pag=1
prev=O22
var_op='asgn
I
obj='Var
obj_type='D
pag=1
prev=O20
var_op='asgn
I
obj='Begin
pag=1
prev=O18
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment=' Inizializzo il TimeStamp dell'import
father=O20
fatherSonIndex=0
frm_calc='DateTime()
len=14
name='_numimp
next=Icpitembatch.CPVarDecl
frm_calc='""
len=10
name='_tabelle
obj='Var
obj_type='M
pag=1
prev=O374
var_op='asgn
I
obj='Var
obj_type='T
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=1
prev=O17
sel_field='*
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O18
fatherSonIndex=0
frm_calc='intermbo->CODINTER
len=11
name='_codinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->DESCCIT
len=30
name='_citinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->CODCAB
len=6
name='_cabinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->PROVINCIA
len=2
name='_prvinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->FLGOPEXTR
len=1
name='_flgmodi
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->FLGDATAIM
len=1
name='_flgdataim
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->FLGRAPCLI
len=1
name='_frapcli
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->DATANASC
len=8
name='_dataeuro
obj='Var
obj_type='D
pag=1
prev=O385
var_op='asgn
I
obj='Var
pag=1
prev=O384
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O383
var_op='asgn
I
obj='Var
pag=1
prev=O382
var_op='asgn
I
obj='Var
pag=1
prev=O381
var_op='asgn
I
obj='Var
pag=1
prev=O380
var_op='asgn
I
obj='Var
pag=1
prev=O379
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=1
prev=O15
I
obj='Begin
pag=1
prev=O13
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
comment='Path Applicazione
father=O15
fatherSonIndex=0
global=True
len=80
name='gPathApp
next=Icpitembatch.CPVarDecl
comment='Azienda
global=True
len=10
name='gAzienda
next=Icpitembatch.CPVarDecl
comment='URL Applicazione
global=True
len=80
name='gUrlApp
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='Messaggio
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Flag Creazione File di Ritorno
global=True
len=1
name='gFlgRet
next=Icpitembatch.CPVarDecl
comment='Tipo Intermediario
global=True
len=2
name='gTipInter
next=Icpitembatch.CPVarDecl
comment='Path Documenti
global=True
len=128
name='gPathDoc
nonlocal=True
obj='Var
pag=1
prev=O396
I
nonlocal=True
obj='Var
pag=1
prev=O395
I
nonlocal=True
obj='Var
pag=1
prev=O394
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O393
I
nonlocal=True
obj='Var
pag=1
prev=O392
I
nonlocal=True
obj='Var
pag=1
prev=O391
I
nonlocal=True
obj='Var
pag=1
prev=O390
I
nonlocal=True
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O11
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O13
fatherSonIndex=0
len=25
name='column01
next=Icpitembatch.CPVarDecl
len=25
name='column02
next=Icpitembatch.CPVarDecl
len=25
name='column03
next=Icpitembatch.CPVarDecl
len=25
name='column04
next=Icpitembatch.CPVarDecl
len=25
name='column05
next=Icpitembatch.CPVarDecl
len=25
name='column06
next=Icpitembatch.CPVarDecl
len=25
name='column07
next=Icpitembatch.CPVarDecl
len=25
name='column08
next=Icpitembatch.CPVarDecl
len=25
name='column09
next=Icpitembatch.CPVarDecl
len=25
name='column10
next=Icpitembatch.CPVarDecl
len=25
name='column11
next=Icpitembatch.CPVarDecl
len=25
name='column12
next=Icpitembatch.CPVarDecl
len=25
name='column13
next=Icpitembatch.CPVarDecl
len=25
name='column14
next=Icpitembatch.CPVarDecl
len=25
name='column15
next=Icpitembatch.CPVarDecl
len=25
name='column16
next=Icpitembatch.CPVarDecl
len=25
name='column17
next=Icpitembatch.CPVarDecl
len=25
name='column18
next=Icpitembatch.CPVarDecl
len=25
name='column19
next=Icpitembatch.CPVarDecl
len=25
name='column20
next=Icpitembatch.CPVarDecl
len=25
name='column21
next=Icpitembatch.CPVarDecl
len=25
name='column22
next=Icpitembatch.CPVarDecl
len=25
name='column23
next=Icpitembatch.CPVarDecl
len=25
name='column24
next=Icpitembatch.CPVarDecl
len=25
name='column25
next=Icpitembatch.CPVarDecl
len=25
name='column26
next=Icpitembatch.CPVarDecl
len=25
name='column27
next=Icpitembatch.CPVarDecl
len=25
name='column28
next=Icpitembatch.CPVarDecl
len=25
name='column29
next=Icpitembatch.CPVarDecl
len=25
name='column30
next=Icpitembatch.CPVarDecl
len=25
name='column31
next=Icpitembatch.CPVarDecl
len=25
name='column32
next=Icpitembatch.CPVarDecl
len=25
name='column33
next=Icpitembatch.CPVarDecl
len=25
name='column34
next=Icpitembatch.CPVarDecl
len=25
name='column35
next=Icpitembatch.CPVarDecl
len=25
name='column36
next=Icpitembatch.CPVarDecl
len=25
name='column37
next=Icpitembatch.CPVarDecl
len=25
name='column38
next=Icpitembatch.CPVarDecl
len=25
name='column39
next=Icpitembatch.CPVarDecl
len=25
name='column40
next=Icpitembatch.CPVarDecl
len=25
name='column41
next=Icpitembatch.CPVarDecl
len=25
name='column42
next=Icpitembatch.CPVarDecl
len=25
name='column43
next=Icpitembatch.CPVarDecl
len=25
name='column44
next=Icpitembatch.CPVarDecl
len=25
name='column45
next=Icpitembatch.CPVarDecl
len=25
name='column46
next=Icpitembatch.CPVarDecl
len=25
name='column47
next=Icpitembatch.CPVarDecl
len=25
name='column48
next=Icpitembatch.CPVarDecl
len=25
name='column49
next=Icpitembatch.CPVarDecl
len=25
name='column50
next=Icpitembatch.CPVarDecl
len=25
name='column51
next=Icpitembatch.CPVarDecl
len=25
name='column52
next=Icpitembatch.CPVarDecl
len=25
name='column53
next=Icpitembatch.CPVarDecl
len=25
name='column54
next=Icpitembatch.CPVarDecl
len=25
name='column55
next=Icpitembatch.CPVarDecl
len=25
name='column56
next=Icpitembatch.CPVarDecl
len=25
name='column57
next=Icpitembatch.CPVarDecl
len=25
name='column58
next=Icpitembatch.CPVarDecl
len=25
name='column59
next=Icpitembatch.CPVarDecl
len=25
name='column60
next=Icpitembatch.CPVarDecl
len=25
name='column61
next=Icpitembatch.CPVarDecl
len=25
name='column62
next=Icpitembatch.CPVarDecl
len=25
name='column63
next=Icpitembatch.CPVarDecl
len=25
name='column64
next=Icpitembatch.CPVarDecl
len=25
name='column65
next=Icpitembatch.CPVarDecl
len=25
name='column66
next=Icpitembatch.CPVarDecl
len=25
name='column67
obj='Var
pag=1
prev=O466
I
obj='Var
pag=1
prev=O465
I
obj='Var
pag=1
prev=O464
I
obj='Var
pag=1
prev=O463
I
obj='Var
pag=1
prev=O462
I
obj='Var
pag=1
prev=O461
I
obj='Var
pag=1
prev=O460
I
obj='Var
pag=1
prev=O459
I
obj='Var
pag=1
prev=O458
I
obj='Var
pag=1
prev=O457
I
obj='Var
pag=1
prev=O456
I
obj='Var
pag=1
prev=O455
I
obj='Var
pag=1
prev=O454
I
obj='Var
pag=1
prev=O453
I
obj='Var
pag=1
prev=O452
I
obj='Var
pag=1
prev=O451
I
obj='Var
pag=1
prev=O450
I
obj='Var
pag=1
prev=O449
I
obj='Var
pag=1
prev=O448
I
obj='Var
pag=1
prev=O447
I
obj='Var
pag=1
prev=O446
I
obj='Var
pag=1
prev=O445
I
obj='Var
pag=1
prev=O444
I
obj='Var
pag=1
prev=O443
I
obj='Var
pag=1
prev=O442
I
obj='Var
pag=1
prev=O441
I
obj='Var
pag=1
prev=O440
I
obj='Var
pag=1
prev=O439
I
obj='Var
pag=1
prev=O438
I
obj='Var
pag=1
prev=O437
I
obj='Var
pag=1
prev=O436
I
obj='Var
pag=1
prev=O435
I
obj='Var
pag=1
prev=O434
I
obj='Var
pag=1
prev=O433
I
obj='Var
pag=1
prev=O432
I
obj='Var
pag=1
prev=O431
I
obj='Var
pag=1
prev=O430
I
obj='Var
pag=1
prev=O429
I
obj='Var
pag=1
prev=O428
I
obj='Var
pag=1
prev=O427
I
obj='Var
pag=1
prev=O426
I
obj='Var
pag=1
prev=O425
I
obj='Var
pag=1
prev=O424
I
obj='Var
pag=1
prev=O423
I
obj='Var
pag=1
prev=O422
I
obj='Var
pag=1
prev=O421
I
obj='Var
pag=1
prev=O420
I
obj='Var
pag=1
prev=O419
I
obj='Var
pag=1
prev=O418
I
obj='Var
pag=1
prev=O417
I
obj='Var
pag=1
prev=O416
I
obj='Var
pag=1
prev=O415
I
obj='Var
pag=1
prev=O414
I
obj='Var
pag=1
prev=O413
I
obj='Var
pag=1
prev=O412
I
obj='Var
pag=1
prev=O411
I
obj='Var
pag=1
prev=O410
I
obj='Var
pag=1
prev=O409
I
obj='Var
pag=1
prev=O408
I
obj='Var
pag=1
prev=O407
I
obj='Var
pag=1
prev=O406
I
obj='Var
pag=1
prev=O405
I
obj='Var
pag=1
prev=O404
I
obj='Var
pag=1
prev=O403
I
obj='Var
pag=1
prev=O402
I
obj='Var
pag=1
prev=O401
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O9
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O11
fatherSonIndex=0
len=100
name='czipfile
next=Icpitembatch.CPVarDecl
len=200
name='cpercorsozip
next=Icpitembatch.CPVarDecl
len=200
name='cdirectoryfile
next=Icpitembatch.CPVarDecl
len=100
name='buffernomefile
next=Icpitembatch.CPVarDecl
len=50
name='nomefileimport
next=Icpitembatch.CPVarDecl
len=3
name='_priorita
obj='Var
obj_type='N
pag=1
prev=O475
I
obj='Var
pag=1
prev=O474
I
obj='Var
pag=1
prev=O473
I
obj='Var
pag=1
prev=O472
I
obj='Var
pag=1
prev=O471
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O7
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O9
fatherSonIndex=0
len=10
name='ciidbase
next=Icpitembatch.CPVarDecl
len=8
name='cidataini
next=Icpitembatch.CPVarDecl
len=8
name='cidatafine
next=Icpitembatch.CPVarDecl
len=12
name='cicodinter
next=Icpitembatch.CPVarDecl
len=11
name='cinumprog
next=Icpitembatch.CPVarDecl
len=1
name='citiporap
obj='Var
pag=1
prev=O484
I
obj='Var
pag=1
prev=O483
I
obj='Var
pag=1
prev=O482
I
obj='Var
obj_type='D
pag=1
prev=O481
I
obj='Var
obj_type='D
pag=1
prev=O480
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O5
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O7
fatherSonIndex=0
len=10
name='_z
next=Icpitembatch.CPVarDecl
len=1
name='fhand
next=Icpitembatch.CPVarDecl
len=1
name='ohand
next=Icpitembatch.CPVarDecl
len=1
name='zhand
next=Icpitembatch.CPVarDecl
len=1
name='xhand
next=Icpitembatch.CPVarDecl
len=1
name='shand
next=Icpitembatch.CPVarDecl
len=10
name='riga
next=Icpitembatch.CPVarDecl
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
len=1
name='_tdest
next=Icpitembatch.CPVarDecl
len=16
name='xCF
next=Icpitembatch.CPVarDecl
len=16
name='xSOCTCon
next=Icpitembatch.CPVarDecl
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
len=30
name='xCitta
next=Icpitembatch.CPVarDecl
len=6
name='cCliProg
next=Icpitembatch.CPVarDecl
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
len=1
name='xSesso
next=Icpitembatch.CPVarDecl
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
len=6
name='xCAB
next=Icpitembatch.CPVarDecl
len=2
name='xPrv
next=Icpitembatch.CPVarDecl
len=6
name='xDIP
next=Icpitembatch.CPVarDecl
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
len=8
name='xData
next=Icpitembatch.CPVarDecl
len=8
name='xDatF
next=Icpitembatch.CPVarDecl
comment='Contatore record nuovi
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
comment='Contatore record aggiornati
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
comment='Contatore record invariati
len=10
name='cNumInv
next=Icpitembatch.CPVarDecl
len=1
name='cFlagLire
next=Icpitembatch.CPVarDecl
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
len=1
name='xCFE
next=Icpitembatch.CPVarDecl
len=10
name='conta
next=Icpitembatch.CPVarDecl
len=1
name='_esito
next=Icpitembatch.CPVarDecl
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
len=1
name='_salta
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
len=10
name='nProgSto
next=Icpitembatch.CPVarDecl
len=10
name='_idbase
next=Icpitembatch.CPVarDecl
len=11
name='_codinter
next=Icpitembatch.CPVarDecl
len=30
name='_citinter
next=Icpitembatch.CPVarDecl
len=6
name='_cabinter
next=Icpitembatch.CPVarDecl
len=2
name='_prvinter
next=Icpitembatch.CPVarDecl
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
len=2
name='_interprv
next=Icpitembatch.CPVarDecl
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
len=35
name='_benind
next=Icpitembatch.CPVarDecl
len=5
name='_bencap
next=Icpitembatch.CPVarDecl
len=1
name='_flgmodi
next=Icpitembatch.CPVarDecl
len=16
name='_conadd
next=Icpitembatch.CPVarDecl
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
len=8
name='_datvarage
next=Icpitembatch.CPVarDecl
len=1
name='_flgdataim
next=Icpitembatch.CPVarDecl
len=1
name='_chkerr
next=Icpitembatch.CPVarDecl
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
len=8
name='_datarett
next=Icpitembatch.CPVarDecl
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
len=1
name='_opeerr
next=Icpitembatch.CPVarDecl
len=1
name='_frzerr
next=Icpitembatch.CPVarDecl
len=1
name='_opxerr
next=Icpitembatch.CPVarDecl
len=1
name='_soxerr
next=Icpitembatch.CPVarDecl
len=11
name='_numprog
next=Icpitembatch.CPVarDecl
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
len=1
name='_frapcli
next=Icpitembatch.CPVarDecl
len=1
name='_tiporap
next=Icpitembatch.CPVarDecl
len=20
name='_czip
next=Icpitembatch.CPVarDecl
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPVarDecl
len=30
name='_file1
next=Icpitembatch.CPVarDecl
len=30
name='_file2
next=Icpitembatch.CPVarDecl
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
len=1
name='_oldest
next=Icpitembatch.CPVarDecl
len=1
name='_newest
next=Icpitembatch.CPVarDecl
len=10
name='_idb2
next=Icpitembatch.CPVarDecl
len=15
name='_totin
next=Icpitembatch.CPVarDecl
len=15
name='_totout
next=Icpitembatch.CPVarDecl
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
len=50
name='_icrag
next=Icpitembatch.CPVarDecl
frm_seek='mcConnes.MCRDef
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_seek='mcConnes.MCRDef
name='rowSoggetti
next=Icpitembatch.CPVarDecl
len=1
name='_flgvali
next=Icpitembatch.CPVarDecl
len=1
name='_flganag
next=Icpitembatch.CPVarDecl
len=16
name='_oldcf
next=Icpitembatch.CPVarDecl
len=26
name='_oldcog
next=Icpitembatch.CPVarDecl
len=26
name='_oldnom
next=Icpitembatch.CPVarDecl
len=70
name='_oldrgs
next=Icpitembatch.CPVarDecl
len=30
name='_oldncm
next=Icpitembatch.CPVarDecl
len=30
name='_oldnst
next=Icpitembatch.CPVarDecl
len=8
name='_oldndt
next=Icpitembatch.CPVarDecl
len=2
name='_oldnpv
next=Icpitembatch.CPVarDecl
len=1
name='_oldnsx
next=Icpitembatch.CPVarDecl
len=1
name='_oldncf
next=Icpitembatch.CPVarDecl
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
len=10
name='cNewProg
next=Icpitembatch.CPVarDecl
len=2
name='_tipooprap
next=Icpitembatch.CPVarDecl
len=8
name='_oldreg
next=Icpitembatch.CPVarDecl
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
comment='Stringa di appoggio 
name='_tmp
next=Icpitembatch.CPVarDecl
len=1
name='_tmp_logic
next=Icpitembatch.CPVarDecl
len=14
name='_numimp
next=Icpitembatch.CPVarDecl
len=10
name='_tabelle
next=Icpitembatch.CPVarDecl
len=8
name='_date_oggi
next=Icpitembatch.CPVarDecl
len=8
name='_date_oggi_venti_anni_fa
next=Icpitembatch.CPVarDecl
comment='MC dei soli codice Rapporto
frm_seek='mcStringa.MCRDef
name='mcRapporti
next=Icpitembatch.CPVarDecl
frm_seek='mcStringa.MCRDef
name='rwRapporto
next=Icpitembatch.CPVarDecl
comment='MC dei codici Causali Analitiche+Sintetiche+Segno
frm_seek='mcStringa.MCRDef
name='mcCauana
next=Icpitembatch.CPVarDecl
frm_seek='mcStringa.MCRDef
name='rwCauana
next=Icpitembatch.CPVarDecl
len=1
name='_flgfraud
next=Icpitembatch.CPVarDecl
len=25
name='_rapcol
next=Icpitembatch.CPVarDecl
comment='Nome file per conteggio righe
name='fileName
next=Icpitembatch.CPVarDecl
len=10
name='righeTot
next=Icpitembatch.CPVarDecl
len=20
name='_charset
next=Icpitembatch.CPVarDecl
len=1
name='_novar
next=Icpitembatch.CPVarDecl
name='_codintope
next=Icpitembatch.CPVarDecl
len=8
name='_dataeuro
obj='Var
obj_type='D
pag=1
prev=O634
I
obj='Var
pag=1
prev=O633
I
obj='Var
obj_type='N
pag=1
prev=O632
I
obj='Var
pag=1
prev=O631
I
obj='Var
obj_type='N
pag=1
prev=O630
I
obj='Var
pag=1
prev=O629
I
obj='Var
pag=1
prev=O628
I
obj='Var
obj_type='N
pag=1
prev=O627
I
obj='Var
obj_type='R
pag=1
prev=O626
I
obj='Var
obj_type='MC
pag=1
prev=O625
I
obj='Var
obj_type='R
pag=1
prev=O624
I
obj='Var
obj_type='MC
pag=1
prev=O623
I
obj='Var
obj_type='D
pag=1
prev=O622
I
obj='Var
obj_type='D
pag=1
prev=O621
I
obj='Var
obj_type='M
pag=1
prev=O620
I
obj='Var
obj_type='T
pag=1
prev=O619
I
obj='Var
obj_type='L
pag=1
prev=O618
I
obj='Var
pag=1
prev=O617
I
obj='Var
pag=1
prev=O616
I
obj='Var
obj_type='D
pag=1
prev=O615
I
obj='Var
pag=1
prev=O614
I
obj='Var
pag=1
prev=O613
I
obj='Var
obj_type='M
pag=1
prev=O612
I
obj='Var
obj_type='M
pag=1
prev=O611
I
obj='Var
obj_type='M
pag=1
prev=O610
I
obj='Var
obj_type='M
pag=1
prev=O609
I
obj='Var
obj_type='M
pag=1
prev=O608
I
obj='Var
obj_type='M
pag=1
prev=O607
I
obj='Var
pag=1
prev=O606
I
obj='Var
obj_type='N
pag=1
prev=O605
I
obj='Var
pag=1
prev=O604
I
obj='Var
pag=1
prev=O603
I
obj='Var
obj_type='D
pag=1
prev=O602
I
obj='Var
pag=1
prev=O601
I
obj='Var
pag=1
prev=O600
I
obj='Var
pag=1
prev=O599
I
obj='Var
pag=1
prev=O598
I
obj='Var
pag=1
prev=O597
I
obj='Var
pag=1
prev=O596
I
obj='Var
pag=1
prev=O595
I
obj='Var
pag=1
prev=O594
I
obj='Var
obj_type='R
pag=1
prev=O593
I
obj='Var
obj_type='MC
pag=1
prev=O592
I
obj='Var
pag=1
prev=O591
I
obj='Var
pag=1
prev=O590
I
obj='Var
pag=1
prev=O589
I
obj='Var
pag=1
prev=O588
I
obj='Var
pag=1
prev=O587
I
obj='Var
obj_type='N
pag=1
prev=O586
I
obj='Var
obj_type='N
pag=1
prev=O585
I
obj='Var
pag=1
prev=O584
I
obj='Var
obj_type='N
pag=1
prev=O583
I
obj='Var
obj_type='N
pag=1
prev=O582
I
obj='Var
pag=1
prev=O581
I
obj='Var
pag=1
prev=O580
I
obj='Var
pag=1
prev=O579
I
obj='Var
pag=1
prev=O578
I
obj='Var
pag=1
prev=O577
I
obj='Var
pag=1
prev=O576
I
obj='Var
pag=1
prev=O575
I
obj='Var
pag=1
prev=O574
I
obj='Var
pag=1
prev=O573
I
obj='Var
pag=1
prev=O572
I
obj='Var
pag=1
prev=O571
I
obj='Var
obj_type='N
pag=1
prev=O570
I
obj='Var
obj_type='N
pag=1
prev=O569
I
obj='Var
obj_type='N
pag=1
prev=O568
I
obj='Var
obj_type='N
pag=1
prev=O567
I
obj='Var
obj_type='N
pag=1
prev=O566
I
obj='Var
pag=1
prev=O565
I
obj='Var
pag=1
prev=O564
I
obj='Var
obj_type='D
pag=1
prev=O563
I
obj='Var
pag=1
prev=O562
I
obj='Var
pag=1
prev=O561
I
obj='Var
pag=1
prev=O560
I
obj='Var
pag=1
prev=O559
I
obj='Var
obj_type='N
pag=1
prev=O558
I
obj='Var
obj_type='N
pag=1
prev=O557
I
obj='Var
obj_type='D
pag=1
prev=O556
I
obj='Var
obj_type='D
pag=1
prev=O555
I
obj='Var
obj_type='D
pag=1
prev=O554
I
obj='Var
pag=1
prev=O553
I
obj='Var
pag=1
prev=O552
I
obj='Var
pag=1
prev=O551
I
obj='Var
pag=1
prev=O550
I
obj='Var
pag=1
prev=O549
I
obj='Var
pag=1
prev=O548
I
obj='Var
pag=1
prev=O547
I
obj='Var
pag=1
prev=O546
I
obj='Var
pag=1
prev=O545
I
obj='Var
pag=1
prev=O544
I
obj='Var
pag=1
prev=O543
I
obj='Var
pag=1
prev=O542
I
obj='Var
pag=1
prev=O541
I
obj='Var
pag=1
prev=O540
I
obj='Var
pag=1
prev=O539
I
obj='Var
pag=1
prev=O538
I
obj='Var
pag=1
prev=O537
I
obj='Var
pag=1
prev=O536
I
obj='Var
pag=1
prev=O535
I
obj='Var
obj_type='N
pag=1
prev=O534
I
obj='Var
obj_type='N
pag=1
prev=O533
I
obj='Var
obj_type='N
pag=1
prev=O532
I
obj='Var
obj_type='N
pag=1
prev=O531
I
obj='Var
pag=1
prev=O530
I
obj='Var
pag=1
prev=O529
I
obj='Var
pag=1
prev=O528
I
obj='Var
obj_type='N
pag=1
prev=O527
I
obj='Var
obj_type='N
pag=1
prev=O526
I
obj='Var
obj_type='N
pag=1
prev=O525
I
obj='Var
pag=1
prev=O524
I
obj='Var
obj_type='N
pag=1
prev=O523
I
obj='Var
pag=1
prev=O522
I
obj='Var
pag=1
prev=O521
I
obj='Var
pag=1
prev=O520
I
obj='Var
obj_type='N
pag=1
prev=O519
I
obj='Var
obj_type='N
pag=1
prev=O518
I
obj='Var
obj_type='N
pag=1
prev=O517
I
obj='Var
pag=1
prev=O516
I
obj='Var
pag=1
prev=O515
I
obj='Var
pag=1
prev=O514
I
obj='Var
pag=1
prev=O513
I
obj='Var
pag=1
prev=O512
I
obj='Var
pag=1
prev=O511
I
obj='Var
pag=1
prev=O510
I
obj='Var
pag=1
prev=O509
I
obj='Var
pag=1
prev=O508
I
obj='Var
pag=1
prev=O507
I
obj='Var
pag=1
prev=O506
I
obj='Var
pag=1
prev=O505
I
obj='Var
pag=1
prev=O504
I
obj='Var
pag=1
prev=O503
I
obj='Var
pag=1
prev=O502
I
obj='Var
pag=1
prev=O501
I
obj='Var
pag=1
prev=O500
I
obj='Var
pag=1
prev=O499
I
obj='Var
pag=1
prev=O498
I
obj='Var
pag=1
prev=O497
I
obj='Var
pag=1
prev=O496
I
obj='Var
pag=1
prev=O495
I
obj='Var
obj_type='M
pag=1
prev=O494
I
obj='Var
pag=1
prev=O493
I
obj='Var
pag=1
prev=O492
I
obj='Var
pag=1
prev=O491
I
obj='Var
pag=1
prev=O490
I
obj='Var
pag=1
prev=O489
I
obj='Var
obj_type='N
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5
fatherSonIndex=0
frm_seek='tbcitta
name='mcTBCITTA
next=Icpitembatch.CPVarDecl
frm_seek='personbo
name='mcPersonbo
next=Icpitembatch.CPVarDecl
frm_seek='personbo
name='rowPersonbo
obj='Var
obj_type='R
pag=1
prev=O640
I
obj='Var
obj_type='MC
pag=1
prev=O639
I
obj='Var
obj_type='MC
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Destinazione import (D = Definitivo, P = Provvisorio) default = D
father=O3
fatherSonIndex=0
len=1
name='w_tipodest
next=Icpitembatch.CPVarDecl
comment='Controllo preliminare dati anagrafici (N = no, S = si) default = N
len=1
name='w_chkaui
next=Icpitembatch.CPVarDecl
comment='Importa i dati anche in presenza di errori (N = no, S = si) default = N
len=1
name='w_imperr
next=Icpitembatch.CPVarDecl
comment='Aggiorna Famiglie (ARCHPERS/PERSNEW) (N = no, S = si) default = N
len=1
name='w_flgaggfam
next=Icpitembatch.CPVarDecl
comment='Aggiorna Importo Netto (SV) (N = no, S = si) default = N
len=1
name='w_flgimposv
next=Icpitembatch.CPVarDecl
comment='Crea modifiche su Operazioni (N = no, S = si) default = N
len=1
name='w_creamo
next=Icpitembatch.CPVarDecl
comment='HIDDEN Non utilizzare RIFIMP/INFOMR per le modifiche (moneytransfer) (N = no, S = si) default = N
len=1
name='w_norifimp
next=Icpitembatch.CPVarDecl
comment='HIDDEN Forza Aggiorna Famiglie (ARCHPERS/PERSNEW) (N = no, S = si) default = N
len=1
name='w_flgforzaagg
next=Icpitembatch.CPVarDecl
comment='Operazioni e frazionate tutte su archope
len=1
name='w_opeunivoco
obj='Var
pag=1
param=True
prev=O652
I
obj='Var
pag=1
param=True
prev=O651
I
obj='Var
pag=1
param=True
prev=O650
I
obj='Var
pag=1
param=True
prev=O649
I
obj='Var
pag=1
param=True
prev=O648
I
obj='Var
pag=1
param=True
prev=O647
I
obj='Var
pag=1
param=True
prev=O646
I
obj='Var
pag=1
param=True
prev=O645
I
obj='Var
pag=1
param=True
I
I
]
w=[
150
150
]
x=13
y=16
I
Icpitembatch.CPIfElse
frm_calc=[
'mcSoggetti.RecCount() > 0
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O655
fatherSonIndex=0
frm_calc='FileLibMit.OpenWrite('output/'+LRTrim(gAzienda)+'/ndg_sovrascritti')
len=1
name='fhand
next=Icpitembatch.CPForEach
for_variable='rowSoggetti
for_variable_type='mcConnes.MCRDef
h=[
19
19
]
iterator_expr='mcSoggetti
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='2
len=1
name='_chkerr
next=Icpitembatch.CPVarDecl
frm_calc='"ndg_sovrascritti.zip"
len=20
name='_czip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/"+_czip
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/ndg_sovrascritti"
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='"ndg_sovrascritti"
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc='// These are the files to include in the ZIP file﷯filenames.clear();﷯fileonames.clear();﷯filenames.add(cNomeFile);﷯fileonames.add(cOnlyNomeFile);
next=Icpitembatch.CPExec
check='page
frm_calc='36
next=Icpitembatch.CPInsert
arch='tmp_listafile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevati soggetti che hanno sovrascritto anagrafiche esistenti. Prelevare il file ndg_sovrascritti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('output/'+LRTrim(gAzienda)+'/opex_scarti')
obj='Exec
pag=1
prev=O672
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O671
var_op='asgn
I
obj='Insert
pag=1
prev=O670
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
''ndg_sovraSCRITTI'
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/ndg_sovrascritti.zip"
]
I
obj='Exec
pag=1
prev=O669
I
obj='Exec
pag=1
prev=O668
I
obj='Var
pag=1
prev=O667
var_op='asgn
I
obj='Var
pag=1
prev=O666
var_op='asgn
I
obj='Var
pag=1
prev=O665
var_op='asgn
I
obj='Var
pag=1
prev=O664
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O663
var_op='asgn
I
obj='Exec
pag=1
prev=O661
I
obj='ForEach
pag=1
prev=O660
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O661
fatherSonIndex=0
frm_calc='FileLibMit.WriteLine(fhand,rowSoggetti.connes)
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
x=1190
y=7126
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumInv
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='nProgSto
next=Icpitembatch.CPVarDecl
frm_calc='0
len=15
name='nProgImp
next=Icpitembatch.CPBeginEnd
comment='Gestione storico import
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Ispitembatch.CPMemoryCursor
data_source='tbcitta
expected_rows=10000
key_expression='tbcitta->CITTA
mem_curs_name='mcTBCITTA
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'nProgImp > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'nProgSto > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Soggetti Inseriti: '+LRTrim(Str(cNumNew,10,0)) + ' - Soggetti Aggiornati: '+LRTrim(Str(cNumMod,10,0)) + ' - Soggetti Invariati: '+LRTrim(Str(cNumInv,10,0)) + ' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','ARCHPERS','Soggetti Corretti: '+LRTrim(Str(cNumNew,10,0)) + ' - Soggetti Errati: '+LRTrim(Str(cNumMod,10,0)))
obj='Exec
pag=2
prev=O708
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O707
var_op='asgn
I
obj='Exec
pag=2
prev=O706
I
obj='Exec
pag=2
prev=O705
I
obj='Exec
pag=2
prev=O704
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O703
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O700
var_op='asgn
I
obj='If
pag=2
prev=O697
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O700
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'm_nUpdatedRows=0
]
h=[
19
19
]
obj='If
pag=2
prev=O712
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O713
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'tablecode
'warncode
'autonum
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
'nProgSto + 1
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=2
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'nProgSto + 1
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O695
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O697
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'm_nUpdatedRows=0
]
h=[
19
19
]
obj='If
pag=2
prev=O731
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O732
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'tablecode
'warncode
'autonum
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
'nProgImp + 1
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=2
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'nProgImp + 1
]
I
I
]
w=[
150
150
]
I
obj='While
pag=2
prev=O694
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O695
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=2
prev=O750
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O751
fatherSonIndex=0
frm_seek='Zap
name='mcPersonbo
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,504,8)),NullDate(),CharToDate(Substr(riga,508,4)+Substr(riga,506,2)+Substr(riga,504,2)))
len=8
name='_datvarage
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgRet='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' soggetti del file '+LRTrim(nomefileimport)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='CODFISC
frm_calc='LRTrim(Substr(riga,112,16))
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
comment='CONNES
frm_calc='LRTrim(Substr(riga,488,16))
len=16
name='_conadd
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(_conadd)),cCli1,_conadd)
len=16
name='cCli1
next=Icpitembatch.CPRemark
frm_calc='Prima la Read si faceva per CF
next=Icpitembatch.CPBeginEnd
comment='Azzera vecchi valori
h=[
19
19
]
next=Ispitembatch.CPMemoryCursor
data_source='personbo
mem_curs_name='mcPersonbo
next=Icpitembatch.CPForEach
for_variable='rwPersonbo
for_variable_type='personbo
h=[
19
19
]
iterator_expr='mcPersonbo
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_flgvali
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_flganag
next=Icpitembatch.CPRead
arch='personbo_agg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,288,1))),'G','P')
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,288,1)='M','1',iif(Substr(riga,288,1)='F','2',Substr(riga,288,1)))
len=1
name='xSesso
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,450,1)='0' or Substr(riga,450,1)='1' or Substr(riga,450,1) = ''
'Substr(riga,450,1)='N' or Substr(riga,450,1)='S'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgvali='S',0,xCFE)
len=1
name='xCFE
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgvali='S',Upper(_oldcf),Upper(LRTrim(Substr(riga,112,16))))
len=16
name='xCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,6)
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,260,2))
len=2
name='xPrv
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCodCab))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,136,30))
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'(Substr(xCF,12,1) = 'Z' or Substr(riga,448,2)='EE') and (Substr(riga,288,1)='M' or Substr(riga,288,1)='F')
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Assegna Valori in base a flag
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico se il soggetto in esame non è già presente l'inserisco
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xConnes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O802
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O803
fatherSonIndex=0
frm_calc='nProgImp + 1
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='personbo
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='personbo_agg
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=2
prev=O811
var_op='asgn
I
obj='Insert
pag=2
prev=O809
rd_kfield=[
'CONNES
'FLGPREGIUD
'FLGTRUST
'FLGRISCHIO
'FLGEQUIFIN
'FLGFALSADIC
'FLGRICINF
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
]
rd_kvar=[
'LRTrim(cCli1)
'iif(Empty(Substr(riga,597,1)),'N',Substr(riga,597,1))
'iif(Empty(Substr(riga,598,1)),'N',Substr(riga,598,1))
'iif(Empty(Substr(riga,599,1)),'N',Substr(riga,599,1))
'iif(Empty(Substr(riga,600,1)),'N',Substr(riga,600,1))
'iif(Empty(Substr(riga,601,1)),'N',Substr(riga,601,1))
'iif(Empty(Substr(riga,602,1)),'N',Substr(riga,602,1))
'Substr(riga,587,2)
'Substr(riga,589,2)
'Substr(riga,591,2)
'Substr(riga,593,2)
'Substr(riga,595,2)
'Substr(riga,587,2)+Substr(riga,589,2)+Substr(riga,591,2)+Substr(riga,593,2)+Substr(riga,595,2)
]
I
obj='Insert
pag=2
prev=O808
rd_kfield=[
'ALLINEATO
'ALLINEATONOMECNOME
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'CONNES
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROGIMPORT
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'TIPOPERS
'DATAVARAGE
'FATCA
'TIN
'ODB
'TIPOORO
'CODORO
'NOTIT
'MITIG
'NOSARA
'RISGLOB
'DATAPROF
'DATAREVPROF
'IDENT
'NUMIMP
'DATASEGN
'DATARAUT
]
rd_kvar=[
'0
'0
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,470,5)),3))
'Substr(riga,460,10)
'Upper(Substr(riga,200,30))
'Substr(riga,265,9)
'xCFE
'xCodCab
'Upper(xCF)
'_oldcog
'Substr(riga,455,5)
'LRTrim(cCli1)
'_oldndt
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Upper(Substr(riga,230,30))
'Substr(riga,348,100)
'Upper(Substr(riga,77,35))
'_oldncm
'_oldnst
'_oldnom
'Upper(Substr(riga,177,15))
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'iif(Empty(Substr(riga,487,1)),'N',Substr(riga,487,1))
'Substr(riga,451,4)
'nProgImp
'xPrv
'_oldrgs
'_oldrgs
'Substr(riga,169,3)
'Val(Substr(riga,484,3))
'Val(Substr(riga,481,3))
'Val(Substr(riga,478,3))
'Val(Substr(riga,475,3))
'_oldnsx
'Substr(riga,172,3)
'Substr(riga,166,3)
'_oldnpv
'Substr(riga,175,2)
'_tipper
'_datvarage
'Substr(riga,512,3)
'Substr(riga,515,16)
'iif(Empty(Substr(riga,531,1)),0,Val(Substr(riga,531,1)))
'Substr(riga,547,1)
'Substr(riga,548,11)
'iif(Empty(LRTrim(Substr(riga,559,1))),0,Val(Substr(riga,559,1)))
'iif(Empty(LRTrim(Substr(riga,560,4))),0,Val(Substr(riga,560,4)))
'iif(Empty(LRTrim(Substr(riga,564,1))) or Substr(riga,564,1)='0' or Substr(riga,564,1)='N','N','S')
'Substr(riga,581,3)
'iif(not(Empty(Substr(riga,565,8))),CharToDate(Substr(riga,565,8)),NullDate())
'iif(not(Empty(Substr(riga,573,8))),CharToDate(Substr(riga,573,8)),NullDate())
'Substr(riga,584,3)
'_numimp
'iif(not(Empty(Substr(riga,603,8))),CharToDate(Substr(riga,603,8)),NullDate())
'iif(not(Empty(Substr(riga,611,8))),CharToDate(Substr(riga,611,8)),NullDate())
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O809
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+LRTrim(Substr(riga,7,70))+" con codice fiscale: "+LRTrim(Substr(riga,112,16))+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O822
I
obj='Exec
pag=2
prev=O821
I
obj='Var
obj_type='N
pag=2
prev=O820
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O819
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPVarDecl
father=O803
fatherSonIndex=1
frm_calc='0
len=1
name='_novar
next=Icpitembatch.CPVarDecl
frm_calc='Upper(xCF)+Substr(riga,7,70)+Substr(riga,77,35)+Substr(riga,230,30)+Substr(riga,260,2)+LibreriaMit.SpacePad(LRTrim(Substr(riga,265,9)),5)+Substr(riga,262,3)+Substr(riga,166,3)+Substr(riga,169,3)+Substr(riga,172,3)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+LibreriaMit.SpacePad(Left(cCNAS,30),30)+Substr(riga,448,2)+LibreriaMit.SpacePad(Left(cSNAS,30),30)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+Substr(riga,175,2)+Substr(riga,177,15)+Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2)+Substr(riga,200,30)+Substr(riga,274,14)+xCodCab
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='Upper(xCF)+Substr(riga,7,70)+Substr(riga,230,30)+Substr(riga,260,2)
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='xRiga3+LibreriaMit.SpacePad(Left(cCNAS,30),30)+Substr(riga,448,2)+LibreriaMit.SpacePad(Left(cSNAS,30),30)
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='xRiga3+Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2)+xSesso
len=10
name='xRiga3
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgaggfam='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.SpacePad(rowPersonbo.CODFISC,16)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.RAGSOC,70)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.DOMICILIO,35)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.DESCCIT,30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.PROVINCIA,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(LRTrim(rowPersonbo.CAP),5)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.PAESE,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.SOTGRUP,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.RAMOGRUP,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.SETTSINT,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(Left(rowPersonbo.NASCOMUN,30),30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.TIPINTER,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(Left(rowPersonbo.NASSTATO,30),30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + iif(DateToChar(rowPersonbo.DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(rowPersonbo.DATANASC),8),Space(8))
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(rowPersonbo.TIPODOC,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(rowPersonbo.NUMDOCUM,15)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + iif(DateToChar(rowPersonbo.DATARILASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(rowPersonbo.DATARILASC),8),Space(8))
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(rowPersonbo.AUTRILASC,30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(rowPersonbo.PARTIVA,14)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(rowPersonbo.CODCAB,6)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.SpacePad(rowPersonbo.CODFISC,16)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(rowPersonbo.RAGSOC,70)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(rowPersonbo.DESCCIT,30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(rowPersonbo.PROVINCIA,2)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(Left(rowPersonbo.NASCOMUN,30),30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(rowPersonbo.TIPINTER,2)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(Left(rowPersonbo.NASSTATO,30),30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + iif(DateToChar(rowPersonbo.DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(rowPersonbo.DATANASC),8),Space(8))
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(rowPersonbo.SESSO,1)
len=10
name='xRiga4
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgaggfam='S'
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Se le due stringhe sono diverse, ci sono delle modifiche da fare. Quindi storicizzo in wersonbo le modifche.
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(xRiga1) <> LRTrim(xRiga2)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgaggfam='S'
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico se il soggetto è una persona fisica
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,288,1)='M' or Substr(riga,288,1)='F'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=2
par_expr=[
'xConnes
]
par_name=[
'w_CONNES
]
prev=O877
sel_name='qbe_aggfam_opextrbo_new
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O880
fatherSonIndex=0
obj='Write
pag=2
rd_kfield=[
'ANNO
'COLLEG
]
rd_kop=[
'=
'=
]
rd_kvar=[
'qbe_aggfam_opextrbo_new->ANNO
'qbe_aggfam_opextrbo_new->COLLEG
]
wr_field=[
'CFESTERO
]
wr_op=[
'=
]
wr_var=[
'iif(_oldest=1,'S','N')
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O876
sons=[
Icpitembatch.CPItemSon
comment='se persona fisica
instr=Icpitembatch.CPWrite
arch='personbo
father=O877
fatherSonIndex=0
frm_calc='Errore in aggiornamento ARCHPERS
h=[
19
19
]
next=Icpitembatch.CPMerge
arch='personbo_agg
next=Icpitembatch.CPIfElse
frm_calc=[
'_novar=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O898
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O899
fatherSonIndex=0
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O899
fatherSonIndex=1
frm_calc='cNumInv + 1
len=10
name='cNumInv
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Merge
pag=2
prev=O896
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(cCli1)
]
wr_field=[
'CONNES
'FLGPREGIUD
'FLGTRUST
'FLGRISCHIO
'FLGEQUIFIN
'FLGFALSADIC
'FLGRICINF
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
]
wr_mode=[
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(cCli1)
'iif(Empty(Substr(riga,597,1)),'N',Substr(riga,597,1))
'iif(Empty(Substr(riga,598,1)),'N',Substr(riga,598,1))
'iif(Empty(Substr(riga,599,1)),'N',Substr(riga,599,1))
'iif(Empty(Substr(riga,600,1)),'N',Substr(riga,600,1))
'iif(Empty(Substr(riga,601,1)),'N',Substr(riga,601,1))
'iif(Empty(Substr(riga,602,1)),'N',Substr(riga,602,1))
'Substr(riga,587,2)
'Substr(riga,589,2)
'Substr(riga,591,2)
'Substr(riga,593,2)
'Substr(riga,595,2)
'Substr(riga,587,2)+Substr(riga,589,2)+Substr(riga,591,2)+Substr(riga,593,2)+Substr(riga,595,2)
]
I
obj='Write
pag=2
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(xConnes)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O896
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
frm_calc='m_cLastMsgError = ""
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O922
I
obj='Exec
pag=2
prev=O921
I
obj='Var
obj_type='N
pag=2
prev=O920
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'DATAVARAGE
'AREAGEO
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'FATCA
'TIN
'ODB
'TIPOORO
'CODORO
'NOTIT
'MITIG
'NOSARA
'RISGLOB
'DATAPROF
'DATAREVPROF
'IDENT
'IDNASCOMUN
'IDNASSTATO
'NUMIMP
'DATASEGN
'DATARAUT
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,460,10)
'Upper(Substr(riga,200,30))
'Substr(riga,265,9)
'_oldest
'xCodCab
'xCF
'_oldcog
'Substr(riga,455,5)
'_oldndt
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Upper(Substr(riga,230,30))
'Substr(riga,348,100)
'Upper(Substr(riga,77,35))
'_oldncm
'_oldnst
'_oldnom
'Upper(Substr(riga,177,15))
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'Substr(riga,451,4)
'xPrv
'_oldrgs
'_oldrgs
'Substr(riga,169,3)
'_oldnsx
'Substr(riga,172,3)
'Substr(riga,166,3)
'_oldnpv
'Substr(riga,175,2)
'_datvarage
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,470,5)),3))
'Val(Substr(riga,484,3))
'Val(Substr(riga,481,3))
'Val(Substr(riga,478,3))
'Val(Substr(riga,475,3))
'Substr(riga,512,3)
'Substr(riga,515,16)
'iif(Empty(Substr(riga,531,1)),0,Val(Substr(riga,531,1)))
'Substr(riga,547,1)
'Substr(riga,548,11)
'iif(Empty(LRTrim(Substr(riga,559,1))),0,Val(Substr(riga,559,1)))
'iif(Empty(LRTrim(Substr(riga,560,4))),0,Val(Substr(riga,560,4)))
'iif(Empty(LRTrim(Substr(riga,564,1))) or Substr(riga,564,1)='0' or Substr(riga,564,1)='N','N','S')
'Substr(riga,581,3)
'iif(not(Empty(Substr(riga,565,8))),CharToDate(Substr(riga,565,8)),NullDate())
'iif(not(Empty(Substr(riga,573,8))),CharToDate(Substr(riga,573,8)),NullDate())
'Substr(riga,584,3)
'''
'''
'_numimp
'iif(not(Empty(Substr(riga,603,8))),CharToDate(Substr(riga,603,8)),NullDate())
'iif(not(Empty(Substr(riga,611,8))),CharToDate(Substr(riga,611,8)),NullDate())
]
I
I
Icpitembatch.CPItemSon
comment='se persona giuridica
instr=Icpitembatch.CPRemark
father=O877
fatherSonIndex=1
frm_calc='Se non è persona fisica
next=Icpitembatch.CPWrite
arch='personbo
frm_calc='Errore in aggiornamento ARCHPERS
h=[
19
19
]
next=Icpitembatch.CPMerge
arch='personbo_agg
next=Icpitembatch.CPIfElse
frm_calc=[
'_novar=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O932
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O933
fatherSonIndex=0
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O933
fatherSonIndex=1
frm_calc='cNumInv + 1
len=10
name='cNumInv
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Merge
pag=2
prev=O930
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(cCli1)
]
wr_field=[
'CONNES
'FLGPREGIUD
'FLGTRUST
'FLGRISCHIO
'FLGEQUIFIN
'FLGFALSADIC
'FLGRICINF
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
]
wr_mode=[
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(cCli1)
'iif(Empty(Substr(riga,597,1)),'N',Substr(riga,597,1))
'iif(Empty(Substr(riga,598,1)),'N',Substr(riga,598,1))
'iif(Empty(Substr(riga,599,1)),'N',Substr(riga,599,1))
'iif(Empty(Substr(riga,600,1)),'N',Substr(riga,600,1))
'iif(Empty(Substr(riga,601,1)),'N',Substr(riga,601,1))
'iif(Empty(Substr(riga,602,1)),'N',Substr(riga,602,1))
'Substr(riga,587,2)
'Substr(riga,589,2)
'Substr(riga,591,2)
'Substr(riga,593,2)
'Substr(riga,595,2)
'Substr(riga,587,2)+Substr(riga,589,2)+Substr(riga,591,2)+Substr(riga,593,2)+Substr(riga,595,2)
]
I
obj='Write
pag=2
prev=O929
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(xConnes)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O930
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O955
I
obj='Var
obj_type='N
pag=2
prev=O954
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'DATAVARAGE
'AREAGEO
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'FATCA
'TIN
'ODB
'TIPOORO
'CODORO
'NOTIT
'MITIG
'NOSARA
'RISGLOB
'DATAPROF
'DATAREVPROF
'IDENT
'NUMIMP
'DATASEGN
'DATARAUT
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,460,10)
'Upper(Substr(riga,200,30))
'Substr(riga,265,9)
'_oldest
'xCodCab
'xCF
'_oldcog
'Substr(riga,455,5)
'_oldndt
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Upper(Substr(riga,230,30))
'Substr(riga,348,100)
'Upper(Substr(riga,77,35))
'_oldncm
'_oldnst
'_oldnom
'Upper(Substr(riga,177,15))
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'Substr(riga,451,4)
'xPrv
'_oldrgs
'_oldrgs
'Substr(riga,169,3)
'_oldnsx
'Substr(riga,172,3)
'Substr(riga,166,3)
'_oldnpv
'Substr(riga,175,2)
'_datvarage
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,470,5)),3))
'Val(Substr(riga,484,3))
'Val(Substr(riga,481,3))
'Val(Substr(riga,478,3))
'Val(Substr(riga,475,3))
'Substr(riga,512,3)
'Substr(riga,515,16)
'iif(Empty(Substr(riga,531,1)),0,Val(Substr(riga,531,1)))
'Substr(riga,547,1)
'Substr(riga,548,11)
'iif(Empty(LRTrim(Substr(riga,559,1))),0,Val(Substr(riga,559,1)))
'iif(Empty(LRTrim(Substr(riga,560,4))),0,Val(Substr(riga,560,4)))
'iif(Empty(LRTrim(Substr(riga,564,1))) or Substr(riga,564,1)='0' or Substr(riga,564,1)='N','N','S')
'Substr(riga,581,3)
'iif(not(Empty(Substr(riga,565,8))),CharToDate(Substr(riga,565,8)),NullDate())
'iif(not(Empty(Substr(riga,573,8))),CharToDate(Substr(riga,573,8)),NullDate())
'Substr(riga,584,3)
'_numimp
'iif(not(Empty(Substr(riga,603,8))),CharToDate(Substr(riga,603,8)),NullDate())
'iif(not(Empty(Substr(riga,611,8))),CharToDate(Substr(riga,611,8)),NullDate())
]
I
obj='Remark
pag=2
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=2
prev=O873
I
obj='If
pag=2
prev=O870
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O873
fatherSonIndex=0
frm_calc=[
'LRTrim(xRiga5) <> LRTrim(xRiga6) or w_flgforzaagg='S'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='bat
father=O964
fatherSonIndex=0
frm_calc='arrt_ae_agg_aetesta_sog(xConnes,_oldest)
obj='Exec
pag=2
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O869
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O870
fatherSonIndex=0
frm_calc='1
len=1
name='_novar
next=Icpitembatch.CPRemark
frm_calc='Verifico se c'è già una variazione
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
obj='If
pag=2
prev=O978
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O980
fatherSonIndex=0
frm_calc='Calcola il progressivo di registrazione
next=Icpitembatch.CPVarDecl
frm_calc='nProgSto + 1
len=10
name='nProgSto
next=Icpitembatch.CPVarDecl
frm_calc='Right('000000000000000'+LRTrim(Str(nProgSto,15,0)),15)
len=15
name='cProgSto
next=Icpitembatch.CPInsert
arch='wersonbo
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_creamo='S'
]
h=[
19
19
]
obj='If
pag=2
prev=O990
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPNote
father=O992
fatherSonIndex=0
frm_calc='>>Questa parte è da vedere (non dovrebbe stare qui)
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(xRiga3) <> LRTrim(xRiga4)
]
h=[
19
19
]
obj='If
pag=2
prev=O997
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O998
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=2
prev=O1003
sel_field='fraziobo->IDBASE
sel_name='fraziobo
sel_where='fraziobo->CONNESCLI=xConnes or fraziobo->CONNESOPER=xConnes or fraziobo->CONNESBEN=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1005
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(gAzienda)+"'",Space(10),10)
len=10
name='cNewProg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc=''JLMNOTUV?'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='fraziobo->IDBASE
len=10
name='_idbase
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=2
prev=O1011
sel_field='*
sel_name='fraziobo
sel_where='fraziobo->IDBASE=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1012
fatherSonIndex=0
frm_calc='iif(Empty(fraziobo->FLAGRAP2),Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(fraziobo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPInsert
arch='fraziobo
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(operazbo->DATAOPE)+"F"+LibreriaMit.UniqueId()+"X"
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=2
prev=O1018
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_idbase
]
wr_field=[
'OPERAZMOD
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
'=
]
wr_var=[
'fraziobo->IDEREG
''1'
'Date()
]
I
obj='Var
pag=2
prev=O1017
var_op='asgn
I
obj='Insert
pag=2
prev=O1016
rd_kfield=[
'ANNOOPE
'AREAGEO
'AUTOM
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESDOC
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'DUCOLLEG
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'IDFILE
'INFORM
'IPCOLLEG
'MODSVOL
'MTCN
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
]
rd_kvar=[
'fraziobo->ANNOOPE
'fraziobo->AREAGEO
'fraziobo->AUTOM
'fraziobo->C_CAB
'fraziobo->C_CAP
'fraziobo->C_CTA
'fraziobo->C_IND
'fraziobo->C_PRV
'fraziobo->C_RAG
'fraziobo->C_RAPPORTO
'fraziobo->C_STA
'fraziobo->CAMBIO
'fraziobo->CDATAOPE
'fraziobo->CDATOPE
'fraziobo->CDATREG
'fraziobo->CODANA
'fraziobo->CODCAB
'fraziobo->CODCAB2
'fraziobo->CODDIPE
'fraziobo->CODINT2
'fraziobo->CODINTER
'fraziobo->CODVOC
'fraziobo->COLLEG
'fraziobo->CONNALTRO
'fraziobo->CONNESBEN
'fraziobo->CONNESCLI
'fraziobo->CONNESDOC
'fraziobo->CONNESOPER
'fraziobo->DATAIMP
'fraziobo->DATAOPE
'fraziobo->DATAREG
'Date()
'fraziobo->DESC2
'fraziobo->DESCCIT
'fraziobo->DESCINTER
'fraziobo->DOCFILE
'fraziobo->DUCOLLEG
'fraziobo->FLAGCONT
'fraziobo->FLAGFRAZ
'fraziobo->FLAGLIRE
'fraziobo->FLAGRAP
'_flagrap2
'cNewProg
'fraziobo->idcauana
'fraziobo->IDEREG
'fraziobo->IDFILE
'fraziobo->INFORM
'fraziobo->IPCOLLEG
'fraziobo->MODSVOL
'fraziobo->MTCN
'fraziobo->NATURA
'fraziobo->NOPROT
'fraziobo->NUMPROG
'fraziobo->OPERAG
'fraziobo->OPERATORE
'fraziobo->OPERAZMOD
'fraziobo->OPRAP
'fraziobo->ORACOLLEG
'fraziobo->PAESE
'fraziobo->PAGASOGOP
'fraziobo->PRGIMPFRZ
'fraziobo->PROV2
'fraziobo->PROVINCIA
'fraziobo->RAGIO
'fraziobo->RAPPORTBEN
'fraziobo->RAPPORTO
'fraziobo->RAREA
'fraziobo->RCOMP
'fraziobo->RESPINS
'fraziobo->RFREQ
'fraziobo->RIFIMP
'fraziobo->RIMP
'fraziobo->RRAGIO
'fraziobo->RTIPO
'fraziobo->SCOPO
'fraziobo->SEGNO
''3'
'fraziobo->TIPO
'fraziobo->TIPOINF
'fraziobo->TIPOINT2
'fraziobo->TIPOINTER
'fraziobo->TIPOLEG
'fraziobo->TIPOOPRAP
'fraziobo->TOTCONT
'fraziobo->TOTLIRE
'fraziobo->UCODE
'fraziobo->UNIQUECODE
'fraziobo->VALUTA
'fraziobo->ZCPARTE
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O1010
var_op='asgn
I
obj='Var
pag=2
prev=O1009
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=2
sel_field='operazbo->IDBASE
sel_name='operazbo
sel_where='operazbo->CONNESCLI=xConnes or operazbo->CONNESOPER=xConnes or operazbo->CONNESBEN=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1003
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",Space(10),10)
len=10
name='cNewProg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='operazbo->IDBASE
len=10
name='_idbase
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=2
prev=O1034
sel_field='*
sel_name='operazbo
sel_where='operazbo->IDBASE=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1035
fatherSonIndex=0
frm_calc='iif(Empty(operazbo->FLAGRAP2),Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(operazbo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPInsert
arch='operazbo
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(operazbo->DATAOPE)+"O"+LibreriaMit.UniqueId()+"X"
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=2
prev=O1041
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_idbase
]
wr_field=[
'OPERAZMOD
'STATOREG
'DATARETT
'IDEREG
'NUMIMP
]
wr_op=[
'=
'=
'=
'=
'=
]
wr_var=[
'operazbo->IDEREG
''1'
'Date()
'_idreg
'_numimp
]
I
obj='Var
pag=2
prev=O1040
var_op='asgn
I
obj='Insert
pag=2
prev=O1039
rd_kfield=[
'AMMONT
'AREAGEO
'AUTOM
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESDOC
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'IDFILE
'INFORM
'IPCOLLEG
'MODSVOL
'MTCN
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
'ANNOOPE
]
rd_kvar=[
'operazbo->AMMONT
'operazbo->AREAGEO
'operazbo->AUTOM
'operazbo->C_CAB
'operazbo->C_CAP
'operazbo->C_CTA
'operazbo->C_IND
'operazbo->C_PRV
'operazbo->C_RAG
'operazbo->C_RAPPORTO
'operazbo->C_STA
'operazbo->CAMBIO
'operazbo->CDATAOPE
'operazbo->CDATOPE
'operazbo->CDATREG
'operazbo->CODANA
'operazbo->CODCAB
'operazbo->CODCAB2
'operazbo->CODDIPE
'operazbo->CODINT2
'operazbo->CODINTER
'operazbo->CODVOC
'operazbo->COLLEG
'operazbo->CONNALTRO
'operazbo->CONNESBEN
'operazbo->CONNESCLI
'operazbo->CONNESDOC
'operazbo->CONNESOPER
'operazbo->DATAIMP
'operazbo->DATAOPE
'operazbo->DATAREG
'Date()
'operazbo->DESC2
'operazbo->DESCCIT
'operazbo->DESCINTER
'operazbo->DOCFILE
'operazbo->DUCOLLEG
'operazbo->DURAT
'operazbo->FLAGCONT
'operazbo->FLAGFRAZ
'operazbo->FLAGLIRE
'operazbo->FLAGRAP
'_flagrap2
'cNewProg
'operazbo->idcauana
'operazbo->IDEREG
'operazbo->IDFILE
'operazbo->INFORM
'operazbo->IPCOLLEG
'operazbo->MODSVOL
'operazbo->MTCN
'operazbo->NATURA
'operazbo->NOPROT
'operazbo->NUMPROG
'operazbo->OPERAG
'operazbo->OPERATORE
'operazbo->OPERAZMOD
'operazbo->OPRAP
'operazbo->ORACOLLEG
'operazbo->PAESE
'operazbo->PAGASOGOP
'operazbo->PRGIMPOPE
'operazbo->PROV2
'operazbo->PROVINCIA
'operazbo->RAGIO
'operazbo->RAPPORTBEN
'operazbo->RAPPORTO
'operazbo->RAREA
'operazbo->RCOMP
'operazbo->RESPINS
'operazbo->RFREQ
'operazbo->RIFIMP
'operazbo->RIMP
'operazbo->RRAGIO
'operazbo->RTIPO
'operazbo->SCOPO
'operazbo->SEGNO
''3'
'operazbo->TIPO
'operazbo->TIPOINF
'operazbo->TIPOINT2
'operazbo->TIPOINTER
'operazbo->TIPOLEG
'operazbo->TIPOOPRAP
'operazbo->TOTCONT
'operazbo->TOTLIRE
'operazbo->UCODE
'operazbo->UNIQUECODE
'operazbo->VALUTA
'operazbo->ZCPARTE
'operazbo->ANNOOPE
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O1033
var_op='asgn
I
obj='Var
pag=2
prev=O1032
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Note
pag=2
I
I
]
w=[
150
150
]
I
obj='Select
pag=2
prev=O988
sel_field='*
sel_name='personbo_agg
sel_where='personbo_agg->CONNES=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo_agg
father=O990
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'sanumpro
'datamodi
'CONNES
'EMAIL
'FLGEMAIL
'TELEFONO
'RDCODAUT
'RDLOCAUT
'FLGBANCA
'FLGVALIDO
'REGRES
'FLGBL
'CLOCCUPA
'NUMTEL
'NAZIONE
'LASTOPER
'CODCLIEST
'FLGANAVAL
'CLPRVDOM
'MITIG
'MITGDOC
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
'FLGPREGIUD
'FLGTRUST
'FLGRISCHIO
'FLGEQUIFIN
'FLGFALSADIC
'FLGRICINF
'WUGID
'WUNAZRILDOC
'NUMCEL
'PEC
'REFERENTE
]
rd_kvar=[
'cProgSto
'_datarett
'personbo_agg->CONNES
'personbo_agg->EMAIL
'personbo_agg->FLGEMAIL
'personbo_agg->TELEFONO
'personbo_agg->RDCODAUT
'personbo_agg->RDLOCAUT
'personbo_agg->FLGBANCA
'personbo_agg->FLGVALIDO
'personbo_agg->REGRES
'personbo_agg->FLGBL
'personbo_agg->CLOCCUPA
'personbo_agg->NUMTEL
'personbo_agg->NAZIONE
'personbo_agg->LASTOPER
'personbo_agg->CODCLIEST
'personbo_agg->FLGANAVAL
'personbo_agg->CLPRVDOM
'personbo_agg->MITIG
'personbo_agg->MITGDOC
'personbo_agg->CATEG01
'personbo_agg->CATEG02
'personbo_agg->CATEG03
'personbo_agg->CATEG04
'personbo_agg->CATEG05
'personbo_agg->CATEGORIA
'personbo_agg->FLGPREGIUD
'personbo_agg->FLGTRUST
'personbo_agg->FLGRISCHIO
'personbo_agg->FLGEQUIFIN
'personbo_agg->FLGFALSADIC
'personbo_agg->FLGRICINF
'personbo_agg->WUGID
'personbo_agg->WUNAZRILDOC
'personbo_agg->NUMCEL
'personbo_agg->PEC
'personbo_agg->REFERENTE
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=2
prev=O987
rd_kfield=[
'ALLINEATO
'ALLINEATONOMECNOME
'ALTROCAP
'ALTRODOM
'AREAGEO
'ATTIV
'AUTRILASC
'BANCABEN
'CAP
'CAUSALE
'CFESTERO
'CITTADIN1
'CITTADIN2
'CODCAB
'CODDIPE
'CODFISC
'CODINTER
'CODLEGRAP
'CODORO
'COGNOME
'COMPORT
'CONNES
'CRIME
'CRIMEDATE
'DAC6
'DATAFINE
'DATAIDENT
'DATAINI
'datamodi
'DATANASC
'DATAPROF
'DATARAUT
'DATAREVPROF
'DATARILASC
'DATASEGN
'DATASIGN
'DATAVALI
'DATEXTRA
'DESCCIT
'DISATTIVO
'DOCFILE
'DOMICILIO
'FATCA
'FATTURATO
'FLAGDAC6
'FLGNOTRIM
'FLGVALIDO
'FREQUENZA
'IDBASE
'idcitta
'IDENT
'IDFILE
'IDNASCOMUN
'IDNASSTATO
'IMPORTOMAX
'MACROAGENTE
'MITGDOC
'MITIG
'NASCOMUN
'NASSTATO
'NOME
'NOSARA
'NOTE
'NOTIT
'NUMDOCUM
'NUMIMP
'NUMOPERAZ
'ODB
'OLDCODFISC
'OLDCONNES
'OLDSETSIN
'PAESE
'PARTIVA
'PEP
'PEPDATE
'PKTBSPECIE
'PROGIMP_C
'PROGIMPORT
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAPSEGNA
'RAREA
'RATTIV
'RCOMP
'RESFISC
'RISGLOB
'RNATGIU
'sanumpro
'SESSO
'SETTSINT
'SETTSINT2
'SOGAFFIDATARIO
'SOSPMAF
'SOTGRUP
'SPOTID
'TELEF
'TIN
'TIPINTER
'TIPODOC
'TIPOORO
'TIPOPERS
'TIPOSOGGETTO
'VERIFICA
]
rd_kvar=[
'rowPersonbo.ALLINEATO
'rowPersonbo.ALLINEATONOMECNOME
'rowPersonbo.ALTROCAP
'rowPersonbo.ALTRODOM
'rowPersonbo.AREAGEO
'rowPersonbo.ATTIV
'rowPersonbo.AUTRILASC
'rowPersonbo.BANCABEN
'rowPersonbo.CAP
'rowPersonbo.CAUSALE
'rowPersonbo.CFESTERO
'rowPersonbo.CITTADIN1
'rowPersonbo.CITTADIN2
'rowPersonbo.CODCAB
'rowPersonbo.CODDIPE
'rowPersonbo.CODFISC
'rowPersonbo.CODINTER
'rowPersonbo.CODLEGRAP
'rowPersonbo.CODORO
'rowPersonbo.COGNOME
'rowPersonbo.COMPORT
'xConnes
'rowPersonbo.CRIME
'rowPersonbo.CRIMEDATE
'rowPersonbo.DAC6
'rowPersonbo.DATAFINE
'rowPersonbo.DATAIDENT
'rowPersonbo.DATAINI
'_datarett
'rowPersonbo.DATANASC
'rowPersonbo.DATAPROF
'rowPersonbo.DATARAUT
'rowPersonbo.DATAREVPROF
'rowPersonbo.DATARILASC
'rowPersonbo.DATASEGN
'rowPersonbo.DATASIGN
'rowPersonbo.DATAVALI
'rowPersonbo.DATEXTRA
'rowPersonbo.DESCCIT
'rowPersonbo.DISATTIVO
'rowPersonbo.DOCFILE
'rowPersonbo.DOMICILIO
'rowPersonbo.FATCA
'rowPersonbo.FATTURATO
'rowPersonbo.FLAGDAC6
'rowPersonbo.FLGNOTRIM
'rowPersonbo.FLGVALIDO
'rowPersonbo.FREQUENZA
'rowPersonbo.IDBASE
'rowPersonbo.idcitta
'rowPersonbo.IDENT
'rowPersonbo.IDFILE
'rowPersonbo.IDNASCOMUN
'rowPersonbo.IDNASSTATO
'rowPersonbo.IMPORTOMAX
'rowPersonbo.MACROAGENTE
'rowPersonbo.MITIGDOC
'rowPersonbo.MITIG
'rowPersonbo.NASCOMUN
'rowPersonbo.NASSTATO
'rowPersonbo.NOME
'rowPersonbo.NOSARA
'rowPersonbo.NOTE
'rowPersonbo.NOTIT
'rowPersonbo.NUMDOCUM
'_numimp
'rowPersonbo.NUMOPERAZ
'rowPersonbo.ODB
'rowPersonbo.OLDCODFISC
'rowPersonbo.OLDCONNES
'rowPersonbo.OLDSETSIN
'rowPersonbo.PAESE
'rowPersonbo.PARTIVA
'rowPersonbo.PEP
'rowPersonbo.PEPDATE
'rowPersonbo.PKTBSPECIE
'rowPersonbo.PROGIMP_C
'rowPersonbo.PROGIMPORT
'rowPersonbo.PROVINCIA
'rowPersonbo.RAGSOC
'rowPersonbo.RAGSOCOLD
'rowPersonbo.RAMOGRUP
'rowPersonbo.RAPSEGNA
'rowPersonbo.RAREA
'rowPersonbo.RATTIV
'rowPersonbo.RCOMP
'rowPersonbo.RESFISC
'rowPersonbo.RISGLOB
'rowPersonbo.RNATGIU
'cProgSto
'rowPersonbo.SESSO
'rowPersonbo.SETTSINT
'rowPersonbo.SETTSINT2
'rowPersonbo.SOGAFFIDATARIO
'rowPersonbo.SOSPMAF
'rowPersonbo.SOTGRUP
'rowPersonbo.SPOTID
'rowPersonbo.TELEF
'rowPersonbo.TIN
'rowPersonbo.TIPINTER
'rowPersonbo.TIPODOC
'rowPersonbo.TIPOORO
'rowPersonbo.TIPOPERS
'rowPersonbo.TIPOSOGGETTO
'rowPersonbo.VERIFICA
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O988
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
frm_calc='m_cLastMsgError = ""
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O1067
I
obj='Exec
pag=2
prev=O1066
I
obj='Var
obj_type='N
pag=2
prev=O1065
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=2
prev=O986
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O985
var_op='asgn
I
obj='Remark
pag=2
I
I
]
w=[
150
150
]
I
obj='Select
pag=2
prev=O977
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=xConnes and wersonbo->datamodi=_datarett
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O978
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='D
pag=2
prev=O976
var_op='asgn
I
obj='Var
pag=2
prev=O975
var_op='asgn
I
obj='Remark
pag=2
prev=O974
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=2
prev=O866
I
obj='If
pag=2
prev=O865
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O866
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad(rowPersonbo.CODFISC,16)
len=10
name='xRiga6
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xSesso)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + iif(rowPersonbo.CFESTERO=1,'1','0')
len=10
name='xRiga6
obj='Var
obj_type='M
pag=2
prev=O1079
var_op='asgn
I
obj='If
pag=2
prev=O1078
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1079
fatherSonIndex=0
frm_calc='xRiga6 + LibreriaMit.SpacePad(rowPersonbo.RAGSOC,70)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + iif(rowPersonbo.PAESE='086',Upper(LibreriaMit.SpacePad(rowPersonbo.DESCCIT,30)),Space(30))
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(rowPersonbo.PAESE,3)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(rowPersonbo.PROVINCIA,2)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + Space(122)
len=10
name='xRiga6
obj='Var
obj_type='M
pag=2
prev=O1088
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1087
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1086
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1085
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1079
fatherSonIndex=1
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->RAGSOC,70)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + Space(35)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(rowPersonbo.COGNOME,26)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(rowPersonbo.NOME,25)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(rowPersonbo.SESSO,1)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + iif(DateToChar(rowPersonbo.DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(rowPersonbo.DATANASC),8),Space(8))
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(Left(rowPersonbo.NASCOMUN,30),30)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(rowPersonbo.TIPINTER,2)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(Left(rowPersonbo.NASSTATO,30),30)
len=10
name='xRiga6
obj='Var
obj_type='M
pag=2
prev=O1098
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1097
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1096
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1095
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1094
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1093
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1092
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1091
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
prev=O864
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O863
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O862
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O861
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O860
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O859
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O858
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O857
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O856
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O855
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O854
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O853
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O852
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O851
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O850
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O849
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O848
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O847
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O846
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O845
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O844
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O843
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O842
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O841
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O840
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O839
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O838
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O837
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O834
var_op='asgn
I
obj='If
pag=2
prev=O833
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O834
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad(Upper(xCF),16)
len=10
name='xRiga5
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xSesso)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+iif(xCFE=1,'1','0')
len=10
name='xRiga5
obj='Var
obj_type='M
pag=2
prev=O1105
var_op='asgn
I
obj='If
pag=2
prev=O1104
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1105
fatherSonIndex=0
frm_calc='xRiga5 + Substr(riga,7,70)
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+iif(Substr(riga,262,3)='086',Upper(Substr(riga,230,30)),Space(30))
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5 +Substr(riga,262,3)
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+Substr(riga,260,2)
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+ Space(122)
len=10
name='xRiga5
obj='Var
obj_type='M
pag=2
prev=O1114
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1113
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1112
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1111
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1105
fatherSonIndex=1
frm_calc='xRiga5+Upper(Substr(riga,7,70))
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+Space(35)
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+Upper(Substr(riga,297,26))
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+Upper(Substr(riga,323,25))
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+xSesso
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2)
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+LibreriaMit.SpacePad(Left(cCNAS,30),30)
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+Substr(riga,448,2)
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+LibreriaMit.SpacePad(Left(cSNAS,30),30)
len=10
name='xRiga5
obj='Var
obj_type='M
pag=2
prev=O1124
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1123
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1122
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1121
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1120
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1119
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1118
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1117
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
prev=O832
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O831
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O830
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O829
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O828
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O827
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O826
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=2
prev=O800
I
obj='Begin
pag=2
prev=O797
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O800
fatherSonIndex=0
frm_calc='iif(_flganag='S',_oldcog,Upper(Substr(riga,297,26)))
len=26
name='_oldcog
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnom,Upper(Substr(riga,323,25)))
len=26
name='_oldnom
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldrgs,Upper(Substr(riga,7,70)))
len=70
name='_oldrgs
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldncm,cCNAS)
len=30
name='_oldncm
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnst,cSNAS)
len=30
name='_oldnst
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldndt,CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2)))
len=8
name='_oldndt
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnpv,Upper(Substr(riga,448,2)))
len=2
name='_oldnpv
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnsx,xSesso)
len=1
name='_oldnsx
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgvali='S',_oldest,xCFE)
len=1
name='_oldest
obj='Var
obj_type='N
pag=2
prev=O1138
var_op='asgn
I
obj='Var
pag=2
prev=O1137
var_op='asgn
I
obj='Var
pag=2
prev=O1136
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O1135
var_op='asgn
I
obj='Var
pag=2
prev=O1134
var_op='asgn
I
obj='Var
pag=2
prev=O1133
var_op='asgn
I
obj='Var
pag=2
prev=O1132
var_op='asgn
I
obj='Var
pag=2
prev=O1131
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O796
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O797
fatherSonIndex=0
frm_calc='Upper(Substr(riga,136,30))
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=2
prev=O1143
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O795
var_op='asgn
I
obj='Var
pag=2
prev=O792
var_op='asgn
I
obj='If
pag=2
prev=O791
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O792
fatherSonIndex=0
frm_calc='Upper(Substr(riga,230,30))
len=30
name='xCitta
next=Icpitembatch.CPForEach
for_variable='rowTBCITTA
for_variable_type='tbcitta
h=[
19
19
]
iterator_expr='mcTBCITTA
obj='ForEach
pag=2
prev=O1148
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1149
fatherSonIndex=0
frm_calc=[
'LRTrim(rowTBCITTA.CITTA)=LRTrim(xCitta)
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1153
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(xPrv))) and rowTBCITTA.PROV=xPrv
'not(Empty(LRTrim(xPrv))) and rowTBCITTA.PROV=xPrv
]
h=[
19
19
19
19
]
haselse=True
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1158
fatherSonIndex=0
frm_calc='rowTBCITTA.CAB
len=6
name='xCodCab
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O1163
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1158
fatherSonIndex=1
frm_calc='rowTBCITTA.CAB
len=6
name='xCodCab
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1158
fatherSonIndex=2
frm_calc='rowTBCITTA.CAB
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
frm_calc='rowTBCITTA.PROV
len=2
name='xPrv
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O1169
I
obj='Var
pag=2
prev=O1168
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O790
var_op='asgn
I
obj='Var
pag=2
prev=O789
var_op='asgn
I
obj='Var
pag=2
prev=O788
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O785
var_op='asgn
I
obj='If
pag=2
prev=O784
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O785
fatherSonIndex=0
frm_calc='iif(LRTrim(Substr(riga,450,1))='1',1,0)
len=1
name='xCFE
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O785
fatherSonIndex=1
frm_calc='iif(LRTrim(Substr(riga,450,1))='S',1,0)
len=1
name='xCFE
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O783
var_op='asgn
I
obj='Var
pag=2
prev=O782
var_op='asgn
I
obj='Read
pag=2
prev=O781
rd_field=[
'FLGVALIDO
'FLGANAVAL
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'cCli1
]
rd_var=[
'_flgvali
'_flganag
]
I
obj='Var
pag=2
prev=O780
var_op='asgn
I
obj='Var
pag=2
prev=O778
var_op='asgn
I
obj='ForEach
pag=2
prev=O777
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O778
fatherSonIndex=0
frm_calc='rwPersonbo
frm_seek='Copy
name='rowPersonbo
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.CONNES
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.CFESTERO
len=1
name='_oldest
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.CODFISC
len=16
name='_oldcf
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.COGNOME
len=26
name='_oldcog
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.NOME
len=26
name='_oldnom
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.RAGSOC
len=70
name='_oldrgs
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.NASCOMUN
len=30
name='_oldncm
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.NASSTATO
len=30
name='_oldnst
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.DATANASC
len=8
name='_oldndt
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.TIPINTER
len=2
name='_oldnpv
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.SESSO
len=1
name='_oldnsx
obj='Var
pag=2
prev=O1197
var_op='asgn
I
obj='Var
pag=2
prev=O1196
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O1195
var_op='asgn
I
obj='Var
pag=2
prev=O1194
var_op='asgn
I
obj='Var
pag=2
prev=O1193
var_op='asgn
I
obj='Var
pag=2
prev=O1192
var_op='asgn
I
obj='Var
pag=2
prev=O1191
var_op='asgn
I
obj='Var
pag=2
prev=O1190
var_op='asgn
I
obj='Var
pag=2
prev=O1189
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O1188
var_op='asgn
I
obj='Var
pag=2
prev=O1187
var_op='asgn
I
obj='Var
obj_type='R
pag=2
var_op='meth
I
I
]
w=[
150
150
]
I
obj='MemoryCursor
pag=2
prev=O775
sel_field='*
sel_name='personbo
sel_type='fltb
sel_where='personbo->CONNES=cCli1
I
obj='Begin
pag=2
prev=O774
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O775
fatherSonIndex=0
frm_calc='0
len=1
name='_oldest
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_oldcf
next=Icpitembatch.CPVarDecl
frm_calc='''
len=26
name='_oldcog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=26
name='_oldnom
next=Icpitembatch.CPVarDecl
frm_calc='''
len=70
name='_oldrgs
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_oldncm
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_oldnst
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_oldndt
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_oldnpv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_oldnsx
obj='Var
pag=2
prev=O1210
var_op='asgn
I
obj='Var
pag=2
prev=O1209
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O1208
var_op='asgn
I
obj='Var
pag=2
prev=O1207
var_op='asgn
I
obj='Var
pag=2
prev=O1206
var_op='asgn
I
obj='Var
pag=2
prev=O1205
var_op='asgn
I
obj='Var
pag=2
prev=O1204
var_op='asgn
I
obj='Var
pag=2
prev=O1203
var_op='asgn
I
obj='Var
pag=2
prev=O1202
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=2
prev=O773
I
obj='Var
pag=2
prev=O772
var_op='asgn
I
obj='Var
pag=2
prev=O771
var_op='asgn
I
obj='Var
pag=2
prev=O770
var_op='asgn
I
obj='Var
pag=2
prev=O769
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O766
var_op='asgn
I
obj='If
pag=2
prev=O765
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xersonbo
father=O766
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'CONNES
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'IDPROG
]
rd_kvar=[
'Substr(riga,470,3)
'Substr(riga,460,10)
'Substr(riga,200,30)
'Substr(riga,265,9)
'Substr(riga,450,1)
'Left(riga,6)
'Substr(riga,112,16)
'Substr(riga,297,26)
'Substr(riga,455,5)
'Substr(riga,488,16)
'Substr(riga,128,8)
'Substr(riga,192,8)
'Substr(riga,289,8)
'Substr(riga,230,30)
'Substr(riga,348,100)
'Substr(riga,77,35)
'Substr(riga,136,30)
'Substr(riga,323,25)
'Substr(riga,177,15)
'Substr(riga,262,3)
'Substr(riga,274,14)
'Substr(riga,487,1)
'Substr(riga,451,4)
'Substr(riga,260,2)
'Substr(riga,7,70)
'Substr(riga,7,70)
'Substr(riga,169,3)
'Substr(riga,484,3)
'Substr(riga,481,3)
'Substr(riga,478,3)
'Substr(riga,475,3)
'Substr(riga,288,1)
'Substr(riga,172,3)
'Substr(riga,166,3)
'Substr(riga,448,2)
'Substr(riga,175,2)
'conta
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O764
var_op='asgn
I
obj='Var
pag=2
prev=O763
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O762
var_op='asgn
I
obj='Var
obj_type='M
pag=2
pagelocal=True
prev=O761
var_op='asgn
I
obj='Var
obj_type='M
pag=2
pagelocal=True
prev=O760
var_op='asgn
I
obj='Var
obj_type='M
pag=2
pagelocal=True
prev=O759
var_op='asgn
I
obj='Var
obj_type='M
pag=2
pagelocal=True
prev=O758
var_op='asgn
I
obj='Var
obj_type='M
pag=2
pagelocal=True
prev=O757
var_op='asgn
I
obj='Var
obj_type='M
pag=2
pagelocal=True
prev=O756
var_op='asgn
I
obj='Var
obj_type='MC
pag=2
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=2
prev=O693
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
rd_var=[
'nProgSto
]
I
obj='Read
pag=2
prev=O692
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
rd_var=[
'nProgImp
]
I
obj='MemoryCursor
pag=2
prev=O691
sel_field='*
sel_name='tbcitta
sel_type='fltb
I
obj='Var
pag=2
prev=O690
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O688
var_op='asgn
I
obj='Begin
pag=2
prev=O687
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O688
fatherSonIndex=0
frm_calc=[
'At("archper",_tabelle)=0
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1231
fatherSonIndex=0
frm_calc='_tabelle+"archpers,"
len=10
name='_tabelle
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O686
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O685
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O684
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O683
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O682
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O681
var_op='asgn
I
obj='Remark
pag=2
x=15
y=15
I
Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathDoc)+"/appo/"+LRTrim(gAzienda)+'/'+LRTrim(nomefileimport)
name='fileName
next=Icpitembatch.CPExec
check='page
frm_calc='45
next=Icpitembatch.CPVarDecl
frm_calc='Paths.get(fileName)
name='path
next=Icpitembatch.CPExec
check='man
frm_calc='// Conta le righe del fle﷯righeTot=Files.lines(path,Charset.forName(_charset)).count();
obj='Exec
pag=2
prev=O1241
I
obj='Var
obj_type='O
pag=2
prev=O1240
var_op='asgn
I
obj='Exec
pag=2
prev=O1239
I
obj='Var
pag=2
var_op='asgn
x=1107
y=349
I
Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' soggetti su '+LRTrim(Str(righeTot,10,0)) + ' del file '+LRTrim(nomefileimport)
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=2
var_op='asgn
x=1075
y=865
I
Icpitembatch.CPRead
arch='personbo
obj='Read
pag=2
rd_field=[
'CONNES
'CFESTERO
'CODFISC
'COGNOME
'NOME
'RAGSOC
'NASCOMUN
'NASSTATO
'DATANASC
'TIPINTER
'SESSO
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'cCli1
]
rd_var=[
'xConnes
'_oldest
'_oldcf
'_oldcog
'_oldnom
'_oldrgs
'_oldncm
'_oldnst
'_oldndt
'_oldnpv
'_oldnsx
]
x=626
y=1177
I
Icpitembatch.CPVarDecl
frm_seek='AppendBlank
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(xConnes)
frm_seek='connes
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcSoggetti
obj='Var
obj_type='MC
pag=2
prev=O1250
var_op='meth
I
obj='Var
obj_type='MC
pag=2
prev=O1249
var_op='prop
I
obj='Var
obj_type='MC
pag=2
var_op='meth
x=1403
y=6599
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPBeginEnd
comment='Gestione storico import
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime())  + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Rapporti Inseriti: '+LRTrim(Str(cNumNew,10,0)) +' - Rapporti Aggiornati: '+LRTrim(Str(cNumMod,10,0))+' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1266
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1265
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1264
var_op='asgn
I
obj='Exec
pag=3
prev=O1263
I
obj='Exec
pag=3
prev=O1262
I
obj='Exec
pag=3
prev=O1260
I
obj='While
pag=3
prev=O1259
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1260
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=3
prev=O1270
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1271
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' rapporti del file '+LRTrim(nomefileimport)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='cFlagLire
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,77,1)='S'
'Substr(riga,77,1)='E'
'Substr(riga,77,1)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='xRapporto
next=Icpitembatch.CPRead
arch='anarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xRapporto))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O1283
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O1284
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='anarapbo
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='knarapbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,83,1)<>'1'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=3
prev=O1294
var_op='asgn
I
obj='If
pag=3
prev=O1292
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1294
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PROGAET\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aetesta
h=[
19
19
]
obj='Insert
pag=3
prev=O1300
rd_kfield=[
'RAPPORTO
'TIPOAG
'COINT
'DESCRI
'VALUTA
'PROGAET
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,81,2)
'iif(Substr(riga,76,1)='1','1','2')
'iif(Substr(riga,81,2)='99',Upper(Substr(riga,26,24)),'')
'Substr(riga,78,3)
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1301
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O1309
I
obj='Var
obj_type='N
pag=3
prev=O1308
var_op='asgn
I
obj='Exec
pag=3
prev=O1307
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=3
prev=O1290
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGRAP
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
''D'
'Substr(riga,76,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1292
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O1319
I
obj='Var
obj_type='N
pag=3
prev=O1318
var_op='asgn
I
obj='Exec
pag=3
prev=O1317
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Insert
pag=3
prev=O1289
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
'AMMONT
'DURAT
'TIPO
'RRAGIO
'RCOMP
'RAREA
'RIMP
'RFREQ
'RTIPO
'NATURA
'SCOPO
'MITIG
'PRGIMPRAP
'RISGLOB
'DATAPROF
'DATAREVPROF
'NUMIMP
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
'ISOAGE
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,94,5)),3))
'Substr(riga,99,5)
'Substr(riga,104,5)
'Substr(riga,109,5)
'Val(Substr(riga,114,3))
'Val(Substr(riga,117,3))
'Val(Substr(riga,120,3))
'Val(Substr(riga,123,3))
'Val(Substr(riga,126,3))
'Val(Substr(riga,129,3))
'Substr(riga,132,50)
'Substr(riga,182,50)
'Val(Substr(riga,298,4))
'nProgImp
'Substr(riga,318,3)
'CharToDate(Substr(riga,306,4)+Substr(riga,304,2)+Substr(riga,302,2))
'CharToDate(Substr(riga,314,4)+Substr(riga,312,2)+Substr(riga,310,2))
'_numimp
'Substr(riga,331,2)
'Substr(riga,333,2)
'Substr(riga,335,2)
'Substr(riga,337,2)
'Substr(riga,339,2)
'fwfn_calc_categoria(Substr(riga,331,2),Substr(riga,333,2),Substr(riga,335,2),Substr(riga,337,2),Substr(riga,339,2))
'Substr(riga,341,3)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1290
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O1328
I
obj='Var
obj_type='N
pag=3
prev=O1327
var_op='asgn
I
obj='Exec
pag=3
prev=O1326
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='anarapbo
father=O1284
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='knarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,83,1)<>'1'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=3
prev=O1335
var_op='asgn
I
obj='If
pag=3
prev=O1334
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aetesta
father=O1335
fatherSonIndex=0
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'TIPOAG
'COINT
'DESCRI
'VALUTA
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,81,2)
'iif(Substr(riga,76,1)='1','1','2')
'iif(Substr(riga,81,2)='99',Upper(Substr(riga,26,24)),'')
'Substr(riga,78,3)
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=3
prev=O1332
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'DESCRAP
'FLAGRAP
'TIPORAP
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Substr(riga,26,50)
'Substr(riga,76,1)
''D'
]
I
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1332
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O1362
I
obj='Var
obj_type='N
pag=3
prev=O1361
var_op='asgn
I
obj='Exec
pag=3
prev=O1360
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
'AMMONT
'DURAT
'TIPO
'RRAGIO
'RCOMP
'RAREA
'RIMP
'RFREQ
'RTIPO
'NATURA
'SCOPO
'MITIG
'RISGLOB
'DATAPROF
'DATAREVPROF
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
'ISOAGE
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,94,5)),3))
'Substr(riga,99,5)
'Substr(riga,104,5)
'Substr(riga,109,5)
'Val(Substr(riga,114,3))
'Val(Substr(riga,117,3))
'Val(Substr(riga,120,3))
'Val(Substr(riga,123,3))
'Val(Substr(riga,126,3))
'Val(Substr(riga,129,3))
'Substr(riga,132,50)
'Substr(riga,182,50)
'Val(Substr(riga,298,4))
'Substr(riga,318,3)
'CharToDate(Substr(riga,306,4)+Substr(riga,304,2)+Substr(riga,302,2))
'CharToDate(Substr(riga,314,4)+Substr(riga,312,2)+Substr(riga,310,2))
'Substr(riga,331,2)
'Substr(riga,333,2)
'Substr(riga,335,2)
'Substr(riga,337,2)
'Substr(riga,339,2)
'fwfn_calc_categoria(Substr(riga,331,2),Substr(riga,333,2),Substr(riga,335,2),Substr(riga,337,2),Substr(riga,339,2))
'Substr(riga,341,3)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=3
prev=O1282
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Left(riga,25)
]
rd_var=[
'xRapporto
]
I
obj='Var
pag=3
prev=O1279
var_op='asgn
I
obj='Case
pag=3
prev=O1278
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1279
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1279
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1279
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1279
fatherSonIndex=3
frm_calc='Substr(riga,77,1)
len=1
name='cFlagLire
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Var
pag=3
prev=O1277
var_op='asgn
I
nonlocal=True
obj='Var
pag=3
prev=O1276
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O1258
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1256
var_op='asgn
I
obj='Begin
pag=3
prev=O1255
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1256
fatherSonIndex=0
frm_calc=[
'At("archrap",_tabelle)=0
]
h=[
19
19
]
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1387
fatherSonIndex=0
frm_calc='_tabelle+"archrap,"
len=10
name='_tabelle
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O1254
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1253
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1252
var_op='asgn
I
obj='Remark
pag=3
x=15
y=15
I
Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+'/'+LRTrim(nomefileimport)
name='fileName
next=Icpitembatch.CPExec
check='page
frm_calc='45
next=Icpitembatch.CPVarDecl
frm_calc='Paths.get(fileName)
name='path
next=Icpitembatch.CPExec
check='man
frm_calc='// Conta le righe del fle﷯righeTot=Files.lines(path,Charset.forName(_charset)).count();
next=Icpitembatch.CPVarDecl
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' rapporti su '+LRTrim(Str(righeTot,10,0)) + ' del file '+nomefileimport
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=3
prev=O1398
var_op='asgn
I
obj='Exec
pag=3
prev=O1397
I
obj='Var
obj_type='O
pag=3
prev=O1396
var_op='asgn
I
obj='Exec
pag=3
prev=O1395
I
obj='Var
pag=3
var_op='asgn
x=1194
y=246
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPBeginEnd
comment='Gestione storico import
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Informazione Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O1413
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O1412
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O1411
var_op='asgn
I
obj='Exec
pag=4
prev=O1410
I
obj='Exec
pag=4
prev=O1409
I
obj='Exec
pag=4
prev=O1407
I
obj='While
pag=4
prev=O1406
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1407
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=4
prev=O1417
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O1418
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,75,16)
len=16
name='xConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,50,16)
len=16
name='xSOCTCon
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xSOCTCon)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono state elaborate '+LRTrim(Str(conta,10,0))+' informazioni del file '+LRTrim(nomefileimport)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,46,1)='S'
'Substr(riga,46,1)='E'
'Substr(riga,46,1)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,159,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,36,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPInsert
arch='rapopebo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,219,16)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(cCli1)) and At(Substr(riga,44,2),'|25|39|40|28|41|47|') = 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(xSOCTCon)) and At(Substr(riga,44,2),'|25|39|40|28|41|47|') > 0
]
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=4
prev=O1462
sel_field='rapopebo->DATAOPE,rapopebo->TIPOOPRAP
sel_name='rapopebo
sel_order='rapopebo->DATAOPE
sel_where='rapopebo->RAPPORTO=LRTrim(Substr(riga,9,25)) and (rapopebo->STATOREG='0' or rapopebo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1465
fatherSonIndex=0
frm_calc=[
'At(rapopebo->TIPOOPRAP,'|26|36|38|43|44|46') > 0
'At(rapopebo->TIPOOPRAP,'|23|24|27|33|34|35|43|44|45') > 0
]
h=[
19
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='knarapbo
father=O1469
fatherSonIndex=0
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(Substr(riga,9,25))
]
wr_field=[
'DATAFIN
]
wr_op=[
'=
]
wr_var=[
'rapopebo->DATAOPE
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='knarapbo
father=O1469
fatherSonIndex=1
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(Substr(riga,9,25))
]
wr_field=[
'DATAINI
]
wr_op=[
'=
]
wr_var=[
'rapopebo->DATAOPE
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O1459
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1462
fatherSonIndex=0
frm_calc=[
'At(Substr(riga,44,2),'|25|39|40') > 0
'At(Substr(riga,44,2),'|28|41|47') > 0
]
h=[
19
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='delegabo
father=O1493
fatherSonIndex=0
h=[
19
19
]
obj='Insert
pag=4
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
'NUMIMP
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'xSOCTCon
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1498
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1506
I
obj='Var
obj_type='N
pag=4
prev=O1505
var_op='asgn
I
obj='Exec
pag=4
prev=O1504
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='delegabo
father=O1493
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'xSOCTCon
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1510
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1519
I
obj='Var
obj_type='N
pag=4
prev=O1518
var_op='asgn
I
obj='Exec
pag=4
prev=O1517
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
'NUMPROG2
'NUMIMP
]
wr_op=[
'=
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
'_numimp
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O1458
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPSelect
father=O1459
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
prev=O1529
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1531
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='intestbo
h=[
19
19
]
obj='Insert
pag=4
prev=O1536
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
'PRGIMPSOG
'PROQUOTA
'NUMIMP
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
'nProgImp2
'Val(Substr(riga,235,3))
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1537
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1545
I
obj='Var
obj_type='N
pag=4
prev=O1544
var_op='asgn
I
obj='Exec
pag=4
prev=O1543
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1531
fatherSonIndex=1
frm_calc=[
'Substr(riga,45,1)='6' or Substr(riga,44,2)='38'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestbo
father=O1549
fatherSonIndex=0
h=[
19
19
]
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'Substr(riga,9,25)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1554
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1563
I
obj='Var
obj_type='N
pag=4
prev=O1562
var_op='asgn
I
obj='Exec
pag=4
prev=O1561
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
'NUMPROG2
'NUMIMP
]
wr_op=[
'=
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
'_numimp
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestbo
father=O1549
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cCli1
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1570
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1579
I
obj='Var
obj_type='N
pag=4
prev=O1578
var_op='asgn
I
obj='Exec
pag=4
prev=O1577
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'NUMPROG1
'NUMIMP
]
wr_op=[
'=
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
'_numimp
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=4
sel_field='*
sel_name='intestbo
sel_order='intestbo->CPROWNUM
sel_where='intestbo->RAPPORTO=Substr(riga,9,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1529
fatherSonIndex=0
frm_calc=[
'intestbo->CODINTER=cCli1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=4
prev=O1589
var_op='asgn
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1589
fatherSonIndex=0
frm_calc='intestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O1457
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1456
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1453
var_op='asgn
I
obj='If
pag=4
prev=O1451
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='fiduciabo
father=O1453
fatherSonIndex=0
obj='Insert
pag=4
rd_kfield=[
'IDFILEBO
'CODSOG
'NUMCOL
'RAPCOL
'IDBASE
'NUMIMP
]
rd_kvar=[
'cInfProg1
'LRTrim(Substr(riga,219,16))
'cInfProg2
'Substr(riga,9,25)
'LibreriaMit.UniqueId()
'_numimp
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=4
prev=O1450
rd_kfield=[
'CDATOPE
'CDATREG
'CODCAB
'CODDIPE
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'VALUTA
'IDBASE2
'NUMIMP
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'_intercab
'Substr(riga,115,6)
'_intercod
'iif((_dataope < CharToDate('20100601') or _dataope > CharToDate('20131231')),xSOCTCF,'')
'_dataope
'_datareg
'_intercit
'Substr(riga,169,50)
'cFlagLire
'Substr(riga,34,1)
'cInfProg1
'"I"+Right(cInfProg2,9)+_idb2
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'iif((_dataope < CharToDate('20100601') or _dataope > CharToDate('20131231')),Substr(riga,35,1),' ')
'Substr(riga,44,2)
'Substr(riga,159,10)
'Substr(riga,47,3)
'_idb2
'_numimp
]
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1451
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1611
I
obj='Var
obj_type='N
pag=4
prev=O1610
var_op='asgn
I
obj='Exec
pag=4
prev=O1609
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=4
prev=O1449
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1448
var_op='asgn
I
obj='Var
pag=4
prev=O1447
var_op='asgn
I
obj='Var
pag=4
prev=O1446
var_op='asgn
I
obj='Var
obj_type='D
pag=4
prev=O1445
var_op='asgn
I
obj='Var
obj_type='D
pag=4
prev=O1442
var_op='asgn
I
obj='If
pag=4
prev=O1441
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='rapopebo
father=O1442
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'_unicode<>''
]
h=[
19
19
]
obj='If
pag=4
prev=O1616
sons=[
Icpitembatch.CPItemSon
comment='In caso di _unicode doppio blocco l'importazione
instr=Icpitembatch.CPVarDecl
father=O1617
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1623
I
obj='Var
obj_type='N
pag=4
prev=O1622
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,159,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
prev=O1440
var_op='asgn
I
obj='Remark
pag=4
prev=O1437
I
obj='Case
pag=4
prev=O1436
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1437
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1437
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1437
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1437
fatherSonIndex=3
frm_calc='Substr(riga,46,1)
len=1
name='cFlagLire
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
nonlocal=True
obj='Var
pag=4
prev=O1435
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1432
var_op='asgn
I
obj='If
pag=4
prev=O1431
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O1432
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=4
prev=O1643
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O1644
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=4
prev=O1649
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1650
fatherSonIndex=0
frm_calc='xSOCTCon
len=16
name='xSOCTCF
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
prev=O1430
var_op='asgn
I
obj='Var
pag=4
prev=O1427
var_op='asgn
I
obj='If
pag=4
prev=O1426
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='personbo
father=O1427
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
obj='If
pag=4
prev=O1669
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1670
fatherSonIndex=0
frm_calc='xConnes
len=16
name='cCli1
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
prev=O1425
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
obj='Var
pag=4
prev=O1423
var_op='asgn
I
obj='Begin
pag=4
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1423
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,104,11))),_codinter,Substr(riga,104,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,121,30))),_citinter,Substr(riga,121,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,153,6))),_cabinter,Substr(riga,153,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,151,2))),_prvinter,Substr(riga,151,2))
len=2
name='_interprv
obj='Var
pag=4
prev=O1690
var_op='asgn
I
obj='Var
pag=4
prev=O1689
var_op='asgn
I
obj='Var
pag=4
prev=O1688
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O1405
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1404
var_op='asgn
I
obj='Var
pag=4
prev=O1403
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O1401
var_op='asgn
I
obj='Begin
pag=4
prev=O1400
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1401
fatherSonIndex=0
frm_calc=[
'At("archinf",_tabelle)=0
]
h=[
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1697
fatherSonIndex=0
frm_calc='_tabelle+"archinf,"
len=10
name='_tabelle
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=4
x=15
y=15
I
Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+'/'+LRTrim(nomefileimport)
name='fileName
next=Icpitembatch.CPExec
check='page
frm_calc='45
next=Icpitembatch.CPVarDecl
frm_calc='Paths.get(fileName)
name='path
next=Icpitembatch.CPExec
check='man
frm_calc='// Conta le righe del fle﷯righeTot=Files.lines(path,Charset.forName(_charset)).count();
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono state elaborate '+LRTrim(Str(conta,10,0))+' informazioni su '+LRTrim(Str(righeTot,10,0)) + ' del file '+LRTrim(nomefileimport)
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=4
prev=O1708
var_op='asgn
I
obj='Exec
pag=4
prev=O1707
I
obj='Var
obj_type='O
pag=4
prev=O1706
var_op='asgn
I
obj='Exec
pag=4
prev=O1705
I
obj='Var
pag=4
var_op='asgn
x=1162
y=231
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPBeginEnd
comment='Gestione storico import
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Inizializzazione MC controlli
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Inserite o modificate: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','OPERAZBO','Operazioni Inserite o modificate: '+LRTrim(Str(cNumNew,10,0)))
obj='Exec
pag=5
prev=O1726
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1725
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1724
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1723
var_op='asgn
I
obj='Exec
pag=5
prev=O1722
I
obj='Exec
pag=5
prev=O1721
I
obj='Exec
pag=5
prev=O1719
I
obj='While
pag=5
prev=O1718
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1719
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=5
prev=O1730
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1731
fatherSonIndex=0
frm_calc=[
'w_opeunivoco='N' or (w_opeunivoco='S' and arfn_chktotalelire(CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)),_dataeuro,Val(Substr(riga,165,10))/100,"0"))
'w_opeunivoco='S' and not(arfn_chktotalelire(CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)),_dataeuro,Val(Substr(riga,165,10))/100,"0"))
]
h=[
19
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1736
fatherSonIndex=0
frm_calc='NullDate()
len=8
name='_oldreg
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Upper(Substr(riga,331,9))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1747
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O1749
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,257,6))))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,318,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc='_flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,923,1)='S',1,0)
len=1
name='_flgfraud
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,331,9))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))) or (Empty(LRTrim(_numprog)) and not(Empty(LRTrim(Left(riga,8)))))
]
h=[
19
19
]
obj='If
pag=5
prev=O1772
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1775
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,155,1)='S'
'Substr(riga,155,1)='E'
'Substr(riga,155,1)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,9,1)='1' or Substr(riga,9,1)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,301,1)),'0',iif(Substr(riga,301,1)='S','1',iif(Substr(riga,301,1)='N','0',Substr(riga,301,1))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,231,11))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono state elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+LRTrim(nomefileimport)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,852,19))),0,Val(LRTrim(Substr(riga,852,19))))
len=15
name='_totin
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,871,19))),0,Val(LRTrim(Substr(riga,871,19))))
len=15
name='_totout
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge i dati dell'intermediario controparte
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='operazbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_oldidb)))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=5
prev=O1806
var_op='asgn
I
obj='If
pag=5
prev=O1804
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1806
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='sogopebo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='clientiope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='beneficope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='terzistiope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPMerge
arch='operazbo_agg
obj='Merge
pag=5
prev=O1826
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'IDBASE
'FLAGFRAUD
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
'SV58724
'SV58726SCA
'SV58726SA
'SV58726PISP
'C_COGNOME
'C_NOME
'SOSPAGAM
]
wr_mode=[
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'cOpeProg1
'_flgfraud
'Substr(riga,924,2)
'Substr(riga,926,2)
'Substr(riga,928,2)
'Substr(riga,930,2)
'Substr(riga,932,2)
'fwfn_calc_categoria(Substr(riga,924,2),Substr(riga,926,2),Substr(riga,928,2),Substr(riga,930,2),Substr(riga,932,2))
'Substr(riga,934,2)
'iif(Empty(Substr(riga,936,1)),'N',Substr(riga,936,1))
'Substr(riga,937,3)
'Substr(riga,940,3)
'Substr(riga,943,50)
'Substr(riga,993,30)
'Substr(riga,1023,1)
]
I
obj='Select
pag=5
prev=O1824
sel_field='*
sel_name='rapcoll
sel_where='rapcoll->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='rapcoll
father=O1826
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'RAPPORTO
'IDBASE
'NUMIMP
]
rd_kvar=[
'cOpeProg1
'rapcoll->RAPPORTO
'rapcoll->IDBASE
'_numimp
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1823
sel_field='*
sel_name='operazbo_agg
sel_where='operazbo_agg->IDBASE=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='operazbo_agg
father=O1824
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDBASE
'CODLOB
'TIPOGIOCO
'CACODICE
'IDBIGLIETTO
'CADATAORA
'CATIPGIO
'CATIPCON
'CAPV_COD
'IDDOCALL
'VPCODICE
'WUDATRET
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
'FLAGFRAUD
'SV58724
'SV58726SCA
'SV58726SA
'SV58726PISP
'C_COGNOME
'C_NOME
'SOSPAGAM
]
rd_kvar=[
'cOpeProg1
'operazbo_agg->CODLOB
'operazbo_agg->TIPOGIOCO
'operazbo_agg->CACODICE
'operazbo_agg->IDBIGLIETTO
'operazbo_agg->CADATAORA
'operazbo_agg->CATIPGIO
'operazbo_agg->CATIPCON
'operazbo_agg->CAPV_COD
'operazbo_agg->IDDOCALL
'operazbo_agg->VPCODICE
'operazbo_agg->WUDATRET
'operazbo_agg->CATEG01
'operazbo_agg->CATEG02
'operazbo_agg->CATEG03
'operazbo_agg->CATEG04
'operazbo_agg->CATEG05
'operazbo_agg->CATEGORIA
'operazbo_agg->FLAGFRAUD
'operazbo_agg->SV58724
'operazbo_agg->SV58726SCA
'operazbo_agg->SV58726SA
'operazbo_agg->SV58726PISP
'operazbo_agg->C_COGNOME
'operazbo_agg->C_NOME
'operazbo_agg->SOSPAGAM
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=5
prev=O1821
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=5
prev=O1820
sel_field='*
sel_name='terzistiope
sel_where='terzistiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistiope
father=O1821
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'NUMIMP
]
rd_kvar=[
'cOpeProg1
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
'_numimp
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=5
prev=O1818
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=5
prev=O1817
sel_field='*
sel_name='beneficope
sel_where='beneficope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficope
father=O1818
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
'NUMIMP
]
rd_kvar=[
'cOpeProg1
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
'_numimp
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=5
prev=O1815
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=5
prev=O1814
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O1815
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'PROQUOTA
'IMPSARA
'NUMIMP
]
rd_kvar=[
'cOpeProg1
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
'clientiope->PROQUOTA
'clientiope->IMPSARA
'_numimp
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=5
prev=O1812
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=5
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sogopebo
father=O1812
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'NUMIMP
]
rd_kvar=[
'cOpeProg1
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
'_numimp
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='operazbo_agg
father=O1806
fatherSonIndex=1
obj='Insert
pag=5
rd_kfield=[
'IDBASE
'FLAGFRAUD
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
'SV58724
'SV58726SCA
'SV58726SA
'SV58726PISP
'C_COGNOME
'C_NOME
'SOSPAGAM
]
rd_kvar=[
'cOpeProg1
'_flgfraud
'Substr(riga,924,2)
'Substr(riga,926,2)
'Substr(riga,928,2)
'Substr(riga,930,2)
'Substr(riga,932,2)
'fwfn_calc_categoria(Substr(riga,924,2),Substr(riga,926,2),Substr(riga,928,2),Substr(riga,930,2),Substr(riga,932,2))
'Substr(riga,934,2)
'iif(Empty(Substr(riga,936,1)),'N',Substr(riga,936,1))
'Substr(riga,937,3)
'Substr(riga,940,3)
'Substr(riga,943,50)
'Substr(riga,993,30)
'Substr(riga,1023,1)
]
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=5
prev=O1802
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
'IMPIN
'IMPOUT
'MITIG
'SV58550
'PROQUOTA
'IMPSARA
'SV58550MA
'NOSARA
'NUMIMP
'VASP
]
rd_kvar=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'LRTrim(Substr(riga,10,4))
'_intercab
'_iccab
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'LRTrim(Substr(riga,484,16))
'LRTrim(Substr(riga,302,16))
'LRTrim(Substr(riga,190,16))
'LRTrim(Substr(riga,206,16))
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_datarett
'_iccit
'_intercit
'_icrag
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'_flagrap2
'cOpeProg1
'cIdCau
'"O"+Right(cOpeProg2,9)+_idb2
'Substr(riga,424,30)
'Substr(riga,813,15)
'Substr(riga,414,5)
'Substr(riga,662,50)
'cOpeProg2
'Substr(riga,328,3)
'_idreg
''1'
'iif(Empty(Substr(riga,828,14)) or Substr(riga,828,14)='01010001000000',NullDateTime(),CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6)))
'_icsta
'Substr(riga,812,1)
'nProgImp
'_icprv
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
'_statoreg
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'_colleg
'_idb2
'_totin / 100
'_totout / 100
'Val(Substr(riga,893,4))
'Substr(riga,897,1)
'Val(Substr(riga,898,3))
'Val(Substr(riga,901,19))/100
'Substr(riga,920,2)
'iif(Empty(LRTrim(Substr(riga,922,1))) or Substr(riga,922,1)='0' or Substr(riga,922,1)='N','N','S')
'_numimp
'Val(Substr(riga,1024,2))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1804
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O1895
I
obj='Var
obj_type='N
pag=5
prev=O1894
var_op='asgn
I
obj='Exec
pag=5
prev=O1893
I
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Begin
pag=5
prev=O1800
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1802
fatherSonIndex=0
frm_calc='''
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=50
name='_icrag
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,18,11)))) and Len(LRTrim(Substr(riga,64,6)+Substr(riga,70,50)+Substr(riga,29,3)+Substr(riga,62,2)+Substr(riga,32,30))) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1904
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O1905
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(_icrag),50)
len=50
name='_icrag
obj='Var
pag=5
prev=O1910
var_op='asgn
I
obj='Read
pag=5
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'Substr(riga,18,11)
]
rd_var=[
'_iccab
'_iccit
'_icprv
'_icsta
'_icrag
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1905
fatherSonIndex=1
frm_calc='Substr(riga,64,6)
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,32,30)
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,62,2)
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,29,3))
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,70,50)
len=50
name='_icrag
obj='Var
pag=5
prev=O1920
var_op='asgn
I
obj='Var
pag=5
prev=O1919
var_op='asgn
I
obj='Var
pag=5
prev=O1918
var_op='asgn
I
obj='Var
pag=5
prev=O1917
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=5
prev=O1903
var_op='asgn
I
obj='Var
pag=5
prev=O1902
var_op='asgn
I
obj='Var
pag=5
prev=O1901
var_op='asgn
I
obj='Var
pag=5
prev=O1900
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
prev=O1799
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1800
fatherSonIndex=0
frm_calc='Upper(Substr(riga,511,70))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,581,3))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,584,30))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,614,6)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,620,2))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,622,35))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,657,5))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,302,16))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=5
prev=O1936
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1939
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,120,25))))
]
h=[
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1944
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1949
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O1960
I
obj='Read
pag=5
prev=O1959
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=5
prev=O1958
var_op='asgn
I
obj='Var
pag=5
prev=O1957
var_op='asgn
I
obj='Var
pag=5
prev=O1956
var_op='asgn
I
obj='Var
pag=5
prev=O1955
var_op='asgn
I
obj='Var
pag=5
prev=O1954
var_op='asgn
I
obj='Var
pag=5
prev=O1953
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1933
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1936
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=5
prev=O1977
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,302,16)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=5
prev=O1976
var_op='asgn
I
obj='Var
pag=5
prev=O1975
var_op='asgn
I
obj='Var
pag=5
prev=O1974
var_op='asgn
I
obj='Var
pag=5
prev=O1973
var_op='asgn
I
obj='Var
pag=5
prev=O1972
var_op='asgn
I
obj='Var
pag=5
prev=O1971
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1932
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O1933
fatherSonIndex=0
obj='Read
pag=5
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1931
var_op='asgn
I
obj='Var
pag=5
prev=O1930
var_op='asgn
I
obj='Var
pag=5
prev=O1929
var_op='asgn
I
obj='Var
pag=5
prev=O1928
var_op='asgn
I
obj='Var
pag=5
prev=O1927
var_op='asgn
I
obj='Var
pag=5
prev=O1926
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1798
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1797
var_op='asgn
I
nonlocal=True
obj='Var
pag=5
prev=O1796
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1795
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1793
var_op='asgn
I
obj='Select
pag=5
par_expr=[
'LRTrim(Substr(riga,10,4))
'Substr(riga,14,2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O1792
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1793
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1791
var_op='asgn
I
obj='Var
pag=5
prev=O1790
var_op='asgn
I
obj='Var
pag=5
prev=O1789
var_op='asgn
I
obj='Var
pag=5
prev=O1788
var_op='asgn
I
obj='Var
pag=5
prev=O1785
var_op='asgn
I
obj='Case
pag=5
prev=O1784
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1785
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1785
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1785
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1785
fatherSonIndex=3
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Var
pag=5
prev=O1783
var_op='asgn
I
obj='Var
pag=5
prev=O1780
var_op='asgn
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1780
fatherSonIndex=0
frm_calc='_numprog
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''1'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
next=Icpitembatch.CPVarDecl
frm_calc='_oldreg
len=8
name='_datareg
obj='Var
obj_type='D
pag=5
prev=O2013
var_op='asgn
I
obj='Var
obj_type='D
pag=5
prev=O2012
var_op='asgn
I
obj='Var
pag=5
prev=O2011
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1780
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("POPERAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''0'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datarett
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0 or Empty(Substr(riga,147,8)),Date(),arfn_datefchar(Substr(riga,147,8)))
len=8
name='_datareg
obj='Var
obj_type='D
pag=5
prev=O2018
var_op='asgn
I
obj='Var
obj_type='D
pag=5
prev=O2017
var_op='asgn
I
obj='Var
pag=5
prev=O2016
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1769
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1772
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Left(riga,8)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2024
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O2029
sel_field='operazbo->IDBASE
sel_name='operazbo
sel_where='operazbo->NUMPROG=_numprog and (operazbo->STATOREG='0'  or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O2030
fatherSonIndex=0
frm_calc='"E' stata cancellata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=5
prev=O2034
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'operazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
'NUMIMP
]
wr_op=[
'=
'=
'=
]
wr_var=[
''2'
'Date()
'_numimp
]
I
nonlocal=True
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
father=O2024
fatherSonIndex=1
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"E' stata variata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O2045
sel_field='operazbo->IDBASE,operazbo->NUMPROG,operazbo->DATAOPE,operazbo->FLAGRAP2,operazbo->IDEREG,operazbo->DATAREG
sel_name='operazbo
sel_where='operazbo->NUMPROG=_numprog and (operazbo->STATOREG='0'  or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2046
fatherSonIndex=0
frm_calc='operazbo->IDBASE
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(operazbo->FLAGRAP2) or operazbo->FLAGRAP2='S',Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(operazbo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='operazbo->IDEREG
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
frm_calc='operazbo->DATAREG
len=8
name='_oldreg
next=Icpitembatch.CPWrite
arch='operazbo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O2059
sel_field='*
sel_name='terzistiope
sel_where='terzistiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='merzistiope
father=O2061
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'IDREG
]
rd_kvar=[
'_oldidb
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O2057
sel_field='*
sel_name='beneficope
sel_where='beneficope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='meneficope
father=O2059
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
'IDREG
]
rd_kvar=[
'_oldidb
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O2055
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mlientiope
father=O2057
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
'PROQUOTA
'IMPSARA
]
rd_kvar=[
'_oldidb
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
'_idreg
'clientiope->PROQUOTA
'clientiope->IMPSARA
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O2054
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mogopebo
father=O2055
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=5
prev=O2053
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'operazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
'FLAGRAP2
'NUMIMP
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
''3'
'iif(Empty(LRTrim(Substr(riga,147,8))),Date(),arfn_datefchar(Substr(riga,147,8)))
'_flagrap2
'_numimp
]
I
obj='Var
obj_type='D
pag=5
prev=O2052
var_op='asgn
I
obj='Var
pag=5
prev=O2051
var_op='asgn
I
obj='Var
pag=5
prev=O2050
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=5
prev=O2044
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1768
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1769
fatherSonIndex=0
frm_calc=[
'w_norifimp='N'
]
h=[
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2098
fatherSonIndex=0
frm_calc=[
'Upper(Substr(riga,331,9))='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2103
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_field='operazbo->NUMPROG
sel_name='operazbo
sel_where='operazbo->INFORM = Substr(riga,424,30) and (operazbo->STATOREG='0' or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2108
fatherSonIndex=0
frm_calc='operazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2103
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=5
sel_field='operazbo->NUMPROG
sel_name='operazbo
sel_where='operazbo->RIFIMP = Substr(riga,331,9) and (operazbo->STATOREG='0' or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2115
fatherSonIndex=0
frm_calc='operazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1767
var_op='asgn
I
obj='Var
pag=5
prev=O1766
var_op='asgn
I
obj='Var
pag=5
prev=O1765
var_op='asgn
I
obj='Var
pag=5
prev=O1764
var_op='asgn
I
obj='Var
pag=5
prev=O1761
var_op='asgn
I
obj='If
pag=5
prev=O1760
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O1761
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=5
prev=O2126
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2127
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+LRTrim(_codintope) +" in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Operazione già presente nelle operazioni.  Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O2133
I
obj='Var
obj_type='N
pag=5
prev=O2132
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,318,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1759
var_op='asgn
I
obj='Remark
pag=5
prev=O1756
I
obj='If
pag=5
prev=O1754
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1756
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,263,30))+LRTrim(Substr(riga,295,6))+LRTrim(Substr(riga,293,2))))
]
h=[
19
19
]
obj='If
pag=5
prev=O2145
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2148
fatherSonIndex=0
frm_calc='LRTrim(Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=5
prev=O2154
var_op='asgn
I
obj='Var
pag=5
prev=O2153
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O2144
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2145
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+LRTrim(_codintope) + " in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(Substr(riga,257,6))+" non è presente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O2160
I
obj='Var
obj_type='N
pag=5
prev=O2159
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O2143
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'Substr(riga,257,6)
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1754
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,246,11))),_codinter,Substr(riga,246,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,263,30))),_citinter,Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,295,6))),_cabinter,Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,293,2))),_prvinter,Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=5
prev=O2172
var_op='asgn
I
obj='Var
pag=5
prev=O2171
var_op='asgn
I
obj='Var
pag=5
prev=O2170
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1749
fatherSonIndex=1
frm_calc='1
len=1
name='_opeerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(ohand,riga+" - "+_descerr)
obj='Exec
pag=5
prev=O2176
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=5
prev=O1744
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1747
fatherSonIndex=0
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Left(riga,8))))
]
h=[
19
19
]
obj='If
pag=5
prev=O2181
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2182
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,190,16))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,206,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,484,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,120,25))) and _findsub = 1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,190,16))) and _findsub = 1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(DateDiff(arfn_datefchar(LRTrim(Left(riga,8))), _date_oggi)>(20*365))  and _findsub = 1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(arfn_datefchar(LRTrim(Left(riga,8)))>_date_oggi) and _findsub = 1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='CODANA+CODVOC+SEGNO
frm_calc='LRTrim(Substr(riga,10,4))+LRTrim(Substr(riga,14,2))+LRTrim(Substr(riga,159,1))
name='_tmp
next=Icpitembatch.CPIfElse
frm_calc=[
'not(mcCauana.HasKey(_tmp)) and _findsub = 1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='""
name='_tmp
obj='Var
pag=5
prev=O2212
var_op='asgn
I
obj='If
pag=5
prev=O2211
sons=[
Icpitembatch.CPItemSon
comment='Causale Analitica o Causale Sintetica o Segno
instr=Icpitembatch.CPVarDecl
father=O2212
fatherSonIndex=0
frm_calc=''Anomalia sui campi Causale Analitica e/o Causale Sintetica e/o Segno'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O2218
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O2208
var_op='asgn
I
obj='If
pag=5
prev=O2205
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Data Operazione maggiore della Data odierna
instr=Icpitembatch.CPVarDecl
father=O2208
fatherSonIndex=0
frm_calc=''Data Operazione maggiore della Data odierna'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O2223
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O2202
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Data Operazione più vecchia di 20 Anni
instr=Icpitembatch.CPVarDecl
father=O2205
fatherSonIndex=0
frm_calc=''Data Operazione più vecchia di 20 Anni'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O2228
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O2199
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Codice Cliente Operazione 
instr=Icpitembatch.CPVarDecl
father=O2202
fatherSonIndex=0
frm_calc=''Codice Cliente Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O2233
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O2196
sons=[
Icpitembatch.CPItemSon
comment='Rapporto continuativo Operazione
instr=Icpitembatch.CPIfElse
father=O2199
fatherSonIndex=0
frm_calc=[
'not(mcRapporti.HasKey(Substr(riga,120,25)))
]
h=[
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2238
fatherSonIndex=0
frm_calc=''Rapporto continuativo:'+ LRTrim(Substr(riga,120,25)) +" dell' Operazione non presente in archivio"
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O2243
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O2193
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Anagrafica Soggetto per conto del quale
instr=Icpitembatch.CPVarDecl
father=O2196
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=5
prev=O2250
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2251
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto per conto del quale assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O2256
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O2249
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,484,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O2190
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Anagrafica Controparte Operazione
instr=Icpitembatch.CPVarDecl
father=O2193
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=5
prev=O2267
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2268
fatherSonIndex=0
frm_calc=''Anagrafica Controparte Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O2273
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O2266
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,302,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O2187
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Anagrafica Soggetto Operante Operazione
instr=Icpitembatch.CPVarDecl
father=O2190
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=5
prev=O2284
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2285
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto Operante Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O2290
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O2283
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,206,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Anagrafica Intestatario Operazione
instr=Icpitembatch.CPVarDecl
father=O2187
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=5
prev=O2301
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2302
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O2307
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O2300
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,190,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1743
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1744
fatherSonIndex=0
frm_calc='" per l'operazione con codice: "+iif(Upper(Substr(riga,331,9))='XXXXXXXXX',LRTrim(Substr(riga,424,30)),LRTrim(Substr(riga,331,9)))
name='_codintope
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1744
fatherSonIndex=1
frm_calc='" per l'operazione"
name='_codintope
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1742
var_op='asgn
I
obj='Var
pag=5
prev=O1741
var_op='asgn
I
obj='Var
obj_type='D
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1736
fatherSonIndex=1
frm_calc='Page_6(riga)
obj='Exec
pag=5
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1717
var_op='asgn
I
obj='Var
pag=5
prev=O1716
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1714
var_op='asgn
I
obj='Begin
pag=5
prev=O1712
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1714
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='""
name='_tmp
obj='Var
pag=5
prev=O2332
var_op='asgn
I
obj='Select
pag=5
prev=O2330
sel_name='QBE_TBCAUANA
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2332
fatherSonIndex=0
frm_seek='mcStringa.MCRDef
name='rwCauana
next=Icpitembatch.CPVarDecl
comment='uso come chiave la concatenazione di: causale_analitica+causale_sintetica+segno    es. "15"+"6S"+"D" = "156SD"
frm_calc='""+LRTrim(QBE_TBCAUANA->CODCAU)+LRTrim(QBE_TBCAUANA->CAUSINT)+LRTrim(QBE_TBCAUANA->SEGNO)
name='_tmp
next=Icpitembatch.CPVarDecl
frm_calc='_tmp
frm_seek='CODICE
name='rwCauana
next=Icpitembatch.CPVarDecl
frm_calc='QBE_TBCAUANA->idbase
frm_seek='ps_rowstatus
name='rwCauana
next=Icpitembatch.CPIfElse
frm_calc=[
'not(mcCauana.HasKey(_tmp))
]
h=[
19
19
]
obj='If
pag=5
prev=O2340
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='MC dei codici Causali Analitiche+Sintetiche+Segno
father=O2341
fatherSonIndex=0
frm_calc='_tmp,rwCauana 
frm_seek='AppendRowWithKey
name='mcCauana
obj='Var
obj_type='MC
pag=5
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='R
pag=5
prev=O2339
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O2338
var_op='prop
I
obj='Var
pag=5
prev=O2337
var_op='asgn
I
obj='Var
obj_type='R
pag=5
var_op='new
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
sel_field='anarapbo->RAPPORTO
sel_name='anarapbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2330
fatherSonIndex=0
frm_seek='mcStringa.MCRDef
name='rwRapporto
next=Icpitembatch.CPVarDecl
frm_calc='anarapbo->RAPPORTO
frm_seek='CODICE
name='rwRapporto
next=Icpitembatch.CPVarDecl
comment='MC dei soli codice Rapporto
frm_calc='LibreriaMit.SpacePad(LRTrim(anarapbo->RAPPORTO),25), rwRapporto
frm_seek='AppendRowWithKey
name='mcRapporti
obj='Var
obj_type='MC
pag=5
prev=O2352
var_op='meth
I
obj='Var
obj_type='R
pag=5
prev=O2351
var_op='prop
I
obj='Var
obj_type='R
pag=5
var_op='new
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
prev=O1711
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1712
fatherSonIndex=0
frm_calc=[
'At("archope",_tabelle)=0
]
h=[
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2358
fatherSonIndex=0
frm_calc='_tabelle+"archope,"
len=10
name='_tabelle
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1710
var_op='asgn
I
obj='Remark
pag=5
x=15
y=15
I
Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+'/'+LRTrim(nomefileimport)
name='fileName
next=Icpitembatch.CPExec
check='page
frm_calc='45
next=Icpitembatch.CPVarDecl
frm_calc='Paths.get(fileName)
name='path
next=Icpitembatch.CPExec
check='man
frm_calc='// Conta le righe del fle﷯righeTot=Files.lines(path,Charset.forName(_charset)).count();
obj='Exec
pag=5
prev=O2368
I
obj='Var
obj_type='O
pag=5
prev=O2367
var_op='asgn
I
obj='Exec
pag=5
prev=O2366
I
obj='Var
pag=5
var_op='asgn
x=1319
y=529
I
Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono state elaborate '+LRTrim(Str(conta,10,0))+' operazioni su '+LRTrim(Str(righeTot,10,0)) + ' del file '+LRTrim(nomefileimport)
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=5
var_op='asgn
x=1189
y=5376
I
Icpitembatch.CPRead
arch='tbcauana
obj='Read
pag=5
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'LRTrim(Substr(riga,10,4))
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
x=607
y=4557
I
Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+'/'+LRTrim(nomefileimport)
name='fileName
next=Icpitembatch.CPExec
check='page
frm_calc='45
next=Icpitembatch.CPVarDecl
frm_calc='Paths.get(fileName)
name='path
next=Icpitembatch.CPExec
check='man
frm_calc='// Conta le righe del fle﷯righeTot=Files.lines(path,Charset.forName(_charset)).count();
obj='Exec
pag=6
prev=O2378
I
obj='Var
obj_type='O
pag=6
prev=O2377
var_op='asgn
I
obj='Exec
pag=6
prev=O2376
I
obj='Var
pag=6
var_op='asgn
x=1491
y=559
I
Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono state elaborate '+LRTrim(Str(conta,10,0))+' frazionate su '+LRTrim(Str(righeTot,10,0)) + ' del file '+nomefileimport
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=6
var_op='asgn
x=1272
y=5161
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPBeginEnd
comment='Gestione storico import
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Rapporti Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Rapporti Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=7
prev=O2394
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=7
prev=O2393
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=7
prev=O2392
var_op='asgn
I
obj='Exec
pag=7
prev=O2391
I
obj='Exec
pag=7
prev=O2390
I
obj='Exec
pag=7
prev=O2388
I
obj='While
pag=7
prev=O2387
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2388
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=7
prev=O2398
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2399
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' rapporti del file '+LRTrim(nomefileimport)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='cFlagLire
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,77,1)='S'
'Substr(riga,77,1)='E'
'Substr(riga,77,1)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='xRapporto
next=Icpitembatch.CPRead
arch='xnarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xRapporto))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=7
prev=O2411
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O2412
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xnarapbo
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='knarapbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=7
prev=O2420
var_op='asgn
I
obj='Insert
pag=7
prev=O2418
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGRAP
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
''P'
'Substr(riga,76,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2420
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=7
prev=O2429
I
obj='Var
obj_type='N
pag=7
prev=O2428
var_op='asgn
I
obj='Exec
pag=7
prev=O2427
I
nonlocal=True
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Insert
pag=7
prev=O2417
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
'AMMONT
'DURAT
'TIPO
'RRAGIO
'RCOMP
'RAREA
'RIMP
'RFREQ
'RTIPO
'NATURA
'SCOPO
'MITIG
'PRGIMPRAP
'RISGLOB
'DATAPROF
'DATAREVPROF
'NUMIMP
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
'ISOAGE
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,94,5)),3))
'Substr(riga,99,5)
'Substr(riga,104,5)
'Substr(riga,109,5)
'Val(Substr(riga,114,3))
'Val(Substr(riga,117,3))
'Val(Substr(riga,120,3))
'Val(Substr(riga,123,3))
'Val(Substr(riga,126,3))
'Val(Substr(riga,129,3))
'Substr(riga,132,50)
'Substr(riga,182,50)
'Val(Substr(riga,298,4))
'nProgImp
'Substr(riga,318,3)
'CharToDate(Substr(riga,306,4)+Substr(riga,304,2)+Substr(riga,302,2))
'CharToDate(Substr(riga,314,4)+Substr(riga,312,2)+Substr(riga,310,2))
'_numimp
'Substr(riga,331,2)
'Substr(riga,333,2)
'Substr(riga,335,2)
'Substr(riga,337,2)
'Substr(riga,339,2)
'fwfn_calc_categoria(Substr(riga,331,2),Substr(riga,333,2),Substr(riga,335,2),Substr(riga,337,2),Substr(riga,339,2))
'Substr(riga,341,3)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2418
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=7
prev=O2438
I
obj='Var
obj_type='N
pag=7
prev=O2437
var_op='asgn
I
obj='Exec
pag=7
prev=O2436
I
nonlocal=True
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='xnarapbo
father=O2412
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='knarapbo
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=7
prev=O2444
var_op='asgn
I
obj='Write
pag=7
prev=O2442
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'DESCRAP
'FLAGRAP
'TIPORAP
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Substr(riga,26,50)
'Substr(riga,76,1)
''P'
]
I
obj='Write
pag=7
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2442
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=7
prev=O2459
I
obj='Var
obj_type='N
pag=7
prev=O2458
var_op='asgn
I
obj='Exec
pag=7
prev=O2457
I
nonlocal=True
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
'AMMONT
'DURAT
'TIPO
'RRAGIO
'RCOMP
'RAREA
'RIMP
'RFREQ
'RTIPO
'NATURA
'SCOPO
'MITIG
'RISGLOB
'DATAPROF
'DATAREVPROF
'NUMIMP
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
'ISOAGE
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,94,5)),3))
'Substr(riga,99,5)
'Substr(riga,104,5)
'Substr(riga,109,5)
'Val(Substr(riga,114,3))
'Val(Substr(riga,117,3))
'Val(Substr(riga,120,3))
'Val(Substr(riga,123,3))
'Val(Substr(riga,126,3))
'Val(Substr(riga,129,3))
'Substr(riga,132,50)
'Substr(riga,182,50)
'Val(Substr(riga,298,4))
'Substr(riga,318,3)
'CharToDate(Substr(riga,306,4)+Substr(riga,304,2)+Substr(riga,302,2))
'CharToDate(Substr(riga,314,4)+Substr(riga,312,2)+Substr(riga,310,2))
'_numimp
'Substr(riga,331,2)
'Substr(riga,333,2)
'Substr(riga,335,2)
'Substr(riga,337,2)
'Substr(riga,339,2)
'fwfn_calc_categoria(Substr(riga,331,2),Substr(riga,333,2),Substr(riga,335,2),Substr(riga,337,2),Substr(riga,339,2))
'Substr(riga,341,3)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=7
prev=O2410
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Left(riga,25)
]
rd_var=[
'xRapporto
]
I
obj='Var
pag=7
prev=O2407
var_op='asgn
I
obj='Case
pag=7
prev=O2406
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2407
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2407
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2407
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2407
fatherSonIndex=3
frm_calc='Substr(riga,77,1)
len=1
name='cFlagLire
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Var
pag=7
prev=O2405
var_op='asgn
I
nonlocal=True
obj='Var
pag=7
prev=O2404
var_op='asgn
I
obj='Var
obj_type='N
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=7
prev=O2386
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=7
prev=O2384
var_op='asgn
I
obj='Begin
pag=7
prev=O2383
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2384
fatherSonIndex=0
frm_calc=[
'At("xnarapbo",_tabelle)=0
]
h=[
19
19
]
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2484
fatherSonIndex=0
frm_calc='_tabelle+"xnarapbo,"
len=10
name='_tabelle
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=7
prev=O2382
var_op='asgn
I
obj='Var
obj_type='N
pag=7
prev=O2381
var_op='asgn
I
obj='Remark
pag=7
x=15
y=15
I
Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+'/'+LRTrim(nomefileimport)
name='fileName
next=Icpitembatch.CPExec
check='page
frm_calc='45
next=Icpitembatch.CPVarDecl
frm_calc='Paths.get(fileName)
name='path
next=Icpitembatch.CPExec
check='man
frm_calc='// Conta le righe del fle﷯righeTot=Files.lines(path,Charset.forName(_charset)).count();
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' rapporti su '+LRTrim(Str(righeTot,10,0)) + ' del file '+nomefileimport
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=7
prev=O2496
var_op='asgn
I
obj='Var
obj_type='N
pag=7
prev=O2495
var_op='asgn
I
obj='Exec
pag=7
prev=O2494
I
obj='Var
obj_type='O
pag=7
prev=O2493
var_op='asgn
I
obj='Exec
pag=7
prev=O2492
I
obj='Var
pag=7
var_op='asgn
x=1522
y=281
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPBeginEnd
comment='Gestione storico import
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Informazione Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O2511
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O2510
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O2509
var_op='asgn
I
obj='Exec
pag=8
prev=O2508
I
obj='Exec
pag=8
prev=O2507
I
obj='Exec
pag=8
prev=O2505
I
obj='While
pag=8
prev=O2504
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2505
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=8
prev=O2515
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O2516
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='cCli1
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,75,16)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,50,16)
len=16
name='xSOCTCon
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xSOCTCon)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono state elaborate '+LRTrim(Str(conta,10,0))+' informazioni del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,46,1)='S'
'Substr(riga,46,1)='E'
'Substr(riga,46,1)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,159,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,36,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPInsert
arch='xapopebo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,219,16)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(cCli1)) and At(Substr(riga,44,2),'|25|39|40|28|41|47|') = 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(xSOCTCon)) and At(Substr(riga,44,2),'|25|39|40|28|41|47|') > 0
]
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
obj='Var
obj_type='N
pag=8
prev=O2562
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O2561
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O2559
var_op='asgn
I
obj='Select
pag=8
prev=O2556
sel_field='rapopebo->DATAOPE,rapopebo->TIPOOPRAP
sel_name='rapopebo
sel_order='rapopebo->DATAOPE
sel_where='rapopebo->RAPPORTO=LRTrim(Substr(riga,9,25)) and (rapopebo->STATOREG='0' or rapopebo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2559
fatherSonIndex=0
frm_calc=[
'At(rapopebo->TIPOOPRAP,'|26|36|38|43|44|46') > 0
'At(rapopebo->TIPOOPRAP,'|23|24|27|33|34|35|43|44|45') > 0
]
h=[
19
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='knarapbo
father=O2566
fatherSonIndex=0
obj='Write
pag=8
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(Substr(riga,9,25))
]
wr_field=[
'DATAFIN
]
wr_op=[
'=
]
wr_var=[
'rapopebo->DATAOPE
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='knarapbo
father=O2566
fatherSonIndex=1
obj='Write
pag=8
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(Substr(riga,9,25))
]
wr_field=[
'DATAINI
]
wr_op=[
'=
]
wr_var=[
'rapopebo->DATAOPE
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=8
prev=O2553
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2556
fatherSonIndex=0
frm_calc=[
'At(Substr(riga,44,2),'|25|39|40') > 0
'At(Substr(riga,44,2),'|28|41|47') > 0
]
h=[
19
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xelegabo
father=O2590
fatherSonIndex=0
h=[
19
19
]
obj='Insert
pag=8
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
'NUMIMP
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'xSOCTCon
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2595
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O2603
I
obj='Var
obj_type='N
pag=8
prev=O2602
var_op='asgn
I
obj='Exec
pag=8
prev=O2601
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xelegabo
father=O2590
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=8
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'xSOCTCon
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2607
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O2616
I
obj='Var
obj_type='N
pag=8
prev=O2615
var_op='asgn
I
obj='Exec
pag=8
prev=O2614
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
'NUMPROG2
'NUMIMP
]
wr_op=[
'=
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
'_numimp
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=8
prev=O2550
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2553
fatherSonIndex=0
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
prev=O2627
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2629
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='xntestbo
h=[
19
19
]
obj='Insert
pag=8
prev=O2634
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
'PRGIMPSOG
'PROQUOTA
'NUMIMP
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
'nProgImp2
'Val(Substr(riga,235,3))
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2635
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O2643
I
obj='Var
obj_type='N
pag=8
prev=O2642
var_op='asgn
I
obj='Exec
pag=8
prev=O2641
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2629
fatherSonIndex=1
frm_calc=[
'Substr(riga,45,1)='6' or Substr(riga,44,2)='38'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xntestbo
father=O2647
fatherSonIndex=0
h=[
19
19
]
obj='Write
pag=8
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'Substr(riga,9,25)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2652
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O2661
I
obj='Var
obj_type='N
pag=8
prev=O2660
var_op='asgn
I
obj='Exec
pag=8
prev=O2659
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
'NUMPROG2
'NUMIMP
]
wr_op=[
'=
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
'_numimp
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xntestbo
father=O2647
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=8
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cCli1
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2668
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O2677
I
obj='Var
obj_type='N
pag=8
prev=O2676
var_op='asgn
I
obj='Exec
pag=8
prev=O2675
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'NUMPROG1
'NUMIMP
]
wr_op=[
'=
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
'_numimp
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=8
prev=O2626
sel_field='*
sel_name='xntestbo
sel_order='xntestbo->CPROWNUM
sel_where='xntestbo->RAPPORTO=Substr(riga,9,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2627
fatherSonIndex=0
frm_calc=[
'xntestbo->CODINTER=cCli1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=8
prev=O2687
var_op='asgn
I
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2687
fatherSonIndex=0
frm_calc='xntestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=8
prev=O2548
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xiduciabo
father=O2550
fatherSonIndex=0
obj='Insert
pag=8
rd_kfield=[
'IDFILEBO
'CODSOG
'NUMCOL
'RAPCOL
'IDBASE
'NUMIMP
]
rd_kvar=[
'cInfProg1
'LRTrim(Substr(riga,219,16))
'cInfProg2
'Substr(riga,9,25)
'LibreriaMit.UniqueId()
'_numimp
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=8
prev=O2547
rd_kfield=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'VALUTA
'CDATREG
'IDBASE2
'NUMIMP
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'_cabinter
'Substr(riga,115,6)
'_intercod
'iif((_dataope < CharToDate('20100601') or _dataope > CharToDate('20131231')),xSOCTCF,'')
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_intercit
'Substr(riga,169,50)
'cFlagLire
'Substr(riga,34,1)
'cInfProg1
''I'+Right(cInfProg2,9)+_idb2
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'iif((_dataope < CharToDate('20100601') or _dataope > CharToDate('20131231')),Substr(riga,35,1),' ')
'Substr(riga,44,2)
'Substr(riga,159,10)
'Substr(riga,47,3)
'DateToChar(_datareg)
'_idb2
'_numimp
]
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2548
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O2709
I
obj='Var
obj_type='N
pag=8
prev=O2708
var_op='asgn
I
obj='Exec
pag=8
prev=O2707
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=8
prev=O2546
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O2545
var_op='asgn
I
obj='Var
pag=8
prev=O2544
var_op='asgn
I
obj='Var
pag=8
prev=O2543
var_op='asgn
I
obj='Var
obj_type='D
pag=8
prev=O2542
var_op='asgn
I
obj='Var
obj_type='D
pag=8
prev=O2539
var_op='asgn
I
obj='If
pag=8
prev=O2538
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xapopebo
father=O2539
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'_unicode<>''
]
h=[
19
19
]
obj='If
pag=8
prev=O2714
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2715
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O2721
I
obj='Var
obj_type='N
pag=8
prev=O2720
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,159,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
prev=O2537
var_op='asgn
I
obj='Remark
pag=8
prev=O2534
I
obj='Case
pag=8
prev=O2533
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2534
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2534
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2534
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2534
fatherSonIndex=3
frm_calc='Substr(riga,46,1)
len=1
name='cFlagLire
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
nonlocal=True
obj='Var
pag=8
prev=O2532
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O2529
var_op='asgn
I
obj='If
pag=8
prev=O2528
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='personbo
father=O2529
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=8
prev=O2741
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O2742
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=8
prev=O2747
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2748
fatherSonIndex=0
frm_calc='xSOCTCon
len=16
name='xSOCTCF
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
prev=O2527
var_op='asgn
I
obj='Var
pag=8
prev=O2524
var_op='asgn
I
obj='If
pag=8
prev=O2523
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2524
fatherSonIndex=0
frm_calc='Substr(riga,75,16)
len=16
name='xConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
obj='If
pag=8
prev=O2768
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O2769
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
obj='If
pag=8
prev=O2774
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2775
fatherSonIndex=0
frm_calc='xConnes
len=16
name='cCli1
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
prev=O2767
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
prev=O2521
var_op='asgn
I
obj='Begin
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2521
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,104,11))),_codinter,Substr(riga,104,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,121,30))),_citinter,Substr(riga,121,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,153,6))),_cabinter,Substr(riga,153,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,151,2))),_prvinter,Substr(riga,151,2))
len=2
name='_interprv
obj='Var
pag=8
prev=O2796
var_op='asgn
I
obj='Var
pag=8
prev=O2795
var_op='asgn
I
obj='Var
pag=8
prev=O2794
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
prev=O2503
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O2502
var_op='asgn
I
obj='Var
pag=8
prev=O2501
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O2499
var_op='asgn
I
obj='Begin
pag=8
prev=O2498
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2499
fatherSonIndex=0
frm_calc=[
'At("archinf",_tabelle)=0
]
h=[
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2803
fatherSonIndex=0
frm_calc='_tabelle+"archinf,"
len=10
name='_tabelle
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=8
x=15
y=15
I
Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+'/'+LRTrim(nomefileimport)
name='fileName
next=Icpitembatch.CPExec
check='page
frm_calc='45
next=Icpitembatch.CPVarDecl
frm_calc='Paths.get(fileName)
name='path
next=Icpitembatch.CPExec
check='man
frm_calc='// Conta le righe del fle﷯righeTot=Files.lines(path,Charset.forName(_charset)).count();
obj='Exec
pag=8
prev=O2813
I
obj='Var
obj_type='O
pag=8
prev=O2812
var_op='asgn
I
obj='Exec
pag=8
prev=O2811
I
obj='Var
pag=8
var_op='asgn
x=1230
y=203
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPBeginEnd
comment='Gestione storico import
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Inizializzazione MC controlli
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','XPERAZBO','Operazioni Inserite: '+LRTrim(Str(cNumNew,10,0)))
obj='Exec
pag=9
prev=O2831
I
nonlocal=True
obj='Var
obj_type='M
pag=9
prev=O2830
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=9
prev=O2829
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=9
prev=O2828
var_op='asgn
I
obj='Exec
pag=9
prev=O2827
I
obj='Exec
pag=9
prev=O2826
I
obj='Exec
pag=9
prev=O2824
I
obj='While
pag=9
prev=O2823
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2824
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono state elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=9
prev=O2836
var_op='asgn
I
obj='If
pag=9
prev=O2835
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2836
fatherSonIndex=0
frm_calc=[
'w_opeunivoco='N' or (w_opeunivoco='S' and arfn_chktotalelire(CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)),_dataeuro,Val(Substr(riga,165,10))/100,"0"))
'w_opeunivoco='S' and not(arfn_chktotalelire(CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)),_dataeuro,Val(Substr(riga,165,10))/100,"0"))
]
h=[
19
19
19
]
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2842
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_oldidb
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgRet='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Upper(Substr(riga,331,9))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
prev=O2855
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O2857
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,257,6))))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,318,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc='_flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,923,1)='S',1,0)
len=1
name='_flgfraud
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,331,9))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog))) and Empty(LRTrim(Left(riga,8)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Left(riga,8)))) 
]
h=[
19
19
]
obj='If
pag=9
prev=O2880
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Prepara i dati comuni
father=O2883
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog)))
'Empty(LRTrim(_numprog))
]
h=[
19
19
19
]
obj='If
pag=9
prev=O2888
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O2890
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=9
prev=O2895
var_op='asgn
I
obj='Write
pag=9
rd_kfield=[
'NUMPROG
]
rd_kop=[
'=
]
rd_kvar=[
'_numprog
]
wr_field=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'idcauana
'IMPIN
'IMPOUT
'INFORM
'IPCOLLEG
'MITIG
'MODSVOL
'NATURA
'OPERAG
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROQUOTA
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'SV58550
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'IMPSARA
'SV58550MA
'NOSARA
'NUMIMP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'LRTrim(Substr(riga,10,4))
'_intercab
'_iccab
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'_colleg
'LRTrim(Substr(riga,484,16))
'LRTrim(Substr(riga,302,16))
'LRTrim(Substr(riga,190,16))
'LRTrim(Substr(riga,206,16))
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_iccit
'_intercit
'_icrag
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'_flagrap2
'cIdCau
'_totin / 100
'_totout / 100
'Substr(riga,424,30)
'Substr(riga,813,15)
'Val(Substr(riga,893,4))
'Substr(riga,414,5)
'Substr(riga,662,50)
'Substr(riga,328,3)
''1'
'iif(Empty(Substr(riga,828,14)) or Substr(riga,828,14)='01010001000000',NullDateTime(),CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6)))
'_icsta
'Substr(riga,812,1)
'nProgImp
'Val(Substr(riga,898,3))
'_icprv
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
''0'
'Substr(riga,897,1)
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'Val(Substr(riga,901,19))/100
'Substr(riga,920,2)
'iif(Empty(LRTrim(Substr(riga,922,1))) or Substr(riga,922,1)='0' or Substr(riga,922,1)='N','N','S')
'_numimp
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2890
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PPOPER1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPInsert
arch='xperazbo
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xperazbo_agg
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=9
prev=O2908
var_op='asgn
I
obj='Insert
pag=9
prev=O2906
rd_kfield=[
'IDBASE
'FLAGFRAUD
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
'SV58724
'SV58726SCA
'SV58726SA
'SV58726PISP
'C_COGNOME
'C_NOME
'SOSPAGAM
]
rd_kvar=[
'cOpeProg1
'_flgfraud
'Substr(riga,924,2)
'Substr(riga,926,2)
'Substr(riga,928,2)
'Substr(riga,930,2)
'Substr(riga,932,2)
'fwfn_calc_categoria(Substr(riga,924,2),Substr(riga,926,2),Substr(riga,928,2),Substr(riga,930,2),Substr(riga,932,2))
'Substr(riga,934,2)
'iif(Empty(Substr(riga,936,1)),'N',Substr(riga,936,1))
'Substr(riga,937,3)
'Substr(riga,940,3)
'Substr(riga,943,50)
'Substr(riga,993,30)
'Substr(riga,1023,1)
]
I
obj='Insert
pag=9
prev=O2905
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
'IMPIN
'IMPOUT
'MITIG
'SV58550
'PROQUOTA
'IMPSARA
'SV58550MA
'NOSARA
'NUMIMP
'VASP
]
rd_kvar=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'LRTrim(Substr(riga,10,4))
'_intercab
'_iccab
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'LRTrim(Substr(riga,484,16))
'LRTrim(Substr(riga,302,16))
'LRTrim(Substr(riga,190,16))
'LRTrim(Substr(riga,206,16))
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_iccit
'_intercit
'_icrag
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'cOpeProg1
'cIdCau
'"O"+Right(cOpeProg2,9)+_idb2
'Substr(riga,424,30)
'Substr(riga,813,15)
'Substr(riga,414,5)
'Substr(riga,662,50)
'cOpeProg2
'Substr(riga,328,3)
''1'
'iif(Empty(Substr(riga,828,14)) or Substr(riga,828,14)='01010001000000',NullDateTime(),CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6)))
'_icsta
'Substr(riga,812,1)
'nProgImp
'_icprv
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
''0'
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'_colleg
'_idb2
'_totin / 100
'_totout / 100
'Val(Substr(riga,893,4))
'Substr(riga,897,1)
'Val(Substr(riga,898,3))
'Val(Substr(riga,901,19))/100
'Substr(riga,920,2)
'iif(Empty(LRTrim(Substr(riga,922,1))) or Substr(riga,922,1)='0' or Substr(riga,922,1)='N','N','S')
'_numimp
'Val(Substr(riga,1024,2))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2906
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=9
prev=O2918
I
obj='Var
obj_type='N
pag=9
prev=O2917
var_op='asgn
I
obj='Exec
pag=9
prev=O2916
I
nonlocal=True
obj='Var
obj_type='M
pag=9
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=9
prev=O2904
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O2888
fatherSonIndex=0
frm_calc=[
'Substr(riga,155,1)='S'
'Substr(riga,155,1)='E'
'Substr(riga,155,1)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,147,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,9,1)='1' or Substr(riga,9,1)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,301,1)),'0',iif(Substr(riga,301,1)='S','1',iif(Substr(riga,301,1)='N','0',Substr(riga,301,1))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,231,11))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,852,19))),0,Val(LRTrim(Substr(riga,852,19))))
len=15
name='_totin
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,871,19))),0,Val(LRTrim(Substr(riga,871,19))))
len=15
name='_totout
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge i dati dell'intermediario controparte
h=[
19
19
]
obj='Begin
pag=9
prev=O2940
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2942
fatherSonIndex=0
frm_calc='''
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=50
name='_icrag
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,18,11)))) and Len(LRTrim(Substr(riga,64,6)+Substr(riga,70,50)+Substr(riga,29,3)+Substr(riga,62,2)+Substr(riga,32,30))) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
prev=O2950
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O2951
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(_icrag),50)
len=50
name='_icrag
obj='Var
pag=9
prev=O2956
var_op='asgn
I
obj='Read
pag=9
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'Substr(riga,18,11)
]
rd_var=[
'_iccab
'_iccit
'_icprv
'_icsta
'_icrag
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2951
fatherSonIndex=1
frm_calc='Substr(riga,64,6)
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,32,30)
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,62,2)
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,29,3))
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,70,50)
len=50
name='_icrag
obj='Var
pag=9
prev=O2966
var_op='asgn
I
obj='Var
pag=9
prev=O2965
var_op='asgn
I
obj='Var
pag=9
prev=O2964
var_op='asgn
I
obj='Var
pag=9
prev=O2963
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=9
prev=O2949
var_op='asgn
I
obj='Var
pag=9
prev=O2948
var_op='asgn
I
obj='Var
pag=9
prev=O2947
var_op='asgn
I
obj='Var
pag=9
prev=O2946
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=9
prev=O2939
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2940
fatherSonIndex=0
frm_calc='Upper(Substr(riga,511,70))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,581,3))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,584,30))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,614,6)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,620,2))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,622,35))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,657,5))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,302,16))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=9
prev=O2982
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2985
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,120,25))))
]
h=[
19
19
]
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2990
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=9
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2995
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=9
prev=O3006
I
obj='Read
pag=9
prev=O3005
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=9
prev=O3004
var_op='asgn
I
obj='Var
pag=9
prev=O3003
var_op='asgn
I
obj='Var
pag=9
prev=O3002
var_op='asgn
I
obj='Var
pag=9
prev=O3001
var_op='asgn
I
obj='Var
pag=9
prev=O3000
var_op='asgn
I
obj='Var
pag=9
prev=O2999
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O2979
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2982
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=9
prev=O3023
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,302,16)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=9
prev=O3022
var_op='asgn
I
obj='Var
pag=9
prev=O3021
var_op='asgn
I
obj='Var
pag=9
prev=O3020
var_op='asgn
I
obj='Var
pag=9
prev=O3019
var_op='asgn
I
obj='Var
pag=9
prev=O3018
var_op='asgn
I
obj='Var
pag=9
prev=O3017
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O2978
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O2979
fatherSonIndex=0
obj='Read
pag=9
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O2977
var_op='asgn
I
obj='Var
pag=9
prev=O2976
var_op='asgn
I
obj='Var
pag=9
prev=O2975
var_op='asgn
I
obj='Var
pag=9
prev=O2974
var_op='asgn
I
obj='Var
pag=9
prev=O2973
var_op='asgn
I
obj='Var
pag=9
prev=O2972
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=9
prev=O2938
var_op='asgn
I
obj='Var
obj_type='N
pag=9
prev=O2937
var_op='asgn
I
obj='Var
obj_type='N
pag=9
prev=O2935
var_op='asgn
I
obj='Select
pag=9
par_expr=[
'LRTrim(Substr(riga,10,4))
'Substr(riga,14,2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O2934
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2935
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O2933
var_op='asgn
I
obj='Var
pag=9
prev=O2932
var_op='asgn
I
obj='Var
pag=9
prev=O2931
var_op='asgn
I
obj='Var
pag=9
prev=O2930
var_op='asgn
I
obj='Var
pag=9
prev=O2929
var_op='asgn
I
obj='Var
obj_type='D
pag=9
prev=O2928
var_op='asgn
I
obj='Var
pag=9
prev=O2927
var_op='asgn
I
obj='Var
pag=9
prev=O2924
var_op='asgn
I
obj='Case
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2924
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2924
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2924
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2924
fatherSonIndex=3
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O2877
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2880
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=9
sel_field='xperazbo->IDBASE
sel_name='xperazbo
sel_where='xperazbo->NUMPROG=_numprog
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O3059
fatherSonIndex=0
frm_calc='"E' stata cancellata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPDelete
arch='xperazbo
obj='Delete
pag=9
prev=O3063
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'xperazbo->IDBASE
]
I
nonlocal=True
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O2876
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2877
fatherSonIndex=0
frm_calc=[
'w_norifimp='N'
]
h=[
19
19
]
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3072
fatherSonIndex=0
frm_calc=[
'Upper(Substr(riga,331,9))='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3077
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=9
sel_field='xperazbo->NUMPROG
sel_name='xperazbo
sel_where='xperazbo->INFORM = Substr(riga,424,30)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3082
fatherSonIndex=0
frm_calc='xperazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3077
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=9
sel_field='xperazbo->NUMPROG
sel_name='xperazbo
sel_where='xperazbo->RIFIMP = Substr(riga,331,9)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3089
fatherSonIndex=0
frm_calc='xperazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O2875
var_op='asgn
I
obj='Var
obj_type='N
pag=9
prev=O2874
var_op='asgn
I
obj='Var
pag=9
prev=O2873
var_op='asgn
I
obj='Var
pag=9
prev=O2872
var_op='asgn
I
obj='Var
pag=9
prev=O2869
var_op='asgn
I
obj='If
pag=9
prev=O2868
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O2869
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=9
prev=O3100
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3101
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Operazione già presente nell'archivio provvisorio. Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=9
prev=O3107
I
obj='Var
obj_type='N
pag=9
prev=O3106
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=9
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,318,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O2867
var_op='asgn
I
obj='Remark
pag=9
prev=O2864
I
obj='If
pag=9
prev=O2862
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2864
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,263,30))+LRTrim(Substr(riga,295,6))+LRTrim(Substr(riga,293,2))))
]
h=[
19
19
]
obj='If
pag=9
prev=O3119
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3122
fatherSonIndex=0
frm_calc='LRTrim(Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=9
prev=O3128
var_op='asgn
I
obj='Var
pag=9
prev=O3127
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O3118
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3119
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+LRTrim(_codintope) + " in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(Substr(riga,257,6))+" non è presente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=9
prev=O3134
I
obj='Var
obj_type='N
pag=9
prev=O3133
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=9
prev=O3117
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'Substr(riga,257,6)
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2862
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,246,11))),_codinter,Substr(riga,246,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,263,30))),_citinter,Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,295,6))),_cabinter,Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,293,2))),_prvinter,Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=9
prev=O3146
var_op='asgn
I
obj='Var
pag=9
prev=O3145
var_op='asgn
I
obj='Var
pag=9
prev=O3144
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2857
fatherSonIndex=1
frm_calc='1
len=1
name='_opeerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(ohand,riga+" - "+_descerr)
obj='Exec
pag=9
prev=O3150
I
obj='Var
obj_type='N
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=9
prev=O2852
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2855
fatherSonIndex=0
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,190,16))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,206,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,484,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,120,25))) and _findsub = 1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,190,16))) and _findsub = 1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(DateDiff(arfn_datefchar(LRTrim(Left(riga,8))), _date_oggi)>(20*365))  and _findsub = 1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(arfn_datefchar(LRTrim(Left(riga,8)))>_date_oggi) and _findsub = 1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='CODANA+CODVOC+SEGNO
frm_calc='LRTrim(Substr(riga,10,4))+LRTrim(Substr(riga,14,2))+LRTrim(Substr(riga,159,1))
name='_tmp
next=Icpitembatch.CPIfElse
frm_calc=[
'not(mcCauana.HasKey(_tmp)) and _findsub = 1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='""
name='_tmp
obj='Var
pag=9
prev=O3182
var_op='asgn
I
obj='If
pag=9
prev=O3181
sons=[
Icpitembatch.CPItemSon
comment='Causale Analitica o Causale Sintetica o Segno
instr=Icpitembatch.CPVarDecl
father=O3182
fatherSonIndex=0
frm_calc=''Anomalia sui campi Causale Analitica e/o Causale Sintetica e/o Segno'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=9
prev=O3188
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O3178
var_op='asgn
I
obj='If
pag=9
prev=O3175
sons=[
Icpitembatch.CPItemSon
comment='Data Operazione maggiore della Data odierna
instr=Icpitembatch.CPVarDecl
father=O3178
fatherSonIndex=0
frm_calc=''Data Operazione maggiore della Data odierna'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=9
prev=O3193
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O3172
sons=[
Icpitembatch.CPItemSon
comment='Data Operazione più vecchia di 20 Anni
instr=Icpitembatch.CPVarDecl
father=O3175
fatherSonIndex=0
frm_calc=''Data Operazione più vecchia di 20 Anni'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=9
prev=O3198
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O3169
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3172
fatherSonIndex=0
frm_calc=''Codice Cliente Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=9
prev=O3203
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O3166
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3169
fatherSonIndex=0
frm_calc=[
'not(mcRapporti.HasKey(Substr(riga,120,25)))
]
h=[
19
19
]
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3208
fatherSonIndex=0
frm_calc=''Rapporto continuativo:'+ LRTrim(Substr(riga,120,25)) +" dell' Operazione non presente in archivio"
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=9
prev=O3213
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O3163
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3166
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=9
prev=O3220
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3221
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto per conto del quale assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=9
prev=O3226
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=9
prev=O3219
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,484,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O3160
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3163
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=9
prev=O3237
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3238
fatherSonIndex=0
frm_calc=''Anagrafica Controparte Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=9
prev=O3243
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=9
prev=O3236
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,302,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O3157
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3160
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=9
prev=O3254
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3255
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto Operante Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=9
prev=O3260
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=9
prev=O3253
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,206,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O3156
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3157
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=9
prev=O3271
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3272
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=9
prev=O3277
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=9
prev=O3270
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,190,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=9
prev=O3155
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O2849
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2852
fatherSonIndex=0
frm_calc='" per l'operazione con codice: "+iif(Upper(Substr(riga,331,9))='XXXXXXXXX',LRTrim(Substr(riga,424,30)),LRTrim(Substr(riga,331,9)))
name='_codintope
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2852
fatherSonIndex=1
frm_calc='" per l'operazione"
name='_codintope
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=9
prev=O2848
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPInsert
arch='xarchope
father=O2849
fatherSonIndex=0
obj='Insert
pag=9
rd_kfield=[
'IDPROG
'DATAOPE
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'CONNESCLI
'CONNESOPER
'CAMBIO
'NUMPROG
'TIPOOPRAP
'TIPOINTER
'CODINTER
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'CONNESBEN
'UNIQUECODE
'AGOPER
'RIFIMP
'ZCPARTE
'RAGIO
'MODSVOL
'AREAGEO
'INFORM
'AMMONT
'DURAT
'TIPO
'RRAGIO
'RCOMP
'RAREA
'RIMP
'RFREQ
'CONNALTRO
'DATAIMP
'RTIPO
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'NATURA
'SCOPO
'C_RAPPORTO
'RAPPORTBEN
'PAGASOGOP
'IPCOLLEG
'ORACOLLEG
'DUCOLLEG
'IMPIN
'IMPOUT
'TIPOORO
'MITIG
'SV58550
'PROQUOTA
'IMPSARA
'SV58550MA
]
rd_kvar=[
'conta
'Substr(riga,1,8)        
'Substr(riga,9,1)        
'LRTrim(Substr(riga,10,4))     
'Substr(riga,14,2)       
'Substr(riga,16,2)       
'Substr(riga,18,11)      
'Substr(riga,29,3)       
'Substr(riga,32,30)      
'Substr(riga,62,2)       
'Substr(riga,64,6)       
'Substr(riga,70,50)      
'Substr(riga,120,25)     
'Substr(riga,145,1)      
'Substr(riga,146,1)      
'Substr(riga,147,8)      
'Substr(riga,155,1)      
'Substr(riga,156,3)      
'Substr(riga,159,1)      
'Substr(riga,160,15)     
'Substr(riga,175,15)     
'Substr(riga,190,16)     
'Substr(riga,206,16)     
'Substr(riga,222,9)      
'Substr(riga,231,11)     
'Substr(riga,242,2)      
'Substr(riga,244,2)      
'Substr(riga,246,11)     
'Substr(riga,257,6)      
'Substr(riga,263,30)     
'Substr(riga,293,2)      
'Substr(riga,295,6)      
'Substr(riga,301,1)      
'Substr(riga,302,16)     
'Substr(riga,318,10)     
'Substr(riga,328,3)      
'Substr(riga,331,9)      
'Substr(riga,340,69)     
'Substr(riga,409,5)      
'Substr(riga,414,5)      
'Substr(riga,419,5)      
'Substr(riga,424,30)     
'Substr(riga,454,5)      
'Substr(riga,459,5)      
'Substr(riga,464,5)      
'Substr(riga,469,3)      
'Substr(riga,472,3)      
'Substr(riga,475,3)      
'Substr(riga,478,3)      
'Substr(riga,481,3)      
'Substr(riga,484,16)     
'Substr(riga,500,8)      
'Substr(riga,508,3)      
'Substr(riga,511,70)     
'Substr(riga,581,3)      
'Substr(riga,584,30)     
'Substr(riga,614,6)      
'Substr(riga,620,2)      
'Substr(riga,622,35)     
'Substr(riga,657,5)      
'Substr(riga,662,50)     
'Substr(riga,712,50)     
'Substr(riga,762,25)     
'Substr(riga,787,25)     
'Substr(riga,812,1)      
'Substr(riga,813,15)     
'Substr(riga,828,14)     
'Substr(riga,842,10)     
'Val(Substr(riga,852,19)) / 100
'Val(Substr(riga,871,19)) / 100
'Substr(riga,890,3)
'Val(Substr(riga,893,4))
'Substr(riga,897,1)
'Val(Substr(riga,898,3))
'Val(Substr(riga,901,19))/100
'Substr(riga,920,2)
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O2847
var_op='asgn
I
obj='Var
obj_type='N
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O2842
fatherSonIndex=1
frm_calc='Page_10(riga)
obj='Exec
pag=9
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=9
prev=O2822
var_op='asgn
I
obj='Var
pag=9
prev=O2821
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=9
prev=O2819
var_op='asgn
I
obj='Begin
pag=9
prev=O2817
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2819
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='""
name='_tmp
obj='Var
pag=9
prev=O3311
var_op='asgn
I
obj='Select
pag=9
prev=O3309
sel_name='QBE_TBCAUANA
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3311
fatherSonIndex=0
frm_seek='mcStringa.MCRDef
name='rwCauana
next=Icpitembatch.CPVarDecl
comment='uso come chiave la concatenazione di: causale_analitica+causale_sintetica+segno    es. "15"+"6S"+"D" = "156SD"
frm_calc='""+LRTrim(QBE_TBCAUANA->CODCAU)+LRTrim(QBE_TBCAUANA->CAUSINT)+LRTrim(QBE_TBCAUANA->SEGNO)
name='_tmp
next=Icpitembatch.CPVarDecl
frm_calc='_tmp
frm_seek='CODICE
name='rwCauana
next=Icpitembatch.CPVarDecl
frm_calc='QBE_TBCAUANA->idbase
frm_seek='ps_rowstatus
name='rwCauana
next=Icpitembatch.CPIfElse
frm_calc=[
'not(mcCauana.HasKey(_tmp))
]
h=[
19
19
]
obj='If
pag=9
prev=O3319
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='MC dei codici Causali Analitiche+Sintetiche+Segno
father=O3320
fatherSonIndex=0
frm_calc='_tmp,rwCauana 
frm_seek='AppendRowWithKey
name='mcCauana
obj='Var
obj_type='MC
pag=9
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='R
pag=9
prev=O3318
var_op='prop
I
obj='Var
obj_type='R
pag=9
prev=O3317
var_op='prop
I
obj='Var
pag=9
prev=O3316
var_op='asgn
I
obj='Var
obj_type='R
pag=9
var_op='new
I
I
]
w=[
150
150
]
I
obj='Select
pag=9
prev=O3307
sel_field='xnarapbo->RAPPORTO
sel_name='xnarapbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3309
fatherSonIndex=0
frm_calc=[
'not(mcRapporti.HasKey(LibreriaMit.SpacePad(LRTrim(xnarapbo->RAPPORTO),25)))
]
h=[
19
19
]
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3330
fatherSonIndex=0
frm_seek='mcStringa.MCRDef
name='rwRapporto
next=Icpitembatch.CPVarDecl
frm_calc='xnarapbo->RAPPORTO
frm_seek='CODICE
name='rwRapporto
next=Icpitembatch.CPVarDecl
comment='MC dei soli codice Rapporto
frm_calc='LibreriaMit.SpacePad(LRTrim(xnarapbo->RAPPORTO),25), rwRapporto
frm_seek='AppendRowWithKey
name='mcRapporti
obj='Var
obj_type='MC
pag=9
prev=O3336
var_op='meth
I
obj='Var
obj_type='R
pag=9
prev=O3335
var_op='prop
I
obj='Var
obj_type='R
pag=9
var_op='new
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=9
prev=O3305
sel_field='anarapbo->RAPPORTO
sel_name='anarapbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3307
fatherSonIndex=0
frm_calc=[
'not(mcRapporti.HasKey(LibreriaMit.SpacePad(LRTrim(anarapbo->RAPPORTO),25)))
]
h=[
19
19
]
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3342
fatherSonIndex=0
frm_seek='mcStringa.MCRDef
name='rwRapporto
next=Icpitembatch.CPVarDecl
frm_calc='anarapbo->RAPPORTO
frm_seek='CODICE
name='rwRapporto
next=Icpitembatch.CPVarDecl
comment='MC dei soli codice Rapporto
frm_calc='LibreriaMit.SpacePad(LRTrim(anarapbo->RAPPORTO),25), rwRapporto
frm_seek='AppendRowWithKey
name='mcRapporti
obj='Var
obj_type='MC
pag=9
prev=O3348
var_op='meth
I
obj='Var
obj_type='R
pag=9
prev=O3347
var_op='prop
I
obj='Var
obj_type='R
pag=9
var_op='new
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=9
sel_field='knarapbo->RAPPORTO
sel_name='knarapbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3305
fatherSonIndex=0
frm_seek='mcStringa.MCRDef
name='rwRapporto
next=Icpitembatch.CPVarDecl
frm_calc='knarapbo->RAPPORTO
frm_seek='CODICE
name='rwRapporto
next=Icpitembatch.CPVarDecl
comment='MC dei soli codice Rapporto
frm_calc='LibreriaMit.SpacePad(LRTrim(knarapbo->RAPPORTO),25), rwRapporto
frm_seek='AppendRowWithKey
name='mcRapporti
obj='Var
obj_type='MC
pag=9
prev=O3355
var_op='meth
I
obj='Var
obj_type='R
pag=9
prev=O3354
var_op='prop
I
obj='Var
obj_type='R
pag=9
var_op='new
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=9
prev=O2816
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2817
fatherSonIndex=0
frm_calc=[
'At("archope",_tabelle)=0
]
h=[
19
19
]
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3361
fatherSonIndex=0
frm_calc='_tabelle+"archope,"
len=10
name='_tabelle
obj='Var
obj_type='M
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=9
prev=O2815
var_op='asgn
I
obj='Remark
pag=9
x=15
y=15
I
Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono state elaborate '+LRTrim(Str(conta,10,0))+' operazioni su '+LRTrim(Str(righeTot,10,0)) + ' del file '+LRTrim(nomefileimport)
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=9
var_op='asgn
x=1177
y=6208
I
Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+'/'+LRTrim(nomefileimport)
name='fileName
next=Icpitembatch.CPExec
check='page
frm_calc='45
next=Icpitembatch.CPVarDecl
frm_calc='Paths.get(fileName)
name='path
next=Icpitembatch.CPExec
check='man
frm_calc='// Conta le righe del fle﷯System.out.println(Charset.availableCharsets());﷯righeTot=Files.lines(path,Charset.forName(_charset)).count();
obj='Exec
pag=9
prev=O3372
I
obj='Var
obj_type='O
pag=9
prev=O3371
var_op='asgn
I
obj='Exec
pag=9
prev=O3370
I
obj='Var
pag=9
var_op='asgn
x=1166
y=1146
I
Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+'/'+LRTrim(nomefileimport)
name='fileName
next=Icpitembatch.CPExec
check='page
frm_calc='45
next=Icpitembatch.CPVarDecl
frm_calc='Paths.get(fileName)
name='path
next=Icpitembatch.CPExec
check='man
frm_calc='// Conta le righe del fle﷯righeTot=Files.lines(path,Charset.forName(_charset)).count();
obj='Exec
pag=10
prev=O3376
I
obj='Var
obj_type='O
pag=10
prev=O3375
var_op='asgn
I
obj='Exec
pag=10
prev=O3374
I
obj='Var
pag=10
var_op='asgn
x=1168
y=1113
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Rapporti AGE Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Rapporti AGE Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=11
prev=O3390
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=11
prev=O3389
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=11
prev=O3388
var_op='asgn
I
obj='Exec
pag=11
prev=O3387
I
obj='Exec
pag=11
prev=O3386
I
obj='Exec
pag=11
prev=O3384
I
obj='While
pag=11
prev=O3383
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3384
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='cFlagLire
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,77,1)='S'
'Substr(riga,77,1)='E'
'Substr(riga,77,1)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='xRapporto
next=Icpitembatch.CPRead
arch='jnarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xRapporto))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=11
prev=O3400
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O3401
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPRAPAGE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='jnarapbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,83,1)<>'1'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=11
prev=O3409
var_op='asgn
I
obj='If
pag=11
prev=O3407
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3409
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PROGAET\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aetesta
h=[
19
19
]
obj='Insert
pag=11
prev=O3415
rd_kfield=[
'RAPPORTO
'TIPOAG
'COINT
'DESCRI
'VALUTA
'PROGAET
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,81,2)
'iif(Substr(riga,76,1)='1','1','2')
'iif(Substr(riga,81,2)='99',Upper(Substr(riga,26,24)),'')
'Substr(riga,78,3)
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3416
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file RAPAGE.TXT
obj='Transaction
pag=11
prev=O3422
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=11
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=11
prev=O3406
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
'PRGIMPRAP
'ISOAGE
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,94,5)),3))
'nProgImp
'Substr(riga,341,3)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3407
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file RAPAGE.TXT
obj='Transaction
pag=11
prev=O3430
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='jnarapbo
father=O3401
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,83,1)<>'1'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=11
prev=O3436
var_op='asgn
I
obj='If
pag=11
prev=O3434
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aetesta
father=O3436
fatherSonIndex=0
h=[
19
19
]
obj='Write
pag=11
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3442
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file RAPAGE.TXT
obj='Transaction
pag=11
prev=O3449
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'TIPOAG
'COINT
'DESCRI
'VALUTA
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,81,2)
'iif(Substr(riga,76,1)='1','1','2')
'iif(Substr(riga,81,2)='99',Upper(Substr(riga,26,24)),'')
'Substr(riga,78,3)
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=11
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3434
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file RAPAGE.TXT
obj='Transaction
pag=11
prev=O3461
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
'ISOAGE
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,94,5)),3))
'Substr(riga,341,3)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=11
prev=O3399
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Left(riga,25)
]
rd_var=[
'xRapporto
]
I
obj='Var
pag=11
prev=O3396
var_op='asgn
I
obj='Case
pag=11
prev=O3395
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3396
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3396
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3396
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3396
fatherSonIndex=3
frm_calc='Substr(riga,77,1)
len=1
name='cFlagLire
obj='Var
pag=11
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Var
pag=11
prev=O3394
var_op='asgn
I
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=11
prev=O3382
var_op='asgn
I
obj='Var
pag=11
prev=O3381
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=11
prev=O3380
var_op='asgn
I
obj='Var
obj_type='N
pag=11
prev=O3379
var_op='asgn
I
obj='Var
obj_type='N
pag=11
prev=O3378
var_op='asgn
I
obj='Remark
pag=11
x=15
y=15
I
Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+'/'+LRTrim(nomefileimport)
name='fileName
next=Icpitembatch.CPExec
check='page
frm_calc='45
next=Icpitembatch.CPVarDecl
frm_calc='Paths.get(fileName)
name='path
next=Icpitembatch.CPExec
check='man
frm_calc='// Conta le righe del fle﷯righeTot=Files.lines(path,Charset.forName(_charset)).count();
obj='Exec
pag=11
prev=O3485
I
obj='Var
obj_type='O
pag=11
prev=O3484
var_op='asgn
I
obj='Exec
pag=11
prev=O3483
I
obj='Var
pag=11
var_op='asgn
x=1298
y=155
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Informazione Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O3498
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O3497
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O3496
var_op='asgn
I
obj='Exec
pag=12
prev=O3495
I
obj='Exec
pag=12
prev=O3494
I
obj='Exec
pag=12
prev=O3492
I
obj='While
pag=12
prev=O3491
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3492
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPBeginEnd
comment='Dati intermediario
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,75,16)
len=16
name='xConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,50,16)
len=16
name='xSOCTCon
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xSOCTCon)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono state elaborate '+LRTrim(Str(conta,10,0))+' informazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,46,1)='S'
'Substr(riga,46,1)='E'
'Substr(riga,46,1)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPRemark
frm_calc='Da sentire Bruno sembra che l'importazione dei soggetti operanti in agenzia delle entrate non sia più attiva.﷯Ma sul tracciato c'è ancora.
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,36,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,159,10)),Utilities.GetAutonumber("PRGINFAGE1\'"+LRTrim(gAzienda)+"'",'',10),Substr(riga,159,10))
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFAGE2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINFAGE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='japopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=12
prev=O3530
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3532
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOGAGE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='jntestbo
h=[
19
19
]
obj='Insert
pag=12
prev=O3537
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3538
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file INFAGE.TXT
obj='Transaction
pag=12
prev=O3544
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3532
fatherSonIndex=1
frm_calc=[
'Substr(riga,44,2)='23'
'Substr(riga,44,2)='26'
]
h=[
19
19
19
]
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='jntestbo
father=O3548
fatherSonIndex=0
h=[
19
19
]
obj='Write
pag=12
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cNumMod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3553
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file INFAGE.TXT
obj='Transaction
pag=12
prev=O3560
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'NUMPROG1
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='jntestbo
father=O3548
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=12
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'Substr(riga,9,25)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3567
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file INFAGE.TXT
obj='Transaction
pag=12
prev=O3574
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=12
prev=O3529
sel_field='*
sel_name='jntestbo
sel_order='jntestbo->CPROWNUM
sel_where='jntestbo->RAPPORTO=Substr(riga,9,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3530
fatherSonIndex=0
frm_calc=[
'jntestbo->CODINTER=cCli1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=12
prev=O3584
var_op='asgn
I
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3584
fatherSonIndex=0
frm_calc='jntestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
prev=O3528
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O3527
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O3525
var_op='asgn
I
obj='Insert
pag=12
prev=O3524
rd_kfield=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'VALUTA
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'_intercab
'Substr(riga,115,6)
'_intercod
'xSOCTCF
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_intercit
'Substr(riga,169,50)
'cFlagLire
'Substr(riga,34,1)
'cInfProg1
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)+"J"+LibreriaMit.UniqueId()+"X"
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,47,3)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3525
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file INFAGE.TXT
obj='Transaction
pag=12
prev=O3597
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
prev=O3523
var_op='asgn
I
obj='Var
pag=12
prev=O3522
var_op='asgn
I
obj='Var
pag=12
prev=O3521
var_op='asgn
I
obj='Var
obj_type='D
pag=12
prev=O3520
var_op='asgn
I
obj='Remark
pag=12
prev=O3517
I
obj='Case
pag=12
prev=O3516
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3517
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3517
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3517
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3517
fatherSonIndex=3
frm_calc='Substr(riga,46,1)
len=1
name='cFlagLire
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O3515
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O3512
var_op='asgn
I
obj='If
pag=12
prev=O3511
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O3512
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=12
prev=O3612
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O3613
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=12
prev=O3618
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3619
fatherSonIndex=0
frm_calc='xSOCTCon
len=16
name='xSOCTCF
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=12
prev=O3510
var_op='asgn
I
obj='Var
pag=12
prev=O3507
var_op='asgn
I
obj='If
pag=12
prev=O3506
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O3507
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
obj='If
pag=12
prev=O3638
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3639
fatherSonIndex=0
frm_calc='xConnes
len=16
name='cCli1
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
prev=O3505
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
obj='Var
pag=12
prev=O3503
var_op='asgn
I
obj='Begin
pag=12
prev=O3502
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3503
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,104,11))),_codinter,Substr(riga,104,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,121,30))),_citinter,Substr(riga,121,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,153,6))),_cabinter,Substr(riga,153,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,151,2))),_prvinter,Substr(riga,151,2))
len=2
name='_interprv
obj='Var
pag=12
prev=O3659
var_op='asgn
I
obj='Var
pag=12
prev=O3658
var_op='asgn
I
obj='Var
pag=12
prev=O3657
var_op='asgn
I
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
prev=O3490
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O3489
var_op='asgn
I
obj='Var
pag=12
prev=O3488
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O3487
var_op='asgn
I
obj='Remark
pag=12
x=15
y=15
I
Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+'/'+LRTrim(nomefileimport)
name='fileName
next=Icpitembatch.CPExec
check='page
frm_calc='45
next=Icpitembatch.CPVarDecl
frm_calc='Paths.get(fileName)
name='path
next=Icpitembatch.CPExec
check='man
frm_calc='// Conta le righe del fle﷯righeTot=Files.lines(path,Charset.forName(_charset)).count();
obj='Exec
pag=12
prev=O3665
I
obj='Var
obj_type='O
pag=12
prev=O3664
var_op='asgn
I
obj='Exec
pag=12
prev=O3663
I
obj='Var
pag=12
var_op='asgn
x=1096
y=120
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni AGE Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','JPERAZBO','Operazioni AGE Inserite: '+LRTrim(Str(cNumNew,10,0)))
obj='Exec
pag=13
prev=O3680
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O3679
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O3678
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O3677
var_op='asgn
I
obj='Exec
pag=13
prev=O3676
I
obj='Exec
pag=13
prev=O3675
I
obj='Exec
pag=13
prev=O3673
I
obj='While
pag=13
prev=O3672
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3673
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=13
prev=O3684
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
father=O3685
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
prev=O3690
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O3692
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,257,6))))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,318,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc='_flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,331,9))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))) or (Empty(LRTrim(_numprog)) and not(Empty(LRTrim(Left(riga,8)))))
]
h=[
19
19
]
obj='If
pag=13
prev=O3714
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3717
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,318,10)),Utilities.GetAutonumber("POPERAGE1\'"+LRTrim(gAzienda)+"'",'',10),Substr(riga,318,10))
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,155,1)='S'
'Substr(riga,155,1)='E'
'Substr(riga,155,1)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,147,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,9,1)='1' or Substr(riga,9,1)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,301,1)),'0',iif(Substr(riga,301,1)='S','1',iif(Substr(riga,301,1)='N','0',Substr(riga,301,1))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,231,11))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPEAGE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono state elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,852,19))),0,Val(LRTrim(Substr(riga,852,19))))
len=15
name='_totin
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,871,19))),0,Val(LRTrim(Substr(riga,871,19))))
len=15
name='_totout
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge i dati dell'intermediario controparte
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='jperazbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=13
prev=O3747
var_op='asgn
I
obj='Insert
pag=13
prev=O3745
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
'IMPIN
'IMPOUT
]
rd_kvar=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'LRTrim(Substr(riga,10,4))
'_intercab
'_iccab
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'Substr(riga,484,16)
'Substr(riga,302,16)
'Substr(riga,190,16)
'Substr(riga,206,16)
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_datarett
'_iccit
'_intercit
'_icrag
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'_flagrap2
'cOpeProg1
'cIdCau
'"O"+Right(cOpeProg2,9)+_idb2
'Substr(riga,424,30)
'Substr(riga,813,15)
'Substr(riga,414,5)
'Substr(riga,662,50)
'cOpeProg2
'Substr(riga,328,3)
'_idreg
''1'
'iif(Empty(Substr(riga,828,14)) or Substr(riga,828,14)='01010001000000',NullDateTime(),CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6)))
'_icsta
'Substr(riga,812,1)
'nProgImp
'_icprv
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
'_statoreg
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'_colleg
'_idb2
'_totin / 100
'_totout / 100
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3747
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file OPEAGE.TXT
obj='Transaction
pag=13
prev=O3755
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O3754
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Begin
pag=13
prev=O3743
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3745
fatherSonIndex=0
frm_calc='''
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=50
name='_icrag
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,18,11)))) and Len(LRTrim(Substr(riga,64,6)+Substr(riga,70,50)+Substr(riga,29,3)+Substr(riga,62,2)+Substr(riga,32,30))) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
prev=O3764
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O3765
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(_icrag),50)
len=50
name='_icrag
obj='Var
pag=13
prev=O3770
var_op='asgn
I
obj='Read
pag=13
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'Substr(riga,18,11)
]
rd_var=[
'_iccab
'_iccit
'_icprv
'_icsta
'_icrag
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3765
fatherSonIndex=1
frm_calc='Substr(riga,64,6)
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,32,30)
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,62,2)
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,29,3))
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,70,50)
len=50
name='_icrag
obj='Var
pag=13
prev=O3780
var_op='asgn
I
obj='Var
pag=13
prev=O3779
var_op='asgn
I
obj='Var
pag=13
prev=O3778
var_op='asgn
I
obj='Var
pag=13
prev=O3777
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=13
prev=O3763
var_op='asgn
I
obj='Var
pag=13
prev=O3762
var_op='asgn
I
obj='Var
pag=13
prev=O3761
var_op='asgn
I
obj='Var
pag=13
prev=O3760
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=13
prev=O3742
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3743
fatherSonIndex=0
frm_calc='Upper(Substr(riga,511,70))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,581,3))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,584,30))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,614,6)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,620,2))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,622,35))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,657,5))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,302,16))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=13
prev=O3796
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3799
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,120,25))))
]
h=[
19
19
]
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3804
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=13
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3809
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=13
prev=O3820
I
obj='Read
pag=13
prev=O3819
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=13
prev=O3818
var_op='asgn
I
obj='Var
pag=13
prev=O3817
var_op='asgn
I
obj='Var
pag=13
prev=O3816
var_op='asgn
I
obj='Var
pag=13
prev=O3815
var_op='asgn
I
obj='Var
pag=13
prev=O3814
var_op='asgn
I
obj='Var
pag=13
prev=O3813
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O3793
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3796
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=13
prev=O3837
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,302,16)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=13
prev=O3836
var_op='asgn
I
obj='Var
pag=13
prev=O3835
var_op='asgn
I
obj='Var
pag=13
prev=O3834
var_op='asgn
I
obj='Var
pag=13
prev=O3833
var_op='asgn
I
obj='Var
pag=13
prev=O3832
var_op='asgn
I
obj='Var
pag=13
prev=O3831
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O3792
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O3793
fatherSonIndex=0
obj='Read
pag=13
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
prev=O3791
var_op='asgn
I
obj='Var
pag=13
prev=O3790
var_op='asgn
I
obj='Var
pag=13
prev=O3789
var_op='asgn
I
obj='Var
pag=13
prev=O3788
var_op='asgn
I
obj='Var
pag=13
prev=O3787
var_op='asgn
I
obj='Var
pag=13
prev=O3786
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=13
prev=O3741
var_op='asgn
I
obj='Var
obj_type='N
pag=13
prev=O3740
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O3739
var_op='asgn
I
obj='Var
obj_type='N
pag=13
prev=O3738
var_op='asgn
I
obj='Var
obj_type='N
pag=13
prev=O3736
var_op='asgn
I
obj='Select
pag=13
par_expr=[
'LRTrim(Substr(riga,10,4))
'Substr(riga,14,2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O3735
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3736
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
prev=O3734
var_op='asgn
I
obj='Var
pag=13
prev=O3733
var_op='asgn
I
obj='Var
pag=13
prev=O3732
var_op='asgn
I
obj='Var
pag=13
prev=O3731
var_op='asgn
I
obj='Var
pag=13
prev=O3730
var_op='asgn
I
obj='Var
obj_type='D
pag=13
prev=O3727
var_op='asgn
I
obj='Case
pag=13
prev=O3726
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3727
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3727
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3727
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3727
fatherSonIndex=3
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Var
pag=13
prev=O3725
var_op='asgn
I
obj='Var
pag=13
prev=O3722
var_op='asgn
I
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3722
fatherSonIndex=0
frm_calc='_numprog
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''1'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
obj='Var
obj_type='D
pag=13
prev=O3872
var_op='asgn
I
obj='Var
pag=13
prev=O3871
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3722
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("POPERAGE2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''0'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datarett
obj='Var
obj_type='D
pag=13
prev=O3876
var_op='asgn
I
obj='Var
pag=13
prev=O3875
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O3711
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3714
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Left(riga,8)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3882
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=13
prev=O3887
sel_field='jperazbo->IDBASE
sel_name='jperazbo
sel_where='jperazbo->NUMPROG=_numprog and (jperazbo->STATOREG='0'  or jperazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O3888
fatherSonIndex=0
frm_calc='"E' stata cancellata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='jperazbo
h=[
19
19
]
obj='Write
pag=13
prev=O3892
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'jperazbo->IDBASE
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3893
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file OPEAGE.TXT
obj='Transaction
pag=13
prev=O3900
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=13
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
]
wr_var=[
''2'
'Date()
]
I
nonlocal=True
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
father=O3882
fatherSonIndex=1
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"E' stata variata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=13
prev=O3909
sel_field='jperazbo->IDBASE,jperazbo->NUMPROG,jperazbo->DATAOPE,jperazbo->FLAGRAP2
sel_name='jperazbo
sel_where='jperazbo->NUMPROG=_numprog and (jperazbo->STATOREG='0'  or jperazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3910
fatherSonIndex=0
frm_calc='jperazbo->IDBASE
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(jperazbo->FLAGRAP2) or jperazbo->FLAGRAP2='S',Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(jperazbo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='jperazbo->IDEREG
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='jperazbo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=13
prev=O3922
sel_field='*
sel_name='terzistiope
sel_where='terzistiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='merzistiope
father=O3924
fatherSonIndex=0
obj='Insert
pag=13
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'IDREG
]
rd_kvar=[
'_oldidb
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=13
prev=O3920
sel_field='*
sel_name='beneficope
sel_where='beneficope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='meneficope
father=O3922
fatherSonIndex=0
obj='Insert
pag=13
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
'IDREG
]
rd_kvar=[
'_oldidb
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=13
prev=O3918
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mlientiope
father=O3920
fatherSonIndex=0
obj='Insert
pag=13
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=13
prev=O3917
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mogopebo
father=O3918
fatherSonIndex=0
obj='Insert
pag=13
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=13
prev=O3916
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'jperazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
'FLAGRAP2
]
wr_op=[
'=
'=
'=
]
wr_var=[
''3'
'Date()
'_flagrap2
]
I
obj='Var
pag=13
prev=O3915
var_op='asgn
I
obj='Var
pag=13
prev=O3914
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=13
prev=O3908
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O3710
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3711
fatherSonIndex=0
frm_calc=[
'Upper(Substr(riga,331,9))='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3961
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=13
sel_field='jperazbo->NUMPROG
sel_name='jperazbo
sel_where='jperazbo->INFORM = Substr(riga,424,30) and (jperazbo->STATOREG='0' or jperazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3966
fatherSonIndex=0
frm_calc='jperazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3961
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=13
sel_field='jperazbo->NUMPROG
sel_name='jperazbo
sel_where='jperazbo->RIFIMP = Substr(riga,331,9) and (jperazbo->STATOREG='0' or jperazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3973
fatherSonIndex=0
frm_calc='jperazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
prev=O3709
var_op='asgn
I
obj='Var
pag=13
prev=O3708
var_op='asgn
I
obj='Var
pag=13
prev=O3707
var_op='asgn
I
obj='Var
pag=13
prev=O3704
var_op='asgn
I
obj='If
pag=13
prev=O3703
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='jperazbo
father=O3704
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=13
prev=O3983
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3984
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file OPEAGE.TXT
obj='Transaction
pag=13
prev=O3989
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,318,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
prev=O3702
var_op='asgn
I
obj='Remark
pag=13
prev=O3699
I
obj='If
pag=13
prev=O3697
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3699
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,263,30))+LRTrim(Substr(riga,295,6))+LRTrim(Substr(riga,293,2))))
]
h=[
19
19
]
obj='If
pag=13
prev=O4001
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4004
fatherSonIndex=0
frm_calc='LRTrim(Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=13
prev=O4010
var_op='asgn
I
obj='Var
pag=13
prev=O4009
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4000
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4001
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(Substr(riga,257,6))+" non è presente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file OPEAGE.TXT
obj='Transaction
pag=13
prev=O4015
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
prev=O3999
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'Substr(riga,257,6)
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=13
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3697
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,246,11))),_codinter,Substr(riga,246,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,263,30))),_citinter,Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,295,6))),_cabinter,Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,293,2))),_prvinter,Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=13
prev=O4027
var_op='asgn
I
obj='Var
pag=13
prev=O4026
var_op='asgn
I
obj='Var
pag=13
prev=O4025
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3692
fatherSonIndex=1
frm_calc='1
len=1
name='_opeerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(ohand,riga+" - "+_descerr)
obj='Exec
pag=13
prev=O4031
I
obj='Var
obj_type='N
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=13
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3690
fatherSonIndex=0
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,190,16))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,206,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,484,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,190,16))) and Empty(LRTrim(Substr(riga,120,25))) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=13
prev=O4047
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4050
fatherSonIndex=0
frm_calc=''Rapporto continuativo o Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=13
prev=O4055
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4044
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4047
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=13
prev=O4061
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4062
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto per conto del quale assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=13
prev=O4067
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
prev=O4060
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,484,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4041
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4044
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=13
prev=O4078
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4079
fatherSonIndex=0
frm_calc=''Anagrafica Controparte Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=13
prev=O4084
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
prev=O4077
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,302,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4038
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4041
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=13
prev=O4095
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4096
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto Operante Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=13
prev=O4101
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
prev=O4094
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,206,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4037
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4038
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=13
prev=O4112
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4113
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=13
prev=O4118
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
prev=O4111
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,190,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=13
prev=O4036
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=13
prev=O3671
var_op='asgn
I
obj='Var
pag=13
prev=O3670
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O3669
var_op='asgn
I
obj='Var
obj_type='N
pag=13
prev=O3668
var_op='asgn
I
obj='Var
pag=13
pagelocal=True
prev=O3667
I
obj='Remark
pag=13
x=15
y=15
I
Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+'/'+LRTrim(nomefileimport)
name='fileName
next=Icpitembatch.CPExec
check='page
frm_calc='45
next=Icpitembatch.CPVarDecl
frm_calc='Paths.get(fileName)
name='path
next=Icpitembatch.CPExec
check='man
frm_calc='// Conta le righe del fle﷯righeTot=Files.lines(path,Charset.forName(_charset)).count();
obj='Exec
pag=13
prev=O4131
I
obj='Var
obj_type='O
pag=13
prev=O4130
var_op='asgn
I
obj='Exec
pag=13
prev=O4129
I
obj='Var
pag=13
var_op='asgn
x=1288
y=161
I
Icpitembatch.CPRead
arch='tbcauana
obj='Read
pag=13
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'LRTrim(Substr(riga,10,4))
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
x=522
y=720
I
Icpitembatch.CPRemark
frm_calc='Import Dipendenze
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumNew <> 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','ANADIP','Dipendenze Inserite: '+LRTrim(Str(cNumNew,10,0)) + ' - Dipendenze Aggiornate: '+LRTrim(Str(cNumMod,10,0)))
obj='Exec
pag=14
prev=O4153
I
nonlocal=True
obj='Var
obj_type='M
pag=14
prev=O4152
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=14
prev=O4149
var_op='asgn
I
obj='If
pag=14
prev=O4148
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4149
fatherSonIndex=0
frm_calc='gMsgProc + 'Dipendenze Inserite/Aggiornate: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Exec
pag=14
prev=O4147
I
obj='Exec
pag=14
prev=O4146
I
obj='Exec
pag=14
prev=O4144
I
obj='While
pag=14
prev=O4143
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4144
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,6)
len=6
name='xDIP
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,69,6)
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Caricamento dipendenza con codice '+xDIP
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCodCab))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgRet='S'
]
h=[
19
19
]
next=Icpitembatch.CPMerge
arch='anadip
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=14
prev=O4172
var_op='asgn
I
obj='Merge
pag=14
prev=O4169
rd_kfield=[
'CODDIP
]
rd_kop=[
'=
]
rd_kvar=[
'xDIP
]
wr_field=[
'CODDIP
'DESCRIZ
'DESCCIT
'PROVINCIA
'CAB
'AGENTE
'IDBASE
'CAP
'TIPOSV
'CODFISC
'PARTIVA
'TIPOAGENTE
'NUMCIVICO
'DATAINI
'DATAFINE
'SERRIMDEN
'DOMICILIO
'MACROAGENTE
'FLGCOMPL
]
wr_mode=[
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xDIP
'Substr(riga,7,30)
'Substr(riga,37,30)
'Substr(riga,67,2)
'xCodCab
'iif(Upper(Substr(riga,85,1))='S','S','N')
'LibreriaMit.UniqueId()
'Substr(riga,86,5)
'Substr(riga,91,3)
'Substr(riga,94,16)
'Substr(riga,110,11)
'Substr(riga,121,2)
'Substr(riga,123,15)
'CharToDate(Substr(riga,142,4)+Substr(riga,140,2)+Substr(riga,138,2))
'CharToDate(Substr(riga,150,4)+Substr(riga,148,2)+Substr(riga,146,2))
'Substr(riga,154,1)
'Substr(riga,155,50)
'LRTrim(Substr(riga,205,5))
'iif(LRTrim(Substr(riga,210,1))='S',1,0)
]
I
obj='If
pag=14
prev=O4166
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xnadip
father=O4169
fatherSonIndex=0
obj='Insert
pag=14
rd_kfield=[
'IDPROG
'CODDIP
'DESCRIZ
'DESCCIT
'PROVINCIA
'CAB
'AGENTE
'IDBASE
'CAP
'TIPOSV
'CODFISC
'PARTIVA
'TIPOAGENTE
'NUMCIVICO
'DATAINI
'DATAFINE
'SERRIMDEN
'DOMICILIO
'MACROAGENTE
]
rd_kvar=[
'conta
'xDIP
'Substr(riga,7,30)
'Substr(riga,37,30)
'Substr(riga,67,2)
'Substr(riga,69,6)
'Substr(riga,85,1)
'LibreriaMit.UniqueId()
'Substr(riga,86,5)
'Substr(riga,91,3)
'Substr(riga,94,16)
'Substr(riga,110,11)
'Substr(riga,121,2)
'Substr(riga,123,15)
'CharToDate(Substr(riga,142,4)+Substr(riga,140,2)+Substr(riga,138,2))
'CharToDate(Substr(riga,150,4)+Substr(riga,148,2)+Substr(riga,146,2))
'Substr(riga,154,1)
'Substr(riga,155,50)
'Substr(riga,205,5)
]
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O4165
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4166
fatherSonIndex=0
frm_calc='Substr(riga,37,30)
len=30
name='xCitta
next=Icpitembatch.CPRead
arch='tbcitta
obj='Read
pag=14
prev=O4189
rd_field=[
'CAB
]
rd_kfield=[
'CITTA
'PROV
]
rd_kvar=[
'xCitta
'Substr(riga,67,2)
]
rd_var=[
'xCodCab
]
I
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=14
prev=O4164
var_op='asgn
I
nonlocal=True
obj='Var
pag=14
prev=O4163
var_op='asgn
I
obj='Var
pag=14
prev=O4162
var_op='asgn
I
obj='Var
pag=14
prev=O4161
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=14
prev=O4142
var_op='asgn
I
obj='Var
pag=14
prev=O4141
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=14
prev=O4140
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O4139
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O4138
var_op='asgn
I
obj='Remark
pag=14
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPBeginEnd
comment='Gestione storico import
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Titolari Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Titolari Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=15
prev=O4210
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=15
prev=O4209
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=15
prev=O4208
var_op='asgn
I
obj='Exec
pag=15
prev=O4207
I
obj='Exec
pag=15
prev=O4206
I
obj='Exec
pag=15
prev=O4204
I
obj='While
pag=15
prev=O4203
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4204
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=15
prev=O4214
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O4215
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,159,10)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
prev=O4223
sons=[
Icpitembatch.CPItemSon
comment='Unicode Assente o vuoto
instr=Icpitembatch.CPVarDecl
father=O4226
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,36,8)))
len=8
name='_datareg
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
prev=O4232
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O4233
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGPTIT1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPTIT2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTIT\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xapotit
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,44,2)='50'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
prev=O4241
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4243
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xntestit
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=15
prev=O4249
var_op='asgn
I
obj='Insert
pag=15
prev=O4248
rd_kfield=[
'CODCLI
'CODINTER
'DATAINI
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
'NUMPROG1
'NUMIMP
]
rd_kvar=[
'Substr(riga,75,16)
'Substr(riga,50,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'Substr(riga,219,30)
'Substr(riga,9,25)
'nProgImp
'LibreriaMit.UniqueId()
'cInfProg2
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4249
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file ARCHTITO.TXT
obj='Transaction
pag=15
prev=O4256
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=15
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xntestit
father=O4243
fatherSonIndex=1
h=[
19
19
]
obj='Insert
pag=15
rd_kfield=[
'CODCLI
'CODINTER
'DATAFINE
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
'NUMPROG2
'NUMIMP
]
rd_kvar=[
'Substr(riga,75,16)
'Substr(riga,50,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'Substr(riga,219,30)
'Substr(riga,9,25)
'nProgImp
'LibreriaMit.UniqueId()
'cInfProg2
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4260
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file ARCHTITO.TXT
obj='Transaction
pag=15
prev=O4266
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=15
prev=O4240
rd_kfield=[
'CDATOPE
'CDATREG
'CODCAB
'CODDIPE
'CODINTER
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPTIT
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'IDBASE2
'NUMIMP
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'_intercab
'Substr(riga,115,6)
'_intercod
'Substr(riga,75,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'cInfProg1
'"T"+Right(cInfProg2,9)+_idb2
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,159,10)
'_idb2
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4241
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file ARCHTITO.TXT
obj='Transaction
pag=15
prev=O4274
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=15
prev=O4239
var_op='asgn
I
obj='Var
pag=15
prev=O4238
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4233
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGTITO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGTITO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTIT\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='rapotit
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,50,16)))
]
h=[
19
19
]
obj='If
pag=15
prev=O4281
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4283
fatherSonIndex=0
frm_calc=[
'Substr(riga,44,2)='50'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4288
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='intestit
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=15
prev=O4294
var_op='asgn
I
obj='Insert
pag=15
prev=O4293
rd_kfield=[
'CODCLI
'CODINTER
'DATAINI
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
'STATOREG
'NUMPROG1
'NUMIMP
]
rd_kvar=[
'Substr(riga,75,16)
'Substr(riga,50,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'Substr(riga,219,30)
'Substr(riga,9,25)
'nProgImp
'LibreriaMit.UniqueId()
''0'
'cInfProg2
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4294
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file ARCHTITO.TXT
obj='Transaction
pag=15
prev=O4301
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=15
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestit
father=O4288
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=15
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,75,16)
'Substr(riga,50,16)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4305
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file ARCHTITO.TXT
obj='Transaction
pag=15
prev=O4312
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
'NUMPROG2
'NUMIMP
]
wr_op=[
'=
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
'_numimp
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=15
prev=O4280
rd_kfield=[
'CDATOPE
'CDATREG
'CODCAB
'CODDIPE
'CODINTER
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPTIT
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'IDBASE2
'NUMIMP
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'_intercab
'Substr(riga,115,6)
'_intercod
'Substr(riga,75,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'cInfProg1
'"T"+Right(cInfProg2,9)+_idb2
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,159,10)
'_idb2
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4281
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file ARCHTITO.TXT
obj='Transaction
pag=15
prev=O4324
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=15
prev=O4279
var_op='asgn
I
obj='Var
pag=15
prev=O4278
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='D
pag=15
prev=O4231
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='Aggiornamento
instr=Icpitembatch.CPIfElse
father=O4226
fatherSonIndex=1
frm_calc=[
'_tdest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4329
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=15
sel_field='*
sel_name='xapotit
sel_where='xapotit->IDBASE=_unicode and (xapotit->STATOREG='0' or xapotit->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4334
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGPTIT1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPInsert
arch='xapotit
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='xapotit
obj='Write
pag=15
prev=O4339
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_unicode
]
wr_field=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDEREG
'OPRAP
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'CONNESCLI
'DATARETT
'NUMIMP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'_intercab
'Substr(riga,115,6)
'_intercod
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'CharToDate(Right(Substr(riga,36,8),4)+Substr(Substr(riga,36,8),3,2)+Left(Substr(riga,36,8),2))
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'xapotit->IDEREG
'Left(Substr(riga,44,2),1)
'_interprv
'Substr(riga,9,25)
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,75,16)
'Date()
'_numimp
]
I
obj='Insert
pag=15
prev=O4338
rd_kfield=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPTIT
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'NUMIMP
]
rd_kvar=[
'xapotit->CDATOPE
'xapotit->CODCAB
'xapotit->CODDIPE
'xapotit->CODINTER
'xapotit->CONNESCLI
'xapotit->DATAOPE
'xapotit->DATAREG
'xapotit->DESCCIT
'xapotit->DESCINTER
'xapotit->FLAGRAP
'cInfProg1
'xapotit->IDEREG
'xapotit->NUMPROG
'xapotit->OPRAP
'xapotit->PRGIMPTIT
'xapotit->PROVINCIA
'xapotit->RAPPORTO
''3'
''1'
'xapotit->TIPOINTER
'xapotit->TIPOLEG
'xapotit->TIPOOPRAP
'xapotit->UNIQUECODE
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4339
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file ARCHTITO.TXT
obj='Transaction
pag=15
prev=O4352
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4329
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=15
sel_field='*
sel_name='rapotit
sel_where='rapotit->IDBASE=_unicode and (rapotit->STATOREG='0' or rapotit->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4357
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGTITO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPInsert
arch='rapotit
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='rapotit
obj='Write
pag=15
prev=O4362
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_unicode
]
wr_field=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDEREG
'OPRAP
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'CONNESCLI
'DATARETT
'NUMIMP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'_intercab
'Substr(riga,115,6)
'_intercod
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'CharToDate(Right(Substr(riga,36,8),4)+Substr(Substr(riga,36,8),3,2)+Left(Substr(riga,36,8),2))
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'rapotit->IDEREG
'Left(Substr(riga,44,2),1)
'_interprv
'Substr(riga,9,25)
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,75,16)
'Date()
'_numimp
]
I
obj='Insert
pag=15
prev=O4361
rd_kfield=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPTIT
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'NUMIMP
]
rd_kvar=[
'rapotit->CDATOPE
'rapotit->CODCAB
'rapotit->CODDIPE
'rapotit->CODINTER
'rapotit->CONNESCLI
'rapotit->DATAOPE
'rapotit->DATAREG
'rapotit->DESCCIT
'rapotit->DESCINTER
'rapotit->FLAGRAP
'cInfProg1
'rapotit->IDEREG
'rapotit->NUMPROG
'rapotit->OPRAP
'rapotit->PRGIMPTIT
'rapotit->PROVINCIA
'rapotit->RAPPORTO
''3'
''1'
'rapotit->TIPOINTER
'rapotit->TIPOLEG
'rapotit->TIPOOPRAP
'rapotit->UNIQUECODE
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4362
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file ARCHTITO.TXT
obj='Transaction
pag=15
prev=O4375
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=15
prev=O4222
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4223
fatherSonIndex=0
frm_calc='''
len=1
name='_tdest
next=Icpitembatch.CPRead
arch='xapotit
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_unicode)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
prev=O4384
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='rapotit
father=O4385
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_unicode))
]
h=[
19
19
]
obj='If
pag=15
prev=O4390
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4391
fatherSonIndex=0
frm_calc=''D'
len=1
name='_tdest
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=15
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,159,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4385
fatherSonIndex=1
frm_calc=''P'
len=1
name='_tdest
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=15
prev=O4383
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,159,10)
]
rd_var=[
'_unicode
]
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=15
prev=O4220
var_op='asgn
I
obj='Begin
pag=15
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O4220
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,104,11))),_codinter,Substr(riga,104,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,121,30))),_citinter,Substr(riga,121,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,153,6))),_cabinter,Substr(riga,153,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,151,2))),_prvinter,Substr(riga,151,2))
len=2
name='_interprv
obj='Var
pag=15
prev=O4414
var_op='asgn
I
obj='Var
pag=15
prev=O4413
var_op='asgn
I
obj='Var
pag=15
prev=O4412
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=15
prev=O4202
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=15
prev=O4200
var_op='asgn
I
obj='Begin
pag=15
prev=O4199
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4200
fatherSonIndex=0
frm_calc=[
'At("archtito",_tabelle)=0
]
h=[
19
19
]
obj='If
pag=15
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4421
fatherSonIndex=0
frm_calc='_tabelle+"archtito,"
len=10
name='_tabelle
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=15
prev=O4198
var_op='asgn
I
obj='Var
obj_type='N
pag=15
prev=O4197
var_op='asgn
I
obj='Remark
pag=15
x=15
y=15
I
Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+'/'+LRTrim(nomefileimport)
name='fileName
next=Icpitembatch.CPExec
check='page
frm_calc='45
next=Icpitembatch.CPVarDecl
frm_calc='Paths.get(fileName)
name='path
next=Icpitembatch.CPExec
check='man
frm_calc='// Conta le righe del fle﷯righeTot=Files.lines(path,Charset.forName(_charset)).count();
obj='Exec
pag=15
prev=O4431
I
obj='Var
obj_type='O
pag=15
prev=O4430
var_op='asgn
I
obj='Exec
pag=15
prev=O4429
I
obj='Var
pag=15
var_op='asgn
x=1266
y=230
I
Icpitembatch.CPBeginEnd
comment='Variabili di pagina
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella (Operazioni ExtraConto)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_opxerr
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Inizio Elaborazione File Operazioni Extraconto (OPEX.TXT)"+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni ExtraConto Inserite: '+LRTrim(Str(cNumNew,10,0)) + " - Operazioni ExtraConto Scartate: "+LRTrim(Str(cNumMod,10,0))+' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=16
prev=O4449
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=16
prev=O4448
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=16
prev=O4447
var_op='asgn
I
obj='Exec
pag=16
prev=O4446
I
obj='Exec
pag=16
prev=O4445
I
obj='Exec
pag=16
prev=O4443
I
obj='While
pag=16
prev=O4442
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O4443
fatherSonIndex=0
frm_calc=''Sono state elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=16
prev=O4455
var_op='asgn
I
obj='If
pag=16
prev=O4454
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4455
fatherSonIndex=0
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datx
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,1,16))
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,25,4)+Substr(riga,23,2)+Substr(riga,21,2)
len=8
name='xData
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,1,16)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=16
prev=O4464
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4465
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,30,30))))
]
h=[
19
19
]
obj='If
pag=16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4470
fatherSonIndex=0
frm_calc='0
len=1
name='_inviato
next=Icpitembatch.CPRead
arch='opextrbo
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xIDB)))
]
h=[
19
19
]
obj='If
pag=16
prev=O4476
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4477
fatherSonIndex=0
frm_calc=[
'_inviato=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=16
prev=O4482
var_op='asgn
I
obj='If
pag=16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='opextrbo
father=O4482
fatherSonIndex=0
obj='Delete
pag=16
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'xIDB
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O4482
fatherSonIndex=1
obj='Write
pag=16
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'xIDB
]
wr_field=[
'DATAANNU
]
wr_op=[
'=
]
wr_var=[
'Date()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=16
prev=O4475
rd_field=[
'IDBASE
'COLLEG
'INVIATO
]
rd_kfield=[
'RIFIMP
]
rd_kvar=[
'LRTrim(Substr(riga,30,30))
]
rd_var=[
'xIDB
'cCli1
'_inviato
]
I
obj='Var
obj_type='N
pag=16
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4465
fatherSonIndex=1
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_rifopex
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_inviato
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_conadd)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=16
prev=O4511
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='opextrbo
father=O4512
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=16
prev=O4517
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O4518
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGOPEX\'"+LRTrim(gAzienda)+"'",0,10)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='opextrbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=16
prev=O4525
var_op='asgn
I
obj='Insert
pag=16
prev=O4524
rd_kfield=[
'COLLEG
'ANNO
'IDBASE
'DATAOPE
'COINT
'RIFIMP
'PROGOPEX
'RAPPORTO
]
rd_kvar=[
'LRTrim(cCli1)
'Substr(riga,17,4)
'xIDB
'CharToDate(xData)
'Substr(riga,29,1)
'Substr(riga,30,30)
'nProgImp
'Substr(riga,17,4)+"_"+LRTrim(cCli1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4525
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice soggetto: "+Substr(riga,1,16)+" per l'operazione extraconto in data: "+Substr(riga,21,8)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=16
prev=O4534
I
obj='Var
obj_type='N
pag=16
prev=O4533
var_op='asgn
I
obj='Exec
pag=16
prev=O4532
I
nonlocal=True
obj='Var
obj_type='M
pag=16
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=16
prev=O4523
var_op='asgn
I
obj='Var
pag=16
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4518
fatherSonIndex=1
frm_calc=[
'not(Empty(LRTrim(Substr(riga,30,30)))) and LRTrim(Substr(riga,30,30))=LRTrim(_rifopex)
]
h=[
19
19
]
obj='If
pag=16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O4538
fatherSonIndex=0
obj='Write
pag=16
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'xIDB
]
wr_field=[
'DATAOPE
'COINT
'DATAMODI
]
wr_op=[
'=
'=
'=
]
wr_var=[
'CharToDate(xData)
'Substr(riga,29,1)
'iif(_inviato=0,NullDate(),Date())
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=16
rd_field=[
'IDBASE
'RIFIMP
'INVIATO
]
rd_kfield=[
'COLLEG
'ANNO
]
rd_kvar=[
'cCli1
'Substr(riga,17,4)
]
rd_var=[
'xIDB
'_rifopex
'_inviato
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4512
fatherSonIndex=1
frm_calc='1
len=1
name='_opxerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(xhand,riga+" - Intestatario operazione extraconto non esiste")
obj='Exec
pag=16
prev=O4557
I
obj='Var
obj_type='N
pag=16
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=16
prev=O4510
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'cCli1
]
rd_var=[
'_conadd
]
I
obj='Var
obj_type='N
pag=16
pagelocal=True
prev=O4509
var_op='asgn
I
obj='Var
pag=16
pagelocal=True
prev=O4508
var_op='asgn
I
obj='Var
pag=16
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=16
prev=O4463
var_op='asgn
I
obj='Var
pag=16
prev=O4462
var_op='asgn
I
obj='Var
obj_type='D
pag=16
pagelocal=True
prev=O4461
var_op='asgn
I
obj='Var
pag=16
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=16
prev=O4453
var_op='asgn
I
nonlocal=True
obj='Var
pag=16
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=16
prev=O4441
var_op='asgn
I
obj='Var
pag=16
prev=O4440
var_op='asgn
I
obj='Var
obj_type='N
pag=16
prev=O4439
var_op='asgn
I
obj='Var
obj_type='N
pag=16
prev=O4438
var_op='asgn
I
obj='Var
obj_type='N
pag=16
prev=O4437
var_op='asgn
I
obj='Var
obj_type='N
pag=16
prev=O4436
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=16
prev=O4435
var_op='asgn
I
obj='Remark
pag=16
prev=O4433
I
obj='Begin
pag=16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4433
fatherSonIndex=0
len=25
name='_aprog
next=Icpitembatch.CPVarDecl
len=15
name='_afile
next=Icpitembatch.CPVarDecl
len=25
name='_dprog
next=Icpitembatch.CPVarDecl
len=15
name='_dfile
next=Icpitembatch.CPVarDecl
len=8
name='_datx
next=Icpitembatch.CPVarDecl
len=1
name='_inviato
next=Icpitembatch.CPVarDecl
len=30
name='_rifopex
obj='Var
pag=16
pagelocal=True
prev=O4574
I
obj='Var
obj_type='N
pag=16
pagelocal=True
prev=O4573
I
obj='Var
obj_type='D
pag=16
pagelocal=True
prev=O4572
I
obj='Var
pag=16
pagelocal=True
prev=O4571
I
obj='Var
pag=16
pagelocal=True
prev=O4570
I
obj='Var
pag=16
pagelocal=True
prev=O4569
I
obj='Var
pag=16
pagelocal=True
I
I
]
w=[
150
150
]
x=18
y=18
I
Icpitembatch.CPIfElse
frm_calc=[
'_inviato=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=16
prev=O4577
var_op='asgn
I
obj='If
pag=16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O4577
fatherSonIndex=0
obj='Write
pag=16
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'xIDB
]
wr_field=[
'DATAOPE
]
wr_op=[
'=
]
wr_var=[
'CharToDate(xData)
]
I
I
Icpitembatch.CPItemSon
I
]
w=[
150
150
150
]
x=969
y=1703
I
Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=16
prev=O4593
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4594
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=16
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=16
prev=O4592
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,1,16))
]
rd_var=[
'_conadd
]
I
obj='Var
obj_type='N
pag=16
var_op='asgn
x=666
y=1080
I
Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+'/'+LRTrim(nomefileimport)
name='fileName
next=Icpitembatch.CPExec
check='page
frm_calc='45
next=Icpitembatch.CPVarDecl
frm_calc='Paths.get(fileName)
name='path
next=Icpitembatch.CPExec
check='man
frm_calc='// Conta le righe del fle﷯righeTot=Files.lines(path,Charset.forName(_charset)).count();
obj='Exec
pag=16
prev=O4607
I
obj='Var
obj_type='O
pag=16
prev=O4606
var_op='asgn
I
obj='Exec
pag=16
prev=O4605
I
obj='Var
pag=16
var_op='asgn
x=1337
y=235
I
Icpitembatch.CPRemark
frm_calc='Deleghe sui rapporti
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPBeginEnd
comment='Gestione storico import
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Deleghe Rapporti Inserite: '+LRTrim(Str(cNumNew,10,0)) + " - Deleghe Rapporti Aggiornate: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=17
prev=O4622
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=17
prev=O4621
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=17
prev=O4620
var_op='asgn
I
obj='Exec
pag=17
prev=O4619
I
obj='Exec
pag=17
prev=O4618
I
obj='Exec
pag=17
prev=O4616
I
obj='While
pag=17
prev=O4615
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4616
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,46,4)+Substr(riga,44,2)+Substr(riga,42,2)
len=8
name='xData
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,55,4)+Substr(riga,53,2)+Substr(riga,51,2)
len=8
name='xDatF
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(xDatF)),CharToDate(xData),CharToDate(xDatF))
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,60,10))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_rifimp))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_rifimp))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=17
prev=O4634
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4637
fatherSonIndex=0
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPRead
arch='delegabo
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=17
prev=O4643
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPSelect
father=O4644
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='delegabo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=17
prev=O4652
var_op='asgn
I
obj='Insert
pag=17
prev=O4651
rd_kfield=[
'RAPPORTO
'CPROWNUM
'CODINTER
'DATAINI
'TIPORAP
'DATAFINE
'IDBASE
'NOAGE
'STATOREG
'NUMPROG1
'NUMIMP
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
'Substr(riga,26,16)
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
'LibreriaMit.UniqueId()
'iif(Empty(LRTrim(Substr(riga,59,1))),'N',Substr(riga,59,1))
''0'
'_rifimp
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4652
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=17
prev=O4661
I
obj='Var
obj_type='N
pag=17
prev=O4660
var_op='asgn
I
obj='Exec
pag=17
prev=O4659
I
nonlocal=True
obj='Var
obj_type='M
pag=17
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=17
prev=O4649
var_op='asgn
I
obj='Select
pag=17
sel_field='*
sel_name='delegabo
sel_order='delegabo->CPROWNUM
sel_where='delegabo->RAPPORTO=Left(riga,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4649
fatherSonIndex=0
frm_calc='delegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=17
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPIfElse
father=O4644
fatherSonIndex=1
frm_calc=[
'Empty(LRTrim(xDatF))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=17
prev=O4669
var_op='asgn
I
obj='If
pag=17
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='delegabo
father=O4669
fatherSonIndex=0
h=[
19
19
]
obj='Write
pag=17
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4675
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=17
prev=O4684
I
obj='Var
obj_type='N
pag=17
prev=O4683
var_op='asgn
I
obj='Exec
pag=17
prev=O4682
I
nonlocal=True
obj='Var
obj_type='M
pag=17
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'TIPORAP
'DATAINI
'NUMPROG1
'NUMIMP
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,50,1)
'CharToDate(xData)
'_rifimp
'_numimp
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='delegabo
father=O4669
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=17
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4691
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=17
prev=O4700
I
obj='Var
obj_type='N
pag=17
prev=O4699
var_op='asgn
I
obj='Exec
pag=17
prev=O4698
I
nonlocal=True
obj='Var
obj_type='M
pag=17
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'TIPORAP
'DATAFINE
'NUMPROG2
'NUMIMP
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,50,1)
'CharToDate(xDatF)
'_rifimp
'_numimp
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=17
prev=O4642
rd_field=[
'CPROWNUM
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,16)
]
rd_var=[
'cMaxRow
]
I
obj='Var
obj_type='N
pag=17
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4637
fatherSonIndex=1
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=17
prev=O4715
I
obj='Var
obj_type='N
pag=17
prev=O4714
var_op='asgn
I
obj='Exec
pag=17
prev=O4713
I
nonlocal=True
obj='Var
obj_type='M
pag=17
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=17
prev=O4631
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4634
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_rifimp))
]
h=[
19
19
]
obj='If
pag=17
prev=O4720
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4722
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=17
sel_field='*
sel_name='rapopebo
sel_where='rapopebo->RAPPORTO=Left(riga,25) and rapopebo->DATAOPE=_dataope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4727
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(xDatF))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=17
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4731
fatherSonIndex=0
frm_calc=[
'(At(rapopebo->STATOREG,'|0|1') > 0 or Empty(rapopebo->STATOREG)) and At(rapopebo->TIPOOPRAP,'|25|39|40') > 0
]
h=[
19
19
]
obj='If
pag=17
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4736
fatherSonIndex=0
frm_calc='rapopebo->NUMPROG
len=11
name='_rifimp
obj='Var
pag=17
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4731
fatherSonIndex=1
frm_calc=[
'(At(rapopebo->STATOREG,'|0|1') > 0 or Empty(rapopebo->STATOREG)) and At(rapopebo->TIPOOPRAP,'|28|41|47') > 0
]
h=[
19
19
]
obj='If
pag=17
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4744
fatherSonIndex=0
frm_calc='rapopebo->NUMPROG
len=11
name='_rifimp
obj='Var
pag=17
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=17
sel_field='*
sel_name='rapopebo
sel_where='rapopebo->RAPPORTO=Left(riga,25) and rapopebo->DATAOPE=_dataope and rapopebo->CONNESOPER=LRTrim(Substr(riga,26,16))
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4720
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(xDatF))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=17
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4756
fatherSonIndex=0
frm_calc=[
'(At(rapopebo->STATOREG,'|0|1') > 0 or Empty(rapopebo->STATOREG)) and At(rapopebo->TIPOOPRAP,'|25|39|40') > 0
]
h=[
19
19
]
obj='If
pag=17
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4761
fatherSonIndex=0
frm_calc='rapopebo->NUMPROG
len=11
name='_rifimp
obj='Var
pag=17
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4756
fatherSonIndex=1
frm_calc=[
'(At(rapopebo->STATOREG,'|0|1') > 0 or Empty(rapopebo->STATOREG)) and At(rapopebo->TIPOOPRAP,'|28|41|47') > 0
]
h=[
19
19
]
obj='If
pag=17
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4769
fatherSonIndex=0
frm_calc='rapopebo->NUMPROG
len=11
name='_rifimp
obj='Var
pag=17
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=17
prev=O4630
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='rapopebo
father=O4631
fatherSonIndex=0
obj='Read
pag=17
rd_field=[
'NUMPROG
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'LRTrim(Substr(riga,60,10))
]
rd_var=[
'_rifimp
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=17
prev=O4629
var_op='asgn
I
obj='Var
obj_type='D
pag=17
prev=O4628
var_op='asgn
I
obj='Var
pag=17
prev=O4627
var_op='asgn
I
obj='Var
pag=17
prev=O4626
var_op='asgn
I
obj='Var
obj_type='M
pag=17
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=17
prev=O4614
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=17
prev=O4612
var_op='asgn
I
obj='Begin
pag=17
prev=O4611
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4612
fatherSonIndex=0
frm_calc=[
'At("procdel",_tabelle)=0
]
h=[
19
19
]
obj='If
pag=17
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4790
fatherSonIndex=0
frm_calc='_tabelle+"procdel,"
len=10
name='_tabelle
obj='Var
obj_type='M
pag=17
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=17
prev=O4610
var_op='asgn
I
obj='Var
obj_type='N
pag=17
prev=O4609
var_op='asgn
I
obj='Remark
pag=17
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file SOGOPE.TXT altri soggetti operanti
next=Icpitembatch.CPBeginEnd
comment='Gestione storico import
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Soggetti operanti inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Soggetti operanti aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=18
prev=O4811
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=18
prev=O4810
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=18
prev=O4809
var_op='asgn
I
obj='Exec
pag=18
prev=O4808
I
obj='Exec
pag=18
prev=O4807
I
obj='Exec
pag=18
prev=O4805
I
obj='While
pag=18
prev=O4804
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4805
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_salta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='_rapcol
next=Icpitembatch.CPRemark
frm_calc='Verfico la presenza di _unicode nelle tabelle rapopebo/operazbo/fraziobo
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,48,1)='I'
'Substr(riga,48,1)='O'
'Substr(riga,48,1)='F'
]
h=[
19
19
19
19
]
obj='Case
pag=18
prev=O4820
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='rapopebo
father=O4821
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=18
prev=O4826
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4827
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='soginfo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=18
prev=O4834
var_op='asgn
I
obj='Insert
pag=18
prev=O4832
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'NUMIMP
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cInfProg2
'Substr(riga,48,1)
'_rapcol
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4834
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=18
prev=O4843
I
obj='Var
obj_type='N
pag=18
prev=O4842
var_op='asgn
I
obj='Exec
pag=18
prev=O4841
I
nonlocal=True
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=18
sel_field='*
sel_name='soginfo
sel_where='soginfo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4832
fatherSonIndex=0
frm_calc='soginfo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=18
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=18
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
'RAPPORTO
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cOpeProg2
'_unicode
'_rapcol
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O4821
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=18
prev=O4856
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4857
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='sogopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=18
prev=O4864
var_op='asgn
I
obj='Insert
pag=18
prev=O4862
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'NUMIMP
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cOpeProg2
'Substr(riga,48,1)
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4864
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=18
prev=O4873
I
obj='Var
obj_type='N
pag=18
prev=O4872
var_op='asgn
I
obj='Exec
pag=18
prev=O4871
I
nonlocal=True
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=18
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4862
fatherSonIndex=0
frm_calc='sogopebo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=18
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=18
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cOpeProg2
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O4821
fatherSonIndex=2
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=18
prev=O4886
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4888
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='sogopefbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_salta
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=18
prev=O4897
var_op='asgn
I
obj='Var
obj_type='N
pag=18
prev=O4895
var_op='asgn
I
obj='Insert
pag=18
prev=O4893
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'NUMIMP
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cOpeProg2
'Substr(riga,48,1)
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4895
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=18
prev=O4905
I
obj='Var
obj_type='N
pag=18
prev=O4904
var_op='asgn
I
obj='Exec
pag=18
prev=O4903
I
nonlocal=True
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=18
sel_field='*
sel_name='sogopefbo
sel_where='sogopefbo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4893
fatherSonIndex=0
frm_calc='sogopefbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=18
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=18
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cOpeProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
comment='se non trova il valore nelle tre tabelle da errore e stoppa la procedura
instr=Icpitembatch.CPVarDecl
father=O4886
fatherSonIndex=0
frm_calc='1
len=1
name='_salta
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=18
prev=O4919
I
obj='Var
obj_type='N
pag=18
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
150
150
]
I
obj='Remark
pag=18
prev=O4819
I
obj='Var
pag=18
prev=O4818
var_op='asgn
I
obj='Var
obj_type='N
pag=18
prev=O4817
var_op='asgn
I
obj='Var
pag=18
prev=O4816
var_op='asgn
I
obj='Var
obj_type='N
pag=18
prev=O4815
var_op='asgn
I
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=18
prev=O4803
var_op='asgn
I
obj='Var
obj_type='N
pag=18
prev=O4802
var_op='asgn
I
obj='Var
pag=18
prev=O4801
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=18
prev=O4799
var_op='asgn
I
obj='Begin
pag=18
prev=O4798
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4799
fatherSonIndex=0
frm_calc=[
'At("sogope",_tabelle)=0
]
h=[
19
19
]
obj='If
pag=18
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4926
fatherSonIndex=0
frm_calc='_tabelle+"sogope,"
len=10
name='_tabelle
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=18
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file INTEST.TXT altri intestatari
next=Icpitembatch.CPBeginEnd
comment='Gestione storico import
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Intestatari inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Intestatari aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=19
prev=O4947
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=19
prev=O4946
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=19
prev=O4945
var_op='asgn
I
obj='Exec
pag=19
prev=O4944
I
obj='Exec
pag=19
prev=O4943
I
obj='Exec
pag=19
prev=O4941
I
obj='While
pag=19
prev=O4940
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4941
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPRemark
frm_calc='Verifico in intestbo che ci sia già un recod con lo stesso codice rapporto e memorizzo i dati della riga necessari per crearne una nuova.
next=Icpitembatch.CPSelect
h=[
19
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Se trovo il record inserisco il nuovo intestatario
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
]
obj='If
pag=19
prev=O4957
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='intestbo
father=O4958
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=19
prev=O4963
var_op='asgn
I
obj='Insert
pag=19
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
'PROQUOTA
'NUMIMP
]
rd_kvar=[
'ciidbase
'cMaxRow + 1
'cidataini
'iif(Empty(Substr(riga,121,1)) ,'P',Substr(riga,121,1))
'Substr(riga,26,16)
'cinumprog
'Substr(riga,1,25)
'citiporap
''0'
'DateToChar(cidataini)+cinumprog+'O'
'Left(LRTrim(Substr(riga,26,16))+Space(5),16)
'Val(Substr(riga,221,3))
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4963
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=19
prev=O4972
I
obj='Var
obj_type='N
pag=19
prev=O4971
var_op='asgn
I
obj='Exec
pag=19
prev=O4970
I
nonlocal=True
obj='Var
obj_type='M
pag=19
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=19
prev=O4955
I
obj='Select
pag=19
prev=O4954
sel_field='*
sel_name='intestbo
sel_order='intestbo->CPROWNUM
sel_where='intestbo->RAPPORTO=Substr(riga,1,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4955
fatherSonIndex=0
frm_calc=[
'Substr(riga,26,16)=intestbo->CODINTER
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->CPROWNUM
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->IDBASE
len=10
name='ciidbase
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->DATAINI
len=8
name='cidataini
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->DATAFINE
len=8
name='cidatafine
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->CODINTER
len=12
name='cicodinter
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->NUMPROG1
len=11
name='cinumprog
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->TIPORAP
len=1
name='citiporap
obj='Var
pag=19
prev=O4986
var_op='asgn
I
obj='Var
pag=19
prev=O4985
var_op='asgn
I
obj='Var
pag=19
prev=O4984
var_op='asgn
I
obj='Var
obj_type='D
pag=19
prev=O4983
var_op='asgn
I
obj='Var
obj_type='D
pag=19
prev=O4982
var_op='asgn
I
obj='Var
pag=19
prev=O4981
var_op='asgn
I
obj='Var
obj_type='N
pag=19
prev=O4978
var_op='asgn
I
obj='If
pag=19
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4978
fatherSonIndex=0
frm_calc='intestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=19
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4955
fatherSonIndex=1
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=19
prev=O4995
I
obj='Var
obj_type='N
pag=19
prev=O4994
var_op='asgn
I
obj='Exec
pag=19
prev=O4993
I
nonlocal=True
obj='Var
obj_type='M
pag=19
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
150
]
I
obj='Remark
pag=19
prev=O4953
I
obj='Var
obj_type='N
pag=19
prev=O4952
var_op='asgn
I
obj='Var
obj_type='N
pag=19
prev=O4951
var_op='asgn
I
obj='Var
obj_type='M
pag=19
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=19
prev=O4939
var_op='asgn
I
obj='Var
obj_type='N
pag=19
prev=O4938
var_op='asgn
I
obj='Var
pag=19
prev=O4937
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=19
prev=O4935
var_op='asgn
I
obj='Begin
pag=19
prev=O4934
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4935
fatherSonIndex=0
frm_calc=[
'At("intest",_tabelle)=0
]
h=[
19
19
]
obj='If
pag=19
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5001
fatherSonIndex=0
frm_calc='_tabelle+"intest,"
len=10
name='_tabelle
obj='Var
obj_type='M
pag=19
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=19
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Deleghe sui rapporti
next=Icpitembatch.CPBeginEnd
comment='Gestione storico import
h=[
19
19
]
next=Icpitembatch.CPVarDecl
len=11
name='_nprg1
next=Icpitembatch.CPVarDecl
len=11
name='_nprg2
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Deleghe Rapporti Inserite: '+LRTrim(Str(cNumNew,10,0)) + " - Deleghe Rapporti Aggiornate: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=20
prev=O5024
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=20
prev=O5023
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=20
prev=O5022
var_op='asgn
I
obj='Exec
pag=20
prev=O5021
I
obj='Exec
pag=20
prev=O5020
I
obj='Exec
pag=20
prev=O5018
I
obj='While
pag=20
prev=O5017
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5018
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,46,4)+Substr(riga,44,2)+Substr(riga,42,2)
len=8
name='xData
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,55,4)+Substr(riga,53,2)+Substr(riga,51,2)
len=8
name='xDatF
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(xDatF)),CharToDate(xData),CharToDate(xDatF))
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,60,10))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_rifimp))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_rifimp))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=20
prev=O5036
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5039
fatherSonIndex=0
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPRead
arch='xelegabo
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=20
prev=O5045
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPSelect
father=O5046
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDatF))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=20
prev=O5054
var_op='asgn
I
obj='If
pag=20
prev=O5053
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xelegabo
father=O5054
fatherSonIndex=0
h=[
19
19
]
obj='Insert
pag=20
rd_kfield=[
'RAPPORTO
'CPROWNUM
'CODINTER
'DATAINI
'TIPORAP
'DATAFINE
'IDBASE
'NOAGE
'STATOREG
'NUMPROG1
'NUMIMP
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
'Substr(riga,26,16)
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
'LibreriaMit.UniqueId()
'iif(Empty(LRTrim(Substr(riga,59,1))),'N',Substr(riga,59,1))
''0'
'_rifimp
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5060
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=20
prev=O5068
I
obj='Var
obj_type='N
pag=20
prev=O5067
var_op='asgn
I
obj='Exec
pag=20
prev=O5066
I
nonlocal=True
obj='Var
obj_type='M
pag=20
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xelegabo
father=O5054
fatherSonIndex=1
h=[
19
19
]
obj='Insert
pag=20
rd_kfield=[
'RAPPORTO
'CPROWNUM
'CODINTER
'DATAINI
'TIPORAP
'DATAFINE
'IDBASE
'NOAGE
'STATOREG
'NUMPROG2
'NUMIMP
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
'Substr(riga,26,16)
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
'LibreriaMit.UniqueId()
'iif(Empty(LRTrim(Substr(riga,59,1))),'N',Substr(riga,59,1))
''0'
'_rifimp
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5072
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=20
prev=O5080
I
obj='Var
obj_type='N
pag=20
prev=O5079
var_op='asgn
I
obj='Exec
pag=20
prev=O5078
I
nonlocal=True
obj='Var
obj_type='M
pag=20
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=20
prev=O5051
var_op='asgn
I
obj='Select
pag=20
sel_field='*
sel_name='xelegabo
sel_order='xelegabo->CPROWNUM
sel_where='xelegabo->RAPPORTO=Left(riga,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5051
fatherSonIndex=0
frm_calc='xelegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=20
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPIfElse
father=O5046
fatherSonIndex=1
frm_calc=[
'Empty(LRTrim(xDatF))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=20
prev=O5089
var_op='asgn
I
obj='If
pag=20
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xelegabo
father=O5089
fatherSonIndex=0
h=[
19
19
]
obj='Write
pag=20
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5095
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=20
prev=O5104
I
obj='Var
obj_type='N
pag=20
prev=O5103
var_op='asgn
I
obj='Exec
pag=20
prev=O5102
I
nonlocal=True
obj='Var
obj_type='M
pag=20
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'TIPORAP
'DATAINI
'NUMPROG1
'NUMIMP
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,50,1)
'CharToDate(xData)
'_rifimp
'_numimp
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xelegabo
father=O5089
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=20
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5111
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=20
prev=O5120
I
obj='Var
obj_type='N
pag=20
prev=O5119
var_op='asgn
I
obj='Exec
pag=20
prev=O5118
I
nonlocal=True
obj='Var
obj_type='M
pag=20
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'TIPORAP
'DATAFINE
'NUMPROG2
'NUMIMP
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,50,1)
'CharToDate(xDatF)
'_rifimp
'_numimp
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=20
prev=O5044
rd_field=[
'CPROWNUM
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,16)
]
rd_var=[
'cMaxRow
]
I
obj='Var
obj_type='N
pag=20
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5039
fatherSonIndex=1
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=20
prev=O5135
I
obj='Var
obj_type='N
pag=20
prev=O5134
var_op='asgn
I
obj='Exec
pag=20
prev=O5133
I
nonlocal=True
obj='Var
obj_type='M
pag=20
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=20
prev=O5033
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5036
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_rifimp))
]
h=[
19
19
]
obj='If
pag=20
prev=O5140
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5142
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=20
sel_field='*
sel_name='xapopebo
sel_where='xapopebo->RAPPORTO=Left(riga,25) and xapopebo->DATAOPE=_dataope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5147
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(xDatF))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=20
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5151
fatherSonIndex=0
frm_calc=[
'(At(xapopebo->STATOREG,'|0|1') > 0 or Empty(xapopebo->STATOREG)) and At(xapopebo->TIPOOPRAP,'|25|39|40') > 0
]
h=[
19
19
]
obj='If
pag=20
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5156
fatherSonIndex=0
frm_calc='xapopebo->NUMPROG
len=11
name='_rifimp
obj='Var
pag=20
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5151
fatherSonIndex=1
frm_calc=[
'(At(xapopebo->STATOREG,'|0|1') > 0 or Empty(xapopebo->STATOREG)) and At(xapopebo->TIPOOPRAP,'|28|41|47') > 0
]
h=[
19
19
]
obj='If
pag=20
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5164
fatherSonIndex=0
frm_calc='xapopebo->NUMPROG
len=11
name='_rifimp
obj='Var
pag=20
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=20
sel_field='*
sel_name='xapopebo
sel_where='xapopebo->RAPPORTO=Left(riga,25) and xapopebo->DATAOPE=_dataope and xapopebo->CONNESOPER=LRTrim(Substr(riga,26,16))
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5140
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(xDatF))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=20
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5176
fatherSonIndex=0
frm_calc=[
'(At(xapopebo->STATOREG,'|0|1') > 0 or Empty(xapopebo->STATOREG)) and At(xapopebo->TIPOOPRAP,'|25|39|40') > 0
]
h=[
19
19
]
obj='If
pag=20
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5181
fatherSonIndex=0
frm_calc='xapopebo->NUMPROG
len=11
name='_rifimp
obj='Var
pag=20
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5176
fatherSonIndex=1
frm_calc=[
'(At(xapopebo->STATOREG,'|0|1') > 0 or Empty(xapopebo->STATOREG)) and At(xapopebo->TIPOOPRAP,'|28|41|47') > 0
]
h=[
19
19
]
obj='If
pag=20
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5189
fatherSonIndex=0
frm_calc='xapopebo->NUMPROG
len=11
name='_rifimp
obj='Var
pag=20
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=20
prev=O5032
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xapopebo
father=O5033
fatherSonIndex=0
obj='Read
pag=20
rd_field=[
'NUMPROG
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'LRTrim(Substr(riga,60,10))
]
rd_var=[
'_rifimp
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=20
prev=O5031
var_op='asgn
I
obj='Var
obj_type='D
pag=20
prev=O5030
var_op='asgn
I
obj='Var
pag=20
prev=O5029
var_op='asgn
I
obj='Var
pag=20
prev=O5028
var_op='asgn
I
obj='Var
obj_type='M
pag=20
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=20
prev=O5016
var_op='asgn
I
obj='Var
obj_type='N
pag=20
prev=O5015
var_op='asgn
I
obj='Var
obj_type='N
pag=20
prev=O5014
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=20
prev=O5013
var_op='asgn
I
obj='Var
pag=20
pagelocal=True
prev=O5012
I
obj='Var
pag=20
pagelocal=True
prev=O5010
I
obj='Begin
pag=20
prev=O5009
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5010
fatherSonIndex=0
frm_calc=[
'At("procdel",_tabelle)=0
]
h=[
19
19
]
obj='If
pag=20
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5210
fatherSonIndex=0
frm_calc='_tabelle+"procdel,"
len=10
name='_tabelle
obj='Var
obj_type='M
pag=20
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=20
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file SOGOPE.TXT altri soggetti operanti in Provvisorio
next=Icpitembatch.CPBeginEnd
comment='Gestione storico import
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Soggetti operanti inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Soggetti operanti aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=21
prev=O5231
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=21
prev=O5230
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=21
prev=O5229
var_op='asgn
I
obj='Exec
pag=21
prev=O5228
I
obj='Exec
pag=21
prev=O5227
I
obj='Exec
pag=21
prev=O5225
I
obj='While
pag=21
prev=O5224
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5225
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_salta
next=Icpitembatch.CPRemark
frm_calc='Verfico la presenza di _unicode nelle tabelle rapopebo/operazbo/fraziobo
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,48,1)='I'
'Substr(riga,48,1)='O'
'Substr(riga,48,1)='F'
]
h=[
19
19
19
19
]
obj='Case
pag=21
prev=O5239
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5240
fatherSonIndex=0
frm_calc='''
len=25
name='_rapcol
next=Icpitembatch.CPRead
arch='xapopebo
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=21
prev=O5246
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5247
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xoginfo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=21
prev=O5254
var_op='asgn
I
obj='Insert
pag=21
prev=O5252
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'NUMIMP
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cInfProg2
'Substr(riga,48,1)
'_rapcol
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5254
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=21
prev=O5263
I
obj='Var
obj_type='N
pag=21
prev=O5262
var_op='asgn
I
obj='Exec
pag=21
prev=O5261
I
nonlocal=True
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=21
sel_field='*
sel_name='xoginfo
sel_where='xoginfo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5252
fatherSonIndex=0
frm_calc='xoginfo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=21
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=21
prev=O5245
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
'RAPPORTO
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cInfProg2
'_unicode
'_rapcol
]
I
obj='Var
pag=21
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O5240
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=21
prev=O5276
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPSelect
father=O5277
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xogopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=21
prev=O5284
var_op='asgn
I
obj='Insert
pag=21
prev=O5282
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'NUMIMP
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cOpeProg2
'Substr(riga,48,1)
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5284
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=21
prev=O5293
I
obj='Var
obj_type='N
pag=21
prev=O5292
var_op='asgn
I
obj='Exec
pag=21
prev=O5291
I
nonlocal=True
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=21
sel_field='*
sel_name='xogopebo
sel_where='xogopebo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5282
fatherSonIndex=0
frm_calc='xogopebo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=21
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=21
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_idbase
'cInfProg2
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O5240
fatherSonIndex=2
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=21
prev=O5306
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPSelect
father=O5307
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xogopefbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_salta
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=21
prev=O5316
var_op='asgn
I
obj='Var
obj_type='N
pag=21
prev=O5314
var_op='asgn
I
obj='Insert
pag=21
prev=O5312
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'NUMIMP
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cOpeProg2
'Substr(riga,48,1)
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5314
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=21
prev=O5324
I
obj='Var
obj_type='N
pag=21
prev=O5323
var_op='asgn
I
obj='Exec
pag=21
prev=O5322
I
nonlocal=True
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=21
sel_field='*
sel_name='xogopefbo
sel_where='xogopefbo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5312
fatherSonIndex=0
frm_calc='xogopefbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=21
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=21
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cInfProg2
'_unicode
]
I
I
]
w=[
150
150
150
150
]
I
obj='Remark
pag=21
prev=O5238
I
obj='Var
obj_type='N
pag=21
prev=O5237
var_op='asgn
I
obj='Var
pag=21
prev=O5236
var_op='asgn
I
obj='Var
obj_type='N
pag=21
prev=O5235
var_op='asgn
I
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=21
prev=O5223
var_op='asgn
I
obj='Var
obj_type='N
pag=21
prev=O5222
var_op='asgn
I
obj='Var
pag=21
prev=O5221
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=21
prev=O5219
var_op='asgn
I
obj='Begin
pag=21
prev=O5218
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5219
fatherSonIndex=0
frm_calc=[
'At("sogope",_tabelle)=0
]
h=[
19
19
]
obj='If
pag=21
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5340
fatherSonIndex=0
frm_calc='_tabelle+"sogope,"
len=10
name='_tabelle
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=21
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file INTEST.TXT altri intestatari
next=Icpitembatch.CPBeginEnd
comment='Gestione storico import
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Intestatari inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Intestatari aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=22
prev=O5361
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=22
prev=O5360
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=22
prev=O5359
var_op='asgn
I
obj='Exec
pag=22
prev=O5358
I
obj='Exec
pag=22
prev=O5357
I
obj='Exec
pag=22
prev=O5355
I
obj='While
pag=22
prev=O5354
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5355
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPRemark
frm_calc='Verifico in intestbo che ci sia già un recod con lo stesso codice rapporto e memorizzo i dati della riga necessari per crearne una nuova.
next=Icpitembatch.CPSelect
h=[
19
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Se trovo il record inserisco il nuovo intestatario
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
]
obj='If
pag=22
prev=O5371
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xntestbo
father=O5372
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=22
prev=O5377
var_op='asgn
I
obj='Insert
pag=22
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
'NUMIMP
]
rd_kvar=[
'ciidbase
'cMaxRow + 1
'cidataini
'iif(Empty(Substr(riga,121,1)) ,'P',Substr(riga,121,1))
'Substr(riga,26,16)
'cinumprog
'Substr(riga,1,25)
'citiporap
''0'
'DateToChar(cidataini)+cinumprog+'O'
'Left(LRTrim(Substr(riga,26,16))+Space(5),16)
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5377
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=22
prev=O5386
I
obj='Var
obj_type='N
pag=22
prev=O5385
var_op='asgn
I
obj='Exec
pag=22
prev=O5384
I
nonlocal=True
obj='Var
obj_type='M
pag=22
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=22
prev=O5369
I
obj='Select
pag=22
prev=O5368
sel_field='*
sel_name='xntestbo
sel_order='xntestbo->CPROWNUM
sel_where='xntestbo->RAPPORTO=Substr(riga,1,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5369
fatherSonIndex=0
frm_calc=[
'Substr(riga,26,16)=xntestbo->CODINTER
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->CPROWNUM
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->IDBASE
len=10
name='ciidbase
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->DATAINI
len=8
name='cidataini
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->DATAFINE
len=8
name='cidatafine
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->CODINTER
len=12
name='cicodinter
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->NUMPROG1
len=11
name='cinumprog
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->TIPORAP
len=1
name='citiporap
obj='Var
pag=22
prev=O5400
var_op='asgn
I
obj='Var
pag=22
prev=O5399
var_op='asgn
I
obj='Var
pag=22
prev=O5398
var_op='asgn
I
obj='Var
obj_type='D
pag=22
prev=O5397
var_op='asgn
I
obj='Var
obj_type='D
pag=22
prev=O5396
var_op='asgn
I
obj='Var
pag=22
prev=O5395
var_op='asgn
I
obj='Var
obj_type='N
pag=22
prev=O5392
var_op='asgn
I
obj='If
pag=22
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5392
fatherSonIndex=0
frm_calc='xntestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=22
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5369
fatherSonIndex=1
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=22
prev=O5409
I
obj='Var
obj_type='N
pag=22
prev=O5408
var_op='asgn
I
obj='Exec
pag=22
prev=O5407
I
nonlocal=True
obj='Var
obj_type='M
pag=22
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
150
]
I
obj='Remark
pag=22
prev=O5367
I
obj='Var
obj_type='N
pag=22
prev=O5366
var_op='asgn
I
obj='Var
obj_type='N
pag=22
prev=O5365
var_op='asgn
I
obj='Var
obj_type='M
pag=22
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=22
prev=O5353
var_op='asgn
I
obj='Var
obj_type='N
pag=22
prev=O5352
var_op='asgn
I
obj='Var
pag=22
prev=O5351
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=22
prev=O5349
var_op='asgn
I
obj='Begin
pag=22
prev=O5348
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5349
fatherSonIndex=0
frm_calc=[
'At("intest",_tabelle)=0
]
h=[
19
19
]
obj='If
pag=22
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5415
fatherSonIndex=0
frm_calc='_tabelle+"intest,"
len=10
name='_tabelle
obj='Var
obj_type='M
pag=22
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=22
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Deleghe sui rapporti
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Deleghe Rapporti Inserite: '+LRTrim(Str(cNumNew,10,0)) + " - Deleghe Rapporti Aggiornate: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=23
prev=O5434
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=23
prev=O5433
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=23
prev=O5432
var_op='asgn
I
obj='Exec
pag=23
prev=O5431
I
obj='Exec
pag=23
prev=O5430
I
obj='Exec
pag=23
prev=O5428
I
obj='While
pag=23
prev=O5427
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5428
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPRead
arch='jelegabo
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,46,4)+Substr(riga,44,2)+Substr(riga,42,2)
len=8
name='xData
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,55,4)+Substr(riga,53,2)+Substr(riga,51,2)
len=8
name='xDatF
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=23
prev=O5442
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPSelect
father=O5443
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='jelegabo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=23
prev=O5451
var_op='asgn
I
obj='Insert
pag=23
prev=O5450
rd_kfield=[
'RAPPORTO
'CPROWNUM
'CODINTER
'DATAINI
'TIPORAP
'DATAFINE
'IDBASE
'NOAGE
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
'Substr(riga,26,16)
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
'LibreriaMit.UniqueId()
'iif(Empty(LRTrim(Substr(riga,59,1))),'N',Substr(riga,59,1))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5451
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=23
prev=O5460
I
obj='Var
obj_type='N
pag=23
prev=O5459
var_op='asgn
I
obj='Exec
pag=23
prev=O5458
I
nonlocal=True
obj='Var
obj_type='M
pag=23
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=23
prev=O5448
var_op='asgn
I
obj='Select
pag=23
sel_field='*
sel_name='jelegabo
sel_order='jelegabo->CPROWNUM
sel_where='jelegabo->RAPPORTO=Left(riga,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5448
fatherSonIndex=0
frm_calc='jelegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=23
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='jelegabo
father=O5443
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=23
prev=O5468
var_op='asgn
I
obj='Write
pag=23
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5468
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=23
prev=O5478
I
obj='Var
obj_type='N
pag=23
prev=O5477
var_op='asgn
I
obj='Exec
pag=23
prev=O5476
I
nonlocal=True
obj='Var
obj_type='M
pag=23
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'TIPORAP
'DATAFINE
]
wr_op=[
'=
'=
'=
]
wr_var=[
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=23
prev=O5441
var_op='asgn
I
obj='Var
pag=23
prev=O5440
var_op='asgn
I
obj='Read
pag=23
prev=O5439
rd_field=[
'CPROWNUM
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,16)
]
rd_var=[
'cMaxRow
]
I
obj='Var
obj_type='N
pag=23
prev=O5438
var_op='asgn
I
obj='Var
obj_type='M
pag=23
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=23
prev=O5426
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=23
prev=O5425
var_op='asgn
I
obj='Var
obj_type='N
pag=23
prev=O5424
var_op='asgn
I
obj='Var
obj_type='N
pag=23
prev=O5423
var_op='asgn
I
obj='Remark
pag=23
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file SOGAGE.TXT altri soggetti operanti in Provvisorio
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Soggetti operanti inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Soggetti operanti aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=24
prev=O5501
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=24
prev=O5500
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=24
prev=O5499
var_op='asgn
I
obj='Exec
pag=24
prev=O5498
I
obj='Exec
pag=24
prev=O5497
I
obj='Exec
pag=24
prev=O5495
I
obj='While
pag=24
prev=O5494
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5495
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_salta
next=Icpitembatch.CPRemark
frm_calc='Verfico la presenza di _unicode nelle tabelle rapopebo/operazbo/fraziobo
next=Icpitembatch.CPRead
arch='japopebo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=24
prev=O5510
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5512
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='joginfo
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=24
prev=O5519
var_op='asgn
I
obj='Insert
pag=24
prev=O5517
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
]
rd_kvar=[
'_unicode
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'_unicode
'cInfProg2
'Substr(riga,48,1)
'Substr(riga,50,25)
]
I
obj='Select
pag=24
sel_field='*
sel_name='joginfo
sel_where='joginfo->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5517
fatherSonIndex=0
frm_calc='joginfo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=24
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=24
prev=O5509
rd_field=[
'IDBASE
'NUMPROG
]
rd_kfield=[
'IDBASE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_unicode
'cInfProg2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='jperazbo
father=O5510
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=24
prev=O5534
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5536
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='jogopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=24
prev=O5543
var_op='asgn
I
obj='Insert
pag=24
prev=O5541
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
]
rd_kvar=[
'_unicode
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'_unicode
'cOpeProg2
'Substr(riga,48,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5543
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=24
prev=O5552
I
obj='Var
obj_type='N
pag=24
prev=O5551
var_op='asgn
I
obj='Exec
pag=24
prev=O5550
I
nonlocal=True
obj='Var
obj_type='M
pag=24
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=24
sel_field='*
sel_name='jogopebo
sel_where='jogopebo->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5541
fatherSonIndex=0
frm_calc='jogopebo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=24
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=24
rd_field=[
'IDBASE
'NUMPROG
]
rd_kfield=[
'IDBASE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
'cOpeProg2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5534
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errore nella valorizazione del campo IDFILEBO nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,21,16)+" non risulta associabile a nessuna informazione/operazione.  Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_salta
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=24
prev=O5569
I
obj='Var
obj_type='N
pag=24
prev=O5568
var_op='asgn
I
obj='Exec
pag=24
prev=O5567
I
obj='Var
obj_type='N
pag=24
prev=O5566
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=24
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Remark
pag=24
prev=O5508
I
obj='Var
obj_type='N
pag=24
prev=O5507
var_op='asgn
I
obj='Var
pag=24
prev=O5506
var_op='asgn
I
obj='Var
obj_type='N
pag=24
prev=O5505
var_op='asgn
I
obj='Var
obj_type='M
pag=24
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=24
prev=O5493
var_op='asgn
I
obj='Var
obj_type='N
pag=24
prev=O5492
var_op='asgn
I
obj='Var
obj_type='N
pag=24
prev=O5491
var_op='asgn
I
obj='Var
pag=24
prev=O5490
var_op='asgn
I
obj='Remark
pag=24
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file INTAGE.TXT altri intestatari
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Intestatari inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Intestatari aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=25
prev=O5585
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=25
prev=O5584
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=25
prev=O5583
var_op='asgn
I
obj='Exec
pag=25
prev=O5582
I
obj='Exec
pag=25
prev=O5581
I
obj='Exec
pag=25
prev=O5579
I
obj='While
pag=25
prev=O5578
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5579
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPRemark
frm_calc='Verifico in intestbo che ci sia già un recod con lo stesso codice rapporto e memorizzo i dati della riga necessari per crearne una nuova.
next=Icpitembatch.CPSelect
h=[
19
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Se trovo il record inserisco il nuovo intestatario
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
]
obj='If
pag=25
prev=O5595
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='jntestbo
father=O5596
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=25
prev=O5601
var_op='asgn
I
obj='Insert
pag=25
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
]
rd_kvar=[
'ciidbase
'cMaxRow + 1
'cidataini
'iif(Empty(Substr(riga,121,1)) ,'P',Substr(riga,121,1))
'Substr(riga,26,16)
'cinumprog
'Substr(riga,1,25)
'citiporap
''0'
'DateToChar(cidataini)+cinumprog+'O'
'Left(LRTrim(Substr(riga,26,16))+Space(5),16)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5601
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=25
prev=O5610
I
obj='Var
obj_type='N
pag=25
prev=O5609
var_op='asgn
I
obj='Exec
pag=25
prev=O5608
I
nonlocal=True
obj='Var
obj_type='M
pag=25
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=25
prev=O5593
I
obj='Select
pag=25
prev=O5592
sel_field='*
sel_name='jntestbo
sel_order='jntestbo->CPROWNUM
sel_where='jntestbo->RAPPORTO=Substr(riga,1,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5593
fatherSonIndex=0
frm_calc=[
'Substr(riga,26,16)=jntestbo->CODINTER
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->CPROWNUM
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->IDBASE
len=10
name='ciidbase
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->DATAINI
len=8
name='cidataini
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->DATAFINE
len=8
name='cidatafine
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->CODINTER
len=12
name='cicodinter
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->NUMPROG1
len=11
name='cinumprog
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->TIPORAP
len=1
name='citiporap
obj='Var
pag=25
prev=O5624
var_op='asgn
I
obj='Var
pag=25
prev=O5623
var_op='asgn
I
obj='Var
pag=25
prev=O5622
var_op='asgn
I
obj='Var
obj_type='D
pag=25
prev=O5621
var_op='asgn
I
obj='Var
obj_type='D
pag=25
prev=O5620
var_op='asgn
I
obj='Var
pag=25
prev=O5619
var_op='asgn
I
obj='Var
obj_type='N
pag=25
prev=O5616
var_op='asgn
I
obj='If
pag=25
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5616
fatherSonIndex=0
frm_calc='jntestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=25
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5593
fatherSonIndex=1
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=25
prev=O5633
I
obj='Var
obj_type='N
pag=25
prev=O5632
var_op='asgn
I
obj='Exec
pag=25
prev=O5631
I
nonlocal=True
obj='Var
obj_type='M
pag=25
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
150
]
I
obj='Remark
pag=25
prev=O5591
I
obj='Var
obj_type='N
pag=25
prev=O5590
var_op='asgn
I
obj='Var
obj_type='N
pag=25
prev=O5589
var_op='asgn
I
obj='Var
obj_type='M
pag=25
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=25
prev=O5577
var_op='asgn
I
obj='Var
obj_type='N
pag=25
prev=O5576
var_op='asgn
I
obj='Var
obj_type='N
pag=25
prev=O5575
var_op='asgn
I
obj='Var
pag=25
prev=O5574
var_op='asgn
I
obj='Remark
pag=25
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPBeginEnd
comment='Gestione storico import
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Intestatari Operazioni Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Intestatari Operazioni Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=26
prev=O5650
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=26
prev=O5649
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=26
prev=O5648
var_op='asgn
I
obj='Exec
pag=26
prev=O5647
I
obj='Exec
pag=26
prev=O5646
I
obj='Exec
pag=26
prev=O5644
I
obj='While
pag=26
prev=O5643
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5644
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,48,1)='F'
'Substr(riga,48,1)='O'
]
h=[
19
19
19
]
obj='If
pag=26
prev=O5657
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O5658
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=26
prev=O5663
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O5664
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=26
prev=O5669
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientifrz
father=O5670
fatherSonIndex=0
obj='Insert
pag=26
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'PROQUOTA
'IMPSARA
'NUMIMP
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Val(Substr(riga,75,3))
'Val(Substr(riga,78,19))/100
'_numimp
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=26
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientifrz
father=O5664
fatherSonIndex=1
obj='Insert
pag=26
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'PROQUOTA
'IMPSARA
'NUMIMP
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Val(Substr(riga,75,3))
'Val(Substr(riga,78,19))/100
'_numimp
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=26
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O5658
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=26
prev=O5693
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O5694
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=26
prev=O5699
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O5700
fatherSonIndex=0
obj='Insert
pag=26
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'PROQUOTA
'IMPSARA
'NUMIMP
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Val(Substr(riga,75,3))
'Val(Substr(riga,78,19))/100
'_numimp
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=26
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientiope
father=O5694
fatherSonIndex=1
obj='Insert
pag=26
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'PROQUOTA
'IMPSARA
'NUMIMP
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Val(Substr(riga,75,3))
'Val(Substr(riga,78,19))/100
'_numimp
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=26
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=26
prev=O5656
var_op='asgn
I
obj='Var
obj_type='N
pag=26
prev=O5655
var_op='asgn
I
obj='Var
obj_type='N
pag=26
prev=O5654
var_op='asgn
I
obj='Var
obj_type='M
pag=26
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=26
prev=O5642
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=26
prev=O5641
var_op='asgn
I
obj='Var
obj_type='N
pag=26
prev=O5640
var_op='asgn
I
obj='Var
obj_type='N
pag=26
prev=O5638
var_op='asgn
I
obj='Begin
pag=26
prev=O5637
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5638
fatherSonIndex=0
frm_calc=[
'At("sogcli",_tabelle)=0
]
h=[
19
19
]
obj='If
pag=26
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5726
fatherSonIndex=0
frm_calc='_tabelle+"sogcli,"
len=10
name='_tabelle
obj='Var
obj_type='M
pag=26
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=26
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPBeginEnd
comment='Gestione storico import
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Altri Soggetti Operazioni Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Altri Soggetti Operazioni Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=29
prev=O5747
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=29
prev=O5746
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=29
prev=O5745
var_op='asgn
I
obj='Exec
pag=29
prev=O5744
I
obj='Exec
pag=29
prev=O5743
I
obj='Exec
pag=29
prev=O5741
I
obj='While
pag=29
prev=O5740
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5741
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,48,1)='F'
'Substr(riga,48,1)='O'
]
h=[
19
19
19
]
obj='If
pag=29
prev=O5754
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O5755
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=29
prev=O5760
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O5761
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=29
prev=O5766
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistifrz
father=O5767
fatherSonIndex=0
obj='Insert
pag=29
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'NUMIMP
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'_numimp
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=29
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xerzistifrz
father=O5761
fatherSonIndex=1
obj='Insert
pag=29
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'NUMIMP
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'_numimp
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=29
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O5755
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=29
prev=O5790
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O5791
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=29
prev=O5796
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistiope
father=O5797
fatherSonIndex=0
obj='Insert
pag=29
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'NUMIMP
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'_numimp
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=29
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xerzistiope
father=O5791
fatherSonIndex=1
obj='Insert
pag=29
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'NUMIMP
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'_numimp
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=29
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=29
prev=O5753
var_op='asgn
I
obj='Var
obj_type='N
pag=29
prev=O5752
var_op='asgn
I
obj='Var
obj_type='N
pag=29
prev=O5751
var_op='asgn
I
obj='Var
obj_type='M
pag=29
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=29
prev=O5739
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=29
prev=O5738
var_op='asgn
I
obj='Var
obj_type='N
pag=29
prev=O5737
var_op='asgn
I
obj='Var
obj_type='N
pag=29
prev=O5735
var_op='asgn
I
obj='Begin
pag=29
prev=O5734
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5735
fatherSonIndex=0
frm_calc=[
'At("sogaltro",_tabelle)=0
]
h=[
19
19
]
obj='If
pag=29
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5823
fatherSonIndex=0
frm_calc='_tabelle+"sogaltro,"
len=10
name='_tabelle
obj='Var
obj_type='M
pag=29
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=29
x=23
y=25
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPBeginEnd
comment='Gestione storico import
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Beneficiari Operazioni Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Beneficiari Operazioni Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=28
prev=O5844
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=28
prev=O5843
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=28
prev=O5842
var_op='asgn
I
obj='Exec
pag=28
prev=O5841
I
obj='Exec
pag=28
prev=O5840
I
obj='Exec
pag=28
prev=O5838
I
obj='While
pag=28
prev=O5837
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5838
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=28
prev=O5848
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5849
fatherSonIndex=0
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='_rapcol
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,48,1)='F'
'Substr(riga,48,1)='O'
'Substr(riga,48,1)='I'
]
h=[
19
19
19
19
]
obj='If
pag=28
prev=O5857
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O5858
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=28
prev=O5863
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O5864
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=28
prev=O5869
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5870
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='beneficfrz
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O5878
var_op='asgn
I
obj='Insert
pag=28
prev=O5877
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'Substr(riga,75,70)
'Substr(riga,145,3)
'Substr(riga,148,30)
'Substr(riga,178,6)
'Substr(riga,184,2)
'Substr(riga,186,35)
'Substr(riga,221,5)
'cMaxRow
]
I
obj='Var
obj_type='N
pag=28
prev=O5875
var_op='asgn
I
obj='Select
pag=28
sel_field='*
sel_name='beneficfrz
sel_order='beneficfrz->CPROWNUM
sel_where='beneficfrz->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5875
fatherSonIndex=0
frm_calc='beneficfrz->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5864
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='xeneficfrz
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O5895
var_op='asgn
I
obj='Insert
pag=28
prev=O5894
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
'NUMIMP
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'Substr(riga,75,70)
'Substr(riga,145,3)
'Substr(riga,148,30)
'Substr(riga,178,6)
'Substr(riga,184,2)
'Substr(riga,186,35)
'Substr(riga,221,5)
'cMaxRow
'_numimp
]
I
obj='Var
obj_type='N
pag=28
prev=O5892
var_op='asgn
I
obj='Select
pag=28
sel_field='*
sel_name='xeneficfrz
sel_order='xeneficfrz->CPROWNUM
sel_where='xeneficfrz->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5892
fatherSonIndex=0
frm_calc='xeneficfrz->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O5858
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=28
prev=O5909
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O5910
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=28
prev=O5915
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5916
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='beneficope
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O5924
var_op='asgn
I
obj='Insert
pag=28
prev=O5923
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'Substr(riga,75,70)
'Substr(riga,145,3)
'Substr(riga,148,30)
'Substr(riga,178,6)
'Substr(riga,184,2)
'Substr(riga,186,35)
'Substr(riga,221,5)
'cMaxRow
]
I
obj='Var
obj_type='N
pag=28
prev=O5921
var_op='asgn
I
obj='Select
pag=28
sel_field='*
sel_name='beneficope
sel_order='beneficope->CPROWNUM
sel_where='beneficope->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5921
fatherSonIndex=0
frm_calc='beneficope->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5910
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='xeneficope
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O5941
var_op='asgn
I
obj='Insert
pag=28
prev=O5940
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
'NUMIMP
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'Substr(riga,75,70)
'Substr(riga,145,3)
'Substr(riga,148,30)
'Substr(riga,178,6)
'Substr(riga,184,2)
'Substr(riga,186,35)
'Substr(riga,221,5)
'cMaxRow
'_numimp
]
I
obj='Var
obj_type='N
pag=28
prev=O5938
var_op='asgn
I
obj='Select
pag=28
sel_field='*
sel_name='xeneficope
sel_order='xeneficope->CPROWNUM
sel_where='xeneficope->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5938
fatherSonIndex=0
frm_calc='xeneficope->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xapopebo
father=O5858
fatherSonIndex=2
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=28
prev=O5955
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='rapopebo
father=O5956
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=28
prev=O5961
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='fiduciabo
father=O5962
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O5967
var_op='asgn
I
obj='Insert
pag=28
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'NUMIMP
'RAPCOL
]
rd_kvar=[
'LRTrim(_unicode)
'LRTrim(Substr(riga,21,16))
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'_numimp
'LRTrim(_rapcol)
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
'RAPPORTO
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'LRTrim(Substr(riga,11,10))
]
rd_var=[
'_unicode
'_rapcol
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xiduciabo
father=O5956
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O5977
var_op='asgn
I
obj='Insert
pag=28
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'NUMIMP
'RAPCOL
]
rd_kvar=[
'LRTrim(_unicode)
'LRTrim(Substr(riga,21,16))
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'_numimp
'LRTrim(_rapcol)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
'RAPPORTO
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'LRTrim(Substr(riga,11,10))
]
rd_var=[
'_unicode
'_rapcol
]
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=28
prev=O5856
var_op='asgn
I
obj='Var
pag=28
prev=O5855
var_op='asgn
I
obj='Var
obj_type='N
pag=28
prev=O5854
var_op='asgn
I
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=28
prev=O5836
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=28
prev=O5835
var_op='asgn
I
obj='Var
obj_type='N
pag=28
prev=O5834
var_op='asgn
I
obj='Var
obj_type='N
pag=28
prev=O5832
var_op='asgn
I
obj='Begin
pag=28
prev=O5831
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5832
fatherSonIndex=0
frm_calc=[
'At("sogben",_tabelle)=0
]
h=[
19
19
]
obj='If
pag=28
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5991
fatherSonIndex=0
frm_calc='_tabelle+"sogben,"
len=10
name='_tabelle
obj='Var
obj_type='M
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=28
x=21
y=20
I
Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumInv
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPBeginEnd
comment='Gestione storico import
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='nProgSto
next=Icpitembatch.CPVarDecl
frm_calc='0
len=15
name='nProgImp
next=Ispitembatch.CPMemoryCursor
data_source='tbcitta
expected_rows=10000
key_expression='tbcitta->CITTA
mem_curs_name='mcTBCITTA
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'nProgImp > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'nProgSto > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Soggetti Inseriti: '+LRTrim(Str(cNumNew,10,0)) + ' - Soggetti Aggiornati: '+LRTrim(Str(cNumMod,10,0)) + ' - Soggetti Invariati: '+LRTrim(Str(cNumInv,10,0)) + ' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','PERSNEW','Soggetti Inseriti: '+LRTrim(Str(cNumNew,10,0)) + ' - Soggetti Aggiornati: '+LRTrim(Str(cNumMod,10,0)) + ' - Soggetti Invariati: '+LRTrim(Str(cNumInv,10,0)))
obj='Exec
pag=30
prev=O6025
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O6024
var_op='asgn
I
obj='Exec
pag=30
prev=O6023
I
obj='Exec
pag=30
prev=O6022
I
obj='Exec
pag=30
prev=O6021
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O6020
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O6017
var_op='asgn
I
obj='If
pag=30
prev=O6014
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O6017
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'm_nUpdatedRows=0
]
h=[
19
19
]
obj='If
pag=30
prev=O6029
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O6030
fatherSonIndex=0
obj='Insert
pag=30
rd_kfield=[
'tablecode
'warncode
'autonum
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
'nProgSto + 1
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=30
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'nProgSto + 1
]
I
I
]
w=[
150
150
]
I
obj='If
pag=30
prev=O6012
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O6014
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'm_nUpdatedRows=0
]
h=[
19
19
]
obj='If
pag=30
prev=O6048
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O6049
fatherSonIndex=0
obj='Insert
pag=30
rd_kfield=[
'tablecode
'warncode
'autonum
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
'nProgImp + 1
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=30
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'nProgImp + 1
]
I
I
]
w=[
150
150
]
I
obj='While
pag=30
prev=O6011
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6012
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=30
prev=O6067
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6068
fatherSonIndex=0
frm_calc=[
'w_creamo='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datvarage
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' nominativi del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,112,16)
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,112,16)
len=16
name='xCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,496,16)
len=16
name='_conadd
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(_conadd)),cCli1,_conadd)
len=16
name='cCli1
next=Icpitembatch.CPRemark
frm_calc='Prima la Read si faceva per CF
next=Icpitembatch.CPBeginEnd
comment='Azzera vecchi valori
h=[
19
19
]
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_flgvali
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_flganag
next=Icpitembatch.CPRead
arch='personbo_agg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,288,1))),'G','P')
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,288,1)='M','1',iif(Substr(riga,288,1)='F','2',Substr(riga,288,1)))
len=1
name='xSesso
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,458,1)='0' or Substr(riga,458,1)='1' or Substr(riga,458,1) = ''
'Substr(riga,458,1)='N' or Substr(riga,458,1)='S'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgvali='S',0,xCFE)
len=1
name='xCFE
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgvali='S',Upper(_oldcf),Upper(LRTrim(Substr(riga,112,16))))
len=16
name='xCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,6)
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,260,2))
len=2
name='xPrv
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCodCab))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,136,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'(Substr(xCF,12,1) = 'Z' or Substr(riga,456,2)='EE') and (Substr(riga,288,1)='M' or Substr(riga,288,1)='F')
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Assegna Valori in base a flag
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xConnes)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=30
prev=O6115
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6117
fatherSonIndex=0
frm_calc='nProgImp + 1
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='personbo
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='personbo_agg
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=30
prev=O6125
var_op='asgn
I
obj='Insert
pag=30
prev=O6123
rd_kfield=[
'CONNES
'FLGPREGIUD
'FLGTRUST
'FLGRISCHIO
'FLGEQUIFIN
'FLGFALSADIC
'FLGRICINF
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
]
rd_kvar=[
'LRTrim(cCli1)
'iif(Empty(Substr(riga,605,1)),'N',Substr(riga,605,1))
'iif(Empty(Substr(riga,606,1)),'N',Substr(riga,606,1))
'iif(Empty(Substr(riga,607,1)),'N',Substr(riga,607,1))
'iif(Empty(Substr(riga,608,1)),'N',Substr(riga,608,1))
'iif(Empty(Substr(riga,609,1)),'N',Substr(riga,609,1))
'iif(Empty(Substr(riga,610,1)),'N',Substr(riga,610,1))
'Substr(riga,595,2)
'Substr(riga,597,2)
'Substr(riga,599,2)
'Substr(riga,601,2)
'Substr(riga,603,2)
'Substr(riga,595,2)+Substr(riga,597,2)+Substr(riga,599,2)+Substr(riga,601,2)+Substr(riga,603,2)
]
I
obj='Insert
pag=30
prev=O6122
rd_kfield=[
'ALLINEATO
'ALLINEATONOMECNOME
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'CONNES
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROGIMPORT
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'TIPOPERS
'DATAVARAGE
'FATCA
'TIN
'ODB
'TIPOORO
'CODORO
'NOTIT
'MITIG
'NOSARA
'RISGLOB
'DATAPROF
'DATAREVPROF
'IDENT
'NUMIMP
'DATASEGN
'DATARAUT
]
rd_kvar=[
'0
'0
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,478,5)),3))
'Substr(riga,468,10)
'Substr(riga,200,30)
'Substr(riga,265,9)
'xCFE
'xCodCab
'xCF
'_oldcog
'Upper(Substr(riga,463,5))
'LRTrim(cCli1)
'_oldndt
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Upper(Substr(riga,230,30))
'Substr(riga,356,100)
'Substr(riga,77,35)
'_oldncm
'_oldnst
'_oldnom
'Substr(riga,177,15)
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'iif(Empty(Substr(riga,495,1)),'N',Substr(riga,495,1))
'Substr(riga,459,4)
'nProgImp
'Upper(Substr(riga,260,2))
'_oldrgs
'_oldrgs
'Substr(riga,169,3)
'Val(Substr(riga,492,3))
'Val(Substr(riga,489,3))
'Val(Substr(riga,486,3))
'Val(Substr(riga,483,3))
'_oldnsx
'Substr(riga,172,3)
'Substr(riga,166,3)
'_oldnpv
'Substr(riga,175,2)
'_tipper
'_datvarage
'Substr(riga,520,3)
'Substr(riga,523,16)
'iif(Empty(Substr(riga,539,1)),0,Val(Substr(riga,539,1)))
'Substr(riga,555,1)
'Substr(riga,556,11)
'iif(Empty(LRTrim(Substr(riga,567,1))),0,Val(Substr(riga,567,1)))
'iif(Empty(LRTrim(Substr(riga,568,4))),0,Val(Substr(riga,568,4)))
'iif(Empty(LRTrim(Substr(riga,572,1))) or Substr(riga,572,1)='0' or Substr(riga,572,1)='N','N','S')
'Substr(riga,589,3)
'iif(not(Empty(Substr(riga,565,8))),CharToDate(Substr(riga,573,8)),NullDate())
'iif(not(Empty(Substr(riga,573,8))),CharToDate(Substr(riga,581,8)),NullDate())
'Substr(riga,592,3)
'_numimp
'iif(not(Empty(Substr(riga,611,8))),CharToDate(Substr(riga,611,8)),NullDate())
'iif(not(Empty(Substr(riga,619,8))),CharToDate(Substr(riga,619,8)),NullDate())
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6123
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+LRTrim(Substr(riga,7,70))+" con codice fiscale: "+LRTrim(Substr(riga,112,16))+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore Import file PersNew.txt. Operazione Abortita. Non sono stati importati dati
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=30
prev=O6137
I
obj='Transaction
pag=30
prev=O6136
I
obj='Exec
pag=30
prev=O6135
I
obj='Var
obj_type='N
pag=30
prev=O6134
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O6133
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6117
fatherSonIndex=1
frm_calc='0
len=1
name='_novar
next=Icpitembatch.CPVarDecl
frm_calc='Upper(xCF)+Substr(riga,7,70)+Substr(riga,77,35)+Substr(riga,230,30)+Substr(riga,260,2)+LibreriaMit.SpacePad(LRTrim(Substr(riga,265,9)),5)+Substr(riga,262,3)+Substr(riga,166,3)+Substr(riga,169,3)+Substr(riga,172,3)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+LibreriaMit.SpacePad(Left(cCNAS,30),30)+Substr(riga,456,2)+LibreriaMit.SpacePad(Left(cSNAS,30),30)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+Substr(riga,175,2)+Substr(riga,177,15)+Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2)+Substr(riga,200,30)+Substr(riga,274,14)+xCodCab
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='Upper(xCF)+Substr(riga,7,70)+Substr(riga,230,30)+Substr(riga,260,2)
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='xRiga3+LibreriaMit.SpacePad(Left(cCNAS,30),30)+Substr(riga,456,2)+LibreriaMit.SpacePad(Left(cSNAS,30),30)
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='xRiga3+Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2)+xSesso
len=10
name='xRiga3
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgaggfam='S'
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Crea la riga di confronto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico se il soggetto è una persona fisica
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Substr(riga,516,4)+Substr(riga,514,2)+Substr(riga,512,2))
len=8
name='_datvarage
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,288,1)='M' or Substr(riga,288,1)='F'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=30
par_expr=[
'xConnes
]
par_name=[
'w_CONNES
]
prev=O6157
sel_name='qbe_aggfam_opextrbo_new
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O6160
fatherSonIndex=0
obj='Write
pag=30
rd_kfield=[
'ANNO
'COLLEG
]
rd_kop=[
'=
'=
]
rd_kvar=[
'qbe_aggfam_opextrbo_new->ANNO
'qbe_aggfam_opextrbo_new->COLLEG
]
wr_field=[
'CFESTERO
]
wr_op=[
'=
]
wr_var=[
'iif(_oldest=1,'S','N')
]
I
I
]
w=[
150
150
]
I
obj='If
pag=30
prev=O6156
sons=[
Icpitembatch.CPItemSon
comment='se persona fisica
instr=Icpitembatch.CPWrite
arch='personbo
father=O6157
fatherSonIndex=0
frm_calc='Errore in aggiornamento PERSNEW
h=[
19
19
]
next=Icpitembatch.CPMerge
arch='personbo_agg
next=Icpitembatch.CPIfElse
frm_calc=[
'_novar=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=30
prev=O6178
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6179
fatherSonIndex=0
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6179
fatherSonIndex=1
frm_calc='cNumInv + 1
len=10
name='cNumInv
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Merge
pag=30
prev=O6176
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(cCli1)
]
wr_field=[
'CONNES
'FLGPREGIUD
'FLGTRUST
'FLGRISCHIO
'FLGEQUIFIN
'FLGFALSADIC
'FLGRICINF
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
]
wr_mode=[
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(cCli1)
'iif(Empty(Substr(riga,605,1)),'N',Substr(riga,605,1))
'iif(Empty(Substr(riga,606,1)),'N',Substr(riga,606,1))
'iif(Empty(Substr(riga,607,1)),'N',Substr(riga,607,1))
'iif(Empty(Substr(riga,608,1)),'N',Substr(riga,608,1))
'iif(Empty(Substr(riga,609,1)),'N',Substr(riga,609,1))
'iif(Empty(Substr(riga,610,1)),'N',Substr(riga,610,1))
'Substr(riga,595,2)
'Substr(riga,597,2)
'Substr(riga,599,2)
'Substr(riga,601,2)
'Substr(riga,603,2)
'Substr(riga,595,2)+Substr(riga,597,2)+Substr(riga,599,2)+Substr(riga,601,2)+Substr(riga,603,2)
]
I
obj='Write
pag=30
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'xConnes
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6176
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
frm_calc='m_cLastMsgError = ""
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=30
prev=O6202
I
obj='Exec
pag=30
prev=O6201
I
obj='Var
obj_type='N
pag=30
prev=O6200
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'DATAVARAGE
'PEP
'AREAGEO
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'FATCA
'TIN
'ODB
'TIPOORO
'CODORO
'NOTIT
'MITIG
'NOSARA
'RISGLOB
'DATAPROF
'DATAREVPROF
'IDENT
'IDNASCOMUN
'IDNASSTATO
'DATASEGN
'DATARAUT
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,468,10)
'Substr(riga,200,30)
'Substr(riga,265,9)
'_oldest
'xCodCab
'xCF
'_oldcog
'Substr(riga,463,5)
'_oldndt
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Upper(Substr(riga,230,30))
'Substr(riga,356,100)
'Substr(riga,77,35)
'_oldncm
'_oldnst
'_oldnom
'Substr(riga,177,15)
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'Substr(riga,459,4)
'Upper(Substr(riga,260,2))
'_oldrgs
'_oldrgs
'Substr(riga,169,3)
'_oldnsx
'Substr(riga,172,3)
'Substr(riga,166,3)
'_oldnpv
'Substr(riga,175,2)
'_datvarage
'iif(Empty(Substr(riga,495,1)),'N',Substr(riga,495,1))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,478,5)),3))
'Val(Substr(riga,492,3))
'Val(Substr(riga,489,3))
'Val(Substr(riga,486,3))
'Val(Substr(riga,483,3))
'Substr(riga,520,3)
'Substr(riga,523,16)
'iif(Empty(Substr(riga,539,1)),0,Val(Substr(riga,539,1)))
'Substr(riga,555,1)
'Substr(riga,556,11)
'iif(Empty(LRTrim(Substr(riga,567,1))),0,Val(Substr(riga,567,1)))
'iif(Empty(LRTrim(Substr(riga,568,4))),0,Val(Substr(riga,568,4)))
'iif(Empty(LRTrim(Substr(riga,572,1))) or Substr(riga,572,1)='0' or Substr(riga,572,1)='N','N','S')
'Substr(riga,589,3)
'iif(not(Empty(Substr(riga,565,8))),CharToDate(Substr(riga,573,8)),NullDate())
'iif(not(Empty(Substr(riga,573,8))),CharToDate(Substr(riga,581,8)),NullDate())
'Substr(riga,592,3)
'''
'''
'iif(not(Empty(Substr(riga,611,8))),CharToDate(Substr(riga,611,8)),NullDate())
'iif(not(Empty(Substr(riga,619,8))),CharToDate(Substr(riga,619,8)),NullDate())
]
I
I
Icpitembatch.CPItemSon
comment='se persona giuridica
instr=Icpitembatch.CPRemark
father=O6157
fatherSonIndex=1
frm_calc='Se non è persona fisica
next=Icpitembatch.CPWrite
arch='personbo
frm_calc='Errore in aggiornamento PERSNEW
h=[
19
19
]
next=Icpitembatch.CPMerge
arch='personbo_agg
next=Icpitembatch.CPIfElse
frm_calc=[
'_novar=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=30
prev=O6212
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6213
fatherSonIndex=0
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6213
fatherSonIndex=1
frm_calc='cNumInv + 1
len=10
name='cNumInv
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Merge
pag=30
prev=O6210
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(cCli1)
]
wr_field=[
'CONNES
'FLGPREGIUD
'FLGTRUST
'FLGRISCHIO
'FLGEQUIFIN
'FLGFALSADIC
'FLGRICINF
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
]
wr_mode=[
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(cCli1)
'iif(Empty(Substr(riga,605,1)),'N',Substr(riga,605,1))
'iif(Empty(Substr(riga,606,1)),'N',Substr(riga,606,1))
'iif(Empty(Substr(riga,607,1)),'N',Substr(riga,607,1))
'iif(Empty(Substr(riga,608,1)),'N',Substr(riga,608,1))
'iif(Empty(Substr(riga,609,1)),'N',Substr(riga,609,1))
'iif(Empty(Substr(riga,610,1)),'N',Substr(riga,610,1))
'Substr(riga,595,2)
'Substr(riga,597,2)
'Substr(riga,599,2)
'Substr(riga,601,2)
'Substr(riga,603,2)
'Substr(riga,595,2)+Substr(riga,597,2)+Substr(riga,599,2)+Substr(riga,601,2)+Substr(riga,603,2)
]
I
obj='Write
pag=30
prev=O6209
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'xConnes
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6210
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=30
prev=O6235
I
obj='Var
obj_type='N
pag=30
prev=O6234
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'DATAVARAGE
'PEP
'AREAGEO
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'FATCA
'TIN
'ODB
'TIPOORO
'CODORO
'NOTIT
'MITIG
'NOSARA
'RISGLOB
'DATAPROF
'DATAREVPROF
'IDENT
'DATASEGN
'DATARAUT
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,468,10)
'Substr(riga,200,30)
'Substr(riga,265,9)
'_oldest
'xCodCab
'xCF
'_oldcog
'Substr(riga,463,5)
'_oldndt
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Upper(Substr(riga,230,30))
'Substr(riga,356,100)
'Substr(riga,77,35)
'_oldncm
'_oldnst
'_oldnom
'Substr(riga,177,15)
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'Substr(riga,459,4)
'Upper(Substr(riga,260,2))
'_oldrgs
'_oldrgs
'Substr(riga,169,3)
'_oldnsx
'Substr(riga,172,3)
'Substr(riga,166,3)
'_oldnpv
'Substr(riga,175,2)
'_datvarage
'iif(Empty(Substr(riga,495,1)),'N',Substr(riga,495,1))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,478,5)),3))
'Val(Substr(riga,492,3))
'Val(Substr(riga,489,3))
'Val(Substr(riga,486,3))
'Val(Substr(riga,483,3))
'Substr(riga,520,3)
'Substr(riga,523,16)
'iif(Empty(Substr(riga,539,1)),0,Val(Substr(riga,539,1)))
'Substr(riga,555,1)
'Substr(riga,556,11)
'iif(Empty(LRTrim(Substr(riga,567,1))),0,Val(Substr(riga,567,1)))
'iif(Empty(LRTrim(Substr(riga,568,4))),0,Val(Substr(riga,568,4)))
'iif(Empty(LRTrim(Substr(riga,572,1))) or Substr(riga,572,1)='0' or Substr(riga,572,1)='N','N','S')
'Substr(riga,589,3)
'iif(not(Empty(Substr(riga,565,8))),CharToDate(Substr(riga,573,8)),NullDate())
'iif(not(Empty(Substr(riga,573,8))),CharToDate(Substr(riga,581,8)),NullDate())
'Substr(riga,592,3)
'iif(not(Empty(Substr(riga,611,8))),CharToDate(Substr(riga,611,8)),NullDate())
'iif(not(Empty(Substr(riga,619,8))),CharToDate(Substr(riga,619,8)),NullDate())
]
I
obj='Remark
pag=30
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='D
pag=30
prev=O6155
var_op='asgn
I
obj='Remark
pag=30
prev=O6153
I
obj='Select
pag=30
prev=O6152
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Riga 2 e Riga 4 e Riga 6
father=O6153
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Se le due stringhe sono diverse, ci sono delle modifiche da fare. Quindi storicizzo in wersonbo le modifche.
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(xRiga1) <> LRTrim(xRiga2)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgaggfam='S'
]
h=[
19
19
]
obj='If
pag=30
prev=O6247
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6250
fatherSonIndex=0
frm_calc=[
'LRTrim(xRiga5) <> LRTrim(xRiga6) or w_flgforzaagg='S'
]
h=[
19
19
]
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='bat
father=O6255
fatherSonIndex=0
frm_calc='arrt_ae_agg_aetesta_sog(xConnes,_oldest)
obj='Exec
pag=30
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=30
prev=O6246
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6247
fatherSonIndex=0
frm_calc='1
len=1
name='_novar
next=Icpitembatch.CPRemark
frm_calc='Verifico se c'è già una variazione
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,297,8)))
'DateDiff(CharToDate(Substr(riga,301,4)+Substr(riga,299,2)+Substr(riga,297,2)),Date()) > 30
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
obj='If
pag=30
prev=O6271
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O6273
fatherSonIndex=0
frm_calc='Calcola il progressivo di registrazione
next=Icpitembatch.CPVarDecl
frm_calc='nProgSto + 1
len=10
name='nProgSto
next=Icpitembatch.CPVarDecl
frm_calc='Right('000000000000000'+LRTrim(Str(nProgSto,15,0)),15)
len=15
name='cProgSto
next=Icpitembatch.CPInsert
arch='wersonbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_creamo='S'
]
h=[
19
19
]
obj='If
pag=30
prev=O6281
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6283
fatherSonIndex=0
frm_calc=[
'LRTrim(xRiga3) <> LRTrim(xRiga4)
]
h=[
19
19
]
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O6288
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=30
prev=O6293
sel_field='fraziobo->IDBASE
sel_name='fraziobo
sel_where='fraziobo->CONNESCLI=xConnes or fraziobo->CONNESOPER=xConnes or fraziobo->CONNESBEN=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6295
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(gAzienda)+"'",Space(10),10)
len=10
name='cNewProg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc=''JLMNOTUV?'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='fraziobo->IDBASE
len=10
name='_idbase
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=30
prev=O6301
sel_field='*
sel_name='fraziobo
sel_where='fraziobo->IDBASE=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6302
fatherSonIndex=0
frm_calc='iif(Empty(fraziobo->FLAGRAP2),Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(fraziobo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPInsert
arch='fraziobo
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(operazbo->DATAOPE)+"F"+LibreriaMit.UniqueId()+"X"
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=30
prev=O6308
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_idbase
]
wr_field=[
'OPERAZMOD
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
'=
]
wr_var=[
'fraziobo->IDEREG
''1'
'Date()
]
I
obj='Var
pag=30
prev=O6307
var_op='asgn
I
obj='Insert
pag=30
prev=O6306
rd_kfield=[
'AREAGEO
'AUTOM
'CAMBIO
'CDATAOPE
'CDATOPE
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'MODSVOL
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
'CONNALTRO
'CONNESDOC
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'DATAIMP
'C_RAPPORTO
'PAGASOGOP
'MTCN
'IDFILE
'CDATREG
'IPCOLLEG
'ORACOLLEG
'DUCOLLEG
'ANNOOPE
]
rd_kvar=[
'fraziobo->AREAGEO
'fraziobo->AUTOM
'fraziobo->CAMBIO
'fraziobo->CDATAOPE
'fraziobo->CDATOPE
'fraziobo->CODANA
'fraziobo->CODCAB
'fraziobo->CODCAB2
'fraziobo->CODDIPE
'fraziobo->CODINT2
'fraziobo->CODINTER
'fraziobo->CODVOC
'fraziobo->COLLEG
'fraziobo->CONNESBEN
'fraziobo->CONNESCLI
'fraziobo->CONNESOPER
'fraziobo->DATAOPE
'fraziobo->DATAREG
'Date()
'fraziobo->DESC2
'fraziobo->DESCCIT
'fraziobo->DESCINTER
'fraziobo->DOCFILE
'fraziobo->FLAGCONT
'fraziobo->FLAGFRAZ
'fraziobo->FLAGLIRE
'fraziobo->FLAGRAP
'_flagrap2
'cNewProg
'fraziobo->idcauana
'fraziobo->IDEREG
'fraziobo->INFORM
'fraziobo->MODSVOL
'fraziobo->NATURA
'fraziobo->NOPROT
'fraziobo->NUMPROG
'fraziobo->OPERAG
'fraziobo->OPERATORE
'fraziobo->OPERAZMOD
'fraziobo->OPRAP
'fraziobo->PAESE
'fraziobo->PRGIMPFRZ
'fraziobo->PROV2
'fraziobo->PROVINCIA
'fraziobo->RAGIO
'fraziobo->RAPPORTBEN
'fraziobo->RAPPORTO
'fraziobo->RAREA
'fraziobo->RCOMP
'fraziobo->RESPINS
'fraziobo->RFREQ
'fraziobo->RIFIMP
'fraziobo->RIMP
'fraziobo->RRAGIO
'fraziobo->RTIPO
'fraziobo->SCOPO
'fraziobo->SEGNO
''3'
'fraziobo->TIPO
'fraziobo->TIPOINF
'fraziobo->TIPOINT2
'fraziobo->TIPOINTER
'fraziobo->TIPOLEG
'fraziobo->TIPOOPRAP
'fraziobo->TOTCONT
'fraziobo->TOTLIRE
'fraziobo->UCODE
'fraziobo->UNIQUECODE
'fraziobo->VALUTA
'fraziobo->ZCPARTE
'fraziobo->CONNALTRO
'fraziobo->CONNESDOC
'fraziobo->C_RAG
'fraziobo->C_STA
'fraziobo->C_CTA
'fraziobo->C_CAB
'fraziobo->C_PRV
'fraziobo->C_IND
'fraziobo->C_CAP
'fraziobo->DATAIMP
'fraziobo->C_RAPPORTO
'fraziobo->PAGASOGOP
'fraziobo->MTCN
'fraziobo->IDFILE
'fraziobo->CDATREG
'fraziobo->IPCOLLEG
'fraziobo->ORACOLLEG
'fraziobo->DUCOLLEG
'fraziobo->ANNOOPE
]
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=30
prev=O6300
var_op='asgn
I
obj='Var
pag=30
prev=O6299
var_op='asgn
I
obj='Var
pag=30
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=30
sel_field='operazbo->IDBASE
sel_name='operazbo
sel_where='operazbo->CONNESCLI=xConnes or operazbo->CONNESOPER=xConnes or operazbo->CONNESBEN=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6293
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",Space(10),10)
len=10
name='cNewProg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='operazbo->IDBASE
len=10
name='_idbase
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=30
prev=O6324
sel_field='*
sel_name='operazbo
sel_where='operazbo->IDBASE=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6325
fatherSonIndex=0
frm_calc='iif(Empty(operazbo->FLAGRAP2),Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(operazbo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPInsert
arch='operazbo
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(operazbo->DATAOPE)+"O"+LibreriaMit.UniqueId()+"X"
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=30
prev=O6331
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_idbase
]
wr_field=[
'OPERAZMOD
'STATOREG
'DATARETT
'IDEREG
'NUMIMP
]
wr_op=[
'=
'=
'=
'=
'=
]
wr_var=[
'operazbo->IDEREG
''1'
'Date()
'_idreg
'_numimp
]
I
obj='Var
pag=30
prev=O6330
var_op='asgn
I
obj='Insert
pag=30
prev=O6329
rd_kfield=[
'AMMONT
'AREAGEO
'AUTOM
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESDOC
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'IDFILE
'INFORM
'IPCOLLEG
'MODSVOL
'MTCN
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
'ANNOOPE
'NUMIMP
]
rd_kvar=[
'operazbo->AMMONT
'operazbo->AREAGEO
'operazbo->AUTOM
'operazbo->C_CAB
'operazbo->C_CAP
'operazbo->C_CTA
'operazbo->C_IND
'operazbo->C_PRV
'operazbo->C_RAG
'operazbo->C_RAPPORTO
'operazbo->C_STA
'operazbo->CAMBIO
'operazbo->CDATAOPE
'operazbo->CDATOPE
'operazbo->CDATREG
'operazbo->CODANA
'operazbo->CODCAB
'operazbo->CODCAB2
'operazbo->CODDIPE
'operazbo->CODINT2
'operazbo->CODINTER
'operazbo->CODVOC
'operazbo->COLLEG
'operazbo->CONNALTRO
'operazbo->CONNESBEN
'operazbo->CONNESCLI
'operazbo->CONNESDOC
'operazbo->CONNESOPER
'operazbo->DATAIMP
'operazbo->DATAOPE
'operazbo->DATAREG
'Date()
'operazbo->DESC2
'operazbo->DESCCIT
'operazbo->DESCINTER
'operazbo->DOCFILE
'operazbo->DUCOLLEG
'operazbo->DURAT
'operazbo->FLAGCONT
'operazbo->FLAGFRAZ
'operazbo->FLAGLIRE
'operazbo->FLAGRAP
'_flagrap2
'cNewProg
'operazbo->idcauana
'operazbo->IDEREG
'operazbo->IDFILE
'operazbo->INFORM
'operazbo->IPCOLLEG
'operazbo->MODSVOL
'operazbo->MTCN
'operazbo->NATURA
'operazbo->NOPROT
'operazbo->NUMPROG
'operazbo->OPERAG
'operazbo->OPERATORE
'operazbo->OPERAZMOD
'operazbo->OPRAP
'operazbo->ORACOLLEG
'operazbo->PAESE
'operazbo->PAGASOGOP
'operazbo->PRGIMPOPE
'operazbo->PROV2
'operazbo->PROVINCIA
'operazbo->RAGIO
'operazbo->RAPPORTBEN
'operazbo->RAPPORTO
'operazbo->RAREA
'operazbo->RCOMP
'operazbo->RESPINS
'operazbo->RFREQ
'operazbo->RIFIMP
'operazbo->RIMP
'operazbo->RRAGIO
'operazbo->RTIPO
'operazbo->SCOPO
'operazbo->SEGNO
''3'
'operazbo->TIPO
'operazbo->TIPOINF
'operazbo->TIPOINT2
'operazbo->TIPOINTER
'operazbo->TIPOLEG
'operazbo->TIPOOPRAP
'operazbo->TOTCONT
'operazbo->TOTLIRE
'operazbo->UCODE
'operazbo->UNIQUECODE
'operazbo->VALUTA
'operazbo->ZCPARTE
'operazbo->ANNOOPE
'_numimp
]
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=30
prev=O6323
var_op='asgn
I
obj='Var
pag=30
prev=O6322
var_op='asgn
I
obj='Var
pag=30
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=30
prev=O6280
rd_kfield=[
'ALLINEATO
'ALLINEATONOMECNOME
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODDIPE
'CODFISC
'CODINTER
'COGNOME
'COMPORT
'CONNES
'datamodi
'DATANASC
'DATARILASC
'DATASEGN
'DATAVALI
'DATEXTRA
'DESCCIT
'DOCFILE
'DOMICILIO
'idcitta
'IDFILE
'MACROAGENTE
'NASCOMUN
'NASSTATO
'NOME
'NOTE
'NUMDOCUM
'OLDCODFISC
'OLDCONNES
'OLDSETSIN
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROGIMP_C
'PROGIMPORT
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'sanumpro
'SESSO
'SETTSINT
'SOSPMAF
'SOTGRUP
'SPOTID
'TIPINTER
'TIPODOC
'TIPOPERS
'SETTSINT2
'FATCA
'BANCABEN
'TIN
'ODB
'TELEF
'TIPOORO
'CODORO
'IDNASCOMUN
'IDNASSTATO
'NOTIT
'IDBASE
'FLGVALIDO
'CITTADIN1
'CITTADIN2
'RESFISC
'MITIG
'MITGDOC
'NOSARA
'RISGLOB
'DATAPROF
'DATAREVPROF
'IDENT
'PEPDATE
'DAC6
'FLAGDAC6
'CRIME
'CRIMEDATE
'ALTRODOM
'ALTROCAP
'NUMIMP
'RAPSEGNA
'CODLEGRAP
'TIPOSOGGETTO
'CAUSALE
'IMPORTOMAX
'FATTURATO
'FREQUENZA
'NUMOPERAZ
'SOGAFFIDATARIO
'FLGNOTRIM
'DISATTIVO
'DATAFINE
'DATAINI
'DATAIDENT
'DATARAUT
]
rd_kvar=[
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->AREAGEO
'personbo->ATTIV
'personbo->AUTRILASC
'personbo->CAP
'personbo->CFESTERO
'personbo->CODCAB
'personbo->CODDIPE
'personbo->CODFISC
'personbo->CODINTER
'personbo->COGNOME
'personbo->COMPORT
'xConnes
'_datarett
'personbo->DATANASC
'personbo->DATARILASC
'personbo->DATASEGN
'personbo->DATAVALI
'personbo->DATEXTRA
'personbo->DESCCIT
'personbo->DOCFILE
'personbo->DOMICILIO
'personbo->idcitta
'personbo->IDFILE
'personbo->MACROAGENTE
'personbo->NASCOMUN
'personbo->NASSTATO
'personbo->NOME
'personbo->NOTE
'personbo->NUMDOCUM
'personbo->OLDCODFISC
'personbo->OLDCONNES
'personbo->OLDSETSIN
'personbo->PAESE
'personbo->PARTIVA
'personbo->PEP
'personbo->PKTBSPECIE
'personbo->PROGIMP_C
'personbo->PROGIMPORT
'personbo->PROVINCIA
'personbo->RAGSOC
'personbo->RAGSOCOLD
'personbo->RAMOGRUP
'personbo->RAREA
'personbo->RATTIV
'personbo->RCOMP
'personbo->RNATGIU
'cProgSto
'personbo->SESSO
'personbo->SETTSINT
'personbo->SOSPMAF
'personbo->SOTGRUP
'personbo->SPOTID
'personbo->TIPINTER
'personbo->TIPODOC
'personbo->TIPOPERS
'personbo->SETTSINT2
'personbo->FATCA
'personbo->BANCABEN
'personbo->TIN
'personbo->ODB
'personbo->TELEF
'personbo->TIPOORO
'personbo->CODORO
'personbo->IDNASCOMUN
'personbo->IDNASSTATO
'personbo->NOTIT
'personbo->IDBASE
'personbo->FLGVALIDO
'personbo->CITTADIN1
'personbo->CITTADIN2
'personbo->RESFISC
'personbo->MITIG
'personbo->MITIGDOC
'personbo->NOSARA
'personbo->RISGLOB
'personbo->DATAPROF
'personbo->DATAREVPROF
'personbo->IDENT
'personbo->PEPDATE
'personbo->DAC6
'personbo->FLAGDAC6
'personbo->CRIME
'personbo->CRIMEDATE
'personbo->ALTRODOM
'personbo->ALTROCAP
'_numimp
'personbo->RAPSEGNA
'personbo->CODLEGRAP
'personbo->TIPOSOGGETTO
'personbo->CAUSALE
'personbo->IMPORTOMAX
'personbo->FATTURATO
'personbo->FREQUENZA
'personbo->NUMOPERAZ
'personbo->SOGAFFIDATARIO
'personbo->FLGNOTRIM
'personbo->DISATTIVO
'personbo->DATAFINE
'personbo->DATAINI
'personbo->DATAIDENT
'personbo->DATARAUT
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6281
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
frm_calc='m_cLastMsgError = ""
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=30
prev=O6351
I
obj='Exec
pag=30
prev=O6350
I
obj='Var
obj_type='N
pag=30
prev=O6349
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=30
pagelocal=True
prev=O6279
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O6278
var_op='asgn
I
obj='Remark
pag=30
I
I
]
w=[
150
150
]
I
obj='Select
pag=30
prev=O6268
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=xConnes and wersonbo->datamodi=_datarett
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6271
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=30
prev=O6267
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6268
fatherSonIndex=0
frm_calc='Date()
len=8
name='_datarett
obj='Var
obj_type='D
pag=30
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6268
fatherSonIndex=1
frm_calc='arfn_dateminus(Date(),30)
len=8
name='_datarett
obj='Var
obj_type='D
pag=30
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6268
fatherSonIndex=2
frm_calc='CharToDate(Substr(riga,301,4)+Substr(riga,299,2)+Substr(riga,297,2))
len=8
name='_datarett
obj='Var
obj_type='D
pag=30
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=30
prev=O6266
var_op='asgn
I
obj='Remark
pag=30
prev=O6265
I
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=30
prev=O6244
I
obj='Begin
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6244
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad(personbo->CODFISC,16)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->RAGSOC,70)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->DOMICILIO,35)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->DESCCIT,30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->PROVINCIA,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(LRTrim(personbo->CAP),5)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->PAESE,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->SOTGRUP,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->RAMOGRUP,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->SETTSINT,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(Left(personbo->NASCOMUN,30),30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->TIPINTER,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(Left(personbo->NASSTATO,30),30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + iif(DateToChar(personbo->DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATANASC),8),Space(8))
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->TIPODOC,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->NUMDOCUM,15)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + iif(DateToChar(personbo->DATARILASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATARILASC),8),Space(8))
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->AUTRILASC,30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->PARTIVA,14)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->CODCAB,6)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.SpacePad(personbo->CODFISC,16)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->RAGSOC,70)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->DESCCIT,30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->PROVINCIA,2)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(Left(personbo->NASCOMUN,30),30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->TIPINTER,2)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(Left(personbo->NASSTATO,30),30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + iif(DateToChar(personbo->DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATANASC),8),Space(8))
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->SESSO,1)
len=10
name='xRiga4
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgaggfam='S'
]
h=[
19
19
]
obj='If
pag=30
prev=O6398
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6399
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad(personbo->CODFISC,16)
len=10
name='xRiga6
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xSesso)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + iif(personbo->CFESTERO=1,'1','0')
len=10
name='xRiga6
obj='Var
obj_type='M
pag=30
prev=O6405
var_op='asgn
I
obj='If
pag=30
prev=O6404
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6405
fatherSonIndex=0
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->RAGSOC,70)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + iif(personbo->PAESE='086',Upper(LibreriaMit.SpacePad(personbo->DESCCIT,30)),Space(30))
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->PAESE,3)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->PROVINCIA,2)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + Space(122)
len=10
name='xRiga6
obj='Var
obj_type='M
pag=30
prev=O6414
var_op='asgn
I
obj='Var
obj_type='M
pag=30
prev=O6413
var_op='asgn
I
obj='Var
obj_type='M
pag=30
prev=O6412
var_op='asgn
I
obj='Var
obj_type='M
pag=30
prev=O6411
var_op='asgn
I
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6405
fatherSonIndex=1
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->RAGSOC,70)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + Space(35)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->COGNOME,26)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->NOME,25)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->SESSO,1)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + iif(DateToChar(personbo->DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATANASC),8),Space(8))
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(Left(personbo->NASCOMUN,30),30)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->TIPINTER,2)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(Left(personbo->NASSTATO,30),30)
len=10
name='xRiga6
obj='Var
obj_type='M
pag=30
prev=O6424
var_op='asgn
I
obj='Var
obj_type='M
pag=30
prev=O6423
var_op='asgn
I
obj='Var
obj_type='M
pag=30
prev=O6422
var_op='asgn
I
obj='Var
obj_type='M
pag=30
prev=O6421
var_op='asgn
I
obj='Var
obj_type='M
pag=30
prev=O6420
var_op='asgn
I
obj='Var
obj_type='M
pag=30
prev=O6419
var_op='asgn
I
obj='Var
obj_type='M
pag=30
prev=O6418
var_op='asgn
I
obj='Var
obj_type='M
pag=30
prev=O6417
var_op='asgn
I
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6397
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6396
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6395
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6394
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6393
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6392
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6391
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6390
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6389
var_op='asgn
I
obj='Var
obj_type='M
pag=30
prev=O6388
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6387
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6386
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6385
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6384
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6383
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6382
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6381
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6380
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6379
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6378
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6377
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6376
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6375
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6374
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6373
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6372
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6371
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6370
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=30
prev=O6149
I
obj='If
pag=30
prev=O6148
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6149
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad(Upper(xCF),16)
len=10
name='xRiga5
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xSesso)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+iif(xCFE=1,'1','0')
len=10
name='xRiga5
obj='Var
obj_type='M
pag=30
prev=O6433
var_op='asgn
I
obj='If
pag=30
prev=O6432
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6433
fatherSonIndex=0
frm_calc='xRiga5+Upper(Substr(riga,7,70))+iif(Substr(riga,262,3)='086',Upper(Substr(riga,230,30)),Space(30))+Substr(riga,262,3)+Substr(riga,260,2)
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+ Space(122)
len=10
name='xRiga5
obj='Var
obj_type='M
pag=30
prev=O6439
var_op='asgn
I
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6433
fatherSonIndex=1
frm_calc='xRiga5+Upper(Substr(riga,7,70))+Space(35)
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+Upper(Substr(riga,305,26))+Upper(Substr(riga,331,25))+xSesso
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2)+LibreriaMit.SpacePad(Left(cCNAS,30),30)+Substr(riga,456,2)
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+LibreriaMit.SpacePad(Left(cSNAS,30),30)
len=10
name='xRiga5
obj='Var
obj_type='M
pag=30
prev=O6444
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6443
var_op='asgn
I
obj='Var
obj_type='M
pag=30
prev=O6442
var_op='asgn
I
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=30
prev=O6147
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6146
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6145
var_op='asgn
I
obj='Var
obj_type='M
pag=30
prev=O6144
var_op='asgn
I
obj='Var
obj_type='M
pag=30
prev=O6143
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6142
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6141
var_op='asgn
I
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=30
prev=O6112
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6115
fatherSonIndex=0
frm_calc='iif(_flganag='S',_oldcog,Upper(Substr(riga,305,26)))
len=26
name='_oldcog
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnom,Upper(Substr(riga,331,25)))
len=26
name='_oldnom
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldrgs,Upper(Substr(riga,7,70)))
len=70
name='_oldrgs
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldncm,cCNAS)
len=30
name='_oldncm
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnst,cSNAS)
len=30
name='_oldnst
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldndt,CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2)))
len=8
name='_oldndt
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnpv,Upper(Substr(riga,456,2)))
len=2
name='_oldnpv
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnsx,xSesso)
len=1
name='_oldnsx
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgvali='S',_oldest,xCFE)
len=1
name='_oldest
obj='Var
obj_type='N
pag=30
prev=O6458
var_op='asgn
I
obj='Var
pag=30
prev=O6457
var_op='asgn
I
obj='Var
pag=30
prev=O6456
var_op='asgn
I
obj='Var
obj_type='D
pag=30
prev=O6455
var_op='asgn
I
obj='Var
pag=30
prev=O6454
var_op='asgn
I
obj='Var
pag=30
prev=O6453
var_op='asgn
I
obj='Var
pag=30
prev=O6452
var_op='asgn
I
obj='Var
pag=30
prev=O6451
var_op='asgn
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=30
prev=O6111
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6112
fatherSonIndex=0
frm_calc='Substr(riga,136,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=30
prev=O6463
var_op='asgn
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=30
prev=O6110
var_op='asgn
I
obj='Var
pag=30
prev=O6107
var_op='asgn
I
obj='If
pag=30
prev=O6106
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6107
fatherSonIndex=0
frm_calc='Upper(Substr(riga,230,30))
len=30
name='xCitta
next=Icpitembatch.CPForEach
for_variable='rowTBCITTA
for_variable_type='tbcitta
h=[
19
19
]
iterator_expr='mcTBCITTA
obj='ForEach
pag=30
prev=O6468
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6469
fatherSonIndex=0
frm_calc=[
'LRTrim(rowTBCITTA.CITTA)=LRTrim(xCitta)
]
h=[
19
19
]
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6473
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(xPrv))) and rowTBCITTA.PROV=xPrv
'not(Empty(LRTrim(xPrv))) and rowTBCITTA.PROV=xPrv
]
h=[
19
19
19
19
]
haselse=True
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6478
fatherSonIndex=0
frm_calc='rowTBCITTA.CAB
len=6
name='xCodCab
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=30
prev=O6483
I
obj='Var
pag=30
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6478
fatherSonIndex=1
frm_calc='rowTBCITTA.CAB
len=6
name='xCodCab
obj='Var
pag=30
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6478
fatherSonIndex=2
frm_calc='rowTBCITTA.CAB
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
frm_calc='rowTBCITTA.PROV
len=2
name='xPrv
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=30
prev=O6489
I
obj='Var
pag=30
prev=O6488
var_op='asgn
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=30
prev=O6105
var_op='asgn
I
obj='Var
pag=30
prev=O6104
var_op='asgn
I
obj='Var
pag=30
prev=O6103
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O6100
var_op='asgn
I
obj='If
pag=30
prev=O6099
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6100
fatherSonIndex=0
frm_calc='iif(LRTrim(Substr(riga,458,1))='1',1,0)
len=1
name='xCFE
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6100
fatherSonIndex=1
frm_calc='iif(LRTrim(Substr(riga,458,1))='S',1,0)
len=1
name='xCFE
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=30
prev=O6098
var_op='asgn
I
obj='Var
pag=30
prev=O6097
var_op='asgn
I
obj='Read
pag=30
prev=O6096
rd_field=[
'FLGVALIDO
'FLGANAVAL
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'cCli1
]
rd_var=[
'_flgvali
'_flganag
]
I
obj='Var
pag=30
prev=O6095
var_op='asgn
I
obj='Var
pag=30
prev=O6094
var_op='asgn
I
obj='Read
pag=30
prev=O6092
rd_field=[
'CONNES
'CFESTERO
'CODFISC
'COGNOME
'NOME
'RAGSOC
'NASCOMUN
'NASSTATO
'DATANASC
'TIPINTER
'SESSO
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'cCli1
]
rd_var=[
'xConnes
'_oldest
'_oldcf
'_oldcog
'_oldnom
'_oldrgs
'_oldncm
'_oldnst
'_oldndt
'_oldnpv
'_oldnsx
]
I
obj='Begin
pag=30
prev=O6091
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6092
fatherSonIndex=0
frm_calc='0
len=1
name='_oldest
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_oldcf
next=Icpitembatch.CPVarDecl
frm_calc='''
len=26
name='_oldcog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=26
name='_oldnom
next=Icpitembatch.CPVarDecl
frm_calc='''
len=70
name='_oldrgs
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_oldncm
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_oldnst
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_oldndt
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_oldnpv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_oldnsx
obj='Var
pag=30
prev=O6519
var_op='asgn
I
obj='Var
pag=30
prev=O6518
var_op='asgn
I
obj='Var
obj_type='D
pag=30
prev=O6517
var_op='asgn
I
obj='Var
pag=30
prev=O6516
var_op='asgn
I
obj='Var
pag=30
prev=O6515
var_op='asgn
I
obj='Var
pag=30
prev=O6514
var_op='asgn
I
obj='Var
pag=30
prev=O6513
var_op='asgn
I
obj='Var
pag=30
prev=O6512
var_op='asgn
I
obj='Var
pag=30
prev=O6511
var_op='asgn
I
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=30
prev=O6090
I
obj='Var
pag=30
prev=O6089
var_op='asgn
I
obj='Var
pag=30
prev=O6088
var_op='asgn
I
obj='Var
pag=30
prev=O6087
var_op='asgn
I
obj='Var
pag=30
prev=O6086
var_op='asgn
I
obj='Var
pag=30
prev=O6085
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O6084
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O6083
var_op='asgn
I
obj='Var
pag=30
prev=O6082
var_op='asgn
I
obj='Var
obj_type='D
pag=30
prev=O6081
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6080
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6079
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6078
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6077
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6076
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6073
var_op='asgn
I
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6073
fatherSonIndex=0
frm_calc='Substr(riga,112,16)
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,496,16)
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xConnes)
]
h=[
19
19
]
obj='If
pag=30
prev=O6526
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='personbo
father=O6527
fatherSonIndex=0
obj='Insert
pag=30
rd_kfield=[
'CONNES
]
rd_kvar=[
'_conadd
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=30
prev=O6525
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'_conadd
]
rd_var=[
'xConnes
]
I
obj='Var
pag=30
prev=O6524
var_op='asgn
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=30
prev=O6010
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
rd_var=[
'nProgSto
]
I
obj='Read
pag=30
prev=O6009
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
rd_var=[
'nProgImp
]
I
obj='MemoryCursor
pag=30
prev=O6008
sel_field='*
sel_name='tbcitta
sel_type='fltb
I
obj='Var
obj_type='N
pag=30
prev=O6007
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O6006
var_op='asgn
I
obj='Var
pag=30
prev=O6005
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O6003
var_op='asgn
I
obj='Begin
pag=30
prev=O6002
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6003
fatherSonIndex=0
frm_calc=[
'At("persnew",_tabelle)=0
]
h=[
19
19
]
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6553
fatherSonIndex=0
frm_calc='_tabelle+"persnew,"
len=10
name='_tabelle
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=30
prev=O6001
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O6000
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O5999
var_op='asgn
I
obj='Var
obj_type='N
pag=30
var_op='asgn
x=8
y=16
I
Icpitembatch.CPRemark
frm_calc='Inserisce priorità sui nomi file
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=27
prev=O6561
sel_name='tmp_list_imprich
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O6562
fatherSonIndex=0
frm_calc=[
'At('archdip.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('archpers.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('archrap.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('archinf.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('archope.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('archfraz.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('opex.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('archtito.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('procdel.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('sogope.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('intest.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('stopers.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('persnew.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('rapage.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('infage.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('intage.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('opeage.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('procage.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('sogcli.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('sogben.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('sogaltro.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('saldopex.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0 or At('saldopex.xls',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('saldrapp.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0 or At('saldrapp.xls',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('titosupp.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
]
h=[
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
]
next=Icpitembatch.CPWrite
arch='tmp_list_imprich
obj='Write
pag=27
prev=O6566
rd_kfield=[
'nomefile
]
rd_kop=[
'=
]
rd_kvar=[
'tmp_list_imprich->nomefile
]
wr_field=[
'priorita
]
wr_op=[
'=
]
wr_var=[
'_priorita
]
I
obj='Case
pag=27
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6566
fatherSonIndex=0
frm_calc='1
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6566
fatherSonIndex=1
frm_calc='2
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6566
fatherSonIndex=2
frm_calc='5
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6566
fatherSonIndex=3
frm_calc='6
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6566
fatherSonIndex=4
frm_calc='7
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6566
fatherSonIndex=5
frm_calc='8
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6566
fatherSonIndex=6
frm_calc='9
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6566
fatherSonIndex=7
frm_calc='10
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6566
fatherSonIndex=8
frm_calc='11
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6566
fatherSonIndex=9
frm_calc='12
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6566
fatherSonIndex=10
frm_calc='13
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6566
fatherSonIndex=11
frm_calc='3
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6566
fatherSonIndex=12
frm_calc='4
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6566
fatherSonIndex=13
frm_calc='14
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6566
fatherSonIndex=14
frm_calc='15
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6566
fatherSonIndex=15
frm_calc='16
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6566
fatherSonIndex=16
frm_calc='17
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6566
fatherSonIndex=17
frm_calc='18
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6566
fatherSonIndex=18
frm_calc='19
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6566
fatherSonIndex=19
frm_calc='20
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6566
fatherSonIndex=20
frm_calc='21
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6566
fatherSonIndex=21
frm_calc='22
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6566
fatherSonIndex=22
frm_calc='23
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6566
fatherSonIndex=23
frm_calc='24
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
]
w=[
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=27
x=18
y=21
I
Icpitembatch.CPBeginEnd
comment='Definizine variabili locali
h=[
19
19
]
next=Icpitembatch.CPDropTemporaryTable
next=Icpitembatch.CPServerTemporaryTable
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=32
prev=O6630
sel_field='*
sel_name='tmp_list_imprich
sel_order='tmp_list_imprich->priorita,tmp_list_imprich->nomefile
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6631
fatherSonIndex=0
frm_calc='LRTrim(tmp_list_imprich->nomefile)
len=50
name='nomefileimport
next=Icpitembatch.CPIfElse
frm_calc=[
'At('archpers.txt',Lower(nomefileimport)) <> 0 or At('persnew.txt',Lower(nomefileimport)) <> 0 or At('stopers.txt',Lower(nomefileimport)) <> 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'At('archrap.txt',Lower(nomefileimport)) <> 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'At('archinf.txt',Lower(nomefileimport)) <> 0
]
h=[
19
19
]
obj='If
pag=32
prev=O6639
sons=[
Icpitembatch.CPItemSon
comment='Informazioni
instr=Icpitembatch.CPVarDecl
father=O6642
fatherSonIndex=0
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
obj='Exec
pag=32
prev=O6649
I
obj='While
pag=32
prev=O6648
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6649
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=32
prev=O6655
var_op='asgn
I
obj='If
pag=32
prev=O6654
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6655
fatherSonIndex=0
frm_calc='''
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='''
len=128
name='_testata
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_ferr
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati controllate '+LRTrim(Str(conta,10,0))+' Informazioni dei Rapporti del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='"Codice Rapporto: "+ LRTrim(Substr(riga,1,25)) + " - Descrizione "+LRTrim(Upper(Substr(riga,26,50)))
len=128
name='_testata
next=Icpitembatch.CPBeginEnd
comment='Effettua Controlli
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_ferr = 1
]
h=[
19
19
]
obj='If
pag=32
prev=O6666
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6668
fatherSonIndex=0
frm_calc='1
len=1
name='_chkerr
next=Icpitembatch.CPInsert
arch='tmp_errimp
obj='Insert
pag=32
prev=O6673
rd_kfield=[
'nomearch
'numriga
'errore
'txtini
]
rd_kvar=[
'LRTrim(nomefileimport)
'conta
'_listaerr
'_testata
]
I
obj='Var
obj_type='N
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=32
prev=O6665
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O6666
fatherSonIndex=0
frm_calc='NOTA: Qualunque informazione viene e deve essere registrata ad evento avvenuto. Pertanto non è possibile registrare qualsiasi evento con una data operazione futura.﷯La data registrazione (presa dal sistema) deve essere maggiore o uguale alla data ope. -cit. Roberto
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Upper(Substr(riga,1,8))))
'(DateDiff(arfn_datefchar(LRTrim(Left(riga,8))), _date_oggi)>(20*365)) or (arfn_datefchar(LRTrim(Left(riga,8)))>_date_oggi)
]
h=[
19
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Upper(Substr(riga,9,25))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Upper(Substr(riga,34,1))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Upper(Substr(riga,44,2))))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Upper(Substr(riga,75,16)))
name='_tmp
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_tmp) and Substr(riga,44,2) <> '25' and Substr(riga,44,2) <> '28'
]
h=[
19
19
]
obj='If
pag=32
prev=O6693
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O6694
fatherSonIndex=0
frm_calc='-- Non controllare se c'è o meno l'anagrafica! Potrebbe non essere ancora stata inserita (solo check dei file)
next=Icpitembatch.CPVarDecl
frm_calc='_listaerr + " non presente il Codice Cliente Intestatario (ASSOLUTAMENTE OBBLIGATORIO)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6700
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
prev=O6699
var_op='asgn
I
obj='Remark
pag=32
I
I
]
w=[
150
150
]
I
obj='Var
pag=32
prev=O6690
var_op='asgn
I
obj='If
pag=32
prev=O6687
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6690
fatherSonIndex=0
frm_calc='_listaerr + " non presente il Tipo Registrazione (ASSOLUTAMENTE OBBLIGATORIO)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6705
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6684
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6687
fatherSonIndex=0
frm_calc='_listaerr + " non presente Flag Tipo Rapporto (ASSOLUTAMENTE OBBLIGATORIO)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6710
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6681
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6684
fatherSonIndex=0
frm_calc='_listaerr + " non presente Rapporto (ASSOLUTAMENTE OBBLIGATORIO)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6715
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6680
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6681
fatherSonIndex=0
frm_calc='_listaerr + " non presente la Data (ASSOLUTAMENTE OBBLIGATORIO)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6720
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6681
fatherSonIndex=1
frm_calc='_listaerr + " anomalia nel campo Data (ASSOLUTAMENTE OBBLIGATORIO)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6723
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=32
I
I
]
w=[
150
150
]
I
obj='Var
pag=32
pagelocal=True
prev=O6664
var_op='asgn
I
nonlocal=True
obj='Var
pag=32
prev=O6663
var_op='asgn
I
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6662
var_op='asgn
I
obj='Var
pag=32
pagelocal=True
prev=O6661
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=32
prev=O6647
var_op='asgn
I
obj='Var
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6636
sons=[
Icpitembatch.CPItemSon
comment='Rapporti
instr=Icpitembatch.CPVarDecl
father=O6639
fatherSonIndex=0
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
obj='Exec
pag=32
prev=O6734
I
obj='While
pag=32
prev=O6733
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6734
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=32
prev=O6740
var_op='asgn
I
obj='If
pag=32
prev=O6739
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6740
fatherSonIndex=0
frm_calc='''
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='''
len=128
name='_testata
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_ferr
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati controllati '+LRTrim(Str(conta,10,0))+' Rapporti del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='"Codice Rapporto: "+ LRTrim(Substr(riga,1,25)) + " - Descrizione "+LRTrim(Upper(Substr(riga,26,50)))
len=128
name='_testata
next=Icpitembatch.CPBeginEnd
comment='Effettua Controlli
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_ferr = 1
]
h=[
19
19
]
obj='If
pag=32
prev=O6751
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6753
fatherSonIndex=0
frm_calc='1
len=1
name='_chkerr
next=Icpitembatch.CPInsert
arch='tmp_errimp
obj='Insert
pag=32
prev=O6758
rd_kfield=[
'nomearch
'numriga
'errore
'txtini
]
rd_kvar=[
'LRTrim(nomefileimport)
'conta
'_listaerr
'_testata
]
I
obj='Var
obj_type='N
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=32
prev=O6750
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6751
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Upper(Substr(riga,1,25))))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Upper(Substr(riga,76,1)))
name='_tmp
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_tmp) or (_tmp<>"0" and _tmp<>"1" and _tmp<>"2" and _tmp<>"3")
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='""
name='_tmp
obj='Var
pag=32
prev=O6769
var_op='asgn
I
obj='If
pag=32
prev=O6768
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6769
fatherSonIndex=0
frm_calc='_listaerr + " anomalia Tipo Rapporto (ASSOLUTAMENTE OBBLIGATORIO)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6775
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=32
prev=O6765
var_op='asgn
I
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6765
fatherSonIndex=0
frm_calc='_listaerr + " non presente il Codice Rapporto (ASSOLUTAMENTE OBBLIGATORIO)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6780
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=32
pagelocal=True
prev=O6749
var_op='asgn
I
nonlocal=True
obj='Var
pag=32
prev=O6748
var_op='asgn
I
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6747
var_op='asgn
I
obj='Var
pag=32
pagelocal=True
prev=O6746
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=32
prev=O6732
var_op='asgn
I
obj='Var
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6635
sons=[
Icpitembatch.CPItemSon
comment='Soggetti
instr=Icpitembatch.CPVarDecl
father=O6636
fatherSonIndex=0
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
obj='Exec
pag=32
prev=O6791
I
obj='While
pag=32
prev=O6790
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6791
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=32
prev=O6797
var_op='asgn
I
obj='If
pag=32
prev=O6796
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6797
fatherSonIndex=0
frm_calc='''
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='''
len=128
name='_testata
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_ferr
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati controllati '+LRTrim(Str(conta,10,0))+' nominativi del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='"Codice: "+ LRTrim(Substr(riga,112,16)) + " - Soggetto "+LRTrim(Upper(Substr(riga,7,70)))
len=128
name='_testata
next=Icpitembatch.CPIfElse
frm_calc=[
'At('archpers.txt',Lower(nomefileimport)) <> 0
'At('persnew.txt',Lower(nomefileimport)) <> 0
]
h=[
19
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Upper(Substr(riga,7,70))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,262,3)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(Substr(riga,262,3)) = '086' or Empty(LRTrim(Substr(riga,262,3)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,166,3)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,172,3)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,288,1)))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_ferr = 1
]
h=[
19
19
]
obj='If
pag=32
prev=O6826
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6829
fatherSonIndex=0
frm_calc='1
len=1
name='_chkerr
next=Icpitembatch.CPInsert
arch='tmp_errimp
obj='Insert
pag=32
prev=O6834
rd_kfield=[
'nomearch
'numriga
'errore
'txtini
]
rd_kvar=[
'LRTrim(nomefileimport)
'conta
'_listaerr
'_testata
]
I
obj='Var
obj_type='N
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6823
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6826
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Substr(riga,136,30)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,128,8)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,175,2)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,177,15)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,192,8)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,200,30)))
]
h=[
19
19
]
obj='If
pag=32
prev=O6853
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6856
fatherSonIndex=0
frm_calc='_listaerr + "non è presente l'autorità di rilascio del documento" + NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6861
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6850
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6853
fatherSonIndex=0
frm_calc='_listaerr + "non è presente la data rilascio del documento"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6866
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6847
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6850
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il numero documento" + NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6871
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6844
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6847
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il tipo di documento"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6876
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6841
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6844
fatherSonIndex=0
frm_calc='_listaerr + "non è presente la data di nascita"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6881
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6841
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il luogo di nascita"
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6886
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O6826
fatherSonIndex=1
frm_calc=[
'not(Empty(LRTrim(Substr(riga,136,30))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,128,8))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,175,2))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,177,15))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,192,8))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,200,30))))
]
h=[
19
19
]
obj='If
pag=32
prev=O6902
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6905
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente l'autorità di rilascio del documento" + NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6910
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6899
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6902
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente la data rilascio del documento"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6915
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6896
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6899
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente il numero documento" + NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6920
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6893
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6896
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente il tipo di documento"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6925
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6890
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6893
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente la data di nascita"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6930
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6890
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente il luogo di nascita"
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6935
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=32
prev=O6820
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6823
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice Settorizzazione sintetica"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6941
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6817
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6820
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice SAE"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6946
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6814
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O6817
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Substr(riga,1,6))) and Empty(LRTrim(Substr(riga,230,30)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,230,30)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,260,2)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,77,35)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,265,9)))
]
h=[
19
19
]
obj='If
pag=32
prev=O6960
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6963
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il cap di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6968
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6957
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6960
fatherSonIndex=0
frm_calc='_listaerr + "non è presente l'indirizzo di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6973
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6954
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6957
fatherSonIndex=0
frm_calc='_listaerr + "non è presente la provincia di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6978
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6951
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6954
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il comune di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6983
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6951
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice CAB (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6988
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6811
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6814
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice stato di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6994
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6808
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6811
fatherSonIndex=0
frm_calc='_listaerr + " non è presente la ragione sociale (ASSOLUTAMENTE OBBLIGATORIO)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6999
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6807
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPBeginEnd
comment='Effettua Controlli
father=O6808
fatherSonIndex=0
h=[
19
19
]
obj='Begin
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7004
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Upper(Substr(riga,488,16))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,112,16))) and Substr(riga,450,1)<>'S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,460,10))) and Empty(LRTrim(Substr(riga,288,1))) and not(Empty(LRTrim(Substr(riga,166,3))))
]
h=[
19
19
]
obj='If
pag=32
prev=O7011
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7014
fatherSonIndex=0
frm_calc='''
len=1
name='_tiposot
next=Icpitembatch.CPRead
arch='tbstgru
next=Icpitembatch.CPIfElse
frm_calc=[
'_tiposot='1'
]
h=[
19
19
]
obj='If
pag=32
prev=O7020
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7021
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice ATECO"
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7026
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=32
prev=O7019
rd_field=[
'TIPOSOT
]
rd_kfield=[
'SOTGRU
]
rd_kvar=[
'Substr(riga,166,3)
]
rd_var=[
'_tiposot
]
I
obj='Var
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O7008
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7011
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice fiscale (ASSOLUTAMENTE OBBLIGATORIO)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7036
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7008
fatherSonIndex=0
frm_calc='_listaerr + " non è il codice NDG (ASSOLUTAMENTE OBBLIGATORIO)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7041
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Effettua Controlli
father=O6808
fatherSonIndex=1
h=[
19
19
]
obj='Begin
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7046
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Upper(Substr(riga,496,16))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,112,16))) and Substr(riga,458,1)<>'S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,468,10))) and Empty(LRTrim(Substr(riga,288,1))) and not(Empty(LRTrim(Substr(riga,166,3))))
]
h=[
19
19
]
obj='If
pag=32
prev=O7053
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7056
fatherSonIndex=0
frm_calc='''
len=1
name='_tiposot
next=Icpitembatch.CPRead
arch='tbstgru
next=Icpitembatch.CPIfElse
frm_calc=[
'_tiposot='1'
]
h=[
19
19
]
obj='If
pag=32
prev=O7062
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7063
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice ATECO"
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7068
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=32
prev=O7061
rd_field=[
'TIPOSOT
]
rd_kfield=[
'SOTGRU
]
rd_kvar=[
'Substr(riga,166,3)
]
rd_var=[
'_tiposot
]
I
obj='Var
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O7050
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7053
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice fiscale (ASSOLUTAMENTE OBBLIGATORIO)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7078
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7050
fatherSonIndex=0
frm_calc='_listaerr + " non è il codice NDG (ASSOLUTAMENTE OBBLIGATORIO)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7083
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=32
pagelocal=True
prev=O6806
var_op='asgn
I
nonlocal=True
obj='Var
pag=32
prev=O6805
var_op='asgn
I
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6804
var_op='asgn
I
obj='Var
pag=32
pagelocal=True
prev=O6803
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=32
prev=O6789
var_op='asgn
I
obj='Var
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='TempTable
pag=32
prev=O6629
sel_type='def
server_table='tmp_errimp
I
obj='DropTempTable
pag=32
prev=O6627
server_table='tmp_errimp
I
obj='Begin
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6627
fatherSonIndex=0
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
len=128
name='_testata
next=Icpitembatch.CPVarDecl
len=1
name='_ferr
next=Icpitembatch.CPVarDecl
len=1
name='_tiposot
obj='Var
pag=32
pagelocal=True
prev=O7096
I
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7095
I
obj='Var
pag=32
pagelocal=True
prev=O7094
I
obj='Var
obj_type='M
pag=32
pagelocal=True
I
I
]
w=[
150
150
]
x=17
y=18
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'Lower(LRTrim(nomefileimport))='saldopex.txt'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Saldi operazioni extraconto Inseriti: '+LRTrim(Str(cNumNew,10,0))  +  NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Saldi operazioni extraconto Aggiornati: '+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O7109
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O7108
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O7107
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O7104
var_op='asgn
I
obj='If
pag=33
prev=O7103
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7104
fatherSonIndex=0
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
obj='Exec
pag=33
prev=O7117
I
obj='Exec
pag=33
prev=O7116
I
obj='Exec
pag=33
prev=O7114
I
obj='While
pag=33
prev=O7113
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7114
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record dei saldi opex del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=33
prev=O7125
var_op='asgn
I
nonlocal=True
obj='Var
pag=33
prev=O7122
var_op='asgn
I
obj='If
pag=33
prev=O7121
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7122
fatherSonIndex=0
frm_calc='Substr(riga,1,16)
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Val(Substr(riga,21,17))=0 and Val(Substr(riga,38,6))=0 and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Val(Substr(riga,21,17))=0 and Val(Substr(riga,38,6)) <> 0 and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Val(Substr(riga,21,17))<>0 and Val(Substr(riga,38,6))=0 and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub = 1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=33
prev=O7146
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O7149
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=33
prev=O7154
var_op='asgn
I
obj='Write
pag=33
rd_kfield=[
'COLLEG
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,16)
'Substr(riga,17,4)
]
wr_field=[
'SALDO
'QUANTITA
'VALUTA
'NATURA
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'Val(Substr(riga,21,17))
'Val(Substr(riga,38,6))
'iif(Empty(LRTrim(Substr(riga,44,3))),'242',Substr(riga,44,3))
'Substr(riga,47,2)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7149
fatherSonIndex=1
frm_calc='1
len=1
name='_soxerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(shand,riga+" - "+_descerr)
obj='Exec
pag=33
prev=O7163
I
obj='Var
obj_type='N
pag=33
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=33
prev=O7143
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7146
fatherSonIndex=0
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPRead
arch='opextrbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
]
obj='If
pag=33
prev=O7169
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7170
fatherSonIndex=0
frm_calc='"Assente operazione extraconto per l'anno indicato"
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O7175
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=33
prev=O7168
rd_field=[
'IDBASE
]
rd_kfield=[
'COLLEG
'ANNO
]
rd_kvar=[
'cCli1
'Substr(riga,17,4)
]
rd_var=[
'xIDB
]
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=33
prev=O7140
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7143
fatherSonIndex=0
frm_calc=''Numero Operazioni non valorizzato'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O7185
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=33
prev=O7137
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7140
fatherSonIndex=0
frm_calc=''Saldo non valorizzato'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O7190
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=33
prev=O7134
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7137
fatherSonIndex=0
frm_calc=''Saldo e Numero operazioni entrambi non valorizzati'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O7195
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=33
prev=O7133
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7134
fatherSonIndex=0
frm_calc=''Anagrafica soggetto non presente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O7200
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=33
prev=O7132
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,1,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=33
prev=O7131
var_op='asgn
I
obj='Var
pag=33
prev=O7130
var_op='asgn
I
obj='Var
obj_type='N
pag=33
prev=O7129
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=33
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Apro il foglio e verifico quante pagine ha
father=O7104
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='_i = 0
next=Icpitembatch.CPWhile
frm_calc='_i < _conta
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='workbook.close()
obj='Exec
pag=33
prev=O7213
I
obj='While
pag=33
prev=O7212
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O7213
fatherSonIndex=0
frm_calc='_righe = 0;﷯Sheet sheet = workbook.getSheet(_i);﷯_righe = sheet.getRows();﷯_y = 1;
next=Icpitembatch.CPWhile
frm_calc='_y < _righe
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=33
prev=O7219
I
obj='While
pag=33
prev=O7218
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Legge le colonne e scrive i dati nelle variabili appoggio
father=O7219
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column06)))
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_y++;
obj='Exec
pag=33
prev=O7226
I
obj='If
pag=33
prev=O7224
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O7226
fatherSonIndex=0
frm_calc=''Elaborazione Foglio N.'+LRTrim(Str(_i+1,2,0))+' - Riga N. '+LRTrim(Str(_y+1,7,0))+' - Rapporto N. : '+LRTrim(column01)
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPRead
arch='opextrbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record dei saldi opex del file '+nomefileimport
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=33
prev=O7235
var_op='asgn
I
obj='If
pag=33
prev=O7234
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O7235
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGOPEX\'"+LRTrim(gAzienda)+"'",0,10)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='opextrbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=33
prev=O7243
var_op='asgn
I
obj='Insert
pag=33
prev=O7242
rd_kfield=[
'COLLEG
'ANNO
'IDBASE
'SALDO
'QUANTITA
'VALUTA
'PROGOPEX
]
rd_kvar=[
'Left(LRTrim(column01),16)
'Left(LRTrim(column02),4)
'xIDB
'Val(LRTrim(column03))
'Val(LRTrim(column04))
'iif(Empty(LRTrim(column05)),'242',Left(LRTrim(column05),3))
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7243
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,1,16)+" per l'operazione extraconto in data: "+Substr(riga,21,8)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=33
prev=O7252
I
obj='Var
obj_type='N
pag=33
prev=O7251
var_op='asgn
I
obj='Exec
pag=33
prev=O7250
I
nonlocal=True
obj='Var
obj_type='M
pag=33
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=33
prev=O7241
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O7235
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=33
prev=O7256
var_op='asgn
I
obj='Write
pag=33
rd_kfield=[
'COLLEG
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(LRTrim(column01),16)
'Left(LRTrim(column02),4)
]
wr_field=[
'SALDO
'QUANTITA
'VALUTA
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Val(LRTrim(column03))
'Val(LRTrim(column04))
'iif(Empty(LRTrim(column05)),'242',Left(LRTrim(column05),3))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=33
prev=O7233
rd_field=[
'IDBASE
]
rd_kfield=[
'COLLEG
'ANNO
]
rd_kvar=[
'Left(LRTrim(column01),16)
'Left(LRTrim(column02),4)
]
rd_var=[
'xIDB
]
I
obj='Var
pag=33
prev=O7232
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=33
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O7224
fatherSonIndex=0
frm_calc='// Legge il contenuto delle celle﷯Cell a01 = sheet.getCell(0,_y);﷯Cell a02 = sheet.getCell(1,_y);﷯Cell a03 = sheet.getCell(2,_y);﷯Cell a04 = sheet.getCell(3,_y);﷯Cell a05 = sheet.getCell(4,_y);﷯Cell a06 = sheet.getCell(5,_y);
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
obj='Begin
pag=33
prev=O7272
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7273
fatherSonIndex=0
frm_calc='a01.getContents()
len=25
name='column01
next=Icpitembatch.CPVarDecl
frm_calc='a02.getContents()
len=25
name='column02
next=Icpitembatch.CPVarDecl
frm_calc='a03.getContents()
len=25
name='column03
next=Icpitembatch.CPVarDecl
frm_calc='a04.getContents()
len=25
name='column04
next=Icpitembatch.CPVarDecl
frm_calc='a05.getContents()
len=25
name='column05
next=Icpitembatch.CPVarDecl
frm_calc='a06.getContents()
len=25
name='column06
obj='Var
pag=33
prev=O7281
var_op='asgn
I
obj='Var
pag=33
prev=O7280
var_op='asgn
I
obj='Var
pag=33
prev=O7279
var_op='asgn
I
obj='Var
pag=33
prev=O7278
var_op='asgn
I
obj='Var
pag=33
prev=O7277
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Exec
pag=33
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=33
I
I
]
w=[
150
150
]
I
obj='Exec
pag=33
prev=O7210
I
obj='Begin
pag=33
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O7210
fatherSonIndex=0
frm_calc='//base﷯Workbook workbook = Workbook.getWorkbook(new File(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(gAzienda)+"/"+CPLib.LRTrim(nomefileimport)));﷯_conta = workbook.getNumberOfSheets();
obj='Exec
pag=33
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O7102
var_op='asgn
I
obj='Var
obj_type='N
pag=33
prev=O7101
var_op='asgn
I
obj='Var
obj_type='N
pag=33
prev=O7100
var_op='asgn
I
obj='Var
obj_type='N
pag=33
prev=O7099
var_op='asgn
I
obj='Remark
pag=33
x=12
y=20
I
Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOCLI\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
obj='Var
obj_type='N
pag=30
var_op='asgn
x=1165
y=1413
I
Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
obj='Var
pag=30
pagelocal=True
var_op='asgn
x=1188
y=2847
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
len=2
name='_tipoag
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'Lower(LRTrim(nomefileimport))='saldrapp.txt'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Saldi Rapporti Creati: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Saldi Rapporti Aggiornati: '+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O7304
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O7303
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O7302
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O7299
var_op='asgn
I
obj='If
pag=34
prev=O7298
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7299
fatherSonIndex=0
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
obj='Exec
pag=34
prev=O7312
I
obj='Exec
pag=34
prev=O7311
I
obj='Exec
pag=34
prev=O7309
I
obj='While
pag=34
prev=O7308
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7309
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,25)
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_tipoag
next=Icpitembatch.CPRead
arch='aetesta
next=Icpitembatch.CPRead
arch='aeannora
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPWrite
arch='aetesta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record dei saldi rapporti del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=34
prev=O7326
var_op='asgn
I
nonlocal=True
obj='Var
pag=34
prev=O7325
var_op='asgn
I
obj='Write
pag=34
prev=O7322
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'VALUTA
'CAB
]
wr_op=[
'=
'=
]
wr_var=[
'iif(Empty(LRTrim(Substr(riga,104,3))),'242',Substr(riga,104,3))
'Substr(riga,107,5)
]
I
obj='If
pag=34
prev=O7321
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O7322
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGSAR\'"+LRTrim(gAzienda)+"'",0,10)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aeannora
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=34
prev=O7338
var_op='asgn
I
obj='Insert
pag=34
prev=O7337
rd_kfield=[
'RAPPORTO
'ANNO
'IDBASE
'IMPORTO1
'IMPORTO2
'IMPORTO3
'IMPORTO4
'IMPORTO5
'TIPRAP
'NATURA
]
rd_kvar=[
'xRapporto
'Substr(riga,26,4)
'xIDB
'Val(Substr(riga,30,17))
'Val(Substr(riga,47,17))
'Val(Substr(riga,64,17))
'Val(Substr(riga,81,17))
'Val(Substr(riga,98,6))
'_tipoag
'Substr(riga,112,2)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7338
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,1,16)+" per il rapporto in data: "+Substr(riga,21,8)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=34
prev=O7347
I
obj='Var
obj_type='N
pag=34
prev=O7346
var_op='asgn
I
obj='Exec
pag=34
prev=O7345
I
nonlocal=True
obj='Var
obj_type='M
pag=34
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=34
prev=O7336
var_op='asgn
I
obj='Var
pag=34
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aeannora
father=O7322
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=34
prev=O7351
var_op='asgn
I
obj='Write
pag=34
rd_kfield=[
'RAPPORTO
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,4)
]
wr_field=[
'IMPORTO1
'IMPORTO2
'IMPORTO3
'IMPORTO4
'IMPORTO5
'TIPRAP
'NATURA
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Val(Substr(riga,30,17))
'Val(Substr(riga,47,17))
'Val(Substr(riga,64,17))
'Val(Substr(riga,81,17))
'Val(Substr(riga,98,6))
'_tipoag
'Substr(riga,112,2)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=34
prev=O7320
rd_field=[
'IDBASE
]
rd_kfield=[
'RAPPORTO
'ANNO
]
rd_kvar=[
'xRapporto
'Substr(riga,26,4)
]
rd_var=[
'xIDB
]
I
obj='Read
pag=34
prev=O7319
rd_field=[
'TIPOAG
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'xRapporto
]
rd_var=[
'_tipoag
]
I
obj='Var
pag=34
pagelocal=True
prev=O7318
var_op='asgn
I
obj='Var
pag=34
prev=O7317
var_op='asgn
I
obj='Var
pag=34
prev=O7316
var_op='asgn
I
obj='Var
obj_type='M
pag=34
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=34
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Apro il foglio e verifico quante pagine ha
father=O7299
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='_i = 0
next=Icpitembatch.CPWhile
frm_calc='_i < _conta
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='workbook.close()
obj='Exec
pag=34
prev=O7373
I
obj='While
pag=34
prev=O7372
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O7373
fatherSonIndex=0
frm_calc='_righe = 0;﷯Sheet sheet = workbook.getSheet(_i);﷯_righe = sheet.getRows();﷯_y = 1;
next=Icpitembatch.CPWhile
frm_calc='_y < _righe
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=34
prev=O7379
I
obj='While
pag=34
prev=O7378
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Legge le colonne e scrive i dati nelle variabili appoggio
father=O7379
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column11)))
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_y++;
obj='Exec
pag=34
prev=O7386
I
obj='If
pag=34
prev=O7384
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O7386
fatherSonIndex=0
frm_calc=''Elaborazione Foglio N.'+LRTrim(Str(_i+1,2,0))+' - Riga N. '+LRTrim(Str(_y+1,7,0))+' - Rapporto N. : '+LRTrim(column01)
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='column01
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_tipoag
next=Icpitembatch.CPRead
arch='aetesta
next=Icpitembatch.CPRead
arch='aeannora
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPWrite
arch='aetesta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record dei saldi rapporti del file '+nomefileimport
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=34
prev=O7401
var_op='asgn
I
obj='Write
pag=34
prev=O7398
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'VALUTA
'CAB
]
wr_op=[
'=
'=
]
wr_var=[
'iif(Empty(LRTrim(column09)),'242',Left(LRTrim(column09),3))
'Left(LRTrim(column10),5)
]
I
obj='If
pag=34
prev=O7397
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O7398
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGSAR\'"+LRTrim(gAzienda)+"'",0,10)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aeannora
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=34
prev=O7413
var_op='asgn
I
obj='Insert
pag=34
prev=O7412
rd_kfield=[
'RAPPORTO
'ANNO
'IDBASE
'IMPORTO1
'IMPORTO2
'IMPORTO3
'IMPORTO4
'IMPORTO5
'IMPORTO6
'TIPRAP
]
rd_kvar=[
'Left(LRTrim(column01),25)
'Left(LRTrim(column02),4)
'xIDB
'Val(LRTrim(column03))
'Val(LRTrim(column04))
'Val(LRTrim(column05))
'Val(LRTrim(column06))
'Val(LRTrim(column07))
'Val(LRTrim(column08))
'_tipoag
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7413
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,1,16)+" per il rapporto in data: "+Substr(riga,21,8)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=34
prev=O7422
I
obj='Var
obj_type='N
pag=34
prev=O7421
var_op='asgn
I
obj='Exec
pag=34
prev=O7420
I
nonlocal=True
obj='Var
obj_type='M
pag=34
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=34
prev=O7411
var_op='asgn
I
obj='Var
pag=34
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aeannora
father=O7398
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=34
prev=O7426
var_op='asgn
I
obj='Write
pag=34
rd_kfield=[
'RAPPORTO
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(LRTrim(column01),25)
'Left(LRTrim(column02),4)
]
wr_field=[
'IMPORTO1
'IMPORTO2
'IMPORTO3
'IMPORTO4
'IMPORTO5
'IMPORTO6
'TIPRAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Val(LRTrim(column03))
'Val(LRTrim(column04))
'Val(LRTrim(column05))
'Val(LRTrim(column06))
'Val(LRTrim(column07))
'Val(LRTrim(column08))
'_tipoag
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=34
prev=O7396
rd_field=[
'IDBASE
]
rd_kfield=[
'RAPPORTO
'ANNO
]
rd_kvar=[
'Left(LRTrim(column01),25)
'Left(LRTrim(column02),4)
]
rd_var=[
'xIDB
]
I
obj='Read
pag=34
prev=O7395
rd_field=[
'TIPOAG
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Left(LRTrim(column01),25)
]
rd_var=[
'_tipoag
]
I
obj='Var
pag=34
pagelocal=True
prev=O7394
var_op='asgn
I
obj='Var
pag=34
prev=O7393
var_op='asgn
I
obj='Var
pag=34
prev=O7392
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=34
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=34
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O7384
fatherSonIndex=0
frm_calc='// Legge il contenuto delle celle﷯Cell a01 = sheet.getCell(0,_y);﷯Cell a02 = sheet.getCell(1,_y);﷯Cell a03 = sheet.getCell(2,_y);﷯Cell a04 = sheet.getCell(3,_y);﷯Cell a05 = sheet.getCell(4,_y);﷯Cell a06 = sheet.getCell(5,_y);﷯Cell a07 = sheet.getCell(6,_y);﷯Cell a08 = sheet.getCell(7,_y);﷯Cell a09 = sheet.getCell(8,_y);﷯Cell a10 = sheet.getCell(9,_y);﷯Cell a11 = sheet.getCell(10,_y);
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
obj='Begin
pag=34
prev=O7446
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7447
fatherSonIndex=0
frm_calc='a01.getContents()
len=25
name='column01
next=Icpitembatch.CPVarDecl
frm_calc='a02.getContents()
len=25
name='column02
next=Icpitembatch.CPVarDecl
frm_calc='a03.getContents()
len=25
name='column03
next=Icpitembatch.CPVarDecl
frm_calc='a04.getContents()
len=25
name='column04
next=Icpitembatch.CPVarDecl
frm_calc='a05.getContents()
len=25
name='column05
next=Icpitembatch.CPVarDecl
frm_calc='a06.getContents()
len=25
name='column06
next=Icpitembatch.CPVarDecl
frm_calc='a07.getContents()
len=25
name='column07
next=Icpitembatch.CPVarDecl
frm_calc='a08.getContents()
len=25
name='column08
next=Icpitembatch.CPVarDecl
frm_calc='a09.getContents()
len=25
name='column09
next=Icpitembatch.CPVarDecl
frm_calc='a10.getContents()
len=25
name='column10
next=Icpitembatch.CPVarDecl
frm_calc='a11.getContents()
len=25
name='column11
obj='Var
pag=34
prev=O7460
var_op='asgn
I
obj='Var
pag=34
prev=O7459
var_op='asgn
I
obj='Var
pag=34
prev=O7458
var_op='asgn
I
obj='Var
pag=34
prev=O7457
var_op='asgn
I
obj='Var
pag=34
prev=O7456
var_op='asgn
I
obj='Var
pag=34
prev=O7455
var_op='asgn
I
obj='Var
pag=34
prev=O7454
var_op='asgn
I
obj='Var
pag=34
prev=O7453
var_op='asgn
I
obj='Var
pag=34
prev=O7452
var_op='asgn
I
obj='Var
pag=34
prev=O7451
var_op='asgn
I
obj='Var
pag=34
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Exec
pag=34
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=34
I
I
]
w=[
150
150
]
I
obj='Exec
pag=34
prev=O7370
I
obj='Begin
pag=34
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O7370
fatherSonIndex=0
frm_calc='//base﷯Workbook workbook = Workbook.getWorkbook(new File(CPLib.LRTrim(gPathDoc)+"/appo/"+CPLib.LRTrim(gAzienda)+"/"+CPLib.LRTrim(nomefileimport)));﷯_conta = workbook.getNumberOfSheets();
obj='Exec
pag=34
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O7297
var_op='asgn
I
obj='Var
obj_type='N
pag=34
prev=O7296
var_op='asgn
I
obj='Var
obj_type='N
pag=34
prev=O7295
var_op='asgn
I
obj='Var
pag=34
pagelocal=True
prev=O7294
I
obj='Remark
pag=34
x=10
y=22
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPBeginEnd
comment='Gestione storico import
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Titolari Effettivi Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Titolari Effettivi Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=35
prev=O7484
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=35
prev=O7483
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=35
prev=O7482
var_op='asgn
I
obj='Exec
pag=35
prev=O7481
I
obj='Exec
pag=35
prev=O7480
I
obj='Exec
pag=35
prev=O7478
I
obj='While
pag=35
prev=O7477
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7478
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
obj='Var
pag=35
prev=O7490
var_op='asgn
I
obj='If
pag=35
prev=O7489
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7490
fatherSonIndex=0
frm_calc='''
len=2
name='_tipooprap
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=35
prev=O7496
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xapotit
father=O7497
fatherSonIndex=0
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=35
prev=O7503
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xntestit
father=O7505
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=35
prev=O7510
var_op='asgn
I
obj='Write
pag=35
rd_kfield=[
'CODCLI
'CODINTER
'RAPPORTO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'Left(riga,25)
]
wr_field=[
'DESCINTER
'DATAINI
'NUMPROG1
'NUMIMP
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,66,30)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'_numprog
'_numimp
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7505
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xntestit
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=35
prev=O7520
var_op='asgn
I
obj='Insert
pag=35
prev=O7519
rd_kfield=[
'CODCLI
'CODINTER
'DATAINI
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
'NUMPROG1
'NUMIMP
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'Substr(riga,66,30)
'Left(riga,25)
'nProgImp
'LibreriaMit.UniqueId()
'_numprog
'_numimp
]
I
obj='Var
obj_type='N
pag=35
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=35
prev=O7502
sel_field='xntestit->IDBASE
sel_name='xntestit
sel_where='xntestit->CODCLI=Substr(riga,26,16) and xntestit->CODINTER=Substr(riga,42,16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7503
fatherSonIndex=0
frm_calc='1
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=35
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=35
rd_field=[
'NUMPROG
'TIPOOPRAP
]
rd_kfield=[
'CONNESCLI
'TIPOOPRAP
]
rd_kvar=[
'Substr(riga,26,16)
''50'
]
rd_var=[
'_numprog
'_tipooprap
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='rapotit
father=O7497
fatherSonIndex=1
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=35
prev=O7535
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestit
father=O7537
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=35
prev=O7542
var_op='asgn
I
obj='Write
pag=35
rd_kfield=[
'CODCLI
'CODINTER
'RAPPORTO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'Left(riga,25)
]
wr_field=[
'DESCINTER
'DATAINI
'NUMPROG1
'NUMIMP
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,66,30)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'_numprog
'_numimp
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7537
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='intestit
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=35
prev=O7552
var_op='asgn
I
obj='Insert
pag=35
prev=O7551
rd_kfield=[
'CODCLI
'CODINTER
'DATAINI
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
'STATOREG
'NUMPROG1
'NUMIMP
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'Substr(riga,66,30)
'Left(riga,25)
'nProgImp
'LibreriaMit.UniqueId()
''0'
'_numprog
'_numimp
]
I
obj='Var
obj_type='N
pag=35
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=35
prev=O7534
sel_field='intestit->IDBASE
sel_name='intestit
sel_where='intestit->CODCLI=Substr(riga,26,16) and intestit->CODINTER=Substr(riga,42,16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7535
fatherSonIndex=0
frm_calc='1
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=35
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=35
rd_field=[
'NUMPROG
'TIPOOPRAP
]
rd_kfield=[
'CONNESCLI
'TIPOOPRAP
]
rd_kvar=[
'Substr(riga,26,16)
''50'
]
rd_var=[
'_numprog
'_tipooprap
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=35
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=35
prev=O7488
var_op='asgn
I
obj='Var
obj_type='M
pag=35
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=35
prev=O7476
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=35
prev=O7474
var_op='asgn
I
obj='Begin
pag=35
prev=O7473
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7474
fatherSonIndex=0
frm_calc=[
'At("titosupp",_tabelle)=0
]
h=[
19
19
]
obj='If
pag=35
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7570
fatherSonIndex=0
frm_calc='_tabelle+"titosupp,"
len=10
name='_tabelle
obj='Var
obj_type='M
pag=35
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=35
prev=O7472
var_op='asgn
I
obj='Var
obj_type='N
pag=35
prev=O7471
var_op='asgn
I
obj='Remark
pag=35
x=13
y=21
I
Icpitembatch.CPIfElse
frm_calc=[
'_tipooprap='50'
'_tipooprap='51'
]
h=[
19
19
19
]
obj='If
pag=35
sons=[
Icpitembatch.CPItemSon
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xntestit
father=O7578
fatherSonIndex=1
obj='Write
pag=35
rd_kfield=[
'CODCLI
'CODINTER
'RAPPORTO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'Left(riga,25)
]
wr_field=[
'DESCINTER
'DATAFINE
'NUMPROG2
'NUMIMP
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,66,30)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'_numprog
'_numimp
]
I
I
]
w=[
150
150
150
]
x=847
y=582
I
Icpitembatch.CPIfElse
frm_calc=[
'_tipooprap='50'
'_tipooprap='51'
]
h=[
19
19
19
]
obj='If
pag=35
sons=[
Icpitembatch.CPItemSon
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xntestit
father=O7592
fatherSonIndex=1
obj='Insert
pag=35
rd_kfield=[
'CODCLI
'CODINTER
'DATAFINE
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
'NUMPROG2
'NUMIMP
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'Substr(riga,66,30)
'Left(riga,25)
'nProgImp
'LibreriaMit.UniqueId()
'_numprog
'_numimp
]
I
I
]
w=[
150
150
150
]
x=839
y=767
I
Icpitembatch.CPIfElse
frm_calc=[
'_tipooprap='50'
'_tipooprap='51'
]
h=[
19
19
19
]
obj='If
pag=35
sons=[
Icpitembatch.CPItemSon
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestit
father=O7602
fatherSonIndex=1
obj='Write
pag=35
rd_kfield=[
'CODCLI
'CODINTER
'RAPPORTO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'Left(riga,25)
]
wr_field=[
'DESCINTER
'DATAINI
'NUMPROG1
'NUMIMP
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,66,30)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'_numprog
'_numimp
]
I
I
]
w=[
150
150
150
]
x=873
y=968
I
Icpitembatch.CPIfElse
frm_calc=[
'_tipooprap='50'
'_tipooprap='51'
]
h=[
19
19
19
]
obj='If
pag=35
sons=[
Icpitembatch.CPItemSon
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='intestit
father=O7616
fatherSonIndex=1
obj='Insert
pag=35
rd_kfield=[
'CODCLI
'CODINTER
'DATAFINE
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
'STATOREG
'NUMPROG2
'NUMIMP
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'Substr(riga,66,30)
'Left(riga,25)
'nProgImp
'LibreriaMit.UniqueId()
''0'
'_numprog
'_numimp
]
I
I
]
w=[
150
150
150
]
x=860
y=1173
I
Icpitembatch.CPExec
check='man
frm_calc='// Create a buffer for reading the files﷯    byte[] buf = new byte[1024];﷯    ﷯    try {﷯        // Create the ZIP file﷯        String outFilename = cNomeFileZip;﷯        java.util.zip.ZipOutputStream out = new java.util.zip.ZipOutputStream(new java.io.FileOutputStream(outFilename));﷯    ﷯        // Compress the files﷯        for (int i=0; i<filenames.size(); i++) {﷯            _file1=(String)filenames.elementAt(i);﷯            _file2=(String)fileonames.elementAt(i);﷯            java.io.FileInputStream in = new java.io.FileInputStream(_file1);﷯    ﷯            // Add ZIP entry to output stream.﷯            out.putNextEntry(new java.util.zip.ZipEntry(_file2));﷯    ﷯            // Transfer bytes from the file to the ZIP file﷯            int len;﷯            while ((len = in.read(buf)) > 0) {﷯                out.write(buf, 0, len);﷯            }﷯    ﷯            // Complete the entry﷯            out.closeEntry();﷯            in.close();﷯            FileLibMit.DeleteFile(CPLib.LRTrim(gPathApp)+"/output/"+CPLib.LRTrim(gAzienda)+"/"+CPLib.LRTrim(_file2));﷯        }﷯    ﷯        // Complete the ZIP file﷯        out.close();﷯        filenames.removeAllElements();﷯        fileonames.removeAllElements();﷯    } catch (java.io.IOException e) {﷯    }﷯
obj='Exec
pag=36
x=15
y=21
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPBeginEnd
comment='Apro il foglio e verifico quante pagine ha
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='_i = 0
next=Icpitembatch.CPWhile
frm_calc='_i < _conta
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='workbook.close()
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Modificate: '+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=37
prev=O7639
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=37
prev=O7638
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=37
prev=O7637
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=37
prev=O7636
var_op='asgn
I
obj='Exec
pag=37
prev=O7634
I
obj='While
pag=37
prev=O7633
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O7634
fatherSonIndex=0
frm_calc='_righe = 0;﷯Sheet sheet = workbook.getSheet(_i);﷯_righe = sheet.getRows();﷯_y = 1;
next=Icpitembatch.CPWhile
frm_calc='_y < _righe
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=37
prev=O7644
I
obj='While
pag=37
prev=O7643
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Legge le colonne e scrive i dati nelle variabili appoggio
father=O7644
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPExec
check='man
frm_calc='_y++;
obj='Exec
pag=37
prev=O7655
I
obj='If
pag=37
prev=O7653
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O7655
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column28)))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(column34)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc='_flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(column36)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(LRTrim(column01))))) or Empty(LRTrim(_numprog))
]
h=[
19
19
]
obj='If
pag=37
prev=O7678
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7681
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(LRTrim(column01))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPCase
frm_calc=[
'LRTrim(column16)='S'
'LRTrim(column16)='E'
'LRTrim(column16)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Left(column15,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPVarDecl
frm_calc='iif(LRTrim(column02)='1' or LRTrim(column02)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column32)),'0',iif(LRTrim(column32)='S','1',iif(LRTrim(column32)='N','0',LRTrim(column32))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(LRTrim(column24))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono state elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column06)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_z
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='operazbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_oldidb)))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=37
prev=O7715
var_op='asgn
I
obj='If
pag=37
prev=O7713
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O7715
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='sogopebo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='clientiope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='beneficope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='terzistiope
obj='Delete
pag=37
prev=O7730
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=37
prev=O7729
sel_field='*
sel_name='terzistiope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistiope
father=O7730
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'cOpeProg1
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=37
prev=O7727
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=37
prev=O7726
sel_field='*
sel_name='beneficope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficope
father=O7727
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
]
rd_kvar=[
'cOpeProg1
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=37
prev=O7724
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=37
prev=O7723
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O7724
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=37
prev=O7721
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=37
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sogopebo
father=O7721
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7715
fatherSonIndex=1
frm_calc=[
'Empty(LRTrim(column21)) and not(Empty(LRTrim(column12)))
]
h=[
19
19
]
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O7770
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=37
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=LRTrim(column12)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7775
fatherSonIndex=0
frm_calc=[
'LRTrim(intestbo->CODINTER) <> LRTrim(column21)
]
h=[
19
19
]
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O7779
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'RAPCOL
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
'LRTrim(column12)
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=37
prev=O7711
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
]
rd_kvar=[
'LRTrim(column42)
'Val(Right(LRTrim(column01),4))
'arfn_conv_stato_uic(Left(LRTrim(column40),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'LRTrim(column62)
'_bensta
'Val(LRTrim(column23)) / 10000
'Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2)
'Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2)
'DateToChar(_datareg)
'LRTrim(column03)
'_intercab
'LRTrim(column10)
'column28
'LRTrim(column06)
'_intercod
'LRTrim(column04)
'LRTrim(column50)
'LRTrim(column33)
'LRTrim(column21)
'LRTrim(column22)
'CharToDate(Right(LRTrim(column51),4)+Substr(LRTrim(column51),3,2)+Left(LRTrim(column51),2))
'CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))
'_datareg
'_datarett
'LRTrim(column08)
'_intercit
'Left(LRTrim(column11),50)
'Val(LRTrim(column67))
'LRTrim(column43)
'cFlagCont
'cFlagFraz
'cFlagLire
'LRTrim(column13)
'_flagrap2
'cOpeProg1
'cIdCau
'"O"+Right(cOpeProg2,9)+_idb2
'column41
'LRTrim(column65)
'LRTrim(column39)
'LRTrim(column60)
'cOpeProg2
'LRTrim(column35)
'_idreg
''1'
'CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6))
'arfn_conv_stato_uic(LRTrim(column07))
'LRTrim(column64)
'nProgImp
'LRTrim(column09)
'_interprv
'LRTrim(column38)
'LRTrim(column63)
'LRTrim(column12)
'Val(LRTrim(column47))
'Val(LRTrim(column46))
'Val(LRTrim(column49))
'column36
'Val(LRTrim(column48))
'Val(LRTrim(column45))
'Val(LRTrim(column52))
'LRTrim(column61)
'LRTrim(column18)
'_statoreg
'LRTrim(column44)
''1'
'LRTrim(column05)
'LRTrim(column26)
'LRTrim(column14)
'LRTrim(column25)
'Val(LRTrim(column20))
'Val(column19)
'column34
'LRTrim(column17)
'LRTrim(column37)
'_colleg
'_idb2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7713
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))+" con importo "+Str((Val(column19))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=37
prev=O7797
I
obj='Var
obj_type='N
pag=37
prev=O7796
var_op='asgn
I
obj='Exec
pag=37
prev=O7795
I
nonlocal=True
obj='Var
obj_type='M
pag=37
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=37
prev=O7710
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=LRTrim(column12)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7711
fatherSonIndex=0
frm_calc=[
'_z=0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_z + 1
len=10
name='_z
obj='Var
obj_type='N
pag=37
prev=O7802
var_op='asgn
I
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7802
fatherSonIndex=0
frm_calc='intestbo->CODINTER
len=25
name='column21
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=37
prev=O7707
var_op='asgn
I
obj='If
pag=37
prev=O7705
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O7707
fatherSonIndex=0
obj='Read
pag=37
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'LRTrim(column06)
]
rd_var=[
'column10
'column08
'column09
'column07
'column11
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=37
prev=O7704
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O7705
fatherSonIndex=0
frm_calc='Upper(LRTrim(column53))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(LRTrim(column54))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column55))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(column56)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column57))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column58))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column59))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(LRTrim(column33)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(LRTrim(column33))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=37
prev=O7831
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7834
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(column12)))
]
h=[
19
19
]
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O7839
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=37
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=LRTrim(column12)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7844
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=37
prev=O7855
I
obj='Read
pag=37
prev=O7854
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=37
prev=O7853
var_op='asgn
I
obj='Var
pag=37
prev=O7852
var_op='asgn
I
obj='Var
pag=37
prev=O7851
var_op='asgn
I
obj='Var
pag=37
prev=O7850
var_op='asgn
I
obj='Var
pag=37
prev=O7849
var_op='asgn
I
obj='Var
pag=37
prev=O7848
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O7828
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7831
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=37
prev=O7872
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column33)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=37
prev=O7871
var_op='asgn
I
obj='Var
pag=37
prev=O7870
var_op='asgn
I
obj='Var
pag=37
prev=O7869
var_op='asgn
I
obj='Var
pag=37
prev=O7868
var_op='asgn
I
obj='Var
pag=37
prev=O7867
var_op='asgn
I
obj='Var
pag=37
prev=O7866
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O7827
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O7828
fatherSonIndex=0
obj='Read
pag=37
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=37
prev=O7826
var_op='asgn
I
obj='Var
pag=37
prev=O7825
var_op='asgn
I
obj='Var
pag=37
prev=O7824
var_op='asgn
I
obj='Var
pag=37
prev=O7823
var_op='asgn
I
obj='Var
pag=37
prev=O7822
var_op='asgn
I
obj='Var
pag=37
prev=O7821
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=37
prev=O7703
var_op='asgn
I
obj='Var
obj_type='N
pag=37
prev=O7702
var_op='asgn
I
obj='Var
obj_type='N
pag=37
prev=O7700
var_op='asgn
I
obj='Select
pag=37
par_expr=[
'Left(LRTrim(column03),4)
'Left(LRTrim(column04),2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O7699
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7700
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=37
prev=O7698
var_op='asgn
I
obj='Var
pag=37
prev=O7697
var_op='asgn
I
obj='Var
pag=37
prev=O7696
var_op='asgn
I
obj='Var
pag=37
prev=O7695
var_op='asgn
I
obj='Var
pag=37
prev=O7694
var_op='asgn
I
obj='Var
pag=37
prev=O7693
var_op='asgn
I
obj='Var
obj_type='D
pag=37
prev=O7690
var_op='asgn
I
obj='Case
pag=37
prev=O7689
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7690
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=37
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7690
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=37
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7690
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=37
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7690
fatherSonIndex=3
frm_calc='LRTrim(column16)
len=1
name='cFlagLire
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Var
pag=37
prev=O7686
var_op='asgn
I
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7686
fatherSonIndex=0
frm_calc='_numprog
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''1'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
obj='Var
obj_type='D
pag=37
prev=O7907
var_op='asgn
I
obj='Var
pag=37
prev=O7906
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7686
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("POPERAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''0'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datarett
obj='Var
obj_type='D
pag=37
prev=O7911
var_op='asgn
I
obj='Var
pag=37
prev=O7910
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O7675
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O7678
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(LRTrim(column01)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7917
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=37
prev=O7922
sel_field='operazbo->IDBASE
sel_name='operazbo
sel_where='operazbo->NUMPROG=_numprog and (operazbo->STATOREG='0'  or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O7923
fatherSonIndex=0
frm_calc='"E' stata cancellata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=37
prev=O7927
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'operazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
]
wr_var=[
''2'
'Date()
]
I
nonlocal=True
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
father=O7917
fatherSonIndex=1
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"E' stata variata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=37
prev=O7938
sel_field='operazbo->IDBASE,operazbo->NUMPROG,operazbo->DATAOPE,operazbo->FLAGRAP2
sel_name='operazbo
sel_where='operazbo->NUMPROG=_numprog and (operazbo->STATOREG='0'  or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7939
fatherSonIndex=0
frm_calc='operazbo->IDBASE
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(operazbo->FLAGRAP2) or operazbo->FLAGRAP2='S',Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(operazbo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='operazbo->IDEREG
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='operazbo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=37
prev=O7951
sel_field='*
sel_name='terzistiope
sel_where='terzistiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='merzistiope
father=O7953
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'IDREG
]
rd_kvar=[
'_oldidb
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=37
prev=O7949
sel_field='*
sel_name='beneficope
sel_where='beneficope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='meneficope
father=O7951
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
'IDREG
]
rd_kvar=[
'_oldidb
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=37
prev=O7947
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mlientiope
father=O7949
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=37
prev=O7946
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mogopebo
father=O7947
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=37
prev=O7945
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'operazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
'FLAGRAP2
]
wr_op=[
'=
'=
'=
]
wr_var=[
''3'
'Date()
'_flagrap2
]
I
obj='Var
pag=37
prev=O7944
var_op='asgn
I
obj='Var
pag=37
prev=O7943
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=37
prev=O7937
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O7674
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7675
fatherSonIndex=0
frm_calc=[
'w_norifimp='N'
]
h=[
19
19
]
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7990
fatherSonIndex=0
frm_calc=[
'Upper(column36)='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O7995
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=37
sel_field='operazbo->NUMPROG
sel_name='operazbo
sel_where='operazbo->INFORM = column41 and (operazbo->STATOREG='0' or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8000
fatherSonIndex=0
frm_calc='operazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O7995
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=37
sel_field='operazbo->NUMPROG
sel_name='operazbo
sel_where='operazbo->RIFIMP = column36 and (operazbo->STATOREG='0' or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8007
fatherSonIndex=0
frm_calc='operazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=37
prev=O7673
var_op='asgn
I
obj='Var
pag=37
prev=O7672
var_op='asgn
I
obj='Var
pag=37
prev=O7671
var_op='asgn
I
obj='Var
pag=37
prev=O7668
var_op='asgn
I
obj='If
pag=37
prev=O7667
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O7668
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=37
prev=O8018
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8019
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))+" con importo "+Str((Val(column19))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=37
prev=O8025
I
obj='Var
obj_type='N
pag=37
prev=O8024
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=37
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'column34
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=37
prev=O7666
var_op='asgn
I
obj='Remark
pag=37
prev=O7663
I
obj='If
pag=37
prev=O7661
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7663
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column29)+LRTrim(column31)+LRTrim(column30)))
]
h=[
19
19
]
obj='If
pag=37
prev=O8037
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8040
fatherSonIndex=0
frm_calc='LRTrim(column29)
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(column31)
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(column30)
len=2
name='_interprv
obj='Var
pag=37
prev=O8046
var_op='asgn
I
obj='Var
pag=37
prev=O8045
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O8036
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8037
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))+" con importo "+Str((Val(column19))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(column28)+" non è presente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=37
prev=O8052
I
obj='Var
obj_type='N
pag=37
prev=O8051
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=37
prev=O8035
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'column28
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7661
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(column27)),_codinter,column27)
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column29)),_citinter,column29)
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column31)),_cabinter,column31)
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column30)),_prvinter,column30)
len=2
name='_interprv
obj='Var
pag=37
prev=O8064
var_op='asgn
I
obj='Var
pag=37
prev=O8063
var_op='asgn
I
obj='Var
pag=37
prev=O8062
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7655
fatherSonIndex=1
frm_calc='1
len=1
name='_opeerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(ohand,riga)
obj='Exec
pag=37
prev=O8068
I
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=37
prev=O7651
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O7653
fatherSonIndex=0
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column21)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column22))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column33))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column50))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(column21)) and Empty(LRTrim(column12)) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=37
prev=O8083
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8086
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O8080
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8083
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=37
prev=O8096
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8097
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=37
prev=O8095
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column50)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O8077
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8080
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=37
prev=O8112
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8113
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=37
prev=O8111
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column33)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O8074
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8077
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=37
prev=O8128
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8129
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=37
prev=O8127
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column22)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O8073
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8074
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=37
prev=O8144
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8145
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=37
prev=O8143
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column21)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=37
prev=O7649
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O7651
fatherSonIndex=0
frm_calc='a01.getContents()
len=25
name='column01
next=Icpitembatch.CPVarDecl
frm_calc='a02.getContents()
len=25
name='column02
next=Icpitembatch.CPVarDecl
frm_calc='a03.getContents()
len=25
name='column03
next=Icpitembatch.CPVarDecl
frm_calc='a04.getContents()
len=25
name='column04
next=Icpitembatch.CPVarDecl
frm_calc='a05.getContents()
len=25
name='column05
next=Icpitembatch.CPVarDecl
frm_calc='a06.getContents()
len=25
name='column06
next=Icpitembatch.CPVarDecl
frm_calc='a07.getContents()
len=25
name='column07
next=Icpitembatch.CPVarDecl
frm_calc='a08.getContents()
len=25
name='column08
next=Icpitembatch.CPVarDecl
frm_calc='a09.getContents()
len=25
name='column09
next=Icpitembatch.CPVarDecl
frm_calc='a10.getContents()
len=25
name='column10
next=Icpitembatch.CPVarDecl
frm_calc='a11.getContents()
len=25
name='column11
next=Icpitembatch.CPVarDecl
frm_calc='a12.getContents()
len=25
name='column12
next=Icpitembatch.CPVarDecl
frm_calc='a13.getContents()
len=25
name='column13
next=Icpitembatch.CPVarDecl
frm_calc='a14.getContents()
len=25
name='column14
next=Icpitembatch.CPVarDecl
frm_calc='a15.getContents()
len=25
name='column15
next=Icpitembatch.CPVarDecl
frm_calc='a16.getContents()
len=25
name='column16
next=Icpitembatch.CPVarDecl
frm_calc='a17.getContents()
len=25
name='column17
next=Icpitembatch.CPVarDecl
frm_calc='a18.getContents()
len=25
name='column18
next=Icpitembatch.CPVarDecl
frm_calc='a19.getContents()
len=25
name='column19
next=Icpitembatch.CPVarDecl
frm_calc='a20.getContents()
len=25
name='column20
next=Icpitembatch.CPVarDecl
frm_calc='a21.getContents()
len=25
name='column21
next=Icpitembatch.CPVarDecl
frm_calc='a22.getContents()
len=25
name='column22
next=Icpitembatch.CPVarDecl
frm_calc='a23.getContents()
len=25
name='column23
next=Icpitembatch.CPVarDecl
frm_calc='a24.getContents()
len=25
name='column24
next=Icpitembatch.CPVarDecl
frm_calc='a25.getContents()
len=25
name='column25
next=Icpitembatch.CPVarDecl
frm_calc='a26.getContents()
len=25
name='column26
next=Icpitembatch.CPVarDecl
frm_calc='a27.getContents()
len=25
name='column27
next=Icpitembatch.CPVarDecl
frm_calc='a28.getContents()
len=25
name='column28
next=Icpitembatch.CPVarDecl
frm_calc='a29.getContents()
len=25
name='column29
next=Icpitembatch.CPVarDecl
frm_calc='a30.getContents()
len=25
name='column30
next=Icpitembatch.CPVarDecl
frm_calc='a31.getContents()
len=25
name='column31
next=Icpitembatch.CPVarDecl
frm_calc='a32.getContents()
len=25
name='column32
next=Icpitembatch.CPVarDecl
frm_calc='a33.getContents()
len=25
name='column33
next=Icpitembatch.CPVarDecl
frm_calc='a34.getContents()
len=25
name='column34
next=Icpitembatch.CPVarDecl
frm_calc='a35.getContents()
len=25
name='column35
next=Icpitembatch.CPVarDecl
frm_calc='a36.getContents()
len=25
name='column36
next=Icpitembatch.CPVarDecl
frm_calc='a37.getContents()
len=25
name='column37
next=Icpitembatch.CPVarDecl
frm_calc='a38.getContents()
len=25
name='column38
next=Icpitembatch.CPVarDecl
frm_calc='a39.getContents()
len=25
name='column39
next=Icpitembatch.CPVarDecl
frm_calc='a40.getContents()
len=25
name='column40
next=Icpitembatch.CPVarDecl
frm_calc='a41.getContents()
len=25
name='column41
next=Icpitembatch.CPVarDecl
frm_calc='a42.getContents()
len=25
name='column42
next=Icpitembatch.CPVarDecl
frm_calc='a43.getContents()
len=25
name='column43
next=Icpitembatch.CPVarDecl
frm_calc='a44.getContents()
len=25
name='column44
next=Icpitembatch.CPVarDecl
frm_calc='a45.getContents()
len=25
name='column45
next=Icpitembatch.CPVarDecl
frm_calc='a46.getContents()
len=25
name='column46
next=Icpitembatch.CPVarDecl
frm_calc='a47.getContents()
len=25
name='column47
next=Icpitembatch.CPVarDecl
frm_calc='a48.getContents()
len=25
name='column48
next=Icpitembatch.CPVarDecl
frm_calc='a49.getContents()
len=25
name='column49
next=Icpitembatch.CPVarDecl
frm_calc='a50.getContents()
len=25
name='column50
next=Icpitembatch.CPVarDecl
frm_calc='a51.getContents()
len=25
name='column51
next=Icpitembatch.CPVarDecl
frm_calc='a52.getContents()
len=25
name='column52
next=Icpitembatch.CPVarDecl
frm_calc='a53.getContents()
len=25
name='column53
next=Icpitembatch.CPVarDecl
frm_calc='a54.getContents()
len=25
name='column54
next=Icpitembatch.CPVarDecl
frm_calc='a55.getContents()
len=25
name='column55
next=Icpitembatch.CPVarDecl
frm_calc='a56.getContents()
len=25
name='column56
next=Icpitembatch.CPVarDecl
frm_calc='a57.getContents()
len=25
name='column57
next=Icpitembatch.CPVarDecl
frm_calc='a58.getContents()
len=25
name='column58
next=Icpitembatch.CPVarDecl
frm_calc='a59.getContents()
len=25
name='column59
next=Icpitembatch.CPVarDecl
frm_calc='a60.getContents()
len=25
name='column60
next=Icpitembatch.CPVarDecl
frm_calc='a61.getContents()
len=25
name='column61
next=Icpitembatch.CPVarDecl
frm_calc='a62.getContents()
len=25
name='column62
next=Icpitembatch.CPVarDecl
frm_calc='a63.getContents()
len=25
name='column63
next=Icpitembatch.CPVarDecl
frm_calc='a64.getContents()
len=25
name='column64
next=Icpitembatch.CPVarDecl
frm_calc='a65.getContents()
len=25
name='column65
next=Icpitembatch.CPVarDecl
frm_calc='a66.getContents()
len=25
name='column66
next=Icpitembatch.CPVarDecl
frm_calc='a67.getContents()
len=25
name='column67
obj='Var
pag=37
prev=O8225
var_op='asgn
I
obj='Var
pag=37
prev=O8224
var_op='asgn
I
obj='Var
pag=37
prev=O8223
var_op='asgn
I
obj='Var
pag=37
prev=O8222
var_op='asgn
I
obj='Var
pag=37
prev=O8221
var_op='asgn
I
obj='Var
pag=37
prev=O8220
var_op='asgn
I
obj='Var
pag=37
prev=O8219
var_op='asgn
I
obj='Var
pag=37
prev=O8218
var_op='asgn
I
obj='Var
pag=37
prev=O8217
var_op='asgn
I
obj='Var
pag=37
prev=O8216
var_op='asgn
I
obj='Var
pag=37
prev=O8215
var_op='asgn
I
obj='Var
pag=37
prev=O8214
var_op='asgn
I
obj='Var
pag=37
prev=O8213
var_op='asgn
I
obj='Var
pag=37
prev=O8212
var_op='asgn
I
obj='Var
pag=37
prev=O8211
var_op='asgn
I
obj='Var
pag=37
prev=O8210
var_op='asgn
I
obj='Var
pag=37
prev=O8209
var_op='asgn
I
obj='Var
pag=37
prev=O8208
var_op='asgn
I
obj='Var
pag=37
prev=O8207
var_op='asgn
I
obj='Var
pag=37
prev=O8206
var_op='asgn
I
obj='Var
pag=37
prev=O8205
var_op='asgn
I
obj='Var
pag=37
prev=O8204
var_op='asgn
I
obj='Var
pag=37
prev=O8203
var_op='asgn
I
obj='Var
pag=37
prev=O8202
var_op='asgn
I
obj='Var
pag=37
prev=O8201
var_op='asgn
I
obj='Var
pag=37
prev=O8200
var_op='asgn
I
obj='Var
pag=37
prev=O8199
var_op='asgn
I
obj='Var
pag=37
prev=O8198
var_op='asgn
I
obj='Var
pag=37
prev=O8197
var_op='asgn
I
obj='Var
pag=37
prev=O8196
var_op='asgn
I
obj='Var
pag=37
prev=O8195
var_op='asgn
I
obj='Var
pag=37
prev=O8194
var_op='asgn
I
obj='Var
pag=37
prev=O8193
var_op='asgn
I
obj='Var
pag=37
prev=O8192
var_op='asgn
I
obj='Var
pag=37
prev=O8191
var_op='asgn
I
obj='Var
pag=37
prev=O8190
var_op='asgn
I
obj='Var
pag=37
prev=O8189
var_op='asgn
I
obj='Var
pag=37
prev=O8188
var_op='asgn
I
obj='Var
pag=37
prev=O8187
var_op='asgn
I
obj='Var
pag=37
prev=O8186
var_op='asgn
I
obj='Var
pag=37
prev=O8185
var_op='asgn
I
obj='Var
pag=37
prev=O8184
var_op='asgn
I
obj='Var
pag=37
prev=O8183
var_op='asgn
I
obj='Var
pag=37
prev=O8182
var_op='asgn
I
obj='Var
pag=37
prev=O8181
var_op='asgn
I
obj='Var
pag=37
prev=O8180
var_op='asgn
I
obj='Var
pag=37
prev=O8179
var_op='asgn
I
obj='Var
pag=37
prev=O8178
var_op='asgn
I
obj='Var
pag=37
prev=O8177
var_op='asgn
I
obj='Var
pag=37
prev=O8176
var_op='asgn
I
obj='Var
pag=37
prev=O8175
var_op='asgn
I
obj='Var
pag=37
prev=O8174
var_op='asgn
I
obj='Var
pag=37
prev=O8173
var_op='asgn
I
obj='Var
pag=37
prev=O8172
var_op='asgn
I
obj='Var
pag=37
prev=O8171
var_op='asgn
I
obj='Var
pag=37
prev=O8170
var_op='asgn
I
obj='Var
pag=37
prev=O8169
var_op='asgn
I
obj='Var
pag=37
prev=O8168
var_op='asgn
I
obj='Var
pag=37
prev=O8167
var_op='asgn
I
obj='Var
pag=37
prev=O8166
var_op='asgn
I
obj='Var
pag=37
prev=O8165
var_op='asgn
I
obj='Var
pag=37
prev=O8164
var_op='asgn
I
obj='Var
pag=37
prev=O8163
var_op='asgn
I
obj='Var
pag=37
prev=O8162
var_op='asgn
I
obj='Var
pag=37
prev=O8161
var_op='asgn
I
obj='Var
pag=37
prev=O8160
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=37
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPExec
check='man
father=O7649
fatherSonIndex=0
frm_calc='// Legge il contenuto delle celle﷯Cell a01 = sheet.getCell(0,_y);﷯Cell a02 = sheet.getCell(1,_y);﷯Cell a03 = sheet.getCell(2,_y);﷯Cell a04 = sheet.getCell(3,_y);﷯Cell a05 = sheet.getCell(4,_y);﷯Cell a06 = sheet.getCell(5,_y);﷯Cell a07 = sheet.getCell(6,_y);﷯Cell a08 = sheet.getCell(7,_y);﷯Cell a09 = sheet.getCell(8,_y);﷯Cell a10 = sheet.getCell(9,_y);﷯Cell a11 = sheet.getCell(10,_y);﷯Cell a12 = sheet.getCell(11,_y);﷯Cell a13 = sheet.getCell(12,_y);﷯Cell a14 = sheet.getCell(13,_y);﷯Cell a15 = sheet.getCell(14,_y);﷯Cell a16 = sheet.getCell(15,_y);﷯Cell a17 = sheet.getCell(16,_y);﷯Cell a18 = sheet.getCell(17,_y);﷯Cell a19 = sheet.getCell(18,_y);﷯Cell a20 = sheet.getCell(19,_y);﷯Cell a21 = sheet.getCell(20,_y);﷯Cell a22 = sheet.getCell(21,_y);﷯Cell a23 = sheet.getCell(22,_y);﷯Cell a24 = sheet.getCell(23,_y);﷯Cell a25 = sheet.getCell(24,_y);﷯Cell a26 = sheet.getCell(25,_y);﷯Cell a27 = sheet.getCell(26,_y);﷯Cell a28 = sheet.getCell(27,_y);﷯Cell a29 = sheet.getCell(28,_y);﷯Cell a30 = sheet.getCell(29,_y);﷯Cell a31 = sheet.getCell(30,_y);﷯Cell a32 = sheet.getCell(31,_y);﷯Cell a33 = sheet.getCell(32,_y);﷯Cell a34 = sheet.getCell(33,_y);﷯Cell a35 = sheet.getCell(34,_y);﷯Cell a36 = sheet.getCell(35,_y);﷯Cell a37 = sheet.getCell(36,_y);﷯Cell a38 = sheet.getCell(37,_y);﷯Cell a39 = sheet.getCell(38,_y);﷯Cell a40 = sheet.getCell(39,_y);﷯Cell a41 = sheet.getCell(40,_y);﷯Cell a42 = sheet.getCell(41,_y);﷯Cell a43 = sheet.getCell(42,_y);﷯Cell a44 = sheet.getCell(43,_y);﷯Cell a45 = sheet.getCell(44,_y);﷯Cell a46 = sheet.getCell(45,_y);﷯Cell a47 = sheet.getCell(46,_y);﷯Cell a48 = sheet.getCell(47,_y);﷯Cell a49 = sheet.getCell(48,_y);﷯Cell a50 = sheet.getCell(49,_y);﷯Cell a51 = sheet.getCell(50,_y);﷯Cell a52 = sheet.getCell(51,_y);﷯Cell a53 = sheet.getCell(52,_y);﷯Cell a54 = sheet.getCell(53,_y);﷯Cell a55 = sheet.getCell(54,_y);﷯Cell a56 = sheet.getCell(55,_y);﷯Cell a57 = sheet.getCell(56,_y);﷯Cell a58 = sheet.getCell(57,_y);﷯Cell a59 = sheet.getCell(58,_y);﷯Cell a60 = sheet.getCell(59,_y);﷯Cell a61 = sheet.getCell(60,_y);﷯Cell a62 = sheet.getCell(61,_y);﷯Cell a63 = sheet.getCell(62,_y);﷯Cell a64 = sheet.getCell(63,_y);﷯Cell a65 = sheet.getCell(64,_y);﷯Cell a66 = sheet.getCell(65,_y);﷯Cell a67 = sheet.getCell(66,_y);
obj='Exec
pag=37
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=37
I
I
]
w=[
150
150
]
I
obj='Exec
pag=37
prev=O7631
I
obj='Begin
pag=37
prev=O7630
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O7631
fatherSonIndex=0
frm_calc='//base﷯Workbook workbook = Workbook.getWorkbook(new File(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(gAzienda)+"/"+CPLib.LRTrim(nomefileimport)));﷯_conta = workbook.getNumberOfSheets();
obj='Exec
pag=37
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=37
prev=O7629
var_op='asgn
I
obj='Var
obj_type='N
pag=37
prev=O7628
var_op='asgn
I
obj='Var
obj_type='N
pag=37
prev=O7627
var_op='asgn
I
obj='Remark
pag=37
x=13
y=29
I
Icpitembatch.CPRead
arch='tbcauana
obj='Read
pag=37
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'LRTrim(Substr(riga,10,4))
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
x=463
y=3942
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPBeginEnd
comment='Apro il foglio e verifico quante pagine ha
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='_i = 0
next=Icpitembatch.CPWhile
frm_calc='_i < _conta
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='workbook.close()
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Modificate: '+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=38
prev=O8255
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=38
prev=O8254
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=38
prev=O8253
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=38
prev=O8252
var_op='asgn
I
obj='Exec
pag=38
prev=O8250
I
obj='While
pag=38
prev=O8249
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O8250
fatherSonIndex=0
frm_calc='_righe = 0;﷯Sheet sheet = workbook.getSheet(_i);﷯_righe = sheet.getRows();﷯_y = 1;
next=Icpitembatch.CPWhile
frm_calc='_y < _righe
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=38
prev=O8260
I
obj='While
pag=38
prev=O8259
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Legge le colonne e scrive i dati nelle variabili appoggio
father=O8260
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPExec
check='man
frm_calc='_y++;
obj='Exec
pag=38
prev=O8271
I
obj='If
pag=38
prev=O8269
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O8271
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column28)))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(column34)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPCase
frm_calc=[
'LRTrim(column16)='S'
'LRTrim(column16)='E'
'LRTrim(column16)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Left(column15,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(LRTrim(column02)='1' or LRTrim(column02)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column32)),'0',iif(LRTrim(column32)='S','1',iif(LRTrim(column32)='N','0',LRTrim(column32))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(LRTrim(column24))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono state elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column06)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_z
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xperazbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=38
prev=O8312
var_op='asgn
I
obj='Insert
pag=38
prev=O8310
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'NUMIMP
]
rd_kvar=[
'LRTrim(column42)
'Val(Right(LRTrim(column01),4))
'arfn_conv_stato_uic(Left(LRTrim(column40),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'LRTrim(column62)
'_bensta
'Val(LRTrim(column23)) / 10000
'Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2)
'Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2)
'DateToChar(_datareg)
'LRTrim(column03)
'_intercab
'LRTrim(column10)
'column28
'LRTrim(column06)
'_intercod
'LRTrim(column04)
'LRTrim(column50)
'LRTrim(column33)
'LRTrim(column21)
'LRTrim(column22)
'CharToDate(Right(LRTrim(column51),4)+Substr(LRTrim(column51),3,2)+Left(LRTrim(column51),2))
'CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))
'_datareg
'_datarett
'LRTrim(column08)
'_intercit
'Left(LRTrim(column11),50)
'Val(LRTrim(column67))
'LRTrim(column43)
'cFlagCont
'cFlagFraz
'cFlagLire
'LRTrim(column13)
'_flagrap2
'cOpeProg1
'cIdCau
'"O"+Right(cOpeProg2,9)+_idb2
'column41
'LRTrim(column65)
'LRTrim(column39)
'LRTrim(column60)
'cOpeProg2
'LRTrim(column35)
'_idreg
''1'
'CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6))
'arfn_conv_stato_uic(LRTrim(column07))
'LRTrim(column64)
'nProgImp
'LRTrim(column09)
'_interprv
'LRTrim(column38)
'LRTrim(column63)
'LRTrim(column12)
'Val(LRTrim(column47))
'Val(LRTrim(column46))
'Val(LRTrim(column49))
'column36
'Val(LRTrim(column48))
'Val(LRTrim(column45))
'Val(LRTrim(column52))
'LRTrim(column61)
'LRTrim(column18)
'_statoreg
'LRTrim(column44)
''1'
'LRTrim(column05)
'LRTrim(column26)
'LRTrim(column14)
'LRTrim(column25)
'Val(LRTrim(column20))
'Val(column19)
'column34
'LRTrim(column17)
'LRTrim(column37)
'_colleg
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8312
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))+" con importo "+Str((Val(column19))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=38
prev=O8321
I
obj='Var
obj_type='N
pag=38
prev=O8320
var_op='asgn
I
obj='Exec
pag=38
prev=O8319
I
nonlocal=True
obj='Var
obj_type='M
pag=38
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=38
prev=O8309
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=LRTrim(column12)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O8310
fatherSonIndex=0
frm_calc=[
'_z=0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_z + 1
len=10
name='_z
obj='Var
obj_type='N
pag=38
prev=O8326
var_op='asgn
I
obj='If
pag=38
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8326
fatherSonIndex=0
frm_calc='intestbo->CODINTER
len=25
name='column21
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=38
prev=O8306
var_op='asgn
I
obj='If
pag=38
prev=O8304
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O8306
fatherSonIndex=0
obj='Read
pag=38
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'LRTrim(column06)
]
rd_var=[
'column10
'column08
'column09
'column07
'column11
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=38
prev=O8303
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O8304
fatherSonIndex=0
frm_calc='Upper(LRTrim(column53))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(LRTrim(column54))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column55))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(column56)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column57))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column58))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column59))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(LRTrim(column33)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(LRTrim(column33))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=38
prev=O8355
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O8358
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(column12)))
]
h=[
19
19
]
obj='If
pag=38
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O8363
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=38
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=LRTrim(column12)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8368
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=38
prev=O8379
I
obj='Read
pag=38
prev=O8378
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=38
prev=O8377
var_op='asgn
I
obj='Var
pag=38
prev=O8376
var_op='asgn
I
obj='Var
pag=38
prev=O8375
var_op='asgn
I
obj='Var
pag=38
prev=O8374
var_op='asgn
I
obj='Var
pag=38
prev=O8373
var_op='asgn
I
obj='Var
pag=38
prev=O8372
var_op='asgn
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O8352
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8355
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=38
prev=O8396
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column33)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=38
prev=O8395
var_op='asgn
I
obj='Var
pag=38
prev=O8394
var_op='asgn
I
obj='Var
pag=38
prev=O8393
var_op='asgn
I
obj='Var
pag=38
prev=O8392
var_op='asgn
I
obj='Var
pag=38
prev=O8391
var_op='asgn
I
obj='Var
pag=38
prev=O8390
var_op='asgn
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O8351
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O8352
fatherSonIndex=0
obj='Read
pag=38
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=38
prev=O8350
var_op='asgn
I
obj='Var
pag=38
prev=O8349
var_op='asgn
I
obj='Var
pag=38
prev=O8348
var_op='asgn
I
obj='Var
pag=38
prev=O8347
var_op='asgn
I
obj='Var
pag=38
prev=O8346
var_op='asgn
I
obj='Var
pag=38
prev=O8345
var_op='asgn
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=38
prev=O8302
var_op='asgn
I
obj='Var
obj_type='N
pag=38
prev=O8301
var_op='asgn
I
obj='Var
obj_type='N
pag=38
prev=O8299
var_op='asgn
I
obj='Select
pag=38
par_expr=[
'Left(LRTrim(column03),4)
'Left(LRTrim(column04),2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O8298
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8299
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=38
prev=O8297
var_op='asgn
I
obj='Var
pag=38
prev=O8296
var_op='asgn
I
obj='Var
pag=38
prev=O8295
var_op='asgn
I
obj='Var
pag=38
prev=O8294
var_op='asgn
I
obj='Var
pag=38
prev=O8293
var_op='asgn
I
obj='Var
obj_type='D
pag=38
prev=O8290
var_op='asgn
I
obj='Case
pag=38
prev=O8289
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8290
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=38
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8290
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=38
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8290
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=38
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8290
fatherSonIndex=3
frm_calc='LRTrim(column16)
len=1
name='cFlagLire
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Var
pag=38
prev=O8288
var_op='asgn
I
obj='Var
pag=38
prev=O8287
var_op='asgn
I
obj='Var
pag=38
prev=O8284
var_op='asgn
I
obj='If
pag=38
prev=O8283
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O8284
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=38
prev=O8430
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8431
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))+" con importo "+Str((Val(column19))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=38
prev=O8437
I
obj='Var
obj_type='N
pag=38
prev=O8436
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=38
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'column34
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=38
prev=O8282
var_op='asgn
I
obj='Remark
pag=38
prev=O8279
I
obj='If
pag=38
prev=O8277
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8279
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column29)+LRTrim(column31)+LRTrim(column30)))
]
h=[
19
19
]
obj='If
pag=38
prev=O8449
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8452
fatherSonIndex=0
frm_calc='LRTrim(column29)
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(column31)
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(column30)
len=2
name='_interprv
obj='Var
pag=38
prev=O8458
var_op='asgn
I
obj='Var
pag=38
prev=O8457
var_op='asgn
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O8448
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8449
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))+" con importo "+Str((Val(column19))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(column28)+" non è presente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=38
prev=O8464
I
obj='Var
obj_type='N
pag=38
prev=O8463
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=38
prev=O8447
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'column28
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=38
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8277
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(column27)),_codinter,column27)
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column29)),_citinter,column29)
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column31)),_cabinter,column31)
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column30)),_prvinter,column30)
len=2
name='_interprv
obj='Var
pag=38
prev=O8476
var_op='asgn
I
obj='Var
pag=38
prev=O8475
var_op='asgn
I
obj='Var
pag=38
prev=O8474
var_op='asgn
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8271
fatherSonIndex=1
frm_calc='1
len=1
name='_opeerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(ohand,riga)
obj='Exec
pag=38
prev=O8480
I
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=38
prev=O8267
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O8269
fatherSonIndex=0
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column21)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column22))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column33))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column50))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(column21)) and Empty(LRTrim(column12)) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=38
prev=O8495
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8498
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O8492
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8495
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=38
prev=O8508
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8509
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=38
prev=O8507
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column50)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O8489
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8492
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=38
prev=O8524
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8525
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=38
prev=O8523
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column33)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O8486
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8489
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=38
prev=O8540
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8541
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=38
prev=O8539
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column22)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O8485
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8486
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=38
prev=O8556
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8557
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=38
prev=O8555
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column21)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=38
prev=O8265
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O8267
fatherSonIndex=0
frm_calc='a01.getContents()
len=25
name='column01
next=Icpitembatch.CPVarDecl
frm_calc='a02.getContents()
len=25
name='column02
next=Icpitembatch.CPVarDecl
frm_calc='a03.getContents()
len=25
name='column03
next=Icpitembatch.CPVarDecl
frm_calc='a04.getContents()
len=25
name='column04
next=Icpitembatch.CPVarDecl
frm_calc='a05.getContents()
len=25
name='column05
next=Icpitembatch.CPVarDecl
frm_calc='a06.getContents()
len=25
name='column06
next=Icpitembatch.CPVarDecl
frm_calc='a07.getContents()
len=25
name='column07
next=Icpitembatch.CPVarDecl
frm_calc='a08.getContents()
len=25
name='column08
next=Icpitembatch.CPVarDecl
frm_calc='a09.getContents()
len=25
name='column09
next=Icpitembatch.CPVarDecl
frm_calc='a10.getContents()
len=25
name='column10
next=Icpitembatch.CPVarDecl
frm_calc='a11.getContents()
len=25
name='column11
next=Icpitembatch.CPVarDecl
frm_calc='a12.getContents()
len=25
name='column12
next=Icpitembatch.CPVarDecl
frm_calc='a13.getContents()
len=25
name='column13
next=Icpitembatch.CPVarDecl
frm_calc='a14.getContents()
len=25
name='column14
next=Icpitembatch.CPVarDecl
frm_calc='a15.getContents()
len=25
name='column15
next=Icpitembatch.CPVarDecl
frm_calc='a16.getContents()
len=25
name='column16
next=Icpitembatch.CPVarDecl
frm_calc='a17.getContents()
len=25
name='column17
next=Icpitembatch.CPVarDecl
frm_calc='a18.getContents()
len=25
name='column18
next=Icpitembatch.CPVarDecl
frm_calc='a19.getContents()
len=25
name='column19
next=Icpitembatch.CPVarDecl
frm_calc='a20.getContents()
len=25
name='column20
next=Icpitembatch.CPVarDecl
frm_calc='a21.getContents()
len=25
name='column21
next=Icpitembatch.CPVarDecl
frm_calc='a22.getContents()
len=25
name='column22
next=Icpitembatch.CPVarDecl
frm_calc='a23.getContents()
len=25
name='column23
next=Icpitembatch.CPVarDecl
frm_calc='a24.getContents()
len=25
name='column24
next=Icpitembatch.CPVarDecl
frm_calc='a25.getContents()
len=25
name='column25
next=Icpitembatch.CPVarDecl
frm_calc='a26.getContents()
len=25
name='column26
next=Icpitembatch.CPVarDecl
frm_calc='a27.getContents()
len=25
name='column27
next=Icpitembatch.CPVarDecl
frm_calc='a28.getContents()
len=25
name='column28
next=Icpitembatch.CPVarDecl
frm_calc='a29.getContents()
len=25
name='column29
next=Icpitembatch.CPVarDecl
frm_calc='a30.getContents()
len=25
name='column30
next=Icpitembatch.CPVarDecl
frm_calc='a31.getContents()
len=25
name='column31
next=Icpitembatch.CPVarDecl
frm_calc='a32.getContents()
len=25
name='column32
next=Icpitembatch.CPVarDecl
frm_calc='a33.getContents()
len=25
name='column33
next=Icpitembatch.CPVarDecl
frm_calc='a34.getContents()
len=25
name='column34
next=Icpitembatch.CPVarDecl
frm_calc='a35.getContents()
len=25
name='column35
next=Icpitembatch.CPVarDecl
frm_calc='a36.getContents()
len=25
name='column36
next=Icpitembatch.CPVarDecl
frm_calc='a37.getContents()
len=25
name='column37
next=Icpitembatch.CPVarDecl
frm_calc='a38.getContents()
len=25
name='column38
next=Icpitembatch.CPVarDecl
frm_calc='a39.getContents()
len=25
name='column39
next=Icpitembatch.CPVarDecl
frm_calc='a40.getContents()
len=25
name='column40
next=Icpitembatch.CPVarDecl
frm_calc='a41.getContents()
len=25
name='column41
next=Icpitembatch.CPVarDecl
frm_calc='a42.getContents()
len=25
name='column42
next=Icpitembatch.CPVarDecl
frm_calc='a43.getContents()
len=25
name='column43
next=Icpitembatch.CPVarDecl
frm_calc='a44.getContents()
len=25
name='column44
next=Icpitembatch.CPVarDecl
frm_calc='a45.getContents()
len=25
name='column45
next=Icpitembatch.CPVarDecl
frm_calc='a46.getContents()
len=25
name='column46
next=Icpitembatch.CPVarDecl
frm_calc='a47.getContents()
len=25
name='column47
next=Icpitembatch.CPVarDecl
frm_calc='a48.getContents()
len=25
name='column48
next=Icpitembatch.CPVarDecl
frm_calc='a49.getContents()
len=25
name='column49
next=Icpitembatch.CPVarDecl
frm_calc='a50.getContents()
len=25
name='column50
next=Icpitembatch.CPVarDecl
frm_calc='a51.getContents()
len=25
name='column51
next=Icpitembatch.CPVarDecl
frm_calc='a52.getContents()
len=25
name='column52
next=Icpitembatch.CPVarDecl
frm_calc='a53.getContents()
len=25
name='column53
next=Icpitembatch.CPVarDecl
frm_calc='a54.getContents()
len=25
name='column54
next=Icpitembatch.CPVarDecl
frm_calc='a55.getContents()
len=25
name='column55
next=Icpitembatch.CPVarDecl
frm_calc='a56.getContents()
len=25
name='column56
next=Icpitembatch.CPVarDecl
frm_calc='a57.getContents()
len=25
name='column57
next=Icpitembatch.CPVarDecl
frm_calc='a58.getContents()
len=25
name='column58
next=Icpitembatch.CPVarDecl
frm_calc='a59.getContents()
len=25
name='column59
next=Icpitembatch.CPVarDecl
frm_calc='a60.getContents()
len=25
name='column60
next=Icpitembatch.CPVarDecl
frm_calc='a61.getContents()
len=25
name='column61
next=Icpitembatch.CPVarDecl
frm_calc='a62.getContents()
len=25
name='column62
next=Icpitembatch.CPVarDecl
frm_calc='a63.getContents()
len=25
name='column63
next=Icpitembatch.CPVarDecl
frm_calc='a64.getContents()
len=25
name='column64
next=Icpitembatch.CPVarDecl
frm_calc='a65.getContents()
len=25
name='column65
next=Icpitembatch.CPVarDecl
frm_calc='a66.getContents()
len=25
name='column66
next=Icpitembatch.CPVarDecl
frm_calc='a67.getContents()
len=25
name='column67
obj='Var
pag=38
prev=O8637
var_op='asgn
I
obj='Var
pag=38
prev=O8636
var_op='asgn
I
obj='Var
pag=38
prev=O8635
var_op='asgn
I
obj='Var
pag=38
prev=O8634
var_op='asgn
I
obj='Var
pag=38
prev=O8633
var_op='asgn
I
obj='Var
pag=38
prev=O8632
var_op='asgn
I
obj='Var
pag=38
prev=O8631
var_op='asgn
I
obj='Var
pag=38
prev=O8630
var_op='asgn
I
obj='Var
pag=38
prev=O8629
var_op='asgn
I
obj='Var
pag=38
prev=O8628
var_op='asgn
I
obj='Var
pag=38
prev=O8627
var_op='asgn
I
obj='Var
pag=38
prev=O8626
var_op='asgn
I
obj='Var
pag=38
prev=O8625
var_op='asgn
I
obj='Var
pag=38
prev=O8624
var_op='asgn
I
obj='Var
pag=38
prev=O8623
var_op='asgn
I
obj='Var
pag=38
prev=O8622
var_op='asgn
I
obj='Var
pag=38
prev=O8621
var_op='asgn
I
obj='Var
pag=38
prev=O8620
var_op='asgn
I
obj='Var
pag=38
prev=O8619
var_op='asgn
I
obj='Var
pag=38
prev=O8618
var_op='asgn
I
obj='Var
pag=38
prev=O8617
var_op='asgn
I
obj='Var
pag=38
prev=O8616
var_op='asgn
I
obj='Var
pag=38
prev=O8615
var_op='asgn
I
obj='Var
pag=38
prev=O8614
var_op='asgn
I
obj='Var
pag=38
prev=O8613
var_op='asgn
I
obj='Var
pag=38
prev=O8612
var_op='asgn
I
obj='Var
pag=38
prev=O8611
var_op='asgn
I
obj='Var
pag=38
prev=O8610
var_op='asgn
I
obj='Var
pag=38
prev=O8609
var_op='asgn
I
obj='Var
pag=38
prev=O8608
var_op='asgn
I
obj='Var
pag=38
prev=O8607
var_op='asgn
I
obj='Var
pag=38
prev=O8606
var_op='asgn
I
obj='Var
pag=38
prev=O8605
var_op='asgn
I
obj='Var
pag=38
prev=O8604
var_op='asgn
I
obj='Var
pag=38
prev=O8603
var_op='asgn
I
obj='Var
pag=38
prev=O8602
var_op='asgn
I
obj='Var
pag=38
prev=O8601
var_op='asgn
I
obj='Var
pag=38
prev=O8600
var_op='asgn
I
obj='Var
pag=38
prev=O8599
var_op='asgn
I
obj='Var
pag=38
prev=O8598
var_op='asgn
I
obj='Var
pag=38
prev=O8597
var_op='asgn
I
obj='Var
pag=38
prev=O8596
var_op='asgn
I
obj='Var
pag=38
prev=O8595
var_op='asgn
I
obj='Var
pag=38
prev=O8594
var_op='asgn
I
obj='Var
pag=38
prev=O8593
var_op='asgn
I
obj='Var
pag=38
prev=O8592
var_op='asgn
I
obj='Var
pag=38
prev=O8591
var_op='asgn
I
obj='Var
pag=38
prev=O8590
var_op='asgn
I
obj='Var
pag=38
prev=O8589
var_op='asgn
I
obj='Var
pag=38
prev=O8588
var_op='asgn
I
obj='Var
pag=38
prev=O8587
var_op='asgn
I
obj='Var
pag=38
prev=O8586
var_op='asgn
I
obj='Var
pag=38
prev=O8585
var_op='asgn
I
obj='Var
pag=38
prev=O8584
var_op='asgn
I
obj='Var
pag=38
prev=O8583
var_op='asgn
I
obj='Var
pag=38
prev=O8582
var_op='asgn
I
obj='Var
pag=38
prev=O8581
var_op='asgn
I
obj='Var
pag=38
prev=O8580
var_op='asgn
I
obj='Var
pag=38
prev=O8579
var_op='asgn
I
obj='Var
pag=38
prev=O8578
var_op='asgn
I
obj='Var
pag=38
prev=O8577
var_op='asgn
I
obj='Var
pag=38
prev=O8576
var_op='asgn
I
obj='Var
pag=38
prev=O8575
var_op='asgn
I
obj='Var
pag=38
prev=O8574
var_op='asgn
I
obj='Var
pag=38
prev=O8573
var_op='asgn
I
obj='Var
pag=38
prev=O8572
var_op='asgn
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=38
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPExec
check='man
father=O8265
fatherSonIndex=0
frm_calc='// Legge il contenuto delle celle﷯Cell a01 = sheet.getCell(0,_y);﷯Cell a02 = sheet.getCell(1,_y);﷯Cell a03 = sheet.getCell(2,_y);﷯Cell a04 = sheet.getCell(3,_y);﷯Cell a05 = sheet.getCell(4,_y);﷯Cell a06 = sheet.getCell(5,_y);﷯Cell a07 = sheet.getCell(6,_y);﷯Cell a08 = sheet.getCell(7,_y);﷯Cell a09 = sheet.getCell(8,_y);﷯Cell a10 = sheet.getCell(9,_y);﷯Cell a11 = sheet.getCell(10,_y);﷯Cell a12 = sheet.getCell(11,_y);﷯Cell a13 = sheet.getCell(12,_y);﷯Cell a14 = sheet.getCell(13,_y);﷯Cell a15 = sheet.getCell(14,_y);﷯Cell a16 = sheet.getCell(15,_y);﷯Cell a17 = sheet.getCell(16,_y);﷯Cell a18 = sheet.getCell(17,_y);﷯Cell a19 = sheet.getCell(18,_y);﷯Cell a20 = sheet.getCell(19,_y);﷯Cell a21 = sheet.getCell(20,_y);﷯Cell a22 = sheet.getCell(21,_y);﷯Cell a23 = sheet.getCell(22,_y);﷯Cell a24 = sheet.getCell(23,_y);﷯Cell a25 = sheet.getCell(24,_y);﷯Cell a26 = sheet.getCell(25,_y);﷯Cell a27 = sheet.getCell(26,_y);﷯Cell a28 = sheet.getCell(27,_y);﷯Cell a29 = sheet.getCell(28,_y);﷯Cell a30 = sheet.getCell(29,_y);﷯Cell a31 = sheet.getCell(30,_y);﷯Cell a32 = sheet.getCell(31,_y);﷯Cell a33 = sheet.getCell(32,_y);﷯Cell a34 = sheet.getCell(33,_y);﷯Cell a35 = sheet.getCell(34,_y);﷯Cell a36 = sheet.getCell(35,_y);﷯Cell a37 = sheet.getCell(36,_y);﷯Cell a38 = sheet.getCell(37,_y);﷯Cell a39 = sheet.getCell(38,_y);﷯Cell a40 = sheet.getCell(39,_y);﷯Cell a41 = sheet.getCell(40,_y);﷯Cell a42 = sheet.getCell(41,_y);﷯Cell a43 = sheet.getCell(42,_y);﷯Cell a44 = sheet.getCell(43,_y);﷯Cell a45 = sheet.getCell(44,_y);﷯Cell a46 = sheet.getCell(45,_y);﷯Cell a47 = sheet.getCell(46,_y);﷯Cell a48 = sheet.getCell(47,_y);﷯Cell a49 = sheet.getCell(48,_y);﷯Cell a50 = sheet.getCell(49,_y);﷯Cell a51 = sheet.getCell(50,_y);﷯Cell a52 = sheet.getCell(51,_y);﷯Cell a53 = sheet.getCell(52,_y);﷯Cell a54 = sheet.getCell(53,_y);﷯Cell a55 = sheet.getCell(54,_y);﷯Cell a56 = sheet.getCell(55,_y);﷯Cell a57 = sheet.getCell(56,_y);﷯Cell a58 = sheet.getCell(57,_y);﷯Cell a59 = sheet.getCell(58,_y);﷯Cell a60 = sheet.getCell(59,_y);﷯Cell a61 = sheet.getCell(60,_y);﷯Cell a62 = sheet.getCell(61,_y);﷯Cell a63 = sheet.getCell(62,_y);﷯Cell a64 = sheet.getCell(63,_y);﷯Cell a65 = sheet.getCell(64,_y);﷯Cell a66 = sheet.getCell(65,_y);﷯Cell a67 = sheet.getCell(66,_y);
obj='Exec
pag=38
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=38
I
I
]
w=[
150
150
]
I
obj='Exec
pag=38
prev=O8247
I
obj='Begin
pag=38
prev=O8246
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O8247
fatherSonIndex=0
frm_calc='//base﷯Workbook workbook = Workbook.getWorkbook(new File(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(gAzienda)+"/"+CPLib.LRTrim(nomefileimport)));﷯_conta = workbook.getNumberOfSheets();
obj='Exec
pag=38
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=38
prev=O8245
var_op='asgn
I
obj='Var
obj_type='N
pag=38
prev=O8244
var_op='asgn
I
obj='Var
obj_type='N
pag=38
prev=O8243
var_op='asgn
I
obj='Remark
pag=38
x=14
y=20
I
Icpitembatch.CPRead
arch='tbcauana
obj='Read
pag=38
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'LRTrim(Substr(riga,10,4))
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
x=666
y=2343
I
Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + czipfile + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Inizio estrazione del file '+ czipfile
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathDoc)+"/appo/"+LRTrim(gAzienda)+"/"+czipfile
len=200
name='cpercorsozip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathDoc)+"/appo/"+LRTrim(gAzienda)+"/"
len=200
name='cdirectoryfile
next=Icpitembatch.CPExec
check='man
frm_calc='try {﷯      // Apro il file zip﷯      java.util.zip.ZipFile zf = new java.util.zip.ZipFile(cpercorsozip);﷯﷯      //Conto il numero di file all interno del file zip e creo un array di stringhe per memorizzare i nomi file﷯      conteggio=zf.size();﷯      lista=new String[conteggio];﷯      ﷯      // Enumerate each entry﷯      i=0;﷯      for (java.util.Enumeration entries = zf.entries(); entries.hasMoreElements();) {﷯          // Get the entry name﷯          lista[i] = ((java.util.zip.ZipEntry)entries.nextElement()).getName();﷯          i++;﷯      }﷯     zf.close();﷯     } catch (java.io.IOException e) {﷯     }﷯try {﷯      // Apro il file zip﷯      java.util.zip.ZipFile zf = new java.util.zip.ZipFile(cpercorsozip);﷯﷯      byte[] buffer = new byte[1024]; ﷯      java.util.Enumeration entries = zf.entries();﷯      while(entries.hasMoreElements() ) {﷯        java.util.zip.ZipEntry entry = (java.util.zip.ZipEntry)entries.nextElement();﷯        java.io.InputStream in =zf.getInputStream(entry);﷯        java.io.OutputStream out = new java.io.BufferedOutputStream(new java.io.FileOutputStream(cdirectoryfile+entry.getName()));﷯﷯        int len;﷯﷯        while((len = in.read(buffer)) >= 0){﷯          out.write(buffer, 0, len);﷯        }﷯﷯          in.close();﷯          out.close();﷯      }﷯﷯      zf.close();﷯} catch (java.io.IOException ioe) {﷯      System.err.println("Unhandled exception:");﷯      ioe.printStackTrace();﷯      return;﷯}
next=Icpitembatch.CPDelete
arch='tmp_list_imprich
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='contanome
next=Icpitembatch.CPVarDecl
frm_calc='0
len=3
name='_priorita
next=Icpitembatch.CPWhile
frm_calc='contanome<conteggio
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+"/appo/"+LRTrim(gAzienda)+"/"+czipfile)
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine estrazione del file '+ czipfile
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +czipfile + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=39
prev=O8666
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=39
prev=O8665
var_op='asgn
I
obj='Exec
pag=39
prev=O8663
I
obj='While
pag=39
prev=O8662
sons=[
Icpitembatch.CPItemSon
comment='Assegnal apriorità ad ogni file e lo inserisce in tmp_list
instr=Icpitembatch.CPExec
check='man
father=O8663
fatherSonIndex=0
frm_calc='buffernomefile=lista[contanome];
next=Icpitembatch.CPMerge
arch='tmp_list_imprich
next=Icpitembatch.CPVarDecl
frm_calc='contanome+1
len=10
name='contanome
obj='Var
obj_type='N
pag=39
prev=O8671
var_op='asgn
I
obj='Merge
pag=39
prev=O8670
rd_kfield=[
'nomefile
]
rd_kop=[
'=
]
rd_kvar=[
'buffernomefile
]
wr_field=[
'nomefile
]
wr_mode=[
'ins/upd
]
wr_op=[
'=
]
wr_var=[
'buffernomefile
]
I
obj='Exec
pag=39
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=39
prev=O8661
var_op='asgn
I
obj='Var
obj_type='N
pag=39
prev=O8660
var_op='asgn
I
obj='Delete
pag=39
prev=O8659
rd_kfield=[
'nomefile
]
rd_kop=[
'=
]
rd_kvar=[
'czipfile
]
I
obj='Exec
pag=39
prev=O8658
I
obj='Var
pag=39
prev=O8657
var_op='asgn
I
obj='Var
pag=39
prev=O8656
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=39
prev=O8655
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=39
var_op='asgn
x=11
y=18
I
Icpitembatch.CPInsert
arch='tmp_list_imprich
obj='Insert
pag=39
rd_kfield=[
'nomefile
]
rd_kvar=[
'buffernomefile
]
x=832
y=1027
I
Icpitembatch.CPIfElse
frm_calc=[
'_flgmodi='S'
]
h=[
19
19
]
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O8687
fatherSonIndex=0
frm_calc=[
'LRTrim(xRiga3) <> LRTrim(xRiga4)
]
h=[
19
19
]
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8692
fatherSonIndex=0
frm_calc='xCFE
len=1
name='_newest
next=Icpitembatch.CPExec
check='page
frm_calc='31
obj='Exec
pag=30
prev=O8697
I
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
x=1632
y=3892
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Titolari AGE Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Titolari AGE Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=40
prev=O8712
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=40
prev=O8711
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=40
prev=O8710
var_op='asgn
I
obj='Exec
pag=40
prev=O8709
I
obj='Exec
pag=40
prev=O8708
I
obj='Exec
pag=40
prev=O8706
I
obj='While
pag=40
prev=O8705
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8706
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=40
prev=O8716
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O8717
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,159,10)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=40
prev=O8725
sons=[
Icpitembatch.CPItemSon
comment='Unicode Assente o vuoto
instr=Icpitembatch.CPVarDecl
father=O8728
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,36,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGJTIT1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGJTIT2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTIT\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='japotit
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='jntestit
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=40
prev=O8741
var_op='asgn
I
obj='Insert
pag=40
prev=O8740
rd_kfield=[
'CODCLI
'CODINTER
'DATAINI
'NUMPROG1
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
]
rd_kvar=[
'Substr(riga,75,16)
'Substr(riga,50,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg1
'Substr(riga,219,30)
'Substr(riga,9,25)
'nProgImp
'LibreriaMit.UniqueId()
]
I
obj='Var
obj_type='N
pag=40
prev=O8738
var_op='asgn
I
obj='Insert
pag=40
prev=O8737
rd_kfield=[
'CDATOPE
'CDATREG
'CODCAB
'CODDIPE
'CODINTER
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPTIT
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'IDBASE2
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'_intercab
'Substr(riga,115,6)
'_intercod
'Substr(riga,75,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'cInfProg1
'"T"+Right(cInfProg2,9)+_idb2
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,159,10)
'_idb2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8738
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,75,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file AGETIT.TXT
obj='Transaction
pag=40
prev=O8749
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=40
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=40
prev=O8736
var_op='asgn
I
obj='Var
pag=40
prev=O8735
var_op='asgn
I
obj='Var
pag=40
prev=O8734
var_op='asgn
I
obj='Var
obj_type='D
pag=40
prev=O8733
var_op='asgn
I
obj='Var
pag=40
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='Aggiornamento
instr=Icpitembatch.CPWrite
arch='japotit
father=O8728
fatherSonIndex=1
obj='Write
pag=40
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_unicode
]
wr_field=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'OPRAP
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'CONNESCLI
'DATARETT
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'_intercab
'Substr(riga,115,6)
'_intercod
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'CharToDate(Right(Substr(riga,36,8),4)+Substr(Substr(riga,36,8),3,2)+Left(Substr(riga,36,8),2))
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'Left(Substr(riga,44,2),1)
'_interprv
'Substr(riga,9,25)
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,75,16)
'Date()
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=40
prev=O8724
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8725
fatherSonIndex=0
frm_calc='''
len=1
name='_tdest
next=Icpitembatch.CPRead
arch='japotit
obj='Read
pag=40
prev=O8763
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,159,10)
]
rd_var=[
'_unicode
]
I
obj='Var
pag=40
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=40
prev=O8722
var_op='asgn
I
obj='Begin
pag=40
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8722
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,104,11))),_codinter,Substr(riga,104,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,121,30))),_citinter,Substr(riga,121,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,153,6))),_cabinter,Substr(riga,153,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,151,2))),_prvinter,Substr(riga,151,2))
len=2
name='_interprv
obj='Var
pag=40
prev=O8774
var_op='asgn
I
obj='Var
pag=40
prev=O8773
var_op='asgn
I
obj='Var
pag=40
prev=O8772
var_op='asgn
I
obj='Var
pag=40
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=40
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=40
prev=O8704
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=40
prev=O8703
var_op='asgn
I
obj='Var
obj_type='N
pag=40
prev=O8702
var_op='asgn
I
obj='Var
obj_type='N
pag=40
prev=O8701
var_op='asgn
I
obj='Remark
pag=40
x=14
y=18
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Titolari Effettivi AGE Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Titolari Effettivi AGE Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=41
prev=O8790
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=41
prev=O8789
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=41
prev=O8788
var_op='asgn
I
obj='Exec
pag=41
prev=O8787
I
obj='Exec
pag=41
prev=O8786
I
obj='Exec
pag=41
prev=O8784
I
obj='While
pag=41
prev=O8783
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8784
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
obj='Var
pag=41
prev=O8796
var_op='asgn
I
obj='If
pag=41
prev=O8795
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O8796
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=41
prev=O8802
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='jntestit
father=O8804
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=41
prev=O8809
var_op='asgn
I
obj='Write
pag=41
rd_kfield=[
'CODCLI
'CODINTER
'RAPPORTO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'Left(riga,25)
]
wr_field=[
'DESCINTER
'DATAINI
]
wr_op=[
'=
'=
]
wr_var=[
'Substr(riga,66,30)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8804
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='jntestit
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=41
prev=O8819
var_op='asgn
I
obj='Insert
pag=41
prev=O8818
rd_kfield=[
'CODCLI
'CODINTER
'DATAINI
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'Substr(riga,66,30)
'Left(riga,25)
'nProgImp
'LibreriaMit.UniqueId()
]
I
obj='Var
obj_type='N
pag=41
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=41
sel_field='jntestit->IDBASE
sel_name='jntestit
sel_where='jntestit->CODCLI=Substr(riga,26,16) and jntestit->CODINTER=Substr(riga,42,16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8802
fatherSonIndex=0
frm_calc='1
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=41
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=41
prev=O8794
var_op='asgn
I
obj='Var
obj_type='M
pag=41
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=41
prev=O8782
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=41
prev=O8781
var_op='asgn
I
obj='Var
obj_type='N
pag=41
prev=O8780
var_op='asgn
I
obj='Var
obj_type='N
pag=41
prev=O8779
var_op='asgn
I
obj='Remark
pag=41
x=16
y=18
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Saldi SV Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Saldi SV Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=42
prev=O8841
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=42
prev=O8840
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=42
prev=O8839
var_op='asgn
I
obj='Exec
pag=42
prev=O8838
I
obj='Exec
pag=42
prev=O8837
I
obj='Exec
pag=42
prev=O8835
I
obj='While
pag=42
prev=O8834
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8835
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
obj='Var
pag=42
prev=O8847
var_op='asgn
I
obj='If
pag=42
prev=O8846
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='saldi_idp
father=O8847
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'm_nUpdatedRows=0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=42
prev=O8853
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='saldi_idp
father=O8854
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=42
prev=O8859
var_op='asgn
I
obj='Insert
pag=42
rd_kfield=[
'RAPPORTO
'ANNO
'TRIMESTRE
'IMPORTO
'IDBASE
]
rd_kvar=[
'LRTrim(Left(riga,25))
'LRTrim(Substr(riga,26,4))
'LRTrim(Substr(riga,30,1))
'Val(LRTrim(Substr(riga,31,15)))/100
'LibreriaMit.UniqueId()
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8854
fatherSonIndex=1
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=42
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Write
pag=42
rd_kfield=[
'RAPPORTO
'ANNO
'TRIMESTRE
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'LRTrim(Left(riga,25))
'LRTrim(Substr(riga,26,4))
'LRTrim(Substr(riga,30,1))
]
wr_field=[
'IMPORTO
]
wr_op=[
'=
]
wr_var=[
'Val(LRTrim(Substr(riga,31,15)))/100
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=42
prev=O8845
var_op='asgn
I
obj='Var
obj_type='M
pag=42
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=42
prev=O8833
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=42
prev=O8832
var_op='asgn
I
obj='Var
obj_type='N
pag=42
prev=O8831
var_op='asgn
I
obj='Var
obj_type='N
pag=42
prev=O8830
var_op='asgn
I
obj='Remark
pag=42
x=15
y=25
I
Icpitembatch.CPBeginEnd
comment='Scrive Importo
h=[
19
19
]
obj='Begin
pag=31
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8874
fatherSonIndex=0
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPIfElse
frm_calc=[
'At('archope.txt',Lower(nomefileimport)) <> 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=31
prev=O8878
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O8879
fatherSonIndex=0
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni modificate: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','OPERAZBO','Operazioni modificate: '+LRTrim(Str(cNumNew,10,0)))
obj='Exec
pag=31
prev=O8894
I
nonlocal=True
obj='Var
obj_type='M
pag=31
prev=O8893
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=31
prev=O8892
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=31
prev=O8891
var_op='asgn
I
obj='Exec
pag=31
prev=O8890
I
obj='Exec
pag=31
prev=O8888
I
obj='While
pag=31
prev=O8887
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8888
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=31
prev=O8898
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O8899
fatherSonIndex=0
frm_calc=[
'Len(LRTrim(Substr(riga,331,9))) > 0
]
h=[
19
19
]
obj='If
pag=31
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8904
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,871,19))),0,Val(LRTrim(Substr(riga,871,19))))
len=15
name='_totout
next=Icpitembatch.CPIfElse
frm_calc=[
'Upper(Substr(riga,331,9))='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=31
prev=O8910
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O8911
fatherSonIndex=0
obj='Write
pag=31
rd_kfield=[
'RIFIMP
'INFORM
]
rd_kop=[
'=
'=
]
rd_kvar=[
''XXXXXXXXX'
'Substr(riga,424,30)
]
wr_field=[
'IMPOUT
]
wr_op=[
'=
]
wr_var=[
'_totout/100
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O8911
fatherSonIndex=1
obj='Write
pag=31
rd_kfield=[
'RIFIMP
]
rd_kop=[
'=
]
rd_kvar=[
'Substr(riga,331,9)
]
wr_field=[
'IMPOUT
]
wr_op=[
'=
]
wr_var=[
'_totout/100
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=31
prev=O8909
var_op='asgn
I
obj='Var
obj_type='N
pag=31
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=31
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=31
prev=O8886
var_op='asgn
I
obj='Var
pag=31
prev=O8885
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=31
prev=O8884
var_op='asgn
I
obj='Remark
pag=31
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O8879
fatherSonIndex=1
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Frazionate modificate: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','FRAZIOBO','Frazionate modificate: '+LRTrim(Str(cNumNew,10,0)))
obj='Exec
pag=31
prev=O8947
I
nonlocal=True
obj='Var
obj_type='M
pag=31
prev=O8946
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=31
prev=O8945
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=31
prev=O8944
var_op='asgn
I
obj='Exec
pag=31
prev=O8943
I
obj='Exec
pag=31
prev=O8942
I
obj='Exec
pag=31
prev=O8940
I
obj='While
pag=31
prev=O8939
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8940
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=31
prev=O8951
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O8952
fatherSonIndex=0
frm_calc=[
'Len(LRTrim(Substr(riga,331,9))) > 0
]
h=[
19
19
]
obj='If
pag=31
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8957
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,871,19))),0,Val(LRTrim(Substr(riga,871,19))))
len=15
name='_totout
next=Icpitembatch.CPIfElse
frm_calc=[
'Upper(Substr(riga,331,9))='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=31
prev=O8963
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='fraziobo
father=O8964
fatherSonIndex=0
obj='Write
pag=31
rd_kfield=[
'RIFIMP
'INFORM
]
rd_kop=[
'=
'=
]
rd_kvar=[
''XXXXXXXXX'
'Substr(riga,424,30)
]
wr_field=[
'IMPOUT
]
wr_op=[
'=
]
wr_var=[
'_totout/100
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='fraziobo
father=O8964
fatherSonIndex=1
obj='Write
pag=31
rd_kfield=[
'RIFIMP
]
rd_kop=[
'=
]
rd_kvar=[
'Substr(riga,331,9)
]
wr_field=[
'IMPOUT
]
wr_op=[
'=
]
wr_var=[
'_totout/100
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=31
prev=O8962
var_op='asgn
I
obj='Var
obj_type='N
pag=31
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=31
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=31
prev=O8938
var_op='asgn
I
obj='Var
pag=31
prev=O8937
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=31
prev=O8936
var_op='asgn
I
obj='Remark
pag=31
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=31
var_op='asgn
I
I
]
w=[
150
150
]
x=20
y=17
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Rapporti Collegati Inseriti: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=43
prev=O9000
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=43
prev=O8999
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=43
prev=O8998
var_op='asgn
I
obj='Exec
pag=43
prev=O8997
I
obj='Exec
pag=43
prev=O8996
I
obj='Exec
pag=43
prev=O8994
I
obj='While
pag=43
prev=O8993
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8994
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPRead
arch='xperazbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=43
prev=O9009
var_op='asgn
I
obj='If
pag=43
prev=O9008
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O9009
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=43
prev=O9015
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='rapcoll
father=O9016
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=43
prev=O9021
var_op='asgn
I
obj='Insert
pag=43
rd_kfield=[
'IDFILEBO
'RAPPORTO
'IDBASE
]
rd_kvar=[
'_unicode
'Substr(riga,21,25)
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=43
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xapcoll
father=O9009
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=43
prev=O9031
var_op='asgn
I
obj='Insert
pag=43
rd_kfield=[
'IDFILEBO
'RAPPORTO
'IDBASE
]
rd_kvar=[
'_unicode
'Substr(riga,21,25)
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=43
prev=O9007
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
obj='Var
pag=43
prev=O9006
var_op='asgn
I
obj='Var
obj_type='N
pag=43
prev=O9005
var_op='asgn
I
obj='Var
obj_type='N
pag=43
prev=O9004
var_op='asgn
I
obj='Var
obj_type='M
pag=43
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=43
prev=O8992
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=43
prev=O8991
var_op='asgn
I
obj='Var
obj_type='N
pag=43
prev=O8990
var_op='asgn
I
obj='Remark
pag=43
x=8
y=21
I
Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,48,1)='F'
'Substr(riga,48,1)='O'
]
h=[
19
19
19
]
obj='If
pag=43
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O9041
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=43
prev=O9046
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O9047
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=43
prev=O9052
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientifrz
father=O9053
fatherSonIndex=0
obj='Insert
pag=43
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'PROQUOTA
'IMPSARA
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Val(Substr(riga,75,3))
'Val(Substr(riga,78,19))/100
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=43
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientifrz
father=O9047
fatherSonIndex=1
obj='Insert
pag=43
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'PROQUOTA
'IMPSARA
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Val(Substr(riga,75,3))
'Val(Substr(riga,78,19))/100
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=43
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
I
]
w=[
150
150
150
]
x=1301
y=258
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumInv
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='nProgSto
next=Icpitembatch.CPVarDecl
frm_calc='0
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPBeginEnd
comment='Gestione storico import
h=[
19
19
]
next=Ispitembatch.CPMemoryCursor
data_source='tbcitta
expected_rows=10000
key_expression='tbcitta->CITTA
mem_curs_name='mcTBCITTA
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPBeginEnd
comment='Apro il foglio e verifico quante pagine ha
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='_i = 0
next=Icpitembatch.CPWhile
frm_calc='_i < _conta
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='workbook.close()
next=Icpitembatch.CPIfElse
frm_calc=[
'nProgImp > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'nProgSto > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Soggetti Nuovi: '+LRTrim(Str(cNumNew,10,0)) + ' - Soggetti Modificati: '+LRTrim(Str(cNumMod,10,0)) + ' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=44
prev=O9104
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=44
prev=O9103
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=44
prev=O9100
var_op='asgn
I
obj='If
pag=44
prev=O9097
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O9100
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'm_nUpdatedRows=0
]
h=[
19
19
]
obj='If
pag=44
prev=O9108
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O9109
fatherSonIndex=0
obj='Insert
pag=44
rd_kfield=[
'tablecode
'warncode
'autonum
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
'nProgSto + 1
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=44
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'nProgSto + 1
]
I
I
]
w=[
150
150
]
I
obj='If
pag=44
prev=O9096
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O9097
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'm_nUpdatedRows=0
]
h=[
19
19
]
obj='If
pag=44
prev=O9127
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O9128
fatherSonIndex=0
obj='Insert
pag=44
rd_kfield=[
'tablecode
'warncode
'autonum
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
'nProgImp + 1
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=44
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'nProgImp + 1
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=44
prev=O9094
I
obj='While
pag=44
prev=O9093
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O9094
fatherSonIndex=0
frm_calc='_righe = 0;﷯Sheet sheet = workbook.getSheet(_i);﷯_righe = sheet.getRows();﷯_y = 1;
next=Icpitembatch.CPWhile
frm_calc='_y < _righe
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=44
prev=O9147
I
obj='While
pag=44
prev=O9146
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Legge le colonne e scrive i dati nelle variabili appoggio
father=O9147
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Crea Riga
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_y++;
obj='Exec
pag=44
prev=O9158
I
obj='If
pag=44
prev=O9156
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9158
fatherSonIndex=0
frm_seek='Zap
name='mcPersonbo
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,504,8)),NullDate(),CharToDate(Substr(riga,508,4)+Substr(riga,506,2)+Substr(riga,504,2)))
len=8
name='_datvarage
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgRet='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' nominativi del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='CODFISC
frm_calc='LRTrim(Substr(riga,112,16))
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
comment='CONNES
frm_calc='LRTrim(Substr(riga,488,16))
len=16
name='_conadd
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(_conadd)),cCli1,_conadd)
len=16
name='cCli1
next=Icpitembatch.CPRemark
frm_calc='Prima la Read si faceva per CF
next=Icpitembatch.CPBeginEnd
comment='Azzera vecchi valori
h=[
19
19
]
next=Ispitembatch.CPMemoryCursor
data_source='personbo
mem_curs_name='mcPersonbo
next=Icpitembatch.CPForEach
for_variable='rwPersonbo
for_variable_type='personbo
h=[
19
19
]
iterator_expr='mcPersonbo
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_flgvali
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_flganag
next=Icpitembatch.CPRead
arch='personbo_agg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,288,1))),'G','P')
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,288,1)='M','1',iif(Substr(riga,288,1)='F','2',Substr(riga,288,1)))
len=1
name='xSesso
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,450,1)='0' or Substr(riga,450,1)='1' or Substr(riga,450,1) = ''
'Substr(riga,450,1)='N' or Substr(riga,450,1)='S'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgvali='S',0,xCFE)
len=1
name='xCFE
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgvali='S',Upper(_oldcf),Upper(LRTrim(Substr(riga,112,16))))
len=16
name='xCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,6)
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,260,2))
len=2
name='xPrv
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCodCab))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,136,30))
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'(Substr(xCF,12,1) = 'Z' or Substr(riga,448,2)='EE') and (Substr(riga,288,1)='M' or Substr(riga,288,1)='F')
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Assegna Valori in base a flag
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico se il soggetto in esame non è già presente l'inserisco
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xConnes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=44
prev=O9210
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O9211
fatherSonIndex=0
frm_calc='nProgImp + 1
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='personbo
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='personbo_agg
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=44
prev=O9219
var_op='asgn
I
obj='Insert
pag=44
prev=O9217
rd_kfield=[
'CONNES
'FLGPREGIUD
'FLGTRUST
'FLGRISCHIO
'FLGEQUIFIN
'FLGFALSADIC
'FLGRICINF
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
]
rd_kvar=[
'LRTrim(cCli1)
'iif(Empty(Substr(riga,597,1)),'N',Substr(riga,597,1))
'iif(Empty(Substr(riga,598,1)),'N',Substr(riga,598,1))
'iif(Empty(Substr(riga,599,1)),'N',Substr(riga,599,1))
'iif(Empty(Substr(riga,600,1)),'N',Substr(riga,600,1))
'iif(Empty(Substr(riga,601,1)),'N',Substr(riga,601,1))
'iif(Empty(Substr(riga,602,1)),'N',Substr(riga,602,1))
'Substr(riga,587,2)
'Substr(riga,589,2)
'Substr(riga,591,2)
'Substr(riga,593,2)
'Substr(riga,595,2)
'Substr(riga,587,2)+Substr(riga,589,2)+Substr(riga,591,2)+Substr(riga,593,2)+Substr(riga,595,2)
]
I
obj='Insert
pag=44
prev=O9216
rd_kfield=[
'ALLINEATO
'ALLINEATONOMECNOME
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'CONNES
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROGIMPORT
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'TIPOPERS
'DATAVARAGE
'FATCA
'TIN
'ODB
'TIPOORO
'CODORO
'NOTIT
'MITIG
'NOSARA
'RISGLOB
'DATAPROF
'DATAREVPROF
'IDENT
'NUMIMP
]
rd_kvar=[
'0
'0
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,470,5)),3))
'Substr(riga,460,10)
'Upper(Substr(riga,200,30))
'Substr(riga,265,9)
'xCFE
'xCodCab
'Upper(xCF)
'_oldcog
'Substr(riga,455,5)
'LRTrim(cCli1)
'_oldndt
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Upper(Substr(riga,230,30))
'Substr(riga,348,100)
'Upper(Substr(riga,77,35))
'_oldncm
'_oldnst
'_oldnom
'Upper(Substr(riga,177,15))
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'iif(Empty(Substr(riga,487,1)),'N',Substr(riga,487,1))
'Substr(riga,451,4)
'nProgImp
'xPrv
'_oldrgs
'_oldrgs
'Substr(riga,169,3)
'Val(Substr(riga,484,3))
'Val(Substr(riga,481,3))
'Val(Substr(riga,478,3))
'Val(Substr(riga,475,3))
'_oldnsx
'Substr(riga,172,3)
'Substr(riga,166,3)
'_oldnpv
'Substr(riga,175,2)
'_tipper
'_datvarage
'Substr(riga,512,3)
'Substr(riga,515,16)
'iif(Empty(Substr(riga,531,1)),0,Val(Substr(riga,531,1)))
'Substr(riga,547,1)
'Substr(riga,548,11)
'iif(Empty(LRTrim(Substr(riga,559,1))),0,Val(Substr(riga,559,1)))
'iif(Empty(LRTrim(Substr(riga,560,4))),0,Val(Substr(riga,560,4)))
'iif(Empty(LRTrim(Substr(riga,564,1))) or Substr(riga,564,1)='0' or Substr(riga,564,1)='N','N','S')
'Substr(riga,581,3)
'iif(not(Empty(Substr(riga,565,8))),CharToDate(Substr(riga,565,8)),NullDate())
'iif(not(Empty(Substr(riga,573,8))),CharToDate(Substr(riga,573,8)),NullDate())
'Substr(riga,584,3)
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9217
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+LRTrim(Substr(riga,7,70))+" con codice fiscale: "+LRTrim(Substr(riga,112,16))+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=44
prev=O9230
I
obj='Exec
pag=44
prev=O9229
I
obj='Var
obj_type='N
pag=44
prev=O9228
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=44
prev=O9227
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=44
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=44
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPVarDecl
father=O9211
fatherSonIndex=1
frm_calc='Upper(xCF)+Substr(riga,7,70)+Substr(riga,77,35)+Substr(riga,230,30)+Substr(riga,260,2)+LibreriaMit.SpacePad(LRTrim(Substr(riga,265,9)),5)+Substr(riga,262,3)+Substr(riga,166,3)+Substr(riga,169,3)+Substr(riga,172,3)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+LibreriaMit.SpacePad(Left(cCNAS,30),30)+Substr(riga,448,2)+LibreriaMit.SpacePad(Left(cSNAS,30),30)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+Substr(riga,175,2)+Substr(riga,177,15)+Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2)+Substr(riga,200,30)+Substr(riga,274,14)+xCodCab
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='Upper(xCF)+Substr(riga,7,70)+Substr(riga,230,30)+Substr(riga,260,2)
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='xRiga3+LibreriaMit.SpacePad(Left(cCNAS,30),30)+Substr(riga,448,2)+LibreriaMit.SpacePad(Left(cSNAS,30),30)
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='xRiga3+CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))+xSesso
len=10
name='xRiga3
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgaggfam='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.SpacePad(rowPersonbo.CODFISC,16)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.RAGSOC,70)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.DOMICILIO,35)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.DESCCIT,30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.PROVINCIA,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(LRTrim(rowPersonbo.CAP),5)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.PAESE,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.SOTGRUP,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.RAMOGRUP,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.SETTSINT,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(Left(rowPersonbo.NASCOMUN,30),30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.TIPINTER,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(Left(rowPersonbo.NASSTATO,30),30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + iif(DateToChar(rowPersonbo.DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(rowPersonbo.DATANASC),8),Space(8))
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(rowPersonbo.TIPODOC,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(rowPersonbo.NUMDOCUM,15)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + iif(DateToChar(rowPersonbo.DATARILASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(rowPersonbo.DATARILASC),8),Space(8))
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(rowPersonbo.AUTRILASC,30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(rowPersonbo.PARTIVA,14)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(rowPersonbo.CODCAB,6)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.SpacePad(rowPersonbo.CODFISC,16)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(rowPersonbo.RAGSOC,70)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(rowPersonbo.DESCCIT,30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(rowPersonbo.PROVINCIA,2)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(Left(rowPersonbo.NASCOMUN,30),30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(rowPersonbo.TIPINTER,2)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(Left(rowPersonbo.NASSTATO,30),30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + iif(DateToChar(rowPersonbo.DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(rowPersonbo.DATANASC),8),Space(8))
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(rowPersonbo.SESSO,1)
len=10
name='xRiga4
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgaggfam='S'
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Se le due stringhe sono diverse, ci sono delle modifiche da fare. Quindi storicizzo in wersonbo le modifche.
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(xRiga1) <> LRTrim(xRiga2)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgaggfam='S'
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico se il soggetto è una persona fisica
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,288,1)='M' or Substr(riga,288,1)='F'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=44
par_expr=[
'xConnes
]
par_name=[
'w_CONNES
]
prev=O9284
sel_name='qbe_aggfam_opextrbo_new
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O9287
fatherSonIndex=0
obj='Write
pag=44
rd_kfield=[
'ANNO
'COLLEG
]
rd_kop=[
'=
'=
]
rd_kvar=[
'qbe_aggfam_opextrbo_new->ANNO
'qbe_aggfam_opextrbo_new->COLLEG
]
wr_field=[
'CFESTERO
]
wr_op=[
'=
]
wr_var=[
'iif(_oldest=1,'S','N')
]
I
I
]
w=[
150
150
]
I
obj='If
pag=44
prev=O9283
sons=[
Icpitembatch.CPItemSon
comment='se persona fisica
instr=Icpitembatch.CPWrite
arch='personbo
father=O9284
fatherSonIndex=0
frm_calc='Errore in aggiornamento ARCHPERS
h=[
19
19
]
next=Icpitembatch.CPMerge
arch='personbo_agg
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=44
prev=O9305
var_op='asgn
I
obj='Merge
pag=44
prev=O9303
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(cCli1)
]
wr_field=[
'CONNES
'FLGPREGIUD
'FLGTRUST
'FLGRISCHIO
'FLGEQUIFIN
'FLGFALSADIC
'FLGRICINF
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
]
wr_mode=[
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(cCli1)
'iif(Empty(Substr(riga,597,1)),'N',Substr(riga,597,1))
'iif(Empty(Substr(riga,598,1)),'N',Substr(riga,598,1))
'iif(Empty(Substr(riga,599,1)),'N',Substr(riga,599,1))
'iif(Empty(Substr(riga,600,1)),'N',Substr(riga,600,1))
'iif(Empty(Substr(riga,601,1)),'N',Substr(riga,601,1))
'iif(Empty(Substr(riga,602,1)),'N',Substr(riga,602,1))
'Substr(riga,587,2)
'Substr(riga,589,2)
'Substr(riga,591,2)
'Substr(riga,593,2)
'Substr(riga,595,2)
'Substr(riga,587,2)+Substr(riga,589,2)+Substr(riga,591,2)+Substr(riga,593,2)+Substr(riga,595,2)
]
I
obj='Write
pag=44
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(xConnes)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9303
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
frm_calc='m_cLastMsgError = ""
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=44
prev=O9321
I
obj='Exec
pag=44
prev=O9320
I
obj='Var
obj_type='N
pag=44
prev=O9319
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=44
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'DATAVARAGE
'AREAGEO
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'FATCA
'TIN
'ODB
'TIPOORO
'CODORO
'NOTIT
'MITIG
'NOSARA
'RISGLOB
'DATAPROF
'DATAREVPROF
'IDENT
'IDNASCOMUN
'IDNASSTATO
'NUMIMP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,460,10)
'Upper(Substr(riga,200,30))
'Substr(riga,265,9)
'_oldest
'xCodCab
'xCF
'_oldcog
'Substr(riga,455,5)
'_oldndt
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Upper(Substr(riga,230,30))
'Substr(riga,348,100)
'Upper(Substr(riga,77,35))
'_oldncm
'_oldnst
'_oldnom
'Upper(Substr(riga,177,15))
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'Substr(riga,451,4)
'xPrv
'_oldrgs
'_oldrgs
'Substr(riga,169,3)
'_oldnsx
'Substr(riga,172,3)
'Substr(riga,166,3)
'_oldnpv
'Substr(riga,175,2)
'_datvarage
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,470,5)),3))
'Val(Substr(riga,484,3))
'Val(Substr(riga,481,3))
'Val(Substr(riga,478,3))
'Val(Substr(riga,475,3))
'Substr(riga,512,3)
'Substr(riga,515,16)
'iif(Empty(Substr(riga,531,1)),0,Val(Substr(riga,531,1)))
'Substr(riga,547,1)
'Substr(riga,548,11)
'iif(Empty(LRTrim(Substr(riga,559,1))),0,Val(Substr(riga,559,1)))
'iif(Empty(LRTrim(Substr(riga,560,4))),0,Val(Substr(riga,560,4)))
'iif(Empty(LRTrim(Substr(riga,564,1))) or Substr(riga,564,1)='0' or Substr(riga,564,1)='N','N','S')
'Substr(riga,581,3)
'iif(not(Empty(Substr(riga,565,8))),CharToDate(Substr(riga,565,8)),NullDate())
'iif(not(Empty(Substr(riga,573,8))),CharToDate(Substr(riga,573,8)),NullDate())
'Substr(riga,584,3)
'''
'''
'_numimp
]
I
I
Icpitembatch.CPItemSon
comment='se persona giuridica
instr=Icpitembatch.CPRemark
father=O9284
fatherSonIndex=1
frm_calc='Se non è persona fisica
next=Icpitembatch.CPWrite
arch='personbo
frm_calc='Errore in aggiornamento ARCHPERS
h=[
19
19
]
next=Icpitembatch.CPMerge
arch='personbo_agg
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=44
prev=O9331
var_op='asgn
I
obj='Merge
pag=44
prev=O9329
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(cCli1)
]
wr_field=[
'CONNES
'FLGPREGIUD
'FLGTRUST
'FLGRISCHIO
'FLGEQUIFIN
'FLGFALSADIC
'FLGRICINF
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
]
wr_mode=[
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(cCli1)
'iif(Empty(Substr(riga,597,1)),'N',Substr(riga,597,1))
'iif(Empty(Substr(riga,598,1)),'N',Substr(riga,598,1))
'iif(Empty(Substr(riga,599,1)),'N',Substr(riga,599,1))
'iif(Empty(Substr(riga,600,1)),'N',Substr(riga,600,1))
'iif(Empty(Substr(riga,601,1)),'N',Substr(riga,601,1))
'iif(Empty(Substr(riga,602,1)),'N',Substr(riga,602,1))
'Substr(riga,587,2)
'Substr(riga,589,2)
'Substr(riga,591,2)
'Substr(riga,593,2)
'Substr(riga,595,2)
'Substr(riga,587,2)+Substr(riga,589,2)+Substr(riga,591,2)+Substr(riga,593,2)+Substr(riga,595,2)
]
I
obj='Write
pag=44
prev=O9328
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(xConnes)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9329
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=44
prev=O9346
I
obj='Var
obj_type='N
pag=44
prev=O9345
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=44
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'DATAVARAGE
'AREAGEO
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'FATCA
'TIN
'ODB
'TIPOORO
'CODORO
'NOTIT
'MITIG
'NOSARA
'RISGLOB
'DATAPROF
'DATAREVPROF
'IDENT
'NUMIMP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,460,10)
'Upper(Substr(riga,200,30))
'Substr(riga,265,9)
'_oldest
'xCodCab
'xCF
'_oldcog
'Substr(riga,455,5)
'_oldndt
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Upper(Substr(riga,230,30))
'Substr(riga,348,100)
'Upper(Substr(riga,77,35))
'_oldncm
'_oldnst
'_oldnom
'Upper(Substr(riga,177,15))
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'Substr(riga,451,4)
'xPrv
'_oldrgs
'_oldrgs
'Substr(riga,169,3)
'_oldnsx
'Substr(riga,172,3)
'Substr(riga,166,3)
'_oldnpv
'Substr(riga,175,2)
'_datvarage
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,470,5)),3))
'Val(Substr(riga,484,3))
'Val(Substr(riga,481,3))
'Val(Substr(riga,478,3))
'Val(Substr(riga,475,3))
'Substr(riga,512,3)
'Substr(riga,515,16)
'iif(Empty(Substr(riga,531,1)),0,Val(Substr(riga,531,1)))
'Substr(riga,547,1)
'Substr(riga,548,11)
'iif(Empty(LRTrim(Substr(riga,559,1))),0,Val(Substr(riga,559,1)))
'iif(Empty(LRTrim(Substr(riga,560,4))),0,Val(Substr(riga,560,4)))
'iif(Empty(LRTrim(Substr(riga,564,1))) or Substr(riga,564,1)='0' or Substr(riga,564,1)='N','N','S')
'Substr(riga,581,3)
'iif(not(Empty(Substr(riga,565,8))),CharToDate(Substr(riga,565,8)),NullDate())
'iif(not(Empty(Substr(riga,573,8))),CharToDate(Substr(riga,573,8)),NullDate())
'Substr(riga,584,3)
'_numimp
]
I
obj='Remark
pag=44
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=44
prev=O9280
I
obj='If
pag=44
prev=O9277
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O9280
fatherSonIndex=0
frm_calc=[
'LRTrim(xRiga5) <> LRTrim(xRiga6) or w_flgforzaagg='S'
]
h=[
19
19
]
obj='If
pag=44
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='bat
father=O9355
fatherSonIndex=0
frm_calc='arrt_ae_agg_aetesta_sog(xConnes,_oldest)
obj='Exec
pag=44
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=44
prev=O9276
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O9277
fatherSonIndex=0
frm_calc='Verifico se c'è già una variazione
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
obj='If
pag=44
prev=O9368
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O9370
fatherSonIndex=0
frm_calc='Calcola il progressivo di registrazione
next=Icpitembatch.CPVarDecl
frm_calc='nProgSto + 1
len=10
name='nProgSto
next=Icpitembatch.CPVarDecl
frm_calc='Right('000000000000000'+LRTrim(Str(nProgSto,15,0)),15)
len=15
name='cProgSto
next=Icpitembatch.CPInsert
arch='wersonbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_creamo='S'
]
h=[
19
19
]
obj='If
pag=44
prev=O9378
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPNote
father=O9380
fatherSonIndex=0
frm_calc='>>Questa parte è da vedere (non dovrebbe stare qui)
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(xRiga3) <> LRTrim(xRiga4)
]
h=[
19
19
]
obj='If
pag=44
prev=O9385
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O9386
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=44
prev=O9391
sel_field='fraziobo->IDBASE
sel_name='fraziobo
sel_where='fraziobo->CONNESCLI=xConnes or fraziobo->CONNESOPER=xConnes or fraziobo->CONNESBEN=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9393
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(gAzienda)+"'",Space(10),10)
len=10
name='cNewProg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc=''JLMNOTUV?'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='fraziobo->IDBASE
len=10
name='_idbase
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=44
prev=O9399
sel_field='*
sel_name='fraziobo
sel_where='fraziobo->IDBASE=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9400
fatherSonIndex=0
frm_calc='iif(Empty(fraziobo->FLAGRAP2),Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(fraziobo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPInsert
arch='fraziobo
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(operazbo->DATAOPE)+"F"+LibreriaMit.UniqueId()+"X"
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=44
prev=O9406
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_idbase
]
wr_field=[
'OPERAZMOD
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
'=
]
wr_var=[
'fraziobo->IDEREG
''1'
'Date()
]
I
obj='Var
pag=44
prev=O9405
var_op='asgn
I
obj='Insert
pag=44
prev=O9404
rd_kfield=[
'ANNOOPE
'AREAGEO
'AUTOM
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESDOC
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'DUCOLLEG
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'IDFILE
'INFORM
'IPCOLLEG
'MODSVOL
'MTCN
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
]
rd_kvar=[
'fraziobo->ANNOOPE
'fraziobo->AREAGEO
'fraziobo->AUTOM
'fraziobo->C_CAB
'fraziobo->C_CAP
'fraziobo->C_CTA
'fraziobo->C_IND
'fraziobo->C_PRV
'fraziobo->C_RAG
'fraziobo->C_RAPPORTO
'fraziobo->C_STA
'fraziobo->CAMBIO
'fraziobo->CDATAOPE
'fraziobo->CDATOPE
'fraziobo->CDATREG
'fraziobo->CODANA
'fraziobo->CODCAB
'fraziobo->CODCAB2
'fraziobo->CODDIPE
'fraziobo->CODINT2
'fraziobo->CODINTER
'fraziobo->CODVOC
'fraziobo->COLLEG
'fraziobo->CONNALTRO
'fraziobo->CONNESBEN
'fraziobo->CONNESCLI
'fraziobo->CONNESDOC
'fraziobo->CONNESOPER
'fraziobo->DATAIMP
'fraziobo->DATAOPE
'fraziobo->DATAREG
'Date()
'fraziobo->DESC2
'fraziobo->DESCCIT
'fraziobo->DESCINTER
'fraziobo->DOCFILE
'fraziobo->DUCOLLEG
'fraziobo->FLAGCONT
'fraziobo->FLAGFRAZ
'fraziobo->FLAGLIRE
'fraziobo->FLAGRAP
'_flagrap2
'cNewProg
'fraziobo->idcauana
'fraziobo->IDEREG
'fraziobo->IDFILE
'fraziobo->INFORM
'fraziobo->IPCOLLEG
'fraziobo->MODSVOL
'fraziobo->MTCN
'fraziobo->NATURA
'fraziobo->NOPROT
'fraziobo->NUMPROG
'fraziobo->OPERAG
'fraziobo->OPERATORE
'fraziobo->OPERAZMOD
'fraziobo->OPRAP
'fraziobo->ORACOLLEG
'fraziobo->PAESE
'fraziobo->PAGASOGOP
'fraziobo->PRGIMPFRZ
'fraziobo->PROV2
'fraziobo->PROVINCIA
'fraziobo->RAGIO
'fraziobo->RAPPORTBEN
'fraziobo->RAPPORTO
'fraziobo->RAREA
'fraziobo->RCOMP
'fraziobo->RESPINS
'fraziobo->RFREQ
'fraziobo->RIFIMP
'fraziobo->RIMP
'fraziobo->RRAGIO
'fraziobo->RTIPO
'fraziobo->SCOPO
'fraziobo->SEGNO
''3'
'fraziobo->TIPO
'fraziobo->TIPOINF
'fraziobo->TIPOINT2
'fraziobo->TIPOINTER
'fraziobo->TIPOLEG
'fraziobo->TIPOOPRAP
'fraziobo->TOTCONT
'fraziobo->TOTLIRE
'fraziobo->UCODE
'fraziobo->UNIQUECODE
'fraziobo->VALUTA
'fraziobo->ZCPARTE
]
I
obj='Var
pag=44
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=44
prev=O9398
var_op='asgn
I
obj='Var
pag=44
prev=O9397
var_op='asgn
I
obj='Var
pag=44
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=44
sel_field='operazbo->IDBASE
sel_name='operazbo
sel_where='operazbo->CONNESCLI=xConnes or operazbo->CONNESOPER=xConnes or operazbo->CONNESBEN=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9391
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",Space(10),10)
len=10
name='cNewProg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='operazbo->IDBASE
len=10
name='_idbase
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=44
prev=O9422
sel_field='*
sel_name='operazbo
sel_where='operazbo->IDBASE=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9423
fatherSonIndex=0
frm_calc='iif(Empty(operazbo->FLAGRAP2),Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(operazbo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPInsert
arch='operazbo
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(operazbo->DATAOPE)+"O"+LibreriaMit.UniqueId()+"X"
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=44
prev=O9429
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_idbase
]
wr_field=[
'OPERAZMOD
'STATOREG
'DATARETT
'IDEREG
'NUMIMP
]
wr_op=[
'=
'=
'=
'=
'=
]
wr_var=[
'operazbo->IDEREG
''1'
'Date()
'_idreg
'_numimp
]
I
obj='Var
pag=44
prev=O9428
var_op='asgn
I
obj='Insert
pag=44
prev=O9427
rd_kfield=[
'AMMONT
'AREAGEO
'AUTOM
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESDOC
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'IDFILE
'INFORM
'IPCOLLEG
'MODSVOL
'MTCN
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
'ANNOOPE
]
rd_kvar=[
'operazbo->AMMONT
'operazbo->AREAGEO
'operazbo->AUTOM
'operazbo->C_CAB
'operazbo->C_CAP
'operazbo->C_CTA
'operazbo->C_IND
'operazbo->C_PRV
'operazbo->C_RAG
'operazbo->C_RAPPORTO
'operazbo->C_STA
'operazbo->CAMBIO
'operazbo->CDATAOPE
'operazbo->CDATOPE
'operazbo->CDATREG
'operazbo->CODANA
'operazbo->CODCAB
'operazbo->CODCAB2
'operazbo->CODDIPE
'operazbo->CODINT2
'operazbo->CODINTER
'operazbo->CODVOC
'operazbo->COLLEG
'operazbo->CONNALTRO
'operazbo->CONNESBEN
'operazbo->CONNESCLI
'operazbo->CONNESDOC
'operazbo->CONNESOPER
'operazbo->DATAIMP
'operazbo->DATAOPE
'operazbo->DATAREG
'Date()
'operazbo->DESC2
'operazbo->DESCCIT
'operazbo->DESCINTER
'operazbo->DOCFILE
'operazbo->DUCOLLEG
'operazbo->DURAT
'operazbo->FLAGCONT
'operazbo->FLAGFRAZ
'operazbo->FLAGLIRE
'operazbo->FLAGRAP
'_flagrap2
'cNewProg
'operazbo->idcauana
'operazbo->IDEREG
'operazbo->IDFILE
'operazbo->INFORM
'operazbo->IPCOLLEG
'operazbo->MODSVOL
'operazbo->MTCN
'operazbo->NATURA
'operazbo->NOPROT
'operazbo->NUMPROG
'operazbo->OPERAG
'operazbo->OPERATORE
'operazbo->OPERAZMOD
'operazbo->OPRAP
'operazbo->ORACOLLEG
'operazbo->PAESE
'operazbo->PAGASOGOP
'operazbo->PRGIMPOPE
'operazbo->PROV2
'operazbo->PROVINCIA
'operazbo->RAGIO
'operazbo->RAPPORTBEN
'operazbo->RAPPORTO
'operazbo->RAREA
'operazbo->RCOMP
'operazbo->RESPINS
'operazbo->RFREQ
'operazbo->RIFIMP
'operazbo->RIMP
'operazbo->RRAGIO
'operazbo->RTIPO
'operazbo->SCOPO
'operazbo->SEGNO
''3'
'operazbo->TIPO
'operazbo->TIPOINF
'operazbo->TIPOINT2
'operazbo->TIPOINTER
'operazbo->TIPOLEG
'operazbo->TIPOOPRAP
'operazbo->TOTCONT
'operazbo->TOTLIRE
'operazbo->UCODE
'operazbo->UNIQUECODE
'operazbo->VALUTA
'operazbo->ZCPARTE
'operazbo->ANNOOPE
]
I
obj='Var
pag=44
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=44
prev=O9421
var_op='asgn
I
obj='Var
pag=44
prev=O9420
var_op='asgn
I
obj='Var
pag=44
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Note
pag=44
I
I
]
w=[
150
150
]
I
obj='Insert
pag=44
prev=O9377
rd_kfield=[
'ALLINEATO
'ALLINEATONOMECNOME
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODDIPE
'CODFISC
'CODINTER
'COGNOME
'COMPORT
'CONNES
'datamodi
'DATANASC
'DATARILASC
'DATASEGN
'DATAVALI
'DATEXTRA
'DESCCIT
'DOCFILE
'DOMICILIO
'idcitta
'IDFILE
'MACROAGENTE
'NASCOMUN
'NASSTATO
'NOME
'NOTE
'NUMDOCUM
'OLDCODFISC
'OLDCONNES
'OLDSETSIN
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROGIMP_C
'PROGIMPORT
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'sanumpro
'SESSO
'SETTSINT
'SOSPMAF
'SOTGRUP
'SPOTID
'TIPINTER
'TIPODOC
'TIPOPERS
'SETTSINT2
'FATCA
'BANCABEN
'TIN
'ODB
'TELEF
'TIPOORO
'CODORO
'IDNASCOMUN
'IDNASSTATO
'NOTIT
'IDBASE
'FLGVALIDO
'CITTADIN1
'CITTADIN2
'RESFISC
'MITIG
'MITGDOC
'NOSARA
'RISGLOB
'DATAPROF
'DATAREVPROF
'IDENT
'PEPDATE
'DAC6
'FLAGDAC6
'CRIME
'CRIMEDATE
'ALTRODOM
'ALTROCAP
'NUMIMP
]
rd_kvar=[
'rowPersonbo.ALLINEATO
'rowPersonbo.ALLINEATONOMECNOME
'rowPersonbo.AREAGEO
'rowPersonbo.ATTIV
'rowPersonbo.AUTRILASC
'rowPersonbo.CAP
'rowPersonbo.CFESTERO
'rowPersonbo.CODCAB
'rowPersonbo.CODDIPE
'rowPersonbo.CODFISC
'rowPersonbo.CODINTER
'rowPersonbo.COGNOME
'rowPersonbo.COMPORT
'xConnes
'_datarett
'rowPersonbo.DATANASC
'rowPersonbo.DATARILASC
'rowPersonbo.DATASEGN
'rowPersonbo.DATAVALI
'rowPersonbo.DATEXTRA
'rowPersonbo.DESCCIT
'rowPersonbo.DOCFILE
'rowPersonbo.DOMICILIO
'rowPersonbo.idcitta
'rowPersonbo.IDFILE
'rowPersonbo.MACROAGENTE
'rowPersonbo.NASCOMUN
'rowPersonbo.NASSTATO
'rowPersonbo.NOME
'rowPersonbo.NOTE
'rowPersonbo.NUMDOCUM
'rowPersonbo.OLDCODFISC
'rowPersonbo.OLDCONNES
'rowPersonbo.OLDSETSIN
'rowPersonbo.PAESE
'rowPersonbo.PARTIVA
'rowPersonbo.PEP
'rowPersonbo.PKTBSPECIE
'rowPersonbo.PROGIMP_C
'rowPersonbo.PROGIMPORT
'rowPersonbo.PROVINCIA
'rowPersonbo.RAGSOC
'rowPersonbo.RAGSOCOLD
'rowPersonbo.RAMOGRUP
'rowPersonbo.RAREA
'rowPersonbo.RATTIV
'rowPersonbo.RCOMP
'rowPersonbo.RNATGIU
'cProgSto
'rowPersonbo.SESSO
'rowPersonbo.SETTSINT
'rowPersonbo.SOSPMAF
'rowPersonbo.SOTGRUP
'rowPersonbo.SPOTID
'rowPersonbo.TIPINTER
'rowPersonbo.TIPODOC
'rowPersonbo.TIPOPERS
'rowPersonbo.SETTSINT2
'rowPersonbo.FATCA
'rowPersonbo.BANCABEN
'rowPersonbo.TIN
'rowPersonbo.ODB
'rowPersonbo.TELEF
'rowPersonbo.TIPOORO
'rowPersonbo.CODORO
'rowPersonbo.IDNASCOMUN
'rowPersonbo.IDNASSTATO
'rowPersonbo.NOTIT
'rowPersonbo.IDBASE
'rowPersonbo.FLGVALIDO
'rowPersonbo.CITTADIN1
'rowPersonbo.CITTADIN2
'rowPersonbo.RESFISC
'rowPersonbo.MITIG
'rowPersonbo.MITIGDOC
'rowPersonbo.NOSARA
'rowPersonbo.RISGLOB
'rowPersonbo.DATAPROF
'rowPersonbo.DATAREVPROF
'rowPersonbo.IDENT
'rowPersonbo.PEPDATE
'rowPersonbo.DAC6
'rowPersonbo.FLAGDAC6
'rowPersonbo.CRIME
'rowPersonbo.CRIMEDATE
'rowPersonbo.ALTRODOM
'rowPersonbo.ALTROCAP
'_numimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9378
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
frm_calc='m_cLastMsgError = ""
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=44
prev=O9449
I
obj='Exec
pag=44
prev=O9448
I
obj='Var
obj_type='N
pag=44
prev=O9447
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=44
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=44
prev=O9376
var_op='asgn
I
obj='Var
obj_type='N
pag=44
prev=O9375
var_op='asgn
I
obj='Remark
pag=44
I
I
]
w=[
150
150
]
I
obj='Select
pag=44
prev=O9367
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=xConnes and wersonbo->datamodi=_datarett
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9368
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=44
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='D
pag=44
prev=O9366
var_op='asgn
I
obj='Var
pag=44
prev=O9365
var_op='asgn
I
obj='Remark
pag=44
I
I
]
w=[
150
150
]
I
obj='Remark
pag=44
prev=O9273
I
obj='If
pag=44
prev=O9272
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9273
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad(rowPersonbo.CODFISC,16)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(rowPersonbo.RAGSOC,70)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(rowPersonbo.DESCCIT,30)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(rowPersonbo.PAESE,3)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(rowPersonbo.PROVINCIA,2)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(rowPersonbo.COGNOME,26)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(rowPersonbo.NOME,25)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(rowPersonbo.SESSO,1)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + iif(DateToChar(rowPersonbo.DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(rowPersonbo.DATANASC),8),Space(8))
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(Left(rowPersonbo.NASCOMUN,30),30)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(rowPersonbo.TIPINTER,2)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(Left(rowPersonbo.NASSTATO,30),30)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='iif(rowPersonbo.CFESTERO=1,'1','0')
len=10
name='xRiga6
obj='Var
obj_type='M
pag=44
prev=O9471
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9470
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9469
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9468
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9467
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9466
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9465
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9464
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9463
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9462
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9461
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9460
var_op='asgn
I
obj='Var
obj_type='M
pag=44
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=44
prev=O9271
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9270
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9269
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9268
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9267
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9266
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9265
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9264
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9263
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9262
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9261
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9260
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9259
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9258
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9257
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9256
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9255
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9254
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9253
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9252
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9251
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9250
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9249
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9248
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9247
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9246
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9245
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9244
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9241
var_op='asgn
I
obj='If
pag=44
prev=O9240
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9241
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad(Upper(xCF),16)+Upper(Substr(riga,7,70))+iif(Substr(riga,262,3)='086',Upper(Substr(riga,230,30)),Space(30))+Substr(riga,262,3)+Substr(riga,260,2)
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+Upper(Substr(riga,297,26))+Upper(Substr(riga,323,25))+xSesso
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2)+LibreriaMit.SpacePad(Left(cCNAS,30),30)+Substr(riga,448,2)
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+LibreriaMit.SpacePad(Left(cSNAS,30),30)+xCFE
len=10
name='xRiga5
obj='Var
obj_type='M
pag=44
prev=O9478
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9477
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9476
var_op='asgn
I
obj='Var
obj_type='M
pag=44
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=44
prev=O9239
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9238
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9237
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9236
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9235
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9234
var_op='asgn
I
obj='Var
obj_type='M
pag=44
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=44
prev=O9208
I
obj='Begin
pag=44
prev=O9205
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9208
fatherSonIndex=0
frm_calc='iif(_flganag='S',_oldcog,Upper(Substr(riga,297,26)))
len=26
name='_oldcog
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnom,Upper(Substr(riga,323,25)))
len=26
name='_oldnom
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldrgs,Upper(Substr(riga,7,70)))
len=70
name='_oldrgs
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldncm,cCNAS)
len=30
name='_oldncm
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnst,cSNAS)
len=30
name='_oldnst
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldndt,CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2)))
len=8
name='_oldndt
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnpv,Upper(Substr(riga,448,2)))
len=2
name='_oldnpv
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnsx,xSesso)
len=1
name='_oldnsx
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgvali='S',_oldest,xCFE)
len=1
name='_oldest
obj='Var
obj_type='N
pag=44
prev=O9491
var_op='asgn
I
obj='Var
pag=44
prev=O9490
var_op='asgn
I
obj='Var
pag=44
prev=O9489
var_op='asgn
I
obj='Var
obj_type='D
pag=44
prev=O9488
var_op='asgn
I
obj='Var
pag=44
prev=O9487
var_op='asgn
I
obj='Var
pag=44
prev=O9486
var_op='asgn
I
obj='Var
pag=44
prev=O9485
var_op='asgn
I
obj='Var
pag=44
prev=O9484
var_op='asgn
I
obj='Var
pag=44
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=44
prev=O9204
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9205
fatherSonIndex=0
frm_calc='Upper(Substr(riga,136,30))
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=44
prev=O9496
var_op='asgn
I
obj='Var
pag=44
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=44
prev=O9203
var_op='asgn
I
obj='Var
pag=44
prev=O9200
var_op='asgn
I
obj='If
pag=44
prev=O9199
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9200
fatherSonIndex=0
frm_calc='Upper(Substr(riga,230,30))
len=30
name='xCitta
next=Icpitembatch.CPForEach
for_variable='rowTBCITTA
for_variable_type='tbcitta
h=[
19
19
]
iterator_expr='mcTBCITTA
obj='ForEach
pag=44
prev=O9501
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O9502
fatherSonIndex=0
frm_calc=[
'LRTrim(rowTBCITTA.CITTA)=LRTrim(xCitta)
]
h=[
19
19
]
obj='If
pag=44
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O9506
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(xPrv))) and rowTBCITTA.PROV=xPrv
'not(Empty(LRTrim(xPrv))) and rowTBCITTA.PROV=xPrv
]
h=[
19
19
19
19
]
haselse=True
obj='If
pag=44
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9511
fatherSonIndex=0
frm_calc='rowTBCITTA.CAB
len=6
name='xCodCab
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=44
prev=O9516
I
obj='Var
pag=44
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9511
fatherSonIndex=1
frm_calc='rowTBCITTA.CAB
len=6
name='xCodCab
obj='Var
pag=44
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9511
fatherSonIndex=2
frm_calc='rowTBCITTA.CAB
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
frm_calc='rowTBCITTA.PROV
len=2
name='xPrv
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=44
prev=O9522
I
obj='Var
pag=44
prev=O9521
var_op='asgn
I
obj='Var
pag=44
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=44
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=44
prev=O9198
var_op='asgn
I
obj='Var
pag=44
prev=O9197
var_op='asgn
I
obj='Var
pag=44
prev=O9196
var_op='asgn
I
obj='Var
obj_type='N
pag=44
prev=O9193
var_op='asgn
I
obj='If
pag=44
prev=O9192
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9193
fatherSonIndex=0
frm_calc='iif(LRTrim(Substr(riga,450,1))='1',1,0)
len=1
name='xCFE
obj='Var
obj_type='N
pag=44
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9193
fatherSonIndex=1
frm_calc='iif(LRTrim(Substr(riga,450,1))='S',1,0)
len=1
name='xCFE
obj='Var
obj_type='N
pag=44
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=44
prev=O9191
var_op='asgn
I
obj='Var
pag=44
prev=O9190
var_op='asgn
I
obj='Read
pag=44
prev=O9189
rd_field=[
'FLGVALIDO
'FLGANAVAL
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'cCli1
]
rd_var=[
'_flgvali
'_flganag
]
I
obj='Var
pag=44
prev=O9188
var_op='asgn
I
obj='Var
pag=44
prev=O9186
var_op='asgn
I
obj='ForEach
pag=44
prev=O9185
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9186
fatherSonIndex=0
frm_calc='rwPersonbo
frm_seek='Copy
name='rowPersonbo
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.CONNES
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.CFESTERO
len=1
name='_oldest
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.CODFISC
len=16
name='_oldcf
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.COGNOME
len=26
name='_oldcog
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.NOME
len=26
name='_oldnom
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.RAGSOC
len=70
name='_oldrgs
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.NASCOMUN
len=30
name='_oldncm
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.NASSTATO
len=30
name='_oldnst
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.DATANASC
len=8
name='_oldndt
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.TIPINTER
len=2
name='_oldnpv
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.SESSO
len=1
name='_oldnsx
obj='Var
pag=44
prev=O9550
var_op='asgn
I
obj='Var
pag=44
prev=O9549
var_op='asgn
I
obj='Var
obj_type='D
pag=44
prev=O9548
var_op='asgn
I
obj='Var
pag=44
prev=O9547
var_op='asgn
I
obj='Var
pag=44
prev=O9546
var_op='asgn
I
obj='Var
pag=44
prev=O9545
var_op='asgn
I
obj='Var
pag=44
prev=O9544
var_op='asgn
I
obj='Var
pag=44
prev=O9543
var_op='asgn
I
obj='Var
pag=44
prev=O9542
var_op='asgn
I
obj='Var
obj_type='N
pag=44
prev=O9541
var_op='asgn
I
obj='Var
pag=44
prev=O9540
var_op='asgn
I
obj='Var
obj_type='R
pag=44
var_op='meth
I
I
]
w=[
150
150
]
I
obj='MemoryCursor
pag=44
prev=O9183
sel_field='*
sel_name='personbo
sel_type='fltb
sel_where='personbo->CONNES=cCli1
I
obj='Begin
pag=44
prev=O9182
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9183
fatherSonIndex=0
frm_calc='0
len=1
name='_oldest
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_oldcf
next=Icpitembatch.CPVarDecl
frm_calc='''
len=26
name='_oldcog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=26
name='_oldnom
next=Icpitembatch.CPVarDecl
frm_calc='''
len=70
name='_oldrgs
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_oldncm
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_oldnst
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_oldndt
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_oldnpv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_oldnsx
obj='Var
pag=44
prev=O9563
var_op='asgn
I
obj='Var
pag=44
prev=O9562
var_op='asgn
I
obj='Var
obj_type='D
pag=44
prev=O9561
var_op='asgn
I
obj='Var
pag=44
prev=O9560
var_op='asgn
I
obj='Var
pag=44
prev=O9559
var_op='asgn
I
obj='Var
pag=44
prev=O9558
var_op='asgn
I
obj='Var
pag=44
prev=O9557
var_op='asgn
I
obj='Var
pag=44
prev=O9556
var_op='asgn
I
obj='Var
pag=44
prev=O9555
var_op='asgn
I
obj='Var
obj_type='N
pag=44
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=44
prev=O9181
I
obj='Var
pag=44
prev=O9180
var_op='asgn
I
obj='Var
pag=44
prev=O9179
var_op='asgn
I
obj='Var
pag=44
prev=O9178
var_op='asgn
I
obj='Var
pag=44
prev=O9177
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=44
prev=O9174
var_op='asgn
I
obj='If
pag=44
prev=O9173
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xersonbo
father=O9174
fatherSonIndex=0
obj='Insert
pag=44
rd_kfield=[
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'CONNES
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'IDPROG
]
rd_kvar=[
'Substr(riga,470,3)
'Substr(riga,460,10)
'Substr(riga,200,30)
'Substr(riga,265,9)
'Substr(riga,450,1)
'Left(riga,6)
'Substr(riga,112,16)
'Substr(riga,297,26)
'Substr(riga,455,5)
'Substr(riga,488,16)
'Substr(riga,128,8)
'Substr(riga,192,8)
'Substr(riga,289,8)
'Substr(riga,230,30)
'Substr(riga,348,100)
'Substr(riga,77,35)
'Substr(riga,136,30)
'Substr(riga,323,25)
'Substr(riga,177,15)
'Substr(riga,262,3)
'Substr(riga,274,14)
'Substr(riga,487,1)
'Substr(riga,451,4)
'Substr(riga,260,2)
'Substr(riga,7,70)
'Substr(riga,7,70)
'Substr(riga,169,3)
'Substr(riga,484,3)
'Substr(riga,481,3)
'Substr(riga,478,3)
'Substr(riga,475,3)
'Substr(riga,288,1)
'Substr(riga,172,3)
'Substr(riga,166,3)
'Substr(riga,448,2)
'Substr(riga,175,2)
'conta
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=44
prev=O9172
var_op='asgn
I
obj='Var
pag=44
prev=O9171
var_op='asgn
I
obj='Var
obj_type='D
pag=44
prev=O9170
var_op='asgn
I
obj='Var
obj_type='M
pag=44
pagelocal=True
prev=O9169
var_op='asgn
I
obj='Var
obj_type='M
pag=44
pagelocal=True
prev=O9168
var_op='asgn
I
obj='Var
obj_type='M
pag=44
pagelocal=True
prev=O9167
var_op='asgn
I
obj='Var
obj_type='M
pag=44
pagelocal=True
prev=O9166
var_op='asgn
I
obj='Var
obj_type='M
pag=44
pagelocal=True
prev=O9165
var_op='asgn
I
obj='Var
obj_type='M
pag=44
pagelocal=True
prev=O9164
var_op='asgn
I
obj='Var
obj_type='MC
pag=44
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Begin
pag=44
prev=O9154
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9156
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad(LRTrim(column01),6)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column02),70)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column03),35)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column04),16)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column05),8)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column06),30)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column07),3)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column08),3)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column09),3)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column10),2)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column11),15)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column12),8)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column13),30)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column14),30)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column15),2)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column16),3)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column17),9)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column18),14)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column19),1)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column20),8)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column21),26)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column22),25)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column23),100)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column24),2)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column25),1)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column26),4)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column27),5)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column28),10)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column29),5)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column30),3)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column31),3)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column32),3)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column33),3)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column34),1)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column35),16)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column36),8)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column37),3)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column38),16)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column39),1)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column40),15)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column41),1)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column42),11)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column43),1)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column44),4)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column45),1)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column46),8)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column47),8)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column48),3)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column49),3)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column50),2)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column51),2)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column52),2)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column53),2)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column54),2)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column55),1)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column56),1)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column57),1)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column58),1)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column59),1)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='riga + LibreriaMit.SpacePad(LRTrim(column60),1)
len=10
name='riga
obj='Var
obj_type='M
pag=44
prev=O9633
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9632
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9631
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9630
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9629
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9628
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9627
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9626
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9625
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9624
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9623
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9622
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9621
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9620
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9619
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9618
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9617
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9616
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9615
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9614
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9613
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9612
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9611
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9610
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9609
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9608
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9607
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9606
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9605
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9604
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9603
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9602
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9601
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9600
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9599
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9598
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9597
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9596
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9595
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9594
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9593
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9592
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9591
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9590
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9589
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9588
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9587
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9586
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9585
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9584
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9583
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9582
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9581
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9580
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9579
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9578
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9577
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9576
var_op='asgn
I
obj='Var
obj_type='M
pag=44
prev=O9575
var_op='asgn
I
obj='Var
obj_type='M
pag=44
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=44
prev=O9152
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9154
fatherSonIndex=0
frm_calc='a01.getContents()
len=25
name='column01
next=Icpitembatch.CPVarDecl
frm_calc='a02.getContents()
len=25
name='column02
next=Icpitembatch.CPVarDecl
frm_calc='a03.getContents()
len=25
name='column03
next=Icpitembatch.CPVarDecl
frm_calc='a04.getContents()
len=25
name='column04
next=Icpitembatch.CPVarDecl
frm_calc='a05.getContents()
len=25
name='column05
next=Icpitembatch.CPVarDecl
frm_calc='a06.getContents()
len=25
name='column06
next=Icpitembatch.CPVarDecl
frm_calc='a07.getContents()
len=25
name='column07
next=Icpitembatch.CPVarDecl
frm_calc='a08.getContents()
len=25
name='column08
next=Icpitembatch.CPVarDecl
frm_calc='a09.getContents()
len=25
name='column09
next=Icpitembatch.CPVarDecl
frm_calc='a10.getContents()
len=25
name='column10
next=Icpitembatch.CPVarDecl
frm_calc='a11.getContents()
len=25
name='column11
next=Icpitembatch.CPVarDecl
frm_calc='a12.getContents()
len=25
name='column12
next=Icpitembatch.CPVarDecl
frm_calc='a13.getContents()
len=25
name='column13
next=Icpitembatch.CPVarDecl
frm_calc='a14.getContents()
len=25
name='column14
next=Icpitembatch.CPVarDecl
frm_calc='a15.getContents()
len=25
name='column15
next=Icpitembatch.CPVarDecl
frm_calc='a16.getContents()
len=25
name='column16
next=Icpitembatch.CPVarDecl
frm_calc='a17.getContents()
len=25
name='column17
next=Icpitembatch.CPVarDecl
frm_calc='a18.getContents()
len=25
name='column18
next=Icpitembatch.CPVarDecl
frm_calc='a19.getContents()
len=25
name='column19
next=Icpitembatch.CPVarDecl
frm_calc='a20.getContents()
len=25
name='column20
next=Icpitembatch.CPVarDecl
frm_calc='a21.getContents()
len=25
name='column21
next=Icpitembatch.CPVarDecl
frm_calc='a22.getContents()
len=25
name='column22
next=Icpitembatch.CPVarDecl
frm_calc='a23.getContents()
len=25
name='column23
next=Icpitembatch.CPVarDecl
frm_calc='a24.getContents()
len=25
name='column24
next=Icpitembatch.CPVarDecl
frm_calc='a25.getContents()
len=25
name='column25
next=Icpitembatch.CPVarDecl
frm_calc='a26.getContents()
len=25
name='column26
next=Icpitembatch.CPVarDecl
frm_calc='a27.getContents()
len=25
name='column27
next=Icpitembatch.CPVarDecl
frm_calc='a28.getContents()
len=25
name='column28
next=Icpitembatch.CPVarDecl
frm_calc='a29.getContents()
len=25
name='column29
next=Icpitembatch.CPVarDecl
frm_calc='a30.getContents()
len=25
name='column30
next=Icpitembatch.CPVarDecl
frm_calc='a31.getContents()
len=25
name='column31
next=Icpitembatch.CPVarDecl
frm_calc='a32.getContents()
len=25
name='column32
next=Icpitembatch.CPVarDecl
frm_calc='a33.getContents()
len=25
name='column33
next=Icpitembatch.CPVarDecl
frm_calc='a34.getContents()
len=25
name='column34
next=Icpitembatch.CPVarDecl
frm_calc='a35.getContents()
len=25
name='column35
next=Icpitembatch.CPVarDecl
frm_calc='a36.getContents()
len=25
name='column36
next=Icpitembatch.CPVarDecl
frm_calc='a37.getContents()
len=25
name='column37
next=Icpitembatch.CPVarDecl
frm_calc='a38.getContents()
len=25
name='column38
next=Icpitembatch.CPVarDecl
frm_calc='a39.getContents()
len=25
name='column39
next=Icpitembatch.CPVarDecl
frm_calc='a40.getContents()
len=25
name='column40
next=Icpitembatch.CPVarDecl
frm_calc='a41.getContents()
len=25
name='column41
next=Icpitembatch.CPVarDecl
frm_calc='a42.getContents()
len=25
name='column42
next=Icpitembatch.CPVarDecl
frm_calc='a43.getContents()
len=25
name='column43
next=Icpitembatch.CPVarDecl
frm_calc='a44.getContents()
len=25
name='column44
next=Icpitembatch.CPVarDecl
frm_calc='a45.getContents()
len=25
name='column45
next=Icpitembatch.CPVarDecl
frm_calc='a46.getContents()
len=25
name='column46
next=Icpitembatch.CPVarDecl
frm_calc='a47.getContents()
len=25
name='column47
next=Icpitembatch.CPVarDecl
frm_calc='a48.getContents()
len=25
name='column48
next=Icpitembatch.CPVarDecl
frm_calc='a49.getContents()
len=25
name='column49
next=Icpitembatch.CPVarDecl
frm_calc='a50.getContents()
len=25
name='column50
next=Icpitembatch.CPVarDecl
frm_calc='a51.getContents()
len=25
name='column51
next=Icpitembatch.CPVarDecl
frm_calc='a52.getContents()
len=25
name='column52
next=Icpitembatch.CPVarDecl
frm_calc='a53.getContents()
len=25
name='column53
next=Icpitembatch.CPVarDecl
frm_calc='a54.getContents()
len=25
name='column54
next=Icpitembatch.CPVarDecl
frm_calc='a55.getContents()
len=25
name='column55
next=Icpitembatch.CPVarDecl
frm_calc='a56.getContents()
len=25
name='column56
next=Icpitembatch.CPVarDecl
frm_calc='a57.getContents()
len=25
name='column57
next=Icpitembatch.CPVarDecl
frm_calc='a58.getContents()
len=25
name='column58
next=Icpitembatch.CPVarDecl
frm_calc='a59.getContents()
len=25
name='column59
next=Icpitembatch.CPVarDecl
frm_calc='a60.getContents()
len=25
name='column60
obj='Var
pag=44
prev=O9696
var_op='asgn
I
obj='Var
pag=44
prev=O9695
var_op='asgn
I
obj='Var
pag=44
prev=O9694
var_op='asgn
I
obj='Var
pag=44
prev=O9693
var_op='asgn
I
obj='Var
pag=44
prev=O9692
var_op='asgn
I
obj='Var
pag=44
prev=O9691
var_op='asgn
I
obj='Var
pag=44
prev=O9690
var_op='asgn
I
obj='Var
pag=44
prev=O9689
var_op='asgn
I
obj='Var
pag=44
prev=O9688
var_op='asgn
I
obj='Var
pag=44
prev=O9687
var_op='asgn
I
obj='Var
pag=44
prev=O9686
var_op='asgn
I
obj='Var
pag=44
prev=O9685
var_op='asgn
I
obj='Var
pag=44
prev=O9684
var_op='asgn
I
obj='Var
pag=44
prev=O9683
var_op='asgn
I
obj='Var
pag=44
prev=O9682
var_op='asgn
I
obj='Var
pag=44
prev=O9681
var_op='asgn
I
obj='Var
pag=44
prev=O9680
var_op='asgn
I
obj='Var
pag=44
prev=O9679
var_op='asgn
I
obj='Var
pag=44
prev=O9678
var_op='asgn
I
obj='Var
pag=44
prev=O9677
var_op='asgn
I
obj='Var
pag=44
prev=O9676
var_op='asgn
I
obj='Var
pag=44
prev=O9675
var_op='asgn
I
obj='Var
pag=44
prev=O9674
var_op='asgn
I
obj='Var
pag=44
prev=O9673
var_op='asgn
I
obj='Var
pag=44
prev=O9672
var_op='asgn
I
obj='Var
pag=44
prev=O9671
var_op='asgn
I
obj='Var
pag=44
prev=O9670
var_op='asgn
I
obj='Var
pag=44
prev=O9669
var_op='asgn
I
obj='Var
pag=44
prev=O9668
var_op='asgn
I
obj='Var
pag=44
prev=O9667
var_op='asgn
I
obj='Var
pag=44
prev=O9666
var_op='asgn
I
obj='Var
pag=44
prev=O9665
var_op='asgn
I
obj='Var
pag=44
prev=O9664
var_op='asgn
I
obj='Var
pag=44
prev=O9663
var_op='asgn
I
obj='Var
pag=44
prev=O9662
var_op='asgn
I
obj='Var
pag=44
prev=O9661
var_op='asgn
I
obj='Var
pag=44
prev=O9660
var_op='asgn
I
obj='Var
pag=44
prev=O9659
var_op='asgn
I
obj='Var
pag=44
prev=O9658
var_op='asgn
I
obj='Var
pag=44
prev=O9657
var_op='asgn
I
obj='Var
pag=44
prev=O9656
var_op='asgn
I
obj='Var
pag=44
prev=O9655
var_op='asgn
I
obj='Var
pag=44
prev=O9654
var_op='asgn
I
obj='Var
pag=44
prev=O9653
var_op='asgn
I
obj='Var
pag=44
prev=O9652
var_op='asgn
I
obj='Var
pag=44
prev=O9651
var_op='asgn
I
obj='Var
pag=44
prev=O9650
var_op='asgn
I
obj='Var
pag=44
prev=O9649
var_op='asgn
I
obj='Var
pag=44
prev=O9648
var_op='asgn
I
obj='Var
pag=44
prev=O9647
var_op='asgn
I
obj='Var
pag=44
prev=O9646
var_op='asgn
I
obj='Var
pag=44
prev=O9645
var_op='asgn
I
obj='Var
pag=44
prev=O9644
var_op='asgn
I
obj='Var
pag=44
prev=O9643
var_op='asgn
I
obj='Var
pag=44
prev=O9642
var_op='asgn
I
obj='Var
pag=44
prev=O9641
var_op='asgn
I
obj='Var
pag=44
prev=O9640
var_op='asgn
I
obj='Var
pag=44
prev=O9639
var_op='asgn
I
obj='Var
pag=44
prev=O9638
var_op='asgn
I
obj='Var
pag=44
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=44
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O9152
fatherSonIndex=0
frm_calc='// Legge il contenuto delle celle﷯Cell a01 = sheet.getCell(0,_y);﷯Cell a02 = sheet.getCell(1,_y);﷯Cell a03 = sheet.getCell(2,_y);﷯Cell a04 = sheet.getCell(3,_y);﷯Cell a05 = sheet.getCell(4,_y);﷯Cell a06 = sheet.getCell(5,_y);﷯Cell a07 = sheet.getCell(6,_y);﷯Cell a08 = sheet.getCell(7,_y);﷯Cell a09 = sheet.getCell(8,_y);﷯Cell a10 = sheet.getCell(9,_y);﷯Cell a11 = sheet.getCell(10,_y);﷯Cell a12 = sheet.getCell(11,_y);﷯Cell a13 = sheet.getCell(12,_y);﷯Cell a14 = sheet.getCell(13,_y);﷯Cell a15 = sheet.getCell(14,_y);﷯Cell a16 = sheet.getCell(15,_y);﷯Cell a17 = sheet.getCell(16,_y);﷯Cell a18 = sheet.getCell(17,_y);﷯Cell a19 = sheet.getCell(18,_y);﷯Cell a20 = sheet.getCell(19,_y);﷯Cell a21 = sheet.getCell(20,_y);﷯Cell a22 = sheet.getCell(21,_y);﷯Cell a23 = sheet.getCell(22,_y);﷯Cell a24 = sheet.getCell(23,_y);﷯Cell a25 = sheet.getCell(24,_y);﷯Cell a26 = sheet.getCell(25,_y);﷯Cell a27 = sheet.getCell(26,_y);﷯Cell a28 = sheet.getCell(27,_y);﷯Cell a29 = sheet.getCell(28,_y);﷯Cell a30 = sheet.getCell(29,_y);﷯Cell a31 = sheet.getCell(30,_y);﷯Cell a32 = sheet.getCell(31,_y);﷯Cell a33 = sheet.getCell(32,_y);﷯Cell a34 = sheet.getCell(33,_y);﷯Cell a35 = sheet.getCell(34,_y);﷯Cell a36 = sheet.getCell(35,_y);﷯Cell a37 = sheet.getCell(36,_y);﷯Cell a38 = sheet.getCell(37,_y);﷯Cell a39 = sheet.getCell(38,_y);﷯Cell a40 = sheet.getCell(39,_y);﷯Cell a41 = sheet.getCell(40,_y);﷯Cell a42 = sheet.getCell(41,_y);﷯Cell a43 = sheet.getCell(42,_y);﷯Cell a44 = sheet.getCell(43,_y);﷯Cell a45 = sheet.getCell(44,_y);﷯Cell a46 = sheet.getCell(45,_y);﷯Cell a47 = sheet.getCell(46,_y);﷯Cell a48 = sheet.getCell(47,_y);﷯Cell a49 = sheet.getCell(48,_y);﷯Cell a50 = sheet.getCell(49,_y);﷯Cell a51 = sheet.getCell(50,_y);﷯Cell a52 = sheet.getCell(51,_y);﷯Cell a53 = sheet.getCell(52,_y);﷯Cell a54 = sheet.getCell(53,_y);﷯Cell a55 = sheet.getCell(54,_y);﷯Cell a56 = sheet.getCell(55,_y);﷯Cell a57 = sheet.getCell(56,_y);﷯Cell a58 = sheet.getCell(57,_y);﷯Cell a59 = sheet.getCell(58,_y);﷯Cell a60 = sheet.getCell(59,_y);
obj='Exec
pag=44
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=44
I
I
]
w=[
150
150
]
I
obj='Exec
pag=44
prev=O9091
I
obj='Begin
pag=44
prev=O9090
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O9091
fatherSonIndex=0
frm_calc='//base﷯Workbook workbook = Workbook.getWorkbook(new File(CPLib.LRTrim(gPathDoc)+"/appo/"+CPLib.LRTrim(gAzienda)+"/"+CPLib.LRTrim(nomefileimport)));﷯_conta = workbook.getNumberOfSheets();
obj='Exec
pag=44
I
I
]
w=[
150
150
]
I
obj='Read
pag=44
prev=O9089
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
rd_var=[
'nProgSto
]
I
obj='Read
pag=44
prev=O9088
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
rd_var=[
'nProgImp
]
I
obj='MemoryCursor
pag=44
prev=O9086
sel_field='*
sel_name='tbcitta
sel_type='fltb
I
obj='Begin
pag=44
prev=O9085
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O9086
fatherSonIndex=0
frm_calc=[
'At("archpers",_tabelle)=0
]
h=[
19
19
]
obj='If
pag=44
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9719
fatherSonIndex=0
frm_calc='_tabelle+"archpers,"
len=10
name='_tabelle
obj='Var
obj_type='M
pag=44
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=44
prev=O9084
var_op='asgn
I
obj='Var
obj_type='N
pag=44
prev=O9083
var_op='asgn
I
obj='Var
obj_type='N
pag=44
prev=O9082
var_op='asgn
I
obj='Var
obj_type='N
pag=44
prev=O9081
var_op='asgn
I
obj='Var
obj_type='N
pag=44
prev=O9080
var_op='asgn
I
obj='Var
obj_type='N
pag=44
prev=O9079
var_op='asgn
I
obj='Var
obj_type='N
pag=44
prev=O9078
var_op='asgn
I
obj='Var
obj_type='N
pag=44
prev=O9077
var_op='asgn
I
obj='Remark
pag=44
x=16
y=23
I
Icpitembatch.CPExec
check='man
frm_calc='// Trova il charset del file di import﷯FileInputStream fis = null;﷯InputStreamReader isr = null;﷯String s;﷯      ﷯try {﷯  // new input stream reader is created ﷯  fis = new FileInputStream(fileName);﷯  isr = new InputStreamReader(fis);﷯  // the name of the character encoding returned﷯  _charset = isr.getEncoding();﷯ if(_charset=="UTF8")﷯   _charset="UTF-8";﷯ System.out.println(_charset);﷯} catch (Exception e) {﷯  // print error﷯  System.out.print("The stream is already closed");﷯} finally {﷯  // closes the stream and releases resources associated﷯  if(fis!=null)﷯     fis.close();﷯  if(isr!=null)﷯     isr.close();﷯}   
obj='Exec
pag=45
x=18
y=17
I
Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono state elaborate '+LRTrim(Str(conta,10,0))+' informazioni su '+LRTrim(Str(righeTot,10,0)) + ' del file '+nomefileimport
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=8
var_op='asgn
x=934
y=869
I
Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono state elaborate '+LRTrim(Str(conta,10,0))+' informazioni su '+LRTrim(Str(righeTot,10,0)) + ' del file '+nomefileimport
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=10
var_op='asgn
x=1245
y=6040
I
Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,16)
len=16
name='cCli1
obj='Var
pag=16
var_op='asgn
x=314
y=620
I
Icpitembatch.CPRemark
frm_calc='Importa i file per OAM
next=Icpitembatch.CPBeginEnd
comment='MacroAgenti
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Responsabili legali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Preposti sedi operative
h=[
19
19
]
obj='Begin
pag=46
prev=O9734
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O9736
fatherSonIndex=0
frm_calc=[
'At('archpreposti.txt',Lower(nomefileimport)) <> 0
]
h=[
19
19
]
obj='If
pag=46
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9740
fatherSonIndex=0
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime())  + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Preposti sedi operative Inseriti/Aggiornati: '+LRTrim(Str(conta,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=46
prev=O9754
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=46
prev=O9753
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=46
prev=O9752
var_op='asgn
I
obj='Exec
pag=46
prev=O9751
I
obj='Exec
pag=46
prev=O9750
I
obj='Exec
pag=46
prev=O9748
I
obj='While
pag=46
prev=O9747
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9748
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=46
prev=O9758
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9759
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' preposti sedi operative del file '+LRTrim(nomefileimport)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPRead
arch='dippreposti
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow=0
]
h=[
19
19
]
next=Icpitembatch.CPMerge
arch='dippreposti
obj='Merge
pag=46
prev=O9768
rd_kfield=[
'CODDIP
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(Left(riga,6))
'cMaxRow
]
wr_field=[
'CODDIP
'CPROWNUM
'COGNOME
'NOME
'CODFISC
'DATAINI
'DATAFINE
'IDBASE
]
wr_mode=[
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(Left(riga,6))
'cMaxRow
'Substr(riga,7,50)
'Substr(riga,57,50)
'Substr(riga,107,16)
'CharToDate(Substr(riga,127,4)+Substr(riga,125,2)+Substr(riga,123,2))
'CharToDate(Substr(riga,135,4)+Substr(riga,133,2)+Substr(riga,131,2))
'LibreriaMit.UniqueId()
]
I
obj='If
pag=46
prev=O9767
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O9768
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=46
prev=O9781
var_op='asgn
I
obj='Select
pag=46
sel_field='dippreposti->CPROWNUM
sel_name='dippreposti
sel_order='dippreposti->CPROWNUM desc
sel_where='dippreposti->CODDIP=LRTrim(Left(riga,6))
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9781
fatherSonIndex=0
frm_calc='dippreposti->CPROWNUM
len=4
name='cMaxRow
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=46
prev=O9786
I
obj='Var
obj_type='N
pag=46
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=46
prev=O9766
rd_field=[
'CPROWNUM
]
rd_kfield=[
'CODDIP
'CODFISC
]
rd_kvar=[
'LRTrim(Left(riga,6))
'Substr(riga,107,16)
]
rd_var=[
'cMaxRow
]
I
obj='Var
obj_type='N
pag=46
prev=O9765
var_op='asgn
I
nonlocal=True
obj='Var
pag=46
prev=O9764
var_op='asgn
I
obj='Var
obj_type='N
pag=46
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=46
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=46
prev=O9746
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=46
prev=O9745
var_op='asgn
I
obj='Var
obj_type='N
pag=46
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=46
prev=O9732
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O9734
fatherSonIndex=0
frm_calc=[
'At('archresleg.txt',Lower(nomefileimport)) <> 0
]
h=[
19
19
]
obj='If
pag=46
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9800
fatherSonIndex=0
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime())  + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Responsabili Legali Inseriti/Aggiornati: '+LRTrim(Str(conta,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=46
prev=O9814
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=46
prev=O9813
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=46
prev=O9812
var_op='asgn
I
obj='Exec
pag=46
prev=O9811
I
obj='Exec
pag=46
prev=O9810
I
obj='Exec
pag=46
prev=O9808
I
obj='While
pag=46
prev=O9807
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9808
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=46
prev=O9818
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9819
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' responsabili legali del file '+LRTrim(nomefileimport)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPRead
arch='ageresleg
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow=0
]
h=[
19
19
]
next=Icpitembatch.CPMerge
arch='ageresleg
obj='Merge
pag=46
prev=O9828
rd_kfield=[
'CODMAGE
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(Left(riga,5))
'cMaxRow
]
wr_field=[
'CODMAGE
'CPROWNUM
'COGNOME
'NOME
'CODFISC
'DATAINI
'DATAFINE
'IDBASE
]
wr_mode=[
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(Left(riga,5))
'cMaxRow
'Substr(riga,6,50)
'Substr(riga,56,50)
'Substr(riga,106,16)
'CharToDate(Substr(riga,126,4)+Substr(riga,124,2)+Substr(riga,122,2))
'CharToDate(Substr(riga,134,4)+Substr(riga,132,2)+Substr(riga,130,2))
'LibreriaMit.UniqueId()
]
I
obj='If
pag=46
prev=O9827
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O9828
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=46
prev=O9841
var_op='asgn
I
obj='Select
pag=46
sel_field='ageresleg->CPROWNUM
sel_name='ageresleg
sel_order='ageresleg->CPROWNUM desc
sel_where='ageresleg->CODMAGE=LRTrim(Left(riga,5))
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9841
fatherSonIndex=0
frm_calc='ageresleg->CPROWNUM
len=4
name='cMaxRow
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=46
prev=O9846
I
obj='Var
obj_type='N
pag=46
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=46
prev=O9826
rd_field=[
'CPROWNUM
]
rd_kfield=[
'CODMAGE
'CODFISC
]
rd_kvar=[
'LRTrim(Left(riga,5))
'Substr(riga,106,16)
]
rd_var=[
'cMaxRow
]
I
obj='Var
obj_type='N
pag=46
prev=O9825
var_op='asgn
I
nonlocal=True
obj='Var
pag=46
prev=O9824
var_op='asgn
I
obj='Var
obj_type='N
pag=46
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=46
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=46
prev=O9806
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=46
prev=O9805
var_op='asgn
I
obj='Var
obj_type='N
pag=46
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=46
prev=O9731
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O9732
fatherSonIndex=0
frm_calc=[
'At('archmacroagenti.txt',Lower(nomefileimport)) <> 0
]
h=[
19
19
]
obj='If
pag=46
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9860
fatherSonIndex=0
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime())  + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'MacroAgenti Inseriti/Aggiornati: '+LRTrim(Str(conta,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=46
prev=O9874
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=46
prev=O9873
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=46
prev=O9872
var_op='asgn
I
obj='Exec
pag=46
prev=O9871
I
obj='Exec
pag=46
prev=O9870
I
obj='Exec
pag=46
prev=O9868
I
obj='While
pag=46
prev=O9867
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9868
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=46
prev=O9878
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9879
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' macroagenti del file '+LRTrim(nomefileimport)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPMerge
arch='tbmacage
obj='Merge
pag=46
prev=O9885
rd_kfield=[
'MACODICE
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(Left(riga,5))
]
wr_field=[
'MACODICE
'MADESCRI
'MACOGNOME
'MANOME
'MACODFIS
'MATIPAGE
'MAFISGIU
'MADATINI
'MADATFIN
'MARESPAESE
'MARESCITTA
'MARESPRV
'MARESIND
'MARESNCIV
'MARESCAP
'MADOMPAESE
'MADOMCITTA
'MADOMPRV
'MADOMIND
'MADOMNCIV
'MADOMCAP
'MADATMOD
'MAFLGCOMPL
]
wr_mode=[
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(Left(riga,5))
'Substr(riga,6,120)
'Substr(riga,126,50)
'Substr(riga,176,50)
'Substr(riga,226,16)
'Substr(riga,242,1)
'Substr(riga,243,1)
'iif(Len(LRTrim(Substr(riga,244,8)))=0,NullDate(),CharToDate(Substr(riga,248,4)+Substr(riga,246,2)+Substr(riga,244,2)))
'iif(Len(LRTrim(Substr(riga,252,8)))=0,NullDate(),CharToDate(Substr(riga,256,4)+Substr(riga,254,2)+Substr(riga,252,2)))
'Substr(riga,260,3)
'Substr(riga,263,60)
'Substr(riga,323,2)
'Substr(riga,325,50)
'Substr(riga,375,15)
'Substr(riga,390,15)
'Substr(riga,405,3)
'Substr(riga,408,60)
'Substr(riga,468,2)
'Substr(riga,470,50)
'Substr(riga,520,15)
'Substr(riga,535,15)
'iif(Len(LRTrim(Substr(riga,550,8)))=0,NullDate(),CharToDate(Substr(riga,554,4)+Substr(riga,552,2)+Substr(riga,550,2)))
'iif(LRTrim(Substr(riga,558,1))='S',1,0)
]
I
nonlocal=True
obj='Var
pag=46
prev=O9884
var_op='asgn
I
obj='Var
obj_type='N
pag=46
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=46
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=46
prev=O9866
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=46
prev=O9865
var_op='asgn
I
obj='Var
obj_type='N
pag=46
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=46
x=21
y=25
I
Icpitembatch.CPBeginEnd
comment='Parametri
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPBeginEnd
comment='Gestione storico import
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Inizializzazione MC controlli
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(riga_ope)
]
h=[
19
19
]
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand)) or not(Empty(riga_ope))
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(riga_ope)
]
h=[
19
19
]
obj='If
pag=6
prev=O9909
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O9911
fatherSonIndex=0
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Frazionate Inserite o Modificate: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','FRAZIOBO','Frazionate Inserite o modificate: '+LRTrim(Str(cNumNew,10,0)))
obj='Exec
pag=6
prev=O9921
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O9920
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O9919
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O9918
var_op='asgn
I
obj='Exec
pag=6
prev=O9917
I
obj='Exec
pag=6
prev=O9916
I
obj='Exec
pag=6
I
I
]
w=[
150
150
]
I
obj='While
pag=6
prev=O9906
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9909
fatherSonIndex=0
frm_calc='iif(Empty(riga_ope),FileLibMit.ReadLine(fhand),riga_ope)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(riga_ope))
]
h=[
19
19
]
obj='If
pag=6
prev=O9927
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExitLoop
father=O9930
fatherSonIndex=0
obj='ExitLoop
pag=6
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O9926
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O9927
fatherSonIndex=0
frm_calc='NullDate()
len=8
name='_oldreg
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Upper(Substr(riga,331,9))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
prev=O9945
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O9947
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,257,6))))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,318,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc='_flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,923,1)='S',1,0)
len=1
name='_flgfraud
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,331,9))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))) or (Empty(LRTrim(_numprog)) and not(Empty(LRTrim(Left(riga,8)))))
]
h=[
19
19
]
obj='If
pag=6
prev=O9970
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O9973
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,155,1)='S'
'Substr(riga,155,1)='E'
'Substr(riga,155,1)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,9,1)='1' or Substr(riga,9,1)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,301,1)),'0',iif(Substr(riga,301,1)='S','1',iif(Substr(riga,301,1)='N','0',Substr(riga,301,1))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,231,11))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono state elaborate '+LRTrim(Str(conta,10,0))+' frazionate del file '+LRTrim(nomefileimport)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,852,19))),0,Val(LRTrim(Substr(riga,852,19))))
len=15
name='_totin
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,871,19))),0,Val(LRTrim(Substr(riga,871,19))))
len=15
name='_totout
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge i dati dell'intermediario controparte
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='fraziobo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_oldidb)))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=6
prev=O10004
var_op='asgn
I
obj='If
pag=6
prev=O10002
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O10004
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='sogopefbo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='clientifrz
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='beneficfrz
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='terzistifrz
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPMerge
arch='fraziobo_agg
obj='Merge
pag=6
prev=O10022
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'IDBASE
'FLAGFRAUD
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
'SV58724
'SV58726SCA
'SV58726SA
'SV58726PISP
'C_COGNOME
'C_NOME
'SOSPAGAM
]
wr_mode=[
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'cOpeProg1
'_flgfraud
'Substr(riga,924,2)
'Substr(riga,926,2)
'Substr(riga,928,2)
'Substr(riga,930,2)
'Substr(riga,932,2)
'fwfn_calc_categoria(Substr(riga,924,2),Substr(riga,926,2),Substr(riga,928,2),Substr(riga,930,2),Substr(riga,932,2))
'Substr(riga,934,2)
'iif(Empty(Substr(riga,936,1)),'N',Substr(riga,936,1))
'Substr(riga,937,3)
'Substr(riga,940,3)
'Substr(riga,943,50)
'Substr(riga,993,30)
'Substr(riga,1023,1)
]
I
obj='Select
pag=6
prev=O10021
sel_field='*
sel_name='fraziobo_agg
sel_where='fraziobo_agg->IDBASE=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='fraziobo_agg
father=O10022
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDBASE
'CODLOB
'TIPOGIOCO
'CACODICE
'IDBIGLIETTO
'CADATAORA
'CATIPGIO
'CATIPCON
'CAPV_COD
'IDDOCALL
'VPCODICE
'WUDATRET
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
'FLAGFRAUD
'SV58724
'SV58726SCA
'SV58726SA
'SV58726PISP
'C_COGNOME
'C_NOME
'SOSPAGAM
]
rd_kvar=[
'cOpeProg1
'fraziobo_agg->CODLOB
'fraziobo_agg->TIPOGIOCO
'fraziobo_agg->CACODICE
'fraziobo_agg->IDBIGLIETTO
'fraziobo_agg->CADATAORA
'fraziobo_agg->CATIPGIO
'fraziobo_agg->CATIPCON
'fraziobo_agg->CAPV_COD
'fraziobo_agg->IDDOCALL
'fraziobo_agg->VPCODICE
'fraziobo_agg->WUDATRET
'fraziobo_agg->CATEG01
'fraziobo_agg->CATEG02
'fraziobo_agg->CATEG03
'fraziobo_agg->CATEG04
'fraziobo_agg->CATEG05
'fraziobo_agg->CATEGORIA
'fraziobo_agg->FLAGFRAUD
'fraziobo_agg->SV58724
'fraziobo_agg->SV58726SCA
'fraziobo_agg->SV58726SA
'fraziobo_agg->SV58726PISP
'fraziobo_agg->C_COGNOME
'fraziobo_agg->C_NOME
'fraziobo_agg->SOSPAGAM
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=6
prev=O10019
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=6
prev=O10018
sel_field='*
sel_name='terzistifrz
sel_where='terzistifrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistifrz
father=O10019
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'NUMIMP
]
rd_kvar=[
'cOpeProg1
'terzistifrz->CODSOG
'terzistifrz->TIPOFILE
'terzistifrz->NUMCOL
'terzistifrz->LEGAME
'terzistifrz->RAPCOL
'terzistifrz->UCODE
'terzistifrz->IDBASE
'_numimp
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=6
prev=O10016
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=6
prev=O10015
sel_field='*
sel_name='beneficfrz
sel_where='beneficfrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficfrz
father=O10016
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
'NUMIMP
]
rd_kvar=[
'cOpeProg1
'beneficfrz->CPROWNUM
'beneficfrz->CODSOG
'beneficfrz->TIPOFILE
'beneficfrz->NUMCOL
'beneficfrz->LEGAME
'beneficfrz->RAPCOL
'beneficfrz->UCODE
'beneficfrz->IDBASE
'beneficfrz->C_RAG
'beneficfrz->C_STA
'beneficfrz->C_CTA
'beneficfrz->C_CAB
'beneficfrz->C_PRV
'beneficfrz->C_IND
'beneficfrz->C_CAP
'beneficfrz->C_RAPPORTO
'_numimp
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=6
prev=O10013
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=6
prev=O10012
sel_field='*
sel_name='clientifrz
sel_where='clientifrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientifrz
father=O10013
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'PROQUOTA
'IMPSARA
'NUMIMP
]
rd_kvar=[
'cOpeProg1
'clientifrz->CODSOG
'clientifrz->LEGAME
'clientifrz->IDBASE
'clientifrz->NUMCOL
'clientifrz->TIPOFILE
'clientifrz->RAPCOL
'clientifrz->UCODE
'clientifrz->PROQUOTA
'clientifrz->IMPSARA
'_numimp
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=6
prev=O10010
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=6
sel_field='*
sel_name='sogopefbo
sel_where='sogopefbo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sogopefbo
father=O10010
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'NUMIMP
]
rd_kvar=[
'cOpeProg1
'sogopefbo->CPROWNUM
'sogopefbo->CODSOG
'sogopefbo->LEGAME
'sogopefbo->IDBASE
'sogopefbo->NUMCOL
'sogopefbo->TIPOFILE
'sogopefbo->RAPCOL
'sogopefbo->UCODE
'_numimp
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='fraziobo_agg
father=O10004
fatherSonIndex=1
obj='Insert
pag=6
rd_kfield=[
'IDBASE
'FLAGFRAUD
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
'SV58724
'SV58726SCA
'SV58726SA
'SV58726PISP
'C_COGNOME
'C_NOME
'SOSPAGAM
]
rd_kvar=[
'cOpeProg1
'_flgfraud
'Substr(riga,924,2)
'Substr(riga,926,2)
'Substr(riga,928,2)
'Substr(riga,930,2)
'Substr(riga,932,2)
'fwfn_calc_categoria(Substr(riga,924,2),Substr(riga,926,2),Substr(riga,928,2),Substr(riga,930,2),Substr(riga,932,2))
'Substr(riga,934,2)
'iif(Empty(Substr(riga,936,1)),'N',Substr(riga,936,1))
'Substr(riga,937,3)
'Substr(riga,940,3)
'Substr(riga,943,50)
'Substr(riga,993,30)
'Substr(riga,1023,1)
]
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=6
prev=O10000
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
'IMPIN
'IMPOUT
'MITIG
'SV58550
'PROQUOTA
'IMPSARA
'SV58550MA
'NOSARA
'NUMIMP
'VASP
]
rd_kvar=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'LRTrim(Substr(riga,10,4))
'_intercab
'_iccab
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'LRTrim(Substr(riga,484,16))
'LRTrim(Substr(riga,302,16))
'LRTrim(Substr(riga,190,16))
'LRTrim(Substr(riga,206,16))
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_datarett
'_iccit
'_intercit
'_icrag
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'_flagrap2
'cOpeProg1
'cIdCau
'"F"+Right(cOpeProg2,9)+_idb2
'Substr(riga,424,30)
'Substr(riga,813,15)
'Substr(riga,414,5)
'Substr(riga,662,50)
'cOpeProg2
'Substr(riga,328,3)
'_idreg
''1'
'iif(Empty(Substr(riga,828,14)) or Substr(riga,828,14)='01010001000000',NullDateTime(),CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6)))
'_icsta
'Substr(riga,812,1)
'nProgImp
'_icprv
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
'_statoreg
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'_colleg
'_idb2
'_totin / 100
'_totout / 100
'Val(Substr(riga,893,4))
'Substr(riga,897,1)
'Val(Substr(riga,898,3))
'Val(Substr(riga,901,19))/100
'Substr(riga,920,2)
'iif(Empty(LRTrim(Substr(riga,922,1))) or Substr(riga,922,1)='0' or Substr(riga,922,1)='N','N','S')
'_numimp
'Val(Substr(riga,1024,2))
]
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O10002
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=6
prev=O10085
I
obj='Var
obj_type='N
pag=6
prev=O10084
var_op='asgn
I
obj='Exec
pag=6
prev=O10083
I
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Begin
pag=6
prev=O9998
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10000
fatherSonIndex=0
frm_calc='''
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=50
name='_icrag
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,18,11)))) and Len(LRTrim(Substr(riga,64,6)+Substr(riga,70,50)+Substr(riga,29,3)+Substr(riga,62,2)+Substr(riga,32,30))) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
prev=O10094
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O10095
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(_icrag),50)
len=50
name='_icrag
obj='Var
pag=6
prev=O10100
var_op='asgn
I
obj='Read
pag=6
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'Substr(riga,18,11)
]
rd_var=[
'_iccab
'_iccit
'_icprv
'_icsta
'_icrag
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10095
fatherSonIndex=1
frm_calc='Substr(riga,64,6)
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,32,30)
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,62,2)
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,29,3))
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,70,50)
len=50
name='_icrag
obj='Var
pag=6
prev=O10110
var_op='asgn
I
obj='Var
pag=6
prev=O10109
var_op='asgn
I
obj='Var
pag=6
prev=O10108
var_op='asgn
I
obj='Var
pag=6
prev=O10107
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=6
prev=O10093
var_op='asgn
I
obj='Var
pag=6
prev=O10092
var_op='asgn
I
obj='Var
pag=6
prev=O10091
var_op='asgn
I
obj='Var
pag=6
prev=O10090
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
prev=O9997
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9998
fatherSonIndex=0
frm_calc='Upper(Substr(riga,511,70))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,581,3))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,584,30))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,614,6)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,620,2))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,622,35))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,657,5))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,302,16))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=6
prev=O10126
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O10129
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,120,25))))
]
h=[
19
19
]
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O10134
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=6
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10139
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=6
prev=O10150
I
obj='Read
pag=6
prev=O10149
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=6
prev=O10148
var_op='asgn
I
obj='Var
pag=6
prev=O10147
var_op='asgn
I
obj='Var
pag=6
prev=O10146
var_op='asgn
I
obj='Var
pag=6
prev=O10145
var_op='asgn
I
obj='Var
pag=6
prev=O10144
var_op='asgn
I
obj='Var
pag=6
prev=O10143
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O10123
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10126
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=6
prev=O10167
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,302,16)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=6
prev=O10166
var_op='asgn
I
obj='Var
pag=6
prev=O10165
var_op='asgn
I
obj='Var
pag=6
prev=O10164
var_op='asgn
I
obj='Var
pag=6
prev=O10163
var_op='asgn
I
obj='Var
pag=6
prev=O10162
var_op='asgn
I
obj='Var
pag=6
prev=O10161
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O10122
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O10123
fatherSonIndex=0
obj='Read
pag=6
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O10121
var_op='asgn
I
obj='Var
pag=6
prev=O10120
var_op='asgn
I
obj='Var
pag=6
prev=O10119
var_op='asgn
I
obj='Var
pag=6
prev=O10118
var_op='asgn
I
obj='Var
pag=6
prev=O10117
var_op='asgn
I
obj='Var
pag=6
prev=O10116
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O9996
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O9995
var_op='asgn
I
nonlocal=True
obj='Var
pag=6
prev=O9994
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O9993
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O9991
var_op='asgn
I
obj='Select
pag=6
par_expr=[
'LRTrim(Substr(riga,10,4))
'Substr(riga,14,2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O9990
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9991
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O9989
var_op='asgn
I
obj='Var
pag=6
prev=O9988
var_op='asgn
I
obj='Var
pag=6
prev=O9987
var_op='asgn
I
obj='Var
pag=6
prev=O9986
var_op='asgn
I
obj='Var
pag=6
prev=O9983
var_op='asgn
I
obj='Case
pag=6
prev=O9982
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9983
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9983
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9983
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9983
fatherSonIndex=3
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Var
pag=6
prev=O9981
var_op='asgn
I
obj='Var
pag=6
prev=O9978
var_op='asgn
I
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9978
fatherSonIndex=0
frm_calc='_numprog
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''1'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
next=Icpitembatch.CPVarDecl
frm_calc='_oldreg
len=8
name='_datareg
obj='Var
obj_type='D
pag=6
prev=O10203
var_op='asgn
I
obj='Var
obj_type='D
pag=6
prev=O10202
var_op='asgn
I
obj='Var
pag=6
prev=O10201
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9978
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PFRAZIO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''0'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datarett
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0 or Empty(Substr(riga,147,8)),Date(),arfn_datefchar(Substr(riga,147,8)))
len=8
name='_datareg
obj='Var
obj_type='D
pag=6
prev=O10208
var_op='asgn
I
obj='Var
obj_type='D
pag=6
prev=O10207
var_op='asgn
I
obj='Var
pag=6
prev=O10206
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O9967
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O9970
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Left(riga,8)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10214
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=6
prev=O10219
sel_field='fraziobo->IDBASE
sel_name='fraziobo
sel_where='fraziobo->NUMPROG=_numprog and (fraziobo->STATOREG='0'  or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O10220
fatherSonIndex=0
frm_calc='"E' stata cancellata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=6
prev=O10224
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'fraziobo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
'NUMIMP
]
wr_op=[
'=
'=
'=
]
wr_var=[
''2'
'Date()
'_numimp
]
I
nonlocal=True
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
father=O10214
fatherSonIndex=1
frm_calc=''JLMNOTUV?'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"E' stata variata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=6
prev=O10235
sel_field='fraziobo->IDBASE,fraziobo->NUMPROG,fraziobo->DATAOPE,fraziobo->FLAGRAP2,fraziobo->IDEREG,fraziobo->DATAREG
sel_name='fraziobo
sel_where='fraziobo->NUMPROG=_numprog and (fraziobo->STATOREG='0'  or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10236
fatherSonIndex=0
frm_calc='fraziobo->IDBASE
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(fraziobo->FLAGRAP2) or fraziobo->FLAGRAP2='Z',Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(fraziobo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='fraziobo->IDEREG
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
frm_calc='fraziobo->DATAREG
len=8
name='_oldreg
next=Icpitembatch.CPWrite
arch='fraziobo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=6
prev=O10249
sel_field='*
sel_name='terzistifrz
sel_where='terzistifrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='merzistifrz
father=O10251
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'IDREG
]
rd_kvar=[
'_oldidb
'terzistifrz->CODSOG
'terzistifrz->TIPOFILE
'terzistifrz->NUMCOL
'terzistifrz->LEGAME
'terzistifrz->RAPCOL
'terzistifrz->UCODE
'terzistifrz->IDBASE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=6
prev=O10247
sel_field='*
sel_name='beneficfrz
sel_where='beneficfrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='meneficfrz
father=O10249
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
'IDREG
]
rd_kvar=[
'_oldidb
'beneficfrz->CPROWNUM
'beneficfrz->CODSOG
'beneficfrz->TIPOFILE
'beneficfrz->NUMCOL
'beneficfrz->LEGAME
'beneficfrz->RAPCOL
'beneficfrz->UCODE
'beneficfrz->IDBASE
'beneficfrz->C_RAG
'beneficfrz->C_STA
'beneficfrz->C_CTA
'beneficfrz->C_CAB
'beneficfrz->C_PRV
'beneficfrz->C_IND
'beneficfrz->C_CAP
'beneficfrz->C_RAPPORTO
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=6
prev=O10245
sel_field='*
sel_name='clientifrz
sel_where='clientifrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mlientifrz
father=O10247
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
'PROQUOTA
'IMPSARA
]
rd_kvar=[
'_oldidb
'clientifrz->CODSOG
'clientifrz->LEGAME
'clientifrz->IDBASE
'clientifrz->NUMCOL
'clientifrz->TIPOFILE
'clientifrz->RAPCOL
'clientifrz->UCODE
'_idreg
'clientifrz->PROQUOTA
'clientifrz->IMPSARA
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=6
prev=O10244
sel_field='*
sel_name='sogopefbo
sel_where='sogopefbo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mogopefbo
father=O10245
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'sogopefbo->CPROWNUM
'sogopefbo->CODSOG
'sogopefbo->LEGAME
'sogopefbo->IDBASE
'sogopefbo->NUMCOL
'sogopefbo->TIPOFILE
'sogopefbo->RAPCOL
'sogopefbo->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=6
prev=O10243
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'fraziobo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
'FLAGRAP2
]
wr_op=[
'=
'=
'=
]
wr_var=[
''3'
'iif(Empty(LRTrim(Substr(riga,147,8))),Date(),arfn_datefchar(Substr(riga,147,8)))
'_flagrap2
]
I
obj='Var
obj_type='D
pag=6
prev=O10242
var_op='asgn
I
obj='Var
pag=6
prev=O10241
var_op='asgn
I
obj='Var
pag=6
prev=O10240
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=6
prev=O10234
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O9966
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O9967
fatherSonIndex=0
frm_calc=[
'w_norifimp='N'
]
h=[
19
19
]
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O10288
fatherSonIndex=0
frm_calc=[
'Upper(Substr(riga,331,9))='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O10293
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=6
sel_field='fraziobo->NUMPROG
sel_name='fraziobo
sel_where='fraziobo->INFORM = Substr(riga,424,30) and (fraziobo->STATOREG='0' or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10298
fatherSonIndex=0
frm_calc='fraziobo->NUMPROG
len=11
name='_numprog
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O10293
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=6
sel_field='fraziobo->NUMPROG
sel_name='fraziobo
sel_where='fraziobo->RIFIMP = Substr(riga,331,9) and (fraziobo->STATOREG='0' or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10305
fatherSonIndex=0
frm_calc='fraziobo->NUMPROG
len=11
name='_numprog
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O9965
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O9964
var_op='asgn
I
obj='Var
pag=6
prev=O9963
var_op='asgn
I
obj='Var
pag=6
prev=O9962
var_op='asgn
I
obj='Var
pag=6
prev=O9959
var_op='asgn
I
obj='If
pag=6
prev=O9958
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O9959
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=6
prev=O10316
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10317
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=6
prev=O10323
I
obj='Var
obj_type='N
pag=6
prev=O10322
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,318,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O9957
var_op='asgn
I
obj='Remark
pag=6
prev=O9954
I
obj='If
pag=6
prev=O9952
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9954
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,263,30))+LRTrim(Substr(riga,295,6))+LRTrim(Substr(riga,293,2))))
]
h=[
19
19
]
obj='If
pag=6
prev=O10335
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10338
fatherSonIndex=0
frm_calc='LRTrim(Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=6
prev=O10344
var_op='asgn
I
obj='Var
pag=6
prev=O10343
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O10334
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10335
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+LRTrim(_codintope)+" in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(Substr(riga,257,6))+" non è presente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=6
prev=O10350
I
obj='Var
obj_type='N
pag=6
prev=O10349
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O10333
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'Substr(riga,257,6)
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9952
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,246,11))),_codinter,Substr(riga,246,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,263,30))),_citinter,Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,295,6))),_cabinter,Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,293,2))),_prvinter,Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=6
prev=O10362
var_op='asgn
I
obj='Var
pag=6
prev=O10361
var_op='asgn
I
obj='Var
pag=6
prev=O10360
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9947
fatherSonIndex=1
frm_calc='1
len=1
name='_frzerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(zhand,riga+" - "+_descerr)
obj='Exec
pag=6
prev=O10366
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=6
prev=O9942
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9945
fatherSonIndex=0
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Left(riga,8))))
]
h=[
19
19
]
obj='If
pag=6
prev=O10371
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O10372
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,190,16))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,206,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,484,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,120,25))) and _findsub = 1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,190,16))) and _findsub = 1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(DateDiff(arfn_datefchar(LRTrim(Left(riga,8))), _date_oggi)>(20*365))  and _findsub = 1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(arfn_datefchar(LRTrim(Left(riga,8)))>_date_oggi) and _findsub = 1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='CODANA+CODVOC+SEGNO
frm_calc='LRTrim(Substr(riga,10,4))+LRTrim(Substr(riga,14,2))+LRTrim(Substr(riga,159,1))
name='_tmp
next=Icpitembatch.CPIfElse
frm_calc=[
'not(mcCauana.HasKey(_tmp)) and _findsub = 1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='""
name='_tmp
obj='Var
pag=6
prev=O10402
var_op='asgn
I
obj='If
pag=6
prev=O10401
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Causale Analitica o Causale Sintetica o Segno
instr=Icpitembatch.CPVarDecl
father=O10402
fatherSonIndex=0
frm_calc=''Anomalia sui campi Causale Analitica e/o Causale Sintetica e/o Segno'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O10408
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O10398
var_op='asgn
I
obj='If
pag=6
prev=O10395
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Data Operazione maggiore della Data odierna
instr=Icpitembatch.CPVarDecl
father=O10398
fatherSonIndex=0
frm_calc=''Data Operazione maggiore della Data odierna'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O10413
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O10392
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Data Operazione più vecchia di 20 Anni
instr=Icpitembatch.CPVarDecl
father=O10395
fatherSonIndex=0
frm_calc=''Data Operazione più vecchia di 20 Anni'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O10418
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O10389
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Codice Cliente Operazione assente
instr=Icpitembatch.CPVarDecl
father=O10392
fatherSonIndex=0
frm_calc=''Codice Cliente Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O10423
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O10386
sons=[
Icpitembatch.CPItemSon
comment='Rapporto continuativo Operazione non presente in archivio
instr=Icpitembatch.CPIfElse
father=O10389
fatherSonIndex=0
frm_calc=[
'not(mcRapporti.HasKey(Substr(riga,120,25)))
]
h=[
19
19
]
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10428
fatherSonIndex=0
frm_calc=''Rapporto continuativo:'+ LRTrim(Substr(riga,120,25)) +" dell' Operazione non presente in archivio"
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O10433
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O10383
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Anagrafica Soggetto per conto del quale assente
instr=Icpitembatch.CPVarDecl
father=O10386
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=6
prev=O10440
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10441
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto per conto del quale assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O10446
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O10439
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,484,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O10380
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Anagrafica Controparte Operazione assente
instr=Icpitembatch.CPVarDecl
father=O10383
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=6
prev=O10457
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10458
fatherSonIndex=0
frm_calc=''Anagrafica Controparte Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O10463
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O10456
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,302,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O10377
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Anagrafica Soggetto Operante Operazione assente
instr=Icpitembatch.CPVarDecl
father=O10380
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=6
prev=O10474
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10475
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto Operante Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O10480
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O10473
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,206,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Anagrafica Intestatario Operazione assente
instr=Icpitembatch.CPVarDecl
father=O10377
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=6
prev=O10491
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10492
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O10497
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O10490
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,190,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O9941
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9942
fatherSonIndex=0
frm_calc='" per l'operazione con codice: "+iif(Upper(Substr(riga,331,9))='XXXXXXXXX',LRTrim(Substr(riga,424,30)),LRTrim(Substr(riga,331,9)))
name='_codintope
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9942
fatherSonIndex=1
frm_calc='" per l'operazione"
name='_codintope
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O9940
var_op='asgn
I
obj='Var
pag=6
prev=O9939
var_op='asgn
I
obj='Var
obj_type='D
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O9904
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9906
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
obj='Var
obj_type='N
pag=6
prev=O10518
var_op='asgn
I
obj='Var
pag=6
prev=O10517
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
prev=O9902
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O9904
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='""
name='_tmp
obj='Var
pag=6
prev=O10525
var_op='asgn
I
obj='Select
pag=6
prev=O10523
sel_name='QBE_TBCAUANA
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10525
fatherSonIndex=0
frm_seek='mcStringa.MCRDef
name='rwCauana
next=Icpitembatch.CPVarDecl
comment='uso come chiave la concatenazione di: causale_analitica+causale_sintetica+segno    es. "15"+"6S"+"D" = "156SD"
frm_calc='""+LRTrim(QBE_TBCAUANA->CODCAU)+LRTrim(QBE_TBCAUANA->CAUSINT)+LRTrim(QBE_TBCAUANA->SEGNO)
name='_tmp
next=Icpitembatch.CPVarDecl
frm_calc='_tmp
frm_seek='CODICE
name='rwCauana
next=Icpitembatch.CPVarDecl
frm_calc='QBE_TBCAUANA->idbase
frm_seek='ps_rowstatus
name='rwCauana
next=Icpitembatch.CPIfElse
frm_calc=[
'not(mcCauana.HasKey(_tmp))
]
h=[
19
19
]
obj='If
pag=6
prev=O10533
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='MC dei codici Causali Analitiche+Sintetiche+Segno
father=O10534
fatherSonIndex=0
frm_calc='_tmp,rwCauana 
frm_seek='AppendRowWithKey
name='mcCauana
obj='Var
obj_type='MC
pag=6
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='R
pag=6
prev=O10532
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O10531
var_op='prop
I
obj='Var
pag=6
prev=O10530
var_op='asgn
I
obj='Var
obj_type='R
pag=6
var_op='new
I
I
]
w=[
150
150
]
I
obj='Select
pag=6
sel_field='anarapbo->RAPPORTO
sel_name='anarapbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10523
fatherSonIndex=0
frm_seek='mcStringa.MCRDef
name='rwRapporto
next=Icpitembatch.CPVarDecl
frm_calc='anarapbo->RAPPORTO
frm_seek='CODICE
name='rwRapporto
next=Icpitembatch.CPVarDecl
comment='MC dei soli codice Rapporto
frm_calc='LibreriaMit.SpacePad(LRTrim(anarapbo->RAPPORTO),25), rwRapporto
frm_seek='AppendRowWithKey
name='mcRapporti
obj='Var
obj_type='MC
pag=6
prev=O10545
var_op='meth
I
obj='Var
obj_type='R
pag=6
prev=O10544
var_op='prop
I
obj='Var
obj_type='R
pag=6
var_op='new
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
prev=O9901
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O9902
fatherSonIndex=0
frm_calc=[
'At("archfraz",_tabelle)=0
]
h=[
19
19
]
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10551
fatherSonIndex=0
frm_calc='_tabelle+"archfraz,"
len=10
name='_tabelle
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O9900
var_op='asgn
I
obj='Remark
pag=6
prev=O9898
I
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Riga proveniente da operazioni
father=O9898
fatherSonIndex=0
len=10
name='riga_ope
obj='Var
obj_type='M
pag=6
pageparam=True
I
I
]
w=[
150
150
]
x=12
y=17
I
Icpitembatch.CPBeginEnd
comment='Parametri
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPBeginEnd
comment='Gestione storico import
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Inizializzazione MC controlli
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(riga_ope)
]
h=[
19
19
]
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(riga_ope)
]
h=[
19
19
]
obj='If
pag=10
prev=O10574
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O10576
fatherSonIndex=0
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(DateTime())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Frazionate Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','XRAZIOBO','Frazionate Inserite: '+LRTrim(Str(cNumNew,10,0)))
obj='Exec
pag=10
prev=O10586
I
nonlocal=True
obj='Var
obj_type='M
pag=10
prev=O10585
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=10
prev=O10584
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=10
prev=O10583
var_op='asgn
I
obj='Exec
pag=10
prev=O10582
I
obj='Exec
pag=10
prev=O10581
I
obj='Exec
pag=10
I
I
]
w=[
150
150
]
I
obj='While
pag=10
prev=O10571
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10574
fatherSonIndex=0
frm_calc='iif(Empty(riga_ope),FileLibMit.ReadLine(fhand),riga_ope)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(riga_ope))
]
h=[
19
19
]
obj='If
pag=10
prev=O10592
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExitLoop
father=O10595
fatherSonIndex=0
obj='ExitLoop
pag=10
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O10591
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O10592
fatherSonIndex=0
frm_calc='''
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgRet='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Upper(Substr(riga,331,9))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
prev=O10612
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O10614
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,257,6))))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,318,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc='_flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,923,1)='S',1,0)
len=1
name='_flgfraud
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPBeginEnd
comment='Controlla il RIFIMP o INFORM
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog))) and Empty(LRTrim(Left(riga,8)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Left(riga,8))))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono state elaborate '+LRTrim(Str(conta,10,0))+' frazionate del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=10
prev=O10642
var_op='asgn
I
nonlocal=True
obj='Var
pag=10
prev=O10639
var_op='asgn
I
obj='If
pag=10
prev=O10636
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati comuni
father=O10639
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog)))
'Empty(LRTrim(_numprog))
]
h=[
19
19
19
]
obj='If
pag=10
prev=O10646
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xraziobo
father=O10648
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=10
prev=O10653
var_op='asgn
I
obj='Write
pag=10
rd_kfield=[
'NUMPROG
]
rd_kop=[
'=
]
rd_kvar=[
'_numprog
]
wr_field=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'idcauana
'IMPIN
'IMPOUT
'INFORM
'IPCOLLEG
'MITIG
'MODSVOL
'NATURA
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPFRZ
'PROQUOTA
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'SV58550
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'IMPSARA
'SV58550MA
'NOSARA
'NUMIMP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'LRTrim(Substr(riga,10,4))
'_intercab
'_iccab
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'_colleg
'LRTrim(Substr(riga,484,16))
'LRTrim(Substr(riga,302,16))
'LRTrim(Substr(riga,190,16))
'LRTrim(Substr(riga,206,16))
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_iccit
'_intercit
'_icrag
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'_flagrap2
'cIdCau
'_totin / 100
'_totout / 100
'Substr(riga,424,30)
'Substr(riga,813,15)
'Val(Substr(riga,893,4))
'Substr(riga,414,5)
'Substr(riga,662,50)
'Substr(riga,328,3)
'''
''1'
'iif(Empty(Substr(riga,828,14)) or Substr(riga,828,14)='01010001000000',NullDateTime(),CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6)))
'_icsta
'Substr(riga,812,1)
'nProgImp
'Val(Substr(riga,898,3))
'_icprv
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
''0'
'Substr(riga,897,1)
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'Val(Substr(riga,901,19))/100
'Substr(riga,920,2)
'iif(Empty(LRTrim(Substr(riga,922,1))) or Substr(riga,922,1)='0' or Substr(riga,922,1)='N','N','S')
'_numimp
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10648
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PPFRAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPFRAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPInsert
arch='xraziobo
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xraziobo_agg
obj='Insert
pag=10
prev=O10664
rd_kfield=[
'IDBASE
'FLAGFRAUD
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
'SV58724
'SV58726SCA
'SV58726SA
'SV58726PISP
'C_COGNOME
'C_NOME
'SOSPAGAM
]
rd_kvar=[
'cOpeProg1
'_flgfraud
'Substr(riga,924,2)
'Substr(riga,926,2)
'Substr(riga,928,2)
'Substr(riga,930,2)
'Substr(riga,932,2)
'fwfn_calc_categoria(Substr(riga,924,2),Substr(riga,926,2),Substr(riga,928,2),Substr(riga,930,2),Substr(riga,932,2))
'Substr(riga,934,2)
'iif(Empty(Substr(riga,936,1)),'N',Substr(riga,936,1))
'Substr(riga,937,3)
'Substr(riga,940,3)
'Substr(riga,943,50)
'Substr(riga,993,30)
'Substr(riga,1023,1)
]
I
obj='Insert
pag=10
prev=O10663
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
'IMPIN
'IMPOUT
'MITIG
'SV58550
'PROQUOTA
'IMPSARA
'SV58550MA
'NOSARA
'NUMIMP
'VASP
]
rd_kvar=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'LRTrim(Substr(riga,10,4))
'_intercab
'_iccab
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'LRTrim(Substr(riga,484,16))
'LRTrim(Substr(riga,302,16))
'LRTrim(Substr(riga,190,16))
'LRTrim(Substr(riga,206,16))
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_iccit
'_intercit
'_icrag
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'cOpeProg1
'cIdCau
''F'+Right(cOpeProg2,9)+_idb2
'Substr(riga,424,30)
'Substr(riga,813,15)
'Substr(riga,414,5)
'Substr(riga,662,50)
'cOpeProg2
'Substr(riga,328,3)
''1'
'iif(Empty(Substr(riga,828,14)) or Substr(riga,828,14)='01010001000000',NullDateTime(),CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6)))
'_icsta
'Substr(riga,812,1)
'nProgImp
'_icprv
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
''0'
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'_colleg
'_idb2
'_totin / 100
'_totout / 100
'Val(Substr(riga,893,4))
'Substr(riga,897,1)
'Val(Substr(riga,898,3))
'Val(Substr(riga,901,19))/100
'Substr(riga,920,2)
'iif(Empty(LRTrim(Substr(riga,922,1))) or Substr(riga,922,1)='0' or Substr(riga,922,1)='N','N','S')
'_numimp
'Val(Substr(riga,1024,2))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10664
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=10
prev=O10675
I
obj='Var
obj_type='N
pag=10
prev=O10674
var_op='asgn
I
obj='Exec
pag=10
prev=O10673
I
nonlocal=True
obj='Var
obj_type='M
pag=10
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=10
prev=O10662
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O10646
fatherSonIndex=0
frm_calc=[
'Substr(riga,155,1)='S'
'Substr(riga,155,1)='E'
'Substr(riga,155,1)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,9,1)='1' or Substr(riga,9,1)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,301,1)),'0',iif(Substr(riga,301,1)='S','1',iif(Substr(riga,301,1)='N','0',Substr(riga,301,1))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,231,11))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,852,19))),0,Val(LRTrim(Substr(riga,852,19))))
len=15
name='_totin
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,871,19))),0,Val(LRTrim(Substr(riga,871,19))))
len=15
name='_totout
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge i dati dell'intermediario controparte
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,147,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
obj='Var
pag=10
prev=O10699
var_op='asgn
I
obj='Var
obj_type='D
pag=10
prev=O10697
var_op='asgn
I
obj='Begin
pag=10
prev=O10695
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O10697
fatherSonIndex=0
frm_calc='''
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=50
name='_icrag
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,18,11)))) and Len(LRTrim(Substr(riga,64,6)+Substr(riga,70,50)+Substr(riga,29,3)+Substr(riga,62,2)+Substr(riga,32,30))) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
prev=O10707
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O10708
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(_icrag),50)
len=50
name='_icrag
obj='Var
pag=10
prev=O10713
var_op='asgn
I
obj='Read
pag=10
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'Substr(riga,18,11)
]
rd_var=[
'_iccab
'_iccit
'_icprv
'_icsta
'_icrag
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10708
fatherSonIndex=1
frm_calc='Substr(riga,64,6)
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,32,30)
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,62,2)
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,29,3))
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,70,50)
len=50
name='_icrag
obj='Var
pag=10
prev=O10723
var_op='asgn
I
obj='Var
pag=10
prev=O10722
var_op='asgn
I
obj='Var
pag=10
prev=O10721
var_op='asgn
I
obj='Var
pag=10
prev=O10720
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=10
prev=O10706
var_op='asgn
I
obj='Var
pag=10
prev=O10705
var_op='asgn
I
obj='Var
pag=10
prev=O10704
var_op='asgn
I
obj='Var
pag=10
prev=O10703
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=10
prev=O10694
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O10695
fatherSonIndex=0
frm_calc='Upper(Substr(riga,511,70))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,581,3))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,584,30))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,614,6)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,620,2))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,622,35))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,657,5))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,302,16))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=10
prev=O10739
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O10742
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,120,25))))
]
h=[
19
19
]
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10747
fatherSonIndex=0
frm_calc='''
len=1
name='_tiporap
next=Icpitembatch.CPRead
arch='knarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'_tiporap='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
prev=O10753
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O10754
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=10
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10759
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=10
prev=O10770
I
obj='Read
pag=10
prev=O10769
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xntestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=10
prev=O10768
var_op='asgn
I
obj='Var
pag=10
prev=O10767
var_op='asgn
I
obj='Var
pag=10
prev=O10766
var_op='asgn
I
obj='Var
pag=10
prev=O10765
var_op='asgn
I
obj='Var
pag=10
prev=O10764
var_op='asgn
I
obj='Var
pag=10
prev=O10763
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O10754
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=10
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10778
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=10
prev=O10789
I
obj='Read
pag=10
prev=O10788
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=10
prev=O10787
var_op='asgn
I
obj='Var
pag=10
prev=O10786
var_op='asgn
I
obj='Var
pag=10
prev=O10785
var_op='asgn
I
obj='Var
pag=10
prev=O10784
var_op='asgn
I
obj='Var
pag=10
prev=O10783
var_op='asgn
I
obj='Var
pag=10
prev=O10782
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=10
prev=O10752
rd_field=[
'TIPORAP
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Substr(riga,120,25)
]
rd_var=[
'_tiporap
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O10736
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10739
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=10
prev=O10811
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,302,16)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=10
prev=O10810
var_op='asgn
I
obj='Var
pag=10
prev=O10809
var_op='asgn
I
obj='Var
pag=10
prev=O10808
var_op='asgn
I
obj='Var
pag=10
prev=O10807
var_op='asgn
I
obj='Var
pag=10
prev=O10806
var_op='asgn
I
obj='Var
pag=10
prev=O10805
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O10735
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O10736
fatherSonIndex=0
obj='Read
pag=10
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
prev=O10734
var_op='asgn
I
obj='Var
pag=10
prev=O10733
var_op='asgn
I
obj='Var
pag=10
prev=O10732
var_op='asgn
I
obj='Var
pag=10
prev=O10731
var_op='asgn
I
obj='Var
pag=10
prev=O10730
var_op='asgn
I
obj='Var
pag=10
prev=O10729
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
prev=O10693
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O10692
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O10690
var_op='asgn
I
obj='Select
pag=10
par_expr=[
'LRTrim(Substr(riga,10,4))
'Substr(riga,14,2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O10689
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10690
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
prev=O10688
var_op='asgn
I
obj='Var
pag=10
prev=O10687
var_op='asgn
I
obj='Var
pag=10
prev=O10686
var_op='asgn
I
obj='Var
pag=10
prev=O10685
var_op='asgn
I
obj='Var
pag=10
prev=O10684
var_op='asgn
I
obj='Var
obj_type='D
pag=10
prev=O10681
var_op='asgn
I
obj='Case
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10681
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10681
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10681
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10681
fatherSonIndex=3
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O10634
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10636
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=10
prev=O10847
sel_field='xraziobo->IDBASE
sel_name='xraziobo
sel_where='xraziobo->NUMPROG=_numprog
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O10848
fatherSonIndex=0
frm_calc='"E' stata cancellata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPDelete
arch='xraziobo
obj='Delete
pag=10
prev=O10852
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'xraziobo->IDBASE
]
I
nonlocal=True
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=10
prev=O10633
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O10634
fatherSonIndex=0
frm_calc=[
'Len(LRTrim(Substr(riga,331,9))) > 0
]
h=[
19
19
]
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O10861
fatherSonIndex=0
frm_calc=[
'w_norifimp='N'
]
h=[
19
19
]
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O10866
fatherSonIndex=0
frm_calc=[
'Upper(Substr(riga,331,9))='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O10871
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=10
sel_field='xraziobo->NUMPROG
sel_name='xraziobo
sel_where='xraziobo->INFORM = Substr(riga,424,30)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10876
fatherSonIndex=0
frm_calc='xraziobo->NUMPROG
len=11
name='_numprog
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O10871
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=10
sel_field='xraziobo->NUMPROG
sel_name='xraziobo
sel_where='xraziobo->RIFIMP = Substr(riga,331,9)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10883
fatherSonIndex=0
frm_calc='xraziobo->NUMPROG
len=11
name='_numprog
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
prev=O10632
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O10631
var_op='asgn
I
obj='Var
pag=10
prev=O10630
var_op='asgn
I
obj='Var
pag=10
prev=O10629
var_op='asgn
I
obj='Var
pag=10
prev=O10626
var_op='asgn
I
obj='If
pag=10
prev=O10625
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O10626
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=10
prev=O10895
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10896
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=10
prev=O10902
I
obj='Var
obj_type='N
pag=10
prev=O10901
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,318,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
prev=O10624
var_op='asgn
I
obj='Remark
pag=10
prev=O10621
I
obj='If
pag=10
prev=O10619
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10621
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,263,30))+LRTrim(Substr(riga,295,6))+LRTrim(Substr(riga,293,2))))
]
h=[
19
19
]
obj='If
pag=10
prev=O10914
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10917
fatherSonIndex=0
frm_calc='LRTrim(Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=10
prev=O10923
var_op='asgn
I
obj='Var
pag=10
prev=O10922
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O10913
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10914
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+LRTrim(_codintope) +" in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(Substr(riga,257,6))+" non è presente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=10
prev=O10929
I
obj='Var
obj_type='N
pag=10
prev=O10928
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
prev=O10912
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'Substr(riga,257,6)
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=10
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O10619
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,246,11))),_codinter,Substr(riga,246,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,263,30))),_citinter,Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,295,6))),_cabinter,Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,293,2))),_prvinter,Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=10
prev=O10941
var_op='asgn
I
obj='Var
pag=10
prev=O10940
var_op='asgn
I
obj='Var
pag=10
prev=O10939
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10614
fatherSonIndex=1
frm_calc='1
len=1
name='_frzerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(zhand,riga+" - "+_descerr)
obj='Exec
pag=10
prev=O10945
I
obj='Var
obj_type='N
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=10
prev=O10609
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10612
fatherSonIndex=0
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,190,16))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,206,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,484,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,120,25))) and _findsub = 1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,190,16))) and _findsub = 1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(DateDiff(arfn_datefchar(LRTrim(Left(riga,8))), _date_oggi)>(20*365))  and _findsub = 1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(arfn_datefchar(LRTrim(Left(riga,8)))>_date_oggi) and _findsub = 1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='CODANA+CODVOC+SEGNO
frm_calc='LRTrim(Substr(riga,10,4))+LRTrim(Substr(riga,14,2))+LRTrim(Substr(riga,159,1))
name='_tmp
next=Icpitembatch.CPIfElse
frm_calc=[
'not(mcCauana.HasKey(_tmp)) and _findsub = 1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='""
name='_tmp
obj='Var
pag=10
prev=O10977
var_op='asgn
I
obj='If
pag=10
prev=O10976
sons=[
Icpitembatch.CPItemSon
comment='Causale Analitica o Causale Sintetica o Segno
instr=Icpitembatch.CPVarDecl
father=O10977
fatherSonIndex=0
frm_calc=''Anomalia sui campi Causale Analitica e/o Causale Sintetica e/o Segno'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=10
prev=O10983
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
prev=O10973
var_op='asgn
I
obj='If
pag=10
prev=O10970
sons=[
Icpitembatch.CPItemSon
comment='Data Operazione maggiore della Data odierna
instr=Icpitembatch.CPVarDecl
father=O10973
fatherSonIndex=0
frm_calc=''Data Operazione maggiore della Data odierna'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=10
prev=O10988
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O10967
sons=[
Icpitembatch.CPItemSon
comment='Data Operazione più vecchia di 20 Anni
instr=Icpitembatch.CPVarDecl
father=O10970
fatherSonIndex=0
frm_calc=''Data Operazione più vecchia di 20 Anni'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=10
prev=O10993
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O10964
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10967
fatherSonIndex=0
frm_calc=''Codice Cliente Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=10
prev=O10998
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O10961
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O10964
fatherSonIndex=0
frm_calc=[
'not(mcRapporti.HasKey(Substr(riga,120,25)))
]
h=[
19
19
]
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O11003
fatherSonIndex=0
frm_calc=''Rapporto continuativo:'+ LRTrim(Substr(riga,120,25)) +" dell' Operazione non presente in archivio"
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=10
prev=O11008
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O10958
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10961
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=10
prev=O11015
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O11016
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto per conto del quale assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=10
prev=O11021
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
prev=O11014
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,484,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O10955
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10958
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=10
prev=O11032
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O11033
fatherSonIndex=0
frm_calc=''Anagrafica Controparte Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=10
prev=O11038
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
prev=O11031
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,302,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O10952
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10955
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=10
prev=O11049
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O11050
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto Operante Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=10
prev=O11055
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
prev=O11048
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,206,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O10951
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10952
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=10
prev=O11066
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O11067
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=10
prev=O11072
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
prev=O11065
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,190,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
prev=O10950
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O10606
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10609
fatherSonIndex=0
frm_calc='" per l'operazione con codice: "+iif(Upper(Substr(riga,331,9))='XXXXXXXXX',LRTrim(Substr(riga,424,30)),LRTrim(Substr(riga,331,9)))
name='_codintope
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10609
fatherSonIndex=1
frm_calc='" per l'operazione"
name='_codintope
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=10
prev=O10605
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xarchfraz
father=O10606
fatherSonIndex=0
obj='Insert
pag=10
rd_kfield=[
'IDPROG
'DATAOPE
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'CONNESCLI
'CONNESOPER
'CAMBIO
'NUMPROG
'TIPOOPRAP
'TIPOINTER
'CODINTER
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'CONNESBEN
'UNIQUECODE
'AGOPER
'RIFIMP
'ZCPARTE
'RAGIO
'MODSVOL
'AREAGEO
'INFORM
'AMMONT
'DURAT
'TIPO
'RRAGIO
'RCOMP
'RAREA
'RIMP
'RFREQ
'CONNALTRO
'DATAIMP
'RTIPO
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'NATURA
'SCOPO
'C_RAPPORTO
'RAPPORTBEN
'PAGASOGOP
'IPCOLLEG
'ORACOLLEG
'DUCOLLEG
'IMPIN
'IMPOUT
'TIPOORO
'MITIG
'SV58550
'PROQUOTA
'IMPSARA
'SV58550MA
]
rd_kvar=[
'conta
'Substr(riga,1,8)        
'Substr(riga,9,1)        
'LRTrim(Substr(riga,10,4))
'Substr(riga,14,2)       
'Substr(riga,16,2)       
'Substr(riga,18,11)      
'Substr(riga,29,3)       
'Substr(riga,32,30)      
'Substr(riga,62,2)       
'Substr(riga,64,6)       
'Substr(riga,70,50)      
'Substr(riga,120,25)     
'Substr(riga,145,1)      
'Substr(riga,146,1)      
'Substr(riga,147,8)      
'Substr(riga,155,1)      
'Substr(riga,156,3)      
'Substr(riga,159,1)      
'Substr(riga,160,15)     
'Substr(riga,175,15)     
'Substr(riga,190,16)     
'Substr(riga,206,16)     
'Substr(riga,222,9)      
'Substr(riga,231,11)     
'Substr(riga,242,2)      
'Substr(riga,244,2)      
'Substr(riga,246,11)     
'Substr(riga,257,6)      
'Substr(riga,263,30)     
'Substr(riga,293,2)      
'Substr(riga,295,6)      
'Substr(riga,301,1)      
'Substr(riga,302,16)     
'Substr(riga,318,10)     
'Substr(riga,328,3)      
'Substr(riga,331,9)      
'Substr(riga,340,69)     
'Substr(riga,409,5)      
'Substr(riga,414,5)      
'Substr(riga,419,5)      
'Substr(riga,424,30)     
'Substr(riga,454,5)      
'Substr(riga,459,5)      
'Substr(riga,464,5)      
'Substr(riga,469,3)      
'Substr(riga,472,3)      
'Substr(riga,475,3)      
'Substr(riga,478,3)      
'Substr(riga,481,3)      
'Substr(riga,484,16)     
'Substr(riga,500,8)      
'Substr(riga,508,3)      
'Substr(riga,511,70)     
'Substr(riga,581,3)      
'Substr(riga,584,30)     
'Substr(riga,614,6)      
'Substr(riga,620,2)      
'Substr(riga,622,35)     
'Substr(riga,657,5)      
'Substr(riga,662,50)     
'Substr(riga,712,50)     
'Substr(riga,762,25)     
'Substr(riga,787,25)     
'Substr(riga,812,1)      
'Substr(riga,813,15)     
'Substr(riga,828,14)     
'Substr(riga,842,10)     
'Val(Substr(riga,852,19)) / 100
'Val(Substr(riga,871,19)) / 100
'Substr(riga,890,3)
'Val(Substr(riga,893,4))
'Substr(riga,897,1)
'Val(Substr(riga,898,3))
'Val(Substr(riga,901,19))/100
'Substr(riga,920,2)
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
prev=O10604
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O10569
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O10571
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(gPathDoc)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
obj='Var
obj_type='N
pag=10
prev=O11098
var_op='asgn
I
obj='Var
pag=10
prev=O11097
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=10
prev=O10567
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPSelect
father=O10569
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='""
name='_tmp
obj='Var
pag=10
prev=O11109
var_op='asgn
I
obj='Select
pag=10
prev=O11107
sel_name='QBE_TBCAUANA
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O11109
fatherSonIndex=0
frm_seek='mcStringa.MCRDef
name='rwCauana
next=Icpitembatch.CPVarDecl
comment='uso come chiave la concatenazione di: causale_analitica+causale_sintetica+segno    es. "15"+"6S"+"D" = "156SD"
frm_calc='""+LRTrim(QBE_TBCAUANA->CODCAU)+LRTrim(QBE_TBCAUANA->CAUSINT)+LRTrim(QBE_TBCAUANA->SEGNO)
name='_tmp
next=Icpitembatch.CPVarDecl
frm_calc='_tmp
frm_seek='CODICE
name='rwCauana
next=Icpitembatch.CPVarDecl
frm_calc='QBE_TBCAUANA->idbase
frm_seek='ps_rowstatus
name='rwCauana
next=Icpitembatch.CPIfElse
frm_calc=[
'not(mcCauana.HasKey(_tmp))
]
h=[
19
19
]
obj='If
pag=10
prev=O11117
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='MC dei codici Causali Analitiche+Sintetiche+Segno
father=O11118
fatherSonIndex=0
frm_calc='_tmp,rwCauana 
frm_seek='AppendRowWithKey
name='mcCauana
obj='Var
obj_type='MC
pag=10
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='R
pag=10
prev=O11116
var_op='prop
I
obj='Var
obj_type='R
pag=10
prev=O11115
var_op='prop
I
obj='Var
pag=10
prev=O11114
var_op='asgn
I
obj='Var
obj_type='R
pag=10
var_op='new
I
I
]
w=[
150
150
]
I
obj='Select
pag=10
prev=O11105
sel_field='xnarapbo->RAPPORTO
sel_name='xnarapbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O11107
fatherSonIndex=0
frm_calc=[
'not(mcRapporti.HasKey(LibreriaMit.SpacePad(LRTrim(xnarapbo->RAPPORTO),25)))
]
h=[
19
19
]
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O11128
fatherSonIndex=0
frm_seek='mcStringa.MCRDef
name='rwRapporto
next=Icpitembatch.CPVarDecl
frm_calc='xnarapbo->RAPPORTO
frm_seek='CODICE
name='rwRapporto
next=Icpitembatch.CPVarDecl
comment='MC dei soli codice Rapporto
frm_calc='LibreriaMit.SpacePad(LRTrim(xnarapbo->RAPPORTO),25), rwRapporto
frm_seek='AppendRowWithKey
name='mcRapporti
obj='Var
obj_type='MC
pag=10
prev=O11134
var_op='meth
I
obj='Var
obj_type='R
pag=10
prev=O11133
var_op='prop
I
obj='Var
obj_type='R
pag=10
var_op='new
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=10
prev=O11103
sel_field='anarapbo->RAPPORTO
sel_name='anarapbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O11105
fatherSonIndex=0
frm_calc=[
'not(mcRapporti.HasKey(LibreriaMit.SpacePad(LRTrim(anarapbo->RAPPORTO),25)))
]
h=[
19
19
]
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O11140
fatherSonIndex=0
frm_seek='mcStringa.MCRDef
name='rwRapporto
next=Icpitembatch.CPVarDecl
frm_calc='anarapbo->RAPPORTO
frm_seek='CODICE
name='rwRapporto
next=Icpitembatch.CPVarDecl
comment='MC dei soli codice Rapporto
frm_calc='LibreriaMit.SpacePad(LRTrim(anarapbo->RAPPORTO),25), rwRapporto
frm_seek='AppendRowWithKey
name='mcRapporti
obj='Var
obj_type='MC
pag=10
prev=O11146
var_op='meth
I
obj='Var
obj_type='R
pag=10
prev=O11145
var_op='prop
I
obj='Var
obj_type='R
pag=10
var_op='new
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=10
sel_field='knarapbo->RAPPORTO
sel_name='knarapbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O11103
fatherSonIndex=0
frm_seek='mcStringa.MCRDef
name='rwRapporto
next=Icpitembatch.CPVarDecl
frm_calc='knarapbo->RAPPORTO
frm_seek='CODICE
name='rwRapporto
next=Icpitembatch.CPVarDecl
comment='MC dei soli codice Rapporto
frm_calc='LibreriaMit.SpacePad(LRTrim(knarapbo->RAPPORTO),25), rwRapporto
frm_seek='AppendRowWithKey
name='mcRapporti
obj='Var
obj_type='MC
pag=10
prev=O11153
var_op='meth
I
obj='Var
obj_type='R
pag=10
prev=O11152
var_op='prop
I
obj='Var
obj_type='R
pag=10
var_op='new
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=10
prev=O10566
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O10567
fatherSonIndex=0
frm_calc=[
'At("archfraz",_tabelle)=0
]
h=[
19
19
]
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O11159
fatherSonIndex=0
frm_calc='_tabelle+"archfraz,"
len=10
name='_tabelle
obj='Var
obj_type='M
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
prev=O10565
var_op='asgn
I
obj='Remark
pag=10
prev=O10563
I
obj='Begin
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Riga proveniente da operazioni
father=O10563
fatherSonIndex=0
len=10
name='riga_ope
obj='Var
obj_type='M
pag=10
pageparam=True
I
I
]
w=[
150
150
]
x=12
y=16
I
]
ManualBlocks={
'BO - Header
Icpmanualblocks.CPManualBlocks
code='import java.io.File; ﷯import java.lang.Double;﷯import java.util.*;﷯import jxl.*;﷯import java.nio.file.Files;﷯import java.nio.file.Path;﷯import java.nio.file.Paths;﷯import java.nio.charset.*;﷯﷯import java.io.FileInputStream;﷯import java.io.IOException;﷯import java.io.InputStreamReader;
name='BO - Header
I
'BO - Properties
Icpmanualblocks.CPManualBlocks
code='public String[] lista;﷯public int conteggio;﷯public int i;﷯public int _i;﷯public int _y;﷯public int contanome;﷯public int _righe;﷯public int _conta;﷯public Path path;﷯// These are the files to include in the ZIP file﷯Vector filenames = new Vector();﷯Vector fileonames = new Vector();
name='BO - Properties
I
}
comment='Importa i dati (Standard)
date_creat=#2006-06-20
date_rev=#2024-05-09
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'Utilities
'FileLibMit
'LibreriaMit
]
merge=True
modcnt=1189
page_result_class=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
page_result_type=[
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
]
page_uid=[
'AHVZNXKOOX
'UKNWCURIZP
'VVERNPVGUJ
'NJDAPTIXHB
'NFQSTSMLAX
'RCTYUXDSQE
'CWXSSFAJKR
'VNWRBRKHOR
'LXYVCNDGXJ
'KBUDYHROVZ
'LYNZFJMARF
'BCDDIGVWEI
'NUVUGANGKH
'BCDBVDAIGN
'YWNGYQEOIM
'ODNUMZRUDM
'UQWVLYOUPO
'XYQTYCJDVF
'WPSSXVVPRN
'LCTYRIXNIR
'QFVUWDOVQJ
'EHJFKSDXAO
'KQLYCRCEND
'VWJMLMOSBD
'CRYCRJTMVP
'WXKLUXETTU
'TQQWCTNMUY
'WFXJLTAYZL
'JUYFDWZDHT
'FPPFVQERKU
'DHMUHURINX
'WYHNUACAYF
'DUMJTRBFGI
'RECUSIAFWL
'FOQQGPLWGB
'LBCELHVYJS
'QIPRKRDCMO
'GIQREITNVH
'JBOYCPPZUI
'TEKDKQDIEN
'JDJFXRYRYA
'KJQXTVBEBH
'AZXJBTPLZE
'VJCKXTRHLA
'YUDNXDAEAB
'FPHKEVHHVS
]
pagename=[
'Page_1
'Page_2
'Page_3
'Page_4
'Page_5
'Page_6
'Page_7
'Page_8
'Page_9
'Page_10
'Page_11
'Page_12
'Page_13
'Page_14
'Page_15
'Page_16
'Page_17
'Page_18
'Page_19
'Page_20
'Page_21
'Page_22
'Page_23
'Page_24
'Page_25
'Page_26
'Page_27
'Page_28
'Page_29
'Page_30
'Page_31
'Page_32
'Page_33
'Page_34
'Page_35
'Page_36
'Page_37
'Page_38
'Page_39
'Page_40
'Page_41
'Page_42
'Page_43
'Page_44
'Find_Charset
'page_46
]
pagenote=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
pagetitle=[
'Main
'Soggetti
'Rapporti
'Informazioni
'Operazioni
'Frazionate
'Rapporti Provvisorio
'Informazioni Provvisorio
'Operazioni Provvisorio
'Frazionate Provvisorio
'Rapporti Agenzia Entrate
'Informazioni Agenzia Entrate
'Operazioni Agenzia Entrate
'Dipendenze
'Titolari Effettivi
'Operazioni extraconto
'Procuratori/delegati su rapporto
'Soggetti operanti
'Intestatari
'Procuratori/delegati su rapporto Provvisorio
'Soggetti operanti Provvisorio
'Intestatari Provvisorio
'Procuratori/delegati su rapporto Agenzia Entrate
'Soggetti operanti Agenzia Entrate
'Intestatari Agenzia Entrate
'Altri Intestatari Operazioni
'Inserisce priorità sui nomi file
'Altri Beneficiari Operazioni
'Altri Soggetti Operanti Operazioni
'Modifiche Soggetti
'Importo Netto Operazioni
'Controllo Anagrafiche
'Saldi Operazioni Extraconto
'Saldi Rapporti Continuativi
'Altri Titolari Effettivi
'Crea il file Zip
'Operazioni Definitive XLS
'Operazioni Provvisorie XLS
'Estrai zip
'Titolari AGE
'Altri Titolari AGE
'SALDI SV
'Rapporti Collegati
'Personbo XLS
'Verifica Charset File di Input
'FIle per OAM
]
result_type='N
runtime_filters=2
tpl_name='Function
work_file=[
'aeannora
'aeopcanc
'aeoprig
'aeopstor
'aetesta
'anadip
'anarapbo
'beneficfrz
'beneficope
'clientifrz
'clientiope
'cpwarn
'delegabo
'fiduciabo
'fraziobo
'fraziobo_agg
'inter2bo
'intermbo
'intestbo
'intestit
'japopebo
'japotit
'jelegabo
'jnarapbo
'jntestbo
'jntestit
'joginfo
'jogopebo
'jperazbo
'knarapbo
'meneficfrz
'meneficope
'merzistifrz
'merzistiope
'mlientifrz
'mlientiope
'mogopebo
'mogopefbo
'operazbo
'operazbo_agg
'opextrbo
'personbo
'personbo_agg
'rapcoll
'rapopebo
'rapotit
'saldi_idp
'soginfo
'sogopebo
'sogopefbo
'storico_import
'tbcauana
'tbcitta
'tbstgru
'tbvalute
'terzistifrz
'terzistiope
'titolabo
'titopers
'tmp_errimp
'tmp_list_imprich
'tmp_listafile
'wersonbo
'xapcoll
'xapopebo
'xapotit
'xarchfraz
'xarchope
'xelegabo
'xeneficfrz
'xeneficope
'xersonbo
'xerzistifrz
'xerzistiope
'xiduciabo
'xlientifrz
'xlientiope
'xnadip
'xnarapbo
'xntestbo
'xntestit
'xoginfo
'xogopebo
'xogopefbo
'xperazbo
'xperazbo_agg
'xraziobo
'xraziobo_agg
'tbmacage
'ageresleg
'dippreposti
'wersonbo_agg
]
work_filter=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
I
*--*
*----*
