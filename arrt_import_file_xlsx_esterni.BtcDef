* --- CodePainter Revolution Batch Vers. 5.1
￼Icpbatch.CPBatch
Items=[
Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel
frm_calc='0
len=9
name='riga_letta
next=Icpitembatch.CPVarDecl
comment='data di base Excel
frm_calc='CharToDate('31/12/1899')
len=8
name='date_base_excel
next=Icpitembatch.CPBeginEnd
comment='Apro il foglio //e verifico quante pagine ha
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Creo file per risultati
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='//Azzero i contatori di fogli letti e righe scritte﷯_i = 0;﷯r=0;﷯//Creo il record da scrivere﷯row2 = (XSSFRow) sheet2.createRow(r);﷯//scrivo la riga di intestazione﷯cell2 = (XSSFCell) row2.createCell(0);﷯cell2.setCellValue("Intestatario");﷯cell2 = (XSSFCell) row2.createCell(1);﷯cell2.setCellValue("Connes");﷯cell2 = (XSSFCell) row2.createCell(2);﷯cell2.setCellValue("cf reale");﷯cell2 = (XSSFCell) row2.createCell(3);﷯cell2.setCellValue("Cognome");﷯cell2 = (XSSFCell) row2.createCell(4);﷯cell2.setCellValue("Nome");﷯cell2 = (XSSFCell) row2.createCell(5);﷯cell2.setCellValue("Sesso");﷯cell2 = (XSSFCell) row2.createCell(6);﷯cell2.setCellValue("Data di nascita");﷯cell2 = (XSSFCell) row2.createCell(7);﷯cell2.setCellValue("Comune di nacita");﷯cell2 = (XSSFCell) row2.createCell(8);﷯cell2.setCellValue("stato di nascita");﷯cell2 = (XSSFCell) row2.createCell(9);﷯cell2.setCellValue("Provincia di nascita");﷯cell2 = (XSSFCell) row2.createCell(10);﷯cell2.setCellValue("Provincia di nascita bis");﷯cell2 = (XSSFCell) row2.createCell(11);﷯cell2.setCellValue("CF Estero");﷯cell2 = (XSSFCell) row2.createCell(12);﷯cell2.setCellValue("New connes");﷯cell2 = (XSSFCell) row2.createCell(13);﷯cell2.setCellValue("Note");﷯cell2 = (XSSFCell) row2.createCell(14);﷯cell2.setCellValue("Riga");﷯r++;
next=Icpitembatch.CPVarDecl
comment='ok alla commit
frm_calc='True
len=1
name='_commit
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='//Ridimensiono le colonne in base al contenuto﷯sheet2.autoSizeColumn(0);﷯sheet2.autoSizeColumn(1);﷯sheet2.autoSizeColumn(2);﷯sheet2.autoSizeColumn(3);﷯sheet2.autoSizeColumn(4);﷯sheet2.autoSizeColumn(5);﷯sheet2.autoSizeColumn(6);﷯sheet2.autoSizeColumn(7);﷯sheet2.autoSizeColumn(8);﷯sheet2.autoSizeColumn(9);﷯sheet2.autoSizeColumn(10);﷯sheet2.autoSizeColumn(11);﷯sheet2.autoSizeColumn(12);﷯sheet2.autoSizeColumn(13);﷯sheet2.autoSizeColumn(14);
next=Icpitembatch.CPExec
check='man
frm_calc='// scrivo il file di esito﷯FileOutputStream fileOut = new FileOutputStream(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(gAzienda)+'/'+CPLib.LRTrim(nomefileoutput));﷯﷯//write this workbook to an Outputstream.﷯wb2.write(fileOut);﷯fileOut.flush();﷯fileOut.close();
obj='Exec
pag=2
prev=O16
I
obj='Exec
pag=2
prev=O14
I
obj='Try
pag=2
prev=O13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWhile
father=O14
fatherSonIndex=0
frm_calc='_i < conta
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_commit
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O20
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O22
fatherSonIndex=0
frm_calc='commit
obj='Transaction
pag=2
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O22
fatherSonIndex=1
frm_calc='transaction error
frm_seek='errore xlsx
obj='Transaction
pag=2
I
I
]
w=[
150
150
150
]
I
obj='While
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O20
fatherSonIndex=0
frm_calc='//Apro uno ad uno i fogli del file Excel﷯XSSFSheet sheet = wb.getSheetAt(_i);﷯//Mi definisco un oggetto che contiene tutte le righe﷯Iterator rows = sheet.rowIterator();﷯//_righe = sheet.getLastRowNum()+1;﷯//_y = 1;
next=Icpitembatch.CPWhile
frm_calc='rows.hasNext() and _commit
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=2
prev=O34
I
obj='While
pag=2
prev=O33
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O34
fatherSonIndex=0
frm_calc='//scorro le righe﷯row=(XSSFRow) rows.next();﷯//Mi definisco un oggetto che contiene tutte le celle della riga letta﷯Iterator cells = row.cellIterator();
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='cell_count
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel
frm_calc='riga_letta+1
len=9
name='riga_letta
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='''
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='ok alla modifica dei dati
frm_calc='True
len=1
name='modifica
next=Icpitembatch.CPWhile
frm_calc='cells.hasNext() and riga_letta>1
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'riga_letta>1
]
h=[
19
19
]
obj='If
pag=2
prev=O44
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O46
fatherSonIndex=0
frm_calc='Str(riga_letta,9,0)
len=9
name='riga_letta_c
next=Icpitembatch.CPExec
check='man
frm_calc='//Creo il record da scrivere﷯row2 = (XSSFRow) sheet2.createRow(r);﷯cell2 = (XSSFCell) row2.createCell(0);﷯cell2.setCellValue(CPLib.LRTrim(column01));﷯cell2 = (XSSFCell) row2.createCell(1);﷯cell2.setCellValue(CPLib.LRTrim(column02));﷯cell2 = (XSSFCell) row2.createCell(2);﷯cell2.setCellValue(CPLib.LRTrim(column03));﷯cell2 = (XSSFCell) row2.createCell(3);﷯cell2.setCellValue(CPLib.LRTrim(column04));﷯cell2 = (XSSFCell) row2.createCell(4);﷯cell2.setCellValue(CPLib.LRTrim(column05));﷯cell2 = (XSSFCell) row2.createCell(5);﷯cell2.setCellValue(CPLib.LRTrim(column06));﷯cell2 = (XSSFCell) row2.createCell(6);﷯cell2.setCellValue(CPLib.LRTrim(column07));﷯cell2 = (XSSFCell) row2.createCell(7);﷯cell2.setCellValue(CPLib.LRTrim(column08));﷯cell2 = (XSSFCell) row2.createCell(8);﷯cell2.setCellValue(CPLib.LRTrim(column09));﷯cell2 = (XSSFCell) row2.createCell(9);﷯cell2.setCellValue(CPLib.LRTrim(column10));﷯cell2 = (XSSFCell) row2.createCell(10);﷯cell2.setCellValue(CPLib.LRTrim(column11));﷯cell2 = (XSSFCell) row2.createCell(11);﷯cell2.setCellValue(CPLib.LRTrim(column12));﷯cell2 = (XSSFCell) row2.createCell(12);﷯cell2.setCellValue(CPLib.LRTrim(column13));﷯cell2 = (XSSFCell) row2.createCell(13);﷯cell2.setCellValue(CPLib.LRTrim(nota));﷯cell2 = (XSSFCell) row2.createCell(14);﷯cell2.setCellValue(CPLib.LRTrim(riga_letta_c));﷯r++;
obj='Exec
pag=2
prev=O51
I
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='While
pag=2
prev=O43
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O44
fatherSonIndex=0
frm_calc='//scorro le celle della riga﷯cell=(XSSFCell) cells.next();
next=Icpitembatch.CPVarDecl
frm_calc='cell_count+1
len=9
name='cell_count
next=Icpitembatch.CPVarDecl
frm_calc='cell.getCellType().ordinal()
len=1
name='cell_type
next=Icpitembatch.CPCase
frm_calc=[
'cell_type=1
'cell_type=2
'cell_type=0
'cell_type=3
]
h=[
19
19
19
19
19
19
]
haselse=True
obj='Case
pag=2
prev=O58
sons=[
Icpitembatch.CPItemSon
comment='Tipo Numerico
instr=Icpitembatch.CPRemark
father=O59
fatherSonIndex=0
frm_calc='tipo numerico﷯da definire il comportamento
next=Icpitembatch.CPCase
frm_calc=[
'cell_count=6
'cell_count=7
'cell_count=12
]
h=[
19
19
19
19
19
]
haselse=True
obj='Case
pag=2
prev=O64
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O65
fatherSonIndex=0
frm_calc='cell.getNumericCellValue()
len=1
name='column06num
next=Icpitembatch.CPVarDecl
frm_calc='Str(column06num,1,0)
len=25
name='column06
obj='Var
pag=2
pagelocal=True
prev=O70
var_op='asgn
I
obj='Var
obj_type='N
pag=2
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O65
fatherSonIndex=1
frm_calc='Quando la leggeva come numero
next=Icpitembatch.CPVarDecl
frm_calc='cell.getNumericCellValue()
len=99
name='column07num
next=Icpitembatch.CPVarDecl
comment='data di nascita
frm_calc='sdf.format(cell.getDateCellValue())
len=25
name='column07
obj='Var
pag=2
pagelocal=True
prev=O74
var_op='asgn
I
obj='Var
obj_type='N
pag=2
pagelocal=True
prev=O73
var_op='asgn
I
obj='Remark
pag=2
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='cfestero numerico
father=O65
fatherSonIndex=2
frm_calc='cell.getNumericCellValue()
len=1
name='column12num
next=Icpitembatch.CPVarDecl
comment='cfestero
frm_calc='Str(column12num,1,0)
len=1
name='column12
obj='Var
pag=2
pagelocal=True
prev=O77
var_op='asgn
I
obj='Var
obj_type='N
pag=2
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O65
fatherSonIndex=3
frm_calc='iif(Empty(nota),'Valore numerico alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Valore numerico alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='ok alla commit
frm_calc='False
len=1
name='_commit
obj='Var
obj_type='L
pag=2
pagelocal=True
prev=O80
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Remark
pag=2
I
I
Icpitembatch.CPItemSon
comment='Tipo stringa
instr=Icpitembatch.CPCase
father=O59
fatherSonIndex=1
frm_calc=[
'cell_count=1
'cell_count=2
'cell_count=3
'cell_count=4
'cell_count=5
'cell_count=6
'cell_count=7
'cell_count=8
'cell_count=9
'cell_count=10
'cell_count=11
'cell_count=12
'cell_count=13
]
h=[
19
19
19
19
19
19
19
19
19
19
19
19
19
19
]
obj='Case
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='ragsoc
father=O84
fatherSonIndex=0
frm_calc='cell.getStringCellValue()
len=25
name='column01
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='connes
father=O84
fatherSonIndex=1
frm_calc='cell.getStringCellValue()
len=25
name='column02
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='CF
father=O84
fatherSonIndex=2
frm_calc='cell.getStringCellValue()
len=25
name='column03
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Cognome
father=O84
fatherSonIndex=3
frm_calc='cell.getStringCellValue()
len=25
name='column04
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nome
father=O84
fatherSonIndex=4
frm_calc='cell.getStringCellValue()
len=25
name='column05
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='sesso
father=O84
fatherSonIndex=5
frm_calc='cell.getStringCellValue()
len=25
name='column06
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='data di nascita
father=O84
fatherSonIndex=6
frm_calc='cell.getStringCellValue()
len=25
name='column07
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='comune di nascita
father=O84
fatherSonIndex=7
frm_calc='cell.getStringCellValue()
len=30
name='column08
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nazione di nascita
father=O84
fatherSonIndex=8
frm_calc='cell.getStringCellValue()
len=30
name='column09
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='provincia di nascita
father=O84
fatherSonIndex=9
frm_calc='cell.getStringCellValue()
len=2
name='column10
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='provincia di nascita
father=O84
fatherSonIndex=10
frm_calc='cell.getStringCellValue()
len=2
name='column11
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='cfestero
father=O84
fatherSonIndex=11
frm_calc='cell.getStringCellValue()
len=1
name='column12
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='new connes
father=O84
fatherSonIndex=12
frm_calc='cell.getStringCellValue()
len=16
name='column13
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column02)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O113
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O114
fatherSonIndex=0
frm_calc=[
'modifica
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O119
fatherSonIndex=0
frm_calc=[
'LRTrim(column02)=LRTrim(column13)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
expected_rows=1
father=O124
fatherSonIndex=0
h=[
19
19
19
]
obj='Select
pag=2
sel_name='personbo
sel_where='personbo->CONNES=LTrim(column02)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='fallimento scrittura dati
father=O129
fatherSonIndex=0
frm_calc='False
len=1
name='_falied
next=Icpitembatch.CPCase
frm_calc=[
'Empty(column10) and Empty(column11)
'Empty(column10) and not(Empty(column11))
'not(Empty(column10)) and not(Empty(column11))
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPWrite
arch='personbo
expected_rows=1
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_falied
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O137
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O139
fatherSonIndex=0
frm_calc='iif(Empty(nota),'Soggetto trovato. Errore nella modifica',nota+' soggetto trovato. Errore nella modifica')
len=100
name='nota
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O139
fatherSonIndex=1
frm_calc='iif(Empty(nota),'Soggetto trovato e modificato',nota+' soggetto trovato e modificato')
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='nota+'. '+iif(LRTrim(column02)<>LRTrim(column03),'Codici fiscali diversi','Codici fiscali uguali')
len=100
name='nota
obj='Var
pag=2
prev=O146
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Write
pag=2
prev=O134
rd_kfield=[
'CONNES
'CODFISC
]
rd_kop=[
'=
'=
]
rd_kvar=[
'personbo->CONNES
'personbo->CODFISC
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='fallimento scrittura dati
father=O137
fatherSonIndex=0
frm_calc='True
len=1
name='_falied
obj='Var
obj_type='L
pag=2
pagelocal=True
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'RAGSOC
'CODFISC
'COGNOME
'NOME
'SESSO
'NASCOMUN
'NASSTATO
'TIPINTER
'CFESTERO
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'column01
'iif(column03='CFESTERO',personbo->CODFISC,LRTrim(column03))
'LRTrim(column04)
'LRTrim(column05)
'iif(LRTrim(column06)='M','1',iif(LRTrim(column06)='F','2',LRTrim(column06)))
'iif(LRTrim(column08)='NOCOMU',personbo->NASCOMUN,LRTrim(column08))
'iif(LRTrim(column09)='NOSTATO',personbo->NASSTATO,LRTrim(column09))
'LRTrim(column10)
'iif(column12='1',1,0)
]
I
obj='Case
pag=2
prev=O133
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O134
fatherSonIndex=0
frm_calc=[
'Empty(column08)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='provincia di nascita
father=O161
fatherSonIndex=0
frm_calc=''EE'
len=2
name='column10
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O161
fatherSonIndex=1
frm_calc='iif(Empty(nota),'Provincia di nascita non valorizzata',nota+' provincia di nascita non valorizzata')
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='ok alla commit
frm_calc='False
len=1
name='_commit
obj='Var
obj_type='L
pag=2
pagelocal=True
prev=O168
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='provincia di nascita
father=O134
fatherSonIndex=1
frm_calc='column11
len=2
name='column10
next=Icpitembatch.CPVarDecl
comment='provincia di nascita
frm_calc='''
len=2
name='column11
obj='Var
pag=2
pagelocal=True
prev=O172
var_op='asgn
I
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O134
fatherSonIndex=2
frm_calc='iif(Empty(nota),'Provincia di nascita valorizzata in entrambi i campi',nota+' provincia di nascita valorizzata in entrambi i campi')
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='ok alla commit
frm_calc='False
len=1
name='_commit
obj='Var
obj_type='L
pag=2
pagelocal=True
prev=O175
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O134
fatherSonIndex=3
frm_calc=[
'Empty(column10)
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O178
fatherSonIndex=0
frm_calc='iif(Empty(nota),'Provincia di nascita non regolare',nota+' provincia di nascita non regolare')
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='ok alla commit
frm_calc='False
len=1
name='_commit
obj='Var
obj_type='L
pag=2
pagelocal=True
prev=O183
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
150
150
]
I
obj='Var
obj_type='L
pag=2
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O129
fatherSonIndex=1
frm_calc='iif(Empty(nota),'Soggetto ricercato non trovato in anagrafica',nota+' soggetto ricercato non trovato in anagrafica')
len=100
name='nota
obj='Var
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O124
fatherSonIndex=1
frm_calc='iif(Empty(nota),'Soggetto Eliminato  per accorpamento.',nota+' Soggetto Eliminato per accorpamento.')
len=100
name='nota
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Page_3(LRTrim(column02),LRTrim(column13),False))
]
h=[
19
19
]
obj='If
pag=2
prev=O191
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='ok alla commit
father=O192
fatherSonIndex=0
frm_calc='False
len=1
name='_commit
obj='Var
obj_type='L
pag=2
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O114
fatherSonIndex=1
frm_calc='iif(Empty(nota),'Connes vuoto',nota+' Connes vuoto')
len=100
name='nota
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
150
150
150
150
150
150
150
150
150
150
150
]
I
I
Icpitembatch.CPItemSon
comment='tipo booleano sbagliato﷯tipo formula il 4 è booleano
instr=Icpitembatch.CPRemark
father=O59
fatherSonIndex=2
frm_calc='tipo buleano﷯da definire il comportamento﷯non è booleanao è tipo formula da vedere
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'Valore buleano alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Valore buleano alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='ok alla commit
frm_calc='False
len=1
name='_commit
obj='Var
obj_type='L
pag=2
pagelocal=True
prev=O207
var_op='asgn
I
obj='Var
pag=2
prev=O206
var_op='asgn
I
obj='Remark
pag=2
I
I
Icpitembatch.CPItemSon
comment='Tipo vuoto
instr=Icpitembatch.CPCase
father=O59
fatherSonIndex=3
frm_calc=[
'cell_count=3
'cell_count=8
'cell_count=9
'cell_count=10
'cell_count=11
]
h=[
19
19
19
19
19
19
19
]
haselse=True
obj='Case
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='CF
father=O210
fatherSonIndex=0
frm_calc=''CFESTERO'
len=25
name='column03
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (CF vuoto)',nota+' Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (CF vuoto)')
len=100
name='nota
obj='Var
pag=2
prev=O215
var_op='asgn
I
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='comune di nascita
father=O210
fatherSonIndex=1
frm_calc=''NOCOMU'
len=30
name='column08
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (comune vuoto)',nota+' Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (comune vuoto)')
len=100
name='nota
obj='Var
pag=2
prev=O218
var_op='asgn
I
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nazione di nascita
father=O210
fatherSonIndex=2
frm_calc=''NOSTATO'
len=30
name='column09
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (stato vuoto)',nota+' Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (stato vuoto)')
len=100
name='nota
obj='Var
pag=2
prev=O221
var_op='asgn
I
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='provincia di nascita
father=O210
fatherSonIndex=3
frm_calc='''
len=2
name='column10
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='provincia di nascita
father=O210
fatherSonIndex=4
frm_calc='''
len=2
name='column11
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O210
fatherSonIndex=5
frm_calc='iif(Empty(nota),'Valore vuoto alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Valore vuoto alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
next=Icpitembatch.CPIfElse
frm_calc=[
'cell_count<14
]
h=[
19
19
]
obj='If
pag=2
prev=O228
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='ok alla commit
father=O229
fatherSonIndex=0
frm_calc='False
len=1
name='_commit
obj='Var
obj_type='L
pag=2
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
150
150
150
150
]
I
I
Icpitembatch.CPItemSon
comment='tipo non supportato
instr=Icpitembatch.CPIfElse
father=O59
fatherSonIndex=4
frm_calc=[
'cell_count=3
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O238
fatherSonIndex=0
frm_calc=''CFESTERO'
len=25
name='column03
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' Rimessa spunta cfestero',nota+' Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' Rimessa spunta cfestero')
len=100
name='nota
obj='Var
pag=2
prev=O243
var_op='asgn
I
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O238
fatherSonIndex=1
frm_calc='iif(Empty(nota),'Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='ok alla commit
frm_calc='False
len=1
name='_commit
obj='Var
obj_type='L
pag=2
pagelocal=True
prev=O246
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
150
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O57
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O56
var_op='asgn
I
obj='Exec
pag=2
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='L
pag=2
prev=O42
var_op='asgn
I
obj='Var
pag=2
prev=O41
var_op='asgn
I
obj='Var
obj_type='N
pag=2
pagelocal=True
prev=O40
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O39
var_op='asgn
I
obj='Exec
pag=2
I
I
]
w=[
150
150
]
I
obj='Exec
pag=2
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O14
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=2
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=2
prev=O12
I
obj='Var
obj_type='L
pag=2
pagelocal=True
prev=O11
var_op='asgn
I
obj='Exec
pag=2
prev=O9
I
obj='Begin
pag=2
prev=O7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O9
fatherSonIndex=0
frm_calc='// creo il contenitore dei fogli﷯XSSFWorkbook wb2 = new XSSFWorkbook();﷯XSSFSheet sheet2 = wb2.createSheet(sheetName) ;
obj='Exec
pag=2
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O7
fatherSonIndex=0
frm_calc='//base﷯InputStream ExcelFileToRead = new FileInputStream(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(gAzienda)+'/'+CPLib.LRTrim(nomefile));﷯XSSFWorkbook  wb = new XSSFWorkbook(ExcelFileToRead);﷯﷯conta = wb.getNumberOfSheets();﷯﷯//XSSFWorkbook test = new XSSFWorkbook(); ﷯﷯//XSSFSheet sheet = wb.getSheetAt(0);﷯XSSFRow row; ﷯XSSFCell cell;﷯﷯XSSFRow row2; ﷯XSSFCell cell2;﷯﷯//Iterator rows = sheet.rowIterator();
obj='Exec
pag=2
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='D
pag=2
pagelocal=True
prev=O5
var_op='asgn
I
obj='Var
obj_type='N
pag=2
pagelocal=True
prev=O3
var_op='asgn
I
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='ragsoc
father=O3
fatherSonIndex=0
len=25
name='column01
next=Icpitembatch.CPVarDecl
comment='connes
len=25
name='column02
next=Icpitembatch.CPVarDecl
comment='CF
len=25
name='column03
next=Icpitembatch.CPVarDecl
comment='Cognome
len=25
name='column04
next=Icpitembatch.CPVarDecl
comment='nome
len=25
name='column05
next=Icpitembatch.CPVarDecl
comment='sesso
len=25
name='column06
next=Icpitembatch.CPVarDecl
comment='sesso numerico
len=1
name='column06num
next=Icpitembatch.CPVarDecl
comment='data di nascita
len=25
name='column07
next=Icpitembatch.CPVarDecl
comment='data di nascita numerico
len=99
name='column07num
next=Icpitembatch.CPVarDecl
comment='data di nascita data
len=8
name='column07date
next=Icpitembatch.CPVarDecl
comment='comune di nascita
len=30
name='column08
next=Icpitembatch.CPVarDecl
comment='nazione di nascita
len=30
name='column09
next=Icpitembatch.CPVarDecl
comment='provincia di nascita
len=2
name='column10
next=Icpitembatch.CPVarDecl
comment='provincia di nascita
len=2
name='column11
next=Icpitembatch.CPVarDecl
comment='cfestero
len=1
name='column12
next=Icpitembatch.CPVarDecl
comment='cfestero numerico
len=1
name='column12num
next=Icpitembatch.CPVarDecl
comment='new connes
len=16
name='column13
next=Icpitembatch.CPVarDecl
comment='ok alla commit
len=1
name='_commit
next=Icpitembatch.CPVarDecl
comment='fallimento scrittura dati
len=1
name='_falied
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel
len=9
name='riga_letta
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel Character
len=9
name='riga_letta_c
next=Icpitembatch.CPVarDecl
comment='data di base Excel
len=8
name='date_base_excel
obj='Var
obj_type='D
pag=2
pagelocal=True
prev=O286
I
obj='Var
pag=2
pagelocal=True
prev=O285
I
obj='Var
obj_type='N
pag=2
pagelocal=True
prev=O284
I
obj='Var
obj_type='L
pag=2
pagelocal=True
prev=O283
I
obj='Var
obj_type='L
pag=2
pagelocal=True
prev=O282
I
obj='Var
pag=2
pagelocal=True
prev=O281
I
obj='Var
obj_type='N
pag=2
pagelocal=True
prev=O280
I
obj='Var
pag=2
pagelocal=True
prev=O279
I
obj='Var
pag=2
pagelocal=True
prev=O278
I
obj='Var
pag=2
pagelocal=True
prev=O277
I
obj='Var
pag=2
pagelocal=True
prev=O276
I
obj='Var
pag=2
pagelocal=True
prev=O275
I
obj='Var
obj_type='D
pag=2
pagelocal=True
prev=O274
I
obj='Var
obj_type='N
pag=2
pagelocal=True
prev=O273
I
obj='Var
pag=2
pagelocal=True
prev=O272
I
obj='Var
obj_type='N
pag=2
pagelocal=True
prev=O271
I
obj='Var
pag=2
pagelocal=True
prev=O270
I
obj='Var
pag=2
pagelocal=True
prev=O269
I
obj='Var
pag=2
pagelocal=True
prev=O268
I
obj='Var
pag=2
pagelocal=True
prev=O267
I
obj='Var
pag=2
pagelocal=True
prev=O266
I
obj='Var
pag=2
pagelocal=True
I
I
]
w=[
150
150
]
x=15
y=12
I
Icpitembatch.CPRemark
frm_calc='Salto l'intestazione
next=Icpitembatch.CPExec
check='man
frm_calc='//scorro le righe﷯row=(XSSFRow) rows.next();
obj='Exec
pag=2
prev=O289
I
obj='Remark
pag=2
x=589
y=1960
I
Icpitembatch.CPBeginEnd
comment='Dichiarazione parametri
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili locali
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Dichiarazione variabili globali
next=Icpitembatch.CPRemark
frm_calc='Verifica se il nuovo codice esiste già
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Inizio Aggiornamento Soggetto e relativi collegamenti'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='connes del soggetto
frm_calc='''
len=16
name='_connes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'flag_modifica
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Aggiorna operazbo'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='operazbo
next=Icpitembatch.CPWrite
arch='operazbo
next=Icpitembatch.CPWrite
arch='operazbo
next=Icpitembatch.CPWrite
arch='operazbo
next=Icpitembatch.CPWrite
arch='clientiope
next=Icpitembatch.CPWrite
arch='beneficope
next=Icpitembatch.CPWrite
arch='sogopebo
next=Icpitembatch.CPWrite
arch='terzistiope
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Aggiorna fraziobo'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='fraziobo
next=Icpitembatch.CPWrite
arch='fraziobo
next=Icpitembatch.CPWrite
arch='fraziobo
next=Icpitembatch.CPWrite
arch='fraziobo
next=Icpitembatch.CPWrite
arch='clientifrz
next=Icpitembatch.CPWrite
arch='beneficfrz
next=Icpitembatch.CPWrite
arch='sogopefbo
next=Icpitembatch.CPWrite
arch='terzistifrz
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Aggiorna xperazbo'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='xperazbo
next=Icpitembatch.CPWrite
arch='xperazbo
next=Icpitembatch.CPWrite
arch='xperazbo
next=Icpitembatch.CPWrite
arch='xperazbo
next=Icpitembatch.CPWrite
arch='xlientiope
next=Icpitembatch.CPWrite
arch='xeneficope
next=Icpitembatch.CPWrite
arch='xogopebo
next=Icpitembatch.CPWrite
arch='xerzistiope
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Aggiorna xraziobo'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='xraziobo
next=Icpitembatch.CPWrite
arch='xraziobo
next=Icpitembatch.CPWrite
arch='xraziobo
next=Icpitembatch.CPWrite
arch='xraziobo
next=Icpitembatch.CPWrite
arch='xlientifrz
next=Icpitembatch.CPWrite
arch='xeneficfrz
next=Icpitembatch.CPWrite
arch='xogopefbo
next=Icpitembatch.CPWrite
arch='xerzistifrz
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Aggiorna rapporti AUI'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='intestbo
next=Icpitembatch.CPWrite
arch='delegabo
next=Icpitembatch.CPWrite
arch='rapopebo
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Aggiorna rapporti provvisori'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='xntestbo
next=Icpitembatch.CPWrite
arch='xelegabo
next=Icpitembatch.CPWrite
arch='xapopebo
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Aggiorna Titolari AUI'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='rapotit
next=Icpitembatch.CPWrite
arch='rapotit
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Aggiorna Titolari provvisori'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='xapotit
next=Icpitembatch.CPWrite
arch='xapotit
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Aggiorna AGE'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='jntestbo
next=Icpitembatch.CPWrite
arch='jelegabo
next=Icpitembatch.CPWrite
arch='japopebo
next=Icpitembatch.CPWrite
arch='jperazbo
next=Icpitembatch.CPWrite
arch='jperazbo
next=Icpitembatch.CPWrite
arch='jperazbo
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Aggiorna Operazioni Società Quotate'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='kperazbo
next=Icpitembatch.CPWrite
arch='kperazbo
next=Icpitembatch.CPWrite
arch='kperazbo
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Aggiorna aerighe'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='aerighe
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Aggiorna aeoprig'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='aeoprig
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Aggiorna aederig'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='aederig
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Cancella vecchia scheda'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPDelete
arch='opextrbo
next=Icpitembatch.CPDelete
arch='personbo
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Elaborazione completata'
global=True
len=120
name='gMsgImp
next=Ispitembatch.CPReturn
frm_calc='True 
obj='Return
pag=3
page_return=True
prev=O373
I
nonlocal=True
obj='Var
pag=3
prev=O372
var_op='asgn
I
obj='Delete
pag=3
prev=O371
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
I
obj='Delete
pag=3
prev=O370
rd_kfield=[
'COLLEG
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
I
nonlocal=True
obj='Var
pag=3
prev=O369
var_op='asgn
I
obj='Write
pag=3
prev=O368
rd_kfield=[
'CONNESINT
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESINT
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
nonlocal=True
obj='Var
pag=3
prev=O367
var_op='asgn
I
obj='Write
pag=3
prev=O366
rd_kfield=[
'CONNESINT
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESINT
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
nonlocal=True
obj='Var
pag=3
prev=O365
var_op='asgn
I
obj='Write
pag=3
prev=O364
rd_kfield=[
'CONNESINT
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESINT
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
nonlocal=True
obj='Var
pag=3
prev=O363
var_op='asgn
I
obj='Write
pag=3
prev=O362
rd_kfield=[
'CONNESBEN
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESBEN
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O361
rd_kfield=[
'CONNESOPER
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O360
rd_kfield=[
'CONNESCLI
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
nonlocal=True
obj='Var
pag=3
prev=O359
var_op='asgn
I
obj='Write
pag=3
prev=O358
rd_kfield=[
'CONNESBEN
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESBEN
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O357
rd_kfield=[
'CONNESOPER
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O356
rd_kfield=[
'CONNESCLI
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O355
rd_kfield=[
'CONNESOPER
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O354
rd_kfield=[
'CODINTER
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CODINTER
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O353
rd_kfield=[
'CODINTER
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CODINTER
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
nonlocal=True
obj='Var
pag=3
prev=O352
var_op='asgn
I
obj='Write
pag=3
prev=O351
rd_kfield=[
'CONNESOPER
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O350
rd_kfield=[
'CONNESCLI
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
nonlocal=True
obj='Var
pag=3
prev=O349
var_op='asgn
I
obj='Write
pag=3
prev=O348
rd_kfield=[
'CONNESOPER
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O347
rd_kfield=[
'CONNESCLI
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
nonlocal=True
obj='Var
pag=3
prev=O346
var_op='asgn
I
obj='Write
pag=3
prev=O345
rd_kfield=[
'CONNESOPER
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O344
rd_kfield=[
'CODINTER
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CODINTER
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O343
rd_kfield=[
'CODINTER
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CODINTER
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
nonlocal=True
obj='Var
pag=3
prev=O342
var_op='asgn
I
obj='Write
pag=3
prev=O341
rd_kfield=[
'CONNESOPER
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O340
rd_kfield=[
'CODINTER
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CODINTER
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O339
rd_kfield=[
'CODINTER
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CODINTER
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
nonlocal=True
obj='Var
pag=3
prev=O338
var_op='asgn
I
obj='Write
pag=3
prev=O337
rd_kfield=[
'CODSOG
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CODSOG
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O336
rd_kfield=[
'CODSOG
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CODSOG
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O335
rd_kfield=[
'CODSOG
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CODSOG
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O334
rd_kfield=[
'CODSOG
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CODSOG
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O333
rd_kfield=[
'CONNALTRO
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNALTRO
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O332
rd_kfield=[
'CONNESOPER
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O331
rd_kfield=[
'CONNESBEN
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESBEN
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O330
rd_kfield=[
'CONNESCLI
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
nonlocal=True
obj='Var
pag=3
prev=O329
var_op='asgn
I
obj='Write
pag=3
prev=O328
rd_kfield=[
'CODSOG
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CODSOG
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O327
rd_kfield=[
'CODSOG
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CODSOG
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O326
rd_kfield=[
'CODSOG
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CODSOG
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O325
rd_kfield=[
'CODSOG
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CODSOG
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O324
rd_kfield=[
'CONNALTRO
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNALTRO
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O323
rd_kfield=[
'CONNESOPER
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O322
rd_kfield=[
'CONNESBEN
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESBEN
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O321
rd_kfield=[
'CONNESCLI
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
nonlocal=True
obj='Var
pag=3
prev=O320
var_op='asgn
I
obj='Write
pag=3
prev=O319
rd_kfield=[
'CODSOG
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CODSOG
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O318
rd_kfield=[
'CODSOG
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CODSOG
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O317
rd_kfield=[
'CODSOG
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CODSOG
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O316
rd_kfield=[
'CODSOG
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CODSOG
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O315
rd_kfield=[
'CONNALTRO
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNALTRO
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O314
rd_kfield=[
'CONNESOPER
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O313
rd_kfield=[
'CONNESBEN
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESBEN
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O312
rd_kfield=[
'CONNESCLI
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
nonlocal=True
obj='Var
pag=3
prev=O311
var_op='asgn
I
obj='Write
pag=3
prev=O310
rd_kfield=[
'CODSOG
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CODSOG
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O309
rd_kfield=[
'CODSOG
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CODSOG
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O308
rd_kfield=[
'CODSOG
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CODSOG
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O307
rd_kfield=[
'CODSOG
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CODSOG
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O306
rd_kfield=[
'CONNALTRO
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNALTRO
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O305
rd_kfield=[
'CONNESOPER
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O304
rd_kfield=[
'CONNESBEN
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESBEN
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
obj='Write
pag=3
prev=O303
rd_kfield=[
'CONNESCLI
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
nonlocal=True
obj='Var
pag=3
prev=O300
var_op='asgn
I
obj='If
pag=3
prev=O299
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O300
fatherSonIndex=0
frm_calc=''Crea Nuovo record personbo'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_connes)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O707
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O708
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Aggiorna wersonbo'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='wersonbo
obj='Write
pag=3
prev=O717
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'w_oldcon
]
wr_field=[
'CONNES
]
wr_op=[
'=
]
wr_var=[
'w_newcon
]
I
nonlocal=True
obj='Var
pag=3
prev=O715
var_op='asgn
I
obj='Select
pag=3
prev=O713
sel_field='*
sel_name='opextrbo
sel_where='opextrbo->COLLEG=w_oldcon
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='opextrbo
father=O715
fatherSonIndex=0
obj='Insert
pag=3
rd_kfield=[
'COLLEG
'ANNO
'IDBASE
'DATAOPE
'COINT
'NOTE
'NUMPROG1
'RIFIMP
'IDFILE
'PROGOPEX
'SALDO
'QUANTITA
'VALUTA
]
rd_kvar=[
'w_newcon
'opextrbo->ANNO
'opextrbo->IDBASE
'opextrbo->DATAOPE
'opextrbo->COINT
'opextrbo->NOTE
'opextrbo->NUMPROG1
'opextrbo->RIFIMP
'opextrbo->IDFILE
'opextrbo->PROGOPEX
'opextrbo->SALDO
'opextrbo->QUANTITA
'opextrbo->VALUTA
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=3
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=w_oldcon
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='personbo
father=O713
fatherSonIndex=0
obj='Insert
pag=3
rd_kfield=[
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
]
rd_kvar=[
'w_newcon
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'w_oldcon
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O708
fatherSonIndex=1
frm_calc='transaction error
frm_seek=''Soggetto con new connes: %1 trovato'
msg_parms=[
'w_newcon
]
next=Ispitembatch.CPReturn
frm_calc='False
obj='Return
pag=3
page_return=True
prev=O738
I
obj='Transaction
pag=3
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O300
fatherSonIndex=1
frm_calc=[
'Empty(_connes)
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Prendo le operazioni del nuovo conne ordinate per anno e genero la key sulla base del ANNO
next=Ispitembatch.CPMemoryCursor
data_source='opextrbo
key_expression='opextrbo->ANNO
mem_curs_name='opextrbo_new_connes
next=Icpitembatch.CPIfElse
frm_calc=[
'opextrbo_new_connes.RecCount()>0
]
h=[
19
19
]
obj='If
pag=3
prev=O747
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O748
fatherSonIndex=0
frm_calc='Giro le operazioni del vecchio connes per verificare se sono da sostituire a quelle già presenti sull'anagrafica
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=3
prev=O753
sel_field='*
sel_name='opextrbo
sel_order='opextrbo->ANNO
sel_where='opextrbo->COLLEG=w_oldcon
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O754
fatherSonIndex=0
frm_calc='Se non la trovo con la key, vuol dire che non ho operazioni con il nuovo connes, quindi riporto quella pressa dal vecchio
next=Icpitembatch.CPIfElse
frm_calc=[
'opextrbo_new_connes.GoToKey(opextrbo->ANNO)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O758
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O759
fatherSonIndex=0
frm_calc='Se l'operazione con il vecchio connes è più vecchia di quella con il nuovo la sostituisco
next=Icpitembatch.CPIfElse
frm_calc=[
'opextrbo_new_connes.DATAOPE>opextrbo->DATAOPE
]
h=[
19
19
]
obj='If
pag=3
prev=O764
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='opextrbo
father=O765
fatherSonIndex=0
next=Icpitembatch.CPInsert
arch='opextrbo
obj='Insert
pag=3
prev=O770
rd_kfield=[
'COLLEG
'ANNO
'IDBASE
'DATAOPE
'COINT
'NOTE
'NUMPROG1
'RIFIMP
'IDFILE
'PROGOPEX
'SALDO
'QUANTITA
'VALUTA
]
rd_kvar=[
'w_newcon
'opextrbo->ANNO
'opextrbo->IDBASE
'opextrbo->DATAOPE
'opextrbo->COINT
'opextrbo->NOTE
'opextrbo->NUMPROG1
'opextrbo->RIFIMP
'opextrbo->IDFILE
'opextrbo->PROGOPEX
'opextrbo->SALDO
'opextrbo->QUANTITA
'opextrbo->VALUTA
]
I
obj='Delete
pag=3
rd_kfield=[
'COLLEG
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'opextrbo_new_connes.COLLEG
'opextrbo_new_connes.ANNO
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=3
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='opextrbo
father=O759
fatherSonIndex=1
obj='Insert
pag=3
rd_kfield=[
'COLLEG
'ANNO
'IDBASE
'DATAOPE
'COINT
'NOTE
'NUMPROG1
'RIFIMP
'IDFILE
'PROGOPEX
'SALDO
'QUANTITA
'VALUTA
]
rd_kvar=[
'w_newcon
'opextrbo->ANNO
'opextrbo->IDBASE
'opextrbo->DATAOPE
'opextrbo->COINT
'opextrbo->NOTE
'opextrbo->NUMPROG1
'opextrbo->RIFIMP
'opextrbo->IDFILE
'opextrbo->PROGOPEX
'opextrbo->SALDO
'opextrbo->QUANTITA
'opextrbo->VALUTA
]
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=3
I
I
]
w=[
150
150
]
I
obj='Remark
pag=3
I
I
]
w=[
150
150
]
I
obj='MemoryCursor
pag=3
prev=O746
sel_field='opextrbo->COLLEG,opextrbo->ANNO,opextrbo->IDBASE,opextrbo->DATAOPE,opextrbo->COINT,opextrbo->NOTE,opextrbo->NUMPROG1,opextrbo->RIFIMP,opextrbo->IDFILE,opextrbo->PROGOPEX,opextrbo->SALDO,opextrbo->QUANTITA,opextrbo->VALUTA
sel_name='opextrbo
sel_order='opextrbo->ANNO
sel_type='fltb
sel_where='opextrbo->COLLEG=w_newcon
I
obj='Remark
pag=3
prev=O743
I
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O743
fatherSonIndex=0
frm_calc='transaction error
frm_seek=''Soggetto con new connes: %1 non trovato'
msg_parms=[
'w_newcon
]
next=Ispitembatch.CPReturn
frm_calc='False
obj='Return
pag=3
page_return=True
prev=O787
I
obj='Transaction
pag=3
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=3
prev=O298
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'w_newcon
]
rd_var=[
'_connes
]
I
obj='Var
pag=3
pagelocal=True
prev=O297
var_op='asgn
I
nonlocal=True
obj='Var
pag=3
prev=O296
var_op='asgn
I
obj='Remark
pag=3
prev=O295
I
obj='Remark
pag=3
prev=O293
I
obj='Begin
pag=3
prev=O291
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='operazioni del nuovo connes
father=O293
fatherSonIndex=0
frm_seek='opextrbo
name='opextrbo_new_connes
next=Icpitembatch.CPVarDecl
comment='connes del soggetto
len=16
name='_connes
obj='Var
pag=3
pagelocal=True
prev=O798
I
obj='Var
obj_type='MC
pag=3
pagelocal=True
I
I
]
w=[
150
150
]
I
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='vecchio connes
father=O291
fatherSonIndex=0
len=16
name='w_oldcon
next=Icpitembatch.CPVarDecl
comment='new connes
len=16
name='w_newcon
next=Icpitembatch.CPVarDecl
comment='flag per sapere se è una modifica del connes o un accorpamento
len=1
name='flag_modifica
obj='Var
obj_type='L
pag=3
pageparam=True
prev=O804
I
obj='Var
pag=3
pageparam=True
prev=O803
I
obj='Var
pag=3
pageparam=True
I
I
]
w=[
150
150
]
x=2
y=7
I
Icpitembatch.CPVarDecl
comment='data di nascita data
frm_calc='cell.getDateCellValue()
len=8
name='column07date
next=Icpitembatch.CPVarDecl
frm_calc='Right(DateToChar(column07date),2)+'/'+Substr(DateToChar(column07date),5,2)+'/'+Left(DateToChar(column07date),4)
len=25
name='column07
obj='Var
pag=2
pagelocal=True
prev=O807
var_op='asgn
I
obj='Var
obj_type='D
pag=2
pagelocal=True
var_op='asgn
x=828
y=2686
I
Icpitembatch.CPVarDecl
frm_calc='Right(LRTrim(Str(column07num,99,0)),2)+'/'+Substr(LRTrim(Str(column07num,99,0)),5,2)+'/'+Left(LRTrim(Str(column07num,99,0)),4)
len=25
name='column07
next=Icpitembatch.CPVarDecl
frm_calc='Format(column07num,'DD/MM/YYYY')
len=25
name='column07
obj='Var
pag=2
pagelocal=True
prev=O809
var_op='asgn
I
obj='Var
pag=2
pagelocal=True
var_op='asgn
x=962
y=2774
I
Icpitembatch.CPWrite
arch='personbo
expected_rows=1
h=[
19
19
]
obj='Write
pag=2
rd_kfield=[
'CONNES
'CODFISC
]
rd_kop=[
'=
'=
]
rd_kvar=[
'personbo->CONNES
'personbo->CODFISC
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='fallimento scrittura dati
father=O811
fatherSonIndex=0
frm_calc='True
len=1
name='_falied
obj='Var
obj_type='L
pag=2
pagelocal=True
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'RAGSOC
'CODFISC
'COGNOME
'NOME
'SESSO
'DATANASC
'NASCOMUN
'NASSTATO
'TIPINTER
'CFESTERO
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'column01
'iif(column03='CFESTERO',personbo->CODFISC,LRTrim(column03))
'LRTrim(column04)
'LRTrim(column05)
'iif(LRTrim(column06)='M','1',iif(LRTrim(column06)='F','2',LRTrim(column06)))
'CharToDate(LRTrim(column07))
'iif(LRTrim(column08)='NOCOMU',personbo->NASCOMUN,LRTrim(column08))
'iif(LRTrim(column09)='NOSTATO',personbo->NASSTATO,LRTrim(column09))
'LRTrim(column10)
'iif(column12='1',1,0)
]
x=939
y=3467
I
Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel
frm_calc='0
len=9
name='riga_letta
next=Icpitembatch.CPVarDecl
comment='data rettifica
frm_calc='Date()
len=8
name='w_DATARETT
next=Icpitembatch.CPVarDecl
comment='data rettifica
frm_calc='CharToDate('01/08/2016')
len=8
name='w_DATARETT
next=Icpitembatch.CPVarDecl
comment='data rettifica
frm_calc='datamod
len=8
name='w_DATARETT
next=Icpitembatch.CPVarDecl
comment='Data Variazione
frm_calc='w_DATARETT
global=True
len=8
name='gDataVaria
next=Icpitembatch.CPMessage
frm_calc=''Apertura file Excel. '+Chr(13)+Chr(10)+"Elaborazione in corso..."
next=Icpitembatch.CPBeginEnd
comment='Apro il foglio //e verifico quante pagine ha
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Creo file per risultati
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='//Azzero i contatori di fogli letti e righe scritte﷯_i = 0;﷯r=0;﷯//Creo il record da scrivere﷯//row2 = (XSSFRow) sheet2.createRow(r);﷯row2 = (SXSSFRow) sheet2.createRow(r);﷯//scrivo la riga di intestazione﷯cell2 = (SXSSFCell) row2.createCell(0);﷯cell2.setCellValue("IDfile");﷯cell2 = (SXSSFCell) row2.createCell(1);﷯cell2.setCellValue("Numprog");﷯cell2 = (SXSSFCell) row2.createCell(2);﷯cell2.setCellValue("Idesito");﷯cell2 = (SXSSFCell) row2.createCell(3);﷯cell2.setCellValue("Intestatario");﷯cell2 = (SXSSFCell) row2.createCell(4);﷯cell2.setCellValue("Connes");﷯cell2 = (SXSSFCell) row2.createCell(5);﷯cell2.setCellValue("cf reale");﷯cell2 = (SXSSFCell) row2.createCell(6);﷯cell2.setCellValue("Cognome");﷯cell2 = (SXSSFCell) row2.createCell(7);﷯cell2.setCellValue("Nome");﷯cell2 = (SXSSFCell) row2.createCell(8);﷯cell2.setCellValue("Sesso");﷯cell2 = (SXSSFCell) row2.createCell(9);﷯cell2.setCellValue("Data di nascita");﷯cell2 = (SXSSFCell) row2.createCell(10);﷯cell2.setCellValue("Comune di nacita");﷯cell2 = (SXSSFCell) row2.createCell(11);﷯cell2.setCellValue("stato di nascita");﷯cell2 = (SXSSFCell) row2.createCell(12);﷯cell2.setCellValue("Provincia di nascita");﷯cell2 = (SXSSFCell) row2.createCell(13);﷯cell2.setCellValue("Provincia di nascita bis");﷯cell2 = (SXSSFCell) row2.createCell(14);﷯cell2.setCellValue("CF Estero");﷯cell2 = (SXSSFCell) row2.createCell(15);﷯cell2.setCellValue("Descrizione");﷯cell2 = (SXSSFCell) row2.createCell(16);﷯cell2.setCellValue("Note");﷯cell2 = (SXSSFCell) row2.createCell(17);﷯cell2.setCellValue("Riga");﷯cell2 = (SXSSFCell) row2.createCell(18);﷯cell2.setCellValue("Foglio");﷯r++;
next=Icpitembatch.CPVarDecl
comment='ok alla commit
frm_calc='True
len=1
name='_commit
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPMessage
frm_calc=''Ridimensionamento delle celle. '+Chr(13)+Chr(10)+"Elaborazione in corso..."
next=Icpitembatch.CPExec
check='man
frm_calc='//Ridimensiono le colonne in base al contenuto﷯sheet2.autoSizeColumn(0);﷯sheet2.autoSizeColumn(1);﷯sheet2.autoSizeColumn(2);﷯sheet2.autoSizeColumn(3);﷯sheet2.autoSizeColumn(4);﷯sheet2.autoSizeColumn(5);﷯sheet2.autoSizeColumn(6);﷯sheet2.autoSizeColumn(7);﷯sheet2.autoSizeColumn(8);﷯sheet2.autoSizeColumn(9);﷯sheet2.autoSizeColumn(10);﷯sheet2.autoSizeColumn(11);﷯sheet2.autoSizeColumn(12);﷯sheet2.autoSizeColumn(13);﷯sheet2.autoSizeColumn(14);﷯sheet2.autoSizeColumn(15);﷯sheet2.autoSizeColumn(16);﷯sheet2.autoSizeColumn(17);﷯sheet2.autoSizeColumn(18);
next=Icpitembatch.CPMessage
frm_calc=''Scrittura file Excel. '+Chr(13)+Chr(10)+"Elaborazione in corso..."
next=Icpitembatch.CPExec
check='man
frm_calc='// scrivo il file di esito﷯FileOutputStream fileOut = new FileOutputStream(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(gAzienda)+'/'+CPLib.LRTrim(nomefileoutput));﷯﷯//write this workbook to an Outputstream.﷯wb2.write(fileOut);﷯fileOut.flush();﷯fileOut.close();
obj='Exec
pag=4
prev=O842
I
obj='Message
pag=4
prev=O841
I
obj='Exec
pag=4
prev=O840
I
obj='Message
pag=4
prev=O838
I
obj='Try
pag=4
prev=O837
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWhile
father=O838
fatherSonIndex=0
frm_calc='_i < conta
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(_commit)
]
h=[
19
19
]
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=4
prev=O848
I
obj='If
pag=4
prev=O846
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O848
fatherSonIndex=0
frm_calc='transaction error
frm_seek='errore xlsx
obj='Transaction
pag=4
I
I
]
w=[
150
150
]
I
obj='While
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O846
fatherSonIndex=0
frm_calc='//Apro uno ad uno i fogli del file Excel﷯XSSFSheet sheet = wb.getSheetAt(_i);﷯//SXSSFSheet sheet = (SXSSFSheet) wb.getSheetAt(_i);﷯//Sheet sheet = wb.getSheetAt(_i);﷯//Mi definisco un oggetto che contiene tutte le righe﷯Iterator rows = sheet.rowIterator();﷯//_righe = sheet.getLastRowNum()+1;﷯//_y = 1;﷯System.out.println("Lettura foglio "+_i+" di "+conta);﷯System.out.println("Ci sono record "+rows.hasNext());﷯//System.out.println("Numero di record "+sheet.getRowNum());
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel
frm_calc='0
len=9
name='riga_letta
next=Icpitembatch.CPVarDecl
comment='foglio letto
frm_calc='_i
len=2
name='foglio
next=Icpitembatch.CPWhile
frm_calc='rows.hasNext() and _commit
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=4
prev=O861
I
obj='While
pag=4
prev=O860
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O861
fatherSonIndex=0
frm_calc='//scorro le righe﷯row=(XSSFRow) rows.next();﷯//Mi definisco un oggetto che contiene tutte le celle della riga letta﷯Iterator cells = row.cellIterator();
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='cell_count
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel
frm_calc='riga_letta+1
len=9
name='riga_letta
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='''
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='ok alla modifica dei dati
frm_calc='True
len=1
name='modifica
next=Icpitembatch.CPExec
check='man
frm_calc='System.out.println("Lettura foglio "+_i+" di "+conta+" riga letta "+riga_letta);
next=Icpitembatch.CPBeginEnd
comment='Azzeramento variabili colonne
h=[
19
19
]
next=Icpitembatch.CPWhile
frm_calc='cells.hasNext() and riga_letta>1
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'riga_letta>1
]
h=[
19
19
]
obj='If
pag=4
prev=O874
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='riga letta del file Excel Character
father=O876
fatherSonIndex=0
frm_calc='Str(riga_letta,9,0)
len=9
name='riga_letta_c
next=Icpitembatch.CPVarDecl
comment='foglio letto Character
frm_calc='Str(foglio,2,0)
len=9
name='foglio_c
next=Icpitembatch.CPExec
check='man
frm_calc='//Creo il record da scrivere﷯row2 = (SXSSFRow) sheet2.createRow(r);﷯cell2 = (SXSSFCell) row2.createCell(0);﷯cell2.setCellValue(CPLib.LRTrim(column14));﷯cell2 = (SXSSFCell) row2.createCell(1);﷯cell2.setCellValue(CPLib.LRTrim(column15));﷯cell2 = (SXSSFCell) row2.createCell(2);﷯cell2.setCellValue(CPLib.LRTrim(column16));﷯cell2 = (SXSSFCell) row2.createCell(3);﷯cell2.setCellValue(CPLib.LRTrim(column01));﷯cell2 = (SXSSFCell) row2.createCell(4);﷯cell2.setCellValue(CPLib.LRTrim(column02));﷯cell2 = (SXSSFCell) row2.createCell(5);﷯cell2.setCellValue(CPLib.LRTrim(column03));﷯cell2 = (SXSSFCell) row2.createCell(6);﷯cell2.setCellValue(CPLib.LRTrim(column04));﷯cell2 = (SXSSFCell) row2.createCell(7);﷯cell2.setCellValue(CPLib.LRTrim(column05));﷯cell2 = (SXSSFCell) row2.createCell(8);﷯cell2.setCellValue(CPLib.LRTrim(column06));﷯cell2 = (SXSSFCell) row2.createCell(9);﷯cell2.setCellValue(CPLib.LRTrim(column07));﷯cell2 = (SXSSFCell) row2.createCell(10);﷯cell2.setCellValue(CPLib.LRTrim(column08));﷯cell2 = (SXSSFCell) row2.createCell(11);﷯cell2.setCellValue(CPLib.LRTrim(column09));﷯cell2 = (SXSSFCell) row2.createCell(12);﷯cell2.setCellValue(CPLib.LRTrim(column10));﷯cell2 = (SXSSFCell) row2.createCell(13);﷯cell2.setCellValue(CPLib.LRTrim(column11));﷯cell2 = (SXSSFCell) row2.createCell(14);﷯cell2.setCellValue(CPLib.LRTrim(column12));﷯cell2 = (SXSSFCell) row2.createCell(15);﷯cell2.setCellValue(CPLib.LRTrim(column13));﷯cell2 = (SXSSFCell) row2.createCell(16);﷯cell2.setCellValue(CPLib.LRTrim(nota));﷯cell2 = (SXSSFCell) row2.createCell(17);﷯cell2.setCellValue(CPLib.LRTrim(riga_letta_c));﷯cell2 = (SXSSFCell) row2.createCell(18);﷯cell2.setCellValue(CPLib.LRTrim(foglio_c));﷯r++;
obj='Exec
pag=4
prev=O882
I
obj='Var
pag=4
pagelocal=True
prev=O881
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='While
pag=4
prev=O872
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMessage
father=O874
fatherSonIndex=0
frm_calc=''Sto leggendo riga: %1 del foglio %2.'+Chr(13)+Chr(10)+"Elaborazione in corso..."
msg_parms=[
'riga_letta
'foglio
]
next=Icpitembatch.CPExec
check='man
frm_calc='//scorro le celle della riga﷯cell=(XSSFCell) cells.next();
next=Icpitembatch.CPVarDecl
frm_calc='cell_count+1
len=9
name='cell_count
next=Icpitembatch.CPVarDecl
frm_calc='cell.getCellType().ordinal()
len=1
name='cell_type
next=Icpitembatch.CPRemark
frm_calc='cell.getColumnIndex() torna il valore della colonna letta partendo da 0
next=Icpitembatch.CPVarDecl
comment='numero della colonna letta
frm_calc='cell.getColumnIndex()
len=2
name='ncol
next=Icpitembatch.CPVarDecl
comment='numero della colonna letta
frm_calc='ncol+1
len=2
name='ncol
next=Icpitembatch.CPRemark
frm_calc='Salto le celle non tornate in modo che resti vuota la variabile relativa alla cella non tornata
next=Icpitembatch.CPWhile
frm_calc='cell_count<ncol
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cell_count=4 or cell_count=6 or cell_count=11 or cell_count=17 or (cell_count>18 and cell_count<23) or cell_count=24 or cell_count=26 or cell_count=31
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Se l'interetor delle celle è più corto di quanto doveva essere ipotizzo che sia un rivio diretto cosi come è senza variazioni. Vedi casistica colonna 31 vuota.
next=Icpitembatch.CPIfElse
frm_calc=[
'cell_count<30 and not(cells.hasNext())
]
h=[
19
19
]
obj='If
pag=4
prev=O901
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O902
fatherSonIndex=0
frm_calc='iif(Empty(nota),'Nessuna azione intrapresa per la fase 1 alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Nessuna azione intrapresa per la fase 1 alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=4
prev=O898
I
obj='If
pag=4
prev=O896
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O898
fatherSonIndex=0
frm_calc=[
'cell_type=1
'cell_type=2
'cell_type=3
'cell_type=6
'cell_type=0
]
h=[
19
19
19
19
19
19
19
]
haselse=True
obj='Case
pag=4
sons=[
Icpitembatch.CPItemSon
comment='Tipo Numerico
instr=Icpitembatch.CPRemark
father=O911
fatherSonIndex=0
frm_calc='tipo numerico﷯da definire il comportamento
next=Icpitembatch.CPCase
frm_calc=[
'cell_count=4
'cell_count=6
'cell_count=28
]
h=[
19
19
19
19
19
]
haselse=True
obj='Case
pag=4
prev=O916
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Afile
father=O917
fatherSonIndex=0
frm_calc='cell.getNumericCellValue()
len=15
name='column14num
next=Icpitembatch.CPVarDecl
comment='Afile
frm_calc='LRTrim(Str(column14num,15,0))
len=15
name='column14
obj='Var
pag=4
pagelocal=True
prev=O922
var_op='asgn
I
obj='Var
obj_type='N
pag=4
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Aprog
father=O917
fatherSonIndex=1
frm_calc='cell.getNumericCellValue()
len=25
name='column15num
next=Icpitembatch.CPVarDecl
comment='Aprog
frm_calc='LRTrim(Str(column15num,25,0))
len=25
name='column15
obj='Var
pag=4
pagelocal=True
prev=O925
var_op='asgn
I
obj='Var
obj_type='N
pag=4
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O917
fatherSonIndex=2
frm_calc='Quando la leggeva come numero
next=Icpitembatch.CPVarDecl
comment='data di nascita numerico
frm_calc='cell.getNumericCellValue()
len=99
name='column07num
next=Icpitembatch.CPVarDecl
comment='data di nascita
frm_calc='LRTrim(sdf.format(cell.getDateCellValue()))
len=25
name='column07
obj='Var
pag=4
pagelocal=True
prev=O929
var_op='asgn
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O928
var_op='asgn
I
obj='Remark
pag=4
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O917
fatherSonIndex=3
frm_calc='iif(Empty(nota),'Valore numerico alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Valore numerico alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='ok alla commit
frm_calc='False
len=1
name='_commit
obj='Var
obj_type='L
pag=4
pagelocal=True
prev=O932
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Remark
pag=4
I
I
Icpitembatch.CPItemSon
comment='Tipo stringa
instr=Icpitembatch.CPCase
father=O911
fatherSonIndex=1
frm_calc=[
'cell_count=4
'cell_count=6
'cell_count=11
'cell_count=20
'cell_count=17
'cell_count=19
'cell_count=21
'cell_count=22
'cell_count=28
'cell_count=24
'cell_count=26
'cell_count=31
]
h=[
19
19
19
19
19
19
19
19
19
19
19
19
19
]
obj='Case
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Afile
father=O936
fatherSonIndex=0
frm_calc='LRTrim(cell.getStringCellValue())
len=15
name='column14
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Aprog
father=O936
fatherSonIndex=1
frm_calc='LRTrim(cell.getStringCellValue())
len=25
name='column15
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Idesito
father=O936
fatherSonIndex=2
frm_calc='LRTrim(cell.getStringCellValue())
len=8
name='column16
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='ragsoc
father=O936
fatherSonIndex=3
frm_calc='LRTrim(cell.getStringCellValue())
len=25
name='column01
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='connes
father=O936
fatherSonIndex=4
frm_calc='LRTrim(cell.getStringCellValue())
len=25
name='column02
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='CF
father=O936
fatherSonIndex=5
frm_calc='LRTrim(cell.getStringCellValue())
len=25
name='column03
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nome
father=O936
fatherSonIndex=6
frm_calc='LRTrim(cell.getStringCellValue())
len=25
name='column05
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Cognome
father=O936
fatherSonIndex=7
frm_calc='LRTrim(cell.getStringCellValue())
len=25
name='column04
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='data di nascita
father=O936
fatherSonIndex=8
frm_calc='LRTrim(cell.getStringCellValue())
len=25
name='column07
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='comune di nascita
father=O936
fatherSonIndex=9
frm_calc='LRTrim(cell.getStringCellValue())
len=30
name='column08
next=Icpitembatch.CPVarDecl
comment='nazione di nascita
frm_calc='LRTrim(cell.getStringCellValue())
len=30
name='column09
obj='Var
pag=4
pagelocal=True
prev=O959
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='provincia di nascita
father=O936
fatherSonIndex=10
frm_calc='LRTrim(cell.getStringCellValue())
len=2
name='column10
next=Icpitembatch.CPVarDecl
comment='provincia di nascita
frm_calc='LRTrim(cell.getStringCellValue())
len=2
name='column11
obj='Var
pag=4
pagelocal=True
prev=O962
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Descrizione
father=O936
fatherSonIndex=11
frm_calc='LRTrim(cell.getStringCellValue())
len=16
name='column13
next=Icpitembatch.CPCase
frm_calc=[
'Empty(column13)
'column13='CANCELLARE E COMUNICARE NUOVA ANAGRAFICA CON CODICE FISCALE FITTIZIO' or column13='CANCELLARE MODIFICARE ANAGRAFICA E COMUNICARE COME FITTIZIO' or column13='CANCELLARE E RICOMUNICARE COME FITTIZIO' or column13='CANCELLARE IL CLIENTE NON ESISTE'
'column13='MODIFICARE E COMUNICARE CON CODICE FISCALE VERIFICATO'
]
h=[
19
19
19
19
19
]
haselse=True
obj='Case
pag=4
prev=O965
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O966
fatherSonIndex=0
frm_calc='iif(Empty(nota),'Nessuna azione intrapresa per la fase 1 alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Nessuna azione intrapresa per la fase 1 alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O966
fatherSonIndex=1
frm_calc='''
len=10
name='_progrig
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_progrig)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
prev=O974
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O976
fatherSonIndex=0
frm_calc='iif(Empty(nota),'Esito trovato per cancellazione alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Esito trovato per cancellazione alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O976
fatherSonIndex=1
frm_calc='iif(Empty(nota),'Esito non trovato alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Esito non trovato alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='ok alla commit
frm_calc='False
len=1
name='_commit
obj='Var
obj_type='L
pag=4
pagelocal=True
prev=O983
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=4
prev=O973
sel_field='*
sel_name='aeoprig
sel_where='aeoprig->CONNESINT=column02 and aeoprig->ASPEDITO=1 and aeoprig->IDESITO=column16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O974
fatherSonIndex=0
frm_calc='''
len=10
name='_progrig
next=Icpitembatch.CPRead
arch='aeopcanc
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_progrig)
]
h=[
19
19
]
obj='If
pag=4
prev=O989
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O990
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOAGE\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProg
next=Icpitembatch.CPInsert
arch='aeopstor
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PDELAGE\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cCanc
next=Icpitembatch.CPInsert
arch='aeopcanc
obj='Insert
pag=4
prev=O997
rd_kfield=[
'ADATA
'ADATARET
'AFILE
'APROG
'ASPEDITO
'CDATA
'CDATARET
'CFILE
'COLDPROG
'COINT
'COLDFILE
'CONNESINT
'CPROG
'CSPEDITO
'DATARIF
'IDBASE
'IDRIF
'NOCODFISC
'PROGRES
'RAPPORTO
'RIFSTOR
'TIPOAG
'TIPOCAN
]
rd_kvar=[
'aeoprig->ADATA
'w_DATARETT
'aeoprig->AFILE
'aeoprig->APROG
'aeoprig->ASPEDITO
'aeoprig->CDATA
'aeoprig->CDATARET
'aeoprig->CFILE
'aeoprig->COLDPROG
'aeoprig->COINT
'aeoprig->COLDFILE
'aeoprig->CONNESINT
'aeoprig->CPROG
'aeoprig->CSPEDITO
'w_DATARETT
'aeoprig->IDBASE
'aeoprig->IDRIF
'aeoprig->NOCODFISC
'cCanc
'aeoprig->RAPPORTO
'cProg
'aeoprig->TIPOAG
''C'
]
I
obj='Var
pag=4
pagelocal=True
prev=O996
var_op='asgn
I
obj='Insert
pag=4
prev=O995
rd_kfield=[
'IDBASE
'RAPPORTO
'CONNESINT
'ASPEDITO
'ADATA
'APROG
'AFILE
'ADATARET
'CSPEDITO
'CDATA
'CPROG
'CFILE
'CDATARET
'IDRIF
'TIPOAG
'COINT
'NOCODFISC
'PROGRES
]
rd_kvar=[
'aeoprig->IDBASE
'aeoprig->RAPPORTO
'aeoprig->CONNESINT
'aeoprig->ASPEDITO
'aeoprig->ADATA
'aeoprig->APROG
'aeoprig->AFILE
'aeoprig->ADATARET
'aeoprig->CSPEDITO
'aeoprig->CDATA
'aeoprig->CPROG
'aeoprig->CFILE
'aeoprig->CDATARET
'aeoprig->IDRIF
'aeoprig->TIPOAG
'aeoprig->COINT
'aeoprig->NOCODFISC
'cProg
]
I
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
prev=O988
rd_field=[
'PROGRES
]
rd_kfield=[
'AFILE
'APROG
]
rd_kvar=[
'aeoprig->AFILE
'aeoprig->APROG
]
rd_var=[
'_progrig
]
I
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O966
fatherSonIndex=2
frm_calc='iif(Empty(nota),'Nessuna azione intrapresa per la fase 1 alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Nessuna azione intrapresa per la fase 1 alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O966
fatherSonIndex=3
frm_calc='iif(Empty(nota),'Valore non previsto alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Valore non previsto alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
next=Icpitembatch.CPIfElse
frm_calc=[
'cell_count<32
]
h=[
19
19
]
obj='If
pag=4
prev=O1012
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='ok alla commit
father=O1013
fatherSonIndex=0
frm_calc='False
len=1
name='_commit
obj='Var
obj_type='L
pag=4
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
150
150
150
150
150
150
150
150
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
comment='Tipo formula
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O911
fatherSonIndex=2
frm_calc='iif(Empty(nota),'Formula alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Formula alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='ok alla commit
frm_calc='False
len=1
name='_commit
obj='Var
obj_type='L
pag=4
pagelocal=True
prev=O1023
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='Tipo vuoto
instr=Icpitembatch.CPCase
father=O911
fatherSonIndex=3
frm_calc=[
'cell_count=19
'cell_count=21
'cell_count=22
'cell_count=24
'cell_count=26
'cell_count=31
]
h=[
19
19
19
19
19
19
19
19
]
haselse=True
obj='Case
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='CF
father=O1026
fatherSonIndex=0
frm_calc='''
len=25
name='column03
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (CF vuoto)',nota+' Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (CF vuoto)')
len=100
name='nota
obj='Var
pag=4
prev=O1031
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nome
father=O1026
fatherSonIndex=1
frm_calc='''
len=25
name='column05
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (nome vuoto)',nota+' Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (nome vuoto)')
len=100
name='nota
obj='Var
pag=4
prev=O1034
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Cognome
father=O1026
fatherSonIndex=2
frm_calc='''
len=25
name='column04
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (cognome vuoto)',nota+' Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (cognome vuoto)')
len=100
name='nota
obj='Var
pag=4
prev=O1037
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='comune di nascita
father=O1026
fatherSonIndex=3
frm_calc='''
len=30
name='column08
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (comune vuoto)',nota+' Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (comune vuoto)')
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='nazione di nascita
frm_calc='''
len=30
name='column09
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (stato vuoto)',nota+' Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (stato vuoto)')
len=100
name='nota
obj='Var
pag=4
prev=O1042
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
prev=O1041
var_op='asgn
I
obj='Var
pag=4
prev=O1040
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='provincia di nascita
father=O1026
fatherSonIndex=4
frm_calc='''
len=2
name='column10
next=Icpitembatch.CPVarDecl
comment='provincia di nascita
frm_calc='''
len=2
name='column11
obj='Var
pag=4
pagelocal=True
prev=O1045
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Descrizione
father=O1026
fatherSonIndex=5
frm_calc='''
len=16
name='column13
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O1026
fatherSonIndex=6
frm_calc='iif(Empty(nota),'Valore vuoto alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Valore vuoto alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
next=Icpitembatch.CPIfElse
frm_calc=[
'cell_count<32
]
h=[
19
19
]
obj='If
pag=4
prev=O1050
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='ok alla commit
father=O1051
fatherSonIndex=0
frm_calc='False
len=1
name='_commit
obj='Var
obj_type='L
pag=4
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
150
150
150
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
comment='tipo booleano
instr=Icpitembatch.CPRemark
father=O911
fatherSonIndex=4
frm_calc='tipo buleano﷯da definire il comportamento
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'Valore buleano alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Valore buleano alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='ok alla commit
frm_calc='False
len=1
name='_commit
obj='Var
obj_type='L
pag=4
pagelocal=True
prev=O1061
var_op='asgn
I
obj='Var
pag=4
prev=O1060
var_op='asgn
I
obj='Remark
pag=4
I
I
Icpitembatch.CPItemSon
collapsed=True
comment='tipo non supportato
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O911
fatherSonIndex=5
frm_calc='iif(Empty(nota),'Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='ok alla commit
frm_calc='False
len=1
name='_commit
obj='Var
obj_type='L
pag=4
pagelocal=True
prev=O1064
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='While
pag=4
prev=O895
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O896
fatherSonIndex=0
frm_calc='cell_count+1
len=9
name='cell_count
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=4
prev=O894
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O893
var_op='asgn
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O892
var_op='asgn
I
obj='Remark
pag=4
prev=O891
I
obj='Var
obj_type='N
pag=4
prev=O890
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O889
var_op='asgn
I
obj='Exec
pag=4
prev=O887
I
obj='Message
pag=4
I
I
]
w=[
150
150
]
I
obj='Begin
pag=4
prev=O871
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
comment='ragsoc
father=O872
fatherSonIndex=0
frm_calc='''
len=25
name='column01
next=Icpitembatch.CPVarDecl
comment='connes
frm_calc='''
len=25
name='column02
next=Icpitembatch.CPVarDecl
comment='CF
frm_calc='''
len=25
name='column03
next=Icpitembatch.CPVarDecl
comment='Cognome
frm_calc='''
len=25
name='column04
next=Icpitembatch.CPVarDecl
comment='nome
frm_calc='''
len=25
name='column05
next=Icpitembatch.CPVarDecl
comment='sesso
frm_calc='''
len=25
name='column06
next=Icpitembatch.CPVarDecl
comment='sesso numerico
frm_calc='0
len=1
name='column06num
next=Icpitembatch.CPVarDecl
comment='data di nascita
frm_calc='''
len=25
name='column07
next=Icpitembatch.CPVarDecl
comment='data di nascita numerico
frm_calc='0
len=99
name='column07num
next=Icpitembatch.CPVarDecl
comment='data di nascita data
frm_calc='NullDate()
len=8
name='column07date
next=Icpitembatch.CPVarDecl
comment='comune di nascita
frm_calc='''
len=30
name='column08
next=Icpitembatch.CPVarDecl
comment='nazione di nascita
frm_calc='''
len=30
name='column09
next=Icpitembatch.CPVarDecl
comment='provincia di nascita
frm_calc='''
len=2
name='column10
next=Icpitembatch.CPVarDecl
comment='provincia di nascita
frm_calc='''
len=2
name='column11
next=Icpitembatch.CPVarDecl
comment='cfestero
frm_calc='''
len=1
name='column12
next=Icpitembatch.CPVarDecl
comment='cfestero numerico
frm_calc='0
len=1
name='column12num
next=Icpitembatch.CPVarDecl
comment='Descrizione
frm_calc='''
len=16
name='column13
next=Icpitembatch.CPVarDecl
comment='Afile
frm_calc='''
len=15
name='column14
next=Icpitembatch.CPVarDecl
comment='Afile
frm_calc='0
len=15
name='column14num
next=Icpitembatch.CPVarDecl
comment='Aprog
frm_calc='''
len=25
name='column15
next=Icpitembatch.CPVarDecl
comment='Aprog
frm_calc='0
len=25
name='column15num
next=Icpitembatch.CPVarDecl
comment='Idesito
frm_calc='''
len=8
name='column16
obj='Var
pag=4
pagelocal=True
prev=O1095
var_op='asgn
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O1094
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
prev=O1093
var_op='asgn
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O1092
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
prev=O1091
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
prev=O1090
var_op='asgn
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O1089
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
prev=O1088
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
prev=O1087
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
prev=O1086
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
prev=O1085
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
prev=O1084
var_op='asgn
I
obj='Var
obj_type='D
pag=4
pagelocal=True
prev=O1083
var_op='asgn
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O1082
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
prev=O1081
var_op='asgn
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O1080
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
prev=O1079
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
prev=O1078
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
prev=O1077
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
prev=O1076
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
prev=O1075
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Exec
pag=4
prev=O870
I
obj='Var
obj_type='L
pag=4
prev=O869
var_op='asgn
I
obj='Var
pag=4
prev=O868
var_op='asgn
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O867
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O866
var_op='asgn
I
obj='Exec
pag=4
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O859
var_op='asgn
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O858
var_op='asgn
I
obj='Exec
pag=4
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O838
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=4
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=4
prev=O836
I
obj='Var
obj_type='L
pag=4
pagelocal=True
prev=O835
var_op='asgn
I
obj='Exec
pag=4
prev=O833
I
obj='Begin
pag=4
prev=O831
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O833
fatherSonIndex=0
frm_calc='// creo il contenitore dei fogli﷯//XSSFWorkbook wb2 = new XSSFWorkbook();﷯//Modifica per evitare che carichi tutto il file in memoria﷯SXSSFWorkbook  wb2 = new SXSSFWorkbook();﷯﷯//XSSFSheet sheet2 = wb2.createSheet(sheetName) ;﷯SXSSFSheet sheet2 = (SXSSFSheet) wb2.createSheet(sheetName) ;
obj='Exec
pag=4
I
I
]
w=[
150
150
]
I
obj='Begin
pag=4
prev=O830
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O831
fatherSonIndex=0
frm_calc='//base﷯InputStream ExcelFileToRead = new FileInputStream(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(gAzienda)+'/'+CPLib.LRTrim(nomefile));﷯XSSFWorkbook  wb = new XSSFWorkbook(ExcelFileToRead);﷯//Modifica per evitare che carichi tutto il file in memoria﷯//XSSFWorkbook  wbx = new XSSFWorkbook(ExcelFileToRead);﷯//SXSSFWorkbook  wb = new SXSSFWorkbook(wbx,100);﷯﷯conta = wb.getNumberOfSheets();﷯﷯System.out.println("Sono presenti "+conta);﷯﷯//XSSFWorkbook test = new XSSFWorkbook(); ﷯﷯//XSSFSheet sheet = wb.getSheetAt(0);﷯﷯//Modifica per evitare che carichi tutto il file in memoria﷯XSSFRow row; ﷯XSSFCell cell;﷯﷯//XSSFRow row2; ﷯//XSSFCell cell2;﷯﷯//SXSSFRow row; ﷯//SXSSFCell cell;﷯﷯SXSSFRow row2; ﷯SXSSFCell cell2;﷯﷯﷯﷯//Iterator rows = sheet.rowIterator();
obj='Exec
pag=4
I
I
]
w=[
150
150
]
I
obj='Message
pag=4
prev=O829
I
nonlocal=True
obj='Var
obj_type='D
pag=4
prev=O828
var_op='asgn
I
obj='Var
obj_type='D
pag=4
pagelocal=True
prev=O827
var_op='asgn
I
obj='Var
obj_type='D
pag=4
pagelocal=True
prev=O826
var_op='asgn
I
obj='Var
obj_type='D
pag=4
pagelocal=True
prev=O825
var_op='asgn
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O823
var_op='asgn
I
obj='Begin
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='ragsoc
father=O823
fatherSonIndex=0
len=25
name='column01
next=Icpitembatch.CPVarDecl
comment='connes
len=25
name='column02
next=Icpitembatch.CPVarDecl
comment='CF
len=25
name='column03
next=Icpitembatch.CPVarDecl
comment='Cognome
len=25
name='column04
next=Icpitembatch.CPVarDecl
comment='nome
len=25
name='column05
next=Icpitembatch.CPVarDecl
comment='sesso
len=25
name='column06
next=Icpitembatch.CPVarDecl
comment='sesso numerico
len=1
name='column06num
next=Icpitembatch.CPVarDecl
comment='data di nascita
len=25
name='column07
next=Icpitembatch.CPVarDecl
comment='data di nascita numerico
len=99
name='column07num
next=Icpitembatch.CPVarDecl
comment='data di nascita data
len=8
name='column07date
next=Icpitembatch.CPVarDecl
comment='comune di nascita
len=30
name='column08
next=Icpitembatch.CPVarDecl
comment='nazione di nascita
len=30
name='column09
next=Icpitembatch.CPVarDecl
comment='provincia di nascita
len=2
name='column10
next=Icpitembatch.CPVarDecl
comment='provincia di nascita
len=2
name='column11
next=Icpitembatch.CPVarDecl
comment='cfestero
len=1
name='column12
next=Icpitembatch.CPVarDecl
comment='cfestero numerico
len=1
name='column12num
next=Icpitembatch.CPVarDecl
comment='Descrizione
len=16
name='column13
next=Icpitembatch.CPVarDecl
comment='Afile
len=15
name='column14num
next=Icpitembatch.CPVarDecl
comment='Afile
len=15
name='column14
next=Icpitembatch.CPVarDecl
comment='Aprog
len=25
name='column15num
next=Icpitembatch.CPVarDecl
comment='Aprog
len=25
name='column15
next=Icpitembatch.CPVarDecl
comment='Idesito
len=8
name='column16
next=Icpitembatch.CPVarDecl
comment='ok alla commit
len=1
name='_commit
next=Icpitembatch.CPVarDecl
comment='fallimento scrittura dati
len=1
name='_falied
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel
len=9
name='riga_letta
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel Character
len=9
name='riga_letta_c
next=Icpitembatch.CPVarDecl
comment='data di base Excel
len=8
name='date_base_excel
next=Icpitembatch.CPVarDecl
comment='numero della colonna letta
len=2
name='ncol
next=Icpitembatch.CPVarDecl
comment='foglio letto
len=2
name='foglio
next=Icpitembatch.CPVarDecl
comment='foglio letto Character
len=9
name='foglio_c
next=Icpitembatch.CPVarDecl
comment='progressivo wersonbo del giorno
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
comment='data rettifica
len=8
name='w_DATARETT
next=Icpitembatch.CPVarDecl
len=10
name='cCanc
next=Icpitembatch.CPVarDecl
len=10
name='cProg
next=Icpitembatch.CPVarDecl
len=10
name='_progrig
obj='Var
pag=4
pagelocal=True
prev=O1146
I
obj='Var
pag=4
pagelocal=True
prev=O1145
I
obj='Var
pag=4
pagelocal=True
prev=O1144
I
obj='Var
obj_type='D
pag=4
pagelocal=True
prev=O1143
I
obj='Var
pag=4
pagelocal=True
prev=O1142
I
obj='Var
pag=4
pagelocal=True
prev=O1141
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O1140
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O1139
I
obj='Var
obj_type='D
pag=4
pagelocal=True
prev=O1138
I
obj='Var
pag=4
pagelocal=True
prev=O1137
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O1136
I
obj='Var
obj_type='L
pag=4
pagelocal=True
prev=O1135
I
obj='Var
obj_type='L
pag=4
pagelocal=True
prev=O1134
I
obj='Var
pag=4
pagelocal=True
prev=O1133
I
obj='Var
pag=4
pagelocal=True
prev=O1132
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O1131
I
obj='Var
pag=4
pagelocal=True
prev=O1130
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O1129
I
obj='Var
pag=4
pagelocal=True
prev=O1128
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O1127
I
obj='Var
pag=4
pagelocal=True
prev=O1126
I
obj='Var
pag=4
pagelocal=True
prev=O1125
I
obj='Var
pag=4
pagelocal=True
prev=O1124
I
obj='Var
pag=4
pagelocal=True
prev=O1123
I
obj='Var
pag=4
pagelocal=True
prev=O1122
I
obj='Var
obj_type='D
pag=4
pagelocal=True
prev=O1121
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O1120
I
obj='Var
pag=4
pagelocal=True
prev=O1119
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O1118
I
obj='Var
pag=4
pagelocal=True
prev=O1117
I
obj='Var
pag=4
pagelocal=True
prev=O1116
I
obj='Var
pag=4
pagelocal=True
prev=O1115
I
obj='Var
pag=4
pagelocal=True
prev=O1114
I
obj='Var
pag=4
pagelocal=True
prev=O1113
I
obj='Var
pag=4
pagelocal=True
I
I
]
w=[
150
150
]
x=31
y=4
I
Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel
frm_calc='0
len=9
name='riga_letta
next=Icpitembatch.CPVarDecl
comment='data rettifica
frm_calc='Date()
len=8
name='w_DATARETT
next=Icpitembatch.CPVarDecl
comment='data rettifica
frm_calc='CharToDate('01/08/2016')
len=8
name='w_DATARETT
next=Icpitembatch.CPVarDecl
comment='data rettifica
frm_calc='datamod
len=8
name='w_DATARETT
next=Icpitembatch.CPVarDecl
comment='Data Variazione
frm_calc='w_DATARETT
global=True
len=8
name='gDataVaria
next=Icpitembatch.CPMessage
frm_calc=''Apertura file Excel. '+Chr(13)+Chr(10)+"Elaborazione in corso..."
next=Icpitembatch.CPBeginEnd
comment='Apro il foglio //e verifico quante pagine ha
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Creo file per risultati
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='//Azzero i contatori di fogli letti e righe scritte﷯_i = 0;﷯r=0;﷯//Creo il record da scrivere﷯row2 = (XSSFRow) sheet2.createRow(r);﷯//scrivo la riga di intestazione﷯cell2 = (XSSFCell) row2.createCell(0);﷯cell2.setCellValue("IDfile");﷯cell2 = (XSSFCell) row2.createCell(1);﷯cell2.setCellValue("Numprog");﷯cell2 = (XSSFCell) row2.createCell(2);﷯cell2.setCellValue("Idesito");﷯cell2 = (XSSFCell) row2.createCell(3);﷯cell2.setCellValue("Intestatario");﷯cell2 = (XSSFCell) row2.createCell(4);﷯cell2.setCellValue("Connes");﷯cell2 = (XSSFCell) row2.createCell(5);﷯cell2.setCellValue("cf reale");﷯cell2 = (XSSFCell) row2.createCell(6);﷯cell2.setCellValue("Cognome");﷯cell2 = (XSSFCell) row2.createCell(7);﷯cell2.setCellValue("Nome");﷯cell2 = (XSSFCell) row2.createCell(8);﷯cell2.setCellValue("Sesso");﷯cell2 = (XSSFCell) row2.createCell(9);﷯cell2.setCellValue("Data di nascita");﷯cell2 = (XSSFCell) row2.createCell(10);﷯cell2.setCellValue("Comune di nacita");﷯cell2 = (XSSFCell) row2.createCell(11);﷯cell2.setCellValue("stato di nascita");﷯cell2 = (XSSFCell) row2.createCell(12);﷯cell2.setCellValue("Provincia di nascita");﷯cell2 = (XSSFCell) row2.createCell(13);﷯cell2.setCellValue("Provincia di nascita bis");﷯cell2 = (XSSFCell) row2.createCell(14);﷯cell2.setCellValue("CF Estero");﷯cell2 = (XSSFCell) row2.createCell(15);﷯cell2.setCellValue("Descrizione");﷯cell2 = (XSSFCell) row2.createCell(16);﷯cell2.setCellValue("Note");﷯cell2 = (XSSFCell) row2.createCell(17);﷯cell2.setCellValue("Riga");﷯cell2 = (XSSFCell) row2.createCell(18);﷯cell2.setCellValue("Foglio");﷯r++;
next=Icpitembatch.CPVarDecl
comment='ok alla commit
frm_calc='True
len=1
name='_commit
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPMessage
frm_calc=''Ridimensionamento delle celle. '+Chr(13)+Chr(10)+"Elaborazione in corso..."
next=Icpitembatch.CPExec
check='man
frm_calc='//Ridimensiono le colonne in base al contenuto﷯sheet2.autoSizeColumn(0);﷯sheet2.autoSizeColumn(1);﷯sheet2.autoSizeColumn(2);﷯sheet2.autoSizeColumn(3);﷯sheet2.autoSizeColumn(4);﷯sheet2.autoSizeColumn(5);﷯sheet2.autoSizeColumn(6);﷯sheet2.autoSizeColumn(7);﷯sheet2.autoSizeColumn(8);﷯sheet2.autoSizeColumn(9);﷯sheet2.autoSizeColumn(10);﷯sheet2.autoSizeColumn(11);﷯sheet2.autoSizeColumn(12);﷯sheet2.autoSizeColumn(13);﷯sheet2.autoSizeColumn(14);﷯sheet2.autoSizeColumn(15);﷯sheet2.autoSizeColumn(16);﷯sheet2.autoSizeColumn(17);﷯sheet2.autoSizeColumn(18);
next=Icpitembatch.CPMessage
frm_calc=''Scrittura file Excel. '+Chr(13)+Chr(10)+"Elaborazione in corso..."
next=Icpitembatch.CPExec
check='man
frm_calc='// scrivo il file di esito﷯FileOutputStream fileOut = new FileOutputStream(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(gAzienda)+'/'+CPLib.LRTrim(nomefileoutput));﷯﷯//write this workbook to an Outputstream.﷯wb2.write(fileOut);﷯fileOut.flush();﷯fileOut.close();
obj='Exec
pag=5
prev=O1168
I
obj='Message
pag=5
prev=O1167
I
obj='Exec
pag=5
prev=O1166
I
obj='Message
pag=5
prev=O1164
I
obj='Try
pag=5
prev=O1163
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWhile
father=O1164
fatherSonIndex=0
frm_calc='_i < conta
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(_commit)
]
h=[
19
19
]
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=5
prev=O1174
I
obj='If
pag=5
prev=O1172
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1174
fatherSonIndex=0
frm_calc='transaction error
frm_seek='errore xlsx
obj='Transaction
pag=5
I
I
]
w=[
150
150
]
I
obj='While
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1172
fatherSonIndex=0
frm_calc='//Apro uno ad uno i fogli del file Excel﷯XSSFSheet sheet = wb.getSheetAt(_i);﷯//Mi definisco un oggetto che contiene tutte le righe﷯Iterator rows = sheet.rowIterator();﷯//_righe = sheet.getLastRowNum()+1;﷯//_y = 1;
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel
frm_calc='0
len=9
name='riga_letta
next=Icpitembatch.CPVarDecl
comment='foglio letto
frm_calc='_i
len=2
name='foglio
next=Icpitembatch.CPWhile
frm_calc='rows.hasNext() and _commit
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=5
prev=O1187
I
obj='While
pag=5
prev=O1186
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1187
fatherSonIndex=0
frm_calc='//scorro le righe﷯row=(XSSFRow) rows.next();﷯//Mi definisco un oggetto che contiene tutte le celle della riga letta﷯Iterator cells = row.cellIterator();
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='cell_count
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel
frm_calc='riga_letta+1
len=9
name='riga_letta
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='''
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='ok alla modifica dei dati
frm_calc='True
len=1
name='modifica
next=Icpitembatch.CPBeginEnd
comment='Azzeramento variabili colonne
h=[
19
19
]
next=Icpitembatch.CPWhile
frm_calc='cells.hasNext() and riga_letta>1
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'riga_letta>1
]
h=[
19
19
]
obj='If
pag=5
prev=O1199
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='riga letta del file Excel Character
father=O1201
fatherSonIndex=0
frm_calc='Str(riga_letta,9,0)
len=9
name='riga_letta_c
next=Icpitembatch.CPVarDecl
comment='foglio letto Character
frm_calc='Str(foglio,2,0)
len=9
name='foglio_c
next=Icpitembatch.CPExec
check='man
frm_calc='//Creo il record da scrivere﷯row2 = (XSSFRow) sheet2.createRow(r);﷯cell2 = (XSSFCell) row2.createCell(0);﷯cell2.setCellValue(CPLib.LRTrim(column14));﷯cell2 = (XSSFCell) row2.createCell(1);﷯cell2.setCellValue(CPLib.LRTrim(column15));﷯cell2 = (XSSFCell) row2.createCell(2);﷯cell2.setCellValue(CPLib.LRTrim(column16));﷯cell2 = (XSSFCell) row2.createCell(3);﷯cell2.setCellValue(CPLib.LRTrim(column01));﷯cell2 = (XSSFCell) row2.createCell(4);﷯cell2.setCellValue(CPLib.LRTrim(column02));﷯cell2 = (XSSFCell) row2.createCell(5);﷯cell2.setCellValue(CPLib.LRTrim(column03));﷯cell2 = (XSSFCell) row2.createCell(6);﷯cell2.setCellValue(CPLib.LRTrim(column04));﷯cell2 = (XSSFCell) row2.createCell(7);﷯cell2.setCellValue(CPLib.LRTrim(column05));﷯cell2 = (XSSFCell) row2.createCell(8);﷯cell2.setCellValue(CPLib.LRTrim(column06));﷯cell2 = (XSSFCell) row2.createCell(9);﷯cell2.setCellValue(CPLib.LRTrim(column07));﷯cell2 = (XSSFCell) row2.createCell(10);﷯cell2.setCellValue(CPLib.LRTrim(column08));﷯cell2 = (XSSFCell) row2.createCell(11);﷯cell2.setCellValue(CPLib.LRTrim(column09));﷯cell2 = (XSSFCell) row2.createCell(12);﷯cell2.setCellValue(CPLib.LRTrim(column10));﷯cell2 = (XSSFCell) row2.createCell(13);﷯cell2.setCellValue(CPLib.LRTrim(column11));﷯cell2 = (XSSFCell) row2.createCell(14);﷯cell2.setCellValue(CPLib.LRTrim(column12));﷯cell2 = (XSSFCell) row2.createCell(15);﷯cell2.setCellValue(CPLib.LRTrim(column13));﷯cell2 = (XSSFCell) row2.createCell(16);﷯cell2.setCellValue(CPLib.LRTrim(nota));﷯cell2 = (XSSFCell) row2.createCell(17);﷯cell2.setCellValue(CPLib.LRTrim(riga_letta_c));﷯cell2 = (XSSFCell) row2.createCell(18);﷯cell2.setCellValue(CPLib.LRTrim(foglio_c));﷯r++;
obj='Exec
pag=5
prev=O1207
I
obj='Var
pag=5
pagelocal=True
prev=O1206
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='While
pag=5
prev=O1197
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMessage
father=O1199
fatherSonIndex=0
frm_calc=''Sto leggendo riga: %1 del foglio %2.'+Chr(13)+Chr(10)+"Elaborazione in corso..."
msg_parms=[
'riga_letta
'foglio
]
next=Icpitembatch.CPExec
check='man
frm_calc='//scorro le celle della riga﷯cell=(XSSFCell) cells.next();
next=Icpitembatch.CPVarDecl
frm_calc='cell_count+1
len=9
name='cell_count
next=Icpitembatch.CPVarDecl
frm_calc='cell.getCellType().ordinal()
len=1
name='cell_type
next=Icpitembatch.CPRemark
frm_calc='cell.getColumnIndex() torna il valore della colonna letta partendo da 0
next=Icpitembatch.CPVarDecl
comment='numero della colonna letta
frm_calc='cell.getColumnIndex()
len=2
name='ncol
next=Icpitembatch.CPVarDecl
comment='numero della colonna letta
frm_calc='ncol+1
len=2
name='ncol
next=Icpitembatch.CPRemark
frm_calc='Salto le celle non tornate in modo che resti vuota la variabile relativa alla cella non tornata
next=Icpitembatch.CPWhile
frm_calc='cell_count<ncol
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cell_count=4 or cell_count=6 or cell_count=11 or cell_count=17 or (cell_count>18 and cell_count<23) or cell_count=24 or cell_count=26 or cell_count=31
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Se l'interetor delle celle è più corto di quanto doveva essere ipotizzo che sia un rivio diretto cosi come è senza variazioni. Vedi casistica colonna 31 vuota.
next=Icpitembatch.CPIfElse
frm_calc=[
'cell_count<30 and not(cells.hasNext())
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cell_count=31
]
h=[
19
19
]
obj='If
pag=5
prev=O1227
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1230
fatherSonIndex=0
frm_calc='System.out.println("Lettura foglio "+_i+" di "+conta+" riga letta "+riga_letta+" tipo: "+cell_type+" descrizione: *"+column13+"*");
obj='Exec
pag=5
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1226
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Descrizione
father=O1227
fatherSonIndex=0
frm_calc='''
len=16
name='column13
next=Icpitembatch.CPMessage
frm_calc=''Sto leggendo riga: %1 del foglio %2.'+Chr(13)+Chr(10)+"Elaborazione in corso..."+Chr(13)+Chr(10)+'Tipo cella: %3 valore letto: %4'
msg_parms=[
'riga_letta
'foglio
'cell_type
'column13
]
next=Icpitembatch.CPRemark
frm_calc='Presa la variabile CProgSto a caso, solo per verificare se viene modificato un solo record altrimenti blocco la routine
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cProgSto) or Len(cProgSto)>1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPExec
check='man
frm_calc='System.out.println("Lettura foglio "+_i+" di "+conta+" riga letta "+riga_letta+" tipo: "+cell_type+" descrizione: *"+column13+"*");
obj='Exec
pag=5
prev=O1246
I
obj='If
pag=5
prev=O1244
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='ok alla commit
father=O1246
fatherSonIndex=0
frm_calc='False
len=1
name='_commit
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'Nessun record trovato o più di uno riscontrato per la fase 2 alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Nessun record trovato o più di uno riscontrato per la fase 2 alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
obj='Var
pag=5
prev=O1252
var_op='asgn
I
obj='Var
obj_type='L
pag=5
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O1246
fatherSonIndex=1
frm_calc='iif(Empty(nota),'Record trovato e preparata la rettifica per la fase 2 alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Record trovato e preparata la rettifica per la fase 2 alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=5
prev=O1243
sel_field='*
sel_name='aeoprig
sel_where='aeoprig->CONNESINT=column02 and aeoprig->ASPEDITO=1 and aeoprig->IDESITO=column16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aeoprig
father=O1244
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cProgSto+'A'
len=15
name='cProgSto
obj='Var
pag=5
pagelocal=True
prev=O1259
var_op='asgn
I
obj='Write
pag=5
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'aeoprig->IDBASE
]
wr_field=[
'ADATARET
'RSPEDITO
'COLDFILE
'COLDPROG
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'w_DATARETT
'0
'''
'''
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
pagelocal=True
prev=O1242
var_op='asgn
I
obj='Remark
pag=5
prev=O1240
I
obj='Message
pag=5
prev=O1239
I
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=5
prev=O1223
I
obj='If
pag=5
prev=O1221
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O1223
fatherSonIndex=0
frm_calc=[
'cell_type=1
'cell_type=2
'cell_type=3
'cell_type=4
'cell_type=0
]
h=[
19
19
19
19
19
19
19
]
haselse=True
obj='Case
pag=5
sons=[
Icpitembatch.CPItemSon
comment='Tipo Numerico
instr=Icpitembatch.CPRemark
father=O1271
fatherSonIndex=0
frm_calc='tipo numerico﷯da definire il comportamento
next=Icpitembatch.CPCase
frm_calc=[
'cell_count=4
'cell_count=6
'cell_count=28
]
h=[
19
19
19
19
19
]
haselse=True
obj='Case
pag=5
prev=O1276
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Afile
father=O1277
fatherSonIndex=0
frm_calc='cell.getNumericCellValue()
len=15
name='column14num
next=Icpitembatch.CPVarDecl
comment='Afile
frm_calc='LRTrim(Str(column14num,15,0))
len=15
name='column14
obj='Var
pag=5
pagelocal=True
prev=O1282
var_op='asgn
I
obj='Var
obj_type='N
pag=5
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Aprog
father=O1277
fatherSonIndex=1
frm_calc='cell.getNumericCellValue()
len=25
name='column15num
next=Icpitembatch.CPVarDecl
comment='Aprog
frm_calc='LRTrim(Str(column15num,25,0))
len=25
name='column15
obj='Var
pag=5
pagelocal=True
prev=O1285
var_op='asgn
I
obj='Var
obj_type='N
pag=5
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O1277
fatherSonIndex=2
frm_calc='Quando la leggeva come numero
next=Icpitembatch.CPVarDecl
comment='data di nascita numerico
frm_calc='cell.getNumericCellValue()
len=99
name='column07num
next=Icpitembatch.CPVarDecl
comment='data di nascita
frm_calc='LRTrim(sdf.format(cell.getDateCellValue()))
len=25
name='column07
obj='Var
pag=5
pagelocal=True
prev=O1289
var_op='asgn
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1288
var_op='asgn
I
obj='Remark
pag=5
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O1277
fatherSonIndex=3
frm_calc='iif(Empty(nota),'Valore numerico alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Valore numerico alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='ok alla commit
frm_calc='False
len=1
name='_commit
obj='Var
obj_type='L
pag=5
pagelocal=True
prev=O1292
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Remark
pag=5
I
I
Icpitembatch.CPItemSon
comment='Tipo stringa
instr=Icpitembatch.CPCase
father=O1271
fatherSonIndex=1
frm_calc=[
'cell_count=4
'cell_count=6
'cell_count=11
'cell_count=20
'cell_count=17
'cell_count=19
'cell_count=21
'cell_count=22
'cell_count=28
'cell_count=24
'cell_count=26
'cell_count=31
]
h=[
19
19
19
19
19
19
19
19
19
19
19
19
19
]
obj='Case
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Afile
father=O1296
fatherSonIndex=0
frm_calc='LRTrim(cell.getStringCellValue())
len=15
name='column14
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Aprog
father=O1296
fatherSonIndex=1
frm_calc='LRTrim(cell.getStringCellValue())
len=25
name='column15
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Idesito
father=O1296
fatherSonIndex=2
frm_calc='LRTrim(cell.getStringCellValue())
len=8
name='column16
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='ragsoc
father=O1296
fatherSonIndex=3
frm_calc='LRTrim(cell.getStringCellValue())
len=25
name='column01
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='connes
father=O1296
fatherSonIndex=4
frm_calc='LRTrim(cell.getStringCellValue())
len=25
name='column02
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='CF
father=O1296
fatherSonIndex=5
frm_calc='LRTrim(cell.getStringCellValue())
len=25
name='column03
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nome
father=O1296
fatherSonIndex=6
frm_calc='LRTrim(cell.getStringCellValue())
len=25
name='column05
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Cognome
father=O1296
fatherSonIndex=7
frm_calc='LRTrim(cell.getStringCellValue())
len=25
name='column04
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='data di nascita
father=O1296
fatherSonIndex=8
frm_calc='LRTrim(cell.getStringCellValue())
len=25
name='column07
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='comune di nascita
father=O1296
fatherSonIndex=9
frm_calc='LRTrim(cell.getStringCellValue())
len=30
name='column08
next=Icpitembatch.CPVarDecl
comment='nazione di nascita
frm_calc='LRTrim(cell.getStringCellValue())
len=30
name='column09
obj='Var
pag=5
pagelocal=True
prev=O1319
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='provincia di nascita
father=O1296
fatherSonIndex=10
frm_calc='LRTrim(cell.getStringCellValue())
len=2
name='column10
next=Icpitembatch.CPVarDecl
comment='provincia di nascita
frm_calc='LRTrim(cell.getStringCellValue())
len=2
name='column11
obj='Var
pag=5
pagelocal=True
prev=O1322
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Descrizione
father=O1296
fatherSonIndex=11
frm_calc='LRTrim(cell.getStringCellValue())
len=16
name='column13
next=Icpitembatch.CPMessage
frm_calc=''Sto leggendo riga: %1 del foglio %2.'+Chr(13)+Chr(10)+"Elaborazione in corso..."+Chr(13)+Chr(10)+'Tipo cella: %3 valore letto: %4'
msg_parms=[
'riga_letta
'foglio
'cell_type
'column13
]
next=Icpitembatch.CPCase
frm_calc=[
'Empty(column13)
'column13='CANCELLARE E COMUNICARE NUOVA ANAGRAFICA CON CODICE FISCALE FITTIZIO' or column13='CANCELLARE MODIFICARE ANAGRAFICA E COMUNICARE COME FITTIZIO'
'column13='CANCELLARE E RICOMUNICARE COME FITTIZIO'
'column13='CANCELLARE IL CLIENTE NON ESISTE'
'column13='MODIFICARE E COMUNICARE CON CODICE FISCALE VERIFICATO'
]
h=[
19
19
19
19
19
19
19
]
haselse=True
obj='Case
pag=5
prev=O1326
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O1328
fatherSonIndex=0
frm_calc='Presa la variabile CProgSto a caso, solo per verificare se viene modificato un solo record altrimenti blocco la routine
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cProgSto) or Len(cProgSto)>1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1335
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='ok alla commit
father=O1337
fatherSonIndex=0
frm_calc='False
len=1
name='_commit
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'Nessun record trovato o più di uno riscontrato per la fase 2 alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Nessun record trovato o più di uno riscontrato per la fase 2 alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
obj='Var
pag=5
prev=O1342
var_op='asgn
I
obj='Var
obj_type='L
pag=5
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O1337
fatherSonIndex=1
frm_calc='iif(Empty(nota),'Record trovato e preparata la rettifica per la fase 2 alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Record trovato e preparata la rettifica per la fase 2 alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=5
prev=O1334
sel_field='*
sel_name='aeoprig
sel_where='aeoprig->CONNESINT=column02 and aeoprig->ASPEDITO=1 and aeoprig->IDESITO=column16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aeoprig
father=O1335
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cProgSto+'A'
len=15
name='cProgSto
obj='Var
pag=5
pagelocal=True
prev=O1349
var_op='asgn
I
obj='Write
pag=5
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'aeoprig->IDBASE
]
wr_field=[
'ADATARET
'RSPEDITO
'COLDFILE
'COLDPROG
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'w_DATARETT
'0
'''
'''
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
pagelocal=True
prev=O1333
var_op='asgn
I
obj='Remark
pag=5
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRemark
father=O1328
fatherSonIndex=1
frm_calc='SE variato CF o luogo di nascita o provincia devo prima registrare a storico la vecchi anagrafica. Altrimenti vari solo i dati dell'anagrafica.
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(column03)) or not(Empty(column08)) or not(Empty(column10))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_progrig
next=Icpitembatch.CPRemark
frm_calc='Creo la nuova riga su aeoprig per rinviarlo come estero.
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_progrig)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1365
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O1367
fatherSonIndex=0
frm_calc='iif(Empty(nota),'Esito non trovato alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Esito non trovato alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='ok alla commit
frm_calc='False
len=1
name='_commit
obj='Var
obj_type='L
pag=5
pagelocal=True
prev=O1372
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O1367
fatherSonIndex=1
frm_calc='iif(Empty(nota),'Esito trovato per rinvio come estero alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Esito trovato per rinvio come estero alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=5
prev=O1364
sel_field='*
sel_name='aeoprig
sel_where='aeoprig->CONNESINT=column02 and aeoprig->ASPEDITO=1 and aeoprig->IDESITO=column16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1365
fatherSonIndex=0
frm_calc='''
len=10
name='_progrig
next=Icpitembatch.CPRead
arch='aeopcanc
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_progrig))
]
h=[
19
19
]
obj='If
pag=5
prev=O1380
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='progressivo opextrbo
father=O1381
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGAEOPEXTR\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='_prog
next=Icpitembatch.CPVarDecl
comment='progressivo aeopig
frm_calc='Utilities.GetAutonumber("PROGAED\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aeoprig
next=Icpitembatch.CPWrite
arch='opextrbo
obj='Write
pag=5
prev=O1388
rd_kfield=[
'COLLEG
'DATAOPE
]
rd_kop=[
'=
'=
]
rd_kvar=[
'aeoprig->CONNESINT
'aeoprig->ADATA
]
wr_field=[
'NUMPROG1
]
wr_op=[
'=
]
wr_var=[
'_prog
]
I
obj='Insert
pag=5
prev=O1387
rd_kfield=[
'IDBASE
'CONNESINT
'ADATA
'TIPOAG
'COINT
'PROGOPX
'NOCODFISC
'ANNOOPE
]
rd_kvar=[
'_prog
'aeoprig->CONNESINT
'aeoprig->ADATA
'aeoprig->TIPOAG
'aeoprig->COINT
'nProgImp
''S'
'Year(aeoprig->ADATA)
]
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1386
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O1379
rd_field=[
'PROGRES
]
rd_kfield=[
'AFILE
'APROG
]
rd_kvar=[
'aeoprig->AFILE
'aeoprig->APROG
]
rd_var=[
'_progrig
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=5
prev=O1363
I
obj='Var
pag=5
prev=O1360
var_op='asgn
I
obj='If
pag=5
prev=O1359
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Crea lo storico dell'anagrafica
father=O1360
fatherSonIndex=0
h=[
19
19
]
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1406
fatherSonIndex=0
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
obj='If
pag=5
prev=O1411
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1413
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1418
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES = column02
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O1419
fatherSonIndex=0
next=Icpitembatch.CPRemark
frm_calc='Faccio la scrittura in base alle valorizzazioni iniziali e a seconda delle nuove.
next=Icpitembatch.CPIfElse
frm_calc=[
'personbo->TIPINTER='EE'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1424
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1425
fatherSonIndex=0
frm_calc=[
'LRTrim(column10)='EE'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='personbo
father=O1430
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'personbo->CONNES
]
wr_field=[
'CODFISC
'NASSTATO
'NASCOMUN
'CFESTERO
'COGNOME
'NOME
]
wr_op=[
'=
'=
'=
'=
'=
'=
]
wr_var=[
'iif(Empty(column03),personbo->CODFISC,LRTrim(column03))
'iif(Empty(column08),personbo->NASSTATO,LRTrim(column08))
'''
'1
'iif(Empty(column04),personbo->COGNOME,LRTrim(column04))
'iif(Empty(column05),personbo->NOME,LRTrim(column05))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='personbo
father=O1430
fatherSonIndex=1
obj='Write
pag=5
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'personbo->CONNES
]
wr_field=[
'CODFISC
'NASSTATO
'NASCOMUN
'TIPINTER
'CFESTERO
'COGNOME
'NOME
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'iif(Empty(column03),personbo->CODFISC,LRTrim(column03))
'''
'iif(Empty(column08),personbo->NASCOMUN,LRTrim(column08))
'iif(Empty(column10),personbo->TIPINTER,column10)
'1
'iif(Empty(column04),personbo->COGNOME,LRTrim(column04))
'iif(Empty(column05),personbo->NOME,LRTrim(column05))
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1425
fatherSonIndex=1
frm_calc=[
'LRTrim(column10)='EE'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='personbo
father=O1452
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'personbo->CONNES
]
wr_field=[
'CODFISC
'NASSTATO
'NASCOMUN
'TIPINTER
'CFESTERO
'COGNOME
'NOME
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'iif(Empty(column03),personbo->CODFISC,LRTrim(column03))
'iif(Empty(column08),personbo->NASSTATO,LRTrim(column08))
'''
''EE'
'1
'iif(Empty(column04),personbo->COGNOME,LRTrim(column04))
'iif(Empty(column05),personbo->NOME,LRTrim(column05))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='personbo
father=O1452
fatherSonIndex=1
obj='Write
pag=5
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'personbo->CONNES
]
wr_field=[
'CODFISC
'NASSTATO
'NASCOMUN
'TIPINTER
'CFESTERO
'COGNOME
'NOME
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'iif(Empty(column03),personbo->CODFISC,LRTrim(column03))
'''
'iif(Empty(column08),personbo->NASCOMUN,LRTrim(column08))
'iif(Empty(column10),personbo->TIPINTER,column10)
'1
'iif(Empty(column04),personbo->COGNOME,LRTrim(column04))
'iif(Empty(column05),personbo->NOME,LRTrim(column05))
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=5
prev=O1423
I
obj='Insert
pag=5
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'datamodi
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
]
rd_kvar=[
'cProgSto
'column02
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'gDataVaria
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1410
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=column02 and wersonbo->datamodi=w_DATARETT﷯
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1411
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1360
fatherSonIndex=1
frm_calc=[
'not(Empty(column04)) or not(Empty(column05))
]
h=[
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='personbo
father=O1484
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'personbo->CONNES
]
wr_field=[
'CFESTERO
'COGNOME
'NOME
]
wr_op=[
'=
'=
'=
]
wr_var=[
'1
'iif(Empty(column04),personbo->COGNOME,LRTrim(column04))
'iif(Empty(column05),personbo->NOME,LRTrim(column05))
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=5
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1328
fatherSonIndex=2
frm_calc='''
len=10
name='_progrig
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_progrig)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1500
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O1502
fatherSonIndex=0
frm_calc='iif(Empty(nota),'Esito non trovato alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Esito non trovato alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='ok alla commit
frm_calc='False
len=1
name='_commit
obj='Var
obj_type='L
pag=5
pagelocal=True
prev=O1507
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O1502
fatherSonIndex=1
frm_calc='iif(Empty(nota),'Esito trovato per rinvio come estero alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Esito trovato per rinvio come estero alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=5
prev=O1499
sel_field='*
sel_name='aeoprig
sel_where='aeoprig->CONNESINT=column02 and aeoprig->ASPEDITO=1 and aeoprig->IDESITO=column16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1500
fatherSonIndex=0
frm_calc='''
len=10
name='_progrig
next=Icpitembatch.CPRead
arch='aeopcanc
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_progrig))
]
h=[
19
19
]
obj='If
pag=5
prev=O1515
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='progressivo opextrbo
father=O1516
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGAEOPEXTR\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='_prog
next=Icpitembatch.CPVarDecl
comment='progressivo aeopig
frm_calc='Utilities.GetAutonumber("PROGAED\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aeoprig
next=Icpitembatch.CPWrite
arch='opextrbo
next=Icpitembatch.CPWrite
arch='personbo
obj='Write
pag=5
prev=O1524
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'aeoprig->CONNESINT
]
wr_field=[
'CFESTERO
]
wr_op=[
'=
]
wr_var=[
'1
]
I
obj='Write
pag=5
prev=O1523
rd_kfield=[
'COLLEG
'DATAOPE
]
rd_kop=[
'=
'=
]
rd_kvar=[
'aeoprig->CONNESINT
'aeoprig->ADATA
]
wr_field=[
'NUMPROG1
]
wr_op=[
'=
]
wr_var=[
'_prog
]
I
obj='Insert
pag=5
prev=O1522
rd_kfield=[
'IDBASE
'CONNESINT
'ADATA
'TIPOAG
'COINT
'PROGOPX
'NOCODFISC
'ANNOOPE
]
rd_kvar=[
'_prog
'aeoprig->CONNESINT
'aeoprig->ADATA
'aeoprig->TIPOAG
'aeoprig->COINT
'nProgImp
''S'
'Year(aeoprig->ADATA)
]
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1521
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O1514
rd_field=[
'PROGRES
]
rd_kfield=[
'AFILE
'APROG
]
rd_kvar=[
'aeoprig->AFILE
'aeoprig->APROG
]
rd_var=[
'_progrig
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O1328
fatherSonIndex=3
frm_calc='iif(Empty(nota),'Nessuna azione intrapresa per la fase 2 alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Nessuna azione intrapresa per la fase 2 alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O1328
fatherSonIndex=4
frm_calc='SE variato CF o luogo di nascita o provincia devo prima registrare a storico la vecchi anagrafica. Altrimenti vari solo i dati dell'anagrafica.
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(column03)) or not(Empty(column08)) or not(Empty(column10))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cProgSto) or Len(cProgSto)>1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1554
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='ok alla commit
father=O1556
fatherSonIndex=0
frm_calc='False
len=1
name='_commit
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'Nessun record trovato o più di uno riscontrato per la fase 2 alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Nessun record trovato o più di uno riscontrato per la fase 2 alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
obj='Var
pag=5
prev=O1561
var_op='asgn
I
obj='Var
obj_type='L
pag=5
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O1556
fatherSonIndex=1
frm_calc='iif(Empty(nota),'Record trovato e preparata la rettifica per la fase 2 alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Record trovato e preparata la rettifica per la fase 2 alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=5
prev=O1553
sel_field='*
sel_name='aeoprig
sel_where='aeoprig->CONNESINT=column02 and aeoprig->ASPEDITO=1 and aeoprig->IDESITO=column16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aeoprig
father=O1554
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cProgSto+'A'
len=15
name='cProgSto
obj='Var
pag=5
pagelocal=True
prev=O1568
var_op='asgn
I
obj='Write
pag=5
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'aeoprig->IDBASE
]
wr_field=[
'ADATARET
'RSPEDITO
'COLDFILE
'COLDPROG
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'w_DATARETT
'0
'''
'''
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
pagelocal=True
prev=O1550
var_op='asgn
I
obj='If
pag=5
prev=O1549
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Crea lo storico dell'anagrafica
father=O1550
fatherSonIndex=0
h=[
19
19
]
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1579
fatherSonIndex=0
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
obj='If
pag=5
prev=O1584
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1586
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1591
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES = LRTrim(column02)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O1592
fatherSonIndex=0
next=Icpitembatch.CPRemark
frm_calc='Faccio la scrittura in base alle valorizzazioni iniziali e a seconda delle nuove.
next=Icpitembatch.CPIfElse
frm_calc=[
'personbo->TIPINTER='EE'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1597
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1598
fatherSonIndex=0
frm_calc=[
'LRTrim(column10)='EE'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='personbo
father=O1603
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'personbo->CONNES
]
wr_field=[
'CODFISC
'NASSTATO
'NASCOMUN
'CFESTERO
'COGNOME
'NOME
]
wr_op=[
'=
'=
'=
'=
'=
'=
]
wr_var=[
'iif(Empty(column03),personbo->CODFISC,LRTrim(column03))
'iif(Empty(column08),personbo->NASSTATO,LRTrim(column08))
'''
'0
'iif(Empty(column04),personbo->COGNOME,LRTrim(column04))
'iif(Empty(column05),personbo->NOME,LRTrim(column05))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='personbo
father=O1603
fatherSonIndex=1
obj='Write
pag=5
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'personbo->CONNES
]
wr_field=[
'CODFISC
'NASSTATO
'NASCOMUN
'TIPINTER
'CFESTERO
'COGNOME
'NOME
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'iif(Empty(column03),personbo->CODFISC,LRTrim(column03))
'''
'iif(Empty(column08),personbo->NASCOMUN,LRTrim(column08))
'iif(Empty(column10),personbo->TIPINTER,column10)
'0
'iif(Empty(column04),personbo->COGNOME,LRTrim(column04))
'iif(Empty(column05),personbo->NOME,LRTrim(column05))
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1598
fatherSonIndex=1
frm_calc=[
'LRTrim(column10)='EE'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='personbo
father=O1625
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'personbo->CONNES
]
wr_field=[
'CODFISC
'NASSTATO
'NASCOMUN
'TIPINTER
'CFESTERO
'COGNOME
'NOME
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'iif(Empty(column03),personbo->CODFISC,LRTrim(column03))
'iif(Empty(column08),personbo->NASSTATO,LRTrim(column08))
'''
''EE'
'0
'iif(Empty(column04),personbo->COGNOME,LRTrim(column04))
'iif(Empty(column05),personbo->NOME,LRTrim(column05))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='personbo
father=O1625
fatherSonIndex=1
obj='Write
pag=5
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'personbo->CONNES
]
wr_field=[
'CODFISC
'NASSTATO
'NASCOMUN
'TIPINTER
'CFESTERO
'COGNOME
'NOME
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'iif(Empty(column03),personbo->CODFISC,LRTrim(column03))
'''
'iif(Empty(column08),personbo->NASCOMUN,LRTrim(column08))
'iif(Empty(column10),personbo->TIPINTER,column10)
'0
'iif(Empty(column04),personbo->COGNOME,LRTrim(column04))
'iif(Empty(column05),personbo->NOME,LRTrim(column05))
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=5
prev=O1596
I
obj='Insert
pag=5
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'datamodi
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
]
rd_kvar=[
'cProgSto
'column02
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'gDataVaria
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1583
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=column02 and wersonbo->datamodi=w_DATARETT﷯
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1584
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='ok alla commit
father=O1550
fatherSonIndex=1
frm_calc='False
len=1
name='_commit
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'Nessuna variazione del soggetto per la fase 2 alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Nessuna variazione del soggetto per la fase 2 alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
obj='Var
pag=5
prev=O1657
var_op='asgn
I
obj='Var
obj_type='L
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=5
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O1328
fatherSonIndex=5
frm_calc='iif(Empty(nota),'Valore non previsto alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Valore non previsto alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
next=Icpitembatch.CPIfElse
frm_calc=[
'cell_count<32
]
h=[
19
19
]
obj='If
pag=5
prev=O1661
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='ok alla commit
father=O1662
fatherSonIndex=0
frm_calc='False
len=1
name='_commit
obj='Var
obj_type='L
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
150
150
150
150
]
I
obj='Message
pag=5
prev=O1325
I
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
150
150
150
150
150
150
150
150
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
comment='Tipo formula
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O1271
fatherSonIndex=2
frm_calc='iif(Empty(nota),'Formula alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Formula alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='ok alla commit
frm_calc='False
len=1
name='_commit
obj='Var
obj_type='L
pag=5
pagelocal=True
prev=O1672
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='Tipo vuoto
instr=Icpitembatch.CPCase
father=O1271
fatherSonIndex=3
frm_calc=[
'cell_count=19
'cell_count=21
'cell_count=22
'cell_count=24
'cell_count=26
'cell_count=31
]
h=[
19
19
19
19
19
19
19
19
]
haselse=True
obj='Case
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='CF
father=O1675
fatherSonIndex=0
frm_calc='''
len=25
name='column03
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (CF vuoto)',nota+' Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (CF vuoto)')
len=100
name='nota
obj='Var
pag=5
prev=O1680
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nome
father=O1675
fatherSonIndex=1
frm_calc='''
len=25
name='column05
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (nome vuoto)',nota+' Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (nome vuoto)')
len=100
name='nota
obj='Var
pag=5
prev=O1683
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Cognome
father=O1675
fatherSonIndex=2
frm_calc='''
len=25
name='column04
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (cognome vuoto)',nota+' Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (cognome vuoto)')
len=100
name='nota
obj='Var
pag=5
prev=O1686
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='comune di nascita
father=O1675
fatherSonIndex=3
frm_calc='''
len=30
name='column08
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (comune vuoto)',nota+' Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (comune vuoto)')
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='nazione di nascita
frm_calc='''
len=30
name='column09
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (stato vuoto)',nota+' Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (stato vuoto)')
len=100
name='nota
obj='Var
pag=5
prev=O1691
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
prev=O1690
var_op='asgn
I
obj='Var
pag=5
prev=O1689
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='provincia di nascita
father=O1675
fatherSonIndex=4
frm_calc='''
len=2
name='column10
next=Icpitembatch.CPVarDecl
comment='provincia di nascita
frm_calc='''
len=2
name='column11
obj='Var
pag=5
pagelocal=True
prev=O1694
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Descrizione
father=O1675
fatherSonIndex=5
frm_calc='''
len=16
name='column13
next=Icpitembatch.CPMessage
frm_calc=''Sto leggendo riga: %1 del foglio %2.'+Chr(13)+Chr(10)+"Elaborazione in corso..."+Chr(13)+Chr(10)+'Tipo cella: %3 valore letto: %4'
msg_parms=[
'riga_letta
'foglio
'cell_type
'column13
]
next=Icpitembatch.CPRemark
frm_calc='Presa la variabile CProgSto a caso, solo per verificare se viene modificato un solo record altrimenti blocco la routine
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cProgSto) or Len(cProgSto)>1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1702
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='ok alla commit
father=O1704
fatherSonIndex=0
frm_calc='False
len=1
name='_commit
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'Nessun record trovato o più di uno riscontrato per la fase 2 alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Nessun record trovato o più di uno riscontrato per la fase 2 alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
obj='Var
pag=5
prev=O1709
var_op='asgn
I
obj='Var
obj_type='L
pag=5
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O1704
fatherSonIndex=1
frm_calc='iif(Empty(nota),'Record trovato e preparata la rettifica per la fase 2 alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Record trovato e preparata la rettifica per la fase 2 alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=5
prev=O1701
sel_field='*
sel_name='aeoprig
sel_where='aeoprig->CONNESINT=column02 and aeoprig->ASPEDITO=1 and aeoprig->IDESITO=column16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aeoprig
father=O1702
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cProgSto+'A'
len=15
name='cProgSto
obj='Var
pag=5
pagelocal=True
prev=O1716
var_op='asgn
I
obj='Write
pag=5
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'aeoprig->IDBASE
]
wr_field=[
'ADATARET
'RSPEDITO
'COLDFILE
'COLDPROG
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'w_DATARETT
'0
'''
'''
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
pagelocal=True
prev=O1700
var_op='asgn
I
obj='Remark
pag=5
prev=O1698
I
obj='Message
pag=5
prev=O1697
I
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O1675
fatherSonIndex=6
frm_calc='iif(Empty(nota),'Valore vuoto alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Valore vuoto alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
next=Icpitembatch.CPIfElse
frm_calc=[
'cell_count<32
]
h=[
19
19
]
obj='If
pag=5
prev=O1726
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='ok alla commit
father=O1727
fatherSonIndex=0
frm_calc='False
len=1
name='_commit
obj='Var
obj_type='L
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
150
150
150
150
150
]
I
I
Icpitembatch.CPItemSon
comment='tipo booleano
instr=Icpitembatch.CPRemark
father=O1271
fatherSonIndex=4
frm_calc='tipo buleano﷯da definire il comportamento
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'Valore buleano alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Valore buleano alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='ok alla commit
frm_calc='False
len=1
name='_commit
obj='Var
obj_type='L
pag=5
pagelocal=True
prev=O1737
var_op='asgn
I
obj='Var
pag=5
prev=O1736
var_op='asgn
I
obj='Remark
pag=5
I
I
Icpitembatch.CPItemSon
comment='tipo non supportato
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O1271
fatherSonIndex=5
frm_calc='iif(Empty(nota),'Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0)),nota+' Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0)))
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='ok alla commit
frm_calc='False
len=1
name='_commit
obj='Var
obj_type='L
pag=5
pagelocal=True
prev=O1740
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='While
pag=5
prev=O1220
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1221
fatherSonIndex=0
frm_calc='cell_count+1
len=9
name='cell_count
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=5
prev=O1219
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1218
var_op='asgn
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1217
var_op='asgn
I
obj='Remark
pag=5
prev=O1216
I
obj='Var
obj_type='N
pag=5
prev=O1215
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1214
var_op='asgn
I
obj='Exec
pag=5
prev=O1212
I
obj='Message
pag=5
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
prev=O1196
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
comment='ragsoc
father=O1197
fatherSonIndex=0
frm_calc='''
len=25
name='column01
next=Icpitembatch.CPVarDecl
comment='connes
frm_calc='''
len=25
name='column02
next=Icpitembatch.CPVarDecl
comment='CF
frm_calc='''
len=25
name='column03
next=Icpitembatch.CPVarDecl
comment='Cognome
frm_calc='''
len=25
name='column04
next=Icpitembatch.CPVarDecl
comment='nome
frm_calc='''
len=25
name='column05
next=Icpitembatch.CPVarDecl
comment='sesso
frm_calc='''
len=25
name='column06
next=Icpitembatch.CPVarDecl
comment='sesso numerico
frm_calc='0
len=1
name='column06num
next=Icpitembatch.CPVarDecl
comment='data di nascita
frm_calc='''
len=25
name='column07
next=Icpitembatch.CPVarDecl
comment='data di nascita numerico
frm_calc='0
len=99
name='column07num
next=Icpitembatch.CPVarDecl
comment='data di nascita data
frm_calc='NullDate()
len=8
name='column07date
next=Icpitembatch.CPVarDecl
comment='comune di nascita
frm_calc='''
len=30
name='column08
next=Icpitembatch.CPVarDecl
comment='nazione di nascita
frm_calc='''
len=30
name='column09
next=Icpitembatch.CPVarDecl
comment='provincia di nascita
frm_calc='''
len=2
name='column10
next=Icpitembatch.CPVarDecl
comment='provincia di nascita
frm_calc='''
len=2
name='column11
next=Icpitembatch.CPVarDecl
comment='cfestero
frm_calc='''
len=1
name='column12
next=Icpitembatch.CPVarDecl
comment='cfestero numerico
frm_calc='0
len=1
name='column12num
next=Icpitembatch.CPVarDecl
comment='Descrizione
frm_calc='''
len=16
name='column13
next=Icpitembatch.CPVarDecl
comment='Afile
frm_calc='''
len=15
name='column14
next=Icpitembatch.CPVarDecl
comment='Afile
frm_calc='0
len=15
name='column14num
next=Icpitembatch.CPVarDecl
comment='Aprog
frm_calc='''
len=25
name='column15
next=Icpitembatch.CPVarDecl
comment='Aprog
frm_calc='0
len=25
name='column15num
next=Icpitembatch.CPVarDecl
comment='Idesito
frm_calc='''
len=8
name='column16
obj='Var
pag=5
pagelocal=True
prev=O1771
var_op='asgn
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1770
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
prev=O1769
var_op='asgn
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1768
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
prev=O1767
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
prev=O1766
var_op='asgn
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1765
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
prev=O1764
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
prev=O1763
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
prev=O1762
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
prev=O1761
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
prev=O1760
var_op='asgn
I
obj='Var
obj_type='D
pag=5
pagelocal=True
prev=O1759
var_op='asgn
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1758
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
prev=O1757
var_op='asgn
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1756
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
prev=O1755
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
prev=O1754
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
prev=O1753
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
prev=O1752
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
prev=O1751
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='L
pag=5
prev=O1195
var_op='asgn
I
obj='Var
pag=5
prev=O1194
var_op='asgn
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1193
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1192
var_op='asgn
I
obj='Exec
pag=5
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1185
var_op='asgn
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1184
var_op='asgn
I
obj='Exec
pag=5
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1164
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=5
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=5
prev=O1162
I
obj='Var
obj_type='L
pag=5
pagelocal=True
prev=O1161
var_op='asgn
I
obj='Exec
pag=5
prev=O1159
I
obj='Begin
pag=5
prev=O1157
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1159
fatherSonIndex=0
frm_calc='// creo il contenitore dei fogli﷯XSSFWorkbook wb2 = new XSSFWorkbook();﷯XSSFSheet sheet2 = wb2.createSheet(sheetName) ;
obj='Exec
pag=5
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
prev=O1156
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1157
fatherSonIndex=0
frm_calc='//base﷯InputStream ExcelFileToRead = new FileInputStream(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(gAzienda)+'/'+CPLib.LRTrim(nomefile));﷯XSSFWorkbook  wb = new XSSFWorkbook(ExcelFileToRead);﷯﷯conta = wb.getNumberOfSheets();﷯﷯//XSSFWorkbook test = new XSSFWorkbook(); ﷯﷯//XSSFSheet sheet = wb.getSheetAt(0);﷯XSSFRow row; ﷯XSSFCell cell;﷯﷯XSSFRow row2; ﷯XSSFCell cell2;﷯﷯//Iterator rows = sheet.rowIterator();
obj='Exec
pag=5
I
I
]
w=[
150
150
]
I
obj='Message
pag=5
prev=O1155
I
nonlocal=True
obj='Var
obj_type='D
pag=5
prev=O1154
var_op='asgn
I
obj='Var
obj_type='D
pag=5
pagelocal=True
prev=O1153
var_op='asgn
I
obj='Var
obj_type='D
pag=5
pagelocal=True
prev=O1152
var_op='asgn
I
obj='Var
obj_type='D
pag=5
pagelocal=True
prev=O1151
var_op='asgn
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1149
var_op='asgn
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
comment='ragsoc
father=O1149
fatherSonIndex=0
len=25
name='column01
next=Icpitembatch.CPVarDecl
comment='connes
len=25
name='column02
next=Icpitembatch.CPVarDecl
comment='CF
len=25
name='column03
next=Icpitembatch.CPVarDecl
comment='Cognome
len=25
name='column04
next=Icpitembatch.CPVarDecl
comment='nome
len=25
name='column05
next=Icpitembatch.CPVarDecl
comment='sesso
len=25
name='column06
next=Icpitembatch.CPVarDecl
comment='sesso numerico
len=1
name='column06num
next=Icpitembatch.CPVarDecl
comment='data di nascita
len=25
name='column07
next=Icpitembatch.CPVarDecl
comment='data di nascita numerico
len=99
name='column07num
next=Icpitembatch.CPVarDecl
comment='data di nascita data
len=8
name='column07date
next=Icpitembatch.CPVarDecl
comment='comune di nascita
len=30
name='column08
next=Icpitembatch.CPVarDecl
comment='nazione di nascita
len=30
name='column09
next=Icpitembatch.CPVarDecl
comment='provincia di nascita
len=2
name='column10
next=Icpitembatch.CPVarDecl
comment='provincia di nascita
len=2
name='column11
next=Icpitembatch.CPVarDecl
comment='cfestero
len=1
name='column12
next=Icpitembatch.CPVarDecl
comment='cfestero numerico
len=1
name='column12num
next=Icpitembatch.CPVarDecl
comment='Descrizione
len=16
name='column13
next=Icpitembatch.CPVarDecl
comment='Afile
len=15
name='column14num
next=Icpitembatch.CPVarDecl
comment='Afile
len=15
name='column14
next=Icpitembatch.CPVarDecl
comment='Aprog
len=25
name='column15num
next=Icpitembatch.CPVarDecl
comment='Aprog
len=25
name='column15
next=Icpitembatch.CPVarDecl
comment='Idesito
len=8
name='column16
next=Icpitembatch.CPVarDecl
comment='ok alla commit
len=1
name='_commit
next=Icpitembatch.CPVarDecl
comment='fallimento scrittura dati
len=1
name='_falied
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel
len=9
name='riga_letta
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel Character
len=9
name='riga_letta_c
next=Icpitembatch.CPVarDecl
comment='data di base Excel
len=8
name='date_base_excel
next=Icpitembatch.CPVarDecl
comment='numero della colonna letta
len=2
name='ncol
next=Icpitembatch.CPVarDecl
comment='foglio letto
len=2
name='foglio
next=Icpitembatch.CPVarDecl
comment='foglio letto Character
len=9
name='foglio_c
next=Icpitembatch.CPVarDecl
comment='progressivo wersonbo del giorno
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
comment='data rettifica
len=8
name='w_DATARETT
next=Icpitembatch.CPVarDecl
len=10
name='cCanc
next=Icpitembatch.CPVarDecl
len=10
name='cProg
next=Icpitembatch.CPVarDecl
len=10
name='_progrig
next=Icpitembatch.CPVarDecl
comment='progressivo opextrbo
len=10
name='_prog
next=Icpitembatch.CPVarDecl
comment='progressivo aeopig
len=15
name='nProgImp
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1824
I
obj='Var
pag=5
pagelocal=True
prev=O1823
I
obj='Var
pag=5
pagelocal=True
prev=O1822
I
obj='Var
pag=5
pagelocal=True
prev=O1821
I
obj='Var
pag=5
pagelocal=True
prev=O1820
I
obj='Var
obj_type='D
pag=5
pagelocal=True
prev=O1819
I
obj='Var
pag=5
pagelocal=True
prev=O1818
I
obj='Var
pag=5
pagelocal=True
prev=O1817
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1816
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1815
I
obj='Var
obj_type='D
pag=5
pagelocal=True
prev=O1814
I
obj='Var
pag=5
pagelocal=True
prev=O1813
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1812
I
obj='Var
obj_type='L
pag=5
pagelocal=True
prev=O1811
I
obj='Var
obj_type='L
pag=5
pagelocal=True
prev=O1810
I
obj='Var
pag=5
pagelocal=True
prev=O1809
I
obj='Var
pag=5
pagelocal=True
prev=O1808
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1807
I
obj='Var
pag=5
pagelocal=True
prev=O1806
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1805
I
obj='Var
pag=5
pagelocal=True
prev=O1804
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1803
I
obj='Var
pag=5
pagelocal=True
prev=O1802
I
obj='Var
pag=5
pagelocal=True
prev=O1801
I
obj='Var
pag=5
pagelocal=True
prev=O1800
I
obj='Var
pag=5
pagelocal=True
prev=O1799
I
obj='Var
pag=5
pagelocal=True
prev=O1798
I
obj='Var
obj_type='D
pag=5
pagelocal=True
prev=O1797
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1796
I
obj='Var
pag=5
pagelocal=True
prev=O1795
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1794
I
obj='Var
pag=5
pagelocal=True
prev=O1793
I
obj='Var
pag=5
pagelocal=True
prev=O1792
I
obj='Var
pag=5
pagelocal=True
prev=O1791
I
obj='Var
pag=5
pagelocal=True
prev=O1790
I
obj='Var
pag=5
pagelocal=True
prev=O1789
I
obj='Var
pag=5
pagelocal=True
I
I
]
w=[
150
150
]
x=10
y=0
I
Icpitembatch.CPBeginEnd
comment='variabili di colonna
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='operazione già cancellata
frm_calc='False
len=1
name='del_ope
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel
frm_calc='0
len=9
name='riga_letta
next=Icpitembatch.CPBeginEnd
comment='Apro il foglio //e verifico quante pagine ha
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Creo file per risultati
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='//Azzero i contatori di fogli letti e righe scritte﷯_i = 0;﷯r=0;﷯//Creo il record da scrivere﷯row2 = (XSSFRow) sheet2.createRow(r);﷯//scrivo la riga di intestazione﷯cell2 = (XSSFCell) row2.createCell(0);﷯cell2.setCellValue("NOPERAZIONE");﷯cell2 = (XSSFCell) row2.createCell(1);﷯cell2.setCellValue("TIPO");﷯cell2 = (XSSFCell) row2.createCell(2);﷯cell2.setCellValue("DATA_OP");﷯cell2 = (XSSFCell) row2.createCell(3);﷯cell2.setCellValue("IMPORTO");﷯cell2 = (XSSFCell) row2.createCell(4);﷯cell2.setCellValue("NDG_CLIENTE");﷯cell2 = (XSSFCell) row2.createCell(5);﷯cell2.setCellValue("Note");﷯cell2 = (XSSFCell) row2.createCell(6);﷯cell2.setCellValue("Riga");﷯r++;
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='// Ridimensiono le colonne﷯_i=0;
next=Icpitembatch.CPWhile
frm_calc='_i<7
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc=''Scrittura del file di esito. Elaborazione in corso...'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPExec
check='man
frm_calc='// scrivo il file di esito﷯FileOutputStream fileOut = new FileOutputStream(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(gAzienda)+'/'+CPLib.LRTrim(nomefileoutput));﷯﷯//write this workbook to an Outputstream.﷯wb2.write(fileOut);﷯fileOut.flush();﷯fileOut.close();
next=Icpitembatch.CPVarDecl
frm_calc=''Elaborazione terminata!'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=6
prev=O1843
var_op='asgn
I
obj='Exec
pag=6
prev=O1842
I
nonlocal=True
obj='Var
pag=6
prev=O1840
var_op='asgn
I
obj='While
pag=6
prev=O1839
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1840
fatherSonIndex=0
frm_calc=''Autodimensionamento delle celle della colonna '+Str(_i,1,0)+' in base al contenuto. Elaborazione in corso...'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPExec
check='man
frm_calc='//Ridimensiono le colonne in base al contenuto﷯_i++;
obj='Exec
pag=6
prev=O1847
I
nonlocal=True
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Exec
pag=6
prev=O1837
I
obj='Try
pag=6
prev=O1836
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1837
fatherSonIndex=0
frm_calc=''Lettura del file in corso. Elaborazione in corso...'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWhile
frm_calc='_i < conta
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='la rimetto a False cosi salvo la modifca tanto non me ne frega che siano già cancellate
next=Icpitembatch.CPVarDecl
comment='operazione già cancellata
frm_calc='False
len=1
name='del_ope
next=Icpitembatch.CPIfElse
frm_calc=[
'del_ope
]
h=[
19
19
]
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=6
prev=O1857
I
obj='If
pag=6
prev=O1856
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1857
fatherSonIndex=0
frm_calc='transaction error
frm_seek='Impossibile cancellare un'operazione frazionata già cancellata o copia di modifica!
obj='Transaction
pag=6
raise_on_trans_err=True
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='L
pag=6
pagelocal=True
prev=O1855
var_op='asgn
I
obj='Remark
pag=6
prev=O1853
I
obj='While
pag=6
prev=O1852
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1853
fatherSonIndex=0
frm_calc='//Apro uno ad uno i fogli del file Excel﷯XSSFSheet sheet = wb.getSheetAt(_i);﷯//Mi definisco un oggetto che contiene tutte le righe﷯Iterator rows = sheet.rowIterator();﷯//_righe = sheet.getLastRowNum()+1;﷯//_y = 1;
next=Icpitembatch.CPVarDecl
comment='foglio letto
frm_calc='_i
len=2
name='foglio
next=Icpitembatch.CPWhile
frm_calc='rows.hasNext()
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=6
prev=O1869
I
obj='While
pag=6
prev=O1868
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1869
fatherSonIndex=0
frm_calc='//scorro le righe﷯row=(XSSFRow) rows.next();﷯//Mi definisco un oggetto che contiene tutte le celle della riga letta﷯Iterator cells = row.cellIterator();
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='cell_count
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel
frm_calc='riga_letta+1
len=9
name='riga_letta
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='''
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='ok alla modifica dei dati
frm_calc='True
len=1
name='modifica
next=Icpitembatch.CPWhile
frm_calc='cells.hasNext() and riga_letta>1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc=''Sto leggendo riga: '+LRTrim(Str(riga_letta,10,0))+". Elaborazione in corso ...."
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'riga_letta>1
]
h=[
19
19
]
obj='If
pag=6
prev=O1881
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1882
fatherSonIndex=0
frm_calc='Str(riga_letta,9,0)
len=9
name='riga_letta_c
next=Icpitembatch.CPExec
check='man
frm_calc='//Creo il record da scrivere﷯row2 = (XSSFRow) sheet2.createRow(r);﷯cell2 = (XSSFCell) row2.createCell(0);﷯cell2.setCellValue(CPLib.LRTrim(column01));﷯cell2 = (XSSFCell) row2.createCell(1);﷯cell2.setCellValue(CPLib.LRTrim(column02));﷯cell2 = (XSSFCell) row2.createCell(2);﷯cell2.setCellValue(CPLib.LRTrim(column03));﷯cell2 = (XSSFCell) row2.createCell(3);﷯cell2.setCellValue(CPLib.LRTrim(column04));﷯cell2 = (XSSFCell) row2.createCell(4);﷯cell2.setCellValue(CPLib.LRTrim(column05));﷯cell2 = (XSSFCell) row2.createCell(5);﷯cell2.setCellValue(CPLib.LRTrim(nota));﷯cell2 = (XSSFCell) row2.createCell(6);﷯cell2.setCellValue(CPLib.LRTrim(riga_letta_c));﷯r++;
obj='Exec
pag=6
prev=O1887
I
obj='Var
pag=6
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=6
prev=O1879
var_op='asgn
I
obj='While
pag=6
prev=O1878
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1879
fatherSonIndex=0
frm_calc='//scorro le celle della riga﷯cell=(XSSFCell) cells.next();
next=Icpitembatch.CPVarDecl
frm_calc='cell_count+1
len=9
name='cell_count
next=Icpitembatch.CPVarDecl
frm_calc='cell.getCellType().ordinal()
len=1
name='cell_type
next=Icpitembatch.CPCase
frm_calc=[
'cell_type=1
'cell_type=2
'cell_type=3
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'cell_count=5
]
h=[
19
19
]
obj='If
pag=6
prev=O1895
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1898
fatherSonIndex=0
frm_calc='''
len=10
name='_idbase
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_statoreg
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'',nota)+iif(Empty(_idbase),'Operazione non trovata','Operazione trovata')
len=100
name='nota
next=Icpitembatch.CPBeginEnd
comment='Aggiorna l'operazione e verifica se deve sistemare anche le extraconto
h=[
19
19
]
obj='Begin
pag=6
prev=O1907
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1908
fatherSonIndex=0
frm_calc=[
'At(_statoreg,"|0|1") > 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='fraziobo
expected_rows=1
father=O1912
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'',nota)+' - Operazione cancellata.'
len=100
name='nota
obj='Var
pag=6
prev=O1917
var_op='asgn
I
obj='Write
pag=6
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_idbase
]
wr_field=[
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
]
wr_var=[
''2'
'oggi
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O1912
fatherSonIndex=1
frm_calc='iif(Empty(nota),'',nota)+' - Operazione già cancellata.'
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='operazione già cancellata
frm_calc='True
len=1
name='del_ope
obj='Var
obj_type='L
pag=6
pagelocal=True
prev=O1926
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O1905
var_op='asgn
I
obj='Select
pag=6
prev=O1904
sel_field='fraziobo->IDBASE,fraziobo->STATOREG
sel_name='fraziobo
sel_where='fraziobo->NUMPROG=column01 and fraziobo->DATAOPE=CharToDate(column03) and fraziobo->TOTLIRE=column04_num*100 and fraziobo->CONNESCLI=column05
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1905
fatherSonIndex=0
frm_calc=[
'fraziobo->STATOREG = '0' or fraziobo->STATOREG = '1'
]
h=[
19
19
]
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1932
fatherSonIndex=0
frm_calc='fraziobo->IDBASE
len=10
name='_idbase
next=Icpitembatch.CPVarDecl
frm_calc='fraziobo->STATOREG
len=1
name='_statoreg
obj='Var
pag=6
pagelocal=True
prev=O1937
var_op='asgn
I
obj='Var
pag=6
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
pagelocal=True
prev=O1903
var_op='asgn
I
obj='Var
pag=6
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Case
pag=6
prev=O1894
sons=[
Icpitembatch.CPItemSon
comment='Tipo Numerico
instr=Icpitembatch.CPCase
father=O1895
fatherSonIndex=0
frm_calc=[
'cell_count=1
'cell_count=2
'cell_count=3
'cell_count=4
'cell_count=5
]
h=[
19
19
19
19
19
19
]
obj='Case
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
dec=2
father=O1944
fatherSonIndex=0
frm_calc='cell.getNumericCellValue()
len=15
name='column01_num
next=Icpitembatch.CPVarDecl
frm_calc='Right(Replicate('0',11)+LRTrim(Str(column01_num,11,0)),11)
len=500
name='column01
obj='Var
pag=6
pagelocal=True
prev=O1949
var_op='asgn
I
obj='Var
obj_type='N
pag=6
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
dec=2
father=O1944
fatherSonIndex=1
frm_calc='cell.getNumericCellValue()
len=15
name='column02_num
next=Icpitembatch.CPVarDecl
frm_calc='Str(column02_num,15,2)
len=500
name='column02
obj='Var
pag=6
pagelocal=True
prev=O1952
var_op='asgn
I
obj='Var
obj_type='N
pag=6
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
dec=2
father=O1944
fatherSonIndex=2
frm_calc='cell.getNumericCellValue()
len=15
name='column03_num
next=Icpitembatch.CPVarDecl
frm_calc='sdf.format(cell.getDateCellValue())
len=500
name='column03
obj='Var
pag=6
pagelocal=True
prev=O1955
var_op='asgn
I
obj='Var
obj_type='N
pag=6
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
dec=2
father=O1944
fatherSonIndex=3
frm_calc='cell.getNumericCellValue()
len=15
name='column04_num
next=Icpitembatch.CPVarDecl
frm_calc='Str(column04_num,15,2)
len=500
name='column04
obj='Var
pag=6
pagelocal=True
prev=O1958
var_op='asgn
I
obj='Var
obj_type='N
pag=6
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
dec=2
father=O1944
fatherSonIndex=4
frm_calc='cell.getNumericCellValue()
len=15
name='column05_num
next=Icpitembatch.CPVarDecl
frm_calc='Str(column05_num,15,2)
len=500
name='column05
obj='Var
pag=6
pagelocal=True
prev=O1961
var_op='asgn
I
obj='Var
obj_type='N
pag=6
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
150
150
150
]
I
I
Icpitembatch.CPItemSon
comment='Tipo Stringa
instr=Icpitembatch.CPCase
father=O1895
fatherSonIndex=1
frm_calc=[
'cell_count=1
'cell_count=2
'cell_count=3
'cell_count=4
'cell_count=5
]
h=[
19
19
19
19
19
19
]
obj='Case
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1965
fatherSonIndex=0
frm_calc='cell.getStringCellValue()
len=500
name='column01
obj='Var
pag=6
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1965
fatherSonIndex=1
frm_calc='cell.getStringCellValue()
len=500
name='column02
obj='Var
pag=6
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1965
fatherSonIndex=2
frm_calc='cell.getStringCellValue()
len=500
name='column03
obj='Var
pag=6
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1965
fatherSonIndex=3
frm_calc='cell.getStringCellValue()
len=500
name='column04
obj='Var
pag=6
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1965
fatherSonIndex=4
frm_calc='cell.getStringCellValue()
len=500
name='column05
obj='Var
pag=6
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
150
150
150
]
I
I
Icpitembatch.CPItemSon
I
Icpitembatch.CPItemSon
I
]
w=[
150
150
150
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O1893
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O1892
var_op='asgn
I
obj='Exec
pag=6
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='L
pag=6
prev=O1877
var_op='asgn
I
obj='Var
pag=6
prev=O1876
var_op='asgn
I
obj='Var
obj_type='N
pag=6
pagelocal=True
prev=O1875
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O1874
var_op='asgn
I
obj='Exec
pag=6
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
pagelocal=True
prev=O1867
var_op='asgn
I
obj='Exec
pag=6
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMessage
father=O1837
fatherSonIndex=1
frm_calc=''Errore SQL: ' + m_Sql.TransactionErrorMessage() + NL
msg_type='Error
next=Icpitembatch.CPTransaction
frm_calc='rollback
obj='Transaction
pag=6
prev=O1987
I
obj='Message
pag=6
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=6
prev=O1835
I
obj='Exec
pag=6
prev=O1833
I
obj='Begin
pag=6
prev=O1831
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1833
fatherSonIndex=0
frm_calc='// creo il contenitore dei fogli﷯XSSFWorkbook wb2 = new XSSFWorkbook();﷯XSSFSheet sheet2 = wb2.createSheet(sheetName) ;
obj='Exec
pag=6
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
prev=O1830
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1831
fatherSonIndex=0
frm_calc='//base﷯InputStream ExcelFileToRead = new FileInputStream(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(gAzienda)+'/'+CPLib.LRTrim(nomefile));﷯XSSFWorkbook  wb = new XSSFWorkbook(ExcelFileToRead);﷯﷯conta = wb.getNumberOfSheets();﷯﷯//XSSFWorkbook test = new XSSFWorkbook(); ﷯﷯//XSSFSheet sheet = wb.getSheetAt(0);﷯XSSFRow row; ﷯XSSFCell cell;﷯﷯XSSFRow row2; ﷯XSSFCell cell2;﷯﷯//Iterator rows = sheet.rowIterator();
obj='Exec
pag=6
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
pagelocal=True
prev=O1829
var_op='asgn
I
obj='Var
obj_type='L
pag=6
pagelocal=True
prev=O1827
var_op='asgn
I
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Variabili per colonne stringhe
father=O1827
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne numeriche
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='variabili per lettura excel
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili locali
h=[
19
19
]
obj='Begin
pag=6
prev=O2004
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='stato dell'operazione
father=O2006
fatherSonIndex=0
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
comment='operazione già cancellata
len=1
name='del_ope
obj='Var
obj_type='L
pag=6
pagelocal=True
prev=O2010
I
obj='Var
pag=6
pagelocal=True
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
prev=O2002
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='foglio letto
father=O2004
fatherSonIndex=0
len=2
name='foglio
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel
len=9
name='riga_letta
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel Character
len=9
name='riga_letta_c
next=Icpitembatch.CPVarDecl
comment='data rettifica
len=8
name='w_DATARETT
next=Icpitembatch.CPVarDecl
comment='progressivo wersonbo del giorno
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
comment='idbase letto
len=10
name='_idbase
obj='Var
pag=6
pagelocal=True
prev=O2019
I
obj='Var
pag=6
pagelocal=True
prev=O2018
I
obj='Var
obj_type='D
pag=6
pagelocal=True
prev=O2017
I
obj='Var
pag=6
pagelocal=True
prev=O2016
I
obj='Var
obj_type='N
pag=6
pagelocal=True
prev=O2015
I
obj='Var
obj_type='N
pag=6
pagelocal=True
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
prev=O2000
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
dec=2
father=O2002
fatherSonIndex=0
len=15
name='column01_num
next=Icpitembatch.CPVarDecl
dec=2
len=15
name='column02_num
next=Icpitembatch.CPVarDecl
dec=2
len=15
name='column03_num
next=Icpitembatch.CPVarDecl
dec=2
len=15
name='column04_num
next=Icpitembatch.CPVarDecl
dec=2
len=15
name='column05_num
next=Icpitembatch.CPVarDecl
dec=2
len=15
name='column06_num
next=Icpitembatch.CPVarDecl
dec=2
len=15
name='column07_num
next=Icpitembatch.CPVarDecl
dec=2
len=15
name='column08_num
obj='Var
obj_type='N
pag=6
pagelocal=True
prev=O2030
I
obj='Var
obj_type='N
pag=6
pagelocal=True
prev=O2029
I
obj='Var
obj_type='N
pag=6
pagelocal=True
prev=O2028
I
obj='Var
obj_type='N
pag=6
pagelocal=True
prev=O2027
I
obj='Var
obj_type='N
pag=6
pagelocal=True
prev=O2026
I
obj='Var
obj_type='N
pag=6
pagelocal=True
prev=O2025
I
obj='Var
obj_type='N
pag=6
pagelocal=True
prev=O2024
I
obj='Var
obj_type='N
pag=6
pagelocal=True
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2000
fatherSonIndex=0
len=500
name='column01
next=Icpitembatch.CPVarDecl
len=500
name='column02
next=Icpitembatch.CPVarDecl
len=500
name='column03
next=Icpitembatch.CPVarDecl
len=500
name='column04
next=Icpitembatch.CPVarDecl
len=500
name='column05
next=Icpitembatch.CPVarDecl
len=500
name='column06
next=Icpitembatch.CPVarDecl
len=500
name='column07
next=Icpitembatch.CPVarDecl
len=500
name='column08
obj='Var
pag=6
pagelocal=True
prev=O2041
I
obj='Var
pag=6
pagelocal=True
prev=O2040
I
obj='Var
pag=6
pagelocal=True
prev=O2039
I
obj='Var
pag=6
pagelocal=True
prev=O2038
I
obj='Var
pag=6
pagelocal=True
prev=O2037
I
obj='Var
pag=6
pagelocal=True
prev=O2036
I
obj='Var
pag=6
pagelocal=True
prev=O2035
I
obj='Var
pag=6
pagelocal=True
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
x=8
y=8
I
Icpitembatch.CPVarDecl
frm_calc='Str(column03_num,15,2)
len=500
name='column03
obj='Var
pag=6
pagelocal=True
var_op='asgn
x=454
y=2541
I
Icpitembatch.CPVarDecl
frm_calc='Str(column01_num,15,2)
len=500
name='column01
obj='Var
pag=6
pagelocal=True
var_op='asgn
x=592
y=2374
I
Icpitembatch.CPBeginEnd
comment='Variabili per colonne stringhe
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne numeriche
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Creo file per risultati
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel
frm_calc='0
len=9
name='riga_letta
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='// Prepara le colonne al ridimensionamento﷯_i=0;
next=Icpitembatch.CPWhile
frm_calc='_i<9
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc=''Scrittura del file di esito. Elaborazione in corso...'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPExec
check='man
frm_calc='// scrivo il file di esito﷯FileOutputStream fileOut = new FileOutputStream(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(gAzienda)+'/'+CPLib.LRTrim(nomefileoutput));﷯﷯//write this workbook to an Outputstream.﷯wb2.write(fileOut);﷯fileOut.flush();﷯fileOut.close();
next=Icpitembatch.CPVarDecl
frm_calc=''Elaborazione terminata!'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=7
prev=O2063
var_op='asgn
I
obj='Exec
pag=7
prev=O2062
I
nonlocal=True
obj='Var
pag=7
prev=O2060
var_op='asgn
I
obj='While
pag=7
prev=O2059
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2060
fatherSonIndex=0
frm_calc=''Autodimensionamento delle celle della colonna '+Str(_i,1,0)+' in base al contenuto. Elaborazione in corso...'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPExec
check='man
frm_calc='//Ridimensiono le colonne in base al contenuto﷯_i++;
obj='Exec
pag=7
prev=O2067
I
nonlocal=True
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Exec
pag=7
prev=O2057
I
obj='Try
pag=7
prev=O2056
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2057
fatherSonIndex=0
frm_calc=''Lettura del file in corso. Elaborazione in corso...'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc=''JLMNOTUV?'
len=10
name='stringaflagrap2
next=Icpitembatch.CPBeginEnd
comment='Ciclo di lettura del CSV
h=[
19
19
]
next=Icpitembatch.CPTransaction
frm_calc='commit
next=Icpitembatch.CPExec
frm_calc='reader.close()
obj='Exec
pag=7
prev=O2076
I
obj='Transaction
pag=7
prev=O2074
I
obj='Begin
pag=7
prev=O2073
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O2074
fatherSonIndex=0
frm_calc='// Apre il file CSV﷯FileReader freader=new FileReader(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(gAzienda)+'/'+CPLib.LRTrim(nomefile));﷯CSVReader reader = new CSVReaderBuilder(freader).withCSVParser(new CSVParserBuilder().withSeparator(';').build()).build();﷯String [] nextLine;﷯// Legge il CSV﷯while ((nextLine = reader.readNext()) != null) {
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_idbase
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='''
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel
frm_calc='riga_letta+1
len=9
name='riga_letta
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[0]
len=500
name='column01
next=Icpitembatch.CPVarDecl
frm_calc='Right(Replicate('0',11)+LRTrim(column01),11)
len=500
name='column01
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[1]
len=500
name='column02
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[2]
len=500
name='column03
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[3]
len=500
name='column04
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[4]
len=500
name='column05
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[5]
len=500
name='column06
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[6]
len=500
name='column07
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_statoreg
next=Icpitembatch.CPRead
arch='fraziobo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_idbase)
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'',nota)+iif(Empty(_idbase),'Operazione non trovata.','Operazione trovata.')+' Stato Registrazione: '+_statoreg
len=100
name='nota
next=Icpitembatch.CPIfElse
frm_calc=[
'At(_statoreg,"|0|1") > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc=''Sto leggendo riga: '+LRTrim(Str(riga_letta,10,0))+". Elaborazione in corso ...."
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'riga_letta>1
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='}
obj='Exec
pag=7
prev=O2103
I
obj='If
pag=7
prev=O2102
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2103
fatherSonIndex=0
frm_calc='Str(riga_letta,9,0)
len=9
name='riga_letta_c
next=Icpitembatch.CPExec
check='man
frm_calc='//Creo il record da scrivere﷯row2 = (XSSFRow) sheet2.createRow(r);﷯cell2 = (XSSFCell) row2.createCell(0);﷯cell2.setCellValue(CPLib.LRTrim(column01));﷯cell2 = (XSSFCell) row2.createCell(1);﷯cell2.setCellValue(CPLib.LRTrim(column02));﷯cell2 = (XSSFCell) row2.createCell(2);﷯cell2.setCellValue(CPLib.LRTrim(column03));﷯cell2 = (XSSFCell) row2.createCell(3);﷯cell2.setCellValue(CPLib.LRTrim(column04));﷯cell2 = (XSSFCell) row2.createCell(4);﷯cell2.setCellValue(CPLib.LRTrim(column05));﷯cell2 = (XSSFCell) row2.createCell(5);﷯cell2.setCellValue(CPLib.LRTrim(column06));﷯cell2 = (XSSFCell) row2.createCell(6);﷯cell2.setCellValue(CPLib.LRTrim(column07));﷯cell2 = (XSSFCell) row2.createCell(7);﷯cell2.setCellValue(CPLib.LRTrim(nota));﷯cell2 = (XSSFCell) row2.createCell(8);﷯cell2.setCellValue(CPLib.LRTrim(riga_letta_c));﷯r++;
obj='Exec
pag=7
prev=O2109
I
obj='Var
pag=7
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=7
prev=O2099
var_op='asgn
I
obj='If
pag=7
prev=O2098
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2099
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(column02))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O2114
fatherSonIndex=0
frm_calc='iif(Empty(nota),'',nota)+" - Operazione senza dati dell'agenzia."
len=100
name='nota
obj='Var
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2114
fatherSonIndex=1
frm_calc='''
len=6
name='_cab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_desccit
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTbcitta.GoToKey(LRTrim(column05))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_cab))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=7
prev=O2123
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O2126
fatherSonIndex=0
frm_calc='iif(Empty(nota),'',nota)+'Dipendenza senza CAB'+NL
len=100
name='nota
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=7
prev=O2131
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_idbase
]
wr_field=[
'INFORM
'RIFIMP
]
wr_op=[
'=
'=
]
wr_var=[
'LRTrim(column07)
'"XXXXXXXXX"
]
I
obj='Var
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Crea rettifica operazione
father=O2126
fatherSonIndex=1
h=[
19
19
]
obj='Begin
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2140
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(gAzienda)+"'",Space(10),10)
len=10
name='cNewProg
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=7
prev=O2145
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_idbase
]
wr_field=[
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
]
wr_var=[
''3'
'Date()
]
I
obj='Select
pag=7
prev=O2144
sel_field='*
sel_name='fraziobo
sel_where='fraziobo->IDBASE=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2145
fatherSonIndex=0
frm_calc='iif(Empty(fraziobo->FLAGRAP2) or fraziobo->FLAGRAP2='Z',Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(fraziobo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
comment='Idbase
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idbase2
next=Icpitembatch.CPVarDecl
comment='Stato Registrazione
frm_calc=''F'+Right(fraziobo->NUMPROG,9)+_idbase2
len=20
name='_idereg
next=Icpitembatch.CPInsert
arch='fraziobo
obj='Insert
pag=7
prev=O2158
rd_kfield=[
'AMMONT
'AREAGEO
'AUTOM
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESDOC
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'IDFILE
'INFORM
'IPCOLLEG
'MODSVOL
'MTCN
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
'IDBASE2
]
rd_kvar=[
'fraziobo->AMMONT
'fraziobo->AREAGEO
'fraziobo->AUTOM
'fraziobo->C_CAB
'fraziobo->C_CAP
'fraziobo->C_CTA
'fraziobo->C_IND
'fraziobo->C_PRV
'fraziobo->C_RAG
'fraziobo->C_RAPPORTO
'fraziobo->C_STA
'fraziobo->CAMBIO
'fraziobo->CDATAOPE
'fraziobo->CDATOPE
'fraziobo->CDATREG
'fraziobo->CODANA
'_cab
'fraziobo->CODCAB2
'Left(LRTrim(column02),6)
'fraziobo->CODINT2
'fraziobo->CODINTER
'fraziobo->CODVOC
'fraziobo->COLLEG
'fraziobo->CONNALTRO
'fraziobo->CONNESBEN
'fraziobo->CONNESCLI
'fraziobo->CONNESDOC
'fraziobo->CONNESOPER
'fraziobo->DATAIMP
'fraziobo->DATAOPE
'fraziobo->DATAREG
'Date()
'fraziobo->DESC2
'Left(LRTrim(column05),30)
'fraziobo->DESCINTER
'fraziobo->DOCFILE
'fraziobo->DUCOLLEG
'fraziobo->DURAT
'fraziobo->FLAGCONT
'fraziobo->FLAGFRAZ
'fraziobo->FLAGLIRE
'fraziobo->FLAGRAP
'_flagrap2
'cNewProg
'fraziobo->idcauana
'_idereg
'fraziobo->IDFILE
'LRTrim(column07)
'fraziobo->IPCOLLEG
'fraziobo->MODSVOL
'fraziobo->MTCN
'fraziobo->NATURA
'fraziobo->NOPROT
'fraziobo->NUMPROG
'fraziobo->OPERAG
'fraziobo->OPERATORE
'fraziobo->IDEREG
'fraziobo->OPRAP
'fraziobo->ORACOLLEG
'fraziobo->PAESE
'fraziobo->PAGASOGOP
'fraziobo->PRGIMPFRZ
'fraziobo->PROV2
'Left(LRTrim(column06),2)
'fraziobo->RAGIO
'fraziobo->RAPPORTBEN
'fraziobo->RAPPORTO
'fraziobo->RAREA
'fraziobo->RCOMP
'fraziobo->RESPINS
'fraziobo->RFREQ
''XXXXXXXXX'
'fraziobo->RIMP
'fraziobo->RRAGIO
'fraziobo->RTIPO
'fraziobo->SCOPO
'fraziobo->SEGNO
''1'
'fraziobo->TIPO
'fraziobo->TIPOINF
'fraziobo->TIPOINT2
'fraziobo->TIPOINTER
'fraziobo->TIPOLEG
'fraziobo->TIPOOPRAP
'fraziobo->TOTCONT
'fraziobo->TOTLIRE
'fraziobo->UCODE
'fraziobo->UNIQUECODE
'fraziobo->VALUTA
'fraziobo->ZCPARTE
'_idbase2
]
I
obj='Var
pag=7
pagelocal=True
prev=O2157
var_op='asgn
I
obj='Var
pag=7
pagelocal=True
prev=O2156
var_op='asgn
I
obj='Var
pag=7
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=7
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=7
prev=O2122
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2123
fatherSonIndex=0
frm_calc='mcTbcitta.CAB
len=6
name='_cab
obj='Var
pag=7
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2123
fatherSonIndex=1
frm_calc=[
'mcAnadip.GoToKey(LRTrim(column02))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2169
fatherSonIndex=0
frm_calc='mcAnadip.CAB
len=6
name='_cab
next=Icpitembatch.CPVarDecl
frm_calc='mcAnadip.DESCCIT
len=30
name='_desccit
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_cab)
]
h=[
19
19
]
obj='If
pag=7
prev=O2175
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2176
fatherSonIndex=0
frm_calc=[
'mcTbcitta.GoToKey(LRTrim(_desccit))
]
h=[
19
19
]
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2181
fatherSonIndex=0
frm_calc='mcTbcitta.CAB
len=6
name='_cab
obj='Var
pag=7
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=7
pagelocal=True
prev=O2174
var_op='asgn
I
obj='Var
pag=7
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O2169
fatherSonIndex=1
frm_calc='iif(Empty(nota),'',nota)+" - Agenzia non presente nell'AUI."
len=100
name='nota
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=7
pagelocal=True
prev=O2121
var_op='asgn
I
obj='Var
pag=7
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=7
prev=O2095
var_op='asgn
I
obj='If
pag=7
prev=O2094
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O2095
fatherSonIndex=0
obj='Read
pag=7
rd_field=[
'IDBASE
'STATOREG
]
rd_kfield=[
'NUMPROG
'STATOREG
]
rd_kvar=[
'column01
''1'
]
rd_var=[
'_idbase
'_statoreg
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=7
prev=O2093
rd_field=[
'IDBASE
'STATOREG
]
rd_kfield=[
'NUMPROG
'STATOREG
]
rd_kvar=[
'column01
''0'
]
rd_var=[
'_idbase
'_statoreg
]
I
obj='Var
pag=7
pagelocal=True
prev=O2092
var_op='asgn
I
obj='Var
pag=7
pagelocal=True
prev=O2091
var_op='asgn
I
obj='Var
pag=7
pagelocal=True
prev=O2090
var_op='asgn
I
obj='Var
pag=7
pagelocal=True
prev=O2089
var_op='asgn
I
obj='Var
pag=7
pagelocal=True
prev=O2088
var_op='asgn
I
obj='Var
pag=7
pagelocal=True
prev=O2087
var_op='asgn
I
obj='Var
pag=7
pagelocal=True
prev=O2086
var_op='asgn
I
obj='Var
pag=7
pagelocal=True
prev=O2085
var_op='asgn
I
obj='Var
pag=7
pagelocal=True
prev=O2084
var_op='asgn
I
obj='Var
obj_type='N
pag=7
pagelocal=True
prev=O2083
var_op='asgn
I
obj='Var
pag=7
prev=O2082
var_op='asgn
I
obj='Var
pag=7
pagelocal=True
prev=O2081
var_op='asgn
I
obj='Var
pag=7
pagelocal=True
prev=O2080
var_op='asgn
I
obj='Exec
pag=7
I
I
]
w=[
150
150
]
I
obj='Var
pag=7
pagelocal=True
prev=O2072
var_op='asgn
I
nonlocal=True
obj='Var
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMessage
father=O2057
fatherSonIndex=1
frm_calc=''Errore SQL: ' + m_Sql.TransactionErrorMessage() + NL
msg_type='Error
next=Icpitembatch.CPTransaction
frm_calc='rollback
obj='Transaction
pag=7
prev=O2209
I
obj='Message
pag=7
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=7
prev=O2055
I
obj='Var
obj_type='N
pag=7
pagelocal=True
prev=O2053
var_op='asgn
I
obj='Begin
pag=7
prev=O2051
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPExec
check='man
father=O2053
fatherSonIndex=0
frm_calc='// creo il contenitore dei fogli﷯XSSFWorkbook wb2 = new XSSFWorkbook();﷯XSSFSheet sheet2 = wb2.createSheet(sheetName) ;﷯XSSFRow row2; ﷯XSSFCell cell2;﷯//Azzero i contatori di fogli letti e righe scritte﷯_i = 0;﷯r=0;﷯//Creo il record da scrivere﷯row2 = (XSSFRow) sheet2.createRow(r);﷯//scrivo la riga di intestazione﷯cell2 = (XSSFCell) row2.createCell(0);﷯cell2.setCellValue("NOPERAZIONE");﷯cell2 = (XSSFCell) row2.createCell(1);﷯cell2.setCellValue("CODICE AGENZIA");﷯cell2 = (XSSFCell) row2.createCell(2);﷯cell2.setCellValue("AGENZIA");﷯cell2 = (XSSFCell) row2.createCell(3);﷯cell2.setCellValue("INDIRIZZO");﷯cell2 = (XSSFCell) row2.createCell(4);﷯cell2.setCellValue("CITTA");﷯cell2 = (XSSFCell) row2.createCell(5);﷯cell2.setCellValue("PROVINCIA");﷯cell2 = (XSSFCell) row2.createCell(6);﷯cell2.setCellValue("MCTN");﷯cell2 = (XSSFCell) row2.createCell(7);﷯cell2.setCellValue("Note");﷯cell2 = (XSSFCell) row2.createCell(8);﷯cell2.setCellValue("Riga");﷯r++;
obj='Exec
pag=7
I
I
]
w=[
150
150
]
I
obj='Begin
pag=7
prev=O2049
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='idbase letto
father=O2051
fatherSonIndex=0
len=10
name='_idbase
next=Icpitembatch.CPVarDecl
comment='stato dell'operazione
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel
len=9
name='riga_letta
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel Character
len=9
name='riga_letta_c
next=Icpitembatch.CPVarDecl
len=10
name='cNewProg
next=Icpitembatch.CPVarDecl
len=20
name='_idereg
next=Icpitembatch.CPVarDecl
len=10
name='_idbase2
next=Icpitembatch.CPVarDecl
len=6
name='_cab
next=Icpitembatch.CPVarDecl
len=10
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
len=30
name='_desccit
obj='Var
pag=7
pagelocal=True
prev=O2227
I
obj='Var
pag=7
pagelocal=True
prev=O2226
I
obj='Var
pag=7
pagelocal=True
prev=O2225
I
obj='Var
pag=7
pagelocal=True
prev=O2224
I
obj='Var
pag=7
pagelocal=True
prev=O2223
I
obj='Var
pag=7
pagelocal=True
prev=O2222
I
obj='Var
pag=7
pagelocal=True
prev=O2221
I
obj='Var
pag=7
pagelocal=True
prev=O2220
I
obj='Var
obj_type='N
pag=7
pagelocal=True
prev=O2219
I
obj='Var
pag=7
pagelocal=True
prev=O2218
I
obj='Var
pag=7
pagelocal=True
I
I
]
w=[
150
150
]
I
obj='Begin
pag=7
prev=O2047
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
dec=2
father=O2049
fatherSonIndex=0
len=15
name='column01_num
next=Icpitembatch.CPVarDecl
dec=2
len=15
name='column02_num
next=Icpitembatch.CPVarDecl
dec=2
len=15
name='column03_num
next=Icpitembatch.CPVarDecl
dec=2
len=15
name='column04_num
next=Icpitembatch.CPVarDecl
dec=2
len=15
name='column05_num
next=Icpitembatch.CPVarDecl
dec=2
len=15
name='column06_num
next=Icpitembatch.CPVarDecl
dec=2
len=15
name='column07_num
next=Icpitembatch.CPVarDecl
dec=2
len=15
name='column08_num
obj='Var
obj_type='N
pag=7
pagelocal=True
prev=O2238
I
obj='Var
obj_type='N
pag=7
pagelocal=True
prev=O2237
I
obj='Var
obj_type='N
pag=7
pagelocal=True
prev=O2236
I
obj='Var
obj_type='N
pag=7
pagelocal=True
prev=O2235
I
obj='Var
obj_type='N
pag=7
pagelocal=True
prev=O2234
I
obj='Var
obj_type='N
pag=7
pagelocal=True
prev=O2233
I
obj='Var
obj_type='N
pag=7
pagelocal=True
prev=O2232
I
obj='Var
obj_type='N
pag=7
pagelocal=True
I
I
]
w=[
150
150
]
I
obj='Begin
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2047
fatherSonIndex=0
len=500
name='column01
next=Icpitembatch.CPVarDecl
len=500
name='column02
next=Icpitembatch.CPVarDecl
len=500
name='column03
next=Icpitembatch.CPVarDecl
len=500
name='column04
next=Icpitembatch.CPVarDecl
len=500
name='column05
next=Icpitembatch.CPVarDecl
len=500
name='column06
next=Icpitembatch.CPVarDecl
len=500
name='column07
next=Icpitembatch.CPVarDecl
len=500
name='column08
obj='Var
pag=7
pagelocal=True
prev=O2249
I
obj='Var
pag=7
pagelocal=True
prev=O2248
I
obj='Var
pag=7
pagelocal=True
prev=O2247
I
obj='Var
pag=7
pagelocal=True
prev=O2246
I
obj='Var
pag=7
pagelocal=True
prev=O2245
I
obj='Var
pag=7
pagelocal=True
prev=O2244
I
obj='Var
pag=7
pagelocal=True
prev=O2243
I
obj='Var
pag=7
pagelocal=True
I
I
]
w=[
150
150
]
x=8
y=8
I
Icpitembatch.CPBeginEnd
comment='Parametri del batch
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Dichiarazione Variabili Globali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Data odierna per le modifiche
frm_calc='Date()
len=8
name='oggi
next=Icpitembatch.CPVarDecl
comment='nome file da importare
frm_calc=''realFC.xlsx'
len=30
name='nomefile
next=Icpitembatch.CPVarDecl
comment='nome file risultati
frm_calc=''realFC_out.xlsx'
len=30
name='nomefileoutput
next=Icpitembatch.CPVarDecl
frm_calc=''Ora Inizio Elaborazione: '+ arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'pselezione<>'S' and pselezione <> 'M'
'pselezione='M'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Elaborazione: '+ arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O2264
var_op='asgn
I
obj='If
pag=1
prev=O2263
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2264
fatherSonIndex=0
frm_calc=[
'FileLibMit.ExistFile(LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+'/'+LRTrim(nomefile))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMessage
father=O2270
fatherSonIndex=0
frm_calc=''Apertura file Excel. '+Chr(13)+Chr(10)+"Elaborazione in corso..."
next=Icpitembatch.CPVarDecl
comment='data rettifica
frm_calc='Date()
len=8
name='w_DATARETT
next=Icpitembatch.CPVarDecl
comment='data rettifica
frm_calc='CharToDate('01/08/2016')
len=8
name='w_DATARETT
next=Icpitembatch.CPVarDecl
comment='data rettifica
frm_calc='datamod
len=8
name='w_DATARETT
next=Icpitembatch.CPVarDecl
comment='Data Variazione
frm_calc='w_DATARETT
global=True
len=8
name='gDataVaria
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel
frm_calc='0
len=9
name='riga_letta
next=Icpitembatch.CPBeginEnd
comment='Apro il foglio //e verifico quante pagine ha
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Creo file per risultati
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='//Azzero i contatori di fogli letti e righe scritte﷯_i = 0;﷯r=0;﷯//Creo il record da scrivere﷯row2 = (XSSFRow) sheet2.createRow(r);﷯//scrivo la riga di intestazione﷯cell2 = (XSSFCell) row2.createCell(0);﷯cell2.setCellValue("CF_old");﷯cell2 = (XSSFCell) row2.createCell(1);﷯cell2.setCellValue("CF_new");﷯cell2 = (XSSFCell) row2.createCell(2);﷯cell2.setCellValue("note");﷯cell2 = (XSSFCell) row2.createCell(3);﷯cell2.setCellValue("Riga");﷯r++;
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='//Ridimensiono le colonne in base al contenuto﷯sheet2.autoSizeColumn(0);﷯sheet2.autoSizeColumn(1);﷯sheet2.autoSizeColumn(2);﷯sheet2.autoSizeColumn(3);
next=Icpitembatch.CPExec
check='man
frm_calc='// scrivo il file di esito﷯FileOutputStream fileOut = new FileOutputStream(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(gAzienda)+'/'+CPLib.LRTrim(nomefileoutput));﷯﷯//write this workbook to an Outputstream.﷯wb2.write(fileOut);﷯fileOut.flush();﷯fileOut.close();
obj='Exec
pag=1
prev=O2289
I
obj='Exec
pag=1
prev=O2287
I
obj='Try
pag=1
prev=O2286
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWhile
father=O2287
fatherSonIndex=0
frm_calc='_i < conta
h=[
19
19
]
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=1
prev=O2293
I
obj='While
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O2293
fatherSonIndex=0
frm_calc='//Apro uno ad uno i fogli del file Excel﷯XSSFSheet sheet = wb.getSheetAt(_i);﷯//Mi definisco un oggetto che contiene tutte le righe﷯Iterator rows = sheet.rowIterator();﷯//_righe = sheet.getLastRowNum()+1;﷯//_y = 1;
next=Icpitembatch.CPVarDecl
comment='foglio letto
frm_calc='_i
len=2
name='foglio
next=Icpitembatch.CPWhile
frm_calc='rows.hasNext()
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=1
prev=O2300
I
obj='While
pag=1
prev=O2299
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O2300
fatherSonIndex=0
frm_calc='//scorro le righe﷯row=(XSSFRow) rows.next();﷯//Mi definisco un oggetto che contiene tutte le celle della riga letta﷯Iterator cells = row.cellIterator();
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='cell_count
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel
frm_calc='riga_letta+1
len=9
name='riga_letta
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='''
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='ok alla modifica dei dati
frm_calc='True
len=1
name='modifica
next=Icpitembatch.CPWhile
frm_calc='cells.hasNext() and riga_letta>1
h=[
19
19
]
next=Icpitembatch.CPMessage
frm_calc=''Sto leggendo riga: %1 del foglio %2.'+Chr(13)+Chr(10)+"Elaborazione in corso..."
msg_parms=[
'riga_letta
'foglio
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sto leggendo la riga n. '+LRTrim(Str(riga_letta,10,0))+". Elaborazione in corso...."
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'riga_letta>1
]
h=[
19
19
]
obj='If
pag=1
prev=O2314
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2315
fatherSonIndex=0
frm_calc='Str(riga_letta,9,0)
len=9
name='riga_letta_c
next=Icpitembatch.CPExec
check='man
frm_calc='//Creo il record da scrivere﷯row2 = (XSSFRow) sheet2.createRow(r);﷯cell2 = (XSSFCell) row2.createCell(0);﷯cell2.setCellValue(CPLib.LRTrim(column01));﷯cell2 = (XSSFCell) row2.createCell(1);﷯cell2.setCellValue(CPLib.LRTrim(column02));﷯cell2 = (XSSFCell) row2.createCell(2);﷯cell2.setCellValue(CPLib.LRTrim(nota));﷯cell2 = (XSSFCell) row2.createCell(3);﷯cell2.setCellValue(CPLib.LRTrim(riga_letta_c));﷯r++;
obj='Exec
pag=1
prev=O2320
I
obj='Var
pag=1
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=1
prev=O2312
var_op='asgn
I
obj='Message
pag=1
prev=O2310
I
obj='While
pag=1
prev=O2309
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O2310
fatherSonIndex=0
frm_calc='//scorro le celle della riga﷯cell=(XSSFCell) cells.next();
next=Icpitembatch.CPVarDecl
frm_calc='cell_count+1
len=9
name='cell_count
next=Icpitembatch.CPVarDecl
frm_calc='cell.getCellType().ordinal()
len=1
name='cell_type
next=Icpitembatch.CPCase
frm_calc=[
'cell_type=1
'cell_type=2
'cell_type=0
'cell_type=3
]
h=[
19
19
19
19
19
19
]
haselse=True
obj='Case
pag=1
prev=O2327
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Tipo Numerico
instr=Icpitembatch.CPRemark
father=O2328
fatherSonIndex=0
frm_calc='tipo numerico﷯da definire il comportamento
obj='Remark
pag=1
I
I
Icpitembatch.CPItemSon
comment='Tipo stringa
instr=Icpitembatch.CPIfElse
father=O2328
fatherSonIndex=1
frm_calc=[
'cell_count=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cell_count=2
]
h=[
19
19
]
obj='If
pag=1
prev=O2335
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2338
fatherSonIndex=0
frm_calc='cell.getStringCellValue()
len=25
name='column02
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column01)))
]
h=[
19
19
]
obj='If
pag=1
prev=O2343
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2344
fatherSonIndex=0
frm_calc=[
'Len(LRTrim(column01))<16
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(column02))<16
]
h=[
19
19
]
next=Icpitembatch.CPRead
arch='personbo_agg
next=Icpitembatch.CPIfElse
frm_calc=[
'_FLGANAVAL='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'modifica
]
h=[
19
19
]
obj='If
pag=1
prev=O2356
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2359
fatherSonIndex=0
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O2365
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
expected_rows=1
father=O2367
fatherSonIndex=0
h=[
19
19
19
]
obj='Select
pag=1
sel_name='personbo
sel_where='personbo->CONNES=LTrim(column01) and personbo->CODFISC=LTrim(column01)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O2372
fatherSonIndex=0
frm_calc='Se cambia il cf faccio la registrazione sullo storico
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(column02)<>personbo->CODFISC
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'aggfam
]
h=[
19
19
]
obj='If
pag=1
prev=O2377
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O2380
fatherSonIndex=0
obj='Write
pag=1
rd_kfield=[
'COLLEG
'ANNO
]
rd_kop=[
'=
'>
]
rd_kvar=[
'personbo->CONNES
''2010'
]
wr_field=[
'DATAMODI
]
wr_op=[
'=
]
wr_var=[
'oggi
]
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O2376
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2377
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPInsert
arch='wersonbo
next=Icpitembatch.CPWrite
arch='personbo
expected_rows=1
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'soggetto trovato, storicizzato e modificato',nota+' soggetto trovato, storicizzato e modificato')
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='nota+'. '+iif(LRTrim(column01)<>LRTrim(column02),'Codici fiscali diversi','Codici fiscali uguali')
len=100
name='nota
obj='Var
pag=1
prev=O2398
var_op='asgn
I
obj='Var
pag=1
prev=O2397
var_op='asgn
I
obj='Write
pag=1
prev=O2396
rd_kfield=[
'CONNES
'CODFISC
]
rd_kop=[
'=
'=
]
rd_kvar=[
'personbo->CONNES
'personbo->CODFISC
]
wr_field=[
'CODFISC
'CFESTERO
]
wr_op=[
'=
'=
]
wr_var=[
'LRTrim(column02)
'0
]
I
obj='Insert
pag=1
prev=O2395
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'datamodi
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
]
rd_kvar=[
'cProgSto
'LRTrim(column01)
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'gDataVaria
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
]
I
obj='Var
pag=1
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='personbo
expected_rows=1
father=O2377
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'soggetto trovato e modificato',nota+' soggetto trovato e modificato')
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='nota+'. '+iif(LRTrim(column01)<>LRTrim(column02),'Codici fiscali diversi','Codici fiscali uguali')
len=100
name='nota
obj='Var
pag=1
prev=O2410
var_op='asgn
I
obj='Var
pag=1
prev=O2409
var_op='asgn
I
obj='Write
pag=1
rd_kfield=[
'CONNES
'CODFISC
]
rd_kop=[
'=
'=
]
rd_kvar=[
'personbo->CONNES
'personbo->CODFISC
]
wr_field=[
'CODFISC
'CFESTERO
]
wr_op=[
'=
'=
]
wr_var=[
'LRTrim(column02)
'0
]
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='connes letto
father=O2372
fatherSonIndex=1
frm_calc='''
len=16
name='_connes
next=Icpitembatch.CPVarDecl
comment='CF letto
frm_calc='''
len=16
name='_cf
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_connes)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O2422
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O2423
fatherSonIndex=0
frm_calc='iif(Empty(nota),'soggetto ricercato non trovato in anagrafica',nota+' soggetto ricercato non trovato in anagrafica')
len=100
name='nota
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2423
fatherSonIndex=1
frm_calc=[
'_cf=LRTrim(column02)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O2430
fatherSonIndex=0
frm_calc='iif(Empty(nota),'soggetto ricercato trovato in anagrafica, con lo stesso CF',nota+' soggetto ricercato trovato in anagrafica, con lo stesso CF')
len=100
name='nota
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O2430
fatherSonIndex=1
frm_calc='iif(Empty(nota),'soggetto ricercato trovato in anagrafica, con CF diverso '+_cf,nota+' soggetto ricercato trovato in anagrafica, con CF diverso '+_cf)
len=100
name='nota
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
prev=O2421
rd_field=[
'CONNES
'CODFISC
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LTrim(column01)
]
rd_var=[
'_connes
'_cf
]
I
obj='Var
pag=1
prev=O2420
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
expected_rows=1
father=O2367
fatherSonIndex=1
h=[
19
19
19
]
obj='Select
pag=1
sel_name='personbo
sel_where='personbo->CONNES=LTrim(column01) and personbo->CODFISC=LTrim(column01)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='personbo
expected_rows=1
father=O2446
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'aggfam
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='iif(Empty(nota),'soggetto trovato e modificato',nota+' soggetto trovato e modificato')
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
frm_calc='nota+'. '+iif(LRTrim(column01)<>LRTrim(column02),'Codici fiscali diversi','Codici fiscali uguali')
len=100
name='nota
obj='Var
pag=1
prev=O2454
var_op='asgn
I
obj='Var
pag=1
prev=O2451
var_op='asgn
I
obj='If
pag=1
prev=O2450
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O2451
fatherSonIndex=0
obj='Write
pag=1
rd_kfield=[
'COLLEG
'ANNO
]
rd_kop=[
'=
'>
]
rd_kvar=[
'personbo->CONNES
''2010'
]
wr_field=[
'DATAMODI
]
wr_op=[
'=
]
wr_var=[
'oggi
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=1
rd_kfield=[
'CONNES
'CODFISC
]
rd_kop=[
'=
'=
]
rd_kvar=[
'personbo->CONNES
'personbo->CODFISC
]
wr_field=[
'CODFISC
'CFESTERO
]
wr_op=[
'=
'=
]
wr_var=[
'LRTrim(column02)
'0
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='connes letto
father=O2446
fatherSonIndex=1
frm_calc='''
len=16
name='_connes
next=Icpitembatch.CPVarDecl
comment='CF letto
frm_calc='''
len=16
name='_cf
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_connes)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O2475
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O2476
fatherSonIndex=0
frm_calc='iif(Empty(nota),'soggetto ricercato non trovato in anagrafica',nota+' soggetto ricercato non trovato in anagrafica')
len=100
name='nota
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2476
fatherSonIndex=1
frm_calc=[
'_cf=LRTrim(column02)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O2483
fatherSonIndex=0
frm_calc='iif(Empty(nota),'soggetto ricercato trovato in anagrafica, con lo stesso CF',nota+' soggetto ricercato trovato in anagrafica, con lo stesso CF')
len=100
name='nota
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O2483
fatherSonIndex=1
frm_calc='iif(Empty(nota),'soggetto ricercato trovato in anagrafica, con CF diverso '+_cf,nota+' soggetto ricercato trovato in anagrafica, con CF diverso '+_cf)
len=100
name='nota
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
prev=O2474
rd_field=[
'CONNES
'CODFISC
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LTrim(column01)
]
rd_var=[
'_connes
'_cf
]
I
obj='Var
pag=1
prev=O2473
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=1
prev=O2364
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=LTrim(column01) and wersonbo->datamodi=w_DATARETT﷯
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2365
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=1
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O2355
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O2356
fatherSonIndex=0
frm_calc='iif(Empty(nota),'Anagrafica bloccata da verifica massivo CF',nota+' Anagrafica bloccata da verifica massivo CF')
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='ok alla modifica dei dati
frm_calc='False
len=1
name='modifica
obj='Var
obj_type='L
pag=1
prev=O2506
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=1
prev=O2352
rd_field=[
'FLGANAVAL
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'column01
]
rd_var=[
'_FLGANAVAL
]
I
obj='If
pag=1
prev=O2349
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O2352
fatherSonIndex=0
frm_calc='iif(Empty(nota),'CF_new<16',nota+' CF_new <16')
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='ok alla modifica dei dati
frm_calc='False
len=1
name='modifica
obj='Var
obj_type='L
pag=1
prev=O2515
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O2349
fatherSonIndex=0
frm_calc='iif(Empty(nota),'CF_old <16',nota+' CF_old <16')
len=100
name='nota
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2335
fatherSonIndex=0
frm_calc='cell.getStringCellValue()
len=25
name='column01
obj='Var
pag=1
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
comment='tipo booleano sbagliato﷯tipo formula il 4 è booleano
instr=Icpitembatch.CPRemark
father=O2328
fatherSonIndex=2
frm_calc='tipo buleano﷯da definire il comportamento﷯non è booleanao è tipo formula da vedere
obj='Remark
pag=1
I
I
Icpitembatch.CPItemSon
comment='Tipo vuoto
instr=Icpitembatch.CPIfElse
father=O2328
fatherSonIndex=3
frm_calc=[
'cell_count=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cell_count=2
]
h=[
19
19
]
obj='If
pag=1
prev=O2531
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O2534
fatherSonIndex=0
frm_calc='iif(Empty(nota),'Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (CF vuoto)',nota+' Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (CF vuoto)')
len=100
name='nota
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''new cf vuoto'
obj='Transaction
pag=1
prev=O2539
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
father=O2531
fatherSonIndex=0
frm_calc='iif(Empty(nota),'Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (CF vuoto)',nota+' Valore non definito alla colonna '+LRTrim(Str(cell_count,2,0))+' (CF vuoto)')
len=100
name='nota
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''old cf vuoto'
obj='Transaction
pag=1
prev=O2544
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
comment='tipo non supportato
I
]
w=[
150
150
150
150
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O2326
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O2325
var_op='asgn
I
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='L
pag=1
prev=O2308
var_op='asgn
I
obj='Var
pag=1
prev=O2307
var_op='asgn
I
obj='Var
obj_type='N
pag=1
pagelocal=True
prev=O2306
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O2305
var_op='asgn
I
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
pagelocal=True
prev=O2298
var_op='asgn
I
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMessage
father=O2287
fatherSonIndex=1
frm_calc=''Errore SQL: ' + m_Sql.TransactionErrorMessage() + NL
msg_type='Error
next=Icpitembatch.CPTransaction
frm_calc='rollback
obj='Transaction
pag=1
prev=O2553
I
obj='Message
pag=1
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=1
prev=O2285
I
obj='Exec
pag=1
prev=O2283
I
obj='Begin
pag=1
prev=O2281
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O2283
fatherSonIndex=0
frm_calc='// creo il contenitore dei fogli﷯XSSFWorkbook wb2 = new XSSFWorkbook();﷯XSSFSheet sheet2 = wb2.createSheet(sheetName) ;
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O2280
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O2281
fatherSonIndex=0
frm_calc='//base﷯InputStream ExcelFileToRead = new FileInputStream(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(gAzienda)+'/'+CPLib.LRTrim(nomefile));﷯XSSFWorkbook  wb = new XSSFWorkbook(ExcelFileToRead);﷯﷯conta = wb.getNumberOfSheets();﷯﷯//XSSFWorkbook test = new XSSFWorkbook(); ﷯﷯//XSSFSheet sheet = wb.getSheetAt(0);﷯XSSFRow row; ﷯XSSFCell cell;﷯﷯XSSFRow row2; ﷯XSSFCell cell2;﷯﷯//Iterator rows = sheet.rowIterator();
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
pagelocal=True
prev=O2279
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='D
pag=1
prev=O2278
var_op='asgn
I
obj='Var
obj_type='D
pag=1
pagelocal=True
prev=O2277
var_op='asgn
I
obj='Var
obj_type='D
pag=1
pagelocal=True
prev=O2276
var_op='asgn
I
obj='Var
obj_type='D
pag=1
pagelocal=True
prev=O2275
var_op='asgn
I
obj='Message
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2270
fatherSonIndex=1
frm_calc=''correzioni.xlsx'
len=30
name='nomefile
next=Icpitembatch.CPVarDecl
comment='nome file risultati
frm_calc=''correzioni_out.xlsx'
len=30
name='nomefileoutput
next=Icpitembatch.CPIfElse
frm_calc=[
'FileLibMit.ExistFile(LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+'/'+LRTrim(nomefile))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O2566
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O2567
fatherSonIndex=0
frm_calc='2
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2567
fatherSonIndex=1
frm_calc=''esiti.xlsx'
len=30
name='nomefile
next=Icpitembatch.CPVarDecl
comment='nome file risultati
frm_calc=''esiti_out.xlsx'
len=30
name='nomefileoutput
next=Icpitembatch.CPIfElse
frm_calc=[
'FileLibMit.ExistFile(LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+'/'+LRTrim(nomefile))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O2575
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O2576
fatherSonIndex=0
frm_calc='4
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2576
fatherSonIndex=1
frm_calc=''esiti2.xlsx'
len=30
name='nomefile
next=Icpitembatch.CPVarDecl
comment='nome file risultati
frm_calc=''esiti2_out.xlsx'
len=30
name='nomefileoutput
next=Icpitembatch.CPIfElse
frm_calc=[
'FileLibMit.ExistFile(LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+'/'+LRTrim(nomefile))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O2584
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O2585
fatherSonIndex=0
frm_calc='5
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2585
fatherSonIndex=1
frm_calc=''cancella.xlsx'
len=30
name='nomefile
next=Icpitembatch.CPVarDecl
comment='nome file risultati
frm_calc=''cancella_out.xlsx'
len=30
name='nomefileoutput
next=Icpitembatch.CPIfElse
frm_calc=[
'FileLibMit.ExistFile(LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+'/'+LRTrim(nomefile))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O2593
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O2594
fatherSonIndex=0
frm_calc='6
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2594
fatherSonIndex=1
frm_calc=[
'At('correzioni.csv',Lower(pnomefile)) <> 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nome file risultati
father=O2601
fatherSonIndex=0
frm_calc='Left(pnomefile,7)+'_correzioni_out.xlsx'
len=30
name='nomefileoutput
next=Icpitembatch.CPExec
check='page
frm_calc='7
obj='Exec
pag=1
prev=O2606
I
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMessage
father=O2601
fatherSonIndex=1
frm_calc=''Apertura file Excel non riuscita. '
msg_type='Error
obj='Message
pag=1
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=1
prev=O2592
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=1
prev=O2583
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=1
prev=O2574
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=1
prev=O2565
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Crea Memory Cursor
father=O2264
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPDropTemporaryTable
next=Icpitembatch.CPServerTemporaryTable
next=Icpitembatch.CPExec
check='man
frm_calc='// Legge i file﷯File di = new File(CPLib.LRTrim(gPathApp+"/appo/"+CPLib.LRTrim(gAzienda)));﷯File fl[] = di.listFiles();﷯int _i;﷯int count=0;﷯for (_i=0; _i < fl.length; _i++)  {
next=Icpitembatch.CPIfElse
frm_calc=[
'At('correzioni.csv',Lower(fl[_i].getName())) <> 0
]
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='}
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=1
prev=O2625
sel_field='*
sel_name='tmp_list_imprich
sel_order='tmp_list_imprich->priorita,tmp_list_imprich->nomefile
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2626
fatherSonIndex=0
frm_calc='LRTrim(tmp_list_imprich->nomefile)
len=30
name='nomefile
next=Icpitembatch.CPVarDecl
comment='nome file risultati
frm_calc='Left(nomefile,7)+'_correzioni_out.xlsx'
len=30
name='nomefileoutput
next=Icpitembatch.CPExec
check='page
frm_calc='7
next=Icpitembatch.CPDelete
arch='tmp_list_imprich
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+'/'+LRTrim(nomefile))
obj='Exec
pag=1
prev=O2633
I
obj='Delete
pag=1
prev=O2632
rd_kfield=[
'nomefile
]
rd_kop=[
'=
]
rd_kvar=[
'tmp_list_imprich->nomefile
]
I
obj='Exec
pag=1
prev=O2631
I
obj='Var
pag=1
prev=O2630
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Exec
pag=1
prev=O2622
I
obj='If
pag=1
prev=O2621
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tmp_list_imprich
father=O2622
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'nomefile
'priorita
]
rd_kvar=[
'LRTrim(fl[_i].getName())
'1
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=1
prev=O2620
I
obj='TempTable
pag=1
prev=O2619
sel_type='def
server_table='tmp_list_imprich
I
obj='DropTempTable
pag=1
prev=O2617
server_table='tmp_list_imprich
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Ispitembatch.CPMemoryCursor
data_source='anadip
father=O2617
fatherSonIndex=0
key_expression='anadip->CODDIP
mem_curs_name='mcAnadip
next=Ispitembatch.CPMemoryCursor
data_source='tbcitta
key_expression='LRTrim(tbcitta->CITTA)
mem_curs_name='mcTbcitta
obj='MemoryCursor
pag=1
prev=O2647
sel_field='*
sel_name='tbcitta
sel_type='fltb
I
obj='MemoryCursor
pag=1
sel_field='*
sel_name='anadip
sel_type='fltb
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O2264
fatherSonIndex=2
frm_calc='8
obj='Exec
pag=1
I
I
]
w=[
150
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O2262
var_op='asgn
I
obj='Var
pag=1
prev=O2261
var_op='asgn
I
obj='Var
pag=1
prev=O2260
var_op='asgn
I
obj='Var
obj_type='D
pag=1
prev=O2258
var_op='asgn
I
obj='Begin
pag=1
prev=O2256
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2258
fatherSonIndex=0
len=25
name='column01
next=Icpitembatch.CPVarDecl
len=25
name='column02
next=Icpitembatch.CPVarDecl
comment='foglio letto
len=2
name='foglio
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel
len=9
name='riga_letta
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel Character
len=9
name='riga_letta_c
next=Icpitembatch.CPVarDecl
comment='data rettifica
len=8
name='w_DATARETT
next=Icpitembatch.CPVarDecl
comment='progressivo wersonbo del giorno
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
comment='Data odierna per le modifiche
len=8
name='oggi
obj='Var
obj_type='D
pag=1
prev=O2661
I
obj='Var
pag=1
pagelocal=True
prev=O2660
I
obj='Var
obj_type='D
pag=1
pagelocal=True
prev=O2659
I
obj='Var
pag=1
pagelocal=True
prev=O2658
I
obj='Var
obj_type='N
pag=1
pagelocal=True
prev=O2657
I
obj='Var
obj_type='N
pag=1
pagelocal=True
prev=O2656
I
obj='Var
pag=1
pagelocal=True
prev=O2655
I
obj='Var
pag=1
pagelocal=True
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O2254
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Azienda
father=O2256
fatherSonIndex=0
global=True
len=10
name='gAzienda
next=Icpitembatch.CPVarDecl
comment='Data Variazione
global=True
len=8
name='gDataVaria
next=Icpitembatch.CPVarDecl
comment='Path Applicazione
global=True
len=80
name='gPathApp
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='Messaggio
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O2669
I
nonlocal=True
obj='Var
pag=1
prev=O2668
I
nonlocal=True
obj='Var
pag=1
prev=O2667
I
nonlocal=True
obj='Var
obj_type='D
pag=1
prev=O2666
I
nonlocal=True
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O2252
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nome file da importare
father=O2254
fatherSonIndex=0
len=30
name='nomefile
next=Icpitembatch.CPVarDecl
comment='nome file risultati
len=30
name='nomefileoutput
next=Icpitembatch.CPVarDecl
comment='nota del eventuale problema
len=100
name='nota
next=Icpitembatch.CPVarDecl
comment='Contatore delle celle lette
len=9
name='cell_count
next=Icpitembatch.CPVarDecl
comment='ok alla modifica dei dati
len=1
name='modifica
next=Icpitembatch.CPVarDecl
comment='connes letto
len=16
name='_connes
next=Icpitembatch.CPVarDecl
comment='CF letto
len=16
name='_cf
next=Icpitembatch.CPVarDecl
comment='flag blocco anagrafica
len=1
name='_FLGANAVAL
next=Icpitembatch.CPVarDecl
len=15
name='_min
next=Icpitembatch.CPVarDecl
len=15
name='_max
next=Icpitembatch.CPVarDecl
len=15
name='_cicli
next=Icpitembatch.CPVarDecl
len=15
name='_conta
next=Icpitembatch.CPVarDecl
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
len=15
name='_top
next=Icpitembatch.CPVarDecl
len=15
name='_totale
next=Icpitembatch.CPVarDecl
len=15
name='_contarec
next=Icpitembatch.CPVarDecl
len=1
name='_mono
next=Icpitembatch.CPVarDecl
len=4
name='_annoc
next=Icpitembatch.CPVarDecl
dec=2
len=12
name='_totsal
next=Icpitembatch.CPVarDecl
len=10
name='_numope
next=Icpitembatch.CPVarDecl
len=10
name='_reccount
next=Icpitembatch.CPVarDecl
len=15
name='_tot
next=Icpitembatch.CPVarDecl
len=100
name='_oldmsg
next=Icpitembatch.CPVarDecl
frm_seek='tbcitta
name='mcTbcitta
next=Icpitembatch.CPVarDecl
frm_seek='anadip
name='mcAnadip
obj='Var
obj_type='MC
pag=1
prev=O2697
I
obj='Var
obj_type='MC
pag=1
prev=O2696
I
obj='Var
pag=1
prev=O2695
I
obj='Var
obj_type='N
pag=1
prev=O2694
I
obj='Var
obj_type='N
pag=1
prev=O2693
I
obj='Var
obj_type='N
pag=1
prev=O2692
I
obj='Var
obj_type='N
pag=1
prev=O2691
I
obj='Var
pag=1
prev=O2690
I
obj='Var
obj_type='N
pag=1
prev=O2689
I
obj='Var
obj_type='N
pag=1
prev=O2688
I
obj='Var
obj_type='N
pag=1
prev=O2687
I
obj='Var
obj_type='N
pag=1
prev=O2686
I
obj='Var
obj_type='N
pag=1
prev=O2685
I
obj='Var
obj_type='N
pag=1
prev=O2684
I
obj='Var
obj_type='N
pag=1
prev=O2683
I
obj='Var
obj_type='N
pag=1
prev=O2682
I
obj='Var
obj_type='N
pag=1
prev=O2681
I
obj='Var
pag=1
prev=O2680
I
obj='Var
pag=1
prev=O2679
I
obj='Var
pag=1
prev=O2678
I
obj='Var
obj_type='L
pag=1
prev=O2677
I
obj='Var
obj_type='N
pag=1
prev=O2676
I
obj='Var
pag=1
prev=O2675
I
obj='Var
pag=1
prev=O2674
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Parametro del portlet con la data a cui devono essere registrate le modifiche
father=O2252
fatherSonIndex=0
len=8
name='datamod
next=Icpitembatch.CPVarDecl
comment='Aggiorna le famiglie collegate (operazioni)
len=1
name='aggfam
next=Icpitembatch.CPVarDecl
comment='nome del file per import
len=200
name='pnomefile
next=Icpitembatch.CPVarDecl
comment='Anno riferimento saldi
len=4
name='pannorif
next=Icpitembatch.CPVarDecl
comment='Tipo Operazione
len=1
name='pselezione
obj='Var
pag=1
param=True
prev=O2705
I
obj='Var
obj_type='N
pag=1
param=True
prev=O2704
I
obj='Var
pag=1
param=True
prev=O2703
I
obj='Var
obj_type='L
pag=1
param=True
prev=O2702
I
obj='Var
obj_type='D
pag=1
param=True
I
I
]
w=[
150
150
]
x=17
y=18
I
Icpitembatch.CPBeginEnd
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc=''Elaborazione terminata!'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=8
prev=O2708
var_op='asgn
I
obj='Begin
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTry
father=O2708
fatherSonIndex=0
h=[
19
19
19
]
obj='Try
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2713
fatherSonIndex=0
frm_calc='Str(pannorif,4,0)
len=4
name='_annoc
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_totale > 1000,0,1)
len=1
name='_mono
next=Icpitembatch.CPIfElse
frm_calc=[
'_mono = 1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='1
len=15
name='_conta
next=Icpitembatch.CPWhile
frm_calc='_conta <= _cicli
h=[
19
19
]
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=8
prev=O2725
I
obj='While
pag=8
prev=O2724
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O2725
fatherSonIndex=0
frm_calc=[
'_mono = 1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Lettura soggetti in corso ... Ciclo N. '+LRTrim(Str(_conta,10,0)) + " su " +LRTrim(Str(_cicli,10,0))
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_oldmsg)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc=''Lettura soggetti in corso ... Ciclo N. '+LRTrim(Str(_conta,10,0)) + " su " +LRTrim(Str(_cicli,10,0))
len=100
name='_oldmsg
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_conta + 1
len=15
name='_conta
obj='Var
obj_type='N
pag=8
prev=O2738
var_op='asgn
I
obj='Select
pag=8
par_expr=[
'_bottom
'_top
'_annoc
]
par_name=[
'_bottom
'_top
'w_anno
]
prev=O2737
sel_name='qbe_opextrbo_resaldi
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2738
fatherSonIndex=0
frm_calc='_contarec + 1
len=15
name='_contarec
next=Icpitembatch.CPVarDecl
dec=2
frm_calc='0
len=12
name='_totsal
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_numope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'qbe_opextrbo_resaldi->SALDO <> _totsal or qbe_opextrbo_resaldi->QUANTITA <> _numope
]
h=[
19
19
]
obj='If
pag=8
prev=O2748
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2750
fatherSonIndex=0
frm_calc=''Aggiorno dati per il soggetto con NDG: '+ qbe_opextrbo_resaldi->COLLEG
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='opextrbo
obj='Write
pag=8
prev=O2755
rd_kfield=[
'COLLEG
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'qbe_opextrbo_resaldi->COLLEG
'_annoc
]
wr_field=[
'SALDO
'QUANTITA
'DATAMODI
]
wr_op=[
'=
'=
'=
]
wr_var=[
'_totsal
'_numope
'Date()
]
I
nonlocal=True
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=8
par_expr=[
'_annoc
'qbe_opextrbo_resaldi->COLLEG
]
par_name=[
'w_annosel
'w_ndgcli
]
prev=O2747
sel_name='qbe_saldi_opex_o
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
dec=2
father=O2748
fatherSonIndex=0
frm_calc='_totsal + qbe_saldi_opex_o->TOTLIRE
len=12
name='_totsal
next=Icpitembatch.CPVarDecl
frm_calc='_numope + qbe_saldi_opex_o->TOTOPER
len=10
name='_numope
obj='Var
obj_type='N
pag=8
prev=O2768
var_op='asgn
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
prev=O2746
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O2745
var_op='asgn
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
prev=O2734
var_op='asgn
I
obj='If
pag=8
prev=O2733
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O2734
fatherSonIndex=0
frm_calc='gMsgProc + 'Lettura soggetti in corso ... Ciclo N. '+LRTrim(Str(_conta,10,0)) + " su " +LRTrim(Str(_cicli,10,0)) + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O2734
fatherSonIndex=1
frm_calc='Strtran(gMsgProc,_oldmsg,LRTrim(gMsgImp))
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
pag=8
prev=O2730
var_op='asgn
I
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2730
fatherSonIndex=0
frm_calc='_min
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_max
len=15
name='_top
obj='Var
obj_type='N
pag=8
prev=O2780
var_op='asgn
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2730
fatherSonIndex=1
frm_calc=[
'_conta=1
'_conta = _cicli
]
h=[
19
19
19
19
]
haselse=True
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2783
fatherSonIndex=0
frm_calc='_min
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_min + 999
len=15
name='_top
obj='Var
obj_type='N
pag=8
prev=O2788
var_op='asgn
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2783
fatherSonIndex=1
frm_calc='_top + 1
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_max
len=15
name='_top
obj='Var
obj_type='N
pag=8
prev=O2791
var_op='asgn
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2783
fatherSonIndex=2
frm_calc='_top + 1
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_bottom + 999
len=15
name='_top
obj='Var
obj_type='N
pag=8
prev=O2794
var_op='asgn
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
prev=O2721
var_op='asgn
I
obj='If
pag=8
prev=O2720
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2721
fatherSonIndex=0
frm_calc=[
'_totale = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2801
fatherSonIndex=0
frm_calc='0
len=15
name='_cicli
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2801
fatherSonIndex=1
frm_calc='1
len=15
name='_cicli
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2721
fatherSonIndex=1
frm_calc='_max - _min
len=10
name='_reccount
next=Icpitembatch.CPVarDecl
frm_calc='iif(Mod(_reccount,1000) <> 0,Int(_reccount/1000) + 1,Int(_reccount/1000))
len=15
name='_cicli
obj='Var
obj_type='N
pag=8
prev=O2811
var_op='asgn
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=8
prev=O2718
var_op='asgn
I
obj='Select
pag=8
par_expr=[
'_annoc
]
par_name=[
'pANNO
]
prev=O2717
sel_name='qbe_minmax_opextrbo
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Valore massimo e minimo
instr=Icpitembatch.CPVarDecl
father=O2718
fatherSonIndex=0
frm_calc='qbe_minmax_opextrbo->MINPRG
len=15
name='_min
next=Icpitembatch.CPVarDecl
frm_calc='qbe_minmax_opextrbo->MAXPRG
len=15
name='_max
next=Icpitembatch.CPVarDecl
frm_calc='qbe_minmax_opextrbo->TOTPRG
len=15
name='_totale
obj='Var
obj_type='N
pag=8
prev=O2819
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O2818
var_op='asgn
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O2713
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=8
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
x=14
y=19
I
]
ManualBlocks={
'BO - Header
Icpmanualblocks.CPManualBlocks
code='import java.io.InputStream;﷯import java.io.FileInputStream;﷯﷯import java.io.FileOutputStream;﷯﷯import java.text.SimpleDateFormat;﷯﷯import java.util.Iterator;﷯﷯﷯import org.apache.poi.xssf.usermodel.XSSFCell;﷯import org.apache.poi.xssf.usermodel.XSSFRow;﷯import org.apache.poi.xssf.usermodel.XSSFSheet;﷯import org.apache.poi.xssf.usermodel.XSSFWorkbook;﷯﷯import org.apache.poi.xssf.streaming.SXSSFCell;﷯import org.apache.poi.xssf.streaming.SXSSFRow;﷯import org.apache.poi.xssf.streaming.SXSSFSheet;﷯//import org.apache.poi.ss.usermodel.Sheet;﷯import org.apache.poi.xssf.streaming.SXSSFWorkbook;﷯﷯//Per la lettura di un csv﷯import java.io.FileReader;﷯import java.io.IOException;﷯import java.io.StringWriter;﷯import java.util.List;﷯import com.opencsv.*;﷯import com.opencsv.CSVReader;﷯import java.io.File;
name='BO - Header
I
'BO - Properties
Icpmanualblocks.CPManualBlocks
code='public int _i;﷯public int _y;﷯public int _righe;﷯public int conta;﷯public int r;﷯public int cell_type;﷯String sheetName = "Sheet1";﷯SimpleDateFormat sdf = new SimpleDateFormat("yyyyMMdd");
name='BO - Properties
I
}
comment='Import da file XLSX esterni
date_creat=#2014-09-03
date_rev=#2021-02-17
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'Utilities
'FileLibMit
]
modcnt=365
page_result_class=[
'
'
'
'
'
'
'
'
]
page_result_type=[
'U
'U
'L
'U
'U
'U
'U
'U
]
page_uid=[
'VZNEIIHYYJ
'RPEDIBZTXM
'UZADPJQBBG
'LOBJMFRSIK
'MJUOWHIZFQ
'ZKFGMOFFFS
'GEYBFDLZKE
'JAUEDWACQB
]
pagename=[
'Page_1
'Page_2
'Page_3
'Page_4
'Page_5
'Page_6
'Page_7
'Page_8
]
pagenote=[
'
'
'
'
'
'canellazione massiva delle operazioni
'modifiche alle operazioni idicate nel csv
'
]
pagetitle=[
'generale
'correzioni
'unisci anagrafiche
'esiti
'esti2
'cancella
'modificheCSV
'verifica saldi
]
runtime_filters=2
tpl_name='Function
work_file=[
'aederig
'aeopcanc
'aeoprig
'aeopstor
'aerighe
'beneficfrz
'beneficope
'clientifrz
'clientiope
'delegabo
'fraziobo
'intestbo
'japopebo
'jelegabo
'jntestbo
'jperazbo
'kperazbo
'operazbo
'opextrbo
'personbo
'rapopebo
'rapotit
'sogopebo
'sogopefbo
'terzistifrz
'terzistiope
'wersonbo
'xapopebo
'xapotit
'xelegabo
'xeneficfrz
'xeneficope
'xerzistifrz
'xerzistiope
'xlientifrz
'xlientiope
'xntestbo
'xogopebo
'xogopefbo
'xperazbo
'xraziobo
'personbo_agg
'tbcitta
'anadip
'tmp_list_imprich
'cpwarn
]
work_filter=[
'
'
'
'
]
I
*--*
*----*
