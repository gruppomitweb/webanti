* --- CodePainter Revolution Batch Vers. 5.2
￼Icpbatch.CPBatch
Items=[
Icpitembatch.CPBeginEnd
comment='Definizione variabili caller
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili Locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='variabili per il calcolo del codice fiscale
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili per lettura file excel
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili globali
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Legge dati intermediario per metteri su operazbo,fraziobo,rapopebo se mancanti
next=Icpitembatch.CPBeginEnd
comment='Ripulisce file appoggio
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Import Soggetti
next=Icpitembatch.CPVarDecl
frm_calc='''
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPRemark
frm_calc='Cicla sul file della lista e lancia la pagina appropriata
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_esito
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Ispitembatch.CPReturn
frm_calc='nResult
obj='Return
pag=1
prev=O23
I
obj='Try
pag=1
prev=O22
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O23
fatherSonIndex=0
frm_calc=''Ora Inizio Elaborazione: '+ arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPTransaction
frm_calc='commit
next=Icpitembatch.CPIfElse
frm_calc=[
'mcErrori.RecCount() > 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Elaborazione: '+ arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O32
var_op='asgn
I
obj='If
pag=1
prev=O31
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O32
fatherSonIndex=0
frm_calc='3
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Rilevati Errori da Correggere. Prelevare il file'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='nResult
obj='Var
obj_type='N
pag=1
prev=O39
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
prev=O38
var_op='asgn
I
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O32
fatherSonIndex=1
frm_calc=''Importazione dati terminata con successo.'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='nResult
obj='Var
obj_type='N
pag=1
prev=O42
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=1
prev=O29
I
obj='Select
pag=1
prev=O28
sel_field='*
sel_name='tmp_list_imprich
sel_order='tmp_list_imprich->priorita,tmp_list_imprich->nomefile
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O29
fatherSonIndex=0
frm_calc='LRTrim(tmp_list_imprich->nomefile)
len=50
name='nomefileimport
next=Icpitembatch.CPExec
check='page
frm_calc='2
next=Icpitembatch.CPDelete
arch='tmp_list_imprich
obj='Delete
pag=1
prev=O48
rd_kfield=[
'nomefile
]
rd_kop=[
'=
]
rd_kvar=[
'tmp_list_imprich->nomefile
]
I
obj='Exec
pag=1
prev=O47
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O23
fatherSonIndex=1
frm_calc='rollback
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Elaborazione: '+ arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Importazione dati terminata con errori. Ricreare il file e rieseguire l'import"
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='2
len=1
name='nResult
obj='Var
obj_type='N
pag=1
prev=O57
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
prev=O56
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O55
var_op='asgn
I
obj='Transaction
pag=1
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=1
prev=O21
I
obj='Var
obj_type='N
pag=1
prev=O20
var_op='asgn
I
obj='Remark
pag=1
prev=O19
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O18
var_op='asgn
I
obj='Remark
pag=1
prev=O16
I
obj='Select
pag=1
prev=O14
sel_field='*
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O16
fatherSonIndex=0
frm_calc='intermbo->CODINTER
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->DESCCIT
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->CODCAB
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->PROVINCIA
len=2
name='_interprv
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->TIPINTER
len=2
name='_intertip
next=Icpitembatch.CPVarDecl
dec=2
frm_calc='intermbo->SOGLIAMAX
len=12
name='_sogliamax
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(intermbo->LIMITE20),CharToDate('20201231'),intermbo->LIMITE20)
len=8
name='_limite20
obj='Var
obj_type='D
pag=1
prev=O67
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O66
var_op='asgn
I
obj='Var
pag=1
prev=O65
var_op='asgn
I
obj='Var
pag=1
prev=O64
var_op='asgn
I
obj='Var
pag=1
prev=O63
var_op='asgn
I
obj='Var
pag=1
prev=O62
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDropTemporaryTable
father=O14
fatherSonIndex=0
next=Icpitembatch.CPServerTemporaryTable
indexes=[
'WUNOMEFILE,WURIFEMTCN
]
next=Icpitembatch.CPDropTemporaryTable
next=Icpitembatch.CPServerTemporaryTable
obj='TempTable
pag=1
prev=O75
sel_type='def
server_table='tmp_listafile
I
obj='DropTempTable
pag=1
prev=O73
server_table='tmp_listafile
I
obj='TempTable
pag=1
prev=O72
sel_type='def
server_table='tmp_impwu
I
obj='DropTempTable
pag=1
server_table='tmp_impwu
I
I
]
w=[
150
150
]
I
obj='Remark
pag=1
prev=O11
I
obj='Begin
pag=1
prev=O9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Path Applicazione
father=O11
fatherSonIndex=0
global=True
len=80
name='gPathApp
next=Icpitembatch.CPVarDecl
comment='Azienda
global=True
len=10
name='gAzienda
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='Messaggio
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='URL Applicazione
global=True
len=80
name='gUrlApp
nonlocal=True
obj='Var
pag=1
prev=O83
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O82
I
nonlocal=True
obj='Var
pag=1
prev=O81
I
nonlocal=True
obj='Var
pag=1
prev=O80
I
nonlocal=True
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O7
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O9
fatherSonIndex=0
len=10
name='righe
next=Icpitembatch.CPVarDecl
len=100
name='filenome
next=Icpitembatch.CPVarDecl
len=100
name='cell01
next=Icpitembatch.CPVarDecl
len=100
name='cell02
next=Icpitembatch.CPVarDecl
len=100
name='cell03
next=Icpitembatch.CPVarDecl
len=100
name='cell04
next=Icpitembatch.CPVarDecl
len=100
name='cell05
next=Icpitembatch.CPVarDecl
len=100
name='cell06
next=Icpitembatch.CPVarDecl
len=100
name='cell07
next=Icpitembatch.CPVarDecl
len=100
name='cell08
next=Icpitembatch.CPVarDecl
dec=10
len=15
name='cell09
next=Icpitembatch.CPVarDecl
len=30
name='cell09c
next=Icpitembatch.CPVarDecl
len=100
name='cell10
next=Icpitembatch.CPVarDecl
dec=4
len=15
name='cell11
next=Icpitembatch.CPVarDecl
len=30
name='cell11c
next=Icpitembatch.CPVarDecl
len=100
name='cell12
next=Icpitembatch.CPVarDecl
len=100
name='cell13
next=Icpitembatch.CPVarDecl
len=100
name='cell14
next=Icpitembatch.CPVarDecl
len=100
name='cell15
next=Icpitembatch.CPVarDecl
len=100
name='cell16
next=Icpitembatch.CPVarDecl
len=100
name='cell17
next=Icpitembatch.CPVarDecl
len=100
name='cell18
next=Icpitembatch.CPVarDecl
len=100
name='cell19
next=Icpitembatch.CPVarDecl
len=100
name='cell20
next=Icpitembatch.CPVarDecl
len=100
name='cell21
next=Icpitembatch.CPVarDecl
len=100
name='cell22
next=Icpitembatch.CPVarDecl
len=100
name='cell23
next=Icpitembatch.CPVarDecl
len=100
name='cell24
next=Icpitembatch.CPVarDecl
len=100
name='cell25
next=Icpitembatch.CPVarDecl
len=100
name='cell26
next=Icpitembatch.CPVarDecl
len=100
name='cell27
next=Icpitembatch.CPVarDecl
len=100
name='cell28
next=Icpitembatch.CPVarDecl
len=100
name='cell29
next=Icpitembatch.CPVarDecl
len=100
name='cell30
next=Icpitembatch.CPVarDecl
len=100
name='cell31
next=Icpitembatch.CPVarDecl
len=100
name='cell32
next=Icpitembatch.CPVarDecl
len=100
name='cell33
next=Icpitembatch.CPVarDecl
len=100
name='cell34
next=Icpitembatch.CPVarDecl
len=100
name='cell35
next=Icpitembatch.CPVarDecl
len=100
name='cell36
next=Icpitembatch.CPVarDecl
len=100
name='cell37
next=Icpitembatch.CPVarDecl
len=100
name='cell38
next=Icpitembatch.CPVarDecl
name='cell39
next=Icpitembatch.CPVarDecl
name='cell40
next=Icpitembatch.CPVarDecl
name='cell41
next=Icpitembatch.CPVarDecl
len=25
name='_rapporto
next=Icpitembatch.CPVarDecl
len=3
name='_contadel
next=Icpitembatch.CPVarDecl
len=70
name='_ragsoc
obj='Var
pag=1
prev=O134
I
obj='Var
obj_type='N
pag=1
prev=O133
I
obj='Var
pag=1
prev=O132
I
obj='Var
pag=1
prev=O131
I
obj='Var
pag=1
prev=O130
I
obj='Var
pag=1
prev=O129
I
obj='Var
pag=1
prev=O128
I
obj='Var
pag=1
prev=O127
I
obj='Var
pag=1
prev=O126
I
obj='Var
pag=1
prev=O125
I
obj='Var
pag=1
prev=O124
I
obj='Var
pag=1
prev=O123
I
obj='Var
pag=1
prev=O122
I
obj='Var
pag=1
prev=O121
I
obj='Var
pag=1
prev=O120
I
obj='Var
pag=1
prev=O119
I
obj='Var
pag=1
prev=O118
I
obj='Var
pag=1
prev=O117
I
obj='Var
pag=1
prev=O116
I
obj='Var
pag=1
prev=O115
I
obj='Var
pag=1
prev=O114
I
obj='Var
pag=1
prev=O113
I
obj='Var
pag=1
prev=O112
I
obj='Var
pag=1
prev=O111
I
obj='Var
pag=1
prev=O110
I
obj='Var
pag=1
prev=O109
I
obj='Var
pag=1
prev=O108
I
obj='Var
pag=1
prev=O107
I
obj='Var
pag=1
prev=O106
I
obj='Var
pag=1
prev=O105
I
obj='Var
pag=1
prev=O104
I
obj='Var
pag=1
prev=O103
I
obj='Var
pag=1
prev=O102
I
obj='Var
obj_type='N
pag=1
prev=O101
I
obj='Var
obj_type='N
pag=1
prev=O100
I
obj='Var
pag=1
prev=O99
I
obj='Var
obj_type='N
pag=1
prev=O98
I
obj='Var
obj_type='N
pag=1
prev=O97
I
obj='Var
pag=1
prev=O96
I
obj='Var
pag=1
prev=O95
I
obj='Var
pag=1
prev=O94
I
obj='Var
pag=1
prev=O93
I
obj='Var
pag=1
prev=O92
I
obj='Var
pag=1
prev=O91
I
obj='Var
pag=1
prev=O90
I
obj='Var
pag=1
prev=O89
I
obj='Var
pag=1
prev=O88
I
obj='Var
obj_type='N
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O5
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O7
fatherSonIndex=0
len=1
name='_nocf
next=Icpitembatch.CPVarDecl
comment='Codice Fiscale
len=16
name='w_CODFISC
next=Icpitembatch.CPVarDecl
comment='Data Nascita
len=8
name='w_DATANASC
next=Icpitembatch.CPVarDecl
comment='Luogo di Nascita
len=30
name='w_NASCOMUN
next=Icpitembatch.CPVarDecl
comment='Stato di nascita
len=30
name='w_NASSTATO
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
len=26
name='w_COGNOME
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
len=70
name='w_RAGSOC
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
len=25
name='w_NOME
next=Icpitembatch.CPVarDecl
comment='Sesso
len=1
name='w_SESSO
obj='Var
pag=1
prev=O146
I
obj='Var
pag=1
prev=O145
I
obj='Var
pag=1
prev=O144
I
obj='Var
pag=1
prev=O143
I
obj='Var
pag=1
prev=O142
I
obj='Var
pag=1
prev=O141
I
obj='Var
obj_type='D
pag=1
prev=O140
I
obj='Var
pag=1
prev=O139
I
obj='Var
obj_type='N
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O3
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O5
fatherSonIndex=0
frm_seek='mcRowsErrori.MCRDef
name='mcErrori
next=Icpitembatch.CPVarDecl
len=11
name='_numprog
next=Icpitembatch.CPVarDecl
len=50
name='nomeesito
next=Icpitembatch.CPVarDecl
len=50
name='nomefilexls
next=Icpitembatch.CPVarDecl
len=128
name='filexls
next=Icpitembatch.CPVarDecl
len=1
name='fhand
next=Icpitembatch.CPVarDecl
len=10
name='nProg
next=Icpitembatch.CPVarDecl
len=50
name='nomefileimport
next=Icpitembatch.CPVarDecl
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
len=10
name='conta
next=Icpitembatch.CPVarDecl
len=10
name='_nerrori
next=Icpitembatch.CPVarDecl
len=1
name='_tdest
next=Icpitembatch.CPVarDecl
len=1
name='_i
next=Icpitembatch.CPVarDecl
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
len=8
name='xData
next=Icpitembatch.CPVarDecl
len=1
name='_tiporap
next=Icpitembatch.CPVarDecl
len=15
name='nVal
next=Icpitembatch.CPVarDecl
dec=2
len=15
name='ndVal
next=Icpitembatch.CPVarDecl
dec=4
len=9
name='nChVal
next=Icpitembatch.CPVarDecl
len=15
name='cVal
next=Icpitembatch.CPVarDecl
len=1
name='cTVal
next=Icpitembatch.CPVarDecl
len=3
name='cCVal
next=Icpitembatch.CPVarDecl
len=3
name='nIntest
next=Icpitembatch.CPVarDecl
len=6
name='xCAB
next=Icpitembatch.CPVarDecl
len=6
name='xDIP
next=Icpitembatch.CPVarDecl
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
comment='Contatore record nuovi
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
comment='Contatore record aggiornati
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
comment='Contatore record invariati
len=10
name='cNumInv
next=Icpitembatch.CPVarDecl
len=1
name='_esito
next=Icpitembatch.CPVarDecl
len=10
name='_idbase
next=Icpitembatch.CPVarDecl
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
len=2
name='_interprv
next=Icpitembatch.CPVarDecl
len=2
name='_intertip
next=Icpitembatch.CPVarDecl
len=6
name='_ccab
next=Icpitembatch.CPVarDecl
len=2
name='_cprov
next=Icpitembatch.CPVarDecl
len=9
name='_ccap
next=Icpitembatch.CPVarDecl
len=3
name='_csta
next=Icpitembatch.CPVarDecl
len=70
name='_crag
next=Icpitembatch.CPVarDecl
len=11
name='_cbanca
next=Icpitembatch.CPVarDecl
len=2
name='_btipo
next=Icpitembatch.CPVarDecl
len=70
name='_bragsoc
next=Icpitembatch.CPVarDecl
len=6
name='_bcodcab
next=Icpitembatch.CPVarDecl
len=30
name='_bcitta
next=Icpitembatch.CPVarDecl
len=3
name='_bstato
next=Icpitembatch.CPVarDecl
len=2
name='_bprov
next=Icpitembatch.CPVarDecl
len=4
name='_cauana
next=Icpitembatch.CPVarDecl
len=2
name='_causin
next=Icpitembatch.CPVarDecl
len=1
name='_segno
next=Icpitembatch.CPVarDecl
len=2
name='_tipope
next=Icpitembatch.CPVarDecl
len=1
name='_rappd
next=Icpitembatch.CPVarDecl
len=16
name='_legrap
next=Icpitembatch.CPVarDecl
len=10
name='_idb2
next=Icpitembatch.CPVarDecl
len=10
name='_errore
next=Icpitembatch.CPVarDecl
len=1
name='nResult
next=Icpitembatch.CPVarDecl
dec=2
len=12
name='_sogliamax
next=Icpitembatch.CPVarDecl
len=8
name='_limite20
next=Icpitembatch.CPVarDecl
dec=2
len=12
name='_limitesoglia
next=Icpitembatch.CPVarDecl
len=3
name='_validstato
obj='Var
pag=1
prev=O213
I
obj='Var
obj_type='N
pag=1
prev=O212
I
obj='Var
obj_type='D
pag=1
prev=O211
I
obj='Var
obj_type='N
pag=1
prev=O210
I
obj='Var
obj_type='N
pag=1
prev=O209
I
obj='Var
obj_type='M
pag=1
prev=O208
I
obj='Var
pag=1
prev=O207
I
obj='Var
pag=1
prev=O206
I
obj='Var
pag=1
prev=O205
I
obj='Var
pag=1
prev=O204
I
obj='Var
pag=1
prev=O203
I
obj='Var
pag=1
prev=O202
I
obj='Var
pag=1
prev=O201
I
obj='Var
pag=1
prev=O200
I
obj='Var
pag=1
prev=O199
I
obj='Var
pag=1
prev=O198
I
obj='Var
pag=1
prev=O197
I
obj='Var
pag=1
prev=O196
I
obj='Var
pag=1
prev=O195
I
obj='Var
pag=1
prev=O194
I
obj='Var
pag=1
prev=O193
I
obj='Var
pag=1
prev=O192
I
obj='Var
pag=1
prev=O191
I
obj='Var
pag=1
prev=O190
I
obj='Var
pag=1
prev=O189
I
obj='Var
pag=1
prev=O188
I
obj='Var
pag=1
prev=O187
I
obj='Var
pag=1
prev=O186
I
obj='Var
pag=1
prev=O185
I
obj='Var
pag=1
prev=O184
I
obj='Var
pag=1
prev=O183
I
obj='Var
obj_type='N
pag=1
prev=O182
I
obj='Var
obj_type='N
pag=1
prev=O181
I
obj='Var
obj_type='N
pag=1
prev=O180
I
obj='Var
obj_type='N
pag=1
prev=O179
I
obj='Var
pag=1
prev=O178
I
obj='Var
pag=1
prev=O177
I
obj='Var
pag=1
prev=O176
I
obj='Var
pag=1
prev=O175
I
obj='Var
obj_type='N
pag=1
prev=O174
I
obj='Var
pag=1
prev=O173
I
obj='Var
pag=1
prev=O172
I
obj='Var
pag=1
prev=O171
I
obj='Var
obj_type='N
pag=1
prev=O170
I
obj='Var
obj_type='N
pag=1
prev=O169
I
obj='Var
obj_type='N
pag=1
prev=O168
I
obj='Var
pag=1
prev=O167
I
obj='Var
pag=1
prev=O166
I
obj='Var
obj_type='N
pag=1
prev=O165
I
obj='Var
pag=1
prev=O164
I
obj='Var
pag=1
prev=O163
I
obj='Var
obj_type='N
pag=1
prev=O162
I
obj='Var
pag=1
prev=O161
I
obj='Var
obj_type='N
pag=1
prev=O160
I
obj='Var
obj_type='N
pag=1
prev=O159
I
obj='Var
pag=1
prev=O158
I
obj='Var
pag=1
prev=O157
I
obj='Var
obj_type='N
pag=1
prev=O156
I
obj='Var
pag=1
prev=O155
I
obj='Var
pag=1
prev=O154
I
obj='Var
pag=1
prev=O153
I
obj='Var
pag=1
prev=O152
I
obj='Var
pag=1
prev=O151
I
obj='Var
obj_type='MC
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3
fatherSonIndex=0
len=1
name='w_tipodest
obj='Var
pag=1
param=True
I
I
]
w=[
150
150
]
x=14
y=19
I
Icpitembatch.CPRemark
frm_calc='Setta il nome del file
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+"/"+LRTrim(nomefileimport)
len=100
name='filenome
next=Icpitembatch.CPBeginEnd
comment='Legge il worksheet
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cell39='I'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPExec
check='man
frm_calc='//﷯    }﷯  }
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Righe Elaborate: '+LRTrim(Str(righe,6,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='//﷯}
obj='Exec
pag=2
prev=O228
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O227
var_op='asgn
I
obj='Exec
pag=2
prev=O224
I
obj='If
pag=2
prev=O222
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O224
fatherSonIndex=0
frm_calc='''
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='_rapporto
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='_cauana
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_causin
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Elaboro operazione N. '+LRTrim(cell06)+" del Customer ID "+LRTrim(cell04) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Elaboro operazione N. '+LRTrim(cell06)+" del Customer ID "+LRTrim(cell04)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'((Lower(LRTrim(cell07))='false' or Lower(LRTrim(cell07))='falso' or Lower(LRTrim(cell07))='0') and Left(cell06,3) = 'TCP')
'((Lower(LRTrim(cell07))='false' or Lower(LRTrim(cell07))='falso' or Lower(LRTrim(cell07))='0') and Left(cell06,3) <> 'TCP')
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
dec=2
frm_calc='iif(CharToDate(xData) > _limite20,500000,1500000)
len=12
name='_limitesoglia
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='cCVal
next=Icpitembatch.CPVarDecl
dec=2
frm_calc='(cell11 * cell09)
len=15
name='ndVal
next=Icpitembatch.CPVarDecl
frm_calc='ndVal * 100
len=15
name='nVal
next=Icpitembatch.CPIfElse
frm_calc=[
'nVal >= _limitesoglia
]
h=[
19
19
]
obj='If
pag=2
prev=O244
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati comuni
father=O245
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_errore)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O250
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O252
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPIfElse
frm_calc=[
'nVal < _limitesoglia
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O257
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O258
fatherSonIndex=0
frm_calc='4
obj='Exec
pag=2
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O258
fatherSonIndex=1
frm_calc='5
obj='Exec
pag=2
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O252
fatherSonIndex=1
frm_seek='AppendBlank
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell01
frm_seek='colonna01
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell02
frm_seek='colonna02
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell03
frm_seek='colonna03
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell04
frm_seek='colonna04
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell05
frm_seek='colonna05
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell06
frm_seek='colonna06
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell07
frm_seek='colonna07
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell08
frm_seek='colonna08
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell09
frm_seek='colonna09
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell10
frm_seek='colonna10
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell11
frm_seek='colonna11
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell12
frm_seek='colonna12
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell13
frm_seek='colonna13
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell14
frm_seek='colonna14
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell15
frm_seek='colonna15
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell16
frm_seek='colonna16
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell17
frm_seek='colonna17
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell18
frm_seek='colonna18
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell19
frm_seek='colonna19
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell20
frm_seek='colonna20
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell21
frm_seek='colonna21
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell22
frm_seek='colonna22
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell23
frm_seek='colonna23
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell24
frm_seek='colonna24
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell25
frm_seek='colonna25
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell26
frm_seek='colonna26
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell27
frm_seek='colonna27
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell28
frm_seek='colonna28
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell29
frm_seek='colonna29
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell30
frm_seek='colonna30
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell31
frm_seek='colonna31
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell32
frm_seek='colonna32
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell33
frm_seek='colonna33
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell34
frm_seek='colonna34
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell35
frm_seek='colonna35
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell36
frm_seek='colonna36
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell37
frm_seek='colonna37
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell38
frm_seek='colonna38
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell39
frm_seek='colonna39
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc=''N'
frm_seek='flgforza
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='_errore
frm_seek='Errore
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcErrori
obj='Var
obj_type='MC
pag=2
prev=O309
var_op='meth
I
obj='Var
obj_type='MC
pag=2
prev=O308
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O307
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O306
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O305
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O304
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O303
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O302
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O301
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O300
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O299
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O298
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O297
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O296
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O295
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O294
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O293
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O292
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O291
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O290
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O289
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O288
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O287
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O286
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O285
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O284
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O283
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O282
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O281
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O280
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O279
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O278
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O277
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O276
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O275
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O274
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O273
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O272
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O271
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O270
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O269
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O268
var_op='prop
I
obj='Var
obj_type='MC
pag=2
var_op='meth
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
dec=4
father=O250
fatherSonIndex=0
frm_calc='cell09
len=9
name='nChVal
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(cell08)='EUR'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCVal))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc=''D'
len=1
name='_rappd
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_tiporap
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='_rapporto
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_legrap
next=Icpitembatch.CPRead
arch='anarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_rapporto))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_rapporto)))
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Verifica codifiche stati
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Verifica chi ha fatto la transazione
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Dati Intermediario Controparte
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Controlla se il codice transazione esiste già
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'((Lower(LRTrim(cell07))='false' or Lower(LRTrim(cell07))='falso' or Lower(LRTrim(cell07))='0') and Left(cell06,3) = 'TCP') or (Lower(LRTrim(cell07))='true' or Lower(LRTrim(cell07))='true' or Lower(LRTrim(cell07))='1')
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(nVal / 100) > _sogliamax and LRTrim(cell40) ='N'
]
h=[
19
19
]
obj='If
pag=2
prev=O340
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O343
fatherSonIndex=0
frm_calc='_errore + "* Importo Elevato. Verificare" + NL
len=10
name='_errore
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O338
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O340
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(cell18))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O352
fatherSonIndex=0
frm_calc='_errore + "* Mancano Dati Controparte" + NL
len=10
name='_errore
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O352
fatherSonIndex=1
frm_calc=[
'LRTrim(cell18)='086'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O359
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(cell13))
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
comment='Tolto controllo indirizzo or Empty(LRTrim(cell14))
instr=Icpitembatch.CPVarDecl
father=O364
fatherSonIndex=0
frm_calc='_errore + "* Mancano Dati Controparte Italia" + NL
len=10
name='_errore
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O359
fatherSonIndex=1
frm_calc=[
'Empty(LRTrim(cell13))
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O372
fatherSonIndex=0
frm_calc='_errore + "* Mancano Dati Controparte Estero" + NL
len=10
name='_errore
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O336
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O338
fatherSonIndex=0
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPRead
arch='operazbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_numprog)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_numprog)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_numprog)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_numprog))
]
h=[
19
19
]
obj='If
pag=2
prev=O392
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O395
fatherSonIndex=0
frm_calc='_errore + "* Operazione già presente in AUI " + NL
len=10
name='_errore
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O389
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O392
fatherSonIndex=0
obj='Read
pag=2
rd_field=[
'NUMPROG
]
rd_kfield=[
'RIFIMP
'SEGNO
'TOTLIRE
]
rd_kvar=[
'LRTrim(cell06)
'_segno
'nVal
]
rd_var=[
'_numprog
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O386
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O389
fatherSonIndex=0
obj='Read
pag=2
rd_field=[
'NUMPROG
]
rd_kfield=[
'RIFIMP
'SEGNO
'TOTLIRE
]
rd_kvar=[
'LRTrim(cell06)
'_segno
'nVal
]
rd_var=[
'_numprog
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O385
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O386
fatherSonIndex=0
obj='Read
pag=2
rd_field=[
'NUMPROG
]
rd_kfield=[
'RIFIMP
'SEGNO
'TOTLIRE
]
rd_kvar=[
'LRTrim(cell06)
'_segno
'nVal
]
rd_var=[
'_numprog
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=2
prev=O384
rd_field=[
'NUMPROG
]
rd_kfield=[
'RIFIMP
'SEGNO
'TOTLIRE
]
rd_kvar=[
'LRTrim(cell06)
'_segno
'nVal
]
rd_var=[
'_numprog
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O334
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O336
fatherSonIndex=0
frm_calc='''
len=11
name='_cbanca
next=Icpitembatch.CPVarDecl
frm_calc='''
len=70
name='_bragsoc
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bcodcab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bcitta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_bprov
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bstato
next=Icpitembatch.CPIfElse
frm_calc=[
'((Lower(LRTrim(cell07))='false' or Lower(LRTrim(cell07))='falso' or Lower(LRTrim(cell07))='0') and Left(cell06,3) = 'TCP')
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O438
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O439
fatherSonIndex=0
frm_calc=[
'Upper(Left(LRTrim(cell23),3))='086'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O444
fatherSonIndex=0
frm_calc=[
'Len(LRTrim(cell26))=10
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc=''086'
len=3
name='_bstato
next=Icpitembatch.CPRead
arch='inter2bo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_bragsoc))
]
h=[
19
19
]
obj='If
pag=2
prev=O453
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O454
fatherSonIndex=0
frm_calc='_errore + "* Mancano Dati Intermediario Controparte Italiano " + NL
len=10
name='_errore
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=2
prev=O452
rd_field=[
'RAGSOC
'CODCAB
'DESCCIT
'PROVINCIA
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'_cbanca
]
rd_var=[
'_bragsoc
'_bcodcab
'_bcitta
'_bprov
]
I
obj='Var
pag=2
prev=O449
var_op='asgn
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O449
fatherSonIndex=0
frm_calc='Left(cell26,5)+"-"+Right(cell26,5)
len=11
name='_cbanca
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O449
fatherSonIndex=1
frm_calc='Substr(cell26,6,5)+"-"+Substr(cell26,11,5)
len=11
name='_cbanca
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O444
fatherSonIndex=1
frm_calc='Left(LRTrim(cell25),11)
len=11
name='_cbanca
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(cell20),70)
len=70
name='_bragsoc
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(cell22),30)
len=30
name='_bcitta
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='_bprov
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(cell23),3)
len=3
name='_bstato
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_bragsoc)) or Empty(LRTrim(_bstato))
]
h=[
19
19
]
obj='If
pag=2
prev=O476
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O477
fatherSonIndex=0
frm_calc='_errore + "* Mancano Dati Intermediario Controparte Estero " + NL
len=10
name='_errore
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O475
var_op='asgn
I
obj='Var
pag=2
prev=O474
var_op='asgn
I
obj='Var
pag=2
prev=O473
var_op='asgn
I
obj='Var
pag=2
prev=O472
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O439
fatherSonIndex=1
frm_calc=[
'(Lower(LRTrim(cell07))='false' or Lower(LRTrim(cell07))='falso' or Lower(LRTrim(cell07))='0')
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O486
fatherSonIndex=0
frm_calc=[
'Upper(Left(LRTrim(cell23),3))='086'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O491
fatherSonIndex=0
frm_calc='Substr(cell36,6,5)+"-"+Substr(cell36,11,5)
len=11
name='_cbanca
next=Icpitembatch.CPVarDecl
frm_calc=''086'
len=3
name='_bstato
next=Icpitembatch.CPRead
arch='inter2bo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_bragsoc))
]
h=[
19
19
]
obj='If
pag=2
prev=O498
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O499
fatherSonIndex=0
frm_calc='_errore + "* Mancano Dati Intermediario Controparte Italiano " + NL
len=10
name='_errore
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=2
prev=O497
rd_field=[
'RAGSOC
'CODCAB
'DESCCIT
'PROVINCIA
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'_cbanca
]
rd_var=[
'_bragsoc
'_bcodcab
'_bcitta
'_bprov
]
I
obj='Var
pag=2
prev=O496
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O491
fatherSonIndex=1
frm_calc='Left(LRTrim(cell32),11)
len=11
name='_cbanca
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(cell35),70)
len=70
name='_bragsoc
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bcitta
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='_bprov
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(cell23),3)
len=3
name='_bstato
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_bragsoc)) or Empty(LRTrim(_bstato))
]
h=[
19
19
]
obj='If
pag=2
prev=O515
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O516
fatherSonIndex=0
frm_calc='_errore + "* Mancano Dati Intermediario Controparte Estero " + NL
len=10
name='_errore
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O514
var_op='asgn
I
obj='Var
pag=2
prev=O513
var_op='asgn
I
obj='Var
pag=2
prev=O512
var_op='asgn
I
obj='Var
pag=2
prev=O511
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O486
fatherSonIndex=1
frm_calc=[
'Upper(Left(LRTrim(cell23),3))='086'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O525
fatherSonIndex=0
frm_calc='Substr(cell26,6,5)+"-"+Substr(cell26,11,5)
len=11
name='_cbanca
next=Icpitembatch.CPVarDecl
frm_calc=''086'
len=3
name='_bstato
next=Icpitembatch.CPRead
arch='inter2bo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_bragsoc))
]
h=[
19
19
]
obj='If
pag=2
prev=O532
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O533
fatherSonIndex=0
frm_calc='_errore + "* Mancano Dati Intermediario Controparte Italiano " + NL
len=10
name='_errore
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=2
prev=O531
rd_field=[
'RAGSOC
'CODCAB
'DESCCIT
'PROVINCIA
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'_cbanca
]
rd_var=[
'_bragsoc
'_bcodcab
'_bcitta
'_bprov
]
I
obj='Var
pag=2
prev=O530
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O525
fatherSonIndex=1
frm_calc='Left(LRTrim(cell25),11)
len=11
name='_cbanca
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(cell20),70)
len=70
name='_bragsoc
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bcitta
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='_bprov
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(cell23),3)
len=3
name='_bstato
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_bragsoc)) or Empty(LRTrim(_bstato))
]
h=[
19
19
]
obj='If
pag=2
prev=O549
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O550
fatherSonIndex=0
frm_calc='_errore + "* Mancano Dati Intermediario Controparte Estero " + NL
len=10
name='_errore
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O548
var_op='asgn
I
obj='Var
pag=2
prev=O547
var_op='asgn
I
obj='Var
pag=2
prev=O546
var_op='asgn
I
obj='Var
pag=2
prev=O545
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O437
var_op='asgn
I
obj='Var
pag=2
prev=O436
var_op='asgn
I
obj='Var
pag=2
prev=O435
var_op='asgn
I
obj='Var
pag=2
prev=O434
var_op='asgn
I
obj='Var
pag=2
prev=O433
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O332
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O334
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(cell37)))
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O563
fatherSonIndex=0
frm_calc=[
'_rappd='D'
'_rappd='P'
]
h=[
19
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O568
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=2
sel_field='*
sel_name='delegabo
sel_where='delegabo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O573
fatherSonIndex=0
frm_calc=[
'Empty(delegabo->DATAFINE)
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O577
fatherSonIndex=0
frm_calc='''
len=70
name='_ragsoc
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Upper(cell37) = Upper(_ragsoc)
]
h=[
19
19
]
obj='If
pag=2
prev=O583
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O584
fatherSonIndex=0
frm_calc='delegabo->CODINTER
len=16
name='_legrap
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O589
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=2
prev=O582
rd_field=[
'RAGSOC
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'delegabo->CODINTER
]
rd_var=[
'_ragsoc
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O568
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=2
sel_field='*
sel_name='xelegabo
sel_where='xelegabo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O599
fatherSonIndex=0
frm_calc=[
'Empty(xelegabo->DATAFINE)
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O603
fatherSonIndex=0
frm_calc='''
len=70
name='_ragsoc
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Upper(cell37) = Upper(_ragsoc)
]
h=[
19
19
]
obj='If
pag=2
prev=O609
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O610
fatherSonIndex=0
frm_calc='xelegabo->CODINTER
len=16
name='_legrap
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O615
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=2
prev=O608
rd_field=[
'RAGSOC
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xelegabo->CODINTER
]
rd_var=[
'_ragsoc
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O329
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O332
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(cell18)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'((Lower(LRTrim(cell07))='false' or Lower(LRTrim(cell07))='falso' or Lower(LRTrim(cell07))='0') and Left(cell06,3) = 'TCP')
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O629
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O632
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(cell23)))
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O637
fatherSonIndex=0
frm_calc='''
len=3
name='_validstato
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_validstato))
]
h=[
19
19
]
obj='If
pag=2
prev=O643
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O644
fatherSonIndex=0
frm_calc='_errore + "* Stato Intermediario Controparte Errato" + NL
len=10
name='_errore
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=2
prev=O642
rd_field=[
'CODSTA
]
rd_kfield=[
'CODSTA
]
rd_kvar=[
'Upper(Left(LRTrim(cell23),3))
]
rd_var=[
'_validstato
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O632
fatherSonIndex=1
frm_calc=[
'not(Empty(LRTrim(cell23)))
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O657
fatherSonIndex=0
frm_calc='''
len=3
name='_validstato
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_validstato))
]
h=[
19
19
]
obj='If
pag=2
prev=O663
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O664
fatherSonIndex=0
frm_calc='_errore + "* Stato Intermediario Controparte Errato" + NL
len=10
name='_errore
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=2
prev=O662
rd_field=[
'CODSTA
]
rd_kfield=[
'CODSTA
]
rd_kvar=[
'Upper(Left(LRTrim(cell23),3))
]
rd_var=[
'_validstato
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O629
fatherSonIndex=0
frm_calc='''
len=3
name='_validstato
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_validstato))
]
h=[
19
19
]
obj='If
pag=2
prev=O680
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O681
fatherSonIndex=0
frm_calc='_errore + "* Stato Controparte Errato" + NL
len=10
name='_errore
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=2
prev=O679
rd_field=[
'CODSTA
]
rd_kfield=[
'CODSTA
]
rd_kvar=[
'Upper(Left(LRTrim(cell18),3))
]
rd_var=[
'_validstato
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O326
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O329
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(_legrap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_rappd='D'
'_rappd='P'
]
h=[
19
19
19
]
obj='If
pag=2
prev=O696
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O699
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=2
sel_field='intestbo->CODINTER
sel_name='intestbo
sel_where='intestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O704
fatherSonIndex=0
frm_calc=[
'not(arfn_chksogg(intestbo->CODINTER,'7'))
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O708
fatherSonIndex=0
frm_calc='_errore + "* Mancano alcuni dati anagrafici soggetto" + NL
len=10
name='_errore
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O699
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=2
sel_field='xntestbo->CODINTER
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O717
fatherSonIndex=0
frm_calc=[
'not(arfn_chksogg(xntestbo->CODINTER,'7'))
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O721
fatherSonIndex=0
frm_calc='_errore + "* Mancano alcuni dati anagrafici soggetto" + NL
len=10
name='_errore
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O696
fatherSonIndex=0
frm_calc='_errore + "* Manca NDG legale rappresentante " + NL
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc='0
len=3
name='_contadel
next=Icpitembatch.CPIfElse
frm_calc=[
'_rappd='D'
'_rappd='P'
]
h=[
19
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_contadel = 0
]
h=[
19
19
]
obj='If
pag=2
prev=O734
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O737
fatherSonIndex=0
frm_calc='_errore + "* Mancano i delegati per il rapporto" + NL
len=10
name='_errore
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O733
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O734
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=2
sel_field='*
sel_name='delegabo
sel_where='delegabo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O746
fatherSonIndex=0
frm_calc='_contadel + 1
len=3
name='_contadel
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O734
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=2
sel_field='*
sel_name='xelegabo
sel_where='xelegabo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O753
fatherSonIndex=0
frm_calc='_contadel + 1
len=3
name='_contadel
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O732
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O325
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O326
fatherSonIndex=0
frm_calc='_errore + "* Customer ID non presente in AUI " + NL
len=10
name='_errore
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=2
prev=O324
rd_field=[
'RAPPORTO
'TIPORAP
'CODICELR
]
rd_kfield=[
'SPLITCODE
]
rd_kvar=[
'LRTrim(cell04)
]
rd_var=[
'_rapporto
'_tiporap
'_legrap
]
I
obj='Var
pag=2
prev=O323
var_op='asgn
I
obj='Var
pag=2
pagelocal=True
prev=O322
var_op='asgn
I
obj='Var
pag=2
prev=O321
var_op='asgn
I
obj='Var
pag=2
prev=O318
var_op='asgn
I
obj='If
pag=2
prev=O315
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O318
fatherSonIndex=0
frm_calc='_errore + "* Codice valuta assente o errato " + NL
len=10
name='_errore
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O314
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O315
fatherSonIndex=0
frm_calc=''3'
len=1
name='cTVal
next=Icpitembatch.CPVarDecl
frm_calc=''242'
len=3
name='cCVal
obj='Var
pag=2
prev=O776
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O315
fatherSonIndex=1
frm_calc=''4'
len=1
name='cTVal
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='cCVal
next=Icpitembatch.CPRead
arch='tbvalute
obj='Read
pag=2
prev=O780
rd_field=[
'CODVAL
]
rd_kfield=[
'ISO
]
rd_kvar=[
'Left(LRTrim(cell08),3)
]
rd_var=[
'cCVal
]
I
obj='Var
pag=2
prev=O779
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O243
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O242
var_op='asgn
I
obj='Var
pag=2
prev=O241
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O238
var_op='asgn
I
obj='If
pag=2
prev=O237
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O238
fatherSonIndex=0
frm_calc='Strtran(LRTrim(cell02),"-","")
len=8
name='xData
next=Icpitembatch.CPIfElse
frm_calc=[
'Left(LRTrim(cell23),3)='086'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_intertip='02'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc=''A'
len=1
name='_segno
next=Icpitembatch.CPVarDecl
frm_calc=''12'
len=2
name='_tipope
obj='Var
pag=2
prev=O798
var_op='asgn
I
obj='Var
pag=2
prev=O795
var_op='asgn
I
obj='If
pag=2
prev=O792
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O795
fatherSonIndex=0
frm_calc=''2B'
len=2
name='_causin
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O795
fatherSonIndex=1
frm_calc=''4M'
len=2
name='_causin
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
prev=O791
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O792
fatherSonIndex=0
frm_calc=''48'
len=4
name='_cauana
next=Icpitembatch.CPVarDecl
frm_calc=''02'
len=2
name='_btipo
obj='Var
pag=2
prev=O808
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O792
fatherSonIndex=1
frm_calc=''AA'
len=4
name='_cauana
next=Icpitembatch.CPVarDecl
frm_calc=''12'
len=2
name='_btipo
obj='Var
pag=2
prev=O811
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O238
fatherSonIndex=1
frm_calc='Strtran(LRTrim(cell02),"-","")
len=8
name='xData
next=Icpitembatch.CPIfElse
frm_calc=[
'Left(LRTrim(cell33),3)='086'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_intertip='02'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc=''A'
len=1
name='_segno
next=Icpitembatch.CPVarDecl
frm_calc=''12'
len=2
name='_tipope
obj='Var
pag=2
prev=O822
var_op='asgn
I
obj='Var
pag=2
prev=O819
var_op='asgn
I
obj='If
pag=2
prev=O816
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O819
fatherSonIndex=0
frm_calc=''2B'
len=2
name='_causin
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O819
fatherSonIndex=1
frm_calc=''4M'
len=2
name='_causin
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
prev=O815
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O816
fatherSonIndex=0
frm_calc=''48'
len=4
name='_cauana
next=Icpitembatch.CPVarDecl
frm_calc=''02'
len=2
name='_btipo
obj='Var
pag=2
prev=O832
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O816
fatherSonIndex=1
frm_calc=''AA'
len=4
name='_cauana
next=Icpitembatch.CPVarDecl
frm_calc=''12'
len=2
name='_btipo
obj='Var
pag=2
prev=O835
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O238
fatherSonIndex=2
frm_calc='Strtran(LRTrim(cell03),"-","")
len=8
name='xData
next=Icpitembatch.CPIfElse
frm_calc=[
'Left(LRTrim(cell23),3)='086'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_intertip='02'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc=''D'
len=1
name='_segno
next=Icpitembatch.CPVarDecl
frm_calc=''11'
len=2
name='_tipope
obj='Var
pag=2
prev=O846
var_op='asgn
I
obj='Var
pag=2
prev=O843
var_op='asgn
I
obj='If
pag=2
prev=O840
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O843
fatherSonIndex=0
frm_calc=''1B'
len=2
name='_causin
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O843
fatherSonIndex=1
frm_calc=''3M'
len=2
name='_causin
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
prev=O839
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O840
fatherSonIndex=0
frm_calc=''26'
len=4
name='_cauana
next=Icpitembatch.CPVarDecl
frm_calc=''02'
len=2
name='_btipo
obj='Var
pag=2
prev=O856
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O840
fatherSonIndex=1
frm_calc=''AA'
len=4
name='_cauana
next=Icpitembatch.CPVarDecl
frm_calc=''12'
len=2
name='_btipo
obj='Var
pag=2
prev=O859
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
nonlocal=True
obj='Var
pag=2
prev=O236
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O235
var_op='asgn
I
obj='Var
pag=2
prev=O234
var_op='asgn
I
obj='Var
pag=2
prev=O233
var_op='asgn
I
obj='Var
pag=2
pagelocal=True
prev=O232
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O224
fatherSonIndex=1
frm_calc='gMsgProc + 'Cancello operazione N. '+LRTrim(cell06)+" del Customer ID "+LRTrim(cell04) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Cancellazione operazione N. '+LRTrim(cell06)+" del Customer ID "+LRTrim(cell04)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPRead
arch='operazbo
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_numprog))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O867
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O868
fatherSonIndex=0
obj='Write
pag=2
rd_kfield=[
'NUMPROG
'STATOREG
'STATOREG
]
rd_kop=[
'=
'>=
'<=
]
rd_kvar=[
'_numprog
''0'
''1'
]
wr_field=[
'DATARETT
'STATOREG
]
wr_op=[
'=
'=
]
wr_var=[
'Date()
''2'
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O868
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_numprog))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O881
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='fraziobo
father=O882
fatherSonIndex=0
obj='Write
pag=2
rd_kfield=[
'NUMPROG
'STATOREG
'STATOREG
]
rd_kop=[
'=
'>=
'<=
]
rd_kvar=[
'_numprog
''0'
''1'
]
wr_field=[
'DATARETT
'STATOREG
]
wr_op=[
'=
'=
]
wr_var=[
'Date()
''2'
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O882
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_numprog))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O895
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='xperazbo
father=O896
fatherSonIndex=0
obj='Delete
pag=2
rd_kfield=[
'NUMPROG
]
rd_kop=[
'=
]
rd_kvar=[
'_numprog
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O896
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_numprog))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O906
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='xraziobo
father=O907
fatherSonIndex=0
obj='Delete
pag=2
rd_kfield=[
'NUMPROG
]
rd_kop=[
'=
]
rd_kvar=[
'_numprog
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O907
fatherSonIndex=1
frm_seek='AppendBlank
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell01
frm_seek='colonna01
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell02
frm_seek='colonna02
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell03
frm_seek='colonna03
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell04
frm_seek='colonna04
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell05
frm_seek='colonna05
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell06
frm_seek='colonna06
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell07
frm_seek='colonna07
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell08
frm_seek='colonna08
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell09
frm_seek='colonna09
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell10
frm_seek='colonna10
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell11
frm_seek='colonna11
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell12
frm_seek='colonna12
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell13
frm_seek='colonna13
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell14
frm_seek='colonna14
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell15
frm_seek='colonna15
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell16
frm_seek='colonna16
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell17
frm_seek='colonna17
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell18
frm_seek='colonna18
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell19
frm_seek='colonna19
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell20
frm_seek='colonna20
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell21
frm_seek='colonna21
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell22
frm_seek='colonna22
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell23
frm_seek='colonna23
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell24
frm_seek='colonna24
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell25
frm_seek='colonna25
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell26
frm_seek='colonna26
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell27
frm_seek='colonna27
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell28
frm_seek='colonna28
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell29
frm_seek='colonna29
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell30
frm_seek='colonna30
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell31
frm_seek='colonna31
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell32
frm_seek='colonna32
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell33
frm_seek='colonna33
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell34
frm_seek='colonna34
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell35
frm_seek='colonna35
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell36
frm_seek='colonna36
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell37
frm_seek='colonna37
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell38
frm_seek='colonna38
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='cell39
frm_seek='colonna39
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc=''N'
frm_seek='flgforza
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='"Non trovata operazione corrispondente da cancellare"
frm_seek='Errore
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcErrori
obj='Var
obj_type='MC
pag=2
prev=O958
var_op='meth
I
obj='Var
obj_type='MC
pag=2
prev=O957
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O956
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O955
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O954
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O953
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O952
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O951
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O950
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O949
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O948
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O947
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O946
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O945
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O944
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O943
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O942
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O941
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O940
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O939
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O938
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O937
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O936
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O935
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O934
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O933
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O932
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O931
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O930
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O929
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O928
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O927
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O926
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O925
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O924
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O923
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O922
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O921
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O920
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O919
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O918
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O917
var_op='prop
I
obj='Var
obj_type='MC
pag=2
var_op='meth
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
rd_field=[
'NUMPROG
]
rd_kfield=[
'INFORM
]
rd_kvar=[
'cell06
]
rd_var=[
'_numprog
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
rd_field=[
'NUMPROG
]
rd_kfield=[
'INFORM
]
rd_kvar=[
'cell06
]
rd_var=[
'_numprog
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
rd_field=[
'NUMPROG
]
rd_kfield=[
'INFORM
]
rd_kvar=[
'cell06
]
rd_var=[
'_numprog
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O866
rd_field=[
'NUMPROG
]
rd_kfield=[
'INFORM
]
rd_kvar=[
'cell06
]
rd_var=[
'_numprog
]
I
obj='Var
pag=2
prev=O865
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O864
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=2
prev=O221
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O222
fatherSonIndex=0
frm_calc='// Legge il worksheet﷯Workbook workbook = Workbook.getWorkbook(new File(CPLib.LRTrim(filenome))); ﷯nfogli = workbook.getNumberOfSheets();﷯Cell[] row = null;﷯NumberCell nc = null;﷯for (int foglio = 0 ; foglio < nfogli ; foglio++) {﷯  Sheet sheet = workbook.getSheet(foglio); ﷯  righe=0;
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Elaborazione File: '+LRTrim(nomefileimport)+ ' - Foglio N. :'+LRTrim(Str(foglio,5,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPBeginEnd
comment='Legge le celle
h=[
19
19
]
obj='Begin
pag=2
prev=O984
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O985
fatherSonIndex=0
frm_calc='// Legge le righe del foglio﷯  for (int riga = 1 ; riga < sheet.getRows() ; riga++) {﷯    row = sheet.getRow(riga);          ﷯    if (row.length > 0 && CPLib.LRTrim(row[0].getContents()) != "" ) {﷯      cell01=row[0].getContents();﷯      cell02=row[1].getContents();﷯      cell03=row[2].getContents();﷯      cell04=row[3].getContents();﷯      cell05=row[4].getContents();﷯      cell06=row[5].getContents();﷯      cell07=row[6].getContents();﷯      cell08=row[7].getContents();﷯      nc = (NumberCell) row[8];﷯      cell09=nc.getValue();﷯      cell10=row[9].getContents();﷯      nc = (NumberCell) row[10];﷯      cell11=nc.getValue();﷯      cell12=row[11].getContents();﷯      cell13=row[12].getContents();﷯      cell14=row[13].getContents();﷯      cell15=row[14].getContents();  ﷯      cell16=row[15].getContents();﷯      cell17=row[16].getContents();﷯      cell18=row[17].getContents();﷯      cell19=row[18].getContents();﷯      cell20=row[19].getContents();﷯      cell21=row[20].getContents();﷯      cell22=row[21].getContents();﷯      cell23=row[22].getContents();﷯      cell24=row[23].getContents();﷯      cell25=row[24].getContents();﷯      cell26=row[25].getContents();﷯      cell27=row[26].getContents();﷯      cell28=row[27].getContents();﷯      cell29=row[28].getContents();﷯      cell30=row[29].getContents();﷯      cell31=row[30].getContents();﷯      cell32=row[31].getContents();﷯      cell33=row[32].getContents();﷯      cell34=row[33].getContents();﷯      cell35=row[34].getContents();﷯      cell36=row[35].getContents();﷯      cell37=row[36].getContents();﷯      cell38=row[37].getContents();﷯      cell39=row[38].getContents();﷯      cell40=row[39].getContents();﷯      cell41=row[40].getContents();﷯      righe++;
obj='Exec
pag=2
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O983
var_op='asgn
I
obj='Exec
pag=2
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
pagelocal=True
prev=O220
var_op='asgn
I
obj='Remark
pag=2
x=17
y=18
I
Icpitembatch.CPRead
arch='tbstati
obj='Read
pag=2
rd_field=[
'CODSTA
]
rd_kfield=[
'ISO2
]
rd_kvar=[
'Left(LRTrim(cell18),2)
]
rd_var=[
'_csta
]
x=758
y=5000
I
Icpitembatch.CPRemark
frm_calc='Scrive il foglio Excel
next=Icpitembatch.CPVarDecl
frm_calc=''Operazioni_Scartate_'+DateTimeToChar(DateTime())+".xls"
len=50
name='nomeesito
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/output/"+LRTrim(gAzienda)+"/"+nomeesito
len=50
name='nomefilexls
next=Icpitembatch.CPBeginEnd
comment='creo testata + dati base
h=[
19
19
]
next=Icpitembatch.CPForEach
for_variable='rwErrori
for_variable_type='mcRowsErrori.MCRDef
h=[
19
19
]
iterator_expr='mcErrori
next=Icpitembatch.CPBeginEnd
comment='aggiusta ultimo foglio e chiude file
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='tmp_listafile
obj='Insert
pag=3
prev=O1004
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
'nomeesito
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/"+nomeesito
]
I
obj='Begin
pag=3
prev=O1002
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1004
fatherSonIndex=0
frm_calc='//Aggiusta le colonne﷯CellView cf = new CellView();﷯cf.setAutosize(true);﷯foglio.setColumnView(0, cf);﷯foglio.setColumnView(1, cf);﷯foglio.setColumnView(2, cf);﷯foglio.setColumnView(3, cf);﷯foglio.setColumnView(4, cf);﷯foglio.setColumnView(5, cf);﷯foglio.setColumnView(6, cf);﷯foglio.setColumnView(7, cf);﷯foglio.setColumnView(8, cf);﷯foglio.setColumnView(9, cf);﷯foglio.setColumnView(10, cf);﷯foglio.setColumnView(11, cf);﷯foglio.setColumnView(12, cf);﷯foglio.setColumnView(13, cf);﷯foglio.setColumnView(14, cf);﷯foglio.setColumnView(15, cf);﷯foglio.setColumnView(16, cf);﷯foglio.setColumnView(17, cf);﷯foglio.setColumnView(18, cf);﷯foglio.setColumnView(19, cf);﷯foglio.setColumnView(20, cf);﷯foglio.setColumnView(21, cf);﷯foglio.setColumnView(22, cf);﷯foglio.setColumnView(23, cf);﷯foglio.setColumnView(24, cf);﷯foglio.setColumnView(25, cf);﷯foglio.setColumnView(26, cf);﷯foglio.setColumnView(27, cf);﷯foglio.setColumnView(28, cf);﷯foglio.setColumnView(29, cf);﷯foglio.setColumnView(30, cf);﷯foglio.setColumnView(31, cf);﷯foglio.setColumnView(32, cf);﷯foglio.setColumnView(33, cf);﷯foglio.setColumnView(34, cf);﷯foglio.setColumnView(35, cf);﷯foglio.setColumnView(36, cf);﷯foglio.setColumnView(37, cf);﷯foglio.setColumnView(38, cf);﷯foglio.setColumnView(39, cf);﷯foglio.setColumnView(40, cf);﷯file.write();﷯file.close();
obj='Exec
pag=3
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=3
prev=O1000
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1002
fatherSonIndex=0
frm_calc='// Scrive le righe degli errori﷯stringa = new Label(0,riga,rwErrori.colonna01);﷯foglio.addCell(stringa);﷯stringa = new Label(1,riga,rwErrori.colonna02);﷯foglio.addCell(stringa);﷯stringa = new Label(2,riga,rwErrori.colonna03);﷯foglio.addCell(stringa);﷯stringa = new Label(3,riga,rwErrori.colonna04);﷯foglio.addCell(stringa);﷯stringa = new Label(4,riga,rwErrori.colonna05);﷯foglio.addCell(stringa);﷯stringa = new Label(5,riga,rwErrori.colonna06);﷯foglio.addCell(stringa);﷯stringa = new Label(6,riga,rwErrori.colonna07);﷯foglio.addCell(stringa);﷯stringa = new Label(7,riga,rwErrori.colonna08);﷯foglio.addCell(stringa);﷯Number num1 = new Number(8,riga,rwErrori.colonna09,decNum);﷯foglio.addCell(num1);﷯stringa = new Label(9,riga,rwErrori.colonna10);﷯foglio.addCell(stringa);﷯num1 = new Number(10,riga,rwErrori.colonna11,dblNum);﷯foglio.addCell(num1);﷯stringa = new Label(11,riga,rwErrori.colonna12);﷯foglio.addCell(stringa);﷯stringa = new Label(12,riga,rwErrori.colonna13);﷯foglio.addCell(stringa);﷯stringa = new Label(13,riga,rwErrori.colonna14);﷯foglio.addCell(stringa);﷯stringa = new Label(14,riga,rwErrori.colonna15);﷯foglio.addCell(stringa);﷯stringa = new Label(15,riga,rwErrori.colonna16);﷯foglio.addCell(stringa);﷯stringa = new Label(16,riga,rwErrori.colonna17);﷯foglio.addCell(stringa);﷯stringa = new Label(17,riga,rwErrori.colonna18);﷯foglio.addCell(stringa);﷯stringa = new Label(18,riga,rwErrori.colonna19);﷯foglio.addCell(stringa);﷯stringa = new Label(19,riga,rwErrori.colonna20);﷯foglio.addCell(stringa);﷯stringa = new Label(20,riga,rwErrori.colonna21);﷯foglio.addCell(stringa);﷯stringa = new Label(21,riga,rwErrori.colonna22);﷯foglio.addCell(stringa);﷯stringa = new Label(22,riga,rwErrori.colonna23);﷯foglio.addCell(stringa);﷯stringa = new Label(23,riga,rwErrori.colonna24);﷯foglio.addCell(stringa);﷯stringa = new Label(24,riga,rwErrori.colonna25);﷯foglio.addCell(stringa);﷯stringa = new Label(25,riga,rwErrori.colonna26);﷯foglio.addCell(stringa);﷯stringa = new Label(26,riga,rwErrori.colonna27);﷯foglio.addCell(stringa);﷯stringa = new Label(27,riga,rwErrori.colonna28);﷯foglio.addCell(stringa);﷯stringa = new Label(28,riga,rwErrori.colonna29);﷯foglio.addCell(stringa);﷯stringa = new Label(29,riga,rwErrori.colonna30);﷯foglio.addCell(stringa);﷯stringa = new Label(30,riga,rwErrori.colonna31);﷯foglio.addCell(stringa);﷯stringa = new Label(31,riga,rwErrori.colonna32);﷯foglio.addCell(stringa);﷯stringa = new Label(32,riga,rwErrori.colonna33);﷯foglio.addCell(stringa);﷯stringa = new Label(33,riga,rwErrori.colonna34);﷯foglio.addCell(stringa);﷯stringa = new Label(34,riga,rwErrori.colonna35);﷯foglio.addCell(stringa);﷯stringa = new Label(35,riga,rwErrori.colonna36);﷯foglio.addCell(stringa);﷯stringa = new Label(36,riga,rwErrori.colonna37);﷯foglio.addCell(stringa);﷯stringa = new Label(37,riga,rwErrori.colonna38);﷯foglio.addCell(stringa);﷯stringa = new Label(38,riga,rwErrori.colonna39);﷯foglio.addCell(stringa);﷯stringa = new Label(39,riga,rwErrori.flgforza);﷯foglio.addCell(stringa);﷯stringa = new Label(40,riga,rwErrori.Errore);﷯foglio.addCell(stringa);﷯riga = riga +1;
obj='Exec
pag=3
I
I
]
w=[
150
150
]
I
obj='Begin
pag=3
prev=O999
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1000
fatherSonIndex=0
frm_calc='//base﷯riga = 1;﷯WorkbookSettings ws = new WorkbookSettings();﷯WritableWorkbook file = Workbook.createWorkbook(new File(nomefilexls), ws);﷯WritableSheet foglio = file.createSheet("Elenco",0);﷯WritableFont arial11font = new WritableFont(WritableFont.ARIAL, 11, WritableFont.BOLD, true);﷯WritableCellFormat arial11format = new WritableCellFormat (arial11font);﷯NumberFormat decimalNo = new NumberFormat("##########0.00000000000"); ﷯WritableCellFormat decNum = new WritableCellFormat(decimalNo);﷯WritableCellFormat intNum = new WritableCellFormat(NumberFormats.INTEGER);﷯WritableCellFormat dblNum = new WritableCellFormat(NumberFormats.FLOAT);﷯Label stringa = new Label(0,0,"Branch Code",arial11format);﷯foglio.addCell(stringa); ﷯stringa = new Label(1,0,"Received Date",arial11format);﷯foglio.addCell(stringa); ﷯stringa = new Label(2,0,"Released Date",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(3,0,"Entity ID",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(4,0,"Order ID",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(5,0,"Payment ID",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(6,0,"Is Payment Outgoing",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(7,0,"Payment Currency",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(8,0,"Trade Rate To Customer ",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(9,0,"Amount In Payment Currency",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(10,0,"Amount Excluding Fees In Payment Currency",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(11,0,"Fee Amount In Settlement Currency",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(12,0,"Recipient Name",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(13,0,"Recipient Address1",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(14,0,"Recipient Address2",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(15,0,"Recipient Address3",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(16,0,"Recipient City",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(17,0,"Recipient Country Code",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(18,0,"Recipient Postal Code",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(19,0,"Recipient Bank",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(20,0,"Recipient Bank Address",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(21,0,"Recipient Bank City",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(22,0,"Recipient Bank Country",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(23,0,"Recipient Bank Postal Code",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(24,0,"Recipient Bank SWIFT Code",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(25,0,"Recipient Bank Account IBAN",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(26,0,"Bank Entity Name Value2",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(27,0,"Address Value2",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(28,0,"City Value",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(29,0,"Country Code Value2",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(30,0,"Postal Zip Code Value2",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(31,0,"SWIFTCode Value2",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(32,0,"Account IBAN Value2",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(33,0,"Deal Number",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(34,0,"Settlement Bank Account",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(35,0,"Settlement Bank Account Number",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(36,0,"Authorized User",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(37,0,"XXX",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(38,0,"Action",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(39,0,"FORZA INSERIMENTO",arial11format);﷯foglio.addCell(stringa);﷯stringa = new Label(40,0,"ERRORI",arial11format);﷯foglio.addCell(stringa);﷯
obj='Exec
pag=3
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O998
var_op='asgn
I
obj='Var
pag=3
prev=O997
var_op='asgn
I
obj='Remark
pag=3
x=17
y=20
I
Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1021
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PPOPER1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='1
len=3
name='nIntest
next=Icpitembatch.CPInsert
arch='xperazbo
next=Icpitembatch.CPIfElse
frm_calc=[
'_rappd = 'D'
'_rappd = 'P'
]
h=[
19
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(Lower(LRTrim(cell07))='false' or Lower(LRTrim(cell07))='falso' or Lower(LRTrim(cell07))='0') and Upper(Left(cell06,3)) <> 'TCP'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(cell01)='554'
]
h=[
19
19
]
obj='If
pag=5
prev=O1034
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1037
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PPOPER1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='1
len=3
name='nIntest
next=Icpitembatch.CPInsert
arch='xperazbo
next=Icpitembatch.CPIfElse
frm_calc=[
'_rappd = 'D'
'_rappd = 'P'
]
h=[
19
19
19
]
obj='If
pag=5
prev=O1046
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1047
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1052
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=3
name='nIntest
obj='Var
obj_type='N
pag=5
prev=O1056
var_op='asgn
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O1056
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'intestbo->CODINTER
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientiope
father=O1056
fatherSonIndex=1
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1047
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=5
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1076
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=3
name='nIntest
obj='Var
obj_type='N
pag=5
prev=O1080
var_op='asgn
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O1080
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xntestbo->CODINTER
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientiope
father=O1080
fatherSonIndex=1
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'xntestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=5
prev=O1045
rd_kfield=[
'ANNOOPE
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DESCCIT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDBASE2
'IDEREG
'INFORM
'NOPROT
'NUMPROG
'OPRAP
'PRGIMPOPE
'PROVINCIA
'RAPPORTO
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
]
rd_kvar=[
'Year(CharToDate(xData))
'nChVal
'xData
'xData
'DateToChar(Date())
'iif(_segno='A','D6','D7')
'_intercab
'LRTrim(cell01)
'_intercod
'iif(_segno='A','3S','4S')
'_legrap
'Date()
'CharToDate(xData)
'Date()
'_intercit
''0'
''0'
'cTVal
'_tiporap
'cOpeProg1
'_idb2
'"O"+Right(cOpeProg2,9)+_idb2
'LRTrim(cell06)+"-"+iif(_segno='A','D7','D6')
'0
'cOpeProg2
''1'
'nProgImp
'_interprv
'_rapporto
''XXXXXXXXX'
'iif(_segno='A','D','A')
''0'
''1'
'_intertip
''3'
'_tipope
'0
'nVal
'cCVal
]
I
obj='Var
obj_type='N
pag=5
prev=O1044
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1043
var_op='asgn
I
obj='Var
pag=5
prev=O1042
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1031
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1034
fatherSonIndex=0
frm_calc='1
len=3
name='nIntest
next=Icpitembatch.CPIfElse
frm_calc=[
'_rappd='D'
'_rappd='P'
]
h=[
19
19
19
]
obj='If
pag=5
prev=O1105
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1106
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1111
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=3
name='nIntest
obj='Var
obj_type='N
pag=5
prev=O1115
var_op='asgn
I
obj='Select
pag=5
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=intestbo->CODINTER
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1115
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O1120
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESBEN
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'intestbo->CODINTER
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xeneficope
father=O1120
fatherSonIndex=1
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
'nIntest - 1
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1106
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=5
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1140
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=3
name='nIntest
obj='Var
obj_type='N
pag=5
prev=O1144
var_op='asgn
I
obj='Select
pag=5
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=xntestbo->CODINTER
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1144
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O1149
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESBEN
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xntestbo->CODINTER
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xeneficope
father=O1149
fatherSonIndex=1
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
]
rd_kvar=[
'cOpeProg1
'xntestbo->CODINTER
'LibreriaMit.UniqueId()
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
'nIntest - 1
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1034
fatherSonIndex=1
frm_calc='''
len=6
name='_ccab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_cprov
next=Icpitembatch.CPVarDecl
frm_calc='''
len=9
name='_ccap
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_csta
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(cell13),70)
len=70
name='_crag
next=Icpitembatch.CPIfElse
frm_calc=[
'Upper(Left(LRTrim(cell18),3))='086'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPWrite
arch='xperazbo
obj='Write
pag=5
prev=O1175
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_PRV
'C_IND
'C_CAP
'C_CAB
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'_crag
'_csta
'Left(LRTrim(cell17),30)
'_cprov
'Left(LRTrim(cell14),35)
'_ccap
'_ccab
]
I
obj='If
pag=5
prev=O1174
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1175
fatherSonIndex=0
frm_calc=''086'
len=3
name='_csta
next=Icpitembatch.CPRead
arch='tbcitta
obj='Read
pag=5
prev=O1187
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'Left(LRTrim(cell17),40)
]
rd_var=[
'_ccab
'_cprov
'_ccap
]
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1175
fatherSonIndex=1
frm_calc=''EE'
len=2
name='_cprov
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(cell18),3)
len=3
name='_csta
obj='Var
pag=5
prev=O1194
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=5
prev=O1173
var_op='asgn
I
obj='Var
pag=5
prev=O1172
var_op='asgn
I
obj='Var
pag=5
prev=O1171
var_op='asgn
I
obj='Var
pag=5
prev=O1170
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=5
prev=O1030
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1031
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1200
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=3
name='nIntest
obj='Var
obj_type='N
pag=5
prev=O1204
var_op='asgn
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O1204
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'intestbo->CODINTER
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientiope
father=O1204
fatherSonIndex=1
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1031
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=5
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1224
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=3
name='nIntest
obj='Var
obj_type='N
pag=5
prev=O1228
var_op='asgn
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O1228
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xntestbo->CODINTER
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientiope
father=O1228
fatherSonIndex=1
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'xntestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=5
prev=O1029
rd_kfield=[
'ANNOOPE
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DESC2
'DESCCIT
'DESCINTER
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDBASE2
'IDEREG
'NOPROT
'NUMPROG
'OPRAP
'PAESE
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAPPORTO
'RIFIMP
'INFORM
'SEGNO
'STATOREG
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
]
rd_kvar=[
'Year(CharToDate(xData))
'nChVal
'xData
'xData
'DateToChar(Date())
'_cauana
'_intercab
'_bcodcab
'LRTrim(cell01)
'_cbanca
'_intercod
'_causin
'_legrap
'Date()
'CharToDate(xData)
'Date()
'_bcitta
'_intercit
'Left(_bragsoc,50)
''0'
''0'
'cTVal
'_tiporap
'cOpeProg1
'_idb2
'"O"+Right(cOpeProg2,9)+_idb2
'0
'cOpeProg2
''1'
'_bstato
'nProgImp
'_bprov
'_interprv
'_rapporto
''XXXXXXXXX'
'LRTrim(cell06)
'_segno
''0'
''1'
'_btipo
'_intertip
''3'
'_tipope
'0
'nVal
'cCVal
]
I
obj='Var
obj_type='N
pag=5
prev=O1028
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1027
var_op='asgn
I
obj='Var
pag=5
prev=O1026
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1021
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("POPERAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='1
len=3
name='nIntest
next=Icpitembatch.CPInsert
arch='operazbo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(Lower(LRTrim(cell07))='false' or Lower(LRTrim(cell07))='falso' or Lower(LRTrim(cell07))='0') and Upper(Left(cell06,3)) <> 'TCP'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(cell01)='554'
]
h=[
19
19
]
obj='If
pag=5
prev=O1258
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1261
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("POPERAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='1
len=3
name='nIntest
next=Icpitembatch.CPInsert
arch='operazbo
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1270
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1271
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=3
name='nIntest
obj='Var
obj_type='N
pag=5
prev=O1275
var_op='asgn
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O1275
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'intestbo->CODINTER
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O1275
fatherSonIndex=1
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=5
prev=O1269
rd_kfield=[
'ANNOOPE
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DESCCIT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDBASE2
'IDEREG
'INFORM
'NOPROT
'NUMPROG
'OPRAP
'PRGIMPOPE
'PROVINCIA
'RAPPORTO
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
]
rd_kvar=[
'Year(CharToDate(xData))
'nChVal
'xData
'xData
'DateToChar(Date())
'iif(_segno='A','D6','D7')
'_intercab
'LRTrim(cell01)
'_intercod
'iif(_segno='A','3S','4S')
'_legrap
'Date()
'CharToDate(xData)
'Date()
'_intercit
''0'
''0'
'cTVal
'_tiporap
'cOpeProg1
'_idb2
'"O"+Right(cOpeProg2,9)+_idb2
'LRTrim(cell06)+"-"+iif(_segno='A','D7','D6')
'0
'cOpeProg2
''1'
'nProgImp
'_interprv
'_rapporto
''XXXXXXXXX'
'iif(_segno='A','D','A')
''0'
''1'
'_intertip
''3'
'_tipope
'0
'nVal
'cCVal
]
I
obj='Var
obj_type='N
pag=5
prev=O1268
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1267
var_op='asgn
I
obj='Var
pag=5
prev=O1266
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1256
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1258
fatherSonIndex=0
frm_calc='1
len=3
name='nIntest
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1299
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1300
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=3
name='nIntest
obj='Var
obj_type='N
pag=5
prev=O1304
var_op='asgn
I
obj='Select
pag=5
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=intestbo->CODINTER
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1304
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O1309
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESBEN
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'intestbo->CODINTER
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficope
father=O1309
fatherSonIndex=1
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
'nIntest - 1
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1258
fatherSonIndex=1
frm_calc='''
len=6
name='_ccab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_cprov
next=Icpitembatch.CPVarDecl
frm_calc='''
len=9
name='_ccap
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_csta
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(cell13),70)
len=70
name='_crag
next=Icpitembatch.CPIfElse
frm_calc=[
'Upper(Left(LRTrim(cell18),3))='086'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=5
prev=O1334
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_PRV
'C_IND
'C_CAP
'C_CAB
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'_crag
'_csta
'Left(LRTrim(cell17),30)
'_cprov
'Left(LRTrim(cell14),35)
'_ccap
'_ccab
]
I
obj='If
pag=5
prev=O1333
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1334
fatherSonIndex=0
frm_calc=''086'
len=3
name='_csta
next=Icpitembatch.CPRead
arch='tbcitta
obj='Read
pag=5
prev=O1346
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'Left(LRTrim(cell17),40)
]
rd_var=[
'_ccab
'_cprov
'_ccap
]
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1334
fatherSonIndex=1
frm_calc=''EE'
len=2
name='_cprov
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(cell18),3)
len=3
name='_csta
obj='Var
pag=5
prev=O1353
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=5
prev=O1332
var_op='asgn
I
obj='Var
pag=5
prev=O1331
var_op='asgn
I
obj='Var
pag=5
prev=O1330
var_op='asgn
I
obj='Var
pag=5
prev=O1329
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=5
prev=O1255
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1256
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=3
name='nIntest
obj='Var
obj_type='N
pag=5
prev=O1359
var_op='asgn
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O1359
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'intestbo->CODINTER
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O1359
fatherSonIndex=1
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=5
prev=O1254
rd_kfield=[
'ANNOOPE
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DESC2
'DESCCIT
'DESCINTER
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDBASE2
'IDEREG
'NOPROT
'NUMPROG
'OPRAP
'PAESE
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAPPORTO
'RIFIMP
'INFORM
'SEGNO
'STATOREG
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
]
rd_kvar=[
'Year(CharToDate(xData))
'nChVal
'xData
'xData
'DateToChar(Date())
'_cauana
'_intercab
'_bcodcab
'LRTrim(cell01)
'_cbanca
'_intercod
'_causin
'_legrap
'Date()
'CharToDate(xData)
'Date()
'_bcitta
'_intercit
'Left(_bragsoc,50)
''0'
''0'
'cTVal
'_tiporap
'cOpeProg1
'_idb2
'"O"+Right(cOpeProg2,9)+_idb2
'0
'cOpeProg2
''1'
'_bstato
'nProgImp
'_bprov
'_interprv
'_rapporto
''XXXXXXXXX'
'LRTrim(cell06)
'_segno
''0'
''1'
'_btipo
'_intertip
''3'
'_tipope
'0
'nVal
'cCVal
]
I
obj='Var
obj_type='N
pag=5
prev=O1253
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1252
var_op='asgn
I
obj='Var
pag=5
prev=O1251
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
x=8
y=15
I
Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1381
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PPFRAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPFRAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='1
len=3
name='nIntest
next=Icpitembatch.CPInsert
arch='xraziobo
next=Icpitembatch.CPIfElse
frm_calc=[
'_rappd = 'D'
'_rappd = 'P'
]
h=[
19
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(Lower(LRTrim(cell07))='false' or Lower(LRTrim(cell07))='falso' or Lower(LRTrim(cell07))='0') and Upper(Left(cell06,3)) <> 'TCP'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(cell01)='554'
]
h=[
19
19
]
obj='If
pag=4
prev=O1394
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1397
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PPFRAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPFRAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='1
len=3
name='nIntest
next=Icpitembatch.CPInsert
arch='xraziobo
next=Icpitembatch.CPIfElse
frm_calc=[
'_rappd = 'D'
'_rappd = 'P'
]
h=[
19
19
19
]
obj='If
pag=4
prev=O1406
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1407
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=4
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1412
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=3
name='nIntest
obj='Var
obj_type='N
pag=4
prev=O1416
var_op='asgn
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xraziobo
father=O1416
fatherSonIndex=0
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'intestbo->CODINTER
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientifrz
father=O1416
fatherSonIndex=1
obj='Insert
pag=4
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1407
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=4
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1436
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=3
name='nIntest
obj='Var
obj_type='N
pag=4
prev=O1440
var_op='asgn
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xraziobo
father=O1440
fatherSonIndex=0
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xntestbo->CODINTER
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientifrz
father=O1440
fatherSonIndex=1
obj='Insert
pag=4
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'xntestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=4
prev=O1405
rd_kfield=[
'ANNOOPE
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DESCCIT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDBASE2
'IDEREG
'INFORM
'NOPROT
'NUMPROG
'OPRAP
'PRGIMPFRZ
'PROVINCIA
'RAPPORTO
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
]
rd_kvar=[
'Year(CharToDate(xData))
'nChVal
'xData
'xData
'DateToChar(Date())
'iif(_segno='A','D6','D7')
'_intercab
'LRTrim(cell01)
'_intercod
'iif(_segno='A','3S','4S')
'_legrap
'Date()
'CharToDate(xData)
'Date()
'_intercit
''0'
''0'
'cTVal
'_tiporap
'cOpeProg1
'_idb2
'"O"+Right(cOpeProg2,9)+_idb2
'LRTrim(cell06)+"-"+iif(_segno='A','D7','D6')
'0
'cOpeProg2
''1'
'nProgImp
'_interprv
'_rapporto
''XXXXXXXXX'
'iif(_segno='A','D','A')
''0'
''1'
'_intertip
''3'
'_tipope
'0
'nVal
'cCVal
]
I
obj='Var
obj_type='N
pag=4
prev=O1404
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1403
var_op='asgn
I
obj='Var
pag=4
prev=O1402
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O1391
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1394
fatherSonIndex=0
frm_calc='1
len=3
name='nIntest
next=Icpitembatch.CPIfElse
frm_calc=[
'_rappd='D'
'_rappd='P'
]
h=[
19
19
19
]
obj='If
pag=4
prev=O1465
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1466
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=4
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1471
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=3
name='nIntest
obj='Var
obj_type='N
pag=4
prev=O1475
var_op='asgn
I
obj='Select
pag=4
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=intestbo->CODINTER
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1475
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xraziobo
father=O1480
fatherSonIndex=0
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESBEN
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'intestbo->CODINTER
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xeneficfrz
father=O1480
fatherSonIndex=1
obj='Insert
pag=4
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
'nIntest - 1
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1466
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=4
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1500
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=3
name='nIntest
obj='Var
obj_type='N
pag=4
prev=O1504
var_op='asgn
I
obj='Select
pag=4
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=xntestbo->CODINTER
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1504
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xraziobo
father=O1509
fatherSonIndex=0
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESBEN
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xntestbo->CODINTER
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xeneficfrz
father=O1509
fatherSonIndex=1
obj='Insert
pag=4
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
]
rd_kvar=[
'cOpeProg1
'xntestbo->CODINTER
'LibreriaMit.UniqueId()
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
'nIntest - 1
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1394
fatherSonIndex=1
frm_calc='''
len=6
name='_ccab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_cprov
next=Icpitembatch.CPVarDecl
frm_calc='''
len=9
name='_ccap
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_csta
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(cell13),70)
len=70
name='_crag
next=Icpitembatch.CPIfElse
frm_calc=[
'Upper(Left(LRTrim(cell18),3))='086'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPWrite
arch='xraziobo
obj='Write
pag=4
prev=O1535
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_PRV
'C_IND
'C_CAP
'C_CAB
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'_crag
'_csta
'Left(LRTrim(cell17),30)
'_cprov
'Left(LRTrim(cell14),35)
'_ccap
'_ccab
]
I
obj='If
pag=4
prev=O1534
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1535
fatherSonIndex=0
frm_calc=''086'
len=3
name='_csta
next=Icpitembatch.CPRead
arch='tbcitta
obj='Read
pag=4
prev=O1547
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'Left(LRTrim(cell17),40)
]
rd_var=[
'_ccab
'_cprov
'_ccap
]
I
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1535
fatherSonIndex=1
frm_calc=''EE'
len=2
name='_cprov
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(cell18),3)
len=3
name='_csta
obj='Var
pag=4
prev=O1554
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=4
prev=O1533
var_op='asgn
I
obj='Var
pag=4
prev=O1532
var_op='asgn
I
obj='Var
pag=4
prev=O1531
var_op='asgn
I
obj='Var
pag=4
prev=O1530
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=4
prev=O1390
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1391
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=4
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1560
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=3
name='nIntest
obj='Var
obj_type='N
pag=4
prev=O1564
var_op='asgn
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xraziobo
father=O1564
fatherSonIndex=0
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'intestbo->CODINTER
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientifrz
father=O1564
fatherSonIndex=1
obj='Insert
pag=4
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1391
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=4
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1584
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=3
name='nIntest
obj='Var
obj_type='N
pag=4
prev=O1588
var_op='asgn
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xraziobo
father=O1588
fatherSonIndex=0
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xntestbo->CODINTER
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientifrz
father=O1588
fatherSonIndex=1
obj='Insert
pag=4
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'xntestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=4
prev=O1389
rd_kfield=[
'ANNOOPE
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DESC2
'DESCCIT
'DESCINTER
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDBASE2
'IDEREG
'INFORM
'NOPROT
'NUMPROG
'OPRAP
'PAESE
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAPPORTO
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
]
rd_kvar=[
'Year(CharToDate(xData))
'nChVal
'xData
'xData
'DateToChar(Date())
'_cauana
'_intercab
'_bcodcab
'LRTrim(cell01)
'_cbanca
'_intercod
'_causin
'_legrap
'Date()
'CharToDate(xData)
'Date()
'_bcitta
'_intercit
'Left(_bragsoc,50)
''0'
''0'
'cTVal
'_tiporap
'cOpeProg1
'_idb2
'"O"+Right(cOpeProg2,9)+_idb2
'LRTrim(cell06)
'0
'cOpeProg2
''1'
'_bstato
'nProgImp
'_bprov
'_interprv
'_rapporto
''XXXXXXXXX'
'_segno
''0'
''1'
'_btipo
'_intertip
''3'
'_tipope
'0
'nVal
'cCVal
]
I
obj='Var
obj_type='N
pag=4
prev=O1388
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1387
var_op='asgn
I
obj='Var
pag=4
prev=O1386
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1381
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PFRAZIO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='1
len=3
name='nIntest
next=Icpitembatch.CPInsert
arch='fraziobo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(Lower(LRTrim(cell07))='false' or Lower(LRTrim(cell07))='falso' or Lower(LRTrim(cell07))='0') and Upper(Left(cell06,3)) <> 'TCP'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(cell01)='554'
]
h=[
19
19
]
obj='If
pag=4
prev=O1618
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1621
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PFRAZIO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='1
len=3
name='nIntest
next=Icpitembatch.CPInsert
arch='fraziobo
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=4
prev=O1630
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1631
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=3
name='nIntest
obj='Var
obj_type='N
pag=4
prev=O1635
var_op='asgn
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='fraziobo
father=O1635
fatherSonIndex=0
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'intestbo->CODINTER
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientifrz
father=O1635
fatherSonIndex=1
obj='Insert
pag=4
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=4
prev=O1629
rd_kfield=[
'ANNOOPE
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DESCCIT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDBASE2
'IDEREG
'INFORM
'NOPROT
'NUMPROG
'OPRAP
'PRGIMPFRZ
'PROVINCIA
'RAPPORTO
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
]
rd_kvar=[
'Year(CharToDate(xData))
'nChVal
'xData
'xData
'DateToChar(Date())
'iif(_segno='A','D6','D7')
'_intercab
'LRTrim(cell01)
'_intercod
'iif(_segno='A','3S','4S')
'_legrap
'Date()
'CharToDate(xData)
'Date()
'_intercit
''0'
''0'
'cTVal
'_tiporap
'cOpeProg1
'_idb2
'"O"+Right(cOpeProg2,9)+_idb2
'LRTrim(cell06)+"-"+iif(_segno='A','D7','D6')
'0
'cOpeProg2
''1'
'nProgImp
'_interprv
'_rapporto
''XXXXXXXXX'
'iif(_segno='A','D','A')
''0'
''1'
'_intertip
''3'
'_tipope
'0
'nVal
'cCVal
]
I
obj='Var
obj_type='N
pag=4
prev=O1628
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1627
var_op='asgn
I
obj='Var
pag=4
prev=O1626
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O1616
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1618
fatherSonIndex=0
frm_calc='1
len=3
name='nIntest
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=4
prev=O1659
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1660
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=3
name='nIntest
obj='Var
obj_type='N
pag=4
prev=O1664
var_op='asgn
I
obj='Select
pag=4
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=intestbo->CODINTER
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1664
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='fraziobo
father=O1669
fatherSonIndex=0
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESBEN
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'intestbo->CODINTER
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficfrz
father=O1669
fatherSonIndex=1
obj='Insert
pag=4
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
'nIntest - 1
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1618
fatherSonIndex=1
frm_calc='''
len=6
name='_ccab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_cprov
next=Icpitembatch.CPVarDecl
frm_calc='''
len=9
name='_ccap
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_csta
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(cell13),70)
len=70
name='_crag
next=Icpitembatch.CPIfElse
frm_calc=[
'Upper(Left(LRTrim(cell18),3))='086'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=4
prev=O1694
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_PRV
'C_IND
'C_CAP
'C_CAB
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'_crag
'_csta
'Left(LRTrim(cell17),30)
'_cprov
'Left(LRTrim(cell14),35)
'_ccap
'_ccab
]
I
obj='If
pag=4
prev=O1693
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1694
fatherSonIndex=0
frm_calc=''086'
len=3
name='_csta
next=Icpitembatch.CPRead
arch='tbcitta
obj='Read
pag=4
prev=O1706
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'Left(LRTrim(cell17),40)
]
rd_var=[
'_ccab
'_cprov
'_ccap
]
I
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1694
fatherSonIndex=1
frm_calc=''EE'
len=2
name='_cprov
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(cell18),3)
len=3
name='_csta
obj='Var
pag=4
prev=O1713
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=4
prev=O1692
var_op='asgn
I
obj='Var
pag=4
prev=O1691
var_op='asgn
I
obj='Var
pag=4
prev=O1690
var_op='asgn
I
obj='Var
pag=4
prev=O1689
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=4
prev=O1615
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1616
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=3
name='nIntest
obj='Var
obj_type='N
pag=4
prev=O1719
var_op='asgn
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='fraziobo
father=O1719
fatherSonIndex=0
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'intestbo->CODINTER
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientifrz
father=O1719
fatherSonIndex=1
obj='Insert
pag=4
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=4
prev=O1614
rd_kfield=[
'ANNOOPE
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DESC2
'DESCCIT
'DESCINTER
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDBASE2
'IDEREG
'NOPROT
'NUMPROG
'OPRAP
'PAESE
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAPPORTO
'RIFIMP
'INFORM
'SEGNO
'STATOREG
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
]
rd_kvar=[
'Year(CharToDate(xData))
'nChVal
'xData
'xData
'DateToChar(Date())
'_cauana
'_intercab
'_bcodcab
'LRTrim(cell01)
'_cbanca
'_intercod
'_causin
'_legrap
'Date()
'CharToDate(xData)
'Date()
'_bcitta
'_intercit
'Left(_bragsoc,50)
''0'
''0'
'cTVal
'_tiporap
'cOpeProg1
'_idb2
'"O"+Right(cOpeProg2,9)+_idb2
'0
'cOpeProg2
''1'
'_bstato
'nProgImp
'_bprov
'_interprv
'_rapporto
''XXXXXXXXX'
'LRTrim(cell06)
'_segno
''0'
''1'
'_btipo
'_intertip
''3'
'_tipope
'0
'nVal
'cCVal
]
I
obj='Var
obj_type='N
pag=4
prev=O1613
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1612
var_op='asgn
I
obj='Var
pag=4
prev=O1611
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
x=10
y=16
I
]
ManualBlocks={
'BO - Header
Icpmanualblocks.CPManualBlocks
code='import java.io.File; ﷯import java.util.Date; ﷯import java.lang.Double;﷯import jxl.*; ﷯import jxl.CellReferenceHelper;﷯import jxl.CellView;﷯import jxl.HeaderFooter;﷯import jxl.Range;﷯import jxl.Workbook;﷯import jxl.WorkbookSettings;﷯import jxl.format.Alignment;﷯import jxl.format.Border;﷯import jxl.format.BorderLineStyle;﷯import jxl.format.Colour;﷯import jxl.format.Orientation;﷯import jxl.format.PageOrder;﷯import jxl.format.PageOrientation;﷯import jxl.format.PaperSize;﷯import jxl.format.ScriptStyle;﷯import jxl.format.UnderlineStyle;﷯import jxl.write.Blank;﷯import jxl.write.Boolean;﷯import jxl.write.DateFormat;﷯import jxl.write.DateFormats;﷯import jxl.write.DateTime;﷯import jxl.write.Formula;﷯import jxl.write.Label;﷯import jxl.write.Number;﷯import jxl.write.NumberFormat;﷯import jxl.write.NumberFormats;﷯import jxl.write.WritableCellFeatures;﷯import jxl.write.WritableCellFormat;﷯import jxl.write.WritableFont;﷯import jxl.write.WritableHyperlink;﷯import jxl.write.WritableImage;﷯import jxl.write.WritableSheet;﷯import jxl.write.WritableWorkbook;﷯import jxl.write.WriteException;
name='BO - Header
I
'BO - Properties
Icpmanualblocks.CPManualBlocks
code='public String[] lista;﷯public int conteggio;﷯public int i;﷯public int contanome;﷯public int nfogli;﷯public int riga;
name='BO - Properties
I
}
comment='Importa i dati (TIPO WUBS - Correzione Errori)
date_creat=#2006-06-20
date_rev=#2024-05-22
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'FileLibMit
'Utilities
'LibreriaMit
]
modcnt=865
page_result_class=[
'
'
'
'
'
]
page_result_type=[
'U
'U
'U
'U
'U
]
page_uid=[
'KVAAPYDNKQ
'UPMTOCCRWP
'RCSAWXBMMW
'PCUBWIQQTM
'KTCIZBVXYK
]
pagename=[
'Page_1
'Page_2
'Page_3
'WriteFrazionate
'WriteOperazioni
]
pagenote=[
'
'
'
'
'
]
pagetitle=[
'Main
'Elabora il file WUBS XLS
'Scrive Foglio Excel Errori
'Scrive Frazionate
'Scrive Operazioni
]
result_type='N
runtime_filters=2
tpl_name='Function
work_file=[
'aeoprig
'anadip
'anarapbo
'beneficfrz
'beneficope
'clientifrz
'clientiope
'docfrabo
'docopebo
'fraziobo
'inter2bo
'intermbo
'intestbo
'kersonbo
'knarapbo
'mtimperr
'mtimport
'mtstati
'operazbo
'opextrbo
'personbo
'rapopebo
'tbcauana
'tbcitta
'tbstati
'tbvalute
'tmp_impwu
'tmp_list_imprich
'wersonbo
'wuchkimp
'wucodes
'wurapporti
'xapopebo
'xeneficfrz
'xeneficope
'xlientifrz
'xlientiope
'xnarapbo
'xntestbo
'xocfrabo
'xocopebo
'xperazbo
'xraziobo
'tmp_listafile
'delegabo
'xelegabo
]
work_filter=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
I
*--*
*----*
