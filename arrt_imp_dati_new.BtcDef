* --- CodePainter Revolution Batch Vers. 4.7
Icpbatch.CPBatch
Items=[
Icpitembatch.CPBeginEnd
comment='Definizione variabili caller
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili Locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='variabili copia
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='variabili locali per decoprimere il file
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili globali
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Legge dati intermediario per metteri su operazbo,fraziobo,rapopebo se mancanti
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Import Soggetti
next=Icpitembatch.CPVarDecl
frm_calc='''
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPRemark
frm_calc='Cicla sul file della lista e lancia la pagina appropriata
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_esito
next=Icpitembatch.CPExec
check='page
frm_calc='27
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_chkerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_opeerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_frzerr
next=Icpitembatch.CPIfElse
frm_calc=[
'w_chkaui='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_chkaui = 'N' or (w_chkaui='S' and w_imperr='S') or  (w_chkaui='S' and w_imperr='N' and _chkerr=0)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O28
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDropTemporaryTable
father=O31
fatherSonIndex=0
next=Icpitembatch.CPServerTemporaryTable
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWrite('./output/'+LRTrim(gAzienda)+'/archope_scarti')
len=1
name='ohand
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWrite('./output/'+LRTrim(gAzienda)+'/archfraz_scarti')
len=1
name='zhand
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWrite('./output/'+LRTrim(gAzienda)+'/opex_scarti')
len=1
name='xhand
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWrite('./output/'+LRTrim(gAzienda)+'/saldopex_scarti')
len=1
name='shand
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
obj='Try
pag=1
prev=O42
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O43
fatherSonIndex=0
frm_calc=[
'gFlgRet='S'
]
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione dati. Inizio fase di commit. Attendere prego...'
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'_esito=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPBeginEnd
comment='Scrittura file con errori
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Importazione dati terminata.'
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O56
var_op='asgn
I
obj='Begin
pag=1
prev=O53
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O56
fatherSonIndex=0
frm_calc='FileLibMit.Close(ohand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(zhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(xhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(shand)
next=Icpitembatch.CPIfElse
frm_calc=[
'_opeerr=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_frzerr=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_opxerr=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_soxerr=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'mcSoggetti.RecCount() > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O74
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O77
fatherSonIndex=0
frm_calc='FileLibMit.OpenWrite('./output/'+LRTrim(gAzienda)+'/ndg_sovrascritti')
len=1
name='fhand
next=Icpitembatch.CPForEach
for_variable='rowSoggetti
for_variable_type='mcConnes.MCRDef
h=[
19
19
]
iterator_expr='mcSoggetti
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='w_fscarti
next=Icpitembatch.CPVarDecl
frm_calc='"ndg_sovrascritti.zip"
len=20
name='_czip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/"+_czip
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/ndg_sovrascritti"
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='"ndg_sovrascritti"
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc="// These are the files to include in the ZIP file
filenames.clear();
fileonames.clear();
filenames.add(cNomeFile);
fileonames.add(cOnlyNomeFile);
°--°
next=Icpitembatch.CPExec
check='page
frm_calc='36
next=Icpitembatch.CPInsert
arch='tmp_listafile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevati soggetti che hanno sovrascritto anagrafiche esistenti. Prelevare il file ndg_sovrascritti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/opex_scarti')
obj='Exec
pag=1
prev=O94
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O93
var_op='asgn
I
obj='Insert
pag=1
prev=O92
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
''ndg_sovraSCRITTI'
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/ndg_sovrascritti.zip"
]
I
obj='Exec
pag=1
prev=O91
I
obj='Exec
pag=1
prev=O90
I
obj='Var
pag=1
prev=O89
var_op='asgn
I
obj='Var
pag=1
prev=O88
var_op='asgn
I
obj='Var
pag=1
prev=O87
var_op='asgn
I
obj='Var
pag=1
prev=O86
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='N
pag=1
prev=O85
var_op='asgn
I
obj='Exec
pag=1
prev=O83
I
obj='ForEach
pag=1
prev=O82
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O83
fatherSonIndex=0
frm_calc='FileLibMit.WriteLine(fhand,rowSoggetti.connes)
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O71
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O74
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/saldopex_scarti')
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O74
fatherSonIndex=1
frm_calc='1
len=1
name='w_fscarti
next=Icpitembatch.CPVarDecl
frm_calc='"saldopex_scarti.zip"
len=20
name='_czip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/"+_czip
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/saldopex_scarti"
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='"saldopex_scarti"
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc="// These are the files to include in the ZIP file
filenames.clear();
fileonames.clear();
filenames.add(cNomeFile);
fileonames.add(cOnlyNomeFile);
°--°
next=Icpitembatch.CPExec
check='page
frm_calc='36
next=Icpitembatch.CPInsert
arch='tmp_listafile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevate operazioni extraconto senza i dati del soggetto. Prelevare il file opex_scarti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/opex_scarti')
obj='Exec
pag=1
prev=O115
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O114
var_op='asgn
I
obj='Insert
pag=1
prev=O113
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
''opex_scarti'
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/opex_scarti.zip"
]
I
obj='Exec
pag=1
prev=O112
I
obj='Exec
pag=1
prev=O111
I
obj='Var
pag=1
prev=O110
var_op='asgn
I
obj='Var
pag=1
prev=O109
var_op='asgn
I
obj='Var
pag=1
prev=O108
var_op='asgn
I
obj='Var
pag=1
prev=O107
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=1
prev=O68
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O71
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/opex_scarti')
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O71
fatherSonIndex=1
frm_calc='1
len=1
name='w_fscarti
next=Icpitembatch.CPVarDecl
frm_calc='"opex_scarti.zip"
len=20
name='_czip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/"+_czip
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/opex_scarti"
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='"opex_scarti"
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc="// These are the files to include in the ZIP file
filenames.clear();
fileonames.clear();
filenames.add(cNomeFile);
fileonames.add(cOnlyNomeFile);
°--°
next=Icpitembatch.CPExec
check='page
frm_calc='36
next=Icpitembatch.CPInsert
arch='tmp_listafile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevate operazioni extraconto senza i dati del soggetto. Prelevare il file opex_scarti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/opex_scarti')
obj='Exec
pag=1
prev=O132
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O131
var_op='asgn
I
obj='Insert
pag=1
prev=O130
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
''opex_scarti'
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/opex_scarti.zip"
]
I
obj='Exec
pag=1
prev=O129
I
obj='Exec
pag=1
prev=O128
I
obj='Var
pag=1
prev=O127
var_op='asgn
I
obj='Var
pag=1
prev=O126
var_op='asgn
I
obj='Var
pag=1
prev=O125
var_op='asgn
I
obj='Var
pag=1
prev=O124
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=1
prev=O65
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O68
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/archfraz_scarti')
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O68
fatherSonIndex=1
frm_calc='1
len=1
name='w_fscarti
next=Icpitembatch.CPVarDecl
frm_calc='"archfraz_scarti.zip"
len=20
name='_czip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/"+_czip
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/archfraz_scarti"
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='"archfraz_scarti"
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc="// These are the files to include in the ZIP file
filenames.clear();
fileonames.clear();
filenames.add(cNomeFile);
fileonames.add(cOnlyNomeFile);
°--°
next=Icpitembatch.CPExec
check='page
frm_calc='36
next=Icpitembatch.CPInsert
arch='tmp_listafile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevate frazionate senza i dati del soggetto. Prelevare il file archfraz_scarti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/archfraz_scarti')
obj='Exec
pag=1
prev=O149
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O148
var_op='asgn
I
obj='Insert
pag=1
prev=O147
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
''archfraz_scarti'
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/archfraz_scarti.zip"
]
I
obj='Exec
pag=1
prev=O146
I
obj='Exec
pag=1
prev=O145
I
obj='Var
pag=1
prev=O144
var_op='asgn
I
obj='Var
pag=1
prev=O143
var_op='asgn
I
obj='Var
pag=1
prev=O142
var_op='asgn
I
obj='Var
pag=1
prev=O141
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=1
prev=O64
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O65
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/archope_scarti')
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O65
fatherSonIndex=1
frm_calc='1
len=1
name='w_fscarti
next=Icpitembatch.CPVarDecl
frm_calc='"archope_scarti.zip"
len=20
name='_czip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/"+_czip
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/archope_scarti"
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='"archope_scarti"
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc="// These are the files to include in the ZIP file
filenames.clear();
fileonames.clear();
filenames.add(cNomeFile);
fileonames.add(cOnlyNomeFile);
°--°
next=Icpitembatch.CPExec
check='page
frm_calc='36
next=Icpitembatch.CPInsert
arch='tmp_listafile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevate operazioni senza i dati del soggetto. Prelevare il file archope_scarti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/archope_scarti')
obj='Exec
pag=1
prev=O166
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O165
var_op='asgn
I
obj='Insert
pag=1
prev=O164
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
''archope_scarti'
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/archope_scarti.zip"
]
I
obj='Exec
pag=1
prev=O163
I
obj='Exec
pag=1
prev=O162
I
obj='Var
pag=1
prev=O161
var_op='asgn
I
obj='Var
pag=1
prev=O160
var_op='asgn
I
obj='Var
pag=1
prev=O159
var_op='asgn
I
obj='Var
pag=1
prev=O158
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=1
prev=O63
I
obj='Exec
pag=1
prev=O62
I
obj='Exec
pag=1
prev=O61
I
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O52
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O53
fatherSonIndex=0
frm_calc='commit
obj='Transaction
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O53
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=1
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O50
var_op='asgn
I
obj='Select
pag=1
prev=O47
sel_field='*
sel_name='tmp_list_imprich
sel_order='tmp_list_imprich->priorita,tmp_list_imprich->nomefile
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O50
fatherSonIndex=0
frm_calc=[
'_esito = 0
]
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='tmp_list_imprich
obj='Delete
pag=1
prev=O180
rd_kfield=[
'nomefile
]
rd_kop=[
'=
]
rd_kvar=[
'tmp_list_imprich->nomefile
]
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O180
fatherSonIndex=0
frm_calc='LRTrim(tmp_list_imprich->nomefile)
len=50
name='nomefileimport
next=Icpitembatch.CPCase
frm_calc=[
'At('archpers.txt',Lower(nomefileimport)) <> 0
'At('archdip.txt',Lower(nomefileimport)) <> 0
'At('archtito.txt',Lower(nomefileimport)) <> 0
'At('sogcli.txt',Lower(nomefileimport)) <> 0
'At('archrap.txt',Lower(nomefileimport)) <> 0
'At('archinf.txt',Lower(nomefileimport)) <> 0
'At('archope.txt',Lower(nomefileimport)) <> 0
'At('archfraz.txt',Lower(nomefileimport)) <> 0
'At('intest.txt',Lower(nomefileimport)) <> 0
'At('rapage.txt',Lower(nomefileimport)) <> 0
'At('infage.txt',Lower(nomefileimport)) <> 0
'At('opeage.txt',Lower(nomefileimport)) <> 0
'At('procdel.txt',Lower(nomefileimport)) <> 0
'At('procage.txt',Lower(nomefileimport)) <> 0
'At('sogope.txt',Lower(nomefileimport)) <> 0
'At('sogage.txt',Lower(nomefileimport)) <> 0
'At('intage.txt',Lower(nomefileimport)) <> 0
'At('sogben.txt',Lower(nomefileimport)) <> 0
'At('sogaltro.txt',Lower(nomefileimport)) <> 0
'At('persnew.txt',Lower(nomefileimport)) <> 0
'At('saldopex.txt',Lower(nomefileimport)) <> 0 or At('saldopex.xls',Lower(nomefileimport)) <> 0
'At('saldrapp.txt',Lower(nomefileimport)) <> 0 or At('saldrapp.xls',Lower(nomefileimport)) <> 0
'At('opex.txt',Lower(nomefileimport)) <> 0
'At('titosupp.txt',Lower(nomefileimport)) <> 0
'At('archope.xls',Lower(nomefileimport)) <> 0
]
h=[
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
]
obj='Case
pag=1
prev=O189
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=0
frm_calc='2
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=1
frm_calc='14
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=2
frm_calc='15
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=3
frm_calc='26
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=4
frm_calc='3
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=5
frm_calc='4
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=6
frm_calc='5
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=7
frm_calc='6
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=8
frm_calc='19
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=9
frm_calc='11
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=10
frm_calc='12
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=11
frm_calc='13
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=12
frm_calc='17
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=13
frm_calc='23
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=14
frm_calc='18
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=15
frm_calc='24
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=16
frm_calc='25
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=17
frm_calc='28
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=18
frm_calc='29
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=19
frm_calc='30
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=20
frm_calc='33
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=21
frm_calc='34
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=22
frm_calc='16
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=23
frm_calc='35
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=24
frm_calc='37
obj='Exec
pag=1
I
I
]
w=[
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
]
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intermbo
father=O47
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='xersonbo
next=Icpitembatch.CPDelete
arch='xarchope
next=Icpitembatch.CPDelete
arch='xarchfraz
next=Icpitembatch.CPDelete
arch='xnadip
obj='Delete
pag=1
prev=O252
sel_type='all
I
obj='Delete
pag=1
prev=O251
sel_type='all
I
obj='Delete
pag=1
prev=O250
sel_type='all
I
obj='Delete
pag=1
prev=O249
sel_type='all
I
obj='Write
pag=1
sel_type='all
wr_field=[
'SBLRITORNO
]
wr_op=[
'=
]
wr_var=[
''N'
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O43
fatherSonIndex=1
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Rilevati errori nell'impotazione dei file! Ricreare il file segnalato e rieseguire l'import dei dati. La procedura annullera automaticamente l'importazione" + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Errore SQL: ' + m_Sql.TransactionErrorMessage() + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='rollback
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(ohand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(zhand)
obj='Exec
pag=1
prev=O263
I
obj='Exec
pag=1
prev=O262
I
obj='Transaction
pag=1
prev=O261
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O260
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O259
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=1
prev=O41
I
obj='Var
pag=1
prev=O40
var_op='asgn
I
obj='Var
pag=1
prev=O39
var_op='asgn
I
obj='Var
pag=1
prev=O38
var_op='asgn
I
obj='Var
pag=1
prev=O37
var_op='asgn
I
obj='TempTable
pag=1
prev=O36
sel_type='def
server_table='tmp_listafile
I
obj='DropTempTable
pag=1
server_table='tmp_listafile
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O31
fatherSonIndex=1
frm_calc='gMsgProc + 'Sono state rilevati errori nei dati anagrafici. Effettuare la stampa' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Elaborazione terminata.'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=1
prev=O267
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=1
prev=O27
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O28
fatherSonIndex=0
frm_calc='32
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O26
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O25
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O24
var_op='asgn
I
obj='Exec
pag=1
prev=O23
I
obj='Var
obj_type='N
pag=1
prev=O21
var_op='asgn
I
obj='Select
pag=1
prev=O20
sel_field='*
sel_name='tmp_list_imprich
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O21
fatherSonIndex=0
frm_calc=[
'At('.zip',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O276
fatherSonIndex=0
frm_calc='LRTrim(tmp_list_imprich->nomefile)
len=100
name='czipfile
next=Icpitembatch.CPExec
check='page
frm_calc='39
obj='Exec
pag=1
prev=O281
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=1
prev=O19
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O18
var_op='asgn
I
obj='Remark
pag=1
prev=O16
I
obj='Select
pag=1
prev=O15
sel_field='*
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O16
fatherSonIndex=0
frm_calc='intermbo->CODINTER
len=11
name='_codinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->DESCCIT
len=30
name='_citinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->CODCAB
len=6
name='_cabinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->PROVINCIA
len=2
name='_prvinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->FLGOPEXTR
len=1
name='_flgmodi
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->FLGDATAIM
len=1
name='_flgdataim
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->FLGRAPCLI
len=1
name='_frapcli
obj='Var
pag=1
prev=O292
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O291
var_op='asgn
I
obj='Var
pag=1
prev=O290
var_op='asgn
I
obj='Var
pag=1
prev=O289
var_op='asgn
I
obj='Var
pag=1
prev=O288
var_op='asgn
I
obj='Var
pag=1
prev=O287
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=1
prev=O13
I
obj='Begin
pag=1
prev=O11
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Path Applicazione
father=O13
fatherSonIndex=0
global=True
len=80
name='gPathApp
next=Icpitembatch.CPVarDecl
comment='Azienda
global=True
len=10
name='gAzienda
next=Icpitembatch.CPVarDecl
comment='URL Applicazione
global=True
len=80
name='gUrlApp
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='Messaggio
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Flag Creazione File di Ritorno
global=True
len=1
name='gFlgRet
next=Icpitembatch.CPVarDecl
comment='Tipo Intermediario
global=True
len=2
name='gTipInter
nonlocal=True
obj='Var
pag=1
prev=O302
I
nonlocal=True
obj='Var
pag=1
prev=O301
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O300
I
nonlocal=True
obj='Var
pag=1
prev=O299
I
nonlocal=True
obj='Var
pag=1
prev=O298
I
nonlocal=True
obj='Var
pag=1
prev=O297
I
nonlocal=True
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O9
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O11
fatherSonIndex=0
len=25
name='column01
next=Icpitembatch.CPVarDecl
len=25
name='column02
next=Icpitembatch.CPVarDecl
len=25
name='column03
next=Icpitembatch.CPVarDecl
len=25
name='column04
next=Icpitembatch.CPVarDecl
len=25
name='column05
next=Icpitembatch.CPVarDecl
len=25
name='column06
next=Icpitembatch.CPVarDecl
len=25
name='column07
next=Icpitembatch.CPVarDecl
len=25
name='column08
next=Icpitembatch.CPVarDecl
len=25
name='column09
next=Icpitembatch.CPVarDecl
len=25
name='column10
next=Icpitembatch.CPVarDecl
len=25
name='column11
next=Icpitembatch.CPVarDecl
len=25
name='column12
next=Icpitembatch.CPVarDecl
len=25
name='column13
next=Icpitembatch.CPVarDecl
len=25
name='column14
next=Icpitembatch.CPVarDecl
len=25
name='column15
next=Icpitembatch.CPVarDecl
len=25
name='column16
next=Icpitembatch.CPVarDecl
len=25
name='column17
next=Icpitembatch.CPVarDecl
len=25
name='column18
next=Icpitembatch.CPVarDecl
len=25
name='column19
next=Icpitembatch.CPVarDecl
len=25
name='column20
next=Icpitembatch.CPVarDecl
len=25
name='column21
next=Icpitembatch.CPVarDecl
len=25
name='column22
next=Icpitembatch.CPVarDecl
len=25
name='column23
next=Icpitembatch.CPVarDecl
len=25
name='column24
next=Icpitembatch.CPVarDecl
len=25
name='column25
next=Icpitembatch.CPVarDecl
len=25
name='column26
next=Icpitembatch.CPVarDecl
len=25
name='column27
next=Icpitembatch.CPVarDecl
len=25
name='column28
next=Icpitembatch.CPVarDecl
len=25
name='column29
next=Icpitembatch.CPVarDecl
len=25
name='column30
next=Icpitembatch.CPVarDecl
len=25
name='column31
next=Icpitembatch.CPVarDecl
len=25
name='column32
next=Icpitembatch.CPVarDecl
len=25
name='column33
next=Icpitembatch.CPVarDecl
len=25
name='column34
next=Icpitembatch.CPVarDecl
len=25
name='column35
next=Icpitembatch.CPVarDecl
len=25
name='column36
next=Icpitembatch.CPVarDecl
len=25
name='column37
next=Icpitembatch.CPVarDecl
len=25
name='column38
next=Icpitembatch.CPVarDecl
len=25
name='column39
next=Icpitembatch.CPVarDecl
len=25
name='column40
next=Icpitembatch.CPVarDecl
len=25
name='column41
next=Icpitembatch.CPVarDecl
len=25
name='column42
next=Icpitembatch.CPVarDecl
len=25
name='column43
next=Icpitembatch.CPVarDecl
len=25
name='column44
next=Icpitembatch.CPVarDecl
len=25
name='column45
next=Icpitembatch.CPVarDecl
len=25
name='column46
next=Icpitembatch.CPVarDecl
len=25
name='column47
next=Icpitembatch.CPVarDecl
len=25
name='column48
next=Icpitembatch.CPVarDecl
len=25
name='column49
next=Icpitembatch.CPVarDecl
len=25
name='column50
next=Icpitembatch.CPVarDecl
len=25
name='column51
next=Icpitembatch.CPVarDecl
len=25
name='column52
next=Icpitembatch.CPVarDecl
len=25
name='column53
next=Icpitembatch.CPVarDecl
len=25
name='column54
next=Icpitembatch.CPVarDecl
len=25
name='column55
next=Icpitembatch.CPVarDecl
len=25
name='column56
next=Icpitembatch.CPVarDecl
len=25
name='column57
next=Icpitembatch.CPVarDecl
len=25
name='column58
next=Icpitembatch.CPVarDecl
len=25
name='column59
next=Icpitembatch.CPVarDecl
len=25
name='column60
next=Icpitembatch.CPVarDecl
len=25
name='column61
next=Icpitembatch.CPVarDecl
len=25
name='column62
next=Icpitembatch.CPVarDecl
len=25
name='column63
next=Icpitembatch.CPVarDecl
len=25
name='column64
next=Icpitembatch.CPVarDecl
len=25
name='column65
next=Icpitembatch.CPVarDecl
len=25
name='column66
next=Icpitembatch.CPVarDecl
len=25
name='column67
obj='Var
pag=1
prev=O372
I
obj='Var
pag=1
prev=O371
I
obj='Var
pag=1
prev=O370
I
obj='Var
pag=1
prev=O369
I
obj='Var
pag=1
prev=O368
I
obj='Var
pag=1
prev=O367
I
obj='Var
pag=1
prev=O366
I
obj='Var
pag=1
prev=O365
I
obj='Var
pag=1
prev=O364
I
obj='Var
pag=1
prev=O363
I
obj='Var
pag=1
prev=O362
I
obj='Var
pag=1
prev=O361
I
obj='Var
pag=1
prev=O360
I
obj='Var
pag=1
prev=O359
I
obj='Var
pag=1
prev=O358
I
obj='Var
pag=1
prev=O357
I
obj='Var
pag=1
prev=O356
I
obj='Var
pag=1
prev=O355
I
obj='Var
pag=1
prev=O354
I
obj='Var
pag=1
prev=O353
I
obj='Var
pag=1
prev=O352
I
obj='Var
pag=1
prev=O351
I
obj='Var
pag=1
prev=O350
I
obj='Var
pag=1
prev=O349
I
obj='Var
pag=1
prev=O348
I
obj='Var
pag=1
prev=O347
I
obj='Var
pag=1
prev=O346
I
obj='Var
pag=1
prev=O345
I
obj='Var
pag=1
prev=O344
I
obj='Var
pag=1
prev=O343
I
obj='Var
pag=1
prev=O342
I
obj='Var
pag=1
prev=O341
I
obj='Var
pag=1
prev=O340
I
obj='Var
pag=1
prev=O339
I
obj='Var
pag=1
prev=O338
I
obj='Var
pag=1
prev=O337
I
obj='Var
pag=1
prev=O336
I
obj='Var
pag=1
prev=O335
I
obj='Var
pag=1
prev=O334
I
obj='Var
pag=1
prev=O333
I
obj='Var
pag=1
prev=O332
I
obj='Var
pag=1
prev=O331
I
obj='Var
pag=1
prev=O330
I
obj='Var
pag=1
prev=O329
I
obj='Var
pag=1
prev=O328
I
obj='Var
pag=1
prev=O327
I
obj='Var
pag=1
prev=O326
I
obj='Var
pag=1
prev=O325
I
obj='Var
pag=1
prev=O324
I
obj='Var
pag=1
prev=O323
I
obj='Var
pag=1
prev=O322
I
obj='Var
pag=1
prev=O321
I
obj='Var
pag=1
prev=O320
I
obj='Var
pag=1
prev=O319
I
obj='Var
pag=1
prev=O318
I
obj='Var
pag=1
prev=O317
I
obj='Var
pag=1
prev=O316
I
obj='Var
pag=1
prev=O315
I
obj='Var
pag=1
prev=O314
I
obj='Var
pag=1
prev=O313
I
obj='Var
pag=1
prev=O312
I
obj='Var
pag=1
prev=O311
I
obj='Var
pag=1
prev=O310
I
obj='Var
pag=1
prev=O309
I
obj='Var
pag=1
prev=O308
I
obj='Var
pag=1
prev=O307
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9
fatherSonIndex=0
len=100
name='czipfile
next=Icpitembatch.CPVarDecl
len=200
name='cpercorsozip
next=Icpitembatch.CPVarDecl
len=200
name='cdirectoryfile
next=Icpitembatch.CPVarDecl
len=100
name='buffernomefile
next=Icpitembatch.CPVarDecl
len=50
name='nomefileimport
next=Icpitembatch.CPVarDecl
len=3
name='_priorita
obj='Var
obj_type='N
pag=1
prev=O381
I
obj='Var
pag=1
prev=O380
I
obj='Var
pag=1
prev=O379
I
obj='Var
pag=1
prev=O378
I
obj='Var
pag=1
prev=O377
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O5
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O7
fatherSonIndex=0
len=10
name='ciidbase
next=Icpitembatch.CPVarDecl
len=8
name='cidataini
next=Icpitembatch.CPVarDecl
len=8
name='cidatafine
next=Icpitembatch.CPVarDecl
len=12
name='cicodinter
next=Icpitembatch.CPVarDecl
len=11
name='cinumprog
next=Icpitembatch.CPVarDecl
len=1
name='citiporap
obj='Var
pag=1
prev=O390
I
obj='Var
pag=1
prev=O389
I
obj='Var
pag=1
prev=O388
I
obj='Var
obj_type='D
pag=1
prev=O387
I
obj='Var
obj_type='D
pag=1
prev=O386
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O3
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O5
fatherSonIndex=0
len=10
name='_z
next=Icpitembatch.CPVarDecl
len=1
name='fhand
next=Icpitembatch.CPVarDecl
len=1
name='ohand
next=Icpitembatch.CPVarDecl
len=1
name='zhand
next=Icpitembatch.CPVarDecl
len=1
name='xhand
next=Icpitembatch.CPVarDecl
len=1
name='shand
next=Icpitembatch.CPVarDecl
len=10
name='riga
next=Icpitembatch.CPVarDecl
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
len=1
name='_tdest
next=Icpitembatch.CPVarDecl
len=16
name='xCF
next=Icpitembatch.CPVarDecl
len=16
name='xSOCTCon
next=Icpitembatch.CPVarDecl
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
len=30
name='xCitta
next=Icpitembatch.CPVarDecl
len=6
name='cCliProg
next=Icpitembatch.CPVarDecl
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
len=1
name='xSesso
next=Icpitembatch.CPVarDecl
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
len=6
name='xCAB
next=Icpitembatch.CPVarDecl
len=2
name='xPrv
next=Icpitembatch.CPVarDecl
len=6
name='xDIP
next=Icpitembatch.CPVarDecl
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
len=8
name='xData
next=Icpitembatch.CPVarDecl
len=8
name='xDatF
next=Icpitembatch.CPVarDecl
comment='Contatore record nuovi
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
comment='Contatore record aggiornati
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
comment='Contatore record invariati
len=10
name='cNumInv
next=Icpitembatch.CPVarDecl
len=1
name='cFlagLire
next=Icpitembatch.CPVarDecl
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
len=1
name='xCFE
next=Icpitembatch.CPVarDecl
len=10
name='conta
next=Icpitembatch.CPVarDecl
len=1
name='_esito
next=Icpitembatch.CPVarDecl
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
len=1
name='_salta
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
len=10
name='nProgSto
next=Icpitembatch.CPVarDecl
len=10
name='_idbase
next=Icpitembatch.CPVarDecl
len=11
name='_codinter
next=Icpitembatch.CPVarDecl
len=30
name='_citinter
next=Icpitembatch.CPVarDecl
len=6
name='_cabinter
next=Icpitembatch.CPVarDecl
len=2
name='_prvinter
next=Icpitembatch.CPVarDecl
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
len=2
name='_interprv
next=Icpitembatch.CPVarDecl
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
len=35
name='_benind
next=Icpitembatch.CPVarDecl
len=5
name='_bencap
next=Icpitembatch.CPVarDecl
len=1
name='_flgmodi
next=Icpitembatch.CPVarDecl
len=16
name='_conadd
next=Icpitembatch.CPVarDecl
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
len=8
name='_datvarage
next=Icpitembatch.CPVarDecl
len=1
name='_flgdataim
next=Icpitembatch.CPVarDecl
len=1
name='_chkerr
next=Icpitembatch.CPVarDecl
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
len=8
name='_datarett
next=Icpitembatch.CPVarDecl
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
len=1
name='_opeerr
next=Icpitembatch.CPVarDecl
len=1
name='_frzerr
next=Icpitembatch.CPVarDecl
len=1
name='_opxerr
next=Icpitembatch.CPVarDecl
len=1
name='_soxerr
next=Icpitembatch.CPVarDecl
len=11
name='_numprog
next=Icpitembatch.CPVarDecl
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
len=1
name='_frapcli
next=Icpitembatch.CPVarDecl
len=1
name='_tiporap
next=Icpitembatch.CPVarDecl
len=20
name='_czip
next=Icpitembatch.CPVarDecl
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPVarDecl
len=30
name='_file1
next=Icpitembatch.CPVarDecl
len=30
name='_file2
next=Icpitembatch.CPVarDecl
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
len=1
name='_oldest
next=Icpitembatch.CPVarDecl
len=1
name='_newest
next=Icpitembatch.CPVarDecl
len=10
name='_idb2
next=Icpitembatch.CPVarDecl
len=15
name='_totin
next=Icpitembatch.CPVarDecl
len=15
name='_totout
next=Icpitembatch.CPVarDecl
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
len=70
name='_icrag
next=Icpitembatch.CPVarDecl
frm_seek='mcConnes.MCRDef
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_seek='mcConnes.MCRDef
name='rowSoggetti
obj='Var
obj_type='R
pag=1
prev=O499
I
obj='Var
obj_type='MC
pag=1
prev=O498
I
obj='Var
pag=1
prev=O497
I
obj='Var
pag=1
prev=O496
I
obj='Var
pag=1
prev=O495
I
obj='Var
pag=1
prev=O494
I
obj='Var
pag=1
prev=O493
I
obj='Var
obj_type='N
pag=1
prev=O492
I
obj='Var
obj_type='N
pag=1
prev=O491
I
obj='Var
pag=1
prev=O490
I
obj='Var
obj_type='N
pag=1
prev=O489
I
obj='Var
obj_type='N
pag=1
prev=O488
I
obj='Var
pag=1
prev=O487
I
obj='Var
pag=1
prev=O486
I
obj='Var
pag=1
prev=O485
I
obj='Var
pag=1
prev=O484
I
obj='Var
pag=1
prev=O483
I
obj='Var
pag=1
prev=O482
I
obj='Var
pag=1
prev=O481
I
obj='Var
pag=1
prev=O480
I
obj='Var
pag=1
prev=O479
I
obj='Var
pag=1
prev=O478
I
obj='Var
pag=1
prev=O477
I
obj='Var
obj_type='N
pag=1
prev=O476
I
obj='Var
obj_type='N
pag=1
prev=O475
I
obj='Var
obj_type='N
pag=1
prev=O474
I
obj='Var
obj_type='N
pag=1
prev=O473
I
obj='Var
obj_type='N
pag=1
prev=O472
I
obj='Var
pag=1
prev=O471
I
obj='Var
pag=1
prev=O470
I
obj='Var
obj_type='D
pag=1
prev=O469
I
obj='Var
pag=1
prev=O468
I
obj='Var
pag=1
prev=O467
I
obj='Var
pag=1
prev=O466
I
obj='Var
pag=1
prev=O465
I
obj='Var
obj_type='N
pag=1
prev=O464
I
obj='Var
obj_type='N
pag=1
prev=O463
I
obj='Var
obj_type='D
pag=1
prev=O462
I
obj='Var
obj_type='D
pag=1
prev=O461
I
obj='Var
obj_type='D
pag=1
prev=O460
I
obj='Var
pag=1
prev=O459
I
obj='Var
pag=1
prev=O458
I
obj='Var
pag=1
prev=O457
I
obj='Var
pag=1
prev=O456
I
obj='Var
pag=1
prev=O455
I
obj='Var
pag=1
prev=O454
I
obj='Var
pag=1
prev=O453
I
obj='Var
pag=1
prev=O452
I
obj='Var
pag=1
prev=O451
I
obj='Var
pag=1
prev=O450
I
obj='Var
pag=1
prev=O449
I
obj='Var
pag=1
prev=O448
I
obj='Var
pag=1
prev=O447
I
obj='Var
pag=1
prev=O446
I
obj='Var
pag=1
prev=O445
I
obj='Var
pag=1
prev=O444
I
obj='Var
pag=1
prev=O443
I
obj='Var
pag=1
prev=O442
I
obj='Var
pag=1
prev=O441
I
obj='Var
obj_type='N
pag=1
prev=O440
I
obj='Var
obj_type='N
pag=1
prev=O439
I
obj='Var
obj_type='N
pag=1
prev=O438
I
obj='Var
obj_type='N
pag=1
prev=O437
I
obj='Var
pag=1
prev=O436
I
obj='Var
pag=1
prev=O435
I
obj='Var
pag=1
prev=O434
I
obj='Var
obj_type='N
pag=1
prev=O433
I
obj='Var
obj_type='N
pag=1
prev=O432
I
obj='Var
obj_type='N
pag=1
prev=O431
I
obj='Var
pag=1
prev=O430
I
obj='Var
obj_type='N
pag=1
prev=O429
I
obj='Var
pag=1
prev=O428
I
obj='Var
pag=1
prev=O427
I
obj='Var
pag=1
prev=O426
I
obj='Var
obj_type='N
pag=1
prev=O425
I
obj='Var
obj_type='N
pag=1
prev=O424
I
obj='Var
obj_type='N
pag=1
prev=O423
I
obj='Var
pag=1
prev=O422
I
obj='Var
pag=1
prev=O421
I
obj='Var
pag=1
prev=O420
I
obj='Var
pag=1
prev=O419
I
obj='Var
pag=1
prev=O418
I
obj='Var
pag=1
prev=O417
I
obj='Var
pag=1
prev=O416
I
obj='Var
pag=1
prev=O415
I
obj='Var
pag=1
prev=O414
I
obj='Var
pag=1
prev=O413
I
obj='Var
pag=1
prev=O412
I
obj='Var
pag=1
prev=O411
I
obj='Var
pag=1
prev=O410
I
obj='Var
pag=1
prev=O409
I
obj='Var
pag=1
prev=O408
I
obj='Var
pag=1
prev=O407
I
obj='Var
pag=1
prev=O406
I
obj='Var
pag=1
prev=O405
I
obj='Var
pag=1
prev=O404
I
obj='Var
pag=1
prev=O403
I
obj='Var
pag=1
prev=O402
I
obj='Var
pag=1
prev=O401
I
obj='Var
obj_type='M
pag=1
prev=O400
I
obj='Var
pag=1
prev=O399
I
obj='Var
pag=1
prev=O398
I
obj='Var
pag=1
prev=O397
I
obj='Var
pag=1
prev=O396
I
obj='Var
pag=1
prev=O395
I
obj='Var
obj_type='N
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3
fatherSonIndex=0
len=1
name='w_tipodest
next=Icpitembatch.CPVarDecl
len=1
name='w_impzip
next=Icpitembatch.CPVarDecl
len=4
name='w_annorif
next=Icpitembatch.CPVarDecl
len=1
name='w_chkaui
next=Icpitembatch.CPVarDecl
len=1
name='w_imperr
next=Icpitembatch.CPVarDecl
len=1
name='w_creamo
next=Icpitembatch.CPVarDecl
len=1
name='w_fscarti
nonlocal=True
obj='Var
obj_type='N
pag=1
prev=O509
I
nonlocal=True
obj='Var
pag=1
prev=O508
I
nonlocal=True
obj='Var
pag=1
prev=O507
I
nonlocal=True
obj='Var
pag=1
prev=O506
I
nonlocal=True
obj='Var
obj_type='N
pag=1
prev=O505
I
nonlocal=True
obj='Var
obj_type='N
pag=1
prev=O504
I
nonlocal=True
obj='Var
pag=1
I
I
]
w=[
150
150
]
x=13
y=16
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumInv
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Soggetti Inseriti: '+LRTrim(Str(cNumNew,10,0)) + ' - Soggetti Aggiornati: '+LRTrim(Str(cNumMod,10,0)) + ' - Soggetti Invariati: '+LRTrim(Str(cNumInv,10,0)) + ' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O524
var_op='asgn
I
obj='Exec
pag=2
prev=O523
I
obj='Exec
pag=2
prev=O522
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O521
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O519
var_op='asgn
I
obj='While
pag=2
prev=O518
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O519
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=2
prev=O528
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O529
fatherSonIndex=0
frm_calc='NullDate()
len=8
name='_datvarage
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgRet='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' nominativi del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,112,16))
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,112,16))
len=16
name='xCF
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,488,16))
len=16
name='_conadd
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(_conadd)),cCli1,_conadd)
len=16
name='cCli1
next=Icpitembatch.CPRemark
frm_calc='Prima la Read si faceva per CF
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,288,1))),'G','P')
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,288,1)='M','1',iif(Substr(riga,288,1)='F','2',Substr(riga,288,1)))
len=1
name='xSesso
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,450,1)='0' or Substr(riga,450,1)='1' or Substr(riga,450,1) = ''
'Substr(riga,450,1)='N' or Substr(riga,450,1)='S'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,6)
len=6
name='xCodCab
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCodCab))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,136,30))
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'(Substr(xCF,12,1) = 'Z' or Substr(riga,448,2)='EE') and (Substr(riga,288,1)='M' or Substr(riga,288,1)='F')
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico se il soggetto in esame non è già presente l'inserisco
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xConnes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O562
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O563
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPOCLI\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='personbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=2
prev=O569
var_op='asgn
I
obj='Insert
pag=2
prev=O568
rd_kfield=[
'ALLINEATO
'ALLINEATONOMECNOME
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'CONNES
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROGIMPORT
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'TIPOPERS
'DATAVARAGE
]
rd_kvar=[
'0
'0
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,470,5)),3))
'Substr(riga,460,10)
'Upper(Substr(riga,200,30))
'Substr(riga,265,9)
'xCFE
'xCodCab
'LRTrim(Substr(riga,112,16))
'Upper(Substr(riga,297,26))
'Substr(riga,455,5)
'LRTrim(cCli1)
'CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Upper(Substr(riga,230,30))
'Substr(riga,348,100)
'Upper(Substr(riga,77,35))
'cCNAS
'cSNAS
'Upper(Substr(riga,323,25))
'Upper(Substr(riga,177,15))
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'iif(Empty(Substr(riga,487,1)),'N',Substr(riga,487,1))
'Substr(riga,451,4)
'nProgImp
'Upper(Substr(riga,260,2))
'Upper(Substr(riga,7,70))
'Upper(Substr(riga,7,70))
'Substr(riga,169,3)
'Val(Substr(riga,484,3))
'Val(Substr(riga,481,3))
'Val(Substr(riga,478,3))
'Val(Substr(riga,475,3))
'xSesso
'Substr(riga,172,3)
'Substr(riga,166,3)
'Substr(riga,448,2)
'Substr(riga,175,2)
'_tipper
'_datvarage
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O569
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+LRTrim(Substr(riga,7,70))+" con codice fiscale: "+LRTrim(Substr(riga,112,16))+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O579
I
obj='Exec
pag=2
prev=O578
I
obj='Var
obj_type='N
pag=2
prev=O577
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O576
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPVarDecl
father=O563
fatherSonIndex=1
frm_calc='CharToDate(Substr(riga,508,4)+Substr(riga,506,2)+Substr(riga,504,2))
len=8
name='_datvarage
next=Icpitembatch.CPRemark
frm_calc='Verifico se il soggetto è una persona fisica
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,288,1)='M' or Substr(riga,288,1)='F'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_seek='AppendBlank
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(xConnes)
frm_seek='connes
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcSoggetti
obj='Var
obj_type='MC
pag=2
prev=O589
var_op='meth
I
obj='Var
obj_type='MC
pag=2
prev=O588
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O585
var_op='meth
I
obj='If
pag=2
prev=O584
sons=[
Icpitembatch.CPItemSon
comment='se persona fisica
instr=Icpitembatch.CPWrite
arch='personbo
father=O585
fatherSonIndex=0
frm_calc='Errore in aggiornamento ARCHPERS
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=2
prev=O593
var_op='asgn
I
obj='Write
pag=2
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(xConnes)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O593
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
frm_calc='m_cLastMsgError = ""
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O603
I
obj='Exec
pag=2
prev=O602
I
obj='Var
obj_type='N
pag=2
prev=O601
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'DATAVARAGE
'AREAGEO
'RAREA
'RATTIV
'RCOMP
'RNATGIU
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,460,10)
'Upper(Substr(riga,200,30))
'Substr(riga,265,9)
'xCFE
'xCodCab
'LRTrim(Substr(riga,112,16))
'Upper(Substr(riga,297,26))
'Substr(riga,455,5)
'CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Upper(Substr(riga,230,30))
'Substr(riga,348,100)
'Upper(Substr(riga,77,35))
'cCNAS
'cSNAS
'Upper(Substr(riga,323,25))
'Upper(Substr(riga,177,15))
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'Substr(riga,451,4)
'Upper(Substr(riga,260,2))
'Upper(Substr(riga,7,70))
'Upper(Substr(riga,7,70))
'Substr(riga,169,3)
'xSesso
'Substr(riga,172,3)
'Substr(riga,166,3)
'Substr(riga,448,2)
'Substr(riga,175,2)
'_datvarage
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,470,5)),3))
'Val(Substr(riga,484,3))
'Val(Substr(riga,481,3))
'Val(Substr(riga,478,3))
'Val(Substr(riga,475,3))
]
I
I
Icpitembatch.CPItemSon
comment='se persona giuridica
instr=Icpitembatch.CPRemark
father=O585
fatherSonIndex=1
frm_calc='Se non è persona fisica
next=Icpitembatch.CPWrite
arch='personbo
frm_calc='Errore in aggiornamento ARCHPERS
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=2
prev=O611
var_op='asgn
I
obj='Write
pag=2
prev=O610
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(xConnes)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O611
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O620
I
obj='Var
obj_type='N
pag=2
prev=O619
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'DATAVARAGE
'AREAGEO
'RAREA
'RATTIV
'RCOMP
'RNATGIU
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,460,10)
'Upper(Substr(riga,200,30))
'Substr(riga,265,9)
'xCFE
'xCodCab
'LRTrim(Substr(riga,112,16))
'Upper(Substr(riga,297,26))
'Substr(riga,455,5)
'CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Upper(Substr(riga,230,30))
'Substr(riga,348,100)
'Upper(Substr(riga,77,35))
'cCNAS
'cSNAS
'Upper(Substr(riga,323,25))
'Upper(Substr(riga,177,15))
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'Substr(riga,451,4)
'Upper(Substr(riga,260,2))
'Upper(Substr(riga,7,70))
'Upper(Substr(riga,7,70))
'Substr(riga,169,3)
'xSesso
'Substr(riga,172,3)
'Substr(riga,166,3)
'Substr(riga,448,2)
'Substr(riga,175,2)
'_datvarage
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,470,5)),3))
'Val(Substr(riga,484,3))
'Val(Substr(riga,481,3))
'Val(Substr(riga,478,3))
'Val(Substr(riga,475,3))
]
I
obj='Remark
pag=2
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=2
prev=O583
I
obj='Var
obj_type='D
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=2
prev=O559
I
obj='If
pag=2
prev=O558
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O559
fatherSonIndex=0
frm_calc='Upper(Substr(riga,136,30))
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=2
prev=O630
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O557
var_op='asgn
I
obj='Var
pag=2
prev=O554
var_op='asgn
I
obj='If
pag=2
prev=O553
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O554
fatherSonIndex=0
frm_calc='Upper(Substr(riga,230,30))
len=30
name='xCitta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,260,2))
len=2
name='xPrv
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xPrv)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O636
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O637
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xCodCab)
]
h=[
19
19
]
obj='If
pag=2
prev=O642
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O643
fatherSonIndex=0
obj='Read
pag=2
rd_field=[
'CAB
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'xCitta
]
rd_var=[
'xCodCab
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=2
rd_field=[
'CAB
]
rd_kfield=[
'CITTA
'PROV
]
rd_kvar=[
'xCitta
'xPrv
]
rd_var=[
'xCodCab
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O637
fatherSonIndex=1
obj='Read
pag=2
rd_field=[
'CAB
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'xCitta
]
rd_var=[
'xCodCab
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O635
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O550
var_op='asgn
I
obj='If
pag=2
prev=O549
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O550
fatherSonIndex=0
frm_calc='iif(LRTrim(Substr(riga,450,1))='1',1,0)
len=1
name='xCFE
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O550
fatherSonIndex=1
frm_calc='iif(LRTrim(Substr(riga,450,1))='S',1,0)
len=1
name='xCFE
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O548
var_op='asgn
I
obj='Var
pag=2
prev=O547
var_op='asgn
I
obj='Read
pag=2
prev=O546
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(cCli1)
]
rd_var=[
'xConnes
]
I
obj='Remark
pag=2
prev=O545
I
obj='Var
pag=2
prev=O544
var_op='asgn
I
obj='Var
pag=2
prev=O543
var_op='asgn
I
obj='Var
pag=2
prev=O542
var_op='asgn
I
obj='Var
pag=2
prev=O541
var_op='asgn
I
obj='Var
pag=2
prev=O540
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O537
var_op='asgn
I
obj='If
pag=2
prev=O536
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xersonbo
father=O537
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'CONNES
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'IDPROG
]
rd_kvar=[
'Substr(riga,470,3)
'Substr(riga,460,10)
'Substr(riga,200,30)
'Substr(riga,265,9)
'Substr(riga,450,1)
'Left(riga,6)
'Substr(riga,112,16)
'Substr(riga,297,26)
'Substr(riga,455,5)
'Substr(riga,488,16)
'Substr(riga,128,8)
'Substr(riga,192,8)
'Substr(riga,289,8)
'Substr(riga,230,30)
'Substr(riga,348,100)
'Substr(riga,77,35)
'Substr(riga,136,30)
'Substr(riga,323,25)
'Substr(riga,177,15)
'Substr(riga,262,3)
'Substr(riga,274,14)
'Substr(riga,487,1)
'Substr(riga,451,4)
'Substr(riga,260,2)
'Substr(riga,7,70)
'Substr(riga,7,70)
'Substr(riga,169,3)
'Substr(riga,484,3)
'Substr(riga,481,3)
'Substr(riga,478,3)
'Substr(riga,475,3)
'Substr(riga,288,1)
'Substr(riga,172,3)
'Substr(riga,166,3)
'Substr(riga,448,2)
'Substr(riga,175,2)
'conta
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O535
var_op='asgn
I
obj='Var
pag=2
prev=O534
var_op='asgn
I
obj='Var
obj_type='D
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O517
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O516
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O515
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O514
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O513
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O512
var_op='asgn
I
obj='Remark
pag=2
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime())  + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Rapporti Inseriti: '+LRTrim(Str(cNumNew,10,0)) +' - Rapporti Aggiornati: '+LRTrim(Str(cNumMod,10,0))+' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O695
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O694
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O693
var_op='asgn
I
obj='Exec
pag=3
prev=O692
I
obj='Exec
pag=3
prev=O690
I
obj='While
pag=3
prev=O689
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O690
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' rapporti del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='cFlagLire
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,77,1)='S' or Substr(riga,77,1)='1' or Substr(riga,77,1)='7'
'Substr(riga,77,1)='E' or Substr(riga,77,1)='3' or Substr(riga,77,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='xRapporto
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O706
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xnarapbo
father=O707
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xRapporto))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O712
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O713
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xnarapbo
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='knarapbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=3
prev=O721
var_op='asgn
I
obj='Insert
pag=3
prev=O719
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGRAP
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
''P'
'Substr(riga,76,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O721
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O730
I
obj='Var
obj_type='N
pag=3
prev=O729
var_op='asgn
I
obj='Exec
pag=3
prev=O728
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Insert
pag=3
prev=O718
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
'PRGIMPRAP
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,94,5)),3))
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O719
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O739
I
obj='Var
obj_type='N
pag=3
prev=O738
var_op='asgn
I
obj='Exec
pag=3
prev=O737
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='xnarapbo
father=O713
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='knarapbo
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=3
prev=O745
var_op='asgn
I
obj='Write
pag=3
prev=O743
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'DESCRAP
'FLAGRAP
'TIPORAP
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Substr(riga,26,50)
'Substr(riga,76,1)
''P'
]
I
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O743
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O760
I
obj='Var
obj_type='N
pag=3
prev=O759
var_op='asgn
I
obj='Exec
pag=3
prev=O758
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,94,5)),3))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=3
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Left(riga,25)
]
rd_var=[
'xRapporto
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anarapbo
father=O707
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xRapporto))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O772
sons=[
Icpitembatch.CPItemSon
collapsed=True
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O773
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='anarapbo
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='knarapbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,83,1)<>'1'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=3
prev=O783
var_op='asgn
I
obj='If
pag=3
prev=O781
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O783
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PROGAET\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aetesta
h=[
19
19
]
obj='Insert
pag=3
prev=O789
rd_kfield=[
'RAPPORTO
'TIPOAG
'COINT
'DESCRI
'VALUTA
'PROGAET
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,81,2)
'iif(Substr(riga,76,1)='1','1','2')
'iif(Substr(riga,81,2)='99',Upper(Substr(riga,26,24)),'')
'Substr(riga,78,3)
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O790
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O798
I
obj='Var
obj_type='N
pag=3
prev=O797
var_op='asgn
I
obj='Exec
pag=3
prev=O796
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=3
prev=O779
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGRAP
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
''D'
'Substr(riga,76,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O781
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O808
I
obj='Var
obj_type='N
pag=3
prev=O807
var_op='asgn
I
obj='Exec
pag=3
prev=O806
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Insert
pag=3
prev=O778
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
'PRGIMPRAP
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,94,5)),3))
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O779
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O817
I
obj='Var
obj_type='N
pag=3
prev=O816
var_op='asgn
I
obj='Exec
pag=3
prev=O815
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='anarapbo
father=O773
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='knarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,83,1)<>'1'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=3
prev=O824
var_op='asgn
I
obj='If
pag=3
prev=O823
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aetesta
father=O824
fatherSonIndex=0
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'TIPOAG
'COINT
'DESCRI
'VALUTA
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,81,2)
'iif(Substr(riga,76,1)='1','1','2')
'iif(Substr(riga,81,2)='99',Upper(Substr(riga,26,24)),'')
'Substr(riga,78,3)
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=3
prev=O821
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'DESCRAP
'FLAGRAP
'TIPORAP
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Substr(riga,26,50)
'Substr(riga,76,1)
''D'
]
I
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O821
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O851
I
obj='Var
obj_type='N
pag=3
prev=O850
var_op='asgn
I
obj='Exec
pag=3
prev=O849
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,94,5)),3))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=3
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Left(riga,25)
]
rd_var=[
'xRapporto
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=3
prev=O703
var_op='asgn
I
obj='Case
pag=3
prev=O702
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O703
fatherSonIndex=0
frm_calc=''L'
len=1
name='cFlagLire
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O703
fatherSonIndex=1
frm_calc=''E'
len=1
name='cFlagLire
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O703
fatherSonIndex=2
frm_calc=''V'
len=1
name='cFlagLire
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=3
prev=O701
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O700
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O699
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O688
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O687
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O686
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O685
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O684
var_op='asgn
I
obj='Remark
pag=3
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Informazione Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O882
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O881
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O880
var_op='asgn
I
obj='Exec
pag=4
prev=O879
I
obj='Exec
pag=4
prev=O877
I
obj='While
pag=4
prev=O876
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O877
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPBeginEnd
comment='Dati intermediario
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,75,16)
len=16
name='xConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,50,16)
len=16
name='xSOCTCon
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xSOCTCon)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' informazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,46,1)='S' or Substr(riga,46,1)='1' or Substr(riga,46,1)='7'
'Substr(riga,46,1)='E' or Substr(riga,46,1)='3' or Substr(riga,46,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPRemark
frm_calc='Calcola le date
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,36,8))) or _flgdataim=1,Date(),CharToDate(Right(Substr(riga,36,8),4)+Substr(Substr(riga,36,8),3,2)+Left(Substr(riga,36,8),2)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
len=8
name='_dataope
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
prev=O907
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O908
fatherSonIndex=0
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,159,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPInsert
arch='xapopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,44,2) <> '25' and Substr(riga,44,2) <> '28'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
prev=O927
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O930
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,44,2)='25' or Substr(riga,44,2)='28'
'Substr(riga,45,1)='6' or Substr(riga,44,2)='38'
]
h=[
19
19
19
19
]
haselse=True
obj='If
pag=4
prev=O935
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O936
fatherSonIndex=0
frm_calc=[
'Substr(riga,44,2)='25'
'Substr(riga,44,2)='28'
]
h=[
19
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xelegabo
father=O941
fatherSonIndex=0
h=[
19
19
]
obj='Insert
pag=4
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O946
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O954
I
obj='Var
obj_type='N
pag=4
prev=O953
var_op='asgn
I
obj='Exec
pag=4
prev=O952
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xelegabo
father=O941
fatherSonIndex=1
h=[
19
19
]
obj='Insert
pag=4
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAFINE
'TIPOPERS
'CODINTER
'NUMPROG2
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O958
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O966
I
obj='Var
obj_type='N
pag=4
prev=O965
var_op='asgn
I
obj='Exec
pag=4
prev=O964
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xntestbo
father=O936
fatherSonIndex=1
h=[
19
19
]
obj='Insert
pag=4
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAFINE
'TIPOPERS
'CODINTER
'NUMPROG2
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O971
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O979
I
obj='Var
obj_type='N
pag=4
prev=O978
var_op='asgn
I
obj='Exec
pag=4
prev=O977
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xntestbo
father=O936
fatherSonIndex=2
h=[
19
19
]
obj='Insert
pag=4
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O983
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O991
I
obj='Var
obj_type='N
pag=4
prev=O990
var_op='asgn
I
obj='Exec
pag=4
prev=O989
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
150
150
]
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O930
fatherSonIndex=1
frm_calc=[
'Substr(riga,44,2)='25' or Substr(riga,44,2)='28'
'Substr(riga,45,1)='6' or Substr(riga,44,2)='38'
]
h=[
19
19
19
19
]
haselse=True
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xntestbo
father=O996
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cNumMod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1002
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1011
I
obj='Var
obj_type='N
pag=4
prev=O1010
var_op='asgn
I
obj='Exec
pag=4
prev=O1009
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
]
wr_op=[
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xntestbo
father=O996
fatherSonIndex=2
h=[
19
19
]
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cNumMod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1018
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1027
I
obj='Var
obj_type='N
pag=4
prev=O1026
var_op='asgn
I
obj='Exec
pag=4
prev=O1025
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
]
wr_op=[
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
]
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=4
prev=O926
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O927
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=4
sel_field='*
sel_name='xntestbo
sel_order='xntestbo->CPROWNUM
sel_where='xntestbo->RAPPORTO=Substr(riga,9,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1037
fatherSonIndex=0
frm_calc=[
'xntestbo->CODINTER=cCli1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=4
prev=O1041
var_op='asgn
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1041
fatherSonIndex=0
frm_calc='xntestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O925
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O924
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O922
var_op='asgn
I
obj='Insert
pag=4
prev=O921
rd_kfield=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'VALUTA
'CDATREG
'IDBASE2
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'_cabinter
'Substr(riga,115,6)
'_intercod
'iif((_dataope < CharToDate('20100601') or _dataope > CharToDate('20131231')),xSOCTCF,'')
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_intercit
'Substr(riga,169,50)
'cFlagLire
'Substr(riga,34,1)
'cInfProg1
''I'+Right(cInfProg2,9)+_idb2
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'iif((_dataope < CharToDate('20100601') or _dataope > CharToDate('20131231')),Substr(riga,35,1),' ')
'Substr(riga,44,2)
'Substr(riga,159,10)
'Substr(riga,47,3)
'DateToChar(_datareg)
'_idb2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O922
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1057
I
obj='Var
obj_type='N
pag=4
prev=O1056
var_op='asgn
I
obj='Exec
pag=4
prev=O1055
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=4
prev=O920
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O919
var_op='asgn
I
obj='Var
pag=4
prev=O918
var_op='asgn
I
obj='Var
pag=4
prev=O915
var_op='asgn
I
obj='If
pag=4
prev=O914
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xapopebo
father=O915
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'_unicode<>''
]
h=[
19
19
]
obj='If
pag=4
prev=O1062
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1063
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1069
I
obj='Var
obj_type='N
pag=4
prev=O1068
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,159,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
prev=O913
var_op='asgn
I
obj='Remark
pag=4
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O908
fatherSonIndex=1
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,159,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPInsert
arch='rapopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,44,2) <> '25' and Substr(riga,44,2) <> '28'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
prev=O1091
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1094
fatherSonIndex=0
frm_calc=[
'Substr(riga,44,2)  = '25'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='delegabo
father=O1099
fatherSonIndex=0
h=[
19
19
]
obj='Insert
pag=4
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1104
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1112
I
obj='Var
obj_type='N
pag=4
prev=O1111
var_op='asgn
I
obj='Exec
pag=4
prev=O1110
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1099
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='intestbo
h=[
19
19
]
obj='Insert
pag=4
prev=O1116
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1117
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1125
I
obj='Var
obj_type='N
pag=4
prev=O1124
var_op='asgn
I
obj='Exec
pag=4
prev=O1123
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1094
fatherSonIndex=1
frm_calc=[
'Substr(riga,44,2)='28'
'Substr(riga,45,1)='6' or Substr(riga,44,2)='38'
]
h=[
19
19
19
19
]
haselse=True
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='delegabo
father=O1130
fatherSonIndex=0
h=[
19
19
]
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cCli1
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1135
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1144
I
obj='Var
obj_type='N
pag=4
prev=O1143
var_op='asgn
I
obj='Exec
pag=4
prev=O1142
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestbo
father=O1130
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cCli1
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1151
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1160
I
obj='Var
obj_type='N
pag=4
prev=O1159
var_op='asgn
I
obj='Exec
pag=4
prev=O1158
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestbo
father=O1130
fatherSonIndex=2
h=[
19
19
]
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cCli1
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1167
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1176
I
obj='Var
obj_type='N
pag=4
prev=O1175
var_op='asgn
I
obj='Exec
pag=4
prev=O1174
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'NUMPROG1
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
]
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=4
prev=O1090
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPSelect
father=O1091
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=4
sel_field='*
sel_name='intestbo
sel_order='intestbo->CPROWNUM
sel_where='intestbo->RAPPORTO=Substr(riga,9,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1186
fatherSonIndex=0
frm_calc=[
'intestbo->CODINTER=cCli1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=4
prev=O1190
var_op='asgn
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1190
fatherSonIndex=0
frm_calc='intestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1091
fatherSonIndex=1
frm_calc=[
'Substr(riga,44,2)  = '25'
'Substr(riga,44,2) = '28'
]
h=[
19
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1200
fatherSonIndex=0
frm_calc='0
len=10
name='cNumMod
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1200
fatherSonIndex=1
frm_calc='1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O1089
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1088
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1086
var_op='asgn
I
obj='Insert
pag=4
prev=O1085
rd_kfield=[
'CDATOPE
'CDATREG
'CODCAB
'CODDIPE
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'VALUTA
'IDBASE2
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'_intercab
'Substr(riga,115,6)
'_intercod
'iif((_dataope < CharToDate('20100601') or _dataope > CharToDate('20131231')),xSOCTCF,'')
'_dataope
'_datareg
'_intercit
'Substr(riga,169,50)
'cFlagLire
'Substr(riga,34,1)
'cInfProg1
'"I"+Right(cInfProg2,9)+_idb2
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'iif((_dataope < CharToDate('20100601') or _dataope > CharToDate('20131231')),Substr(riga,35,1),' ')
'Substr(riga,44,2)
'Substr(riga,159,10)
'Substr(riga,47,3)
'_idb2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1086
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1216
I
obj='Var
obj_type='N
pag=4
prev=O1215
var_op='asgn
I
obj='Exec
pag=4
prev=O1214
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=4
prev=O1084
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1083
var_op='asgn
I
obj='Var
pag=4
prev=O1082
var_op='asgn
I
obj='Var
pag=4
prev=O1079
var_op='asgn
I
obj='If
pag=4
prev=O1078
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='rapopebo
father=O1079
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'_unicode<>''
]
h=[
19
19
]
obj='If
pag=4
prev=O1221
sons=[
Icpitembatch.CPItemSon
comment='In caso di _unicode doppio blocco l'importazione
instr=Icpitembatch.CPVarDecl
father=O1222
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1228
I
obj='Var
obj_type='N
pag=4
prev=O1227
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,159,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=4
prev=O906
I
obj='Var
obj_type='D
pag=4
prev=O905
var_op='asgn
I
obj='Var
obj_type='D
pag=4
prev=O904
var_op='asgn
I
obj='Remark
pag=4
prev=O901
I
obj='Case
pag=4
prev=O900
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O901
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O901
fatherSonIndex=1
frm_calc=[
'Substr(riga,46,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1241
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1241
fatherSonIndex=1
frm_calc='Substr(riga,46,1)
len=1
name='cFlagLire
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O901
fatherSonIndex=2
frm_calc='Substr(riga,46,1)
len=1
name='cFlagLire
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O899
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O896
var_op='asgn
I
obj='If
pag=4
prev=O895
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O896
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=4
prev=O1255
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O1256
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=4
prev=O1261
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1262
fatherSonIndex=0
frm_calc='xSOCTCon
len=16
name='xSOCTCF
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
prev=O894
var_op='asgn
I
obj='Var
pag=4
prev=O891
var_op='asgn
I
obj='If
pag=4
prev=O890
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O891
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
obj='If
pag=4
prev=O1281
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1282
fatherSonIndex=0
frm_calc='xConnes
len=16
name='cCli1
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
prev=O889
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
obj='Var
pag=4
prev=O887
var_op='asgn
I
obj='Begin
pag=4
prev=O886
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O887
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,104,11))),_codinter,Substr(riga,104,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,121,30))),_citinter,Substr(riga,121,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,153,6))),_cabinter,Substr(riga,153,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,151,2))),_prvinter,Substr(riga,151,2))
len=2
name='_interprv
obj='Var
pag=4
prev=O1302
var_op='asgn
I
obj='Var
pag=4
prev=O1301
var_op='asgn
I
obj='Var
pag=4
prev=O1300
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O875
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O874
var_op='asgn
I
obj='Var
pag=4
prev=O873
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O872
var_op='asgn
I
obj='Remark
pag=4
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Inserite o modificate: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1317
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1316
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1315
var_op='asgn
I
obj='Exec
pag=5
prev=O1314
I
obj='Exec
pag=5
prev=O1312
I
obj='While
pag=5
prev=O1311
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1312
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=5
prev=O1321
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1322
fatherSonIndex=0
frm_calc=[
'gFlgRet='S' and w_tipodest='P'
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1330
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O1332
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,257,6))))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,318,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc='_flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,155,1)='S' or Substr(riga,155,1)='1' or Substr(riga,155,1)='7'
'Substr(riga,155,1)='E' or Substr(riga,155,1)='3' or Substr(riga,155,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,147,8))) or _flgdataim=1,Date(),CharToDate(Right(Substr(riga,147,8),4)+Substr(Substr(riga,147,8),3,2)+Left(Substr(riga,147,8),2)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,9,1)='1' or Substr(riga,9,1)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,301,1)),'0',iif(Substr(riga,301,1)='S','1',iif(Substr(riga,301,1)='N','1',Substr(riga,301,1))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,231,11))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,852,19))),0,Val(LRTrim(Substr(riga,852,19))))
len=15
name='_totin
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,871,19))),0,Val(LRTrim(Substr(riga,871,19))))
len=15
name='_totout
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge i dati dell'intermediario controparte
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P' and not(Empty(LRTrim(Left(riga,8))))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1367
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1369
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPInsert
arch='xperazbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=5
prev=O1378
var_op='asgn
I
obj='Insert
pag=5
prev=O1377
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
'IMPIN
'IMPOUT
]
rd_kvar=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'Substr(riga,10,4)
'_intercab
'_iccab
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'Substr(riga,484,16)
'Substr(riga,302,16)
'Substr(riga,190,16)
'Substr(riga,206,16)
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_iccit
'_intercit
'_icrag
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'cOpeProg1
'cIdCau
'"O"+Right(cOpeProg2,9)+_idb2
'Substr(riga,424,30)
'Substr(riga,813,15)
'Substr(riga,414,5)
'Substr(riga,662,50)
'cOpeProg2
'Substr(riga,328,3)
''1'
'iif(Empty(Substr(riga,828,14)) or Substr(riga,828,14)='01010001000000',NullDateTime(),CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6)))
'_icsta
'Substr(riga,812,1)
'nProgImp
'_icprv
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
''0'
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'_colleg
'_idb2
'_totin / 100
'_totout / 100
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1378
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O1387
I
obj='Var
obj_type='N
pag=5
prev=O1386
var_op='asgn
I
obj='Exec
pag=5
prev=O1385
I
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=5
prev=O1376
var_op='asgn
I
obj='Var
pag=5
prev=O1375
var_op='asgn
I
obj='Var
pag=5
prev=O1374
var_op='asgn
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1369
fatherSonIndex=1
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,331,9))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))) or (Empty(LRTrim(_numprog)) and not(Empty(LRTrim(Left(riga,8)))))
]
h=[
19
19
]
obj='If
pag=5
prev=O1395
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1398
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPInsert
arch='operazbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_oldidb)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=5
prev=O1411
var_op='asgn
I
obj='If
pag=5
prev=O1409
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1411
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='sogopebo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='clientiope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='beneficope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='terzistiope
obj='Delete
pag=5
prev=O1426
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=5
prev=O1425
sel_field='*
sel_name='terzistiope
sel_where='terzistiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistiope
father=O1426
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'cOpeProg1
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=5
prev=O1423
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=5
prev=O1422
sel_field='*
sel_name='beneficope
sel_where='beneficope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficope
father=O1423
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
]
rd_kvar=[
'cOpeProg1
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=5
prev=O1420
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=5
prev=O1419
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O1420
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=5
prev=O1417
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=5
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sogopebo
father=O1417
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=5
prev=O1408
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
'IMPIN
'IMPOUT
]
rd_kvar=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'Substr(riga,10,4)
'_intercab
'_iccab
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'Substr(riga,484,16)
'Substr(riga,302,16)
'Substr(riga,190,16)
'Substr(riga,206,16)
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_datarett
'_iccit
'_intercit
'_icrag
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'_flagrap2
'cOpeProg1
'cIdCau
'"O"+Right(cOpeProg2,9)+_idb2
'Substr(riga,424,30)
'Substr(riga,813,15)
'Substr(riga,414,5)
'Substr(riga,662,50)
'cOpeProg2
'Substr(riga,328,3)
'_idreg
''1'
'iif(Empty(Substr(riga,828,14)) or Substr(riga,828,14)='01010001000000',NullDateTime(),CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6)))
'_icsta
'Substr(riga,812,1)
'nProgImp
'_icprv
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
'_statoreg
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'_colleg
'_idb2
'_totin / 100
'_totout / 100
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1409
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O1472
I
obj='Var
obj_type='N
pag=5
prev=O1471
var_op='asgn
I
obj='Exec
pag=5
prev=O1470
I
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=5
prev=O1407
var_op='asgn
I
obj='Var
pag=5
prev=O1406
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1403
var_op='asgn
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1403
fatherSonIndex=0
frm_calc='_numprog
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''1'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
obj='Var
obj_type='D
pag=5
prev=O1478
var_op='asgn
I
obj='Var
pag=5
prev=O1477
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1403
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("POPERAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''0'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datarett
obj='Var
obj_type='D
pag=5
prev=O1482
var_op='asgn
I
obj='Var
pag=5
prev=O1481
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1392
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1395
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Left(riga,8)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1488
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1493
sel_field='operazbo->IDBASE
sel_name='operazbo
sel_where='operazbo->NUMPROG=_numprog and (operazbo->STATOREG='0'  or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O1494
fatherSonIndex=0
frm_calc='"E' stata cancellata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=5
prev=O1498
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'operazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
]
wr_var=[
''2'
'Date()
]
I
nonlocal=True
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
father=O1488
fatherSonIndex=1
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"E' stata variata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1509
sel_field='operazbo->IDBASE,operazbo->NUMPROG,operazbo->DATAOPE,operazbo->FLAGRAP2
sel_name='operazbo
sel_where='operazbo->NUMPROG=_numprog and (operazbo->STATOREG='0'  or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1510
fatherSonIndex=0
frm_calc='operazbo->IDBASE
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(operazbo->FLAGRAP2) or operazbo->FLAGRAP2='S',Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(operazbo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='operazbo->IDEREG
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='operazbo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1522
sel_field='*
sel_name='terzistiope
sel_where='terzistiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='merzistiope
father=O1524
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'IDREG
]
rd_kvar=[
'_oldidb
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1520
sel_field='*
sel_name='beneficope
sel_where='beneficope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='meneficope
father=O1522
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
'IDREG
]
rd_kvar=[
'_oldidb
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1518
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mlientiope
father=O1520
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1517
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mogopebo
father=O1518
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=5
prev=O1516
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'operazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
'FLAGRAP2
]
wr_op=[
'=
'=
'=
]
wr_var=[
''3'
'Date()
'_flagrap2
]
I
obj='Var
pag=5
prev=O1515
var_op='asgn
I
obj='Var
pag=5
prev=O1514
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=5
prev=O1508
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1391
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1392
fatherSonIndex=0
frm_calc=[
'Upper(Substr(riga,331,9))='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1561
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_field='operazbo->NUMPROG
sel_name='operazbo
sel_where='operazbo->INFORM = Substr(riga,424,30) and (operazbo->STATOREG='0' or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1566
fatherSonIndex=0
frm_calc='operazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1561
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=5
sel_field='operazbo->NUMPROG
sel_name='operazbo
sel_where='operazbo->RIFIMP = Substr(riga,331,9) and (operazbo->STATOREG='0' or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1573
fatherSonIndex=0
frm_calc='operazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=5
prev=O1365
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1367
fatherSonIndex=0
frm_calc='''
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=70
name='_icrag
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,18,11)))) and Len(LRTrim(Substr(riga,64,6)+Substr(riga,70,50)+Substr(riga,29,3)+Substr(riga,62,2)+Substr(riga,32,30))) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1588
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O1589
fatherSonIndex=0
obj='Read
pag=5
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'Substr(riga,18,11)
]
rd_var=[
'_iccab
'_iccit
'_icprv
'_icsta
'_icrag
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1589
fatherSonIndex=1
frm_calc='Substr(riga,64,6)
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,32,30)
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,62,2)
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,29,3))
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,70,50)
len=70
name='_icrag
obj='Var
pag=5
prev=O1603
var_op='asgn
I
obj='Var
pag=5
prev=O1602
var_op='asgn
I
obj='Var
pag=5
prev=O1601
var_op='asgn
I
obj='Var
pag=5
prev=O1600
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=5
prev=O1587
var_op='asgn
I
obj='Var
pag=5
prev=O1586
var_op='asgn
I
obj='Var
pag=5
prev=O1585
var_op='asgn
I
obj='Var
pag=5
prev=O1584
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
prev=O1364
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1365
fatherSonIndex=0
frm_calc='Upper(Substr(riga,511,70))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,581,3))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,584,30))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,614,6)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,620,2))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,622,35))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,657,5))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,302,16))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=5
prev=O1619
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1622
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,120,25))))
]
h=[
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1627
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1632
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O1643
I
obj='Read
pag=5
prev=O1642
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=5
prev=O1641
var_op='asgn
I
obj='Var
pag=5
prev=O1640
var_op='asgn
I
obj='Var
pag=5
prev=O1639
var_op='asgn
I
obj='Var
pag=5
prev=O1638
var_op='asgn
I
obj='Var
pag=5
prev=O1637
var_op='asgn
I
obj='Var
pag=5
prev=O1636
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1616
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1619
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=5
prev=O1660
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,302,16)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=5
prev=O1659
var_op='asgn
I
obj='Var
pag=5
prev=O1658
var_op='asgn
I
obj='Var
pag=5
prev=O1657
var_op='asgn
I
obj='Var
pag=5
prev=O1656
var_op='asgn
I
obj='Var
pag=5
prev=O1655
var_op='asgn
I
obj='Var
pag=5
prev=O1654
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1615
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O1616
fatherSonIndex=0
obj='Read
pag=5
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1614
var_op='asgn
I
obj='Var
pag=5
prev=O1613
var_op='asgn
I
obj='Var
pag=5
prev=O1612
var_op='asgn
I
obj='Var
pag=5
prev=O1611
var_op='asgn
I
obj='Var
pag=5
prev=O1610
var_op='asgn
I
obj='Var
pag=5
prev=O1609
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1363
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1362
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1361
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1359
var_op='asgn
I
obj='Select
pag=5
par_expr=[
'Substr(riga,10,4)
'Substr(riga,14,2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O1358
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1359
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1357
var_op='asgn
I
obj='Var
pag=5
prev=O1356
var_op='asgn
I
obj='Var
pag=5
prev=O1355
var_op='asgn
I
obj='Var
pag=5
prev=O1354
var_op='asgn
I
obj='Var
pag=5
prev=O1353
var_op='asgn
I
obj='Var
obj_type='D
pag=5
prev=O1350
var_op='asgn
I
obj='Case
pag=5
prev=O1349
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1350
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1350
fatherSonIndex=1
frm_calc=[
'Substr(riga,155,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1686
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1686
fatherSonIndex=1
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1350
fatherSonIndex=2
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=5
prev=O1348
var_op='asgn
I
obj='Var
pag=5
prev=O1347
var_op='asgn
I
obj='Var
pag=5
prev=O1344
var_op='asgn
I
obj='If
pag=5
prev=O1343
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O1344
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=5
prev=O1700
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1701
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O1707
I
obj='Var
obj_type='N
pag=5
prev=O1706
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,318,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1342
var_op='asgn
I
obj='Remark
pag=5
prev=O1339
I
obj='If
pag=5
prev=O1337
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1339
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,263,30))+LRTrim(Substr(riga,295,6))+LRTrim(Substr(riga,293,2))))
]
h=[
19
19
]
obj='If
pag=5
prev=O1719
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1722
fatherSonIndex=0
frm_calc='LRTrim(Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=5
prev=O1728
var_op='asgn
I
obj='Var
pag=5
prev=O1727
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1718
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1719
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(Substr(riga,257,6))+" non è prensente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O1734
I
obj='Var
obj_type='N
pag=5
prev=O1733
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O1717
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'Substr(riga,257,6)
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1337
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,246,11))),_codinter,Substr(riga,246,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,263,30))),_citinter,Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,295,6))),_cabinter,Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,293,2))),_prvinter,Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=5
prev=O1746
var_op='asgn
I
obj='Var
pag=5
prev=O1745
var_op='asgn
I
obj='Var
pag=5
prev=O1744
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1332
fatherSonIndex=1
frm_calc='1
len=1
name='_opeerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(ohand,riga+" - "+_descerr)
obj='Exec
pag=5
prev=O1750
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=5
prev=O1327
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1330
fatherSonIndex=0
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,190,16))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,206,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,484,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,190,16))) and Empty(LRTrim(Substr(riga,120,25))) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=5
prev=O1766
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1769
fatherSonIndex=0
frm_calc=''Rapporto continuativo o Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O1774
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1763
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1766
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=5
prev=O1780
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1781
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto per conto del quale assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O1786
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O1779
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,484,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1760
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1763
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=5
prev=O1797
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1798
fatherSonIndex=0
frm_calc=''Anagrafica Controparte Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O1803
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O1796
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,302,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1757
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1760
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=5
prev=O1814
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1815
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto Operante Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O1820
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O1813
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,206,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1756
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1757
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=5
prev=O1831
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1832
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O1837
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O1830
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,190,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1755
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xarchope
father=O1327
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDPROG
'DATAOPE
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'CONNESCLI
'CONNESOPER
'CAMBIO
'NUMPROG
'TIPOOPRAP
'TIPOINTER
'CODINTER
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'CONNESBEN
'UNIQUECODE
'AGOPER
'RIFIMP
'ZCPARTE
'RAGIO
'MODSVOL
'AREAGEO
'INFORM
'AMMONT
'DURAT
'TIPO
'RRAGIO
'RCOMP
'RAREA
'RIMP
'RFREQ
'CONNALTRO
'DATAIMP
'RTIPO
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'NATURA
'SCOPO
'C_RAPPORTO
'RAPPORTBEN
'PAGASOGOP
'IPCOLLEG
'ORACOLLEG
'DUCOLLEG
]
rd_kvar=[
'conta
'Substr(riga,1,8)        
'Substr(riga,9,1)        
'Substr(riga,10,4)       
'Substr(riga,14,2)       
'Substr(riga,16,2)       
'Substr(riga,18,11)      
'Substr(riga,29,3)       
'Substr(riga,32,30)      
'Substr(riga,62,2)       
'Substr(riga,64,6)       
'Substr(riga,70,50)      
'Substr(riga,120,25)     
'Substr(riga,145,1)      
'Substr(riga,146,1)      
'Substr(riga,147,8)      
'Substr(riga,155,1)      
'Substr(riga,156,3)      
'Substr(riga,159,1)      
'Substr(riga,160,15)     
'Substr(riga,175,15)     
'Substr(riga,190,16)     
'Substr(riga,206,16)     
'Substr(riga,222,9)      
'Substr(riga,231,11)     
'Substr(riga,242,2)      
'Substr(riga,244,2)      
'Substr(riga,246,11)     
'Substr(riga,257,6)      
'Substr(riga,263,30)     
'Substr(riga,293,2)      
'Substr(riga,295,6)      
'Substr(riga,301,1)      
'Substr(riga,302,16)     
'Substr(riga,318,10)     
'Substr(riga,328,3)      
'Substr(riga,331,9)      
'Substr(riga,340,69)     
'Substr(riga,409,5)      
'Substr(riga,414,5)      
'Substr(riga,419,5)      
'Substr(riga,424,30)     
'Substr(riga,454,5)      
'Substr(riga,459,5)      
'Substr(riga,464,5)      
'Substr(riga,469,3)      
'Substr(riga,472,3)      
'Substr(riga,475,3)      
'Substr(riga,478,3)      
'Substr(riga,481,3)      
'Substr(riga,484,16)     
'Substr(riga,500,8)      
'Substr(riga,508,3)      
'Substr(riga,511,70)     
'Substr(riga,581,3)      
'Substr(riga,584,30)     
'Substr(riga,614,6)      
'Substr(riga,620,2)      
'Substr(riga,622,35)     
'Substr(riga,657,5)      
'Substr(riga,662,50)     
'Substr(riga,712,50)     
'Substr(riga,762,25)     
'Substr(riga,787,25)     
'Substr(riga,812,1)      
'Substr(riga,813,15)     
'Substr(riga,828,14)     
'Substr(riga,842,10)     
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1310
var_op='asgn
I
obj='Var
pag=5
prev=O1309
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1308
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1307
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
prev=O1306
I
obj='Remark
pag=5
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Frazionate Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O1865
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O1864
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O1863
var_op='asgn
I
obj='Exec
pag=6
prev=O1862
I
obj='Exec
pag=6
prev=O1860
I
obj='While
pag=6
prev=O1859
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1860
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=6
prev=O1869
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
father=O1870
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
prev=O1875
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O1877
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,257,6))))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,318,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc='_flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,147,8))) or _flgdataim=1,Date(),CharToDate(Right(Substr(riga,147,8),4)+Substr(Substr(riga,147,8),3,2)+Left(Substr(riga,147,8),2)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,9,1)='1' or Substr(riga,9,1)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,301,1)),'0',iif(Substr(riga,301,1)='S','1',iif(Substr(riga,301,1)='N','1',Substr(riga,301,1))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,231,11))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' frazionate del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,852,19))),0,Val(LRTrim(Substr(riga,852,19))))
len=15
name='_totin
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,871,19))),0,Val(LRTrim(Substr(riga,871,19))))
len=15
name='_totout
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge i dati dell'intermediario controparte
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P' and not(Empty(LRTrim(Left(riga,8))))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
prev=O1909
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1911
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPFRAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPFRAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xraziobo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=6
prev=O1920
var_op='asgn
I
obj='Insert
pag=6
prev=O1919
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
'IMPIN
'IMPOUT
]
rd_kvar=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'Substr(riga,10,4)
'_intercab
'_iccab
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'Substr(riga,484,16)
'Substr(riga,302,16)
'Substr(riga,190,16)
'Substr(riga,206,16)
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_iccit
'_intercit
'_icrag
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'cOpeProg1
'cIdCau
''F'+Right(cOpeProg2,9)+_idb2
'Substr(riga,424,30)
'Substr(riga,813,15)
'Substr(riga,414,5)
'Substr(riga,662,50)
'cOpeProg2
'Substr(riga,328,3)
''1'
'iif(Empty(Substr(riga,828,14)) or Substr(riga,828,14)='01010001000000',NullDateTime(),CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6)))
'_icsta
'Substr(riga,812,1)
'nProgImp
'_icprv
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
''0'
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'_colleg
'_idb2
'_totin / 100
'_totout / 100
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1920
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=6
prev=O1929
I
obj='Var
obj_type='N
pag=6
prev=O1928
var_op='asgn
I
obj='Exec
pag=6
prev=O1927
I
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O1918
var_op='asgn
I
obj='Var
pag=6
prev=O1917
var_op='asgn
I
obj='Var
pag=6
prev=O1916
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1911
fatherSonIndex=1
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,331,9))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))) or (Empty(LRTrim(_numprog)) and not(Empty(LRTrim(Left(riga,8)))))
]
h=[
19
19
]
obj='If
pag=6
prev=O1937
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1940
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,155,1)='S' or Substr(riga,155,1)='1' or Substr(riga,155,1)='7'
'Substr(riga,155,1)='E' or Substr(riga,155,1)='3' or Substr(riga,155,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPInsert
arch='fraziobo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_oldidb)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=6
prev=O1956
var_op='asgn
I
obj='If
pag=6
prev=O1954
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPSelect
father=O1956
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='sogopefbo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='clientifrz
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='beneficfrz
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='terzistifrz
obj='Delete
pag=6
prev=O1971
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=6
prev=O1970
sel_field='*
sel_name='terzistifrz
sel_where='terzistifrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistifrz
father=O1971
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'cOpeProg1
'terzistifrz->CODSOG
'terzistifrz->TIPOFILE
'terzistifrz->NUMCOL
'terzistifrz->LEGAME
'terzistifrz->RAPCOL
'terzistifrz->UCODE
'terzistifrz->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=6
prev=O1968
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=6
prev=O1967
sel_field='*
sel_name='beneficfrz
sel_where='beneficfrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficfrz
father=O1968
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
]
rd_kvar=[
'cOpeProg1
'beneficfrz->CPROWNUM
'beneficfrz->CODSOG
'beneficfrz->TIPOFILE
'beneficfrz->NUMCOL
'beneficfrz->LEGAME
'beneficfrz->RAPCOL
'beneficfrz->UCODE
'beneficfrz->IDBASE
'beneficfrz->C_RAG
'beneficfrz->C_STA
'beneficfrz->C_CTA
'beneficfrz->C_CAB
'beneficfrz->C_PRV
'beneficfrz->C_IND
'beneficfrz->C_CAP
'beneficfrz->C_RAPPORTO
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=6
prev=O1965
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=6
prev=O1964
sel_field='*
sel_name='clientifrz
sel_where='clientifrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientifrz
father=O1965
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'clientifrz->CODSOG
'clientifrz->LEGAME
'clientifrz->IDBASE
'clientifrz->NUMCOL
'clientifrz->TIPOFILE
'clientifrz->RAPCOL
'clientifrz->UCODE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=6
prev=O1962
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=6
sel_field='*
sel_name='sogopefbo
sel_where='sogopefbo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sogopefbo
father=O1962
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'sogopefbo->CPROWNUM
'sogopefbo->CODSOG
'sogopefbo->LEGAME
'sogopefbo->IDBASE
'sogopefbo->NUMCOL
'sogopefbo->TIPOFILE
'sogopefbo->RAPCOL
'sogopefbo->UCODE
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=6
prev=O1951
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
'IMPIN
'IMPOUT
]
rd_kvar=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'Substr(riga,10,4)
'_intercab
'_iccab
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'Substr(riga,484,16)
'Substr(riga,302,16)
'Substr(riga,190,16)
'Substr(riga,206,16)
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_datarett
'_iccit
'_intercit
'_icrag
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'_flagrap2
'cOpeProg1
'cIdCau
'"F"+Right(cOpeProg2,9)+_idb2
'Substr(riga,424,30)
'Substr(riga,813,15)
'Substr(riga,414,5)
'Substr(riga,662,50)
'cOpeProg2
'Substr(riga,328,3)
'_idreg
''1'
'iif(Empty(Substr(riga,828,14)) or Substr(riga,828,14)='01010001000000',NullDateTime(),CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6)))
'_icsta
'Substr(riga,812,1)
'nProgImp
'_icprv
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
'_statoreg
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'_colleg
'_idb2
'_totin / 100
'_totout / 100
]
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1954
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=6
prev=O2017
I
obj='Var
obj_type='N
pag=6
prev=O2016
var_op='asgn
I
obj='Exec
pag=6
prev=O2015
I
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Case
pag=6
prev=O1950
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1951
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1951
fatherSonIndex=1
frm_calc=[
'Substr(riga,155,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2024
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2024
fatherSonIndex=1
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1951
fatherSonIndex=2
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=6
prev=O1949
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O1948
var_op='asgn
I
obj='Var
pag=6
prev=O1945
var_op='asgn
I
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1945
fatherSonIndex=0
frm_calc='_numprog
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''1'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
obj='Var
obj_type='D
pag=6
prev=O2039
var_op='asgn
I
obj='Var
pag=6
prev=O2038
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1945
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PFRAZIO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''0'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datarett
obj='Var
obj_type='D
pag=6
prev=O2043
var_op='asgn
I
obj='Var
pag=6
prev=O2042
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O1934
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1937
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Left(riga,8)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2049
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=6
prev=O2054
sel_field='fraziobo->IDBASE
sel_name='fraziobo
sel_where='fraziobo->NUMPROG=_numprog and (fraziobo->STATOREG='0'  or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O2055
fatherSonIndex=0
frm_calc='"E' stata cancellata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=6
prev=O2059
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'fraziobo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
]
wr_var=[
''2'
'Date()
]
I
nonlocal=True
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
father=O2049
fatherSonIndex=1
frm_calc=''JLMNOTUV?'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"E' stata variata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=6
prev=O2070
sel_field='fraziobo->IDBASE,fraziobo->NUMPROG,fraziobo->DATAOPE,fraziobo->FLAGRAP2
sel_name='fraziobo
sel_where='fraziobo->NUMPROG=_numprog and (fraziobo->STATOREG='0'  or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2071
fatherSonIndex=0
frm_calc='fraziobo->IDBASE
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(fraziobo->FLAGRAP2) or fraziobo->FLAGRAP2='Z',Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(fraziobo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='fraziobo->IDEREG
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='fraziobo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=6
prev=O2083
sel_field='*
sel_name='terzistifrz
sel_where='terzistifrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='merzistifrz
father=O2085
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'IDREG
]
rd_kvar=[
'_oldidb
'terzistifrz->CODSOG
'terzistifrz->TIPOFILE
'terzistifrz->NUMCOL
'terzistifrz->LEGAME
'terzistifrz->RAPCOL
'terzistifrz->UCODE
'terzistifrz->IDBASE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=6
prev=O2081
sel_field='*
sel_name='beneficfrz
sel_where='beneficfrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='meneficfrz
father=O2083
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
'IDREG
]
rd_kvar=[
'_oldidb
'beneficfrz->CPROWNUM
'beneficfrz->CODSOG
'beneficfrz->TIPOFILE
'beneficfrz->NUMCOL
'beneficfrz->LEGAME
'beneficfrz->RAPCOL
'beneficfrz->UCODE
'beneficfrz->IDBASE
'beneficfrz->C_RAG
'beneficfrz->C_STA
'beneficfrz->C_CTA
'beneficfrz->C_CAB
'beneficfrz->C_PRV
'beneficfrz->C_IND
'beneficfrz->C_CAP
'beneficfrz->C_RAPPORTO
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=6
prev=O2079
sel_field='*
sel_name='clientifrz
sel_where='clientifrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mlientifrz
father=O2081
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'clientifrz->CODSOG
'clientifrz->LEGAME
'clientifrz->IDBASE
'clientifrz->NUMCOL
'clientifrz->TIPOFILE
'clientifrz->RAPCOL
'clientifrz->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=6
prev=O2078
sel_field='*
sel_name='sogopefbo
sel_where='sogopefbo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mogopefbo
father=O2079
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'sogopefbo->CPROWNUM
'sogopefbo->CODSOG
'sogopefbo->LEGAME
'sogopefbo->IDBASE
'sogopefbo->NUMCOL
'sogopefbo->TIPOFILE
'sogopefbo->RAPCOL
'sogopefbo->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=6
prev=O2077
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'fraziobo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
'FLAGRAP2
]
wr_op=[
'=
'=
'=
]
wr_var=[
''3'
'Date()
'_flagrap2
]
I
obj='Var
pag=6
prev=O2076
var_op='asgn
I
obj='Var
pag=6
prev=O2075
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=6
prev=O2069
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O1933
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1934
fatherSonIndex=0
frm_calc=[
'Upper(Substr(riga,331,9))='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2122
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=6
sel_field='fraziobo->NUMPROG
sel_name='fraziobo
sel_where='fraziobo->INFORM = Substr(riga,424,30) and (fraziobo->STATOREG='0' or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2127
fatherSonIndex=0
frm_calc='fraziobo->NUMPROG
len=11
name='_numprog
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2122
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=6
sel_field='fraziobo->NUMPROG
sel_name='fraziobo
sel_where='fraziobo->RIFIMP = Substr(riga,331,9) and (fraziobo->STATOREG='0' or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2134
fatherSonIndex=0
frm_calc='fraziobo->NUMPROG
len=11
name='_numprog
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=6
prev=O1907
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1909
fatherSonIndex=0
frm_calc='''
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=70
name='_icrag
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,18,11)))) and Len(LRTrim(Substr(riga,64,6)+Substr(riga,70,50)+Substr(riga,29,3)+Substr(riga,62,2)+Substr(riga,32,30))) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
prev=O2149
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O2150
fatherSonIndex=0
obj='Read
pag=6
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'Substr(riga,18,11)
]
rd_var=[
'_iccab
'_iccit
'_icprv
'_icsta
'_icrag
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2150
fatherSonIndex=1
frm_calc='Substr(riga,64,6)
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,32,30)
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,62,2)
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,29,3))
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,70,50)
len=70
name='_icrag
obj='Var
pag=6
prev=O2164
var_op='asgn
I
obj='Var
pag=6
prev=O2163
var_op='asgn
I
obj='Var
pag=6
prev=O2162
var_op='asgn
I
obj='Var
pag=6
prev=O2161
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=6
prev=O2148
var_op='asgn
I
obj='Var
pag=6
prev=O2147
var_op='asgn
I
obj='Var
pag=6
prev=O2146
var_op='asgn
I
obj='Var
pag=6
prev=O2145
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
prev=O1906
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1907
fatherSonIndex=0
frm_calc='Upper(Substr(riga,511,70))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,581,3))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,584,30))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,614,6)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,620,2))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,622,35))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,657,5))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,302,16))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=6
prev=O2180
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2183
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,120,25))))
]
h=[
19
19
]
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2188
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=6
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2193
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=6
prev=O2204
I
obj='Read
pag=6
prev=O2203
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=6
prev=O2202
var_op='asgn
I
obj='Var
pag=6
prev=O2201
var_op='asgn
I
obj='Var
pag=6
prev=O2200
var_op='asgn
I
obj='Var
pag=6
prev=O2199
var_op='asgn
I
obj='Var
pag=6
prev=O2198
var_op='asgn
I
obj='Var
pag=6
prev=O2197
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O2177
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2180
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=6
prev=O2221
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,302,16)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=6
prev=O2220
var_op='asgn
I
obj='Var
pag=6
prev=O2219
var_op='asgn
I
obj='Var
pag=6
prev=O2218
var_op='asgn
I
obj='Var
pag=6
prev=O2217
var_op='asgn
I
obj='Var
pag=6
prev=O2216
var_op='asgn
I
obj='Var
pag=6
prev=O2215
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O2176
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O2177
fatherSonIndex=0
obj='Read
pag=6
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O2175
var_op='asgn
I
obj='Var
pag=6
prev=O2174
var_op='asgn
I
obj='Var
pag=6
prev=O2173
var_op='asgn
I
obj='Var
pag=6
prev=O2172
var_op='asgn
I
obj='Var
pag=6
prev=O2171
var_op='asgn
I
obj='Var
pag=6
prev=O2170
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O1905
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O1904
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O1903
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O1901
var_op='asgn
I
obj='Select
pag=6
par_expr=[
'Substr(riga,10,4)
'Substr(riga,14,2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O1900
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1901
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O1899
var_op='asgn
I
obj='Var
pag=6
prev=O1898
var_op='asgn
I
obj='Var
pag=6
prev=O1897
var_op='asgn
I
obj='Var
pag=6
prev=O1896
var_op='asgn
I
obj='Var
pag=6
prev=O1895
var_op='asgn
I
obj='Var
obj_type='D
pag=6
prev=O1894
var_op='asgn
I
obj='Var
pag=6
prev=O1893
var_op='asgn
I
obj='Var
pag=6
prev=O1892
var_op='asgn
I
obj='Var
pag=6
prev=O1889
var_op='asgn
I
obj='If
pag=6
prev=O1888
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='fraziobo
father=O1889
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=6
prev=O2245
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2246
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=6
prev=O2252
I
obj='Var
obj_type='N
pag=6
prev=O2251
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,318,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O1887
var_op='asgn
I
obj='Remark
pag=6
prev=O1884
I
obj='If
pag=6
prev=O1882
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1884
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,263,30))+LRTrim(Substr(riga,295,6))+LRTrim(Substr(riga,293,2))))
]
h=[
19
19
]
obj='If
pag=6
prev=O2264
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2267
fatherSonIndex=0
frm_calc='LRTrim(Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=6
prev=O2273
var_op='asgn
I
obj='Var
pag=6
prev=O2272
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O2263
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2264
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(Substr(riga,257,6))+" non è prensente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=6
prev=O2279
I
obj='Var
obj_type='N
pag=6
prev=O2278
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O2262
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'Substr(riga,257,6)
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=6
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1882
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,246,11))),_codinter,Substr(riga,246,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,263,30))),_citinter,Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,295,6))),_cabinter,Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,293,2))),_prvinter,Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=6
prev=O2291
var_op='asgn
I
obj='Var
pag=6
prev=O2290
var_op='asgn
I
obj='Var
pag=6
prev=O2289
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1877
fatherSonIndex=1
frm_calc='1
len=1
name='_frzerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(zhand,riga+" - "+_descerr)
obj='Exec
pag=6
prev=O2295
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1875
fatherSonIndex=0
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,190,16))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,206,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,484,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,190,16))) and Empty(LRTrim(Substr(riga,120,25))) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=6
prev=O2311
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2314
fatherSonIndex=0
frm_calc=''Rapporto continuativo Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O2319
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O2308
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2311
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=6
prev=O2325
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2326
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto per conto del quale assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O2331
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O2324
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,484,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O2305
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2308
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=6
prev=O2342
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2343
fatherSonIndex=0
frm_calc=''Anagrafica Controparte Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O2348
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O2341
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,302,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O2302
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2305
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=6
prev=O2359
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2360
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto Operante Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O2365
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O2358
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,206,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O2301
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2302
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=6
prev=O2376
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2377
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O2382
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O2375
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,190,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O2300
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O1858
var_op='asgn
I
obj='Var
pag=6
prev=O1857
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O1856
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O1855
var_op='asgn
I
obj='Var
pag=6
pagelocal=True
prev=O1854
I
obj='Remark
pag=6
x=15
y=15
I
Icpitembatch.CPRead
arch='tbcauana
obj='Read
pag=6
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,10,4)
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
x=696
y=2867
I
Icpitembatch.CPRead
arch='tbcauana
obj='Read
pag=9
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,10,4)
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
x=703
y=1319
I
Icpitembatch.CPRead
arch='tbcauana
obj='Read
pag=10
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,10,4)
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
x=628
y=1370
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Rapporti AGE Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Rapporti AGE Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=11
prev=O2419
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=11
prev=O2418
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=11
prev=O2417
var_op='asgn
I
obj='Exec
pag=11
prev=O2416
I
obj='Exec
pag=11
prev=O2414
I
obj='While
pag=11
prev=O2413
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2414
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='cFlagLire
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,77,1)='S' or Substr(riga,77,1)='1' or Substr(riga,77,1)='7'
'Substr(riga,77,1)='E' or Substr(riga,77,1)='3' or Substr(riga,77,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='xRapporto
next=Icpitembatch.CPRead
arch='jnarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xRapporto))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=11
prev=O2429
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O2430
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPRAPAGE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='jnarapbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,83,1)<>'1'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=11
prev=O2438
var_op='asgn
I
obj='If
pag=11
prev=O2436
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2438
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PROGAET\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aetesta
h=[
19
19
]
obj='Insert
pag=11
prev=O2444
rd_kfield=[
'RAPPORTO
'TIPOAG
'COINT
'DESCRI
'VALUTA
'PROGAET
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,81,2)
'iif(Substr(riga,76,1)='1','1','2')
'iif(Substr(riga,81,2)='99',Upper(Substr(riga,26,24)),'')
'Substr(riga,78,3)
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2445
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=11
prev=O2453
I
obj='Var
obj_type='N
pag=11
prev=O2452
var_op='asgn
I
obj='Exec
pag=11
prev=O2451
I
nonlocal=True
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=11
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=11
prev=O2435
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
'PRGIMPRAP
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,94,5)),3))
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2436
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=11
prev=O2463
I
obj='Var
obj_type='N
pag=11
prev=O2462
var_op='asgn
I
obj='Exec
pag=11
prev=O2461
I
nonlocal=True
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='jnarapbo
father=O2430
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,83,1)<>'1'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=11
prev=O2469
var_op='asgn
I
obj='If
pag=11
prev=O2467
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aetesta
father=O2469
fatherSonIndex=0
obj='Write
pag=11
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'TIPOAG
'COINT
'DESCRI
'VALUTA
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,81,2)
'iif(Substr(riga,76,1)='1','1','2')
'iif(Substr(riga,81,2)='99',Upper(Substr(riga,26,24)),'')
'Substr(riga,78,3)
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=11
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2467
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=11
prev=O2490
I
obj='Var
obj_type='N
pag=11
prev=O2489
var_op='asgn
I
obj='Exec
pag=11
prev=O2488
I
nonlocal=True
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,94,5)),3))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=11
prev=O2428
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Left(riga,25)
]
rd_var=[
'xRapporto
]
I
obj='Var
pag=11
prev=O2425
var_op='asgn
I
obj='Case
pag=11
prev=O2424
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2425
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2425
fatherSonIndex=1
frm_calc=[
'Substr(riga,77,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=11
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2505
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2505
fatherSonIndex=1
frm_calc='Substr(riga,77,1)
len=1
name='cFlagLire
obj='Var
pag=11
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2425
fatherSonIndex=2
frm_calc='Substr(riga,77,1)
len=1
name='cFlagLire
obj='Var
pag=11
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=11
prev=O2423
var_op='asgn
I
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=11
prev=O2412
var_op='asgn
I
obj='Var
pag=11
prev=O2411
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=11
prev=O2410
var_op='asgn
I
obj='Var
obj_type='N
pag=11
prev=O2409
var_op='asgn
I
obj='Var
obj_type='N
pag=11
prev=O2408
var_op='asgn
I
obj='Remark
pag=11
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Informazione Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O2528
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O2527
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O2526
var_op='asgn
I
obj='Exec
pag=12
prev=O2525
I
obj='Exec
pag=12
prev=O2523
I
obj='While
pag=12
prev=O2522
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2523
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPBeginEnd
comment='Dati intermediario
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,75,16)
len=16
name='xConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,50,16)
len=16
name='xSOCTCon
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xSOCTCon)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' informazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,46,1)='S' or Substr(riga,46,1)='1' or Substr(riga,46,1)='7'
'Substr(riga,46,1)='E' or Substr(riga,46,1)='3' or Substr(riga,46,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPRemark
frm_calc="Da sentire Bruno sembra che l'importazione dei soggetti operanti in agenzia delle entrate non sia più attiva.
Ma sul tracciato c'è ancora.
°--°
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,36,8))) or _flgdataim=1,Date(),CharToDate(Right(Substr(riga,36,8),4)+Substr(Substr(riga,36,8),3,2)+Left(Substr(riga,36,8),2)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,159,10)),Utilities.GetAutonumber("PRGINFAGE1\'"+LRTrim(gAzienda)+"'",'',10),Substr(riga,159,10))
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFAGE2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINFAGE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='japopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=12
prev=O2560
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2562
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOGAGE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='jntestbo
h=[
19
19
]
obj='Insert
pag=12
prev=O2567
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2568
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=12
prev=O2576
I
obj='Var
obj_type='N
pag=12
prev=O2575
var_op='asgn
I
obj='Exec
pag=12
prev=O2574
I
nonlocal=True
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2562
fatherSonIndex=1
frm_calc=[
'Substr(riga,44,2)='23'
'Substr(riga,44,2)='26'
]
h=[
19
19
19
]
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='jntestbo
father=O2580
fatherSonIndex=0
h=[
19
19
]
obj='Write
pag=12
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cNumMod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2585
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=12
prev=O2594
I
obj='Var
obj_type='N
pag=12
prev=O2593
var_op='asgn
I
obj='Exec
pag=12
prev=O2592
I
nonlocal=True
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'NUMPROG1
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='jntestbo
father=O2580
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=12
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cNumMod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2601
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=12
prev=O2610
I
obj='Var
obj_type='N
pag=12
prev=O2609
var_op='asgn
I
obj='Exec
pag=12
prev=O2608
I
nonlocal=True
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=12
prev=O2559
sel_field='*
sel_name='jntestbo
sel_order='jntestbo->CPROWNUM
sel_where='jntestbo->RAPPORTO=Substr(riga,9,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2560
fatherSonIndex=0
frm_calc=[
'jntestbo->CODINTER=cCli1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=12
prev=O2620
var_op='asgn
I
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2620
fatherSonIndex=0
frm_calc='jntestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
prev=O2558
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O2557
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O2555
var_op='asgn
I
obj='Insert
pag=12
prev=O2554
rd_kfield=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'VALUTA
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'_intercab
'Substr(riga,115,6)
'_intercod
'xSOCTCF
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_intercit
'Substr(riga,169,50)
'cFlagLire
'Substr(riga,34,1)
'cInfProg1
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)+"J"+LibreriaMit.UniqueId()+"X"
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,47,3)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2555
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=12
prev=O2635
I
obj='Var
obj_type='N
pag=12
prev=O2634
var_op='asgn
I
obj='Exec
pag=12
prev=O2633
I
nonlocal=True
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
prev=O2553
var_op='asgn
I
obj='Var
pag=12
prev=O2552
var_op='asgn
I
obj='Var
pag=12
prev=O2551
var_op='asgn
I
obj='Var
obj_type='D
pag=12
prev=O2550
var_op='asgn
I
obj='Remark
pag=12
prev=O2547
I
obj='Case
pag=12
prev=O2546
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2547
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O2547
fatherSonIndex=1
frm_calc=[
'Substr(riga,46,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2642
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2642
fatherSonIndex=1
frm_calc='Substr(riga,46,1)
len=1
name='cFlagLire
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2547
fatherSonIndex=2
frm_calc='Substr(riga,46,1)
len=1
name='cFlagLire
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O2545
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O2542
var_op='asgn
I
obj='If
pag=12
prev=O2541
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O2542
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=12
prev=O2656
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O2657
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=12
prev=O2662
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2663
fatherSonIndex=0
frm_calc='xSOCTCon
len=16
name='xSOCTCF
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=12
prev=O2540
var_op='asgn
I
obj='Var
pag=12
prev=O2537
var_op='asgn
I
obj='If
pag=12
prev=O2536
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O2537
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
obj='If
pag=12
prev=O2682
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2683
fatherSonIndex=0
frm_calc='xConnes
len=16
name='cCli1
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
prev=O2535
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
obj='Var
pag=12
prev=O2533
var_op='asgn
I
obj='Begin
pag=12
prev=O2532
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2533
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,104,11))),_codinter,Substr(riga,104,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,121,30))),_citinter,Substr(riga,121,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,153,6))),_cabinter,Substr(riga,153,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,151,2))),_prvinter,Substr(riga,151,2))
len=2
name='_interprv
obj='Var
pag=12
prev=O2703
var_op='asgn
I
obj='Var
pag=12
prev=O2702
var_op='asgn
I
obj='Var
pag=12
prev=O2701
var_op='asgn
I
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
prev=O2521
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O2520
var_op='asgn
I
obj='Var
pag=12
prev=O2519
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O2518
var_op='asgn
I
obj='Remark
pag=12
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni AGE Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O2718
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O2717
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O2716
var_op='asgn
I
obj='Exec
pag=13
prev=O2715
I
obj='Exec
pag=13
prev=O2713
I
obj='While
pag=13
prev=O2712
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2713
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=13
prev=O2722
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
father=O2723
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
prev=O2728
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O2730
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,257,6))))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,318,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc='_flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,331,9))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))) or (Empty(LRTrim(_numprog)) and not(Empty(LRTrim(Left(riga,8)))))
]
h=[
19
19
]
obj='If
pag=13
prev=O2752
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2755
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,318,10)),Utilities.GetAutonumber("POPERAGE1\'"+LRTrim(gAzienda)+"'",'',10),Substr(riga,318,10))
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,155,1)='S' or Substr(riga,155,1)='1' or Substr(riga,155,1)='7'
'Substr(riga,155,1)='E' or Substr(riga,155,1)='3' or Substr(riga,155,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,147,8))) or _flgdataim=1,Date(),CharToDate(Right(Substr(riga,147,8),4)+Substr(Substr(riga,147,8),3,2)+Left(Substr(riga,147,8),2)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,9,1)='1' or Substr(riga,9,1)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,301,1)),'0',iif(Substr(riga,301,1)='S','1',iif(Substr(riga,301,1)='N','1',Substr(riga,301,1))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,231,11))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPEAGE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,852,19))),0,Val(LRTrim(Substr(riga,852,19))))
len=15
name='_totin
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,871,19))),0,Val(LRTrim(Substr(riga,871,19))))
len=15
name='_totout
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge i dati dell'intermediario controparte
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='jperazbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=13
prev=O2785
var_op='asgn
I
obj='Insert
pag=13
prev=O2783
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
'IMPIN
'IMPOUT
]
rd_kvar=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'Substr(riga,10,4)
'_intercab
'_iccab
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'Substr(riga,484,16)
'Substr(riga,302,16)
'Substr(riga,190,16)
'Substr(riga,206,16)
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_datarett
'_iccit
'_intercit
'_icrag
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'_flagrap2
'cOpeProg1
'cIdCau
'"O"+Right(cOpeProg2,9)+_idb2
'Substr(riga,424,30)
'Substr(riga,813,15)
'Substr(riga,414,5)
'Substr(riga,662,50)
'cOpeProg2
'Substr(riga,328,3)
'_idreg
''1'
'iif(Empty(Substr(riga,828,14)) or Substr(riga,828,14)='01010001000000',NullDateTime(),CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6)))
'_icsta
'Substr(riga,812,1)
'nProgImp
'_icprv
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
'_statoreg
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'_colleg
'_idb2
'_totin / 100
'_totout / 100
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2785
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=13
prev=O2794
I
obj='Var
obj_type='N
pag=13
prev=O2793
var_op='asgn
I
obj='Exec
pag=13
prev=O2792
I
nonlocal=True
obj='Var
obj_type='M
pag=13
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Begin
pag=13
prev=O2781
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2783
fatherSonIndex=0
frm_calc='''
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=70
name='_icrag
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,18,11)))) and Len(LRTrim(Substr(riga,64,6)+Substr(riga,70,50)+Substr(riga,29,3)+Substr(riga,62,2)+Substr(riga,32,30))) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
prev=O2803
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O2804
fatherSonIndex=0
obj='Read
pag=13
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'Substr(riga,18,11)
]
rd_var=[
'_iccab
'_iccit
'_icprv
'_icsta
'_icrag
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2804
fatherSonIndex=1
frm_calc='Substr(riga,64,6)
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,32,30)
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,62,2)
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,29,3))
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,70,50)
len=70
name='_icrag
obj='Var
pag=13
prev=O2818
var_op='asgn
I
obj='Var
pag=13
prev=O2817
var_op='asgn
I
obj='Var
pag=13
prev=O2816
var_op='asgn
I
obj='Var
pag=13
prev=O2815
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=13
prev=O2802
var_op='asgn
I
obj='Var
pag=13
prev=O2801
var_op='asgn
I
obj='Var
pag=13
prev=O2800
var_op='asgn
I
obj='Var
pag=13
prev=O2799
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=13
prev=O2780
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2781
fatherSonIndex=0
frm_calc='Upper(Substr(riga,511,70))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,581,3))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,584,30))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,614,6)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,620,2))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,622,35))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,657,5))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,302,16))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=13
prev=O2834
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2837
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,120,25))))
]
h=[
19
19
]
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2842
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=13
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2847
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=13
prev=O2858
I
obj='Read
pag=13
prev=O2857
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=13
prev=O2856
var_op='asgn
I
obj='Var
pag=13
prev=O2855
var_op='asgn
I
obj='Var
pag=13
prev=O2854
var_op='asgn
I
obj='Var
pag=13
prev=O2853
var_op='asgn
I
obj='Var
pag=13
prev=O2852
var_op='asgn
I
obj='Var
pag=13
prev=O2851
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O2831
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2834
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=13
prev=O2875
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,302,16)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=13
prev=O2874
var_op='asgn
I
obj='Var
pag=13
prev=O2873
var_op='asgn
I
obj='Var
pag=13
prev=O2872
var_op='asgn
I
obj='Var
pag=13
prev=O2871
var_op='asgn
I
obj='Var
pag=13
prev=O2870
var_op='asgn
I
obj='Var
pag=13
prev=O2869
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O2830
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O2831
fatherSonIndex=0
obj='Read
pag=13
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
prev=O2829
var_op='asgn
I
obj='Var
pag=13
prev=O2828
var_op='asgn
I
obj='Var
pag=13
prev=O2827
var_op='asgn
I
obj='Var
pag=13
prev=O2826
var_op='asgn
I
obj='Var
pag=13
prev=O2825
var_op='asgn
I
obj='Var
pag=13
prev=O2824
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=13
prev=O2779
var_op='asgn
I
obj='Var
obj_type='N
pag=13
prev=O2778
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O2777
var_op='asgn
I
obj='Var
obj_type='N
pag=13
prev=O2776
var_op='asgn
I
obj='Var
obj_type='N
pag=13
prev=O2774
var_op='asgn
I
obj='Select
pag=13
par_expr=[
'Substr(riga,10,4)
'Substr(riga,14,2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O2773
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2774
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
prev=O2772
var_op='asgn
I
obj='Var
pag=13
prev=O2771
var_op='asgn
I
obj='Var
pag=13
prev=O2770
var_op='asgn
I
obj='Var
pag=13
prev=O2769
var_op='asgn
I
obj='Var
pag=13
prev=O2768
var_op='asgn
I
obj='Var
obj_type='D
pag=13
prev=O2765
var_op='asgn
I
obj='Case
pag=13
prev=O2764
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2765
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2765
fatherSonIndex=1
frm_calc=[
'Substr(riga,155,1) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2901
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2901
fatherSonIndex=1
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2765
fatherSonIndex=2
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=13
prev=O2763
var_op='asgn
I
obj='Var
pag=13
prev=O2760
var_op='asgn
I
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2760
fatherSonIndex=0
frm_calc='_numprog
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''1'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
obj='Var
obj_type='D
pag=13
prev=O2916
var_op='asgn
I
obj='Var
pag=13
prev=O2915
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2760
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("POPERAGE2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''0'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datarett
obj='Var
obj_type='D
pag=13
prev=O2920
var_op='asgn
I
obj='Var
pag=13
prev=O2919
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O2749
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2752
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Left(riga,8)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2926
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=13
prev=O2931
sel_field='jperazbo->IDBASE
sel_name='jperazbo
sel_where='jperazbo->NUMPROG=_numprog and (jperazbo->STATOREG='0'  or jperazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O2932
fatherSonIndex=0
frm_calc='"E' stata cancellata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='jperazbo
obj='Write
pag=13
prev=O2936
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'jperazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
]
wr_var=[
''2'
'Date()
]
I
nonlocal=True
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
father=O2926
fatherSonIndex=1
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"E' stata variata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=13
prev=O2947
sel_field='jperazbo->IDBASE,jperazbo->NUMPROG,jperazbo->DATAOPE,jperazbo->FLAGRAP2
sel_name='jperazbo
sel_where='jperazbo->NUMPROG=_numprog and (jperazbo->STATOREG='0'  or jperazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2948
fatherSonIndex=0
frm_calc='jperazbo->IDBASE
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(jperazbo->FLAGRAP2) or jperazbo->FLAGRAP2='S',Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(jperazbo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='jperazbo->IDEREG
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='jperazbo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=13
prev=O2960
sel_field='*
sel_name='terzistiope
sel_where='terzistiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='merzistiope
father=O2962
fatherSonIndex=0
obj='Insert
pag=13
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'IDREG
]
rd_kvar=[
'_oldidb
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=13
prev=O2958
sel_field='*
sel_name='beneficope
sel_where='beneficope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='meneficope
father=O2960
fatherSonIndex=0
obj='Insert
pag=13
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
'IDREG
]
rd_kvar=[
'_oldidb
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=13
prev=O2956
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mlientiope
father=O2958
fatherSonIndex=0
obj='Insert
pag=13
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=13
prev=O2955
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mogopebo
father=O2956
fatherSonIndex=0
obj='Insert
pag=13
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=13
prev=O2954
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'jperazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
'FLAGRAP2
]
wr_op=[
'=
'=
'=
]
wr_var=[
''3'
'Date()
'_flagrap2
]
I
obj='Var
pag=13
prev=O2953
var_op='asgn
I
obj='Var
pag=13
prev=O2952
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=13
prev=O2946
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O2748
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2749
fatherSonIndex=0
frm_calc=[
'Upper(Substr(riga,331,9))='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2999
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=13
sel_field='jperazbo->NUMPROG
sel_name='jperazbo
sel_where='jperazbo->INFORM = Substr(riga,424,30) and (jperazbo->STATOREG='0' or jperazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3004
fatherSonIndex=0
frm_calc='jperazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2999
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=13
sel_field='jperazbo->NUMPROG
sel_name='jperazbo
sel_where='jperazbo->RIFIMP = Substr(riga,331,9) and (jperazbo->STATOREG='0' or jperazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3011
fatherSonIndex=0
frm_calc='jperazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
prev=O2747
var_op='asgn
I
obj='Var
pag=13
prev=O2746
var_op='asgn
I
obj='Var
pag=13
prev=O2745
var_op='asgn
I
obj='Var
pag=13
prev=O2742
var_op='asgn
I
obj='If
pag=13
prev=O2741
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O2742
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=13
prev=O3021
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3022
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=13
prev=O3028
I
obj='Var
obj_type='N
pag=13
prev=O3027
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,318,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
prev=O2740
var_op='asgn
I
obj='Remark
pag=13
prev=O2737
I
obj='If
pag=13
prev=O2735
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2737
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,263,30))+LRTrim(Substr(riga,295,6))+LRTrim(Substr(riga,293,2))))
]
h=[
19
19
]
obj='If
pag=13
prev=O3040
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3043
fatherSonIndex=0
frm_calc='LRTrim(Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=13
prev=O3049
var_op='asgn
I
obj='Var
pag=13
prev=O3048
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O3039
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3040
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(Substr(riga,257,6))+" non è prensente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=13
prev=O3055
I
obj='Var
obj_type='N
pag=13
prev=O3054
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
prev=O3038
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'Substr(riga,257,6)
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=13
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2735
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,246,11))),_codinter,Substr(riga,246,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,263,30))),_citinter,Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,295,6))),_cabinter,Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,293,2))),_prvinter,Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=13
prev=O3067
var_op='asgn
I
obj='Var
pag=13
prev=O3066
var_op='asgn
I
obj='Var
pag=13
prev=O3065
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2730
fatherSonIndex=1
frm_calc='1
len=1
name='_opeerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(ohand,riga+" - "+_descerr)
obj='Exec
pag=13
prev=O3071
I
obj='Var
obj_type='N
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=13
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2728
fatherSonIndex=0
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,190,16))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,206,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,484,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,190,16))) and Empty(LRTrim(Substr(riga,120,25))) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=13
prev=O3087
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3090
fatherSonIndex=0
frm_calc=''Rapporto continuativo o Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=13
prev=O3095
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O3084
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3087
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=13
prev=O3101
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3102
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto per conto del quale assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=13
prev=O3107
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
prev=O3100
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,484,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O3081
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3084
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=13
prev=O3118
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3119
fatherSonIndex=0
frm_calc=''Anagrafica Controparte Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=13
prev=O3124
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
prev=O3117
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,302,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O3078
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3081
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=13
prev=O3135
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3136
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto Operante Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=13
prev=O3141
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
prev=O3134
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,206,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O3077
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3078
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=13
prev=O3152
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3153
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=13
prev=O3158
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
prev=O3151
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,190,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=13
prev=O3076
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=13
prev=O2711
var_op='asgn
I
obj='Var
pag=13
prev=O2710
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O2709
var_op='asgn
I
obj='Var
obj_type='N
pag=13
prev=O2708
var_op='asgn
I
obj='Var
pag=13
pagelocal=True
prev=O2707
I
obj='Remark
pag=13
x=15
y=15
I
Icpitembatch.CPRead
arch='tbcauana
obj='Read
pag=13
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,10,4)
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
x=522
y=720
I
Icpitembatch.CPRemark
frm_calc='Import Dipendenze
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumNew <> 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod <> 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=14
prev=O3190
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=14
prev=O3187
var_op='asgn
I
obj='If
pag=14
prev=O3184
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3187
fatherSonIndex=0
frm_calc='gMsgProc + 'Dipendenze Aggiornate: '+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O3183
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3184
fatherSonIndex=0
frm_calc='gMsgProc + 'Dipendenze Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Exec
pag=14
prev=O3182
I
obj='Exec
pag=14
prev=O3180
I
obj='While
pag=14
prev=O3179
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3180
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,6)
len=6
name='xDIP
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,69,6)
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Caricamento dipendenza con codice '+xDIP
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCodCab))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgRet='S'
]
h=[
19
19
]
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDIPx))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
prev=O3213
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPInsert
arch='anadip
father=O3214
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=14
prev=O3219
var_op='asgn
I
obj='Insert
pag=14
rd_kfield=[
'CODDIP
'DESCRIZ
'DESCCIT
'PROVINCIA
'CAB
'AGENTE
'IDBASE
'CAP
'DOMICILIO
]
rd_kvar=[
'xDIP
'Substr(riga,7,30)
'Substr(riga,37,30)
'Substr(riga,67,2)
'xCodCab
'iif(Upper(Substr(riga,85,1))='S','S','N')
'LibreriaMit.UniqueId()
'Substr(riga,86,5)
'Substr(riga,91,40)
]
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='anadip
father=O3214
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=14
prev=O3224
var_op='asgn
I
obj='Write
pag=14
rd_kfield=[
'CODDIP
]
rd_kop=[
'=
]
rd_kvar=[
'xDIP
]
wr_field=[
'DESCRIZ
'DESCCIT
'PROVINCIA
'CAB
'AGENTE
'CAP
'DOMICILIO
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,7,30)
'Substr(riga,37,30)
'Substr(riga,67,2)
'xCodCab
'iif(Upper(Substr(riga,85,1))='S','S','N')
'Substr(riga,86,5)
'Substr(riga,91,40)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=14
prev=O3210
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'xDIP
]
rd_var=[
'xDIPx
]
I
obj='If
pag=14
prev=O3207
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xnadip
father=O3210
fatherSonIndex=0
obj='Insert
pag=14
rd_kfield=[
'IDPROG
'CODDIP
'DESCRIZ
'DESCCIT
'PROVINCIA
'CAB
'AGENTE
]
rd_kvar=[
'conta
'xDIP
'Substr(riga,7,30)
'Substr(riga,37,30)
'Substr(riga,67,2)
'Substr(riga,69,6)
'Substr(riga,85,1)
]
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O3206
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3207
fatherSonIndex=0
frm_calc='Substr(riga,37,30)
len=30
name='xCitta
next=Icpitembatch.CPRead
arch='tbcitta
obj='Read
pag=14
prev=O3245
rd_field=[
'CAB
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'xCitta
]
rd_var=[
'xCodCab
]
I
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=14
prev=O3205
var_op='asgn
I
nonlocal=True
obj='Var
pag=14
prev=O3204
var_op='asgn
I
obj='Var
pag=14
prev=O3203
var_op='asgn
I
obj='Var
pag=14
prev=O3202
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=14
prev=O3178
var_op='asgn
I
obj='Var
pag=14
prev=O3177
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=14
prev=O3176
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O3175
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O3174
var_op='asgn
I
obj='Remark
pag=14
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Titolari Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Titolari Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=15
prev=O3263
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=15
prev=O3262
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=15
prev=O3261
var_op='asgn
I
obj='Exec
pag=15
prev=O3260
I
obj='Exec
pag=15
prev=O3258
I
obj='While
pag=15
prev=O3257
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3258
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPBeginEnd
comment='Dati intermediario
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,159,10)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
prev=O3271
sons=[
Icpitembatch.CPItemSon
comment='Unicode Assente o vuoto
instr=Icpitembatch.CPVarDecl
father=O3274
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,36,8))) or _flgdataim=1,Date(),CharToDate(Right(Substr(riga,36,8),4)+Substr(Substr(riga,36,8),3,2)+Left(Substr(riga,36,8),2)))
len=8
name='_datareg
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
prev=O3280
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3281
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGPTIT1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPTIT2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTIT\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xapotit
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=15
prev=O3289
var_op='asgn
I
obj='Insert
pag=15
prev=O3288
rd_kfield=[
'CDATOPE
'CDATREG
'CODCAB
'CODDIPE
'CODINTER
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPTIT
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'IDBASE2
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'_intercab
'Substr(riga,115,6)
'_intercod
'Substr(riga,75,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'cInfProg1
'"T"+Right(cInfProg2,9)+_idb2
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,159,10)
'_idb2
]
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3289
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=15
prev=O3298
I
obj='Var
obj_type='N
pag=15
prev=O3297
var_op='asgn
I
obj='Exec
pag=15
prev=O3296
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=15
prev=O3287
var_op='asgn
I
obj='Var
pag=15
prev=O3286
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3281
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGTITO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGTITO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTIT\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='rapotit
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=15
prev=O3305
var_op='asgn
I
obj='Insert
pag=15
prev=O3304
rd_kfield=[
'CDATOPE
'CDATREG
'CODCAB
'CODDIPE
'CODINTER
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPTIT
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'IDBASE2
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'_intercab
'Substr(riga,115,6)
'_intercod
'Substr(riga,75,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'cInfProg1
'"T"+Right(cInfProg2,9)+_idb2
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,159,10)
'_idb2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3305
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=15
prev=O3314
I
obj='Var
obj_type='N
pag=15
prev=O3313
var_op='asgn
I
obj='Exec
pag=15
prev=O3312
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=15
prev=O3303
var_op='asgn
I
obj='Var
pag=15
prev=O3302
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='D
pag=15
prev=O3279
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='Aggiornamento
instr=Icpitembatch.CPIfElse
father=O3274
fatherSonIndex=1
frm_calc=[
'_tdest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3319
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=15
sel_field='*
sel_name='xapotit
sel_where='xapotit->IDBASE=_unicode and (xapotit->STATOREG='0' or xapotit->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3324
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGPTIT1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPInsert
arch='xapotit
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='xapotit
obj='Write
pag=15
prev=O3329
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_unicode
]
wr_field=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDEREG
'OPRAP
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'CONNESCLI
'DATARETT
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'_intercab
'Substr(riga,115,6)
'_intercod
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'CharToDate(Right(Substr(riga,36,8),4)+Substr(Substr(riga,36,8),3,2)+Left(Substr(riga,36,8),2))
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'xapotit->IDEREG
'Left(Substr(riga,44,2),1)
'_interprv
'Substr(riga,9,25)
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,75,16)
'Date()
]
I
obj='Insert
pag=15
prev=O3328
rd_kfield=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPTIT
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
]
rd_kvar=[
'xapotit->CDATOPE
'xapotit->CODCAB
'xapotit->CODDIPE
'xapotit->CODINTER
'xapotit->CONNESCLI
'xapotit->DATAOPE
'xapotit->DATAREG
'xapotit->DESCCIT
'xapotit->DESCINTER
'xapotit->FLAGRAP
'cInfProg1
'xapotit->IDEREG
'xapotit->NUMPROG
'xapotit->OPRAP
'xapotit->PRGIMPTIT
'xapotit->PROVINCIA
'xapotit->RAPPORTO
''3'
''1'
'xapotit->TIPOINTER
'xapotit->TIPOLEG
'xapotit->TIPOOPRAP
'xapotit->UNIQUECODE
]
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3329
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=15
prev=O3344
I
obj='Var
obj_type='N
pag=15
prev=O3343
var_op='asgn
I
obj='Exec
pag=15
prev=O3342
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3319
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=15
sel_field='*
sel_name='rapotit
sel_where='rapotit->IDBASE=_unicode and (rapotit->STATOREG='0' or rapotit->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3349
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGTITO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPInsert
arch='rapotit
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='rapotit
obj='Write
pag=15
prev=O3354
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_unicode
]
wr_field=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDEREG
'OPRAP
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'CONNESCLI
'DATARETT
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'_intercab
'Substr(riga,115,6)
'_intercod
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'CharToDate(Right(Substr(riga,36,8),4)+Substr(Substr(riga,36,8),3,2)+Left(Substr(riga,36,8),2))
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'rapotit->IDEREG
'Left(Substr(riga,44,2),1)
'_interprv
'Substr(riga,9,25)
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,75,16)
'Date()
]
I
obj='Insert
pag=15
prev=O3353
rd_kfield=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPTIT
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
]
rd_kvar=[
'rapotit->CDATOPE
'rapotit->CODCAB
'rapotit->CODDIPE
'rapotit->CODINTER
'rapotit->CONNESCLI
'rapotit->DATAOPE
'rapotit->DATAREG
'rapotit->DESCCIT
'rapotit->DESCINTER
'rapotit->FLAGRAP
'cInfProg1
'rapotit->IDEREG
'rapotit->NUMPROG
'rapotit->OPRAP
'rapotit->PRGIMPTIT
'rapotit->PROVINCIA
'rapotit->RAPPORTO
''3'
''1'
'rapotit->TIPOINTER
'rapotit->TIPOLEG
'rapotit->TIPOOPRAP
'rapotit->UNIQUECODE
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3354
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=15
prev=O3369
I
obj='Var
obj_type='N
pag=15
prev=O3368
var_op='asgn
I
obj='Exec
pag=15
prev=O3367
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=15
prev=O3270
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3271
fatherSonIndex=0
frm_calc='''
len=1
name='_tdest
next=Icpitembatch.CPRead
arch='xapotit
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_unicode)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
prev=O3378
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='rapotit
father=O3379
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_unicode))
]
h=[
19
19
]
obj='If
pag=15
prev=O3384
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3385
fatherSonIndex=0
frm_calc=''D'
len=1
name='_tdest
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=15
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,159,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3379
fatherSonIndex=1
frm_calc=''P'
len=1
name='_tdest
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=15
prev=O3377
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,159,10)
]
rd_var=[
'_unicode
]
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=15
prev=O3268
var_op='asgn
I
obj='Begin
pag=15
prev=O3267
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3268
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,104,11))),_codinter,Substr(riga,104,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,121,30))),_citinter,Substr(riga,121,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,153,6))),_cabinter,Substr(riga,153,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,151,2))),_prvinter,Substr(riga,151,2))
len=2
name='_interprv
obj='Var
pag=15
prev=O3408
var_op='asgn
I
obj='Var
pag=15
prev=O3407
var_op='asgn
I
obj='Var
pag=15
prev=O3406
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=15
prev=O3256
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=15
prev=O3255
var_op='asgn
I
obj='Var
obj_type='N
pag=15
prev=O3254
var_op='asgn
I
obj='Var
obj_type='N
pag=15
prev=O3253
var_op='asgn
I
obj='Remark
pag=15
x=15
y=15
I
Icpitembatch.CPBeginEnd
comment='Variabili di pagina
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella (Operazioni ExtraConto)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_opxerr
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Inizio Elaborazione File Operazioni Extraconto (OPEX.TXT)"+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni ExtraConto Inserite: '+LRTrim(Str(cNumNew,10,0)) + " - Operazioni ExtraConto Scartate: "+LRTrim(Str(cNumMod,10,0))+' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=16
prev=O3427
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=16
prev=O3426
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=16
prev=O3425
var_op='asgn
I
obj='Exec
pag=16
prev=O3424
I
obj='Exec
pag=16
prev=O3422
I
obj='While
pag=16
prev=O3421
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O3422
fatherSonIndex=0
frm_calc=''Sono state elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=16
prev=O3433
var_op='asgn
I
obj='If
pag=16
prev=O3432
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3433
fatherSonIndex=0
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datx
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,16)
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,25,4)+Substr(riga,23,2)+Substr(riga,21,2)
len=8
name='xData
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,1,16)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=16
prev=O3442
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O3443
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,30,30))))
]
h=[
19
19
]
obj='If
pag=16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='opextrbo
father=O3448
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xIDB)))
]
h=[
19
19
]
obj='If
pag=16
prev=O3453
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3454
fatherSonIndex=0
frm_calc='''
len=25
name='_aprog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='_afile
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='_dprog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='_dfile
next=Icpitembatch.CPRead
arch='aeoprig
next=Icpitembatch.CPRead
arch='aeopcanc
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_afile)+LRTrim(_aprog)) or (not(Empty(LRTrim(_afile)+LRTrim(_aprog))) and not(Empty(LRTrim(_dfile)+LRTrim(_dprog))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=16
prev=O3465
var_op='asgn
I
obj='If
pag=16
prev=O3464
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='opextrbo
father=O3465
fatherSonIndex=0
obj='Delete
pag=16
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'xIDB
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3465
fatherSonIndex=1
frm_calc='gMsgProc +"Impossibile cancellare operazione con riferimento "+LRTrim(Substr(riga,30,30))+" perché già inviata all'agenzia delle entrate"+ NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=16
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=16
prev=O3463
rd_field=[
'APROG
'AFILE
]
rd_kfield=[
'CONNESINT
'ADATA
]
rd_kvar=[
'cCli1
'_datx
]
rd_var=[
'_dprog
'_dfile
]
I
obj='Read
pag=16
prev=O3462
rd_field=[
'APROG
'AFILE
]
rd_kfield=[
'CONNESINT
'ADATA
]
rd_kvar=[
'cCli1
'_datx
]
rd_var=[
'_aprog
'_afile
]
I
obj='Var
pag=16
pagelocal=True
prev=O3461
var_op='asgn
I
obj='Var
pag=16
pagelocal=True
prev=O3460
var_op='asgn
I
obj='Var
pag=16
pagelocal=True
prev=O3459
var_op='asgn
I
obj='Var
pag=16
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=16
rd_field=[
'IDBASE
'COLLEG
'DATAOPE
]
rd_kfield=[
'RIFIMP
]
rd_kvar=[
'Substr(riga,30,30)
]
rd_var=[
'xIDB
'cCli1
'_datx
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3443
fatherSonIndex=1
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=16
prev=O3496
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='opextrbo
father=O3499
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=16
prev=O3504
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O3505
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGOPEX\'"+LRTrim(gAzienda)+"'",0,10)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='opextrbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=16
prev=O3512
var_op='asgn
I
obj='Insert
pag=16
prev=O3511
rd_kfield=[
'COLLEG
'ANNO
'IDBASE
'DATAOPE
'COINT
'RIFIMP
'PROGOPEX
'RAPPORTO
]
rd_kvar=[
'cCli1
'Substr(riga,17,4)
'xIDB
'CharToDate(xData)
'Substr(riga,29,1)
'Substr(riga,30,30)
'nProgImp
'Substr(riga,17,4)+"_"+LRTrim(cCli1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3512
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,1,16)+" per l'operazione extraconto in data: "+Substr(riga,21,8)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=16
prev=O3521
I
obj='Var
obj_type='N
pag=16
prev=O3520
var_op='asgn
I
obj='Exec
pag=16
prev=O3519
I
nonlocal=True
obj='Var
obj_type='M
pag=16
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=16
prev=O3510
var_op='asgn
I
obj='Var
pag=16
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3505
fatherSonIndex=1
frm_calc='gMsgProc +"Esiste già una operazione per il soggetto con codice "+cCli1+ NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=16
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=16
rd_field=[
'IDBASE
]
rd_kfield=[
'COLLEG
'ANNO
]
rd_kvar=[
'cCli1
'Substr(riga,17,4)
]
rd_var=[
'xIDB
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3499
fatherSonIndex=1
frm_calc='1
len=1
name='_opxerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(xhand,riga+" - Intestatario operazione extraconto non esiste")
obj='Exec
pag=16
prev=O3532
I
obj='Var
obj_type='N
pag=16
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=16
prev=O3495
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3496
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=16
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=16
prev=O3494
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,1,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=16
prev=O3493
var_op='asgn
I
obj='Var
obj_type='N
pag=16
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=16
prev=O3441
var_op='asgn
I
obj='Var
pag=16
prev=O3440
var_op='asgn
I
obj='Var
obj_type='D
pag=16
pagelocal=True
prev=O3439
var_op='asgn
I
obj='Var
pag=16
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=16
prev=O3431
var_op='asgn
I
nonlocal=True
obj='Var
pag=16
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=16
prev=O3420
var_op='asgn
I
obj='Var
pag=16
prev=O3419
var_op='asgn
I
obj='Var
obj_type='N
pag=16
prev=O3418
var_op='asgn
I
obj='Var
obj_type='N
pag=16
prev=O3417
var_op='asgn
I
obj='Var
obj_type='N
pag=16
prev=O3416
var_op='asgn
I
obj='Var
obj_type='N
pag=16
prev=O3415
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=16
prev=O3414
var_op='asgn
I
obj='Remark
pag=16
prev=O3412
I
obj='Begin
pag=16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3412
fatherSonIndex=0
len=25
name='_aprog
next=Icpitembatch.CPVarDecl
len=15
name='_afile
next=Icpitembatch.CPVarDecl
len=25
name='_dprog
next=Icpitembatch.CPVarDecl
len=15
name='_dfile
next=Icpitembatch.CPVarDecl
len=8
name='_datx
obj='Var
obj_type='D
pag=16
pagelocal=True
prev=O3551
I
obj='Var
pag=16
pagelocal=True
prev=O3550
I
obj='Var
pag=16
pagelocal=True
prev=O3549
I
obj='Var
pag=16
pagelocal=True
prev=O3548
I
obj='Var
pag=16
pagelocal=True
I
I
]
w=[
150
150
]
x=18
y=18
I
Icpitembatch.CPRemark
frm_calc='Deleghe sui rapporti
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Deleghe Rapporti Inserite: '+LRTrim(Str(cNumNew,10,0)) + " - Deleghe Rapporti Aggiornate: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=17
prev=O3564
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=17
prev=O3563
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=17
prev=O3562
var_op='asgn
I
obj='Exec
pag=17
prev=O3561
I
obj='Exec
pag=17
prev=O3559
I
obj='While
pag=17
prev=O3558
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3559
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPRead
arch='delegabo
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,46,4)+Substr(riga,44,2)+Substr(riga,42,2)
len=8
name='xData
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,55,4)+Substr(riga,53,2)+Substr(riga,51,2)
len=8
name='xDatF
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=17
prev=O3572
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPSelect
father=O3573
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='delegabo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=17
prev=O3581
var_op='asgn
I
obj='Insert
pag=17
prev=O3580
rd_kfield=[
'RAPPORTO
'CPROWNUM
'CODINTER
'DATAINI
'TIPORAP
'DATAFINE
'IDBASE
'NOAGE
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
'Substr(riga,26,16)
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
'LibreriaMit.UniqueId()
'iif(Empty(LRTrim(Substr(riga,59,1))),'N',Substr(riga,59,1))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3581
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=17
prev=O3590
I
obj='Var
obj_type='N
pag=17
prev=O3589
var_op='asgn
I
obj='Exec
pag=17
prev=O3588
I
nonlocal=True
obj='Var
obj_type='M
pag=17
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=17
prev=O3578
var_op='asgn
I
obj='Select
pag=17
sel_field='*
sel_name='delegabo
sel_order='delegabo->CPROWNUM
sel_where='delegabo->RAPPORTO=Left(riga,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3578
fatherSonIndex=0
frm_calc='delegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=17
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='delegabo
father=O3573
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=17
prev=O3598
var_op='asgn
I
obj='Write
pag=17
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3598
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=17
prev=O3608
I
obj='Var
obj_type='N
pag=17
prev=O3607
var_op='asgn
I
obj='Exec
pag=17
prev=O3606
I
nonlocal=True
obj='Var
obj_type='M
pag=17
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'TIPORAP
'DATAFINE
]
wr_op=[
'=
'=
'=
]
wr_var=[
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=17
prev=O3571
var_op='asgn
I
obj='Var
pag=17
prev=O3570
var_op='asgn
I
obj='Read
pag=17
prev=O3569
rd_field=[
'CPROWNUM
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,16)
]
rd_var=[
'cMaxRow
]
I
obj='Var
obj_type='N
pag=17
prev=O3568
var_op='asgn
I
obj='Var
obj_type='M
pag=17
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=17
prev=O3557
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=17
prev=O3556
var_op='asgn
I
obj='Var
obj_type='N
pag=17
prev=O3555
var_op='asgn
I
obj='Var
obj_type='N
pag=17
prev=O3554
var_op='asgn
I
obj='Remark
pag=17
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file SOGOPE.TXT altri soggetti operanti
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport')
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Soggetti operanti inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Soggetti operanti aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=18
prev=O3630
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=18
prev=O3629
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=18
prev=O3628
var_op='asgn
I
obj='Exec
pag=18
prev=O3627
I
obj='Exec
pag=18
prev=O3625
I
obj='While
pag=18
prev=O3624
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3625
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_salta
next=Icpitembatch.CPRemark
frm_calc='Verfico la presenza di _unicode nelle tabelle rapopebo/operazbo/fraziobo
next=Icpitembatch.CPRead
arch='rapopebo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=18
prev=O3639
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3641
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='soginfo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=18
prev=O3648
var_op='asgn
I
obj='Insert
pag=18
prev=O3646
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cInfProg2
'Substr(riga,48,1)
'Substr(riga,50,25)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3648
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=18
prev=O3657
I
obj='Var
obj_type='N
pag=18
prev=O3656
var_op='asgn
I
obj='Exec
pag=18
prev=O3655
I
nonlocal=True
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=18
sel_field='*
sel_name='soginfo
sel_where='soginfo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3646
fatherSonIndex=0
frm_calc='soginfo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=18
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=18
prev=O3638
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cOpeProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O3639
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=18
prev=O3671
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3673
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='sogopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=18
prev=O3680
var_op='asgn
I
obj='Insert
pag=18
prev=O3678
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cOpeProg2
'Substr(riga,48,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3680
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=18
prev=O3689
I
obj='Var
obj_type='N
pag=18
prev=O3688
var_op='asgn
I
obj='Exec
pag=18
prev=O3687
I
nonlocal=True
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=18
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3678
fatherSonIndex=0
frm_calc='sogopebo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=18
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=18
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cOpeProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O3671
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=18
prev=O3703
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3705
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='sogopefbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_salta
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=18
prev=O3714
var_op='asgn
I
obj='Var
obj_type='N
pag=18
prev=O3712
var_op='asgn
I
obj='Insert
pag=18
prev=O3710
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cOpeProg2
'Substr(riga,48,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3712
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=18
prev=O3722
I
obj='Var
obj_type='N
pag=18
prev=O3721
var_op='asgn
I
obj='Exec
pag=18
prev=O3720
I
nonlocal=True
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=18
sel_field='*
sel_name='sogopefbo
sel_where='sogopefbo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3710
fatherSonIndex=0
frm_calc='sogopefbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=18
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=18
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cOpeProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
comment='se non trova il valore nelle tre tabelle da errore e stoppa la procedura
instr=Icpitembatch.CPVarDecl
father=O3703
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errore nella valorizazione del campo IDFILEBO nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,21,16)+" non risulta associabile a nessuna informazione/operazione.  Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_salta
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=18
prev=O3739
I
obj='Var
obj_type='N
pag=18
prev=O3738
var_op='asgn
I
obj='Var
obj_type='N
pag=18
prev=O3737
var_op='asgn
I
obj='Exec
pag=18
prev=O3736
I
nonlocal=True
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Remark
pag=18
prev=O3637
I
obj='Var
obj_type='N
pag=18
prev=O3636
var_op='asgn
I
obj='Var
pag=18
prev=O3635
var_op='asgn
I
obj='Var
obj_type='N
pag=18
prev=O3634
var_op='asgn
I
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=18
prev=O3623
var_op='asgn
I
obj='Var
obj_type='N
pag=18
prev=O3622
var_op='asgn
I
obj='Var
pag=18
prev=O3621
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=18
prev=O3620
var_op='asgn
I
obj='Remark
pag=18
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file INTEST.TXT altri intestatari
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Intestatari inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Intestatari aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=19
prev=O3755
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=19
prev=O3754
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=19
prev=O3753
var_op='asgn
I
obj='Exec
pag=19
prev=O3752
I
obj='Exec
pag=19
prev=O3750
I
obj='While
pag=19
prev=O3749
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3750
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPRemark
frm_calc='Verifico in intestbo che ci sia già un recod con lo stesso codice rapporto e memorizzo i dati della riga necessari per crearne una nuova.
next=Icpitembatch.CPSelect
h=[
19
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Se trovo il record inserisco il nuovo intestatario
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
]
obj='If
pag=19
prev=O3765
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='intestbo
father=O3766
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=19
prev=O3771
var_op='asgn
I
obj='Insert
pag=19
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
]
rd_kvar=[
'ciidbase
'cMaxRow + 1
'cidataini
'iif(Empty(Substr(riga,121,1)) ,'P',Substr(riga,121,1))
'Substr(riga,26,16)
'cinumprog
'Substr(riga,1,25)
'citiporap
''0'
'DateToChar(cidataini)+cinumprog+'O'
'Left(LRTrim(Substr(riga,26,16))+Space(5),16)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3771
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=19
prev=O3780
I
obj='Var
obj_type='N
pag=19
prev=O3779
var_op='asgn
I
obj='Exec
pag=19
prev=O3778
I
nonlocal=True
obj='Var
obj_type='M
pag=19
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=19
prev=O3763
I
obj='Select
pag=19
prev=O3762
sel_field='*
sel_name='intestbo
sel_order='intestbo->CPROWNUM
sel_where='intestbo->RAPPORTO=Substr(riga,1,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3763
fatherSonIndex=0
frm_calc=[
'Substr(riga,26,16)=intestbo->CODINTER
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->CPROWNUM
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->IDBASE
len=10
name='ciidbase
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->DATAINI
len=8
name='cidataini
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->DATAFINE
len=8
name='cidatafine
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->CODINTER
len=12
name='cicodinter
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->NUMPROG1
len=11
name='cinumprog
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->TIPORAP
len=1
name='citiporap
obj='Var
pag=19
prev=O3794
var_op='asgn
I
obj='Var
pag=19
prev=O3793
var_op='asgn
I
obj='Var
pag=19
prev=O3792
var_op='asgn
I
obj='Var
obj_type='D
pag=19
prev=O3791
var_op='asgn
I
obj='Var
obj_type='D
pag=19
prev=O3790
var_op='asgn
I
obj='Var
pag=19
prev=O3789
var_op='asgn
I
obj='Var
obj_type='N
pag=19
prev=O3786
var_op='asgn
I
obj='If
pag=19
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3786
fatherSonIndex=0
frm_calc='intestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=19
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3763
fatherSonIndex=1
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=19
prev=O3803
I
obj='Var
obj_type='N
pag=19
prev=O3802
var_op='asgn
I
obj='Exec
pag=19
prev=O3801
I
nonlocal=True
obj='Var
obj_type='M
pag=19
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
150
]
I
obj='Remark
pag=19
prev=O3761
I
obj='Var
obj_type='N
pag=19
prev=O3760
var_op='asgn
I
obj='Var
obj_type='N
pag=19
prev=O3759
var_op='asgn
I
obj='Var
obj_type='M
pag=19
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=19
prev=O3748
var_op='asgn
I
obj='Var
obj_type='N
pag=19
prev=O3747
var_op='asgn
I
obj='Var
pag=19
prev=O3746
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=19
prev=O3745
var_op='asgn
I
obj='Remark
pag=19
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Deleghe sui rapporti
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Deleghe Rapporti Inserite: '+LRTrim(Str(cNumNew,10,0)) + " - Deleghe Rapporti Aggiornate: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=20
prev=O3817
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=20
prev=O3816
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=20
prev=O3815
var_op='asgn
I
obj='Exec
pag=20
prev=O3814
I
obj='Exec
pag=20
prev=O3812
I
obj='While
pag=20
prev=O3811
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3812
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPRead
arch='xelegabo
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,46,4)+Substr(riga,44,2)+Substr(riga,42,2)
len=8
name='xData
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,55,4)+Substr(riga,53,2)+Substr(riga,51,2)
len=8
name='xDatF
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=20
prev=O3825
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPSelect
father=O3826
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='xelegabo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=20
prev=O3834
var_op='asgn
I
obj='Insert
pag=20
prev=O3833
rd_kfield=[
'RAPPORTO
'CPROWNUM
'CODINTER
'DATAINI
'TIPORAP
'DATAFINE
'IDBASE
'NOAGE
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
'Substr(riga,26,16)
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
'LibreriaMit.UniqueId()
'iif(Empty(LRTrim(Substr(riga,59,1))),'N',Substr(riga,59,1))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3834
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=20
prev=O3843
I
obj='Var
obj_type='N
pag=20
prev=O3842
var_op='asgn
I
obj='Exec
pag=20
prev=O3841
I
nonlocal=True
obj='Var
obj_type='M
pag=20
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=20
prev=O3831
var_op='asgn
I
obj='Select
pag=20
sel_field='*
sel_name='xelegabo
sel_order='xelegabo->CPROWNUM
sel_where='xelegabo->RAPPORTO=Left(riga,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3831
fatherSonIndex=0
frm_calc='xelegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=20
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='xelegabo
father=O3826
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=20
prev=O3851
var_op='asgn
I
obj='Write
pag=20
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3851
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=20
prev=O3861
I
obj='Exec
pag=20
prev=O3860
I
obj='Var
obj_type='N
pag=20
prev=O3859
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=20
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'TIPORAP
'DATAFINE
]
wr_op=[
'=
'=
'=
]
wr_var=[
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=20
prev=O3824
var_op='asgn
I
obj='Var
pag=20
prev=O3823
var_op='asgn
I
obj='Read
pag=20
prev=O3822
rd_field=[
'CPROWNUM
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,16)
]
rd_var=[
'cMaxRow
]
I
obj='Var
obj_type='N
pag=20
prev=O3821
var_op='asgn
I
obj='Var
obj_type='M
pag=20
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=20
prev=O3810
var_op='asgn
I
obj='Var
obj_type='N
pag=20
prev=O3809
var_op='asgn
I
obj='Var
obj_type='N
pag=20
prev=O3808
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=20
prev=O3807
var_op='asgn
I
obj='Remark
pag=20
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file SOGOPE.TXT altri soggetti operanti in Provvisorio
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport')
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Soggetti operanti inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Soggetti operanti aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=21
prev=O3883
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=21
prev=O3882
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=21
prev=O3881
var_op='asgn
I
obj='Exec
pag=21
prev=O3880
I
obj='Exec
pag=21
prev=O3878
I
obj='While
pag=21
prev=O3877
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3878
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_salta
next=Icpitembatch.CPRemark
frm_calc='Verfico la presenza di _unicode nelle tabelle rapopebo/operazbo/fraziobo
next=Icpitembatch.CPRead
arch='xapopebo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=21
prev=O3892
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3894
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xoginfo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=21
prev=O3901
var_op='asgn
I
obj='Insert
pag=21
prev=O3899
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cInfProg2
'Substr(riga,48,1)
'Substr(riga,50,25)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3901
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=21
prev=O3910
I
obj='Var
obj_type='N
pag=21
prev=O3909
var_op='asgn
I
obj='Exec
pag=21
prev=O3908
I
nonlocal=True
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=21
sel_field='*
sel_name='xoginfo
sel_where='xoginfo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3899
fatherSonIndex=0
frm_calc='xoginfo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=21
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=21
prev=O3891
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cInfProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O3892
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=21
prev=O3924
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3926
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xogopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=21
prev=O3933
var_op='asgn
I
obj='Insert
pag=21
prev=O3931
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cOpeProg2
'Substr(riga,48,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3933
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=21
prev=O3942
I
obj='Var
obj_type='N
pag=21
prev=O3941
var_op='asgn
I
obj='Exec
pag=21
prev=O3940
I
nonlocal=True
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=21
sel_field='*
sel_name='xogopebo
sel_where='xogopebo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3931
fatherSonIndex=0
frm_calc='xogopebo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=21
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=21
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_idbase
'cInfProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O3924
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=21
prev=O3956
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3958
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xogopefbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_salta
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=21
prev=O3967
var_op='asgn
I
obj='Var
obj_type='N
pag=21
prev=O3965
var_op='asgn
I
obj='Insert
pag=21
prev=O3963
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cOpeProg2
'Substr(riga,48,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3965
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=21
prev=O3975
I
obj='Var
obj_type='N
pag=21
prev=O3974
var_op='asgn
I
obj='Exec
pag=21
prev=O3973
I
nonlocal=True
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=21
sel_field='*
sel_name='xogopefbo
sel_where='xogopefbo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3963
fatherSonIndex=0
frm_calc='xogopefbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=21
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=21
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cInfProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
comment='se non trova il valore nelle tre tabelle da errore e stoppa la procedura
instr=Icpitembatch.CPVarDecl
father=O3956
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errore nella valorizazione del campo IDFILEBO nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,21,16)+" non risulta associabile a nessuna informazione/operazione.  Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_salta
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=21
prev=O3992
I
obj='Var
obj_type='N
pag=21
prev=O3991
var_op='asgn
I
obj='Exec
pag=21
prev=O3990
I
obj='Var
obj_type='N
pag=21
prev=O3989
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Remark
pag=21
prev=O3890
I
obj='Var
obj_type='N
pag=21
prev=O3889
var_op='asgn
I
obj='Var
pag=21
prev=O3888
var_op='asgn
I
obj='Var
obj_type='N
pag=21
prev=O3887
var_op='asgn
I
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=21
prev=O3876
var_op='asgn
I
obj='Var
obj_type='N
pag=21
prev=O3875
var_op='asgn
I
obj='Var
pag=21
prev=O3874
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=21
prev=O3873
var_op='asgn
I
obj='Remark
pag=21
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file INTEST.TXT altri intestatari
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Intestatari inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Intestatari aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=22
prev=O4008
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=22
prev=O4007
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=22
prev=O4006
var_op='asgn
I
obj='Exec
pag=22
prev=O4005
I
obj='Exec
pag=22
prev=O4003
I
obj='While
pag=22
prev=O4002
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4003
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPRemark
frm_calc='Verifico in intestbo che ci sia già un recod con lo stesso codice rapporto e memorizzo i dati della riga necessari per crearne una nuova.
next=Icpitembatch.CPSelect
h=[
19
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Se trovo il record inserisco il nuovo intestatario
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
]
obj='If
pag=22
prev=O4018
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xntestbo
father=O4019
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=22
prev=O4024
var_op='asgn
I
obj='Insert
pag=22
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
]
rd_kvar=[
'ciidbase
'cMaxRow + 1
'cidataini
'iif(Empty(Substr(riga,121,1)) ,'P',Substr(riga,121,1))
'Substr(riga,26,16)
'cinumprog
'Substr(riga,1,25)
'citiporap
''0'
'DateToChar(cidataini)+cinumprog+'O'
'Left(LRTrim(Substr(riga,26,16))+Space(5),16)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4024
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=22
prev=O4033
I
obj='Var
obj_type='N
pag=22
prev=O4032
var_op='asgn
I
obj='Exec
pag=22
prev=O4031
I
nonlocal=True
obj='Var
obj_type='M
pag=22
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=22
prev=O4016
I
obj='Select
pag=22
prev=O4015
sel_field='*
sel_name='xntestbo
sel_order='xntestbo->CPROWNUM
sel_where='xntestbo->RAPPORTO=Substr(riga,1,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4016
fatherSonIndex=0
frm_calc=[
'Substr(riga,26,16)=xntestbo->CODINTER
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->CPROWNUM
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->IDBASE
len=10
name='ciidbase
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->DATAINI
len=8
name='cidataini
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->DATAFINE
len=8
name='cidatafine
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->CODINTER
len=12
name='cicodinter
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->NUMPROG1
len=11
name='cinumprog
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->TIPORAP
len=1
name='citiporap
obj='Var
pag=22
prev=O4047
var_op='asgn
I
obj='Var
pag=22
prev=O4046
var_op='asgn
I
obj='Var
pag=22
prev=O4045
var_op='asgn
I
obj='Var
obj_type='D
pag=22
prev=O4044
var_op='asgn
I
obj='Var
obj_type='D
pag=22
prev=O4043
var_op='asgn
I
obj='Var
pag=22
prev=O4042
var_op='asgn
I
obj='Var
obj_type='N
pag=22
prev=O4039
var_op='asgn
I
obj='If
pag=22
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4039
fatherSonIndex=0
frm_calc='xntestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=22
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4016
fatherSonIndex=1
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=22
prev=O4056
I
obj='Var
obj_type='N
pag=22
prev=O4055
var_op='asgn
I
obj='Exec
pag=22
prev=O4054
I
nonlocal=True
obj='Var
obj_type='M
pag=22
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
150
]
I
obj='Remark
pag=22
prev=O4014
I
obj='Var
obj_type='N
pag=22
prev=O4013
var_op='asgn
I
obj='Var
obj_type='N
pag=22
prev=O4012
var_op='asgn
I
obj='Var
obj_type='M
pag=22
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=22
prev=O4001
var_op='asgn
I
obj='Var
obj_type='N
pag=22
prev=O4000
var_op='asgn
I
obj='Var
pag=22
prev=O3999
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=22
prev=O3998
var_op='asgn
I
obj='Remark
pag=22
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Deleghe sui rapporti
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Deleghe Rapporti Inserite: '+LRTrim(Str(cNumNew,10,0)) + " - Deleghe Rapporti Aggiornate: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=23
prev=O4070
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=23
prev=O4069
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=23
prev=O4068
var_op='asgn
I
obj='Exec
pag=23
prev=O4067
I
obj='Exec
pag=23
prev=O4065
I
obj='While
pag=23
prev=O4064
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4065
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPRead
arch='jelegabo
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,46,4)+Substr(riga,44,2)+Substr(riga,42,2)
len=8
name='xData
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,55,4)+Substr(riga,53,2)+Substr(riga,51,2)
len=8
name='xDatF
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=23
prev=O4078
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPSelect
father=O4079
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='jelegabo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=23
prev=O4087
var_op='asgn
I
obj='Insert
pag=23
prev=O4086
rd_kfield=[
'RAPPORTO
'CPROWNUM
'CODINTER
'DATAINI
'TIPORAP
'DATAFINE
'IDBASE
'NOAGE
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
'Substr(riga,26,16)
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
'LibreriaMit.UniqueId()
'iif(Empty(LRTrim(Substr(riga,59,1))),'N',Substr(riga,59,1))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4087
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=23
prev=O4096
I
obj='Var
obj_type='N
pag=23
prev=O4095
var_op='asgn
I
obj='Exec
pag=23
prev=O4094
I
nonlocal=True
obj='Var
obj_type='M
pag=23
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=23
prev=O4084
var_op='asgn
I
obj='Select
pag=23
sel_field='*
sel_name='jelegabo
sel_order='jelegabo->CPROWNUM
sel_where='jelegabo->RAPPORTO=Left(riga,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4084
fatherSonIndex=0
frm_calc='jelegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=23
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='jelegabo
father=O4079
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=23
prev=O4104
var_op='asgn
I
obj='Write
pag=23
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4104
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=23
prev=O4114
I
obj='Var
obj_type='N
pag=23
prev=O4113
var_op='asgn
I
obj='Exec
pag=23
prev=O4112
I
nonlocal=True
obj='Var
obj_type='M
pag=23
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'TIPORAP
'DATAFINE
]
wr_op=[
'=
'=
'=
]
wr_var=[
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=23
prev=O4077
var_op='asgn
I
obj='Var
pag=23
prev=O4076
var_op='asgn
I
obj='Read
pag=23
prev=O4075
rd_field=[
'CPROWNUM
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,16)
]
rd_var=[
'cMaxRow
]
I
obj='Var
obj_type='N
pag=23
prev=O4074
var_op='asgn
I
obj='Var
obj_type='M
pag=23
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=23
prev=O4063
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=23
prev=O4062
var_op='asgn
I
obj='Var
obj_type='N
pag=23
prev=O4061
var_op='asgn
I
obj='Var
obj_type='N
pag=23
prev=O4060
var_op='asgn
I
obj='Remark
pag=23
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file SOGAGE.TXT altri soggetti operanti in Provvisorio
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport')
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Soggetti operanti inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Soggetti operanti aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=24
prev=O4136
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=24
prev=O4135
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=24
prev=O4134
var_op='asgn
I
obj='Exec
pag=24
prev=O4133
I
obj='Exec
pag=24
prev=O4131
I
obj='While
pag=24
prev=O4130
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4131
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_salta
next=Icpitembatch.CPRemark
frm_calc='Verfico la presenza di _unicode nelle tabelle rapopebo/operazbo/fraziobo
next=Icpitembatch.CPRead
arch='japopebo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=24
prev=O4145
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4147
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='joginfo
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=24
prev=O4154
var_op='asgn
I
obj='Insert
pag=24
prev=O4152
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
]
rd_kvar=[
'_unicode
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'_unicode
'cInfProg2
'Substr(riga,48,1)
'Substr(riga,50,25)
]
I
obj='Select
pag=24
sel_field='*
sel_name='joginfo
sel_where='joginfo->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4152
fatherSonIndex=0
frm_calc='joginfo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=24
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=24
prev=O4144
rd_field=[
'IDBASE
'NUMPROG
]
rd_kfield=[
'IDBASE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_unicode
'cInfProg2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='jperazbo
father=O4145
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=24
prev=O4169
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4171
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='jogopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=24
prev=O4178
var_op='asgn
I
obj='Insert
pag=24
prev=O4176
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
]
rd_kvar=[
'_unicode
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'_unicode
'cOpeProg2
'Substr(riga,48,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4178
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=24
prev=O4187
I
obj='Var
obj_type='N
pag=24
prev=O4186
var_op='asgn
I
obj='Exec
pag=24
prev=O4185
I
nonlocal=True
obj='Var
obj_type='M
pag=24
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=24
sel_field='*
sel_name='jogopebo
sel_where='jogopebo->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4176
fatherSonIndex=0
frm_calc='jogopebo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=24
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=24
rd_field=[
'IDBASE
'NUMPROG
]
rd_kfield=[
'IDBASE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
'cOpeProg2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4169
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errore nella valorizazione del campo IDFILEBO nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,21,16)+" non risulta associabile a nessuna informazione/operazione.  Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_salta
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=24
prev=O4204
I
obj='Var
obj_type='N
pag=24
prev=O4203
var_op='asgn
I
obj='Exec
pag=24
prev=O4202
I
obj='Var
obj_type='N
pag=24
prev=O4201
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=24
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Remark
pag=24
prev=O4143
I
obj='Var
obj_type='N
pag=24
prev=O4142
var_op='asgn
I
obj='Var
pag=24
prev=O4141
var_op='asgn
I
obj='Var
obj_type='N
pag=24
prev=O4140
var_op='asgn
I
obj='Var
obj_type='M
pag=24
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=24
prev=O4129
var_op='asgn
I
obj='Var
obj_type='N
pag=24
prev=O4128
var_op='asgn
I
obj='Var
obj_type='N
pag=24
prev=O4127
var_op='asgn
I
obj='Var
pag=24
prev=O4126
var_op='asgn
I
obj='Remark
pag=24
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file INTAGE.TXT altri intestatari
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Intestatari inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Intestatari aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=25
prev=O4219
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=25
prev=O4218
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=25
prev=O4217
var_op='asgn
I
obj='Exec
pag=25
prev=O4216
I
obj='Exec
pag=25
prev=O4214
I
obj='While
pag=25
prev=O4213
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4214
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPRemark
frm_calc='Verifico in intestbo che ci sia già un recod con lo stesso codice rapporto e memorizzo i dati della riga necessari per crearne una nuova.
next=Icpitembatch.CPSelect
h=[
19
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Se trovo il record inserisco il nuovo intestatario
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
]
obj='If
pag=25
prev=O4229
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='jntestbo
father=O4230
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=25
prev=O4235
var_op='asgn
I
obj='Insert
pag=25
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
]
rd_kvar=[
'ciidbase
'cMaxRow + 1
'cidataini
'iif(Empty(Substr(riga,121,1)) ,'P',Substr(riga,121,1))
'Substr(riga,26,16)
'cinumprog
'Substr(riga,1,25)
'citiporap
''0'
'DateToChar(cidataini)+cinumprog+'O'
'Left(LRTrim(Substr(riga,26,16))+Space(5),16)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4235
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=25
prev=O4244
I
obj='Var
obj_type='N
pag=25
prev=O4243
var_op='asgn
I
obj='Exec
pag=25
prev=O4242
I
nonlocal=True
obj='Var
obj_type='M
pag=25
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=25
prev=O4227
I
obj='Select
pag=25
prev=O4226
sel_field='*
sel_name='jntestbo
sel_order='jntestbo->CPROWNUM
sel_where='jntestbo->RAPPORTO=Substr(riga,1,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4227
fatherSonIndex=0
frm_calc=[
'Substr(riga,26,16)=jntestbo->CODINTER
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->CPROWNUM
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->IDBASE
len=10
name='ciidbase
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->DATAINI
len=8
name='cidataini
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->DATAFINE
len=8
name='cidatafine
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->CODINTER
len=12
name='cicodinter
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->NUMPROG1
len=11
name='cinumprog
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->TIPORAP
len=1
name='citiporap
obj='Var
pag=25
prev=O4258
var_op='asgn
I
obj='Var
pag=25
prev=O4257
var_op='asgn
I
obj='Var
pag=25
prev=O4256
var_op='asgn
I
obj='Var
obj_type='D
pag=25
prev=O4255
var_op='asgn
I
obj='Var
obj_type='D
pag=25
prev=O4254
var_op='asgn
I
obj='Var
pag=25
prev=O4253
var_op='asgn
I
obj='Var
obj_type='N
pag=25
prev=O4250
var_op='asgn
I
obj='If
pag=25
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4250
fatherSonIndex=0
frm_calc='jntestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=25
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4227
fatherSonIndex=1
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=25
prev=O4267
I
obj='Var
obj_type='N
pag=25
prev=O4266
var_op='asgn
I
obj='Exec
pag=25
prev=O4265
I
nonlocal=True
obj='Var
obj_type='M
pag=25
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
150
]
I
obj='Remark
pag=25
prev=O4225
I
obj='Var
obj_type='N
pag=25
prev=O4224
var_op='asgn
I
obj='Var
obj_type='N
pag=25
prev=O4223
var_op='asgn
I
obj='Var
obj_type='M
pag=25
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=25
prev=O4212
var_op='asgn
I
obj='Var
obj_type='N
pag=25
prev=O4211
var_op='asgn
I
obj='Var
obj_type='N
pag=25
prev=O4210
var_op='asgn
I
obj='Var
pag=25
prev=O4209
var_op='asgn
I
obj='Remark
pag=25
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Intestatari Operazioni Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Intestatari Operazioni Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=26
prev=O4281
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=26
prev=O4280
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=26
prev=O4279
var_op='asgn
I
obj='Exec
pag=26
prev=O4278
I
obj='Exec
pag=26
prev=O4276
I
obj='While
pag=26
prev=O4275
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4276
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,48,1)='F'
'Substr(riga,48,1)='O'
]
h=[
19
19
19
]
obj='If
pag=26
prev=O4288
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O4289
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=26
prev=O4294
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O4295
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=26
prev=O4300
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientifrz
father=O4301
fatherSonIndex=0
obj='Insert
pag=26
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=26
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientifrz
father=O4295
fatherSonIndex=1
obj='Insert
pag=26
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=26
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O4289
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=26
prev=O4324
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O4325
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=26
prev=O4330
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O4331
fatherSonIndex=0
obj='Insert
pag=26
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=26
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientiope
father=O4325
fatherSonIndex=1
obj='Insert
pag=26
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=26
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=26
prev=O4287
var_op='asgn
I
obj='Var
obj_type='N
pag=26
prev=O4286
var_op='asgn
I
obj='Var
obj_type='N
pag=26
prev=O4285
var_op='asgn
I
obj='Var
obj_type='M
pag=26
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=26
prev=O4274
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=26
prev=O4273
var_op='asgn
I
obj='Var
obj_type='N
pag=26
prev=O4272
var_op='asgn
I
obj='Var
obj_type='N
pag=26
prev=O4271
var_op='asgn
I
obj='Remark
pag=26
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Altri Soggetti Operazioni Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Altri Soggetti Operazioni Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=29
prev=O4365
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=29
prev=O4364
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=29
prev=O4363
var_op='asgn
I
obj='Exec
pag=29
prev=O4362
I
obj='Exec
pag=29
prev=O4360
I
obj='While
pag=29
prev=O4359
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4360
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,48,1)='F'
'Substr(riga,48,1)='O'
]
h=[
19
19
19
]
obj='If
pag=29
prev=O4372
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O4373
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=29
prev=O4378
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O4379
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=29
prev=O4384
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistifrz
father=O4385
fatherSonIndex=0
obj='Insert
pag=29
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=29
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xerzistifrz
father=O4379
fatherSonIndex=1
obj='Insert
pag=29
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=29
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O4373
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=29
prev=O4408
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O4409
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=29
prev=O4414
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistiope
father=O4415
fatherSonIndex=0
obj='Insert
pag=29
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=29
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xerzistiope
father=O4409
fatherSonIndex=1
obj='Insert
pag=29
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=29
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=29
prev=O4371
var_op='asgn
I
obj='Var
obj_type='N
pag=29
prev=O4370
var_op='asgn
I
obj='Var
obj_type='N
pag=29
prev=O4369
var_op='asgn
I
obj='Var
obj_type='M
pag=29
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=29
prev=O4358
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=29
prev=O4357
var_op='asgn
I
obj='Var
obj_type='N
pag=29
prev=O4356
var_op='asgn
I
obj='Var
obj_type='N
pag=29
prev=O4355
var_op='asgn
I
obj='Remark
pag=29
x=23
y=25
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Beneficiari Operazioni Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Beneficiari Operazioni Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=28
prev=O4449
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=28
prev=O4448
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=28
prev=O4447
var_op='asgn
I
obj='Exec
pag=28
prev=O4446
I
obj='Exec
pag=28
prev=O4444
I
obj='While
pag=28
prev=O4443
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4444
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=28
prev=O4453
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4454
fatherSonIndex=0
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,48,1)='F'
'Substr(riga,48,1)='O'
'Substr(riga,48,1)='I'
]
h=[
19
19
19
19
]
obj='If
pag=28
prev=O4461
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O4462
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=28
prev=O4467
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O4468
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=28
prev=O4473
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4474
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='beneficfrz
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O4482
var_op='asgn
I
obj='Insert
pag=28
prev=O4481
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'Substr(riga,75,70)
'Substr(riga,145,3)
'Substr(riga,148,30)
'Substr(riga,178,6)
'Substr(riga,184,2)
'Substr(riga,186,35)
'Substr(riga,221,5)
'cMaxRow
]
I
obj='Var
obj_type='N
pag=28
prev=O4479
var_op='asgn
I
obj='Select
pag=28
sel_field='*
sel_name='beneficfrz
sel_order='beneficfrz->CPROWNUM
sel_where='beneficfrz->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4479
fatherSonIndex=0
frm_calc='beneficfrz->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4468
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='xeneficfrz
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O4499
var_op='asgn
I
obj='Insert
pag=28
prev=O4498
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'Substr(riga,75,70)
'Substr(riga,145,3)
'Substr(riga,148,30)
'Substr(riga,178,6)
'Substr(riga,184,2)
'Substr(riga,186,35)
'Substr(riga,221,5)
'cMaxRow
]
I
obj='Var
obj_type='N
pag=28
prev=O4496
var_op='asgn
I
obj='Select
pag=28
sel_field='*
sel_name='xeneficfrz
sel_order='xeneficfrz->CPROWNUM
sel_where='xeneficfrz->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4496
fatherSonIndex=0
frm_calc='xeneficfrz->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='xperazbo
father=O4462
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=28
prev=O4513
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O4514
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=28
prev=O4519
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4520
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='beneficope
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O4528
var_op='asgn
I
obj='Insert
pag=28
prev=O4527
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'Substr(riga,75,70)
'Substr(riga,145,3)
'Substr(riga,148,30)
'Substr(riga,178,6)
'Substr(riga,184,2)
'Substr(riga,186,35)
'Substr(riga,221,5)
'cMaxRow
]
I
obj='Var
obj_type='N
pag=28
prev=O4525
var_op='asgn
I
obj='Select
pag=28
sel_field='*
sel_name='beneficope
sel_order='beneficope->CPROWNUM
sel_where='beneficope->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4525
fatherSonIndex=0
frm_calc='beneficope->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4514
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='xeneficope
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O4545
var_op='asgn
I
obj='Insert
pag=28
prev=O4544
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'Substr(riga,75,70)
'Substr(riga,145,3)
'Substr(riga,148,30)
'Substr(riga,178,6)
'Substr(riga,184,2)
'Substr(riga,186,35)
'Substr(riga,221,5)
'cMaxRow
]
I
obj='Var
obj_type='N
pag=28
prev=O4542
var_op='asgn
I
obj='Select
pag=28
sel_field='*
sel_name='xeneficope
sel_order='xeneficope->CPROWNUM
sel_where='xeneficope->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4542
fatherSonIndex=0
frm_calc='xeneficope->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xapopebo
father=O4462
fatherSonIndex=2
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=28
prev=O4559
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='rapopebo
father=O4560
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=28
prev=O4565
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='fiduciabo
father=O4566
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O4571
var_op='asgn
I
obj='Insert
pag=28
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xiduciabo
father=O4560
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O4581
var_op='asgn
I
obj='Insert
pag=28
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=28
prev=O4460
var_op='asgn
I
obj='Var
obj_type='N
pag=28
prev=O4459
var_op='asgn
I
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=28
prev=O4442
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=28
prev=O4441
var_op='asgn
I
obj='Var
obj_type='N
pag=28
prev=O4440
var_op='asgn
I
obj='Var
obj_type='N
pag=28
prev=O4439
var_op='asgn
I
obj='Remark
pag=28
x=21
y=20
I
Icpitembatch.CPVarDecl
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
len=10
name='cNewProg
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumInv
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='nProgSto
next=Icpitembatch.CPVarDecl
frm_calc='0
len=15
name='nProgImp
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='cpwarn
next=Icpitembatch.CPWrite
arch='cpwarn
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Soggetti Inseriti: '+LRTrim(Str(cNumNew,10,0)) + ' - Soggetti Aggiornati: '+LRTrim(Str(cNumMod,10,0)) + ' - Soggetti Invariati: '+LRTrim(Str(cNumInv,10,0)) + ' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O4616
var_op='asgn
I
obj='Exec
pag=30
prev=O4615
I
obj='Exec
pag=30
prev=O4614
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O4613
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O4612
var_op='asgn
I
obj='Write
pag=30
prev=O4611
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'nProgSto + 1
]
I
obj='Write
pag=30
prev=O4609
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'nProgImp + 1
]
I
obj='While
pag=30
prev=O4608
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4609
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=30
prev=O4632
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4633
fatherSonIndex=0
frm_calc=[
'w_creamo='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datvarage
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' nominativi del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,112,16)
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,112,16)
len=16
name='xCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,496,16)
len=16
name='_conadd
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(_conadd)),cCli1,_conadd)
len=16
name='cCli1
next=Icpitembatch.CPRemark
frm_calc='Prima la Read si faceva per CF
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_oldest
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,288,1))),'G','P')
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,288,1)='M','1',iif(Substr(riga,288,1)='F','2',Substr(riga,288,1)))
len=1
name='xSesso
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,458,1)='0' or Substr(riga,458,1)='1' or Substr(riga,458,1) = ''
'Substr(riga,458,1)='N' or Substr(riga,458,1)='S'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,6)
len=6
name='xCodCab
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCodCab))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,136,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'(Substr(xCF,12,1) = 'Z' or Substr(riga,456,2)='EE') and (Substr(riga,288,1)='M' or Substr(riga,288,1)='F')
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xConnes)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=30
prev=O4668
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4671
fatherSonIndex=0
frm_calc='nProgImp + 1
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='personbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=30
prev=O4677
var_op='asgn
I
obj='Insert
pag=30
prev=O4676
rd_kfield=[
'ALLINEATO
'ALLINEATONOMECNOME
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'CONNES
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROGIMPORT
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'TIPOPERS
'DATAVARAGE
]
rd_kvar=[
'0
'0
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,478,5)),3))
'Substr(riga,468,10)
'Substr(riga,200,30)
'Substr(riga,265,9)
'xCFE
'xCodCab
'Substr(riga,112,16)
'Substr(riga,305,26)
'Substr(riga,463,5)
'cCli1
'CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Substr(riga,230,30)
'Substr(riga,356,100)
'Substr(riga,77,35)
'cCNAS
'cSNAS
'Substr(riga,331,25)
'Substr(riga,177,15)
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'iif(Empty(Substr(riga,495,1)),'N',Substr(riga,495,1))
'Substr(riga,459,4)
'nProgImp
'Substr(riga,260,2)
'Substr(riga,7,70)
'Substr(riga,7,70)
'Substr(riga,169,3)
'Val(Substr(riga,492,3))
'Val(Substr(riga,489,3))
'Val(Substr(riga,486,3))
'Val(Substr(riga,483,3))
'xSesso
'Substr(riga,172,3)
'Substr(riga,166,3)
'Substr(riga,456,2)
'Substr(riga,175,2)
'_tipper
'_datvarage
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4677
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+LRTrim(Substr(riga,7,70))+" con codice fiscale: "+LRTrim(Substr(riga,112,16))+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=30
prev=O4687
I
obj='Exec
pag=30
prev=O4686
I
obj='Var
obj_type='N
pag=30
prev=O4685
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O4684
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4671
fatherSonIndex=1
frm_calc='Upper(xCF)+Substr(riga,7,70)+Substr(riga,77,35)+Substr(riga,230,30)+Substr(riga,260,2)+LibreriaMit.SpacePad(LRTrim(Substr(riga,265,9)),5)+Substr(riga,262,3)+Substr(riga,166,3)+Substr(riga,169,3)+Substr(riga,172,3)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+LibreriaMit.SpacePad(Left(cCNAS,30),30)+Substr(riga,456,2)+LibreriaMit.SpacePad(Left(cSNAS,30),30)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+Substr(riga,175,2)+Substr(riga,177,15)+Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2)+Substr(riga,200,30)+Substr(riga,274,14)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='Upper(xCF)+Substr(riga,7,70)+Substr(riga,230,30)+Substr(riga,260,2)
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='xRiga3+LibreriaMit.SpacePad(Left(cCNAS,30),30)+Substr(riga,456,2)+LibreriaMit.SpacePad(Left(cSNAS,30),30)
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='xRiga3+CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))+xSesso
len=10
name='xRiga3
next=Icpitembatch.CPRemark
frm_calc='Crea la riga di confronto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico se il soggetto è una persona fisica
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Substr(riga,516,4)+Substr(riga,514,2)+Substr(riga,512,2))
len=8
name='_datvarage
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,288,1)='M' or Substr(riga,288,1)='F'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=30
prev=O4702
sons=[
Icpitembatch.CPItemSon
comment='se persona fisica
instr=Icpitembatch.CPWrite
arch='personbo
father=O4703
fatherSonIndex=0
frm_calc='Errore in aggiornamento PERSNEW
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=30
prev=O4708
var_op='asgn
I
obj='Write
pag=30
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'xConnes
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4708
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
frm_calc='m_cLastMsgError = ""
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=30
prev=O4718
I
obj='Exec
pag=30
prev=O4717
I
obj='Var
obj_type='N
pag=30
prev=O4716
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'DATAVARAGE
'PEP
'AREAGEO
'RAREA
'RATTIV
'RCOMP
'RNATGIU
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,468,10)
'Substr(riga,200,30)
'Substr(riga,265,9)
'xCFE
'xCodCab
'Substr(riga,112,16)
'Substr(riga,305,26)
'Substr(riga,463,5)
'CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Substr(riga,230,30)
'Substr(riga,356,100)
'Substr(riga,77,35)
'cCNAS
'cSNAS
'Substr(riga,331,25)
'Substr(riga,177,15)
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'Substr(riga,459,4)
'Substr(riga,260,2)
'Substr(riga,7,70)
'Substr(riga,7,70)
'Substr(riga,169,3)
'xSesso
'Substr(riga,172,3)
'Substr(riga,166,3)
'Substr(riga,456,2)
'Substr(riga,175,2)
'_datvarage
'iif(Empty(Substr(riga,495,1)),'N',Substr(riga,495,1))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,478,5)),3))
'Val(Substr(riga,492,3))
'Val(Substr(riga,489,3))
'Val(Substr(riga,486,3))
'Val(Substr(riga,483,3))
]
I
I
Icpitembatch.CPItemSon
comment='se persona giuridica
instr=Icpitembatch.CPRemark
father=O4703
fatherSonIndex=1
frm_calc='Se non è persona fisica
next=Icpitembatch.CPWrite
arch='personbo
frm_calc='Errore in aggiornamento PERSNEW
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=30
prev=O4726
var_op='asgn
I
obj='Write
pag=30
prev=O4725
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'xConnes
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4726
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=30
prev=O4735
I
obj='Var
obj_type='N
pag=30
prev=O4734
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'DATAVARAGE
'PEP
'AREAGEO
'RAREA
'RATTIV
'RCOMP
'RNATGIU
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,468,10)
'Substr(riga,200,30)
'Substr(riga,265,9)
'xCFE
'xCodCab
'Substr(riga,112,16)
'Substr(riga,305,26)
'Substr(riga,463,5)
'CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'Substr(riga,230,30)
'Substr(riga,356,100)
'Substr(riga,77,35)
'cCNAS
'cSNAS
'Substr(riga,331,25)
'Substr(riga,177,15)
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'Substr(riga,459,4)
'Substr(riga,260,2)
'Substr(riga,7,70)
'Substr(riga,7,70)
'Substr(riga,169,3)
'xSesso
'Substr(riga,172,3)
'Substr(riga,166,3)
'Substr(riga,456,2)
'Substr(riga,175,2)
'_datvarage
'iif(Empty(Substr(riga,495,1)),'N',Substr(riga,495,1))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,478,5)),3))
'Val(Substr(riga,492,3))
'Val(Substr(riga,489,3))
'Val(Substr(riga,486,3))
'Val(Substr(riga,483,3))
]
I
obj='Remark
pag=30
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='D
pag=30
prev=O4701
var_op='asgn
I
obj='Remark
pag=30
prev=O4699
I
obj='Select
pag=30
prev=O4698
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4699
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad(personbo->CODFISC,16)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->RAGSOC,70)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->DOMICILIO,35)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->DESCCIT,30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->PROVINCIA,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(LRTrim(personbo->CAP),5)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->PAESE,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->SOTGRUP,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->RAMOGRUP,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->SETTSINT,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(Left(personbo->NASCOMUN,30),30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->TIPINTER,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(Left(personbo->NASSTATO,30),30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + iif(DateToChar(personbo->DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATANASC),8),Space(8))
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->TIPODOC,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->NUMDOCUM,15)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + iif(DateToChar(personbo->DATARILASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATARILASC),8),Space(8))
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->AUTRILASC,30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->PARTIVA,14)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.SpacePad(personbo->CODFISC,16)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->RAGSOC,70)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->DESCCIT,30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->PROVINCIA,2)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(Left(personbo->NASCOMUN,30),30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->TIPINTER,2)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(Left(personbo->NASSTATO,30),30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + iif(DateToChar(personbo->DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATANASC),8),Space(8))
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->SESSO,1)
len=10
name='xRiga4
next=Icpitembatch.CPRemark
frm_calc='Se le due stringhe sono diverse, ci sono delle modifiche da fare. Quindi storicizzo in wersonbo le modifche.
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(xRiga1) <> LRTrim(xRiga2)
]
h=[
19
19
]
obj='If
pag=30
prev=O4772
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O4773
fatherSonIndex=0
frm_calc='Verifico se c'è già una variazione
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Substr(riga,301,4)+Substr(riga,299,2)+Substr(riga,297,2))
len=8
name='_datarett
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
obj='If
pag=30
prev=O4781
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O4783
fatherSonIndex=0
frm_calc='Calcola il progressivo di registrazione
next=Icpitembatch.CPVarDecl
frm_calc='nProgSto + 1
len=10
name='nProgSto
next=Icpitembatch.CPVarDecl
frm_calc='Right('000000000000000'+LRTrim(Str(nProgSto,15,0)),15)
len=15
name='cProgSto
next=Icpitembatch.CPInsert
arch='wersonbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_flgmodi='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_creamo='S'
]
h=[
19
19
]
obj='If
pag=30
prev=O4793
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4796
fatherSonIndex=0
frm_calc=[
'LRTrim(xRiga3) <> LRTrim(xRiga4)
]
h=[
19
19
]
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4801
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=30
prev=O4806
sel_field='fraziobo->IDBASE
sel_name='fraziobo
sel_where='fraziobo->CONNESCLI=xConnes or fraziobo->CONNESOPER=xConnes or fraziobo->CONNESBEN=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4808
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(gAzienda)+"'",Space(10),10)
len=10
name='cNewProg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc=''JLMNOTUV?'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='fraziobo->IDBASE
len=10
name='_idbase
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=30
prev=O4814
sel_field='*
sel_name='fraziobo
sel_where='fraziobo->IDBASE=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4815
fatherSonIndex=0
frm_calc='iif(Empty(fraziobo->FLAGRAP2),Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(fraziobo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPInsert
arch='fraziobo
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(operazbo->DATAOPE)+"F"+LibreriaMit.UniqueId()+"X"
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=30
prev=O4821
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_idbase
]
wr_field=[
'OPERAZMOD
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
'=
]
wr_var=[
'fraziobo->IDEREG
''1'
'Date()
]
I
obj='Var
pag=30
prev=O4820
var_op='asgn
I
obj='Insert
pag=30
prev=O4819
rd_kfield=[
'AREAGEO
'AUTOM
'CAMBIO
'CDATAOPE
'CDATOPE
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'MODSVOL
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
'CONNALTRO
'CONNESDOC
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'DATAIMP
'C_RAPPORTO
'PAGASOGOP
'MTCN
'IDFILE
'CDATREG
'IPCOLLEG
'ORACOLLEG
'DUCOLLEG
'ANNOOPE
]
rd_kvar=[
'fraziobo->AREAGEO
'fraziobo->AUTOM
'fraziobo->CAMBIO
'fraziobo->CDATAOPE
'fraziobo->CDATOPE
'fraziobo->CODANA
'fraziobo->CODCAB
'fraziobo->CODCAB2
'fraziobo->CODDIPE
'fraziobo->CODINT2
'fraziobo->CODINTER
'fraziobo->CODVOC
'fraziobo->COLLEG
'fraziobo->CONNESBEN
'fraziobo->CONNESCLI
'fraziobo->CONNESOPER
'fraziobo->DATAOPE
'fraziobo->DATAREG
'Date()
'fraziobo->DESC2
'fraziobo->DESCCIT
'fraziobo->DESCINTER
'fraziobo->DOCFILE
'fraziobo->FLAGCONT
'fraziobo->FLAGFRAZ
'fraziobo->FLAGLIRE
'fraziobo->FLAGRAP
'_flagrap2
'cNewProg
'fraziobo->idcauana
'fraziobo->IDEREG
'fraziobo->INFORM
'fraziobo->MODSVOL
'fraziobo->NATURA
'fraziobo->NOPROT
'fraziobo->NUMPROG
'fraziobo->OPERAG
'fraziobo->OPERATORE
'fraziobo->OPERAZMOD
'fraziobo->OPRAP
'fraziobo->PAESE
'fraziobo->PRGIMPFRZ
'fraziobo->PROV2
'fraziobo->PROVINCIA
'fraziobo->RAGIO
'fraziobo->RAPPORTBEN
'fraziobo->RAPPORTO
'fraziobo->RAREA
'fraziobo->RCOMP
'fraziobo->RESPINS
'fraziobo->RFREQ
'fraziobo->RIFIMP
'fraziobo->RIMP
'fraziobo->RRAGIO
'fraziobo->RTIPO
'fraziobo->SCOPO
'fraziobo->SEGNO
''3'
'fraziobo->TIPO
'fraziobo->TIPOINF
'fraziobo->TIPOINT2
'fraziobo->TIPOINTER
'fraziobo->TIPOLEG
'fraziobo->TIPOOPRAP
'fraziobo->TOTCONT
'fraziobo->TOTLIRE
'fraziobo->UCODE
'fraziobo->UNIQUECODE
'fraziobo->VALUTA
'fraziobo->ZCPARTE
'fraziobo->CONNALTRO
'fraziobo->CONNESDOC
'fraziobo->C_RAG
'fraziobo->C_STA
'fraziobo->C_CTA
'fraziobo->C_CAB
'fraziobo->C_PRV
'fraziobo->C_IND
'fraziobo->C_CAP
'fraziobo->DATAIMP
'fraziobo->C_RAPPORTO
'fraziobo->PAGASOGOP
'fraziobo->MTCN
'fraziobo->IDFILE
'fraziobo->CDATREG
'fraziobo->IPCOLLEG
'fraziobo->ORACOLLEG
'fraziobo->DUCOLLEG
'fraziobo->ANNOOPE
]
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=30
prev=O4813
var_op='asgn
I
obj='Var
pag=30
prev=O4812
var_op='asgn
I
obj='Var
pag=30
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=30
sel_field='operazbo->IDBASE
sel_name='operazbo
sel_where='operazbo->CONNESCLI=xConnes or operazbo->CONNESOPER=xConnes or operazbo->CONNESBEN=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4806
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",Space(10),10)
len=10
name='cNewProg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='operazbo->IDBASE
len=10
name='_idbase
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=30
prev=O4837
sel_field='*
sel_name='operazbo
sel_where='operazbo->IDBASE=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4838
fatherSonIndex=0
frm_calc='iif(Empty(operazbo->FLAGRAP2),Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(operazbo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPInsert
arch='operazbo
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(operazbo->DATAOPE)+"O"+LibreriaMit.UniqueId()+"X"
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=30
prev=O4844
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_idbase
]
wr_field=[
'OPERAZMOD
'STATOREG
'DATARETT
'IDEREG
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'operazbo->IDEREG
''1'
'Date()
'_idreg
]
I
obj='Var
pag=30
prev=O4843
var_op='asgn
I
obj='Insert
pag=30
prev=O4842
rd_kfield=[
'AMMONT
'AREAGEO
'AUTOM
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESDOC
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'IDFILE
'INFORM
'IPCOLLEG
'MODSVOL
'MTCN
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
'ANNOOPE
]
rd_kvar=[
'operazbo->AMMONT
'operazbo->AREAGEO
'operazbo->AUTOM
'operazbo->C_CAB
'operazbo->C_CAP
'operazbo->C_CTA
'operazbo->C_IND
'operazbo->C_PRV
'operazbo->C_RAG
'operazbo->C_RAPPORTO
'operazbo->C_STA
'operazbo->CAMBIO
'operazbo->CDATAOPE
'operazbo->CDATOPE
'operazbo->CDATREG
'operazbo->CODANA
'operazbo->CODCAB
'operazbo->CODCAB2
'operazbo->CODDIPE
'operazbo->CODINT2
'operazbo->CODINTER
'operazbo->CODVOC
'operazbo->COLLEG
'operazbo->CONNALTRO
'operazbo->CONNESBEN
'operazbo->CONNESCLI
'operazbo->CONNESDOC
'operazbo->CONNESOPER
'operazbo->DATAIMP
'operazbo->DATAOPE
'operazbo->DATAREG
'Date()
'operazbo->DESC2
'operazbo->DESCCIT
'operazbo->DESCINTER
'operazbo->DOCFILE
'operazbo->DUCOLLEG
'operazbo->DURAT
'operazbo->FLAGCONT
'operazbo->FLAGFRAZ
'operazbo->FLAGLIRE
'operazbo->FLAGRAP
'_flagrap2
'cNewProg
'operazbo->idcauana
'operazbo->IDEREG
'operazbo->IDFILE
'operazbo->INFORM
'operazbo->IPCOLLEG
'operazbo->MODSVOL
'operazbo->MTCN
'operazbo->NATURA
'operazbo->NOPROT
'operazbo->NUMPROG
'operazbo->OPERAG
'operazbo->OPERATORE
'operazbo->OPERAZMOD
'operazbo->OPRAP
'operazbo->ORACOLLEG
'operazbo->PAESE
'operazbo->PAGASOGOP
'operazbo->PRGIMPOPE
'operazbo->PROV2
'operazbo->PROVINCIA
'operazbo->RAGIO
'operazbo->RAPPORTBEN
'operazbo->RAPPORTO
'operazbo->RAREA
'operazbo->RCOMP
'operazbo->RESPINS
'operazbo->RFREQ
'operazbo->RIFIMP
'operazbo->RIMP
'operazbo->RRAGIO
'operazbo->RTIPO
'operazbo->SCOPO
'operazbo->SEGNO
''3'
'operazbo->TIPO
'operazbo->TIPOINF
'operazbo->TIPOINT2
'operazbo->TIPOINTER
'operazbo->TIPOLEG
'operazbo->TIPOOPRAP
'operazbo->TOTCONT
'operazbo->TOTLIRE
'operazbo->UCODE
'operazbo->UNIQUECODE
'operazbo->VALUTA
'operazbo->ZCPARTE
'operazbo->ANNOOPE
]
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=30
prev=O4836
var_op='asgn
I
obj='Var
pag=30
prev=O4835
var_op='asgn
I
obj='Var
pag=30
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=30
prev=O4791
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4793
fatherSonIndex=0
frm_calc=[
'LRTrim(xRiga3) <> LRTrim(xRiga4)
]
h=[
19
19
]
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4860
fatherSonIndex=0
frm_calc='xCFE
len=1
name='_newest
next=Icpitembatch.CPExec
check='page
frm_calc='31
obj='Exec
pag=30
prev=O4865
I
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=30
prev=O4790
rd_kfield=[
'ALLINEATO
'ALLINEATONOMECNOME
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODDIPE
'CODFISC
'CODINTER
'COGNOME
'COMPORT
'CONNES
'datamodi
'DATANASC
'DATARILASC
'DATASEGN
'DATAVALI
'DATEXTRA
'DESCCIT
'DOCFILE
'DOMICILIO
'idcitta
'IDFILE
'MACROAGENTE
'NASCOMUN
'NASSTATO
'NOME
'NOTE
'NUMDOCUM
'OLDCODFISC
'OLDCONNES
'OLDSETSIN
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROGIMP_C
'PROGIMPORT
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'sanumpro
'SESSO
'SETTSINT
'SOSPMAF
'SOTGRUP
'SPOTID
'TIPINTER
'TIPODOC
'TIPOPERS
]
rd_kvar=[
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->AREAGEO
'personbo->ATTIV
'personbo->AUTRILASC
'personbo->CAP
'personbo->CFESTERO
'personbo->CODCAB
'personbo->CODDIPE
'personbo->CODFISC
'personbo->CODINTER
'personbo->COGNOME
'personbo->COMPORT
'xConnes
'_datarett
'personbo->DATANASC
'personbo->DATARILASC
'personbo->DATASEGN
'personbo->DATAVALI
'personbo->DATEXTRA
'personbo->DESCCIT
'personbo->DOCFILE
'personbo->DOMICILIO
'personbo->idcitta
'personbo->IDFILE
'personbo->MACROAGENTE
'personbo->NASCOMUN
'personbo->NASSTATO
'personbo->NOME
'personbo->NOTE
'personbo->NUMDOCUM
'personbo->OLDCODFISC
'personbo->OLDCONNES
'personbo->OLDSETSIN
'personbo->PAESE
'personbo->PARTIVA
'personbo->PEP
'personbo->PKTBSPECIE
'personbo->PROGIMP_C
'personbo->PROGIMPORT
'personbo->PROVINCIA
'personbo->RAGSOC
'personbo->RAGSOCOLD
'personbo->RAMOGRUP
'personbo->RAREA
'personbo->RATTIV
'personbo->RCOMP
'personbo->RNATGIU
'cProgSto
'personbo->SESSO
'personbo->SETTSINT
'personbo->SOSPMAF
'personbo->SOTGRUP
'personbo->SPOTID
'personbo->TIPINTER
'personbo->TIPODOC
'personbo->TIPOPERS
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4791
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
frm_calc='m_cLastMsgError = ""
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=30
prev=O4875
I
obj='Exec
pag=30
prev=O4874
I
obj='Var
obj_type='N
pag=30
prev=O4873
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=30
pagelocal=True
prev=O4789
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O4788
var_op='asgn
I
obj='Remark
pag=30
I
I
]
w=[
150
150
]
I
obj='Select
pag=30
prev=O4780
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=xConnes and wersonbo->datamodi=_datarett
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4781
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='D
pag=30
prev=O4779
var_op='asgn
I
obj='Var
pag=30
prev=O4778
var_op='asgn
I
obj='Remark
pag=30
I
I
]
w=[
150
150
]
I
obj='Remark
pag=30
prev=O4771
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4770
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4769
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4768
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4767
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4766
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4765
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4764
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4763
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4762
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4761
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4760
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4759
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4758
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4757
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4756
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4755
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4754
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4753
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4752
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4751
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4750
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4749
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4748
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4747
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4746
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4745
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4744
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=30
prev=O4697
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4696
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4695
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4694
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4693
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4692
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4691
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=30
prev=O4667
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4668
fatherSonIndex=0
frm_calc='Substr(riga,136,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=30
prev=O4888
var_op='asgn
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=30
prev=O4666
var_op='asgn
I
obj='Var
pag=30
prev=O4663
var_op='asgn
I
obj='If
pag=30
prev=O4662
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4663
fatherSonIndex=0
frm_calc='Substr(riga,230,30)
len=30
name='xCitta
next=Icpitembatch.CPRead
arch='tbcitta
obj='Read
pag=30
prev=O4893
rd_field=[
'CAB
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'xCitta
]
rd_var=[
'xCodCab
]
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=30
prev=O4659
var_op='asgn
I
obj='If
pag=30
prev=O4658
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4659
fatherSonIndex=0
frm_calc='iif(LRTrim(Substr(riga,458,1))='1',1,0)
len=1
name='xCFE
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4659
fatherSonIndex=1
frm_calc='iif(LRTrim(Substr(riga,458,1))='S',1,0)
len=1
name='xCFE
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=30
prev=O4657
var_op='asgn
I
obj='Var
pag=30
prev=O4656
var_op='asgn
I
obj='Read
pag=30
prev=O4655
rd_field=[
'CONNES
'CFESTERO
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'cCli1
]
rd_var=[
'xConnes
'_oldest
]
I
obj='Var
obj_type='N
pag=30
prev=O4654
var_op='asgn
I
obj='Remark
pag=30
prev=O4653
I
obj='Var
pag=30
prev=O4652
var_op='asgn
I
obj='Var
pag=30
prev=O4651
var_op='asgn
I
obj='Var
pag=30
prev=O4650
var_op='asgn
I
obj='Var
pag=30
prev=O4649
var_op='asgn
I
obj='Var
pag=30
prev=O4648
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O4647
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O4646
var_op='asgn
I
obj='Var
pag=30
prev=O4645
var_op='asgn
I
obj='Var
obj_type='D
pag=30
prev=O4644
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4643
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4642
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4641
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4638
var_op='asgn
I
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4638
fatherSonIndex=0
frm_calc='Substr(riga,112,16)
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,496,16)
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xConnes)
]
h=[
19
19
]
obj='If
pag=30
prev=O4914
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4915
fatherSonIndex=0
frm_calc=[
'Empty(_conadd)
]
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='personbo
obj='Insert
pag=30
prev=O4920
rd_kfield=[
'CONNES
]
rd_kvar=[
'_conadd
]
I
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O4920
fatherSonIndex=0
frm_calc='System.out.println('Riga '+Str(conta+1,10,0)+" - Codice "+_conadd)
obj='Exec
pag=30
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=30
prev=O4913
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'_conadd
]
rd_var=[
'xConnes
]
I
obj='Var
pag=30
prev=O4912
var_op='asgn
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=30
prev=O4607
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
rd_var=[
'nProgSto
]
I
obj='Read
pag=30
prev=O4606
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
rd_var=[
'nProgImp
]
I
obj='Var
obj_type='N
pag=30
prev=O4605
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O4604
var_op='asgn
I
obj='Var
pag=30
prev=O4603
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O4602
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O4601
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O4600
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O4599
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O4598
var_op='asgn
I
obj='Var
pag=30
pagelocal=True
prev=O4597
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4596
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4595
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4594
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O4593
I
obj='Var
pag=30
pagelocal=True
x=9
y=5
I
Icpitembatch.CPRemark
frm_calc='Inserisce priorità sui nomi file
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=27
prev=O4946
sel_name='tmp_list_imprich
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O4947
fatherSonIndex=0
frm_calc=[
'At('archdip.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('archpers.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('archrap.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('archinf.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('archope.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('archfraz.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('opex.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('archtito.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('procdel.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('sogope.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('intest.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('stopers.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('persnew.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('rapage.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('infage.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('intage.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('opeage.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('procage.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('sogcli.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('sogben.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('sogaltro.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('saldopex.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0 or At('saldopex.xls',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('saldrapp.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0 or At('saldrapp.xls',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('titosupp.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
]
h=[
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
]
next=Icpitembatch.CPWrite
arch='tmp_list_imprich
obj='Write
pag=27
prev=O4951
rd_kfield=[
'nomefile
]
rd_kop=[
'=
]
rd_kvar=[
'tmp_list_imprich->nomefile
]
wr_field=[
'priorita
]
wr_op=[
'=
]
wr_var=[
'_priorita
]
I
obj='Case
pag=27
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4951
fatherSonIndex=0
frm_calc='1
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4951
fatherSonIndex=1
frm_calc='2
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4951
fatherSonIndex=2
frm_calc='5
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4951
fatherSonIndex=3
frm_calc='6
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4951
fatherSonIndex=4
frm_calc='7
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4951
fatherSonIndex=5
frm_calc='8
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4951
fatherSonIndex=6
frm_calc='9
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4951
fatherSonIndex=7
frm_calc='10
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4951
fatherSonIndex=8
frm_calc='11
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4951
fatherSonIndex=9
frm_calc='12
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4951
fatherSonIndex=10
frm_calc='13
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4951
fatherSonIndex=11
frm_calc='3
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4951
fatherSonIndex=12
frm_calc='4
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4951
fatherSonIndex=13
frm_calc='14
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4951
fatherSonIndex=14
frm_calc='15
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4951
fatherSonIndex=15
frm_calc='16
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4951
fatherSonIndex=16
frm_calc='17
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4951
fatherSonIndex=17
frm_calc='18
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4951
fatherSonIndex=18
frm_calc='19
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4951
fatherSonIndex=19
frm_calc='20
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4951
fatherSonIndex=20
frm_calc='21
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4951
fatherSonIndex=21
frm_calc='22
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4951
fatherSonIndex=22
frm_calc='23
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4951
fatherSonIndex=23
frm_calc='24
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
]
w=[
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=27
x=18
y=21
I
Icpitembatch.CPBeginEnd
comment='Definizione variabili locali
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Aggiorna le righe
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=31
prev=O5014
sel_field='*
sel_name='aeoprig
sel_where='aeoprig->CONNESINT=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5015
fatherSonIndex=0
frm_calc=[
'Year(aeoprig->ADATA) = w_annorif or w_annorif=0
]
h=[
19
19
]
obj='If
pag=31
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5019
fatherSonIndex=0
frm_calc=[
'_oldest = _newest
]
h=[
19
19
19
]
haselse=True
obj='If
pag=31
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5024
fatherSonIndex=0
frm_calc=[
'not(Empty(aeoprig->APROG))
]
h=[
19
19
]
obj='If
pag=31
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5029
fatherSonIndex=0
frm_calc='''
len=10
name='_opep
next=Icpitembatch.CPRead
arch='aeopcanc
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_opep))
]
h=[
19
19
]
obj='If
pag=31
prev=O5035
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5036
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOAGE\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProg
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='cIDBase
next=Icpitembatch.CPInsert
arch='aeopstor
next=Icpitembatch.CPWrite
arch='aeoprig
obj='Write
pag=31
prev=O5043
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'aeoprig->IDBASE
]
wr_field=[
'AOLDPROG
'AOLDFILE
'ADATARET
'RSPEDITO
'COLDPROG
'COLDFILE
]
wr_op=[
'=
'=
'=
'=
'=
'=
]
wr_var=[
'aeoprig->APROG
'aeoprig->AFILE
'Date()
'0
'''
'''
]
I
obj='Insert
pag=31
prev=O5042
rd_kfield=[
'PROGRES
'IDBASE
'RAPPORTO
'CONNESINT
'ASPEDITO
'ADATA
'APROG
'AOLDPROG
'AFILE
'AOLDFILE
'ADATARET
'CSPEDITO
'CDATA
'CPROG
'COLDPROG
'CFILE
'COLDFILE
'CDATARET
'IDRIF
'NOCODFISC
'ADTPRE
'CDTPRE
'TIPOAG
'COINT
'PROGOPX
'ABBINATO
'IDESITO
'DATESITO
'RSPEDITO
'SALDO
'QUANTITA
'VALUTA
'ANNO
'PROG1
'PROG2
'ESITOANNO
'UNIQUECODE
'PROGREC
'PROGBASE
'FILEANNO
'ABBSALDI
'OLDINTER
'ANNOOPE
]
rd_kvar=[
'cProg
'aeoprig->IDBASE
'aeoprig->RAPPORTO
'aeoprig->CONNESINT
'aeoprig->ASPEDITO
'aeoprig->ADATA
'aeoprig->APROG
'aeoprig->AOLDPROG
'aeoprig->AFILE
'aeoprig->AOLDFILE
'aeoprig->ADATARET
'aeoprig->CSPEDITO
'aeoprig->CDATA
'aeoprig->CPROG
'aeoprig->COLDPROG
'aeoprig->CFILE
'aeoprig->COLDFILE
'aeoprig->CDATARET
'aeoprig->IDRIF
'aeoprig->NOCODFISC
'aeoprig->ADTPRE
'aeoprig->CDTPRE
'aeoprig->TIPOAG
'aeoprig->COINT
'aeoprig->PROGOPX
'aeoprig->ABBINATO
'aeoprig->IDESITO
'aeoprig->DATESITO
'aeoprig->RSPEDITO
'aeoprig->SALDO
'aeoprig->QUANTITA
'aeoprig->VALUTA
'aeoprig->ANNO
'aeoprig->PROG1
'aeoprig->PROG2
'aeoprig->ESITOANNO
'aeoprig->UNIQUECODE
'aeoprig->PROGREC
'aeoprig->PROGBASE
'aeoprig->FILEANNO
'aeoprig->ABBSALDI
'aeoprig->OLDINTER
'aeoprig->ANNOOPE
]
I
obj='Var
pag=31
pagelocal=True
prev=O5041
var_op='asgn
I
obj='Var
pag=31
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=31
prev=O5034
rd_field=[
'PROGRES
]
rd_kfield=[
'IDBASE
]
rd_kvar=[
'aeoprig->IDBASE
]
rd_var=[
'_opep
]
I
obj='Var
pag=31
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5024
fatherSonIndex=1
frm_calc=[
'aeoprig->ASPEDITO=0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=31
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aeoprig
father=O5060
fatherSonIndex=0
obj='Write
pag=31
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'aeoprig->IDBASE
]
wr_field=[
'NOCODFISC
]
wr_op=[
'=
]
wr_var=[
'iif(_newest=1,'S','N')
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5060
fatherSonIndex=1
frm_calc='''
len=10
name='_opep
next=Icpitembatch.CPRead
arch='aeopcanc
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_opep)
]
h=[
19
19
]
obj='If
pag=31
prev=O5074
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5075
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOAGE\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProg
next=Icpitembatch.CPInsert
arch='aeopstor
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PDELAGE\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cCanc
next=Icpitembatch.CPInsert
arch='aeopcanc
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGAEOPEXTR\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='_prog
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGAED\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aeoprig
next=Icpitembatch.CPWrite
arch='opextrbo
obj='Write
pag=31
prev=O5086
rd_kfield=[
'COLLEG
'DATAOPE
]
rd_kop=[
'=
'=
]
rd_kvar=[
'aeoprig->CONNESINT
'aeoprig->ADATA
]
wr_field=[
'NUMPROG1
]
wr_op=[
'=
]
wr_var=[
'_prog
]
I
obj='Insert
pag=31
prev=O5085
rd_kfield=[
'IDBASE
'CONNESINT
'ADATA
'TIPOAG
'COINT
'PROGOPX
'NOCODFISC
'ANNOOPE
]
rd_kvar=[
'_prog
'aeoprig->CONNESINT
'aeoprig->ADATA
'aeoprig->TIPOAG
'aeoprig->COINT
'nProgImp
'iif(_newest=1,'S','N')
'Year(aeoprig->ADATA)
]
I
obj='Var
obj_type='N
pag=31
prev=O5084
var_op='asgn
I
obj='Var
pag=31
pagelocal=True
prev=O5083
var_op='asgn
I
obj='Insert
pag=31
prev=O5082
rd_kfield=[
'ADATA
'ADATARET
'AFILE
'APROG
'ASPEDITO
'CDATA
'CDATARET
'CFILE
'COLDPROG
'COINT
'COLDFILE
'CONNESINT
'CPROG
'CSPEDITO
'DATARIF
'IDBASE
'IDRIF
'NOCODFISC
'PROGRES
'RAPPORTO
'RIFSTOR
'TIPOAG
'TIPOCAN
]
rd_kvar=[
'aeoprig->ADATA
'Date()
'aeoprig->AFILE
'aeoprig->APROG
'aeoprig->ASPEDITO
'aeoprig->CDATA
'aeoprig->CDATARET
'aeoprig->CFILE
'aeoprig->COLDPROG
'aeoprig->COINT
'aeoprig->COLDFILE
'aeoprig->CONNESINT
'aeoprig->CPROG
'aeoprig->CSPEDITO
'Date()
'aeoprig->IDBASE
'aeoprig->IDRIF
'aeoprig->NOCODFISC
'cCanc
'aeoprig->RAPPORTO
'cProg
'aeoprig->TIPOAG
''C'
]
I
obj='Var
pag=31
pagelocal=True
prev=O5081
var_op='asgn
I
obj='Insert
pag=31
prev=O5080
rd_kfield=[
'PROGRES
'IDBASE
'RAPPORTO
'CONNESINT
'ASPEDITO
'ADATA
'APROG
'AOLDPROG
'AFILE
'AOLDFILE
'ADATARET
'CSPEDITO
'CDATA
'CPROG
'COLDPROG
'CFILE
'COLDFILE
'CDATARET
'IDRIF
'NOCODFISC
'ADTPRE
'CDTPRE
'TIPOAG
'COINT
'PROGOPX
'ABBINATO
'IDESITO
'DATESITO
'RSPEDITO
'SALDO
'QUANTITA
'VALUTA
'ANNO
'PROG1
'PROG2
'ESITOANNO
'UNIQUECODE
'PROGREC
'PROGBASE
'FILEANNO
'ABBSALDI
'OLDINTER
'ANNOOPE
]
rd_kvar=[
'cProg
'aeoprig->IDBASE
'aeoprig->RAPPORTO
'aeoprig->CONNESINT
'aeoprig->ASPEDITO
'aeoprig->ADATA
'aeoprig->APROG
'aeoprig->AOLDPROG
'aeoprig->AFILE
'aeoprig->AOLDFILE
'aeoprig->ADATARET
'aeoprig->CSPEDITO
'aeoprig->CDATA
'aeoprig->CPROG
'aeoprig->COLDPROG
'aeoprig->CFILE
'aeoprig->COLDFILE
'aeoprig->CDATARET
'aeoprig->IDRIF
'aeoprig->NOCODFISC
'aeoprig->ADTPRE
'aeoprig->CDTPRE
'aeoprig->TIPOAG
'aeoprig->COINT
'aeoprig->PROGOPX
'aeoprig->ABBINATO
'aeoprig->IDESITO
'aeoprig->DATESITO
'aeoprig->RSPEDITO
'aeoprig->SALDO
'aeoprig->QUANTITA
'aeoprig->VALUTA
'aeoprig->ANNO
'aeoprig->PROG1
'aeoprig->PROG2
'aeoprig->ESITOANNO
'aeoprig->UNIQUECODE
'aeoprig->PROGREC
'aeoprig->PROGBASE
'aeoprig->FILEANNO
'aeoprig->ABBSALDI
'aeoprig->OLDINTER
'aeoprig->ANNOOPE
]
I
obj='Var
pag=31
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=31
prev=O5073
rd_field=[
'PROGRES
]
rd_kfield=[
'AFILE
'APROG
]
rd_kvar=[
'aeoprig->AFILE
'aeoprig->APROG
]
rd_var=[
'_opep
]
I
obj='Var
pag=31
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=31
prev=O5012
I
obj='Begin
pag=31
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5012
fatherSonIndex=0
len=10
name='cProg
next=Icpitembatch.CPVarDecl
len=10
name='cIDBase
next=Icpitembatch.CPVarDecl
len=10
name='_opep
next=Icpitembatch.CPVarDecl
len=10
name='cCanc
next=Icpitembatch.CPVarDecl
len=10
name='_prog
obj='Var
pag=31
pagelocal=True
prev=O5114
I
obj='Var
pag=31
pagelocal=True
prev=O5113
I
obj='Var
pag=31
pagelocal=True
prev=O5112
I
obj='Var
pag=31
pagelocal=True
prev=O5111
I
obj='Var
pag=31
pagelocal=True
I
I
]
w=[
150
150
]
x=9
y=17
I
Icpitembatch.CPBeginEnd
comment='Definizine variabili locali
h=[
19
19
]
next=Icpitembatch.CPDropTemporaryTable
next=Icpitembatch.CPServerTemporaryTable
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=32
prev=O5120
sel_field='*
sel_name='tmp_list_imprich
sel_order='tmp_list_imprich->priorita,tmp_list_imprich->nomefile
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5121
fatherSonIndex=0
frm_calc='LRTrim(tmp_list_imprich->nomefile)
len=50
name='nomefileimport
next=Icpitembatch.CPIfElse
frm_calc=[
'At('archpers.txt',Lower(nomefileimport)) <> 0 or At('persnew.txt',Lower(nomefileimport)) <> 0 or At('stopers.txt',Lower(nomefileimport)) <> 0
]
h=[
19
19
]
obj='If
pag=32
prev=O5125
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5126
fatherSonIndex=0
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
obj='Exec
pag=32
prev=O5133
I
obj='While
pag=32
prev=O5132
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5133
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=32
prev=O5139
var_op='asgn
I
obj='If
pag=32
prev=O5138
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5139
fatherSonIndex=0
frm_calc='''
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='''
len=128
name='_testata
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_ferr
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati controllati '+LRTrim(Str(conta,10,0))+' nominativi del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='"Codice: "+ LRTrim(Substr(riga,112,16)) + " - Soggetto "+LRTrim(Upper(Substr(riga,7,70)))
len=128
name='_testata
next=Icpitembatch.CPBeginEnd
comment='Effettua Controlli
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_ferr = 1
]
h=[
19
19
]
obj='If
pag=32
prev=O5150
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5152
fatherSonIndex=0
frm_calc='1
len=1
name='_chkerr
next=Icpitembatch.CPInsert
arch='tmp_errimp
obj='Insert
pag=32
prev=O5157
rd_kfield=[
'nomearch
'numriga
'errore
'txtini
]
rd_kvar=[
'LRTrim(nomefileimport)
'conta
'_listaerr
'_testata
]
I
obj='Var
obj_type='N
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=32
prev=O5149
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5150
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Upper(Substr(riga,7,70))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,112,16)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,262,3)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(Substr(riga,262,3)) = '086' or Empty(LRTrim(Substr(riga,262,3)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,166,3)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,172,3)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'At("archpers.txt",Lower(nomefileimport)) <> 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,460,10))) and not(Empty(LRTrim(Substr(riga,166,3))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,288,1)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=32
prev=O5185
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5188
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Substr(riga,136,30)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,128,8)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,175,2)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,177,15)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,192,8)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,200,30)))
]
h=[
19
19
]
obj='If
pag=32
prev=O5205
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5208
fatherSonIndex=0
frm_calc='_listaerr + "non è presente l'autorità di rilascio del documento" + NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5213
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O5202
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5205
fatherSonIndex=0
frm_calc='_listaerr + "non è presente la data rilascio del documento"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5218
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O5199
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5202
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il numero documento" + NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5223
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O5196
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5199
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il tipo di documento"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5228
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O5193
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5196
fatherSonIndex=0
frm_calc='_listaerr + "non è presente la data di nascita"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5233
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5193
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il luogo di nascita"
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5238
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5188
fatherSonIndex=1
frm_calc=[
'not(Empty(LRTrim(Substr(riga,136,30))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,128,8))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,175,2))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,177,15))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,192,8))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,200,30))))
]
h=[
19
19
]
obj='If
pag=32
prev=O5254
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5257
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente l'autorità di rilascio del documento" + NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5262
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O5251
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5254
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente la data rilascio del documento"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5267
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O5248
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5251
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente il numero documento" + NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5272
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O5245
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5248
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente il tipo di documento"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5277
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O5242
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5245
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente la data di nascita"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5282
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5242
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente il luogo di nascita"
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5287
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=32
prev=O5182
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5185
fatherSonIndex=0
frm_calc='''
len=1
name='_tiposot
next=Icpitembatch.CPRead
arch='tbstgru
next=Icpitembatch.CPIfElse
frm_calc=[
'_tiposot='1'
]
h=[
19
19
]
obj='If
pag=32
prev=O5294
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5295
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice ATECO"
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5300
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=32
prev=O5293
rd_field=[
'TIPOSOT
]
rd_kfield=[
'SOTGRU
]
rd_kvar=[
'Substr(riga,166,3)
]
rd_var=[
'_tiposot
]
I
obj='Var
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O5179
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5182
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Substr(riga,460,10))) and Empty(LRTrim(Substr(riga,288,1)))
]
h=[
19
19
]
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5310
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice Ateco"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5315
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5182
fatherSonIndex=1
frm_calc=[
'Empty(LRTrim(Substr(riga,468,10))) and Empty(LRTrim(Substr(riga,288,1)))
]
h=[
19
19
]
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5319
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice Ateco"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5324
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=32
prev=O5176
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5179
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice Settorizzazione sintetica"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5330
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O5173
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5176
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice SAE"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5335
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O5170
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5173
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Substr(riga,1,6))) and Empty(LRTrim(Substr(riga,230,30)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,230,30)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,260,2)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,77,35)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,265,9)))
]
h=[
19
19
]
obj='If
pag=32
prev=O5349
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5352
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il cap di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5357
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O5346
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5349
fatherSonIndex=0
frm_calc='_listaerr + "non è presente l'indirizzo di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5362
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O5343
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5346
fatherSonIndex=0
frm_calc='_listaerr + "non è presente la provincia di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5367
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O5340
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5343
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il comune di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5372
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5340
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice CAB (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5377
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O5167
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O5170
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice stato di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5383
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O5164
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O5167
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice fiscale (ASSOLUTAMENTE OBBLIGATORIO)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5388
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O5164
fatherSonIndex=0
frm_calc='_listaerr + " non è presente la ragione sociale (ASSOLUTAMENTE OBBLIGATORIO)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5393
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=32
pagelocal=True
prev=O5148
var_op='asgn
I
nonlocal=True
obj='Var
pag=32
prev=O5147
var_op='asgn
I
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5146
var_op='asgn
I
obj='Var
pag=32
pagelocal=True
prev=O5145
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=32
prev=O5131
var_op='asgn
I
obj='Var
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='TempTable
pag=32
prev=O5119
sel_type='def
server_table='tmp_errimp
I
obj='DropTempTable
pag=32
prev=O5117
server_table='tmp_errimp
I
obj='Begin
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5117
fatherSonIndex=0
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
len=128
name='_testata
next=Icpitembatch.CPVarDecl
len=1
name='_ferr
next=Icpitembatch.CPVarDecl
len=1
name='_tiposot
obj='Var
pag=32
pagelocal=True
prev=O5405
I
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O5404
I
obj='Var
pag=32
pagelocal=True
prev=O5403
I
obj='Var
obj_type='M
pag=32
pagelocal=True
I
I
]
w=[
150
150
]
x=17
y=18
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'Lower(LRTrim(nomefileimport))='saldopex.txt'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Saldi operazioni extraconto Inseriti: '+LRTrim(Str(cNumNew,10,0))  +  NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Saldi operazioni extraconto Aggiornati: '+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O5417
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O5416
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O5415
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O5412
var_op='asgn
I
obj='If
pag=33
prev=O5411
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5412
fatherSonIndex=0
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
obj='Exec
pag=33
prev=O5424
I
obj='Exec
pag=33
prev=O5422
I
obj='While
pag=33
prev=O5421
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5422
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record dei saldi opex del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=33
prev=O5432
var_op='asgn
I
nonlocal=True
obj='Var
pag=33
prev=O5429
var_op='asgn
I
obj='If
pag=33
prev=O5428
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5429
fatherSonIndex=0
frm_calc='Substr(riga,1,16)
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Val(Substr(riga,21,17))=0 and Val(Substr(riga,38,6))=0 and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Val(Substr(riga,21,17))=0 and Val(Substr(riga,38,6)) <> 0 and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Val(Substr(riga,21,17))<>0 and Val(Substr(riga,38,6))=0 and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub = 1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=33
prev=O5453
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O5456
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=33
prev=O5461
var_op='asgn
I
obj='Write
pag=33
rd_kfield=[
'COLLEG
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,16)
'Substr(riga,17,4)
]
wr_field=[
'SALDO
'QUANTITA
'VALUTA
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Val(Substr(riga,21,17))
'Val(Substr(riga,38,6))
'iif(Empty(LRTrim(Substr(riga,44,3))),'242',Substr(riga,44,3))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5456
fatherSonIndex=1
frm_calc='1
len=1
name='_soxerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(shand,riga+" - "+_descerr)
obj='Exec
pag=33
prev=O5470
I
obj='Var
obj_type='N
pag=33
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=33
prev=O5450
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5453
fatherSonIndex=0
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPRead
arch='opextrbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
]
obj='If
pag=33
prev=O5476
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5477
fatherSonIndex=0
frm_calc='"Assente operazione extraconto per l'anno indicato"
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O5482
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=33
prev=O5475
rd_field=[
'IDBASE
]
rd_kfield=[
'COLLEG
'ANNO
]
rd_kvar=[
'cCli1
'Substr(riga,17,4)
]
rd_var=[
'xIDB
]
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=33
prev=O5447
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5450
fatherSonIndex=0
frm_calc=''Numero Operazioni non valorizzato'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O5492
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=33
prev=O5444
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5447
fatherSonIndex=0
frm_calc=''Saldo non valorizzato'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O5497
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=33
prev=O5441
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5444
fatherSonIndex=0
frm_calc=''Saldo e Numero operazioni entrambi non valorizzati'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O5502
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=33
prev=O5440
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5441
fatherSonIndex=0
frm_calc=''Anagrafica soggetto non presente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O5507
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=33
prev=O5439
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,1,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=33
prev=O5438
var_op='asgn
I
obj='Var
pag=33
prev=O5437
var_op='asgn
I
obj='Var
obj_type='N
pag=33
prev=O5436
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=33
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPBeginEnd
comment='Apro il foglio e verifico quante pagine ha
father=O5412
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='_i = 0
next=Icpitembatch.CPWhile
frm_calc='_i < _conta
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='workbook.close()
obj='Exec
pag=33
prev=O5520
I
obj='While
pag=33
prev=O5519
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O5520
fatherSonIndex=0
frm_calc="_righe = 0;
Sheet sheet = workbook.getSheet(_i);
_righe = sheet.getRows();
_y = 1;
°--°
next=Icpitembatch.CPWhile
frm_calc='_y < _righe
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=33
prev=O5526
I
obj='While
pag=33
prev=O5525
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Legge le colonne e scrive i dati nelle variabili appoggio
father=O5526
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column06)))
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_y++;
obj='Exec
pag=33
prev=O5533
I
obj='If
pag=33
prev=O5531
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O5533
fatherSonIndex=0
frm_calc=''Elaborazione Foglio N.'+LRTrim(Str(_i+1,2,0))+' - Riga N. '+LRTrim(Str(_y+1,7,0))+' - Rapporto N. : '+LRTrim(column01)
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPRead
arch='opextrbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record dei saldi opex del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=33
prev=O5545
var_op='asgn
I
nonlocal=True
obj='Var
pag=33
prev=O5542
var_op='asgn
I
obj='If
pag=33
prev=O5541
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O5542
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGOPEX\'"+LRTrim(gAzienda)+"'",0,10)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='opextrbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=33
prev=O5551
var_op='asgn
I
obj='Insert
pag=33
prev=O5550
rd_kfield=[
'COLLEG
'ANNO
'IDBASE
'SALDO
'QUANTITA
'VALUTA
'PROGOPEX
]
rd_kvar=[
'Left(LRTrim(column01),16)
'Left(LRTrim(column02),4)
'xIDB
'Val(LRTrim(column03))
'Val(LRTrim(column04))
'iif(Empty(LRTrim(column05)),'242',Left(LRTrim(column05),3))
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5551
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,1,16)+" per l'operazione extraconto in data: "+Substr(riga,21,8)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=33
prev=O5560
I
obj='Var
obj_type='N
pag=33
prev=O5559
var_op='asgn
I
obj='Exec
pag=33
prev=O5558
I
nonlocal=True
obj='Var
obj_type='M
pag=33
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=33
prev=O5549
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O5542
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=33
prev=O5564
var_op='asgn
I
obj='Write
pag=33
rd_kfield=[
'COLLEG
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(LRTrim(column01),16)
'Left(LRTrim(column02),4)
]
wr_field=[
'SALDO
'QUANTITA
'VALUTA
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Val(LRTrim(column03))
'Val(LRTrim(column04))
'iif(Empty(LRTrim(column05)),'242',Left(LRTrim(column05),3))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=33
prev=O5540
rd_field=[
'IDBASE
]
rd_kfield=[
'COLLEG
'ANNO
]
rd_kvar=[
'Left(LRTrim(column01),16)
'Left(LRTrim(column02),4)
]
rd_var=[
'xIDB
]
I
obj='Var
pag=33
prev=O5539
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=33
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O5531
fatherSonIndex=0
frm_calc="// Legge il contenuto delle celle
Cell a01 = sheet.getCell(0,_y);
Cell a02 = sheet.getCell(1,_y);
Cell a03 = sheet.getCell(2,_y);
Cell a04 = sheet.getCell(3,_y);
Cell a05 = sheet.getCell(4,_y);
Cell a06 = sheet.getCell(5,_y);
°--°
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
obj='Begin
pag=33
prev=O5580
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5581
fatherSonIndex=0
frm_calc='a01.getContents()
len=25
name='column01
next=Icpitembatch.CPVarDecl
frm_calc='a02.getContents()
len=25
name='column02
next=Icpitembatch.CPVarDecl
frm_calc='a03.getContents()
len=25
name='column03
next=Icpitembatch.CPVarDecl
frm_calc='a04.getContents()
len=25
name='column04
next=Icpitembatch.CPVarDecl
frm_calc='a05.getContents()
len=25
name='column05
next=Icpitembatch.CPVarDecl
frm_calc='a06.getContents()
len=25
name='column06
obj='Var
pag=33
prev=O5589
var_op='asgn
I
obj='Var
pag=33
prev=O5588
var_op='asgn
I
obj='Var
pag=33
prev=O5587
var_op='asgn
I
obj='Var
pag=33
prev=O5586
var_op='asgn
I
obj='Var
pag=33
prev=O5585
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Exec
pag=33
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=33
I
I
]
w=[
150
150
]
I
obj='Exec
pag=33
prev=O5517
I
obj='Begin
pag=33
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O5517
fatherSonIndex=0
frm_calc="//base
Workbook workbook = Workbook.getWorkbook(new File(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(nomefileimport)));
_conta = workbook.getNumberOfSheets();
°--°
obj='Exec
pag=33
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O5410
var_op='asgn
I
obj='Var
obj_type='N
pag=33
prev=O5409
var_op='asgn
I
obj='Var
obj_type='N
pag=33
prev=O5408
var_op='asgn
I
obj='Remark
pag=33
x=12
y=20
I
Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOCLI\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
obj='Var
obj_type='N
pag=30
var_op='asgn
x=1165
y=1413
I
Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
obj='Var
pag=30
pagelocal=True
var_op='asgn
x=954
y=2841
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
len=2
name='_tipoag
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'Lower(LRTrim(nomefileimport))='saldrapp.txt'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Saldi Rapporti Creati: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Saldi Rapporti Aggiornati: '+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O5612
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O5611
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O5610
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O5607
var_op='asgn
I
obj='If
pag=34
prev=O5606
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5607
fatherSonIndex=0
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
obj='Exec
pag=34
prev=O5619
I
obj='Exec
pag=34
prev=O5617
I
obj='While
pag=34
prev=O5616
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5617
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,25)
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_tipoag
next=Icpitembatch.CPRead
arch='aetesta
next=Icpitembatch.CPRead
arch='aeannora
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPWrite
arch='aetesta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record dei saldi rapporti del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=34
prev=O5633
var_op='asgn
I
nonlocal=True
obj='Var
pag=34
prev=O5632
var_op='asgn
I
obj='Write
pag=34
prev=O5629
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'VALUTA
'CAB
]
wr_op=[
'=
'=
]
wr_var=[
'iif(Empty(LRTrim(Substr(riga,104,3))),'242',Substr(riga,104,3))
'Substr(riga,107,5)
]
I
obj='If
pag=34
prev=O5628
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O5629
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGSAR\'"+LRTrim(gAzienda)+"'",0,10)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aeannora
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=34
prev=O5645
var_op='asgn
I
obj='Insert
pag=34
prev=O5644
rd_kfield=[
'RAPPORTO
'ANNO
'IDBASE
'IMPORTO1
'IMPORTO2
'IMPORTO3
'IMPORTO4
'IMPORTO5
'TIPRAP
]
rd_kvar=[
'xRapporto
'Substr(riga,26,4)
'xIDB
'Val(Substr(riga,30,17))
'Val(Substr(riga,47,17))
'Val(Substr(riga,64,17))
'Val(Substr(riga,81,17))
'Val(Substr(riga,98,6))
'_tipoag
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5645
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,1,16)+" per il rapporto in data: "+Substr(riga,21,8)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=34
prev=O5654
I
obj='Var
obj_type='N
pag=34
prev=O5653
var_op='asgn
I
obj='Exec
pag=34
prev=O5652
I
nonlocal=True
obj='Var
obj_type='M
pag=34
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=34
prev=O5643
var_op='asgn
I
obj='Var
pag=34
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aeannora
father=O5629
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=34
prev=O5658
var_op='asgn
I
obj='Write
pag=34
rd_kfield=[
'RAPPORTO
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,4)
]
wr_field=[
'IMPORTO1
'IMPORTO2
'IMPORTO3
'IMPORTO4
'IMPORTO5
'TIPRAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Val(Substr(riga,30,17))
'Val(Substr(riga,47,17))
'Val(Substr(riga,64,17))
'Val(Substr(riga,81,17))
'Val(Substr(riga,98,6))
'_tipoag
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=34
prev=O5627
rd_field=[
'IDBASE
]
rd_kfield=[
'RAPPORTO
'ANNO
]
rd_kvar=[
'xRapporto
'Substr(riga,26,4)
]
rd_var=[
'xIDB
]
I
obj='Read
pag=34
prev=O5626
rd_field=[
'TIPOAG
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'xRapporto
]
rd_var=[
'_tipoag
]
I
obj='Var
pag=34
pagelocal=True
prev=O5625
var_op='asgn
I
obj='Var
pag=34
prev=O5624
var_op='asgn
I
obj='Var
pag=34
prev=O5623
var_op='asgn
I
obj='Var
obj_type='M
pag=34
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=34
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Apro il foglio e verifico quante pagine ha
father=O5607
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='_i = 0
next=Icpitembatch.CPWhile
frm_calc='_i < _conta
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='workbook.close()
obj='Exec
pag=34
prev=O5680
I
obj='While
pag=34
prev=O5679
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O5680
fatherSonIndex=0
frm_calc="_righe = 0;
Sheet sheet = workbook.getSheet(_i);
_righe = sheet.getRows();
_y = 1;
°--°
next=Icpitembatch.CPWhile
frm_calc='_y < _righe
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=34
prev=O5686
I
obj='While
pag=34
prev=O5685
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Legge le colonne e scrive i dati nelle variabili appoggio
father=O5686
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column10)))
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_y++;
obj='Exec
pag=34
prev=O5693
I
obj='If
pag=34
prev=O5691
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O5693
fatherSonIndex=0
frm_calc=''Elaborazione Foglio N.'+LRTrim(Str(_i+1,2,0))+' - Riga N. '+LRTrim(Str(_y+1,7,0))+' - Rapporto N. : '+LRTrim(column01)
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='column01
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_tipoag
next=Icpitembatch.CPRead
arch='aetesta
next=Icpitembatch.CPRead
arch='aeannora
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPWrite
arch='aetesta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record dei saldi rapporti del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=34
prev=O5709
var_op='asgn
I
nonlocal=True
obj='Var
pag=34
prev=O5708
var_op='asgn
I
obj='Write
pag=34
prev=O5705
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'VALUTA
'CAB
]
wr_op=[
'=
'=
]
wr_var=[
'iif(Empty(LRTrim(column08)),'242',Left(LRTrim(column08),3))
'Left(LRTrim(column09),5)
]
I
obj='If
pag=34
prev=O5704
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O5705
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGSAR\'"+LRTrim(gAzienda)+"'",0,10)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aeannora
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=34
prev=O5721
var_op='asgn
I
obj='Insert
pag=34
prev=O5720
rd_kfield=[
'RAPPORTO
'ANNO
'IDBASE
'IMPORTO1
'IMPORTO2
'IMPORTO3
'IMPORTO4
'IMPORTO5
'TIPRAP
]
rd_kvar=[
'Left(LRTrim(column01),25)
'Left(LRTrim(column02),4)
'xIDB
'Val(LRTrim(column03))
'Val(LRTrim(column04))
'Val(LRTrim(column05))
'Val(LRTrim(column06))
'Val(LRTrim(column07))
'_tipoag
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5721
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,1,16)+" per il rapporto in data: "+Substr(riga,21,8)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=34
prev=O5730
I
obj='Var
obj_type='N
pag=34
prev=O5729
var_op='asgn
I
obj='Exec
pag=34
prev=O5728
I
nonlocal=True
obj='Var
obj_type='M
pag=34
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=34
prev=O5719
var_op='asgn
I
obj='Var
pag=34
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aeannora
father=O5705
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=34
prev=O5734
var_op='asgn
I
obj='Write
pag=34
rd_kfield=[
'RAPPORTO
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(LRTrim(column01),25)
'Left(LRTrim(column02),4)
]
wr_field=[
'IMPORTO1
'IMPORTO2
'IMPORTO3
'IMPORTO4
'IMPORTO5
'TIPRAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Val(LRTrim(column03))
'Val(LRTrim(column04))
'Val(LRTrim(column05))
'Val(LRTrim(column06))
'Val(LRTrim(column07))
'_tipoag
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=34
prev=O5703
rd_field=[
'IDBASE
]
rd_kfield=[
'RAPPORTO
'ANNO
]
rd_kvar=[
'Left(LRTrim(column01),25)
'Left(LRTrim(column02),4)
]
rd_var=[
'xIDB
]
I
obj='Read
pag=34
prev=O5702
rd_field=[
'TIPOAG
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Left(LRTrim(column01),25)
]
rd_var=[
'_tipoag
]
I
obj='Var
pag=34
pagelocal=True
prev=O5701
var_op='asgn
I
obj='Var
pag=34
prev=O5700
var_op='asgn
I
obj='Var
pag=34
prev=O5699
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=34
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=34
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O5691
fatherSonIndex=0
frm_calc="// Legge il contenuto delle celle
Cell a01 = sheet.getCell(0,_y);
Cell a02 = sheet.getCell(1,_y);
Cell a03 = sheet.getCell(2,_y);
Cell a04 = sheet.getCell(3,_y);
Cell a05 = sheet.getCell(4,_y);
Cell a06 = sheet.getCell(5,_y);
Cell a07 = sheet.getCell(6,_y);
Cell a08 = sheet.getCell(7,_y);
Cell a09 = sheet.getCell(8,_y);
Cell a10 = sheet.getCell(9,_y);
°--°
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='System.out.println(column01)
next=Icpitembatch.CPExec
frm_calc='System.out.println(column02)
next=Icpitembatch.CPExec
frm_calc='System.out.println(column03)
next=Icpitembatch.CPExec
frm_calc='System.out.println(column04)
next=Icpitembatch.CPExec
frm_calc='System.out.println(column05)
next=Icpitembatch.CPExec
frm_calc='System.out.println(column06)
next=Icpitembatch.CPExec
frm_calc='System.out.println(column07)
next=Icpitembatch.CPExec
frm_calc='System.out.println(column08)
next=Icpitembatch.CPExec
frm_calc='System.out.println(column09)
next=Icpitembatch.CPExec
frm_calc='System.out.println(column10)
obj='Exec
pag=34
prev=O5765
I
obj='Exec
pag=34
prev=O5764
I
obj='Exec
pag=34
prev=O5763
I
obj='Exec
pag=34
prev=O5762
I
obj='Exec
pag=34
prev=O5761
I
obj='Exec
pag=34
prev=O5760
I
obj='Exec
pag=34
prev=O5759
I
obj='Exec
pag=34
prev=O5758
I
obj='Exec
pag=34
prev=O5757
I
obj='Exec
pag=34
prev=O5755
I
obj='Begin
pag=34
prev=O5754
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5755
fatherSonIndex=0
frm_calc='a01.getContents()
len=25
name='column01
next=Icpitembatch.CPVarDecl
frm_calc='a02.getContents()
len=25
name='column02
next=Icpitembatch.CPVarDecl
frm_calc='a03.getContents()
len=25
name='column03
next=Icpitembatch.CPVarDecl
frm_calc='a04.getContents()
len=25
name='column04
next=Icpitembatch.CPVarDecl
frm_calc='a05.getContents()
len=25
name='column05
next=Icpitembatch.CPVarDecl
frm_calc='a06.getContents()
len=25
name='column06
next=Icpitembatch.CPVarDecl
frm_calc='a07.getContents()
len=25
name='column07
next=Icpitembatch.CPVarDecl
frm_calc='a08.getContents()
len=25
name='column08
next=Icpitembatch.CPVarDecl
frm_calc='a09.getContents()
len=25
name='column09
next=Icpitembatch.CPVarDecl
frm_calc='a10.getContents()
len=25
name='column10
obj='Var
pag=34
prev=O5777
var_op='asgn
I
obj='Var
pag=34
prev=O5776
var_op='asgn
I
obj='Var
pag=34
prev=O5775
var_op='asgn
I
obj='Var
pag=34
prev=O5774
var_op='asgn
I
obj='Var
pag=34
prev=O5773
var_op='asgn
I
obj='Var
pag=34
prev=O5772
var_op='asgn
I
obj='Var
pag=34
prev=O5771
var_op='asgn
I
obj='Var
pag=34
prev=O5770
var_op='asgn
I
obj='Var
pag=34
prev=O5769
var_op='asgn
I
obj='Var
pag=34
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Exec
pag=34
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=34
I
I
]
w=[
150
150
]
I
obj='Exec
pag=34
prev=O5677
I
obj='Begin
pag=34
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O5677
fatherSonIndex=0
frm_calc="//base
Workbook workbook = Workbook.getWorkbook(new File(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(nomefileimport)));
_conta = workbook.getNumberOfSheets();
°--°
obj='Exec
pag=34
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O5605
var_op='asgn
I
obj='Var
obj_type='N
pag=34
prev=O5604
var_op='asgn
I
obj='Var
obj_type='N
pag=34
prev=O5603
var_op='asgn
I
obj='Var
pag=34
pagelocal=True
prev=O5602
I
obj='Remark
pag=34
x=10
y=22
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Titolari Effettivi Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Titolari Effettivi Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=35
prev=O5798
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=35
prev=O5797
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=35
prev=O5796
var_op='asgn
I
obj='Exec
pag=35
prev=O5795
I
obj='Exec
pag=35
prev=O5793
I
obj='While
pag=35
prev=O5792
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5793
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
obj='Var
pag=35
prev=O5804
var_op='asgn
I
obj='If
pag=35
prev=O5803
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5804
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=35
prev=O5810
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xntestit
father=O5812
fatherSonIndex=0
obj='Write
pag=35
rd_kfield=[
'CODINTER
'CODCLI
'RAPPORTO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'Left(riga,25)
]
wr_field=[
'DESCINTER
'DATAINI
]
wr_op=[
'=
'=
]
wr_var=[
'Substr(riga,66,30)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5812
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xntestit
obj='Insert
pag=35
prev=O5825
rd_kfield=[
'CODCLI
'CODINTER
'DATAINI
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'Substr(riga,66,30)
'Left(riga,25)
'nProgImp
'LibreriaMit.UniqueId()
]
I
obj='Var
obj_type='N
pag=35
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=35
sel_field='xntestit->IDBASE
sel_name='xntestit
sel_where='xntestit->CODCLI=Substr(riga,26,16) and xntestit->CODINTER=Substr(riga,42,16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5810
fatherSonIndex=0
frm_calc='1
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=35
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5804
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=35
prev=O5835
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestit
father=O5837
fatherSonIndex=0
obj='Write
pag=35
rd_kfield=[
'CODINTER
'CODCLI
'RAPPORTO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'Left(riga,25)
]
wr_field=[
'DESCINTER
'DATAINI
]
wr_op=[
'=
'=
]
wr_var=[
'Substr(riga,66,30)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5837
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='intestit
obj='Insert
pag=35
prev=O5850
rd_kfield=[
'CODCLI
'CODINTER
'DATAINI
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'Substr(riga,66,30)
'Left(riga,25)
'nProgImp
'LibreriaMit.UniqueId()
]
I
obj='Var
obj_type='N
pag=35
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=35
sel_field='intestit->IDBASE
sel_name='intestit
sel_where='intestit->CODCLI=Substr(riga,26,16) and intestit->CODINTER=Substr(riga,42,16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5835
fatherSonIndex=0
frm_calc='1
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=35
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=35
prev=O5802
var_op='asgn
I
obj='Var
obj_type='M
pag=35
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=35
prev=O5791
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=35
prev=O5790
var_op='asgn
I
obj='Var
obj_type='N
pag=35
prev=O5789
var_op='asgn
I
obj='Var
obj_type='N
pag=35
prev=O5788
var_op='asgn
I
obj='Remark
pag=35
x=13
y=21
I
Icpitembatch.CPExec
check='man
frm_calc="// Create a buffer for reading the files
    byte[] buf = new byte[1024];
    
    try {
        // Create the ZIP file
        String outFilename = cNomeFileZip;
        java.util.zip.ZipOutputStream out = new java.util.zip.ZipOutputStream(new java.io.FileOutputStream(outFilename));
    
        // Compress the files
        for (int i=0; i<filenames.size(); i++) {
            _file1=(String)filenames.elementAt(i);
            _file2=(String)fileonames.elementAt(i);
            java.io.FileInputStream in = new java.io.FileInputStream(_file1);
    
            // Add ZIP entry to output stream.
            out.putNextEntry(new java.util.zip.ZipEntry(_file2));
    
            // Transfer bytes from the file to the ZIP file
            int len;
            while ((len = in.read(buf)) > 0) {
                out.write(buf, 0, len);
            }
    
            // Complete the entry
            out.closeEntry();
            in.close();
            FileLibMit.DeleteFile(CPLib.LRTrim(gPathApp)+"/output/"+CPLib.LRTrim(gAzienda)+"/"+CPLib.LRTrim(_file2));
        }
    
        // Complete the ZIP file
        out.close();
        filenames.removeAllElements();
        fileonames.removeAllElements();
    } catch (java.io.IOException e) {
    }

°--°
obj='Exec
pag=36
x=15
y=21
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPBeginEnd
comment='Apro il foglio e verifico quante pagine ha
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='_i = 0
next=Icpitembatch.CPWhile
frm_calc='_i < _conta
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='workbook.close()
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Modificate: '+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=37
prev=O5875
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=37
prev=O5874
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=37
prev=O5873
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=37
prev=O5872
var_op='asgn
I
obj='Exec
pag=37
prev=O5870
I
obj='While
pag=37
prev=O5869
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O5870
fatherSonIndex=0
frm_calc="_righe = 0;
Sheet sheet = workbook.getSheet(_i);
_righe = sheet.getRows();
_y = 1;
°--°
next=Icpitembatch.CPWhile
frm_calc='_y < _righe
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=37
prev=O5880
I
obj='While
pag=37
prev=O5879
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Legge le colonne e scrive i dati nelle variabili appoggio
father=O5880
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPExec
check='man
frm_calc='_y++;
obj='Exec
pag=37
prev=O5891
I
obj='If
pag=37
prev=O5889
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O5891
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column28)))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(column34)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc='_flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(column36)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(LRTrim(column01))))) or Empty(LRTrim(_numprog))
]
h=[
19
19
]
obj='If
pag=37
prev=O5914
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5917
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(LRTrim(column01))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPCase
frm_calc=[
'LRTrim(column16)='S' or LRTrim(column16)='1' or LRTrim(column16)='7'
'LRTrim(column16)='E' or LRTrim(column16)='3' or LRTrim(column16)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(LRTrim(column15))) or _flgdataim=1,Date(),CharToDate(Right(LRTrim(column15),4)+Substr(LRTrim(column15),3,2)+Left(LRTrim(column15),2)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPVarDecl
frm_calc='iif(LRTrim(column02)='1' or LRTrim(column02)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column32)),'0',iif(LRTrim(column32)='S','1',iif(LRTrim(column32)='N','1',LRTrim(column32))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(LRTrim(column24))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column06)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_z
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='operazbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_oldidb)))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=37
prev=O5951
var_op='asgn
I
obj='If
pag=37
prev=O5949
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5951
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='sogopebo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='clientiope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='beneficope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='terzistiope
obj='Delete
pag=37
prev=O5966
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=37
prev=O5965
sel_field='*
sel_name='terzistiope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistiope
father=O5966
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'cOpeProg1
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=37
prev=O5963
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=37
prev=O5962
sel_field='*
sel_name='beneficope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficope
father=O5963
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
]
rd_kvar=[
'cOpeProg1
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=37
prev=O5960
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=37
prev=O5959
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O5960
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=37
prev=O5957
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=37
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sogopebo
father=O5957
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5951
fatherSonIndex=1
frm_calc=[
'Empty(LRTrim(column21)) and not(Empty(LRTrim(column12)))
]
h=[
19
19
]
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O6006
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=37
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=LRTrim(column12)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6011
fatherSonIndex=0
frm_calc=[
'LRTrim(intestbo->CODINTER) <> LRTrim(column21)
]
h=[
19
19
]
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O6015
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'RAPCOL
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
'LRTrim(column12)
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=37
prev=O5947
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
]
rd_kvar=[
'LRTrim(column42)
'Val(Right(LRTrim(column01),4))
'arfn_conv_stato_uic(Left(LRTrim(column40),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'LRTrim(column62)
'_bensta
'Val(LRTrim(column23)) / 10000
'Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2)
'Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2)
'DateToChar(_datareg)
'LRTrim(column03)
'_intercab
'LRTrim(column10)
'column28
'LRTrim(column06)
'_intercod
'LRTrim(column04)
'LRTrim(column50)
'LRTrim(column33)
'LRTrim(column21)
'LRTrim(column22)
'CharToDate(Right(LRTrim(column51),4)+Substr(LRTrim(column51),3,2)+Left(LRTrim(column51),2))
'CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))
'_datareg
'_datarett
'LRTrim(column08)
'_intercit
'Left(LRTrim(column11),50)
'Val(LRTrim(column67))
'LRTrim(column43)
'cFlagCont
'cFlagFraz
'cFlagLire
'LRTrim(column13)
'_flagrap2
'cOpeProg1
'cIdCau
'"O"+Right(cOpeProg2,9)+_idb2
'column41
'LRTrim(column65)
'LRTrim(column39)
'LRTrim(column60)
'cOpeProg2
'LRTrim(column35)
'_idreg
''1'
'CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6))
'arfn_conv_stato_uic(LRTrim(column07))
'LRTrim(column64)
'nProgImp
'LRTrim(column09)
'_interprv
'LRTrim(column38)
'LRTrim(column63)
'LRTrim(column12)
'Val(LRTrim(column47))
'Val(LRTrim(column46))
'Val(LRTrim(column49))
'column36
'Val(LRTrim(column48))
'Val(LRTrim(column45))
'Val(LRTrim(column52))
'LRTrim(column61)
'LRTrim(column18)
'_statoreg
'LRTrim(column44)
''1'
'LRTrim(column05)
'LRTrim(column26)
'LRTrim(column14)
'LRTrim(column25)
'Val(LRTrim(column20))
'Val(column19)
'column34
'LRTrim(column17)
'LRTrim(column37)
'_colleg
'_idb2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5949
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))+" con importo "+Str((Val(column19))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=37
prev=O6033
I
obj='Var
obj_type='N
pag=37
prev=O6032
var_op='asgn
I
obj='Exec
pag=37
prev=O6031
I
nonlocal=True
obj='Var
obj_type='M
pag=37
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=37
prev=O5946
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=LRTrim(column12)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5947
fatherSonIndex=0
frm_calc=[
'_z=0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_z + 1
len=10
name='_z
obj='Var
obj_type='N
pag=37
prev=O6038
var_op='asgn
I
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6038
fatherSonIndex=0
frm_calc='intestbo->CODINTER
len=25
name='column21
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=37
prev=O5943
var_op='asgn
I
obj='If
pag=37
prev=O5941
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O5943
fatherSonIndex=0
obj='Read
pag=37
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'LRTrim(column06)
]
rd_var=[
'column10
'column08
'column09
'column07
'column11
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=37
prev=O5940
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O5941
fatherSonIndex=0
frm_calc='Upper(LRTrim(column53))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(LRTrim(column54))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column55))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(column56)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column57))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column58))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column59))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(LRTrim(column33)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(LRTrim(column33))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=37
prev=O6067
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6070
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(column12)))
]
h=[
19
19
]
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O6075
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=37
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=LRTrim(column12)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6080
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=37
prev=O6091
I
obj='Read
pag=37
prev=O6090
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=37
prev=O6089
var_op='asgn
I
obj='Var
pag=37
prev=O6088
var_op='asgn
I
obj='Var
pag=37
prev=O6087
var_op='asgn
I
obj='Var
pag=37
prev=O6086
var_op='asgn
I
obj='Var
pag=37
prev=O6085
var_op='asgn
I
obj='Var
pag=37
prev=O6084
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O6064
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6067
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=37
prev=O6108
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column33)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=37
prev=O6107
var_op='asgn
I
obj='Var
pag=37
prev=O6106
var_op='asgn
I
obj='Var
pag=37
prev=O6105
var_op='asgn
I
obj='Var
pag=37
prev=O6104
var_op='asgn
I
obj='Var
pag=37
prev=O6103
var_op='asgn
I
obj='Var
pag=37
prev=O6102
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O6063
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O6064
fatherSonIndex=0
obj='Read
pag=37
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=37
prev=O6062
var_op='asgn
I
obj='Var
pag=37
prev=O6061
var_op='asgn
I
obj='Var
pag=37
prev=O6060
var_op='asgn
I
obj='Var
pag=37
prev=O6059
var_op='asgn
I
obj='Var
pag=37
prev=O6058
var_op='asgn
I
obj='Var
pag=37
prev=O6057
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=37
prev=O5939
var_op='asgn
I
obj='Var
obj_type='N
pag=37
prev=O5938
var_op='asgn
I
obj='Var
obj_type='N
pag=37
prev=O5936
var_op='asgn
I
obj='Select
pag=37
par_expr=[
'Left(LRTrim(column03),4)
'Left(LRTrim(column04),2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O5935
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5936
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=37
prev=O5934
var_op='asgn
I
obj='Var
pag=37
prev=O5933
var_op='asgn
I
obj='Var
pag=37
prev=O5932
var_op='asgn
I
obj='Var
pag=37
prev=O5931
var_op='asgn
I
obj='Var
pag=37
prev=O5930
var_op='asgn
I
obj='Var
pag=37
prev=O5929
var_op='asgn
I
obj='Var
obj_type='D
pag=37
prev=O5926
var_op='asgn
I
obj='Case
pag=37
prev=O5925
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5926
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=37
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5926
fatherSonIndex=1
frm_calc=[
'LRTrim(column16) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6134
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=37
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6134
fatherSonIndex=1
frm_calc='LRTrim(column16)
len=1
name='cFlagLire
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5926
fatherSonIndex=2
frm_calc='LRTrim(column16)
len=1
name='cFlagLire
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=37
prev=O5922
var_op='asgn
I
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5922
fatherSonIndex=0
frm_calc='_numprog
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''1'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
obj='Var
obj_type='D
pag=37
prev=O6149
var_op='asgn
I
obj='Var
pag=37
prev=O6148
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5922
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("POPERAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''0'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datarett
obj='Var
obj_type='D
pag=37
prev=O6153
var_op='asgn
I
obj='Var
pag=37
prev=O6152
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O5911
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5914
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(LRTrim(column01)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6159
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=37
prev=O6164
sel_field='operazbo->IDBASE
sel_name='operazbo
sel_where='operazbo->NUMPROG=_numprog and (operazbo->STATOREG='0'  or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O6165
fatherSonIndex=0
frm_calc='"E' stata cancellata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=37
prev=O6169
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'operazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
]
wr_var=[
''2'
'Date()
]
I
nonlocal=True
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
father=O6159
fatherSonIndex=1
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"E' stata variata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=37
prev=O6180
sel_field='operazbo->IDBASE,operazbo->NUMPROG,operazbo->DATAOPE,operazbo->FLAGRAP2
sel_name='operazbo
sel_where='operazbo->NUMPROG=_numprog and (operazbo->STATOREG='0'  or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6181
fatherSonIndex=0
frm_calc='operazbo->IDBASE
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(operazbo->FLAGRAP2) or operazbo->FLAGRAP2='S',Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(operazbo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='operazbo->IDEREG
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='operazbo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=37
prev=O6193
sel_field='*
sel_name='terzistiope
sel_where='terzistiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='merzistiope
father=O6195
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'IDREG
]
rd_kvar=[
'_oldidb
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=37
prev=O6191
sel_field='*
sel_name='beneficope
sel_where='beneficope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='meneficope
father=O6193
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
'IDREG
]
rd_kvar=[
'_oldidb
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=37
prev=O6189
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mlientiope
father=O6191
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=37
prev=O6188
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mogopebo
father=O6189
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=37
prev=O6187
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'operazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
'FLAGRAP2
]
wr_op=[
'=
'=
'=
]
wr_var=[
''3'
'Date()
'_flagrap2
]
I
obj='Var
pag=37
prev=O6186
var_op='asgn
I
obj='Var
pag=37
prev=O6185
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=37
prev=O6179
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O5910
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5911
fatherSonIndex=0
frm_calc=[
'Upper(column36)='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O6232
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=37
sel_field='operazbo->NUMPROG
sel_name='operazbo
sel_where='operazbo->INFORM = column41 and (operazbo->STATOREG='0' or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6237
fatherSonIndex=0
frm_calc='operazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O6232
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=37
sel_field='operazbo->NUMPROG
sel_name='operazbo
sel_where='operazbo->RIFIMP = column36 and (operazbo->STATOREG='0' or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6244
fatherSonIndex=0
frm_calc='operazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=37
prev=O5909
var_op='asgn
I
obj='Var
pag=37
prev=O5908
var_op='asgn
I
obj='Var
pag=37
prev=O5907
var_op='asgn
I
obj='Var
pag=37
prev=O5904
var_op='asgn
I
obj='If
pag=37
prev=O5903
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O5904
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=37
prev=O6254
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6255
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))+" con importo "+Str((Val(column19))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=37
prev=O6261
I
obj='Var
obj_type='N
pag=37
prev=O6260
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=37
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'column34
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=37
prev=O5902
var_op='asgn
I
obj='Remark
pag=37
prev=O5899
I
obj='If
pag=37
prev=O5897
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5899
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column29)+LRTrim(column31)+LRTrim(column30)))
]
h=[
19
19
]
obj='If
pag=37
prev=O6273
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6276
fatherSonIndex=0
frm_calc='LRTrim(column29)
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(column31)
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(column30)
len=2
name='_interprv
obj='Var
pag=37
prev=O6282
var_op='asgn
I
obj='Var
pag=37
prev=O6281
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O6272
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6273
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))+" con importo "+Str((Val(column19))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(column28)+" non è prensente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=37
prev=O6288
I
obj='Var
obj_type='N
pag=37
prev=O6287
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=37
prev=O6271
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'column28
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=37
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5897
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(column27)),_codinter,column27)
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column29)),_citinter,column29)
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column31)),_cabinter,column31)
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column30)),_prvinter,column30)
len=2
name='_interprv
obj='Var
pag=37
prev=O6300
var_op='asgn
I
obj='Var
pag=37
prev=O6299
var_op='asgn
I
obj='Var
pag=37
prev=O6298
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5891
fatherSonIndex=1
frm_calc='1
len=1
name='_opeerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(ohand,riga)
obj='Exec
pag=37
prev=O6304
I
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=37
prev=O5887
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O5889
fatherSonIndex=0
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column21)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column22))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column33))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column50))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(column21)) and Empty(LRTrim(column12)) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=37
prev=O6319
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6322
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O6316
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6319
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=37
prev=O6332
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6333
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=37
prev=O6331
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column50)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O6313
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6316
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=37
prev=O6348
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6349
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=37
prev=O6347
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column33)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O6310
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6313
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=37
prev=O6364
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6365
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=37
prev=O6363
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column22)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O6309
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6310
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=37
prev=O6380
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6381
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=37
prev=O6379
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column21)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=37
prev=O5885
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O5887
fatherSonIndex=0
frm_calc='a01.getContents()
len=25
name='column01
next=Icpitembatch.CPVarDecl
frm_calc='a02.getContents()
len=25
name='column02
next=Icpitembatch.CPVarDecl
frm_calc='a03.getContents()
len=25
name='column03
next=Icpitembatch.CPVarDecl
frm_calc='a04.getContents()
len=25
name='column04
next=Icpitembatch.CPVarDecl
frm_calc='a05.getContents()
len=25
name='column05
next=Icpitembatch.CPVarDecl
frm_calc='a06.getContents()
len=25
name='column06
next=Icpitembatch.CPVarDecl
frm_calc='a07.getContents()
len=25
name='column07
next=Icpitembatch.CPVarDecl
frm_calc='a08.getContents()
len=25
name='column08
next=Icpitembatch.CPVarDecl
frm_calc='a09.getContents()
len=25
name='column09
next=Icpitembatch.CPVarDecl
frm_calc='a10.getContents()
len=25
name='column10
next=Icpitembatch.CPVarDecl
frm_calc='a11.getContents()
len=25
name='column11
next=Icpitembatch.CPVarDecl
frm_calc='a12.getContents()
len=25
name='column12
next=Icpitembatch.CPVarDecl
frm_calc='a13.getContents()
len=25
name='column13
next=Icpitembatch.CPVarDecl
frm_calc='a14.getContents()
len=25
name='column14
next=Icpitembatch.CPVarDecl
frm_calc='a15.getContents()
len=25
name='column15
next=Icpitembatch.CPVarDecl
frm_calc='a16.getContents()
len=25
name='column16
next=Icpitembatch.CPVarDecl
frm_calc='a17.getContents()
len=25
name='column17
next=Icpitembatch.CPVarDecl
frm_calc='a18.getContents()
len=25
name='column18
next=Icpitembatch.CPVarDecl
frm_calc='a19.getContents()
len=25
name='column19
next=Icpitembatch.CPVarDecl
frm_calc='a20.getContents()
len=25
name='column20
next=Icpitembatch.CPVarDecl
frm_calc='a21.getContents()
len=25
name='column21
next=Icpitembatch.CPVarDecl
frm_calc='a22.getContents()
len=25
name='column22
next=Icpitembatch.CPVarDecl
frm_calc='a23.getContents()
len=25
name='column23
next=Icpitembatch.CPVarDecl
frm_calc='a24.getContents()
len=25
name='column24
next=Icpitembatch.CPVarDecl
frm_calc='a25.getContents()
len=25
name='column25
next=Icpitembatch.CPVarDecl
frm_calc='a26.getContents()
len=25
name='column26
next=Icpitembatch.CPVarDecl
frm_calc='a27.getContents()
len=25
name='column27
next=Icpitembatch.CPVarDecl
frm_calc='a28.getContents()
len=25
name='column28
next=Icpitembatch.CPVarDecl
frm_calc='a29.getContents()
len=25
name='column29
next=Icpitembatch.CPVarDecl
frm_calc='a30.getContents()
len=25
name='column30
next=Icpitembatch.CPVarDecl
frm_calc='a31.getContents()
len=25
name='column31
next=Icpitembatch.CPVarDecl
frm_calc='a32.getContents()
len=25
name='column32
next=Icpitembatch.CPVarDecl
frm_calc='a33.getContents()
len=25
name='column33
next=Icpitembatch.CPVarDecl
frm_calc='a34.getContents()
len=25
name='column34
next=Icpitembatch.CPVarDecl
frm_calc='a35.getContents()
len=25
name='column35
next=Icpitembatch.CPVarDecl
frm_calc='a36.getContents()
len=25
name='column36
next=Icpitembatch.CPVarDecl
frm_calc='a37.getContents()
len=25
name='column37
next=Icpitembatch.CPVarDecl
frm_calc='a38.getContents()
len=25
name='column38
next=Icpitembatch.CPVarDecl
frm_calc='a39.getContents()
len=25
name='column39
next=Icpitembatch.CPVarDecl
frm_calc='a40.getContents()
len=25
name='column40
next=Icpitembatch.CPVarDecl
frm_calc='a41.getContents()
len=25
name='column41
next=Icpitembatch.CPVarDecl
frm_calc='a42.getContents()
len=25
name='column42
next=Icpitembatch.CPVarDecl
frm_calc='a43.getContents()
len=25
name='column43
next=Icpitembatch.CPVarDecl
frm_calc='a44.getContents()
len=25
name='column44
next=Icpitembatch.CPVarDecl
frm_calc='a45.getContents()
len=25
name='column45
next=Icpitembatch.CPVarDecl
frm_calc='a46.getContents()
len=25
name='column46
next=Icpitembatch.CPVarDecl
frm_calc='a47.getContents()
len=25
name='column47
next=Icpitembatch.CPVarDecl
frm_calc='a48.getContents()
len=25
name='column48
next=Icpitembatch.CPVarDecl
frm_calc='a49.getContents()
len=25
name='column49
next=Icpitembatch.CPVarDecl
frm_calc='a50.getContents()
len=25
name='column50
next=Icpitembatch.CPVarDecl
frm_calc='a51.getContents()
len=25
name='column51
next=Icpitembatch.CPVarDecl
frm_calc='a52.getContents()
len=25
name='column52
next=Icpitembatch.CPVarDecl
frm_calc='a53.getContents()
len=25
name='column53
next=Icpitembatch.CPVarDecl
frm_calc='a54.getContents()
len=25
name='column54
next=Icpitembatch.CPVarDecl
frm_calc='a55.getContents()
len=25
name='column55
next=Icpitembatch.CPVarDecl
frm_calc='a56.getContents()
len=25
name='column56
next=Icpitembatch.CPVarDecl
frm_calc='a57.getContents()
len=25
name='column57
next=Icpitembatch.CPVarDecl
frm_calc='a58.getContents()
len=25
name='column58
next=Icpitembatch.CPVarDecl
frm_calc='a59.getContents()
len=25
name='column59
next=Icpitembatch.CPVarDecl
frm_calc='a60.getContents()
len=25
name='column60
next=Icpitembatch.CPVarDecl
frm_calc='a61.getContents()
len=25
name='column61
next=Icpitembatch.CPVarDecl
frm_calc='a62.getContents()
len=25
name='column62
next=Icpitembatch.CPVarDecl
frm_calc='a63.getContents()
len=25
name='column63
next=Icpitembatch.CPVarDecl
frm_calc='a64.getContents()
len=25
name='column64
next=Icpitembatch.CPVarDecl
frm_calc='a65.getContents()
len=25
name='column65
next=Icpitembatch.CPVarDecl
frm_calc='a66.getContents()
len=25
name='column66
next=Icpitembatch.CPVarDecl
frm_calc='a67.getContents()
len=25
name='column67
obj='Var
pag=37
prev=O6461
var_op='asgn
I
obj='Var
pag=37
prev=O6460
var_op='asgn
I
obj='Var
pag=37
prev=O6459
var_op='asgn
I
obj='Var
pag=37
prev=O6458
var_op='asgn
I
obj='Var
pag=37
prev=O6457
var_op='asgn
I
obj='Var
pag=37
prev=O6456
var_op='asgn
I
obj='Var
pag=37
prev=O6455
var_op='asgn
I
obj='Var
pag=37
prev=O6454
var_op='asgn
I
obj='Var
pag=37
prev=O6453
var_op='asgn
I
obj='Var
pag=37
prev=O6452
var_op='asgn
I
obj='Var
pag=37
prev=O6451
var_op='asgn
I
obj='Var
pag=37
prev=O6450
var_op='asgn
I
obj='Var
pag=37
prev=O6449
var_op='asgn
I
obj='Var
pag=37
prev=O6448
var_op='asgn
I
obj='Var
pag=37
prev=O6447
var_op='asgn
I
obj='Var
pag=37
prev=O6446
var_op='asgn
I
obj='Var
pag=37
prev=O6445
var_op='asgn
I
obj='Var
pag=37
prev=O6444
var_op='asgn
I
obj='Var
pag=37
prev=O6443
var_op='asgn
I
obj='Var
pag=37
prev=O6442
var_op='asgn
I
obj='Var
pag=37
prev=O6441
var_op='asgn
I
obj='Var
pag=37
prev=O6440
var_op='asgn
I
obj='Var
pag=37
prev=O6439
var_op='asgn
I
obj='Var
pag=37
prev=O6438
var_op='asgn
I
obj='Var
pag=37
prev=O6437
var_op='asgn
I
obj='Var
pag=37
prev=O6436
var_op='asgn
I
obj='Var
pag=37
prev=O6435
var_op='asgn
I
obj='Var
pag=37
prev=O6434
var_op='asgn
I
obj='Var
pag=37
prev=O6433
var_op='asgn
I
obj='Var
pag=37
prev=O6432
var_op='asgn
I
obj='Var
pag=37
prev=O6431
var_op='asgn
I
obj='Var
pag=37
prev=O6430
var_op='asgn
I
obj='Var
pag=37
prev=O6429
var_op='asgn
I
obj='Var
pag=37
prev=O6428
var_op='asgn
I
obj='Var
pag=37
prev=O6427
var_op='asgn
I
obj='Var
pag=37
prev=O6426
var_op='asgn
I
obj='Var
pag=37
prev=O6425
var_op='asgn
I
obj='Var
pag=37
prev=O6424
var_op='asgn
I
obj='Var
pag=37
prev=O6423
var_op='asgn
I
obj='Var
pag=37
prev=O6422
var_op='asgn
I
obj='Var
pag=37
prev=O6421
var_op='asgn
I
obj='Var
pag=37
prev=O6420
var_op='asgn
I
obj='Var
pag=37
prev=O6419
var_op='asgn
I
obj='Var
pag=37
prev=O6418
var_op='asgn
I
obj='Var
pag=37
prev=O6417
var_op='asgn
I
obj='Var
pag=37
prev=O6416
var_op='asgn
I
obj='Var
pag=37
prev=O6415
var_op='asgn
I
obj='Var
pag=37
prev=O6414
var_op='asgn
I
obj='Var
pag=37
prev=O6413
var_op='asgn
I
obj='Var
pag=37
prev=O6412
var_op='asgn
I
obj='Var
pag=37
prev=O6411
var_op='asgn
I
obj='Var
pag=37
prev=O6410
var_op='asgn
I
obj='Var
pag=37
prev=O6409
var_op='asgn
I
obj='Var
pag=37
prev=O6408
var_op='asgn
I
obj='Var
pag=37
prev=O6407
var_op='asgn
I
obj='Var
pag=37
prev=O6406
var_op='asgn
I
obj='Var
pag=37
prev=O6405
var_op='asgn
I
obj='Var
pag=37
prev=O6404
var_op='asgn
I
obj='Var
pag=37
prev=O6403
var_op='asgn
I
obj='Var
pag=37
prev=O6402
var_op='asgn
I
obj='Var
pag=37
prev=O6401
var_op='asgn
I
obj='Var
pag=37
prev=O6400
var_op='asgn
I
obj='Var
pag=37
prev=O6399
var_op='asgn
I
obj='Var
pag=37
prev=O6398
var_op='asgn
I
obj='Var
pag=37
prev=O6397
var_op='asgn
I
obj='Var
pag=37
prev=O6396
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=37
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPExec
check='man
father=O5885
fatherSonIndex=0
frm_calc="// Legge il contenuto delle celle
Cell a01 = sheet.getCell(0,_y);
Cell a02 = sheet.getCell(1,_y);
Cell a03 = sheet.getCell(2,_y);
Cell a04 = sheet.getCell(3,_y);
Cell a05 = sheet.getCell(4,_y);
Cell a06 = sheet.getCell(5,_y);
Cell a07 = sheet.getCell(6,_y);
Cell a08 = sheet.getCell(7,_y);
Cell a09 = sheet.getCell(8,_y);
Cell a10 = sheet.getCell(9,_y);
Cell a11 = sheet.getCell(10,_y);
Cell a12 = sheet.getCell(11,_y);
Cell a13 = sheet.getCell(12,_y);
Cell a14 = sheet.getCell(13,_y);
Cell a15 = sheet.getCell(14,_y);
Cell a16 = sheet.getCell(15,_y);
Cell a17 = sheet.getCell(16,_y);
Cell a18 = sheet.getCell(17,_y);
Cell a19 = sheet.getCell(18,_y);
Cell a20 = sheet.getCell(19,_y);
Cell a21 = sheet.getCell(20,_y);
Cell a22 = sheet.getCell(21,_y);
Cell a23 = sheet.getCell(22,_y);
Cell a24 = sheet.getCell(23,_y);
Cell a25 = sheet.getCell(24,_y);
Cell a26 = sheet.getCell(25,_y);
Cell a27 = sheet.getCell(26,_y);
Cell a28 = sheet.getCell(27,_y);
Cell a29 = sheet.getCell(28,_y);
Cell a30 = sheet.getCell(29,_y);
Cell a31 = sheet.getCell(30,_y);
Cell a32 = sheet.getCell(31,_y);
Cell a33 = sheet.getCell(32,_y);
Cell a34 = sheet.getCell(33,_y);
Cell a35 = sheet.getCell(34,_y);
Cell a36 = sheet.getCell(35,_y);
Cell a37 = sheet.getCell(36,_y);
Cell a38 = sheet.getCell(37,_y);
Cell a39 = sheet.getCell(38,_y);
Cell a40 = sheet.getCell(39,_y);
Cell a41 = sheet.getCell(40,_y);
Cell a42 = sheet.getCell(41,_y);
Cell a43 = sheet.getCell(42,_y);
Cell a44 = sheet.getCell(43,_y);
Cell a45 = sheet.getCell(44,_y);
Cell a46 = sheet.getCell(45,_y);
Cell a47 = sheet.getCell(46,_y);
Cell a48 = sheet.getCell(47,_y);
Cell a49 = sheet.getCell(48,_y);
Cell a50 = sheet.getCell(49,_y);
Cell a51 = sheet.getCell(50,_y);
Cell a52 = sheet.getCell(51,_y);
Cell a53 = sheet.getCell(52,_y);
Cell a54 = sheet.getCell(53,_y);
Cell a55 = sheet.getCell(54,_y);
Cell a56 = sheet.getCell(55,_y);
Cell a57 = sheet.getCell(56,_y);
Cell a58 = sheet.getCell(57,_y);
Cell a59 = sheet.getCell(58,_y);
Cell a60 = sheet.getCell(59,_y);
Cell a61 = sheet.getCell(60,_y);
Cell a62 = sheet.getCell(61,_y);
Cell a63 = sheet.getCell(62,_y);
Cell a64 = sheet.getCell(63,_y);
Cell a65 = sheet.getCell(64,_y);
Cell a66 = sheet.getCell(65,_y);
Cell a67 = sheet.getCell(66,_y);
°--°
obj='Exec
pag=37
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=37
I
I
]
w=[
150
150
]
I
obj='Exec
pag=37
prev=O5867
I
obj='Begin
pag=37
prev=O5866
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O5867
fatherSonIndex=0
frm_calc="//base
Workbook workbook = Workbook.getWorkbook(new File(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(nomefileimport)));
_conta = workbook.getNumberOfSheets();
°--°
obj='Exec
pag=37
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=37
prev=O5865
var_op='asgn
I
obj='Var
obj_type='N
pag=37
prev=O5864
var_op='asgn
I
obj='Var
obj_type='N
pag=37
prev=O5863
var_op='asgn
I
obj='Var
pag=37
pagelocal=True
prev=O5862
I
obj='Remark
pag=37
x=13
y=29
I
Icpitembatch.CPRead
arch='tbcauana
obj='Read
pag=37
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,10,4)
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
x=463
y=3942
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPBeginEnd
comment='Apro il foglio e verifico quante pagine ha
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='_i = 0
next=Icpitembatch.CPWhile
frm_calc='_i < _conta
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='workbook.close()
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Modificate: '+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=38
prev=O6492
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=38
prev=O6491
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=38
prev=O6490
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=38
prev=O6489
var_op='asgn
I
obj='Exec
pag=38
prev=O6487
I
obj='While
pag=38
prev=O6486
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O6487
fatherSonIndex=0
frm_calc="_righe = 0;
Sheet sheet = workbook.getSheet(_i);
_righe = sheet.getRows();
_y = 1;
°--°
next=Icpitembatch.CPWhile
frm_calc='_y < _righe
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=38
prev=O6497
I
obj='While
pag=38
prev=O6496
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Legge le colonne e scrive i dati nelle variabili appoggio
father=O6497
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPExec
check='man
frm_calc='_y++;
obj='Exec
pag=38
prev=O6508
I
obj='If
pag=38
prev=O6506
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O6508
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column28)))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(column34)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPCase
frm_calc=[
'LRTrim(column16)='S' or LRTrim(column16)='1' or LRTrim(column16)='7'
'LRTrim(column16)='E' or LRTrim(column16)='3' or LRTrim(column16)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(LRTrim(column15))) or _flgdataim=1,Date(),CharToDate(Right(LRTrim(column15),4)+Substr(LRTrim(column15),3,2)+Left(LRTrim(column15),2)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(LRTrim(column02)='1' or LRTrim(column02)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column32)),'0',iif(LRTrim(column32)='S','1',iif(LRTrim(column32)='N','1',LRTrim(column32))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(LRTrim(column24))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column06)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_z
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xperazbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=38
prev=O6549
var_op='asgn
I
obj='Insert
pag=38
prev=O6547
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
]
rd_kvar=[
'LRTrim(column42)
'Val(Right(LRTrim(column01),4))
'arfn_conv_stato_uic(Left(LRTrim(column40),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'LRTrim(column62)
'_bensta
'Val(LRTrim(column23)) / 10000
'Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2)
'Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2)
'DateToChar(_datareg)
'LRTrim(column03)
'_intercab
'LRTrim(column10)
'column28
'LRTrim(column06)
'_intercod
'LRTrim(column04)
'LRTrim(column50)
'LRTrim(column33)
'LRTrim(column21)
'LRTrim(column22)
'CharToDate(Right(LRTrim(column51),4)+Substr(LRTrim(column51),3,2)+Left(LRTrim(column51),2))
'CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))
'_datareg
'_datarett
'LRTrim(column08)
'_intercit
'Left(LRTrim(column11),50)
'Val(LRTrim(column67))
'LRTrim(column43)
'cFlagCont
'cFlagFraz
'cFlagLire
'LRTrim(column13)
'_flagrap2
'cOpeProg1
'cIdCau
'"O"+Right(cOpeProg2,9)+_idb2
'column41
'LRTrim(column65)
'LRTrim(column39)
'LRTrim(column60)
'cOpeProg2
'LRTrim(column35)
'_idreg
''1'
'CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6))
'arfn_conv_stato_uic(LRTrim(column07))
'LRTrim(column64)
'nProgImp
'LRTrim(column09)
'_interprv
'LRTrim(column38)
'LRTrim(column63)
'LRTrim(column12)
'Val(LRTrim(column47))
'Val(LRTrim(column46))
'Val(LRTrim(column49))
'column36
'Val(LRTrim(column48))
'Val(LRTrim(column45))
'Val(LRTrim(column52))
'LRTrim(column61)
'LRTrim(column18)
'_statoreg
'LRTrim(column44)
''1'
'LRTrim(column05)
'LRTrim(column26)
'LRTrim(column14)
'LRTrim(column25)
'Val(LRTrim(column20))
'Val(column19)
'column34
'LRTrim(column17)
'LRTrim(column37)
'_colleg
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6549
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))+" con importo "+Str((Val(column19))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=38
prev=O6558
I
obj='Var
obj_type='N
pag=38
prev=O6557
var_op='asgn
I
obj='Exec
pag=38
prev=O6556
I
nonlocal=True
obj='Var
obj_type='M
pag=38
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=38
prev=O6546
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=LRTrim(column12)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6547
fatherSonIndex=0
frm_calc=[
'_z=0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_z + 1
len=10
name='_z
obj='Var
obj_type='N
pag=38
prev=O6563
var_op='asgn
I
obj='If
pag=38
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6563
fatherSonIndex=0
frm_calc='intestbo->CODINTER
len=25
name='column21
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=38
prev=O6543
var_op='asgn
I
obj='If
pag=38
prev=O6541
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O6543
fatherSonIndex=0
obj='Read
pag=38
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'LRTrim(column06)
]
rd_var=[
'column10
'column08
'column09
'column07
'column11
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=38
prev=O6540
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O6541
fatherSonIndex=0
frm_calc='Upper(LRTrim(column53))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(LRTrim(column54))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column55))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(column56)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column57))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column58))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column59))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(LRTrim(column33)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(LRTrim(column33))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=38
prev=O6592
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6595
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(column12)))
]
h=[
19
19
]
obj='If
pag=38
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O6600
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=38
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=LRTrim(column12)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6605
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=38
prev=O6616
I
obj='Read
pag=38
prev=O6615
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=38
prev=O6614
var_op='asgn
I
obj='Var
pag=38
prev=O6613
var_op='asgn
I
obj='Var
pag=38
prev=O6612
var_op='asgn
I
obj='Var
pag=38
prev=O6611
var_op='asgn
I
obj='Var
pag=38
prev=O6610
var_op='asgn
I
obj='Var
pag=38
prev=O6609
var_op='asgn
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O6589
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6592
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=38
prev=O6633
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column33)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=38
prev=O6632
var_op='asgn
I
obj='Var
pag=38
prev=O6631
var_op='asgn
I
obj='Var
pag=38
prev=O6630
var_op='asgn
I
obj='Var
pag=38
prev=O6629
var_op='asgn
I
obj='Var
pag=38
prev=O6628
var_op='asgn
I
obj='Var
pag=38
prev=O6627
var_op='asgn
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O6588
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O6589
fatherSonIndex=0
obj='Read
pag=38
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=38
prev=O6587
var_op='asgn
I
obj='Var
pag=38
prev=O6586
var_op='asgn
I
obj='Var
pag=38
prev=O6585
var_op='asgn
I
obj='Var
pag=38
prev=O6584
var_op='asgn
I
obj='Var
pag=38
prev=O6583
var_op='asgn
I
obj='Var
pag=38
prev=O6582
var_op='asgn
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=38
prev=O6539
var_op='asgn
I
obj='Var
obj_type='N
pag=38
prev=O6538
var_op='asgn
I
obj='Var
obj_type='N
pag=38
prev=O6536
var_op='asgn
I
obj='Select
pag=38
par_expr=[
'Left(LRTrim(column03),4)
'Left(LRTrim(column04),2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O6535
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6536
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=38
prev=O6534
var_op='asgn
I
obj='Var
pag=38
prev=O6533
var_op='asgn
I
obj='Var
pag=38
prev=O6532
var_op='asgn
I
obj='Var
pag=38
prev=O6531
var_op='asgn
I
obj='Var
pag=38
prev=O6530
var_op='asgn
I
obj='Var
obj_type='D
pag=38
prev=O6527
var_op='asgn
I
obj='Case
pag=38
prev=O6526
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6527
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=38
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6527
fatherSonIndex=1
frm_calc=[
'LRTrim(column16) = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=38
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6659
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=38
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6659
fatherSonIndex=1
frm_calc='LRTrim(column16)
len=1
name='cFlagLire
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6527
fatherSonIndex=2
frm_calc='LRTrim(column16)
len=1
name='cFlagLire
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=38
prev=O6525
var_op='asgn
I
obj='Var
pag=38
prev=O6524
var_op='asgn
I
obj='Var
pag=38
prev=O6521
var_op='asgn
I
obj='If
pag=38
prev=O6520
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O6521
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=38
prev=O6673
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6674
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))+" con importo "+Str((Val(column19))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=38
prev=O6680
I
obj='Var
obj_type='N
pag=38
prev=O6679
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=38
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'column34
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=38
prev=O6519
var_op='asgn
I
obj='Remark
pag=38
prev=O6516
I
obj='If
pag=38
prev=O6514
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6516
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column29)+LRTrim(column31)+LRTrim(column30)))
]
h=[
19
19
]
obj='If
pag=38
prev=O6692
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6695
fatherSonIndex=0
frm_calc='LRTrim(column29)
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(column31)
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(column30)
len=2
name='_interprv
obj='Var
pag=38
prev=O6701
var_op='asgn
I
obj='Var
pag=38
prev=O6700
var_op='asgn
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O6691
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6692
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))+" con importo "+Str((Val(column19))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(column28)+" non è prensente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=38
prev=O6707
I
obj='Var
obj_type='N
pag=38
prev=O6706
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=38
prev=O6690
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'column28
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=38
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=38
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6514
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(column27)),_codinter,column27)
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column29)),_citinter,column29)
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column31)),_cabinter,column31)
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column30)),_prvinter,column30)
len=2
name='_interprv
obj='Var
pag=38
prev=O6719
var_op='asgn
I
obj='Var
pag=38
prev=O6718
var_op='asgn
I
obj='Var
pag=38
prev=O6717
var_op='asgn
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6508
fatherSonIndex=1
frm_calc='1
len=1
name='_opeerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(ohand,riga)
obj='Exec
pag=38
prev=O6723
I
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=38
prev=O6504
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O6506
fatherSonIndex=0
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column21)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column22))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column33))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column50))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(column21)) and Empty(LRTrim(column12)) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=38
prev=O6738
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6741
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O6735
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6738
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=38
prev=O6751
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6752
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=38
prev=O6750
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column50)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O6732
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6735
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=38
prev=O6767
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6768
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=38
prev=O6766
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column33)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O6729
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6732
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=38
prev=O6783
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6784
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=38
prev=O6782
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column22)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O6728
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6729
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=38
prev=O6799
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6800
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=38
prev=O6798
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column21)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=38
prev=O6502
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O6504
fatherSonIndex=0
frm_calc='a01.getContents()
len=25
name='column01
next=Icpitembatch.CPVarDecl
frm_calc='a02.getContents()
len=25
name='column02
next=Icpitembatch.CPVarDecl
frm_calc='a03.getContents()
len=25
name='column03
next=Icpitembatch.CPVarDecl
frm_calc='a04.getContents()
len=25
name='column04
next=Icpitembatch.CPVarDecl
frm_calc='a05.getContents()
len=25
name='column05
next=Icpitembatch.CPVarDecl
frm_calc='a06.getContents()
len=25
name='column06
next=Icpitembatch.CPVarDecl
frm_calc='a07.getContents()
len=25
name='column07
next=Icpitembatch.CPVarDecl
frm_calc='a08.getContents()
len=25
name='column08
next=Icpitembatch.CPVarDecl
frm_calc='a09.getContents()
len=25
name='column09
next=Icpitembatch.CPVarDecl
frm_calc='a10.getContents()
len=25
name='column10
next=Icpitembatch.CPVarDecl
frm_calc='a11.getContents()
len=25
name='column11
next=Icpitembatch.CPVarDecl
frm_calc='a12.getContents()
len=25
name='column12
next=Icpitembatch.CPVarDecl
frm_calc='a13.getContents()
len=25
name='column13
next=Icpitembatch.CPVarDecl
frm_calc='a14.getContents()
len=25
name='column14
next=Icpitembatch.CPVarDecl
frm_calc='a15.getContents()
len=25
name='column15
next=Icpitembatch.CPVarDecl
frm_calc='a16.getContents()
len=25
name='column16
next=Icpitembatch.CPVarDecl
frm_calc='a17.getContents()
len=25
name='column17
next=Icpitembatch.CPVarDecl
frm_calc='a18.getContents()
len=25
name='column18
next=Icpitembatch.CPVarDecl
frm_calc='a19.getContents()
len=25
name='column19
next=Icpitembatch.CPVarDecl
frm_calc='a20.getContents()
len=25
name='column20
next=Icpitembatch.CPVarDecl
frm_calc='a21.getContents()
len=25
name='column21
next=Icpitembatch.CPVarDecl
frm_calc='a22.getContents()
len=25
name='column22
next=Icpitembatch.CPVarDecl
frm_calc='a23.getContents()
len=25
name='column23
next=Icpitembatch.CPVarDecl
frm_calc='a24.getContents()
len=25
name='column24
next=Icpitembatch.CPVarDecl
frm_calc='a25.getContents()
len=25
name='column25
next=Icpitembatch.CPVarDecl
frm_calc='a26.getContents()
len=25
name='column26
next=Icpitembatch.CPVarDecl
frm_calc='a27.getContents()
len=25
name='column27
next=Icpitembatch.CPVarDecl
frm_calc='a28.getContents()
len=25
name='column28
next=Icpitembatch.CPVarDecl
frm_calc='a29.getContents()
len=25
name='column29
next=Icpitembatch.CPVarDecl
frm_calc='a30.getContents()
len=25
name='column30
next=Icpitembatch.CPVarDecl
frm_calc='a31.getContents()
len=25
name='column31
next=Icpitembatch.CPVarDecl
frm_calc='a32.getContents()
len=25
name='column32
next=Icpitembatch.CPVarDecl
frm_calc='a33.getContents()
len=25
name='column33
next=Icpitembatch.CPVarDecl
frm_calc='a34.getContents()
len=25
name='column34
next=Icpitembatch.CPVarDecl
frm_calc='a35.getContents()
len=25
name='column35
next=Icpitembatch.CPVarDecl
frm_calc='a36.getContents()
len=25
name='column36
next=Icpitembatch.CPVarDecl
frm_calc='a37.getContents()
len=25
name='column37
next=Icpitembatch.CPVarDecl
frm_calc='a38.getContents()
len=25
name='column38
next=Icpitembatch.CPVarDecl
frm_calc='a39.getContents()
len=25
name='column39
next=Icpitembatch.CPVarDecl
frm_calc='a40.getContents()
len=25
name='column40
next=Icpitembatch.CPVarDecl
frm_calc='a41.getContents()
len=25
name='column41
next=Icpitembatch.CPVarDecl
frm_calc='a42.getContents()
len=25
name='column42
next=Icpitembatch.CPVarDecl
frm_calc='a43.getContents()
len=25
name='column43
next=Icpitembatch.CPVarDecl
frm_calc='a44.getContents()
len=25
name='column44
next=Icpitembatch.CPVarDecl
frm_calc='a45.getContents()
len=25
name='column45
next=Icpitembatch.CPVarDecl
frm_calc='a46.getContents()
len=25
name='column46
next=Icpitembatch.CPVarDecl
frm_calc='a47.getContents()
len=25
name='column47
next=Icpitembatch.CPVarDecl
frm_calc='a48.getContents()
len=25
name='column48
next=Icpitembatch.CPVarDecl
frm_calc='a49.getContents()
len=25
name='column49
next=Icpitembatch.CPVarDecl
frm_calc='a50.getContents()
len=25
name='column50
next=Icpitembatch.CPVarDecl
frm_calc='a51.getContents()
len=25
name='column51
next=Icpitembatch.CPVarDecl
frm_calc='a52.getContents()
len=25
name='column52
next=Icpitembatch.CPVarDecl
frm_calc='a53.getContents()
len=25
name='column53
next=Icpitembatch.CPVarDecl
frm_calc='a54.getContents()
len=25
name='column54
next=Icpitembatch.CPVarDecl
frm_calc='a55.getContents()
len=25
name='column55
next=Icpitembatch.CPVarDecl
frm_calc='a56.getContents()
len=25
name='column56
next=Icpitembatch.CPVarDecl
frm_calc='a57.getContents()
len=25
name='column57
next=Icpitembatch.CPVarDecl
frm_calc='a58.getContents()
len=25
name='column58
next=Icpitembatch.CPVarDecl
frm_calc='a59.getContents()
len=25
name='column59
next=Icpitembatch.CPVarDecl
frm_calc='a60.getContents()
len=25
name='column60
next=Icpitembatch.CPVarDecl
frm_calc='a61.getContents()
len=25
name='column61
next=Icpitembatch.CPVarDecl
frm_calc='a62.getContents()
len=25
name='column62
next=Icpitembatch.CPVarDecl
frm_calc='a63.getContents()
len=25
name='column63
next=Icpitembatch.CPVarDecl
frm_calc='a64.getContents()
len=25
name='column64
next=Icpitembatch.CPVarDecl
frm_calc='a65.getContents()
len=25
name='column65
next=Icpitembatch.CPVarDecl
frm_calc='a66.getContents()
len=25
name='column66
next=Icpitembatch.CPVarDecl
frm_calc='a67.getContents()
len=25
name='column67
obj='Var
pag=38
prev=O6880
var_op='asgn
I
obj='Var
pag=38
prev=O6879
var_op='asgn
I
obj='Var
pag=38
prev=O6878
var_op='asgn
I
obj='Var
pag=38
prev=O6877
var_op='asgn
I
obj='Var
pag=38
prev=O6876
var_op='asgn
I
obj='Var
pag=38
prev=O6875
var_op='asgn
I
obj='Var
pag=38
prev=O6874
var_op='asgn
I
obj='Var
pag=38
prev=O6873
var_op='asgn
I
obj='Var
pag=38
prev=O6872
var_op='asgn
I
obj='Var
pag=38
prev=O6871
var_op='asgn
I
obj='Var
pag=38
prev=O6870
var_op='asgn
I
obj='Var
pag=38
prev=O6869
var_op='asgn
I
obj='Var
pag=38
prev=O6868
var_op='asgn
I
obj='Var
pag=38
prev=O6867
var_op='asgn
I
obj='Var
pag=38
prev=O6866
var_op='asgn
I
obj='Var
pag=38
prev=O6865
var_op='asgn
I
obj='Var
pag=38
prev=O6864
var_op='asgn
I
obj='Var
pag=38
prev=O6863
var_op='asgn
I
obj='Var
pag=38
prev=O6862
var_op='asgn
I
obj='Var
pag=38
prev=O6861
var_op='asgn
I
obj='Var
pag=38
prev=O6860
var_op='asgn
I
obj='Var
pag=38
prev=O6859
var_op='asgn
I
obj='Var
pag=38
prev=O6858
var_op='asgn
I
obj='Var
pag=38
prev=O6857
var_op='asgn
I
obj='Var
pag=38
prev=O6856
var_op='asgn
I
obj='Var
pag=38
prev=O6855
var_op='asgn
I
obj='Var
pag=38
prev=O6854
var_op='asgn
I
obj='Var
pag=38
prev=O6853
var_op='asgn
I
obj='Var
pag=38
prev=O6852
var_op='asgn
I
obj='Var
pag=38
prev=O6851
var_op='asgn
I
obj='Var
pag=38
prev=O6850
var_op='asgn
I
obj='Var
pag=38
prev=O6849
var_op='asgn
I
obj='Var
pag=38
prev=O6848
var_op='asgn
I
obj='Var
pag=38
prev=O6847
var_op='asgn
I
obj='Var
pag=38
prev=O6846
var_op='asgn
I
obj='Var
pag=38
prev=O6845
var_op='asgn
I
obj='Var
pag=38
prev=O6844
var_op='asgn
I
obj='Var
pag=38
prev=O6843
var_op='asgn
I
obj='Var
pag=38
prev=O6842
var_op='asgn
I
obj='Var
pag=38
prev=O6841
var_op='asgn
I
obj='Var
pag=38
prev=O6840
var_op='asgn
I
obj='Var
pag=38
prev=O6839
var_op='asgn
I
obj='Var
pag=38
prev=O6838
var_op='asgn
I
obj='Var
pag=38
prev=O6837
var_op='asgn
I
obj='Var
pag=38
prev=O6836
var_op='asgn
I
obj='Var
pag=38
prev=O6835
var_op='asgn
I
obj='Var
pag=38
prev=O6834
var_op='asgn
I
obj='Var
pag=38
prev=O6833
var_op='asgn
I
obj='Var
pag=38
prev=O6832
var_op='asgn
I
obj='Var
pag=38
prev=O6831
var_op='asgn
I
obj='Var
pag=38
prev=O6830
var_op='asgn
I
obj='Var
pag=38
prev=O6829
var_op='asgn
I
obj='Var
pag=38
prev=O6828
var_op='asgn
I
obj='Var
pag=38
prev=O6827
var_op='asgn
I
obj='Var
pag=38
prev=O6826
var_op='asgn
I
obj='Var
pag=38
prev=O6825
var_op='asgn
I
obj='Var
pag=38
prev=O6824
var_op='asgn
I
obj='Var
pag=38
prev=O6823
var_op='asgn
I
obj='Var
pag=38
prev=O6822
var_op='asgn
I
obj='Var
pag=38
prev=O6821
var_op='asgn
I
obj='Var
pag=38
prev=O6820
var_op='asgn
I
obj='Var
pag=38
prev=O6819
var_op='asgn
I
obj='Var
pag=38
prev=O6818
var_op='asgn
I
obj='Var
pag=38
prev=O6817
var_op='asgn
I
obj='Var
pag=38
prev=O6816
var_op='asgn
I
obj='Var
pag=38
prev=O6815
var_op='asgn
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=38
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPExec
check='man
father=O6502
fatherSonIndex=0
frm_calc="// Legge il contenuto delle celle
Cell a01 = sheet.getCell(0,_y);
Cell a02 = sheet.getCell(1,_y);
Cell a03 = sheet.getCell(2,_y);
Cell a04 = sheet.getCell(3,_y);
Cell a05 = sheet.getCell(4,_y);
Cell a06 = sheet.getCell(5,_y);
Cell a07 = sheet.getCell(6,_y);
Cell a08 = sheet.getCell(7,_y);
Cell a09 = sheet.getCell(8,_y);
Cell a10 = sheet.getCell(9,_y);
Cell a11 = sheet.getCell(10,_y);
Cell a12 = sheet.getCell(11,_y);
Cell a13 = sheet.getCell(12,_y);
Cell a14 = sheet.getCell(13,_y);
Cell a15 = sheet.getCell(14,_y);
Cell a16 = sheet.getCell(15,_y);
Cell a17 = sheet.getCell(16,_y);
Cell a18 = sheet.getCell(17,_y);
Cell a19 = sheet.getCell(18,_y);
Cell a20 = sheet.getCell(19,_y);
Cell a21 = sheet.getCell(20,_y);
Cell a22 = sheet.getCell(21,_y);
Cell a23 = sheet.getCell(22,_y);
Cell a24 = sheet.getCell(23,_y);
Cell a25 = sheet.getCell(24,_y);
Cell a26 = sheet.getCell(25,_y);
Cell a27 = sheet.getCell(26,_y);
Cell a28 = sheet.getCell(27,_y);
Cell a29 = sheet.getCell(28,_y);
Cell a30 = sheet.getCell(29,_y);
Cell a31 = sheet.getCell(30,_y);
Cell a32 = sheet.getCell(31,_y);
Cell a33 = sheet.getCell(32,_y);
Cell a34 = sheet.getCell(33,_y);
Cell a35 = sheet.getCell(34,_y);
Cell a36 = sheet.getCell(35,_y);
Cell a37 = sheet.getCell(36,_y);
Cell a38 = sheet.getCell(37,_y);
Cell a39 = sheet.getCell(38,_y);
Cell a40 = sheet.getCell(39,_y);
Cell a41 = sheet.getCell(40,_y);
Cell a42 = sheet.getCell(41,_y);
Cell a43 = sheet.getCell(42,_y);
Cell a44 = sheet.getCell(43,_y);
Cell a45 = sheet.getCell(44,_y);
Cell a46 = sheet.getCell(45,_y);
Cell a47 = sheet.getCell(46,_y);
Cell a48 = sheet.getCell(47,_y);
Cell a49 = sheet.getCell(48,_y);
Cell a50 = sheet.getCell(49,_y);
Cell a51 = sheet.getCell(50,_y);
Cell a52 = sheet.getCell(51,_y);
Cell a53 = sheet.getCell(52,_y);
Cell a54 = sheet.getCell(53,_y);
Cell a55 = sheet.getCell(54,_y);
Cell a56 = sheet.getCell(55,_y);
Cell a57 = sheet.getCell(56,_y);
Cell a58 = sheet.getCell(57,_y);
Cell a59 = sheet.getCell(58,_y);
Cell a60 = sheet.getCell(59,_y);
Cell a61 = sheet.getCell(60,_y);
Cell a62 = sheet.getCell(61,_y);
Cell a63 = sheet.getCell(62,_y);
Cell a64 = sheet.getCell(63,_y);
Cell a65 = sheet.getCell(64,_y);
Cell a66 = sheet.getCell(65,_y);
Cell a67 = sheet.getCell(66,_y);
°--°
obj='Exec
pag=38
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=38
I
I
]
w=[
150
150
]
I
obj='Exec
pag=38
prev=O6484
I
obj='Begin
pag=38
prev=O6483
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O6484
fatherSonIndex=0
frm_calc="//base
Workbook workbook = Workbook.getWorkbook(new File(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(nomefileimport)));
_conta = workbook.getNumberOfSheets();
°--°
obj='Exec
pag=38
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=38
prev=O6482
var_op='asgn
I
obj='Var
obj_type='N
pag=38
prev=O6481
var_op='asgn
I
obj='Var
obj_type='N
pag=38
prev=O6480
var_op='asgn
I
obj='Var
pag=38
pagelocal=True
prev=O6479
I
obj='Remark
pag=38
x=14
y=20
I
Icpitembatch.CPRead
arch='tbcauana
obj='Read
pag=38
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,10,4)
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
x=666
y=2343
I
Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + czipfile + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Inizio estrazione del file '+ czipfile
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/appo/"+czipfile
len=200
name='cpercorsozip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/appo/"
len=200
name='cdirectoryfile
next=Icpitembatch.CPExec
check='man
frm_calc="try {
      // Apro il file zip
      java.util.zip.ZipFile zf = new java.util.zip.ZipFile(cpercorsozip);

      //Conto il numero di file all interno del file zip e creo un array di stringhe per memorizzare i nomi file
      conteggio=zf.size();
      lista=new String[conteggio];
      
      // Enumerate each entry
      i=0;
      for (java.util.Enumeration entries = zf.entries(); entries.hasMoreElements();) {
          // Get the entry name
          lista[i] = ((java.util.zip.ZipEntry)entries.nextElement()).getName();
          i++;
      }
     zf.close();
     } catch (java.io.IOException e) {
     }
try {
      // Apro il file zip
      java.util.zip.ZipFile zf = new java.util.zip.ZipFile(cpercorsozip);

      byte[] buffer = new byte[1024]; 
      java.util.Enumeration entries = zf.entries();
      while(entries.hasMoreElements() ) {
        java.util.zip.ZipEntry entry = (java.util.zip.ZipEntry)entries.nextElement();
        java.io.InputStream in =zf.getInputStream(entry);
        java.io.OutputStream out = new java.io.BufferedOutputStream(new java.io.FileOutputStream(cdirectoryfile+entry.getName()));

        int len;

        while((len = in.read(buffer)) >= 0){
          out.write(buffer, 0, len);
        }

          in.close();
          out.close();
      }

      zf.close();
} catch (java.io.IOException ioe) {
      System.err.println("Unhandled exception:");
      ioe.printStackTrace();
      return;
}
°--°
next=Icpitembatch.CPDelete
arch='tmp_list_imprich
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='contanome
next=Icpitembatch.CPVarDecl
frm_calc='0
len=3
name='_priorita
next=Icpitembatch.CPWhile
frm_calc='contanome<conteggio
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+czipfile)
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine estrazione del file '+ czipfile
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +czipfile + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=39
prev=O6909
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=39
prev=O6908
var_op='asgn
I
obj='Exec
pag=39
prev=O6906
I
obj='While
pag=39
prev=O6905
sons=[
Icpitembatch.CPItemSon
comment='Assegnal apriorità ad ogni file e lo inserisce in tmp_list
instr=Icpitembatch.CPExec
check='man
father=O6906
fatherSonIndex=0
frm_calc='buffernomefile=lista[contanome];
next=Icpitembatch.CPInsert
arch='tmp_list_imprich
next=Icpitembatch.CPVarDecl
frm_calc='contanome+1
len=10
name='contanome
obj='Var
obj_type='N
pag=39
prev=O6914
var_op='asgn
I
obj='Insert
pag=39
prev=O6913
rd_kfield=[
'nomefile
]
rd_kvar=[
'buffernomefile
]
I
obj='Exec
pag=39
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=39
prev=O6904
var_op='asgn
I
obj='Var
obj_type='N
pag=39
prev=O6903
var_op='asgn
I
obj='Delete
pag=39
prev=O6902
rd_kfield=[
'nomefile
]
rd_kop=[
'=
]
rd_kvar=[
'czipfile
]
I
obj='Exec
pag=39
prev=O6901
I
obj='Var
pag=39
prev=O6900
var_op='asgn
I
obj='Var
pag=39
prev=O6899
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=39
prev=O6898
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=39
var_op='asgn
x=11
y=18
I
Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=4
sel_field='*
sel_name='xntestbo
sel_order='xntestbo->CPROWNUM
sel_where='xntestbo->RAPPORTO=Substr(riga,9,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6922
fatherSonIndex=0
frm_calc=[
'xntestbo->CODINTER=cCli1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=4
prev=O6926
var_op='asgn
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6926
fatherSonIndex=0
frm_calc='xntestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
x=1155
y=2003
I
]
ManualBlocks={
BO - Header
Icpmanualblocks.CPManualBlocks
code="import java.io.File; 
import java.lang.Double;
import java.util.*;
import jxl.*;
°--°
name='BO - Header
I
BO - Properties
Icpmanualblocks.CPManualBlocks
code="public String[] lista;
public int conteggio;
public int i;
public int _i;
public int _y;
public int contanome;
public int _righe;
public int _conta;
// These are the files to include in the ZIP file
Vector filenames = new Vector();
Vector fileonames = new Vector();
°--°
name='BO - Properties
I
}
comment='Importa i dati (NOZIP)
date_creat=#2006-06-20
date_rev=#2016-06-06
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'FileLibMit
'Utilities
'LibreriaMit
]
merge=True
modcnt=800
page_result_class=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
page_result_type=[
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
]
page_uid=[
'AHVZNXKOOX
'UKNWCURIZP
'VVERNPVGUJ
'NJDAPTIXHB
'NFQSTSMLAX
'RCTYUXDSQE
'CWXSSFAJKR
'VNWRBRKHOR
'LXYVCNDGXJ
'KBUDYHROVZ
'LYNZFJMARF
'BCDDIGVWEI
'NUVUGANGKH
'BCDBVDAIGN
'YWNGYQEOIM
'ODNUMZRUDM
'UQWVLYOUPO
'XYQTYCJDVF
'WPSSXVVPRN
'LCTYRIXNIR
'QFVUWDOVQJ
'EHJFKSDXAO
'KQLYCRCEND
'VWJMLMOSBD
'CRYCRJTMVP
'WXKLUXETTU
'TQQWCTNMUY
'WFXJLTAYZL
'JUYFDWZDHT
'FPPFVQERKU
'DHMUHURINX
'WYHNUACAYF
'DUMJTRBFGI
'RECUSIAFWL
'FOQQGPLWGB
'LBCELHVYJS
'QIPRKRDCMO
'GIQREITNVH
'JBOYCPPZUI
]
pagename=[
'Page_1
'Page_2
'Page_3
'Page_4
'Page_5
'Page_6
'Page_7
'Page_8
'Page_9
'Page_10
'Page_11
'Page_12
'Page_13
'Page_14
'Page_15
'Page_16
'Page_17
'Page_18
'Page_19
'Page_20
'Page_21
'Page_22
'Page_23
'Page_24
'Page_25
'Page_26
'Page_27
'Page_28
'Page_29
'Page_30
'Page_31
'Page_32
'Page_33
'Page_34
'Page_35
'Page_36
'Page_37
'Page_38
'Page_39
]
pagenote=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
pagetitle=[
'Main
'Soggetti
'Rapporti
'Informazioni
'Operazioni
'Frazionate
'Rapporti Provvisorio
'Informazioni Provvisorio
'Operazioni Provvisorio
'Frazionarie Provvisorio
'Rapporti Agenzia Entrate
'Informazioni Agenzia Entrate
'Operazioni Agenzia Entrate
'Dipendenze
'Titolari Effettivi
'Operazioni extraconto
'Procuratori/delegati su rapporto
'Soggetti operanti
'Intestatari
'Procuratori/delegati su rapporto Provvisorio
'Soggetti operanti Provvisorio
'Intestatari Provvisorio
'Procuratori/delegati su rapporto Agenzia Entrate
'Soggetti operanti Agenzia Entrate
'Intestatari Agenzia Entrate
'Altri Intestatari Rapporti
'Inserisce priorità sui nomi file
'Altri Beneficiari Operazioni
'Altri Soggetti Operanti Operazioni
'Modifiche Soggetti
'Movimento per AGE
'Controllo Anagrafiche
'Saldi Operazioni Extraconto
'Saldi Rapporti Continuativi
'Altri Titolari Effettivi
'Crea il file Zip
'Operazioni Definitive XLS
'Operazioni Provvisorie XLS
'Estrai zip
]
runtime_filters=2
tpl_name='Routine
work_file=[
'aeannora
'aeopcanc
'aeoprig
'aeopstor
'aetesta
'anadip
'anarapbo
'beneficfrz
'beneficope
'clientifrz
'clientiope
'cpwarn
'delegabo
'fiduciabo
'fraziobo
'intermbo
'intestbo
'intestit
'japopebo
'jelegabo
'jnarapbo
'jntestbo
'joginfo
'jogopebo
'jperazbo
'knarapbo
'meneficfrz
'meneficope
'merzistifrz
'merzistiope
'mlientifrz
'mlientiope
'mogopebo
'mogopefbo
'operazbo
'opextrbo
'personbo
'rapopebo
'rapotit
'soginfo
'sogopebo
'sogopefbo
'tbcauana
'tbcitta
'tbstgru
'tbvalute
'terzistifrz
'terzistiope
'titolabo
'titopers
'tmp_errimp
'tmp_list_imprich
'tmp_listafile
'wersonbo
'xapopebo
'xapotit
'xelegabo
'xeneficfrz
'xeneficope
'xerzistifrz
'xerzistiope
'xiduciabo
'xlientifrz
'xlientiope
'xnarapbo
'xntestbo
'xntestit
'xoginfo
'xogopebo
'xogopefbo
'xperazbo
'xraziobo
'inter2bo
'xersonbo
'xnadip
'xarchope
'xarchfraz
]
work_filter=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
I
*--*
*----*
