* --- CodePainter Revolution Batch Vers. 5.1
￼Icpbatch.CPBatch
Items=[
Icpitembatch.CPRemark
frm_calc='Formato Testo
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(pmcParametri.w_destfold)),LRTrim(_gPathApp)+"/export/"+LRTrim(_gAzienda)+"/"+LRTrim(_testa)+"_"+Left(_cfromdate,6)+".txt",LRTrim(pmcParametri.w_destfold)+"/"+LRTrim(_testa)+"_"+Left(_cfromdate,6)+".txt")
len=50
name='_nfile
next=Icpitembatch.CPExec
check='man
frm_calc='// These are the files to include in the ZIP file﷯filenames.add(CPLib.LRTrim(_nfile));﷯fileonames.add(CPLib.LRTrim(_testa)+"_"+CPLib.Left(_cfromdate,6)+".txt");
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWrite(_nfile)
len=10
name='fhand
next=Icpitembatch.CPBeginEnd
comment='Crea la prima riga
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Seleziona i record
next=Icpitembatch.CPExec
check='page
frm_calc='6
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.pTipo = 'B'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O11
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O12
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('./processi/EXT'+prcProg)
obj='Exec
pag=3
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O12
fatherSonIndex=1
frm_calc=''Elaborazione Terminata (' + LRTrim(Str(riga,10,0)) + ' movimenti).'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=3
prev=O10
I
obj='Exec
pag=3
prev=O9
I
obj='Remark
pag=3
prev=O7
I
obj='Begin
pag=3
prev=O6
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O7
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad("TIPO",8)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad("AGENZIA",41)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad("INDIRIZZO",36)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad("CITTA'",31)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad("IMPORTO",13)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad("NDG CLIENTE",17)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad("COGNOME CLIENTE",27)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad("NOME CLIENTE",26)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + "SESSO "
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad("LUOGO DI NASCITA",31)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + "DATA DI NASCITA "
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad("CODICE FISCALE",17)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + "DOCUMENTO "
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad("N° DOCUMENTO",16)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + "DATA RILASCIO "
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad("AUTORITA' DI RILASCIO",31)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad("CITTA' DI RESIDENZA",31)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad("INDIRIZZO",36)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + "STATO RESIDENZA "
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + "TIPO OPERAZIONE "
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + "CAUSALE ANALITICA "
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + "CAUSALE SINTETICA "
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + "SEGNO OPERAZIONE "
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + "DATA OPERAZIONE "
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad("NOMINATIVO CONTROPARTE",71)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + "STATO CONTROPARTE "
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + "N° OPERAZIONE "
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + "STATO REGISTRAZIONE "
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad("CODICE RAPPORTO",26)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + "DATA REGISTRAZIONE "
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + "FRAZIONATA/OPERAZIONE "
len=10
name='_file
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgWU='S'
]
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(fhand,_file)
obj='Exec
pag=3
prev=O54
I
obj='If
pag=3
prev=O53
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O54
fatherSonIndex=0
frm_calc='_file + LibreriaMit.SpacePad("MTCN",11)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + "MACROAGENTE "
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + "COD. AGENZIA "
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + "CODICE FISCALE FITTIZIO "
len=10
name='_file
obj='Var
obj_type='M
pag=3
prev=O62
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O61
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O60
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=3
prev=O52
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O51
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O50
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O49
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O48
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O47
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O46
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O45
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O44
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O43
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O42
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O41
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O40
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O39
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O38
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O37
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O36
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O35
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O34
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O33
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O32
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O31
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O30
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O29
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O28
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O27
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O26
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O25
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O24
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O23
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O5
var_op='asgn
I
obj='Exec
pag=3
prev=O4
I
obj='Var
pag=3
prev=O3
var_op='asgn
I
obj='Remark
pag=3
x=14
y=13
I
Icpitembatch.CPRemark
frm_calc='Database
next=Icpitembatch.CPExec
check='page
frm_calc='6
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Elaborazione Terminata (' + LRTrim(Str(riga,10,0)) + ' movimenti).'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=4
prev=O67
var_op='asgn
I
obj='Exec
pag=4
prev=O66
I
obj='Remark
pag=4
x=13
y=23
I
Icpitembatch.CPBeginEnd
comment='Apro il foglio //e verifico quante pagine ha
h=[
19
19
]
next=Icpitembatch.CPWhile
frm_calc='_i < conta
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='// Cancella il file excel di input﷯ExcelFileToRead.close();﷯FileLibMit.DeleteFilePath(CPLib.LRTrim(_gPathApp)+"/appo/"+CPLib.LRTrim(_gAzienda)+"/"+CPLib.LRTrim(_nomefile));
obj='Exec
pag=7
prev=O71
I
obj='While
pag=7
prev=O69
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O71
fatherSonIndex=0
frm_calc='//Apro uno ad uno i fogli del file Excel﷯XSSFSheet sheet = wb.getSheetAt(_i);﷯//Mi definisco un oggetto che contiene tutte le righe﷯Iterator rows = sheet.rowIterator();﷯//_righe = sheet.getLastRowNum()+1;﷯//_y = 1;
next=Icpitembatch.CPWhile
frm_calc='rows.hasNext()
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=7
prev=O77
I
obj='While
pag=7
prev=O76
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O77
fatherSonIndex=0
frm_calc='//scorro le righe﷯row=(XSSFRow) rows.next();﷯//Mi definisco un oggetto che contiene tutte le celle della riga letta﷯Iterator cells = row.cellIterator();
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='cell_count
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel
frm_calc='riga_letta+1
len=9
name='riga_letta
next=Icpitembatch.CPWhile
frm_calc='cells.hasNext() and riga_letta>1
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.w_tipofile='1'
'pmcParametri.w_tipofile='2'
]
h=[
19
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(not(Empty(LRTrim(_mtcn))) and pmcParametri.w_tipofile='1') or (not(Empty(LRTrim(codfisc))) and pmcParametri.w_tipofile='2')
]
h=[
19
19
]
obj='If
pag=7
prev=O87
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tmp_mtcn_cf
father=O90
fatherSonIndex=0
obj='Insert
pag=7
rd_kfield=[
'MTCN
'CODFISC
]
rd_kvar=[
'_mtcn
'codfisc
]
I
I
]
w=[
150
150
]
I
obj='If
pag=7
prev=O85
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O87
fatherSonIndex=0
frm_calc='Left(LRTrim(column01),10)
len=10
name='_mtcn
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='codfisc
obj='Var
pag=7
prev=O101
var_op='asgn
I
obj='Var
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O87
fatherSonIndex=1
frm_calc='Left(LRTrim(column01),16)
len=16
name='codfisc
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_mtcn
obj='Var
pag=7
prev=O104
var_op='asgn
I
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='While
pag=7
prev=O84
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O85
fatherSonIndex=0
frm_calc='//scorro le celle della riga﷯cell=(XSSFCell) cells.next();
next=Icpitembatch.CPVarDecl
frm_calc='cell_count+1
len=9
name='cell_count
next=Icpitembatch.CPVarDecl
frm_calc='cell.getStringCellValue()
len=25
name='column01
obj='Var
pag=7
prev=O110
var_op='asgn
I
obj='Var
obj_type='N
pag=7
prev=O109
var_op='asgn
I
obj='Exec
pag=7
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=7
prev=O83
var_op='asgn
I
obj='Var
obj_type='N
pag=7
prev=O82
var_op='asgn
I
obj='Exec
pag=7
I
I
]
w=[
150
150
]
I
obj='Exec
pag=7
I
I
]
w=[
150
150
]
I
obj='Begin
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O69
fatherSonIndex=0
frm_calc='//base﷯InputStream ExcelFileToRead = new FileInputStream(CPLib.LRTrim(_gPathApp)+"/appo/"+CPLib.LRTrim(_gAzienda)+"/"+CPLib.LRTrim(_nomefile));﷯XSSFWorkbook  wb = new XSSFWorkbook(ExcelFileToRead);﷯﷯conta = wb.getNumberOfSheets();﷯﷯//XSSFWorkbook test = new XSSFWorkbook(); ﷯﷯//XSSFSheet sheet = wb.getSheetAt(0);﷯XSSFRow row; ﷯XSSFCell cell;﷯﷯XSSFRow row2; ﷯XSSFCell cell2;﷯﷯//Iterator rows = sheet.rowIterator();﷯﷯_i =0;
obj='Exec
pag=7
I
I
]
w=[
150
150
]
x=12
y=19
I
Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.w_flgsto='N'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPSelect
father=O119
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=13
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=_ndg
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O124
fatherSonIndex=0
frm_calc='iif(personbo->CFESTERO=1 and pmcParametri.w_flgncf='S','',personbo->CODFISC)
len=16
name='codfisc
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(personbo->SESSO)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='personbo->NOME
len=30
name='_nomman
next=Icpitembatch.CPVarDecl
frm_calc='personbo->NASCOMUN
len=40
name='citnas
next=Icpitembatch.CPVarDecl
frm_calc='personbo->TIPINTER
len=2
name='prvnas
next=Icpitembatch.CPVarDecl
frm_calc='personbo->NASSTATO
len=40
name='stanas
next=Icpitembatch.CPVarDecl
frm_calc='iif(personbo->SESSO='1','Uomo',iif(personbo->SESSO='2','Donna',''))
len=40
name='sesso
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(personbo->DATANASC)
len=8
name='datnas
next=Icpitembatch.CPVarDecl
frm_calc='personbo->DATANASC
len=8
name='_datnas
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fdate(personbo->DATANASC)
len=10
name='f_datnas
next=Icpitembatch.CPVarDecl
frm_calc='iif(prvnas='EE' or prvnas='',stanas,citnas)
len=40
name='_luonas
next=Icpitembatch.CPVarDecl
frm_calc='personbo->DOMICILIO
len=35
name='indirizzo
next=Icpitembatch.CPVarDecl
frm_calc='personbo->DESCCIT
len=40
name='citres
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(personbo->CAP),5)
len=5
name='capres
next=Icpitembatch.CPVarDecl
frm_calc='personbo->PROVINCIA
len=2
name='prvres
next=Icpitembatch.CPVarDecl
frm_calc='''
len=40
name='stares
next=Icpitembatch.CPVarDecl
frm_calc='personbo->PAESE
len=3
name='_codstar
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTBSTATI.GoToKey(_codstar)
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_tipdoc
next=Icpitembatch.CPVarDecl
frm_calc='personbo->TIPODOC
len=2
name='tipdoc
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTBTIPDOC.GoToKey(tipdoc)
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fdate(personbo->DATARILASC)
len=10
name='f_datdoc
next=Icpitembatch.CPVarDecl
frm_calc='personbo->DATARILASC
len=8
name='_datadoc
next=Icpitembatch.CPVarDecl
frm_calc='personbo->AUTRILASC
len=30
name='_autril
next=Icpitembatch.CPVarDecl
frm_calc='personbo->NUMDOCUM
len=20
name='_numdoc
next=Icpitembatch.CPVarDecl
frm_calc='iif(personbo->CFESTERO=1,'SI','NO')
len=2
name='_cfestero
obj='Var
pag=13
prev=O158
var_op='asgn
I
obj='Var
pag=13
prev=O157
var_op='asgn
I
obj='Var
pag=13
prev=O156
var_op='asgn
I
obj='Var
obj_type='D
pag=13
prev=O155
var_op='asgn
I
obj='Var
pag=13
prev=O152
var_op='asgn
I
obj='If
pag=13
prev=O151
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O152
fatherSonIndex=0
frm_calc='mcTBTIPDOC.DESCRI
len=20
name='_tipdoc
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
prev=O150
var_op='asgn
I
obj='Var
pag=13
prev=O147
var_op='asgn
I
obj='If
pag=13
prev=O146
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O147
fatherSonIndex=0
frm_calc='mcTBSTATI.DESCRI
len=40
name='stares
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
prev=O145
var_op='asgn
I
obj='Var
pag=13
prev=O144
var_op='asgn
I
obj='Var
pag=13
prev=O143
var_op='asgn
I
obj='Var
pag=13
prev=O142
var_op='asgn
I
obj='Var
pag=13
prev=O141
var_op='asgn
I
obj='Var
pag=13
prev=O140
var_op='asgn
I
obj='Var
pag=13
prev=O139
var_op='asgn
I
obj='Var
pag=13
prev=O138
var_op='asgn
I
obj='Var
obj_type='D
pag=13
prev=O137
var_op='asgn
I
obj='Var
pag=13
prev=O136
var_op='asgn
I
obj='Var
pag=13
prev=O135
var_op='asgn
I
obj='Var
pag=13
prev=O134
var_op='asgn
I
obj='Var
pag=13
prev=O133
var_op='asgn
I
obj='Var
pag=13
prev=O132
var_op='asgn
I
obj='Var
pag=13
prev=O129
var_op='asgn
I
obj='If
pag=13
prev=O128
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O129
fatherSonIndex=0
frm_calc='LRTrim(personbo->RAGSOC)
len=30
name='_cogman
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O129
fatherSonIndex=1
frm_calc='personbo->COGNOME
len=30
name='_cogman
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O119
fatherSonIndex=1
frm_calc='arfn_chkspers(_ndg,iif(_stator='1',_datarett,_datareg))
len=15
name='_numsto
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_numsto))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
prev=O176
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O177
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=13
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=_ndg
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O182
fatherSonIndex=0
frm_calc='iif(personbo->CFESTERO=1 and pmcParametri.w_flgncf='S','',personbo->CODFISC)
len=16
name='codfisc
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(personbo->SESSO)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='personbo->NOME
len=30
name='_nomman
next=Icpitembatch.CPVarDecl
frm_calc='personbo->NASCOMUN
len=40
name='citnas
next=Icpitembatch.CPVarDecl
frm_calc='personbo->TIPINTER
len=2
name='prvnas
next=Icpitembatch.CPVarDecl
frm_calc='personbo->NASSTATO
len=40
name='stanas
next=Icpitembatch.CPVarDecl
frm_calc='iif(personbo->SESSO='1','Uomo',iif(personbo->SESSO='2','Donna',''))
len=40
name='sesso
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(personbo->DATANASC)
len=8
name='datnas
next=Icpitembatch.CPVarDecl
frm_calc='personbo->DATANASC
len=8
name='_datnas
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fdate(personbo->DATANASC)
len=10
name='f_datnas
next=Icpitembatch.CPVarDecl
frm_calc='iif(prvnas='EE' or prvnas='',stanas,citnas)
len=40
name='_luonas
next=Icpitembatch.CPVarDecl
frm_calc='personbo->DOMICILIO
len=35
name='indirizzo
next=Icpitembatch.CPVarDecl
frm_calc='personbo->DESCCIT
len=40
name='citres
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(personbo->CAP),5)
len=5
name='capres
next=Icpitembatch.CPVarDecl
frm_calc='personbo->PROVINCIA
len=2
name='prvres
next=Icpitembatch.CPVarDecl
frm_calc='''
len=40
name='stares
next=Icpitembatch.CPVarDecl
frm_calc='personbo->PAESE
len=3
name='_codstar
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTBSTATI.GoToKey(_codstar)
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='personbo->TIPODOC
len=2
name='tipdoc
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_tipdoc
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTBTIPDOC.GoToKey(tipdoc)
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fdate(personbo->DATARILASC)
len=10
name='f_datdoc
next=Icpitembatch.CPVarDecl
frm_calc='personbo->DATARILASC
len=8
name='_datadoc
next=Icpitembatch.CPVarDecl
frm_calc='personbo->AUTRILASC
len=30
name='_autril
next=Icpitembatch.CPVarDecl
frm_calc='personbo->NUMDOCUM
len=20
name='_numdoc
next=Icpitembatch.CPVarDecl
frm_calc='iif(personbo->CFESTERO=1,'SI','NO')
len=2
name='_cfestero
obj='Var
pag=13
prev=O216
var_op='asgn
I
obj='Var
pag=13
prev=O215
var_op='asgn
I
obj='Var
pag=13
prev=O214
var_op='asgn
I
obj='Var
obj_type='D
pag=13
prev=O213
var_op='asgn
I
obj='Var
pag=13
prev=O210
var_op='asgn
I
obj='If
pag=13
prev=O209
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O210
fatherSonIndex=0
frm_calc='mcTBTIPDOC.DESCRI
len=20
name='_tipdoc
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
prev=O208
var_op='asgn
I
obj='Var
pag=13
prev=O205
var_op='asgn
I
obj='If
pag=13
prev=O204
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O205
fatherSonIndex=0
frm_calc='mcTBSTATI.DESCRI
len=40
name='stares
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
prev=O203
var_op='asgn
I
obj='Var
pag=13
prev=O202
var_op='asgn
I
obj='Var
pag=13
prev=O201
var_op='asgn
I
obj='Var
pag=13
prev=O200
var_op='asgn
I
obj='Var
pag=13
prev=O199
var_op='asgn
I
obj='Var
pag=13
prev=O198
var_op='asgn
I
obj='Var
pag=13
prev=O197
var_op='asgn
I
obj='Var
pag=13
prev=O196
var_op='asgn
I
obj='Var
obj_type='D
pag=13
prev=O195
var_op='asgn
I
obj='Var
pag=13
prev=O194
var_op='asgn
I
obj='Var
pag=13
prev=O193
var_op='asgn
I
obj='Var
pag=13
prev=O192
var_op='asgn
I
obj='Var
pag=13
prev=O191
var_op='asgn
I
obj='Var
pag=13
prev=O190
var_op='asgn
I
obj='Var
pag=13
prev=O187
var_op='asgn
I
obj='If
pag=13
prev=O186
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O187
fatherSonIndex=0
frm_calc='LRTrim(personbo->RAGSOC)
len=30
name='_cogman
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O187
fatherSonIndex=1
frm_calc='personbo->COGNOME
len=30
name='_cogman
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O177
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=13
sel_field='*
sel_name='wersonbo
sel_where='wersonbo->sanumpro=_numsto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O234
fatherSonIndex=0
frm_calc='iif(wersonbo->CFESTERO=1 and pmcParametri.w_flgncf='S','',wersonbo->CODFISC)
len=16
name='codfisc
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(wersonbo->SESSO)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='wersonbo->NOME
len=30
name='_nomman
next=Icpitembatch.CPVarDecl
frm_calc='wersonbo->NASCOMUN
len=40
name='citnas
next=Icpitembatch.CPVarDecl
frm_calc='wersonbo->TIPINTER
len=2
name='prvnas
next=Icpitembatch.CPVarDecl
frm_calc='wersonbo->NASSTATO
len=40
name='stanas
next=Icpitembatch.CPVarDecl
frm_calc='iif(wersonbo->SESSO='1','Uomo',iif(wersonbo->SESSO='2','Donna',''))
len=40
name='sesso
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(wersonbo->DATANASC)
len=8
name='datnas
next=Icpitembatch.CPVarDecl
frm_calc='wersonbo->DATANASC
len=8
name='_datnas
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fdate(wersonbo->DATANASC)
len=10
name='f_datnas
next=Icpitembatch.CPVarDecl
frm_calc='iif(prvnas='EE' or prvnas='',stanas,citnas)
len=40
name='_luonas
next=Icpitembatch.CPVarDecl
frm_calc='wersonbo->DOMICILIO
len=35
name='indirizzo
next=Icpitembatch.CPVarDecl
frm_calc='wersonbo->DESCCIT
len=40
name='citres
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(wersonbo->CAP),5)
len=5
name='capres
next=Icpitembatch.CPVarDecl
frm_calc='wersonbo->PROVINCIA
len=2
name='prvres
next=Icpitembatch.CPVarDecl
frm_calc='''
len=40
name='stares
next=Icpitembatch.CPVarDecl
frm_calc='wersonbo->PAESE
len=3
name='_codstar
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTBSTATI.GoToKey(_codstar)
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='wersonbo->TIPODOC
len=2
name='tipdoc
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_tipdoc
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTBTIPDOC.GoToKey(tipdoc)
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fdate(wersonbo->DATARILASC)
len=10
name='f_datdoc
next=Icpitembatch.CPVarDecl
frm_calc='wersonbo->DATARILASC
len=8
name='_datadoc
next=Icpitembatch.CPVarDecl
frm_calc='wersonbo->AUTRILASC
len=30
name='_autril
next=Icpitembatch.CPVarDecl
frm_calc='wersonbo->NUMDOCUM
len=20
name='_numdoc
next=Icpitembatch.CPVarDecl
frm_calc='iif(wersonbo->CFESTERO=1,'SI','NO')
len=2
name='_cfestero
obj='Var
pag=13
prev=O268
var_op='asgn
I
obj='Var
pag=13
prev=O267
var_op='asgn
I
obj='Var
pag=13
prev=O266
var_op='asgn
I
obj='Var
obj_type='D
pag=13
prev=O265
var_op='asgn
I
obj='Var
pag=13
prev=O262
var_op='asgn
I
obj='If
pag=13
prev=O261
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O262
fatherSonIndex=0
frm_calc='mcTBTIPDOC.DESCRI
len=20
name='_tipdoc
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
prev=O260
var_op='asgn
I
obj='Var
pag=13
prev=O257
var_op='asgn
I
obj='If
pag=13
prev=O256
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O257
fatherSonIndex=0
frm_calc='mcTBSTATI.DESCRI
len=40
name='stares
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
prev=O255
var_op='asgn
I
obj='Var
pag=13
prev=O254
var_op='asgn
I
obj='Var
pag=13
prev=O253
var_op='asgn
I
obj='Var
pag=13
prev=O252
var_op='asgn
I
obj='Var
pag=13
prev=O251
var_op='asgn
I
obj='Var
pag=13
prev=O250
var_op='asgn
I
obj='Var
pag=13
prev=O249
var_op='asgn
I
obj='Var
pag=13
prev=O248
var_op='asgn
I
obj='Var
obj_type='D
pag=13
prev=O247
var_op='asgn
I
obj='Var
pag=13
prev=O246
var_op='asgn
I
obj='Var
pag=13
prev=O245
var_op='asgn
I
obj='Var
pag=13
prev=O244
var_op='asgn
I
obj='Var
pag=13
prev=O243
var_op='asgn
I
obj='Var
pag=13
prev=O242
var_op='asgn
I
obj='Var
pag=13
prev=O239
var_op='asgn
I
obj='If
pag=13
prev=O238
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O239
fatherSonIndex=0
frm_calc='LRTrim(wersonbo->RAGSOC)
len=30
name='_cogman
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O239
fatherSonIndex=1
frm_calc='wersonbo->COGNOME
len=30
name='_cogman
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
x=17
y=18
I
Icpitembatch.CPRemark
frm_calc='Formato CSV
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(pmcParametri.w_destfold)),LRTrim(_gPathApp)+"/export/"+LRTrim(_gAzienda)+"/"+LRTrim(_testa)+"_"+Left(_cfromdate,6)+".csv",LRTrim(pmcParametri.w_destfold)+"/"+LRTrim(_testa)+"_"+Left(_cfromdate,6)+".csv")
len=50
name='_nfile
next=Icpitembatch.CPExec
check='man
frm_calc='// These are the files to include in the ZIP file﷯filenames.add(CPLib.LRTrim(_nfile));﷯fileonames.add(CPLib.LRTrim(_testa)+"_"+CPLib.Left(_cfromdate,6)+".csv");
next=Icpitembatch.CPExec
check='man
frm_calc='// Creazione del writer﷯cwriter=new CSVWriter(new FileWriter(_nfile));
next=Icpitembatch.CPBeginEnd
comment='Crea la prima riga
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Seleziona i record
next=Icpitembatch.CPExec
check='page
frm_calc='6
next=Icpitembatch.CPExec
frm_calc='cwriter.close()
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.pTipo = 'B'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O295
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O296
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('./processi/EXT'+prcProg)
obj='Exec
pag=5
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O296
fatherSonIndex=1
frm_calc=''Elaborazione Terminata (' + LRTrim(Str(riga,10,0)) + ' movimenti).'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=5
prev=O294
I
obj='Exec
pag=5
prev=O293
I
obj='Remark
pag=5
prev=O291
I
obj='Begin
pag=5
prev=O290
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O291
fatherSonIndex=0
frm_calc='// Creazione della prima riga﷯ncampi=(CPLib.eqr(gFlgWU,"S")?40:38);﷯campi = new String[ncampi];﷯campi[0]="INTERMEDIARIO";﷯campi[1]="TIPO";﷯campi[2]="CODICE AGENZIA";﷯campi[3]="AGENZIA";﷯campi[4]="INDIRIZZO";﷯campi[5]="CITTA";﷯campi[6]="PROVINCIA";﷯campi[7]="IMPORTO";﷯campi[8]="NDG CLIENTE";﷯campi[9]="COGNOME CLIENTE/RAGIONE SOCIALE";﷯campi[10]="NOME CLIENTE";﷯campi[11]="SESSO";﷯campi[12]="STATO DI NASCITA";﷯campi[13]="COMUNE DI NASCITA";﷯campi[14]="PROVINCIA DI NASCITA";﷯campi[15]="DATA DI NASCITA";﷯campi[16]="CODICE FISCALE";﷯campi[17]="DOCUMENTO";﷯campi[18]="N. DOCUMENTO";﷯campi[19]="DATA DI RILASCIO";﷯campi[20]="AUTORITA DI RILASCIO";﷯campi[21]="STATO DI RESIDENZA";﷯campi[22]="CITTA DI RESIDENZA";﷯campi[23]="PROVINCIA DI RESIDENZA";﷯campi[24]="INDIRIZZO RESIDENZA";﷯campi[25]="TIPO OPERAZIONE";﷯campi[26]="CAUSALE ANALITICA";﷯campi[27]="CAUSALE SINTETICA";﷯campi[28]="SEGNO OPERAZIONE";﷯campi[29]="DATA OPERAZIONE";﷯campi[30]="NOMINATIVO CONTROPARTE";﷯campi[31]="STATO CONTROPARTE";﷯campi[32]="N. OPERAZIONE";﷯campi[33]="STATO REGISTRAZIONE";﷯campi[34]="CODICE RAPPORTO";﷯campi[35]="DATA REGISTRAZIONE";﷯campi[36]="FRAZIONATA/OPERAZIONE";
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgWU='S'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPExec
frm_calc='cwriter.writeNext(campi)
obj='Exec
pag=5
prev=O308
I
obj='If
pag=5
prev=O307
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O308
fatherSonIndex=0
frm_calc=[
'pmcParametri.w_flgncf='N'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O314
fatherSonIndex=0
frm_calc='// CAmpi WU﷯campi[37]="CODICE FISCALE FITTIZIO";﷯campi[38]="MTCN";﷯campi[39]="MACROAGENTE";﷯campi[40]="AJW CODE";
obj='Exec
pag=5
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O314
fatherSonIndex=1
frm_calc='// CAmpi WU﷯campi[37]="MTCN";﷯campi[38]="MACROAGENTE";﷯campi[39]="AJW CODE";
obj='Exec
pag=5
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O308
fatherSonIndex=1
frm_calc=[
'pmcParametri.w_flgncf='N'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O324
fatherSonIndex=0
frm_calc='// CAmpi No WU﷯campi[37]="CODICE FISCALE FITTIZIO";﷯campi[38]="RIFERIMENTO";
obj='Exec
pag=5
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O324
fatherSonIndex=1
frm_calc='// CAmpi No WU﷯campi[37]="RIFERIMENTO";
obj='Exec
pag=5
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=5
I
I
]
w=[
150
150
]
I
obj='Exec
pag=5
prev=O289
I
obj='Exec
pag=5
prev=O288
I
obj='Var
pag=5
prev=O287
var_op='asgn
I
obj='Remark
pag=5
x=12
y=18
I
Icpitembatch.CPRemark
frm_calc='Formato Excel
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(pmcParametri.w_destfold)),LRTrim(_gPathApp)+"/export/"+LRTrim(_gAzienda)+"/"+LRTrim(_testa)+"_"+Left(_cfromdate,6)+".xlsx",LRTrim(pmcParametri.w_destfold)+"/"+LRTrim(_testa)+"_"+Left(_cfromdate,6)+".xlsx")
len=50
name='_nfile
next=Icpitembatch.CPExec
check='man
frm_calc='// These are the files to include in the ZIP file﷯filenames.add(CPLib.LRTrim(_nfile));﷯fileonames.add(CPLib.LRTrim(_testa)+"_"+CPLib.Left(_cfromdate,6)+".xlsx");
next=Icpitembatch.CPRemark
frm_calc='Seleziona i record
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='riga
next=Icpitembatch.CPBeginEnd
comment='Creo file per risultati
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Crea la prima riga
h=[
19
19
]
next=Icpitembatch.CPExec
check='page
frm_calc='6
next=Icpitembatch.CPBeginEnd
comment='Creazione file excel
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.pTipo = 'B'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O345
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O347
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('./processi/EXT'+prcProg)
obj='Exec
pag=2
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O347
fatherSonIndex=1
frm_calc=''Elaborazione Terminata (' + LRTrim(Str(riga,10,0)) + ' movimenti).'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=2
prev=O344
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O345
fatherSonIndex=0
frm_calc=''Attendere. Creazione del file excel ...'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPExec
check='man
frm_calc='//Ridimensiono le colonne in base al contenuto﷯sheet.autoSizeColumn(0);﷯sheet.autoSizeColumn(1);﷯sheet.autoSizeColumn(2);﷯sheet.autoSizeColumn(3);﷯sheet.autoSizeColumn(4);﷯sheet.autoSizeColumn(5);﷯sheet.autoSizeColumn(6);﷯sheet.autoSizeColumn(7);﷯sheet.autoSizeColumn(8);﷯sheet.autoSizeColumn(9);﷯sheet.autoSizeColumn(10);﷯sheet.autoSizeColumn(11);﷯sheet.autoSizeColumn(12);﷯sheet.autoSizeColumn(13);﷯sheet.autoSizeColumn(14);﷯sheet.autoSizeColumn(15);﷯sheet.autoSizeColumn(16);﷯sheet.autoSizeColumn(17);﷯sheet.autoSizeColumn(18);﷯sheet.autoSizeColumn(19);﷯sheet.autoSizeColumn(20);﷯sheet.autoSizeColumn(21);﷯sheet.autoSizeColumn(22);﷯sheet.autoSizeColumn(23);﷯sheet.autoSizeColumn(24);﷯sheet.autoSizeColumn(25);﷯sheet.autoSizeColumn(26);﷯sheet.autoSizeColumn(27);﷯sheet.autoSizeColumn(28);﷯sheet.autoSizeColumn(29);﷯sheet.autoSizeColumn(30);﷯sheet.autoSizeColumn(31);﷯sheet.autoSizeColumn(32);﷯sheet.autoSizeColumn(33);﷯sheet.autoSizeColumn(34);﷯sheet.autoSizeColumn(35);﷯sheet.autoSizeColumn(36);
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgWU='S'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPExec
check='man
frm_calc='// scrivo il file di esito﷯FileOutputStream fileOut = new FileOutputStream(CPLib.LRTrim(_nfile));﷯﷯//write this workbook to an Outputstream.﷯wb.write(fileOut);﷯fileOut.flush();﷯fileOut.close();
obj='Exec
pag=2
prev=O360
I
obj='If
pag=2
prev=O359
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O360
fatherSonIndex=0
frm_calc='// Scrive MTCN e MacroAgente per WU﷯sheet.autoSizeColumn(37);﷯sheet.autoSizeColumn(38);﷯sheet.autoSizeColumn(39);
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.w_flgncf='N'
]
h=[
19
19
]
obj='If
pag=2
prev=O366
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O367
fatherSonIndex=0
frm_calc='// Scrive MTCN e MacroAgente per WU﷯sheet.autoSizeColumn(40);
obj='Exec
pag=2
I
I
]
w=[
150
150
]
I
obj='Exec
pag=2
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O360
fatherSonIndex=1
frm_calc=[
'pmcParametri.w_flgncf='N'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O375
fatherSonIndex=0
frm_calc='// Scrive MTCN e MacroAgente per WU﷯sheet.autoSizeColumn(37);﷯sheet.autoSizeColumn(38);﷯sheet.autoSizeColumn(39);
obj='Exec
pag=2
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O375
fatherSonIndex=1
frm_calc='// Scrive MTCN e MacroAgente per WU﷯sheet.autoSizeColumn(37);﷯sheet.autoSizeColumn(38);
obj='Exec
pag=2
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=2
prev=O358
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Exec
pag=2
prev=O342
I
obj='Begin
pag=2
prev=O340
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O342
fatherSonIndex=0
frm_calc='//Azzero i contatori di fogli letti e righe scritte﷯_i = 0;﷯r=0;﷯//Creo il record da scrivere﷯row = sheet.createRow(r);﷯//scrivo la riga di intestazione﷯cell =  row.createCell(0);﷯cell.setCellValue("INTERMEDIARIO");﷯cell.setCellStyle(cs);﷯cell =  row.createCell(1);﷯cell.setCellValue("TIPO");﷯cell.setCellStyle(cs);﷯cell = row.createCell(2);﷯cell.setCellValue("Codice AGENZIA");﷯cell.setCellStyle(cs);﷯cell = row.createCell(3);﷯cell.setCellValue("AGENZIA");﷯cell.setCellStyle(cs);﷯cell =  row.createCell(4);﷯cell.setCellValue("INDIRIZZO");﷯cell.setCellStyle(cs);﷯cell =  row.createCell(5);﷯cell.setCellValue("CITTA'");﷯cell.setCellStyle(cs);﷯cell =  row.createCell(6);﷯cell.setCellValue("PROVINCIA'");﷯cell.setCellStyle(cs);﷯cell =  row.createCell(7);﷯cell.setCellValue("IMPORTO TRASFERITO");﷯cell.setCellStyle(cs);﷯cell =  row.createCell(8);﷯cell.setCellValue("NDG CLIENTE");﷯cell.setCellStyle(cs);﷯cell =  row.createCell(9);﷯cell.setCellValue("COGNOME/RAGIONE SOCIALE CLIENTE");﷯cell.setCellStyle(cs);﷯cell = row.createCell(10);﷯cell.setCellValue("NOME CLIENTE");﷯cell.setCellStyle(cs);﷯cell = row.createCell(11);﷯cell.setCellValue("SESSO");﷯cell.setCellStyle(cs);﷯cell = row.createCell(12);﷯cell.setCellValue("STATO DI NASCITA");﷯cell.setCellStyle(cs);﷯cell = row.createCell(13);﷯cell.setCellValue("COMUNE DI NASCITA");﷯cell.setCellStyle(cs);﷯cell = row.createCell(14);﷯cell.setCellValue("PROVINCIA DI NASCITA");﷯cell.setCellStyle(cs);﷯cell = row.createCell(15);﷯cell.setCellValue("DATA DI NASCITA");﷯cell.setCellStyle(cs);﷯cell = row.createCell(16);﷯cell.setCellValue("CODICE FISCALE");﷯cell.setCellStyle(cs);﷯cell = row.createCell(17);﷯cell.setCellValue("DOCUMENTO");﷯cell.setCellStyle(cs);﷯cell = row.createCell(18);﷯cell.setCellValue("N° DOCUMENTO");﷯cell.setCellStyle(cs);﷯cell = row.createCell(19);﷯cell.setCellValue("DATA DI RILASCIO");﷯cell.setCellStyle(cs);﷯cell = row.createCell(20);﷯cell.setCellValue("AUTORITA' DI RILASCIO");﷯cell.setCellStyle(cs);﷯cell = row.createCell(21);﷯cell.setCellValue("STATO RESIDENZA");﷯cell.setCellStyle(cs);﷯cell = row.createCell(22);﷯cell.setCellValue("CITTA' RESIDENZA");﷯cell.setCellStyle(cs);﷯cell = row.createCell(23);﷯cell.setCellValue("PROVINCIA DI RESIDENZA");﷯cell.setCellStyle(cs);﷯cell = row.createCell(24);﷯cell.setCellValue("INDIRIZZO");﷯cell.setCellStyle(cs);﷯cell = row.createCell(25);﷯cell.setCellValue("TIPO OPERAZIONE");﷯cell.setCellStyle(cs);﷯cell = row.createCell(26);﷯cell.setCellValue("CAUSALE ANALITICA");﷯cell.setCellStyle(cs);﷯cell = row.createCell(27);﷯cell.setCellValue("CAUSALE SINTETICA");﷯cell.setCellStyle(cs);﷯cell = row.createCell(28);﷯cell.setCellValue("SEGNO OPERAZIONE");﷯cell.setCellStyle(cs);﷯cell = row.createCell(29);﷯cell.setCellValue("DATA OPERAZIONE");﷯cell.setCellStyle(cs);﷯cell = row.createCell(30);﷯cell.setCellValue("NOMINATIVO CONTROPARTE");﷯cell.setCellStyle(cs);﷯cell = row.createCell(31);﷯cell.setCellValue("STATO CONTROPARTE");﷯cell.setCellStyle(cs);﷯cell = row.createCell(32);﷯cell.setCellValue("N° OPERAZIONE");﷯cell.setCellStyle(cs);﷯cell = row.createCell(33);﷯cell.setCellValue("STATO REGISTRAZIONE");﷯cell.setCellStyle(cs);﷯cell = row.createCell(34);﷯cell.setCellValue("CODICE RAPPORTO");﷯cell.setCellStyle(cs);﷯cell = row.createCell(35);﷯cell.setCellValue("DATA REGISTRAZIONE");﷯cell.setCellStyle(cs);﷯cell = row.createCell(36);﷯cell.setCellValue("FRAZIONATA/OPERAZIONE");﷯cell.setCellStyle(cs);
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgWU='S'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPExec
check='man
frm_calc='// Aggiorna il contatore delle righe﷯r++;
obj='Exec
pag=2
prev=O389
I
obj='If
pag=2
prev=O388
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O389
fatherSonIndex=0
frm_calc=[
'pmcParametri.w_flgncf='N'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O395
fatherSonIndex=0
frm_calc='// Scrive MTCN e MacroAgente per WU﷯cell = row.createCell(37);﷯cell.setCellValue("COD. FISCALE FITTIZZIO");﷯cell.setCellStyle(cs);﷯cell = row.createCell(38);﷯cell.setCellValue("MTCN");﷯cell.setCellStyle(cs);﷯cell = row.createCell(39);﷯cell.setCellValue("MACROAGENTE");﷯cell.setCellStyle(cs);﷯cell = row.createCell(40);﷯cell.setCellValue("AJW CODE");﷯cell.setCellStyle(cs);
obj='Exec
pag=2
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O395
fatherSonIndex=1
frm_calc='// Scrive MTCN e MacroAgente per WU﷯cell = row.createCell(37);﷯cell.setCellValue("MTCN");﷯cell.setCellStyle(cs);﷯cell = row.createCell(38);﷯cell.setCellValue("MACROAGENTE");﷯cell.setCellStyle(cs);﷯cell = row.createCell(39);﷯cell.setCellValue("AJW CODE");﷯cell.setCellStyle(cs);
obj='Exec
pag=2
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O389
fatherSonIndex=1
frm_calc=[
'pmcParametri.w_flgncf='N'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O405
fatherSonIndex=0
frm_calc='// Scrive riferimento per Altri﷯cell = row.createCell(37);﷯cell.setCellValue("COD. FISCALE FITTIZZIO");﷯cell.setCellStyle(cs);﷯cell = row.createCell(38);﷯cell.setCellValue("RIFERIMENTO 1");﷯cell.setCellStyle(cs);﷯cell = row.createCell(39);﷯cell.setCellValue("RIFERIMENTO 2");﷯cell.setCellStyle(cs);
obj='Exec
pag=2
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O405
fatherSonIndex=1
frm_calc='// Scrive riferimento per Altri﷯cell = row.createCell(37);﷯cell.setCellValue("RIFERIMENTO 1");﷯cell.setCellStyle(cs);﷯cell = row.createCell(38);﷯cell.setCellValue("RIFERIMENTO 2");﷯cell.setCellStyle(cs);
obj='Exec
pag=2
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=2
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O339
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O340
fatherSonIndex=0
frm_calc='// creo il contenitore dei fogli﷯wb = new SXSSFWorkbook();﷯sheet = (SXSSFSheet) wb.createSheet("Foglio1") ;﷯CellStyle cs = wb.createCellStyle();﷯cs.setFillForegroundColor(IndexedColors.LIME.getIndex());﷯cs.setFillPattern(FillPatternType.SOLID_FOREGROUND);﷯Font f = wb.createFont();﷯f.setBold(true);﷯f.setFontHeightInPoints((short) 11);﷯cs.setFont(f);
obj='Exec
pag=2
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O338
var_op='asgn
I
obj='Remark
pag=2
prev=O337
I
obj='Exec
pag=2
prev=O336
I
obj='Var
pag=2
prev=O335
var_op='asgn
I
obj='Remark
pag=2
x=14
y=26
I
Icpitembatch.CPExec
check='man
frm_calc='// Create a buffer for reading the files﷯    byte[] buf = new byte[1024];﷯    ﷯    try {﷯        // Create the ZIP file﷯        String outFilename = cNomeFileZip;﷯        java.util.zip.ZipOutputStream out = new java.util.zip.ZipOutputStream(new java.io.FileOutputStream(outFilename));﷯    ﷯        // Compress the files﷯        for (int i=0; i<filenames.size(); i++) {﷯            _file1=(String)filenames.elementAt(i);﷯            _file2=(String)fileonames.elementAt(i);﷯            java.io.FileInputStream in = new java.io.FileInputStream(_file1);﷯    ﷯            // Add ZIP entry to output stream.﷯            out.putNextEntry(new java.util.zip.ZipEntry(_file2));﷯    ﷯            // Transfer bytes from the file to the ZIP file﷯            int len;﷯            while ((len = in.read(buf)) > 0) {﷯                out.write(buf, 0, len);﷯            }﷯    ﷯            // Complete the entry﷯            out.closeEntry();﷯            in.close();﷯            FileLibMit.DeleteFilePath(CPLib.LRTrim(_file1));﷯        }﷯    ﷯        // Complete the ZIP file﷯        out.close();﷯        filenames.removeAllElements();﷯        fileonames.removeAllElements();﷯    } catch (java.io.IOException e) {﷯    }﷯
obj='Exec
pag=14
x=17
y=26
I
Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.w_tipoout='Z'
'pmcParametri.w_tipoout='D'
]
h=[
19
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(pmcParametri.w_nomefile)) and Empty(pmcParametri.w_cCODFISC)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
prev=O424
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O426
fatherSonIndex=0
frm_calc=[
'Empty(pmcParametri.w_ragosc) and Empty(pmcParametri.w_citnas) and Empty(pmcParametri.w_stanas) and Empty(pmcParametri.w_datnas) and Empty(pmcParametri.w_connes)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O431
fatherSonIndex=0
frm_calc=[
'pmcParametri.w_frzsel='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.w_opesel='S'
]
h=[
19
19
]
obj='If
pag=6
prev=O436
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O439
fatherSonIndex=0
frm_calc='0
len=15
name='_max
next=Icpitembatch.CPVarDecl
frm_calc='0
len=15
name='_min
next=Icpitembatch.CPVarDecl
frm_calc='0
len=15
name='_tot
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_tot > 75000,0,1)
len=1
name='_mono
next=Icpitembatch.CPIfElse
frm_calc=[
'_mono = 1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='1
len=15
name='_contacicli
next=Icpitembatch.CPWhile
frm_calc='_contacicli<=_cicli
h=[
19
19
]
obj='While
pag=6
prev=O453
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O454
fatherSonIndex=0
frm_calc=[
'_mono = 1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.pTipo <> 'B'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_top>=_min
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_contacicli+1
len=15
name='_contacicli
obj='Var
obj_type='N
pag=6
prev=O464
var_op='asgn
I
obj='If
pag=6
prev=O461
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O464
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=6
par_expr=[
'_cfromdate
'_c_todate
'pmcParametri.w_cDIP
'pmcParametri.w_cCODFISC
'pmcParametri.w_cMTCN
'pmcParametri.w_codmag
'_bottom
'_top
'_mstato
'pmcParametri.w_lststa
'pmcParametri.w_lstprv
'_importo
]
par_name=[
'w_cdadata
'w_c_adata
'w_cDIP
'w_cCODFISC
'w_cMTCN
'w_codmag
'_bottom
'_top
'_mstato
'_lststati
'_lstprov
'_importo
]
sel_name='qbe_estrai_ope
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O470
fatherSonIndex=0
frm_calc='riga + 1
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.pTipo='B'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPBeginEnd
comment='Riempie variabili con valori della query
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Scrive il record della dipendenza
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.w_tipoout='E'
'pmcParametri.w_tipoout='T'
'pmcParametri.w_tipoout='C'
]
h=[
19
19
19
19
19
]
haselse=True
obj='If
pag=6
prev=O482
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O484
fatherSonIndex=0
frm_calc='10
obj='Exec
pag=6
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O484
fatherSonIndex=1
frm_calc='11
obj='Exec
pag=6
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O484
fatherSonIndex=2
frm_calc='12
obj='Exec
pag=6
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O484
fatherSonIndex=3
frm_calc='_ctot + 1
len=10
name='_ctot
next=Icpitembatch.CPInsert
arch='dw_operazioni
obj='Insert
pag=6
prev=O495
rd_kfield=[
'PROGOPE
'TIPO
'CODDIP
'AGENZIA
'SEDE_AGENZIA
'NUMOPE
'IMPORTO
'NDG
'COGNOME
'NOME
'SESSO
'LUOGONAS
'DATANAS
'CODFISC
'TIPODOC
'NUMDOC
'DATARIL
'AUTRIL
'CITTARES
'CAPRES
'PRVRES
'INDIRIZZO
'STATORES
'TIPOOPEUIC
'CAUANA
'CAUSIN
'SEGNO
'DATAOPE
'RAGSOCCONT
'PAESECONT
'STATOOPE
'DATAREG
'OPEFRZ
'MTCN
'MACROAGENTE
'CFESTERO
'CODINTER
]
rd_kvar=[
'_ctot
'_sqr
'_coddip
'_namdip
'_citdip
'_numprog
'totimp
'_ndg
'_cogman
'_nomman
'sesso
'_luonas
'_datnas
'codfisc
'_tipdoc
'_numdoc
'_datadoc
'_autril
'citres
'capres
'prvres
'indirizzo
'stares
'_dtipoope
'_dcauana
'_dcausin
'segno
'_dataope
'nominativo
'_dpaesedes
'_dstator
'_datareg
'_orgdati
'numprog
'_macage
'_cfestero
'_codinter
]
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Begin
pag=6
prev=O480
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O482
fatherSonIndex=0
frm_calc=[
'not(mcANADIP.GoToKey(_coddip))
]
h=[
19
19
]
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O502
fatherSonIndex=0
frm_calc='_coddip
frm_seek='AppendWithKey
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_coddip
frm_seek='CODDIP
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_namdip
frm_seek='DESCRIZ
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_citdip
frm_seek='DESCCIT
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_inddip
frm_seek='DOMICILIO
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_prvdip
frm_seek='PROVINCIA
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_cabdip
frm_seek='CAB
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_macage
frm_seek='MACROAGENTE
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcANADIP
obj='Var
obj_type='MC
pag=6
prev=O514
var_op='meth
I
obj='Var
obj_type='MC
pag=6
prev=O513
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O512
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O511
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O510
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O509
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O508
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O507
var_op='prop
I
obj='Var
obj_type='MC
pag=6
var_op='meth
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
prev=O477
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O480
fatherSonIndex=0
frm_calc=[
'pmcParametri.w_flgsegno='1'
'pmcParametri.w_flgsegno='2'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope->NUMPROG
len=11
name='_numprog
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope->CODDIPE
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope->AGACCODE
len=10
name='_ajwcode
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope->DESCRIZ
len=40
name='_namdip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope->DESCCIT
len=40
name='_citdip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope->PROVINCIA
len=2
name='_prvdip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope->CAB
len=6
name='_cabdip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope->DOMICILIO
len=40
name='_inddip
next=Icpitembatch.CPBeginEnd
comment='Lettura dei dati anagrafici
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope->MTCN
len=11
name='numprog
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(qbe_estrai_ope->DATAOPE)
len=8
name='dataope
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope->DATAOPE
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fdate(qbe_estrai_ope->DATAOPE)
len=10
name='f_datope
next=Icpitembatch.CPVarDecl
dec=2
frm_calc='qbe_estrai_ope->TOTLIRE / 100
len=15
name='totimp
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope->C_RAG
len=70
name='nominativo
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope->C_STA
len=30
name='_nazben
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope->TIPOOPRAP
len=2
name='tipope
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope->CODANA
len=4
name='cauana
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope->CODVOC
len=4
name='causin
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope->SEGNO
len=1
name='segno
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope->RIFIMP
len=28
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope->INFORM
len=30
name='_rifimp2
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope->MTCN
len=10
name='_mtcn
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope->MACROAGENTE
len=5
name='_macage
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fdate(qbe_estrai_ope->DATAREG)
len=10
name='f_datreg
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope->RAPPORTO
len=25
name='_rapporto
next=Icpitembatch.CPVarDecl
frm_calc='''
len=165
name='_dcauana
next=Icpitembatch.CPVarDecl
frm_calc='''
len=165
name='_dcausin
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_dpaesedes
next=Icpitembatch.CPVarDecl
frm_calc='''
len=90
name='_dtipoope
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTBCAUANA.GoToKey(cauana+Left(causin,2))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Upper(LRTrim(cauana))='U2'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTBTIPREG.GoToKey(tipope)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTBSTATI.GoToKey(_nazben)
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_stator='0','Attiva',iif(_stator='1','Attiva dopo modifica',iif(_stator='2','Cancellata','Copia di modificata')))
len=30
name='_dstator
next=Icpitembatch.CPVarDecl
frm_calc=''O'
len=1
name='_orgdati
obj='Var
pag=6
prev=O566
var_op='asgn
I
obj='Var
pag=6
prev=O563
var_op='asgn
I
obj='If
pag=6
prev=O560
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O563
fatherSonIndex=0
frm_calc='mcTBSTATI.DESCRI
len=30
name='_dpaesedes
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O557
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O560
fatherSonIndex=0
frm_calc='mcTBTIPREG.DES1
len=90
name='_dtipoope
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O554
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O557
fatherSonIndex=0
frm_calc=[
'Left(causin,2)='80'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O578
fatherSonIndex=0
frm_calc=''Consegna di mezzi di pagamento da parte di clientela'
len=165
name='_dcauana
next=Icpitembatch.CPVarDecl
frm_calc=''Consegna mezzi di pagamento'
len=165
name='_dcausin
obj='Var
pag=6
prev=O583
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O578
fatherSonIndex=1
frm_calc=''Ritiro di mezzi di pagamento da parte di clientela'
len=165
name='_dcauana
next=Icpitembatch.CPVarDecl
frm_calc=''Ritiro mezzi di pagamento'
len=165
name='_dcausin
obj='Var
pag=6
prev=O586
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O557
fatherSonIndex=1
frm_calc=[
'mcTBCAUSIN.GoToKey(Left(causin,2))
]
h=[
19
19
]
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O590
fatherSonIndex=0
frm_calc='mcTBCAUSIN.DESCRIZ
len=165
name='_dcausin
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=6
prev=O553
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O554
fatherSonIndex=0
frm_calc='mcTBCAUANA.DESCRI
len=165
name='_dcauana
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O552
var_op='asgn
I
obj='Var
pag=6
prev=O551
var_op='asgn
I
obj='Var
pag=6
prev=O550
var_op='asgn
I
obj='Var
pag=6
prev=O549
var_op='asgn
I
obj='Var
pag=6
prev=O548
var_op='asgn
I
obj='Var
pag=6
prev=O547
var_op='asgn
I
obj='Var
pag=6
prev=O546
var_op='asgn
I
obj='Var
pag=6
prev=O545
var_op='asgn
I
obj='Var
pag=6
prev=O544
var_op='asgn
I
obj='Var
pag=6
prev=O543
var_op='asgn
I
obj='Var
pag=6
prev=O542
var_op='asgn
I
obj='Var
pag=6
prev=O541
var_op='asgn
I
obj='Var
pag=6
prev=O540
var_op='asgn
I
obj='Var
pag=6
prev=O539
var_op='asgn
I
obj='Var
pag=6
prev=O538
var_op='asgn
I
obj='Var
pag=6
prev=O537
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O536
var_op='asgn
I
obj='Var
pag=6
prev=O535
var_op='asgn
I
obj='Var
obj_type='D
pag=6
prev=O534
var_op='asgn
I
obj='Var
pag=6
prev=O533
var_op='asgn
I
obj='Var
pag=6
prev=O531
var_op='asgn
I
obj='Begin
pag=6
prev=O530
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O531
fatherSonIndex=0
frm_calc='LRTrim(qbe_estrai_ope->CONNESCLI)
len=16
name='_ndg
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(qbe_estrai_ope->CONNESDOC)
len=50
name='_connesdoc
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope->DATAREG
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope->STATOREG
len=1
name='_stator
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope->DATARETT
len=8
name='_datarett
next=Icpitembatch.CPExec
check='page
frm_calc='13
obj='Exec
pag=6
prev=O608
I
obj='Var
obj_type='D
pag=6
prev=O607
var_op='asgn
I
obj='Var
pag=6
prev=O606
var_op='asgn
I
obj='Var
obj_type='D
pag=6
prev=O605
var_op='asgn
I
obj='Var
pag=6
prev=O604
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O529
var_op='asgn
I
obj='Var
pag=6
prev=O528
var_op='asgn
I
obj='Var
pag=6
prev=O527
var_op='asgn
I
obj='Var
pag=6
prev=O526
var_op='asgn
I
obj='Var
pag=6
prev=O525
var_op='asgn
I
obj='Var
pag=6
prev=O524
var_op='asgn
I
obj='Var
pag=6
prev=O523
var_op='asgn
I
obj='Var
pag=6
prev=O520
var_op='asgn
I
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O520
fatherSonIndex=0
frm_calc='iif(qbe_estrai_ope->SEGNO='A','RECEIVE','SEND')
len=10
name='_sqr
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O520
fatherSonIndex=1
frm_calc='iif(qbe_estrai_ope->SEGNO='D','RECEIVE','SEND')
len=10
name='_sqr
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O476
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O477
fatherSonIndex=0
frm_calc='FileLibMit.OpenWrite('./processi/EXT'+prcProg)
len=10
name='fmhand
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fmhand,'Elaborazione del record '+LRTrim(Str(riga,10,0))+"/"+LRTrim(Str(_totalone,10,0)))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fmhand)
obj='Exec
pag=6
prev=O621
I
obj='Exec
pag=6
prev=O620
I
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O477
fatherSonIndex=1
frm_calc=''Elaboro operazione con progressivo n°: '+qbe_estrai_ope->NUMPROG
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O464
fatherSonIndex=1
frm_calc=[
'pmcParametri.pTipo <> 'B'
]
h=[
19
19
]
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O628
fatherSonIndex=0
frm_calc=''Lettura informazioni in corso ... Ciclo N. '+LRTrim(Str(_contacicli,10,0))
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=6
prev=O458
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O461
fatherSonIndex=0
frm_calc=''Lettura informazioni in corso ... Ciclo N. '+LRTrim(Str(_contacicli,10,0))
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O458
fatherSonIndex=0
frm_calc='_min
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_max
len=15
name='_top
obj='Var
obj_type='N
pag=6
prev=O642
var_op='asgn
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O458
fatherSonIndex=1
frm_calc='((_contacicli -1 ) * 5000) + 1
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_contacicli * 5000
len=15
name='_top
obj='Var
obj_type='N
pag=6
prev=O645
var_op='asgn
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O450
var_op='asgn
I
obj='If
pag=6
prev=O449
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O450
fatherSonIndex=0
frm_calc=[
'_tot = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O651
fatherSonIndex=0
frm_calc='0
len=15
name='_cicli
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O651
fatherSonIndex=1
frm_calc='1
len=15
name='_cicli
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O450
fatherSonIndex=1
frm_calc='iif(Mod(_max,5000) <> 0,Int(_max/5000) + 1,Int(_max/5000))
len=15
name='_cicli
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O447
var_op='asgn
I
obj='Select
pag=6
par_expr=[
'_cfromdate
'_c_todate
'pmcParametri.w_cDIP
'pmcParametri.w_cCODFISC
'pmcParametri.w_cMTCN
'pmcParametri.w_codmag
'_mstato
'pmcParametri.w_lststa
'pmcParametri.w_lstprv
'_importo
]
par_name=[
'w_cdadata
'w_c_adata
'w_cDIP
'w_cCODFISC
'w_cMTCN
'w_codmag
'_mstato
'_lststati
'_lstprov
'_importo
]
prev=O446
sel_name='qbe_estrai_ope_lim
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O447
fatherSonIndex=0
frm_calc='qbe_estrai_ope_lim->maxope
len=15
name='_max
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_lim->minope
len=15
name='_min
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_lim->totope
len=15
name='_tot
obj='Var
obj_type='N
pag=6
prev=O668
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O667
var_op='asgn
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O445
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O444
var_op='asgn
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O436
fatherSonIndex=0
frm_calc='0
len=15
name='_max
next=Icpitembatch.CPVarDecl
frm_calc='0
len=15
name='_min
next=Icpitembatch.CPVarDecl
frm_calc='0
len=15
name='_tot
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_tot > 75000,0,1)
len=1
name='_mono
next=Icpitembatch.CPIfElse
frm_calc=[
'_mono = 1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='1
len=15
name='_contacicli
next=Icpitembatch.CPWhile
frm_calc='_contacicli<=_cicli
h=[
19
19
]
obj='While
pag=6
prev=O683
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O684
fatherSonIndex=0
frm_calc=[
'_mono = 1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.pTipo <> 'B'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_top>=_min
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_contacicli+1
len=15
name='_contacicli
obj='Var
obj_type='N
pag=6
prev=O694
var_op='asgn
I
obj='If
pag=6
prev=O691
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O694
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=6
par_expr=[
'_cfromdate
'_c_todate
'pmcParametri.w_cDIP
'pmcParametri.w_cCODFISC
'pmcParametri.w_cMTCN
'pmcParametri.w_codmag
'_bottom
'_top
'_mstato
'pmcParametri.w_lststa
'pmcParametri.w_lstprv
'_importo
]
par_name=[
'w_cdadata
'w_c_adata
'w_cDIP
'w_cCODFISC
'w_cMTCN
'w_codmag
'_bottom
'_top
'_mstato
'_lststati
'_lstprov
'_importo
]
sel_name='qbe_estrai_frz
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O700
fatherSonIndex=0
frm_calc='riga + 1
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.pTipo='B'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPBeginEnd
comment='Riempie variabili con valori della query
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Scrive il record della dipendenza
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.w_tipoout='E'
'pmcParametri.w_tipoout='T'
'pmcParametri.w_tipoout='C'
]
h=[
19
19
19
19
19
]
haselse=True
obj='If
pag=6
prev=O712
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O714
fatherSonIndex=0
frm_calc='10
obj='Exec
pag=6
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O714
fatherSonIndex=1
frm_calc='11
obj='Exec
pag=6
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O714
fatherSonIndex=2
frm_calc='12
obj='Exec
pag=6
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O714
fatherSonIndex=3
frm_calc='_ctot + 1
len=10
name='_ctot
next=Icpitembatch.CPInsert
arch='dw_operazioni
obj='Insert
pag=6
prev=O725
rd_kfield=[
'PROGOPE
'TIPO
'CODDIP
'AGENZIA
'SEDE_AGENZIA
'NUMOPE
'IMPORTO
'NDG
'COGNOME
'NOME
'SESSO
'LUOGONAS
'DATANAS
'CODFISC
'TIPODOC
'NUMDOC
'DATARIL
'AUTRIL
'CITTARES
'CAPRES
'PRVRES
'INDIRIZZO
'STATORES
'TIPOOPEUIC
'CAUANA
'CAUSIN
'SEGNO
'DATAOPE
'RAGSOCCONT
'PAESECONT
'STATOOPE
'DATAREG
'OPEFRZ
'MTCN
'MACROAGENTE
'CFESTERO
'CODINTER
]
rd_kvar=[
'_ctot
'_sqr
'_coddip
'_namdip
'_citdip
'_numprog
'totimp
'_ndg
'_cogman
'_nomman
'sesso
'_luonas
'_datnas
'codfisc
'_tipdoc
'_numdoc
'_datadoc
'_autril
'citres
'capres
'prvres
'indirizzo
'stares
'_dtipoope
'_dcauana
'_dcausin
'segno
'_dataope
'nominativo
'_dpaesedes
'_dstator
'_datareg
'_orgdati
'numprog
'_macage
'_cfestero
'_codinter
]
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Begin
pag=6
prev=O710
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O712
fatherSonIndex=0
frm_calc=[
'not(mcANADIP.GoToKey(_coddip))
]
h=[
19
19
]
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O732
fatherSonIndex=0
frm_calc='_coddip
frm_seek='AppendWithKey
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_coddip
frm_seek='CODDIP
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_namdip
frm_seek='DESCRIZ
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_citdip
frm_seek='DESCCIT
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_inddip
frm_seek='DOMICILIO
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_prvdip
frm_seek='PROVINCIA
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_cabdip
frm_seek='CAB
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_macage
frm_seek='MACROAGENTE
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcANADIP
obj='Var
obj_type='MC
pag=6
prev=O744
var_op='meth
I
obj='Var
obj_type='MC
pag=6
prev=O743
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O742
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O741
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O740
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O739
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O738
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O737
var_op='prop
I
obj='Var
obj_type='MC
pag=6
var_op='meth
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
prev=O707
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O710
fatherSonIndex=0
frm_calc=[
'pmcParametri.w_flgsegno='1'
'pmcParametri.w_flgsegno='2'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz->NUMPROG
len=11
name='_numprog
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz->CODDIPE
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz->AGACCODE
len=10
name='_ajwcode
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz->DESCRIZ
len=40
name='_namdip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz->DESCCIT
len=40
name='_citdip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz->PROVINCIA
len=2
name='_prvdip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz->CAB
len=6
name='_cabdip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz->DOMICILIO
len=40
name='_inddip
next=Icpitembatch.CPBeginEnd
comment='Lettura dei dati anagrafici
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz->MTCN
len=11
name='numprog
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(qbe_estrai_frz->DATAOPE)
len=8
name='dataope
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz->DATAOPE
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fdate(qbe_estrai_frz->DATAOPE)
len=10
name='f_datope
next=Icpitembatch.CPVarDecl
dec=2
frm_calc='qbe_estrai_frz->TOTLIRE / 100
len=15
name='totimp
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz->C_RAG
len=70
name='nominativo
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz->C_STA
len=30
name='_nazben
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz->TIPOOPRAP
len=2
name='tipope
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz->CODANA
len=4
name='cauana
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz->CODVOC
len=4
name='causin
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz->SEGNO
len=1
name='segno
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz->RIFIMP
len=28
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz->INFORM
len=30
name='_rifimp2
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz->MTCN
len=10
name='_mtcn
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz->MACROAGENTE
len=5
name='_macage
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fdate(qbe_estrai_frz->DATAREG)
len=10
name='f_datreg
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz->RAPPORTO
len=25
name='_rapporto
next=Icpitembatch.CPVarDecl
frm_calc='''
len=165
name='_dcauana
next=Icpitembatch.CPVarDecl
frm_calc='''
len=165
name='_dcausin
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_dpaesedes
next=Icpitembatch.CPVarDecl
frm_calc='''
len=90
name='_dtipoope
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTBCAUANA.GoToKey(cauana+Left(causin,2))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Upper(LRTrim(cauana))='U2'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTBTIPREG.GoToKey(tipope)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTBSTATI.GoToKey(_nazben)
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_stator='0','Attiva',iif(_stator='1','Attiva dopo modifica',iif(_stator='2','Cancellata','Copia di modificata')))
len=30
name='_dstator
next=Icpitembatch.CPVarDecl
frm_calc=''F'
len=1
name='_orgdati
obj='Var
pag=6
prev=O796
var_op='asgn
I
obj='Var
pag=6
prev=O793
var_op='asgn
I
obj='If
pag=6
prev=O790
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O793
fatherSonIndex=0
frm_calc='mcTBSTATI.DESCRI
len=30
name='_dpaesedes
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O787
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O790
fatherSonIndex=0
frm_calc='mcTBTIPREG.DES1
len=90
name='_dtipoope
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O784
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O787
fatherSonIndex=0
frm_calc=[
'Left(causin,2)='80'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O808
fatherSonIndex=0
frm_calc=''Consegna di mezzi di pagamento da parte di clientela'
len=165
name='_dcauana
next=Icpitembatch.CPVarDecl
frm_calc=''Consegna mezzi di pagamento'
len=165
name='_dcausin
obj='Var
pag=6
prev=O813
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O808
fatherSonIndex=1
frm_calc=''Ritiro di mezzi di pagamento da parte di clientela'
len=165
name='_dcauana
next=Icpitembatch.CPVarDecl
frm_calc=''Ritiro mezzi di pagamento'
len=165
name='_dcausin
obj='Var
pag=6
prev=O816
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O787
fatherSonIndex=1
frm_calc=[
'mcTBCAUSIN.GoToKey(Left(causin,2))
]
h=[
19
19
]
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O820
fatherSonIndex=0
frm_calc='mcTBCAUSIN.DESCRIZ
len=165
name='_dcausin
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=6
prev=O783
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O784
fatherSonIndex=0
frm_calc='mcTBCAUANA.DESCRI
len=165
name='_dcauana
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O782
var_op='asgn
I
obj='Var
pag=6
prev=O781
var_op='asgn
I
obj='Var
pag=6
prev=O780
var_op='asgn
I
obj='Var
pag=6
prev=O779
var_op='asgn
I
obj='Var
pag=6
prev=O778
var_op='asgn
I
obj='Var
pag=6
prev=O777
var_op='asgn
I
obj='Var
pag=6
prev=O776
var_op='asgn
I
obj='Var
pag=6
prev=O775
var_op='asgn
I
obj='Var
pag=6
prev=O774
var_op='asgn
I
obj='Var
pag=6
prev=O773
var_op='asgn
I
obj='Var
pag=6
prev=O772
var_op='asgn
I
obj='Var
pag=6
prev=O771
var_op='asgn
I
obj='Var
pag=6
prev=O770
var_op='asgn
I
obj='Var
pag=6
prev=O769
var_op='asgn
I
obj='Var
pag=6
prev=O768
var_op='asgn
I
obj='Var
pag=6
prev=O767
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O766
var_op='asgn
I
obj='Var
pag=6
prev=O765
var_op='asgn
I
obj='Var
obj_type='D
pag=6
prev=O764
var_op='asgn
I
obj='Var
pag=6
prev=O763
var_op='asgn
I
obj='Var
pag=6
prev=O761
var_op='asgn
I
obj='Begin
pag=6
prev=O760
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O761
fatherSonIndex=0
frm_calc='LRTrim(qbe_estrai_frz->CONNESCLI)
len=16
name='_ndg
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(qbe_estrai_frz->CONNESDOC)
len=50
name='_connesdoc
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz->DATAREG
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz->STATOREG
len=1
name='_stator
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz->DATARETT
len=8
name='_datarett
next=Icpitembatch.CPExec
check='page
frm_calc='13
obj='Exec
pag=6
prev=O838
I
obj='Var
obj_type='D
pag=6
prev=O837
var_op='asgn
I
obj='Var
pag=6
prev=O836
var_op='asgn
I
obj='Var
obj_type='D
pag=6
prev=O835
var_op='asgn
I
obj='Var
pag=6
prev=O834
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O759
var_op='asgn
I
obj='Var
pag=6
prev=O758
var_op='asgn
I
obj='Var
pag=6
prev=O757
var_op='asgn
I
obj='Var
pag=6
prev=O756
var_op='asgn
I
obj='Var
pag=6
prev=O755
var_op='asgn
I
obj='Var
pag=6
prev=O754
var_op='asgn
I
obj='Var
pag=6
prev=O753
var_op='asgn
I
obj='Var
pag=6
prev=O750
var_op='asgn
I
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O750
fatherSonIndex=0
frm_calc='iif(qbe_estrai_frz->SEGNO='A','RECEIVE','SEND')
len=10
name='_sqr
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O750
fatherSonIndex=1
frm_calc='iif(qbe_estrai_frz->SEGNO='D','RECEIVE','SEND')
len=10
name='_sqr
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O706
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O707
fatherSonIndex=0
frm_calc='FileLibMit.OpenWrite('./processi/EXT'+prcProg)
len=10
name='fmhand
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fmhand,'Elaborazione del record '+LRTrim(Str(riga,10,0))+"/"+LRTrim(Str(_totalone,10,0)))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fmhand)
obj='Exec
pag=6
prev=O851
I
obj='Exec
pag=6
prev=O850
I
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O707
fatherSonIndex=1
frm_calc=''Elaboro frazionata con progressivo n°: '+qbe_estrai_frz->NUMPROG
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O694
fatherSonIndex=1
frm_calc=[
'pmcParametri.pTipo <> 'B'
]
h=[
19
19
]
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O858
fatherSonIndex=0
frm_calc=''Lettura informazioni in corso ... Ciclo N. '+LRTrim(Str(_contacicli,10,0))
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=6
prev=O688
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O691
fatherSonIndex=0
frm_calc=''Lettura informazioni in corso ... Ciclo N. '+LRTrim(Str(_contacicli,10,0))
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O688
fatherSonIndex=0
frm_calc='_min
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_max
len=15
name='_top
obj='Var
obj_type='N
pag=6
prev=O872
var_op='asgn
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O688
fatherSonIndex=1
frm_calc='((_contacicli -1 ) * 5000) + 1
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_contacicli * 5000
len=15
name='_top
obj='Var
obj_type='N
pag=6
prev=O875
var_op='asgn
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O680
var_op='asgn
I
obj='If
pag=6
prev=O679
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O680
fatherSonIndex=0
frm_calc=[
'_tot = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O881
fatherSonIndex=0
frm_calc='0
len=15
name='_cicli
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O881
fatherSonIndex=1
frm_calc='1
len=15
name='_cicli
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O680
fatherSonIndex=1
frm_calc='iif(Mod(_max,5000) <> 0,Int(_max/5000) + 1,Int(_max/5000))
len=15
name='_cicli
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O677
var_op='asgn
I
obj='Select
pag=6
par_expr=[
'_cfromdate
'_c_todate
'pmcParametri.w_cDIP
'pmcParametri.w_cCODFISC
'pmcParametri.w_cMTCN
'pmcParametri.w_codmag
'_mstato
'pmcParametri.w_lststa
'pmcParametri.w_lstprv
'_importo
]
par_name=[
'w_cdadata
'w_c_adata
'w_cDIP
'w_cCODFISC
'w_cMTCN
'w_codmag
'_mstato
'_lststati
'_lstprov
'_importo
]
prev=O676
sel_name='qbe_estrai_frz_lim
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O677
fatherSonIndex=0
frm_calc='qbe_estrai_frz_lim->maxfrz
len=15
name='_max
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_lim->minfrz
len=15
name='_min
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_lim->totfrz
len=15
name='_tot
obj='Var
obj_type='N
pag=6
prev=O898
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O897
var_op='asgn
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O675
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O674
var_op='asgn
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O431
fatherSonIndex=1
frm_calc=[
'Empty(LRTrim(pmcParametri.w_connes))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPExec
check='page
frm_calc='8
obj='Exec
pag=6
prev=O903
I
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O903
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(pmcParametri.w_ragosc)),'','%'+LRTrim(pmcParametri.w_ragosc)+"%")
len=70
name='_ragsoc
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=6
par_expr=[
'_ragsoc
'pmcParametri.w_citnas
'pmcParametri.w_datnas
'pmcParametri.w_stanas
]
par_name=[
'w_ragosc
'w_citnas
'w_datnas
'w_stanas
]
prev=O909
sel_name='qbe_sele_sogg
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tmp_newpers
father=O910
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'CONNES
]
rd_kvar=[
'qbe_sele_sogg->CONNES
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tmp_newpers
father=O903
fatherSonIndex=1
obj='Insert
pag=6
rd_kfield=[
'CONNES
]
rd_kvar=[
'pmcParametri.w_connes
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O426
fatherSonIndex=1
frm_calc=[
'not(Empty(pmcParametri.w_nomefile))
'not(Empty(pmcParametri.w_cCODFISC))
]
h=[
19
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.w_tipofile='1'
'pmcParametri.w_tipofile='2'
]
h=[
19
19
19
]
obj='If
pag=6
prev=O927
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O930
fatherSonIndex=0
frm_calc='9
obj='Exec
pag=6
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O930
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPExec
check='page
frm_calc='8
obj='Exec
pag=6
prev=O937
I
obj='Select
pag=6
sel_name='qbe_sele_sogg2
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tmp_newpers
father=O937
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'CONNES
]
rd_kvar=[
'qbe_sele_sogg2->CONNES
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O927
fatherSonIndex=0
frm_calc='7
obj='Exec
pag=6
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tmp_mtcn_cf
father=O927
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc=''2'
frm_seek='w_tipofile
name='pmcParametri
obj='Var
obj_type='MC
pag=6
prev=O951
var_op='prop
I
obj='Insert
pag=6
rd_kfield=[
'MTCN
'CODFISC
]
rd_kvar=[
'''
'pmcParametri.w_cCODFISC
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=6
prev=O421
sel_field='intermbo->CODINTER
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O424
fatherSonIndex=0
frm_calc='intermbo->CODINTER
len=11
name='_codinter
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='dw_operazioni
father=O421
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_ctot
obj='Var
obj_type='N
pag=6
prev=O963
var_op='asgn
I
obj='Delete
pag=6
sel_type='all
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O421
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=6
par_expr=[
''dw_operazioni'
''PROGOPE'
]
par_name=[
'tbname
'fldname
]
sel_name='qbe_tab_mmc
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O966
fatherSonIndex=0
frm_calc='qbe_tab_mmc->max
len=10
name='_ctot
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
x=10
y=18
I
Icpitembatch.CPRead
arch='tbcauana
obj='Read
pag=6
rd_field=[
'DESCRI
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'cauana
'Left(causin,2)
]
rd_var=[
'_dcauana
]
x=1249
y=2717
I
Icpitembatch.CPRead
arch='tbcausin
obj='Read
pag=6
rd_field=[
'DESCRIZ
]
rd_kfield=[
'CODVOC
]
rd_kvar=[
'Left(causin,2)
]
rd_var=[
'_dcausin
]
x=1262
y=2793
I
Icpitembatch.CPRead
arch='tbtipreg
obj='Read
pag=6
rd_field=[
'DES1
]
rd_kfield=[
'CODICE
]
rd_kvar=[
'tipope
]
rd_var=[
'_dtipoope
]
x=1256
y=2838
I
Icpitembatch.CPRead
arch='tbstati
obj='Read
pag=6
rd_field=[
'DESCRI
]
rd_kfield=[
'CODSTA
]
rd_kvar=[
'_nazben
]
rd_var=[
'_dpaesedes
]
x=1281
y=2902
I
Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.w_frzsel='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.w_opesel='S'
]
h=[
19
19
]
obj='If
pag=8
prev=O995
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O998
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=8
par_expr=[
'_cfromdate
'_c_todate
'pmcParametri.w_cDIP
'pmcParametri.w_cCODFISC
'pmcParametri.w_cMTCN
'pmcParametri.w_codmag
'_mstato
'pmcParametri.w_lststa
'pmcParametri.w_lstprv
'_importo
]
par_name=[
'w_cdadata
'w_c_adata
'w_cDIP
'w_cCODFISC
'w_cMTCN
'w_codmag
'_mstato
'_lststati
'_lstprov
'_importo
]
sel_name='qbe_estrai_ope_sog
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O1003
fatherSonIndex=0
frm_calc=''Elaboro operazione con progressivo n°: '+qbe_estrai_ope_sog->NUMPROG
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='riga + 1
len=10
name='riga
next=Icpitembatch.CPBeginEnd
comment='Riempie variabili con valori della query
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Scrive il record della dipendenza
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.w_tipoout='E'
'pmcParametri.w_tipoout='T'
'pmcParametri.w_tipoout='C'
]
h=[
19
19
19
19
19
]
haselse=True
obj='If
pag=8
prev=O1013
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1015
fatherSonIndex=0
frm_calc='10
obj='Exec
pag=8
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1015
fatherSonIndex=1
frm_calc='11
obj='Exec
pag=8
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1015
fatherSonIndex=2
frm_calc='12
obj='Exec
pag=8
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1015
fatherSonIndex=3
frm_calc='_ctot + 1
len=10
name='_ctot
next=Icpitembatch.CPInsert
arch='dw_operazioni
obj='Insert
pag=8
prev=O1026
rd_kfield=[
'PROGOPE
'TIPO
'CODDIP
'AGENZIA
'SEDE_AGENZIA
'NUMOPE
'IMPORTO
'NDG
'COGNOME
'NOME
'SESSO
'LUOGONAS
'DATANAS
'CODFISC
'TIPODOC
'NUMDOC
'DATARIL
'AUTRIL
'CITTARES
'CAPRES
'PRVRES
'INDIRIZZO
'STATORES
'TIPOOPEUIC
'CAUANA
'CAUSIN
'SEGNO
'DATAOPE
'RAGSOCCONT
'PAESECONT
'STATOOPE
'DATAREG
'OPEFRZ
'MTCN
'MACROAGENTE
'CFESTERO
'CODINTER
]
rd_kvar=[
'_ctot
'_sqr
'_coddip
'_namdip
'_citdip
'_numprog
'totimp
'_ndg
'_cogman
'_nomman
'sesso
'_luonas
'_datnas
'codfisc
'_tipdoc
'_numdoc
'_datadoc
'_autril
'citres
'capres
'prvres
'indirizzo
'stares
'_dtipoope
'_dcauana
'_dcausin
'segno
'_dataope
'nominativo
'_dpaesedes
'_dstator
'_datareg
'_orgdati
'numprog
'_macage
'_cfestero
'_codinter
]
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Begin
pag=8
prev=O1011
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1013
fatherSonIndex=0
frm_calc=[
'not(mcANADIP.GoToKey(_coddip))
]
h=[
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1033
fatherSonIndex=0
frm_calc='_coddip
frm_seek='AppendWithKey
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_coddip
frm_seek='CODDIP
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_namdip
frm_seek='DESCRIZ
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_citdip
frm_seek='DESCCIT
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_inddip
frm_seek='DOMICILIO
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_prvdip
frm_seek='PROVINCIA
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_cabdip
frm_seek='CAB
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_macage
frm_seek='MACROAGENTE
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcANADIP
obj='Var
obj_type='MC
pag=8
prev=O1045
var_op='meth
I
obj='Var
obj_type='MC
pag=8
prev=O1044
var_op='prop
I
obj='Var
obj_type='MC
pag=8
prev=O1043
var_op='prop
I
obj='Var
obj_type='MC
pag=8
prev=O1042
var_op='prop
I
obj='Var
obj_type='MC
pag=8
prev=O1041
var_op='prop
I
obj='Var
obj_type='MC
pag=8
prev=O1040
var_op='prop
I
obj='Var
obj_type='MC
pag=8
prev=O1039
var_op='prop
I
obj='Var
obj_type='MC
pag=8
prev=O1038
var_op='prop
I
obj='Var
obj_type='MC
pag=8
var_op='meth
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=8
prev=O1010
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1011
fatherSonIndex=0
frm_calc=[
'pmcParametri.w_flgsegno='1'
'pmcParametri.w_flgsegno='2'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->NUMPROG
len=11
name='_numprog
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->CODDIPE
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->AGACCODE
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->DESCRIZ
len=40
name='_namdip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->DESCCIT
len=40
name='_citdip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->PROVINCIA
len=2
name='_prvdip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->CAB
len=6
name='_cabdip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->DOMICILIO
len=40
name='_inddip
next=Icpitembatch.CPBeginEnd
comment='Lettura dei dati anagrafici
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->MTCN
len=11
name='numprog
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(qbe_estrai_ope_sog->DATAOPE)
len=8
name='dataope
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->DATAOPE
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fdate(qbe_estrai_ope_sog->DATAOPE)
len=10
name='f_datope
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fdate(qbe_estrai_ope_sog->DATAREG)
len=10
name='f_datreg
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->RAPPORTO
len=25
name='_rapporto
next=Icpitembatch.CPVarDecl
dec=2
frm_calc='qbe_estrai_ope_sog->TOTLIRE / 100
len=15
name='totimp
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->C_RAG
len=70
name='nominativo
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->C_STA
len=30
name='_nazben
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->TIPOOPRAP
len=2
name='tipope
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->CODANA
len=4
name='cauana
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->CODVOC
len=4
name='causin
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->SEGNO
len=1
name='segno
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->RIFIMP
len=28
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->INFORM
len=30
name='_rifimp2
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->MTCN
len=10
name='_mtcn
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->MACROAGENTE
len=5
name='_macage
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fdate(qbe_estrai_ope_sog->DATAREG)
len=10
name='f_datreg
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->RAPPORTO
len=25
name='_rapporto
next=Icpitembatch.CPVarDecl
frm_calc='''
len=165
name='_dcauana
next=Icpitembatch.CPVarDecl
frm_calc='''
len=165
name='_dcausin
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_dpaesedes
next=Icpitembatch.CPVarDecl
frm_calc='''
len=90
name='_dtipoope
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTBCAUANA.GoToKey(cauana+Left(causin,2))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Upper(LRTrim(cauana))='U2'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTBTIPREG.GoToKey(tipope)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTBSTATI.GoToKey(_nazben)
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_stator='0','Attiva',iif(_stator='1','Attiva dopo modifica',iif(_stator='2','Cancellata','Copia di modificata')))
len=30
name='_dstator
next=Icpitembatch.CPVarDecl
frm_calc=''O'
len=1
name='_orgdati
obj='Var
pag=8
prev=O1099
var_op='asgn
I
obj='Var
pag=8
prev=O1096
var_op='asgn
I
obj='If
pag=8
prev=O1093
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1096
fatherSonIndex=0
frm_calc='mcTBSTATI.DESCRI
len=30
name='_dpaesedes
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=8
prev=O1090
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1093
fatherSonIndex=0
frm_calc='mcTBTIPREG.DES1
len=90
name='_dtipoope
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=8
prev=O1087
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1090
fatherSonIndex=0
frm_calc=[
'Left(causin,2)='80'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1111
fatherSonIndex=0
frm_calc=''Consegna di mezzi di pagamento da parte di clientela'
len=165
name='_dcauana
next=Icpitembatch.CPVarDecl
frm_calc=''Consegna mezzi di pagamento'
len=165
name='_dcausin
obj='Var
pag=8
prev=O1116
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1111
fatherSonIndex=1
frm_calc=''Ritiro di mezzi di pagamento da parte di clientela'
len=165
name='_dcauana
next=Icpitembatch.CPVarDecl
frm_calc=''Ritiro mezzi di pagamento'
len=165
name='_dcausin
obj='Var
pag=8
prev=O1119
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1090
fatherSonIndex=1
frm_calc=[
'mcTBCAUSIN.GoToKey(Left(causin,2))
]
h=[
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1123
fatherSonIndex=0
frm_calc='mcTBCAUSIN.DESCRIZ
len=165
name='_dcausin
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=8
prev=O1086
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1087
fatherSonIndex=0
frm_calc='mcTBCAUANA.DESCRI
len=165
name='_dcauana
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
prev=O1085
var_op='asgn
I
obj='Var
pag=8
prev=O1084
var_op='asgn
I
obj='Var
pag=8
prev=O1083
var_op='asgn
I
obj='Var
pag=8
prev=O1082
var_op='asgn
I
obj='Var
pag=8
prev=O1081
var_op='asgn
I
obj='Var
pag=8
prev=O1080
var_op='asgn
I
obj='Var
pag=8
prev=O1079
var_op='asgn
I
obj='Var
pag=8
prev=O1078
var_op='asgn
I
obj='Var
pag=8
prev=O1077
var_op='asgn
I
obj='Var
pag=8
prev=O1076
var_op='asgn
I
obj='Var
pag=8
prev=O1075
var_op='asgn
I
obj='Var
pag=8
prev=O1074
var_op='asgn
I
obj='Var
pag=8
prev=O1073
var_op='asgn
I
obj='Var
pag=8
prev=O1072
var_op='asgn
I
obj='Var
pag=8
prev=O1071
var_op='asgn
I
obj='Var
pag=8
prev=O1070
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O1069
var_op='asgn
I
obj='Var
pag=8
prev=O1068
var_op='asgn
I
obj='Var
pag=8
prev=O1067
var_op='asgn
I
obj='Var
pag=8
prev=O1066
var_op='asgn
I
obj='Var
obj_type='D
pag=8
prev=O1065
var_op='asgn
I
obj='Var
pag=8
prev=O1064
var_op='asgn
I
obj='Var
pag=8
prev=O1062
var_op='asgn
I
obj='Begin
pag=8
prev=O1061
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1062
fatherSonIndex=0
frm_calc='LRTrim(qbe_estrai_ope_sog->CONNESCLI)
len=16
name='_ndg
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(qbe_estrai_ope_sog->CONNESDOC)
len=50
name='_connesdoc
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->DATAREG
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->STATOREG
len=1
name='_stator
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_sog->DATARETT
len=8
name='_datarett
next=Icpitembatch.CPExec
check='page
frm_calc='13
obj='Exec
pag=8
prev=O1141
I
obj='Var
obj_type='D
pag=8
prev=O1140
var_op='asgn
I
obj='Var
pag=8
prev=O1139
var_op='asgn
I
obj='Var
obj_type='D
pag=8
prev=O1138
var_op='asgn
I
obj='Var
pag=8
prev=O1137
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
prev=O1060
var_op='asgn
I
obj='Var
pag=8
prev=O1059
var_op='asgn
I
obj='Var
pag=8
prev=O1058
var_op='asgn
I
obj='Var
pag=8
prev=O1057
var_op='asgn
I
obj='Var
pag=8
prev=O1056
var_op='asgn
I
obj='Var
pag=8
prev=O1055
var_op='asgn
I
obj='Var
pag=8
prev=O1054
var_op='asgn
I
obj='Var
pag=8
prev=O1051
var_op='asgn
I
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1051
fatherSonIndex=0
frm_calc='iif(qbe_estrai_ope_sog->SEGNO='A','RECEIVE','SEND')
len=10
name='_sqr
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1051
fatherSonIndex=1
frm_calc='iif(qbe_estrai_ope_sog->SEGNO='D','RECEIVE','SEND')
len=10
name='_sqr
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
prev=O1009
var_op='asgn
I
nonlocal=True
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O995
fatherSonIndex=0
h=[
19
19
19
]
obj='Select
pag=8
par_expr=[
'_cfromdate
'_c_todate
'pmcParametri.w_cDIP
'pmcParametri.w_cCODFISC
'pmcParametri.w_cMTCN
'pmcParametri.w_codmag
'_mstato
'pmcParametri.w_lststa
'pmcParametri.w_lstprv
'_importo
]
par_name=[
'w_cdadata
'w_c_adata
'w_cDIP
'w_cCODFISC
'w_cMTCN
'w_codmag
'_mstato
'_lststati
'_lstprov
'_importo
]
sel_name='qbe_estrai_frz_sog
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O1155
fatherSonIndex=0
frm_calc=''Elaboro frazionata con progressivo n°: '+qbe_estrai_frz_sog->NUMPROG
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='riga + 1
len=10
name='riga
next=Icpitembatch.CPBeginEnd
comment='Riempie variabili con valori della query
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Scrive il record della dipendenza
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.w_tipoout='E'
'pmcParametri.w_tipoout='T'
'pmcParametri.w_tipoout='C'
]
h=[
19
19
19
19
19
]
haselse=True
obj='If
pag=8
prev=O1165
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1167
fatherSonIndex=0
frm_calc='10
obj='Exec
pag=8
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1167
fatherSonIndex=1
frm_calc='11
obj='Exec
pag=8
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1167
fatherSonIndex=2
frm_calc='12
obj='Exec
pag=8
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1167
fatherSonIndex=3
frm_calc='_ctot + 1
len=10
name='_ctot
next=Icpitembatch.CPInsert
arch='dw_operazioni
obj='Insert
pag=8
prev=O1178
rd_kfield=[
'PROGOPE
'TIPO
'CODDIP
'AGENZIA
'SEDE_AGENZIA
'NUMOPE
'IMPORTO
'NDG
'COGNOME
'NOME
'SESSO
'LUOGONAS
'DATANAS
'CODFISC
'TIPODOC
'NUMDOC
'DATARIL
'AUTRIL
'CITTARES
'CAPRES
'PRVRES
'INDIRIZZO
'STATORES
'TIPOOPEUIC
'CAUANA
'CAUSIN
'SEGNO
'DATAOPE
'RAGSOCCONT
'PAESECONT
'STATOOPE
'DATAREG
'OPEFRZ
'MTCN
'MACROAGENTE
'CFESTERO
'CODINTER
]
rd_kvar=[
'_ctot
'_sqr
'_coddip
'_namdip
'_citdip
'_numprog
'totimp
'_ndg
'_cogman
'_nomman
'sesso
'_luonas
'_datnas
'codfisc
'_tipdoc
'_numdoc
'_datadoc
'_autril
'citres
'capres
'prvres
'indirizzo
'stares
'_dtipoope
'_dcauana
'_dcausin
'segno
'_dataope
'nominativo
'_dpaesedes
'_dstator
'_datareg
'_orgdati
'numprog
'_macage
'_cfestero
'_codinter
]
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Begin
pag=8
prev=O1163
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1165
fatherSonIndex=0
frm_calc=[
'not(mcANADIP.GoToKey(_coddip))
]
h=[
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1185
fatherSonIndex=0
frm_calc='_coddip
frm_seek='AppendWithKey
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_coddip
frm_seek='CODDIP
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_namdip
frm_seek='DESCRIZ
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_citdip
frm_seek='DESCCIT
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_inddip
frm_seek='DOMICILIO
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_prvdip
frm_seek='PROVINCIA
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_cabdip
frm_seek='CAB
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_macage
frm_seek='MACROAGENTE
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcANADIP
obj='Var
obj_type='MC
pag=8
prev=O1197
var_op='meth
I
obj='Var
obj_type='MC
pag=8
prev=O1196
var_op='prop
I
obj='Var
obj_type='MC
pag=8
prev=O1195
var_op='prop
I
obj='Var
obj_type='MC
pag=8
prev=O1194
var_op='prop
I
obj='Var
obj_type='MC
pag=8
prev=O1193
var_op='prop
I
obj='Var
obj_type='MC
pag=8
prev=O1192
var_op='prop
I
obj='Var
obj_type='MC
pag=8
prev=O1191
var_op='prop
I
obj='Var
obj_type='MC
pag=8
prev=O1190
var_op='prop
I
obj='Var
obj_type='MC
pag=8
var_op='meth
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=8
prev=O1162
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1163
fatherSonIndex=0
frm_calc=[
'pmcParametri.w_flgsegno='1'
'pmcParametri.w_flgsegno='2'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->CODDIPE
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->AGACCODE
len=10
name='_ajwcode
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->NUMPROG
len=11
name='_numprog
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->DESCRIZ
len=40
name='_namdip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->DESCCIT
len=40
name='_citdip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->PROVINCIA
len=2
name='_prvdip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->CAB
len=6
name='_cabdip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->DOMICILIO
len=40
name='_inddip
next=Icpitembatch.CPBeginEnd
comment='Lettura dei dati anagrafici
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->MTCN
len=11
name='numprog
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(qbe_estrai_frz_sog->DATAOPE)
len=8
name='dataope
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->DATAOPE
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fdate(qbe_estrai_frz_sog->DATAOPE)
len=10
name='f_datope
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fdate(qbe_estrai_frz_sog->DATAREG)
len=10
name='f_datreg
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->RAPPORTO
len=25
name='_rapporto
next=Icpitembatch.CPVarDecl
dec=2
frm_calc='qbe_estrai_frz_sog->TOTLIRE / 100
len=15
name='totimp
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->C_RAG
len=70
name='nominativo
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->C_STA
len=30
name='_nazben
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->TIPOOPRAP
len=2
name='tipope
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->CODANA
len=4
name='cauana
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->CODVOC
len=4
name='causin
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->SEGNO
len=1
name='segno
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->RIFIMP
len=28
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->INFORM
len=30
name='_rifimp2
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->MTCN
len=10
name='_mtcn
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->MACROAGENTE
len=5
name='_macage
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fdate(qbe_estrai_frz_sog->DATAREG)
len=10
name='f_datreg
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->RAPPORTO
len=25
name='_rapporto
next=Icpitembatch.CPVarDecl
frm_calc='''
len=165
name='_dcauana
next=Icpitembatch.CPVarDecl
frm_calc='''
len=165
name='_dcausin
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_dpaesedes
next=Icpitembatch.CPVarDecl
frm_calc='''
len=90
name='_dtipoope
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTBCAUANA.GoToKey(cauana+Left(causin,2))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Upper(LRTrim(cauana))='U2'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTBTIPREG.GoToKey(tipope)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTBSTATI.GoToKey(_nazben)
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_stator='0','Attiva',iif(_stator='1','Attiva dopo modifica',iif(_stator='2','Cancellata','Copia di modificata')))
len=30
name='_dstator
next=Icpitembatch.CPVarDecl
frm_calc=''F'
len=1
name='_orgdati
obj='Var
pag=8
prev=O1251
var_op='asgn
I
obj='Var
pag=8
prev=O1248
var_op='asgn
I
obj='If
pag=8
prev=O1245
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1248
fatherSonIndex=0
frm_calc='mcTBSTATI.DESCRI
len=30
name='_dpaesedes
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=8
prev=O1242
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1245
fatherSonIndex=0
frm_calc='mcTBTIPREG.DES1
len=90
name='_dtipoope
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=8
prev=O1239
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1242
fatherSonIndex=0
frm_calc=[
'Left(causin,2)='80'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1263
fatherSonIndex=0
frm_calc=''Consegna di mezzi di pagamento da parte di clientela'
len=165
name='_dcauana
next=Icpitembatch.CPVarDecl
frm_calc=''Consegna mezzi di pagamento'
len=165
name='_dcausin
obj='Var
pag=8
prev=O1268
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1263
fatherSonIndex=1
frm_calc=''Ritiro di mezzi di pagamento da parte di clientela'
len=165
name='_dcauana
next=Icpitembatch.CPVarDecl
frm_calc=''Ritiro mezzi di pagamento'
len=165
name='_dcausin
obj='Var
pag=8
prev=O1271
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1242
fatherSonIndex=1
frm_calc=[
'mcTBCAUSIN.GoToKey(Left(causin,2))
]
h=[
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1275
fatherSonIndex=0
frm_calc='mcTBCAUSIN.DESCRIZ
len=165
name='_dcausin
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=8
prev=O1238
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1239
fatherSonIndex=0
frm_calc='mcTBCAUANA.DESCRI
len=165
name='_dcauana
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
prev=O1237
var_op='asgn
I
obj='Var
pag=8
prev=O1236
var_op='asgn
I
obj='Var
pag=8
prev=O1235
var_op='asgn
I
obj='Var
pag=8
prev=O1234
var_op='asgn
I
obj='Var
pag=8
prev=O1233
var_op='asgn
I
obj='Var
pag=8
prev=O1232
var_op='asgn
I
obj='Var
pag=8
prev=O1231
var_op='asgn
I
obj='Var
pag=8
prev=O1230
var_op='asgn
I
obj='Var
pag=8
prev=O1229
var_op='asgn
I
obj='Var
pag=8
prev=O1228
var_op='asgn
I
obj='Var
pag=8
prev=O1227
var_op='asgn
I
obj='Var
pag=8
prev=O1226
var_op='asgn
I
obj='Var
pag=8
prev=O1225
var_op='asgn
I
obj='Var
pag=8
prev=O1224
var_op='asgn
I
obj='Var
pag=8
prev=O1223
var_op='asgn
I
obj='Var
pag=8
prev=O1222
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O1221
var_op='asgn
I
obj='Var
pag=8
prev=O1220
var_op='asgn
I
obj='Var
pag=8
prev=O1219
var_op='asgn
I
obj='Var
pag=8
prev=O1218
var_op='asgn
I
obj='Var
obj_type='D
pag=8
prev=O1217
var_op='asgn
I
obj='Var
pag=8
prev=O1216
var_op='asgn
I
obj='Var
pag=8
prev=O1214
var_op='asgn
I
obj='Begin
pag=8
prev=O1213
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1214
fatherSonIndex=0
frm_calc='LRTrim(qbe_estrai_frz_sog->CONNESCLI)
len=16
name='_ndg
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(qbe_estrai_frz_sog->CONNESDOC)
len=50
name='_connesdoc
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->DATAREG
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->STATOREG
len=1
name='_stator
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_sog->DATARETT
len=8
name='_datarett
next=Icpitembatch.CPExec
check='page
frm_calc='13
obj='Exec
pag=8
prev=O1293
I
obj='Var
obj_type='D
pag=8
prev=O1292
var_op='asgn
I
obj='Var
pag=8
prev=O1291
var_op='asgn
I
obj='Var
obj_type='D
pag=8
prev=O1290
var_op='asgn
I
obj='Var
pag=8
prev=O1289
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
prev=O1212
var_op='asgn
I
obj='Var
pag=8
prev=O1211
var_op='asgn
I
obj='Var
pag=8
prev=O1210
var_op='asgn
I
obj='Var
pag=8
prev=O1209
var_op='asgn
I
obj='Var
pag=8
prev=O1208
var_op='asgn
I
obj='Var
pag=8
prev=O1207
var_op='asgn
I
obj='Var
pag=8
prev=O1206
var_op='asgn
I
obj='Var
pag=8
prev=O1203
var_op='asgn
I
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1203
fatherSonIndex=0
frm_calc='iif(qbe_estrai_frz_sog->SEGNO='A','RECEIVE','SEND')
len=10
name='_sqr
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1203
fatherSonIndex=1
frm_calc='iif(qbe_estrai_frz_sog->SEGNO='D','RECEIVE','SEND')
len=10
name='_sqr
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
prev=O1161
var_op='asgn
I
nonlocal=True
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
I
]
test_zero_rows=True
w=[
150
150
150
]
I
I
]
w=[
150
150
]
x=12
y=20
I
Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.w_frzsel='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.w_opesel='S'
]
h=[
19
19
]
obj='If
pag=9
prev=O1306
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1309
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=9
par_expr=[
'_cfromdate
'_c_todate
'pmcParametri.w_cDIP
'pmcParametri.w_cCODFISC
'pmcParametri.w_cMTCN
'pmcParametri.w_codmag
'_mstato
'pmcParametri.w_lststa
'pmcParametri.w_lstprv
'_importo
]
par_name=[
'w_cdadata
'w_c_adata
'w_cDIP
'w_cCODFISC
'w_cMTCN
'w_codmag
'_mstato
'_lststati
'_lstprov
'_importo
]
sel_name='qbe_estrai_ope_mtcn
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O1314
fatherSonIndex=0
frm_calc=''Elaboro operazione con progressivo n°: '+qbe_estrai_ope_mtcn->NUMPROG
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='riga + 1
len=10
name='riga
next=Icpitembatch.CPBeginEnd
comment='Riempie variabili con valori della query
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Scrive il record della dipendenza
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.w_tipoout='E'
'pmcParametri.w_tipoout='T'
'pmcParametri.w_tipoout='C'
]
h=[
19
19
19
19
19
]
haselse=True
obj='If
pag=9
prev=O1324
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1326
fatherSonIndex=0
frm_calc='10
obj='Exec
pag=9
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1326
fatherSonIndex=1
frm_calc='11
obj='Exec
pag=9
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1326
fatherSonIndex=2
frm_calc='12
obj='Exec
pag=9
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1326
fatherSonIndex=3
frm_calc='_ctot + 1
len=10
name='_ctot
next=Icpitembatch.CPInsert
arch='dw_operazioni
obj='Insert
pag=9
prev=O1337
rd_kfield=[
'PROGOPE
'TIPO
'CODDIP
'AGENZIA
'SEDE_AGENZIA
'NUMOPE
'IMPORTO
'NDG
'COGNOME
'NOME
'SESSO
'LUOGONAS
'DATANAS
'CODFISC
'TIPODOC
'NUMDOC
'DATARIL
'AUTRIL
'CITTARES
'CAPRES
'PRVRES
'INDIRIZZO
'STATORES
'TIPOOPEUIC
'CAUANA
'CAUSIN
'SEGNO
'DATAOPE
'RAGSOCCONT
'PAESECONT
'STATOOPE
'DATAREG
'OPEFRZ
'MTCN
'MACROAGENTE
'CFESTERO
'CODINTER
]
rd_kvar=[
'_ctot
'_sqr
'_coddip
'_namdip
'_citdip
'_numprog
'totimp
'_ndg
'_cogman
'_nomman
'sesso
'_luonas
'_datnas
'codfisc
'_tipdoc
'_numdoc
'_datadoc
'_autril
'citres
'capres
'prvres
'indirizzo
'stares
'_dtipoope
'_dcauana
'_dcausin
'segno
'_dataope
'nominativo
'_dpaesedes
'_dstator
'_datareg
'_orgdati
'numprog
'_macage
'_cfestero
'_codinter
]
I
obj='Var
obj_type='N
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Begin
pag=9
prev=O1322
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1324
fatherSonIndex=0
frm_calc=[
'not(mcANADIP.GoToKey(_coddip))
]
h=[
19
19
]
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1344
fatherSonIndex=0
frm_calc='_coddip
frm_seek='AppendWithKey
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_coddip
frm_seek='CODDIP
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_namdip
frm_seek='DESCRIZ
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_citdip
frm_seek='DESCCIT
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_inddip
frm_seek='DOMICILIO
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_prvdip
frm_seek='PROVINCIA
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_cabdip
frm_seek='CAB
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_macage
frm_seek='MACROAGENTE
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcANADIP
obj='Var
obj_type='MC
pag=9
prev=O1356
var_op='meth
I
obj='Var
obj_type='MC
pag=9
prev=O1355
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1354
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1353
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1352
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1351
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1350
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1349
var_op='prop
I
obj='Var
obj_type='MC
pag=9
var_op='meth
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=9
prev=O1321
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1322
fatherSonIndex=0
frm_calc=[
'pmcParametri.w_flgsegno='1'
'pmcParametri.w_flgsegno='2'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->NUMPROG
len=11
name='_numprog
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->CODDIPE
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->AGACCODE
len=10
name='_ajwcode
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->DESCRIZ
len=40
name='_namdip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->DESCCIT
len=40
name='_citdip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->PROVINCIA
len=2
name='_prvdip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->CAB
len=6
name='_cabdip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->DOMICILIO
len=40
name='_inddip
next=Icpitembatch.CPBeginEnd
comment='Lettura dei dati anagrafici
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->MTCN
len=11
name='numprog
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(qbe_estrai_ope_mtcn->DATAOPE)
len=8
name='dataope
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->DATAOPE
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fdate(qbe_estrai_ope_mtcn->DATAOPE)
len=10
name='f_datope
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fdate(qbe_estrai_ope_mtcn->DATAREG)
len=10
name='f_datreg
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->RAPPORTO
len=25
name='_rapporto
next=Icpitembatch.CPVarDecl
dec=2
frm_calc='qbe_estrai_ope_mtcn->TOTLIRE / 100
len=15
name='totimp
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->C_RAG
len=70
name='nominativo
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->C_STA
len=30
name='_nazben
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->TIPOOPRAP
len=2
name='tipope
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->CODANA
len=4
name='cauana
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->CODVOC
len=4
name='causin
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->SEGNO
len=1
name='segno
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->RIFIMP
len=28
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->INFORM
len=30
name='_rifimp2
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->MTCN
len=10
name='_mtcn
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->MACROAGENTE
len=5
name='_macage
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fdate(qbe_estrai_ope_mtcn->DATAREG)
len=10
name='f_datreg
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->RAPPORTO
len=25
name='_rapporto
next=Icpitembatch.CPVarDecl
frm_calc='''
len=165
name='_dcauana
next=Icpitembatch.CPVarDecl
frm_calc='''
len=165
name='_dcausin
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_dpaesedes
next=Icpitembatch.CPVarDecl
frm_calc='''
len=90
name='_dtipoope
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTBCAUANA.GoToKey(cauana+Left(causin,2))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Upper(LRTrim(cauana))='U2'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTBTIPREG.GoToKey(tipope)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTBSTATI.GoToKey(_nazben)
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_stator='0','Attiva',iif(_stator='1','Attiva dopo modifica',iif(_stator='2','Cancellata','Copia di modificata')))
len=30
name='_dstator
next=Icpitembatch.CPVarDecl
frm_calc=''O'
len=1
name='_orgdati
obj='Var
pag=9
prev=O1410
var_op='asgn
I
obj='Var
pag=9
prev=O1407
var_op='asgn
I
obj='If
pag=9
prev=O1404
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1407
fatherSonIndex=0
frm_calc='mcTBSTATI.DESCRI
len=30
name='_dpaesedes
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O1401
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1404
fatherSonIndex=0
frm_calc='mcTBTIPREG.DES1
len=90
name='_dtipoope
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O1398
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1401
fatherSonIndex=0
frm_calc=[
'Left(causin,2)='80'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1422
fatherSonIndex=0
frm_calc=''Consegna di mezzi di pagamento da parte di clientela'
len=165
name='_dcauana
next=Icpitembatch.CPVarDecl
frm_calc=''Consegna mezzi di pagamento'
len=165
name='_dcausin
obj='Var
pag=9
prev=O1427
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1422
fatherSonIndex=1
frm_calc=''Ritiro di mezzi di pagamento da parte di clientela'
len=165
name='_dcauana
next=Icpitembatch.CPVarDecl
frm_calc=''Ritiro mezzi di pagamento'
len=165
name='_dcausin
obj='Var
pag=9
prev=O1430
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1401
fatherSonIndex=1
frm_calc=[
'mcTBCAUSIN.GoToKey(Left(causin,2))
]
h=[
19
19
]
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1434
fatherSonIndex=0
frm_calc='mcTBCAUSIN.DESCRIZ
len=165
name='_dcausin
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=9
prev=O1397
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1398
fatherSonIndex=0
frm_calc='mcTBCAUANA.DESCRI
len=165
name='_dcauana
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O1396
var_op='asgn
I
obj='Var
pag=9
prev=O1395
var_op='asgn
I
obj='Var
pag=9
prev=O1394
var_op='asgn
I
obj='Var
pag=9
prev=O1393
var_op='asgn
I
obj='Var
pag=9
prev=O1392
var_op='asgn
I
obj='Var
pag=9
prev=O1391
var_op='asgn
I
obj='Var
pag=9
prev=O1390
var_op='asgn
I
obj='Var
pag=9
prev=O1389
var_op='asgn
I
obj='Var
pag=9
prev=O1388
var_op='asgn
I
obj='Var
pag=9
prev=O1387
var_op='asgn
I
obj='Var
pag=9
prev=O1386
var_op='asgn
I
obj='Var
pag=9
prev=O1385
var_op='asgn
I
obj='Var
pag=9
prev=O1384
var_op='asgn
I
obj='Var
pag=9
prev=O1383
var_op='asgn
I
obj='Var
pag=9
prev=O1382
var_op='asgn
I
obj='Var
pag=9
prev=O1381
var_op='asgn
I
obj='Var
obj_type='N
pag=9
prev=O1380
var_op='asgn
I
obj='Var
pag=9
prev=O1379
var_op='asgn
I
obj='Var
pag=9
prev=O1378
var_op='asgn
I
obj='Var
pag=9
prev=O1377
var_op='asgn
I
obj='Var
obj_type='D
pag=9
prev=O1376
var_op='asgn
I
obj='Var
pag=9
prev=O1375
var_op='asgn
I
obj='Var
pag=9
prev=O1373
var_op='asgn
I
obj='Begin
pag=9
prev=O1372
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1373
fatherSonIndex=0
frm_calc='LRTrim(qbe_estrai_ope_mtcn->CONNESCLI)
len=16
name='_ndg
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(qbe_estrai_ope_mtcn->CONNESDOC)
len=50
name='_connesdoc
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->DATAREG
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->STATOREG
len=1
name='_stator
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_ope_mtcn->DATARETT
len=8
name='_datarett
next=Icpitembatch.CPExec
check='page
frm_calc='13
obj='Exec
pag=9
prev=O1452
I
obj='Var
obj_type='D
pag=9
prev=O1451
var_op='asgn
I
obj='Var
pag=9
prev=O1450
var_op='asgn
I
obj='Var
obj_type='D
pag=9
prev=O1449
var_op='asgn
I
obj='Var
pag=9
prev=O1448
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O1371
var_op='asgn
I
obj='Var
pag=9
prev=O1370
var_op='asgn
I
obj='Var
pag=9
prev=O1369
var_op='asgn
I
obj='Var
pag=9
prev=O1368
var_op='asgn
I
obj='Var
pag=9
prev=O1367
var_op='asgn
I
obj='Var
pag=9
prev=O1366
var_op='asgn
I
obj='Var
pag=9
prev=O1365
var_op='asgn
I
obj='Var
pag=9
prev=O1362
var_op='asgn
I
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1362
fatherSonIndex=0
frm_calc='iif(qbe_estrai_ope_mtcn->SEGNO='A','RECEIVE','SEND')
len=10
name='_sqr
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1362
fatherSonIndex=1
frm_calc='iif(qbe_estrai_ope_mtcn->SEGNO='D','RECEIVE','SEND')
len=10
name='_sqr
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=9
prev=O1320
var_op='asgn
I
nonlocal=True
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1306
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=9
par_expr=[
'_cfromdate
'_c_todate
'pmcParametri.w_cDIP
'pmcParametri.w_cCODFISC
'pmcParametri.w_cMTCN
'pmcParametri.w_codmag
'_mstato
'pmcParametri.w_lststa
'pmcParametri.w_lstprv
'_importo
]
par_name=[
'w_cdadata
'w_c_adata
'w_cDIP
'w_cCODFISC
'w_cMTCN
'w_codmag
'_mstato
'_lststati
'_lstprov
'_importo
]
sel_name='qbe_estrai_frz_mtcn
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O1466
fatherSonIndex=0
frm_calc=''Elaboro frazionata con progressivo n°: '+qbe_estrai_frz_mtcn->NUMPROG
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='riga + 1
len=10
name='riga
next=Icpitembatch.CPBeginEnd
comment='Riempie variabili con valori della query
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Scrive il record della dipendenza
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.w_tipoout='E'
'pmcParametri.w_tipoout='T'
'pmcParametri.w_tipoout='C'
]
h=[
19
19
19
19
19
]
haselse=True
obj='If
pag=9
prev=O1476
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1478
fatherSonIndex=0
frm_calc='10
obj='Exec
pag=9
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1478
fatherSonIndex=1
frm_calc='11
obj='Exec
pag=9
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1478
fatherSonIndex=2
frm_calc='12
obj='Exec
pag=9
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1478
fatherSonIndex=3
frm_calc='_ctot + 1
len=10
name='_ctot
next=Icpitembatch.CPInsert
arch='dw_operazioni
obj='Insert
pag=9
prev=O1489
rd_kfield=[
'PROGOPE
'TIPO
'CODDIP
'AGENZIA
'SEDE_AGENZIA
'NUMOPE
'IMPORTO
'NDG
'COGNOME
'NOME
'SESSO
'LUOGONAS
'DATANAS
'CODFISC
'TIPODOC
'NUMDOC
'DATARIL
'AUTRIL
'CITTARES
'CAPRES
'PRVRES
'INDIRIZZO
'STATORES
'TIPOOPEUIC
'CAUANA
'CAUSIN
'SEGNO
'DATAOPE
'RAGSOCCONT
'PAESECONT
'STATOOPE
'DATAREG
'OPEFRZ
'MTCN
'MACROAGENTE
'CFESTERO
'CODINTER
]
rd_kvar=[
'_ctot
'_sqr
'_coddip
'_namdip
'_citdip
'_numprog
'totimp
'_ndg
'_cogman
'_nomman
'sesso
'_luonas
'_datnas
'codfisc
'_tipdoc
'_numdoc
'_datadoc
'_autril
'citres
'capres
'prvres
'indirizzo
'stares
'_dtipoope
'_dcauana
'_dcausin
'segno
'_dataope
'nominativo
'_dpaesedes
'_dstator
'_datareg
'_orgdati
'numprog
'_macage
'_cfestero
'_codinter
]
I
obj='Var
obj_type='N
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Begin
pag=9
prev=O1474
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1476
fatherSonIndex=0
frm_calc=[
'not(mcANADIP.GoToKey(_coddip))
]
h=[
19
19
]
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1496
fatherSonIndex=0
frm_calc='_coddip
frm_seek='AppendWithKey
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_coddip
frm_seek='CODDIP
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_namdip
frm_seek='DESCRIZ
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_citdip
frm_seek='DESCCIT
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_inddip
frm_seek='DOMICILIO
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_prvdip
frm_seek='PROVINCIA
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_cabdip
frm_seek='CAB
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_calc='_macage
frm_seek='MACROAGENTE
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcANADIP
obj='Var
obj_type='MC
pag=9
prev=O1508
var_op='meth
I
obj='Var
obj_type='MC
pag=9
prev=O1507
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1506
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1505
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1504
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1503
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1502
var_op='prop
I
obj='Var
obj_type='MC
pag=9
prev=O1501
var_op='prop
I
obj='Var
obj_type='MC
pag=9
var_op='meth
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=9
prev=O1473
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1474
fatherSonIndex=0
frm_calc=[
'pmcParametri.w_flgsegno='1'
'pmcParametri.w_flgsegno='2'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->CODDIPE
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->AGACCODE
len=10
name='_ajwcode
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->NUMPROG
len=11
name='_numprog
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->DESCRIZ
len=40
name='_namdip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->DESCCIT
len=40
name='_citdip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->PROVINCIA
len=2
name='_prvdip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->CAB
len=6
name='_cabdip
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->DOMICILIO
len=40
name='_inddip
next=Icpitembatch.CPBeginEnd
comment='Lettura dei dati anagrafici
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->MTCN
len=11
name='numprog
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(qbe_estrai_frz_mtcn->DATAOPE)
len=8
name='dataope
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->DATAOPE
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fdate(qbe_estrai_frz_mtcn->DATAOPE)
len=10
name='f_datope
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fdate(qbe_estrai_frz_mtcn->DATAREG)
len=10
name='f_datreg
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->RAPPORTO
len=25
name='_rapporto
next=Icpitembatch.CPVarDecl
dec=2
frm_calc='qbe_estrai_frz_mtcn->TOTLIRE / 100
len=15
name='totimp
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->C_RAG
len=70
name='nominativo
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->C_STA
len=30
name='_nazben
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->TIPOOPRAP
len=2
name='tipope
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->CODANA
len=4
name='cauana
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->CODVOC
len=4
name='causin
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->SEGNO
len=1
name='segno
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->RIFIMP
len=28
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->INFORM
len=30
name='_rifimp2
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->MTCN
len=10
name='_mtcn
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->MACROAGENTE
len=5
name='_macage
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fdate(qbe_estrai_frz_mtcn->DATAREG)
len=10
name='f_datreg
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->RAPPORTO
len=25
name='_rapporto
next=Icpitembatch.CPVarDecl
frm_calc='''
len=165
name='_dcauana
next=Icpitembatch.CPVarDecl
frm_calc='''
len=165
name='_dcausin
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_dpaesedes
next=Icpitembatch.CPVarDecl
frm_calc='''
len=90
name='_dtipoope
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTBCAUANA.GoToKey(cauana+Left(causin,2))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Upper(LRTrim(cauana))='U2'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTBTIPREG.GoToKey(tipope)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTBSTATI.GoToKey(_nazben)
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_stator='0','Attiva',iif(_stator='1','Attiva dopo modifica',iif(_stator='2','Cancellata','Copia di modificata')))
len=30
name='_dstator
next=Icpitembatch.CPVarDecl
frm_calc=''F'
len=1
name='_orgdati
obj='Var
pag=9
prev=O1562
var_op='asgn
I
obj='Var
pag=9
prev=O1559
var_op='asgn
I
obj='If
pag=9
prev=O1556
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1559
fatherSonIndex=0
frm_calc='mcTBSTATI.DESCRI
len=30
name='_dpaesedes
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O1553
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1556
fatherSonIndex=0
frm_calc='mcTBTIPREG.DES1
len=90
name='_dtipoope
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O1550
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1553
fatherSonIndex=0
frm_calc=[
'Left(causin,2)='80'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1574
fatherSonIndex=0
frm_calc=''Consegna di mezzi di pagamento da parte di clientela'
len=165
name='_dcauana
next=Icpitembatch.CPVarDecl
frm_calc=''Consegna mezzi di pagamento'
len=165
name='_dcausin
obj='Var
pag=9
prev=O1579
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1574
fatherSonIndex=1
frm_calc=''Ritiro di mezzi di pagamento da parte di clientela'
len=165
name='_dcauana
next=Icpitembatch.CPVarDecl
frm_calc=''Ritiro mezzi di pagamento'
len=165
name='_dcausin
obj='Var
pag=9
prev=O1582
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1553
fatherSonIndex=1
frm_calc=[
'mcTBCAUSIN.GoToKey(Left(causin,2))
]
h=[
19
19
]
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1586
fatherSonIndex=0
frm_calc='mcTBCAUSIN.DESCRIZ
len=165
name='_dcausin
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=9
prev=O1549
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1550
fatherSonIndex=0
frm_calc='mcTBCAUANA.DESCRI
len=165
name='_dcauana
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O1548
var_op='asgn
I
obj='Var
pag=9
prev=O1547
var_op='asgn
I
obj='Var
pag=9
prev=O1546
var_op='asgn
I
obj='Var
pag=9
prev=O1545
var_op='asgn
I
obj='Var
pag=9
prev=O1544
var_op='asgn
I
obj='Var
pag=9
prev=O1543
var_op='asgn
I
obj='Var
pag=9
prev=O1542
var_op='asgn
I
obj='Var
pag=9
prev=O1541
var_op='asgn
I
obj='Var
pag=9
prev=O1540
var_op='asgn
I
obj='Var
pag=9
prev=O1539
var_op='asgn
I
obj='Var
pag=9
prev=O1538
var_op='asgn
I
obj='Var
pag=9
prev=O1537
var_op='asgn
I
obj='Var
pag=9
prev=O1536
var_op='asgn
I
obj='Var
pag=9
prev=O1535
var_op='asgn
I
obj='Var
pag=9
prev=O1534
var_op='asgn
I
obj='Var
pag=9
prev=O1533
var_op='asgn
I
obj='Var
obj_type='N
pag=9
prev=O1532
var_op='asgn
I
obj='Var
pag=9
prev=O1531
var_op='asgn
I
obj='Var
pag=9
prev=O1530
var_op='asgn
I
obj='Var
pag=9
prev=O1529
var_op='asgn
I
obj='Var
obj_type='D
pag=9
prev=O1528
var_op='asgn
I
obj='Var
pag=9
prev=O1527
var_op='asgn
I
obj='Var
pag=9
prev=O1525
var_op='asgn
I
obj='Begin
pag=9
prev=O1524
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1525
fatherSonIndex=0
frm_calc='LRTrim(qbe_estrai_frz_mtcn->CONNESCLI)
len=16
name='_ndg
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(qbe_estrai_frz_mtcn->CONNESDOC)
len=50
name='_connesdoc
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->DATAREG
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->STATOREG
len=1
name='_stator
next=Icpitembatch.CPVarDecl
frm_calc='qbe_estrai_frz_mtcn->DATARETT
len=8
name='_datarett
next=Icpitembatch.CPExec
check='page
frm_calc='13
obj='Exec
pag=9
prev=O1604
I
obj='Var
obj_type='D
pag=9
prev=O1603
var_op='asgn
I
obj='Var
pag=9
prev=O1602
var_op='asgn
I
obj='Var
obj_type='D
pag=9
prev=O1601
var_op='asgn
I
obj='Var
pag=9
prev=O1600
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O1523
var_op='asgn
I
obj='Var
pag=9
prev=O1522
var_op='asgn
I
obj='Var
pag=9
prev=O1521
var_op='asgn
I
obj='Var
pag=9
prev=O1520
var_op='asgn
I
obj='Var
pag=9
prev=O1519
var_op='asgn
I
obj='Var
pag=9
prev=O1518
var_op='asgn
I
obj='Var
pag=9
prev=O1517
var_op='asgn
I
obj='Var
pag=9
prev=O1514
var_op='asgn
I
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1514
fatherSonIndex=0
frm_calc='iif(qbe_estrai_frz_mtcn->SEGNO='A','RECEIVE','SEND')
len=10
name='_sqr
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1514
fatherSonIndex=1
frm_calc='iif(qbe_estrai_frz_mtcn->SEGNO='D','RECEIVE','SEND')
len=10
name='_sqr
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=9
prev=O1472
var_op='asgn
I
nonlocal=True
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
x=17
y=20
I
Icpitembatch.CPBeginEnd
comment='Crea la prima riga
h=[
19
19
]
obj='Begin
pag=11
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1616
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad(_sqr,8)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(_namdip,41)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + Space(36)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(_citdip,31)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(Str(totimp,12,2),13)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(_ndg,17)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(_cogman,27)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(_nomman,26)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(sesso,6)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(_luonas,31)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(f_datnas,16)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(codfisc,17)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(_tipdoc,10)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(_numdoc,16)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(f_datdoc,14)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(_autril,31)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(citres,31)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(indirizzo,36)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(stares,16)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(tipope,16)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(cauana,18)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(causin,18)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(segno,17)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(f_datope,16)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(nominativo,71)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(_nazben,18)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(_numprog,14)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(_stator,20)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(_rapporto,26)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(f_datreg,19)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + _orgdati +Space(21)
len=10
name='_file
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgWU='S'
]
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(fhand,_file)
obj='Exec
pag=11
prev=O1651
I
obj='If
pag=11
prev=O1650
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1651
fatherSonIndex=0
frm_calc='_file + LibreriaMit.SpacePad(_mtcn,11)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(_macage,12)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(_coddip,13)
len=10
name='_file
next=Icpitembatch.CPVarDecl
frm_calc='_file + LibreriaMit.SpacePad(_cfestero,24)
len=10
name='_file
obj='Var
obj_type='M
pag=11
prev=O1659
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1658
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1657
var_op='asgn
I
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=11
prev=O1649
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1648
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1647
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1646
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1645
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1644
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1643
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1642
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1641
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1640
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1639
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1638
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1637
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1636
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1635
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1634
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1633
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1632
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1631
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1630
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1629
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1628
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1627
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1626
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1625
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1624
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1623
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1622
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1621
var_op='asgn
I
obj='Var
obj_type='M
pag=11
prev=O1620
var_op='asgn
I
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
w=[
150
150
]
x=17
y=22
I
Icpitembatch.CPRemark
frm_calc='Crea il file delle dipendenze
next=Icpitembatch.CPVarDecl
frm_calc='Strtran(LRTrim(_testa),'movimenti','agenzie')
len=50
name='_agetesta
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.w_tipoout='E'
'pmcParametri.w_tipoout='C'
]
h=[
19
19
19
]
next=Icpitembatch.CPForEach
for_variable='rowANADIP
for_variable_type='anadip
h=[
19
19
]
iterator_expr='mcANADIP
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.w_tipoout='E'
'pmcParametri.w_tipoout='C'
]
h=[
19
19
19
]
obj='If
pag=15
prev=O1668
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Creazione file excel
father=O1670
fatherSonIndex=0
h=[
19
19
]
obj='Begin
pag=15
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O1675
fatherSonIndex=0
frm_calc=''Attendere. Creazione del file excel ...'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPExec
check='man
frm_calc='//Ridimensiono le colonne in base al contenuto﷯sheet.autoSizeColumn(0);﷯sheet.autoSizeColumn(1);﷯sheet.autoSizeColumn(2);﷯sheet.autoSizeColumn(3);﷯sheet.autoSizeColumn(4);﷯sheet.autoSizeColumn(5);
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgWU='S'
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='// scrivo il file di esito﷯FileOutputStream fileOut = new FileOutputStream(CPLib.LRTrim(_nfile));﷯﷯//write this workbook to an Outputstream.﷯wb.write(fileOut);﷯fileOut.flush();﷯fileOut.close();
obj='Exec
pag=15
prev=O1681
I
obj='If
pag=15
prev=O1680
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1681
fatherSonIndex=0
frm_calc='// Formatta colonne aggiuntive WU﷯sheet.autoSizeColumn(6);
obj='Exec
pag=15
I
I
]
w=[
150
150
]
I
obj='Exec
pag=15
prev=O1679
I
nonlocal=True
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O1670
fatherSonIndex=1
frm_calc='cwriter.close()
obj='Exec
pag=15
I
I
]
w=[
150
150
150
]
I
obj='ForEach
pag=15
prev=O1665
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1668
fatherSonIndex=0
frm_calc='rowANADIP.CODDIP
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='rowANADIP.DESCRIZ
len=40
name='_namdip
next=Icpitembatch.CPVarDecl
frm_calc='rowANADIP.DOMICILIO
len=40
name='_inddip
next=Icpitembatch.CPVarDecl
frm_calc='rowANADIP.DESCCIT
len=40
name='_citdip
next=Icpitembatch.CPVarDecl
frm_calc='rowANADIP.PROVINCIA
len=2
name='_prvdip
next=Icpitembatch.CPVarDecl
frm_calc='rowANADIP.CAB
len=6
name='_cabdip
next=Icpitembatch.CPVarDecl
frm_calc='rowANADIP.MACROAGENTE
len=5
name='_macage
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.w_tipoout='E'
'pmcParametri.w_tipoout='C'
]
h=[
19
19
19
]
obj='If
pag=15
prev=O1701
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Scrive la riga
father=O1702
fatherSonIndex=0
h=[
19
19
]
obj='Begin
pag=15
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1707
fatherSonIndex=0
frm_calc='//Creo il record da scrivere﷯row = sheet.createRow(r);﷯cell = row.createCell(0);﷯cell.setCellValue(CPLib.LRTrim(_coddip));﷯cell = row.createCell(1);﷯cell.setCellValue(CPLib.LRTrim(_namdip));﷯cell = row.createCell(2);﷯cell.setCellValue(CPLib.LRTrim(_inddip));﷯cell = row.createCell(3);﷯cell.setCellValue(CPLib.LRTrim(_citdip));﷯cell = row.createCell(4);﷯cell.setCellValue(CPLib.LRTrim(_prvdip));﷯cell = row.createCell(5);﷯cell.setCellValue(CPLib.LRTrim(_cabdip));
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgWU='S'
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='// Contatore Righe﷯r++;
obj='Exec
pag=15
prev=O1712
I
obj='If
pag=15
prev=O1711
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1712
fatherSonIndex=0
frm_calc='// Scrive MTCN e MacroAgente per WU﷯cell = row.createCell(6);﷯cell.setCellValue(CPLib.LRTrim(_macage));
obj='Exec
pag=15
I
I
]
w=[
150
150
]
I
obj='Exec
pag=15
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Crea la riga coi dati
father=O1702
fatherSonIndex=1
h=[
19
19
]
obj='Begin
pag=15
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1722
fatherSonIndex=0
frm_calc='// Creazione della prima riga﷯campi[0]=_coddip;﷯campi[1]=_namdip;﷯campi[2]=_inddip;﷯campi[3]=_citdip;﷯campi[4]=_prvdip;﷯campi[5]=_cabdip;
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgWU='S'
]
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='cwriter.writeNext(campi)
obj='Exec
pag=15
prev=O1727
I
obj='If
pag=15
prev=O1726
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1727
fatherSonIndex=0
frm_calc='// CAmpi WU﷯campi[6]=_macage;
obj='Exec
pag=15
I
I
]
w=[
150
150
]
I
obj='Exec
pag=15
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=15
prev=O1700
var_op='asgn
I
obj='Var
pag=15
prev=O1699
var_op='asgn
I
obj='Var
pag=15
prev=O1698
var_op='asgn
I
obj='Var
pag=15
prev=O1697
var_op='asgn
I
obj='Var
pag=15
prev=O1696
var_op='asgn
I
obj='Var
pag=15
prev=O1695
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=15
prev=O1664
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRemark
father=O1665
fatherSonIndex=0
frm_calc='Formato Excel
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(pmcParametri.w_destfold)),LRTrim(_gPathApp)+"/export/"+LRTrim(_gAzienda)+"/"+LRTrim(_agetesta)+".xlsx",LRTrim(pmcParametri.w_destfold)+"/"+LRTrim(_agetesta)+".xlsx")
len=50
name='_nfile
next=Icpitembatch.CPExec
check='man
frm_calc='// These are the files to include in the ZIP file﷯filenames.add(CPLib.LRTrim(_nfile));﷯fileonames.add(CPLib.LRTrim(_agetesta)+".xlsx");
next=Icpitembatch.CPRemark
frm_calc='Seleziona i record
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='riga
next=Icpitembatch.CPBeginEnd
comment='Creo file per risultati
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Crea la prima riga
h=[
19
19
]
obj='Begin
pag=15
prev=O1745
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPExec
check='man
father=O1747
fatherSonIndex=0
frm_calc='//Azzero i contatori di fogli letti e righe scritte﷯_i = 0;﷯r=0;﷯//Creo il record da scrivere﷯row = sheet.createRow(r);﷯//scrivo la riga di intestazione﷯cell = row.createCell(0);﷯cell.setCellValue("Codice AGENZIA");﷯cell.setCellStyle(cs);﷯cell = row.createCell(1);﷯cell.setCellValue("AGENZIA");﷯cell.setCellStyle(cs);﷯cell =  row.createCell(2);﷯cell.setCellValue("INDIRIZZO");﷯cell.setCellStyle(cs);﷯cell =  row.createCell(3);﷯cell.setCellValue("CITTA'");﷯cell.setCellStyle(cs);﷯cell =  row.createCell(4);﷯cell.setCellValue("PROVINCIA");﷯cell.setCellStyle(cs);﷯cell =  row.createCell(5);﷯cell.setCellValue("CAB");﷯cell.setCellStyle(cs);
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgWU='S'
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='// Aggiorna il contatore delle righe﷯r++;
obj='Exec
pag=15
prev=O1752
I
obj='If
pag=15
prev=O1751
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1752
fatherSonIndex=0
frm_calc='// Scrive MTCN e MacroAgente per WU﷯cell = row.createCell(6);﷯cell.setCellValue("MACROAGENTE");﷯cell.setCellStyle(cs);
obj='Exec
pag=15
I
I
]
w=[
150
150
]
I
obj='Exec
pag=15
I
I
]
w=[
150
150
]
I
obj='Begin
pag=15
prev=O1744
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1745
fatherSonIndex=0
frm_calc='// creo il contenitore dei fogli﷯wb = new SXSSFWorkbook();﷯sheet = (SXSSFSheet) wb.createSheet("Foglio1") ;﷯CellStyle cs = wb.createCellStyle();﷯cs.setFillForegroundColor(IndexedColors.LIME.getIndex());﷯cs.setFillPattern(FillPatternType.SOLID_FOREGROUND);﷯Font f = wb.createFont();﷯f.setBold(true);﷯f.setFontHeightInPoints((short) 11);﷯cs.setFont(f);
obj='Exec
pag=15
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=15
prev=O1743
var_op='asgn
I
obj='Remark
pag=15
prev=O1742
I
obj='Exec
pag=15
prev=O1741
I
obj='Var
pag=15
prev=O1740
var_op='asgn
I
obj='Remark
pag=15
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1665
fatherSonIndex=1
frm_calc='iif(Empty(LRTrim(pmcParametri.w_destfold)),LRTrim(_gPathApp)+"/export/"+LRTrim(_gAzienda)+"/"+LRTrim(_agetesta)+".csv",LRTrim(pmcParametri.w_destfold)+"/"+LRTrim(_agetesta)+".csv")
len=50
name='_nfile
next=Icpitembatch.CPExec
check='man
frm_calc='// These are the files to include in the ZIP file﷯filenames.add(CPLib.LRTrim(_nfile));﷯fileonames.add(CPLib.LRTrim(_agetesta)+".csv");
next=Icpitembatch.CPExec
check='man
frm_calc='// Creazione del writer﷯cwriter=new CSVWriter(new FileWriter(_nfile));
next=Icpitembatch.CPBeginEnd
comment='Crea la prima riga
h=[
19
19
]
obj='Begin
pag=15
prev=O1768
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1769
fatherSonIndex=0
frm_calc='// Creazione della prima riga﷯ncampi=(CPLib.eqr(gFlgWU,"S")?9:8);﷯campi = new String[ncampi];﷯campi[0]="CODICE AGENZIA";﷯campi[1]="AGENZIA";﷯campi[2]="INDIRIZZO";﷯campi[3]="CITTA";﷯campi[4]="PROVINCIA";﷯campi[5]="CAB";
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgWU='S'
]
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='cwriter.writeNext(campi)
obj='Exec
pag=15
prev=O1774
I
obj='If
pag=15
prev=O1773
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1774
fatherSonIndex=0
frm_calc='// CAmpi WU﷯campi[6]="MACROAGENTE";
obj='Exec
pag=15
I
I
]
w=[
150
150
]
I
obj='Exec
pag=15
I
I
]
w=[
150
150
]
I
obj='Exec
pag=15
prev=O1767
I
obj='Exec
pag=15
prev=O1766
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=15
prev=O1663
var_op='asgn
I
obj='Remark
pag=15
x=14
y=19
I
Icpitembatch.CPBeginEnd
comment='Parametri dell'elaborazione
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili globali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Cursori tabelle
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Riempie il memory Cursor dei parametri
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Riempie i memory cursor delle tabelle
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_seek='GoTop
name='pmcParametri
next=Icpitembatch.CPVarDecl
frm_calc='DateTimeToChar(DateTime())
len=14
name='dataoggi
next=Icpitembatch.CPVarDecl
comment='Path Applicazione
frm_calc='pPath
len=80
name='_gPathApp
next=Icpitembatch.CPVarDecl
comment='Azienda
frm_calc='pAzienda
len=10
name='_gAzienda
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='_mstato
next=Icpitembatch.CPVarDecl
comment='Nome file
frm_calc='pmcParametri.w_nomefile
len=60
name='_nomefile
next=Icpitembatch.CPVarDecl
frm_calc='pmcParametri.w_importo * 100
len=15
name='_importo
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.pTipo='B'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.w_attive='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_totalone
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='riga
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Calcolo Operazioni/Frazionate da Elaborare'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.w_frzsel='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.w_opesel='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(_gAzienda)+"_movimenti_"+dataoggi
len=50
name='_testa
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(pmcParametri.w_destfold)),LRTrim(_gPathApp)+'/export/'+LRTrim(_gAzienda)+"/"+LRTrim(_testa)+".zip",LRTrim(pmcParametri.w_destfold)+"/"+LRTrim(_testa)+".zip")
len=30
name='cNomeFileZip
next=Icpitembatch.CPDropTemporaryTable
next=Icpitembatch.CPServerTemporaryTable
next=Icpitembatch.CPDropTemporaryTable
next=Icpitembatch.CPServerTemporaryTable
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
comment='NomeFile
frm_calc='LRTrim(_testa)+".zip"
global=True
len=80
name='gFileName
nonlocal=True
obj='Var
pag=1
prev=O1825
var_op='asgn
I
obj='Try
pag=1
prev=O1824
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1825
fatherSonIndex=0
frm_calc=[
'pmcParametri.w_flgmese='N'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPTransaction
frm_calc='commit
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.pTipo='B'
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='page
frm_calc='15
next=Icpitembatch.CPExec
check='page
frm_calc='14
obj='Exec
pag=1
prev=O1837
I
obj='Exec
pag=1
prev=O1834
I
obj='If
pag=1
prev=O1833
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='processi
father=O1834
fatherSonIndex=0
obj='Write
pag=1
rd_kfield=[
'PR_TIPO
'PRCODICE
]
rd_kop=[
'=
'=
]
rd_kvar=[
''EXT'
'prcProg
]
wr_field=[
'PRFILEOUT
'PRDOSTOP
'PRESITO
'PRNOMEFILE
'PRGMSGSTA
]
wr_op=[
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(cNomeFileZip)
'DateTime()
''P'
'LRTrim(_testa)+".zip"
''Estrazione Terminata ('+LRTrim(Str(_totalone,10,0))+' movimenti)'
]
I
I
]
w=[
150
150
]
I
obj='Transaction
pag=1
prev=O1830
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1830
fatherSonIndex=0
frm_calc='iif(DateToChar(pmcParametri.w_dadata)='01000101',NullDate(),pmcParametri.w_dadata)
len=8
name='_dadata
next=Icpitembatch.CPVarDecl
frm_calc='iif(DateToChar(pmcParametri.w_adata)='01000101',NullDate(),pmcParametri.w_adata)
len=8
name='_a_data
next=Icpitembatch.CPVarDecl
frm_calc='iif(DateToChar(pmcParametri.w_dadata)='01000101','',DateToChar(_dadata))
len=8
name='_cfromdate
next=Icpitembatch.CPVarDecl
frm_calc='iif(DateToChar(pmcParametri.w_adata)='01000101','',DateToChar(_a_data))
len=8
name='_c_todate
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.w_tipoout='E'
'pmcParametri.w_tipoout='D' or pmcParametri.w_tipoout='Z'
'pmcParametri.w_tipoout='T'
'pmcParametri.w_tipoout='C'
]
h=[
19
19
19
19
19
]
obj='If
pag=1
prev=O1854
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1855
fatherSonIndex=0
frm_calc='2
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1855
fatherSonIndex=1
frm_calc='4
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1855
fatherSonIndex=2
frm_calc='3
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1855
fatherSonIndex=3
frm_calc='5
obj='Exec
pag=1
I
I
]
w=[
150
150
150
150
150
]
I
obj='Var
pag=1
prev=O1853
var_op='asgn
I
obj='Var
pag=1
prev=O1852
var_op='asgn
I
obj='Var
obj_type='D
pag=1
prev=O1851
var_op='asgn
I
obj='Var
obj_type='D
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1830
fatherSonIndex=1
frm_calc='pmcParametri.w_dadata
len=8
name='_dadata
next=Icpitembatch.CPVarDecl
frm_calc='arfn_finemese(_dadata)
len=8
name='_a_data
next=Icpitembatch.CPIfElse
frm_calc=[
'_dadata < pmcParametri.w_adata and _a_data > pmcParametri.w_adata
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(_dadata)
len=8
name='_cfromdate
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(_a_data)
len=8
name='_c_todate
next=Icpitembatch.CPWhile
frm_calc='_a_data <= pmcParametri.w_adata
h=[
19
19
]
obj='While
pag=1
prev=O1875
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1876
fatherSonIndex=0
frm_calc=[
'pmcParametri.w_tipoout='E'
'pmcParametri.w_tipoout='D' or pmcParametri.w_tipoout='Z'
'pmcParametri.w_tipoout='T'
'pmcParametri.w_tipoout='C'
]
h=[
19
19
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='arfn_datesum(_a_data,1)
len=8
name='_dadata
next=Icpitembatch.CPVarDecl
frm_calc='arfn_finemese(_dadata)
len=8
name='_a_data
next=Icpitembatch.CPIfElse
frm_calc=[
'_dadata < pmcParametri.w_adata and _a_data > pmcParametri.w_adata
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(_dadata)
len=8
name='_cfromdate
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(_a_data)
len=8
name='_c_todate
obj='Var
pag=1
prev=O1888
var_op='asgn
I
obj='Var
pag=1
prev=O1885
var_op='asgn
I
obj='If
pag=1
prev=O1884
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1885
fatherSonIndex=0
frm_calc='pmcParametri.w_adata
len=8
name='_a_data
obj='Var
obj_type='D
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='D
pag=1
prev=O1883
var_op='asgn
I
obj='Var
obj_type='D
pag=1
prev=O1880
var_op='asgn
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1880
fatherSonIndex=0
frm_calc='2
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1880
fatherSonIndex=1
frm_calc='4
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1880
fatherSonIndex=2
frm_calc='3
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1880
fatherSonIndex=3
frm_calc='5
obj='Exec
pag=1
I
I
]
w=[
150
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O1874
var_op='asgn
I
obj='Var
pag=1
prev=O1871
var_op='asgn
I
obj='If
pag=1
prev=O1870
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1871
fatherSonIndex=0
frm_calc='pmcParametri.w_adata
len=8
name='_a_data
obj='Var
obj_type='D
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='D
pag=1
prev=O1869
var_op='asgn
I
obj='Var
obj_type='D
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1825
fatherSonIndex=1
frm_calc='rollback
next=Icpitembatch.CPIfElse
frm_calc=[
'pmcParametri.pTipo='B'
]
h=[
19
19
]
obj='If
pag=1
prev=O1911
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O1912
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('./processi/EXT'+prcProg)
next=Icpitembatch.CPWrite
arch='processi
obj='Write
pag=1
prev=O1917
rd_kfield=[
'PR_TIPO
'PRCODICE
]
rd_kop=[
'=
'=
]
rd_kvar=[
''EXT'
'prcProg
]
wr_field=[
'PRDOSTOP
'PRESITO
'PRGMSGSTA
]
wr_op=[
'=
'=
'=
]
wr_var=[
'DateTime()
''N'
''Estrazione Abortita'
]
I
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Transaction
pag=1
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=1
prev=O1823
I
obj='TempTable
pag=1
prev=O1822
sel_type='def
server_table='tmp_newpers
I
obj='DropTempTable
pag=1
prev=O1821
server_table='tmp_newpers
I
obj='TempTable
pag=1
prev=O1820
sel_type='def
server_table='tmp_mtcn_cf
I
obj='DropTempTable
pag=1
prev=O1819
server_table='tmp_mtcn_cf
I
obj='Var
pag=1
prev=O1818
var_op='asgn
I
obj='Var
pag=1
prev=O1815
var_op='asgn
I
obj='If
pag=1
prev=O1812
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1815
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=1
par_expr=[
'pmcParametri.w_cdadata
'pmcParametri.w_c_adata
'pmcParametri.w_cDIP
'pmcParametri.w_cCODFISC
'pmcParametri.w_cMTCN
'pmcParametri.w_codmag
'_mstato
'pmcParametri.w_lststa
'pmcParametri.w_lstprv
'pmcParametri.w_connes
'_importo
]
par_name=[
'w_cdadata
'w_c_adata
'w_cDIP
'w_cCODFISC
'w_cMTCN
'w_codmag
'_mstato
'_lststati
'_lstprov
'w_connes
'_importo
]
sel_name='qbe_estrai_ope_lim
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1929
fatherSonIndex=0
frm_calc='_totalone + qbe_estrai_ope_lim->totope
len=10
name='_totalone
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O1811
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1812
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=1
par_expr=[
'pmcParametri.w_cdadata
'pmcParametri.w_c_adata
'pmcParametri.w_cDIP
'pmcParametri.w_cCODFISC
'pmcParametri.w_cMTCN
'pmcParametri.w_codmag
'_mstato
'pmcParametri.w_lststa
'pmcParametri.w_lstprv
'pmcParametri.w_connes
'_importo
]
par_name=[
'w_cdadata
'w_c_adata
'w_cDIP
'w_cCODFISC
'w_cMTCN
'w_codmag
'_mstato
'_lststati
'_lstprov
'w_connes
'_importo
]
sel_name='qbe_estrai_frz_lim
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1940
fatherSonIndex=0
frm_calc='_totalone + qbe_estrai_frz_lim->totfrz
len=10
name='_totalone
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=1
prev=O1810
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O1809
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O1806
var_op='asgn
I
obj='If
pag=1
prev=O1803
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1806
fatherSonIndex=0
frm_calc='"'0','1'"
len=15
name='_mstato
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O1802
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O1803
fatherSonIndex=0
frm_calc='Utilities.SetCompany(_gAzienda)
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPROC\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='prcProg
next=Icpitembatch.CPCase
frm_calc=[
'pmcParametri.w_tipoout='E'
'pmcParametri.w_tipoout='T'
'pmcParametri.w_tipoout='D'
'pmcParametri.w_tipoout='Z'
'pmcParametri.w_tipoout='C'
]
h=[
19
19
19
19
19
19
]
next=Icpitembatch.CPInsert
arch='processi
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Elaborazione lanciata. Consultare la schermata dei processi per verificare lo stato di avanzamento'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=1
prev=O1960
var_op='asgn
I
obj='Insert
pag=1
prev=O1957
rd_kfield=[
'PR_TIPO
'PRCODICE
'PRDESCRI
'PRDOSTART
'PRESITO
'PTRIPOOUT
]
rd_kvar=[
''EXT'
'prcProg
''Estrazione Movimenti '+LRTrim(cOutput)
'DateTime()
''L'
'pmcParametri.w_tipoout
]
I
obj='Case
pag=1
prev=O1956
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1957
fatherSonIndex=0
frm_calc=''su file Excel'
len=30
name='cOutput
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1957
fatherSonIndex=1
frm_calc=''su file Testo'
len=30
name='cOutput
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1957
fatherSonIndex=2
frm_calc=''su tabella in accodamento'
len=30
name='cOutput
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1957
fatherSonIndex=3
frm_calc=''su tabella con azzeramento'
len=30
name='cOutput
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1957
fatherSonIndex=4
frm_calc=''su file CSV'
len=30
name='cOutput
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
150
150
150
]
I
obj='Var
pag=1
prev=O1955
var_op='asgn
I
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O1801
var_op='asgn
I
obj='Var
pag=1
prev=O1800
var_op='asgn
I
obj='Var
pag=1
prev=O1799
var_op='asgn
I
obj='Var
pag=1
prev=O1798
var_op='asgn
I
obj='Var
pag=1
prev=O1797
var_op='asgn
I
obj='Var
pag=1
prev=O1796
var_op='asgn
I
obj='Var
obj_type='MC
pag=1
prev=O1794
var_op='meth
I
obj='Begin
pag=1
prev=O1792
sons=[
Icpitembatch.CPItemSon
instr=Ispitembatch.CPMemoryCursor
data_source='tbcauana
father=O1794
fatherSonIndex=0
key_expression='tbcauana->CODCAU+tbcauana->CAUSINT
mem_curs_name='mcTBCAUANA
next=Ispitembatch.CPMemoryCursor
data_source='tbcausin
key_expression='tbcausin->CODVOC
mem_curs_name='mcTBCAUSIN
next=Ispitembatch.CPMemoryCursor
data_source='tbstati
key_expression='tbstati->CODSTA
mem_curs_name='mcTBSTATI
next=Ispitembatch.CPMemoryCursor
data_source='tbtipdoc
key_expression='tbtipdoc->TIPDOC
mem_curs_name='mcTBTIPDOC
next=Ispitembatch.CPMemoryCursor
data_source='tbtipreg
key_expression='tbtipreg->CODICE
mem_curs_name='mcTBTIPREG
obj='MemoryCursor
pag=1
prev=O1982
sel_field='*
sel_name='tbtipreg
sel_type='fltb
I
obj='MemoryCursor
pag=1
prev=O1981
sel_field='*
sel_name='tbtipdoc
sel_type='fltb
I
obj='MemoryCursor
pag=1
prev=O1980
sel_field='*
sel_name='tbstati
sel_type='fltb
I
obj='MemoryCursor
pag=1
prev=O1979
sel_field='*
sel_name='tbcausin
sel_type='fltb
I
obj='MemoryCursor
pag=1
sel_field='*
sel_name='tbcauana
sel_type='fltb
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O1790
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
comment='mc Parametri
father=O1792
fatherSonIndex=0
frm_seek='AppendBlank
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='pTipo
frm_seek='pTipo
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='w_dadata
frm_seek='w_dadata
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='w_adata
frm_seek='w_adata
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='w_cdadata
frm_seek='w_cdadata
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='w_c_adata
frm_seek='w_c_adata
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='w_cDIP
frm_seek='w_cDIP
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='w_xdesdip
frm_seek='w_xdesdip
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='w_ragosc
frm_seek='w_ragosc
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='w_citnas
frm_seek='w_citnas
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='w_stanas
frm_seek='w_stanas
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='w_datnas
frm_seek='w_datnas
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='w_cMTCN
frm_seek='w_cMTCN
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='w_cCODFISC
frm_seek='w_cCODFISC
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='w_ragben
frm_seek='w_ragben
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='w_staben
frm_seek='w_staben
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='w_codmag
frm_seek='w_codmag
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='w_connes
frm_seek='w_connes
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='w_nomefile
frm_seek='w_nomefile
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='w_tipofile
frm_seek='w_tipofile
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='w_flgsto
frm_seek='w_flgsto
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='w_tipoout
frm_seek='w_tipoout
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='w_opesel
frm_seek='w_opesel
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='w_frzsel
frm_seek='w_frzsel
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='w_attive
frm_seek='w_attive
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='w_destfold
frm_seek='w_destfold
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='pMese
frm_seek='w_flgmese
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='pNCF
frm_seek='w_flgncf
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='pSegno
frm_seek='w_flgsegno
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='pLstSta
frm_seek='w_lststa
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='pLstPrv
frm_seek='w_lstprv
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_calc='pImporto
frm_seek='w_importo
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='mc Parametri
frm_seek='SaveRow
name='pmcParametri
obj='Var
obj_type='MC
pag=1
prev=O2018
var_op='meth
I
obj='Var
obj_type='MC
pag=1
prev=O2017
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O2016
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O2015
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O2014
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O2013
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O2012
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O2011
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O2010
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O2009
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O2008
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O2007
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O2006
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O2005
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O2004
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O2003
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O2002
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O2001
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O2000
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O1999
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O1998
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O1997
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O1996
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O1995
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O1994
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O1993
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O1992
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O1991
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O1990
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O1989
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O1988
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O1987
var_op='prop
I
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O1788
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1790
fatherSonIndex=0
frm_seek='tbstati
name='mcTBSTATI
next=Icpitembatch.CPVarDecl
frm_seek='tbcauana
name='mcTBCAUANA
next=Icpitembatch.CPVarDecl
frm_seek='tbcausin
name='mcTBCAUSIN
next=Icpitembatch.CPVarDecl
frm_seek='tbtipdoc
name='mcTBTIPDOC
next=Icpitembatch.CPVarDecl
frm_seek='tbtipreg
name='mcTBTIPREG
obj='Var
obj_type='MC
pag=1
prev=O2026
I
obj='Var
obj_type='MC
pag=1
prev=O2025
I
obj='Var
obj_type='MC
pag=1
prev=O2024
I
obj='Var
obj_type='MC
pag=1
prev=O2023
I
obj='Var
obj_type='MC
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O1786
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='mc Parametri
father=O1788
fatherSonIndex=0
frm_seek='mcParametri.MCRDef
name='pmcParametri
next=Icpitembatch.CPVarDecl
comment='Path Applicazione
len=80
name='_gPathApp
next=Icpitembatch.CPVarDecl
comment='Azienda
len=10
name='_gAzienda
next=Icpitembatch.CPVarDecl
len=10
name='fhand
next=Icpitembatch.CPVarDecl
len=100
name='filenome
next=Icpitembatch.CPVarDecl
len=10
name='righe
next=Icpitembatch.CPVarDecl
len=100
name='cell01
next=Icpitembatch.CPVarDecl
len=25
name='column01
next=Icpitembatch.CPVarDecl
len=9
name='cell_count
next=Icpitembatch.CPVarDecl
comment='riga letta del file Excel
len=9
name='riga_letta
next=Icpitembatch.CPVarDecl
len=10
name='_file
next=Icpitembatch.CPVarDecl
len=8
name='_dadata
next=Icpitembatch.CPVarDecl
len=8
name='_a_data
next=Icpitembatch.CPVarDecl
len=1
name='prova
next=Icpitembatch.CPVarDecl
len=1
name='foglio
next=Icpitembatch.CPVarDecl
len=50
name='_nfile
next=Icpitembatch.CPVarDecl
len=1
name='stringa
next=Icpitembatch.CPVarDecl
len=1
name='numero
next=Icpitembatch.CPVarDecl
len=1
name='dData
next=Icpitembatch.CPVarDecl
len=14
name='dataoggi
next=Icpitembatch.CPVarDecl
len=11
name='numprog
next=Icpitembatch.CPVarDecl
len=8
name='datareg
next=Icpitembatch.CPVarDecl
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
len=8
name='dataope
next=Icpitembatch.CPVarDecl
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
len=10
name='f_datope
next=Icpitembatch.CPVarDecl
len=10
name='f_datnas
next=Icpitembatch.CPVarDecl
len=10
name='f_datreg
next=Icpitembatch.CPVarDecl
len=2
name='tipope
next=Icpitembatch.CPVarDecl
len=4
name='cauana
next=Icpitembatch.CPVarDecl
len=4
name='causin
next=Icpitembatch.CPVarDecl
len=1
name='segno
next=Icpitembatch.CPVarDecl
len=6
name='valuta
next=Icpitembatch.CPVarDecl
len=30
name='divisa
next=Icpitembatch.CPVarDecl
dec=10
len=15
name='cambio
next=Icpitembatch.CPVarDecl
dec=2
len=15
name='totimp
next=Icpitembatch.CPVarDecl
dec=2
len=15
name='totcon
next=Icpitembatch.CPVarDecl
len=16
name='codfisc
next=Icpitembatch.CPVarDecl
len=70
name='nominativo
next=Icpitembatch.CPVarDecl
len=35
name='indirizzo
next=Icpitembatch.CPVarDecl
len=40
name='citres
next=Icpitembatch.CPVarDecl
len=5
name='capres
next=Icpitembatch.CPVarDecl
len=2
name='prvres
next=Icpitembatch.CPVarDecl
len=40
name='stares
next=Icpitembatch.CPVarDecl
len=40
name='citnas
next=Icpitembatch.CPVarDecl
len=2
name='prvnas
next=Icpitembatch.CPVarDecl
len=40
name='stanas
next=Icpitembatch.CPVarDecl
len=40
name='sesso
next=Icpitembatch.CPVarDecl
len=8
name='datnas
next=Icpitembatch.CPVarDecl
len=8
name='_datnas
next=Icpitembatch.CPVarDecl
len=2
name='tipdoc
next=Icpitembatch.CPVarDecl
len=30
name='autril
next=Icpitembatch.CPVarDecl
len=15
name='numdoc
next=Icpitembatch.CPVarDecl
len=8
name='datril
next=Icpitembatch.CPVarDecl
len=8
name='_datril
next=Icpitembatch.CPVarDecl
len=50
name='_testa
next=Icpitembatch.CPVarDecl
len=50
name='_agetesta
next=Icpitembatch.CPVarDecl
len=10
name='_sqr
next=Icpitembatch.CPVarDecl
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
len=40
name='_namdip
next=Icpitembatch.CPVarDecl
len=40
name='_citdip
next=Icpitembatch.CPVarDecl
len=30
name='_nomman
next=Icpitembatch.CPVarDecl
len=30
name='_cogman
next=Icpitembatch.CPVarDecl
len=30
name='_nazben
next=Icpitembatch.CPVarDecl
len=40
name='_luonas
next=Icpitembatch.CPVarDecl
len=20
name='_tipdoc
next=Icpitembatch.CPVarDecl
len=20
name='_numdoc
next=Icpitembatch.CPVarDecl
len=10
name='f_datdoc
next=Icpitembatch.CPVarDecl
len=30
name='_autril
next=Icpitembatch.CPVarDecl
len=11
name='_numprog
next=Icpitembatch.CPVarDecl
len=10
name='_mtcn
next=Icpitembatch.CPVarDecl
len=5
name='_macage
next=Icpitembatch.CPVarDecl
len=1
name='_stator
next=Icpitembatch.CPVarDecl
len=25
name='_rapporto
next=Icpitembatch.CPVarDecl
len=10
name='riga
next=Icpitembatch.CPVarDecl
len=16
name='_ndg
next=Icpitembatch.CPVarDecl
len=2
name='_cfestero
next=Icpitembatch.CPVarDecl
len=15
name='_numsto
next=Icpitembatch.CPVarDecl
len=10
name='_ctot
next=Icpitembatch.CPVarDecl
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
len=8
name='_datadoc
next=Icpitembatch.CPVarDecl
len=15
name='_max
next=Icpitembatch.CPVarDecl
len=15
name='_min
next=Icpitembatch.CPVarDecl
len=15
name='_tot
next=Icpitembatch.CPVarDecl
len=1
name='_mono
next=Icpitembatch.CPVarDecl
len=15
name='_cicli
next=Icpitembatch.CPVarDecl
len=15
name='_contacicli
next=Icpitembatch.CPVarDecl
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
len=15
name='_top
next=Icpitembatch.CPVarDecl
len=15
name='_mstato
next=Icpitembatch.CPVarDecl
len=28
name='_rifimp
next=Icpitembatch.CPVarDecl
len=30
name='_rifimp2
next=Icpitembatch.CPVarDecl
len=50
name='_connesdoc
next=Icpitembatch.CPVarDecl
len=8
name='_datarett
next=Icpitembatch.CPVarDecl
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
len=165
name='_dcauana
next=Icpitembatch.CPVarDecl
len=165
name='_dcausin
next=Icpitembatch.CPVarDecl
len=30
name='_dpaeseres
next=Icpitembatch.CPVarDecl
len=30
name='_dpaesedes
next=Icpitembatch.CPVarDecl
len=90
name='_dtipoope
next=Icpitembatch.CPVarDecl
len=30
name='_dstator
next=Icpitembatch.CPVarDecl
len=10
name='prcProg
next=Icpitembatch.CPVarDecl
len=30
name='cOutput
next=Icpitembatch.CPVarDecl
len=3
name='_codstar
next=Icpitembatch.CPVarDecl
len=10
name='_totgen
next=Icpitembatch.CPVarDecl
len=10
name='fmhand
next=Icpitembatch.CPVarDecl
len=128
name='_file1
next=Icpitembatch.CPVarDecl
len=80
name='_file2
next=Icpitembatch.CPVarDecl
len=10
name='_totalone
next=Icpitembatch.CPVarDecl
len=1
name='_orgdati
next=Icpitembatch.CPVarDecl
len=11
name='_codinter
next=Icpitembatch.CPVarDecl
frm_seek='anadip
name='mcANADIP
next=Icpitembatch.CPVarDecl
frm_seek='anadip
name='rowANADIP
next=Icpitembatch.CPVarDecl
len=2
name='_prvdip
next=Icpitembatch.CPVarDecl
len=6
name='_cabdip
next=Icpitembatch.CPVarDecl
len=40
name='_inddip
next=Icpitembatch.CPVarDecl
len=8
name='_cfromdate
next=Icpitembatch.CPVarDecl
len=8
name='_c_todate
next=Icpitembatch.CPVarDecl
comment='Nome file
len=60
name='_nomefile
next=Icpitembatch.CPVarDecl
len=70
name='_ragsoc
next=Icpitembatch.CPVarDecl
len=15
name='_importo
next=Icpitembatch.CPVarDecl
len=10
name='_ajwcode
obj='Var
pag=1
prev=O2152
I
obj='Var
obj_type='N
pag=1
prev=O2151
I
obj='Var
pag=1
prev=O2150
I
obj='Var
pag=1
prev=O2149
I
obj='Var
pag=1
prev=O2148
I
obj='Var
pag=1
prev=O2147
I
obj='Var
pag=1
prev=O2146
I
obj='Var
pag=1
prev=O2145
I
obj='Var
pag=1
prev=O2144
I
obj='Var
obj_type='R
pag=1
prev=O2143
I
obj='Var
obj_type='MC
pag=1
prev=O2142
I
obj='Var
pag=1
prev=O2141
I
obj='Var
pag=1
prev=O2140
I
obj='Var
obj_type='N
pag=1
prev=O2139
I
obj='Var
pag=1
prev=O2138
I
obj='Var
pag=1
prev=O2137
I
obj='Var
pag=1
prev=O2136
I
obj='Var
obj_type='N
pag=1
prev=O2135
I
obj='Var
pag=1
prev=O2134
I
obj='Var
pag=1
prev=O2133
I
obj='Var
pag=1
prev=O2132
I
obj='Var
pag=1
prev=O2131
I
obj='Var
pag=1
prev=O2130
I
obj='Var
pag=1
prev=O2129
I
obj='Var
pag=1
prev=O2128
I
obj='Var
pag=1
prev=O2127
I
obj='Var
pag=1
prev=O2126
I
obj='Var
obj_type='D
pag=1
prev=O2125
I
obj='Var
obj_type='D
pag=1
prev=O2124
I
obj='Var
pag=1
prev=O2123
I
obj='Var
pag=1
prev=O2122
I
obj='Var
pag=1
prev=O2121
I
obj='Var
pag=1
prev=O2120
I
obj='Var
obj_type='N
pag=1
prev=O2119
I
obj='Var
obj_type='N
pag=1
prev=O2118
I
obj='Var
obj_type='N
pag=1
prev=O2117
I
obj='Var
obj_type='N
pag=1
prev=O2116
I
obj='Var
obj_type='N
pag=1
prev=O2115
I
obj='Var
obj_type='N
pag=1
prev=O2114
I
obj='Var
obj_type='N
pag=1
prev=O2113
I
obj='Var
obj_type='N
pag=1
prev=O2112
I
obj='Var
obj_type='D
pag=1
prev=O2111
I
obj='Var
pag=1
prev=O2110
I
obj='Var
pag=1
prev=O2109
I
obj='Var
obj_type='N
pag=1
prev=O2108
I
obj='Var
pag=1
prev=O2107
I
obj='Var
pag=1
prev=O2106
I
obj='Var
pag=1
prev=O2105
I
obj='Var
obj_type='N
pag=1
prev=O2104
I
obj='Var
pag=1
prev=O2103
I
obj='Var
pag=1
prev=O2102
I
obj='Var
pag=1
prev=O2101
I
obj='Var
pag=1
prev=O2100
I
obj='Var
pag=1
prev=O2099
I
obj='Var
pag=1
prev=O2098
I
obj='Var
pag=1
prev=O2097
I
obj='Var
pag=1
prev=O2096
I
obj='Var
pag=1
prev=O2095
I
obj='Var
pag=1
prev=O2094
I
obj='Var
pag=1
prev=O2093
I
obj='Var
pag=1
prev=O2092
I
obj='Var
pag=1
prev=O2091
I
obj='Var
pag=1
prev=O2090
I
obj='Var
pag=1
prev=O2089
I
obj='Var
pag=1
prev=O2088
I
obj='Var
pag=1
prev=O2087
I
obj='Var
pag=1
prev=O2086
I
obj='Var
pag=1
prev=O2085
I
obj='Var
obj_type='D
pag=1
prev=O2084
I
obj='Var
pag=1
prev=O2083
I
obj='Var
pag=1
prev=O2082
I
obj='Var
pag=1
prev=O2081
I
obj='Var
pag=1
prev=O2080
I
obj='Var
obj_type='D
pag=1
prev=O2079
I
obj='Var
pag=1
prev=O2078
I
obj='Var
pag=1
prev=O2077
I
obj='Var
pag=1
prev=O2076
I
obj='Var
pag=1
prev=O2075
I
obj='Var
pag=1
prev=O2074
I
obj='Var
pag=1
prev=O2073
I
obj='Var
pag=1
prev=O2072
I
obj='Var
pag=1
prev=O2071
I
obj='Var
pag=1
prev=O2070
I
obj='Var
pag=1
prev=O2069
I
obj='Var
pag=1
prev=O2068
I
obj='Var
pag=1
prev=O2067
I
obj='Var
obj_type='N
pag=1
prev=O2066
I
obj='Var
obj_type='N
pag=1
prev=O2065
I
obj='Var
obj_type='N
pag=1
prev=O2064
I
obj='Var
pag=1
prev=O2063
I
obj='Var
pag=1
prev=O2062
I
obj='Var
pag=1
prev=O2061
I
obj='Var
pag=1
prev=O2060
I
obj='Var
pag=1
prev=O2059
I
obj='Var
pag=1
prev=O2058
I
obj='Var
pag=1
prev=O2057
I
obj='Var
pag=1
prev=O2056
I
obj='Var
pag=1
prev=O2055
I
obj='Var
obj_type='D
pag=1
prev=O2054
I
obj='Var
pag=1
prev=O2053
I
obj='Var
obj_type='D
pag=1
prev=O2052
I
obj='Var
pag=1
prev=O2051
I
obj='Var
pag=1
prev=O2050
I
obj='Var
pag=1
prev=O2049
I
obj='Var
pag=1
prev=O2048
I
obj='Var
pag=1
prev=O2047
I
obj='Var
pag=1
prev=O2046
I
obj='Var
pag=1
prev=O2045
I
obj='Var
pag=1
prev=O2044
I
obj='Var
pag=1
prev=O2043
I
obj='Var
obj_type='D
pag=1
prev=O2042
I
obj='Var
obj_type='D
pag=1
prev=O2041
I
obj='Var
obj_type='M
pag=1
prev=O2040
I
obj='Var
obj_type='N
pag=1
prev=O2039
I
obj='Var
obj_type='N
pag=1
prev=O2038
I
obj='Var
pag=1
prev=O2037
I
obj='Var
pag=1
prev=O2036
I
obj='Var
obj_type='N
pag=1
prev=O2035
I
obj='Var
pag=1
prev=O2034
I
obj='Var
pag=1
prev=O2033
I
obj='Var
pag=1
prev=O2032
I
obj='Var
pag=1
prev=O2031
I
obj='Var
obj_type='MC
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O1784
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O1786
fatherSonIndex=0
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='NomeFile
global=True
len=80
name='gFileName
next=Icpitembatch.CPVarDecl
comment='Gestione WU
global=True
len=1
name='gFlgWU
next=Icpitembatch.CPVarDecl
comment='URL Applicazione
global=True
len=80
name='gUrlApp
nonlocal=True
obj='Var
pag=1
prev=O2159
I
nonlocal=True
obj='Var
pag=1
prev=O2158
I
nonlocal=True
obj='Var
pag=1
prev=O2157
I
nonlocal=True
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
comment='Tipo
father=O1784
fatherSonIndex=0
len=1
name='pTipo
next=Icpitembatch.CPVarDecl
comment='Data Inizio
len=8
name='w_dadata
next=Icpitembatch.CPVarDecl
comment='Data Fine
len=8
name='w_adata
next=Icpitembatch.CPVarDecl
comment='Data Inizio Char
len=8
name='w_cdadata
next=Icpitembatch.CPVarDecl
comment='Data Fine Char
len=8
name='w_c_adata
next=Icpitembatch.CPVarDecl
comment='Agenzia
len=6
name='w_cDIP
next=Icpitembatch.CPVarDecl
comment='Descrizione
len=30
name='w_xdesdip
next=Icpitembatch.CPVarDecl
comment='Nominativo
len=60
name='w_ragosc
next=Icpitembatch.CPVarDecl
comment='Citta di nascita
len=40
name='w_citnas
next=Icpitembatch.CPVarDecl
comment='Stato di nascita
len=40
name='w_stanas
next=Icpitembatch.CPVarDecl
comment='Data di nascita
len=8
name='w_datnas
next=Icpitembatch.CPVarDecl
comment='MTCN Operazione
len=10
name='w_cMTCN
next=Icpitembatch.CPVarDecl
comment='Codice Fiscale
len=16
name='w_cCODFISC
next=Icpitembatch.CPVarDecl
comment='Nominativo
len=60
name='w_ragben
next=Icpitembatch.CPVarDecl
comment='Stato di nascita
len=40
name='w_staben
next=Icpitembatch.CPVarDecl
comment='MacroAgente
len=5
name='w_codmag
next=Icpitembatch.CPVarDecl
comment='MacroAgente
len=16
name='w_connes
next=Icpitembatch.CPVarDecl
comment='Nome File
len=60
name='w_nomefile
next=Icpitembatch.CPVarDecl
comment='Tipo Import
len=1
name='w_tipofile
next=Icpitembatch.CPVarDecl
comment='Dati Storici Soggetto
len=1
name='w_flgsto
next=Icpitembatch.CPVarDecl
comment='Tipo Output
len=1
name='w_tipoout
next=Icpitembatch.CPVarDecl
comment='Operazioni
len=1
name='w_opesel
next=Icpitembatch.CPVarDecl
comment='Frazionate
len=1
name='w_frzsel
next=Icpitembatch.CPVarDecl
comment='Solo movimenti Attivi
len=1
name='w_attive
next=Icpitembatch.CPVarDecl
comment='Cartella Destinazione
len=128
name='w_destfold
next=Icpitembatch.CPVarDecl
comment='Azienda Riferimento
len=10
name='pAzienda
next=Icpitembatch.CPVarDecl
comment='Path Applicazione
len=80
name='pPath
next=Icpitembatch.CPVarDecl
comment='Suddividi in un file per mese
len=1
name='pMese
next=Icpitembatch.CPVarDecl
comment='No CF Fittizi
len=1
name='pNCF
next=Icpitembatch.CPVarDecl
comment='Segno Operazioni
len=1
name='pSegno
next=Icpitembatch.CPVarDecl
comment='Stati Destinazione
len=128
name='pLstSta
next=Icpitembatch.CPVarDecl
comment='Provincie Agenzie
len=128
name='pLstPrv
next=Icpitembatch.CPVarDecl
comment='Importo minimo
dec=2
len=15
name='pImporto
obj='Var
obj_type='N
pag=1
param=True
prev=O2195
I
obj='Var
pag=1
param=True
prev=O2194
I
obj='Var
pag=1
param=True
prev=O2193
I
obj='Var
pag=1
param=True
prev=O2192
I
obj='Var
pag=1
param=True
prev=O2191
I
obj='Var
pag=1
param=True
prev=O2190
I
obj='Var
pag=1
param=True
prev=O2189
I
obj='Var
pag=1
param=True
prev=O2188
I
obj='Var
pag=1
param=True
prev=O2187
I
obj='Var
pag=1
param=True
prev=O2186
I
obj='Var
pag=1
param=True
prev=O2185
I
obj='Var
pag=1
param=True
prev=O2184
I
obj='Var
pag=1
param=True
prev=O2183
I
obj='Var
pag=1
param=True
prev=O2182
I
obj='Var
pag=1
param=True
prev=O2181
I
obj='Var
pag=1
param=True
prev=O2180
I
obj='Var
pag=1
param=True
prev=O2179
I
obj='Var
pag=1
param=True
prev=O2178
I
obj='Var
pag=1
param=True
prev=O2177
I
obj='Var
pag=1
param=True
prev=O2176
I
obj='Var
pag=1
param=True
prev=O2175
I
obj='Var
pag=1
param=True
prev=O2174
I
obj='Var
obj_type='D
pag=1
param=True
prev=O2173
I
obj='Var
pag=1
param=True
prev=O2172
I
obj='Var
pag=1
param=True
prev=O2171
I
obj='Var
pag=1
param=True
prev=O2170
I
obj='Var
pag=1
param=True
prev=O2169
I
obj='Var
pag=1
param=True
prev=O2168
I
obj='Var
pag=1
param=True
prev=O2167
I
obj='Var
pag=1
param=True
prev=O2166
I
obj='Var
obj_type='D
pag=1
param=True
prev=O2165
I
obj='Var
obj_type='D
pag=1
param=True
prev=O2164
I
obj='Var
pag=1
param=True
I
I
]
w=[
150
150
]
x=10
y=23
I
Icpitembatch.CPBeginEnd
comment='Crea la riga coi dati
h=[
19
19
]
obj='Begin
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O2198
fatherSonIndex=0
frm_calc='// Creazione della prima riga﷯campi[0]=_codinter;﷯campi[1]=_sqr;﷯campi[2]=_coddip;﷯campi[3]=_namdip;﷯campi[4]=_inddip;﷯campi[5]=_citdip;﷯campi[6]=_prvdip;﷯campi[7]=CPLib.LRTrim(CPLib.Str(totimp,12,2));﷯campi[8]=_ndg;﷯campi[9]=_cogman;﷯campi[10]=_nomman;﷯campi[11]=sesso;﷯campi[12]=stanas;﷯campi[13]=citnas;﷯campi[14]=prvnas;﷯campi[15]=f_datnas;﷯campi[16]=codfisc;﷯campi[17]=tipdoc+"-"+_tipdoc;﷯campi[18]=_numdoc;﷯campi[19]=f_datdoc;﷯campi[20]=_autril;﷯campi[21]=_codstar+"-"+stares;﷯campi[22]=citres;﷯campi[23]=prvres;﷯campi[24]=indirizzo;﷯campi[25]=tipope+"-"+_dtipoope;﷯campi[26]=cauana+"-"+_dcauana;﷯campi[27]=causin+"-"+_dcausin;﷯campi[28]=segno;﷯campi[29]=f_datope;﷯campi[30]=nominativo;﷯campi[31]=_nazben+"-"+CPLib.LRTrim(_dpaesedes);﷯campi[32]=_numprog;﷯campi[33]=_dstator;﷯campi[34]=_rapporto;﷯campi[35]=f_datreg;﷯campi[36]=_orgdati;
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgWU='S'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPExec
frm_calc='cwriter.writeNext(campi)
obj='Exec
pag=12
prev=O2203
I
obj='If
pag=12
prev=O2202
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2203
fatherSonIndex=0
frm_calc=[
'pmcParametri.w_flgncf='N'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O2209
fatherSonIndex=0
frm_calc='// CAmpi WU﷯campi[37]=_cfestero;﷯campi[38]=_mtcn;﷯campi[39]=_macage;﷯campi[40]=_ajwcode;
obj='Exec
pag=12
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O2209
fatherSonIndex=1
frm_calc='// CAmpi WU﷯campi[37]=_mtcn;﷯campi[38]=_macage;﷯campi[39]=_ajwcode;
obj='Exec
pag=12
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2203
fatherSonIndex=1
frm_calc=[
'pmcParametri.w_flgncf='N'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O2219
fatherSonIndex=0
frm_calc='// Campi No WU﷯campi[37]=_cfestero;﷯campi[38]=_rifimp;﷯campi[39]=_rifimp2;
obj='Exec
pag=12
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O2219
fatherSonIndex=1
frm_calc='// Campi No WU﷯campi[37]=_rifimp;﷯campi[38]=_rifimp2;
obj='Exec
pag=12
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=12
I
I
]
w=[
150
150
]
x=15
y=21
I
Icpitembatch.CPBeginEnd
comment='Scrive la riga
h=[
19
19
]
obj='Begin
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O2230
fatherSonIndex=0
frm_calc='//Creo il record da scrivere﷯row = sheet.createRow(r);﷯cell = row.createCell(0);﷯cell.setCellValue(CPLib.LRTrim(_codinter));﷯cell = row.createCell(1);﷯cell.setCellValue(CPLib.LRTrim(_sqr));﷯cell = row.createCell(2);﷯cell.setCellValue(CPLib.LRTrim(_coddip));﷯cell = row.createCell(3);﷯cell.setCellValue(CPLib.LRTrim(_namdip));﷯cell = row.createCell(4);﷯cell.setCellValue(CPLib.LRTrim(_inddip));﷯cell = row.createCell(5);﷯cell.setCellValue(CPLib.LRTrim(_citdip));﷯cell = row.createCell(6);﷯cell.setCellValue(CPLib.LRTrim(_prvdip));﷯cell = row.createCell(7);﷯cell.setCellValue(totimp);﷯cell = row.createCell(8);﷯cell.setCellValue(CPLib.LRTrim(_ndg));﷯cell = row.createCell(9);﷯cell.setCellValue(CPLib.LRTrim(_cogman));﷯cell = row.createCell(10);﷯cell.setCellValue(CPLib.LRTrim(_nomman));﷯cell = row.createCell(11);﷯cell.setCellValue(CPLib.LRTrim(sesso));﷯cell = row.createCell(12);﷯cell.setCellValue(CPLib.LRTrim(stanas));﷯cell = row.createCell(13);﷯cell.setCellValue(CPLib.LRTrim(citnas));﷯cell = row.createCell(14);﷯cell.setCellValue(CPLib.LRTrim(prvnas));﷯cell = row.createCell(15);﷯cell.setCellValue(CPLib.LRTrim(f_datnas));﷯cell = row.createCell(16);﷯cell.setCellValue(CPLib.LRTrim(codfisc));﷯cell = row.createCell(17);﷯cell.setCellValue(CPLib.LRTrim(tipdoc)+"-"+CPLib.LRTrim(_tipdoc));﷯cell = row.createCell(18);﷯cell.setCellValue(CPLib.LRTrim(_numdoc));﷯cell = row.createCell(19);﷯cell.setCellValue(CPLib.LRTrim(f_datdoc));﷯cell = row.createCell(20);﷯cell.setCellValue(CPLib.LRTrim(_autril));﷯cell = row.createCell(21);﷯cell.setCellValue(CPLib.LRTrim(_codstar)+"-"+CPLib.LRTrim(stares));﷯cell = row.createCell(22);﷯cell.setCellValue(CPLib.LRTrim(citres));﷯cell = row.createCell(23);﷯cell.setCellValue(CPLib.LRTrim(prvres));﷯cell = row.createCell(24);﷯cell.setCellValue(CPLib.LRTrim(indirizzo));﷯cell = row.createCell(25);﷯cell.setCellValue(CPLib.LRTrim(tipope)+"-"+CPLib.LRTrim(_dtipoope));﷯cell = row.createCell(26);﷯cell.setCellValue(CPLib.LRTrim(cauana)+"-"+CPLib.LRTrim(_dcauana));﷯cell = row.createCell(27);﷯cell.setCellValue(CPLib.LRTrim(causin)+"-"+CPLib.LRTrim(_dcausin));﷯cell = row.createCell(28);﷯cell.setCellValue(CPLib.LRTrim(segno));﷯cell = row.createCell(29);﷯cell.setCellValue(CPLib.LRTrim(f_datope));﷯cell = row.createCell(30);﷯cell.setCellValue(CPLib.LRTrim(nominativo));﷯cell = row.createCell(31);﷯cell.setCellValue(CPLib.LRTrim(_nazben)+"-"+CPLib.LRTrim(_dpaesedes));﷯cell = row.createCell(32);﷯cell.setCellValue(CPLib.LRTrim(_numprog));﷯cell = row.createCell(33);﷯cell.setCellValue(CPLib.LRTrim(_stator)+"-"+CPLib.LRTrim(_dstator));﷯cell = row.createCell(34);﷯cell.setCellValue(CPLib.LRTrim(_rapporto));﷯cell = row.createCell(35);﷯cell.setCellValue(CPLib.LRTrim(f_datreg));﷯cell = row.createCell(36);﷯cell.setCellValue(_orgdati);
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgWU='S'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPExec
check='man
frm_calc='// Contatore Righe﷯r++;
obj='Exec
pag=10
prev=O2235
I
obj='If
pag=10
prev=O2234
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2235
fatherSonIndex=0
frm_calc=[
'pmcParametri.w_flgncf='N'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O2241
fatherSonIndex=0
frm_calc='// Scrive MTCN e MacroAgente per WU﷯cell = row.createCell(37);﷯cell.setCellValue(CPLib.LRTrim(_cfestero));﷯cell = row.createCell(38);﷯cell.setCellValue(CPLib.LRTrim(_mtcn));﷯cell = row.createCell(39);﷯cell.setCellValue(CPLib.LRTrim(_macage));﷯cell = row.createCell(40);﷯cell.setCellValue(CPLib.LRTrim(_ajwcode));
obj='Exec
pag=10
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O2241
fatherSonIndex=1
frm_calc='// Scrive MTCN e MacroAgente per WU﷯cell = row.createCell(37);﷯cell.setCellValue(CPLib.LRTrim(_mtcn));﷯cell = row.createCell(38);﷯cell.setCellValue(CPLib.LRTrim(_macage));﷯cell = row.createCell(39);﷯cell.setCellValue(CPLib.LRTrim(_ajwcode));
obj='Exec
pag=10
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2235
fatherSonIndex=1
frm_calc=[
'pmcParametri.w_flgncf='N'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O2251
fatherSonIndex=0
frm_calc='// Scrive riferimento per altri﷯cell = row.createCell(37);﷯cell.setCellValue(CPLib.LRTrim(_cfestero));﷯cell = row.createCell(38);﷯cell.setCellValue(CPLib.LRTrim(_rifimp));﷯cell = row.createCell(39);﷯cell.setCellValue(CPLib.LRTrim(_rifimp2));
obj='Exec
pag=10
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O2251
fatherSonIndex=1
frm_calc='// Scrive riferimento per altri﷯cell = row.createCell(37);﷯cell.setCellValue(CPLib.LRTrim(_rifimp));﷯cell = row.createCell(38);﷯cell.setCellValue(CPLib.LRTrim(_rifimp2));
obj='Exec
pag=10
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=10
I
I
]
w=[
150
150
]
x=14
y=22
I
]
ManualBlocks={
'BO - Header
Icpmanualblocks.CPManualBlocks
code='import java.util.*;﷯import java.io.InputStream;﷯import java.io.FileInputStream;﷯import java.io.FileOutputStream;﷯import java.util.Iterator;﷯import java.io.File;﷯import java.io.FileWriter;﷯import org.apache.poi.xssf.usermodel.XSSFCell;﷯import org.apache.poi.xssf.usermodel.XSSFRow;﷯import org.apache.poi.xssf.usermodel.XSSFSheet;﷯import org.apache.poi.xssf.usermodel.XSSFWorkbook;﷯import org.apache.poi.xssf.usermodel.XSSFCellStyle;﷯import org.apache.poi.xssf.streaming.SXSSFWorkbook;﷯import org.apache.poi.xssf.streaming.SXSSFSheet;﷯import org.apache.poi.ss.usermodel.*;﷯import org.apache.poi.xssf.streaming.SXSSFCell;﷯import org.apache.poi.xssf.streaming.SXSSFRow;﷯import org.apache.poi.xssf.streaming.SXSSFSheet;﷯import org.apache.poi.xssf.streaming.SXSSFWorkbook;﷯// import com.opencsv.CSVWriter;﷯import com.opencsv.CSVWriter;﷯import java.util.ArrayList;
name='BO - Header
I
'BO - Properties
Icpmanualblocks.CPManualBlocks
code='public int _i;﷯public int _y;﷯public int _righe;﷯public int conta;﷯public int r;﷯String sheetName = "Foglio1";﷯public String[] lista;﷯public String[] campi;﷯public int conteggio;﷯public int i;﷯public int contanome;﷯public int nfogli;﷯public int ncampi;﷯public SXSSFWorkbook wb;﷯public SXSSFSheet sheet;﷯public Row row; ﷯public Cell cell;﷯public CellStyle cs;﷯public Font f;﷯public CSVWriter cwriter;﷯Vector filenames = new Vector();﷯Vector fileonames = new Vector();
name='BO - Properties
I
}
comment='Estrazione operazioni/frazionate e produzione file excel
date_creat=#2011-05-10
date_rev=#2021-02-17
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'LibreriaMit
'FileLibMit
'Utilities
'FileLibMit
]
modcnt=366
page_result_class=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
page_result_type=[
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
]
page_uid=[
'CYNPGRYHBZ
'JKUDYBLEUT
'EAEPJATKCK
'KPVDJQNBRO
'JHYCAYPRDU
'ADCURFYFVN
'ARQBDTULOC
'OXGSLPFTXB
'OBUALUMCXL
'SUINZWWIFD
'ILMFYGSEQG
'ZPXKRDWMSS
'WKRUVIENML
'ZXPLIVVYFN
'MMTDEXBTBG
]
pagename=[
'Page_1
'Page_2
'Page_3
'Page_4
'Page_5
'Page_6
'Page_7
'Page_8
'Page_9
'Page_10
'Page_11
'Page_12
'Page_13
'Page_14
'Page_15
]
pagenote=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
pagetitle=[
'Main
'Excel
'Txt
'DB
'CSV
'Lettura Dati
'Legge il file XLSX
'Lettura per SOG
'Lettura per MTCN
'Riga Excel
'Riga TXT
'Riga CSV
'Estrazione Dati Anagrafici
'Crea il file zip
'Crea il file delle dipendenze
]
public=True
runtime_filters=2
tpl_name='Routine
work_file=[
'docfrabo
'dw_operazioni
'intermbo
'kersonbo
'personbo
'processi
'tbcauana
'tbcausin
'tbstati
'tbtipdoc
'tbtipreg
'tmp_mtcn_cf
'tmp_newpers
'wersonbo
]
work_filter=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
I
*--*
*----*
