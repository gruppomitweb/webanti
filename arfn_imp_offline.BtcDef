* --- CodePainter Revolution Batch Vers. 5.2
￼Icpbatch.CPBatch
Items=[
Icpitembatch.CPBeginEnd
comment='Definizione variabili caller
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili Locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='variabili locali per decoprimere il file
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Memory Cursor
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili globali
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Import Scarico OffLine
next=Icpitembatch.CPVarDecl
frm_calc='''
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'At('.zip',Lower(w_nomefile)) <> 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPBeginEnd
comment='Verifica charset del file e lo apre
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Cicla sul file della lista e lancia la pagina appropriata
next=Icpitembatch.CPBeginEnd
comment='azzera le variabili
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Azzeramento Tabelle import e archivi
h=[
19
19
]
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibrary.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibrary.DeleteFile("appo/"+LRTrim(gAzienda)+"/"+LRTrim(filenome))
obj='Exec
pag=1
prev=O28
I
obj='Exec
pag=1
prev=O26
I
obj='Try
pag=1
prev=O25
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Import Dati
father=O26
fatherSonIndex=0
h=[
19
19
]
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O32
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + filenome + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPWhile
frm_calc='not(FileLibrary.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Scorre la tabella tipo 1
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Messaggi finali
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione dati. Inizio fase di commit. Attendere prego...'
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPTransaction
frm_calc='commit
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Soggetti: '+LRTrim(Str(cNumSog,10,0)) + ' - Informazioni: '+LRTrim(Str(cNumInf,10,0)) + ' - Operazioni: '+LRTrim(Str(cNumOpe,10,0))+ ' - Titolari: '+LRTrim(Str(cNumTit,10,0)) + ' dal file '+filenome+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +filenome+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Importazione dati terminata.'
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O45
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O44
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O43
var_op='asgn
I
obj='Transaction
pag=1
prev=O42
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O41
var_op='asgn
I
obj='Remark
pag=1
prev=O39
I
obj='Begin
pag=1
prev=O37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O39
fatherSonIndex=0
for_variable='rwTipo0
for_variable_type='tipo1
h=[
19
19
]
iterator_expr='mcTipo0
obj='ForEach
orderby_expr='A51
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='identificativo di registrazione A03
father=O49
fatherSonIndex=0
frm_calc='rwTipo0.A03
len=20
name='_A03
next=Icpitembatch.CPVarDecl
frm_calc='rwTipo0.A52
len=2
name='_A52
next=Icpitembatch.CPVarDecl
frm_calc='rwTipo0.A54A
len=1
name='_A54A
next=Icpitembatch.CPExec
check='page
frm_calc='14
next=Ispitembatch.CPMemoryCursor
data_source='tipo1
mem_curs_name='mcTipo1
next=Ispitembatch.CPMemoryCursor
data_source='tipo2_3
mem_curs_name='mcTipo2
next=Ispitembatch.CPMemoryCursor
data_source='tipo4
mem_curs_name='mcTipo4
next=Ispitembatch.CPMemoryCursor
data_source='tipo5
mem_curs_name='mcTipo5
next=Ispitembatch.CPMemoryCursor
data_source='tipo6
mem_curs_name='mcTipo6
next=Ispitembatch.CPMemoryCursor
data_source='tipo7
mem_curs_name='mcTipo7
next=Ispitembatch.CPMemoryCursor
data_source='tipo8
mem_curs_name='mcTipo8
next=Ispitembatch.CPMemoryCursor
data_source='tipo9
mem_curs_name='mcTipo9
next=Icpitembatch.CPCase
frm_calc=[
'Left(rwTipo0.A52,1)="1"
'Left(rwTipo0.A52,1)="5"
]
h=[
19
19
19
19
]
haselse=True
obj='Case
pag=1
prev=O64
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O65
fatherSonIndex=0
frm_calc='"Elaborazione dell'operazione con codice: "+_A03
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc=''O'
name='_tipreg
next=Icpitembatch.CPExec
check='page
frm_calc='4
obj='Exec
pag=1
prev=O71
I
obj='Var
pag=1
prev=O70
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O65
fatherSonIndex=1
frm_calc='"Elaborazione del legame con codice: "+_A03
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc=''T'
name='_tipreg
next=Icpitembatch.CPExec
check='page
frm_calc='6
obj='Exec
pag=1
prev=O75
I
obj='Var
pag=1
prev=O74
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O65
fatherSonIndex=2
frm_calc='"Elaborazione dell'informazione con codice: "+_A03
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc=''R'
name='_tipreg
next=Icpitembatch.CPExec
check='page
frm_calc='5
obj='Exec
pag=1
prev=O79
I
obj='Var
pag=1
prev=O78
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='MemoryCursor
pag=1
prev=O63
sel_field='*
sel_name='l_tipo9
sel_type='fltb
sel_where='l_tipo9->A03=_A03
I
obj='MemoryCursor
pag=1
prev=O62
sel_field='*
sel_name='l_tipo8
sel_type='fltb
sel_where='l_tipo8->A03=_A03
I
obj='MemoryCursor
pag=1
prev=O61
sel_field='*
sel_name='l_tipo7
sel_type='fltb
sel_where='l_tipo7->A03=_A03
I
obj='MemoryCursor
pag=1
prev=O60
sel_field='*
sel_name='l_tipo6
sel_type='fltb
sel_where='l_tipo6->A03=_A03
I
obj='MemoryCursor
pag=1
prev=O59
sel_field='*
sel_name='l_tipo5
sel_type='fltb
sel_where='l_tipo5->A03=_A03
I
obj='MemoryCursor
pag=1
prev=O58
sel_field='*
sel_name='l_tipo4
sel_type='fltb
sel_where='l_tipo4->A03=_A03
I
obj='MemoryCursor
pag=1
prev=O57
sel_field='*
sel_name='l_tipo23
sel_type='fltb
sel_where='l_tipo23->A03=_A03
I
obj='MemoryCursor
pag=1
prev=O56
sel_field='*
sel_name='l_tipo1
sel_type='fltb
sel_where='l_tipo1->A03=_A03
I
obj='Exec
pag=1
prev=O55
I
obj='Var
pag=1
prev=O54
var_op='asgn
I
obj='Var
pag=1
prev=O53
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='While
pag=1
prev=O36
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O37
fatherSonIndex=0
frm_calc='FileLibrary.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O87
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O88
fatherSonIndex=0
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file '+ filenome
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPRemark
frm_calc='Verifico il tipo di riga
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,14,1)
len=1
name='xTipo
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,15,20)
len=20
name='_A03
next=Icpitembatch.CPCase
frm_calc=[
'xTipo='1'
'xTipo='2' or xTipo='3'
'xTipo='4'
'xTipo='5'
'xTipo='6'
'xTipo='7'
'xTipo='8'
'xTipo='9'
]
h=[
19
19
19
19
19
19
19
19
19
]
obj='Case
pag=1
prev=O96
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O97
fatherSonIndex=0
frm_calc='Substr(riga,248,1)
len=1
name='xStato
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,234,1)='1'
'Substr(riga,234,1)='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='conta1 + 1 
len=10
name='conta1
next=Icpitembatch.CPInsert
arch='l_tipo1
next=Icpitembatch.CPVarDecl
frm_seek='AppendBlank
name='mcTipo0
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,2)
frm_seek='A01A
name='mcTipo0
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,3,11)
frm_seek='A01B
name='mcTipo0
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,14,1)
frm_seek='A02
name='mcTipo0
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,15,20)
frm_seek='A03
name='mcTipo0
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Substr(riga,226,8))
frm_seek='A51
name='mcTipo0
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,234,2)
frm_seek='A52
name='mcTipo0
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,248,1)
frm_seek='A54A
name='mcTipo0
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcTipo0
obj='Var
obj_type='MC
pag=1
prev=O115
var_op='meth
I
obj='Var
obj_type='MC
pag=1
prev=O114
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O113
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O112
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O111
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O110
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O109
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O108
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O107
var_op='meth
I
obj='Insert
pag=1
prev=O106
rd_kfield=[
'A01A
'A01B
'A02
'A03
'A11
'A12A
'A12B
'A12C
'A21
'A22
'A23
'A24
'A25
'A31A
'A31B
'A32
'A33A
'A33B
'A33C
'A34
'A41
'A42
'A43
'A51
'A52
'A53
'A54A
'A54B
'A54C
'B11
'B12
'B13
'B14
'B15
'PROG
'TMOV
'PRGANTI
'FONTE
'A52L
]
rd_kvar=[
'Substr(riga,1,2)
'Substr(riga,3,11)
'Substr(riga,14,1)
'Substr(riga,15,20)
'Substr(riga,35,6)
'Substr(riga,41,6)
'Substr(riga,47,30)
'Substr(riga,77,2)
'CharToDate(Substr(riga,79,8))
'Substr(riga,87,1)
'Substr(riga,88,1)
'Substr(riga,89,4)
'Substr(riga,93,2)
'Substr(riga,95,2)
'Substr(riga,97,11)
'Substr(riga,108,3)
'Substr(riga,111,6)
'Substr(riga,117,30)
'Substr(riga,147,2)
'Substr(riga,149,50)
'Substr(riga,199,25)
'Substr(riga,224,1)
'Substr(riga,225,1)
'CharToDate(Substr(riga,226,8))
'Substr(riga,234,2)
'Substr(riga,236,12)
'Substr(riga,248,1)
'CharToDate(Substr(riga,249,8))
'Substr(riga,257,20)
'Substr(riga,277,1)
'Substr(riga,278,3)
'Substr(riga,281,1)
'Val(Substr(riga,282,15))
'Val(Substr(riga,297,15))
'conta1
'iif(LRTrim(Substr(riga,371,10))='AGENZIA','A','D')
'Substr(riga,360,11)
'Substr(riga,359,1)
'Substr(riga,234,1)
]
I
obj='Var
obj_type='N
pag=1
prev=O103
var_op='asgn
I
obj='Case
pag=1
prev=O102
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Operazioni
father=O103
fatherSonIndex=0
frm_calc='cNumOpe + 1
len=10
name='cNumOpe
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
father=O103
fatherSonIndex=1
frm_calc='cNumTit + 1
len=10
name='cNumTit
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
father=O103
fatherSonIndex=2
frm_calc='cNumInf + 1
len=10
name='cNumInf
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
father=O97
fatherSonIndex=1
frm_calc='cNumSog + 1
len=15
name='cNumSog
next=Icpitembatch.CPVarDecl
frm_calc='conta2 + 1 
len=10
name='conta2
next=Icpitembatch.CPInsert
arch='l_tipo23
obj='Insert
pag=1
prev=O129
rd_kfield=[
'A01A
'A01B
'A02
'A03
'C11
'D11
'D13
'D14A
'D14B
'D14C
'D15
'D16
'D17
'D18
'D19
'D21
'D22
'D23
'D31
'D32
'D41
'D42
'D43
'D44
'D45
'PROG
'CFESTERO
'DATAVALI
]
rd_kvar=[
'Substr(riga,1,2)
'Substr(riga,3,11)
'Substr(riga,14,1)
'Substr(riga,15,20)
'Substr(riga,35,16)
'Substr(riga,51,70)
'Substr(riga,121,3)
'Substr(riga,124,6)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'Substr(riga,202,16)
'CharToDate(Substr(riga,218,8))
'Substr(riga,226,30)
'Substr(riga,256,3)
'Substr(riga,259,3)
'Substr(riga,262,3)
'Substr(riga,265,25)
'Substr(riga,290,1)
'Substr(riga,291,2)
'Substr(riga,293,15)
'CharToDate(Substr(riga,308,8))
'Substr(riga,316,30)
'Substr(riga,346,1)
'conta2
'iif(Substr(riga,377,4)='NOCF',1,0)
'iif(Empty(LRTrim(Substr(riga,369,8))),NullDate(),CharToDate(Substr(riga,369,8)))
]
I
obj='Var
obj_type='N
pag=1
prev=O128
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
father=O97
fatherSonIndex=2
frm_calc='cNumSog + 1
len=15
name='cNumSog
next=Icpitembatch.CPVarDecl
frm_calc='conta4 + 1 
len=10
name='conta4
next=Icpitembatch.CPInsert
arch='l_tipo4
obj='Insert
pag=1
prev=O135
rd_kfield=[
'A01A
'A01B
'A02
'A03
'C21
'E11
'E13
'E14A
'E14B
'E14C
'E15
'E16
'E17
'E18
'E19
'E41
'E42
'E43
'E44
'E45
'PROG
'CFESTERO
'DATAVALI
]
rd_kvar=[
'Substr(riga,1,2)
'Substr(riga,3,11)
'Substr(riga,14,1)
'Substr(riga,15,20)
'Substr(riga,35,16)
'Substr(riga,51,70)
'Substr(riga,121,3)
'Substr(riga,124,6)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'Substr(riga,202,16)
'CharToDate(Substr(riga,218,8))
'Substr(riga,226,30)
'Substr(riga,291,2)
'Substr(riga,293,15)
'CharToDate(Substr(riga,308,8))
'Substr(riga,316,30)
'Substr(riga,346,1)
'conta4
'iif(Substr(riga,377,4)='NOCF',1,0)
'iif(Empty(LRTrim(Substr(riga,369,8))),NullDate(),CharToDate(Substr(riga,369,8)))
]
I
obj='Var
obj_type='N
pag=1
prev=O134
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
father=O97
fatherSonIndex=3
frm_calc='cNumSog + 1
len=15
name='cNumSog
next=Icpitembatch.CPVarDecl
frm_calc='conta5 + 1 
len=10
name='conta5
next=Icpitembatch.CPInsert
arch='l_tipo5
obj='Insert
pag=1
prev=O141
rd_kfield=[
'A01A
'A01B
'A02
'A03
'C31
'F11
'F13
'F14A
'F14B
'F14C
'F15
'F16
'F31
'PROG
'CFESTERO
'DATAVALI
]
rd_kvar=[
'Substr(riga,1,2)
'Substr(riga,3,11)
'Substr(riga,14,1)
'Substr(riga,15,20)
'Substr(riga,35,16)
'Substr(riga,51,70)
'Substr(riga,121,3)
'Substr(riga,124,6)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'Substr(riga,265,25)
'conta5
'iif(Substr(riga,377,4)='NOCF',1,0)
'iif(Empty(LRTrim(Substr(riga,369,8))),NullDate(),CharToDate(Substr(riga,369,8)))
]
I
obj='Var
obj_type='N
pag=1
prev=O140
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
father=O97
fatherSonIndex=4
frm_calc='cNumSog + 1
len=15
name='cNumSog
next=Icpitembatch.CPVarDecl
frm_calc='conta6 + 1 
len=10
name='conta6
next=Icpitembatch.CPInsert
arch='l_tipo6
obj='Insert
pag=1
prev=O147
rd_kfield=[
'A01A
'A01B
'A02
'A03
'C41
'G11
'G13
'G14A
'G14B
'G14C
'G15
'G16
'G17
'G18
'G19
'G41
'G42
'G43
'G44
'G45
'PROG
'CFESTERO
'DATAVALI
]
rd_kvar=[
'Substr(riga,1,2)
'Substr(riga,3,11)
'Substr(riga,14,1)
'Substr(riga,15,20)
'Substr(riga,35,16)
'Substr(riga,51,70)
'Substr(riga,121,3)
'Substr(riga,124,6)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'Substr(riga,202,16)
'CharToDate(Substr(riga,218,8))
'Substr(riga,226,30)
'Substr(riga,291,2)
'Substr(riga,293,15)
'CharToDate(Substr(riga,308,8))
'Substr(riga,316,30)
'Substr(riga,346,1)
'conta6
'iif(Substr(riga,377,4)='NOCF',1,0)
'iif(Empty(LRTrim(Substr(riga,369,8))),NullDate(),CharToDate(Substr(riga,369,8)))
]
I
obj='Var
obj_type='N
pag=1
prev=O146
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
father=O97
fatherSonIndex=5
frm_calc='cNumSog + 1
len=15
name='cNumSog
next=Icpitembatch.CPVarDecl
frm_calc='conta7 + 1 
len=10
name='conta7
next=Icpitembatch.CPInsert
arch='l_tipo7
obj='Insert
pag=1
prev=O153
rd_kfield=[
'A01A
'A01B
'A02
'A03
'C11
'D11
'D13
'D14A
'D14B
'D14C
'D15
'D16
'D17
'D18
'D19
'D21
'D22
'D23
'D31
'D32
'D41
'D42
'D43
'D44
'D45
'PROG
'CFESTERO
'DATAVALI
]
rd_kvar=[
'Substr(riga,1,2)
'Substr(riga,3,11)
'Substr(riga,14,1)
'Substr(riga,15,20)
'Substr(riga,35,16)
'Substr(riga,51,70)
'Substr(riga,121,3)
'Substr(riga,124,6)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'Substr(riga,202,16)
'CharToDate(Substr(riga,218,8))
'Substr(riga,226,30)
'Substr(riga,256,3)
'Substr(riga,259,3)
'Substr(riga,262,3)
'Substr(riga,265,25)
'Substr(riga,290,1)
'Substr(riga,291,2)
'Substr(riga,293,15)
'CharToDate(Substr(riga,308,8))
'Substr(riga,316,30)
'Substr(riga,346,1)
'conta7
'iif(Substr(riga,377,4)='NOCF',1,0)
'iif(Empty(LRTrim(Substr(riga,369,8))),NullDate(),CharToDate(Substr(riga,369,8)))
]
I
obj='Var
obj_type='N
pag=1
prev=O152
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
father=O97
fatherSonIndex=6
frm_calc='cNumSog + 1
len=15
name='cNumSog
next=Icpitembatch.CPVarDecl
frm_calc='conta8 + 1 
len=10
name='conta8
next=Icpitembatch.CPInsert
arch='l_tipo8
obj='Insert
pag=1
prev=O159
rd_kfield=[
'A01A
'A01B
'A02
'A03
'C21
'E11
'E13
'E14A
'E14B
'E14C
'E15
'E16
'E17
'E18
'E19
'E41
'E42
'E43
'E44
'E45
'PROG
'CFESTERO
'DATAVALI
]
rd_kvar=[
'Substr(riga,1,2)
'Substr(riga,3,11)
'Substr(riga,14,1)
'Substr(riga,15,20)
'Substr(riga,35,16)
'Substr(riga,51,70)
'Substr(riga,121,3)
'Substr(riga,124,6)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'Substr(riga,202,16)
'CharToDate(Substr(riga,218,8))
'Substr(riga,226,30)
'Substr(riga,291,2)
'Substr(riga,293,15)
'CharToDate(Substr(riga,308,8))
'Substr(riga,316,30)
'Substr(riga,346,1)
'conta8
'iif(Substr(riga,377,4)='NOCF',1,0)
'iif(Empty(LRTrim(Substr(riga,369,8))),NullDate(),CharToDate(Substr(riga,369,8)))
]
I
obj='Var
obj_type='N
pag=1
prev=O158
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
father=O97
fatherSonIndex=7
frm_calc='cNumSog + 1
len=15
name='cNumSog
next=Icpitembatch.CPVarDecl
frm_calc='conta9 + 1 
len=10
name='conta9
next=Icpitembatch.CPInsert
arch='l_tipo9
obj='Insert
pag=1
prev=O165
rd_kfield=[
'A01A
'A01B
'A02
'A03
'C51
'H11
'H13
'H14A
'H14B
'H14C
'H15
'H16
'H17
'H18
'H19
'H41
'H42
'H43
'H44
'H45
'PROG
'CFESTERO
'DATAVALI
]
rd_kvar=[
'Substr(riga,1,2)
'Substr(riga,3,11)
'Substr(riga,14,1)
'Substr(riga,15,20)
'Substr(riga,35,16)
'Substr(riga,51,70)
'Substr(riga,121,3)
'Substr(riga,124,6)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'Substr(riga,202,16)
'CharToDate(Substr(riga,218,8))
'Substr(riga,226,30)
'Substr(riga,291,2)
'Substr(riga,293,15)
'CharToDate(Substr(riga,308,8))
'Substr(riga,316,30)
'Substr(riga,346,1)
'conta9
'iif(Substr(riga,377,4)='NOCF',1,0)
'iif(Empty(LRTrim(Substr(riga,369,8))),NullDate(),CharToDate(Substr(riga,369,8)))
]
I
obj='Var
obj_type='N
pag=1
prev=O164
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
150
150
150
150
150
150
]
I
obj='Var
pag=1
prev=O95
var_op='asgn
I
obj='Var
pag=1
prev=O94
var_op='asgn
I
obj='Remark
pag=1
prev=O93
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O86
var_op='asgn
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O26
fatherSonIndex=1
frm_calc='gMsgProc + "Rilevati errori nell'impotazione dei file! Ricreare il file segnalato e rieseguire l'import dei dati. La procedura annullera automaticamente l'importazione" + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Anomalia in fase d'inserimento su tipo informazione: "+ xTipo + NL+'con A03:'+ _A03 + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Anomalia in fase d'inserimento su tipo informazione: "+ xTipo +' con A03:' + _A03
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Errore SQL: ' + m_Sql.TransactionErrorMessage() + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='rollback
obj='Transaction
pag=1
prev=O177
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O176
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
prev=O175
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O174
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=1
prev=O23
I
obj='Begin
pag=1
prev=O21
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Azzeramento archivi se richiesto
father=O23
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Azzeramento tabelle import
h=[
19
19
]
obj='Begin
pag=1
prev=O182
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O184
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Azzeramento archivi appoggio: '+ arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Attendere. Azzeramento Archivi ...'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWhile
frm_calc='tblnum<10
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Azzeramento archivi appoggio: '+ arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O190
var_op='asgn
I
obj='While
pag=1
prev=O189
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nome tabella
father=O190
fatherSonIndex=0
frm_calc=''l_tipo'+Str(tblnum,1,0)+iif(tblnum<>2,'','3')
len=9
name='tblname_main
next=Icpitembatch.CPExec
check='page
frm_calc='Page_3(tblname_main)
next=Icpitembatch.CPVarDecl
comment='numero progressivo tabella
frm_calc='tblnum+iif(tblnum<>2,1,2)
len=2
name='tblnum
obj='Var
obj_type='N
pag=1
pagelocal=True
prev=O196
var_op='asgn
I
obj='Exec
pag=1
prev=O195
I
obj='Var
pag=1
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=1
prev=O188
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O182
fatherSonIndex=0
frm_calc=[
'w_azzera = 'S'
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='xoginfo
father=O202
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='xogopefbo
next=Icpitembatch.CPDelete
arch='xogopebo
next=Icpitembatch.CPDelete
arch='xiduciabo
next=Icpitembatch.CPDelete
arch='xoginfo
next=Icpitembatch.CPDelete
arch='xarantbo
next=Icpitembatch.CPDelete
arch='xelegabo
next=Icpitembatch.CPDelete
arch='xntestbo
next=Icpitembatch.CPDelete
arch='xapopebo
next=Icpitembatch.CPDelete
arch='xnarapbo
next=Icpitembatch.CPDelete
arch='xperazbo
next=Icpitembatch.CPDelete
arch='xntestit
next=Icpitembatch.CPDelete
arch='xapotit
next=Icpitembatch.CPDelete
arch='soginfo
next=Icpitembatch.CPDelete
arch='sogopebo
next=Icpitembatch.CPDelete
arch='sogopefbo
next=Icpitembatch.CPDelete
arch='intestit
next=Icpitembatch.CPDelete
arch='rapotit
next=Icpitembatch.CPDelete
arch='fiduciabo
next=Icpitembatch.CPDelete
arch='soginfo
next=Icpitembatch.CPDelete
arch='garantbo
next=Icpitembatch.CPDelete
arch='delegabo
next=Icpitembatch.CPDelete
arch='intestbo
next=Icpitembatch.CPDelete
arch='rapopebo
next=Icpitembatch.CPDelete
arch='anarapbo
next=Icpitembatch.CPDelete
arch='clientiope
next=Icpitembatch.CPDelete
arch='beneficope
next=Icpitembatch.CPDelete
arch='terzistiope
next=Icpitembatch.CPDelete
arch='operazbo
next=Icpitembatch.CPDelete
arch='personbo_agg
next=Icpitembatch.CPDelete
arch='personbo
next=Icpitembatch.CPDelete
arch='wersonbo
next=Icpitembatch.CPDelete
arch='cpwarn
obj='Delete
pag=1
prev=O238
rd_kfield=[
'warncode
]
rd_kop=[
'=
]
rd_kvar=[
'gAzienda
]
I
obj='Delete
pag=1
prev=O237
sel_type='all
I
obj='Delete
pag=1
prev=O236
sel_type='all
I
obj='Delete
pag=1
prev=O235
sel_type='all
I
obj='Delete
pag=1
prev=O234
sel_type='all
I
obj='Delete
pag=1
prev=O233
sel_type='all
I
obj='Delete
pag=1
prev=O232
sel_type='all
I
obj='Delete
pag=1
prev=O231
sel_type='all
I
obj='Delete
pag=1
prev=O230
sel_type='all
I
obj='Delete
pag=1
prev=O229
sel_type='all
I
obj='Delete
pag=1
prev=O228
sel_type='all
I
obj='Delete
pag=1
prev=O227
sel_type='all
I
obj='Delete
pag=1
prev=O226
sel_type='all
I
obj='Delete
pag=1
prev=O225
sel_type='all
I
obj='Delete
pag=1
prev=O224
sel_type='all
I
obj='Delete
pag=1
prev=O223
sel_type='all
I
obj='Delete
pag=1
prev=O222
sel_type='all
I
obj='Delete
pag=1
prev=O221
sel_type='all
I
obj='Delete
pag=1
prev=O220
sel_type='all
I
obj='Delete
pag=1
prev=O219
sel_type='all
I
obj='Delete
pag=1
prev=O218
sel_type='all
I
obj='Delete
pag=1
prev=O217
sel_type='all
I
obj='Delete
pag=1
prev=O216
sel_type='all
I
obj='Delete
pag=1
prev=O215
sel_type='all
I
obj='Delete
pag=1
prev=O214
sel_type='all
I
obj='Delete
pag=1
prev=O213
sel_type='all
I
obj='Delete
pag=1
prev=O212
sel_type='all
I
obj='Delete
pag=1
prev=O211
sel_type='all
I
obj='Delete
pag=1
prev=O210
sel_type='all
I
obj='Delete
pag=1
prev=O209
sel_type='all
I
obj='Delete
pag=1
prev=O208
sel_type='all
I
obj='Delete
pag=1
prev=O207
sel_type='all
I
obj='Delete
pag=1
sel_type='all
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O20
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Operazioni
father=O21
fatherSonIndex=0
frm_calc='0
len=10
name='cNumOpe
next=Icpitembatch.CPVarDecl
comment='Contatore Rapporti
frm_calc='0
len=10
name='cNumRap
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='0
len=10
name='cNumPer
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='0
len=10
name='cNumInf
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='0
len=10
name='cNumTit
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='0
len=15
name='cNumSog
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='0
len=15
name='cStoPer
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta1
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta2
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta4
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta5
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta6
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta7
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta8
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta9
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
obj='Var
obj_type='N
pag=1
prev=O262
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O261
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O260
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O259
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O258
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O257
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O256
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O255
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O254
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O253
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O252
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O251
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O250
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O249
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O248
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=1
prev=O18
I
obj='Begin
pag=1
prev=O15
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O18
fatherSonIndex=0
frm_calc='LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+"/"+LRTrim(filenome)
name='_fileinput
next=Icpitembatch.CPVarDecl
comment='ritorno del Charset
frm_seek='CharsetMit
name='objCharset
next=Icpitembatch.CPVarDecl
frm_calc='objCharset.detectCharsetString(_fileinput)
name='charset
next=Icpitembatch.CPVarDecl
frm_calc='FileLibrary.OpenRead("appo/"+LRTrim(gAzienda)+"/"+LRTrim(filenome),charset)
len=1
name='fhand
obj='Var
pag=1
prev=O269
var_op='asgn
I
obj='Var
pag=1
prev=O268
var_op='asgn
I
obj='Var
obj_type='O
pag=1
pagelocal=True
prev=O267
var_op='new
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O15
fatherSonIndex=0
frm_calc='2
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O15
fatherSonIndex=1
frm_calc='LRTrim(w_nomefile)
len=100
name='filenome
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O13
var_op='asgn
I
obj='Remark
pag=1
prev=O11
I
obj='Begin
pag=1
prev=O9
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
comment='Path Applicazione
father=O11
fatherSonIndex=0
global=True
len=80
name='gPathApp
next=Icpitembatch.CPVarDecl
comment='Path Documenti
global=True
len=128
name='gPathDoc
next=Icpitembatch.CPVarDecl
comment='Azienda
global=True
len=10
name='gAzienda
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O283
I
nonlocal=True
obj='Var
pag=1
prev=O282
I
nonlocal=True
obj='Var
pag=1
prev=O281
I
nonlocal=True
obj='Var
pag=1
prev=O280
I
nonlocal=True
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O7
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O9
fatherSonIndex=0
frm_seek='tipo1
name='mcTipo0
next=Icpitembatch.CPVarDecl
frm_seek='tipo1
name='mcTipo1
next=Icpitembatch.CPVarDecl
frm_seek='tipo2_3
name='mcTipo2
next=Icpitembatch.CPVarDecl
frm_seek='tipo4
name='mcTipo4
next=Icpitembatch.CPVarDecl
frm_seek='tipo5
name='mcTipo5
next=Icpitembatch.CPVarDecl
frm_seek='tipo6
name='mcTipo6
next=Icpitembatch.CPVarDecl
frm_seek='tipo7
name='mcTipo7
next=Icpitembatch.CPVarDecl
frm_seek='tipo8
name='mcTipo8
next=Icpitembatch.CPVarDecl
frm_seek='tipo9
name='mcTipo9
obj='Var
obj_type='MC
pag=1
prev=O295
I
obj='Var
obj_type='MC
pag=1
prev=O294
I
obj='Var
obj_type='MC
pag=1
prev=O293
I
obj='Var
obj_type='MC
pag=1
prev=O292
I
obj='Var
obj_type='MC
pag=1
prev=O291
I
obj='Var
obj_type='MC
pag=1
prev=O290
I
obj='Var
obj_type='MC
pag=1
prev=O289
I
obj='Var
obj_type='MC
pag=1
prev=O288
I
obj='Var
obj_type='MC
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O5
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O7
fatherSonIndex=0
len=100
name='czipfile
next=Icpitembatch.CPVarDecl
len=200
name='cpercorsozip
next=Icpitembatch.CPVarDecl
len=200
name='cdirectoryfile
next=Icpitembatch.CPVarDecl
name='_fileinput
next=Icpitembatch.CPVarDecl
frm_seek='CharsetMit
name='objCharset
next=Icpitembatch.CPVarDecl
name='charset
obj='Var
pag=1
prev=O304
I
obj='Var
obj_type='O
pag=1
pagelocal=True
prev=O303
I
obj='Var
pag=1
prev=O302
I
obj='Var
pag=1
prev=O301
I
obj='Var
pag=1
prev=O300
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5
fatherSonIndex=0
len=1
name='fhand
next=Icpitembatch.CPVarDecl
len=10
name='riga
next=Icpitembatch.CPVarDecl
comment='Contatore Operazioni
len=10
name='cNumOpe
next=Icpitembatch.CPVarDecl
comment='Contatore Rapporti
len=10
name='cNumRap
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
len=10
name='cNumPer
next=Icpitembatch.CPVarDecl
comment='Contatore Titolari
len=10
name='cNumTit
next=Icpitembatch.CPVarDecl
comment='Contatore Informazioni
len=10
name='cNumInf
next=Icpitembatch.CPVarDecl
comment='Contatore Informazioni
len=15
name='cNumSog
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
len=15
name='cStoPer
next=Icpitembatch.CPVarDecl
len=10
name='_conta
next=Icpitembatch.CPVarDecl
len=10
name='conta
next=Icpitembatch.CPVarDecl
len=1
name='xTipo
next=Icpitembatch.CPVarDecl
len=1
name='xOpe
next=Icpitembatch.CPVarDecl
len=1
name='xStato
next=Icpitembatch.CPVarDecl
len=100
name='filenome
next=Icpitembatch.CPVarDecl
len=10
name='conta1
next=Icpitembatch.CPVarDecl
len=10
name='conta2
next=Icpitembatch.CPVarDecl
len=10
name='conta4
next=Icpitembatch.CPVarDecl
len=10
name='conta5
next=Icpitembatch.CPVarDecl
len=10
name='conta6
next=Icpitembatch.CPVarDecl
len=10
name='conta7
next=Icpitembatch.CPVarDecl
len=10
name='conta8
next=Icpitembatch.CPVarDecl
len=10
name='conta9
next=Icpitembatch.CPVarDecl
comment='registra informazioni collegate
len=1
name='_registra
next=Icpitembatch.CPVarDecl
comment='identificativo di registrazione A03
len=20
name='_A03
next=Icpitembatch.CPVarDecl
comment='Tipo Operazione
len=2
name='_A52
next=Icpitembatch.CPVarDecl
len=1
name='_A54A
next=Icpitembatch.CPVarDecl
comment='numero progressivo tabella
frm_calc='1
len=2
name='tblnum
next=Icpitembatch.CPVarDecl
comment='nome tabella
frm_calc='''
len=9
name='tblname_main
next=Icpitembatch.CPVarDecl
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
len=6
name='xDIP
next=Icpitembatch.CPVarDecl
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
len=16
name='xCF
next=Icpitembatch.CPVarDecl
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
len=1
name='xSesso
next=Icpitembatch.CPVarDecl
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
len=2
name='_prvnas
next=Icpitembatch.CPVarDecl
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
len=2
name='xTD
next=Icpitembatch.CPVarDecl
name='_tipreg
next=Icpitembatch.CPVarDecl
name='_statoreg
next=Icpitembatch.CPVarDecl
len=16
name='xTitolare
next=Icpitembatch.CPVarDecl
len=1
name='xTipoInf
next=Icpitembatch.CPVarDecl
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
len=11
name='cInfTit
next=Icpitembatch.CPVarDecl
len=1
name='streg
next=Icpitembatch.CPVarDecl
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
len=1
name='cTipPer
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
len=16
name='xIDBx
next=Icpitembatch.CPVarDecl
len=25
name='xAppRap
next=Icpitembatch.CPVarDecl
len=25
name='xRapportox
next=Icpitembatch.CPVarDecl
len=15
name='nProgRap
next=Icpitembatch.CPVarDecl
len=1
name='cDelega
obj='Var
pag=1
prev=O371
I
obj='Var
obj_type='N
pag=1
prev=O370
I
obj='Var
pag=1
prev=O369
I
obj='Var
pag=1
prev=O368
I
obj='Var
pag=1
prev=O367
I
obj='Var
obj_type='N
pag=1
prev=O366
I
obj='Var
pag=1
prev=O365
I
obj='Var
pag=1
prev=O364
I
obj='Var
pag=1
prev=O363
I
obj='Var
pag=1
prev=O362
I
obj='Var
pag=1
prev=O361
I
obj='Var
pag=1
prev=O360
I
obj='Var
pag=1
prev=O359
I
obj='Var
pag=1
prev=O358
I
obj='Var
pag=1
prev=O357
I
obj='Var
pag=1
prev=O356
I
obj='Var
pag=1
prev=O355
I
obj='Var
pag=1
prev=O354
I
obj='Var
pag=1
prev=O353
I
obj='Var
pag=1
prev=O352
I
obj='Var
pag=1
prev=O351
I
obj='Var
pag=1
prev=O350
I
obj='Var
pag=1
prev=O349
I
obj='Var
pag=1
prev=O348
I
obj='Var
obj_type='N
pag=1
prev=O347
I
obj='Var
pag=1
prev=O346
I
obj='Var
pag=1
prev=O345
I
obj='Var
pag=1
prev=O344
I
obj='Var
pag=1
prev=O343
I
obj='Var
pag=1
prev=O342
I
obj='Var
pag=1
prev=O341
I
obj='Var
pag=1
prev=O340
I
obj='Var
obj_type='N
pag=1
prev=O339
I
obj='Var
obj_type='D
pag=1
prev=O338
I
obj='Var
obj_type='D
pag=1
prev=O337
I
obj='Var
pag=1
pagelocal=True
prev=O336
I
obj='Var
obj_type='N
pag=1
pagelocal=True
prev=O335
I
obj='Var
pag=1
prev=O334
I
obj='Var
pag=1
prev=O333
I
obj='Var
pag=1
prev=O332
I
obj='Var
obj_type='L
pag=1
prev=O331
I
obj='Var
obj_type='N
pag=1
prev=O330
I
obj='Var
obj_type='N
pag=1
prev=O329
I
obj='Var
obj_type='N
pag=1
prev=O328
I
obj='Var
obj_type='N
pag=1
prev=O327
I
obj='Var
obj_type='N
pag=1
prev=O326
I
obj='Var
obj_type='N
pag=1
prev=O325
I
obj='Var
obj_type='N
pag=1
prev=O324
I
obj='Var
obj_type='N
pag=1
prev=O323
I
obj='Var
pag=1
prev=O322
I
obj='Var
pag=1
prev=O321
I
obj='Var
pag=1
prev=O320
I
obj='Var
pag=1
prev=O319
I
obj='Var
obj_type='N
pag=1
prev=O318
I
obj='Var
obj_type='N
pag=1
prev=O317
I
obj='Var
obj_type='N
pag=1
prev=O316
I
obj='Var
obj_type='N
pag=1
prev=O315
I
obj='Var
obj_type='N
pag=1
prev=O314
I
obj='Var
obj_type='N
pag=1
prev=O313
I
obj='Var
obj_type='N
pag=1
prev=O312
I
obj='Var
obj_type='N
pag=1
prev=O311
I
obj='Var
obj_type='N
pag=1
prev=O310
I
obj='Var
obj_type='M
pag=1
prev=O309
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3
fatherSonIndex=0
len=100
name='w_nomefile
next=Icpitembatch.CPVarDecl
comment='Destinazione (Definitivo/Provvisorio)
len=1
name='w_tipodest
next=Icpitembatch.CPVarDecl
comment='Azzera archivi esistenti
len=1
name='w_azzera
next=Icpitembatch.CPVarDecl
comment='Importa solo anagrafiche
len=1
name='w_soloanag
obj='Var
pag=1
param=True
prev=O378
I
obj='Var
pag=1
param=True
prev=O377
I
obj='Var
pag=1
param=True
prev=O376
I
obj='Var
pag=1
param=True
I
I
]
w=[
150
150
]
x=14
y=17
I
Icpitembatch.CPVarDecl
frm_calc='LRTrim(w_nomefile)
len=100
name='czipfile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + czipfile + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Inizio estrazione del file '+ czipfile
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='FileLibrary.GetLocation()+"/appo/"+LRTrim(gAzienda)+"/"+czipfile
len=200
name='cpercorsozip
next=Icpitembatch.CPVarDecl
frm_calc='FileLibrary.GetLocation()+"/appo/"+LRTrim(gAzienda)+"/"
len=200
name='cdirectoryfile
next=Icpitembatch.CPExec
check='man
frm_calc='try {﷯      // Apro il file zip﷯      java.util.zip.ZipFile zf = new java.util.zip.ZipFile(cpercorsozip);﷯﷯      //Conto il numero di file all interno del file zip e creo un array di stringhe per memorizzare i nomi file﷯      conteggio=zf.size();﷯      lista=new String[conteggio];﷯      ﷯      // Enumerate each entry﷯      i=0;﷯      for (java.util.Enumeration entries = zf.entries(); entries.hasMoreElements();) {﷯          // Get the entry name﷯          lista[i] = ((java.util.zip.ZipEntry)entries.nextElement()).getName();﷯          i++;﷯      }﷯     zf.close();﷯     } catch (java.io.IOException e) {﷯     }﷯try {﷯      // Apro il file zip﷯      java.util.zip.ZipFile zf = new java.util.zip.ZipFile(cpercorsozip);﷯﷯      byte[] buffer = new byte[1024]; ﷯      java.util.Enumeration entries = zf.entries();﷯      while(entries.hasMoreElements() ) {﷯        java.util.zip.ZipEntry entry = (java.util.zip.ZipEntry)entries.nextElement();﷯﷯        System.err.println("Extracting file: " + entry.getName());﷯        java.io.InputStream in =zf.getInputStream(entry);﷯        java.io.OutputStream out = new java.io.BufferedOutputStream(new java.io.FileOutputStream(cdirectoryfile+entry.getName()));﷯﷯        int len;﷯﷯        while((len = in.read(buffer)) >= 0){﷯          out.write(buffer, 0, len);﷯        }﷯﷯          in.close();﷯          out.close();﷯      }﷯﷯      zf.close();﷯} catch (java.io.IOException ioe) {﷯      System.err.println("Unhandled exception:");﷯      ioe.printStackTrace();﷯      return;﷯}
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='contanome
next=Icpitembatch.CPWhile
frm_calc='contanome<conteggio
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibrary.DeleteFile('./appo/'+czipfile)
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine estrazione del file '+ czipfile
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +czipfile + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O391
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O390
var_op='asgn
I
obj='Exec
pag=2
prev=O388
I
obj='While
pag=2
prev=O387
sons=[
Icpitembatch.CPItemSon
comment='Assegnal apriorità ad ogni file e lo inserisce in tmp_list
instr=Icpitembatch.CPVarDecl
father=O388
fatherSonIndex=0
frm_calc='lista[contanome]
len=100
name='filenome
next=Icpitembatch.CPVarDecl
frm_calc='contanome+1
len=10
name='contanome
obj='Var
obj_type='N
pag=2
prev=O395
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O386
var_op='asgn
I
obj='Exec
pag=2
prev=O385
I
obj='Var
pag=2
prev=O384
var_op='asgn
I
obj='Var
pag=2
prev=O383
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O382
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O381
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
x=5
y=4
I
Icpitembatch.CPVarDecl
comment='nome tabella
len=9
name='tblname
next=Icpitembatch.CPExec
check='man
frm_calc=' // * ---truncate﷯        m_Sql.RequireTransaction();﷯        m_cServer = m_Ctx.GetServer(tblname);﷯        m_cPhName = m_Ctx.GetPhName(tblname);﷯        m_oWrInfo = CPPhTableWrInfo.GetCPPhTableWrInfo(m_Ctx,tblname,m_Ctx.GetCompany());﷯        m_oParameters = CPLib.GetParamsForSqlUpdate(m_cServer);﷯        m_cSql = CPLib.GetSQLPrefixComment("arfn_imp_offline",613,"0000003C")+"truncate "+m_oWrInfo.GetTableWriteName();﷯        m_nUpdatedRows = m_Sql.Update(m_cServer,m_cSql,m_oParameters);﷯        if (CPLib.lt(m_nUpdatedRows,0)) {﷯          m_Sql.AbortTransaction();﷯        }﷯        m_Sql.CompleteTransaction();﷯        m_cLastMsgError = m_Sql.TransactionErrorMessage();﷯        if (CPLib.ne(m_cLastMsgError,"")) {﷯          m_bError = true;﷯        }
obj='Exec
pag=3
prev=O398
I
obj='Var
pag=3
pageparam=True
x=7
y=10
I
Icpitembatch.CPBeginEnd
comment='Legge l'operazione e scrive i dati
h=[
19
19
]
obj='Begin
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O400
fatherSonIndex=0
frm_calc=[
'w_soloanag <> 'S'
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='page
frm_calc='7
next=Icpitembatch.CPExec
check='page
frm_calc='11
next=Icpitembatch.CPExec
check='page
frm_calc='8
next=Icpitembatch.CPExec
check='page
frm_calc='12
next=Icpitembatch.CPExec
check='page
frm_calc='9
next=Icpitembatch.CPExec
check='page
frm_calc='10
next=Icpitembatch.CPExec
check='page
frm_calc='13
obj='Exec
pag=4
prev=O412
I
obj='Exec
pag=4
prev=O411
I
obj='Exec
pag=4
prev=O410
I
obj='Exec
pag=4
prev=O409
I
obj='Exec
pag=4
prev=O408
I
obj='Exec
pag=4
prev=O407
I
obj='Exec
pag=4
prev=O404
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O404
fatherSonIndex=0
for_variable='rwTipo1
for_variable_type='tipo1
h=[
19
19
]
iterator_expr='mcTipo1
obj='ForEach
pag=4
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRemark
father=O416
fatherSonIndex=0
frm_calc='Importa i dati base delle operazioni
next=Icpitembatch.CPVarDecl
comment='Contatore Operazioni
frm_calc='cNumOpe + 1
len=10
name='cNumOpe
next=Icpitembatch.CPVarDecl
frm_calc='rwTipo1.A21
len=8
name='_dataope
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
prev=O422
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O423
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PPOPER1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(iif(rwTipo1.A41 <> '00000000000000000000000000',rwTipo1.A41,Space(25)))
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='iif(rwTipo1.A41 <> '00000000000000000000000000',rwTipo1.A42,Space(1))
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPRead
arch='tbcauana
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
frm_calc='rwTipo1.A11
len=6
name='xDIP
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xDIP)))
]
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xperazbo
h=[
19
19
]
obj='Insert
pag=4
prev=O437
rd_kfield=[
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'idcauana
'IDEREG
'NUMPROG
'OPERAZMOD
'OPRAP
'PAESE
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAPPORTO
'SEGNO
'STATOREG
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
]
rd_kvar=[
'DateToChar(rwTipo1.A21)
'DateToChar(rwTipo1.A21)
'DateToChar(rwTipo1.A51)
'rwTipo1.A24
'rwTipo1.A12A
'rwTipo1.A33A
'rwTipo1.A11
'rwTipo1.A31B
'rwTipo1.A01B
'rwTipo1.A25
'rwTipo1.A53
'rwTipo1.A21
'rwTipo1.A51
'rwTipo1.A54B
'rwTipo1.A33B
'rwTipo1.A12B
'rwTipo1.A34
'rwTipo1.A23
'rwTipo1.A22
'rwTipo1.B11
'xTipRap
'cOpeProg1
'cIdCau
'rwTipo1.A03
'cOpeProg2
'rwTipo1.A54C
'Substr(riga,234,1)
'rwTipo1.A32
'nProgImp
'rwTipo1.A33C
'rwTipo1.A12C
'LRTrim(xRapporto)
'rwTipo1.B13
'rwTipo1.A54A
''1'
'rwTipo1.A31A
'rwTipo1.A01A
'rwTipo1.A43
'rwTipo1.A52
'rwTipo1.B15
'rwTipo1.B14
'rwTipo1.B12
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O440
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+w_nomefile+" per l'operazione in data "+arfn_fdate(rwTipo1.A21)+" con importo "+Str(rwTipo1.B14/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL﷯
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=4
prev=O446
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='If
pag=4
prev=O436
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='anadip
father=O437
fatherSonIndex=0
obj='Merge
pag=4
rd_kfield=[
'CODDIP
]
rd_kop=[
'=
]
rd_kvar=[
'xDIP
]
wr_field=[
'CODDIP
'DESCRIZ
'CAB
'DESCCIT
'PROVINCIA
]
wr_mode=[
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
]
wr_var=[
'xDIP
'xDIP
'rwTipo1.A12A
'rwTipo1.A12B
'rwTipo1.A12C
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
prev=O435
var_op='asgn
I
obj='Var
pag=4
prev=O434
var_op='asgn
I
obj='Read
pag=4
prev=O433
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'rwTipo1.A24
'rwTipo1.A25
]
rd_var=[
'cIdCau
]
I
obj='Var
pag=4
prev=O432
var_op='asgn
I
obj='Var
pag=4
prev=O431
var_op='asgn
I
obj='Var
pag=4
prev=O430
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O429
var_op='asgn
I
obj='Var
pag=4
prev=O428
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O423
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPIfElse
frm_calc=[
'rwTipo1.A54A='0' or (At(rwTipo1.A54A,'|3|2') >0 and LRTrim(rwTipo1.A54C)='')
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(iif(rwTipo1.A41 <> '00000000000000000000000000',rwTipo1.A41,Space(25)))
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='iif(rwTipo1.A41 <> '00000000000000000000000000',rwTipo1.A42,Space(1))
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPRead
arch='tbcauana
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
frm_calc='rwTipo1.A11
len=6
name='xDIP
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xDIP)))
]
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='operazbo
h=[
19
19
]
obj='Insert
pag=4
prev=O476
rd_kfield=[
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'idcauana
'IDEREG
'NUMPROG
'OPERAZMOD
'OPRAP
'PAESE
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAPPORTO
'SEGNO
'STATOREG
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
]
rd_kvar=[
'DateToChar(rwTipo1.A21)
'DateToChar(rwTipo1.A21)
'DateToChar(rwTipo1.A51)
'rwTipo1.A24
'rwTipo1.A12A
'rwTipo1.A33A
'rwTipo1.A11
'rwTipo1.A31B
'rwTipo1.A01B
'rwTipo1.A25
'rwTipo1.A53
'rwTipo1.A21
'rwTipo1.A51
'rwTipo1.A54B
'rwTipo1.A33B
'rwTipo1.A12B
'rwTipo1.A34
'rwTipo1.A23
'rwTipo1.A22
'rwTipo1.B11
'xTipRap
'cOpeProg1
'cIdCau
'rwTipo1.A03
'cOpeProg2
'rwTipo1.A54C
'Substr(riga,234,1)
'rwTipo1.A32
'nProgImp
'rwTipo1.A33C
'rwTipo1.A12C
'LRTrim(xRapporto)
'rwTipo1.B13
'rwTipo1.A54A
''1'
'rwTipo1.A31A
'rwTipo1.A01A
'rwTipo1.A43
'rwTipo1.A52
'rwTipo1.B15
'rwTipo1.B14
'rwTipo1.B12
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O479
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+w_nomefile+" per l'operazione in data "+CharToDate(Substr(riga,79,8))+" con importo "+Str((Val(Substr(riga,282,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=4
prev=O485
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='If
pag=4
prev=O475
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='anadip
father=O476
fatherSonIndex=0
obj='Merge
pag=4
rd_kfield=[
'CODDIP
]
rd_kop=[
'=
]
rd_kvar=[
'xDIP
]
wr_field=[
'CODDIP
'DESCRIZ
'CAB
'DESCCIT
'PROVINCIA
]
wr_mode=[
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
]
wr_var=[
'xDIP
'xDIP
'rwTipo1.A12A
'rwTipo1.A12B
'rwTipo1.A12C
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
prev=O474
var_op='asgn
I
obj='Var
pag=4
prev=O473
var_op='asgn
I
obj='Read
pag=4
prev=O472
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'rwTipo1.A24
'rwTipo1.A25
]
rd_var=[
'cIdCau
]
I
obj='Var
pag=4
prev=O471
var_op='asgn
I
obj='Var
pag=4
prev=O470
var_op='asgn
I
obj='Var
pag=4
prev=O469
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O466
var_op='asgn
I
obj='If
pag=4
prev=O465
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O466
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("POPERAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O466
fatherSonIndex=1
obj='Read
pag=4
rd_field=[
'NUMPROG
]
rd_kfield=[
'IDEREG
]
rd_kvar=[
'rwTipo1.A54A
]
rd_var=[
'cOpeProg2
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='D
pag=4
prev=O421
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O420
var_op='asgn
I
obj='Remark
pag=4
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
x=9
y=15
I
Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDIPx))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPRead
arch='anadip
obj='Read
pag=4
prev=O517
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'xDIP
]
rd_var=[
'xDIPx
]
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anadip
father=O517
fatherSonIndex=0
obj='Insert
pag=4
rd_kfield=[
'CODDIP
'DESCRIZ
'CAB
'DESCCIT
'PROVINCIA
]
rd_kvar=[
'xDIP
'xDIP
'rwTipo1.A33A
'rwTipo1.A33B
'rwTipo1.A33C
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='anadip
father=O517
fatherSonIndex=1
obj='Write
pag=4
rd_kfield=[
'CODDIP
]
rd_kop=[
'=
]
rd_kvar=[
'xDIP
]
wr_field=[
'DESCCIT
'CAB
'PROVINCIA
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Substr(riga,47,30)
'Substr(riga,41,6)
'Substr(riga,77,2)
]
I
I
]
w=[
150
150
150
]
x=1442
y=724
I
Icpitembatch.CPBeginEnd
comment='Legge i dati dei clienti e li scrive
h=[
19
19
]
obj='Begin
pag=11
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O539
fatherSonIndex=0
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPForEach
for_variable='rwTipo7
for_variable_type='tipo7
h=[
19
19
]
iterator_expr='mcTipo7
obj='ForEach
pag=11
prev=O543
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O544
fatherSonIndex=0
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPRemark
frm_calc='Importa i soggetti delle operazioni
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(xConnes)),'S','N')
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwTipo7.C11)
len=16
name='xConnes
next=Icpitembatch.CPBeginEnd
comment='Calcola valori da salvare
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPIfElse
frm_calc=[
'xNewSog = 'N'
]
h=[
19
19
]
next=Icpitembatch.CPMerge
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'w_soloanag <> 'S'
]
h=[
19
19
]
obj='If
pag=11
prev=O560
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O561
fatherSonIndex=0
frm_calc=[
'_tipreg='O'
'_tipreg='T'
'_tipreg='R'
]
h=[
19
19
19
19
]
obj='Case
pag=11
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O566
fatherSonIndex=0
frm_calc=[
'_conta=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=11
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O571
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=11
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O576
fatherSonIndex=0
obj='Write
pag=11
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'LRTrim(rwTipo7.C11)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O576
fatherSonIndex=1
obj='Write
pag=11
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'LRTrim(rwTipo7.C11)
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O571
fatherSonIndex=1
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=11
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='xlientiope
father=O598
fatherSonIndex=0
obj='Merge
pag=11
rd_kfield=[
'IDFILEBO
'CODSOG
]
rd_kop=[
'=
'=
]
rd_kvar=[
'cOpeProg1
'LRTrim(rwTipo7.C11)
]
wr_field=[
'IDFILEBO
'IDBASE
'CODSOG
]
wr_mode=[
'ins
'ins
'ins/upd
]
wr_op=[
'=
'=
'=
]
wr_var=[
'cOpeProg1
'LibreriaMit.UniqueId()
'LRTrim(rwTipo7.C11)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='clientiope
father=O598
fatherSonIndex=1
obj='Merge
pag=11
rd_kfield=[
'IDFILEBO
'CODSOG
]
rd_kop=[
'=
'=
]
rd_kvar=[
'cOpeProg1
'rwTipo7.C11
]
wr_field=[
'IDFILEBO
'IDBASE
'CODSOG
]
wr_mode=[
'ins
'ins
'ins/upd
]
wr_op=[
'=
'=
'=
]
wr_var=[
'cOpeProg1
'LibreriaMit.UniqueId()
'rwTipo7.C11
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O566
fatherSonIndex=1
frm_calc='rwTipo7.C11
len=16
name='xTitolare
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=11
prev=O623
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xapotit
father=O624
fatherSonIndex=0
obj='Write
pag=11
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cInfProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'LRTrim(rwTipo7.C11)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='rapotit
father=O624
fatherSonIndex=1
obj='Write
pag=11
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cInfProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'LRTrim(rwTipo7.C11)
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O566
fatherSonIndex=2
frm_calc=[
'cDelega='N'
]
h=[
19
19
]
obj='If
pag=11
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='intestbo
father=O646
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDBx))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A'
'xTipoInf='C'
'xTipoInf='P' or xTipoInf='D'
]
h=[
19
19
19
19
]
obj='If
pag=11
prev=O652
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='intestbo
father=O655
fatherSonIndex=0
obj='Merge
pag=11
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xRapporto)
'LRTrim(rwTipo7.C11)
]
wr_field=[
'RAPPORTO
'CODINTER
'IDBASE
'PRGIMPSOG
'CPROWNUM
'DATAINI
'NUMPROG1
'STATOREG
]
wr_mode=[
'ins
'ins
'ins
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xRapporto)
'LRTrim(rwTipo7.C11)
'LibreriaMit.UniqueId()
'nProgImp2
'cMaxRow
'_dataope
'cInfProg2
''0'
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='intestbo
father=O655
fatherSonIndex=1
obj='Merge
pag=11
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xRapporto)
'LRTrim(rwTipo7.C11)
]
wr_field=[
'RAPPORTO
'CODINTER
'IDBASE
'CPROWNUM
'PRGIMPSOG
'DATAFINE
'NUMPROG2
'STATOREG
]
wr_mode=[
'ins
'ins
'ins
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xRapporto)
'LRTrim(rwTipo7.C11)
'LibreriaMit.UniqueId()
'cMaxRow
'nProgImp2
'_dataope
'cInfProg2
''0'
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='intestbo
father=O655
fatherSonIndex=2
obj='Merge
pag=11
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xRapporto)
'LRTrim(rwTipo7.C11)
]
wr_field=[
'RAPPORTO
'CODINTER
'IDBASE
'CPROWNUM
'PRGIMPSOG
]
wr_mode=[
'ins
'ins
'ins
'ins
'ins
]
wr_op=[
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xRapporto)
'LRTrim(rwTipo7.C11)
'LibreriaMit.UniqueId()
'cMaxRow
'nProgImp2
]
I
I
]
w=[
150
150
150
150
]
I
obj='If
pag=11
prev=O651
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O652
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=11
prev=O691
var_op='asgn
I
obj='Select
pag=11
prev=O690
sel_field='intestbo->CPROWNUM
sel_name='intestbo
sel_order='intestbo->CPROWNUM
sel_where='intestbo->RAPPORTO=xRapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O691
fatherSonIndex=0
frm_calc='intestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=11
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=11
prev=O689
var_op='asgn
I
obj='Var
obj_type='N
pag=11
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=11
rd_field=[
'CODINTER
'CPROWNUM
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'LRTrim(xRapporto)
'LRTrim(rwTipo7.C11)
]
rd_var=[
'xIDBx
'cMaxRow
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Merge
pag=11
prev=O557
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(rwTipo7.C11)
]
wr_field=[
'CONNES
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'CODFISC
'DATANASC
'NASCOMUN
'NASSTATO
'SOTGRUP
'ATTIV
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'SESSO
'TIPOPERS
'CFESTERO
'TIPINTER
]
wr_mode=[
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(rwTipo7.C11)
'rwTipo7.D11
'rwTipo7.D14A
'rwTipo7.D13
'rwTipo7.D14B
'rwTipo7.D14C
'rwTipo7.D15
'rwTipo7.D16
'rwTipo7.D17
'rwTipo7.D18
'cCNAS
'cSNAS
'rwTipo7.D21
'rwTipo7.D22
'rwTipo7.D23
'xTD
'rwTipo7.D42
'rwTipo7.D43
'rwTipo7.D44
'xSesso
'cTipPer
'iif(Empty(rwTipo7.D17),1,0)
'_prvnas
]
I
obj='If
pag=11
prev=O556
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O557
fatherSonIndex=0
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
obj='If
pag=11
prev=O716
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O718
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=11
prev=O723
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES =xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O724
fatherSonIndex=0
obj='Insert
pag=11
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'datamodi
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
'DATAVARAGE
'SETTSINT2
'FATCA
'BANCABEN
'TIN
'ODB
'TELEF
'TIPOORO
'CODORO
'IDNASCOMUN
'IDNASSTATO
'NOTIT
]
rd_kvar=[
'cProgSto
'LRTrim(rwTipo7.C11)
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'_datareg
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
'personbo->DATAVARAGE
'personbo->SETTSINT2
'personbo->FATCA
'personbo->BANCABEN
'personbo->TIN
'personbo->ODB
'personbo->TELEF
'personbo->TIPOORO
'personbo->CODORO
'personbo->IDNASCOMUN
'personbo->IDNASSTATO
'personbo->NOTIT
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=11
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=11
prev=O715
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=xConnes and wersonbo->datamodi=_datareg
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O716
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=11
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=11
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=11
prev=O554
var_op='asgn
I
obj='Begin
pag=11
prev=O553
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O554
fatherSonIndex=0
frm_calc=[
'rwTipo7.D45='M'
'rwTipo7.D45='F'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_prvnas
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='rwTipo7.D19
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(rwTipo7.D17))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='rwTipo7.D41
len=2
name='xTD
next=Icpitembatch.CPIfElse
frm_calc=[
'At(xTD,'|01|02|03|04|05|06') = 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(xSesso),'G','P')
len=1
name='cTipPer
obj='Var
pag=11
prev=O750
var_op='asgn
I
obj='If
pag=11
prev=O749
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O750
fatherSonIndex=0
frm_calc='''
len=2
name='xTD
obj='Var
pag=11
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=11
prev=O746
var_op='asgn
I
obj='If
pag=11
prev=O745
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O746
fatherSonIndex=0
frm_calc=[
'Substr(rwTipo7.D17,12,1) = 'Z' and Len(LRTrim(rwTipo7.D17))=16
'Substr(rwTipo7.D17,12,1) <> 'Z' and Len(LRTrim(rwTipo7.D17))=16
]
h=[
19
19
19
]
obj='If
pag=11
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O760
fatherSonIndex=0
frm_calc='rwTipo7.D19
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='_prvnas
obj='Var
pag=11
prev=O766
var_op='asgn
I
obj='Var
pag=11
prev=O765
var_op='asgn
I
obj='Var
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O760
fatherSonIndex=1
obj='Read
pag=11
rd_field=[
'PROV
]
rd_kfield=[
'SIGLA
]
rd_kvar=[
'Substr(xCF,12,4)
]
rd_var=[
'_prvnas
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O746
fatherSonIndex=1
frm_calc='rwTipo7.D19
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='_prvnas
obj='Var
pag=11
prev=O777
var_op='asgn
I
obj='Var
pag=11
prev=O776
var_op='asgn
I
obj='Var
pag=11
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=11
prev=O744
var_op='asgn
I
obj='Var
pag=11
prev=O743
var_op='asgn
I
obj='Var
pag=11
prev=O740
var_op='asgn
I
obj='Case
pag=11
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O740
fatherSonIndex=0
frm_calc=''1'
len=1
name='xSesso
obj='Var
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O740
fatherSonIndex=1
frm_calc=''2'
len=1
name='xSesso
obj='Var
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O740
fatherSonIndex=2
frm_calc='rwTipo7.D45
len=1
name='xSesso
obj='Var
pag=11
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=11
prev=O552
var_op='asgn
I
obj='Var
pag=11
prev=O551
var_op='asgn
I
obj='Read
pag=11
prev=O550
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(rwTipo7.C11)
]
rd_var=[
'xConnes
]
I
obj='Var
pag=11
prev=O549
var_op='asgn
I
obj='Remark
pag=11
prev=O548
I
obj='Var
obj_type='N
pag=11
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=11
var_op='asgn
I
I
]
w=[
150
150
]
x=17
y=24
I
Icpitembatch.CPBeginEnd
comment='Legge i dati degli Esecutori e li scrive
h=[
19
19
]
obj='Begin
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O795
fatherSonIndex=0
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPForEach
for_variable='rwTipo8
for_variable_type='tipo8
h=[
19
19
]
iterator_expr='mcTipo8
obj='ForEach
pag=12
prev=O799
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O800
fatherSonIndex=0
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPRemark
frm_calc='Importa i soggetti delle operazioni
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(xConnes)),'S','N')
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwTipo8.C21)
len=16
name='xConnes
next=Icpitembatch.CPBeginEnd
comment='Calcola valori da salvare
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPIfElse
frm_calc=[
'xNewSog = 'N'
]
h=[
19
19
]
next=Icpitembatch.CPMerge
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'w_soloanag <> 'S'
]
h=[
19
19
]
obj='If
pag=12
prev=O816
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O817
fatherSonIndex=0
frm_calc=[
'_tipreg='O'
'_tipreg='R'
]
h=[
19
19
19
]
obj='Case
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O822
fatherSonIndex=0
frm_calc=[
'_conta=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O827
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O832
fatherSonIndex=0
obj='Write
pag=12
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'LRTrim(rwTipo8.C21)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O832
fatherSonIndex=1
obj='Write
pag=12
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'LRTrim(rwTipo8.C21)
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O827
fatherSonIndex=1
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O854
fatherSonIndex=0
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='xogopebo
obj='Insert
pag=12
prev=O862
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'cMaxRow
'LRTrim(rwTipo8.C21)
'LibreriaMit.UniqueId()
]
I
obj='Var
obj_type='N
pag=12
prev=O860
var_op='asgn
I
obj='Select
pag=12
prev=O859
sel_field='xogopebo->CPROWNUM
sel_name='xogopebo
sel_order='xogopebo->CPROWNUM
sel_where='xogopebo->IDFILEBO=cOpeProg1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O860
fatherSonIndex=0
frm_calc='xogopebo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O854
fatherSonIndex=1
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='sogopebo
obj='Insert
pag=12
prev=O874
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'cMaxRow
'LRTrim(rwTipo8.C21)
'LibreriaMit.UniqueId()
]
I
obj='Var
obj_type='N
pag=12
prev=O872
var_op='asgn
I
obj='Select
pag=12
prev=O871
sel_field='sogopebo->CPROWNUM
sel_name='sogopebo
sel_order='sogopebo->CPROWNUM
sel_where='sogopebo->IDFILEBO=cOpeProg1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O872
fatherSonIndex=0
frm_calc='sogopebo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O822
fatherSonIndex=1
frm_calc=[
'cDelega='S'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='delegabo
father=O885
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDBx))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A'
'xTipoInf='C'
'xTipoInf='P' or xTipoInf='D'
]
h=[
19
19
19
19
]
obj='If
pag=12
prev=O891
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='delegabo
father=O894
fatherSonIndex=0
obj='Merge
pag=12
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xRapporto)
'LRTrim(rwTipo8.C21)
]
wr_field=[
'RAPPORTO
'CODINTER
'IDBASE
'CPROWNUM
'DATAINI
'NUMPROG1
'STATOREG
]
wr_mode=[
'ins
'ins
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xRapporto)
'LRTrim(rwTipo8.C21)
'LibreriaMit.UniqueId()
'cMaxRow
'_dataope
'cInfProg2
''0'
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='delegabo
father=O894
fatherSonIndex=1
obj='Merge
pag=12
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xRapporto)
'LRTrim(rwTipo8.C21)
]
wr_field=[
'RAPPORTO
'CODINTER
'IDBASE
'CPROWNUM
'DATAFINE
'NUMPROG2
'STATOREG
]
wr_mode=[
'ins
'ins
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xRapporto)
'LRTrim(rwTipo8.C21)
'LibreriaMit.UniqueId()
'cMaxRow
'_dataope
'cInfProg2
''0'
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='delegabo
father=O894
fatherSonIndex=2
obj='Merge
pag=12
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xRapporto)
'LRTrim(rwTipo8.C21)
]
wr_field=[
'RAPPORTO
'CODINTER
'IDBASE
'CPROWNUM
]
wr_mode=[
'ins
'ins
'ins
'ins
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xRapporto)
'LRTrim(rwTipo8.C21)
'LibreriaMit.UniqueId()
'cMaxRow
]
I
I
]
w=[
150
150
150
150
]
I
obj='If
pag=12
prev=O890
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O891
fatherSonIndex=0
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=12
prev=O929
var_op='asgn
I
obj='Select
pag=12
prev=O928
sel_field='delegabo->CPROWNUM
sel_name='delegabo
sel_order='delegabo->CPROWNUM
sel_where='delegabo->RAPPORTO=xRapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O929
fatherSonIndex=0
frm_calc='delegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
rd_field=[
'CODINTER
'CPROWNUM
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'LRTrim(xRapporto)
'LRTrim(rwTipo8.C21)
]
rd_var=[
'xIDBx
'cMaxRow
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O885
fatherSonIndex=1
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xapopebo
father=O942
fatherSonIndex=0
obj='Write
pag=12
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'LRTrim(rwTipo8.C21)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='rapopebo
father=O942
fatherSonIndex=1
obj='Write
pag=12
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'LRTrim(rwTipo8.C21)
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Merge
pag=12
prev=O813
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(rwTipo8.C21)
]
wr_field=[
'CONNES
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'CODFISC
'DATANASC
'NASCOMUN
'NASSTATO
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'SESSO
'TIPOPERS
'CFESTERO
'TIPINTER
]
wr_mode=[
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(rwTipo8.C21)
'rwTipo8.E11
'rwTipo8.E14A
'rwTipo8.E13
'rwTipo8.E14B
'rwTipo8.E14C
'rwTipo8.E15
'rwTipo8.E16
'rwTipo8.E17
'rwTipo8.E18
'cCNAS
'cSNAS
'xTD
'rwTipo8.E42
'rwTipo8.E43
'rwTipo8.E44
'xSesso
'cTipPer
'iif(Empty(rwTipo8.E17),1,0)
'_prvnas
]
I
obj='If
pag=12
prev=O812
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O813
fatherSonIndex=0
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
obj='If
pag=12
prev=O976
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O978
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=12
prev=O983
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES =xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O984
fatherSonIndex=0
obj='Insert
pag=12
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'datamodi
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
'DATAVARAGE
'SETTSINT2
'FATCA
'BANCABEN
'TIN
'ODB
'TELEF
'TIPOORO
'CODORO
'IDNASCOMUN
'IDNASSTATO
'NOTIT
]
rd_kvar=[
'cProgSto
'LRTrim(rwTipo8.C21)
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'_datareg
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
'personbo->DATAVARAGE
'personbo->SETTSINT2
'personbo->FATCA
'personbo->BANCABEN
'personbo->TIN
'personbo->ODB
'personbo->TELEF
'personbo->TIPOORO
'personbo->CODORO
'personbo->IDNASCOMUN
'personbo->IDNASSTATO
'personbo->NOTIT
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=12
prev=O975
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=xConnes and wersonbo->datamodi=_datareg
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O976
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
prev=O810
var_op='asgn
I
obj='Begin
pag=12
prev=O809
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O810
fatherSonIndex=0
frm_calc=[
'rwTipo8.E45='M'
'rwTipo8.E45='F'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_prvnas
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='rwTipo8.E19
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(rwTipo8.E17))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='rwTipo8.E41
len=2
name='xTD
next=Icpitembatch.CPIfElse
frm_calc=[
'At(xTD,'|01|02|03|04|05|06') = 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(xSesso),'G','P')
len=1
name='cTipPer
obj='Var
pag=12
prev=O1010
var_op='asgn
I
obj='If
pag=12
prev=O1009
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1010
fatherSonIndex=0
frm_calc='''
len=2
name='xTD
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=12
prev=O1006
var_op='asgn
I
obj='If
pag=12
prev=O1005
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1006
fatherSonIndex=0
frm_calc=[
'Substr(rwTipo8.E17,12,1) = 'Z' and Len(LRTrim(rwTipo8.E17))=16
'Substr(rwTipo8.E17,12,1) <> 'Z' and Len(LRTrim(rwTipo8.E17))=16
]
h=[
19
19
19
]
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1020
fatherSonIndex=0
frm_calc='rwTipo8.E19
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='_prvnas
obj='Var
pag=12
prev=O1026
var_op='asgn
I
obj='Var
pag=12
prev=O1025
var_op='asgn
I
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O1020
fatherSonIndex=1
obj='Read
pag=12
rd_field=[
'PROV
]
rd_kfield=[
'SIGLA
]
rd_kvar=[
'Substr(xCF,12,4)
]
rd_var=[
'_prvnas
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1006
fatherSonIndex=1
frm_calc='rwTipo8.E19
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='_prvnas
obj='Var
pag=12
prev=O1037
var_op='asgn
I
obj='Var
pag=12
prev=O1036
var_op='asgn
I
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=12
prev=O1004
var_op='asgn
I
obj='Var
pag=12
prev=O1003
var_op='asgn
I
obj='Var
pag=12
prev=O1000
var_op='asgn
I
obj='Case
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1000
fatherSonIndex=0
frm_calc=''1'
len=1
name='xSesso
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1000
fatherSonIndex=1
frm_calc=''2'
len=1
name='xSesso
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1000
fatherSonIndex=2
frm_calc='rwTipo8.E45
len=1
name='xSesso
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=12
prev=O808
var_op='asgn
I
obj='Var
pag=12
prev=O807
var_op='asgn
I
obj='Read
pag=12
prev=O806
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(rwTipo8.C21)
]
rd_var=[
'xConnes
]
I
obj='Var
pag=12
prev=O805
var_op='asgn
I
obj='Remark
pag=12
prev=O804
I
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
x=7
y=21
I
Icpitembatch.CPBeginEnd
comment='Legge i dati delle controparti e li scrive
h=[
19
19
]
obj='Begin
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1055
fatherSonIndex=0
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPForEach
for_variable='rwTipo5
for_variable_type='tipo5
h=[
19
19
]
iterator_expr='mcTipo5
obj='ForEach
pag=9
prev=O1059
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1060
fatherSonIndex=0
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPRemark
frm_calc='Importa i soggetti delle operazioni
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xConnes
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(rwTipo5.C31))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_soloanag <> 'S'
]
h=[
19
19
]
obj='If
pag=9
prev=O1067
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1070
fatherSonIndex=0
frm_calc=[
'_conta=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1075
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O1080
fatherSonIndex=0
obj='Write
pag=9
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESBEN
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(rwTipo5.C31)
'rwTipo5.F11
'rwTipo5.F13
'rwTipo5.F14B
'rwTipo5.F14A
'rwTipo5.F14C
'rwTipo5.F15
'rwTipo5.F16
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O1080
fatherSonIndex=1
obj='Write
pag=9
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESBEN
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(rwTipo5.C31)
'rwTipo5.F11
'rwTipo5.F13
'rwTipo5.F14B
'rwTipo5.F14A
'rwTipo5.F14C
'rwTipo5.F15
'rwTipo5.F16
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1075
fatherSonIndex=1
frm_calc=[
'_A54A='3'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='meneficope
father=O1102
fatherSonIndex=0
obj='Insert
pag=9
rd_kfield=[
'IDFILEBO
'CODSOG
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'IDBASE
]
rd_kvar=[
'cOpeProg1
'LRTrim(rwTipo5.C31)
'rwTipo5.F11
'rwTipo5.F13
'rwTipo5.F14B
'rwTipo5.F14A
'rwTipo5.F14C
'rwTipo5.F15
'rwTipo5.F16
'LibreriaMit.UniqueId()
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1102
fatherSonIndex=1
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xeneficope
father=O1111
fatherSonIndex=0
obj='Insert
pag=9
rd_kfield=[
'IDFILEBO
'CODSOG
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'IDBASE
]
rd_kvar=[
'cOpeProg1
'LRTrim(rwTipo5.C31)
'rwTipo5.F11
'rwTipo5.F13
'rwTipo5.F14B
'rwTipo5.F14A
'rwTipo5.F14C
'rwTipo5.F15
'rwTipo5.F16
'LibreriaMit.UniqueId()
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficope
father=O1111
fatherSonIndex=1
obj='Insert
pag=9
rd_kfield=[
'IDFILEBO
'CODSOG
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'IDBASE
]
rd_kvar=[
'cOpeProg1
'LRTrim(rwTipo5.C31)
'rwTipo5.F11
'rwTipo5.F13
'rwTipo5.F14B
'rwTipo5.F14A
'rwTipo5.F14C
'rwTipo5.F15
'rwTipo5.F16
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O1066
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O1067
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(xConnes)),'S','N')
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwTipo5.C31)
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPIfElse
frm_calc=[
'xNewSog = 'N'
]
h=[
19
19
]
next=Icpitembatch.CPMerge
arch='personbo
obj='Merge
pag=9
prev=O1133
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(rwTipo5.C31)
]
wr_field=[
'CONNES
'RAGSOC
'PAESE
'CODCAB
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
]
wr_mode=[
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(rwTipo5.C31)
'rwTipo5.F11
'rwTipo5.F13
'rwTipo5.F14A
'rwTipo5.F14B
'rwTipo5.F14C
'rwTipo5.F15
'rwTipo5.F16
]
I
obj='If
pag=9
prev=O1132
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1133
fatherSonIndex=0
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
obj='If
pag=9
prev=O1147
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1149
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=9
prev=O1154
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES =xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O1155
fatherSonIndex=0
obj='Insert
pag=9
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'datamodi
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
'DATAVARAGE
'SETTSINT2
'FATCA
'BANCABEN
'TIN
'ODB
'TELEF
'TIPOORO
'CODORO
'IDNASCOMUN
'IDNASSTATO
'NOTIT
]
rd_kvar=[
'cProgSto
'LRTrim(rwTipo5.C31)
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'_datareg
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
'personbo->DATAVARAGE
'personbo->SETTSINT2
'personbo->FATCA
'personbo->BANCABEN
'personbo->TIN
'personbo->ODB
'personbo->TELEF
'personbo->TIPOORO
'personbo->CODORO
'personbo->IDNASCOMUN
'personbo->IDNASSTATO
'personbo->NOTIT
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=9
prev=O1146
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=xConnes and wersonbo->datamodi=_datareg
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1147
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=9
prev=O1131
var_op='asgn
I
obj='Var
pag=9
prev=O1130
var_op='asgn
I
obj='Var
pag=9
prev=O1129
var_op='asgn
I
obj='Read
pag=9
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'rwTipo5.C31
]
rd_var=[
'xConnes
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O1065
var_op='asgn
I
obj='Remark
pag=9
prev=O1064
I
obj='Var
obj_type='N
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
x=13
y=18
I
Icpitembatch.CPBeginEnd
comment='Legge l'operazione e scrive i dati
h=[
19
19
]
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1176
fatherSonIndex=0
frm_calc=[
'w_soloanag <> 'S'
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='page
frm_calc='7
next=Icpitembatch.CPExec
check='page
frm_calc='11
next=Icpitembatch.CPExec
check='page
frm_calc='10
obj='Exec
pag=6
prev=O1184
I
obj='Exec
pag=6
prev=O1183
I
obj='Exec
pag=6
prev=O1180
I
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O1180
fatherSonIndex=0
for_variable='rwTipo1
for_variable_type='tipo1
h=[
19
19
]
iterator_expr='mcTipo1
obj='ForEach
pag=6
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRemark
father=O1188
fatherSonIndex=0
frm_calc='Importa i dati base delle operazioni
next=Icpitembatch.CPVarDecl
comment='Contatore Operazioni
frm_calc='cNumTit + 1
len=10
name='cNumTit
next=Icpitembatch.CPVarDecl
frm_calc='rwTipo1.A21
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
frm_calc='rwTipo1.A51
len=8
name='_datareg
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
prev=O1195
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1196
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGPTIT1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPTIT2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='cInfProg2
len=11
name='cInfTit
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTIT\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(iif(rwTipo1.A41 <> '00000000000000000000000000',rwTipo1.A41,Space(25)))
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='iif(rwTipo1.A41 <> '00000000000000000000000000',rwTipo1.A42,Space(1))
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,248,1)='2','2',iif(Substr(riga,248,1)='0','S','A'))
len=1
name='streg
next=Icpitembatch.CPVarDecl
frm_calc='rwTipo1.A11
len=6
name='xDIP
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xDIP)))
]
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xapotit
h=[
19
19
]
obj='Insert
pag=6
prev=O1209
rd_kfield=[
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPERAZMOD
'OPRAP
'PAESE
'PRGIMPTIT
'PROV2
'PROVINCIA
'RAPPORTO
'SEGNO
'STATOREG
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
]
rd_kvar=[
'DateToChar(rwTipo1.A21)
'DateToChar(rwTipo1.A51)
'rwTipo1.A24
'rwTipo1.A12A
'rwTipo1.A33A
'rwTipo1.A11
'rwTipo1.A31B
'rwTipo1.A01B
'rwTipo1.A25
'rwTipo1.A53
'rwTipo1.A21
'rwTipo1.A51
'rwTipo1.A54B
'rwTipo1.A33B
'rwTipo1.A12B
'rwTipo1.A34
'rwTipo1.A23
'rwTipo1.A22
'rwTipo1.B11
'xTipRap
'cInfProg1
'rwTipo1.A03
'cInfProg2
'rwTipo1.A54C
'Substr(riga,234,1)
'rwTipo1.A32
'nProgImp
'rwTipo1.A33C
'rwTipo1.A12C
'LRTrim(xRapporto)
'rwTipo1.B13
'rwTipo1.A54A
''1'
'rwTipo1.A31A
'rwTipo1.A01A
'rwTipo1.A43
'rwTipo1.A52
'rwTipo1.B15
'rwTipo1.B14
'rwTipo1.B12
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1212
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+w_nomefile+" per l'informazione in data "+Substr(riga,79,8)+" relativa al legame: "+xRapporto+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=6
prev=O1218
I
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='If
pag=6
prev=O1208
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='anadip
father=O1209
fatherSonIndex=0
obj='Merge
pag=6
rd_kfield=[
'CODDIP
]
rd_kop=[
'=
]
rd_kvar=[
'xDIP
]
wr_field=[
'CODDIP
'DESCRIZ
'CAB
'DESCCIT
'PROVINCIA
]
wr_mode=[
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
]
wr_var=[
'xDIP
'xDIP
'rwTipo1.A12A
'rwTipo1.A12B
'rwTipo1.A12C
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O1207
var_op='asgn
I
obj='Var
pag=6
prev=O1206
var_op='asgn
I
obj='Var
pag=6
prev=O1205
var_op='asgn
I
obj='Var
pag=6
prev=O1204
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O1203
var_op='asgn
I
obj='Var
pag=6
prev=O1202
var_op='asgn
I
obj='Var
pag=6
prev=O1201
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1196
fatherSonIndex=1
frm_calc=[
'xTipoInf <> 'X'
]
h=[
19
19
]
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1233
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGTITO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGTITO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='cInfProg2
len=11
name='cInfTit
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTIT\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,199,25),Space(25)))
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,224,1),Space(1))
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,248,1)='2','2',iif(Substr(riga,248,1)='0','S','A'))
len=1
name='streg
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,35,6)
len=6
name='xDIP
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xDIP)))
]
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='rapotit
h=[
19
19
]
obj='Insert
pag=6
prev=O1248
rd_kfield=[
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPERAZMOD
'OPRAP
'PAESE
'PRGIMPTIT
'PROV2
'PROVINCIA
'RAPPORTO
'SEGNO
'STATOREG
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
]
rd_kvar=[
'DateToChar(rwTipo1.A21)
'DateToChar(rwTipo1.A51)
'rwTipo1.A24
'rwTipo1.A12A
'rwTipo1.A33A
'rwTipo1.A11
'rwTipo1.A31B
'rwTipo1.A01B
'rwTipo1.A25
'rwTipo1.A53
'rwTipo1.A21
'rwTipo1.A51
'rwTipo1.A54B
'rwTipo1.A33B
'rwTipo1.A12B
'rwTipo1.A34
'rwTipo1.A23
'rwTipo1.A22
'rwTipo1.B11
'xTipRap
'cInfProg1
'rwTipo1.A03
'cInfProg2
'rwTipo1.A54C
'Substr(riga,234,1)
'rwTipo1.A32
'nProgImp
'rwTipo1.A33C
'rwTipo1.A12C
'LRTrim(xRapporto)
'rwTipo1.B13
'rwTipo1.A54A
''1'
'rwTipo1.A31A
'rwTipo1.A01A
'rwTipo1.A43
'rwTipo1.A52
'rwTipo1.B15
'rwTipo1.B14
'rwTipo1.B12
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1251
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+w_nomefile+" per l'informazione in data "+Substr(riga,79,8)+" relativa al legame: "+xRapporto+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=6
prev=O1257
I
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='If
pag=6
prev=O1247
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anadip
father=O1248
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDIPx))
]
h=[
19
19
]
obj='If
pag=6
prev=O1262
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anadip
father=O1263
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'CODDIP
'DESCRIZ
]
rd_kvar=[
'xDIP
'xDIP
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'xDIP
]
rd_var=[
'xDIPx
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O1246
var_op='asgn
I
obj='Var
pag=6
prev=O1245
var_op='asgn
I
obj='Var
pag=6
prev=O1244
var_op='asgn
I
obj='Var
pag=6
prev=O1243
var_op='asgn
I
obj='Var
pag=6
prev=O1242
var_op='asgn
I
obj='Var
pag=6
prev=O1241
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O1240
var_op='asgn
I
obj='Var
pag=6
prev=O1239
var_op='asgn
I
obj='Var
pag=6
prev=O1238
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='D
pag=6
prev=O1194
var_op='asgn
I
obj='Var
obj_type='D
pag=6
prev=O1193
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O1192
var_op='asgn
I
obj='Remark
pag=6
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
x=13
y=16
I
Icpitembatch.CPIfElse
frm_calc=[
'_dataope <= CharToDate("20131231")
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
I
Icpitembatch.CPItemSon
I
]
w=[
150
150
150
]
x=775
y=1445
I
Icpitembatch.CPRemark
frm_calc='Controllo se apertura o chiusura o altro
next=Icpitembatch.CPCase
frm_calc=[
'At(_A52,'|26|28|36|38|46|51|53') > 0
'At(_A52,'|21|22|23|25|33|34|35|37|43|44|45|50|52|58') > 0
'At(_A52,'|31|54') > 0
'At(_A52,'|32|55') > 0
]
h=[
19
19
19
19
19
19
]
haselse=True
obj='Case
pag=14
prev=O1289
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1290
fatherSonIndex=0
frm_calc=''C'
len=1
name='xTipoInf
obj='Var
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1290
fatherSonIndex=1
frm_calc=''A'
len=1
name='xTipoInf
obj='Var
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1290
fatherSonIndex=2
frm_calc=''P'
len=1
name='xTipoInf
obj='Var
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1290
fatherSonIndex=3
frm_calc=''D'
len=1
name='xTipoInf
obj='Var
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1290
fatherSonIndex=4
frm_calc=''X'
len=1
name='xTipoInf
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
150
150
150
150
]
I
obj='Remark
pag=14
x=11
y=18
I
Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPForEach
for_variable='rwTipo6
for_variable_type='tipo6
h=[
19
19
]
iterator_expr='mcTipo6
obj='ForEach
pag=10
prev=O1305
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1306
fatherSonIndex=0
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPRemark
frm_calc='Importa i soggetti delle operazioni
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(xConnes)),'S','N')
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwTipo6.C41)
len=16
name='xConnes
next=Icpitembatch.CPBeginEnd
comment='Calcola valori da salvare
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPIfElse
frm_calc=[
'xNewSog = 'N'
]
h=[
19
19
]
next=Icpitembatch.CPMerge
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'w_soloanag <> 'S'
]
h=[
19
19
]
obj='If
pag=10
prev=O1322
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O1323
fatherSonIndex=0
frm_calc=[
'_tipreg='T'
'_tipreg='R'
'_tipreg='O'
]
h=[
19
19
19
19
]
obj='Case
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='intestit
father=O1328
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDBx))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A'
'xTipoInf='C'
'xTipoInf='P' or xTipoInf='D'
]
h=[
19
19
19
19
]
obj='If
pag=10
prev=O1334
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='intestit
father=O1337
fatherSonIndex=0
obj='Merge
pag=10
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xTitolare)
'LRTrim(rwTipo6.C41)
]
wr_field=[
'CODCLI
'CODINTER
'IDBASE
'DATAINI
'NUMPROG1
'STATOREG
'PRGIMPTITE
]
wr_mode=[
'ins
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
'ins
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xTitolare)
'LRTrim(rwTipo6.C41)
'LibreriaMit.UniqueId()
'_dataope
'cInfProg2
''0'
'nProgImp2
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='intestit
father=O1337
fatherSonIndex=1
obj='Merge
pag=10
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xTitolare)
'LRTrim(rwTipo6.C41)
]
wr_field=[
'CODCLI
'CODINTER
'IDBASE
'DATAFINE
'NUMPROG2
'STATOREG
'PRGIMPTITE
]
wr_mode=[
'ins
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
'ins
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xTitolare)
'LRTrim(rwTipo6.C41)
'LibreriaMit.UniqueId()
'_dataope
'cInfProg2
''0'
'nProgImp2
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='intestit
father=O1337
fatherSonIndex=2
obj='Merge
pag=10
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xTitolare)
'LRTrim(rwTipo6.C41)
]
wr_field=[
'CODCLI
'CODINTER
'IDBASE
'PRGIMPTITE
]
wr_mode=[
'ins
'ins
'ins
'ins
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xTitolare)
'LRTrim(rwTipo6.C41)
'LibreriaMit.UniqueId()
'nProgImp2
]
I
I
]
w=[
150
150
150
150
]
I
obj='If
pag=10
prev=O1333
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1334
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
obj='Var
obj_type='N
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
rd_field=[
'CODINTER
]
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kvar=[
'LRTrim(xTitolare)
'LRTrim(rwTipo6.C41)
]
rd_var=[
'xIDBx
]
I
I
Icpitembatch.CPItemSon
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1328
fatherSonIndex=2
frm_calc=[
'_conta=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1379
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O1384
fatherSonIndex=0
obj='Write
pag=10
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNALTRO
]
wr_op=[
'=
]
wr_var=[
'LRTrim(rwTipo6.C41)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O1384
fatherSonIndex=1
obj='Write
pag=10
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNALTRO
]
wr_op=[
'=
]
wr_var=[
'LRTrim(rwTipo6.C41)
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1379
fatherSonIndex=1
frm_calc=[
'_A54A='3'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='merzistiope
father=O1406
fatherSonIndex=0
obj='Insert
pag=10
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'LRTrim(rwTipo6.C41)
'LibreriaMit.UniqueId()
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1406
fatherSonIndex=1
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xerzistiope
father=O1415
fatherSonIndex=0
obj='Insert
pag=10
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'LRTrim(rwTipo6.C41)
'LibreriaMit.UniqueId()
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistiope
father=O1415
fatherSonIndex=1
obj='Insert
pag=10
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'LRTrim(rwTipo6.C41)
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Merge
pag=10
prev=O1319
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(rwTipo6.C41)
]
wr_field=[
'CONNES
'RAGSOC
'PAESE
'CODCAB
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'CODFISC
'DATANASC
'NASCOMUN
'NASSTATO
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'SESSO
'TIPOPERS
'CFESTERO
'TIPINTER
]
wr_mode=[
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(rwTipo6.C41)
'rwTipo6.G11
'rwTipo6.G13
'rwTipo6.G14A
'rwTipo6.G14B
'rwTipo6.G14C
'rwTipo6.G15
'rwTipo6.G16
'rwTipo6.G17
'rwTipo6.G18
'cCNAS
'cSNAS
'xTD
'rwTipo6.G42
'rwTipo6.G43
'rwTipo6.G44
'xSesso
'cTipPer
'iif(Empty(rwTipo6.G17),1,0)
'_prvnas
]
I
obj='If
pag=10
prev=O1318
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1319
fatherSonIndex=0
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
obj='If
pag=10
prev=O1442
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1444
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=10
prev=O1449
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES =xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O1450
fatherSonIndex=0
obj='Insert
pag=10
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'datamodi
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
'DATAVARAGE
'SETTSINT2
'FATCA
'BANCABEN
'TIN
'ODB
'TELEF
'TIPOORO
'CODORO
'IDNASCOMUN
'IDNASSTATO
'NOTIT
]
rd_kvar=[
'cProgSto
'LRTrim(rwTipo6.C41)
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'_datareg
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
'personbo->DATAVARAGE
'personbo->SETTSINT2
'personbo->FATCA
'personbo->BANCABEN
'personbo->TIN
'personbo->ODB
'personbo->TELEF
'personbo->TIPOORO
'personbo->CODORO
'personbo->IDNASCOMUN
'personbo->IDNASSTATO
'personbo->NOTIT
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=10
prev=O1441
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=xConnes and wersonbo->datamodi=_datareg
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1442
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
prev=O1316
var_op='asgn
I
obj='Begin
pag=10
prev=O1315
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPCase
father=O1316
fatherSonIndex=0
frm_calc=[
'rwTipo6.G45='M'
'rwTipo6.G45='F'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_prvnas
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='rwTipo6.G19
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(rwTipo6.G17))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='rwTipo6.G41
len=2
name='xTD
next=Icpitembatch.CPIfElse
frm_calc=[
'At(xTD,'|01|02|03|04|05|06') = 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(xSesso),'G','P')
len=1
name='cTipPer
obj='Var
pag=10
prev=O1476
var_op='asgn
I
obj='If
pag=10
prev=O1475
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1476
fatherSonIndex=0
frm_calc='''
len=2
name='xTD
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
prev=O1472
var_op='asgn
I
obj='If
pag=10
prev=O1471
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1472
fatherSonIndex=0
frm_calc=[
'Substr(rwTipo6.G17,12,1) = 'Z' and Len(LRTrim(rwTipo6.G17))=16
'Substr(rwTipo6.G17,12,1) <> 'Z' and Len(LRTrim(rwTipo6.G17))=16
]
h=[
19
19
19
]
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1486
fatherSonIndex=0
frm_calc='rwTipo6.G19
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='_prvnas
obj='Var
pag=10
prev=O1492
var_op='asgn
I
obj='Var
pag=10
prev=O1491
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O1486
fatherSonIndex=1
obj='Read
pag=10
rd_field=[
'PROV
]
rd_kfield=[
'SIGLA
]
rd_kvar=[
'Substr(xCF,12,4)
]
rd_var=[
'_prvnas
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1472
fatherSonIndex=1
frm_calc='rwTipo6.G19
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='_prvnas
obj='Var
pag=10
prev=O1503
var_op='asgn
I
obj='Var
pag=10
prev=O1502
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=10
prev=O1470
var_op='asgn
I
obj='Var
pag=10
prev=O1469
var_op='asgn
I
obj='Var
pag=10
prev=O1466
var_op='asgn
I
obj='Case
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1466
fatherSonIndex=0
frm_calc=''1'
len=1
name='xSesso
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1466
fatherSonIndex=1
frm_calc=''2'
len=1
name='xSesso
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1466
fatherSonIndex=2
frm_calc='rwTipo6.G45
len=1
name='xSesso
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
prev=O1314
var_op='asgn
I
obj='Var
pag=10
prev=O1313
var_op='asgn
I
obj='Read
pag=10
prev=O1312
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(rwTipo6.C41)
]
rd_var=[
'xConnes
]
I
obj='Var
pag=10
prev=O1311
var_op='asgn
I
obj='Remark
pag=10
prev=O1310
I
obj='Var
obj_type='N
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
var_op='asgn
x=18
y=23
I
Icpitembatch.CPBeginEnd
comment='Legge i dati dei clienti e li scrive
h=[
19
19
]
obj='Begin
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1520
fatherSonIndex=0
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPForEach
for_variable='rwTipo2
for_variable_type='tipo2_3
h=[
19
19
]
iterator_expr='mcTipo2
obj='ForEach
pag=7
prev=O1524
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1525
fatherSonIndex=0
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPRemark
frm_calc='Importa i soggetti delle operazioni
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(xConnes)),'S','N')
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwTipo2.C11)
len=16
name='xConnes
next=Icpitembatch.CPBeginEnd
comment='Calcola valori da salvare
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPIfElse
frm_calc=[
'xNewSog = 'N'
]
h=[
19
19
]
next=Icpitembatch.CPMerge
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'w_soloanag <> 'S'
]
h=[
19
19
]
obj='If
pag=7
prev=O1541
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O1542
fatherSonIndex=0
frm_calc=[
'_tipreg='O'
'_tipreg='T'
'_tipreg='R'
]
h=[
19
19
19
19
]
obj='Case
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1547
fatherSonIndex=0
frm_calc=[
'_conta=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1552
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O1557
fatherSonIndex=0
obj='Write
pag=7
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'LRTrim(rwTipo2.C11)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O1557
fatherSonIndex=1
obj='Write
pag=7
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'LRTrim(rwTipo2.C11)
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1552
fatherSonIndex=1
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='xlientiope
father=O1579
fatherSonIndex=0
obj='Merge
pag=7
rd_kfield=[
'IDFILEBO
'CODSOG
]
rd_kop=[
'=
'=
]
rd_kvar=[
'cOpeProg1
'LRTrim(rwTipo2.C11)
]
wr_field=[
'IDFILEBO
'IDBASE
'CODSOG
]
wr_mode=[
'ins
'ins
'ins/upd
]
wr_op=[
'=
'=
'=
]
wr_var=[
'cOpeProg1
'LibreriaMit.UniqueId()
'LRTrim(rwTipo2.C11)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='clientiope
father=O1579
fatherSonIndex=1
obj='Merge
pag=7
rd_kfield=[
'IDFILEBO
'CODSOG
]
rd_kop=[
'=
'=
]
rd_kvar=[
'cOpeProg1
'LRTrim(rwTipo2.C11)
]
wr_field=[
'IDFILEBO
'IDBASE
'CODSOG
]
wr_mode=[
'ins
'ins
'ins/upd
]
wr_op=[
'=
'=
'=
]
wr_var=[
'cOpeProg1
'LibreriaMit.UniqueId()
'LRTrim(rwTipo2.C11)
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1547
fatherSonIndex=1
frm_calc='rwTipo2.C11
len=16
name='xTitolare
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=7
prev=O1604
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xapotit
father=O1605
fatherSonIndex=0
obj='Write
pag=7
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cInfProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'LRTrim(rwTipo2.C11)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='rapotit
father=O1605
fatherSonIndex=1
obj='Write
pag=7
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cInfProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'LRTrim(rwTipo2.C11)
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1547
fatherSonIndex=2
frm_calc=[
'cDelega='N'
]
h=[
19
19
]
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='intestbo
father=O1627
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDBx))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A'
'xTipoInf='C'
'xTipoInf='P' or xTipoInf='D'
]
h=[
19
19
19
19
]
obj='If
pag=7
prev=O1633
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='intestbo
father=O1636
fatherSonIndex=0
obj='Merge
pag=7
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xRapporto)
'LRTrim(rwTipo2.C11)
]
wr_field=[
'RAPPORTO
'CODINTER
'IDBASE
'PRGIMPSOG
'CPROWNUM
'DATAINI
'NUMPROG1
'STATOREG
]
wr_mode=[
'ins
'ins
'ins
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xRapporto)
'LRTrim(rwTipo2.C11)
'LibreriaMit.UniqueId()
'nProgImp2
'cMaxRow
'_dataope
'cInfProg2
''0'
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='intestbo
father=O1636
fatherSonIndex=1
obj='Merge
pag=7
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xRapporto)
'LRTrim(rwTipo2.C11)
]
wr_field=[
'RAPPORTO
'CODINTER
'IDBASE
'CPROWNUM
'PRGIMPSOG
'DATAFINE
'NUMPROG2
'STATOREG
]
wr_mode=[
'ins
'ins
'ins
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xRapporto)
'LRTrim(rwTipo2.C11)
'LibreriaMit.UniqueId()
'cMaxRow
'nProgImp2
'_dataope
'cInfProg2
''0'
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='intestbo
father=O1636
fatherSonIndex=2
obj='Merge
pag=7
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xRapporto)
'LRTrim(rwTipo2.C11)
]
wr_field=[
'RAPPORTO
'CODINTER
'IDBASE
'CPROWNUM
'PRGIMPSOG
]
wr_mode=[
'ins
'ins
'ins
'ins
'ins
]
wr_op=[
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xRapporto)
'LRTrim(rwTipo2.C11)
'LibreriaMit.UniqueId()
'cMaxRow
'nProgImp2
]
I
I
]
w=[
150
150
150
150
]
I
obj='If
pag=7
prev=O1632
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1633
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=7
prev=O1672
var_op='asgn
I
obj='Select
pag=7
prev=O1671
sel_field='intestbo->CPROWNUM
sel_name='intestbo
sel_order='intestbo->CPROWNUM
sel_where='intestbo->RAPPORTO=xRapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1672
fatherSonIndex=0
frm_calc='intestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=7
prev=O1670
var_op='asgn
I
obj='Var
obj_type='N
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=7
rd_field=[
'CODINTER
'CPROWNUM
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'LRTrim(xRapporto)
'LRTrim(rwTipo2.C11)
]
rd_var=[
'xIDBx
'cMaxRow
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Merge
pag=7
prev=O1538
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(rwTipo2.C11)
]
wr_field=[
'CONNES
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'CODFISC
'DATANASC
'NASCOMUN
'NASSTATO
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'SESSO
'TIPOPERS
'CFESTERO
'TIPINTER
]
wr_mode=[
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(rwTipo2.C11)
'rwTipo2.D11
'rwTipo2.D14A
'rwTipo2.D13
'rwTipo2.D14B
'rwTipo2.D14C
'rwTipo2.D15
'rwTipo2.D16
'rwTipo2.D17
'rwTipo2.D18
'cCNAS
'cSNAS
'rwTipo2.D21
'rwTipo2.D22
'rwTipo2.D23
'xTD
'rwTipo2.D42
'rwTipo2.D43
'rwTipo2.D44
'xSesso
'cTipPer
'iif(Empty(rwTipo2.D17),1,0)
'_prvnas
]
I
obj='If
pag=7
prev=O1537
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1538
fatherSonIndex=0
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
obj='If
pag=7
prev=O1697
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1699
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=7
prev=O1704
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES =xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O1705
fatherSonIndex=0
obj='Insert
pag=7
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'datamodi
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
'DATAVARAGE
'SETTSINT2
'FATCA
'BANCABEN
'TIN
'ODB
'TELEF
'TIPOORO
'CODORO
'IDNASCOMUN
'IDNASSTATO
'NOTIT
]
rd_kvar=[
'cProgSto
'LRTrim(rwTipo2.C11)
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'_datareg
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
'personbo->DATAVARAGE
'personbo->SETTSINT2
'personbo->FATCA
'personbo->BANCABEN
'personbo->TIN
'personbo->ODB
'personbo->TELEF
'personbo->TIPOORO
'personbo->CODORO
'personbo->IDNASCOMUN
'personbo->IDNASSTATO
'personbo->NOTIT
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=7
prev=O1696
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=xConnes and wersonbo->datamodi=_datareg
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1697
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=7
prev=O1535
var_op='asgn
I
obj='Begin
pag=7
prev=O1534
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O1535
fatherSonIndex=0
frm_calc=[
'rwTipo2.D45='M'
'rwTipo2.D45='F'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_prvnas
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='rwTipo2.D19
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(rwTipo2.D17))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='rwTipo2.D41
len=2
name='xTD
next=Icpitembatch.CPIfElse
frm_calc=[
'At(xTD,'|01|02|03|04|05|06') = 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(xSesso),'G','P')
len=1
name='cTipPer
obj='Var
pag=7
prev=O1731
var_op='asgn
I
obj='If
pag=7
prev=O1730
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1731
fatherSonIndex=0
frm_calc='''
len=2
name='xTD
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=7
prev=O1727
var_op='asgn
I
obj='If
pag=7
prev=O1726
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1727
fatherSonIndex=0
frm_calc=[
'Substr(rwTipo2.D17,12,1) = 'Z' and Len(LRTrim(rwTipo2.D17))=16
'Substr(rwTipo2.D17,12,1) <> 'Z' and Len(LRTrim(rwTipo2.D17))=16
]
h=[
19
19
19
]
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1741
fatherSonIndex=0
frm_calc='rwTipo2.D19
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='_prvnas
obj='Var
pag=7
prev=O1747
var_op='asgn
I
obj='Var
pag=7
prev=O1746
var_op='asgn
I
obj='Var
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O1741
fatherSonIndex=1
obj='Read
pag=7
rd_field=[
'PROV
]
rd_kfield=[
'SIGLA
]
rd_kvar=[
'Substr(xCF,12,4)
]
rd_var=[
'_prvnas
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1727
fatherSonIndex=1
frm_calc='rwTipo2.D19
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='_prvnas
obj='Var
pag=7
prev=O1758
var_op='asgn
I
obj='Var
pag=7
prev=O1757
var_op='asgn
I
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=7
prev=O1725
var_op='asgn
I
obj='Var
pag=7
prev=O1724
var_op='asgn
I
obj='Var
pag=7
prev=O1721
var_op='asgn
I
obj='Case
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1721
fatherSonIndex=0
frm_calc=''1'
len=1
name='xSesso
obj='Var
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1721
fatherSonIndex=1
frm_calc=''2'
len=1
name='xSesso
obj='Var
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1721
fatherSonIndex=2
frm_calc='rwTipo2.D45
len=1
name='xSesso
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=7
prev=O1533
var_op='asgn
I
obj='Var
pag=7
prev=O1532
var_op='asgn
I
obj='Read
pag=7
prev=O1531
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(rwTipo2.C11)
]
rd_var=[
'xConnes
]
I
obj='Var
pag=7
prev=O1530
var_op='asgn
I
obj='Remark
pag=7
prev=O1529
I
obj='Var
obj_type='N
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
x=16
y=20
I
Icpitembatch.CPBeginEnd
comment='Legge i dati degli Esecutori e li scrive
h=[
19
19
]
obj='Begin
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1776
fatherSonIndex=0
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPForEach
for_variable='rwTipo4
for_variable_type='tipo4
h=[
19
19
]
iterator_expr='mcTipo4
obj='ForEach
pag=8
prev=O1780
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1781
fatherSonIndex=0
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPRemark
frm_calc='Importa i soggetti delle operazioni
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(xConnes)),'S','N')
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwTipo4.C21)
len=16
name='xConnes
next=Icpitembatch.CPBeginEnd
comment='Calcola valori da salvare
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPIfElse
frm_calc=[
'xNewSog = 'N'
]
h=[
19
19
]
next=Icpitembatch.CPMerge
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'w_soloanag <> 'S'
]
h=[
19
19
]
obj='If
pag=8
prev=O1797
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O1798
fatherSonIndex=0
frm_calc=[
'_tipreg='O'
'_tipreg='R'
]
h=[
19
19
19
]
obj='Case
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1803
fatherSonIndex=0
frm_calc=[
'_conta=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1808
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O1813
fatherSonIndex=0
obj='Write
pag=8
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'LRTrim(rwTipo4.C21)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O1813
fatherSonIndex=1
obj='Write
pag=8
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'LRTrim(rwTipo4.C21)
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1808
fatherSonIndex=1
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1835
fatherSonIndex=0
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='xogopebo
obj='Insert
pag=8
prev=O1843
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'cMaxRow
'LRTrim(rwTipo4.C21)
'LibreriaMit.UniqueId()
]
I
obj='Var
obj_type='N
pag=8
prev=O1841
var_op='asgn
I
obj='Select
pag=8
prev=O1840
sel_field='xogopebo->CPROWNUM
sel_name='xogopebo
sel_order='xogopebo->CPROWNUM
sel_where='xogopebo->IDFILEBO=cOpeProg1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1841
fatherSonIndex=0
frm_calc='xogopebo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1835
fatherSonIndex=1
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='sogopebo
obj='Insert
pag=8
prev=O1855
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'cMaxRow
'LRTrim(rwTipo4.C21)
'LibreriaMit.UniqueId()
]
I
obj='Var
obj_type='N
pag=8
prev=O1853
var_op='asgn
I
obj='Select
pag=8
prev=O1852
sel_field='sogopebo->CPROWNUM
sel_name='sogopebo
sel_order='sogopebo->CPROWNUM
sel_where='sogopebo->IDFILEBO=cOpeProg1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1853
fatherSonIndex=0
frm_calc='sogopebo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1803
fatherSonIndex=1
frm_calc=[
'cDelega='S'
]
h=[
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='delegabo
father=O1866
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDBx))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A'
'xTipoInf='C'
'xTipoInf='P' or xTipoInf='D'
]
h=[
19
19
19
19
]
obj='If
pag=8
prev=O1872
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='delegabo
father=O1875
fatherSonIndex=0
obj='Merge
pag=8
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xRapporto)
'LRTrim(rwTipo4.C21)
]
wr_field=[
'RAPPORTO
'CODINTER
'IDBASE
'CPROWNUM
'DATAINI
'NUMPROG1
'STATOREG
]
wr_mode=[
'ins
'ins
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xRapporto)
'LRTrim(rwTipo4.C21)
'LibreriaMit.UniqueId()
'cMaxRow
'_dataope
'cInfProg2
''0'
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='delegabo
father=O1875
fatherSonIndex=1
obj='Merge
pag=8
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xRapporto)
'LRTrim(rwTipo4.C21)
]
wr_field=[
'RAPPORTO
'CODINTER
'IDBASE
'CPROWNUM
'DATAFINE
'NUMPROG2
'STATOREG
]
wr_mode=[
'ins
'ins
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xRapporto)
'LRTrim(rwTipo4.C21)
'LibreriaMit.UniqueId()
'cMaxRow
'_dataope
'cInfProg2
''0'
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='delegabo
father=O1875
fatherSonIndex=2
obj='Merge
pag=8
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xRapporto)
'LRTrim(rwTipo4.C21)
]
wr_field=[
'RAPPORTO
'CODINTER
'IDBASE
'CPROWNUM
]
wr_mode=[
'ins
'ins
'ins
'ins
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xRapporto)
'LRTrim(rwTipo4.C21)
'LibreriaMit.UniqueId()
'cMaxRow
]
I
I
]
w=[
150
150
150
150
]
I
obj='If
pag=8
prev=O1871
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1872
fatherSonIndex=0
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=8
prev=O1910
var_op='asgn
I
obj='Select
pag=8
prev=O1909
sel_field='delegabo->CPROWNUM
sel_name='delegabo
sel_order='delegabo->CPROWNUM
sel_where='delegabo->RAPPORTO=xRapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1910
fatherSonIndex=0
frm_calc='delegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
rd_field=[
'CODINTER
'CPROWNUM
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'LRTrim(xRapporto)
'LRTrim(rwTipo4.C21)
]
rd_var=[
'xIDBx
'cMaxRow
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Merge
pag=8
prev=O1794
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(rwTipo4.C21)
]
wr_field=[
'CONNES
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'CODFISC
'DATANASC
'NASCOMUN
'NASSTATO
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'SESSO
'TIPOPERS
'CFESTERO
'TIPINTER
]
wr_mode=[
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(rwTipo4.C21)
'rwTipo4.E11
'rwTipo4.E14A
'rwTipo4.E13
'rwTipo4.E14B
'rwTipo4.E14C
'rwTipo4.E15
'rwTipo4.E16
'rwTipo4.E17
'rwTipo4.E18
'cCNAS
'cSNAS
'xTD
'rwTipo4.E42
'rwTipo4.E43
'rwTipo4.E44
'xSesso
'cTipPer
'iif(Empty(rwTipo4.E17),1,0)
'_prvnas
]
I
obj='If
pag=8
prev=O1793
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1794
fatherSonIndex=0
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
obj='If
pag=8
prev=O1935
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1937
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=8
prev=O1942
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES =xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O1943
fatherSonIndex=0
obj='Insert
pag=8
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'datamodi
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
'DATAVARAGE
'SETTSINT2
'FATCA
'BANCABEN
'TIN
'ODB
'TELEF
'TIPOORO
'CODORO
'IDNASCOMUN
'IDNASSTATO
'NOTIT
]
rd_kvar=[
'cProgSto
'LRTrim(rwTipo4.C21)
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'_datareg
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
'personbo->DATAVARAGE
'personbo->SETTSINT2
'personbo->FATCA
'personbo->BANCABEN
'personbo->TIN
'personbo->ODB
'personbo->TELEF
'personbo->TIPOORO
'personbo->CODORO
'personbo->IDNASCOMUN
'personbo->IDNASSTATO
'personbo->NOTIT
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=8
prev=O1934
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=xConnes and wersonbo->datamodi=_datareg
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1935
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
prev=O1791
var_op='asgn
I
obj='Begin
pag=8
prev=O1790
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O1791
fatherSonIndex=0
frm_calc=[
'rwTipo4.E45='M'
'rwTipo4.E45='F'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_prvnas
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='rwTipo4.E19
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(rwTipo4.E17))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='rwTipo4.E41
len=2
name='xTD
next=Icpitembatch.CPIfElse
frm_calc=[
'At(xTD,'|01|02|03|04|05|06') = 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(xSesso),'G','P')
len=1
name='cTipPer
obj='Var
pag=8
prev=O1969
var_op='asgn
I
obj='If
pag=8
prev=O1968
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1969
fatherSonIndex=0
frm_calc='''
len=2
name='xTD
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
prev=O1965
var_op='asgn
I
obj='If
pag=8
prev=O1964
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1965
fatherSonIndex=0
frm_calc=[
'Substr(rwTipo4.E17,12,1) = 'Z' and Len(LRTrim(rwTipo4.E17))=16
'Substr(rwTipo4.E17,12,1) <> 'Z' and Len(LRTrim(rwTipo4.E17))=16
]
h=[
19
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1979
fatherSonIndex=0
frm_calc='rwTipo4.E19
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='_prvnas
obj='Var
pag=8
prev=O1985
var_op='asgn
I
obj='Var
pag=8
prev=O1984
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O1979
fatherSonIndex=1
obj='Read
pag=8
rd_field=[
'PROV
]
rd_kfield=[
'SIGLA
]
rd_kvar=[
'Substr(xCF,12,4)
]
rd_var=[
'_prvnas
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1965
fatherSonIndex=1
frm_calc='rwTipo4.E19
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='_prvnas
obj='Var
pag=8
prev=O1996
var_op='asgn
I
obj='Var
pag=8
prev=O1995
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=8
prev=O1963
var_op='asgn
I
obj='Var
pag=8
prev=O1962
var_op='asgn
I
obj='Var
pag=8
prev=O1959
var_op='asgn
I
obj='Case
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1959
fatherSonIndex=0
frm_calc=''1'
len=1
name='xSesso
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1959
fatherSonIndex=1
frm_calc=''2'
len=1
name='xSesso
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1959
fatherSonIndex=2
frm_calc='rwTipo4.E45
len=1
name='xSesso
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
prev=O1789
var_op='asgn
I
obj='Var
pag=8
prev=O1788
var_op='asgn
I
obj='Read
pag=8
prev=O1787
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(rwTipo4.C21)
]
rd_var=[
'xConnes
]
I
obj='Var
pag=8
prev=O1786
var_op='asgn
I
obj='Remark
pag=8
prev=O1785
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
x=15
y=19
I
Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPForEach
for_variable='rwTipo9
for_variable_type='tipo9
h=[
19
19
]
iterator_expr='mcTipo9
obj='ForEach
pag=13
prev=O2014
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2015
fatherSonIndex=0
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPRemark
frm_calc='Importa i soggetti delle operazioni
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(xConnes)),'S','N')
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rwTipo9.C51)
len=16
name='xConnes
next=Icpitembatch.CPBeginEnd
comment='Calcola valori da salvare
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPIfElse
frm_calc=[
'xNewSog = 'N'
]
h=[
19
19
]
next=Icpitembatch.CPMerge
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'w_soloanag <> 'S'
]
h=[
19
19
]
obj='If
pag=13
prev=O2031
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O2032
fatherSonIndex=0
frm_calc=[
'_tipreg='T'
'_tipreg='R'
'_tipreg='O'
]
h=[
19
19
19
19
]
obj='Case
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='intestit
father=O2037
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDBx))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A'
'xTipoInf='C'
'xTipoInf='P' or xTipoInf='D'
]
h=[
19
19
19
19
]
obj='If
pag=13
prev=O2043
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='intestit
father=O2046
fatherSonIndex=0
obj='Merge
pag=13
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xTitolare)
'LRTrim(rwTipo9.C51)
]
wr_field=[
'CODCLI
'CODINTER
'IDBASE
'DATAINI
'NUMPROG1
'STATOREG
'PRGIMPTITE
]
wr_mode=[
'ins
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
'ins
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xTitolare)
'LRTrim(rwTipo9.C51)
'LibreriaMit.UniqueId()
'_dataope
'cInfProg2
''0'
'nProgImp2
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='intestit
father=O2046
fatherSonIndex=1
obj='Merge
pag=13
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xTitolare)
'LRTrim(rwTipo9.C51)
]
wr_field=[
'CODCLI
'CODINTER
'IDBASE
'DATAFINE
'NUMPROG2
'STATOREG
'PRGIMPTITE
]
wr_mode=[
'ins
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
'ins
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xTitolare)
'LRTrim(rwTipo9.C51)
'LibreriaMit.UniqueId()
'_dataope
'cInfProg2
''0'
'nProgImp2
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='intestit
father=O2046
fatherSonIndex=2
obj='Merge
pag=13
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xTitolare)
'LRTrim(rwTipo9.C51)
]
wr_field=[
'CODCLI
'CODINTER
'IDBASE
'PRGIMPTITE
]
wr_mode=[
'ins
'ins
'ins
'ins
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xTitolare)
'LRTrim(rwTipo9.C51)
'LibreriaMit.UniqueId()
'nProgImp2
]
I
I
]
w=[
150
150
150
150
]
I
obj='If
pag=13
prev=O2042
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2043
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
obj='Var
obj_type='N
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
rd_field=[
'CODINTER
]
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kvar=[
'LRTrim(xTitolare)
'LRTrim(rwTipo9.C51)
]
rd_var=[
'xIDBx
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='fiduciabo
father=O2037
fatherSonIndex=1
obj='Merge
pag=13
rd_kfield=[
'IDFILEBO
'CODSOG
]
rd_kop=[
'=
'=
]
rd_kvar=[
'cInfProg1
'LRTrim(rwTipo9.C51)
]
wr_field=[
'IDFILEBO
'CODSOG
'RAPCOL
'IDBASE
]
wr_mode=[
'ins
'ins
'ins
'ins
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'cInfProg1
'LRTrim(rwTipo9.C51)
'xRapporto
'LibreriaMit.UniqueId()
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2037
fatherSonIndex=2
frm_calc=[
'_conta=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2096
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O2101
fatherSonIndex=0
obj='Write
pag=13
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNALTRO
]
wr_op=[
'=
]
wr_var=[
'LRTrim(rwTipo9.C51)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O2101
fatherSonIndex=1
obj='Write
pag=13
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNALTRO
]
wr_op=[
'=
]
wr_var=[
'LRTrim(rwTipo9.C51)
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2096
fatherSonIndex=1
frm_calc=[
'_A54A='3'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='merzistiope
father=O2123
fatherSonIndex=0
obj='Insert
pag=13
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'LRTrim(rwTipo9.C51)
'LibreriaMit.UniqueId()
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2123
fatherSonIndex=1
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xerzistiope
father=O2132
fatherSonIndex=0
obj='Insert
pag=13
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'LRTrim(rwTipo9.C51)
'LibreriaMit.UniqueId()
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistiope
father=O2132
fatherSonIndex=1
obj='Insert
pag=13
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'LRTrim(rwTipo9.C51)
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Merge
pag=13
prev=O2028
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(rwTipo9.C51)
]
wr_field=[
'CONNES
'RAGSOC
'PAESE
'CODCAB
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'CODFISC
'DATANASC
'NASCOMUN
'NASSTATO
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'SESSO
'TIPOPERS
'CFESTERO
'TIPINTER
]
wr_mode=[
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(rwTipo9.C51)
'rwTipo9.H11
'rwTipo9.H13
'rwTipo9.H14A
'rwTipo9.H14B
'rwTipo9.H14C
'rwTipo9.H15
'rwTipo9.H16
'rwTipo9.H17
'rwTipo9.H18
'cCNAS
'cSNAS
'xTD
'rwTipo9.H42
'rwTipo9.H43
'rwTipo9.H44
'xSesso
'cTipPer
'iif(Empty(rwTipo9.H17),1,0)
'_prvnas
]
I
obj='If
pag=13
prev=O2027
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2028
fatherSonIndex=0
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
obj='If
pag=13
prev=O2159
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2161
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=13
prev=O2166
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES =xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O2167
fatherSonIndex=0
obj='Insert
pag=13
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'datamodi
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
'DATAVARAGE
'SETTSINT2
'FATCA
'BANCABEN
'TIN
'ODB
'TELEF
'TIPOORO
'CODORO
'IDNASCOMUN
'IDNASSTATO
'NOTIT
]
rd_kvar=[
'cProgSto
'LRTrim(rwTipo9.C51)
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'_datareg
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
'personbo->DATAVARAGE
'personbo->SETTSINT2
'personbo->FATCA
'personbo->BANCABEN
'personbo->TIN
'personbo->ODB
'personbo->TELEF
'personbo->TIPOORO
'personbo->CODORO
'personbo->IDNASCOMUN
'personbo->IDNASSTATO
'personbo->NOTIT
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=13
prev=O2158
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=xConnes and wersonbo->datamodi=_datareg
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2159
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=13
prev=O2025
var_op='asgn
I
obj='Begin
pag=13
prev=O2024
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O2025
fatherSonIndex=0
frm_calc=[
'rwTipo9.H45='M'
'rwTipo9.H45='F'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_prvnas
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='rwTipo9.H19
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(rwTipo9.H17))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='rwTipo9.H41
len=2
name='xTD
next=Icpitembatch.CPIfElse
frm_calc=[
'At(xTD,'|01|02|03|04|05|06') = 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(xSesso),'G','P')
len=1
name='cTipPer
obj='Var
pag=13
prev=O2193
var_op='asgn
I
obj='If
pag=13
prev=O2192
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2193
fatherSonIndex=0
frm_calc='''
len=2
name='xTD
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
prev=O2189
var_op='asgn
I
obj='If
pag=13
prev=O2188
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2189
fatherSonIndex=0
frm_calc=[
'Substr(rwTipo9.H17,12,1) = 'Z' and Len(LRTrim(rwTipo9.H17))=16
'Substr(rwTipo9.H17,12,1) <> 'Z' and Len(LRTrim(rwTipo9.H17))=16
]
h=[
19
19
19
]
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2203
fatherSonIndex=0
frm_calc='rwTipo9.H19
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='_prvnas
obj='Var
pag=13
prev=O2209
var_op='asgn
I
obj='Var
pag=13
prev=O2208
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O2203
fatherSonIndex=1
obj='Read
pag=13
rd_field=[
'PROV
]
rd_kfield=[
'SIGLA
]
rd_kvar=[
'Substr(xCF,12,4)
]
rd_var=[
'_prvnas
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2189
fatherSonIndex=1
frm_calc='rwTipo9.H19
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='_prvnas
obj='Var
pag=13
prev=O2220
var_op='asgn
I
obj='Var
pag=13
prev=O2219
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=13
prev=O2187
var_op='asgn
I
obj='Var
pag=13
prev=O2186
var_op='asgn
I
obj='Var
pag=13
prev=O2183
var_op='asgn
I
obj='Case
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2183
fatherSonIndex=0
frm_calc=''1'
len=1
name='xSesso
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2183
fatherSonIndex=1
frm_calc=''2'
len=1
name='xSesso
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2183
fatherSonIndex=2
frm_calc='rwTipo9.H45
len=1
name='xSesso
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
prev=O2023
var_op='asgn
I
obj='Var
pag=13
prev=O2022
var_op='asgn
I
obj='Read
pag=13
prev=O2021
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(rwTipo9.C51)
]
rd_var=[
'xConnes
]
I
obj='Var
pag=13
prev=O2020
var_op='asgn
I
obj='Remark
pag=13
prev=O2019
I
obj='Var
obj_type='N
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=13
var_op='asgn
x=14
y=19
I
Icpitembatch.CPBeginEnd
comment='Legge l'operazione e scrive i dati
h=[
19
19
]
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2237
fatherSonIndex=0
frm_calc=[
'w_soloanag <> 'S'
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='page
frm_calc='7
next=Icpitembatch.CPExec
check='page
frm_calc='11
next=Icpitembatch.CPExec
check='page
frm_calc='8
next=Icpitembatch.CPExec
check='page
frm_calc='12
next=Icpitembatch.CPExec
check='page
frm_calc='13
obj='Exec
pag=5
prev=O2247
I
obj='Exec
pag=5
prev=O2246
I
obj='Exec
pag=5
prev=O2245
I
obj='Exec
pag=5
prev=O2244
I
obj='Exec
pag=5
prev=O2241
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O2241
fatherSonIndex=0
for_variable='rwTipo1
for_variable_type='tipo1
h=[
19
19
]
iterator_expr='mcTipo1
obj='ForEach
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O2251
fatherSonIndex=0
frm_calc='Importa i dati base delle operazioni
next=Icpitembatch.CPVarDecl
comment='Contatore Operazioni
frm_calc='cNumInf + 1
len=10
name='cNumInf
next=Icpitembatch.CPVarDecl
frm_calc='rwTipo1.A21
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
frm_calc='rwTipo1.A51
len=8
name='_datareg
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O2258
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2259
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGPINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(iif(rwTipo1.A41 <> '00000000000000000000000000',rwTipo1.A41,Space(25)))
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='iif(rwTipo1.A41 <> '00000000000000000000000000',rwTipo1.A42,Space(1))
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
frm_calc='iif(rwTipo1.A54A='2','2',iif(rwTipo1.A54A='0','S','A'))
len=1
name='streg
next=Icpitembatch.CPVarDecl
frm_calc='rwTipo1.A11
len=6
name='xDIP
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xDIP)))
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Inserisce Rapporto
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xapopebo
h=[
19
19
]
obj='Insert
pag=5
prev=O2274
rd_kfield=[
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPERAZMOD
'OPRAP
'PAESE
'PRGIMPINF
'PROV2
'PROVINCIA
'RAPPORTO
'SEGNO
'STATOREG
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
]
rd_kvar=[
'DateToChar(rwTipo1.A21)
'DateToChar(rwTipo1.A51)
'rwTipo1.A24
'rwTipo1.A12A
'rwTipo1.A33A
'rwTipo1.A11
'rwTipo1.A31B
'rwTipo1.A01B
'rwTipo1.A25
'rwTipo1.A53
'rwTipo1.A21
'rwTipo1.A51
'rwTipo1.A54B
'rwTipo1.A33B
'rwTipo1.A12B
'rwTipo1.A34
'rwTipo1.A23
'rwTipo1.A22
'rwTipo1.B11
'xTipRap
'cInfProg1
'rwTipo1.A03
'cInfProg2
'rwTipo1.A54C
'Left(rwTipo1.A52,1)
'rwTipo1.A32
'nProgImp
'rwTipo1.A33C
'rwTipo1.A12C
'LRTrim(xRapporto)
'rwTipo1.B13
'rwTipo1.A54A
''1'
'rwTipo1.A31A
'rwTipo1.A01A
'rwTipo1.A43
'rwTipo1.A52
'rwTipo1.B15
'rwTipo1.B14
'rwTipo1.B12
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2276
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+w_nomefile+" per l'informazione in data "+Substr(riga,79,8)+" relativa al legame: "+xRapporto+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=5
prev=O2282
I
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Begin
pag=5
prev=O2271
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2274
fatherSonIndex=0
frm_calc='''
len=25
name='xAppRap
next=Icpitembatch.CPRead
arch='xnarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xAppRap))
]
h=[
19
19
]
obj='If
pag=5
prev=O2288
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Rapporti
father=O2289
fatherSonIndex=0
frm_calc='cNumRap + 1
len=10
name='cNumRap
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgRap
next=Icpitembatch.CPInsert
arch='xnarapbo
next=Icpitembatch.CPMerge
arch='knarapbo
obj='Merge
pag=5
prev=O2296
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(xRapporto)
]
wr_field=[
'RAPPORTO
'TIPORAP
]
wr_mode=[
'ins
'ins/upd
]
wr_op=[
'=
'=
]
wr_var=[
'LRTrim(xRapporto)
''P'
]
I
obj='Insert
pag=5
prev=O2295
rd_kfield=[
'RAPPORTO
'TIPORAP
'FLAGLIRE
'VALUTA
'PRGIMPRAP
]
rd_kvar=[
'LRTrim(xRapporto)
'rwTipo1.A42
'iif(rwTipo1.B11='1','L',iif(rwTipo1.B11='2','V','E'))
'rwTipo1.B12
'nProgRap
]
I
obj='Var
obj_type='N
pag=5
prev=O2294
var_op='asgn
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O2287
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'xRapporto
]
rd_var=[
'xAppRap
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O2270
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='anadip
father=O2271
fatherSonIndex=0
obj='Merge
pag=5
rd_kfield=[
'CODDIP
]
rd_kop=[
'=
]
rd_kvar=[
'xDIP
]
wr_field=[
'CODDIP
'DESCRIZ
'CAB
'DESCCIT
'PROVINCIA
]
wr_mode=[
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
]
wr_var=[
'xDIP
'xDIP
'rwTipo1.A12A
'rwTipo1.A12B
'rwTipo1.A12C
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O2269
var_op='asgn
I
obj='Var
pag=5
prev=O2268
var_op='asgn
I
obj='Var
pag=5
prev=O2267
var_op='asgn
I
obj='Var
pag=5
prev=O2266
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O2265
var_op='asgn
I
obj='Var
pag=5
prev=O2264
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2259
fatherSonIndex=1
frm_calc=[
'xTipoInf <> 'X'
]
h=[
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2325
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(iif(rwTipo1.A41 <> '00000000000000000000000000',rwTipo1.A41,Space(25)))
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='iif(rwTipo1.A41 <> '00000000000000000000000000',rwTipo1.A42,Space(1))
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
frm_calc='iif(At(_A52,"|25|28|39|40|41|47")>0,"S","N")
len=1
name='cDelega
next=Icpitembatch.CPVarDecl
frm_calc='iif(rwTipo1.A54A='2','2',iif(rwTipo1.A54A='0','S','A'))
len=1
name='streg
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
frm_calc='rwTipo1.A11
len=6
name='xDIP
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xDIP)))
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Inserisce Rapporto
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='rapopebo
h=[
19
19
]
obj='Insert
pag=5
prev=O2343
rd_kfield=[
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPERAZMOD
'OPRAP
'PAESE
'PRGIMPINF
'PROV2
'PROVINCIA
'RAPPORTO
'SEGNO
'STATOREG
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
]
rd_kvar=[
'DateToChar(rwTipo1.A21)
'DateToChar(rwTipo1.A51)
'rwTipo1.A24
'rwTipo1.A12A
'rwTipo1.A33A
'rwTipo1.A11
'rwTipo1.A31B
'rwTipo1.A01B
'rwTipo1.A25
'rwTipo1.A53
'rwTipo1.A21
'rwTipo1.A51
'rwTipo1.A54B
'rwTipo1.A33B
'rwTipo1.A12B
'rwTipo1.A34
'rwTipo1.A23
'rwTipo1.A22
'rwTipo1.B11
'xTipRap
'cInfProg1
'rwTipo1.A03
'cInfProg2
'rwTipo1.A54C
'Left(rwTipo1.A52,1)
'rwTipo1.A32
'nProgImp
'rwTipo1.A33C
'rwTipo1.A12C
'LRTrim(xRapporto)
'rwTipo1.B13
'rwTipo1.A54A
''1'
'rwTipo1.A31A
'rwTipo1.A01A
'rwTipo1.A43
'rwTipo1.A52
'rwTipo1.B15
'rwTipo1.B14
'rwTipo1.B12
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2345
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+w_nomefile+" per l'informazione in data "+Substr(riga,79,8)+" relativa al legame: "+xRapporto+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=5
prev=O2351
I
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Begin
pag=5
prev=O2340
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2343
fatherSonIndex=0
frm_calc='''
len=25
name='xAppRap
next=Icpitembatch.CPRead
arch='anarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xAppRap))
]
h=[
19
19
]
obj='If
pag=5
prev=O2357
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Rapporti
father=O2358
fatherSonIndex=0
frm_calc='cNumRap + 1
len=10
name='cNumRap
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgRap
next=Icpitembatch.CPInsert
arch='anarapbo
next=Icpitembatch.CPMerge
arch='knarapbo
obj='Merge
pag=5
prev=O2365
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(xRapporto)
]
wr_field=[
'RAPPORTO
'TIPORAP
]
wr_mode=[
'ins
'ins/upd
]
wr_op=[
'=
'=
]
wr_var=[
'LRTrim(xRapporto)
''D'
]
I
obj='Insert
pag=5
prev=O2364
rd_kfield=[
'RAPPORTO
'TIPORAP
'FLAGLIRE
'VALUTA
'PRGIMPRAP
]
rd_kvar=[
'LRTrim(xRapporto)
'rwTipo1.A42
'iif(rwTipo1.B11='1','L',iif(rwTipo1.B11='2','V','E'))
'rwTipo1.B12
'nProgRap
]
I
obj='Var
obj_type='N
pag=5
prev=O2363
var_op='asgn
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O2356
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'LRTrim(xRapporto)
]
rd_var=[
'xAppRap
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O2339
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anadip
father=O2340
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDIPx))
]
h=[
19
19
]
obj='If
pag=5
prev=O2384
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anadip
father=O2385
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'CODDIP
'DESCRIZ
]
rd_kvar=[
'xDIP
'xDIP
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'xDIP
]
rd_var=[
'xDIPx
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O2338
var_op='asgn
I
obj='Var
pag=5
prev=O2337
var_op='asgn
I
obj='Var
pag=5
prev=O2336
var_op='asgn
I
obj='Var
pag=5
prev=O2335
var_op='asgn
I
obj='Var
pag=5
prev=O2334
var_op='asgn
I
obj='Var
pag=5
prev=O2333
var_op='asgn
I
obj='Var
pag=5
prev=O2332
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O2331
var_op='asgn
I
obj='Var
pag=5
prev=O2330
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='D
pag=5
prev=O2257
var_op='asgn
I
obj='Var
obj_type='D
pag=5
prev=O2256
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O2255
var_op='asgn
I
obj='Remark
pag=5
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
x=9
y=16
I
]
ManualBlocks={
'BO - Properties
Icpmanualblocks.CPManualBlocks
code='public String[] lista;﷯public int conteggio;﷯public int i;﷯public int contanome;
name='BO - Properties
I
}
comment='Import Scarico OffLINE
date_creat=#2006-06-20
date_rev=#2024-06-04
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'Utilities
'FileLibrary
'ZipMit
'LibreriaMit
]
modcnt=729
page_result_class=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
page_result_type=[
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
]
page_uid=[
'PNDQUWMYPW
'OZVSRIJYBW
'XAUBHYXNYZ
'GLMUNJUINL
'MNJRQSMUBH
'DFJGSTFKAX
'HMGLAKVXYF
'WRFDGTBRRV
'FHVLNWUPJM
'TZZLUKJCKW
'PORPTZXDSZ
'YROOFGPMWJ
'SBITSWHOGJ
'CBWHJBELRD
]
pagename=[
'Page_1
'Page_2
'Page_3
'OperazioniBase
'RapportiBase
'TitolariBase
'Tipo2_3
'Tipo4
'Tipo5
'Tipo6
'Tipo7
'Tipo8
'Tipo9
'ChkOper
]
pagenote=[
'
'Estrae i dati dal file zip
'Tronca la tabella passata come parametro
'Scrive i dati dell'operazione
'Scrive i dati base del rapporto
'Scrive i dati base dei titolari
'
'
'
'
'
'
'
'
]
pagetitle=[
'Main
'Estrae file da Zip
'Truncate tabella
'Operazioni (Base)
'Rapporti (Base)
'Titolari (Base)
'Tipo 2/3 (Clienti pre 2014)
'Tipo 4 (Esecutore pre 2014)
'Tipo 5 (Controparte)
'Tipo 6 (Titolare operazione/legame)
'Tipo 7 (Clienti post 2013)
'Tipo 8 (Esecutori post 2013)
'Tipo 9 (Altri soggetti)
'Controllo Operazione
]
runtime_filters=2
tpl_name='Function
work_file=[
'anarapbo
'contatori
'cpwarn
'delegabo
'fiduciabo
'garantbo
'intestbo
'intestit
'operazbo
'personbo
'personbo_agg
'rapopebo
'rapotit
'soginfo
'l_tipo1
'l_tipo23
'l_tipo4
'l_tipo5
'l_tipo6
'l_tipo7
'l_tipo8
'l_tipo9
'tmp_anarapbo
'tmp_intestbo_ol
'tmp_operazbo_ol
'tmp_rapopebo_ol
'tmp_stp_imp_err
'wersonbo
'xapopebo
'xapotit
'xarantbo
'xelegabo
'xiduciabo
'xnarapbo
'xntestbo
'xntestit
'xoginfo
'xperazbo
'anadip
'tbcauana
'tbcitta
'xlientiope
'clientiope
'sogopebo
'xogopebo
'xeneficope
'beneficope
'meneficope
'xerzistiope
'terzistiope
'merzistiope
'knarapbo
'sogopefbo
'xogopefbo
]
work_filter=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
I
*--*
*----*
