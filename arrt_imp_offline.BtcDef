* --- CodePainter Revolution Batch Vers. 5.1
￼Icpbatch.CPBatch
Items=[
Icpitembatch.CPBeginEnd
comment='Definizione parametri
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili Locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili globali
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Import Soggetti
next=Icpitembatch.CPVarDecl
frm_calc='''
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPRemark
frm_calc='Cicla sul file della lista e lancia la pagina appropriata
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_esito
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibrary.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibrary.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+w_nomefile)
obj='Exec
pag=1
prev=O16
I
obj='Exec
pag=1
prev=O14
I
obj='Try
pag=1
prev=O13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Import Dati
father=O14
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=1
prev=O20
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Azzeramento archivi se richiesto
father=O20
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Contatore Operazioni
frm_calc='0
len=10
name='cNumOpe
next=Icpitembatch.CPVarDecl
comment='Contatore Rapporti
frm_calc='0
len=10
name='cNumRap
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='0
len=10
name='cNumPer
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='0
len=10
name='cNumInf
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='0
len=10
name='cNumTit
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + w_nomefile + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'At('.zip',Lower(w_nomefile)) <> 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPBeginEnd
comment='Verifica charset del file e lo apre
h=[
19
19
]
next=Icpitembatch.CPCase
frm_calc=[
'w_tipoimp='M' or w_tipoimp='R'
'w_tipoimp='S'
]
h=[
19
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Messaggi finali
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Soggetti Inseriti/Aggiornati: '+LRTrim(Str(cNumPer,10,0)) + ' dal file '+w_nomefile+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Rapporti Inseriti: '+LRTrim(Str(cNumRap,10,0)) + ' dal file '+w_nomefile+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Informazioni Inserite: '+LRTrim(Str(cNumInf,10,0)) + ' dal file '+w_nomefile+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Inserite: '+LRTrim(Str(cNumOpe,10,0)) + ' dal file '+w_nomefile+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Titolari Inseriti: '+LRTrim(Str(cNumTit,10,0)) + ' dal file '+w_nomefile+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +w_nomefile + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione dati. Inizio fase di commit. Attendere prego...'
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Importazione dati terminata.'
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O48
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O47
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O46
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O45
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O44
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O43
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O42
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O41
var_op='asgn
I
obj='Remark
pag=1
prev=O38
I
obj='Case
pag=1
prev=O36
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPDropTemporaryTable
father=O38
fatherSonIndex=0
next=Icpitembatch.CPDropTemporaryTable
next=Icpitembatch.CPDropTemporaryTable
next=Icpitembatch.CPDropTemporaryTable
next=Icpitembatch.CPServerTemporaryTable
next=Icpitembatch.CPServerTemporaryTable
next=Icpitembatch.CPServerTemporaryTable
next=Icpitembatch.CPServerTemporaryTable
next=Icpitembatch.CPWhile
frm_calc='not(FileLibrary.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipoimp = 'M'
'w_tipoimp = 'R'
]
h=[
19
19
19
]
obj='If
pag=1
prev=O60
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='tmp_operazbo_ol
father=O62
fatherSonIndex=0
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='tmp_rapopebo_ol
next=Icpitembatch.CPWrite
arch='tmp_rapopebo_ol
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='tmp_rapopebo_ol
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='tmp_rapopebo_ol
next=Icpitembatch.CPInsert
arch='xnarapbo
next=Icpitembatch.CPInsert
arch='xapopebo
next=Icpitembatch.CPInsert
arch='xntestbo
obj='Insert
pag=1
prev=O79
sel_field='*
sel_name='tmp_intestbo_ol
sel_type='sql
I
obj='Insert
pag=1
prev=O78
sel_field='*
sel_name='tmp_rapopebo_ol
sel_type='sql
I
obj='Insert
pag=1
prev=O77
sel_field='*
sel_name='tmp_anarapbo
sel_type='sql
I
obj='Write
pag=1
prev=O75
rd_kfield=[
'TIPOOPRAP
]
rd_kop=[
'=
]
rd_kvar=[
''46'
]
wr_field=[
'TIPOOPRAP
]
wr_op=[
'=
]
wr_var=[
''45'
]
I
obj='Select
pag=1
prev=O74
sel_field='tmp_rapopebo_ol->RAPPORTO,tmp_rapopebo_ol->IDBASE,tmp_rapopebo_ol->DATAOPE,tmp_rapopebo_ol->NUMPROG
sel_name='tmp_rapopebo_ol
sel_where='tmp_rapopebo_ol->TIPOOPRAP='46'
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tmp_intestbo_ol
father=O75
fatherSonIndex=0
obj='Write
pag=1
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'tmp_rapopebo_ol->RAPPORTO
]
wr_field=[
'DATAINI
'DATAFINE
'NUMPROG1
'NUMPROG2
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'tmp_rapopebo_ol->DATAOPE
'NullDate()
'tmp_rapopebo_ol->NUMPROG
'''
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=1
prev=O72
rd_kfield=[
'TIPOOPRAP
]
rd_kop=[
'=
]
rd_kvar=[
''36'
]
wr_field=[
'TIPOOPRAP
]
wr_op=[
'=
]
wr_var=[
''35'
]
I
obj='Select
pag=1
prev=O71
sel_field='tmp_rapopebo_ol->RAPPORTO,tmp_rapopebo_ol->IDBASE,tmp_rapopebo_ol->DATAOPE,tmp_rapopebo_ol->NUMPROG
sel_name='tmp_rapopebo_ol
sel_where='tmp_rapopebo_ol->TIPOOPRAP='36'
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tmp_intestbo_ol
father=O72
fatherSonIndex=0
obj='Write
pag=1
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'tmp_rapopebo_ol->RAPPORTO
]
wr_field=[
'DATAINI
'DATAFINE
'NUMPROG1
'NUMPROG2
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'tmp_rapopebo_ol->DATAOPE
'NullDate()
'tmp_rapopebo_ol->NUMPROG
'''
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=1
prev=O70
rd_kfield=[
'TIPOOPRAP
]
rd_kop=[
'=
]
rd_kvar=[
''28'
]
wr_field=[
'TIPOOPRAP
]
wr_op=[
'=
]
wr_var=[
''25'
]
I
obj='Delete
pag=1
prev=O68
rd_kfield=[
'TIPOOPRAP
'TIPOOPRAP
'TIPOOPRAP
]
rd_kop=[
'<>
'<>
'<>
]
rd_kvar=[
''28'
''36'
''46'
]
I
obj='Select
pag=1
prev=O67
sel_field='*
sel_name='tmp_rapopebo_ol
sel_where='tmp_rapopebo_ol->TIPOOPRAP='26'
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='tmp_intestbo_ol
father=O68
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='tmp_rapopebo_ol
next=Icpitembatch.CPDelete
arch='tmp_anarapbo
obj='Delete
pag=1
prev=O125
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'tmp_rapopebo_ol->RAPPORTO
]
I
obj='Delete
pag=1
prev=O124
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'tmp_rapopebo_ol->RAPPORTO
]
I
obj='Delete
pag=1
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'tmp_rapopebo_ol->RAPPORTO
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=1
rd_kfield=[
'1
]
rd_kop=[
'=
]
rd_kvar=[
'1
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='tmp_rapopebo_ol
father=O62
fatherSonIndex=1
next=Icpitembatch.CPDelete
arch='tmp_rapopebo_ol
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=1
prev=O142
sel_field='*
sel_name='tmp_operazbo_ol
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O143
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xperazbo
father=O147
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'IDBASE
'NUMPROG
'DATAOPE
'TIPOINTER
'CODINTER
'TIPOINF
'IDEREG
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'OPRAP
'TIPOOPRAP
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'STATOREG
'OPERAZMOD
'DATARETT
'CONNESCLI
'CONNESOPER
'CONNESBEN
'COLLEG
'CAMBIO
'RAPPORTBEN
'FLAGRAP2
'OPERATORE
'AUTOM
'idcauana
'OPERAG
'DOCFILE
'RESPINS
'INFORM
'CDATOPE
'NOPROT
'UCODE
'CDATAOPE
'ZCPARTE
'RAGIO
'MODSVOL
'AREAGEO
'RIFIMP
'SCOPO
'NATURA
'RTIPO
'RCOMP
'RIMP
'RFREQ
'RRAGIO
'RAREA
'TIPO
'PRGIMPOPE
'UNIQUECODE
'AMMONT
'DURAT
'CONNALTRO
'CONNESDOC
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'DATAIMP
'C_RAPPORTO
'PAGASOGOP
'MTCN
'IDFILE
'CDATREG
]
rd_kvar=[
'tmp_operazbo_ol->IDBASE
'tmp_operazbo_ol->NUMPROG
'tmp_operazbo_ol->DATAOPE
'tmp_operazbo_ol->TIPOINTER
'tmp_operazbo_ol->CODINTER
'tmp_operazbo_ol->TIPOINF
'tmp_operazbo_ol->IDEREG
'tmp_operazbo_ol->CODDIPE
'tmp_operazbo_ol->DESCCIT
'tmp_operazbo_ol->PROVINCIA
'tmp_operazbo_ol->CODCAB
'tmp_operazbo_ol->FLAGFRAZ
'tmp_operazbo_ol->FLAGCONT
'tmp_operazbo_ol->CODANA
'tmp_operazbo_ol->CODVOC
'tmp_operazbo_ol->TIPOINT2
'tmp_operazbo_ol->CODINT2
'tmp_operazbo_ol->PAESE
'tmp_operazbo_ol->DESC2
'tmp_operazbo_ol->PROV2
'tmp_operazbo_ol->CODCAB2
'tmp_operazbo_ol->DESCINTER
'tmp_operazbo_ol->RAPPORTO
'tmp_operazbo_ol->FLAGRAP
'tmp_operazbo_ol->TIPOLEG
'Date()
'tmp_operazbo_ol->OPRAP
'tmp_operazbo_ol->TIPOOPRAP
'tmp_operazbo_ol->FLAGLIRE
'tmp_operazbo_ol->VALUTA
'tmp_operazbo_ol->SEGNO
'tmp_operazbo_ol->TOTLIRE
'tmp_operazbo_ol->TOTCONT
'tmp_operazbo_ol->STATOREG
'tmp_operazbo_ol->OPERAZMOD
'tmp_operazbo_ol->DATARETT
'tmp_operazbo_ol->CONNESCLI
'tmp_operazbo_ol->CONNESOPER
'tmp_operazbo_ol->CONNESBEN
'tmp_operazbo_ol->COLLEG
'tmp_operazbo_ol->CAMBIO
'tmp_operazbo_ol->RAPPORTBEN
'tmp_operazbo_ol->FLAGRAP2
'tmp_operazbo_ol->OPERATORE
'tmp_operazbo_ol->AUTOM
'tmp_operazbo_ol->idcauana
'tmp_operazbo_ol->OPERAG
'tmp_operazbo_ol->DOCFILE
'tmp_operazbo_ol->RESPINS
'tmp_operazbo_ol->INFORM
'tmp_operazbo_ol->CDATOPE
'tmp_operazbo_ol->NOPROT
'tmp_operazbo_ol->UCODE
'tmp_operazbo_ol->CDATAOPE
'tmp_operazbo_ol->ZCPARTE
'tmp_operazbo_ol->RAGIO
'tmp_operazbo_ol->MODSVOL
'tmp_operazbo_ol->AREAGEO
'tmp_operazbo_ol->RIFIMP
'tmp_operazbo_ol->SCOPO
'tmp_operazbo_ol->NATURA
'tmp_operazbo_ol->RTIPO
'tmp_operazbo_ol->RCOMP
'tmp_operazbo_ol->RIMP
'tmp_operazbo_ol->RFREQ
'tmp_operazbo_ol->RRAGIO
'tmp_operazbo_ol->RAREA
'tmp_operazbo_ol->TIPO
'tmp_operazbo_ol->PRGIMPOPE
'tmp_operazbo_ol->UNIQUECODE
'tmp_operazbo_ol->AMMONT
'tmp_operazbo_ol->DURAT
'tmp_operazbo_ol->CONNALTRO
'tmp_operazbo_ol->CONNESDOC
'tmp_operazbo_ol->C_RAG
'tmp_operazbo_ol->C_STA
'tmp_operazbo_ol->C_CTA
'tmp_operazbo_ol->C_CAB
'tmp_operazbo_ol->C_PRV
'tmp_operazbo_ol->C_IND
'tmp_operazbo_ol->C_CAP
'tmp_operazbo_ol->DATAIMP
'tmp_operazbo_ol->C_RAPPORTO
'tmp_operazbo_ol->PAGASOGOP
'tmp_operazbo_ol->MTCN
'tmp_operazbo_ol->IDFILE
'tmp_operazbo_ol->CDATREG
]
sel_field='*
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='operazbo
father=O147
fatherSonIndex=1
obj='Insert
pag=1
rd_kfield=[
'IDBASE
'NUMPROG
'DATAOPE
'TIPOINTER
'CODINTER
'TIPOINF
'IDEREG
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'OPRAP
'TIPOOPRAP
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'STATOREG
'OPERAZMOD
'DATARETT
'CONNESCLI
'CONNESOPER
'CONNESBEN
'COLLEG
'CAMBIO
'RAPPORTBEN
'FLAGRAP2
'OPERATORE
'AUTOM
'idcauana
'OPERAG
'DOCFILE
'RESPINS
'INFORM
'CDATOPE
'NOPROT
'UCODE
'CDATAOPE
'ZCPARTE
'RAGIO
'MODSVOL
'AREAGEO
'RIFIMP
'SCOPO
'NATURA
'RTIPO
'RCOMP
'RIMP
'RFREQ
'RRAGIO
'RAREA
'TIPO
'PRGIMPOPE
'UNIQUECODE
'AMMONT
'DURAT
'CONNALTRO
'CONNESDOC
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'DATAIMP
'C_RAPPORTO
'PAGASOGOP
'MTCN
'IDFILE
'CDATREG
]
rd_kvar=[
'tmp_operazbo_ol->IDBASE
'tmp_operazbo_ol->NUMPROG
'tmp_operazbo_ol->DATAOPE
'tmp_operazbo_ol->TIPOINTER
'tmp_operazbo_ol->CODINTER
'tmp_operazbo_ol->TIPOINF
'tmp_operazbo_ol->IDEREG
'tmp_operazbo_ol->CODDIPE
'tmp_operazbo_ol->DESCCIT
'tmp_operazbo_ol->PROVINCIA
'tmp_operazbo_ol->CODCAB
'tmp_operazbo_ol->FLAGFRAZ
'tmp_operazbo_ol->FLAGCONT
'tmp_operazbo_ol->CODANA
'tmp_operazbo_ol->CODVOC
'tmp_operazbo_ol->TIPOINT2
'tmp_operazbo_ol->CODINT2
'tmp_operazbo_ol->PAESE
'tmp_operazbo_ol->DESC2
'tmp_operazbo_ol->PROV2
'tmp_operazbo_ol->CODCAB2
'tmp_operazbo_ol->DESCINTER
'tmp_operazbo_ol->RAPPORTO
'tmp_operazbo_ol->FLAGRAP
'tmp_operazbo_ol->TIPOLEG
'Date()
'tmp_operazbo_ol->OPRAP
'tmp_operazbo_ol->TIPOOPRAP
'tmp_operazbo_ol->FLAGLIRE
'tmp_operazbo_ol->VALUTA
'tmp_operazbo_ol->SEGNO
'tmp_operazbo_ol->TOTLIRE
'tmp_operazbo_ol->TOTCONT
'tmp_operazbo_ol->STATOREG
'tmp_operazbo_ol->OPERAZMOD
'tmp_operazbo_ol->DATARETT
'tmp_operazbo_ol->CONNESCLI
'tmp_operazbo_ol->CONNESOPER
'tmp_operazbo_ol->CONNESBEN
'tmp_operazbo_ol->COLLEG
'tmp_operazbo_ol->CAMBIO
'tmp_operazbo_ol->RAPPORTBEN
'tmp_operazbo_ol->FLAGRAP2
'tmp_operazbo_ol->OPERATORE
'tmp_operazbo_ol->AUTOM
'tmp_operazbo_ol->idcauana
'tmp_operazbo_ol->OPERAG
'tmp_operazbo_ol->DOCFILE
'tmp_operazbo_ol->RESPINS
'tmp_operazbo_ol->INFORM
'tmp_operazbo_ol->CDATOPE
'tmp_operazbo_ol->NOPROT
'tmp_operazbo_ol->UCODE
'tmp_operazbo_ol->CDATAOPE
'tmp_operazbo_ol->ZCPARTE
'tmp_operazbo_ol->RAGIO
'tmp_operazbo_ol->MODSVOL
'tmp_operazbo_ol->AREAGEO
'tmp_operazbo_ol->RIFIMP
'tmp_operazbo_ol->SCOPO
'tmp_operazbo_ol->NATURA
'tmp_operazbo_ol->RTIPO
'tmp_operazbo_ol->RCOMP
'tmp_operazbo_ol->RIMP
'tmp_operazbo_ol->RFREQ
'tmp_operazbo_ol->RRAGIO
'tmp_operazbo_ol->RAREA
'tmp_operazbo_ol->TIPO
'tmp_operazbo_ol->PRGIMPOPE
'tmp_operazbo_ol->UNIQUECODE
'tmp_operazbo_ol->AMMONT
'tmp_operazbo_ol->DURAT
'tmp_operazbo_ol->CONNALTRO
'tmp_operazbo_ol->CONNESDOC
'tmp_operazbo_ol->C_RAG
'tmp_operazbo_ol->C_STA
'tmp_operazbo_ol->C_CTA
'tmp_operazbo_ol->C_CAB
'tmp_operazbo_ol->C_PRV
'tmp_operazbo_ol->C_IND
'tmp_operazbo_ol->C_CAP
'tmp_operazbo_ol->DATAIMP
'tmp_operazbo_ol->C_RAPPORTO
'tmp_operazbo_ol->PAGASOGOP
'tmp_operazbo_ol->MTCN
'tmp_operazbo_ol->IDFILE
'tmp_operazbo_ol->CDATREG
]
sel_field='*
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=1
prev=O141
rd_kfield=[
'TIPOOPRAP
]
rd_kop=[
'=
]
rd_kvar=[
''46'
]
I
obj='Delete
pag=1
rd_kfield=[
'TIPOOPRAP
]
rd_kop=[
'=
]
rd_kvar=[
''36'
]
I
I
]
w=[
150
150
150
]
I
obj='While
pag=1
prev=O59
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O60
fatherSonIndex=0
frm_calc='FileLibrary.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O170
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O171
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file '+w_nomefile
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPRemark
frm_calc='Verifico il tipo di riga
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,14,1)
len=1
name='xTipo
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,234,1)='1','S','N')
len=1
name='xOpe
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipo='1'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O180
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O181
fatherSonIndex=0
frm_calc=[
'xOpe='S'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O186
fatherSonIndex=0
frm_calc='7
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O186
fatherSonIndex=1
frm_calc='8
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O181
fatherSonIndex=1
frm_calc=[
'xOpe='S'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O196
fatherSonIndex=0
frm_calc='9
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O196
fatherSonIndex=1
frm_calc='10
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=1
prev=O179
var_op='asgn
I
obj='Var
pag=1
prev=O178
var_op='asgn
I
obj='Remark
pag=1
prev=O177
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O176
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='TempTable
pag=1
prev=O58
sel_type='def
server_table='tmp_operazbo_ol
I
obj='TempTable
pag=1
prev=O57
sel_type='def
server_table='tmp_intestbo_ol
I
obj='TempTable
pag=1
prev=O56
sel_type='def
server_table='tmp_rapopebo_ol
I
obj='TempTable
pag=1
prev=O55
sel_type='def
server_table='tmp_anarapbo
I
obj='DropTempTable
pag=1
prev=O54
server_table='tmp_rapopebo_ol
I
obj='DropTempTable
pag=1
prev=O53
server_table='tmp_intestbo_ol
I
obj='DropTempTable
pag=1
prev=O52
server_table='tmp_anarapbo
I
obj='DropTempTable
pag=1
server_table='tmp_operazbo_ol
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWhile
father=O38
fatherSonIndex=1
frm_calc='not(FileLibrary.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'mcOperazioni.RecCount() > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'mcInformazioni.RecCount() > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTitolari.RecCount() > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O214
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O217
fatherSonIndex=0
for_variable='rwTitolari
for_variable_type='mcTesto.MCRDef
h=[
19
19
]
iterator_expr='mcTitolari
obj='ForEach
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O222
fatherSonIndex=0
frm_calc='rwTitolari.testo
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,14,1)
len=1
name='xTipo
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipo='1'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O227
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O228
fatherSonIndex=0
frm_calc='Substr(riga,234,1)
len=1
name='xOpe
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_dataope
next=Icpitembatch.CPExec
check='page
frm_calc='11
obj='Exec
pag=1
prev=O234
I
obj='Var
obj_type='D
pag=1
prev=O233
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O228
fatherSonIndex=1
frm_calc='12
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=1
prev=O226
var_op='asgn
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O211
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPForEach
father=O214
fatherSonIndex=0
for_variable='rwInformazioni
for_variable_type='mcTesto.MCRDef
h=[
19
19
]
iterator_expr='mcInformazioni
obj='ForEach
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O243
fatherSonIndex=0
frm_calc='rwInformazioni.testo
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,14,1)
len=1
name='xTipo
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipo='1'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O248
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O249
fatherSonIndex=0
frm_calc='Substr(riga,234,1)
len=1
name='xOpe
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,234,2)='25' or Substr(riga,234,2)='28','S','N')
len=1
name='cDelega
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_dataope
next=Icpitembatch.CPExec
check='page
frm_calc='3
obj='Exec
pag=1
prev=O256
I
obj='Var
obj_type='D
pag=1
prev=O255
var_op='asgn
I
obj='Var
pag=1
prev=O254
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O249
fatherSonIndex=1
frm_calc='5
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=1
prev=O247
var_op='asgn
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O209
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPForEach
father=O211
fatherSonIndex=0
for_variable='rwOperazioni
for_variable_type='mcTesto.MCRDef
h=[
19
19
]
iterator_expr='mcOperazioni
obj='ForEach
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O265
fatherSonIndex=0
frm_calc='rwOperazioni.testo
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,14,1)
len=1
name='xTipo
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipo='1'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O270
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O271
fatherSonIndex=0
frm_calc='Substr(riga,234,1)
len=1
name='xOpe
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,234,2)='25' or Substr(riga,234,2)='28','S','N')
len=1
name='cDelega
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_dataope
next=Icpitembatch.CPExec
check='page
frm_calc='2
obj='Exec
pag=1
prev=O278
I
obj='Var
obj_type='D
pag=1
prev=O277
var_op='asgn
I
obj='Var
pag=1
prev=O276
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O271
fatherSonIndex=1
frm_calc=[
'xTipo='5'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O281
fatherSonIndex=0
frm_calc='14
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O281
fatherSonIndex=1
frm_calc='4
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=1
prev=O269
var_op='asgn
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='While
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O209
fatherSonIndex=0
frm_calc='FileLibrary.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O295
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O296
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file '+w_nomefile
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPRemark
frm_calc='Verifico il tipo di riga
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,14,1)
len=1
name='xTipo
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipo='1'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O304
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O305
fatherSonIndex=0
frm_calc='Substr(riga,234,1)
len=1
name='xOpe
next=Icpitembatch.CPIfElse
frm_calc=[
'w_soloanag<>'S'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O310
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O311
fatherSonIndex=0
frm_calc='iif(Substr(riga,234,2)='25' or Substr(riga,234,2)='28','S','N')
len=1
name='cDelega
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_dataope
next=Icpitembatch.CPCase
frm_calc=[
'xOpe='1' and False
'xOpe='5'
]
h=[
19
19
19
19
]
haselse=True
obj='Case
pag=1
prev=O317
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O318
fatherSonIndex=0
frm_calc='2
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O318
fatherSonIndex=1
frm_calc='11
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O318
fatherSonIndex=2
frm_calc=[
'False
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O327
fatherSonIndex=0
frm_calc='3
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
150
]
I
obj='Var
obj_type='D
pag=1
prev=O316
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O311
fatherSonIndex=1
frm_calc=[
'xOpe='1'
'xOpe='5'
]
h=[
19
19
19
19
]
haselse=True
obj='Case
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O336
fatherSonIndex=0
frm_calc=''N'
len=1
name='_opepost
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O336
fatherSonIndex=1
frm_calc=''N'
len=1
name='_infpost
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O336
fatherSonIndex=2
frm_calc=''N'
len=1
name='_titpost
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O305
fatherSonIndex=1
frm_calc=[
'_opepost='N' or _infpost='N' or _titpost='N'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O349
fatherSonIndex=0
frm_calc=[
'xOpe='1' and False
'xOpe='5'
]
h=[
19
19
19
19
]
haselse=True
obj='Case
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O354
fatherSonIndex=0
frm_calc=[
'xTipo='5'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O359
fatherSonIndex=0
frm_calc='14
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O359
fatherSonIndex=1
frm_calc='4
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O354
fatherSonIndex=1
frm_calc='12
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O354
fatherSonIndex=2
frm_calc=[
'False
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O371
fatherSonIndex=0
frm_calc='5
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O349
fatherSonIndex=1
frm_calc=[
'_opepost='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_infpost='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_titpost='S'
]
h=[
19
19
]
obj='If
pag=1
prev=O383
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O386
fatherSonIndex=0
frm_seek='AppendBlank
name='mcTitolari
next=Icpitembatch.CPVarDecl
frm_calc='riga
frm_seek='testo
name='mcTitolari
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcTitolari
obj='Var
obj_type='MC
pag=1
prev=O392
var_op='meth
I
obj='Var
obj_type='MC
pag=1
prev=O391
var_op='prop
I
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O380
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O383
fatherSonIndex=0
frm_seek='AppendBlank
name='mcInformazioni
next=Icpitembatch.CPVarDecl
frm_calc='riga
frm_seek='testo
name='mcInformazioni
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcInformazioni
obj='Var
obj_type='MC
pag=1
prev=O398
var_op='meth
I
obj='Var
obj_type='MC
pag=1
prev=O397
var_op='prop
I
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
]
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O380
fatherSonIndex=0
frm_seek='AppendBlank
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='riga
frm_seek='testo
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcOperazioni
obj='Var
obj_type='MC
pag=1
prev=O404
var_op='meth
I
obj='Var
obj_type='MC
pag=1
prev=O403
var_op='prop
I
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=1
prev=O303
var_op='asgn
I
obj='Remark
pag=1
prev=O302
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O301
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=1
prev=O33
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O36
fatherSonIndex=0
frm_calc='LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+"/"+LRTrim(fileelab)
name='_fileinput
next=Icpitembatch.CPVarDecl
comment='ritorno del Charset
frm_seek='CharsetMit
name='objCharset
next=Icpitembatch.CPVarDecl
frm_calc='objCharset.detectCharsetString(_fileinput)
name='charset
next=Icpitembatch.CPVarDecl
frm_calc='FileLibrary.OpenRead('appo/'+LRTrim(gAzienda)+"/"+LRTrim(fileelab),charset)
len=1
name='fhand
obj='Var
pag=1
prev=O416
var_op='asgn
I
obj='Var
pag=1
prev=O415
var_op='asgn
I
obj='Var
obj_type='O
pag=1
pagelocal=True
prev=O414
var_op='new
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O33
fatherSonIndex=0
frm_calc='13
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O33
fatherSonIndex=1
frm_calc='w_nomefile
len=128
name='fileelab
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O31
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O30
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O29
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O28
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O27
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O25
var_op='asgn
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O25
fatherSonIndex=0
frm_calc=[
'w_azzera = 'S'
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='xelegabo
father=O427
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='xntestbo
next=Icpitembatch.CPDelete
arch='xapopebo
next=Icpitembatch.CPDelete
arch='xnarapbo
next=Icpitembatch.CPDelete
arch='xperazbo
next=Icpitembatch.CPDelete
arch='xapotit
next=Icpitembatch.CPDelete
arch='intestit
next=Icpitembatch.CPDelete
arch='rapotit
next=Icpitembatch.CPDelete
arch='fiduciabo
next=Icpitembatch.CPDelete
arch='soginfo
next=Icpitembatch.CPDelete
arch='garantbo
next=Icpitembatch.CPDelete
arch='delegabo
next=Icpitembatch.CPDelete
arch='intestbo
next=Icpitembatch.CPDelete
arch='rapopebo
next=Icpitembatch.CPDelete
arch='anarapbo
next=Icpitembatch.CPDelete
arch='operazbo
next=Icpitembatch.CPDelete
arch='personbo_agg
next=Icpitembatch.CPDelete
arch='personbo
next=Icpitembatch.CPDelete
arch='wersonbo
next=Icpitembatch.CPDelete
arch='cpwarn
obj='Delete
pag=1
prev=O450
rd_kfield=[
'warncode
]
rd_kop=[
'=
]
rd_kvar=[
'gAzienda
]
I
obj='Delete
pag=1
prev=O449
sel_type='all
I
obj='Delete
pag=1
prev=O448
sel_type='all
I
obj='Delete
pag=1
prev=O447
sel_type='all
I
obj='Delete
pag=1
prev=O446
sel_type='all
I
obj='Delete
pag=1
prev=O445
sel_type='all
I
obj='Delete
pag=1
prev=O444
sel_type='all
I
obj='Delete
pag=1
prev=O443
sel_type='all
I
obj='Delete
pag=1
prev=O442
sel_type='all
I
obj='Delete
pag=1
prev=O441
sel_type='all
I
obj='Delete
pag=1
prev=O440
sel_type='all
I
obj='Delete
pag=1
prev=O439
sel_type='all
I
obj='Delete
pag=1
prev=O438
sel_type='all
I
obj='Delete
pag=1
prev=O437
sel_type='all
I
obj='Delete
pag=1
prev=O436
sel_type='all
I
obj='Delete
pag=1
prev=O435
sel_type='all
I
obj='Delete
pag=1
prev=O434
sel_type='all
I
obj='Delete
pag=1
prev=O433
sel_type='all
I
obj='Delete
pag=1
prev=O432
sel_type='all
I
obj='Delete
pag=1
sel_type='all
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O14
fatherSonIndex=1
frm_calc='gMsgProc + "Rilevati errori nell'impotazione dei file! Ricreare il file segnalato e rieseguire l'import dei dati. La procedura annullera automaticamente l'importazione" + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Errore SQL: ' + m_Sql.TransactionErrorMessage() + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='rollback
obj='Transaction
pag=1
prev=O460
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O459
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=1
prev=O12
I
obj='Var
obj_type='N
pag=1
prev=O11
var_op='asgn
I
obj='Remark
pag=1
prev=O10
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O9
var_op='asgn
I
obj='Remark
pag=1
prev=O7
I
obj='Begin
pag=1
prev=O5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Path Applicazione
father=O7
fatherSonIndex=0
global=True
len=80
name='gPathApp
next=Icpitembatch.CPVarDecl
comment='Azienda
global=True
len=10
name='gAzienda
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O467
I
nonlocal=True
obj='Var
pag=1
prev=O466
I
nonlocal=True
obj='Var
pag=1
prev=O465
I
nonlocal=True
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5
fatherSonIndex=0
len=1
name='fhand
next=Icpitembatch.CPVarDecl
len=10
name='riga
next=Icpitembatch.CPVarDecl
len=25
name='xRapportox
next=Icpitembatch.CPVarDecl
comment='Contatore Operazioni
len=10
name='cNumOpe
next=Icpitembatch.CPVarDecl
comment='Contatore Rapporti
len=10
name='cNumRap
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
len=10
name='cNumPer
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
len=10
name='cNumInf
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
len=10
name='cNumTit
next=Icpitembatch.CPVarDecl
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
len=1
name='xTipo
next=Icpitembatch.CPVarDecl
len=1
name='xOpe
next=Icpitembatch.CPVarDecl
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
len=16
name='cConnes
next=Icpitembatch.CPVarDecl
len=16
name='xCF
next=Icpitembatch.CPVarDecl
len=16
name='cCF
next=Icpitembatch.CPVarDecl
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
len=30
name='xCitta
next=Icpitembatch.CPVarDecl
len=6
name='cCliProg
next=Icpitembatch.CPVarDecl
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
len=1
name='xSesso
next=Icpitembatch.CPVarDecl
len=3
name='xRam
next=Icpitembatch.CPVarDecl
len=2
name='xTD
next=Icpitembatch.CPVarDecl
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
len=6
name='xCAB
next=Icpitembatch.CPVarDecl
len=6
name='xDIP
next=Icpitembatch.CPVarDecl
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
len=8
name='xData
next=Icpitembatch.CPVarDecl
len=8
name='xDatF
next=Icpitembatch.CPVarDecl
len=1
name='cFlagLire
next=Icpitembatch.CPVarDecl
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
len=1
name='xCFE
next=Icpitembatch.CPVarDecl
len=10
name='conta
next=Icpitembatch.CPVarDecl
len=1
name='_esito
next=Icpitembatch.CPVarDecl
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
len=15
name='nProgRap
next=Icpitembatch.CPVarDecl
len=15
name='nProgOpe
next=Icpitembatch.CPVarDecl
len=5
name='nMaxR
next=Icpitembatch.CPVarDecl
len=1
name='streg
next=Icpitembatch.CPVarDecl
len=25
name='xAppRap
next=Icpitembatch.CPVarDecl
len=1
name='xTipoInf
next=Icpitembatch.CPVarDecl
len=70
name='cRagSoc
next=Icpitembatch.CPVarDecl
len=16
name='xIDBx
next=Icpitembatch.CPVarDecl
len=10
name='xMaxRow
next=Icpitembatch.CPVarDecl
len=1
name='cTipPer
next=Icpitembatch.CPVarDecl
len=8
name='xDatOpe
next=Icpitembatch.CPVarDecl
len=1
name='cDelega
next=Icpitembatch.CPVarDecl
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
len=200
name='cpercorsozip
next=Icpitembatch.CPVarDecl
len=200
name='cdirectoryfile
next=Icpitembatch.CPVarDecl
len=128
name='fileelab
next=Icpitembatch.CPVarDecl
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
len=2
name='_prvnas
next=Icpitembatch.CPVarDecl
frm_seek='mcTesto.MCRDef
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_seek='mcTesto.MCRDef
name='mcInformazioni
next=Icpitembatch.CPVarDecl
frm_seek='mcTesto.MCRDef
name='mcTitolari
next=Icpitembatch.CPVarDecl
len=1
name='_opepost
next=Icpitembatch.CPVarDecl
len=1
name='_infpost
next=Icpitembatch.CPVarDecl
len=1
name='_titpost
next=Icpitembatch.CPVarDecl
len=16
name='xTitolare
next=Icpitembatch.CPVarDecl
len=11
name='cInfTit
next=Icpitembatch.CPVarDecl
name='_fileinput
next=Icpitembatch.CPVarDecl
name='charset
next=Icpitembatch.CPVarDecl
comment='ritorno del Charset
frm_seek='CharsetMit
name='objCharset
next=Icpitembatch.CPVarDecl
len=10
name='xATECO
next=Icpitembatch.CPVarDecl
frm_seek='tipo6
name='mcTipo6
next=Icpitembatch.CPVarDecl
len=1
name='_tipo6b
next=Icpitembatch.CPVarDecl
len=8
name='xDatReg
obj='Var
obj_type='D
pag=1
prev=O549
I
obj='Var
pag=1
prev=O548
I
obj='Var
obj_type='MC
pag=1
prev=O547
I
obj='Var
pag=1
prev=O546
I
obj='Var
obj_type='O
pag=1
pagelocal=True
prev=O545
I
obj='Var
pag=1
prev=O544
I
obj='Var
pag=1
prev=O543
I
obj='Var
pag=1
prev=O542
I
obj='Var
pag=1
prev=O541
I
obj='Var
pag=1
prev=O540
I
obj='Var
pag=1
prev=O539
I
obj='Var
pag=1
prev=O538
I
obj='Var
obj_type='MC
pag=1
prev=O537
I
obj='Var
obj_type='MC
pag=1
prev=O536
I
obj='Var
obj_type='MC
pag=1
prev=O535
I
obj='Var
pag=1
prev=O534
I
obj='Var
obj_type='D
pag=1
prev=O533
I
obj='Var
pag=1
prev=O532
I
obj='Var
pag=1
prev=O531
I
obj='Var
pag=1
prev=O530
I
obj='Var
pag=1
prev=O529
I
obj='Var
pag=1
prev=O528
I
obj='Var
obj_type='D
pag=1
prev=O527
I
obj='Var
pag=1
prev=O526
I
obj='Var
obj_type='N
pag=1
prev=O525
I
obj='Var
pag=1
prev=O524
I
obj='Var
pag=1
prev=O523
I
obj='Var
pag=1
prev=O522
I
obj='Var
pag=1
prev=O521
I
obj='Var
pag=1
prev=O520
I
obj='Var
obj_type='N
pag=1
prev=O519
I
obj='Var
obj_type='N
pag=1
prev=O518
I
obj='Var
obj_type='N
pag=1
prev=O517
I
obj='Var
obj_type='N
pag=1
prev=O516
I
obj='Var
obj_type='N
pag=1
prev=O515
I
obj='Var
pag=1
prev=O514
I
obj='Var
pag=1
prev=O513
I
obj='Var
obj_type='N
pag=1
prev=O512
I
obj='Var
obj_type='N
pag=1
prev=O511
I
obj='Var
obj_type='N
pag=1
prev=O510
I
obj='Var
pag=1
prev=O509
I
obj='Var
obj_type='N
pag=1
prev=O508
I
obj='Var
pag=1
prev=O507
I
obj='Var
pag=1
prev=O506
I
obj='Var
pag=1
prev=O505
I
obj='Var
pag=1
prev=O504
I
obj='Var
pag=1
prev=O503
I
obj='Var
pag=1
prev=O502
I
obj='Var
pag=1
prev=O501
I
obj='Var
pag=1
prev=O500
I
obj='Var
pag=1
prev=O499
I
obj='Var
pag=1
prev=O498
I
obj='Var
pag=1
prev=O497
I
obj='Var
pag=1
prev=O496
I
obj='Var
pag=1
prev=O495
I
obj='Var
pag=1
prev=O494
I
obj='Var
pag=1
prev=O493
I
obj='Var
pag=1
prev=O492
I
obj='Var
pag=1
prev=O491
I
obj='Var
pag=1
prev=O490
I
obj='Var
pag=1
prev=O489
I
obj='Var
pag=1
prev=O488
I
obj='Var
pag=1
prev=O487
I
obj='Var
pag=1
prev=O486
I
obj='Var
pag=1
prev=O485
I
obj='Var
pag=1
prev=O484
I
obj='Var
pag=1
prev=O483
I
obj='Var
pag=1
prev=O482
I
obj='Var
pag=1
prev=O481
I
obj='Var
pag=1
prev=O480
I
obj='Var
pag=1
prev=O479
I
obj='Var
obj_type='N
pag=1
prev=O478
I
obj='Var
obj_type='N
pag=1
prev=O477
I
obj='Var
obj_type='N
pag=1
prev=O476
I
obj='Var
obj_type='N
pag=1
prev=O475
I
obj='Var
obj_type='N
pag=1
prev=O474
I
obj='Var
pag=1
prev=O473
I
obj='Var
obj_type='M
pag=1
prev=O472
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Nome file di import
father=O3
fatherSonIndex=0
len=100
name='w_nomefile
next=Icpitembatch.CPVarDecl
comment='Destinazione (Definitivo/Provvisorio)
len=1
name='w_tipodest
next=Icpitembatch.CPVarDecl
comment='Azzera archivi esistenti
len=1
name='w_azzera
next=Icpitembatch.CPVarDecl
comment='Tipo Import
len=1
name='w_tipoimp
next=Icpitembatch.CPVarDecl
comment='RAE o ATECO
len=1
name='w_flgrae
next=Icpitembatch.CPVarDecl
comment='Importa solo anagrafiche
len=1
name='w_soloanag
obj='Var
pag=1
param=True
prev=O558
I
obj='Var
pag=1
param=True
prev=O557
I
obj='Var
pag=1
param=True
prev=O556
I
obj='Var
pag=1
param=True
prev=O555
I
obj='Var
pag=1
param=True
prev=O554
I
obj='Var
pag=1
param=True
I
I
]
w=[
150
150
]
x=17
y=14
I
Icpitembatch.CPRemark
frm_calc='Importa i dati base delle operazioni
next=Icpitembatch.CPVarDecl
comment='Contatore Operazioni
frm_calc='cNumOpe + 1
len=10
name='cNumOpe
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Substr(riga,79,8))
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
frm_calc=''N'
len=1
name='_opepost
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O564
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O565
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PPOPER1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,199,25),Space(25)))
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,224,1),Space(1))
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,35,6)
len=6
name='xDIP
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xDIP)))
]
h=[
19
19
]
next=Icpitembatch.CPRead
arch='tbcauana
next=Icpitembatch.CPInsert
arch='xperazbo
h=[
19
19
]
obj='Insert
pag=2
prev=O581
rd_kfield=[
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'idcauana
'IDEREG
'NUMPROG
'OPERAZMOD
'OPRAP
'PAESE
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAPPORTO
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
'COLLEG
]
rd_kvar=[
'Substr(riga,79,8)
'Substr(riga,79,8)
'Substr(riga,226,8)
'Substr(riga,89,4)
'Substr(riga,41,6)
'Substr(riga,111,6)
'Substr(riga,35,6)
'Substr(riga,97,11)
'Substr(riga,3,11)
'Substr(riga,93,2)
'CharToDate(Substr(riga,79,8))
'Date()
'CharToDate(Substr(riga,249,8))
'Substr(riga,117,30)
'Substr(riga,47,30)
'Substr(riga,149,50)
'Substr(riga,88,1)
'Substr(riga,87,1)
'Substr(riga,277,1)
'xTipRap
'cOpeProg1
'cIdCau
'Substr(riga,79,8) + cOpeProg2 + Substr(riga,248,1)
'cOpeProg2
'Substr(riga,257,20)
'Substr(riga,234,1)
'Substr(riga,108,3)
'nProgImp
'Substr(riga,147,2)
'Substr(riga,77,2)
'LRTrim(xRapporto)
'LRTrim(Substr(riga,312,12))
'Substr(riga,281,1)
'Substr(riga,248,1)
''1'
'Substr(riga,95,2)
'Substr(riga,1,2)
'Substr(riga,225,1)
'Substr(riga,234,2)
'Val(Substr(riga,297,15))
'Val(Substr(riga,282,15))
'Substr(riga,278,3)
'LRTrim(Substr(riga,236,12))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O582
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+w_nomefile+" per l'operazione in data "+Substr(riga,79,8)+" con importo "+Str((Val(Substr(riga,282,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=2
prev=O588
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Read
pag=2
prev=O578
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,89,4)
'Substr(riga,93,2)
]
rd_var=[
'cIdCau
]
I
obj='If
pag=2
prev=O577
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anadip
father=O578
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDIPx))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O597
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anadip
father=O598
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'CODDIP
'DESCRIZ
'CAB
'DESCCIT
'PROVINCIA
]
rd_kvar=[
'xDIP
'xDIP
'Substr(riga,41,6)
'Substr(riga,47,30)
'Substr(riga,77,2)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='anadip
father=O598
fatherSonIndex=1
obj='Write
pag=2
rd_kfield=[
'CODDIP
]
rd_kop=[
'=
]
rd_kvar=[
'xDIP
]
wr_field=[
'DESCCIT
'CAB
'PROVINCIA
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Substr(riga,47,30)
'Substr(riga,41,6)
'Substr(riga,77,2)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'xDIP
]
rd_var=[
'xDIPx
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O576
var_op='asgn
I
obj='Var
pag=2
prev=O575
var_op='asgn
I
obj='Var
pag=2
prev=O574
var_op='asgn
I
obj='Var
pag=2
prev=O573
var_op='asgn
I
obj='Var
pag=2
prev=O572
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O571
var_op='asgn
I
obj='Var
pag=2
prev=O570
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O565
fatherSonIndex=1
frm_calc=[
'Substr(riga,248,1)='0' or (At(Substr(riga,248,1),'|3|2') >0 and LRTrim(Substr(riga,257,20))='')
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(cOpeProg2))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O621
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O624
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,199,25),Space(25)))
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,224,1),Space(1))
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPRead
arch='tbcauana
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,35,6)
len=6
name='xDIP
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xDIP)))
]
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='operazbo
h=[
19
19
]
obj='Insert
pag=2
prev=O637
rd_kfield=[
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'idcauana
'IDEREG
'NUMPROG
'OPERAZMOD
'OPRAP
'PAESE
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAPPORTO
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
]
rd_kvar=[
'Substr(riga,79,8)
'Substr(riga,79,8)
'Substr(riga,226,8)
'Substr(riga,89,4)
'Substr(riga,41,6)
'Substr(riga,111,6)
'Substr(riga,35,6)
'Substr(riga,97,11)
'Substr(riga,3,11)
'Substr(riga,93,2)
'LRTrim(Substr(riga,236,12))
'CharToDate(Substr(riga,79,8))
'CharToDate(Substr(riga,226,8))
'CharToDate(Substr(riga,249,8))
'Substr(riga,117,30)
'Substr(riga,47,30)
'Substr(riga,149,50)
'Substr(riga,88,1)
'Substr(riga,87,1)
'Substr(riga,277,1)
'xTipRap
'cOpeProg1
'cIdCau
'Substr(riga,15,20)
'cOpeProg2
'Substr(riga,257,20)
'Substr(riga,234,1)
'Substr(riga,108,3)
'nProgImp
'Substr(riga,147,2)
'Substr(riga,77,2)
'LRTrim(xRapporto)
'LRTrim(Substr(riga,312,12))
'Substr(riga,281,1)
'Substr(riga,248,1)
''1'
'Substr(riga,95,2)
'Substr(riga,1,2)
'Substr(riga,225,1)
'Substr(riga,234,2)
'Val(Substr(riga,297,15))
'Val(Substr(riga,282,15))
'Substr(riga,278,3)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O640
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+w_nomefile+" per l'operazione in data "+CharToDate(Substr(riga,79,8))+" con importo "+Str((Val(Substr(riga,282,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL﷯
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=2
prev=O646
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='If
pag=2
prev=O636
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='anadip
father=O637
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDIPx))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O651
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anadip
father=O652
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'CODDIP
'DESCRIZ
'CAB
'DESCCIT
'PROVINCIA
]
rd_kvar=[
'xDIP
'xDIP
'Substr(riga,41,6)
'Substr(riga,47,30)
'Substr(riga,77,2)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='anadip
father=O652
fatherSonIndex=1
obj='Write
pag=2
rd_kfield=[
'CODDIP
]
rd_kop=[
'=
]
rd_kvar=[
'xDIP
]
wr_field=[
'DESCCIT
'CAB
'PROVINCIA
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Substr(riga,47,30)
'Substr(riga,41,6)
'Substr(riga,77,2)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'xDIP
]
rd_var=[
'xDIPx
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O635
var_op='asgn
I
obj='Var
pag=2
prev=O634
var_op='asgn
I
obj='Read
pag=2
prev=O633
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,89,4)
'Substr(riga,93,2)
]
rd_var=[
'cIdCau
]
I
obj='Var
pag=2
prev=O632
var_op='asgn
I
obj='Var
pag=2
prev=O631
var_op='asgn
I
obj='Var
pag=2
prev=O630
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O629
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O624
fatherSonIndex=1
frm_calc=''S'
len=1
name='_opepost
next=Icpitembatch.CPVarDecl
frm_seek='AppendBlank
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_calc='riga
frm_seek='testo
name='mcOperazioni
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcOperazioni
obj='Var
obj_type='MC
pag=2
prev=O681
var_op='meth
I
obj='Var
obj_type='MC
pag=2
prev=O680
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O679
var_op='meth
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O621
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("POPERAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O621
fatherSonIndex=1
obj='Read
pag=2
rd_field=[
'NUMPROG
]
rd_kfield=[
'IDEREG
]
rd_kvar=[
'Substr(riga,257,20)
]
rd_var=[
'cOpeProg2
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O563
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O562
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O561
var_op='asgn
I
obj='Remark
pag=2
x=18
y=24
I
Icpitembatch.CPRemark
frm_calc='Importa i dati base dei rapporti
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='cNumInf + 1
len=10
name='cNumInf
next=Icpitembatch.CPVarDecl
frm_calc=''N'
len=1
name='_infpost
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O697
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O698
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGPINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,199,25),Space(25)))
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,224,1),Space(1))
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,248,1)='2','2',iif(Substr(riga,248,1)='0','S','A'))
len=1
name='streg
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,35,6)
len=6
name='xDIP
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xDIP)))
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Inserisce Rapporto
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xapopebo
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Inserisce Intestatario
h=[
19
19
]
obj='Begin
pag=3
prev=O717
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O719
fatherSonIndex=0
frm_calc='''
len=1
name='xTipoInf
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPExec
check='page
frm_calc='6
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A' or xTipoInf='C'
]
h=[
19
19
]
obj='If
pag=3
prev=O725
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xntestbo
father=O726
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A'
'xTipoInf='C'
]
h=[
19
19
19
]
obj='If
pag=3
prev=O732
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xntestbo
father=O735
fatherSonIndex=0
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(xRapporto)
]
wr_field=[
'TIPOPERS
'DATAINI
]
wr_op=[
'=
'=
]
wr_var=[
''P'
'CharToDate(Substr(riga,79,8))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xntestbo
father=O735
fatherSonIndex=1
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(xRapporto)
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Substr(riga,79,8))
'cInfProg2
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=3
prev=O731
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O732
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xntestbo
h=[
19
19
]
obj='Insert
pag=3
prev=O760
rd_kfield=[
'IDBASE
'CPROWNUM
'NUMPROG1
'STATOREG
'RAPPORTO
'TIPORAP
'PRGIMPSOG
'TIPOPERS
]
rd_kvar=[
'xIDB
'xMaxRow + 1
'cInfProg2
''0'
'LRTrim(xRapporto)
'Substr(riga,224,1)
'nProgImp2
''P'
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O762
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+w_nomefile+" per la registrazione dell'intestatario dell'informazione in data "+Substr(riga,79,8)+" relativa al rapporto: "+ xRapporto +" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=3
prev=O768
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=3
prev=O759
sel_field='xntestbo->CPROWNUM
sel_name='xntestbo
sel_order='xntestbo->CPROWNUM
sel_where='xntestbo->RAPPORTO=LRTrim(xRapporto)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O760
fatherSonIndex=0
frm_calc='xntestbo->CPROWNUM
len=10
name='xMaxRow
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O758
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=3
rd_field=[
'IDBASE
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'xRapporto
]
rd_var=[
'xIDB
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=3
prev=O724
I
obj='Var
pag=3
prev=O723
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=3
prev=O715
rd_kfield=[
'IDBASE
'NUMPROG
'DATAOPE
'TIPOINTER
'CODINTER
'TIPOINF
'IDEREG
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'OPRAP
'TIPOOPRAP
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'STATOREG
'OPERAZMOD
'DATARETT
'COLLEG
'PRGIMPINF
'CDATOPE
'CDATREG
]
rd_kvar=[
'cInfProg1
'cInfProg2
'CharToDate(Substr(riga,79,8))
'Substr(riga,1,2)
'Substr(riga,3,11)
''1'
'Substr(riga,79,8) + cOpeProg2 + streg
'Substr(riga,35,6)
'Substr(riga,47,30)
'Substr(riga,77,2)
'Substr(riga,41,6)
'Substr(riga,87,1)
'Substr(riga,88,1)
'Substr(riga,89,4)
'Substr(riga,93,2)
'Substr(riga,95,2)
'Substr(riga,97,11)
'Substr(riga,108,3)
'Substr(riga,117,30)
'Substr(riga,147,2)
'Substr(riga,111,6)
'Substr(riga,149,50)
'LRTrim(xRapporto)
'xTipRap
'Substr(riga,225,1)
'CharToDate(Substr(riga,226,8))
'Substr(riga,234,1)
'Substr(riga,234,2)
'Substr(riga,277,1)
'Substr(riga,278,3)
'Substr(riga,281,1)
'Val(Substr(riga,282,15))
'Val(Substr(riga,297,15))
'Substr(riga,248,1)
'Substr(riga,257,20)
'CharToDate(Substr(riga,249,8))
'Substr(riga,236,12)
'nProgImp
'Substr(riga,79,8)
'Substr(riga,226,8)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O717
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+w_nomefile+" per l'informazione in data "+Substr(riga,79,8)+" relativa al rapporto: "+xRapporto+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=3
prev=O786
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Begin
pag=3
prev=O712
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O715
fatherSonIndex=0
frm_calc='''
len=25
name='xAppRap
next=Icpitembatch.CPRead
arch='xnarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xAppRap))
]
h=[
19
19
]
obj='If
pag=3
prev=O792
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Rapporti
father=O793
fatherSonIndex=0
frm_calc='cNumRap + 1
len=10
name='cNumRap
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgRap
next=Icpitembatch.CPInsert
arch='xnarapbo
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='xRapportox
next=Icpitembatch.CPRead
arch='knarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xRapportox))
]
h=[
19
19
]
obj='If
pag=3
prev=O802
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='knarapbo
father=O803
fatherSonIndex=0
obj='Insert
pag=3
rd_kfield=[
'RAPPORTO
'TIPORAP
]
rd_kvar=[
'LRTrim(xRapporto)
''P'
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=3
prev=O801
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'LRTrim(xRapporto)
]
rd_var=[
'xRapportox
]
I
obj='Var
pag=3
prev=O800
var_op='asgn
I
obj='Insert
pag=3
prev=O799
rd_kfield=[
'RAPPORTO
'TIPORAP
'FLAGLIRE
'VALUTA
]
rd_kvar=[
'LRTrim(xRapporto)
'Substr(riga,224,1)
'iif(Substr(riga,277,1)='1','L',iif(Substr(riga,277,1)='2','V','E'))
'Substr(riga,278,3)
]
I
obj='Var
obj_type='N
pag=3
prev=O798
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=3
prev=O791
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'xRapporto
]
rd_var=[
'xAppRap
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O711
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anadip
father=O712
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDIPx))
]
h=[
19
19
]
obj='If
pag=3
prev=O826
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anadip
father=O827
fatherSonIndex=0
obj='Insert
pag=3
rd_kfield=[
'CODDIP
'DESCRIZ
]
rd_kvar=[
'xDIP
'xDIP
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=3
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'xDIP
]
rd_var=[
'xDIPx
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O710
var_op='asgn
I
obj='Var
pag=3
prev=O709
var_op='asgn
I
obj='Var
pag=3
prev=O708
var_op='asgn
I
obj='Var
pag=3
prev=O707
var_op='asgn
I
obj='Var
pag=3
prev=O706
var_op='asgn
I
obj='Var
pag=3
prev=O705
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O704
var_op='asgn
I
obj='Var
pag=3
prev=O703
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O698
fatherSonIndex=1
frm_calc='''
len=1
name='xTipoInf
next=Icpitembatch.CPExec
check='page
frm_calc='6
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf <> 'X'
]
h=[
19
19
]
obj='If
pag=3
prev=O843
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O844
fatherSonIndex=0
frm_calc=[
'Substr(riga,248,1)='0' or (At(Substr(riga,248,1),'|3|2') >0 and LRTrim(Substr(riga,257,20))='')
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(cInfProg2))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O849
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O852
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,199,25),Space(25)))
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,224,1),Space(1))
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Substr(riga,79,8))
len=8
name='xDatOpe
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,248,1)='2','2',iif(Substr(riga,248,1)='0','S','A'))
len=1
name='streg
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,35,6)
len=6
name='xDIP
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xDIP)))
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Inserisce Rapporto
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='rapopebo
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Inserisce Intestatario
h=[
19
19
]
obj='Begin
pag=3
prev=O871
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O873
fatherSonIndex=0
frm_calc=[
'cDelega <> 'S'
]
h=[
19
19
]
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O877
fatherSonIndex=0
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A' or xTipoInf='C'
]
h=[
19
19
]
obj='If
pag=3
prev=O882
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='intestbo
father=O883
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A'
'xTipoInf='C'
]
h=[
19
19
19
]
obj='If
pag=3
prev=O889
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestbo
father=O892
fatherSonIndex=0
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xRapporto)
'1
]
wr_field=[
'TIPOPERS
'DATAINI
]
wr_op=[
'=
'=
]
wr_var=[
''P'
'CharToDate(Substr(riga,79,8))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestbo
father=O892
fatherSonIndex=1
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(xRapporto)
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Substr(riga,79,8))
'cInfProg2
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=3
prev=O888
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O889
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='intestbo
h=[
19
19
]
obj='Insert
pag=3
prev=O917
rd_kfield=[
'IDBASE
'CPROWNUM
'NUMPROG1
'STATOREG
'RAPPORTO
'TIPORAP
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'xMaxRow + 1
'cInfProg2
''0'
'LRTrim(xRapporto)
'Substr(riga,224,1)
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O919
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+w_nomefile+" per la registrazione dell'intestatario dell'informazione in data "+Substr(riga,79,8)+" relativa al rapporto: "+ xRapporto +" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=3
prev=O925
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=3
prev=O916
sel_field='intestbo->CPROWNUM
sel_name='intestbo
sel_order='intestbo->CPROWNUM
sel_where='intestbo->RAPPORTO=xRapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O917
fatherSonIndex=0
frm_calc='intestbo->CPROWNUM
len=10
name='xMaxRow
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O915
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=3
rd_field=[
'IDBASE
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'LRTrim(xRapporto)
]
rd_var=[
'xIDB
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=3
prev=O869
rd_kfield=[
'IDBASE
'NUMPROG
'DATAOPE
'TIPOINTER
'CODINTER
'TIPOINF
'IDEREG
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'OPRAP
'TIPOOPRAP
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'STATOREG
'OPERAZMOD
'DATARETT
'COLLEG
'PRGIMPINF
'CDATOPE
'CDATREG
]
rd_kvar=[
'cInfProg1
'cInfProg2
'CharToDate(Substr(riga,79,8))
'Substr(riga,1,2)
'Substr(riga,3,11)
''1'
'Substr(riga,15,20)
'Substr(riga,35,6)
'Substr(riga,47,30)
'Substr(riga,77,2)
'Substr(riga,41,6)
'Substr(riga,87,1)
'Substr(riga,88,1)
'Substr(riga,89,4)
'Substr(riga,93,2)
'Substr(riga,95,2)
'Substr(riga,97,11)
'Substr(riga,108,3)
'Substr(riga,117,30)
'Substr(riga,147,2)
'Substr(riga,111,6)
'Substr(riga,149,50)
'LRTrim(xRapporto)
'xTipRap
'Substr(riga,225,1)
'CharToDate(Substr(riga,226,8))
'Substr(riga,234,1)
'Substr(riga,234,2)
'Substr(riga,277,1)
'Substr(riga,278,3)
'Substr(riga,281,1)
'Val(Substr(riga,282,15))
'Val(Substr(riga,297,15))
'Substr(riga,248,1)
'Substr(riga,257,20)
'CharToDate(Substr(riga,249,8))
'Substr(riga,236,12)
'nProgImp
'Substr(riga,79,8)
'Substr(riga,226,8)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O871
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+w_nomefile+" per l'informazione in data "+Substr(riga,79,8)+" relativa al rapporto: "+xRapporto+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=3
prev=O944
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Begin
pag=3
prev=O866
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O869
fatherSonIndex=0
frm_calc='''
len=25
name='xAppRap
next=Icpitembatch.CPRead
arch='anarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xAppRap))
]
h=[
19
19
]
obj='If
pag=3
prev=O950
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Rapporti
father=O951
fatherSonIndex=0
frm_calc='cNumRap + 1
len=10
name='cNumRap
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgRap
next=Icpitembatch.CPInsert
arch='anarapbo
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='xRapportox
next=Icpitembatch.CPRead
arch='knarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xRapportox))
]
h=[
19
19
]
obj='If
pag=3
prev=O960
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='knarapbo
father=O961
fatherSonIndex=0
obj='Insert
pag=3
rd_kfield=[
'RAPPORTO
'TIPORAP
]
rd_kvar=[
'LRTrim(xRapporto)
''D'
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=3
prev=O959
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'LRTrim(xRapporto)
]
rd_var=[
'xRapportox
]
I
obj='Var
pag=3
prev=O958
var_op='asgn
I
obj='Insert
pag=3
prev=O957
rd_kfield=[
'RAPPORTO
'TIPORAP
'FLAGLIRE
'VALUTA
'PRGIMPRAP
]
rd_kvar=[
'LRTrim(xRapporto)
'Substr(riga,224,1)
'iif(Substr(riga,277,1)='1','L',iif(Substr(riga,277,1)='2','V','E'))
'Substr(riga,278,3)
'nProgRap
]
I
obj='Var
obj_type='N
pag=3
prev=O956
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=3
prev=O949
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'LRTrim(xRapporto)
]
rd_var=[
'xAppRap
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O865
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='anadip
father=O866
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDIPx))
]
h=[
19
19
]
obj='If
pag=3
prev=O984
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anadip
father=O985
fatherSonIndex=0
obj='Insert
pag=3
rd_kfield=[
'CODDIP
'DESCRIZ
]
rd_kvar=[
'xDIP
'xDIP
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=3
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'xDIP
]
rd_var=[
'xDIPx
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O864
var_op='asgn
I
obj='Var
pag=3
prev=O863
var_op='asgn
I
obj='Var
pag=3
prev=O862
var_op='asgn
I
obj='Var
pag=3
prev=O861
var_op='asgn
I
obj='Var
obj_type='D
pag=3
prev=O860
var_op='asgn
I
obj='Var
pag=3
prev=O859
var_op='asgn
I
obj='Var
pag=3
prev=O858
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O857
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O852
fatherSonIndex=1
frm_calc=''S'
len=1
name='_infpost
next=Icpitembatch.CPVarDecl
frm_seek='AppendBlank
name='mcInformazioni
next=Icpitembatch.CPVarDecl
frm_calc='riga
frm_seek='testo
name='mcInformazioni
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcInformazioni
obj='Var
obj_type='MC
pag=3
prev=O1002
var_op='meth
I
obj='Var
obj_type='MC
pag=3
prev=O1001
var_op='prop
I
obj='Var
obj_type='MC
pag=3
prev=O1000
var_op='meth
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O849
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='rapopebo
father=O849
fatherSonIndex=1
obj='Read
pag=3
rd_field=[
'NUMPROG
]
rd_kfield=[
'IDEREG
]
rd_kvar=[
'Substr(riga,257,20)
]
rd_var=[
'cInfProg2
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=3
prev=O842
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=3
prev=O696
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O695
var_op='asgn
I
obj='Remark
pag=3
x=12
y=18
I
Icpitembatch.CPRemark
frm_calc='Importa i soggetti delle operazioni
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,35,16))
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,202,16)
len=16
name='xCF
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCF)) and Empty(LRTrim(xConnes))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPBeginEnd
comment='Calcola valori da salvare
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPIfElse
frm_calc=[
'xNewSog = 'S'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'w_soloanag <> 'S'
]
h=[
19
19
]
obj='If
pag=4
prev=O1026
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O1029
fatherSonIndex=0
frm_calc=[
'xTipo='2' or xTipo='3' or xTipo='7'
'xTipo='4' or xTipo='8'
'xTipo='5'
'xTipo='6' or xTipo='9'
]
h=[
19
19
19
19
19
]
obj='Case
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1034
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O1039
fatherSonIndex=0
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O1039
fatherSonIndex=1
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1034
fatherSonIndex=1
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O1061
fatherSonIndex=0
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O1061
fatherSonIndex=1
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1034
fatherSonIndex=2
frm_calc=[
'Empty(LRTrim(xConnes)) and Empty(LRTrim(cConnes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1083
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O1088
fatherSonIndex=0
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,51,70)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,124,6)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O1088
fatherSonIndex=1
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,51,70)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,124,6)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1083
fatherSonIndex=1
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O1110
fatherSonIndex=0
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESBEN
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xConnes
'Substr(riga,51,70)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,124,6)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O1110
fatherSonIndex=1
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESBEN
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xConnes
'Substr(riga,51,70)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,124,6)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1034
fatherSonIndex=3
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O1133
fatherSonIndex=0
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNALTRO
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O1133
fatherSonIndex=1
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNALTRO
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O1025
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='personbo
father=O1026
fatherSonIndex=0
obj='Insert
pag=4
rd_kfield=[
'CONNES
'CODFISC
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'AUTRILASC
'DATARILASC
'SESSO
'NASSTATO
'TIPOPERS
'CFESTERO
'TIPINTER
'ATTIV
]
rd_kvar=[
'LRTrim(xConnes)
'xCF
'Substr(riga,51,70)
'Substr(riga,124,6)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'CharToDate(Substr(riga,218,8))
'cCNAS
'Substr(riga,256,3)
'xRam
'Substr(riga,262,3)
'xTD
'Substr(riga,293,15)
'Substr(riga,316,30)
'CharToDate(Substr(riga,308,8))
'xSesso
'cSNAS
'cTipPer
'iif(Empty(xCF),1,0)
'_prvnas
'xATECO
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1026
fatherSonIndex=1
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='personbo
obj='Write
pag=4
prev=O1165
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(xConnes)
]
wr_field=[
'CODFISC
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'AUTRILASC
'DATARILASC
'SESSO
'NASSTATO
'TIPOPERS
'CFESTERO
'TIPINTER
'ATTIV
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xCF
'Substr(riga,51,70)
'Substr(riga,124,6)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'CharToDate(Substr(riga,218,8))
'cCNAS
'Substr(riga,256,3)
'xRam
'Substr(riga,262,3)
'xTD
'Substr(riga,293,15)
'Substr(riga,316,30)
'CharToDate(Substr(riga,308,8))
'xSesso
'cSNAS
'cTipPer
'iif(Empty(xCF),1,0)
'_prvnas
'xATECO
]
I
obj='If
pag=4
prev=O1163
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1165
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=4
prev=O1177
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES = xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O1178
fatherSonIndex=0
obj='Insert
pag=4
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'datamodi
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
'DATAVARAGE
'SETTSINT2
'FATCA
'BANCABEN
'TIN
'ODB
'TELEF
'TIPOORO
'CODORO
'IDNASCOMUN
'IDNASSTATO
'NOTIT
]
rd_kvar=[
'cProgSto
'xConnes
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'_dataope
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
'personbo->DATAVARAGE
'personbo->SETTSINT2
'personbo->FATCA
'personbo->BANCABEN
'personbo->TIN
'personbo->ODB
'personbo->TELEF
'personbo->TIPOORO
'personbo->CODORO
'personbo->IDNASCOMUN
'personbo->IDNASSTATO
'personbo->NOTIT
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=4
prev=O1162
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=xConnes and wersonbo->datamodi=_dataope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1163
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O1023
var_op='asgn
I
obj='Begin
pag=4
prev=O1020
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O1023
fatherSonIndex=0
frm_calc=[
'Substr(riga,346,1)='M'
'Substr(riga,346,1)='F'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_prvnas
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,226,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(xCF))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgrae = 'R'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,291,2)
len=2
name='xTD
next=Icpitembatch.CPIfElse
frm_calc=[
'xTD <> '01' and xTD <> '02' and xTD <> '03' and xTD <> '04' and xTD <> '05' and xTD <> '06'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(xSesso),'G','P')
len=1
name='cTipPer
obj='Var
pag=4
prev=O1207
var_op='asgn
I
obj='If
pag=4
prev=O1206
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1207
fatherSonIndex=0
frm_calc='''
len=2
name='xTD
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
prev=O1203
var_op='asgn
I
obj='If
pag=4
prev=O1200
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1203
fatherSonIndex=0
frm_calc='iif(Substr(riga,259,3)='000','',Substr(riga,259,3))
len=3
name='xRam
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xATECO
obj='Var
pag=4
prev=O1217
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1203
fatherSonIndex=1
frm_calc='''
len=3
name='xRam
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,259,3)='000','',Substr(riga,259,3))
len=10
name='xATECO
obj='Var
pag=4
prev=O1220
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=4
prev=O1199
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1200
fatherSonIndex=0
frm_calc=[
'Substr(xCF,12,1) = 'Z' and Len(LRTrim(xCF))=16
'Substr(xCF,12,1) <> 'Z' and Len(LRTrim(xCF))=16
]
h=[
19
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1225
fatherSonIndex=0
frm_calc='Substr(riga,226,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='_prvnas
obj='Var
pag=4
prev=O1231
var_op='asgn
I
obj='Var
pag=4
prev=O1230
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O1225
fatherSonIndex=1
obj='Read
pag=4
rd_field=[
'PROV
]
rd_kfield=[
'SIGLA
]
rd_kvar=[
'Substr(xCF,12,4)
]
rd_var=[
'_prvnas
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1200
fatherSonIndex=1
frm_calc='Substr(riga,226,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='_prvnas
obj='Var
pag=4
prev=O1242
var_op='asgn
I
obj='Var
pag=4
prev=O1241
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=4
prev=O1198
var_op='asgn
I
obj='Var
pag=4
prev=O1197
var_op='asgn
I
obj='Var
pag=4
prev=O1194
var_op='asgn
I
obj='Case
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1194
fatherSonIndex=0
frm_calc=''1'
len=1
name='xSesso
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1194
fatherSonIndex=1
frm_calc=''2'
len=1
name='xSesso
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1194
fatherSonIndex=2
frm_calc='Substr(riga,346,1)
len=1
name='xSesso
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O1019
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1020
fatherSonIndex=0
frm_calc=''N'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='cConnes
obj='Var
pag=4
prev=O1256
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1020
fatherSonIndex=1
frm_calc=''N'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='cConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cConnes))
]
h=[
19
19
]
obj='If
pag=4
prev=O1261
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1262
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(xCF))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1267
fatherSonIndex=0
frm_calc=''S'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cConnes
obj='Var
pag=4
prev=O1272
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1267
fatherSonIndex=1
frm_calc='''
len=16
name='cConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cConnes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
prev=O1276
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1277
fatherSonIndex=0
frm_calc=''S'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cConnes
obj='Var
pag=4
prev=O1282
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1277
fatherSonIndex=1
frm_calc='cConnes
len=16
name='xConnes
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=4
prev=O1275
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xCF
]
rd_var=[
'cConnes
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
prev=O1260
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'cConnes
]
I
obj='Var
pag=4
prev=O1259
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=4
prev=O1018
var_op='asgn
I
obj='Var
pag=4
prev=O1017
var_op='asgn
I
obj='Remark
pag=4
x=14
y=21
I
Icpitembatch.CPRemark
frm_calc='Importa i soggetti dei rapporti
next=Icpitembatch.CPVarDecl
frm_calc=''N'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='cConnes
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,35,16))
len=16
name='xConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cConnes))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,202,16)
len=16
name='xCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,51,70)
len=70
name='cRagSoc
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,346,1)='M'
'Substr(riga,346,1)='F'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(xCF))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgrae = 'R'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,291,2)
len=2
name='xTD
next=Icpitembatch.CPIfElse
frm_calc=[
'xTD <> '01' and xTD <> '02' and xTD <> '03' and xTD <> '04' and xTD <> '05' and xTD <> '06'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Len(LRTrim(xCF))=16,'P','G')
len=1
name='cTipPer
next=Icpitembatch.CPIfElse
frm_calc=[
'xNewSog = 'S'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'w_soloanag <> 'S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='P'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='D'
]
h=[
19
19
]
obj='If
pag=5
prev=O1329
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
father=O1332
fatherSonIndex=0
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,346,1)='M'
'Substr(riga,346,1)='F'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,226,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(xCF,12,1) = 'Z' and Len(LRTrim(xCF))=16
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgrae = 'R'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,291,2)
len=2
name='xTD
next=Icpitembatch.CPIfElse
frm_calc=[
'xTD <> '01' and xTD <> '02' and xTD <> '03' and xTD <> '04' and xTD <> '05' and xTD <> '06'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Len(LRTrim(xCF))=16,'P','G')
len=1
name='cTipPer
next=Icpitembatch.CPWrite
arch='personbo
obj='Write
pag=5
prev=O1353
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'cConnes
]
wr_field=[
'CODFISC
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'AUTRILASC
'DATARILASC
'SESSO
'NASSTATO
'TIPOPERS
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xCF
'Substr(riga,51,70)
'Substr(riga,124,6)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'CharToDate(Substr(riga,218,8))
'cCNAS
'Substr(riga,256,3)
'xRam
'Substr(riga,262,3)
'xTD
'Substr(riga,293,15)
'Substr(riga,316,30)
'CharToDate(Substr(riga,308,8))
'xSesso
'cSNAS
'cTipPer
]
I
obj='Var
pag=5
prev=O1350
var_op='asgn
I
obj='If
pag=5
prev=O1349
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1350
fatherSonIndex=0
frm_calc='''
len=2
name='xTD
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1346
var_op='asgn
I
obj='If
pag=5
prev=O1343
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1346
fatherSonIndex=0
frm_calc='iif(Substr(riga,259,3)='000','',Substr(riga,259,3))
len=3
name='xRam
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1346
fatherSonIndex=1
frm_calc='''
len=3
name='xRam
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=5
prev=O1342
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1343
fatherSonIndex=0
frm_calc='Substr(riga,226,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=5
prev=O1373
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1341
var_op='asgn
I
obj='Var
pag=5
prev=O1338
var_op='asgn
I
obj='Case
pag=5
prev=O1337
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1338
fatherSonIndex=0
frm_calc=''1'
len=1
name='xSesso
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1338
fatherSonIndex=1
frm_calc=''2'
len=1
name='xSesso
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1338
fatherSonIndex=2
frm_calc='Substr(riga,346,1)
len=1
name='xSesso
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1326
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O1329
fatherSonIndex=0
frm_calc='Calcola il progressivo di registrazione
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1388
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES = cConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O1389
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'datamodi
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
]
rd_kvar=[
'cProgSto
'personbo->CONNES
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'xDatOpe
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1387
var_op='asgn
I
obj='Remark
pag=5
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1323
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O1326
fatherSonIndex=0
frm_calc=[
'xTipo='2' or xTipo='3'  or xTipo='7'
'xTipo='4' or xTipo='5' or xTipo='8'
'xTipo='9'
]
h=[
19
19
19
19
]
obj='Case
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1400
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
next=Icpitembatch.CPWrite
arch='knarapbo
obj='Write
pag=5
prev=O1405
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(xRapporto)
]
wr_field=[
'DESCRAP
]
wr_op=[
'=
]
wr_var=[
'Left(LRTrim(cRagSoc),50)
]
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1405
fatherSonIndex=0
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow > 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1418
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xntestbo
father=O1420
fatherSonIndex=0
next=Icpitembatch.CPWrite
arch='xnarapbo
obj='Write
pag=5
prev=O1425
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'DESCRAP
]
wr_op=[
'=
]
wr_var=[
'Left(LRTrim(cRagSoc),50)
]
I
obj='Write
pag=5
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xRapporto
'cMaxRow
]
wr_field=[
'CODINTER
]
wr_op=[
'=
]
wr_var=[
'cConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1420
fatherSonIndex=1
frm_calc='''
len=16
name='xIDBx
next=Icpitembatch.CPRead
arch='xntestbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDBx))
]
h=[
19
19
]
obj='If
pag=5
prev=O1441
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1442
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1449
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=LRTrim(xRapporto) and xntestbo->CPROWNUM=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xntestbo
father=O1450
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'CODINTER
'DATAFINE
'NUMPROG1
'NUMPROG2
'RAPPORTO
'TIPORAP
'STATOREG
'PRGIMPSOG
'TIPOPERS
]
rd_kvar=[
'xIDB
'cMaxRow
'xntestbo->DATAINI
'cConnes
'xntestbo->DATAFINE
'xntestbo->NUMPROG1
'xntestbo->NUMPROG2
'xRapporto
'xntestbo->TIPORAP
''0'
'nProgImp2
''P'
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1448
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1447
var_op='asgn
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O1440
rd_field=[
'CODINTER
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'LRTrim(xRapporto)
'cConnes
]
rd_var=[
'xIDBx
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=5
par_expr=[
'xRapporto
]
par_name=[
'xRapporto
]
prev=O1417
sel_field='xntestbo->CPROWNUM
sel_name='qbe_offline_max_int
sel_order='xntestbo->CPROWNUM
sel_type='sqry
sel_where='xntestbo->RAPPORTO = xRapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1418
fatherSonIndex=0
frm_calc='qbe_offline_max_int->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1405
fatherSonIndex=1
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow > 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1472
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestbo
father=O1474
fatherSonIndex=0
next=Icpitembatch.CPWrite
arch='anarapbo
obj='Write
pag=5
prev=O1479
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'DESCRAP
]
wr_op=[
'=
]
wr_var=[
'Left(LRTrim(cRagSoc),50)
]
I
obj='Write
pag=5
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xRapporto)
'cMaxRow
]
wr_field=[
'CODINTER
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1474
fatherSonIndex=1
frm_calc='''
len=16
name='xIDBx
next=Icpitembatch.CPRead
arch='intestbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDBx))
]
h=[
19
19
]
obj='If
pag=5
prev=O1495
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1496
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1503
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=LRTrim(xRapporto) and intestbo->CPROWNUM=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='intestbo
father=O1504
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'CODINTER
'DATAFINE
'NUMPROG1
'NUMPROG2
'RAPPORTO
'TIPORAP
'STATOREG
'PRGIMPSOG
]
rd_kvar=[
'xIDB
'cMaxRow
'intestbo->DATAINI
'cConnes
'intestbo->DATAFINE
'intestbo->NUMPROG1
'intestbo->NUMPROG2
'LRTrim(intestbo->RAPPORTO)
'intestbo->TIPORAP
''0'
'nProgImp2
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1502
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1501
var_op='asgn
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O1494
rd_field=[
'CODINTER
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'LRTrim(xRapporto)
'cConnes
]
rd_var=[
'xIDBx
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=5
par_expr=[
'xRapporto
]
par_name=[
'xRapporto
]
prev=O1471
sel_field='xntestbo->CPROWNUM
sel_name='qbe_offline_max_int_d
sel_order='xntestbo->CPROWNUM
sel_type='sqry
sel_where='xntestbo->RAPPORTO = xRapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1472
fatherSonIndex=0
frm_calc='qbe_offline_max_int_d->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1400
fatherSonIndex=1
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPWrite
arch='xapopebo
father=O1526
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'cDelega='S'
]
h=[
19
19
]
obj='If
pag=5
prev=O1531
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1532
fatherSonIndex=0
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow = 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A'
'xTipoInf='C'
]
h=[
19
19
19
]
obj='If
pag=5
prev=O1540
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xelegabo
father=O1543
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xRapporto)
'cMaxRow
]
wr_field=[
'DATAINI
'NUMPROG1
]
wr_op=[
'=
'=
]
wr_var=[
'xDatOpe
'cInfProg2
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xelegabo
father=O1543
fatherSonIndex=1
obj='Write
pag=5
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xRapporto)
'cMaxRow
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'xDatOpe
'cInfProg2
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=5
prev=O1538
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1540
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='xelegabo
obj='Insert
pag=5
prev=O1568
rd_kfield=[
'RAPPORTO
'CPROWNUM
'CODINTER
'DESCINTER
'TIPORAP
'TIPOPERS
'STATOREG
'IDBASE
]
rd_kvar=[
'LRTrim(xRapporto)
'cMaxRow
'cConnes
'Substr(riga,51,70)
'xTipRap
''P'
''0'
'LibreriaMit.UniqueId()
]
I
obj='Var
obj_type='N
pag=5
prev=O1566
var_op='asgn
I
obj='Select
pag=5
sel_field='xelegabo->CPROWNUM
sel_name='delegabo
sel_order='xelegabo->CPROWNUM
sel_where='xelegabo->RAPPORTO=LRTrim(xRapporto)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1566
fatherSonIndex=0
frm_calc='xelegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1537
sel_field='xelegabo->CPROWNUM
sel_name='xelegabo
sel_where='xelegabo->RAPPORTO=LRTrim(xRapporto) and xelegabo->CODINTER=cConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1538
fatherSonIndex=0
frm_calc='xelegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Write
pag=5
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cInfProg1
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'cConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='rapopebo
father=O1526
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'cDelega='S'
]
h=[
19
19
]
obj='If
pag=5
prev=O1589
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1590
fatherSonIndex=0
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow = 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A'
'xTipoInf='C'
]
h=[
19
19
19
]
obj='If
pag=5
prev=O1598
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='delegabo
father=O1601
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xRapporto)
'cMaxRow
]
wr_field=[
'DATAINI
'NUMPROG1
]
wr_op=[
'=
'=
]
wr_var=[
'xDatOpe
'cInfProg2
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='delegabo
father=O1601
fatherSonIndex=1
obj='Write
pag=5
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xRapporto)
'cMaxRow
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'xDatOpe
'cInfProg2
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=5
prev=O1596
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1598
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='delegabo
obj='Insert
pag=5
prev=O1626
rd_kfield=[
'RAPPORTO
'CPROWNUM
'CODINTER
'DESCINTER
'TIPORAP
'TIPOPERS
'STATOREG
'IDBASE
]
rd_kvar=[
'LRTrim(xRapporto)
'cMaxRow
'cConnes
'Substr(riga,51,70)
'xTipRap
''P'
''0'
'LibreriaMit.UniqueId()
]
I
obj='Var
obj_type='N
pag=5
prev=O1624
var_op='asgn
I
obj='Select
pag=5
sel_field='delegabo->CPROWNUM
sel_name='delegabo
sel_order='delegabo->CPROWNUM
sel_where='delegabo->RAPPORTO=LRTrim(xRapporto)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1624
fatherSonIndex=0
frm_calc='delegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1595
sel_field='delegabo->CPROWNUM
sel_name='delegabo
sel_order='delegabo->CPROWNUM
sel_where='delegabo->RAPPORTO=LRTrim(xRapporto) and delegabo->CODINTER=cConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1596
fatherSonIndex=0
frm_calc='delegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Write
pag=5
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cInfProg1
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'cConnes
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1400
fatherSonIndex=2
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='xiduciabo
father=O1648
fatherSonIndex=0
obj='Merge
pag=5
rd_kfield=[
'RAPCOL
'CODSOG
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xRapporto
'cConnes
]
wr_field=[
'IDFILEBO
'IDBASE
'CODSOG
'RAPCOL
]
wr_mode=[
'ins
'ins
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'LibreriaMit.UniqueId()
'LibreriaMit.UniqueId()
'cConnes
'xRapporto
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='fiduciabo
father=O1648
fatherSonIndex=1
obj='Merge
pag=5
rd_kfield=[
'RAPCOL
'CODSOG
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xRapporto
'cConnes
]
wr_field=[
'IDFILEBO
'IDBASE
'CODSOG
'RAPCOL
]
wr_mode=[
'ins
'ins
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'LibreriaMit.UniqueId()
'LibreriaMit.UniqueId()
'cConnes
'xRapporto
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1322
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='personbo
father=O1323
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'CONNES
'CODFISC
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'AUTRILASC
'DATARILASC
'SESSO
'NASSTATO
'TIPOPERS
'ATTIV
'TIPINTER
]
rd_kvar=[
'LRTrim(xConnes)
'xCF
'Substr(riga,51,70)
'Substr(riga,124,6)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'CharToDate(Substr(riga,218,8))
'cCNAS
'Substr(riga,256,3)
'xRam
'Substr(riga,262,3)
'xTD
'Substr(riga,293,15)
'Substr(riga,316,30)
'CharToDate(Substr(riga,308,8))
'xSesso
'cSNAS
'cTipPer
'xATECO
'_prvnas
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1323
fatherSonIndex=1
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='personbo
obj='Write
pag=5
prev=O1682
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(xConnes)
]
wr_field=[
'CODFISC
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'AUTRILASC
'DATARILASC
'SESSO
'NASSTATO
'TIPOPERS
'ATTIV
'TIPINTER
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xCF
'Substr(riga,51,70)
'Substr(riga,124,6)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'CharToDate(Substr(riga,218,8))
'cCNAS
'Substr(riga,256,3)
'xRam
'Substr(riga,262,3)
'xTD
'Substr(riga,293,15)
'Substr(riga,316,30)
'CharToDate(Substr(riga,308,8))
'xSesso
'cSNAS
'cTipPer
'xATECO
'_prvnas
]
I
obj='If
pag=5
prev=O1680
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1682
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1694
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES = xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O1695
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'datamodi
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
'DATAVARAGE
'SETTSINT2
'FATCA
'BANCABEN
'TIN
'ODB
'TELEF
'TIPOORO
'CODORO
'IDNASCOMUN
'IDNASSTATO
'NOTIT
]
rd_kvar=[
'cProgSto
'xConnes
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'_dataope
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
'personbo->DATAVARAGE
'personbo->SETTSINT2
'personbo->FATCA
'personbo->BANCABEN
'personbo->TIN
'personbo->ODB
'personbo->TELEF
'personbo->TIPOORO
'personbo->CODORO
'personbo->IDNASCOMUN
'personbo->IDNASSTATO
'personbo->NOTIT
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1679
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=xConnes and wersonbo->datamodi=_dataope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1680
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=5
prev=O1319
var_op='asgn
I
obj='If
pag=5
prev=O1318
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1319
fatherSonIndex=0
frm_calc='''
len=2
name='xTD
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1315
var_op='asgn
I
obj='If
pag=5
prev=O1312
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1315
fatherSonIndex=0
frm_calc='iif(Substr(riga,259,3)='000','',Substr(riga,259,3))
len=3
name='xRam
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xATECO
obj='Var
pag=5
prev=O1715
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1315
fatherSonIndex=1
frm_calc='''
len=3
name='xRam
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,259,3)='000','',Substr(riga,259,3))
len=10
name='xATECO
obj='Var
pag=5
prev=O1718
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=5
prev=O1309
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1312
fatherSonIndex=0
frm_calc=[
'Substr(xCF,12,1) = 'Z' and Len(LRTrim(xCF))=16
'Substr(xCF,12,1) <> 'Z' and Len(LRTrim(xCF))=16
]
h=[
19
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1723
fatherSonIndex=0
frm_calc='Substr(riga,226,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='_prvnas
obj='Var
pag=5
prev=O1729
var_op='asgn
I
obj='Var
pag=5
prev=O1728
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O1723
fatherSonIndex=1
obj='Read
pag=5
rd_field=[
'PROV
]
rd_kfield=[
'SIGLA
]
rd_kvar=[
'Substr(xCF,12,4)
]
rd_var=[
'_prvnas
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1312
fatherSonIndex=1
frm_calc='Substr(riga,226,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='_prvnas
obj='Var
pag=5
prev=O1740
var_op='asgn
I
obj='Var
pag=5
prev=O1739
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Case
pag=5
prev=O1308
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1309
fatherSonIndex=0
frm_calc=''1'
len=1
name='xSesso
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1309
fatherSonIndex=1
frm_calc=''2'
len=1
name='xSesso
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1309
fatherSonIndex=2
frm_calc='Substr(riga,346,1)
len=1
name='xSesso
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1307
var_op='asgn
I
obj='Var
pag=5
prev=O1306
var_op='asgn
I
obj='Var
pag=5
prev=O1303
var_op='asgn
I
obj='If
pag=5
prev=O1302
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1303
fatherSonIndex=0
frm_calc=''S'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,35,16))
len=16
name='cConnes
obj='Var
pag=5
prev=O1753
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O1301
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(xConnes)
]
rd_var=[
'cConnes
]
I
obj='Var
pag=5
prev=O1300
var_op='asgn
I
obj='Var
pag=5
prev=O1299
var_op='asgn
I
obj='Var
pag=5
prev=O1298
var_op='asgn
I
obj='Remark
pag=5
x=14
y=16
I
Icpitembatch.CPRemark
frm_calc='Controllo se apertura o chiusura o altro
next=Icpitembatch.CPCase
frm_calc=[
'At(Substr(riga,234,2),'|26|28|36|38|46|51|53') > 0
'At(Substr(riga,234,2),'|21|22|23|25|33|34|35|37|43|44|45|50|52|58') > 0
'At(Substr(riga,234,2),'|31|54') > 0
'At(Substr(riga,234,2),'|32|55') > 0
]
h=[
19
19
19
19
19
19
]
haselse=True
obj='Case
pag=6
prev=O1760
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1761
fatherSonIndex=0
frm_calc=''C'
len=1
name='xTipoInf
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1761
fatherSonIndex=1
frm_calc=''A'
len=1
name='xTipoInf
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1761
fatherSonIndex=2
frm_calc=''P'
len=1
name='xTipoInf
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1761
fatherSonIndex=3
frm_calc=''D'
len=1
name='xTipoInf
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1761
fatherSonIndex=4
frm_calc=''X'
len=1
name='xTipoInf
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
150
150
150
]
I
obj='Remark
pag=6
x=18
y=28
I
Icpitembatch.CPRemark
frm_calc='Importa i dati base delle operazioni
next=Icpitembatch.CPVarDecl
comment='Contatore Operazioni
frm_calc='cNumOpe + 1
len=10
name='cNumOpe
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,199,25),Space(25)))
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,224,1),Space(1))
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,35,6)
len=6
name='xDIP
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xDIP)))
]
h=[
19
19
]
next=Icpitembatch.CPRead
arch='tbcauana
next=Icpitembatch.CPInsert
arch='tmp_operazbo_ol
h=[
19
19
]
obj='Insert
pag=7
prev=O1789
rd_kfield=[
'IDBASE
'NUMPROG
'DATAOPE
'TIPOINTER
'CODINTER
'TIPOINF
'IDEREG
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'OPRAP
'TIPOOPRAP
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'STATOREG
'OPERAZMOD
'DATARETT
'RIFIMP
'idcauana
'CDATOPE
'CDATAOPE
'PRGIMPOPE
'CDATREG
'COLLEG
]
rd_kvar=[
'cOpeProg1
'cOpeProg2
'CharToDate(Substr(riga,79,8))
'Substr(riga,1,2)
'Substr(riga,3,11)
''1'
'Substr(riga,79,8) + cOpeProg2 + Substr(riga,248,1)
'Substr(riga,35,6)
'Substr(riga,47,30)
'Substr(riga,77,2)
'Substr(riga,41,6)
'Substr(riga,87,1)
'Substr(riga,88,1)
'Substr(riga,89,4)
'Substr(riga,93,2)
'Substr(riga,95,2)
'Substr(riga,97,11)
'Substr(riga,108,3)
'Substr(riga,117,30)
'Substr(riga,147,2)
'Substr(riga,111,6)
'Substr(riga,149,50)
'xRapporto
'xTipRap
'Substr(riga,225,1)
'CharToDate(Substr(riga,226,8))
'Substr(riga,234,1)
'Substr(riga,234,2)
'Substr(riga,277,1)
'Substr(riga,278,3)
'Substr(riga,281,1)
'Val(Substr(riga,282,15))
'Val(Substr(riga,297,15))
'Substr(riga,248,1)
'Substr(riga,257,20)
'CharToDate(Substr(riga,249,8))
'LRTrim(Substr(riga,236,12))
'cIdCau
'Substr(riga,79,8)
'Substr(riga,79,8)
'nProgImp
'Substr(riga,226,8)
'LRTrim(Substr(riga,236,12))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1790
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+w_nomefile+" per l'operazione in data "+Substr(riga,79,8)+" con importo "+Str((Val(Substr(riga,282,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=7
prev=O1796
I
nonlocal=True
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Read
pag=7
prev=O1786
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,89,4)
'Substr(riga,93,2)
]
rd_var=[
'cIdCau
]
I
obj='If
pag=7
prev=O1785
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anadip
father=O1786
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDIPx))
]
h=[
19
19
]
obj='If
pag=7
prev=O1805
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anadip
father=O1806
fatherSonIndex=0
obj='Insert
pag=7
rd_kfield=[
'CODDIP
'DESCRIZ
]
rd_kvar=[
'xDIP
'xDIP
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=7
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'xDIP
]
rd_var=[
'xDIPx
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=7
prev=O1784
var_op='asgn
I
obj='Var
pag=7
prev=O1783
var_op='asgn
I
obj='Var
pag=7
prev=O1782
var_op='asgn
I
obj='Var
pag=7
prev=O1781
var_op='asgn
I
obj='Var
pag=7
prev=O1780
var_op='asgn
I
obj='Var
obj_type='N
pag=7
prev=O1779
var_op='asgn
I
obj='Var
pag=7
prev=O1778
var_op='asgn
I
obj='Var
pag=7
prev=O1777
var_op='asgn
I
obj='Var
obj_type='N
pag=7
prev=O1776
var_op='asgn
I
obj='Remark
pag=7
x=15
y=20
I
Icpitembatch.CPRemark
frm_calc='Importa i dati base dei rapporti
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='cNumInf + 1
len=10
name='cNumInf
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,199,25),Space(25)))
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,224,1),Space(1))
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,248,1)='2','2',iif(Substr(riga,248,1)='0','S','A'))
len=1
name='streg
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,35,6)
len=6
name='xDIP
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xDIP)))
]
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='tmp_rapopebo_ol
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Inserisce Rapporto e Intestatario
h=[
19
19
]
obj='Begin
pag=8
prev=O1834
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1836
fatherSonIndex=0
frm_calc='''
len=25
name='xAppRap
next=Icpitembatch.CPRead
arch='tmp_anarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xAppRap))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='xTipoInf
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPExec
check='page
frm_calc='6
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A' or xTipoInf='C'
]
h=[
19
19
]
obj='If
pag=8
prev=O1847
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tmp_intestbo_ol
father=O1848
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A'
'xTipoInf='C'
]
h=[
19
19
19
]
obj='If
pag=8
prev=O1854
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tmp_intestbo_ol
father=O1857
fatherSonIndex=0
obj='Write
pag=8
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'TIPOPERS
'DATAINI
]
wr_op=[
'=
'=
]
wr_var=[
''P'
'CharToDate(Substr(riga,79,8))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tmp_intestbo_ol
father=O1857
fatherSonIndex=1
obj='Write
pag=8
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Substr(riga,79,8))
'cInfProg2
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=8
prev=O1853
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1854
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPInsert
arch='tmp_intestbo_ol
h=[
19
19
]
obj='Insert
pag=8
prev=O1881
rd_kfield=[
'IDBASE
'CPROWNUM
'NUMPROG1
'STATOREG
'RAPPORTO
'TIPORAP
'PRGIMPSOG
'TIPOPERS
]
rd_kvar=[
'xIDB
'1
'cInfProg2
''0'
'xRapporto
'Substr(riga,224,1)
'nProgImp2
''P'
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1882
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+w_nomefile+" per la registrazione dell'intestatario dell'informazione in data "+Substr(riga,79,8)+" relativa al rapporto: "+ xRapporto +" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=8
prev=O1888
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=8
prev=O1880
var_op='asgn
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
rd_field=[
'IDBASE
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'xRapporto
]
rd_var=[
'xIDB
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=8
prev=O1846
I
obj='Var
pag=8
prev=O1845
var_op='asgn
I
obj='Var
pag=8
prev=O1842
var_op='asgn
I
obj='If
pag=8
prev=O1841
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Rapporti
father=O1842
fatherSonIndex=0
frm_calc='cNumRap + 1
len=10
name='cNumRap
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgRap
next=Icpitembatch.CPInsert
arch='tmp_anarapbo
obj='Insert
pag=8
prev=O1900
rd_kfield=[
'RAPPORTO
'TIPORAP
'FLAGLIRE
'VALUTA
]
rd_kvar=[
'xRapporto
'Substr(riga,224,1)
'iif(Substr(riga,277,1)='1','L',iif(Substr(riga,277,1)='2','V','E'))
'Substr(riga,278,3)
]
I
obj='Var
obj_type='N
pag=8
prev=O1899
var_op='asgn
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
prev=O1840
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'xRapporto
]
rd_var=[
'xAppRap
]
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=8
prev=O1831
rd_kfield=[
'IDBASE
'NUMPROG
'DATAOPE
'TIPOINTER
'CODINTER
'TIPOINF
'IDEREG
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'OPRAP
'TIPOOPRAP
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'STATOREG
'OPERAZMOD
'DATARETT
'COLLEG
'PRGIMPINF
'CDATREG
'CDATOPE
]
rd_kvar=[
'cInfProg1
'cInfProg2
'CharToDate(Substr(riga,79,8))
'Substr(riga,1,2)
'Substr(riga,3,11)
''1'
'Substr(riga,79,8) + cOpeProg2 + streg
'Substr(riga,35,6)
'Substr(riga,47,30)
'Substr(riga,77,2)
'Substr(riga,41,6)
'Substr(riga,87,1)
'Substr(riga,88,1)
'Substr(riga,89,4)
'Substr(riga,93,2)
'Substr(riga,95,2)
'Substr(riga,97,11)
'Substr(riga,108,3)
'Substr(riga,117,30)
'Substr(riga,147,2)
'Substr(riga,111,6)
'Substr(riga,149,50)
'xRapporto
'xTipRap
'Substr(riga,225,1)
'CharToDate(Substr(riga,226,8))
'Substr(riga,234,1)
'Substr(riga,234,2)
'Substr(riga,277,1)
'Substr(riga,278,3)
'Substr(riga,281,1)
'Val(Substr(riga,282,15))
'Val(Substr(riga,297,15))
'Substr(riga,248,1)
'Substr(riga,257,20)
'CharToDate(Substr(riga,249,8))
'Substr(riga,236,12)
'nProgImp
'Substr(riga,226,8)
'Substr(riga,79,8)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1834
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+w_nomefile+" per l'informazione in data "+Substr(riga,79,8)+" relativa al rapporto: "+xRapporto+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=8
prev=O1914
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='If
pag=8
prev=O1830
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anadip
father=O1831
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDIPx))
]
h=[
19
19
]
obj='If
pag=8
prev=O1919
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anadip
father=O1920
fatherSonIndex=0
obj='Insert
pag=8
rd_kfield=[
'CODDIP
'DESCRIZ
]
rd_kvar=[
'xDIP
'xDIP
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'xDIP
]
rd_var=[
'xDIPx
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
prev=O1829
var_op='asgn
I
obj='Var
pag=8
prev=O1828
var_op='asgn
I
obj='Var
pag=8
prev=O1827
var_op='asgn
I
obj='Var
pag=8
prev=O1826
var_op='asgn
I
obj='Var
pag=8
prev=O1825
var_op='asgn
I
obj='Var
pag=8
prev=O1824
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O1823
var_op='asgn
I
obj='Var
pag=8
prev=O1822
var_op='asgn
I
obj='Var
pag=8
prev=O1821
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O1820
var_op='asgn
I
obj='Remark
pag=8
x=21
y=23
I
Icpitembatch.CPRemark
frm_calc='Importa i soggetti dei rapporti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,35,16))
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,202,16)
len=16
name='xCF
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCF)) and Empty(LRTrim(xConnes))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,51,70)
len=70
name='cRagSoc
next=Icpitembatch.CPIfElse
frm_calc=[
'xNewSog = 'S'
]
h=[
19
19
]
next=Icpitembatch.CPCase
frm_calc=[
'xTipo='2' or xTipo='3'
'xTipo='4' or xTipo='5'
]
h=[
19
19
19
]
obj='Case
pag=10
prev=O1941
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1944
fatherSonIndex=0
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPRead
arch='tmp_intestbo_ol
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDBx))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
prev=O1952
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tmp_intestbo_ol
father=O1953
fatherSonIndex=0
next=Icpitembatch.CPWrite
arch='tmp_anarapbo
obj='Write
pag=10
prev=O1958
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'DESCRAP
]
wr_op=[
'=
]
wr_var=[
'Left(LRTrim(cRagSoc),50)
]
I
obj='Write
pag=10
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xRapporto
'cMaxRow
]
wr_field=[
'CODINTER
]
wr_op=[
'=
]
wr_var=[
'cConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1953
fatherSonIndex=1
frm_calc='''
len=16
name='xIDBx
next=Icpitembatch.CPRead
arch='tmp_intestbo_ol
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDBx))
]
h=[
19
19
]
obj='If
pag=10
prev=O1974
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1975
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=10
prev=O1982
sel_field='*
sel_name='tmp_intestbo_ol
sel_where='tmp_intestbo_ol->RAPPORTO=xRapporto and tmp_intestbo_ol->CPROWNUM=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tmp_intestbo_ol
father=O1983
fatherSonIndex=0
obj='Insert
pag=10
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'CODINTER
'DATAFINE
'NUMPROG1
'NUMPROG2
'RAPPORTO
'TIPORAP
'STATOREG
'PRGIMPSOG
'TIPOPERS
]
rd_kvar=[
'xIDB
'cMaxRow
'tmp_intestbo_ol->DATAINI
'cConnes
'tmp_intestbo_ol->DATAFINE
'tmp_intestbo_ol->NUMPROG1
'tmp_intestbo_ol->NUMPROG2
'xRapporto
'tmp_intestbo_ol->TIPORAP
''0'
'nProgImp2
''P'
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
prev=O1981
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O1980
var_op='asgn
I
obj='Var
obj_type='N
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
prev=O1973
rd_field=[
'CODINTER
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'xRapporto
'cConnes
]
rd_var=[
'xIDBx
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=10
prev=O1950
rd_field=[
'CODINTER
]
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kvar=[
'xRapporto
'cMaxRow
]
rd_var=[
'xIDBx
]
I
obj='Select
pag=10
prev=O1949
sel_field='tmp_intestbo_ol->CPROWNUM
sel_name='tmp_intestbo_ol
sel_order='tmp_intestbo_ol->CPROWNUM
sel_where='tmp_intestbo_ol->RAPPORTO=xRapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1950
fatherSonIndex=0
frm_calc='tmp_intestbo_ol->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tmp_rapopebo_ol
father=O1944
fatherSonIndex=1
obj='Write
pag=10
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cInfProg1
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'cConnes
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=10
prev=O1940
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
father=O1941
fatherSonIndex=0
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,346,1)='M'
'Substr(riga,346,1)='F'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,226,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(xCF,12,1) = 'Z' and Len(LRTrim(xCF))=16
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,259,3)='000','',Substr(riga,259,3))
len=3
name='xRam
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,291,2)
len=2
name='xTD
next=Icpitembatch.CPIfElse
frm_calc=[
'xTD <> '01' and xTD <> '02' and xTD <> '03' and xTD <> '04' and xTD <> '05' and xTD <> '06'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Len(LRTrim(xCF))=16,'P','G')
len=1
name='cTipPer
next=Icpitembatch.CPInsert
arch='personbo
obj='Insert
pag=10
prev=O2031
rd_kfield=[
'CONNES
'CODFISC
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'AUTRILASC
'DATARILASC
'SESSO
'NASSTATO
'TIPOPERS
]
rd_kvar=[
'xConnes
'xCF
'Substr(riga,51,70)
'Substr(riga,124,6)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'CharToDate(Substr(riga,218,8))
'cCNAS
'Substr(riga,256,3)
'xRam
'Substr(riga,262,3)
'xTD
'Substr(riga,293,15)
'Substr(riga,316,30)
'CharToDate(Substr(riga,308,8))
'xSesso
'cSNAS
'cTipPer
]
I
obj='Var
pag=10
prev=O2028
var_op='asgn
I
obj='If
pag=10
prev=O2027
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2028
fatherSonIndex=0
frm_calc='''
len=2
name='xTD
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
prev=O2026
var_op='asgn
I
obj='Var
pag=10
prev=O2023
var_op='asgn
I
obj='If
pag=10
prev=O2022
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2023
fatherSonIndex=0
frm_calc='Substr(riga,226,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=10
prev=O2041
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
prev=O2021
var_op='asgn
I
obj='Var
pag=10
prev=O2018
var_op='asgn
I
obj='Case
pag=10
prev=O2017
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2018
fatherSonIndex=0
frm_calc=''1'
len=1
name='xSesso
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2018
fatherSonIndex=1
frm_calc=''2'
len=1
name='xSesso
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2018
fatherSonIndex=2
frm_calc='Substr(riga,346,1)
len=1
name='xSesso
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
obj_type='N
pag=10
prev=O2016
var_op='asgn
I
obj='Var
obj_type='N
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
prev=O1937
var_op='asgn
I
obj='If
pag=10
prev=O1936
sons=[
Icpitembatch.CPItemSon
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1937
fatherSonIndex=1
frm_calc=''N'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='cConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cConnes))
]
h=[
19
19
]
obj='If
pag=10
prev=O2058
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2059
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(xCF))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2064
fatherSonIndex=0
frm_calc=''S'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cConnes
obj='Var
pag=10
prev=O2069
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2064
fatherSonIndex=1
frm_calc='''
len=16
name='cConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cConnes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
prev=O2073
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2074
fatherSonIndex=0
frm_calc=''S'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cConnes
obj='Var
pag=10
prev=O2079
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2074
fatherSonIndex=1
frm_calc='cConnes
len=16
name='xConnes
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=10
prev=O2072
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xCF
]
rd_var=[
'cConnes
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
prev=O2057
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'cConnes
]
I
obj='Var
pag=10
prev=O2056
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=10
prev=O1935
var_op='asgn
I
obj='Var
pag=10
prev=O1934
var_op='asgn
I
obj='Remark
pag=10
x=18
y=22
I
Icpitembatch.CPRemark
frm_calc='Importa i soggetti delle operazioni
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,35,16))
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,202,16)
len=16
name='xCF
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCF)) and Empty(LRTrim(xConnes))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'xNewSog = 'S'
]
h=[
19
19
]
next=Icpitembatch.CPCase
frm_calc=[
'xTipo='2' or xTipo='3'
'xTipo='4'
'xTipo='5'
]
h=[
19
19
19
19
]
obj='Case
pag=9
prev=O2101
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tmp_operazbo_ol
father=O2104
fatherSonIndex=0
obj='Write
pag=9
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tmp_operazbo_ol
father=O2104
fatherSonIndex=1
obj='Write
pag=9
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tmp_operazbo_ol
father=O2104
fatherSonIndex=2
obj='Write
pag=9
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESBEN
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
]
w=[
150
150
150
150
]
I
obj='If
pag=9
prev=O2098
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
father=O2101
fatherSonIndex=0
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,346,1)='M'
'Substr(riga,346,1)='F'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,226,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(xCF,12,1) = 'Z' and Len(LRTrim(xCF))=16
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,259,3)='000','',Substr(riga,259,3))
len=3
name='xRam
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,291,2)
len=2
name='xTD
next=Icpitembatch.CPIfElse
frm_calc=[
'xTD <> '01' and xTD <> '02' and xTD <> '03' and xTD <> '04' and xTD <> '05' and xTD <> '06'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Len(LRTrim(xCF))=16,'P','G')
len=1
name='cTipPer
next=Icpitembatch.CPInsert
arch='personbo
obj='Insert
pag=9
prev=O2150
rd_kfield=[
'CONNES
'CODFISC
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'AUTRILASC
'DATARILASC
'SESSO
'NASSTATO
'TIPOPERS
]
rd_kvar=[
'xConnes
'xCF
'Substr(riga,51,70)
'Substr(riga,124,6)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'CharToDate(Substr(riga,218,8))
'cCNAS
'Substr(riga,256,3)
'xRam
'Substr(riga,262,3)
'xTD
'Substr(riga,293,15)
'Substr(riga,316,30)
'CharToDate(Substr(riga,308,8))
'xSesso
'cSNAS
'cTipPer
]
I
obj='Var
pag=9
prev=O2147
var_op='asgn
I
obj='If
pag=9
prev=O2146
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2147
fatherSonIndex=0
frm_calc='''
len=2
name='xTD
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O2145
var_op='asgn
I
obj='Var
pag=9
prev=O2142
var_op='asgn
I
obj='If
pag=9
prev=O2141
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2142
fatherSonIndex=0
frm_calc='Substr(riga,226,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=9
prev=O2160
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O2140
var_op='asgn
I
obj='Var
pag=9
prev=O2137
var_op='asgn
I
obj='Case
pag=9
prev=O2136
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2137
fatherSonIndex=0
frm_calc=''1'
len=1
name='xSesso
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2137
fatherSonIndex=1
frm_calc=''2'
len=1
name='xSesso
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2137
fatherSonIndex=2
frm_calc='Substr(riga,346,1)
len=1
name='xSesso
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
obj_type='N
pag=9
prev=O2135
var_op='asgn
I
obj='Var
obj_type='N
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O2097
sons=[
Icpitembatch.CPItemSon
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2098
fatherSonIndex=1
frm_calc=''N'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='cConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cConnes))
]
h=[
19
19
]
obj='If
pag=9
prev=O2177
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2178
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(xCF))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2183
fatherSonIndex=0
frm_calc=''S'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cConnes
obj='Var
pag=9
prev=O2188
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2183
fatherSonIndex=1
frm_calc='''
len=16
name='cConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cConnes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
prev=O2192
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2193
fatherSonIndex=0
frm_calc=''S'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cConnes
obj='Var
pag=9
prev=O2198
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2193
fatherSonIndex=1
frm_calc='cConnes
len=16
name='xConnes
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=9
prev=O2191
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xCF
]
rd_var=[
'cConnes
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=9
prev=O2176
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'cConnes
]
I
obj='Var
pag=9
prev=O2175
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=9
prev=O2096
var_op='asgn
I
obj='Var
pag=9
prev=O2095
var_op='asgn
I
obj='Remark
pag=9
x=15
y=20
I
Icpitembatch.CPRemark
frm_calc='Importa i dati base dei rapporti
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='cNumTit + 1
len=10
name='cNumTit
next=Icpitembatch.CPVarDecl
frm_calc=''S'
len=1
name='_titpost
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xTitolare
next=Icpitembatch.CPVarDecl
frm_calc=''N'
len=1
name='_tipo6b
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcTipo6
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=11
prev=O2219
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2220
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGPTIT1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPTIT2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='cInfProg2
len=11
name='cInfTit
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTIT\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,199,25),Space(25)))
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,224,1),Space(1))
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,248,1)='2','2',iif(Substr(riga,248,1)='0','S','A'))
len=1
name='streg
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,35,6)
len=6
name='xDIP
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xDIP)))
]
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xapotit
h=[
19
19
]
obj='Insert
pag=11
prev=O2235
rd_kfield=[
'IDBASE
'NUMPROG
'DATAOPE
'TIPOINTER
'CODINTER
'TIPOINF
'IDEREG
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'OPRAP
'TIPOOPRAP
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'STATOREG
'OPERAZMOD
'DATARETT
'COLLEG
'PRGIMPTIT
'CDATOPE
'CDATREG
]
rd_kvar=[
'cInfProg1
'cInfProg2
'CharToDate(Substr(riga,79,8))
'Substr(riga,1,2)
'Substr(riga,3,11)
''1'
'Substr(riga,79,8) + cOpeProg2 + streg
'Substr(riga,35,6)
'Substr(riga,47,30)
'Substr(riga,77,2)
'Substr(riga,41,6)
'Substr(riga,87,1)
'Substr(riga,88,1)
'Substr(riga,89,4)
'Substr(riga,93,2)
'Substr(riga,95,2)
'Substr(riga,97,11)
'Substr(riga,108,3)
'Substr(riga,117,30)
'Substr(riga,147,2)
'Substr(riga,111,6)
'Substr(riga,149,50)
'xRapporto
'xTipRap
'Substr(riga,225,1)
'CharToDate(Substr(riga,226,8))
'Substr(riga,234,1)
'Substr(riga,234,2)
'Substr(riga,277,1)
'Substr(riga,278,3)
'Substr(riga,281,1)
'Val(Substr(riga,282,15))
'Val(Substr(riga,297,15))
'Substr(riga,248,1)
'Substr(riga,257,20)
'CharToDate(Substr(riga,249,8))
'Substr(riga,236,12)
'nProgImp
'Substr(riga,79,8)
'Substr(riga,226,8)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2238
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+w_nomefile+" per l'informazione in data "+Substr(riga,79,8)+" relativa al legame: "+xRapporto+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=11
prev=O2244
I
nonlocal=True
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='If
pag=11
prev=O2234
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anadip
father=O2235
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDIPx))
]
h=[
19
19
]
obj='If
pag=11
prev=O2249
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anadip
father=O2250
fatherSonIndex=0
obj='Insert
pag=11
rd_kfield=[
'CODDIP
'DESCRIZ
]
rd_kvar=[
'xDIP
'xDIP
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=11
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'xDIP
]
rd_var=[
'xDIPx
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=11
prev=O2233
var_op='asgn
I
obj='Var
pag=11
prev=O2232
var_op='asgn
I
obj='Var
pag=11
prev=O2231
var_op='asgn
I
obj='Var
pag=11
prev=O2230
var_op='asgn
I
obj='Var
pag=11
prev=O2229
var_op='asgn
I
obj='Var
pag=11
prev=O2228
var_op='asgn
I
obj='Var
obj_type='N
pag=11
prev=O2227
var_op='asgn
I
obj='Var
pag=11
prev=O2226
var_op='asgn
I
obj='Var
pag=11
prev=O2225
var_op='asgn
I
obj='Var
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2220
fatherSonIndex=1
frm_calc='''
len=1
name='xTipoInf
next=Icpitembatch.CPExec
check='page
frm_calc='6
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf <> 'X'
]
h=[
19
19
]
obj='If
pag=11
prev=O2266
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2267
fatherSonIndex=0
frm_calc=[
'Substr(riga,248,1)='0' or (At(Substr(riga,248,1),'|3|2') >0 and LRTrim(Substr(riga,257,20))='')
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(cInfProg2))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=11
prev=O2272
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2275
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGTITO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='cInfProg2
len=11
name='cInfTit
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTIT\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,199,25),Space(25)))
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,224,1),Space(1))
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Substr(riga,79,8))
len=8
name='xDatOpe
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Substr(riga,226,8))
len=8
name='xDatReg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,248,1)='2','2',iif(Substr(riga,248,1)='0','S','A'))
len=1
name='streg
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,35,6)
len=6
name='xDIP
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xDIP)))
]
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='rapotit
h=[
19
19
]
obj='Insert
pag=11
prev=O2291
rd_kfield=[
'IDBASE
'NUMPROG
'DATAOPE
'TIPOINTER
'CODINTER
'TIPOINF
'IDEREG
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'OPRAP
'TIPOOPRAP
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'STATOREG
'OPERAZMOD
'DATARETT
'COLLEG
'PRGIMPTIT
'CDATOPE
'CDATREG
]
rd_kvar=[
'cInfProg1
'cInfProg2
'CharToDate(Substr(riga,79,8))
'Substr(riga,1,2)
'Substr(riga,3,11)
''1'
'Substr(riga,15,20)
'Substr(riga,35,6)
'Substr(riga,47,30)
'Substr(riga,77,2)
'Substr(riga,41,6)
'Substr(riga,87,1)
'Substr(riga,88,1)
'Substr(riga,89,4)
'Substr(riga,93,2)
'Substr(riga,95,2)
'Substr(riga,97,11)
'Substr(riga,108,3)
'Substr(riga,117,30)
'Substr(riga,147,2)
'Substr(riga,111,6)
'Substr(riga,149,50)
'xRapporto
'xTipRap
'Substr(riga,225,1)
'CharToDate(Substr(riga,226,8))
'Substr(riga,234,1)
'Substr(riga,234,2)
'Substr(riga,277,1)
'Substr(riga,278,3)
'Substr(riga,281,1)
'Val(Substr(riga,282,15))
'Val(Substr(riga,297,15))
'Substr(riga,248,1)
'Substr(riga,257,20)
'CharToDate(Substr(riga,248,8))
'Substr(riga,236,12)
'nProgImp
'Substr(riga,79,8)
'Substr(riga,226,8)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2294
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+w_nomefile+" per l'informazione in data "+Substr(riga,79,8)+" relativa al legame: "+xRapporto+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=11
prev=O2300
I
nonlocal=True
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='If
pag=11
prev=O2290
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='anadip
father=O2291
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDIPx))
]
h=[
19
19
]
obj='If
pag=11
prev=O2305
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anadip
father=O2306
fatherSonIndex=0
obj='Insert
pag=11
rd_kfield=[
'CODDIP
'DESCRIZ
]
rd_kvar=[
'xDIP
'xDIP
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=11
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'xDIP
]
rd_var=[
'xDIPx
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=11
prev=O2289
var_op='asgn
I
obj='Var
pag=11
prev=O2288
var_op='asgn
I
obj='Var
pag=11
prev=O2287
var_op='asgn
I
obj='Var
pag=11
prev=O2286
var_op='asgn
I
obj='Var
obj_type='D
pag=11
prev=O2285
var_op='asgn
I
obj='Var
obj_type='D
pag=11
prev=O2284
var_op='asgn
I
obj='Var
pag=11
prev=O2283
var_op='asgn
I
obj='Var
pag=11
prev=O2282
var_op='asgn
I
obj='Var
obj_type='N
pag=11
prev=O2281
var_op='asgn
I
obj='Var
pag=11
prev=O2280
var_op='asgn
I
obj='Var
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2275
fatherSonIndex=1
frm_calc=''S'
len=1
name='_titpost
next=Icpitembatch.CPVarDecl
frm_seek='AppendBlank
name='mcTitolari
next=Icpitembatch.CPVarDecl
frm_calc='riga
frm_seek='testo
name='mcTitolari
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcTitolari
obj='Var
obj_type='MC
pag=11
prev=O2323
var_op='meth
I
obj='Var
obj_type='MC
pag=11
prev=O2322
var_op='prop
I
obj='Var
obj_type='MC
pag=11
prev=O2321
var_op='meth
I
obj='Var
pag=11
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=11
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2272
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGTITO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
obj='Var
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='rapotit
father=O2272
fatherSonIndex=1
obj='Read
pag=11
rd_field=[
'NUMPROG
]
rd_kfield=[
'IDEREG
]
rd_kvar=[
'Substr(riga,257,20)
]
rd_var=[
'cInfProg2
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=11
prev=O2265
I
obj='Var
pag=11
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='MC
pag=11
prev=O2218
var_op='meth
I
obj='Var
pag=11
prev=O2217
var_op='asgn
I
obj='Var
pag=11
prev=O2216
var_op='asgn
I
obj='Var
pag=11
prev=O2215
var_op='asgn
I
obj='Var
obj_type='N
pag=11
prev=O2214
var_op='asgn
I
obj='Remark
pag=11
x=16
y=17
I
Icpitembatch.CPBeginEnd
comment='Crea/Aggiorna anagrafica soggetto
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_soloanag <> 'S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='P'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='D'
]
h=[
19
19
]
obj='If
pag=12
prev=O2343
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
father=O2346
fatherSonIndex=0
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,346,1)='M'
'Substr(riga,346,1)='F'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,226,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(xCF,12,1) = 'Z' and Len(LRTrim(xCF))=16
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgrae = 'R'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,291,2)
len=2
name='xTD
next=Icpitembatch.CPIfElse
frm_calc=[
'xTD <> '01' and xTD <> '02' and xTD <> '03' and xTD <> '04' and xTD <> '05' and xTD <> '06'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Len(LRTrim(xCF))=16,'P','G')
len=1
name='cTipPer
next=Icpitembatch.CPWrite
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipo='6' and not(Empty(xTitolare))
]
h=[
19
19
]
obj='If
pag=12
prev=O2368
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='intestit
father=O2369
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDBx))
]
h=[
19
19
]
obj='If
pag=12
prev=O2374
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2375
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPMerge
arch='intestit
obj='Merge
pag=12
prev=O2380
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xTitolare)
'LRTrim(cConnes)
]
wr_field=[
'CODCLI
'CODINTER
'IDBASE
'PRGIMPTITE
]
wr_mode=[
'ins
'ins
'ins
'ins
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xTitolare)
'LRTrim(cConnes)
'LibreriaMit.UniqueId()
'nProgImp2
]
I
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
rd_field=[
'IDBASE
'PRGIMPTITE
]
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kvar=[
'LRTrim(xTitolare)
'LRTrim(cConnes)
]
rd_var=[
'xIDBx
'nProgImp2
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=12
prev=O2367
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'cConnes
]
wr_field=[
'CODFISC
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'AUTRILASC
'DATARILASC
'SESSO
'NASSTATO
'TIPOPERS
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xCF
'Substr(riga,51,70)
'Substr(riga,124,6)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'CharToDate(Substr(riga,218,8))
'cCNAS
'Substr(riga,256,3)
'xRam
'Substr(riga,262,3)
'xTD
'Substr(riga,293,15)
'Substr(riga,316,30)
'CharToDate(Substr(riga,308,8))
'xSesso
'cSNAS
'cTipPer
]
I
obj='Var
pag=12
prev=O2364
var_op='asgn
I
obj='If
pag=12
prev=O2363
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2364
fatherSonIndex=0
frm_calc='''
len=2
name='xTD
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=12
prev=O2360
var_op='asgn
I
obj='If
pag=12
prev=O2357
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2360
fatherSonIndex=0
frm_calc='iif(Substr(riga,259,3)='000','',Substr(riga,259,3))
len=3
name='xRam
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2360
fatherSonIndex=1
frm_calc='''
len=3
name='xRam
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=12
prev=O2356
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2357
fatherSonIndex=0
frm_calc='Substr(riga,226,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=12
prev=O2413
var_op='asgn
I
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=12
prev=O2355
var_op='asgn
I
obj='Var
pag=12
prev=O2352
var_op='asgn
I
obj='Case
pag=12
prev=O2351
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2352
fatherSonIndex=0
frm_calc=''1'
len=1
name='xSesso
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2352
fatherSonIndex=1
frm_calc=''2'
len=1
name='xSesso
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2352
fatherSonIndex=2
frm_calc='Substr(riga,346,1)
len=1
name='xSesso
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=12
prev=O2340
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O2343
fatherSonIndex=0
frm_calc='Calcola il progressivo di registrazione
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipo='6' and not(Empty(xTitolare))
]
h=[
19
19
]
obj='If
pag=12
prev=O2429
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='intestit
father=O2431
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDBx))
]
h=[
19
19
]
obj='If
pag=12
prev=O2436
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2437
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPMerge
arch='intestit
obj='Merge
pag=12
prev=O2442
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xTitolare)
'LRTrim(cConnes)
]
wr_field=[
'CODCLI
'CODINTER
'IDBASE
'PRGIMPTITE
]
wr_mode=[
'ins
'ins
'ins
'ins
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xTitolare)
'LRTrim(cConnes)
'LibreriaMit.UniqueId()
'nProgImp2
]
I
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
rd_field=[
'IDBASE
'PRGIMPTITE
]
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kvar=[
'LRTrim(xTitolare)
'LRTrim(cConnes)
]
rd_var=[
'xIDBx
'nProgImp2
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=12
prev=O2428
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES = cConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O2429
fatherSonIndex=0
obj='Insert
pag=12
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'datamodi
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
]
rd_kvar=[
'cProgSto
'personbo->CONNES
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'xDatReg
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=12
prev=O2427
var_op='asgn
I
obj='Remark
pag=12
I
I
]
w=[
150
150
]
I
obj='If
pag=12
prev=O2338
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O2340
fatherSonIndex=0
frm_calc=[
'xTipo='7'
'xTipo='6' or xTipo='9'
]
h=[
19
19
19
]
obj='Case
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2466
fatherSonIndex=0
frm_calc='LRTrim(cConnes)
len=16
name='xTitolare
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_tipo6b='S'
]
h=[
19
19
]
obj='If
pag=12
prev=O2472
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O2475
fatherSonIndex=0
for_variable='rwTipo6
for_variable_type='tipo6
h=[
19
19
]
iterator_expr='mcTipo6
obj='ForEach
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2480
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xntestit
father=O2484
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDBx))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A'
'xTipoInf='C'
]
h=[
19
19
19
]
obj='If
pag=12
prev=O2490
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='xntestit
father=O2493
fatherSonIndex=0
obj='Merge
pag=12
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xTitolare)
'LRTrim(rwTipo6.C41)
]
wr_field=[
'CODCLI
'IDBASE
'CODINTER
'DATAINI
'NUMPROG1
'STATOREG
'PRGIMPTITE
]
wr_mode=[
'ins
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
'ins
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xTitolare)
'LibreriaMit.UniqueId()
'LRTrim(rwTipo6.C41)
'xDatOpe
'cInfTit
''0'
'nProgImp2
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='xntestit
father=O2493
fatherSonIndex=1
obj='Merge
pag=12
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xTitolare)
'LRTrim(rwTipo6.C41)
]
wr_field=[
'CODCLI
'CODINTER
'IDBASE
'DATAFINE
'NUMPROG2
'STATOREG
'PRGIMPTITE
]
wr_mode=[
'
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
'ins
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xTitolare)
'LRTrim(rwTipo6.C41)
'LibreriaMit.UniqueId()
'xDatOpe
'cInfTit
''0'
'nProgImp2
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=12
prev=O2489
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2490
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
rd_field=[
'CODINTER
]
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kvar=[
'LRTrim(xTitolare)
'LRTrim(rwTipo6.C41)
]
rd_var=[
'xIDBx
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='intestit
father=O2484
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDBx))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A'
'xTipoInf='C'
]
h=[
19
19
19
]
obj='If
pag=12
prev=O2526
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='intestit
father=O2529
fatherSonIndex=0
obj='Merge
pag=12
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xTitolare)
'LRTrim(rwTipo6.C41)
]
wr_field=[
'CODCLI
'CODINTER
'IDBASE
'DATAINI
'NUMPROG1
'STATOREG
'PRGIMPTITE
]
wr_mode=[
'ins
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
'ins
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xTitolare)
'LRTrim(rwTipo6.C41)
'LibreriaMit.UniqueId()
'xDatOpe
'cInfTit
''0'
'nProgImp2
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='intestit
father=O2529
fatherSonIndex=1
obj='Merge
pag=12
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xTitolare)
'LRTrim(rwTipo6.C41)
]
wr_field=[
'CODCLI
'CODINTER
'IDBASE
'DATAFINE
'NUMPROG2
'STATOREG
'PRGIMPTITE
]
wr_mode=[
'ins
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
'ins
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xTitolare)
'LRTrim(rwTipo6.C41)
'LibreriaMit.UniqueId()
'xDatOpe
'cInfTit
''0'
'nProgImp2
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=12
prev=O2525
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2526
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
rd_field=[
'CODINTER
]
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kvar=[
'LRTrim(xTitolare)
'LRTrim(rwTipo6.C41)
]
rd_var=[
'xIDBx
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=12
prev=O2471
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xapotit
father=O2472
fatherSonIndex=0
obj='Write
pag=12
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cInfProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'cConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='rapotit
father=O2472
fatherSonIndex=1
obj='Write
pag=12
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cInfProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'LRTrim(cConnes)
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2466
fatherSonIndex=1
frm_calc=[
'Empty(xTitolare)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2582
fatherSonIndex=0
frm_calc=''S'
len=1
name='_tipo6b
next=Icpitembatch.CPVarDecl
frm_seek='AppendBlank
name='mcTipo6
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,2)
frm_seek='A01A
name='mcTipo6
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,3,11)
frm_seek='A01B
name='mcTipo6
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,14,1)
frm_seek='A02
name='mcTipo6
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,15,20)
frm_seek='A03
name='mcTipo6
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,35,16)
frm_seek='C41
name='mcTipo6
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,51,70)
frm_seek='G11
name='mcTipo6
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,121,3)
frm_seek='G13
name='mcTipo6
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,124,6)
frm_seek='G14A
name='mcTipo6
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,130,30)
frm_seek='G14B
name='mcTipo6
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,160,2)
frm_seek='G14C
name='mcTipo6
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,162,35)
frm_seek='G15
name='mcTipo6
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,197,5)
frm_seek='G16
name='mcTipo6
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,202,16)
frm_seek='G17
name='mcTipo6
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Substr(riga,218,8))
frm_seek='G18
name='mcTipo6
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,226,30)
frm_seek='G19
name='mcTipo6
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,291,2)
frm_seek='G41
name='mcTipo6
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,293,15)
frm_seek='G42
name='mcTipo6
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Substr(riga,308,8))
frm_seek='G43
name='mcTipo6
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,316,30)
frm_seek='G44
name='mcTipo6
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,346,1)
frm_seek='G45
name='mcTipo6
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcTipo6
obj='Var
obj_type='MC
pag=12
prev=O2608
var_op='meth
I
obj='Var
obj_type='MC
pag=12
prev=O2607
var_op='prop
I
obj='Var
obj_type='MC
pag=12
prev=O2606
var_op='prop
I
obj='Var
obj_type='MC
pag=12
prev=O2605
var_op='prop
I
obj='Var
obj_type='MC
pag=12
prev=O2604
var_op='prop
I
obj='Var
obj_type='MC
pag=12
prev=O2603
var_op='prop
I
obj='Var
obj_type='MC
pag=12
prev=O2602
var_op='prop
I
obj='Var
obj_type='MC
pag=12
prev=O2601
var_op='prop
I
obj='Var
obj_type='MC
pag=12
prev=O2600
var_op='prop
I
obj='Var
obj_type='MC
pag=12
prev=O2599
var_op='prop
I
obj='Var
obj_type='MC
pag=12
prev=O2598
var_op='prop
I
obj='Var
obj_type='MC
pag=12
prev=O2597
var_op='prop
I
obj='Var
obj_type='MC
pag=12
prev=O2596
var_op='prop
I
obj='Var
obj_type='MC
pag=12
prev=O2595
var_op='prop
I
obj='Var
obj_type='MC
pag=12
prev=O2594
var_op='prop
I
obj='Var
obj_type='MC
pag=12
prev=O2593
var_op='prop
I
obj='Var
obj_type='MC
pag=12
prev=O2592
var_op='prop
I
obj='Var
obj_type='MC
pag=12
prev=O2591
var_op='prop
I
obj='Var
obj_type='MC
pag=12
prev=O2590
var_op='prop
I
obj='Var
obj_type='MC
pag=12
prev=O2589
var_op='prop
I
obj='Var
obj_type='MC
pag=12
prev=O2588
var_op='prop
I
obj='Var
obj_type='MC
pag=12
prev=O2587
var_op='meth
I
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2582
fatherSonIndex=1
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xntestit
father=O2611
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDBx))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A'
'xTipoInf='C'
]
h=[
19
19
19
]
obj='If
pag=12
prev=O2617
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='xntestit
father=O2620
fatherSonIndex=0
obj='Merge
pag=12
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xTitolare)
'LRTrim(cConnes)
]
wr_field=[
'CODCLI
'CODINTER
'IDBASE
'DATAINI
'NUMPROG1
'STATOREG
'PRGIMPTITE
]
wr_mode=[
'ins
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xTitolare)
'LRTrim(cConnes)
'LibreriaMit.UniqueId()
'xDatOpe
'cInfTit
''0'
'nProgImp2
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='xntestit
father=O2620
fatherSonIndex=1
obj='Merge
pag=12
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xTitolare)
'LRTrim(cConnes)
]
wr_field=[
'CODCLI
'CODINTER
'IDBASE
'DATAFINE
'NUMPROG2
'STATOREG
'PRGIMPTITE
]
wr_mode=[
'ins
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
'ins
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xTitolare)
'LRTrim(cConnes)
'LibreriaMit.UniqueId()
'xDatOpe
'cInfTit
''0'
'nProgImp2
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=12
prev=O2616
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2617
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
rd_field=[
'IDBASE
'PRGIMPTITE
]
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kvar=[
'LRTrim(xTitolare)
'cConnes
]
rd_var=[
'xIDBx
'nProgImp2
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='intestit
father=O2611
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDBx))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A'
'xTipoInf='C'
]
h=[
19
19
19
]
obj='If
pag=12
prev=O2653
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='intestit
father=O2656
fatherSonIndex=0
obj='Merge
pag=12
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xTitolare)
'LRTrim(cConnes)
]
wr_field=[
'CODCLI
'CODINTER
'IDBASE
'DATAINI
'NUMPROG1
'STATOREG
'PRGIMPTITE
]
wr_mode=[
'ins
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
'ins
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xTitolare)
'LRTrim(cConnes)
'LibreriaMit.UniqueId()
'xDatOpe
'cInfTit
''0'
'nProgImp2
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='intestit
father=O2656
fatherSonIndex=1
obj='Merge
pag=12
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'LRTrim(xTitolare)
'LRTrim(cConnes)
]
wr_field=[
'CODCLI
'CODINTER
'IDBASE
'DATAFINE
'NUMPROG2
'STATOREG
'PRGIMPTITE
]
wr_mode=[
'ins
'ins
'ins
'ins/upd
'ins/upd
'ins/upd
'ins
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'LRTrim(xTitolare)
'LRTrim(cConnes)
'LibreriaMit.UniqueId()
'xDatOpe
'cInfTit
''0'
'nProgImp2
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=12
prev=O2652
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2653
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
rd_field=[
'IDBASE
'PRGIMPTITE
]
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kvar=[
'LRTrim(xTitolare)
'LRTrim(cConnes)
]
rd_var=[
'xIDBx
'nProgImp2
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2338
fatherSonIndex=0
frm_calc=''N'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='cConnes
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,35,16))
len=16
name='xConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cConnes))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,202,16)
len=16
name='xCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,51,70)
len=70
name='cRagSoc
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,346,1)='M'
'Substr(riga,346,1)='F'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(xCF))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgrae = 'R'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,291,2)
len=2
name='xTD
next=Icpitembatch.CPIfElse
frm_calc=[
'xTD <> '01' and xTD <> '02' and xTD <> '03' and xTD <> '04' and xTD <> '05' and xTD <> '06'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Len(LRTrim(xCF))=16,'P','G')
len=1
name='cTipPer
next=Icpitembatch.CPIfElse
frm_calc=[
'xNewSog = 'S'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=12
prev=O2716
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='personbo
father=O2717
fatherSonIndex=0
obj='Insert
pag=12
rd_kfield=[
'CONNES
'CODFISC
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'AUTRILASC
'DATARILASC
'SESSO
'NASSTATO
'TIPOPERS
'TIPINTER
]
rd_kvar=[
'cConnes
'xCF
'Substr(riga,51,70)
'Substr(riga,124,6)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'CharToDate(Substr(riga,218,8))
'cCNAS
'Substr(riga,256,3)
'xRam
'Substr(riga,262,3)
'xTD
'Substr(riga,293,15)
'Substr(riga,316,30)
'CharToDate(Substr(riga,308,8))
'xSesso
'cSNAS
'cTipPer
'_prvnas
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2717
fatherSonIndex=1
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='personbo
obj='Write
pag=12
prev=O2729
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(xConnes)
]
wr_field=[
'CODFISC
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'AUTRILASC
'DATARILASC
'SESSO
'NASSTATO
'TIPOPERS
'ATTIV
'TIPINTER
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xCF
'Substr(riga,51,70)
'Substr(riga,124,6)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'CharToDate(Substr(riga,218,8))
'cCNAS
'Substr(riga,256,3)
'xRam
'Substr(riga,262,3)
'xTD
'Substr(riga,293,15)
'Substr(riga,316,30)
'CharToDate(Substr(riga,308,8))
'xSesso
'cSNAS
'cTipPer
'xATECO
'_prvnas
]
I
obj='If
pag=12
prev=O2727
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2729
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=12
prev=O2741
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES = xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O2742
fatherSonIndex=0
obj='Insert
pag=12
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'datamodi
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
'DATAVARAGE
'SETTSINT2
'FATCA
'BANCABEN
'TIN
'ODB
'TELEF
'TIPOORO
'CODORO
'IDNASCOMUN
'IDNASSTATO
'NOTIT
]
rd_kvar=[
'cProgSto
'xConnes
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'_dataope
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
'personbo->DATAVARAGE
'personbo->SETTSINT2
'personbo->FATCA
'personbo->BANCABEN
'personbo->TIN
'personbo->ODB
'personbo->TELEF
'personbo->TIPOORO
'personbo->CODORO
'personbo->IDNASCOMUN
'personbo->IDNASSTATO
'personbo->NOTIT
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=12
prev=O2726
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=xConnes and wersonbo->datamodi=_dataope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2727
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=12
prev=O2713
var_op='asgn
I
obj='If
pag=12
prev=O2712
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2713
fatherSonIndex=0
frm_calc='''
len=2
name='xTD
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=12
prev=O2709
var_op='asgn
I
obj='If
pag=12
prev=O2706
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2709
fatherSonIndex=0
frm_calc='iif(Substr(riga,259,3)='000','',Substr(riga,259,3))
len=3
name='xRam
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xATECO
obj='Var
pag=12
prev=O2762
var_op='asgn
I
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2709
fatherSonIndex=1
frm_calc='''
len=3
name='xRam
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,259,3)='000','',Substr(riga,259,3))
len=10
name='xATECO
obj='Var
pag=12
prev=O2765
var_op='asgn
I
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=12
prev=O2703
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O2706
fatherSonIndex=0
frm_calc=[
'Substr(xCF,12,1) = 'Z' and Len(LRTrim(xCF))=16
'Substr(xCF,12,1) <> 'Z' and Len(LRTrim(xCF))=16
]
h=[
19
19
19
]
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2770
fatherSonIndex=0
frm_calc='Substr(riga,226,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='_prvnas
obj='Var
pag=12
prev=O2776
var_op='asgn
I
obj='Var
pag=12
prev=O2775
var_op='asgn
I
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O2770
fatherSonIndex=1
obj='Read
pag=12
rd_field=[
'PROV
]
rd_kfield=[
'SIGLA
]
rd_kvar=[
'Substr(xCF,12,4)
]
rd_var=[
'_prvnas
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2706
fatherSonIndex=1
frm_calc='Substr(riga,226,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='_prvnas
obj='Var
pag=12
prev=O2787
var_op='asgn
I
obj='Var
pag=12
prev=O2786
var_op='asgn
I
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Case
pag=12
prev=O2702
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2703
fatherSonIndex=0
frm_calc=''1'
len=1
name='xSesso
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2703
fatherSonIndex=1
frm_calc=''2'
len=1
name='xSesso
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2703
fatherSonIndex=2
frm_calc='Substr(riga,346,1)
len=1
name='xSesso
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
obj_type='N
pag=12
prev=O2701
var_op='asgn
I
obj='Var
pag=12
prev=O2700
var_op='asgn
I
obj='Var
pag=12
prev=O2697
var_op='asgn
I
obj='If
pag=12
prev=O2696
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2697
fatherSonIndex=0
frm_calc=''S'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,35,16))
len=16
name='cConnes
obj='Var
pag=12
prev=O2800
var_op='asgn
I
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
prev=O2695
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(xConnes)
]
rd_var=[
'cConnes
]
I
obj='Var
pag=12
prev=O2694
var_op='asgn
I
obj='Var
pag=12
prev=O2693
var_op='asgn
I
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
x=18
y=17
I
Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + LRTrim(w_nomefile) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Inizio estrazione del file '+ LRTrim(w_nomefile)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+"/"+LRTrim(w_nomefile)
len=200
name='cpercorsozip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+"/"
len=200
name='cdirectoryfile
next=Icpitembatch.CPExec
check='man
frm_calc='try {﷯      // Apro il file zip﷯      java.util.zip.ZipFile zf = new java.util.zip.ZipFile(cpercorsozip);﷯﷯      //Conto il numero di file all interno del file zip e creo un array di stringhe per memorizzare i nomi file﷯      conteggio=zf.size();﷯      lista=new String[conteggio];﷯      ﷯      // Enumerate each entry﷯      i=0;﷯      for (java.util.Enumeration entries = zf.entries(); entries.hasMoreElements();) {﷯          // Get the entry name﷯          lista[i] = ((java.util.zip.ZipEntry)entries.nextElement()).getName();﷯          i++;﷯      }﷯     zf.close();﷯     } catch (java.io.IOException e) {﷯     }﷯try {﷯      // Apro il file zip﷯      java.util.zip.ZipFile zf = new java.util.zip.ZipFile(cpercorsozip);﷯﷯      byte[] buffer = new byte[1024]; ﷯      java.util.Enumeration entries = zf.entries();﷯      while(entries.hasMoreElements() ) {﷯        java.util.zip.ZipEntry entry = (java.util.zip.ZipEntry)entries.nextElement();﷯        java.io.InputStream in =zf.getInputStream(entry);﷯        java.io.OutputStream out = new java.io.BufferedOutputStream(new java.io.FileOutputStream(cdirectoryfile+entry.getName()));﷯﷯        int len;﷯﷯        while((len = in.read(buffer)) >= 0){﷯          out.write(buffer, 0, len);﷯        }﷯﷯          in.close();﷯          out.close();﷯      }﷯﷯      zf.close();﷯} catch (java.io.IOException ioe) {﷯      System.err.println("Unhandled exception:");﷯      ioe.printStackTrace();﷯      return;﷯}
next=Icpitembatch.CPVarDecl
frm_calc='lista[0]
len=128
name='fileelab
next=Icpitembatch.CPExec
frm_calc='FileLibrary.DeleteFile('./appo/'+LRTrim(w_nomefile))
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine estrazione del file '+ LRTrim(w_nomefile)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +LRTrim(w_nomefile) + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O2815
var_op='asgn
I
nonlocal=True
obj='Var
pag=13
prev=O2814
var_op='asgn
I
obj='Exec
pag=13
prev=O2813
I
obj='Var
pag=13
prev=O2812
var_op='asgn
I
obj='Exec
pag=13
prev=O2811
I
obj='Var
pag=13
prev=O2810
var_op='asgn
I
obj='Var
pag=13
prev=O2809
var_op='asgn
I
nonlocal=True
obj='Var
pag=13
prev=O2808
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
var_op='asgn
x=14
y=14
I
Icpitembatch.CPRemark
frm_calc='Importa i soggetti delle operazioni
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,35,16))
len=16
name='xConnes
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xConnes)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_soloanag <> 'S'
]
h=[
19
19
]
obj='If
pag=14
prev=O2819
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O2822
fatherSonIndex=0
frm_calc=[
'xTipo='2' or xTipo='3' or xTipo='7'
'xTipo='4' or xTipo='8'
'xTipo='5'
'xTipo='6' or xTipo='9'
]
h=[
19
19
19
19
19
]
obj='Case
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2827
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O2832
fatherSonIndex=0
obj='Write
pag=14
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O2832
fatherSonIndex=1
obj='Write
pag=14
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2827
fatherSonIndex=1
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O2854
fatherSonIndex=0
obj='Write
pag=14
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O2854
fatherSonIndex=1
obj='Write
pag=14
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2827
fatherSonIndex=2
frm_calc=[
'Empty(LRTrim(xConnes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2876
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O2881
fatherSonIndex=0
obj='Write
pag=14
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,51,70)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,124,6)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O2881
fatherSonIndex=1
obj='Write
pag=14
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,51,70)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,124,6)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2876
fatherSonIndex=1
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O2903
fatherSonIndex=0
obj='Write
pag=14
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESBEN
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xConnes
'Substr(riga,51,70)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,124,6)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O2903
fatherSonIndex=1
obj='Write
pag=14
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESBEN
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xConnes
'Substr(riga,51,70)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,124,6)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2827
fatherSonIndex=3
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O2926
fatherSonIndex=0
obj='Write
pag=14
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNALTRO
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O2926
fatherSonIndex=1
obj='Write
pag=14
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNALTRO
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O2818
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2819
fatherSonIndex=0
frm_calc=''N'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='cConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cConnes))
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Calcola valori da salvare
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPIfElse
frm_calc=[
'xNewSog = 'S'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
prev=O2959
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='personbo
father=O2960
fatherSonIndex=0
obj='Insert
pag=14
rd_kfield=[
'CONNES
'CODFISC
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'AUTRILASC
'DATARILASC
'SESSO
'NASSTATO
'TIPOPERS
]
rd_kvar=[
'xConnes
'xCF
'Substr(riga,51,70)
'Substr(riga,124,6)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'CharToDate(Substr(riga,218,8))
'cCNAS
'Substr(riga,256,3)
'xRam
'Substr(riga,262,3)
'xTD
'Substr(riga,293,15)
'Substr(riga,316,30)
'CharToDate(Substr(riga,308,8))
'xSesso
'cSNAS
'cTipPer
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2960
fatherSonIndex=1
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='personbo
obj='Write
pag=14
prev=O2972
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'xConnes
]
wr_field=[
'CODFISC
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'AUTRILASC
'DATARILASC
'SESSO
'NASSTATO
'TIPOPERS
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xCF
'Substr(riga,51,70)
'Substr(riga,124,6)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'CharToDate(Substr(riga,218,8))
'cCNAS
'Substr(riga,256,3)
'xRam
'Substr(riga,262,3)
'xTD
'Substr(riga,293,15)
'Substr(riga,316,30)
'CharToDate(Substr(riga,308,8))
'xSesso
'cSNAS
'cTipPer
]
I
obj='If
pag=14
prev=O2970
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2972
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=14
prev=O2984
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES = xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O2985
fatherSonIndex=0
obj='Insert
pag=14
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'datamodi
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
'DATAVARAGE
'SETTSINT2
'FATCA
'BANCABEN
'TIN
'ODB
'TELEF
'TIPOORO
'CODORO
'IDNASCOMUN
'IDNASSTATO
'NOTIT
]
rd_kvar=[
'cProgSto
'xConnes
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'Date()
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
'personbo->DATAVARAGE
'personbo->SETTSINT2
'personbo->FATCA
'personbo->BANCABEN
'personbo->TIN
'personbo->ODB
'personbo->TELEF
'personbo->TIPOORO
'personbo->CODORO
'personbo->IDNASCOMUN
'personbo->IDNASSTATO
'personbo->NOTIT
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=14
prev=O2969
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=xConnes and wersonbo->datamodi=Date()
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2970
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=14
prev=O2957
var_op='asgn
I
obj='Begin
pag=14
prev=O2954
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPCase
father=O2957
fatherSonIndex=0
frm_calc=[
'Substr(riga,346,1)='M'
'Substr(riga,346,1)='F'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,226,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(xCF,12,1) = 'Z' and Len(LRTrim(xCF))=16
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgrae = 'R'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,291,2)
len=2
name='xTD
next=Icpitembatch.CPIfElse
frm_calc=[
'xTD <> '01' and xTD <> '02' and xTD <> '03' and xTD <> '04' and xTD <> '05' and xTD <> '06'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Len(LRTrim(xCF))=16,'P','G')
len=1
name='cTipPer
obj='Var
pag=14
prev=O3013
var_op='asgn
I
obj='If
pag=14
prev=O3012
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3013
fatherSonIndex=0
frm_calc='''
len=2
name='xTD
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=14
prev=O3009
var_op='asgn
I
obj='If
pag=14
prev=O3006
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3009
fatherSonIndex=0
frm_calc='iif(Substr(riga,259,3)='000','',Substr(riga,259,3))
len=3
name='xRam
obj='Var
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3009
fatherSonIndex=1
frm_calc='''
len=3
name='xRam
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=14
prev=O3005
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3006
fatherSonIndex=0
frm_calc='Substr(riga,226,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=14
prev=O3029
var_op='asgn
I
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=14
prev=O3004
var_op='asgn
I
obj='Var
pag=14
prev=O3001
var_op='asgn
I
obj='Case
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3001
fatherSonIndex=0
frm_calc=''1'
len=1
name='xSesso
obj='Var
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3001
fatherSonIndex=1
frm_calc=''2'
len=1
name='xSesso
obj='Var
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3001
fatherSonIndex=2
frm_calc='Substr(riga,346,1)
len=1
name='xSesso
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O2953
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2954
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(xCF))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3043
fatherSonIndex=0
frm_calc=''S'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cConnes
obj='Var
pag=14
prev=O3048
var_op='asgn
I
obj='Var
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3043
fatherSonIndex=1
frm_calc='''
len=16
name='cConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cConnes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
prev=O3052
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3053
fatherSonIndex=0
frm_calc=''S'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cConnes
obj='Var
pag=14
prev=O3058
var_op='asgn
I
obj='Var
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3053
fatherSonIndex=1
frm_calc='cConnes
len=16
name='xConnes
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=14
prev=O3051
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xCF
]
rd_var=[
'cConnes
]
I
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=14
prev=O2952
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'cConnes
]
I
obj='Var
pag=14
prev=O2951
var_op='asgn
I
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=14
prev=O2817
var_op='asgn
I
obj='Remark
pag=14
x=12
y=20
I
]
ManualBlocks={
'BO - Properties
Icpmanualblocks.CPManualBlocks
code='public String[] lista;﷯public int conteggio;﷯public int i;﷯public int contanome;
name='BO - Properties
I
}
comment='Import Scarico OffLINE
date_creat=#2006-06-20
date_rev=#2023-06-14
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'FileLibrary
'Utilities
'LibreriaMit
]
modcnt=649
page_result_class=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
page_result_type=[
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
]
page_uid=[
'DGHXGDVUYP
'EZDCMJCTUI
'YKUKDBCDRH
'SAPCTHNUVI
'ZBOQDBKIYI
'QHUQJYTCQM
'TWJXWEWESK
'JXUBOCMZBX
'PDNNFPHWYY
'AIGWQRAJLC
'SLTRPRQLHW
'RTKEJQSEGV
'HWRCOQMWLU
'JUKVVRHWNU
]
pagename=[
'Page_1
'Page_2
'Page_3
'Page_4
'Page_5
'Page_6
'Page_7
'Page_8
'Page_9
'Page_10
'Page_11
'Page_12
'Page_13
'Page_14
]
pagenote=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
pagetitle=[
'Main
'Operazioni (Dati Base)
'Rapporti (Dati Base)
'Operazioni (Soggetti)
'Rapporti (Soggetti)
'Controllo Se Apertura o Chiusura
'Operazioni (dati Base) su appoggio
'Rapporti (Dati Base) su Appoggio
'Operazioni (Soggetti) su appoggio
'Rapporti (Soggetti) su appoggio
'Titolari (Dati Base)
'Titolari (Soggetti)
'Estrai Zip
'Controparti
]
runtime_filters=2
tpl_name='Routine
work_file=[
'anadip
'anarapbo
'intestbo
'operazbo
'personbo
'rapopebo
'tbcauana
'tbcitta
'tbvalute
'xapopebo
'xnarapbo
'xntestbo
'xperazbo
'knarapbo
'tmp_operazbo_ol
'tmp_rapopebo_ol
'tmp_anarapbo
'tmp_intestbo_ol
'delegabo
'xelegabo
'cpwarn
'wersonbo
'xapotit
'rapotit
'intestit
'personbo_agg
'fiduciabo
'garantbo
'soginfo
'xiduciabo
'xntestit
]
work_filter=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
I
*--*
*----*
