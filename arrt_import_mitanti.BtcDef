* --- CodePainter Revolution Batch Vers. 5.1
￼Icpbatch.CPBatch
Items=[
Icpitembatch.CPRemark
frm_calc='Parametro
next=Icpitembatch.CPVarDecl
len=1
name='pOper
next=Icpitembatch.CPVarDecl
len=1
name='pFlg
next=Icpitembatch.CPRemark
frm_calc='Dichiarazione variabili del caller
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili caller
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Definizione variabili locali
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili Locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili globali
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Inizio Elaborazione'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPRemark
frm_calc='Lancia la pagina appropriata
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine Elaborazione'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=1
prev=O18
var_op='asgn
I
obj='Try
pag=1
prev=O17
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O18
fatherSonIndex=0
frm_calc=[
'pOper='I'
'pOper='P'
'pOper='R'
'pOper='O'
'pOper='T'
'pOper='G'
'pOper='A'
'pOper='D'
'pOper='X'
'pOper='Y'
'pOper='Z'
'pOper='S'
'pOper='E'
'pOper='F'
'pOper='1'
'pOper='2'
'pOper='3'
'pOper='J'
]
h=[
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
]
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=1
prev=O23
I
obj='Case
pag=1
sons=[
Icpitembatch.CPItemSon
comment='Intermediari controparte + Dipendenze
instr=Icpitembatch.CPExec
check='page
father=O23
fatherSonIndex=0
frm_calc='2
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O23
fatherSonIndex=1
frm_calc='3
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
comment='Rapporti + Informazioni sui rapporti
instr=Icpitembatch.CPExec
check='page
father=O23
fatherSonIndex=2
frm_calc='4
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O23
fatherSonIndex=3
frm_calc='5
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O23
fatherSonIndex=4
frm_calc='6
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O23
fatherSonIndex=5
frm_calc='7
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O23
fatherSonIndex=6
frm_calc='8
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O23
fatherSonIndex=7
frm_calc='9
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O23
fatherSonIndex=8
frm_calc='10
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O23
fatherSonIndex=9
frm_calc='11
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O23
fatherSonIndex=10
frm_calc='12
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O23
fatherSonIndex=11
frm_calc='15
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O23
fatherSonIndex=12
frm_calc='13
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O23
fatherSonIndex=13
frm_calc='2
next=Icpitembatch.CPExec
check='page
frm_calc='3
next=Icpitembatch.CPExec
check='page
frm_calc='4
next=Icpitembatch.CPRemark
frm_calc='Si importa prima da storico dove sono le vecchie operazioni. Non spostare altrimenti salta l'aggiornamento dei contatori.
next=Icpitembatch.CPExec
check='page
frm_calc='14
next=Icpitembatch.CPExec
check='page
frm_calc='5
next=Icpitembatch.CPExec
check='page
frm_calc='6
next=Icpitembatch.CPExec
check='page
frm_calc='7
next=Icpitembatch.CPExec
check='page
frm_calc='8
next=Icpitembatch.CPExec
check='page
frm_calc='9
next=Icpitembatch.CPExec
check='page
frm_calc='10
next=Icpitembatch.CPExec
check='page
frm_calc='11
next=Icpitembatch.CPExec
check='page
frm_calc='12
next=Icpitembatch.CPExec
check='page
frm_calc='13
next=Icpitembatch.CPExec
check='page
frm_calc='15
next=Icpitembatch.CPExec
check='page
frm_calc='16
next=Icpitembatch.CPExec
check='page
frm_calc='17
obj='Exec
pag=1
prev=O70
I
obj='Exec
pag=1
prev=O69
I
obj='Exec
pag=1
prev=O68
I
obj='Exec
pag=1
prev=O67
I
obj='Exec
pag=1
prev=O66
I
obj='Exec
pag=1
prev=O65
I
obj='Exec
pag=1
prev=O64
I
obj='Exec
pag=1
prev=O63
I
obj='Exec
pag=1
prev=O62
I
obj='Exec
pag=1
prev=O61
I
obj='Exec
pag=1
prev=O60
I
obj='Exec
pag=1
prev=O59
I
obj='Exec
pag=1
prev=O58
I
obj='Remark
pag=1
prev=O57
I
obj='Exec
pag=1
prev=O56
I
obj='Exec
pag=1
prev=O55
I
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
comment='Rapporti + Informazioni (Storico)
instr=Icpitembatch.CPExec
check='page
father=O23
fatherSonIndex=14
frm_calc='17
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
comment='Frazionate e Operazioni (Storico)
instr=Icpitembatch.CPExec
check='page
father=O23
fatherSonIndex=15
frm_calc='14
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
comment='Titolari (Storico)
instr=Icpitembatch.CPExec
check='page
father=O23
fatherSonIndex=16
frm_calc='18
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
comment='Garantiti
instr=Icpitembatch.CPExec
check='page
father=O23
fatherSonIndex=17
frm_calc='16
obj='Exec
pag=1
I
I
]
w=[
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O18
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=1
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=1
prev=O16
I
obj='Remark
pag=1
prev=O15
I
nonlocal=True
obj='Var
pag=1
prev=O14
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
prev=O12
var_op='asgn
I
obj='Begin
pag=1
prev=O10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Path Applicazione
father=O12
fatherSonIndex=0
global=True
len=80
name='gPathApp
next=Icpitembatch.CPVarDecl
comment='Azienda
global=True
len=10
name='gAzienda
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='Messaggio
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=1
prev=O88
I
nonlocal=True
obj='Var
pag=1
prev=O87
I
nonlocal=True
obj='Var
pag=1
prev=O86
I
nonlocal=True
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O9
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O10
fatherSonIndex=0
len=10
name='conta
next=Icpitembatch.CPVarDecl
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
len=3
name='_numrig
next=Icpitembatch.CPVarDecl
len=16
name='_connes
next=Icpitembatch.CPVarDecl
len=1
name='_nocodfis
next=Icpitembatch.CPVarDecl
len=11
name='_maxfo
next=Icpitembatch.CPVarDecl
len=11
name='_maxfon
next=Icpitembatch.CPVarDecl
len=11
name='_top
next=Icpitembatch.CPVarDecl
len=11
name='_topl
next=Icpitembatch.CPVarDecl
len=11
name='_bot
next=Icpitembatch.CPVarDecl
len=11
name='_botl
next=Icpitembatch.CPVarDecl
len=11
name='_cicli
next=Icpitembatch.CPVarDecl
len=11
name='_pci
next=Icpitembatch.CPVarDecl
len=8
name='_dataret
next=Icpitembatch.CPVarDecl
len=8
name='_dataimp
next=Icpitembatch.CPVarDecl
len=8
name='_datamin
next=Icpitembatch.CPVarDecl
len=11
name='_codinter
next=Icpitembatch.CPVarDecl
len=10
name='cProg
next=Icpitembatch.CPVarDecl
len=10
name='cCanc
next=Icpitembatch.CPVarDecl
len=25
name='_codrap
obj='Var
pag=1
prev=O116
I
obj='Var
pag=1
prev=O115
I
obj='Var
pag=1
prev=O114
I
obj='Var
pag=1
prev=O113
I
obj='Var
obj_type='D
pag=1
prev=O112
I
obj='Var
obj_type='D
pag=1
prev=O111
I
obj='Var
obj_type='D
pag=1
prev=O110
I
obj='Var
obj_type='N
pag=1
prev=O109
I
obj='Var
obj_type='N
pag=1
prev=O108
I
obj='Var
pag=1
prev=O107
I
obj='Var
obj_type='N
pag=1
prev=O106
I
obj='Var
pag=1
prev=O105
I
obj='Var
obj_type='N
pag=1
prev=O104
I
obj='Var
obj_type='N
pag=1
prev=O103
I
obj='Var
pag=1
prev=O102
I
obj='Var
obj_type='N
pag=1
prev=O101
I
obj='Var
pag=1
prev=O100
I
obj='Var
obj_type='N
pag=1
prev=O99
I
obj='Var
pag=1
prev=O98
I
obj='Var
obj_type='N
pag=1
prev=O97
I
obj='Var
obj_type='N
pag=1
prev=O96
I
obj='Var
pag=1
prev=O95
I
obj='Var
pag=1
prev=O94
I
obj='Var
pag=1
prev=O93
I
obj='Var
obj_type='N
pag=1
I
I
]
w=[
150
150
]
I
obj='Remark
pag=1
prev=O7
I
obj='Begin
pag=1
prev=O6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7
fatherSonIndex=0
len=10
name='w_msgproc
nonlocal=True
obj='Var
obj_type='M
pag=1
I
I
]
w=[
150
150
]
I
obj='Remark
pag=1
prev=O5
I
obj='Var
pag=1
param=True
prev=O4
I
obj='Var
pag=1
param=True
prev=O3
I
obj='Remark
pag=1
x=10
y=21
I
Icpitembatch.CPRemark
frm_calc='Dati Soggetti
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Soggetti' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPRemark
frm_calc='Dati Soggetti
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_pci  > _cicli
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Soggetti' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file Soggetti'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=3
prev=O132
var_op='asgn
I
nonlocal=True
obj='Var
pag=3
prev=O129
var_op='asgn
I
obj='If
pag=3
prev=O127
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O129
fatherSonIndex=0
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Soggetti' + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O129
fatherSonIndex=1
frm_calc='gMsgProc + 'Elaborazione terminata con errori. Import abortito' + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Try
pag=3
prev=O126
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Personbo
father=O127
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Wersonbo
h=[
19
19
]
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=3
prev=O144
I
obj='Begin
pag=3
prev=O142
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O144
fatherSonIndex=0
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='0
len=11
name='_maxfon
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_maxfon <= 20000
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='1
len=11
name='_pci
next=Icpitembatch.CPWhile
frm_calc='_pci <= _cicli
h=[
19
19
]
obj='While
pag=3
prev=O156
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O157
fatherSonIndex=0
frm_calc='((_pci -1 ) * 20000) + 1
len=11
name='_bot
next=Icpitembatch.CPVarDecl
frm_calc='_pci * 20000
len=11
name='_top
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_pci + 1
len=11
name='_pci
obj='Var
obj_type='N
pag=3
prev=O163
var_op='asgn
I
obj='Select
pag=3
par_expr=[
'_bot
'_top
]
par_name=[
'_bot
'_top
]
prev=O162
sel_field='*
sel_name='qbe_f_wersonbo
sel_type='sqry
sel_where='recno() >= _bot and recno() <= _top
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O163
fatherSonIndex=0
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'qbe_f_wersonbo->TIPINTER='EE'
'Empty(LRTrim(qbe_f_wersonbo->TIPINTER)) or LRTrim(qbe_f_wersonbo->TIPINTER) <> 'EE'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(qbe_f_wersonbo->SESSO)),'G','P')
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Soggetti (Storico)'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPInsert
arch='wersonbo
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=3
prev=O179
sel_field='*
sel_name='f_wersonbo_agg
sel_where='f_wersonbo_agg->IDBASE=qbe_f_wersonbo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo_agg
father=O180
fatherSonIndex=0
obj='Insert
pag=3
rd_kfield=[
'sanumpro
'datamodi
'CONNES
'EMAIL
'FLGEMAIL
'TELEFONO
'RDCODAUT
'RDLOCAUT
'FLGBANCA
'FLGVALIDO
'REGRES
'FLGBL
'CLOCCUPA
'NUMTEL
'NAZIONE
'LASTOPER
'CODCLIEST
'FLGANAVAL
'MITIG
'MITGDOC
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
'FLGPREGIUD
'FLGTRUST
'FLGRISCHIO
'FLGEQUIFIN
'FLGFALSADIC
'FLGRICINF
]
rd_kvar=[
'cProgSto
'qbe_f_wersonbo->DATAMODI
'Upper(qbe_f_wersonbo->CONNES)
'f_wersonbo_agg->EMAIL
'f_wersonbo_agg->FLGEMAIL
'f_wersonbo_agg->TELEFONO
'f_wersonbo_agg->RDCODAUT
'f_wersonbo_agg->RDLOCAUT
'f_wersonbo_agg->FLGBANCA
'f_wersonbo_agg->FLGVALIDO
'f_wersonbo_agg->REGRES
'f_wersonbo_agg->FLGBL
'f_wersonbo_agg->CLOCCUPA
'f_wersonbo_agg->NUMTEL
'f_wersonbo_agg->NAZIONE
'f_wersonbo_agg->LASTOPER
'f_wersonbo_agg->CODCLIEST
'f_wersonbo_agg->FLGANAVAL
'f_wersonbo_agg->MITIG
'f_wersonbo_agg->MITIGDOC
'f_wersonbo_agg->CATEG01
'f_wersonbo_agg->CATEG02
'f_wersonbo_agg->CATEG03
'f_wersonbo_agg->CATEG04
'f_wersonbo_agg->CATEG05
'f_wersonbo_agg->CATEGORIA
'f_wersonbo_agg->FLGPREGIUD
'f_wersonbo_agg->FLGTRUST
'f_wersonbo_agg->FLGRISCHIO
'f_wersonbo_agg->FLGEQUIFIN
'f_wersonbo_agg->FLGFALSADI
'f_wersonbo_agg->FLGRICINF
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=3
prev=O178
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'AREAGEO
'datamodi
'PEP
'DATASEGN
'DATAVARAGE
'SETTSINT2
'FATCA
'TIN
'ODB
'TELEF
'TIPOORO
'CODORO
'NOTIT
'IDBASE
'FLGVALIDO
'CITTADIN1
'CITTADIN2
'RESFISC
'MITIG
'MITGDOC
'NOSARA
'RISGLOB
'DATAPROF
'DATAREVPROF
'IDENT
'PEPDATE
'DAC6
'FLAGDAC6
'ALTRODOM
'ALTROCAP
'CONTO
'NUMIMP
'DATAIDENT
'DATARAUT
]
rd_kvar=[
'cProgSto
'Upper(qbe_f_wersonbo->CONNES)
'qbe_f_wersonbo->CODCAB
'qbe_f_wersonbo->RAGSOC
'qbe_f_wersonbo->DOMICILIO
'qbe_f_wersonbo->CODFISC
'qbe_f_wersonbo->DATANASC
'cCNAS
'qbe_f_wersonbo->SOTGRUP
'qbe_f_wersonbo->RAMOGRUP
'qbe_f_wersonbo->SETTSINT
'qbe_f_wersonbo->TIPODOC
'qbe_f_wersonbo->NUMDOCUM
'qbe_f_wersonbo->DATARILASC
'qbe_f_wersonbo->AUTRILASC
'qbe_f_wersonbo->DESCCIT
'qbe_f_wersonbo->PROVINCIA
'qbe_f_wersonbo->PAESE
'qbe_f_wersonbo->CAP
'qbe_f_wersonbo->CODINTER
'qbe_f_wersonbo->TIPINTER
'_tipper
'qbe_f_wersonbo->CODDIPE
'qbe_f_wersonbo->PARTIVA
'qbe_f_wersonbo->NOTE
'qbe_f_wersonbo->SESSO
'qbe_f_wersonbo->SOSPMAF
'qbe_f_wersonbo->DATAVALI
'cSNAS
'qbe_f_wersonbo->DOCFILE
'qbe_f_wersonbo->NOME
'qbe_f_wersonbo->COGNOME
'qbe_f_wersonbo->CFESTERO
'qbe_f_wersonbo->OLDCONNES
'qbe_f_wersonbo->PKTBSPECIE
'qbe_f_wersonbo->COMPORT
'qbe_f_wersonbo->ATTIV
'qbe_f_wersonbo->RNATGIU
'qbe_f_wersonbo->RATTIV
'qbe_f_wersonbo->RCOMP
'qbe_f_wersonbo->RAREA
'qbe_f_wersonbo->AREAGEO
'qbe_f_wersonbo->DATAMODI
'qbe_f_wersonbo->PEP
'qbe_f_wersonbo->DATASEGN
'qbe_f_wersonbo->DATAVARAGE
'qbe_f_wersonbo->SETTSINT2
'qbe_f_wersonbo->FATCA
'qbe_f_wersonbo->TIN
'qbe_f_wersonbo->ODB
'qbe_f_wersonbo->TELEF
'qbe_f_wersonbo->TIPOORO
'qbe_f_wersonbo->CODORO
'qbe_f_wersonbo->NOTIT
'qbe_f_wersonbo->IDBASE
'qbe_f_wersonbo->FLGVALIDO
'qbe_f_wersonbo->CITTADIN1
'qbe_f_wersonbo->CITTADIN2
'qbe_f_wersonbo->RESFISC
'qbe_f_wersonbo->MITIG
'qbe_f_wersonbo->MITIGDOC
'qbe_f_wersonbo->NOSARA
'qbe_f_wersonbo->RISGLOB
'qbe_f_wersonbo->DATAPROF
'qbe_f_wersonbo->DATAREVPRO
'qbe_f_wersonbo->IDENT
'qbe_f_wersonbo->PEPDATE
'qbe_f_wersonbo->DAC6
'qbe_f_wersonbo->FLAGDAC6
'qbe_f_wersonbo->ALTRODOM
'qbe_f_wersonbo->ALTROCAP
'qbe_f_wersonbo->CONTO
'qbe_f_wersonbo->NUMIMP
'qbe_f_wersonbo->DATAIDENT
'qbe_f_wersonbo->DATARAUT
]
I
obj='Var
pag=3
prev=O177
var_op='asgn
I
nonlocal=True
obj='Var
pag=3
prev=O176
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O175
var_op='asgn
I
obj='Var
pag=3
prev=O172
var_op='asgn
I
obj='If
pag=3
prev=O171
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O172
fatherSonIndex=0
frm_calc='qbe_f_wersonbo->NASCOMUN
len=30
name='cSNAS
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O172
fatherSonIndex=1
frm_calc='qbe_f_wersonbo->NASCOMUN
len=30
name='cCNAS
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=3
prev=O170
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O161
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O153
var_op='asgn
I
obj='If
pag=3
prev=O151
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O153
fatherSonIndex=0
frm_calc='1
len=11
name='_cicli
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O153
fatherSonIndex=1
frm_calc='iif(Mod(_maxfon,20000) <> 0,Int(_maxfon/20000) + 1,Int(_maxfon/20000))
len=11
name='_cicli
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=3
prev=O150
sel_field='reccount() as TOTALE
sel_name='qbe_f_wersonbo_totale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O151
fatherSonIndex=0
frm_calc='qbe_f_wersonbo_totale->TOTALE
len=11
name='_maxfon
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O149
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O142
fatherSonIndex=0
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='0
len=11
name='_maxfon
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_maxfon <= 20000
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='1
len=11
name='_pci
next=Icpitembatch.CPWhile
frm_calc='_pci <= _cicli
h=[
19
19
]
obj='While
pag=3
prev=O218
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O219
fatherSonIndex=0
frm_calc='((_pci -1 ) * 20000) + 1
len=11
name='_bot
next=Icpitembatch.CPVarDecl
frm_calc='_pci * 20000
len=11
name='_top
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_pci + 1
len=11
name='_pci
obj='Var
obj_type='N
pag=3
prev=O225
var_op='asgn
I
obj='Select
pag=3
par_expr=[
'_bot
'_top
]
par_name=[
'_bot
'_top
]
prev=O224
sel_field='*
sel_name='qbe_f_personbo
sel_type='sqry
sel_where='recno() >= _bot and recno() <= _top
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O225
fatherSonIndex=0
frm_calc='''
len=16
name='_connes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_connes)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O233
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O234
fatherSonIndex=0
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'qbe_f_personbo->TIPINTER='EE'
'Empty(LRTrim(qbe_f_personbo->TIPINTER)) or LRTrim(qbe_f_personbo->TIPINTER) <> 'EE'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(qbe_f_personbo->SESSO)),'G','P')
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Soggetti'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOCLI\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='personbo
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=3
prev=O248
sel_field='*
sel_name='f_personbo_agg
sel_where='f_personbo_agg->CONNES=qbe_f_personbo->CONNES
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='personbo_agg
father=O249
fatherSonIndex=0
obj='Insert
pag=3
rd_kfield=[
'CONNES
'EMAIL
'FLGEMAIL
'TELEFONO
'RDCODAUT
'RDLOCAUT
'FLGBANCA
'FLGVALIDO
'REGRES
'FLGBL
'CLOCCUPA
'NUMTEL
'NAZIONE
'LASTOPER
'CODCLIEST
'FLGANAVAL
'MITIG
'MITGDOC
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
'FLGPREGIUD
'FLGTRUST
'FLGRISCHIO
'FLGEQUIFIN
'FLGFALSADIC
'FLGRICINF
]
rd_kvar=[
'Upper(f_personbo_agg->CONNES)
'f_personbo_agg->EMAIL
'f_personbo_agg->FLGEMAIL
'f_personbo_agg->TELEFONO
'f_personbo_agg->RDCODAUT
'f_personbo_agg->RDLOCAUT
'f_personbo_agg->FLGBANCA
'f_personbo_agg->FLGVALIDO
'f_personbo_agg->REGRES
'f_personbo_agg->FLGBL
'f_personbo_agg->CLOCCUPA
'f_personbo_agg->NUMTEL
'f_personbo_agg->NAZIONE
'f_personbo_agg->LASTOPER
'f_personbo_agg->CODCLIEST
'f_personbo_agg->FLGANAVAL
'f_personbo_agg->MITIG
'f_personbo_agg->MITIGDOC
'f_personbo_agg->CATEG01
'f_personbo_agg->CATEG02
'f_personbo_agg->CATEG03
'f_personbo_agg->CATEG04
'f_personbo_agg->CATEG05
'f_personbo_agg->CATEGORIA
'f_personbo_agg->FLGPREGIUD
'f_personbo_agg->FLGTRUST
'f_personbo_agg->FLGRISCHIO
'f_personbo_agg->FLGRISCHIO
'f_personbo_agg->FLGFALSADI
'f_personbo_agg->FLGRICINF
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=3
prev=O247
rd_kfield=[
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'PROGIMPORT
'AREAGEO
'PEP
'DATASEGN
'OLDSETSIN
'DATAVARAGE
'SETTSINT2
'FATCA
'BANCABEN
'TIN
'ODB
'TELEF
'TIPOORO
'CODORO
'NOTIT
'IDBASE
'FLGVALIDO
'CITTADIN1
'CITTADIN2
'RESFISC
'MITIG
'MITIGDOC
'NOSARA
'RISGLOB
'DATAPROF
'DATAREVPROF
'IDENT
'PEPDATE
'DAC6
'FLAGDAC6
'CRIME
'CRIMEDATE
'ALTRODOM
'ALTROCAP
'CONTO
'NUMIMP
'DATAIDENT
'DATASIGN
'DATARAUT
]
rd_kvar=[
'Upper(qbe_f_personbo->CONNES)
'qbe_f_personbo->CODCAB
'qbe_f_personbo->RAGSOC
'qbe_f_personbo->DOMICILIO
'qbe_f_personbo->CODFISC
'iif(DateToChar(qbe_f_personbo->DATANASC)='18991230',NullDate(),qbe_f_personbo->DATANASC)
'cCNAS
'qbe_f_personbo->SOTGRUP
'qbe_f_personbo->RAMOGRUP
'qbe_f_personbo->SETTSINT
'qbe_f_personbo->TIPODOC
'qbe_f_personbo->NUMDOCUM
'iif(DateToChar(qbe_f_personbo->DATARILASC)='18991230',NullDate(),qbe_f_personbo->DATARILASC)
'qbe_f_personbo->AUTRILASC
'qbe_f_personbo->DESCCIT
'qbe_f_personbo->PROVINCIA
'qbe_f_personbo->PAESE
'qbe_f_personbo->CAP
'qbe_f_personbo->CODINTER
'qbe_f_personbo->TIPINTER
'_tipper
'qbe_f_personbo->CODDIPE
'qbe_f_personbo->PARTIVA
'qbe_f_personbo->NOTE
'qbe_f_personbo->SESSO
'qbe_f_personbo->SOSPMAF
'iif(DateToChar(qbe_f_personbo->DATAVALI)='18991230',NullDate(),qbe_f_personbo->DATAVALI)
'cSNAS
'qbe_f_personbo->DOCFILE
'qbe_f_personbo->NOME
'qbe_f_personbo->COGNOME
'qbe_f_personbo->CFESTERO
'qbe_f_personbo->OLDCONNES
'qbe_f_personbo->PKTBSPECIE
'qbe_f_personbo->COMPORT
'qbe_f_personbo->ATTIV
'qbe_f_personbo->RNATGIU
'qbe_f_personbo->RATTIV
'qbe_f_personbo->RCOMP
'qbe_f_personbo->RAREA
'nProgImp
'qbe_f_personbo->AREAGEO
'qbe_f_personbo->PEP
'qbe_f_personbo->DATASEGN
'qbe_f_personbo->SETTSINT2
'qbe_f_personbo->DATAVARAGE
'qbe_f_personbo->SETTSINT2
'qbe_f_personbo->FATCA
'Left(qbe_f_personbo->OLDCONNES,11)
'qbe_f_personbo->TIN
'qbe_f_personbo->ODB
'qbe_f_personbo->TELEF
'qbe_f_personbo->TIPOORO
'qbe_f_personbo->CODORO
'qbe_f_personbo->NOTIT
'qbe_f_personbo->IDBASE
'qbe_f_personbo->FLGVALIDO
'qbe_f_personbo->CITTADIN1
'qbe_f_personbo->CITTADIN2
'qbe_f_personbo->RESFISC
'qbe_f_personbo->MITIG
'qbe_f_personbo->MITIGDOC
'qbe_f_personbo->NOSARA
'qbe_f_personbo->RISGLOB
'qbe_f_personbo->DATAPROF
'qbe_f_personbo->DATAREVPRO
'qbe_f_personbo->IDENT
'qbe_f_personbo->PEPDATE
'qbe_f_personbo->DAC6
'qbe_f_personbo->FLAGDAC6
'qbe_f_personbo->CRIME
'qbe_f_personbo->CRIMEDATE
'qbe_f_personbo->ALTRODOM
'qbe_f_personbo->ALTROCAP
'qbe_f_personbo->CONTO
'qbe_f_personbo->NUMIMP
'qbe_f_personbo->DATAIDENT
'qbe_f_personbo->DATASEGN
'qbe_f_personbo->DATARAUT
]
I
obj='Var
obj_type='N
pag=3
prev=O246
var_op='asgn
I
nonlocal=True
obj='Var
pag=3
prev=O245
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O244
var_op='asgn
I
obj='Var
pag=3
prev=O241
var_op='asgn
I
obj='If
pag=3
prev=O240
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O241
fatherSonIndex=0
frm_calc='qbe_f_personbo->NASCOMUN
len=30
name='cSNAS
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O241
fatherSonIndex=1
frm_calc='qbe_f_personbo->NASCOMUN
len=30
name='cCNAS
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=3
prev=O239
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O234
fatherSonIndex=1
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'qbe_f_personbo->TIPINTER='EE'
'Empty(LRTrim(qbe_f_personbo->TIPINTER)) or LRTrim(qbe_f_personbo->TIPINTER) <> 'EE'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(qbe_f_personbo->SESSO)),'G','P')
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Soggetti'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='personbo
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=3
prev=O277
sel_field='*
sel_name='f_personbo_agg
sel_where='f_personbo_agg->CONNES=qbe_f_personbo->CONNES
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMerge
arch='personbo_agg
father=O278
fatherSonIndex=0
obj='Merge
pag=3
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'Upper(f_personbo_agg->CONNES)
]
wr_field=[
'CONNES
'EMAIL
'FLGEMAIL
'TELEFONO
'RDCODAUT
'RDLOCAUT
'FLGBANCA
'FLGVALIDO
'REGRES
'FLGBL
'CLOCCUPA
'NUMTEL
'NAZIONE
'LASTOPER
'CODCLIEST
'FLGANAVAL
'MITIG
'MITGDOC
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
'FLGPREGIUD
'FLGTRUST
'FLGRISCHIO
'FLGEQUIFIN
'FLGFALSADIC
'FLGRICINF
]
wr_mode=[
'ins
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
'ins/upd
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Upper(f_personbo_agg->CONNES)
'f_personbo_agg->EMAIL
'f_personbo_agg->FLGEMAIL
'f_personbo_agg->TELEFONO
'f_personbo_agg->RDCODAUT
'f_personbo_agg->RDLOCAUT
'f_personbo_agg->FLGBANCA
'f_personbo_agg->FLGVALIDO
'f_personbo_agg->REGRES
'f_personbo_agg->FLGBL
'f_personbo_agg->CLOCCUPA
'f_personbo_agg->NUMTEL
'f_personbo_agg->NAZIONE
'f_personbo_agg->LASTOPER
'f_personbo_agg->CODCLIEST
'f_personbo_agg->FLGANAVAL
'f_personbo_agg->MITIG
'f_personbo_agg->MITIGDOC
'f_personbo_agg->CATEG01
'f_personbo_agg->CATEG02
'f_personbo_agg->CATEG03
'f_personbo_agg->CATEG04
'f_personbo_agg->CATEG05
'f_personbo_agg->CATEGORIA
'f_personbo_agg->FLGPREGIUD
'f_personbo_agg->FLGTRUST
'f_personbo_agg->FLGRISCHIO
'f_personbo_agg->FLGRISCHIO
'f_personbo_agg->FLGFALSADI
'f_personbo_agg->FLGRICINF
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=3
prev=O275
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'Upper(qbe_f_personbo->CONNES)
]
wr_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'PROGIMPORT
'AREAGEO
'PEP
'DATASEGN
'OLDSETSIN
'DATAVARAGE
'SETTSINT2
'FATCA
'BANCABEN
'TIN
'ODB
'TELEF
'TIPOORO
'CODORO
'NOTIT
'IDBASE
'FLGVALIDO
'CITTADIN1
'CITTADIN2
'RESFISC
'MITIG
'MITIGDOC
'NOSARA
'RISGLOB
'DATAPROF
'DATAREVPROF
'IDENT
'PEPDATE
'DAC6
'FLAGDAC6
'CRIME
'CRIMEDATE
'ALTRODOM
'ALTROCAP
'CONTO
'NUMIMP
'DATAIDENT
'DATASIGN
'DATARAUT
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'qbe_f_personbo->CODCAB
'qbe_f_personbo->RAGSOC
'qbe_f_personbo->DOMICILIO
'qbe_f_personbo->CODFISC
'iif(DateToChar(qbe_f_personbo->DATANASC)='18991230',NullDate(),qbe_f_personbo->DATANASC)
'cCNAS
'qbe_f_personbo->SOTGRUP
'qbe_f_personbo->RAMOGRUP
'qbe_f_personbo->SETTSINT
'qbe_f_personbo->TIPODOC
'qbe_f_personbo->NUMDOCUM
'iif(DateToChar(qbe_f_personbo->DATARILASC)='18991230',NullDate(),qbe_f_personbo->DATARILASC)
'qbe_f_personbo->AUTRILASC
'qbe_f_personbo->DESCCIT
'qbe_f_personbo->PROVINCIA
'qbe_f_personbo->PAESE
'qbe_f_personbo->CAP
'qbe_f_personbo->CODINTER
'qbe_f_personbo->TIPINTER
'_tipper
'qbe_f_personbo->CODDIPE
'qbe_f_personbo->PARTIVA
'qbe_f_personbo->NOTE
'qbe_f_personbo->SESSO
'qbe_f_personbo->SOSPMAF
'iif(DateToChar(qbe_f_personbo->DATAVALI)='18991230',NullDate(),qbe_f_personbo->DATAVALI)
'cSNAS
'qbe_f_personbo->DOCFILE
'qbe_f_personbo->NOME
'qbe_f_personbo->COGNOME
'qbe_f_personbo->CFESTERO
'qbe_f_personbo->OLDCONNES
'qbe_f_personbo->PKTBSPECIE
'qbe_f_personbo->COMPORT
'qbe_f_personbo->ATTIV
'qbe_f_personbo->RNATGIU
'qbe_f_personbo->RATTIV
'qbe_f_personbo->RCOMP
'qbe_f_personbo->RAREA
'nProgImp
'qbe_f_personbo->AREAGEO
'qbe_f_personbo->PEP
'qbe_f_personbo->DATASEGN
'qbe_f_personbo->SETTSINT2
'qbe_f_personbo->DATAVARAGE
'qbe_f_personbo->SETTSINT2
'qbe_f_personbo->FATCA
'Left(qbe_f_personbo->OLDCONNES,11)
'qbe_f_personbo->TIN
'qbe_f_personbo->ODB
'qbe_f_personbo->TELEF
'qbe_f_personbo->TIPOORO
'qbe_f_personbo->CODORO
'qbe_f_personbo->NOTIT
'qbe_f_personbo->IDBASE
'qbe_f_personbo->FLGVALIDO
'qbe_f_personbo->CITTADIN1
'qbe_f_personbo->CITTADIN2
'qbe_f_personbo->RESFISC
'qbe_f_personbo->MITIG
'qbe_f_personbo->MITIGDOC
'qbe_f_personbo->NOSARA
'qbe_f_personbo->RISGLOB
'qbe_f_personbo->DATAPROF
'qbe_f_personbo->DATAREVPRO
'qbe_f_personbo->IDENT
'qbe_f_personbo->PEPDATE
'qbe_f_personbo->DAC6
'qbe_f_personbo->FLAGDAC6
'qbe_f_personbo->CRIME
'qbe_f_personbo->CRIMEDATE
'qbe_f_personbo->ALTRODOM
'qbe_f_personbo->ALTROCAP
'qbe_f_personbo->CONTO
'qbe_f_personbo->NUMIMP
'qbe_f_personbo->DATAIDENT
'qbe_f_personbo->DATASEGN
'qbe_f_personbo->DATARAUT
]
I
obj='Select
pag=3
prev=O274
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=_connes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O275
fatherSonIndex=0
frm_calc='NullDate()
len=8
name='_datamin
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='wersonbo
obj='Insert
pag=3
prev=O300
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'datamodi
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
'DATAVARAGE
'SETTSINT2
'FATCA
'BANCABEN
'TIN
'ODB
'TELEF
'TIPOORO
'CODORO
'IDNASCOMUN
'IDNASSTATO
'NOTIT
'IDBASE
'FLGVALIDO
'CITTADIN1
'CITTADIN2
'RESFISC
'MITIG
'MITGDOC
'NOSARA
'RISGLOB
'DATAPROF
'DATAREVPROF
'IDENT
'PEPDATE
'DAC6
'FLAGDAC6
'CRIME
'CRIMEDATE
'ALTRODOM
'ALTROCAP
'CONTO
'NUMIMP
'RAPSEGNA
'CODLEGRAP
'TIPOSOGGETTO
'CAUSALE
'IMPORTOMAX
'FATTURATO
'FREQUENZA
'NUMOPERAZ
'SOGAFFIDATARIO
'FLGNOTRIM
'DISATTIVO
'DATAFINE
'DATAINI
'DATAIDENT
'DATARAUT
]
rd_kvar=[
'cProgSto
'Upper(personbo->CONNES)
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'_datamin
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
'personbo->DATAVARAGE
'personbo->SETTSINT2
'personbo->FATCA
'personbo->BANCABEN
'personbo->TIN
'personbo->ODB
'personbo->TELEF
'personbo->TIPOORO
'personbo->CODORO
'personbo->IDNASCOMUN
'personbo->IDNASSTATO
'personbo->NOTIT
'personbo->IDBASE
'personbo->FLGVALIDO
'personbo->CITTADIN1
'personbo->CITTADIN2
'personbo->RESFISC
'personbo->MITIG
'personbo->MITIGDOC
'personbo->NOSARA
'personbo->RISGLOB
'personbo->DATAPROF
'personbo->DATAREVPROF
'personbo->IDENT
'personbo->PEPDATE
'personbo->DAC6
'personbo->FLAGDAC6
'personbo->CRIME
'personbo->CRIMEDATE
'personbo->ALTRODOM
'personbo->ALTROCAP
'personbo->CONTO
'personbo->NUMIMP
'personbo->RAPSEGNA
'personbo->CODLEGRAP
'personbo->TIPOSOGGETTO
'personbo->CAUSALE
'personbo->IMPORTOMAX
'personbo->FATTURATO
'personbo->FREQUENZA
'personbo->NUMOPERAZ
'personbo->SOGAFFIDATARIO
'personbo->FLGNOTRIM
'personbo->DISATTIVO
'personbo->DATAFINE
'personbo->DATAINI
'personbo->DATAIDENT
'personbo->DATARAUT
]
I
obj='Select
pag=3
prev=O299
sel_field='f_opextrbo->DATAOPE
sel_name='f_opextrbo
sel_where='f_opextrbo->COLLEG=_connes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O300
fatherSonIndex=0
frm_calc='f_opextrbo->DATAOPE
len=8
name='_datamin
obj='Var
obj_type='D
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='D
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O273
var_op='asgn
I
nonlocal=True
obj='Var
pag=3
prev=O272
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O271
var_op='asgn
I
obj='Var
pag=3
prev=O268
var_op='asgn
I
obj='If
pag=3
prev=O267
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O268
fatherSonIndex=0
frm_calc='qbe_f_personbo->NASCOMUN
len=30
name='cSNAS
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O268
fatherSonIndex=1
frm_calc='qbe_f_personbo->NASCOMUN
len=30
name='cCNAS
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=3
prev=O266
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=3
prev=O232
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Upper(qbe_f_personbo->CONNES)
]
rd_var=[
'_connes
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O223
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O215
var_op='asgn
I
obj='If
pag=3
prev=O213
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O215
fatherSonIndex=0
frm_calc='1
len=11
name='_cicli
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O215
fatherSonIndex=1
frm_calc='iif(Mod(_maxfon,20000) <> 0,Int(_maxfon/20000) + 1,Int(_maxfon/20000))
len=11
name='_cicli
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=3
prev=O212
sel_field='reccount() as TOTALE
sel_name='qbe_f_personbo_totale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O213
fatherSonIndex=0
frm_calc='qbe_f_personbo_totale->TOTALE
len=11
name='_maxfon
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O211
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O127
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=3
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=3
prev=O125
I
obj='Remark
pag=3
prev=O124
I
nonlocal=True
obj='Var
pag=3
prev=O123
var_op='asgn
I
obj='Remark
pag=3
x=21
y=19
I
Icpitembatch.CPDelete
arch='personbo
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOCLI\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='personbo
obj='Insert
pag=3
prev=O338
rd_kfield=[
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'PROGIMPORT
'AREAGEO
'PEP
'DATASEGN
'OLDSETSIN
'DATAVARAGE
'SETTSINT2
'FATCA
'BANCABEN
'TIN
'ODB
'TELEF
'TIPOORO
'CODORO
'NOTIT
'IDBASE
'FLGVALIDO
'CITTADIN1
'CITTADIN2
'RESFISC
'MITIG
'MITIGDOC
'NOSARA
'RISGLOB
'DATAPROF
'DATAREVPROF
'IDENT
'PEPDATE
'DAC6
'FLAGDAC6
'CRIME
'CRIMEDATE
'ALTRODOM
'ALTROCAP
'CONTO
'NUMIMP
'DATAIDENT
'DATASIGN
'DATARAUT
]
rd_kvar=[
'Upper(f_personbo->CONNES)
'f_personbo->CODCAB
'f_personbo->RAGSOC
'f_personbo->DOMICILIO
'f_personbo->CODFISC
'iif(DateToChar(f_personbo->DATANASC)='18991230',NullDate(),f_personbo->DATANASC)
'cCNAS
'f_personbo->SOTGRUP
'f_personbo->RAMOGRUP
'f_personbo->SETTSINT
'f_personbo->TIPODOC
'f_personbo->NUMDOCUM
'iif(DateToChar(f_personbo->DATARILASC)='18991230',NullDate(),f_personbo->DATARILASC)
'f_personbo->AUTRILASC
'f_personbo->DESCCIT
'f_personbo->PROVINCIA
'f_personbo->PAESE
'f_personbo->CAP
'f_personbo->CODINTER
'f_personbo->TIPINTER
'_tipper
'f_personbo->CODDIPE
'f_personbo->PARTIVA
'f_personbo->NOTE
'f_personbo->SESSO
'f_personbo->SOSPMAF
'iif(DateToChar(f_personbo->DATAVALI)='18991230',NullDate(),f_personbo->DATAVALI)
'cSNAS
'f_personbo->DOCFILE
'f_personbo->NOME
'f_personbo->COGNOME
'f_personbo->CFESTERO
'f_personbo->OLDCONNES
'f_personbo->PKTBSPECIE
'f_personbo->COMPORT
'f_personbo->ATTIV
'f_personbo->RNATGIU
'f_personbo->RATTIV
'f_personbo->RCOMP
'f_personbo->RAREA
'nProgImp
'f_personbo->AREAGEO
'f_personbo->PEP
'f_personbo->DATASEGN
'f_personbo->SETTSINT2
'f_personbo->DATAVARAGE
'f_personbo->SETTSINT2
'f_personbo->FATCA
'Left(f_personbo->OLDCONNES,11)
'f_personbo->TIN
'f_personbo->ODB
'f_personbo->TELEF
'f_personbo->TIPOORO
'f_personbo->CODORO
'f_personbo->NOTIT
'f_personbo->IDBASE
'f_personbo->FLGVALIDO
'f_personbo->CITTADIN1
'f_personbo->CITTADIN2
'f_personbo->RESFISC
'f_personbo->MITIG
'f_personbo->MITIGDOC
'f_personbo->NOSARA
'f_personbo->RISGLOB
'f_personbo->DATAPROF
'f_personbo->DATAREVPRO
'f_personbo->IDENT
'f_personbo->PEPDATE
'f_personbo->DAC6
'f_personbo->FLAGDAC6
'f_personbo->CRIME
'f_personbo->CRIMEDATE
'f_personbo->ALTRODOM
'f_personbo->ALTROCAP
'f_personbo->CONTO
'f_personbo->NUMIMP
'f_personbo->DATAIDENT
'f_personbo->DATASEGN
'f_personbo->DATARAUT
]
I
obj='Var
obj_type='N
pag=3
prev=O337
var_op='asgn
I
obj='Delete
pag=3
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'_connes
]
x=1176
y=1527
I
Icpitembatch.CPRemark
frm_calc='Dati Rapporti
next=Icpitembatch.CPVarDecl
len=25
name='_codrap
next=Icpitembatch.CPVarDecl
comment='Vecchio codice rapporto
len=25
name='_oldrapporto
next=Icpitembatch.CPVarDecl
len=10
name='check_prog
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Rapporti' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Rapporti' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Rappoorti' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file Rapporti'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPRemark
frm_calc='Informazioni Rapporti
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Informazioni Rapporti' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='check_prog
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPIfElse
frm_calc=[
'check_prog>0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Informazioni Rapporti' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=3
name='_numrig
next=Icpitembatch.CPVarDecl
comment='Vecchio codice rapporto
frm_calc='''
len=25
name='_oldrapporto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Informazioni Rapporti' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file Informazioni Rapporti'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=4
prev=O371
var_op='asgn
I
nonlocal=True
obj='Var
pag=4
prev=O369
var_op='asgn
I
obj='Select
pag=4
prev=O368
sel_name='f_delegabo
sel_order='f_delegabo->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O369
fatherSonIndex=0
frm_calc=[
'not(Empty(f_delegabo->CODINTER))
]
h=[
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O375
fatherSonIndex=0
frm_calc=[
'_oldrapporto<>f_delegabo->RAPPORTO
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPInsert
arch='delegabo
obj='Insert
pag=4
prev=O380
rd_kfield=[
'RAPPORTO
'CPROWNUM
'CODINTER
'DESCINTER
'DATAINI
'TIPORAP
'TIPOPERS
'STATOREG
'OPERAZMOD
'DATARETT
'IDEREG
'COLLEGAMEN
'DATAFINE
'NUMPROG1
'NUMPROG2
'IDBASE
'UCODE
'ABBINATO
'NOAGE
]
rd_kvar=[
'f_delegabo->RAPPORTO
'_numrig
'f_delegabo->CODINTER
'f_delegabo->DESCINTER
'f_delegabo->DATAINI
'f_delegabo->TIPORAP
'f_delegabo->TIPOPERS
'f_delegabo->STATOREG
'f_delegabo->OPERAZMOD
'f_delegabo->DATARETT
'f_delegabo->IDEREG
'f_delegabo->COLLEGAMEN
'f_delegabo->DATAFINE
'f_delegabo->NUMPROG1
'f_delegabo->NUMPROG2
'f_delegabo->IDBASE
'f_delegabo->UCODE
'f_delegabo->ABBINATO
'f_delegabo->NOAGE
]
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O380
fatherSonIndex=0
frm_calc='1
len=3
name='_numrig
next=Icpitembatch.CPVarDecl
comment='Vecchio codice rapporto
frm_calc='f_delegabo->RAPPORTO
len=25
name='_oldrapporto
obj='Var
pag=4
prev=O388
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O380
fatherSonIndex=1
frm_calc='_numrig + 1
len=3
name='_numrig
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
prev=O367
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O366
var_op='asgn
I
nonlocal=True
obj='Var
pag=4
prev=O363
var_op='asgn
I
obj='If
pag=4
prev=O362
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O363
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=4
par_expr=[
''rapopebo'
''NUMPROG'
]
par_name=[
'tbname
'fldname
]
sel_name='qbe_tab_mmc
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O397
fatherSonIndex=0
obj='Write
pag=4
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PRGINFO2\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'qbe_tab_mmc->max
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O363
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=4
par_expr=[
''rapopebo'
''NUMPROG'
]
par_name=[
'tbname
'fldname
]
sel_name='qbe_tab_mmc
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O412
fatherSonIndex=0
obj='Insert
pag=4
rd_kfield=[
'tablecode
'warncode
'autonum
]
rd_kvar=[
'"prog\PRGINFO2\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
'qbe_tab_mmc->max
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=4
prev=O361
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PRGINFO2\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
rd_var=[
'check_prog
]
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O359
var_op='asgn
I
obj='Select
pag=4
prev=O358
sel_field='*
sel_name='f_rapopebo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O359
fatherSonIndex=0
frm_calc=[
'not(Empty(f_rapopebo->RAPPORTO))
]
h=[
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O429
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Informazioni Rapporti'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='rapopebo
next=Icpitembatch.CPVarDecl
frm_calc='1
len=3
name='_numrig
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=4
prev=O438
sel_field='*
sel_name='f_soggetbo
sel_where='f_soggetbo->IDFILEBO=f_rapopebo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O439
fatherSonIndex=0
frm_calc=[
'not(Empty(f_soggetbo->CODSOG))
]
h=[
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='soginfo
father=O443
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='_numrig + 1
len=3
name='_numrig
obj='Var
obj_type='N
pag=4
prev=O448
var_op='asgn
I
obj='Insert
pag=4
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UNIQUECODE
]
rd_kvar=[
'f_soggetbo->IDFILEBO
'_numrig
'Upper(f_soggetbo->CODSOG)
'f_soggetbo->LEGAME
'f_soggetbo->IDBASE
'f_soggetbo->NUMCOL
'f_soggetbo->TIPOFILE
'f_soggetbo->RAPCOL
'f_soggetbo->UCODE
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O437
var_op='asgn
I
obj='Insert
pag=4
prev=O436
rd_kfield=[
'AUTOM
'CAMBIO
'CDATOPE
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAAGE
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'IDEREG
'INFORM
'NUMPROG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PRGIMPINF
'PROV2
'PROVINCIA
'RAPPORTBEN
'RAPPORTO
'RESPINS
'SEGNO
'STATOREG
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'VALUTA
]
rd_kvar=[
'f_rapopebo->AUTOM
'f_rapopebo->CAMBIO
'DateToChar(f_rapopebo->DATAOPE)
'f_rapopebo->CODANA
'f_rapopebo->CODCAB
'f_rapopebo->CODCAB2
'f_rapopebo->CODDIPE
'f_rapopebo->CODINT2
'Upper(f_rapopebo->CODINTER)
'f_rapopebo->CODVOC
'f_rapopebo->COLLEG
'f_rapopebo->CONNESBEN
'f_rapopebo->CONNESCLI
'f_rapopebo->CONNESOPER
'iif(DateToChar(f_rapopebo->DATAAGE)='18991230',NullDate(),f_rapopebo->DATAAGE)
'iif(DateToChar(f_rapopebo->DATAOPE)='18991230',NullDate(),f_rapopebo->DATAOPE)
'iif(DateToChar(f_rapopebo->DATAREG)='18991230',NullDate(),f_rapopebo->DATAREG)
'iif(DateToChar(f_rapopebo->DATARETT)='18991230',NullDate(),f_rapopebo->DATARETT)
'f_rapopebo->DESC2
'f_rapopebo->DESCCIT
'f_rapopebo->DESCINTER
'f_rapopebo->FLAGCONT
'f_rapopebo->FLAGFRAZ
'f_rapopebo->FLAGLIRE
'f_rapopebo->FLAGRAP
'f_rapopebo->FLAGRAP2
'f_rapopebo->IDBASE
'f_rapopebo->IDEREG
'f_rapopebo->INFORM
'f_rapopebo->NUMPROG
'f_rapopebo->OPERATORE
'f_rapopebo->OPERAZMOD
'f_rapopebo->OPRAP
'f_rapopebo->PAESE
'nProgImp
'f_rapopebo->PROV2
'f_rapopebo->PROVINCIA
'f_rapopebo->RAPPORTBEN
'f_rapopebo->RAPPORTO
'f_rapopebo->RESPINS
'f_rapopebo->SEGNO
'f_rapopebo->STATOREG
'f_rapopebo->TIPOINF
'f_rapopebo->TIPOINT2
'f_rapopebo->TIPOINTER
'f_rapopebo->TIPOLEG
'f_rapopebo->TIPOOPRAP
'f_rapopebo->TOTCONT
'f_rapopebo->TOTLIRE
'f_rapopebo->UCODE
'f_rapopebo->VALUTA
]
I
obj='Var
obj_type='N
pag=4
prev=O435
var_op='asgn
I
nonlocal=True
obj='Var
pag=4
prev=O434
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O357
var_op='asgn
I
nonlocal=True
obj='Var
pag=4
prev=O356
var_op='asgn
I
obj='Remark
pag=4
prev=O355
I
nonlocal=True
obj='Var
pag=4
prev=O354
var_op='asgn
I
nonlocal=True
obj='Var
pag=4
prev=O353
var_op='asgn
I
nonlocal=True
obj='Var
pag=4
prev=O351
var_op='asgn
I
obj='Select
pag=4
prev=O350
sel_field='*
sel_name='f_anarapbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O351
fatherSonIndex=0
frm_calc=[
'not(Empty(f_anarapbo->RAPPORTO))
]
h=[
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O460
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Rapporti'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='anarapbo
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='_codrap
next=Icpitembatch.CPRead
arch='knarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_codrap)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='1
len=3
name='_numrig
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=4
prev=O474
sel_field='*
sel_name='f_intestbo
sel_where='f_intestbo->RAPPORTO=f_anarapbo->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O475
fatherSonIndex=0
frm_calc=[
'not(Empty(f_intestbo->CODINTER))
]
h=[
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O479
fatherSonIndex=0
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Intestatari Rapporti'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='intestbo
next=Icpitembatch.CPVarDecl
frm_calc='_numrig + 1
len=3
name='_numrig
obj='Var
obj_type='N
pag=4
prev=O486
var_op='asgn
I
obj='Insert
pag=4
prev=O485
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'DATAFINE
'NUMPROG1
'NUMPROG2
'RAPPORTO
'TIPORAP
'STATOREG
'DESCINTER
'OPERAZMOD
'DATARETT
'IDEREG
'COLLEGAMEN
'UCODE
'ABBINATO
'PRGIMPSOG
]
rd_kvar=[
'f_intestbo->IDBASE
'_numrig
'iif(DateToChar(f_intestbo->DATAINI)='18991230',NullDate(),f_intestbo->DATAINI)
'f_intestbo->TIPOPERS
'Upper(f_intestbo->CODINTER)
'iif(DateToChar(f_intestbo->DATAFINE)='18991230',NullDate(),f_intestbo->DATAFINE)
'f_intestbo->NUMPROG1
'f_intestbo->NUMPROG2
'f_intestbo->RAPPORTO
'f_intestbo->TIPORAP
'f_intestbo->STATOREG
'f_intestbo->DESCINTER
'f_intestbo->OPERAZMOD
'iif(DateToChar(f_intestbo->DATARETT)='18991230',NullDate(),f_intestbo->DATARETT)
'f_intestbo->IDEREG
'f_intestbo->COLLEGAMEN
'f_intestbo->UCODE
'f_intestbo->ABBINATO
'nProgImp2
]
I
obj='Var
obj_type='N
pag=4
prev=O484
var_op='asgn
I
nonlocal=True
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O471
var_op='asgn
I
obj='If
pag=4
prev=O470
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='knarapbo
father=O471
fatherSonIndex=0
obj='Insert
pag=4
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGRAP
]
rd_kvar=[
'f_anarapbo->RAPPORTO
'f_anarapbo->DESCRAP
''D'
'f_anarapbo->TIPORAP
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='knarapbo
father=O471
fatherSonIndex=1
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'f_anarapbo->RAPPORTO
]
wr_field=[
'DESCRAP
'TIPORAP
'FLAGRAP
]
wr_op=[
'=
'=
'=
]
wr_var=[
'f_anarapbo->DESCRAP
''D'
'f_anarapbo->TIPORAP
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=4
prev=O469
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'f_anarapbo->RAPPORTO
]
rd_var=[
'_codrap
]
I
obj='Var
pag=4
prev=O468
var_op='asgn
I
obj='Insert
pag=4
prev=O467
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'CONTINUA
'TIPOAG
'DOCFILE
'NOPROT
'TIPMOD
'DATAMOD
'IDRAPPORTO
'IDBASE
'RAGIO
'MODSVOL
'AREAGEO
'SCOPO
'NATURA
'RTIPO
'RCOMP
'RIMP
'RFREQ
'RRAGIO
'RAREA
'TIPO
'PRGIMPRAP
'AMMONT
'DURAT
'IMPAPE
'IMPCHIU
]
rd_kvar=[
'f_anarapbo->RAPPORTO
'f_anarapbo->DESCRAP
'f_anarapbo->TIPORAP
'f_anarapbo->FLAGLIRE
'f_anarapbo->VALUTA
'f_anarapbo->CONTINUA
'f_anarapbo->TIPOAG
'f_anarapbo->DOCFILE
'f_anarapbo->NOPROT
'f_anarapbo->TIPMOD
'iif(DateToChar(f_anarapbo->DATAMOD)='18991230',NullDate(),f_anarapbo->DATAMOD)
'f_anarapbo->IDRAPPORTO
'f_anarapbo->IDBASE
'f_anarapbo->RAGIO
'f_anarapbo->MODSVOL
'f_anarapbo->AREAGEO
'f_anarapbo->SCOPO
'f_anarapbo->NATURA
'f_anarapbo->RTIPO
'f_anarapbo->RCOMP
'f_anarapbo->RIMP
'f_anarapbo->RFREQ
'f_anarapbo->RRAGIO
'f_anarapbo->RAREA
'f_anarapbo->TIPO
'nProgImp
'f_anarapbo->AMMONT
'f_anarapbo->DURAT
'0
'0
]
I
obj='Var
obj_type='N
pag=4
prev=O466
var_op='asgn
I
nonlocal=True
obj='Var
pag=4
prev=O465
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O349
var_op='asgn
I
nonlocal=True
obj='Var
pag=4
prev=O348
var_op='asgn
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O347
I
obj='Var
pag=4
prev=O346
I
obj='Var
pag=4
prev=O345
I
obj='Remark
pag=4
x=10
y=19
I
Icpitembatch.CPRemark
frm_calc='Informazioni Titolarità
next=Icpitembatch.CPVarDecl
len=10
name='check_prog
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Informazioni Titolarità' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Idbase
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='check_prog
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPIfElse
frm_calc=[
'check_prog>0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPRemark
frm_calc='Progessivo
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='check_prog
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPIfElse
frm_calc=[
'check_prog>0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Informazioni Titolarità' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file di intestazioni Titolarità' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Informazioni Titolarità' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file Informazioni Titolarità'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=6
prev=O537
var_op='asgn
I
nonlocal=True
obj='Var
pag=6
prev=O536
var_op='asgn
I
nonlocal=True
obj='Var
pag=6
prev=O534
var_op='asgn
I
obj='Select
pag=6
prev=O533
sel_field='*
sel_name='f_inttitbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O534
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file di intestazione Titolarità'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTITE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='intestit
obj='Insert
pag=6
prev=O543
rd_kfield=[
'PRGIMPTITE
'CODCLI
'RAPPORTO
'CODINTER
'DESCINTER
'DATAINI
'TIPORAP
'TIPOPERS
'STATOREG
'OPERAZMOD
'DATARETT
'IDEREG
'COLLEGAMEN
'DATAFINE
'NUMPROG1
'NUMPROG2
'IDBASE
'UCODE
'ABBINATO
]
rd_kvar=[
'nProgImp
'Upper(f_inttitbo->CONNESCLI)
'f_inttitbo->RAPPORTO
'Upper(f_inttitbo->CODINTER)
'f_inttitbo->DESCINTER
'f_inttitbo->DATAINI
'f_inttitbo->TIPORAP
'f_inttitbo->TIPOPERS
'f_inttitbo->STATOREG
'f_inttitbo->OPERAZMOD
'f_inttitbo->DATARETT
'f_inttitbo->IDEREG
'f_inttitbo->COLLEGAMEN
'f_inttitbo->DATAFINE
'f_inttitbo->NUMPROG1
'f_inttitbo->NUMPROG2
'f_inttitbo->IDBASE
'f_inttitbo->UCODE
'f_inttitbo->ABBINATO
]
I
obj='Var
obj_type='N
pag=6
prev=O542
var_op='asgn
I
nonlocal=True
obj='Var
pag=6
prev=O541
var_op='asgn
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O532
var_op='asgn
I
nonlocal=True
obj='Var
pag=6
prev=O529
var_op='asgn
I
obj='If
pag=6
prev=O528
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O529
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=6
par_expr=[
''rapotit'
''NUMPROG'
]
par_name=[
'tbname
'fldname
]
sel_name='qbe_tab_mmc
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O550
fatherSonIndex=0
obj='Write
pag=6
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PRGTITO2\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'qbe_tab_mmc->max
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O529
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=6
par_expr=[
''rapotit'
''NUMPROG'
]
par_name=[
'tbname
'fldname
]
sel_name='qbe_tab_mmc
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O565
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'tablecode
'autonum
'warncode
]
rd_kvar=[
'"prog\PRGTITO2\'"+LRTrim(gAzienda)+"'"
'qbe_tab_mmc->max
'LRTrim(gAzienda)
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=6
prev=O527
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PRGTITO2\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
rd_var=[
'check_prog
]
I
obj='Var
obj_type='N
pag=6
pagelocal=True
prev=O526
var_op='asgn
I
obj='Remark
pag=6
prev=O523
I
obj='If
pag=6
prev=O522
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O523
fatherSonIndex=0
obj='Write
pag=6
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PRGTITO1\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'_maxfon
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O523
fatherSonIndex=1
obj='Insert
pag=6
rd_kfield=[
'tablecode
'autonum
'warncode
]
rd_kvar=[
'"prog\PRGTITO1\'"+LRTrim(gAzienda)+"'"
'_maxfon
'LRTrim(gAzienda)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=6
prev=O521
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PRGTITO1\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
rd_var=[
'check_prog
]
I
obj='Var
obj_type='N
pag=6
pagelocal=True
prev=O520
var_op='asgn
I
obj='Remark
pag=6
prev=O518
I
obj='Select
pag=6
prev=O517
sel_field='*
sel_name='f_rapotit
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O518
fatherSonIndex=0
frm_calc=[
'not(Empty(f_rapotit->CONNESCLI))
]
h=[
19
19
]
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O600
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Informazioni Titolarità'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTIT\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='rapotit
obj='Insert
pag=6
prev=O607
rd_kfield=[
'IDBASE
'NUMPROG
'DATAOPE
'TIPOINTER
'CODINTER
'TIPOINF
'IDEREG
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'OPRAP
'TIPOOPRAP
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'STATOREG
'OPERAZMOD
'CONNESCLI
'CONNESOPER
'CONNESBEN
'COLLEG
'CAMBIO
'RAPPORTBEN
'FLAGRAP2
'OPERATORE
'AUTOM
'RESPINS
'INFORM
'DATAAGE
'UCODE
'PRGIMPTIT
'CDATOPE
]
rd_kvar=[
'f_rapotit->IDBASE
'f_rapotit->NUMPROG
'iif(DateToChar(f_rapotit->DATAOPE)='18991230',NullDate(),f_rapotit->DATAOPE)
'f_rapotit->TIPOINTER
'f_rapotit->CODINTER
'f_rapotit->TIPOINF
'f_rapotit->IDEREG
'f_rapotit->CODDIPE
'f_rapotit->DESCCIT
'f_rapotit->PROVINCIA
'f_rapotit->CODCAB
'f_rapotit->FLAGFRAZ
'f_rapotit->FLAGCONT
'f_rapotit->CODANA
'f_rapotit->CODVOC
'f_rapotit->TIPOINT2
'f_rapotit->CODINT2
'f_rapotit->PAESE
'f_rapotit->DESC2
'f_rapotit->PROV2
'f_rapotit->CODCAB2
'f_rapotit->DESCINTER
'f_rapotit->RAPPORTO
'f_rapotit->FLAGRAP
'f_rapotit->TIPOLEG
'iif(DateToChar(f_rapotit->DATAREG)='18991230',NullDate(),f_rapotit->DATAREG)
'f_rapotit->OPRAP
'f_rapotit->TIPOOPRAP
'f_rapotit->FLAGLIRE
'f_rapotit->VALUTA
'f_rapotit->SEGNO
'f_rapotit->TOTLIRE
'f_rapotit->TOTCONT
'f_rapotit->STATOREG
'f_rapotit->OPERAZMOD
'Upper(f_rapotit->CONNESCLI)
'Upper(f_rapotit->CONNESOPER)
'Upper(f_rapotit->CONNESBEN)
'f_rapotit->COLLEG
'f_rapotit->CAMBIO
'f_rapotit->RAPPORTBEN
'f_rapotit->FLAGRAP2
'f_rapotit->OPERATORE
'f_rapotit->AUTOM
'f_rapotit->RESPINS
'f_rapotit->INFORM
'iif(DateToChar(f_rapotit->DATAAGE)='18991230',NullDate(),f_rapotit->DATAAGE)
'f_rapotit->UCODE
'nProgImp
'DateToChar(f_rapotit->DATAOPE)
]
I
obj='Var
obj_type='N
pag=6
prev=O606
var_op='asgn
I
nonlocal=True
obj='Var
pag=6
prev=O605
var_op='asgn
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O516
var_op='asgn
I
nonlocal=True
obj='Var
pag=6
prev=O515
var_op='asgn
I
obj='Var
obj_type='N
pag=6
pagelocal=True
prev=O514
I
obj='Remark
pag=6
x=13
y=21
I
Icpitembatch.CPRemark
frm_calc='Dati Rapporti
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Rapporti (AGE)' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Rapporti (AGE)'+ NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Rappoorti (AGE)' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file Rapporti (AGE)'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPRemark
frm_calc='Informazioni Rapporti
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Informazioni Rapporti (AGE)' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Informazioni Rapporti (AGE)' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Informazioni Rapporti (AGE)' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file Informazioni Rapporti (AGE)'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=7
prev=O627
var_op='asgn
I
nonlocal=True
obj='Var
pag=7
prev=O626
var_op='asgn
I
nonlocal=True
obj='Var
pag=7
prev=O624
var_op='asgn
I
obj='Select
pag=7
prev=O623
sel_field='*
sel_name='f_japopebo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O624
fatherSonIndex=0
frm_calc=[
'not(Empty(f_japopebo->RAPPORTO))
]
h=[
19
19
]
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O631
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Informazioni Rapporti (AGE)'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINFAGE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='japopebo
obj='Insert
pag=7
prev=O638
rd_kfield=[
'IDBASE
'NUMPROG
'DATAOPE
'TIPOINTER
'CODINTER
'TIPOINF
'IDEREG
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'OPRAP
'TIPOOPRAP
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'STATOREG
'OPERAZMOD
'CONNESCLI
'CONNESOPER
'CONNESBEN
'COLLEG
'CAMBIO
'RAPPORTBEN
'FLAGRAP2
'OPERATORE
'AUTOM
'RESPINS
'INFORM
'DATAAGE
'UCODE
'PRGIMPINF
'CDATOPE
]
rd_kvar=[
'f_japopebo->IDBASE
'f_japopebo->NUMPROG
'iif(DateToChar(f_japopebo->DATAOPE)='18991230',NullDate(),f_japopebo->DATAOPE)
'f_japopebo->TIPOINTER
'f_japopebo->CODINTER
'f_japopebo->TIPOINF
'f_japopebo->IDEREG
'f_japopebo->CODDIPE
'f_japopebo->DESCCIT
'f_japopebo->PROVINCIA
'f_japopebo->CODCAB
'f_japopebo->FLAGFRAZ
'f_japopebo->FLAGCONT
'f_japopebo->CODANA
'f_japopebo->CODVOC
'f_japopebo->TIPOINT2
'f_japopebo->CODINT2
'f_japopebo->PAESE
'f_japopebo->DESC2
'f_japopebo->PROV2
'f_japopebo->CODCAB2
'f_japopebo->DESCINTER
'f_japopebo->RAPPORTO
'f_japopebo->FLAGRAP
'f_japopebo->TIPOLEG
'iif(DateToChar(f_japopebo->DATAREG)='18991230',NullDate(),f_japopebo->DATAREG)
'f_japopebo->OPRAP
'f_japopebo->TIPOOPRAP
'f_japopebo->FLAGLIRE
'f_japopebo->VALUTA
'f_japopebo->SEGNO
'f_japopebo->TOTLIRE
'f_japopebo->TOTCONT
'f_japopebo->STATOREG
'f_japopebo->OPERAZMOD
'Upper(f_japopebo->CONNESCLI)
'Upper(f_japopebo->CONNESOPER)
'Upper(f_japopebo->CONNESBEN)
'f_japopebo->COLLEG
'f_japopebo->CAMBIO
'f_japopebo->RAPPORTBEN
'f_japopebo->FLAGRAP2
'f_japopebo->OPERATORE
'f_japopebo->AUTOM
'f_japopebo->RESPINS
'f_japopebo->INFORM
'iif(DateToChar(f_japopebo->DATAAGE)='18991230',NullDate(),f_japopebo->DATAAGE)
'f_japopebo->UCODE
'nProgImp
'DateToChar(f_japopebo->DATAOPE)
]
I
obj='Var
obj_type='N
pag=7
prev=O637
var_op='asgn
I
nonlocal=True
obj='Var
pag=7
prev=O636
var_op='asgn
I
obj='Var
obj_type='N
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=7
prev=O622
var_op='asgn
I
nonlocal=True
obj='Var
pag=7
prev=O621
var_op='asgn
I
obj='Remark
pag=7
prev=O620
I
nonlocal=True
obj='Var
pag=7
prev=O619
var_op='asgn
I
nonlocal=True
obj='Var
pag=7
prev=O618
var_op='asgn
I
nonlocal=True
obj='Var
pag=7
prev=O616
var_op='asgn
I
obj='Select
pag=7
prev=O615
sel_field='*
sel_name='f_jnarapbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O616
fatherSonIndex=0
frm_calc=[
'not(Empty(f_jnarapbo->RAPPORTO))
]
h=[
19
19
]
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O646
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Rapporti (AGE)'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPRAPAGE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='jnarapbo
next=Icpitembatch.CPVarDecl
frm_calc='1
len=3
name='_numrig
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=7
prev=O655
sel_field='*
sel_name='f_jntestbo
sel_where='f_jntestbo->RAPPORTO=f_jnarapbo->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O656
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOGAGE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='jntestbo
next=Icpitembatch.CPVarDecl
frm_calc='_numrig + 1
len=3
name='_numrig
obj='Var
obj_type='N
pag=7
prev=O661
var_op='asgn
I
obj='Insert
pag=7
prev=O660
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'DATAFINE
'NUMPROG1
'NUMPROG2
'RAPPORTO
'TIPORAP
'STATOREG
'DESCINTER
'OPERAZMOD
'DATARETT
'IDEREG
'COLLEGAMEN
'UCODE
'ABBINATO
'PRGIMPSOG
]
rd_kvar=[
'f_jntestbo->IDBASE
'_numrig
'iif(DateToChar(f_jntestbo->DATAINI)='18991230',NullDate(),f_jntestbo->DATAINI)
'f_jntestbo->TIPOPERS
'Upper(f_jntestbo->CODINTER)
'iif(DateToChar(f_jntestbo->DATAFINE)='18991230',NullDate(),f_jntestbo->DATAFINE)
'f_jntestbo->NUMPROG1
'f_jntestbo->NUMPROG2
'f_jntestbo->RAPPORTO
'f_jntestbo->TIPORAP
'f_jntestbo->STATOREG
'f_jntestbo->DESCINTER
'f_jntestbo->OPERAZMOD
'iif(DateToChar(f_jntestbo->DATARETT)='18991230',NullDate(),f_jntestbo->DATARETT)
'f_jntestbo->IDEREG
'f_jntestbo->COLLEGAMEN
'f_jntestbo->UCODE
'f_jntestbo->ABBINATO
'nProgImp2
]
I
obj='Var
obj_type='N
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=7
prev=O654
var_op='asgn
I
obj='Insert
pag=7
prev=O653
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'CONTINUA
'TIPOAG
'DOCFILE
'NOPROT
'TIPMOD
'DATAMOD
'IDRAPPORTO
'IDBASE
'RAGIO
'MODSVOL
'AREAGEO
'SCOPO
'NATURA
'RTIPO
'RCOMP
'RIMP
'RFREQ
'RRAGIO
'RAREA
'TIPO
'PRGIMPRAP
'AMMONT
'DURAT
'IMPAPE
'IMPCHIU
]
rd_kvar=[
'f_jnarapbo->RAPPORTO
'f_jnarapbo->DESCRAP
'f_jnarapbo->TIPORAP
'f_jnarapbo->FLAGLIRE
'f_jnarapbo->VALUTA
'f_jnarapbo->CONTINUA
'f_jnarapbo->TIPOAG
'f_jnarapbo->DOCFILE
'f_jnarapbo->NOPROT
'f_jnarapbo->TIPMOD
'iif(DateToChar(f_jnarapbo->DATAMOD)='18991230',NullDate(),f_jnarapbo->DATAMOD)
'f_jnarapbo->IDRAPPORTO
'f_jnarapbo->IDBASE
'f_jnarapbo->RAGIO
'f_jnarapbo->MODSVOL
'f_jnarapbo->AREAGEO
'f_jnarapbo->SCOPO
'f_jnarapbo->NATURA
'f_jnarapbo->RTIPO
'f_jnarapbo->RCOMP
'f_jnarapbo->RIMP
'f_jnarapbo->RFREQ
'f_jnarapbo->RRAGIO
'f_jnarapbo->RAREA
'f_jnarapbo->TIPO
'nProgImp
'f_jnarapbo->AMMONT
'f_jnarapbo->DURAT
'0
'0
]
I
obj='Var
obj_type='N
pag=7
prev=O652
var_op='asgn
I
nonlocal=True
obj='Var
pag=7
prev=O651
var_op='asgn
I
obj='Var
obj_type='N
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=7
prev=O614
var_op='asgn
I
nonlocal=True
obj='Var
pag=7
prev=O613
var_op='asgn
I
obj='Remark
pag=7
x=19
y=20
I
Icpitembatch.CPRemark
frm_calc='Legge la tabella aetesta e aggiunge i record
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Anagrafe dei rapporti' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Anagrafe dei rapporti' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Anagrafe dei rapporti' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file Anagrafe dei rapporti'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=8
prev=O676
var_op='asgn
I
nonlocal=True
obj='Var
pag=8
prev=O675
var_op='asgn
I
nonlocal=True
obj='Var
pag=8
prev=O673
var_op='asgn
I
obj='Select
pag=8
prev=O672
sel_field='*
sel_name='f_aetesta
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O673
fatherSonIndex=0
frm_calc=[
'not(Empty(f_aetesta->RAPPORTO))
]
h=[
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O680
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Anagrafe dei Rapporti'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGAET\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aetesta
next=Icpitembatch.CPVarDecl
frm_calc='1
len=3
name='_numrig
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=8
prev=O689
sel_field='*
sel_name='f_aerighe
sel_where='f_aerighe->RAPPORTO=f_aetesta->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O690
fatherSonIndex=0
frm_calc=[
'not(Empty(f_aerighe->CONNESINT))
]
h=[
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O694
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PROGAER\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPInsert
arch='aerighe
next=Icpitembatch.CPVarDecl
frm_calc='_numrig + 1
len=3
name='_numrig
obj='Var
obj_type='N
pag=8
prev=O701
var_op='asgn
I
obj='Insert
pag=8
prev=O700
rd_kfield=[
'ABBSALDI
'ADATA
'ADATARET
'ADTPRE
'AFILE
'ANNO
'AOLDFILE
'AOLDPROG
'APROG
'ASPEDITO
'CDATA
'CDATARET
'CDTPRE
'CFILE
'COLDFILE
'COLDPROG
'CONNESINT
'CPROG
'CPROWNUM
'CSPEDITO
'ESITOANNO
'FILEANNO
'IDBASE
'IDRIF
'NOCODFISC
'PROG1
'PROG2
'PROGAER
'PROGREC
'RAPPORTO
'RSPEDITO
]
rd_kvar=[
'f_aerighe->ABBINATO
'iif(DateToChar(f_aerighe->ADATA)='18991230',NullDate(),f_aerighe->ADATA)
'iif(DateToChar(f_aerighe->ADATARET)='18991230',NullDate(),f_aerighe->ADATARET)
'iif(DateToChar(f_aerighe->ADTPRE)='18991230',NullDate(),f_aerighe->ADTPRE)
'f_aerighe->AFILE
'f_aerighe->ANNO
'f_aerighe->AOLDFILE
'f_aerighe->AOLDPROG
'f_aerighe->APROG
'f_aerighe->ASPEDITO
'iif(DateToChar(f_aerighe->CDATA)='18991230',NullDate(),f_aerighe->CDATA)
'iif(DateToChar(f_aerighe->CDATARET)='18991230',NullDate(),f_aerighe->CDATARET)
'iif(DateToChar(f_aerighe->CDTPRE)='18991230',NullDate(),f_aerighe->CDTPRE)
'f_aerighe->CFILE
'f_aerighe->COLDFILE
'f_aerighe->COLDPROG
'Upper(f_aerighe->CONNESINT)
'f_aerighe->CPROG
'_numrig
'f_aerighe->CSPEDITO
'f_aerighe->ESITOANNO
'f_aerighe->FILEANNO
'f_aerighe->IDBASE
'f_aerighe->IDRIF
'_nocodfis
'f_aerighe->PROG1
'f_aerighe->PROG2
'nProgImp2
'f_aerighe->PROGREC
'f_aerighe->RAPPORTO
'f_aerighe->RSPEDITO
]
I
obj='Read
pag=8
prev=O699
rd_field=[
'CFESTERO
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Upper(f_aerighe->CONNESINT)
]
rd_var=[
'_nocodfis
]
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
prev=O688
var_op='asgn
I
obj='Insert
pag=8
prev=O687
rd_kfield=[
'RAPPORTO
'TIPOAG
'COINT
'RIFANA
'PROGAET
'FLGIMP
'DESCRI
'UNIQUECODE
'CAB
'VALUTA
'CODINTER
'OLDINTER
'DATAMODI
'INVIATO
'DATAINVIO
'ANNULLA
'DATAANNU
'OLDUNIQUE
'DATAOLDUNI
'IDESITOFAM
'INVIATOC
'DATAINVIOC
]
rd_kvar=[
'f_aetesta->RAPPORTO
'f_aetesta->TIPOAG
'f_aetesta->COINT
'f_aetesta->RIFANA
'nProgImp
''N'
'f_aetesta->DESCRI
'f_aetesta->UNIQUE
'f_aetesta->CAB
'f_aetesta->VALUTA
'f_aetesta->CODINTER
'f_aetesta->OLDINTER
'f_aetesta->DATAMODI
'f_aetesta->INVIATO
'f_aetesta->DATAINVIO
'f_aetesta->ANNULLA
'f_aetesta->DATAANNU
'f_aetesta->OLDUNIQUE
'f_aetesta->DATAOLDUNI
'f_aetesta->IDESITO
'f_aetesta->INVIATOC
'f_aetesta->DATAINVIOC
]
I
obj='Var
obj_type='N
pag=8
prev=O686
var_op='asgn
I
nonlocal=True
obj='Var
pag=8
prev=O685
var_op='asgn
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
prev=O671
var_op='asgn
I
nonlocal=True
obj='Var
pag=8
prev=O670
var_op='asgn
I
obj='Remark
pag=8
x=13
y=16
I
Icpitembatch.CPRemark
frm_calc='Legge la tabella aederig e aggiunge i record
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Deleghe' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Deleghe' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Deleghe' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file Deleghe'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPRemark
frm_calc='Legge la tabella aeoprig e aggiunge i record
next=Icpitembatch.CPBeginEnd
comment='Operazioni Extraconto AGE
h=[
19
19
]
obj='Begin
pag=9
prev=O727
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O728
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Oper. Extraconto' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='0
len=11
name='_maxfon
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_maxfon <= 20000
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPWhile
frm_calc='_pci <= _cicli
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_pci > _cicli
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Oper. Extraconto' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file Oper. Extraconto'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=9
prev=O745
var_op='asgn
I
nonlocal=True
obj='Var
pag=9
prev=O742
var_op='asgn
I
obj='If
pag=9
prev=O740
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O742
fatherSonIndex=0
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Oper. Extraconto' + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O742
fatherSonIndex=1
frm_calc='gMsgProc + 'Elaborazione terminata con errori. Import abortito' + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='While
pag=9
prev=O737
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O740
fatherSonIndex=0
frm_calc='((_pci -1 ) * 20000) + 1
len=11
name='_bot
next=Icpitembatch.CPVarDecl
frm_calc='_pci * 20000
len=11
name='_top
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_pci + 1
len=11
name='_pci
obj='Var
obj_type='N
pag=9
prev=O758
var_op='asgn
I
obj='Try
pag=9
prev=O757
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O758
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=9
prev=O763
I
obj='Select
pag=9
par_expr=[
'_bot
'_top
]
par_name=[
'_bot
'_top
]
sel_field='*
sel_name='qbe_f_aeoprig
sel_type='sqry
sel_where='recno() >= _bot and recno() <= _top
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O763
fatherSonIndex=0
frm_calc=[
'not(Empty(qbe_f_aeoprig->CONNESINT))
]
h=[
19
19
]
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O770
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Oper. Extraconto'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGAEO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aeoprig
obj='Insert
pag=9
prev=O777
rd_kfield=[
'ADATA
'ADATARET
'ADTPRE
'AFILE
'AOLDFILE
'AOLDPROG
'APROG
'ASPEDITO
'CDATA
'CDATARET
'CDTPRE
'CFILE
'COINT
'COLDFILE
'COLDPROG
'CONNESINT
'CPROG
'CSPEDITO
'IDBASE
'IDRIF
'NOCODFISC
'PROGOPX
'RAPPORTO
'TIPOAG
'RSPEDITO
]
rd_kvar=[
'iif(DateToChar(qbe_f_aeoprig->ADATA)='18991230',NullDate(),qbe_f_aeoprig->ADATA)
'iif(DateToChar(qbe_f_aeoprig->ADATARET)='18991230',NullDate(),qbe_f_aeoprig->ADATARET)
'iif(DateToChar(qbe_f_aeoprig->ADTPRE)='18991230',NullDate(),qbe_f_aeoprig->ADTPRE)
'qbe_f_aeoprig->AFILE
'qbe_f_aeoprig->AOLDFILE
'qbe_f_aeoprig->AOLDPROG
'qbe_f_aeoprig->APROG
'qbe_f_aeoprig->ASPEDITO
'iif(DateToChar(qbe_f_aeoprig->CDATA)='18991230',NullDate(),qbe_f_aeoprig->CDATA)
'iif(DateToChar(qbe_f_aeoprig->CDATARET)='18991230',NullDate(),qbe_f_aeoprig->CDATARET)
'iif(DateToChar(qbe_f_aeoprig->CDTPRE)='18991230',NullDate(),qbe_f_aeoprig->CDTPRE)
'qbe_f_aeoprig->CFILE
'qbe_f_aeoprig->COINT
'qbe_f_aeoprig->COLDFILE
'qbe_f_aeoprig->COLDPROG
'Upper(qbe_f_aeoprig->CONNESINT)
'qbe_f_aeoprig->CPROG
'qbe_f_aeoprig->CSPEDITO
'qbe_f_aeoprig->IDBASE
'qbe_f_aeoprig->IDRIF
'qbe_f_aeoprig->NOCODFISC
'nProgImp
'qbe_f_aeoprig->RAPPORTO
'qbe_f_aeoprig->TIPOAG
'qbe_f_aeoprig->RSPEDITO
]
I
obj='Var
obj_type='N
pag=9
prev=O776
var_op='asgn
I
nonlocal=True
obj='Var
pag=9
prev=O775
var_op='asgn
I
obj='Var
obj_type='N
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O758
fatherSonIndex=1
frm_calc='rollback
next=Icpitembatch.CPDelete
arch='aeoprig
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=9
prev=O785
I
obj='Delete
pag=9
prev=O784
sel_type='all
I
obj='Transaction
pag=9
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=9
prev=O756
I
obj='Var
obj_type='N
pag=9
prev=O755
var_op='asgn
I
obj='Var
obj_type='N
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O735
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O737
fatherSonIndex=0
frm_calc='1
len=11
name='_cicli
obj='Var
obj_type='N
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O737
fatherSonIndex=1
frm_calc='iif(Mod(_maxfon,20000) <> 0,Int(_maxfon/20000) + 1,Int(_maxfon/20000))
len=11
name='_cicli
obj='Var
obj_type='N
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=9
prev=O734
sel_field='reccount() as TOTALE
sel_name='qbe_f_aeoprig_totale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O735
fatherSonIndex=0
frm_calc='qbe_f_aeoprig_totale->TOTALE
len=11
name='_maxfon
obj='Var
obj_type='N
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=9
prev=O733
var_op='asgn
I
obj='Var
obj_type='N
pag=9
prev=O732
var_op='asgn
I
nonlocal=True
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=9
prev=O726
I
nonlocal=True
obj='Var
pag=9
prev=O725
var_op='asgn
I
nonlocal=True
obj='Var
pag=9
prev=O724
var_op='asgn
I
nonlocal=True
obj='Var
pag=9
prev=O722
var_op='asgn
I
obj='Select
pag=9
prev=O720
sel_field='*
sel_name='f_aedecanc
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O722
fatherSonIndex=0
frm_calc=[
'not(Empty(f_aedecanc->CONNESINT))
]
h=[
19
19
]
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O802
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Storico Deleghe'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PDELAGE\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cCanc
next=Icpitembatch.CPInsert
arch='aedecanc
obj='Insert
pag=9
prev=O809
rd_kfield=[
'PROGRES
'IDBASE
'RAPPORTO
'CONNESINT
'ASPEDITO
'ADATA
'APROG
'AOLDPROG
'AFILE
'AOLDFILE
'ADATARET
'CSPEDITO
'CDATA
'CPROG
'COLDPROG
'CFILE
'COLDFILE
'CDATARET
'IDRIF
'RIFRIGA
'TIPOAG
'COINT
'RIFSTOR
'DATARIF
'TIPOCAN
'NOCODFISC
'IDFILE
'IDPROG
'ADTPRE
'CDTPRE
'ABBINATO
'IDESITO
'OLDINTER
]
rd_kvar=[
'cCanc
'f_aedecanc->IDBASE
'f_aedecanc->RAPPORTO
'Upper(f_aedecanc->CONNESINT)
'f_aedecanc->ASPEDITO
'f_aedecanc->ADATA
'f_aedecanc->APROG
'f_aedecanc->AOLDPROG
'f_aedecanc->AFILE
'f_aedecanc->AOLDFILE
'f_aedecanc->ADATARET
'f_aedecanc->CSPEDITO
'f_aedecanc->CDATA
'f_aedecanc->CPROG
'f_aedecanc->COLDPROG
'f_aedecanc->CFILE
'f_aedecanc->COLDFILE
'f_aedecanc->CDATARET
'f_aedecanc->IDRIF
'f_aedecanc->RIFRIGA
'f_aedecanc->TIPOAG
'f_aedecanc->COINT
'f_aedecanc->RIFSTOR
'f_aedecanc->DATARIF
'f_aedecanc->TIPOCAN
'f_aedecanc->NOCODFISC
'f_aedecanc->IDFILE
'f_aedecanc->IDPROG
'f_aedecanc->ADTPRE
'f_aedecanc->CDTPRE
'f_aedecanc->ABBINATO
'f_aedecanc->IDESITO
'f_aedecanc->OLDINTER
]
I
obj='Var
pag=9
prev=O808
var_op='asgn
I
nonlocal=True
obj='Var
pag=9
prev=O807
var_op='asgn
I
obj='Var
obj_type='N
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=9
prev=O718
sel_field='*
sel_name='f_aedestor
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O720
fatherSonIndex=0
frm_calc=[
'not(Empty(f_aedestor->CONNESINT))
]
h=[
19
19
]
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O817
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Storico Deleghe'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PSTOAGE\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProg
next=Icpitembatch.CPInsert
arch='aedestor
obj='Insert
pag=9
prev=O824
rd_kfield=[
'PROGRES
'IDBASE
'RAPPORTO
'CONNESINT
'ASPEDITO
'ADATA
'APROG
'AFILE
'ADATARET
'CSPEDITO
'CDATA
'CPROG
'CFILE
'CDATARET
'IDRIF
'NOCODFISC
'ADTPRE
'CDTPRE
'TIPOAG
'COINT
'ABBINATO
'IDESITO
'DATESITO
]
rd_kvar=[
'cProg
'f_aedestor->IDBASE
'f_aedestor->RAPPORTO
'Upper(f_aedestor->CONNESINT)
'f_aedestor->ASPEDITO
'f_aedestor->ADATA
'f_aedestor->APROG
'f_aedestor->AFILE
'f_aedestor->ADATARET
'f_aedestor->CSPEDITO
'f_aedestor->CDATA
'f_aedestor->CPROG
'f_aedestor->CFILE
'f_aedestor->CDATARET
'f_aedestor->IDRIF
'f_aedestor->NOCODFISC
'f_aedestor->ADTPRE
'f_aedestor->CDTPRE
'f_aedestor->TIPOAG
'f_aedestor->COINT
'f_aedestor->ABBINATO
'f_aedestor->IDESITO
'f_aedestor->IDESITO
]
I
obj='Var
pag=9
prev=O823
var_op='asgn
I
nonlocal=True
obj='Var
pag=9
prev=O822
var_op='asgn
I
obj='Var
obj_type='N
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=9
prev=O717
sel_field='*
sel_name='f_aederig
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O718
fatherSonIndex=0
frm_calc=[
'not(Empty(f_aederig->CONNESINT))
]
h=[
19
19
]
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O832
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Deleghe'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGAED\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aederig
obj='Insert
pag=9
prev=O839
rd_kfield=[
'ADATA
'ADATARET
'ADTPRE
'AFILE
'AOLDFILE
'AOLDPROG
'APROG
'ASPEDITO
'CDATA
'CDATARET
'CDTPRE
'CFILE
'COINT
'COLDFILE
'COLDPROG
'CONNESINT
'CPROG
'CSPEDITO
'IDBASE
'IDRIF
'NOCODFISC
'PROGDLG
'RAPPORTO
'RSPEDITO
'TIPOAG
]
rd_kvar=[
'iif(DateToChar(f_aederig->ADATA)='18991230',NullDate(),f_aederig->ADATA)
'iif(DateToChar(f_aederig->ADATARET)='18991230',NullDate(),f_aederig->ADATARET)
'iif(DateToChar(f_aederig->ADTPRE)='18991230',NullDate(),f_aederig->ADTPRE)
'f_aederig->AFILE
'f_aederig->AOLDFILE
'f_aederig->AOLDPROG
'f_aederig->APROG
'f_aederig->ASPEDITO
'iif(DateToChar(f_aederig->CDATA)='18991230',NullDate(),f_aederig->CDATA)
'iif(DateToChar(f_aederig->CDATARET)='18991230',NullDate(),f_aederig->CDATARET)
'iif(DateToChar(f_aederig->CDTPRE)='18991230',NullDate(),f_aederig->CDTPRE)
'f_aederig->CFILE
'f_aederig->COINT
'f_aederig->COLDFILE
'f_aederig->COLDPROG
'Upper(f_aederig->CONNESINT)
'f_aederig->CPROG
'f_aederig->CSPEDITO
'f_aederig->IDBASE
'f_aederig->IDRIF
'f_aederig->NOCODFISC
'nProgImp
'f_aederig->RAPPORTO
'f_aederig->RSPEDITO
'f_aederig->TIPOAG
]
I
obj='Var
obj_type='N
pag=9
prev=O838
var_op='asgn
I
nonlocal=True
obj='Var
pag=9
prev=O837
var_op='asgn
I
obj='Var
obj_type='N
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=9
prev=O716
var_op='asgn
I
nonlocal=True
obj='Var
pag=9
prev=O715
var_op='asgn
I
obj='Remark
pag=9
x=7
y=18
I
Icpitembatch.CPRemark
frm_calc='Dati Rapporti P
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Rapporti P' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Rapporti P' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Rapporti P' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file Rapporti P'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPRemark
frm_calc='Informazioni Rapporti P
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Informazioni Rapporti P' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Informazioni Rapporti P' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Informazioni Rapporti P' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file Informazioni Rapporti P'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=10
prev=O859
var_op='asgn
I
nonlocal=True
obj='Var
pag=10
prev=O858
var_op='asgn
I
nonlocal=True
obj='Var
pag=10
prev=O856
var_op='asgn
I
obj='Select
pag=10
prev=O855
sel_field='*
sel_name='f_xapopebo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O856
fatherSonIndex=0
frm_calc=[
'not(Empty(f_xapopebo->RAPPORTO))
]
h=[
19
19
]
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O863
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Informazioni Rapporti P'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xapopebo
next=Icpitembatch.CPVarDecl
frm_calc='1
len=3
name='_numrig
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=10
prev=O872
sel_field='*
sel_name='f_xoggetbo
sel_where='f_xoggetbo->IDFILEBO=f_xapopebo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xoginfo
father=O873
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='_numrig + 1
len=3
name='_numrig
obj='Var
obj_type='N
pag=10
prev=O877
var_op='asgn
I
obj='Insert
pag=10
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UNIQUECODE
]
rd_kvar=[
'f_xoggetbo->IDFILEBO
'_numrig
'Upper(f_xoggetbo->CODSOG)
'f_xoggetbo->LEGAME
'f_xoggetbo->IDBASE
'f_xoggetbo->NUMCOL
'f_xoggetbo->TIPOFILE
'f_xoggetbo->RAPCOL
'f_xoggetbo->UCODE
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
prev=O871
var_op='asgn
I
obj='Insert
pag=10
prev=O870
rd_kfield=[
'IDBASE
'NUMPROG
'DATAOPE
'TIPOINTER
'CODINTER
'TIPOINF
'IDEREG
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'OPRAP
'TIPOOPRAP
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'STATOREG
'OPERAZMOD
'CONNESCLI
'CONNESOPER
'CONNESBEN
'COLLEG
'CAMBIO
'RAPPORTBEN
'FLAGRAP2
'OPERATORE
'AUTOM
'RESPINS
'INFORM
'DATAAGE
'UCODE
'PRGIMPINF
'CDATOPE
]
rd_kvar=[
'f_xapopebo->IDBASE
'f_xapopebo->NUMPROG
'iif(DateToChar(f_xapopebo->DATAOPE)='18991230',NullDate(),f_xapopebo->DATAOPE)
'f_xapopebo->TIPOINTER
'f_xapopebo->CODINTER
'f_xapopebo->TIPOINF
'f_xapopebo->IDEREG
'f_xapopebo->CODDIPE
'f_xapopebo->DESCCIT
'f_xapopebo->PROVINCIA
'f_xapopebo->CODCAB
'f_xapopebo->FLAGFRAZ
'f_xapopebo->FLAGCONT
'f_xapopebo->CODANA
'f_xapopebo->CODVOC
'f_xapopebo->TIPOINT2
'f_xapopebo->CODINT2
'f_xapopebo->PAESE
'f_xapopebo->DESC2
'f_xapopebo->PROV2
'f_xapopebo->CODCAB2
'f_xapopebo->DESCINTER
'f_xapopebo->RAPPORTO
'f_xapopebo->FLAGRAP
'f_xapopebo->TIPOLEG
'iif(DateToChar(f_xapopebo->DATAREG)='18991230',NullDate(),f_xapopebo->DATAREG)
'f_xapopebo->OPRAP
'f_xapopebo->TIPOOPRAP
'f_xapopebo->FLAGLIRE
'f_xapopebo->VALUTA
'f_xapopebo->SEGNO
'f_xapopebo->TOTLIRE
'f_xapopebo->TOTCONT
'f_xapopebo->STATOREG
'f_xapopebo->OPERAZMOD
'Upper(f_xapopebo->CONNESCLI)
'Upper(f_xapopebo->CONNESOPER)
'Upper(f_xapopebo->CONNESBEN)
'f_xapopebo->COLLEG
'f_xapopebo->CAMBIO
'f_xapopebo->RAPPORTBEN
'f_xapopebo->FLAGRAP2
'f_xapopebo->OPERATORE
'f_xapopebo->AUTOM
'f_xapopebo->RESPINS
'f_xapopebo->INFORM
'iif(DateToChar(f_xapopebo->DATAAGE)='18991230',NullDate(),f_xapopebo->DATAAGE)
'f_xapopebo->UCODE
'nProgImp
'DateToChar(f_xapopebo->DATAOPE)
]
I
obj='Var
obj_type='N
pag=10
prev=O869
var_op='asgn
I
nonlocal=True
obj='Var
pag=10
prev=O868
var_op='asgn
I
obj='Var
obj_type='N
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
prev=O854
var_op='asgn
I
nonlocal=True
obj='Var
pag=10
prev=O853
var_op='asgn
I
obj='Remark
pag=10
prev=O852
I
nonlocal=True
obj='Var
pag=10
prev=O851
var_op='asgn
I
nonlocal=True
obj='Var
pag=10
prev=O850
var_op='asgn
I
nonlocal=True
obj='Var
pag=10
prev=O848
var_op='asgn
I
obj='Select
pag=10
prev=O847
sel_field='*
sel_name='f_xnarapbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O848
fatherSonIndex=0
frm_calc=[
'not(Empty(f_xnarapbo->RAPPORTO))
]
h=[
19
19
]
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O888
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Rapporti P'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xnarapbo
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='_codrap
next=Icpitembatch.CPRead
arch='knarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_codrap)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='1
len=3
name='_numrig
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=10
prev=O902
sel_field='*
sel_name='f_xntestbo
sel_where='f_xntestbo->RAPPORTO=f_xnarapbo->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O903
fatherSonIndex=0
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Intestatari Rapporti P'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='xntestbo
next=Icpitembatch.CPVarDecl
frm_calc='_numrig + 1
len=3
name='_numrig
obj='Var
obj_type='N
pag=10
prev=O909
var_op='asgn
I
obj='Insert
pag=10
prev=O908
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'DATAFINE
'NUMPROG1
'NUMPROG2
'RAPPORTO
'TIPORAP
'STATOREG
'DESCINTER
'OPERAZMOD
'DATARETT
'IDEREG
'COLLEGAMEN
'UCODE
'PRGIMPSOG
]
rd_kvar=[
'f_xntestbo->IDBASE
'_numrig
'iif(DateToChar(f_xntestbo->DATAINI)='18991230',NullDate(),f_xntestbo->DATAINI)
'f_xntestbo->TIPOPERS
'Upper(f_xntestbo->CODINTER)
'iif(DateToChar(f_xntestbo->DATAFINE)='18991230',NullDate(),f_xntestbo->DATAFINE)
'f_xntestbo->NUMPROG1
'f_xntestbo->NUMPROG2
'f_xntestbo->RAPPORTO
'f_xntestbo->TIPORAP
'f_xntestbo->STATOREG
'f_xntestbo->DESCINTER
'f_xntestbo->OPERAZMOD
'iif(DateToChar(f_xntestbo->DATARETT)='18991230',NullDate(),f_xntestbo->DATARETT)
'f_xntestbo->IDEREG
'f_xntestbo->COLLEGAMEN
'f_xntestbo->UCODE
'nProgImp2
]
I
obj='Var
obj_type='N
pag=10
prev=O907
var_op='asgn
I
nonlocal=True
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
prev=O899
var_op='asgn
I
obj='If
pag=10
prev=O898
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='knarapbo
father=O899
fatherSonIndex=0
obj='Insert
pag=10
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGRAP
]
rd_kvar=[
'f_xnarapbo->RAPPORTO
'f_xnarapbo->DESCRAP
''P'
'f_xnarapbo->TIPORAP
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='knarapbo
father=O899
fatherSonIndex=1
obj='Write
pag=10
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'f_xnarapbo->RAPPORTO
]
wr_field=[
'DESCRAP
'TIPORAP
'FLAGRAP
]
wr_op=[
'=
'=
'=
]
wr_var=[
'f_xnarapbo->DESCRAP
''P'
'f_xnarapbo->TIPORAP
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=10
prev=O897
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'f_xnarapbo->RAPPORTO
]
rd_var=[
'_codrap
]
I
obj='Var
pag=10
prev=O896
var_op='asgn
I
obj='Insert
pag=10
prev=O895
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'CONTINUA
'TIPOAG
'DOCFILE
'NOPROT
'TIPMOD
'DATAMOD
'IDRAPPORTO
'IDBASE
'RAGIO
'MODSVOL
'AREAGEO
'SCOPO
'NATURA
'RTIPO
'RCOMP
'RIMP
'RFREQ
'RRAGIO
'RAREA
'TIPO
'PRGIMPRAP
'AMMONT
'DURAT
]
rd_kvar=[
'f_xnarapbo->RAPPORTO
'f_xnarapbo->DESCRAP
'f_xnarapbo->TIPORAP
'f_xnarapbo->FLAGLIRE
'f_xnarapbo->VALUTA
'f_xnarapbo->CONTINUA
'f_xnarapbo->TIPOAG
'f_xnarapbo->DOCFILE
'f_xnarapbo->NOPROT
'f_xnarapbo->TIPMOD
'iif(DateToChar(f_xnarapbo->DATAMOD)='18991230',NullDate(),f_xnarapbo->DATAMOD)
'f_xnarapbo->IDRAPPORTO
'f_xnarapbo->IDBASE
'f_xnarapbo->RAGIO
'f_xnarapbo->MODSVOL
'f_xnarapbo->AREAGEO
'f_xnarapbo->SCOPO
'f_xnarapbo->NATURA
'f_xnarapbo->RTIPO
'f_xnarapbo->RCOMP
'f_xnarapbo->RIMP
'f_xnarapbo->RFREQ
'f_xnarapbo->RRAGIO
'f_xnarapbo->RAREA
'f_xnarapbo->TIPO
'nProgImp
'f_xnarapbo->AMMONT
'f_xnarapbo->DURAT
]
I
obj='Var
obj_type='N
pag=10
prev=O894
var_op='asgn
I
nonlocal=True
obj='Var
pag=10
prev=O893
var_op='asgn
I
obj='Var
obj_type='N
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
prev=O846
var_op='asgn
I
nonlocal=True
obj='Var
pag=10
prev=O845
var_op='asgn
I
obj='Remark
pag=10
x=12
y=23
I
Icpitembatch.CPRemark
frm_calc='Informazioni Titolarità Provvisorie
next=Icpitembatch.CPVarDecl
len=10
name='check_prog
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Informazioni Titolarità P' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Idbase
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='check_prog
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPIfElse
frm_calc=[
'check_prog>0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPRemark
frm_calc='Progessivo
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='check_prog
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPIfElse
frm_calc=[
'check_prog>0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Informazioni Titolarità P' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file di intestazioni Titolarità P' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Informazioni Titolarità P' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file Informazioni Titolarità P'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=12
prev=O959
var_op='asgn
I
nonlocal=True
obj='Var
pag=12
prev=O958
var_op='asgn
I
nonlocal=True
obj='Var
pag=12
prev=O956
var_op='asgn
I
obj='Select
pag=12
prev=O955
sel_field='*
sel_name='f_xnttitbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O956
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file di intestazione Titolarità P'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTITE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xntestit
obj='Insert
pag=12
prev=O965
rd_kfield=[
'ABBINATO
'CODCLI
'CODINTER
'COLLEGAMEN
'DATAFINE
'DATAINI
'DATARETT
'DESCINTER
'IDBASE
'IDEREG
'NUMPROG1
'NUMPROG2
'OPERAZMOD
'PRGIMPTITE
'RAPPORTO
'STATOREG
'TIPOPERS
'TIPORAP
'UCODE
]
rd_kvar=[
'f_xnttitbo->ABBINATO
'Upper(f_xnttitbo->CONNESCLI)
'Upper(f_xnttitbo->CODINTER)
'f_xnttitbo->COLLEGAMEN
'f_xnttitbo->DATAFINE
'f_xnttitbo->DATAINI
'f_xnttitbo->DATARETT
'f_xnttitbo->DESCINTER
'f_xnttitbo->IDBASE
'f_xnttitbo->IDEREG
'f_xnttitbo->NUMPROG1
'f_xnttitbo->NUMPROG2
'f_xnttitbo->OPERAZMOD
'nProgImp
'f_xnttitbo->RAPPORTO
'f_xnttitbo->STATOREG
'f_xnttitbo->TIPOPERS
'f_xnttitbo->TIPORAP
'f_xnttitbo->UCODE
]
I
obj='Var
obj_type='N
pag=12
prev=O964
var_op='asgn
I
nonlocal=True
obj='Var
pag=12
prev=O963
var_op='asgn
I
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
prev=O954
var_op='asgn
I
nonlocal=True
obj='Var
pag=12
prev=O951
var_op='asgn
I
obj='If
pag=12
prev=O950
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O951
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=12
par_expr=[
''rapotit'
''NUMPROG'
]
par_name=[
'tbname
'fldname
]
sel_name='qbe_tab_mmc
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O972
fatherSonIndex=0
obj='Write
pag=12
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PRGPTIT2\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'qbe_tab_mmc->max
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O951
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=12
par_expr=[
''rapotit'
''NUMPROG'
]
par_name=[
'tbname
'fldname
]
sel_name='qbe_tab_mmc
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O987
fatherSonIndex=0
obj='Insert
pag=12
rd_kfield=[
'tablecode
'autonum
'warncode
]
rd_kvar=[
'"prog\PRGPTIT2\'"+LRTrim(gAzienda)+"'"
'qbe_tab_mmc->max
'LRTrim(gAzienda)
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=12
prev=O949
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PRGPTIT2\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
rd_var=[
'check_prog
]
I
obj='Var
obj_type='N
pag=12
pagelocal=True
prev=O948
var_op='asgn
I
obj='Remark
pag=12
prev=O945
I
obj='If
pag=12
prev=O944
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O945
fatherSonIndex=0
obj='Write
pag=12
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PRGPTIT1\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'_maxfon
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O945
fatherSonIndex=1
obj='Insert
pag=12
rd_kfield=[
'tablecode
'autonum
'warncode
]
rd_kvar=[
'"prog\PRGPTIT1\'"+LRTrim(gAzienda)+"'"
'_maxfon
'LRTrim(gAzienda)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=12
prev=O943
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PRGPTIT1\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
rd_var=[
'check_prog
]
I
obj='Var
obj_type='N
pag=12
pagelocal=True
prev=O942
var_op='asgn
I
obj='Remark
pag=12
prev=O940
I
obj='Select
pag=12
prev=O939
sel_field='*
sel_name='f_xapotit
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O940
fatherSonIndex=0
frm_calc=[
'not(Empty(f_xapotit->CONNESCLI))
]
h=[
19
19
]
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1022
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Informazioni Titolarità P'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTIT\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xapotit
obj='Insert
pag=12
prev=O1029
rd_kfield=[
'AUTOM
'CAMBIO
'CDATOPE
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAAGE
'DATAOPE
'DATAREG
'DESC2
'DESCCIT
'DESCINTER
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'IDEREG
'INFORM
'NUMPROG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PRGIMPTIT
'PROV2
'PROVINCIA
'RAPPORTBEN
'RAPPORTO
'RESPINS
'SEGNO
'STATOREG
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'VALUTA
]
rd_kvar=[
'f_xapotit->AUTOM
'f_xapotit->CAMBIO
'DateToChar(f_xapotit->DATAOPE)
'f_xapotit->CODANA
'f_xapotit->CODCAB
'f_xapotit->CODCAB2
'f_xapotit->CODDIPE
'f_xapotit->CODINT2
'f_xapotit->CODINTER
'f_xapotit->CODVOC
'f_xapotit->COLLEG
'Upper(f_xapotit->CONNESBEN)
'Upper(f_xapotit->CONNESCLI)
'Upper(f_xapotit->CONNESOPER)
'iif(DateToChar(f_xapotit->DATAAGE)='18991230',NullDate(),f_xapotit->DATAAGE)
'iif(DateToChar(f_xapotit->DATAOPE)='18991230',NullDate(),f_xapotit->DATAOPE)
'iif(DateToChar(f_xapotit->DATAREG)='18991230',NullDate(),f_xapotit->DATAREG)
'f_xapotit->DESC2
'f_xapotit->DESCCIT
'f_xapotit->DESCINTER
'f_xapotit->FLAGCONT
'f_xapotit->FLAGFRAZ
'f_xapotit->FLAGLIRE
'f_xapotit->FLAGRAP
'f_xapotit->FLAGRAP2
'f_xapotit->IDBASE
'f_xapotit->IDEREG
'f_xapotit->INFORM
'f_xapotit->NUMPROG
'f_xapotit->OPERATORE
'f_xapotit->OPERAZMOD
'f_xapotit->OPRAP
'f_xapotit->PAESE
'nProgImp
'f_xapotit->PROV2
'f_xapotit->PROVINCIA
'f_xapotit->RAPPORTBEN
'f_xapotit->RAPPORTO
'f_xapotit->RESPINS
'f_xapotit->SEGNO
'f_xapotit->STATOREG
'f_xapotit->TIPOINF
'f_xapotit->TIPOINT2
'f_xapotit->TIPOINTER
'f_xapotit->TIPOLEG
'f_xapotit->TIPOOPRAP
'f_xapotit->TOTCONT
'f_xapotit->TOTLIRE
'f_xapotit->UCODE
'f_xapotit->VALUTA
]
I
obj='Var
obj_type='N
pag=12
prev=O1028
var_op='asgn
I
nonlocal=True
obj='Var
pag=12
prev=O1027
var_op='asgn
I
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
prev=O938
var_op='asgn
I
nonlocal=True
obj='Var
pag=12
prev=O937
var_op='asgn
I
obj='Var
obj_type='N
pag=12
pagelocal=True
prev=O936
I
obj='Remark
pag=12
x=11
y=18
I
Icpitembatch.CPVarDecl
len=6
name='_codip
next=Icpitembatch.CPRemark
frm_calc='Legge la tabella intermediari controparte e aggiunge i record
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Intermediario' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Intermediario' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Intermediari controparte' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file Intermediari controparte'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPRemark
frm_calc='Legge la tabella intermediari controparte e aggiunge i record
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Intermediari controparte' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Intermediari controparte' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Intermediari controparte' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file Intermediari controparte'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPRemark
frm_calc='Legge la tabella dipendenze e aggiunge i record
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Dipendenze' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Dipendenze' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Dipendenze' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file Dipendenze'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=2
prev=O1058
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O1057
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O1055
var_op='asgn
I
obj='Select
pag=2
prev=O1054
sel_field='*
sel_name='f_anadip
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1055
fatherSonIndex=0
frm_calc=[
'not(Empty(f_anadip->CODDIP))
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1062
fatherSonIndex=0
frm_calc='''
len=6
name='_codip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_codip)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Dipendenze'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=2
prev=O1072
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O1069
var_op='asgn
I
obj='If
pag=2
prev=O1068
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anadip
father=O1069
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'ABICABSARA
'AGACCODE
'AGEREGIO
'ANOMOPER
'CAB
'RISGLOB
'CAB2
'CAP
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
'CODAGE
'CODDIP
'CODFISC
'CODLOC
'DESCCIT
'DESCRIZ
'DOMICILIO
'FLGATT
'IDBASE
'MACROAGENTE
'NAZAGENTE
'NUOVO
'OPXSOSAGE
'OPXSOSCLI
'PARTIVA
'PROVINCIA
'TELEFONO
'TERMINALID
'TIPOAGENTE
'TIPOSV
'VALCOMPL
'AGENTE
]
rd_kvar=[
'f_anadip->ABICABSARA
'f_anadip->AGACCODE
'f_anadip->AGEREGIO
'f_anadip->ANOMOPER
'f_anadip->CAB
'f_anadip->CAB2
'f_anadip->CAB2
'f_anadip->CAP
'f_anadip->CATEG01
'f_anadip->CATEG02
'f_anadip->CATEG03
'f_anadip->CATEG04
'f_anadip->CATEG05
'f_anadip->CATEGORIA
'f_anadip->CODAGE
'f_anadip->CODDIP
'f_anadip->CODFISC
'f_anadip->CODLOC
'f_anadip->DESCCIT
'f_anadip->DESCRIZ
'f_anadip->DOMICILIO
'f_anadip->FLGATT
'f_anadip->IDBASE
'f_anadip->MACROAGENT
'f_anadip->NAZAGENTE
'f_anadip->NUOVO
'f_anadip->OPXSOSAGE
'f_anadip->OPXSOSCLI
'f_anadip->PARTIVA
'f_anadip->PROVINCIA
'f_anadip->TELEFONO
'f_anadip->TERMINALID
'f_anadip->TIPOAGE
'f_anadip->TIPOSV
'f_anadip->VALCOMPL
'iif(f_anadip->AGENTE=1,'S','N')
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='anadip
father=O1069
fatherSonIndex=1
obj='Write
pag=2
rd_kfield=[
'CODDIP
]
rd_kop=[
'=
]
rd_kvar=[
'_codip
]
wr_field=[
'ABICABSARA
'AGACCODE
'AGEREGIO
'ANOMOPER
'CAB
'RISGLOB
'CAB2
'CAP
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
'CODAGE
'CODFISC
'CODLOC
'DESCCIT
'DESCRIZ
'DOMICILIO
'FLGATT
'IDBASE
'MACROAGENTE
'NAZAGENTE
'NUOVO
'OPXSOSAGE
'OPXSOSCLI
'PARTIVA
'PROVINCIA
'TELEFONO
'TERMINALID
'TIPOAGENTE
'TIPOSV
'VALCOMPL
'AGENTE
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'f_anadip->ABICABSARA
'f_anadip->AGACCODE
'f_anadip->AGEREGIO
'f_anadip->ANOMOPER
'f_anadip->CAB
'f_anadip->CAB2
'f_anadip->CAB2
'f_anadip->CAP
'f_anadip->CATEG01
'f_anadip->CATEG02
'f_anadip->CATEG03
'f_anadip->CATEG04
'f_anadip->CATEG05
'f_anadip->CATEGORIA
'f_anadip->CODAGE
'f_anadip->CODFISC
'f_anadip->CODLOC
'f_anadip->DESCCIT
'f_anadip->DESCRIZ
'f_anadip->DOMICILIO
'f_anadip->FLGATT
'f_anadip->IDBASE
'f_anadip->MACROAGENT
'f_anadip->NAZAGENTE
'f_anadip->NUOVO
'f_anadip->OPXSOSAGE
'f_anadip->OPXSOSCLI
'f_anadip->PARTIVA
'f_anadip->PROVINCIA
'f_anadip->TELEFONO
'f_anadip->TERMINALID
'f_anadip->TIPOAGE
'f_anadip->TIPOSV
'f_anadip->VALCOMPL
'iif(f_anadip->AGENTE=1,'S','N')
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O1067
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'f_anadip->CODDIP
]
rd_var=[
'_codip
]
I
obj='Var
pag=2
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O1053
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O1052
var_op='asgn
I
obj='Remark
pag=2
prev=O1051
I
nonlocal=True
obj='Var
pag=2
prev=O1050
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O1049
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O1047
var_op='asgn
I
obj='Select
pag=2
prev=O1046
sel_field='*
sel_name='f_inter2bo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1047
fatherSonIndex=0
frm_calc=[
'not(Empty(f_inter2bo->CODINTER))
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1096
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Intermediari controparte'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_codinter
next=Icpitembatch.CPRead
arch='inter2bo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_codinter))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O1104
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='inter2bo
father=O1105
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'CODINTER
'RAGSOC
'CODCAB
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'TIPINTER
'TIPOPERS
'CONNES
'CODDIPE
'PARTIVA
'SESSO
'SOSPMAF
]
rd_kvar=[
'f_inter2bo->CODINTER
'f_inter2bo->RAGSOC
'f_inter2bo->CODCAB
'f_inter2bo->DOMICILIO
'f_inter2bo->CODFISC
'iif(DateToChar(f_inter2bo->DATANASC)='18991230',NullDate(),f_inter2bo->DATANASC)
'f_inter2bo->NASCOMUN
'f_inter2bo->SOTGRUP
'f_inter2bo->RAMOGRUP
'f_inter2bo->SETTSINT
'f_inter2bo->TIPODOC
'f_inter2bo->NUMDOCUM
'iif(DateToChar(f_inter2bo->DATARILASC)='18991230',NullDate(),f_inter2bo->DATARILASC)
'f_inter2bo->AUTRILASC
'f_inter2bo->DESCCIT
'f_inter2bo->PROVINCIA
'f_inter2bo->PAESE
'f_inter2bo->CAP
'f_inter2bo->TIPINTER
'f_inter2bo->TIPOPERS
'f_inter2bo->CONNES
'f_inter2bo->CODDIPE
'f_inter2bo->PARTIVA
'f_inter2bo->SESSO
'f_inter2bo->SOSPMAF
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='inter2bo
father=O1105
fatherSonIndex=1
obj='Write
pag=2
rd_kfield=[
'CODINTER
]
rd_kop=[
'=
]
rd_kvar=[
'f_inter2bo->CODINTER
]
wr_field=[
'RAGSOC
'CODCAB
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CONNES
'CODDIPE
'PARTIVA
'SESSO
'SOSPMAF
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'f_inter2bo->RAGSOC
'f_inter2bo->CODCAB
'f_inter2bo->DOMICILIO
'f_inter2bo->CODFISC
'iif(DateToChar(f_inter2bo->DATANASC)='18991230',NullDate(),f_inter2bo->DATANASC)
'f_inter2bo->NASCOMUN
'f_inter2bo->SOTGRUP
'f_inter2bo->RAMOGRUP
'f_inter2bo->SETTSINT
'f_inter2bo->TIPODOC
'f_inter2bo->NUMDOCUM
'iif(DateToChar(f_inter2bo->DATARILASC)='18991230',NullDate(),f_inter2bo->DATARILASC)
'f_inter2bo->AUTRILASC
'f_inter2bo->DESCCIT
'f_inter2bo->PROVINCIA
'f_inter2bo->PAESE
'f_inter2bo->CAP
'f_inter2bo->CODINTER
'f_inter2bo->TIPINTER
'f_inter2bo->TIPOPERS
'f_inter2bo->CONNES
'f_inter2bo->CODDIPE
'f_inter2bo->PARTIVA
'f_inter2bo->SESSO
'f_inter2bo->SOSPMAF
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O1103
rd_field=[
'CODINTER
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'f_inter2bo->CODINTER
]
rd_var=[
'_codinter
]
I
obj='Var
pag=2
prev=O1102
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O1101
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O1045
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O1044
var_op='asgn
I
obj='Remark
pag=2
prev=O1043
I
nonlocal=True
obj='Var
pag=2
prev=O1042
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O1041
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O1039
var_op='asgn
I
obj='Select
pag=2
prev=O1038
sel_field='*
sel_name='f_intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1039
fatherSonIndex=0
frm_calc=[
'not(Empty(f_intermbo->CODINTER))
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1130
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Intermediario'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_codinter
next=Icpitembatch.CPRead
arch='intermbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_codinter))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O1138
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='intermbo
father=O1139
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'RAGSOC
'CODCAB
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CONNES
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'SUPPLEM
'DBPROT
'CONTATORE
'AEPATH
'MOLTI
'CFINVIO
'CAFINVIO
'FILEINVIO
'DATAINVIO
'FLGWU
'IDSID
]
rd_kvar=[
'f_intermbo->RAGSOC
'f_intermbo->CODCAB
'f_intermbo->DOMICILIO
'f_intermbo->CODFISC
'f_intermbo->DATANASC
'f_intermbo->NASCOMUN
'f_intermbo->SOTGRUP
'f_intermbo->RAMOGRUP
'f_intermbo->SETTSINT
'f_intermbo->TIPODOC
'f_intermbo->NUMDOCUM
'f_intermbo->DATARILASC
'f_intermbo->AUTRILASC
'f_intermbo->DESCCIT
'f_intermbo->PROVINCIA
'f_intermbo->PAESE
'f_intermbo->CAP
'f_intermbo->CODINTER
'f_intermbo->TIPINTER
'f_intermbo->TIPOPERS
'f_intermbo->CONNES
'f_intermbo->CODDIPE
'f_intermbo->PARTIVA
'f_intermbo->NOTE
'f_intermbo->SESSO
'f_intermbo->SOSPMAF
'f_intermbo->SUPPLEM
'f_intermbo->DBPROT
'f_intermbo->CONTATORE
'f_intermbo->AEPATH
'f_intermbo->MOLTI
'f_intermbo->CODINTER2
'f_intermbo->NUMINTER2
'f_intermbo->IMPINTER2
'f_intermbo->DATAINTER2
''N'
'f_intermbo->IDSID
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intermbo
father=O1139
fatherSonIndex=1
obj='Write
pag=2
rd_kfield=[
'CODINTER
]
rd_kop=[
'=
]
rd_kvar=[
'f_intermbo->CODINTER
]
wr_field=[
'AEPATH
'AUTRILASC
'CAP
'CODCAB
'CODDIPE
'CODFISC
'CODINTER
'CODINTER2
'CONNES
'CONTATORE
'DATAINTER2
'DATANASC
'DATARILASC
'DBPROT
'DESCCIT
'DOMICILIO
'F_INGLESE
'F_LOG
'FLGDATAIM
'FLGDATATP
'FLGSIDAUTO
'IDSID
'IMPINTER2
'IMPPATH
'MOLTI
'NASCOMUN
'NOCODFISC
'NODOM
'NOSAB
'NOTE
'NUMDOCUM
'NUMINTER2
'PAESE
'PARTIVA
'PATRONO
'PROVINCIA
'RAGSOC
'RAMOGRUP
'SESSO
'SETTSINT
'SIDPASS
'SOSPMAF
'SOTGRUP
'SUPPLEM
'TIPINTER
'TIPODOC
'TIPOPERS
'TPSOFTAE
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'f_intermbo->AEPATH
'f_intermbo->AUTRILASC
'f_intermbo->CAP
'f_intermbo->CODCAB
'f_intermbo->CODDIPE
'f_intermbo->CODFISC
'f_intermbo->CODINTER
'f_intermbo->CODINTER2
'f_intermbo->CONNES
'f_intermbo->CONTATORE
'f_intermbo->DATAINTER2
'f_intermbo->DATANASC
'f_intermbo->DATARILASC
'f_intermbo->DBPROT
'f_intermbo->DESCCIT
'f_intermbo->DOMICILIO
'f_intermbo->F_INGLESE
'f_intermbo->F_LOG
'f_intermbo->FLGDATAIM
'f_intermbo->FLGDATATP
'f_intermbo->FLGSIDAUTO
'f_intermbo->IDSID
'f_intermbo->IMPINTER2
'f_intermbo->IMPPATH
'f_intermbo->MOLTI
'f_intermbo->NASCOMUN
'f_intermbo->NOCODFISC
'f_intermbo->NODOM
'f_intermbo->NOSAB
'f_intermbo->NOTE
'f_intermbo->NUMDOCUM
'f_intermbo->NUMINTER2
'f_intermbo->PAESE
'f_intermbo->PARTIVA
'f_intermbo->PATRONO
'f_intermbo->PROVINCIA
'f_intermbo->RAGSOC
'f_intermbo->RAMOGRUP
'f_intermbo->SESSO
'f_intermbo->SETTSINT
'f_intermbo->SIDPASS
'f_intermbo->SOSPMAF
'f_intermbo->SOTGRUP
'f_intermbo->SUPPLEM
'f_intermbo->TIPINTER
'f_intermbo->TIPODOC
'f_intermbo->TIPOPERS
'f_intermbo->TPSOFTAE
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O1137
rd_field=[
'CODINTER
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'f_intermbo->CODINTER
]
rd_var=[
'_codinter
]
I
obj='Var
pag=2
prev=O1136
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O1135
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O1037
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O1036
var_op='asgn
I
obj='Remark
pag=2
prev=O1035
I
obj='Var
pag=2
pagelocal=True
x=19
y=10
I
Icpitembatch.CPVarDecl
len=10
name='check_prog
next=Icpitembatch.CPVarDecl
len=1
name='altricli
next=Icpitembatch.CPVarDecl
len=1
name='altriben
next=Icpitembatch.CPVarDecl
len=1
name='altriterz
next=Icpitembatch.CPVarDecl
len=1
name='altrisog
next=Icpitembatch.CPVarDecl
len=1
name='altriagg
next=Icpitembatch.CPVarDecl
len=10
name='_idbase
next=Icpitembatch.CPVarDecl
comment='appoggio per verifica dipendenze
len=6
name='codidpe
next=Icpitembatch.CPVarDecl
len=11
name='_maxprg
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
obj='Try
pag=5
prev=O1171
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Operazioni
father=O1172
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Frazionate
h=[
19
19
]
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=5
prev=O1178
I
obj='Begin
pag=5
prev=O1176
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1178
fatherSonIndex=0
frm_calc='''
len=11
name='_maxfo
next=Icpitembatch.CPVarDecl
frm_calc='0
len=11
name='_maxfon
next=Icpitembatch.CPVarDecl
frm_calc='0
len=11
name='_top
next=Icpitembatch.CPVarDecl
frm_calc='0
len=11
name='_bot
next=Icpitembatch.CPVarDecl
frm_calc='0
len=11
name='_cicli
next=Icpitembatch.CPVarDecl
frm_calc='0
len=11
name='_pci
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='altriagg
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Frazionate' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'_maxfon > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Frazionate' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file Frazionate'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=5
prev=O1199
var_op='asgn
I
nonlocal=True
obj='Var
pag=5
prev=O1196
var_op='asgn
I
obj='If
pag=5
prev=O1195
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1196
fatherSonIndex=0
frm_calc=[
'_maxfon <= 20000
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='1
len=11
name='_pci
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='_pci <= _cicli
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza del contatore dei progressivi e dell'idbase. Per evitare errori in inserimento.
next=Icpitembatch.CPIfElse
frm_calc=[
'_pci > _cicli
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1210
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O1211
fatherSonIndex=0
frm_calc='idbase
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='check_prog
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPIfElse
frm_calc=[
'check_prog>0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPRemark
frm_calc='numprog
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='check_prog
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPIfElse
frm_calc=[
'check_prog>0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Frazionate' + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=5
prev=O1225
var_op='asgn
I
obj='If
pag=5
prev=O1224
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1225
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
par_expr=[
''fraziobo'
''NUMPROG'
]
par_name=[
'tbname
'fldname
]
sel_name='qbe_tab_mmc
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O1231
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PFRAZIO2\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'qbe_tab_mmc->max
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1225
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=5
par_expr=[
''fraziobo'
''NUMPROG'
]
par_name=[
'tbname
'fldname
]
sel_name='qbe_tab_mmc
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O1246
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'tablecode
'autonum
'warncode
]
rd_kvar=[
'"prog\PFRAZIO2\'"+LRTrim(gAzienda)+"'"
'qbe_tab_mmc->max
'LRTrim(gAzienda)
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=5
prev=O1223
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PFRAZIO2\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
rd_var=[
'check_prog
]
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1222
var_op='asgn
I
obj='Remark
pag=5
prev=O1219
I
obj='If
pag=5
prev=O1218
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O1219
fatherSonIndex=0
frm_calc='Se riunisco lo storico con le operazioni sommo i due contatori del numero di operazioni, mentre per il numprog prendo il massimo di operazbo comunque
next=Icpitembatch.CPIfElse
frm_calc=[
'pFlg='N'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1263
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O1264
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PFRAZIO1\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'_maxfon
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O1264
fatherSonIndex=1
obj='Write
pag=5
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PFRAZIO1\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
wr_field=[
'autonum
]
wr_op=[
'+
]
wr_var=[
'_maxfon
]
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=5
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O1219
fatherSonIndex=1
obj='Insert
pag=5
rd_kfield=[
'tablecode
'autonum
'warncode
]
rd_kvar=[
'"prog\PFRAZIO1\'"+LRTrim(gAzienda)+"'"
'_maxfon
'LRTrim(gAzienda)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=5
prev=O1217
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PFRAZIO1\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
rd_var=[
'check_prog
]
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1216
var_op='asgn
I
obj='Remark
pag=5
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O1211
fatherSonIndex=1
frm_calc=''Fine importazione del file Frazionate'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore nell'import delle frazionate
obj='Transaction
pag=5
prev=O1295
raise_on_trans_err=True
I
nonlocal=True
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=5
prev=O1208
I
obj='While
pag=5
prev=O1207
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1208
fatherSonIndex=0
frm_calc='((_pci -1 ) * 20000) + 1
len=11
name='_bot
next=Icpitembatch.CPVarDecl
frm_calc='_pci * 20000
len=11
name='_top
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_pci + 1
len=11
name='_pci
obj='Var
obj_type='N
pag=5
prev=O1302
var_op='asgn
I
obj='Select
pag=5
par_expr=[
'_bot
'_top
]
par_name=[
'_bot
'_top
]
prev=O1301
sel_field='*
sel_name='qbe_f_fraziobo
sel_type='sqry
sel_where='recno() >= _bot and recno() <= _top
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1302
fatherSonIndex=0
frm_calc=[
'not(Empty(qbe_f_fraziobo->CODDIPE))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(qbe_f_fraziobo->IDBASE))
]
h=[
19
19
]
obj='If
pag=5
prev=O1309
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1312
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='_maxprg + 1
len=11
name='_maxprg
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Frazionate'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(DateToChar(qbe_f_fraziobo->DATARETT)='18991230',NullDate(),qbe_f_fraziobo->DATARETT)
len=8
name='_dataret
next=Icpitembatch.CPVarDecl
frm_calc='iif(DateToChar(qbe_f_fraziobo->DATAIMP)='18991230',NullDate(),qbe_f_fraziobo->DATAIMP)
len=8
name='_dataimp
next=Icpitembatch.CPRemark
frm_calc='Verifico se già presente un operazione con lo stesso idbase. Nel caso inserisco il numprog su idbase, per evitare duplicazioni di chiave primaria.
next=Icpitembatch.CPVarDecl
frm_calc='Right('00000000000'+LRTrim(Str(_maxprg,11,0)),11)
len=11
name='_maxfo
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_idbase
next=Icpitembatch.CPRead
arch='fraziobo
next=Icpitembatch.CPInsert
arch='fraziobo
next=Icpitembatch.CPIfElse
frm_calc=[
'altricli=True
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'altriben=True 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'altriterz=True
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'altrisog=True 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'altriagg
]
h=[
19
19
]
obj='If
pag=5
prev=O1337
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1340
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_field='*
sel_name='f_fraziobo_agg
sel_where='f_fraziobo_agg->IDBASE=qbe_f_fraziobo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='fraziobo_agg
father=O1345
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDBASE
'CODLOB
'TIPOGIOCO
'CACODICE
'IDBIGLIETTO
'CADATAORA
'CATIPGIO
'CATIPCON
'CAPV_COD
'IDDOCALL
'VPCODICE
'WUDATRET
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
'FLAGFRAUD
'SV58724
'SV58726SCA
'SV58726SA
'SV58726PISP
'C_COGNOME
'C_NOME
'SOSPAGAM
]
rd_kvar=[
'f_fraziobo_agg->IDBASE
'f_fraziobo_agg->CODLOB
'f_fraziobo_agg->TIPOGIOCO
'f_fraziobo_agg->CACODICE
'f_fraziobo_agg->IDBIGLIETT
'f_fraziobo_agg->CADATAORA
'f_fraziobo_agg->CATIPGIO
'f_fraziobo_agg->CATIPCON
'f_fraziobo_agg->CAPV_COD
'f_fraziobo_agg->IDDOCALL
'f_fraziobo_agg->VPCODICE
'f_fraziobo_agg->WUDATRET
'f_fraziobo_agg->CATEG01
'f_fraziobo_agg->CATEG02
'f_fraziobo_agg->CATEG03
'f_fraziobo_agg->CATEG04
'f_fraziobo_agg->CATEG05
'f_fraziobo_agg->CATEGORIA
'f_fraziobo_agg->FLAGFRAUD
'f_fraziobo_agg->SV58724
'f_fraziobo_agg->SV58726SCA
'f_fraziobo_agg->SV58726SA
'f_fraziobo_agg->SV58726PIS
'f_fraziobo_agg->C_COGNOME
'f_fraziobo_agg->C_NOME
'f_fraziobo_agg->SOSPAGAM
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1334
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1337
fatherSonIndex=0
frm_calc='1
len=3
name='_numrig
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1356
sel_field='*
sel_name='f_soggetbo
sel_where='f_soggetbo->IDFILEBO=qbe_f_fraziobo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sogopefbo
father=O1357
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='_numrig + 1
len=3
name='_numrig
obj='Var
obj_type='N
pag=5
prev=O1361
var_op='asgn
I
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'f_soggetbo->IDFILEBO
'_numrig
'Upper(f_soggetbo->CODSOG)
'f_soggetbo->LEGAME
'f_soggetbo->IDBASE
'f_soggetbo->NUMCOL
'f_soggetbo->TIPOFILE
'f_soggetbo->RAPCOL
'f_soggetbo->UCODE
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1331
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1334
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_field='*
sel_name='f_terzisti
sel_where='f_terzisti->IDFILEBO=qbe_f_fraziobo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistifrz
father=O1369
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'f_terzisti->IDFILEBO
'Upper(f_terzisti->CODSOG)
'f_terzisti->TIPOFILE
'f_terzisti->NUMCOL
'f_terzisti->LEGAME
'f_terzisti->RAPCOL
'f_terzisti->UCODE
'f_terzisti->IDBASE
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1328
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1331
fatherSonIndex=0
frm_calc='1
len=3
name='_numrig
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1380
sel_field='*
sel_name='f_benefic
sel_where='f_benefic->IDFILEBO=qbe_f_fraziobo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficfrz
father=O1381
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='_numrig + 1
len=3
name='_numrig
obj='Var
obj_type='N
pag=5
prev=O1385
var_op='asgn
I
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
rd_kvar=[
'f_benefic->IDFILEBO
'_numrig
'Upper(f_benefic->CODSOG)
'f_benefic->TIPOFILE
'f_benefic->NUMCOL
'f_benefic->LEGAME
'f_benefic->RAPCOL
'f_benefic->UCODE
'f_benefic->IDBASE
'f_benefic->C_RAG
'f_benefic->C_STA
'f_benefic->C_CTA
'f_benefic->C_CAB
'f_benefic->C_PRV
'f_benefic->C_IND
'f_benefic->C_CAP
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1327
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1328
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_field='*
sel_name='f_clienti
sel_where='f_clienti->IDFILEBO=qbe_f_fraziobo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientifrz
father=O1393
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'f_clienti->IDFILEBO
'Upper(f_clienti->CODSOG)
'f_clienti->TIPOFILE
'f_clienti->NUMCOL
'f_clienti->LEGAME
'f_clienti->RAPCOL
'f_clienti->UCODE
'f_clienti->IDBASE
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=5
prev=O1326
rd_kfield=[
'AMMONT
'AREAGEO
'AUTOM
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'IDEREG
'INFORM
'MODSVOL
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PAGASOGOP
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
'ANNOOPE
'IDBASE2
'IMPIN
'IMPOUT
'MITIG
'MITIGDOC
'RISGLOB
'SV58550
'PROQUOTA
'TIPOORO
'DAC6
'FLAGDAC6
'IMPSARA
'SV58550MA
'NOSARA
'MEZPAG
'PRESTAZ
'NUMIMP
]
rd_kvar=[
'qbe_f_fraziobo->AMMONT
'qbe_f_fraziobo->AREAGEO
'qbe_f_fraziobo->AUTOM
'qbe_f_fraziobo->C_CAB
'qbe_f_fraziobo->C_CAP
'qbe_f_fraziobo->C_CTA
'qbe_f_fraziobo->C_IND
'qbe_f_fraziobo->C_PRV
'qbe_f_fraziobo->C_RAG
'qbe_f_fraziobo->C_RAPPORTO
'qbe_f_fraziobo->C_STA
'qbe_f_fraziobo->CAMBIO
'DateToChar(qbe_f_fraziobo->DATAOPE)
'DateToChar(qbe_f_fraziobo->DATAOPE)
'DateToChar(qbe_f_fraziobo->DATAREG)
'qbe_f_fraziobo->CODANA
'qbe_f_fraziobo->CODCAB
'qbe_f_fraziobo->CODCAB2
'qbe_f_fraziobo->CODDIPE
'qbe_f_fraziobo->CODINT2
'qbe_f_fraziobo->CODINTER
'qbe_f_fraziobo->CODVOC
'qbe_f_fraziobo->COLLEG
'Upper(qbe_f_fraziobo->CONNALTRO)
'Upper(qbe_f_fraziobo->CONNESBEN)
'Upper(qbe_f_fraziobo->CONNESCLI)
'Upper(qbe_f_fraziobo->CONNESOPER)
'_dataimp
'qbe_f_fraziobo->DATAOPE
'qbe_f_fraziobo->DATAREG
'_dataret
'qbe_f_fraziobo->DESC2
'qbe_f_fraziobo->DESCCIT
'qbe_f_fraziobo->DESCINTER
'qbe_f_fraziobo->DOCFILE
'qbe_f_fraziobo->DURAT
'qbe_f_fraziobo->FLAGCONT
'qbe_f_fraziobo->FLAGFRAZ
'qbe_f_fraziobo->FLAGLIRE
'qbe_f_fraziobo->FLAGRAP
'qbe_f_fraziobo->FLAGRAP2
'iif(Empty(_idbase),qbe_f_fraziobo->IDBASE,Right(qbe_f_fraziobo->NUMPROG,10))
'qbe_f_fraziobo->IDEREG
'qbe_f_fraziobo->INFORM
'qbe_f_fraziobo->MODSVOL
'qbe_f_fraziobo->NATURA
'qbe_f_fraziobo->NOPROT
'qbe_f_fraziobo->NUMPROG
'qbe_f_fraziobo->OPERAG
'qbe_f_fraziobo->OPERATORE
'qbe_f_fraziobo->OPERAZMOD
'qbe_f_fraziobo->OPRAP
'qbe_f_fraziobo->PAESE
'qbe_f_fraziobo->PAGASOGOP
'nProgImp
'qbe_f_fraziobo->PROV2
'qbe_f_fraziobo->PROVINCIA
'qbe_f_fraziobo->RAGIO
'qbe_f_fraziobo->RAPPORTBEN
'qbe_f_fraziobo->RAPPORTO
'qbe_f_fraziobo->RAREA
'qbe_f_fraziobo->RCOMP
'qbe_f_fraziobo->RESPINS
'qbe_f_fraziobo->RFREQ
'qbe_f_fraziobo->RIFIMP
'qbe_f_fraziobo->RIMP
'qbe_f_fraziobo->RRAGIO
'qbe_f_fraziobo->RTIPO
'qbe_f_fraziobo->SCOPO
'qbe_f_fraziobo->SEGNO
'qbe_f_fraziobo->STATOREG
'qbe_f_fraziobo->TIPO
'qbe_f_fraziobo->TIPOINF
'qbe_f_fraziobo->TIPOINT2
'qbe_f_fraziobo->TIPOINTER
'qbe_f_fraziobo->TIPOLEG
'qbe_f_fraziobo->TIPOOPRAP
'qbe_f_fraziobo->TOTCONT
'qbe_f_fraziobo->TOTLIRE
'qbe_f_fraziobo->UCODE
'qbe_f_fraziobo->UNIQUECODE
'qbe_f_fraziobo->VALUTA
'qbe_f_fraziobo->ZCPARTE
'Year(qbe_f_fraziobo->DATAOPE)
'Right(qbe_f_fraziobo->IDEREG,10)
'qbe_f_fraziobo->IMPIN
'qbe_f_fraziobo->IMPOUT
'qbe_f_fraziobo->MITIG
'qbe_f_fraziobo->MITIGDOC
'qbe_f_fraziobo->RISGLOB
'qbe_f_fraziobo->SV58550
'qbe_f_fraziobo->PROQUOTA
'qbe_f_fraziobo->TIPOORO
'qbe_f_fraziobo->DAC6
'qbe_f_fraziobo->FLAGDAC6
'qbe_f_fraziobo->IMPSARA
'qbe_f_fraziobo->SV58550MA
'iif(qbe_f_fraziobo->NOSARA=1,'S','N')
'qbe_f_fraziobo->MEZPAG
'qbe_f_fraziobo->PRESTAZ
'qbe_f_fraziobo->NUMIMP
]
I
obj='Read
pag=5
prev=O1325
rd_field=[
'IDBASE
]
rd_kfield=[
'IDBASE
]
rd_kvar=[
'qbe_f_fraziobo->IDBASE
]
rd_var=[
'_idbase
]
I
obj='Var
pag=5
pagelocal=True
prev=O1324
var_op='asgn
I
obj='Var
pag=5
prev=O1323
var_op='asgn
I
obj='Remark
pag=5
prev=O1322
I
obj='Var
obj_type='D
pag=5
prev=O1321
var_op='asgn
I
obj='Var
obj_type='D
pag=5
prev=O1320
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1319
var_op='asgn
I
nonlocal=True
obj='Var
pag=5
prev=O1318
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1317
var_op='asgn
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='appoggio per verifica dipendenze
father=O1309
fatherSonIndex=0
frm_calc='''
len=6
name='codidpe
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(codidpe)
]
h=[
19
19
]
obj='If
pag=5
prev=O1412
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anadip
father=O1413
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'CODDIP
'DESCRIZ
]
rd_kvar=[
'qbe_f_fraziobo->CODDIPE
''DIPENDENZA NON INSERITA'
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O1411
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'qbe_f_fraziobo->CODDIPE
]
rd_var=[
'codidpe
]
I
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1300
var_op='asgn
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1206
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1203
var_op='asgn
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1203
fatherSonIndex=0
frm_calc='1
len=11
name='_cicli
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1203
fatherSonIndex=1
frm_calc='iif(Mod(_maxfon,20000) <> 0,Int(_maxfon/20000) + 1,Int(_maxfon/20000))
len=11
name='_cicli
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=5
prev=O1193
var_op='asgn
I
obj='Select
pag=5
prev=O1191
sel_field='reccount() as TOTALE
sel_name='qbe_f_fraziobo_totale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1193
fatherSonIndex=0
frm_calc='qbe_f_fraziobo_totale->TOTALE
len=11
name='_maxfon
next=Icpitembatch.CPVarDecl
frm_calc='Val(qbe_f_fraziobo_totale->MAXPRG)
len=11
name='_maxprg
obj='Var
obj_type='N
pag=5
prev=O1438
var_op='asgn
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1190
sel_field='*
sel_name='f_fraziobo_agg
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1191
fatherSonIndex=0
frm_calc='True
len=1
name='altriagg
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O1443
I
obj='Var
obj_type='L
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='L
pag=5
pagelocal=True
prev=O1189
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1188
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1187
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1186
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1185
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1184
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1183
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1176
fatherSonIndex=0
frm_calc='''
len=11
name='_maxfo
next=Icpitembatch.CPVarDecl
frm_calc='0
len=11
name='_maxfon
next=Icpitembatch.CPVarDecl
frm_calc='0
len=11
name='_top
next=Icpitembatch.CPVarDecl
frm_calc='0
len=11
name='_bot
next=Icpitembatch.CPVarDecl
frm_calc='0
len=11
name='_cicli
next=Icpitembatch.CPVarDecl
frm_calc='0
len=11
name='_pci
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='altricli
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='altriterz
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='altrisog
next=Icpitembatch.CPVarDecl
frm_calc='False 
len=1
name='altriben
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='altriagg
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Operazioni' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'_maxfon > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Operazioni' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file Operazioni'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=5
prev=O1476
var_op='asgn
I
nonlocal=True
obj='Var
pag=5
prev=O1473
var_op='asgn
I
obj='If
pag=5
prev=O1472
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1473
fatherSonIndex=0
frm_calc=[
'_maxfon <= 20000
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='1
len=11
name='_pci
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='_pci <= _cicli
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza del contatore dei progressivi e dell'idbase. Per evitare errori in inserimento.
next=Icpitembatch.CPIfElse
frm_calc=[
'_pci > _cicli
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1487
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O1488
fatherSonIndex=0
frm_calc='idbase
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='check_prog
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPIfElse
frm_calc=[
'check_prog>0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPRemark
frm_calc='progressivo
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='check_prog
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPIfElse
frm_calc=[
'check_prog>0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Operazioni' + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=5
prev=O1502
var_op='asgn
I
obj='If
pag=5
prev=O1501
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1502
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
par_expr=[
''operazbo'
''NUMPROG'
]
par_name=[
'tbname
'fldname
]
sel_name='qbe_tab_mmc
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O1508
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\POPERAZ2\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'qbe_tab_mmc->max
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1502
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=5
par_expr=[
''operazbo'
''NUMPROG'
]
par_name=[
'tbname
'fldname
]
sel_name='qbe_tab_mmc
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O1523
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'tablecode
'autonum
'warncode
]
rd_kvar=[
'"prog\POPERAZ2\'"+LRTrim(gAzienda)+"'"
'qbe_tab_mmc->max
'LRTrim(gAzienda)
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=5
prev=O1500
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\POPERAZ2\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
rd_var=[
'check_prog
]
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1499
var_op='asgn
I
obj='Remark
pag=5
prev=O1496
I
obj='If
pag=5
prev=O1495
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O1496
fatherSonIndex=0
frm_calc='Se riunisco lo storico con le operazioni sommo i due contatori del numero di operazioni, mentre per il numprog prendo il massimo di operazbo comunque
next=Icpitembatch.CPIfElse
frm_calc=[
'pFlg='N'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1540
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O1541
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\POPERAZ1\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'_maxfon
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O1541
fatherSonIndex=1
obj='Write
pag=5
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\POPERAZ1\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
wr_field=[
'autonum
]
wr_op=[
'+
]
wr_var=[
'_maxfon
]
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=5
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O1496
fatherSonIndex=1
obj='Insert
pag=5
rd_kfield=[
'tablecode
'autonum
'warncode
]
rd_kvar=[
'"prog\POPERAZ1\'"+LRTrim(gAzienda)+"'"
'_maxfon
'LRTrim(gAzienda)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=5
prev=O1494
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\POPERAZ1\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
rd_var=[
'check_prog
]
I
obj='Var
obj_type='N
pag=5
pagelocal=True
prev=O1493
var_op='asgn
I
obj='Remark
pag=5
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1488
fatherSonIndex=1
frm_calc='gMsgProc + 'Elaborazione terminata con errori. Import abortito' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore nell'import delle operazioni
obj='Transaction
pag=5
prev=O1572
raise_on_trans_err=True
I
nonlocal=True
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=5
prev=O1485
I
obj='While
pag=5
prev=O1484
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1485
fatherSonIndex=0
frm_calc='((_pci -1 ) * 20000) + 1
len=11
name='_bot
next=Icpitembatch.CPVarDecl
frm_calc='_pci * 20000
len=11
name='_top
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_pci + 1
len=11
name='_pci
obj='Var
obj_type='N
pag=5
prev=O1579
var_op='asgn
I
obj='Select
pag=5
par_expr=[
'_bot
'_top
]
par_name=[
'_bot
'_top
]
prev=O1578
sel_field='*
sel_name='qbe_f_operazbo
sel_type='sqry
sel_where='recno() >= _bot and recno() <= _top
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1579
fatherSonIndex=0
frm_calc=[
'not(Empty(qbe_f_operazbo->CODDIPE))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(qbe_f_operazbo->IDBASE))
]
h=[
19
19
]
obj='If
pag=5
prev=O1586
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1589
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Operazioni'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(DateToChar(qbe_f_operazbo->DATARETT)='18991230',NullDate(),qbe_f_operazbo->DATARETT)
len=8
name='_dataret
next=Icpitembatch.CPVarDecl
frm_calc='iif(DateToChar(qbe_f_operazbo->DATAIMP)='18991230',NullDate(),qbe_f_operazbo->DATAIMP)
len=8
name='_dataimp
next=Icpitembatch.CPRemark
frm_calc='Verifico se già presente un operazione con lo stesso idbase. Nel caso inserisco il numprog su idbase, per evitare duplicazioni di chiave primaria.
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_idbase
next=Icpitembatch.CPRead
arch='operazbo
next=Icpitembatch.CPInsert
arch='operazbo
next=Icpitembatch.CPIfElse
frm_calc=[
'altricli=True 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'altriben=True 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'altriterz=True 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'altrisog=True 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'altriagg
]
h=[
19
19
]
obj='If
pag=5
prev=O1612
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1615
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_field='*
sel_name='f_operazbo_agg
sel_where='f_operazbo_agg->IDBASE=qbe_f_operazbo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='operazbo_agg
father=O1620
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDBASE
'CODLOB
'TIPOGIOCO
'CACODICE
'IDBIGLIETTO
'CADATAORA
'CATIPGIO
'CATIPCON
'CAPV_COD
'IDDOCALL
'VPCODICE
'WUDATRET
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
'FLAGFRAUD
'SV58724
'SV58726SCA
'SV58726SA
'SV58726PISP
'C_COGNOME
'C_NOME
'SOSPAGAM
]
rd_kvar=[
'f_operazbo_agg->IDBASE
'f_operazbo_agg->CODLOB
'f_operazbo_agg->TIPOGIOCO
'f_operazbo_agg->CACODICE
'f_operazbo_agg->IDBIGLIETT
'f_operazbo_agg->CADATAORA
'f_operazbo_agg->CATIPGIO
'f_operazbo_agg->CATIPCON
'f_operazbo_agg->CAPV_COD
'f_operazbo_agg->IDDOCALL
'f_operazbo_agg->VPCODICE
'f_operazbo_agg->WUDATRET
'f_operazbo_agg->CATEG01
'f_operazbo_agg->CATEG02
'f_operazbo_agg->CATEG03
'f_operazbo_agg->CATEG04
'f_operazbo_agg->CATEG05
'f_operazbo_agg->CATEGORIA
'f_operazbo_agg->FLAGFRAUD
'f_operazbo_agg->SV58724
'f_operazbo_agg->SV58726SCA
'f_operazbo_agg->SV58726SA
'f_operazbo_agg->SV58726PIS
'f_operazbo_agg->C_COGNOME
'f_operazbo_agg->C_NOME
'f_operazbo_agg->SOSPAGAM
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1609
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1612
fatherSonIndex=0
frm_calc='1
len=3
name='_numrig
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1631
sel_field='*
sel_name='f_soggetbo
sel_where='f_soggetbo->IDFILEBO=qbe_f_operazbo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sogopebo
father=O1632
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='_numrig + 1
len=3
name='_numrig
obj='Var
obj_type='N
pag=5
prev=O1636
var_op='asgn
I
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'f_soggetbo->IDFILEBO
'_numrig
'Upper(f_soggetbo->CODSOG)
'f_soggetbo->LEGAME
'f_soggetbo->IDBASE
'f_soggetbo->NUMCOL
'f_soggetbo->TIPOFILE
'f_soggetbo->RAPCOL
'f_soggetbo->UCODE
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1606
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1609
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_field='*
sel_name='f_terzisti
sel_where='f_terzisti->IDFILEBO=qbe_f_operazbo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistiope
father=O1644
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'f_terzisti->IDFILEBO
'Upper(f_terzisti->CODSOG)
'f_terzisti->TIPOFILE
'f_terzisti->NUMCOL
'f_terzisti->LEGAME
'f_terzisti->RAPCOL
'f_terzisti->UCODE
'f_terzisti->IDBASE
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1603
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1606
fatherSonIndex=0
frm_calc='1
len=3
name='_numrig
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1655
sel_field='*
sel_name='f_benefic
sel_where='f_benefic->IDFILEBO=qbe_f_operazbo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficope
father=O1656
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='_numrig + 1
len=3
name='_numrig
obj='Var
obj_type='N
pag=5
prev=O1660
var_op='asgn
I
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
rd_kvar=[
'f_benefic->IDFILEBO
'_numrig
'Upper(f_benefic->CODSOG)
'f_benefic->TIPOFILE
'f_benefic->NUMCOL
'f_benefic->LEGAME
'f_benefic->RAPCOL
'f_benefic->UCODE
'f_benefic->IDBASE
'f_benefic->C_RAG
'f_benefic->C_STA
'f_benefic->C_CTA
'f_benefic->C_CAB
'f_benefic->C_PRV
'f_benefic->C_IND
'f_benefic->C_CAP
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1602
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1603
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_field='*
sel_name='f_clienti
sel_where='f_clienti->IDFILEBO=qbe_f_operazbo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O1668
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'f_clienti->IDFILEBO
'Upper(f_clienti->CODSOG)
'f_clienti->TIPOFILE
'f_clienti->NUMCOL
'f_clienti->LEGAME
'f_clienti->RAPCOL
'f_clienti->UCODE
'f_clienti->IDBASE
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=5
prev=O1601
rd_kfield=[
'AMMONT
'AREAGEO
'AUTOM
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'IDEREG
'INFORM
'MODSVOL
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
'ANNOOPE
'IDBASE2
'IMPIN
'IMPOUT
'MITIG
'MITIGDOC
'RISGLOB
'SV58550
'PROQUOTA
'TIPOORO
'DAC6
'FLAGDAC6
'IMPSARA
'SV58550MA
'NOSARA
'MEZPAG
'PRESTAZ
'NUMIMP
]
rd_kvar=[
'qbe_f_operazbo->AMMONT
'qbe_f_operazbo->AREAGEO
'qbe_f_operazbo->AUTOM
'qbe_f_operazbo->C_CAB
'qbe_f_operazbo->C_CAP
'qbe_f_operazbo->C_CTA
'qbe_f_operazbo->C_IND
'qbe_f_operazbo->C_PRV
'qbe_f_operazbo->C_RAG
'qbe_f_operazbo->C_RAPPORTO
'qbe_f_operazbo->C_STA
'qbe_f_operazbo->CAMBIO
'DateToChar(qbe_f_operazbo->DATAOPE)
'DateToChar(qbe_f_operazbo->DATAOPE)
'DateToChar(qbe_f_operazbo->DATAREG)
'qbe_f_operazbo->CODANA
'qbe_f_operazbo->CODCAB
'qbe_f_operazbo->CODCAB2
'qbe_f_operazbo->CODDIPE
'qbe_f_operazbo->CODINT2
'qbe_f_operazbo->CODINTER
'qbe_f_operazbo->CODVOC
'qbe_f_operazbo->COLLEG
'Upper(qbe_f_operazbo->CONNALTRO)
'Upper(qbe_f_operazbo->CONNESBEN)
'Upper(qbe_f_operazbo->CONNESCLI)
'Upper(qbe_f_operazbo->CONNESOPER)
'_dataimp
'qbe_f_operazbo->DATAOPE
'qbe_f_operazbo->DATAREG
'_dataret
'qbe_f_operazbo->DESC2
'qbe_f_operazbo->DESCCIT
'qbe_f_operazbo->DESCINTER
'qbe_f_operazbo->DOCFILE
'qbe_f_operazbo->DURAT
'qbe_f_operazbo->FLAGCONT
'qbe_f_operazbo->FLAGFRAZ
'qbe_f_operazbo->FLAGLIRE
'qbe_f_operazbo->FLAGRAP
'qbe_f_operazbo->FLAGRAP2
'iif(Empty(_idbase),qbe_f_operazbo->IDBASE,Right(qbe_f_operazbo->NUMPROG,10))
'qbe_f_operazbo->IDEREG
'qbe_f_operazbo->INFORM
'qbe_f_operazbo->MODSVOL
'qbe_f_operazbo->NATURA
'qbe_f_operazbo->NOPROT
'qbe_f_operazbo->NUMPROG
'qbe_f_operazbo->OPERAG
'qbe_f_operazbo->OPERATORE
'qbe_f_operazbo->OPERAZMOD
'qbe_f_operazbo->OPRAP
'qbe_f_operazbo->PAESE
'qbe_f_operazbo->PAGASOGOP
'nProgImp
'qbe_f_operazbo->PROV2
'qbe_f_operazbo->PROVINCIA
'qbe_f_operazbo->RAGIO
'qbe_f_operazbo->RAPPORTBEN
'qbe_f_operazbo->RAPPORTO
'qbe_f_operazbo->RAREA
'qbe_f_operazbo->RCOMP
'qbe_f_operazbo->RESPINS
'qbe_f_operazbo->RFREQ
'qbe_f_operazbo->RIFIMP
'qbe_f_operazbo->RIMP
'qbe_f_operazbo->RRAGIO
'qbe_f_operazbo->RTIPO
'qbe_f_operazbo->SCOPO
'qbe_f_operazbo->SEGNO
'qbe_f_operazbo->STATOREG
'qbe_f_operazbo->TIPO
'qbe_f_operazbo->TIPOINF
'qbe_f_operazbo->TIPOINT2
'qbe_f_operazbo->TIPOINTER
'qbe_f_operazbo->TIPOLEG
'qbe_f_operazbo->TIPOOPRAP
'qbe_f_operazbo->TOTCONT
'qbe_f_operazbo->TOTLIRE
'qbe_f_operazbo->UCODE
'qbe_f_operazbo->UNIQUECODE
'qbe_f_operazbo->VALUTA
'qbe_f_operazbo->ZCPARTE
'Year(qbe_f_operazbo->DATAOPE)
'Right(qbe_f_operazbo->IDEREG,10)
'qbe_f_operazbo->IMPIN
'qbe_f_operazbo->IMPOUT
'qbe_f_operazbo->MITIG
'qbe_f_operazbo->MITIGDOC
'qbe_f_operazbo->RISGLOB
'qbe_f_operazbo->SV58550
'qbe_f_operazbo->PROQUOTA
'qbe_f_operazbo->TIPOORO
'qbe_f_operazbo->DAC6
'qbe_f_operazbo->FLAGDAC6
'qbe_f_operazbo->IMPSARA
'qbe_f_operazbo->SV58550MA
'iif(qbe_f_operazbo->NOSARA=1,'S','N')
'qbe_f_operazbo->MEZPAG
'qbe_f_operazbo->PRESTAZ
'qbe_f_operazbo->NUMIMP
]
I
obj='Read
pag=5
prev=O1600
rd_field=[
'IDBASE
]
rd_kfield=[
'IDBASE
]
rd_kvar=[
'qbe_f_operazbo->IDBASE
]
rd_var=[
'_idbase
]
I
obj='Var
pag=5
pagelocal=True
prev=O1599
var_op='asgn
I
obj='Remark
pag=5
prev=O1598
I
obj='Var
obj_type='D
pag=5
prev=O1597
var_op='asgn
I
obj='Var
obj_type='D
pag=5
prev=O1596
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1595
var_op='asgn
I
nonlocal=True
obj='Var
pag=5
prev=O1594
var_op='asgn
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='appoggio per verifica dipendenze
father=O1586
fatherSonIndex=0
frm_calc='''
len=6
name='codidpe
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(codidpe)
]
h=[
19
19
]
obj='If
pag=5
prev=O1687
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anadip
father=O1688
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'CODDIP
'DESCRIZ
]
rd_kvar=[
'qbe_f_operazbo->CODDIPE
''DIPENDENZA NON INSERITA'
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O1686
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'qbe_f_operazbo->CODDIPE
]
rd_var=[
'codidpe
]
I
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1577
var_op='asgn
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1483
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1480
var_op='asgn
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1480
fatherSonIndex=0
frm_calc='1
len=11
name='_cicli
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1480
fatherSonIndex=1
frm_calc='iif(Mod(_maxfon,20000) <> 0,Int(_maxfon/20000) + 1,Int(_maxfon/20000))
len=11
name='_cicli
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=5
prev=O1470
var_op='asgn
I
obj='Select
pag=5
prev=O1468
sel_field='reccount() as TOTALE
sel_name='qbe_f_operazbo_totale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1470
fatherSonIndex=0
frm_calc='qbe_f_operazbo_totale->TOTALE
len=11
name='_maxfon
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1466
sel_field='*
sel_name='f_operazbo_agg
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1468
fatherSonIndex=0
frm_calc='True
len=1
name='altriagg
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O1717
I
obj='Var
obj_type='L
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1464
sel_field='*
sel_name='f_soggetbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1466
fatherSonIndex=0
frm_calc='True
len=1
name='altrisog
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O1722
I
obj='Var
obj_type='L
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1462
sel_field='*
sel_name='f_terzisti
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1464
fatherSonIndex=0
frm_calc='True
len=1
name='altriterz
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O1727
I
obj='Var
obj_type='L
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1460
sel_field='*
sel_name='f_benefic
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1462
fatherSonIndex=0
frm_calc='True
len=1
name='altriben
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O1732
I
obj='Var
obj_type='L
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1459
sel_field='*
sel_name='f_clienti
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1460
fatherSonIndex=0
frm_calc='True
len=1
name='altricli
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O1737
I
obj='Var
obj_type='L
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='L
pag=5
pagelocal=True
prev=O1458
var_op='asgn
I
obj='Var
obj_type='L
pag=5
pagelocal=True
prev=O1457
var_op='asgn
I
obj='Var
obj_type='L
pag=5
pagelocal=True
prev=O1456
var_op='asgn
I
obj='Var
obj_type='L
pag=5
pagelocal=True
prev=O1455
var_op='asgn
I
obj='Var
obj_type='L
pag=5
pagelocal=True
prev=O1454
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1453
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1452
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1451
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1450
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1449
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1172
fatherSonIndex=1
frm_calc='rollback
next=Icpitembatch.CPMessage
frm_calc='m_Sql.TransactionErrorMessage()
msg_type='Debug
obj='Message
pag=5
prev=O1742
I
obj='Transaction
pag=5
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=5
prev=O1170
I
obj='Var
obj_type='N
pag=5
prev=O1169
I
obj='Var
pag=5
pagelocal=True
prev=O1168
I
obj='Var
pag=5
pagelocal=True
prev=O1167
I
obj='Var
obj_type='L
pag=5
pagelocal=True
prev=O1166
I
obj='Var
obj_type='L
pag=5
pagelocal=True
prev=O1165
I
obj='Var
obj_type='L
pag=5
pagelocal=True
prev=O1164
I
obj='Var
obj_type='L
pag=5
pagelocal=True
prev=O1163
I
obj='Var
obj_type='L
pag=5
pagelocal=True
prev=O1162
I
obj='Var
obj_type='N
pag=5
pagelocal=True
x=5
y=6
I
Icpitembatch.CPRemark
frm_calc='Dati Operazioni ExtraConto
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Operazioni ExtraConto' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='0
len=11
name='_maxfon
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_maxfon <= 20000
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='1
len=11
name='_pci
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_pci > _cicli
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Operazioni ExtraConto' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file Operazioni ExtraConto'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=13
prev=O1762
var_op='asgn
I
nonlocal=True
obj='Var
pag=13
prev=O1759
var_op='asgn
I
obj='If
pag=13
prev=O1757
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1759
fatherSonIndex=0
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Operazioni ExtraConto' + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1759
fatherSonIndex=1
frm_calc='gMsgProc + 'Elaborazione terminata con errori. Import abortito' + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Try
pag=13
prev=O1756
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWhile
father=O1757
fatherSonIndex=0
frm_calc='_pci <= _cicli
h=[
19
19
]
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=13
prev=O1772
I
obj='While
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1772
fatherSonIndex=0
frm_calc='((_pci -1 ) * 20000) + 1
len=11
name='_bot
next=Icpitembatch.CPVarDecl
frm_calc='_pci * 20000
len=11
name='_top
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_pci + 1
len=11
name='_pci
obj='Var
obj_type='N
pag=13
prev=O1779
var_op='asgn
I
obj='Select
pag=13
par_expr=[
'_bot
'_top
]
par_name=[
'_bot
'_top
]
prev=O1778
sel_field='*
sel_name='qbe_f_opextrbo
sel_type='sqry
sel_where='recno() >= _bot and recno() <= _top
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1779
fatherSonIndex=0
frm_calc='NullDate()
len=8
name='_dataimp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Operazioni ExtraConto'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPRead
arch='opextrbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_dataimp)
'qbe_f_opextrbo->DATAOPE < _dataimp
]
h=[
19
19
19
]
obj='If
pag=13
prev=O1789
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1790
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PROGOPEX\'"+LRTrim(gAzienda)+"'",0,10)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='opextrbo
obj='Insert
pag=13
prev=O1795
rd_kfield=[
'COLLEG
'ANNO
'IDBASE
'DATAOPE
'COINT
'NOTE
'RIFIMP
'PROGOPEX
'SALDO
'QUANTITA
'VALUTA
'UNIQUER
'CODINTER
'OLDINTER
'DATAMODI
'INVIATO
'DATAINVIO
'ANNULLA
'DATAANNU
'OLDUNIQUE
'DATAOLDUNI
'IDESITO
'CONNESOPER
'RAPPORTO
'INVSALDO
'DTSALDO
'NATURA
]
rd_kvar=[
'Upper(qbe_f_opextrbo->COLLEG)
'qbe_f_opextrbo->ANNO
'qbe_f_opextrbo->IDBASE
'iif(DateToChar(qbe_f_opextrbo->DATAOPE)='18991230',NullDate(),qbe_f_opextrbo->DATAOPE)
'qbe_f_opextrbo->COINT
'qbe_f_opextrbo->NOTE
'qbe_f_opextrbo->RIFIMP
'nProgImp
'qbe_f_opextrbo->SALDO
'qbe_f_opextrbo->QUANTITA
'qbe_f_opextrbo->VALUTA
'qbe_f_opextrbo->UNIQUE
'qbe_f_opextrbo->CODINTER
'qbe_f_opextrbo->OLDINTER
'qbe_f_opextrbo->DATAMODI
'qbe_f_opextrbo->INVIATO
'qbe_f_opextrbo->DATAINVIO
'qbe_f_opextrbo->ANNULLA
'qbe_f_opextrbo->DATAANNU
'qbe_f_opextrbo->OLDUNIQUE
'qbe_f_opextrbo->DATAOLDUNI
'qbe_f_opextrbo->IDESITO
'qbe_f_opextrbo->CONNESOPER
'qbe_f_opextrbo->RAPPORTO
'qbe_f_opextrbo->INVSALDO
'qbe_f_opextrbo->DTSALDO
'qbe_f_opextrbo->NATURA
]
I
obj='Var
obj_type='N
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O1790
fatherSonIndex=1
obj='Write
pag=13
rd_kfield=[
'COLLEG
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Upper(qbe_f_opextrbo->COLLEG)
'qbe_f_opextrbo->ANNO
]
wr_field=[
'IDBASE
'DATAOPE
'COINT
'NOTE
'RIFIMP
'SALDO
'QUANTITA
'VALUTA
'UNIQUER
'CODINTER
'OLDINTER
'DATAMODI
'INVIATO
'DATAINVIO
'ANNULLA
'DATAANNU
'OLDUNIQUE
'DATAOLDUNI
'IDESITO
'CONNESOPER
'RAPPORTO
'INVSALDO
'DTSALDO
'NATURA
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'qbe_f_opextrbo->IDBASE
'iif(DateToChar(qbe_f_opextrbo->DATAOPE)='18991230',NullDate(),qbe_f_opextrbo->DATAOPE)
'qbe_f_opextrbo->COINT
'qbe_f_opextrbo->NOTE
'qbe_f_opextrbo->RIFIMP
'qbe_f_opextrbo->SALDO
'qbe_f_opextrbo->QUANTITA
'qbe_f_opextrbo->VALUTA
'qbe_f_opextrbo->UNIQUE
'qbe_f_opextrbo->CODINTER
'qbe_f_opextrbo->OLDINTER
'qbe_f_opextrbo->DATAMODI
'qbe_f_opextrbo->INVIATO
'qbe_f_opextrbo->DATAINVIO
'qbe_f_opextrbo->ANNULLA
'qbe_f_opextrbo->DATAANNU
'qbe_f_opextrbo->OLDUNIQUE
'qbe_f_opextrbo->DATAOLDUNI
'qbe_f_opextrbo->IDESITO
'qbe_f_opextrbo->CONNESOPER
'qbe_f_opextrbo->RAPPORTO
'qbe_f_opextrbo->INVSALDO
'qbe_f_opextrbo->DTSALDO
'qbe_f_opextrbo->NATURA
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=13
prev=O1788
rd_field=[
'DATAOPE
]
rd_kfield=[
'COLLEG
'ANNO
]
rd_kvar=[
'Upper(qbe_f_opextrbo->COLLEG)
'qbe_f_opextrbo->ANNO
]
rd_var=[
'_dataimp
]
I
nonlocal=True
obj='Var
pag=13
prev=O1787
var_op='asgn
I
obj='Var
obj_type='N
pag=13
prev=O1786
var_op='asgn
I
obj='Var
obj_type='D
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=13
prev=O1777
var_op='asgn
I
obj='Var
obj_type='N
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1757
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=13
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=13
prev=O1755
I
obj='Var
obj_type='N
pag=13
prev=O1754
var_op='asgn
I
obj='Var
obj_type='N
pag=13
prev=O1751
var_op='asgn
I
obj='If
pag=13
prev=O1749
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1751
fatherSonIndex=0
frm_calc='1
len=11
name='_cicli
obj='Var
obj_type='N
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1751
fatherSonIndex=1
frm_calc='iif(Mod(_maxfon,20000) <> 0,Int(_maxfon/20000) + 1,Int(_maxfon/20000))
len=11
name='_cicli
obj='Var
obj_type='N
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=13
prev=O1748
sel_field='reccount() as TOTALE
sel_name='qbe_f_opextrbo_totale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1749
fatherSonIndex=0
frm_calc='qbe_f_opextrbo_totale->TOTALE
len=11
name='_maxfon
obj='Var
obj_type='N
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=13
prev=O1747
var_op='asgn
I
obj='Var
obj_type='N
pag=13
prev=O1746
var_op='asgn
I
nonlocal=True
obj='Var
pag=13
prev=O1745
var_op='asgn
I
obj='Remark
pag=13
x=8
y=18
I
Icpitembatch.CPVarDecl
len=10
name='check_prog
next=Icpitembatch.CPVarDecl
len=1
name='altricli
next=Icpitembatch.CPVarDecl
len=1
name='altriben
next=Icpitembatch.CPVarDecl
len=1
name='altriterz
next=Icpitembatch.CPVarDecl
len=1
name='altrisog
next=Icpitembatch.CPVarDecl
len=10
name='_idbase
next=Icpitembatch.CPVarDecl
comment='appoggio per verifica dipendenze
len=6
name='codidpe
next=Icpitembatch.CPBeginEnd
comment='Operazioni
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Frazionate
h=[
19
19
]
obj='Begin
pag=14
prev=O1834
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1836
fatherSonIndex=0
frm_calc='''
len=11
name='_maxfo
next=Icpitembatch.CPVarDecl
frm_calc='0
len=11
name='_maxfon
next=Icpitembatch.CPVarDecl
frm_calc='0
len=11
name='_top
next=Icpitembatch.CPVarDecl
frm_calc='0
len=11
name='_bot
next=Icpitembatch.CPVarDecl
frm_calc='0
len=11
name='_cicli
next=Icpitembatch.CPVarDecl
frm_calc='0
len=11
name='_pci
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='altricli
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='altriterz
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='altrisog
next=Icpitembatch.CPVarDecl
frm_calc='False 
len=1
name='altriben
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Frazionate (Storico)' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'_maxfon > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Frazionate (Storico)' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file Frazionate (Storico)'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=14
prev=O1857
var_op='asgn
I
nonlocal=True
obj='Var
pag=14
prev=O1854
var_op='asgn
I
obj='If
pag=14
prev=O1853
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1854
fatherSonIndex=0
frm_calc=[
'_maxfon <= 20000
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='1
len=11
name='_pci
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='_pci <= _cicli
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza del contatore dei progressivi e dell'idbase. Per evitare errori in inserimento.
next=Icpitembatch.CPIfElse
frm_calc=[
'_pci > _cicli
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
prev=O1868
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O1869
fatherSonIndex=0
frm_calc='idbase
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='check_prog
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPIfElse
frm_calc=[
'check_prog>0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPRemark
frm_calc='numprog
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='check_prog
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPIfElse
frm_calc=[
'check_prog>0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Frazionate (Storico)' + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=14
prev=O1883
var_op='asgn
I
obj='If
pag=14
prev=O1882
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1883
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=14
par_expr=[
''fraziobo'
''NUMPROG'
]
par_name=[
'tbname
'fldname
]
sel_name='qbe_tab_mmc
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O1889
fatherSonIndex=0
obj='Write
pag=14
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PFRAZIO2\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'qbe_tab_mmc->max
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1883
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=14
par_expr=[
''fraziobo'
''NUMPROG'
]
par_name=[
'tbname
'fldname
]
sel_name='qbe_tab_mmc
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O1904
fatherSonIndex=0
obj='Insert
pag=14
rd_kfield=[
'tablecode
'autonum
'warncode
]
rd_kvar=[
'"prog\PFRAZIO2\'"+LRTrim(gAzienda)+"'"
'qbe_tab_mmc->max
'LRTrim(gAzienda)
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=14
prev=O1881
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PFRAZIO2\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
rd_var=[
'check_prog
]
I
obj='Var
obj_type='N
pag=14
pagelocal=True
prev=O1880
var_op='asgn
I
obj='Remark
pag=14
prev=O1877
I
obj='If
pag=14
prev=O1876
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O1877
fatherSonIndex=0
obj='Write
pag=14
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PFRAZIO1\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'_maxfon
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O1877
fatherSonIndex=1
obj='Insert
pag=14
rd_kfield=[
'tablecode
'autonum
'warncode
]
rd_kvar=[
'"prog\PFRAZIO1\'"+LRTrim(gAzienda)+"'"
'_maxfon
'LRTrim(gAzienda)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=14
prev=O1875
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PFRAZIO1\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
rd_var=[
'check_prog
]
I
obj='Var
obj_type='N
pag=14
pagelocal=True
prev=O1874
var_op='asgn
I
obj='Remark
pag=14
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1869
fatherSonIndex=1
frm_calc='gMsgProc + 'Elaborazione terminata con errori. Import abortito' + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=14
prev=O1866
I
obj='While
pag=14
prev=O1865
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1866
fatherSonIndex=0
frm_calc='((_pci -1 ) * 20000) + 1
len=11
name='_bot
next=Icpitembatch.CPVarDecl
frm_calc='_pci * 20000
len=11
name='_top
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_pci + 1
len=11
name='_pci
obj='Var
obj_type='N
pag=14
prev=O1945
var_op='asgn
I
obj='Try
pag=14
prev=O1944
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1945
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=14
prev=O1950
I
obj='Select
pag=14
par_expr=[
'_bot
'_top
]
par_name=[
'_bot
'_top
]
sel_field='*
sel_name='qbe_f_wraziobo
sel_type='sqry
sel_where='recno() >= _bot and recno() <= _top
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1950
fatherSonIndex=0
frm_calc=[
'not(Empty(qbe_f_wraziobo->CODDIPE))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(qbe_f_wraziobo->IDBASE))
]
h=[
19
19
]
obj='If
pag=14
prev=O1957
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1960
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Frazionate'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(DateToChar(qbe_f_wraziobo->DATARETT)='18991230',NullDate(),qbe_f_wraziobo->DATARETT)
len=8
name='_dataret
next=Icpitembatch.CPVarDecl
frm_calc='iif(DateToChar(qbe_f_wraziobo->DATAIMP)='18991230',NullDate(),qbe_f_wraziobo->DATAIMP)
len=8
name='_dataimp
next=Icpitembatch.CPRemark
frm_calc='Verifico se già presente un operazione con lo stesso idbase. Nel caso inserisco il numprog su idbase, per evitare duplicazioni di chiave primaria.
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_idbase
next=Icpitembatch.CPIfElse
frm_calc=[
'pFlg='N'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'altricli=True
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'altriben=True 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'altriterz=True
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'altrisog=True 
]
h=[
19
19
]
obj='If
pag=14
prev=O1981
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1984
fatherSonIndex=0
frm_calc='1
len=3
name='_numrig
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=14
prev=O1989
sel_field='*
sel_name='f_woggetbo
sel_where='f_woggetbo->IDFILEBO=qbe_f_wraziobo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1990
fatherSonIndex=0
frm_calc=[
'pFlg='N'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_numrig + 1
len=3
name='_numrig
obj='Var
obj_type='N
pag=14
prev=O1994
var_op='asgn
I
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wogopefbo
father=O1994
fatherSonIndex=0
obj='Insert
pag=14
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
]
rd_kvar=[
'f_woggetbo->IDFILEBO
'_numrig
'f_woggetbo->CODSOG
'f_woggetbo->LEGAME
'f_woggetbo->IDBASE
'f_woggetbo->NUMCOL
'f_woggetbo->TIPOFILE
'f_woggetbo->RAPCOL
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sogopefbo
father=O1994
fatherSonIndex=1
obj='Insert
pag=14
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
]
rd_kvar=[
'f_woggetbo->IDFILEBO
'_numrig
'f_woggetbo->CODSOG
'f_woggetbo->LEGAME
'f_woggetbo->IDBASE
'f_woggetbo->NUMCOL
'f_woggetbo->TIPOFILE
'f_woggetbo->RAPCOL
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O1978
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1981
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=14
sel_field='*
sel_name='f_werzisti
sel_where='f_werzisti->IDFILEBO=qbe_f_wraziobo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2012
fatherSonIndex=0
frm_calc=[
'pFlg='N'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='werzistifrz
father=O2016
fatherSonIndex=0
obj='Insert
pag=14
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'f_werzisti->IDFILEBO
'f_werzisti->CODSOG
'f_werzisti->TIPOFILE
'f_werzisti->NUMCOL
'f_werzisti->LEGAME
'f_werzisti->RAPCOL
'f_werzisti->UCODE
'f_werzisti->IDBASE
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistifrz
father=O2016
fatherSonIndex=1
obj='Insert
pag=14
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'f_werzisti->IDFILEBO
'f_werzisti->CODSOG
'f_werzisti->TIPOFILE
'f_werzisti->NUMCOL
'f_werzisti->LEGAME
'f_werzisti->RAPCOL
'f_werzisti->UCODE
'f_werzisti->IDBASE
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O1975
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1978
fatherSonIndex=0
frm_calc='1
len=3
name='_numrig
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=14
prev=O2033
sel_field='*
sel_name='f_wenefic
sel_where='f_wenefic->IDFILEBO=qbe_f_wraziobo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2034
fatherSonIndex=0
frm_calc=[
'pFlg='N'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_numrig + 1
len=3
name='_numrig
obj='Var
obj_type='N
pag=14
prev=O2038
var_op='asgn
I
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='weneficfrz
father=O2038
fatherSonIndex=0
obj='Insert
pag=14
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
rd_kvar=[
'f_wenefic->IDFILEBO
'_numrig
'f_wenefic->CODSOG
'f_wenefic->TIPOFILE
'f_wenefic->NUMCOL
'f_wenefic->LEGAME
'f_wenefic->RAPCOL
'f_wenefic->UCODE
'f_wenefic->IDBASE
'f_wenefic->C_RAG
'f_wenefic->C_STA
'f_wenefic->C_CTA
'f_wenefic->C_CAB
'f_wenefic->C_PRV
'f_wenefic->C_IND
'f_wenefic->C_CAP
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficfrz
father=O2038
fatherSonIndex=1
obj='Insert
pag=14
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
rd_kvar=[
'f_wenefic->IDFILEBO
'_numrig
'f_wenefic->CODSOG
'f_wenefic->TIPOFILE
'f_wenefic->NUMCOL
'f_wenefic->LEGAME
'f_wenefic->RAPCOL
'f_wenefic->UCODE
'f_wenefic->IDBASE
'f_wenefic->C_RAG
'f_wenefic->C_STA
'f_wenefic->C_CTA
'f_wenefic->C_CAB
'f_wenefic->C_PRV
'f_wenefic->C_IND
'f_wenefic->C_CAP
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O1972
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1975
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=14
sel_field='*
sel_name='f_wlienti
sel_where='f_wlienti->IDFILEBO=qbe_f_wraziobo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2056
fatherSonIndex=0
frm_calc=[
'pFlg='N'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wlientifrz
father=O2060
fatherSonIndex=0
obj='Insert
pag=14
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'f_wlienti->IDFILEBO
'f_wlienti->CODSOG
'f_wlienti->TIPOFILE
'f_wlienti->NUMCOL
'f_wlienti->LEGAME
'f_wlienti->RAPCOL
'f_wlienti->UCODE
'f_wlienti->IDBASE
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientifrz
father=O2060
fatherSonIndex=1
obj='Insert
pag=14
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'f_wlienti->IDFILEBO
'f_wlienti->CODSOG
'f_wlienti->TIPOFILE
'f_wlienti->NUMCOL
'f_wlienti->LEGAME
'f_wlienti->RAPCOL
'f_wlienti->UCODE
'f_wlienti->IDBASE
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O1971
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='wraziobo
father=O1972
fatherSonIndex=0
next=Icpitembatch.CPInsert
arch='wraziobo
obj='Insert
pag=14
prev=O2077
rd_kfield=[
'AMMONT
'AREAGEO
'AUTOM
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'IDEREG
'INFORM
'MODSVOL
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PAGASOGOP
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
'ANNOOPE
]
rd_kvar=[
'qbe_f_wraziobo->AMMONT
'qbe_f_wraziobo->AREAGEO
'qbe_f_wraziobo->AUTOM
'qbe_f_wraziobo->C_CAB
'qbe_f_wraziobo->C_CAP
'qbe_f_wraziobo->C_CTA
'qbe_f_wraziobo->C_IND
'qbe_f_wraziobo->C_PRV
'qbe_f_wraziobo->C_RAG
'qbe_f_wraziobo->C_RAPPORTO
'qbe_f_wraziobo->C_STA
'qbe_f_wraziobo->CAMBIO
'DateToChar(qbe_f_wraziobo->DATAOPE)
'DateToChar(qbe_f_wraziobo->DATAOPE)
'DateToChar(qbe_f_wraziobo->DATAREG)
'qbe_f_wraziobo->CODANA
'qbe_f_wraziobo->CODCAB
'qbe_f_wraziobo->CODCAB2
'qbe_f_wraziobo->CODDIPE
'qbe_f_wraziobo->CODINT2
'qbe_f_wraziobo->CODINTER
'qbe_f_wraziobo->CODVOC
'qbe_f_wraziobo->COLLEG
'qbe_f_wraziobo->CONNALTRO
'qbe_f_wraziobo->CONNESBEN
'qbe_f_wraziobo->CONNESCLI
'qbe_f_wraziobo->CONNESOPER
'_dataimp
'qbe_f_wraziobo->DATAOPE
'qbe_f_wraziobo->DATAREG
'_dataret
'qbe_f_wraziobo->DESC2
'qbe_f_wraziobo->DESCCIT
'qbe_f_wraziobo->DESCINTER
'qbe_f_wraziobo->DOCFILE
'qbe_f_wraziobo->DURAT
'qbe_f_wraziobo->FLAGCONT
'qbe_f_wraziobo->FLAGFRAZ
'qbe_f_wraziobo->FLAGLIRE
'qbe_f_wraziobo->FLAGRAP
'qbe_f_wraziobo->FLAGRAP2
'iif(Empty(_idbase),qbe_f_wraziobo->IDBASE,Right(qbe_f_wraziobo->NUMPROG,10))
'qbe_f_wraziobo->IDEREG
'qbe_f_wraziobo->INFORM
'qbe_f_wraziobo->MODSVOL
'qbe_f_wraziobo->NATURA
'qbe_f_wraziobo->NOPROT
'qbe_f_wraziobo->NUMPROG
'qbe_f_wraziobo->OPERAG
'qbe_f_wraziobo->OPERATORE
'qbe_f_wraziobo->OPERAZMOD
'qbe_f_wraziobo->OPRAP
'qbe_f_wraziobo->PAESE
'qbe_f_wraziobo->PAGASOGOP
'nProgImp
'qbe_f_wraziobo->PROV2
'qbe_f_wraziobo->PROVINCIA
'qbe_f_wraziobo->RAGIO
'qbe_f_wraziobo->RAPPORTBEN
'qbe_f_wraziobo->RAPPORTO
'qbe_f_wraziobo->RAREA
'qbe_f_wraziobo->RCOMP
'qbe_f_wraziobo->RESPINS
'qbe_f_wraziobo->RFREQ
'qbe_f_wraziobo->RIFIMP
'qbe_f_wraziobo->RIMP
'qbe_f_wraziobo->RRAGIO
'qbe_f_wraziobo->RTIPO
'qbe_f_wraziobo->SCOPO
'qbe_f_wraziobo->SEGNO
'qbe_f_wraziobo->STATOREG
'qbe_f_wraziobo->TIPO
'qbe_f_wraziobo->TIPOINF
'qbe_f_wraziobo->TIPOINT2
'qbe_f_wraziobo->TIPOINTER
'qbe_f_wraziobo->TIPOLEG
'qbe_f_wraziobo->TIPOOPRAP
'qbe_f_wraziobo->TOTCONT
'qbe_f_wraziobo->TOTLIRE
'qbe_f_wraziobo->UCODE
'qbe_f_wraziobo->UNIQUECODE
'qbe_f_wraziobo->VALUTA
'qbe_f_wraziobo->ZCPARTE
'Year(qbe_f_wraziobo->DATAOPE)
]
I
obj='Read
pag=14
rd_field=[
'IDBASE
]
rd_kfield=[
'IDBASE
]
rd_kvar=[
'qbe_f_wraziobo->IDBASE
]
rd_var=[
'_idbase
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O1972
fatherSonIndex=1
next=Icpitembatch.CPInsert
arch='fraziobo
obj='Insert
pag=14
prev=O2086
rd_kfield=[
'AMMONT
'AREAGEO
'AUTOM
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'IDEREG
'INFORM
'MODSVOL
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PAGASOGOP
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
'ANNOOPE
]
rd_kvar=[
'qbe_f_wraziobo->AMMONT
'qbe_f_wraziobo->AREAGEO
'qbe_f_wraziobo->AUTOM
'qbe_f_wraziobo->C_CAB
'qbe_f_wraziobo->C_CAP
'qbe_f_wraziobo->C_CTA
'qbe_f_wraziobo->C_IND
'qbe_f_wraziobo->C_PRV
'qbe_f_wraziobo->C_RAG
'qbe_f_wraziobo->C_RAPPORTO
'qbe_f_wraziobo->C_STA
'qbe_f_wraziobo->CAMBIO
'DateToChar(qbe_f_wraziobo->DATAOPE)
'DateToChar(qbe_f_wraziobo->DATAOPE)
'DateToChar(qbe_f_wraziobo->DATAREG)
'qbe_f_wraziobo->CODANA
'qbe_f_wraziobo->CODCAB
'qbe_f_wraziobo->CODCAB2
'qbe_f_wraziobo->CODDIPE
'qbe_f_wraziobo->CODINT2
'qbe_f_wraziobo->CODINTER
'qbe_f_wraziobo->CODVOC
'qbe_f_wraziobo->COLLEG
'qbe_f_wraziobo->CONNALTRO
'qbe_f_wraziobo->CONNESBEN
'qbe_f_wraziobo->CONNESCLI
'qbe_f_wraziobo->CONNESOPER
'_dataimp
'qbe_f_wraziobo->DATAOPE
'qbe_f_wraziobo->DATAREG
'_dataret
'qbe_f_wraziobo->DESC2
'qbe_f_wraziobo->DESCCIT
'qbe_f_wraziobo->DESCINTER
'qbe_f_wraziobo->DOCFILE
'qbe_f_wraziobo->DURAT
'qbe_f_wraziobo->FLAGCONT
'qbe_f_wraziobo->FLAGFRAZ
'qbe_f_wraziobo->FLAGLIRE
'qbe_f_wraziobo->FLAGRAP
'qbe_f_wraziobo->FLAGRAP2
'iif(Empty(_idbase),qbe_f_wraziobo->IDBASE,Right(qbe_f_wraziobo->NUMPROG,10))
'qbe_f_wraziobo->IDEREG
'qbe_f_wraziobo->INFORM
'qbe_f_wraziobo->MODSVOL
'qbe_f_wraziobo->NATURA
'qbe_f_wraziobo->NOPROT
'qbe_f_wraziobo->NUMPROG
'qbe_f_wraziobo->OPERAG
'qbe_f_wraziobo->OPERATORE
'qbe_f_wraziobo->OPERAZMOD
'qbe_f_wraziobo->OPRAP
'qbe_f_wraziobo->PAESE
'qbe_f_wraziobo->PAGASOGOP
'nProgImp
'qbe_f_wraziobo->PROV2
'qbe_f_wraziobo->PROVINCIA
'qbe_f_wraziobo->RAGIO
'qbe_f_wraziobo->RAPPORTBEN
'qbe_f_wraziobo->RAPPORTO
'qbe_f_wraziobo->RAREA
'qbe_f_wraziobo->RCOMP
'qbe_f_wraziobo->RESPINS
'qbe_f_wraziobo->RFREQ
'qbe_f_wraziobo->RIFIMP
'qbe_f_wraziobo->RIMP
'qbe_f_wraziobo->RRAGIO
'qbe_f_wraziobo->RTIPO
'qbe_f_wraziobo->SCOPO
'qbe_f_wraziobo->SEGNO
'qbe_f_wraziobo->STATOREG
'qbe_f_wraziobo->TIPO
'qbe_f_wraziobo->TIPOINF
'qbe_f_wraziobo->TIPOINT2
'qbe_f_wraziobo->TIPOINTER
'qbe_f_wraziobo->TIPOLEG
'qbe_f_wraziobo->TIPOOPRAP
'qbe_f_wraziobo->TOTCONT
'qbe_f_wraziobo->TOTLIRE
'qbe_f_wraziobo->UCODE
'qbe_f_wraziobo->UNIQUECODE
'qbe_f_wraziobo->VALUTA
'qbe_f_wraziobo->ZCPARTE
'Year(qbe_f_wraziobo->DATAOPE)
]
I
obj='Read
pag=14
rd_field=[
'IDBASE
]
rd_kfield=[
'IDBASE
]
rd_kvar=[
'qbe_f_wraziobo->IDBASE
]
rd_var=[
'_idbase
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=14
pagelocal=True
prev=O1970
var_op='asgn
I
obj='Remark
pag=14
prev=O1969
I
obj='Var
obj_type='D
pag=14
prev=O1968
var_op='asgn
I
obj='Var
obj_type='D
pag=14
prev=O1967
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O1966
var_op='asgn
I
nonlocal=True
obj='Var
pag=14
prev=O1965
var_op='asgn
I
obj='Var
obj_type='N
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='appoggio per verifica dipendenze
father=O1957
fatherSonIndex=0
frm_calc='''
len=6
name='codidpe
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(codidpe)
]
h=[
19
19
]
obj='If
pag=14
prev=O2099
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anadip
father=O2100
fatherSonIndex=0
obj='Insert
pag=14
rd_kfield=[
'CODDIP
'DESCRIZ
]
rd_kvar=[
'qbe_f_wraziobo->CODDIPE
''DIPENDENZA NON INSERITA'
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=14
prev=O2098
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'qbe_f_wraziobo->CODDIPE
]
rd_var=[
'codidpe
]
I
obj='Var
pag=14
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1945
fatherSonIndex=1
frm_calc='rollback
next=Icpitembatch.CPDelete
arch='wraziobo
obj='Delete
pag=14
prev=O2116
sel_type='all
I
obj='Transaction
pag=14
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=14
prev=O1943
I
obj='Var
obj_type='N
pag=14
prev=O1942
var_op='asgn
I
obj='Var
obj_type='N
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=14
prev=O1864
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O1861
var_op='asgn
I
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1861
fatherSonIndex=0
frm_calc='1
len=11
name='_cicli
obj='Var
obj_type='N
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1861
fatherSonIndex=1
frm_calc='iif(Mod(_maxfon,20000) <> 0,Int(_maxfon/20000) + 1,Int(_maxfon/20000))
len=11
name='_cicli
obj='Var
obj_type='N
pag=14
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=14
prev=O1851
var_op='asgn
I
obj='Select
pag=14
prev=O1850
sel_field='reccount() as TOTALE
sel_name='qbe_f_wraziobo_totale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1851
fatherSonIndex=0
frm_calc='qbe_f_wraziobo_totale->TOTALE
len=11
name='_maxfon
obj='Var
obj_type='N
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='L
pag=14
pagelocal=True
prev=O1849
var_op='asgn
I
obj='Var
obj_type='L
pag=14
pagelocal=True
prev=O1848
var_op='asgn
I
obj='Var
obj_type='L
pag=14
pagelocal=True
prev=O1847
var_op='asgn
I
obj='Var
obj_type='L
pag=14
pagelocal=True
prev=O1846
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O1845
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O1844
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O1843
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O1842
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O1841
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O1840
var_op='asgn
I
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=14
prev=O1833
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1834
fatherSonIndex=0
frm_calc='''
len=11
name='_maxfo
next=Icpitembatch.CPVarDecl
frm_calc='0
len=11
name='_maxfon
next=Icpitembatch.CPVarDecl
frm_calc='0
len=11
name='_top
next=Icpitembatch.CPVarDecl
frm_calc='0
len=11
name='_bot
next=Icpitembatch.CPVarDecl
frm_calc='0
len=11
name='_cicli
next=Icpitembatch.CPVarDecl
frm_calc='0
len=11
name='_pci
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='altricli
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='altriterz
next=Icpitembatch.CPVarDecl
frm_calc='False
len=1
name='altrisog
next=Icpitembatch.CPVarDecl
frm_calc='False 
len=1
name='altriben
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Operazioni (Storico)' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'_maxfon > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Operazioni (Storico)' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file Operazioni (Storico)'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=14
prev=O2158
var_op='asgn
I
nonlocal=True
obj='Var
pag=14
prev=O2155
var_op='asgn
I
obj='If
pag=14
prev=O2154
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2155
fatherSonIndex=0
frm_calc=[
'_maxfon <= 20000
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='1
len=11
name='_pci
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='_pci <= _cicli
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza del contatore dei progressivi e dell'idbase. Per evitare errori in inserimento.
next=Icpitembatch.CPIfElse
frm_calc=[
'_pci > _cicli
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
prev=O2169
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O2170
fatherSonIndex=0
frm_calc='idbase
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='check_prog
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPIfElse
frm_calc=[
'check_prog>0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPRemark
frm_calc='progressivo
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='check_prog
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPIfElse
frm_calc=[
'check_prog>0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Operazioni (Storico)' + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=14
prev=O2184
var_op='asgn
I
obj='If
pag=14
prev=O2183
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2184
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=14
par_expr=[
''operazbo'
''NUMPROG'
]
par_name=[
'tbname
'fldname
]
sel_name='qbe_tab_mmc
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O2190
fatherSonIndex=0
obj='Write
pag=14
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\POPERAZ2\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'qbe_tab_mmc->max
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2184
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=14
par_expr=[
''operazbo'
''NUMPROG'
]
par_name=[
'tbname
'fldname
]
sel_name='qbe_tab_mmc
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O2205
fatherSonIndex=0
obj='Insert
pag=14
rd_kfield=[
'tablecode
'autonum
'warncode
]
rd_kvar=[
'"prog\POPERAZ2\'"+LRTrim(gAzienda)+"'"
'qbe_tab_mmc->max
'LRTrim(gAzienda)
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=14
prev=O2182
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\POPERAZ2\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
rd_var=[
'check_prog
]
I
obj='Var
obj_type='N
pag=14
pagelocal=True
prev=O2181
var_op='asgn
I
obj='Remark
pag=14
prev=O2178
I
obj='If
pag=14
prev=O2177
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O2178
fatherSonIndex=0
obj='Write
pag=14
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\POPERAZ1\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'_maxfon
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O2178
fatherSonIndex=1
obj='Insert
pag=14
rd_kfield=[
'tablecode
'autonum
'warncode
]
rd_kvar=[
'"prog\POPERAZ1\'"+LRTrim(gAzienda)+"'"
'_maxfon
'LRTrim(gAzienda)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=14
prev=O2176
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\POPERAZ1\'"+LRTrim(gAzienda)+"'"
'LRTrim(gAzienda)
]
rd_var=[
'check_prog
]
I
obj='Var
obj_type='N
pag=14
pagelocal=True
prev=O2175
var_op='asgn
I
obj='Remark
pag=14
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2170
fatherSonIndex=1
frm_calc='gMsgProc + 'Elaborazione terminata con errori. Import abortito' + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=14
prev=O2167
I
obj='While
pag=14
prev=O2166
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2167
fatherSonIndex=0
frm_calc='((_pci -1 ) * 20000) + 1
len=11
name='_bot
next=Icpitembatch.CPVarDecl
frm_calc='_pci * 20000
len=11
name='_top
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_pci + 1
len=11
name='_pci
obj='Var
obj_type='N
pag=14
prev=O2246
var_op='asgn
I
obj='Try
pag=14
prev=O2245
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2246
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=14
prev=O2251
I
obj='Select
pag=14
par_expr=[
'_bot
'_top
]
par_name=[
'_bot
'_top
]
sel_field='*
sel_name='qbe_f_wperazbo
sel_type='sqry
sel_where='recno() >= _bot and recno() <= _top
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2251
fatherSonIndex=0
frm_calc=[
'not(Empty(qbe_f_wperazbo->CODDIPE))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(qbe_f_wperazbo->IDBASE))
]
h=[
19
19
]
obj='If
pag=14
prev=O2258
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2261
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Operazioni'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(DateToChar(qbe_f_wperazbo->DATARETT)='18991230',NullDate(),qbe_f_wperazbo->DATARETT)
len=8
name='_dataret
next=Icpitembatch.CPVarDecl
frm_calc='iif(DateToChar(qbe_f_wperazbo->DATAIMP)='18991230',NullDate(),qbe_f_wperazbo->DATAIMP)
len=8
name='_dataimp
next=Icpitembatch.CPRemark
frm_calc='Verifico se già presente un operazione con lo stesso idbase. Nel caso inserisco il numprog su idbase, per evitare duplicazioni di chiave primaria.
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_idbase
next=Icpitembatch.CPIfElse
frm_calc=[
'pFlg='N'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'altricli=True 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'altriben=True 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'altriterz=True 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'altrisog=True 
]
h=[
19
19
]
obj='If
pag=14
prev=O2282
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2285
fatherSonIndex=0
frm_calc='1
len=3
name='_numrig
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=14
prev=O2290
sel_field='*
sel_name='f_woggetbo
sel_where='f_woggetbo->IDFILEBO=qbe_f_wperazbo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2291
fatherSonIndex=0
frm_calc=[
'pFlg='N'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_numrig + 1
len=3
name='_numrig
obj='Var
obj_type='N
pag=14
prev=O2295
var_op='asgn
I
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wogopebo
father=O2295
fatherSonIndex=0
obj='Insert
pag=14
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
]
rd_kvar=[
'f_woggetbo->IDFILEBO
'_numrig
'f_woggetbo->CODSOG
'f_woggetbo->LEGAME
'f_woggetbo->IDBASE
'f_woggetbo->NUMCOL
'f_woggetbo->TIPOFILE
'f_woggetbo->RAPCOL
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sogopebo
father=O2295
fatherSonIndex=1
obj='Insert
pag=14
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
]
rd_kvar=[
'f_woggetbo->IDFILEBO
'_numrig
'f_woggetbo->CODSOG
'f_woggetbo->LEGAME
'f_woggetbo->IDBASE
'f_woggetbo->NUMCOL
'f_woggetbo->TIPOFILE
'f_woggetbo->RAPCOL
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O2279
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2282
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=14
sel_field='*
sel_name='f_werzisti
sel_where='f_werzisti->IDFILEBO=qbe_f_wperazbo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2313
fatherSonIndex=0
frm_calc=[
'pFlg='N'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='werzistiope
father=O2317
fatherSonIndex=0
obj='Insert
pag=14
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'f_werzisti->IDFILEBO
'f_werzisti->CODSOG
'f_werzisti->TIPOFILE
'f_werzisti->NUMCOL
'f_werzisti->LEGAME
'f_werzisti->RAPCOL
'f_werzisti->UCODE
'f_werzisti->IDBASE
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistiope
father=O2317
fatherSonIndex=1
obj='Insert
pag=14
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'f_werzisti->IDFILEBO
'f_werzisti->CODSOG
'f_werzisti->TIPOFILE
'f_werzisti->NUMCOL
'f_werzisti->LEGAME
'f_werzisti->RAPCOL
'f_werzisti->UCODE
'f_werzisti->IDBASE
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O2276
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2279
fatherSonIndex=0
frm_calc='1
len=3
name='_numrig
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=14
prev=O2334
sel_field='*
sel_name='f_wenefic
sel_where='f_wenefic->IDFILEBO=qbe_f_wperazbo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2335
fatherSonIndex=0
frm_calc=[
'pFlg='N'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_numrig + 1
len=3
name='_numrig
obj='Var
obj_type='N
pag=14
prev=O2339
var_op='asgn
I
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='weneficope
father=O2339
fatherSonIndex=0
obj='Insert
pag=14
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
rd_kvar=[
'f_wenefic->IDFILEBO
'_numrig
'f_wenefic->CODSOG
'f_wenefic->TIPOFILE
'f_wenefic->NUMCOL
'f_wenefic->LEGAME
'f_wenefic->RAPCOL
'f_wenefic->UCODE
'f_wenefic->IDBASE
'f_wenefic->C_RAG
'f_wenefic->C_STA
'f_wenefic->C_CTA
'f_wenefic->C_CAB
'f_wenefic->C_PRV
'f_wenefic->C_IND
'f_wenefic->C_CAP
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficope
father=O2339
fatherSonIndex=1
obj='Insert
pag=14
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
rd_kvar=[
'f_wenefic->IDFILEBO
'_numrig
'f_wenefic->CODSOG
'f_wenefic->TIPOFILE
'f_wenefic->NUMCOL
'f_wenefic->LEGAME
'f_wenefic->RAPCOL
'f_wenefic->UCODE
'f_wenefic->IDBASE
'f_wenefic->C_RAG
'f_wenefic->C_STA
'f_wenefic->C_CTA
'f_wenefic->C_CAB
'f_wenefic->C_PRV
'f_wenefic->C_IND
'f_wenefic->C_CAP
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O2273
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2276
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=14
sel_field='*
sel_name='f_wlienti
sel_where='f_wlienti->IDFILEBO=qbe_f_wperazbo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2357
fatherSonIndex=0
frm_calc=[
'pFlg='N'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wlientiope
father=O2361
fatherSonIndex=0
obj='Insert
pag=14
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'f_wlienti->IDFILEBO
'f_wlienti->CODSOG
'f_wlienti->TIPOFILE
'f_wlienti->NUMCOL
'f_wlienti->LEGAME
'f_wlienti->RAPCOL
'f_wlienti->UCODE
'f_wlienti->IDBASE
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O2361
fatherSonIndex=1
obj='Insert
pag=14
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'f_wlienti->IDFILEBO
'f_wlienti->CODSOG
'f_wlienti->TIPOFILE
'f_wlienti->NUMCOL
'f_wlienti->LEGAME
'f_wlienti->RAPCOL
'f_wlienti->UCODE
'f_wlienti->IDBASE
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O2272
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='wperazbo
father=O2273
fatherSonIndex=0
next=Icpitembatch.CPInsert
arch='wperazbo
obj='Insert
pag=14
prev=O2378
rd_kfield=[
'AMMONT
'AREAGEO
'AUTOM
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'IDEREG
'INFORM
'MODSVOL
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
]
rd_kvar=[
'qbe_f_wperazbo->AMMONT
'qbe_f_wperazbo->AREAGEO
'qbe_f_wperazbo->AUTOM
'qbe_f_wperazbo->C_CAB
'qbe_f_wperazbo->C_CAP
'qbe_f_wperazbo->C_CTA
'qbe_f_wperazbo->C_IND
'qbe_f_wperazbo->C_PRV
'qbe_f_wperazbo->C_RAG
'qbe_f_wperazbo->C_RAPPORTO
'qbe_f_wperazbo->C_STA
'qbe_f_wperazbo->CAMBIO
'DateToChar(qbe_f_wperazbo->DATAOPE)
'DateToChar(qbe_f_wperazbo->DATAOPE)
'DateToChar(qbe_f_wperazbo->DATAREG)
'qbe_f_wperazbo->CODANA
'qbe_f_wperazbo->CODCAB
'qbe_f_wperazbo->CODCAB2
'qbe_f_wperazbo->CODDIPE
'qbe_f_wperazbo->CODINT2
'qbe_f_wperazbo->CODINTER
'qbe_f_wperazbo->CODVOC
'qbe_f_wperazbo->COLLEG
'qbe_f_wperazbo->CONNALTRO
'qbe_f_wperazbo->CONNESBEN
'qbe_f_wperazbo->CONNESCLI
'qbe_f_wperazbo->CONNESOPER
'_dataimp
'qbe_f_wperazbo->DATAOPE
'qbe_f_wperazbo->DATAREG
'_dataret
'qbe_f_wperazbo->DESC2
'qbe_f_wperazbo->DESCCIT
'qbe_f_wperazbo->DESCINTER
'qbe_f_wperazbo->DOCFILE
'qbe_f_wperazbo->DURAT
'qbe_f_wperazbo->FLAGCONT
'qbe_f_wperazbo->FLAGFRAZ
'qbe_f_wperazbo->FLAGLIRE
'qbe_f_wperazbo->FLAGRAP
'qbe_f_wperazbo->FLAGRAP2
'iif(Empty(_idbase),qbe_f_wperazbo->IDBASE,Right(qbe_f_wperazbo->NUMPROG,10))
'qbe_f_wperazbo->IDEREG
'qbe_f_wperazbo->INFORM
'qbe_f_wperazbo->MODSVOL
'qbe_f_wperazbo->NATURA
'qbe_f_wperazbo->NOPROT
'qbe_f_wperazbo->NUMPROG
'qbe_f_wperazbo->OPERAG
'qbe_f_wperazbo->OPERATORE
'qbe_f_wperazbo->OPERAZMOD
'qbe_f_wperazbo->OPRAP
'qbe_f_wperazbo->PAESE
'qbe_f_wperazbo->PAGASOGOP
'nProgImp
'qbe_f_wperazbo->PROV2
'qbe_f_wperazbo->PROVINCIA
'qbe_f_wperazbo->RAGIO
'qbe_f_wperazbo->RAPPORTBEN
'qbe_f_wperazbo->RAPPORTO
'qbe_f_wperazbo->RAREA
'qbe_f_wperazbo->RCOMP
'qbe_f_wperazbo->RESPINS
'qbe_f_wperazbo->RFREQ
'qbe_f_wperazbo->RIFIMP
'qbe_f_wperazbo->RIMP
'qbe_f_wperazbo->RRAGIO
'qbe_f_wperazbo->RTIPO
'qbe_f_wperazbo->SCOPO
'qbe_f_wperazbo->SEGNO
'qbe_f_wperazbo->STATOREG
'qbe_f_wperazbo->TIPO
'qbe_f_wperazbo->TIPOINF
'qbe_f_wperazbo->TIPOINT2
'qbe_f_wperazbo->TIPOINTER
'qbe_f_wperazbo->TIPOLEG
'qbe_f_wperazbo->TIPOOPRAP
'qbe_f_wperazbo->TOTCONT
'qbe_f_wperazbo->TOTLIRE
'qbe_f_wperazbo->UCODE
'qbe_f_wperazbo->UNIQUECODE
'qbe_f_wperazbo->VALUTA
'qbe_f_wperazbo->ZCPARTE
]
I
obj='Read
pag=14
rd_field=[
'IDBASE
]
rd_kfield=[
'IDBASE
]
rd_kvar=[
'qbe_f_wperazbo->IDBASE
]
rd_var=[
'_idbase
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O2273
fatherSonIndex=1
next=Icpitembatch.CPInsert
arch='operazbo
obj='Insert
pag=14
prev=O2387
rd_kfield=[
'AMMONT
'AREAGEO
'AUTOM
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'IDEREG
'INFORM
'MODSVOL
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
]
rd_kvar=[
'qbe_f_wperazbo->AMMONT
'qbe_f_wperazbo->AREAGEO
'qbe_f_wperazbo->AUTOM
'qbe_f_wperazbo->C_CAB
'qbe_f_wperazbo->C_CAP
'qbe_f_wperazbo->C_CTA
'qbe_f_wperazbo->C_IND
'qbe_f_wperazbo->C_PRV
'qbe_f_wperazbo->C_RAG
'qbe_f_wperazbo->C_RAPPORTO
'qbe_f_wperazbo->C_STA
'qbe_f_wperazbo->CAMBIO
'DateToChar(qbe_f_wperazbo->DATAOPE)
'DateToChar(qbe_f_wperazbo->DATAOPE)
'DateToChar(qbe_f_wperazbo->DATAREG)
'qbe_f_wperazbo->CODANA
'qbe_f_wperazbo->CODCAB
'qbe_f_wperazbo->CODCAB2
'qbe_f_wperazbo->CODDIPE
'qbe_f_wperazbo->CODINT2
'qbe_f_wperazbo->CODINTER
'qbe_f_wperazbo->CODVOC
'qbe_f_wperazbo->COLLEG
'qbe_f_wperazbo->CONNALTRO
'qbe_f_wperazbo->CONNESBEN
'qbe_f_wperazbo->CONNESCLI
'qbe_f_wperazbo->CONNESOPER
'_dataimp
'qbe_f_wperazbo->DATAOPE
'qbe_f_wperazbo->DATAREG
'_dataret
'qbe_f_wperazbo->DESC2
'qbe_f_wperazbo->DESCCIT
'qbe_f_wperazbo->DESCINTER
'qbe_f_wperazbo->DOCFILE
'qbe_f_wperazbo->DURAT
'qbe_f_wperazbo->FLAGCONT
'qbe_f_wperazbo->FLAGFRAZ
'qbe_f_wperazbo->FLAGLIRE
'qbe_f_wperazbo->FLAGRAP
'qbe_f_wperazbo->FLAGRAP2
'iif(Empty(_idbase),qbe_f_wperazbo->IDBASE,Right(qbe_f_wperazbo->NUMPROG,10))
'qbe_f_wperazbo->IDEREG
'qbe_f_wperazbo->INFORM
'qbe_f_wperazbo->MODSVOL
'qbe_f_wperazbo->NATURA
'qbe_f_wperazbo->NOPROT
'qbe_f_wperazbo->NUMPROG
'qbe_f_wperazbo->OPERAG
'qbe_f_wperazbo->OPERATORE
'qbe_f_wperazbo->OPERAZMOD
'qbe_f_wperazbo->OPRAP
'qbe_f_wperazbo->PAESE
'qbe_f_wperazbo->PAGASOGOP
'nProgImp
'qbe_f_wperazbo->PROV2
'qbe_f_wperazbo->PROVINCIA
'qbe_f_wperazbo->RAGIO
'qbe_f_wperazbo->RAPPORTBEN
'qbe_f_wperazbo->RAPPORTO
'qbe_f_wperazbo->RAREA
'qbe_f_wperazbo->RCOMP
'qbe_f_wperazbo->RESPINS
'qbe_f_wperazbo->RFREQ
'qbe_f_wperazbo->RIFIMP
'qbe_f_wperazbo->RIMP
'qbe_f_wperazbo->RRAGIO
'qbe_f_wperazbo->RTIPO
'qbe_f_wperazbo->SCOPO
'qbe_f_wperazbo->SEGNO
'qbe_f_wperazbo->STATOREG
'qbe_f_wperazbo->TIPO
'qbe_f_wperazbo->TIPOINF
'qbe_f_wperazbo->TIPOINT2
'qbe_f_wperazbo->TIPOINTER
'qbe_f_wperazbo->TIPOLEG
'qbe_f_wperazbo->TIPOOPRAP
'qbe_f_wperazbo->TOTCONT
'qbe_f_wperazbo->TOTLIRE
'qbe_f_wperazbo->UCODE
'qbe_f_wperazbo->UNIQUECODE
'qbe_f_wperazbo->VALUTA
'qbe_f_wperazbo->ZCPARTE
]
I
obj='Read
pag=14
rd_field=[
'IDBASE
]
rd_kfield=[
'IDBASE
]
rd_kvar=[
'qbe_f_wperazbo->IDBASE
]
rd_var=[
'_idbase
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=14
pagelocal=True
prev=O2271
var_op='asgn
I
obj='Remark
pag=14
prev=O2270
I
obj='Var
obj_type='D
pag=14
prev=O2269
var_op='asgn
I
obj='Var
obj_type='D
pag=14
prev=O2268
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O2267
var_op='asgn
I
nonlocal=True
obj='Var
pag=14
prev=O2266
var_op='asgn
I
obj='Var
obj_type='N
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='appoggio per verifica dipendenze
father=O2258
fatherSonIndex=0
frm_calc='''
len=6
name='codidpe
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(codidpe)
]
h=[
19
19
]
obj='If
pag=14
prev=O2400
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anadip
father=O2401
fatherSonIndex=0
obj='Insert
pag=14
rd_kfield=[
'CODDIP
'DESCRIZ
]
rd_kvar=[
'qbe_f_wperazbo->CODDIPE
''DIPENDENZA NON INSERITA'
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=14
prev=O2399
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'qbe_f_wperazbo->CODDIPE
]
rd_var=[
'codidpe
]
I
obj='Var
pag=14
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O2246
fatherSonIndex=1
frm_calc='rollback
next=Icpitembatch.CPDelete
arch='wperazbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=14
prev=O2418
I
obj='Delete
pag=14
prev=O2417
sel_type='all
I
obj='Transaction
pag=14
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=14
prev=O2244
I
obj='Var
obj_type='N
pag=14
prev=O2243
var_op='asgn
I
obj='Var
obj_type='N
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=14
prev=O2165
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O2162
var_op='asgn
I
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2162
fatherSonIndex=0
frm_calc='1
len=11
name='_cicli
obj='Var
obj_type='N
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2162
fatherSonIndex=1
frm_calc='iif(Mod(_maxfon,20000) <> 0,Int(_maxfon/20000) + 1,Int(_maxfon/20000))
len=11
name='_cicli
obj='Var
obj_type='N
pag=14
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=14
prev=O2152
var_op='asgn
I
obj='Select
pag=14
prev=O2150
sel_field='reccount() as TOTALE
sel_name='qbe_f_wperazbo_totale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2152
fatherSonIndex=0
frm_calc='qbe_f_wperazbo_totale->TOTALE
len=11
name='_maxfon
obj='Var
obj_type='N
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=14
prev=O2148
sel_field='*
sel_name='f_woggetbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2150
fatherSonIndex=0
frm_calc='True
len=1
name='altrisog
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=14
prev=O2435
I
obj='Var
obj_type='L
pag=14
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=14
prev=O2146
sel_field='*
sel_name='f_werzisti
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2148
fatherSonIndex=0
frm_calc='True
len=1
name='altriterz
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=14
prev=O2440
I
obj='Var
obj_type='L
pag=14
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=14
prev=O2144
sel_field='*
sel_name='f_wenefic
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2146
fatherSonIndex=0
frm_calc='True
len=1
name='altriben
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=14
prev=O2445
I
obj='Var
obj_type='L
pag=14
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=14
prev=O2143
sel_field='*
sel_name='f_wlienti
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2144
fatherSonIndex=0
frm_calc='True
len=1
name='altricli
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=14
prev=O2450
I
obj='Var
obj_type='L
pag=14
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='L
pag=14
pagelocal=True
prev=O2142
var_op='asgn
I
obj='Var
obj_type='L
pag=14
pagelocal=True
prev=O2141
var_op='asgn
I
obj='Var
obj_type='L
pag=14
pagelocal=True
prev=O2140
var_op='asgn
I
obj='Var
obj_type='L
pag=14
pagelocal=True
prev=O2139
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O2138
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O2137
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O2136
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O2135
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O2134
var_op='asgn
I
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=14
pagelocal=True
prev=O1832
I
obj='Var
pag=14
pagelocal=True
prev=O1831
I
obj='Var
obj_type='L
pag=14
pagelocal=True
prev=O1830
I
obj='Var
obj_type='L
pag=14
pagelocal=True
prev=O1829
I
obj='Var
obj_type='L
pag=14
pagelocal=True
prev=O1828
I
obj='Var
obj_type='L
pag=14
pagelocal=True
prev=O1827
I
obj='Var
obj_type='N
pag=14
pagelocal=True
x=14
y=18
I
Icpitembatch.CPBeginEnd
comment='Variabili di pagina
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Saldi Agenzia Entrate
h=[
19
19
]
obj='Begin
pag=15
prev=O2454
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2456
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Saldi AGE' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file AEANNORA' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file AESALDI' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file AEINVIO' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Saldi AGE' +NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=15
prev=O2472
var_op='asgn
I
nonlocal=True
obj='Var
pag=15
prev=O2470
var_op='asgn
I
obj='Select
pag=15
prev=O2469
sel_field='*
sel_name='f_aeinvio
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2470
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Inserisco Dati File Invio: '+f_aeinvio->FILEANNO
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPInsert
arch='aeinvio
obj='Insert
pag=15
prev=O2477
rd_kfield=[
'IDBASE
'PROG1
'PROG2
'PROGREC
'FILEANNO
'IDRIF
'ANNO
'TIPO
]
rd_kvar=[
'f_aeinvio->IDBASE
'f_aeinvio->PROG1
'f_aeinvio->PROG2
'f_aeinvio->PROGREC
'f_aeinvio->FILEANNO
'f_aeinvio->IDRIF
'f_aeinvio->ANNO
'f_aeinvio->TIPO
]
I
nonlocal=True
obj='Var
pag=15
prev=O2476
var_op='asgn
I
obj='Var
obj_type='N
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=15
prev=O2468
var_op='asgn
I
nonlocal=True
obj='Var
pag=15
prev=O2466
var_op='asgn
I
obj='Select
pag=15
prev=O2465
sel_field='*
sel_name='f_aesaldi
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2466
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Inserisco File Saldi: '+f_aesaldi->NOMEFILE
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPInsert
arch='aesaldi
obj='Insert
pag=15
prev=O2485
rd_kfield=[
'NOMEFILE
'ANNO
'PROTOCOLLO
'IDBASE
'TIPO
'FILEINV1
'FILEINV2
'ANNULLATO
]
rd_kvar=[
'f_aesaldi->NOMEFILE
'f_aesaldi->ANNO
'f_aesaldi->PROTOCOLLO
'f_aesaldi->IDBASE
'f_aesaldi->TIPO
'f_aesaldi->FILEINV1
'f_aesaldi->FILEINV2
'f_aesaldi->ANNULLATO
]
I
nonlocal=True
obj='Var
pag=15
prev=O2484
var_op='asgn
I
obj='Var
obj_type='N
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=15
prev=O2464
var_op='asgn
I
nonlocal=True
obj='Var
pag=15
prev=O2462
var_op='asgn
I
obj='Select
pag=15
prev=O2461
sel_field='*
sel_name='f_aeannora
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2462
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Inserisco Saldo per Rapporto: '+f_aeannora->RAPPORTO
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_tiporap
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='_codrap
next=Icpitembatch.CPRead
arch='aetesta
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_codrap))
]
h=[
19
19
]
obj='If
pag=15
prev=O2496
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='aeannora
father=O2497
fatherSonIndex=0
obj='Insert
pag=15
rd_kfield=[
'RAPPORTO
'TIPRAP
'ANNO
'IDBASE
'IMPORTO1
'IMPORTO2
'IMPORTO3
'IMPORTO4
'IMPORTO5
'PROG1
'PROG2
'ESITOANNO
'PROGREC
'FILEANNO
]
rd_kvar=[
'f_aeannora->RAPPORTO
'_tiporap
'f_aeannora->ANNO
'f_aeannora->IDBASE
'f_aeannora->IMPORTO1
'f_aeannora->IMPORTO2
'f_aeannora->IMPORTO3
'f_aeannora->IMPORTO4
'f_aeannora->IMPORTO5
'f_aeannora->PROG1
'f_aeannora->PROG2
'f_aeannora->ESITOANNO
'f_aeannora->PROGREC
'f_aeannora->FILEANNO
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=15
prev=O2495
rd_field=[
'TIPOAG
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'f_aeannora->RAPPORTO
]
rd_var=[
'_tiporap
'_codrap
]
I
obj='Var
pag=15
prev=O2494
var_op='asgn
I
obj='Var
pag=15
pagelocal=True
prev=O2493
var_op='asgn
I
nonlocal=True
obj='Var
pag=15
prev=O2492
var_op='asgn
I
obj='Var
obj_type='N
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=15
prev=O2460
var_op='asgn
I
nonlocal=True
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=15
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2454
fatherSonIndex=0
len=2
name='_tiporap
obj='Var
pag=15
pagelocal=True
I
I
]
w=[
150
150
]
x=15
y=18
I
Icpitembatch.CPBeginEnd
comment='Legge Garantiti
h=[
19
19
]
obj='Begin
pag=16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2516
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Garantiti' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Garantiti' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Garantiti' +NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=16
prev=O2524
var_op='asgn
I
nonlocal=True
obj='Var
pag=16
prev=O2522
var_op='asgn
I
obj='Select
pag=16
prev=O2521
sel_field='*
sel_name='f_garantbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2522
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Inserisco Garantito per Rapporto: '+f_garantbo->RAPPORTO
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPInsert
arch='garantbo
obj='Insert
pag=16
prev=O2529
rd_kfield=[
'RAPPORTO
'CODINTER
'DATAINI
'DATAFINE
'IDBASE
]
rd_kvar=[
'f_garantbo->RAPPORTO
'Upper(f_garantbo->CODINTER)
'f_garantbo->DATAINI
'f_garantbo->DATAFINE
'f_garantbo->IDBASE
]
I
nonlocal=True
obj='Var
pag=16
prev=O2528
var_op='asgn
I
obj='Var
obj_type='N
pag=16
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=16
prev=O2520
var_op='asgn
I
nonlocal=True
obj='Var
pag=16
var_op='asgn
I
I
]
w=[
150
150
]
x=20
y=22
I
Icpitembatch.CPBeginEnd
comment='Legge Garantiti
h=[
19
19
]
obj='Begin
pag=17
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2535
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Storico XBRL' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Storico XBRL' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Storico XBRL (Dettaglio)' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Storico XBRL' +NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=17
prev=O2547
var_op='asgn
I
nonlocal=True
obj='Var
pag=17
prev=O2545
var_op='asgn
I
obj='Select
pag=17
prev=O2544
sel_field='*
sel_name='f_storicoxbrl_dett
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2545
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Inserisco Registrazione : '+ f_storicoxbrl_dett->ANNORIF + "-" + f_storicoxbrl_dett->MESERIF + "-"+f_storicoxbrl_dett->PROGRIF+"-"+f_storicoxbrl_dett->TIPOPE+"-"+f_storicoxbrl_dett->NUMPROG
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPInsert
arch='storicoxbrl_dett
obj='Insert
pag=17
prev=O2552
rd_kfield=[
'ANNORIF
'MESERIF
'PROGRIF
'TIPOPE
'NUMPROG
'DATAOPE
'CODVOC
'FLAGLIRE
'SEGNO
'TOTLIRE
'TOTCONT
'CODINTDIP
'ABICABDIP
'CODCABDIP
'RAPPORTO
'CONNESCLI
'PERPAESE
'PERCAB
'SETTSINT
'CONNESBEN
'PAESECP
'CODCABCP
'INTCONTRO
'PAESEICP
'CABICP
]
rd_kvar=[
'f_storicoxbrl_dett->ANNORIF
'f_storicoxbrl_dett->MESERIF
'f_storicoxbrl_dett->PROGRIF
'f_storicoxbrl_dett->TIPOPE
'f_storicoxbrl_dett->NUMPROG
'f_storicoxbrl_dett->DATAOPE
'f_storicoxbrl_dett->CODVOC
'f_storicoxbrl_dett->FLAGLIRE
'f_storicoxbrl_dett->SEGNO
'f_storicoxbrl_dett->TOTLIRE
'f_storicoxbrl_dett->TOTCONT
'f_storicoxbrl_dett->CODINTDIP
'f_storicoxbrl_dett->ABICABDIP
'f_storicoxbrl_dett->CODCABDIP
'f_storicoxbrl_dett->RAPPORTO
'f_storicoxbrl_dett->CONNESCLI
'f_storicoxbrl_dett->PERPAESE
'f_storicoxbrl_dett->PERCAB
'f_storicoxbrl_dett->SETTSINT
'f_storicoxbrl_dett->CONNESBEN
'f_storicoxbrl_dett->PAESECP
'f_storicoxbrl_dett->CODCABCP
'f_storicoxbrl_dett->INTCONTRO
'f_storicoxbrl_dett->PAESEICP
'f_storicoxbrl_dett->CABICP
]
I
nonlocal=True
obj='Var
pag=17
prev=O2551
var_op='asgn
I
obj='Var
obj_type='N
pag=17
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=17
prev=O2543
var_op='asgn
I
nonlocal=True
obj='Var
pag=17
prev=O2541
var_op='asgn
I
obj='Select
pag=17
prev=O2540
sel_field='*
sel_name='f_storicoxbrl
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2541
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Inserisco Registrazione : '+ f_storicoxbrl->ANNORIF + "-" + f_storicoxbrl->MESERIF + "-"+f_storicoxbrl->PROGRIF
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPInsert
arch='storicoxbrl
obj='Insert
pag=17
prev=O2560
rd_kfield=[
'ANNORIF
'MESERIF
'PROGRIF
'CODINTDIP
'ABICABDIP
'CODCABDIP
'PERPAESE
'PERCAB
'CODVOC
'FLAGLIRE
'SEGNO
'SETTSINT
'PAESECP
'CODCABCP
'PAESEICP
'CABICP
'TOTLIRE
'TOTCONT
'OPERAZIONI
'CONTANTI
]
rd_kvar=[
'f_storicoxbrl->ANNORIF
'f_storicoxbrl->MESERIF
'f_storicoxbrl->PROGRIF
'f_storicoxbrl->CODINTDIP
'f_storicoxbrl->ABICABDIP
'f_storicoxbrl->CODCABDIP
'f_storicoxbrl->PERPAESE
'f_storicoxbrl->PERCAB
'f_storicoxbrl->CODVOC
'f_storicoxbrl->FLAGLIRE
'f_storicoxbrl->SEGNO
'f_storicoxbrl->SETTSINT
'f_storicoxbrl->PAESECP
'f_storicoxbrl->CODCABCP
'f_storicoxbrl->PAESEICP
'f_storicoxbrl->CABICP
'f_storicoxbrl->TOTLIRE
'f_storicoxbrl->TOTCONT
'f_storicoxbrl->OPERAZIONI
'f_storicoxbrl->CONTANTI
]
I
nonlocal=True
obj='Var
pag=17
prev=O2559
var_op='asgn
I
obj='Var
obj_type='N
pag=17
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=17
prev=O2539
var_op='asgn
I
nonlocal=True
obj='Var
pag=17
var_op='asgn
I
I
]
w=[
150
150
]
x=14
y=20
I
Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
obj='Try
pag=11
prev=O2566
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O2567
fatherSonIndex=0
frm_calc='Operazioni P
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Operazioni P' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Operazioni P' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Operazioni P' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file Operazioni P'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPRemark
frm_calc='Frazionate P
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file Frazionate P' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Frazionate P' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file Frazionate P' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file Frazionate P'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=11
prev=O2586
I
nonlocal=True
obj='Var
pag=11
prev=O2585
var_op='asgn
I
nonlocal=True
obj='Var
pag=11
prev=O2584
var_op='asgn
I
nonlocal=True
obj='Var
pag=11
prev=O2582
var_op='asgn
I
obj='Select
pag=11
prev=O2581
sel_field='*
sel_name='f_xraziobo
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O2582
fatherSonIndex=0
frm_calc=[
'not(Empty(f_xraziobo->IDBASE))
]
h=[
19
19
]
obj='If
pag=11
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2590
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Frazionate P'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xraziobo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='1
len=3
name='_numrig
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='1
len=3
name='_numrig
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=11
prev=O2606
sel_field='*
sel_name='f_xoggetbo
sel_where='f_xoggetbo->IDFILEBO=f_xraziobo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xogopefbo
father=O2607
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='_numrig + 1
len=3
name='_numrig
obj='Var
obj_type='N
pag=11
prev=O2611
var_op='asgn
I
obj='Insert
pag=11
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'f_xoggetbo->IDFILEBO
'_numrig
'Upper(f_xoggetbo->CODSOG)
'f_xoggetbo->LEGAME
'f_xoggetbo->IDBASE
'f_xoggetbo->NUMCOL
'f_xoggetbo->TIPOFILE
'f_xoggetbo->RAPCOL
'f_xoggetbo->UCODE
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=11
prev=O2604
var_op='asgn
I
obj='Select
pag=11
prev=O2602
sel_field='*
sel_name='f_xerzisti
sel_where='f_xerzisti->IDFILEBO=f_xraziobo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xerzistifrz
father=O2604
fatherSonIndex=0
obj='Insert
pag=11
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'f_xerzisti->IDFILEBO
'Upper(f_xerzisti->CODSOG)
'f_xerzisti->TIPOFILE
'f_xerzisti->NUMCOL
'f_xerzisti->LEGAME
'f_xerzisti->RAPCOL
'f_xerzisti->UCODE
'f_xerzisti->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=11
prev=O2601
sel_field='*
sel_name='f_xenefic
sel_where='f_xenefic->IDFILEBO=f_xraziobo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xeneficfrz
father=O2602
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='_numrig + 1
len=3
name='_numrig
obj='Var
obj_type='N
pag=11
prev=O2624
var_op='asgn
I
obj='Insert
pag=11
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
rd_kvar=[
'f_xenefic->IDFILEBO
'_numrig
'Upper(f_xenefic->CODSOG)
'f_xenefic->TIPOFILE
'f_xenefic->NUMCOL
'f_xenefic->LEGAME
'f_xenefic->RAPCOL
'f_xenefic->UCODE
'f_xenefic->IDBASE
'f_xenefic->C_RAG
'f_xenefic->C_STA
'f_xenefic->C_CTA
'f_xenefic->C_CAB
'f_xenefic->C_PRV
'f_xenefic->C_IND
'f_xenefic->C_CAP
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=11
prev=O2599
var_op='asgn
I
obj='Select
pag=11
prev=O2598
sel_field='*
sel_name='f_xlienti
sel_where='f_xlienti->IDFILEBO=f_xraziobo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientifrz
father=O2599
fatherSonIndex=0
obj='Insert
pag=11
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'f_xlienti->IDFILEBO
'Upper(f_xlienti->CODSOG)
'f_xlienti->TIPOFILE
'f_xlienti->NUMCOL
'f_xlienti->LEGAME
'f_xlienti->RAPCOL
'f_xlienti->UCODE
'f_xlienti->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=11
prev=O2597
rd_kfield=[
'AMMONT
'AREAGEO
'AUTOM
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'IDEREG
'INFORM
'MODSVOL
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PAGASOGOP
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
]
rd_kvar=[
'f_xraziobo->AMMONT
'f_xraziobo->AREAGEO
'f_xraziobo->AUTOM
'f_xraziobo->C_CAB
'f_xraziobo->C_CAP
'f_xraziobo->C_CTA
'f_xraziobo->C_IND
'f_xraziobo->C_PRV
'f_xraziobo->C_RAG
'f_xraziobo->C_RAPPORTO
'f_xraziobo->C_STA
'f_xraziobo->CAMBIO
'DateToChar(f_xraziobo->DATAOPE)
'DateToChar(f_xraziobo->DATAOPE)
'f_xraziobo->CODANA
'f_xraziobo->CODCAB
'f_xraziobo->CODCAB2
'f_xraziobo->CODDIPE
'f_xraziobo->CODINT2
'f_xraziobo->CODINTER
'f_xraziobo->CODVOC
'f_xraziobo->COLLEG
'Upper(f_xraziobo->CONNALTRO)
'Upper(f_xraziobo->CONNESBEN)
'Upper(f_xraziobo->CONNESCLI)
'Upper(f_xraziobo->CONNESOPER)
'f_xraziobo->DATAIMP
'f_xraziobo->DATAOPE
'f_xraziobo->DATAREG
'f_xraziobo->DATARETT
'f_xraziobo->DESC2
'f_xraziobo->DESCCIT
'f_xraziobo->DESCINTER
'f_xraziobo->DOCFILE
'f_xraziobo->DURAT
'f_xraziobo->FLAGCONT
'f_xraziobo->FLAGFRAZ
'f_xraziobo->FLAGLIRE
'f_xraziobo->FLAGRAP
'f_xraziobo->FLAGRAP2
'f_xraziobo->IDBASE
'f_xraziobo->IDEREG
'f_xraziobo->INFORM
'f_xraziobo->MODSVOL
'f_xraziobo->NATURA
'f_xraziobo->NOPROT
'f_xraziobo->NUMPROG
'f_xraziobo->OPERAG
'f_xraziobo->OPERATORE
'f_xraziobo->OPERAZMOD
'f_xraziobo->OPRAP
'f_xraziobo->PAESE
'f_xraziobo->PAGASOGOP
'nProgImp
'f_xraziobo->PROV2
'f_xraziobo->PROVINCIA
'f_xraziobo->RAGIO
'f_xraziobo->RAPPORTBEN
'f_xraziobo->RAPPORTO
'f_xraziobo->RAREA
'f_xraziobo->RCOMP
'f_xraziobo->RESPINS
'f_xraziobo->RFREQ
'f_xraziobo->RIFIMP
'f_xraziobo->RIMP
'f_xraziobo->RRAGIO
'f_xraziobo->RTIPO
'f_xraziobo->SCOPO
'f_xraziobo->SEGNO
'f_xraziobo->STATOREG
'f_xraziobo->TIPO
'f_xraziobo->TIPOINF
'f_xraziobo->TIPOINT2
'f_xraziobo->TIPOINTER
'f_xraziobo->TIPOLEG
'f_xraziobo->TIPOOPRAP
'f_xraziobo->TOTCONT
'f_xraziobo->TOTLIRE
'f_xraziobo->UCODE
'f_xraziobo->UNIQUECODE
'f_xraziobo->VALUTA
'f_xraziobo->ZCPARTE
]
I
obj='Var
obj_type='N
pag=11
prev=O2596
var_op='asgn
I
nonlocal=True
obj='Var
pag=11
prev=O2595
var_op='asgn
I
obj='Var
obj_type='N
pag=11
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=11
prev=O2580
var_op='asgn
I
nonlocal=True
obj='Var
pag=11
prev=O2579
var_op='asgn
I
obj='Remark
pag=11
prev=O2578
I
nonlocal=True
obj='Var
pag=11
prev=O2577
var_op='asgn
I
nonlocal=True
obj='Var
pag=11
prev=O2576
var_op='asgn
I
nonlocal=True
obj='Var
pag=11
prev=O2574
var_op='asgn
I
obj='Select
pag=11
prev=O2573
sel_field='*
sel_name='f_xperazbo
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O2574
fatherSonIndex=0
frm_calc=[
'not(Empty(f_xperazbo->IDBASE))
]
h=[
19
19
]
obj='If
pag=11
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2641
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Operazioni P'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xperazbo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='1
len=3
name='_numrig
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='1
len=3
name='_numrig
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=11
prev=O2657
sel_field='*
sel_name='f_xoggetbo
sel_where='f_xoggetbo->IDFILEBO=f_xperazbo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xogopebo
father=O2658
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='_numrig + 1
len=3
name='_numrig
obj='Var
obj_type='N
pag=11
prev=O2662
var_op='asgn
I
obj='Insert
pag=11
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'f_xoggetbo->IDFILEBO
'_numrig
'Upper(f_xoggetbo->CODSOG)
'f_xoggetbo->LEGAME
'f_xoggetbo->IDBASE
'f_xoggetbo->NUMCOL
'f_xoggetbo->TIPOFILE
'f_xoggetbo->RAPCOL
'f_xoggetbo->UCODE
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=11
prev=O2655
var_op='asgn
I
obj='Select
pag=11
prev=O2653
sel_field='*
sel_name='f_xerzisti
sel_where='f_xerzisti->IDFILEBO=f_xperazbo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xerzistiope
father=O2655
fatherSonIndex=0
obj='Insert
pag=11
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'f_xerzisti->IDFILEBO
'Upper(f_xerzisti->CODSOG)
'f_xerzisti->TIPOFILE
'f_xerzisti->NUMCOL
'f_xerzisti->LEGAME
'f_xerzisti->RAPCOL
'f_xerzisti->UCODE
'f_xerzisti->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=11
prev=O2652
sel_field='*
sel_name='f_xenefic
sel_where='f_xenefic->IDFILEBO=f_xperazbo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xeneficope
father=O2653
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='_numrig + 1
len=3
name='_numrig
obj='Var
obj_type='N
pag=11
prev=O2675
var_op='asgn
I
obj='Insert
pag=11
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
rd_kvar=[
'f_xenefic->IDFILEBO
'_numrig
'Upper(f_xenefic->CODSOG)
'f_xenefic->TIPOFILE
'f_xenefic->NUMCOL
'f_xenefic->LEGAME
'f_xenefic->RAPCOL
'f_xenefic->UCODE
'f_xenefic->IDBASE
'f_xenefic->C_RAG
'f_xenefic->C_STA
'f_xenefic->C_CTA
'f_xenefic->C_CAB
'f_xenefic->C_PRV
'f_xenefic->C_IND
'f_xenefic->C_CAP
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=11
prev=O2650
var_op='asgn
I
obj='Select
pag=11
prev=O2649
sel_field='*
sel_name='f_xlienti
sel_where='f_xlienti->IDFILEBO=f_xperazbo->IDBASE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientiope
father=O2650
fatherSonIndex=0
obj='Insert
pag=11
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'f_xlienti->IDFILEBO
'Upper(f_xlienti->CODSOG)
'f_xlienti->TIPOFILE
'f_xlienti->NUMCOL
'f_xlienti->LEGAME
'f_xlienti->RAPCOL
'f_xlienti->UCODE
'f_xlienti->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=11
prev=O2648
rd_kfield=[
'AMMONT
'AREAGEO
'AUTOM
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'IDEREG
'INFORM
'MODSVOL
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
]
rd_kvar=[
'f_xperazbo->AMMONT
'f_xperazbo->AREAGEO
'f_xperazbo->AUTOM
'f_xperazbo->C_CAB
'f_xperazbo->C_CAP
'f_xperazbo->C_CTA
'f_xperazbo->C_IND
'f_xperazbo->C_PRV
'f_xperazbo->C_RAG
'f_xperazbo->C_RAPPORTO
'f_xperazbo->C_STA
'f_xperazbo->CAMBIO
'DateToChar(f_xperazbo->DATAOPE)
'DateToChar(f_xperazbo->DATAOPE)
'f_xperazbo->CODANA
'f_xperazbo->CODCAB
'f_xperazbo->CODCAB2
'f_xperazbo->CODDIPE
'f_xperazbo->CODINT2
'f_xperazbo->CODINTER
'f_xperazbo->CODVOC
'f_xperazbo->COLLEG
'Upper(f_xperazbo->CONNALTRO)
'Upper(f_xperazbo->CONNESBEN)
'Upper(f_xperazbo->CONNESCLI)
'Upper(f_xperazbo->CONNESOPER)
'f_xperazbo->DATAIMP
'f_xperazbo->DATAOPE
'f_xperazbo->DATAREG
'f_xperazbo->DATARETT
'f_xperazbo->DESC2
'f_xperazbo->DESCCIT
'f_xperazbo->DESCINTER
'f_xperazbo->DOCFILE
'f_xperazbo->DURAT
'f_xperazbo->FLAGCONT
'f_xperazbo->FLAGFRAZ
'f_xperazbo->FLAGLIRE
'f_xperazbo->FLAGRAP
'f_xperazbo->FLAGRAP2
'f_xperazbo->IDBASE
'f_xperazbo->IDEREG
'f_xperazbo->INFORM
'f_xperazbo->MODSVOL
'f_xperazbo->NATURA
'f_xperazbo->NOPROT
'f_xperazbo->NUMPROG
'f_xperazbo->OPERAG
'f_xperazbo->OPERATORE
'f_xperazbo->OPERAZMOD
'f_xperazbo->OPRAP
'f_xperazbo->PAESE
'f_xperazbo->PAGASOGOP
'nProgImp
'f_xperazbo->PROV2
'f_xperazbo->PROVINCIA
'f_xperazbo->RAGIO
'f_xperazbo->RAPPORTBEN
'f_xperazbo->RAPPORTO
'f_xperazbo->RAREA
'f_xperazbo->RCOMP
'f_xperazbo->RESPINS
'f_xperazbo->RFREQ
'f_xperazbo->RIFIMP
'f_xperazbo->RIMP
'f_xperazbo->RRAGIO
'f_xperazbo->RTIPO
'f_xperazbo->SCOPO
'f_xperazbo->SEGNO
'f_xperazbo->STATOREG
'f_xperazbo->TIPO
'f_xperazbo->TIPOINF
'f_xperazbo->TIPOINT2
'f_xperazbo->TIPOINTER
'f_xperazbo->TIPOLEG
'f_xperazbo->TIPOOPRAP
'f_xperazbo->TOTCONT
'f_xperazbo->TOTLIRE
'f_xperazbo->UCODE
'f_xperazbo->UNIQUECODE
'f_xperazbo->VALUTA
'f_xperazbo->ZCPARTE
]
I
obj='Var
obj_type='N
pag=11
prev=O2647
var_op='asgn
I
nonlocal=True
obj='Var
pag=11
prev=O2646
var_op='asgn
I
obj='Var
obj_type='N
pag=11
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=11
prev=O2572
var_op='asgn
I
nonlocal=True
obj='Var
pag=11
prev=O2571
var_op='asgn
I
obj='Remark
pag=11
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O2567
fatherSonIndex=1
frm_calc='rollback
next=Icpitembatch.CPMessage
frm_calc='m_Sql.TransactionErrorMessage()
msg_type='Debug
obj='Message
pag=11
prev=O2691
I
obj='Transaction
pag=11
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=11
x=14
y=14
I
Icpitembatch.CPBeginEnd
comment='Legge Invii AGE
h=[
19
19
]
obj='Begin
pag=18
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2694
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file INVII AGE' +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record del file Storico XBRL' + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=18
prev=O2701
var_op='asgn
I
obj='Try
pag=18
prev=O2700
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2701
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=18
prev=O2706
I
obj='Select
pag=18
sel_field='*
sel_name='f_aefaminvio
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O2706
fatherSonIndex=0
frm_calc=''Inserisco Registrazione : '+ f_aefaminvio->IDBASE + " per Anno/Mese: " +f_aefaminvio->ANNO +"/"+f_aefaminvio->MESE
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPInsert
arch='aefaminvio
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=18
prev=O2712
var_op='asgn
I
obj='Insert
pag=18
prev=O2711
rd_kfield=[
'IDBASE
'IDIDBASE
'TIPO
'TIPOINVIO
'ANNO
'MESE
'TIPOCOM
'OLDDATA
'RAPPORTO
'NOMEFILE
'FILEINV1
'FILEINV2
'PROG
'PROTOCOLLO
'CODERROR
]
rd_kvar=[
'f_aefaminvio->IDBASE
'f_aefaminvio->IDIDBASE
'f_aefaminvio->TIPO
'f_aefaminvio->TIPOINVIO
'f_aefaminvio->ANNO
'f_aefaminvio->MESE
'f_aefaminvio->TIPOCOM
'f_aefaminvio->OLDDATA
'f_aefaminvio->RAPPORTO
'f_aefaminvio->NOMEFILE
'f_aefaminvio->FILEINV1
'f_aefaminvio->FILEINV2
'f_aefaminvio->PROG
'f_aefaminvio->PROTOCOLLO
'f_aefaminvio->CODERROR
]
I
nonlocal=True
obj='Var
pag=18
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O2701
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=18
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=18
prev=O2699
I
obj='Var
obj_type='N
pag=18
prev=O2698
var_op='asgn
I
nonlocal=True
obj='Var
pag=18
var_op='asgn
I
I
]
w=[
150
150
]
x=4
y=19
I
]
comment='Importa i dati da MITANTI
date_creat=#2006-06-20
date_rev=#2024-01-11
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'FileLibMit
'LibreriaMit
'Utilities
]
merge=True
modcnt=736
page_result_class=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
page_result_type=[
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
]
page_uid=[
'SWGEZEDOHY
'CXKVMEJZCZ
'KRKDIEUZTU
'UDVVJWBLMF
'DEGMBEFAHZ
'TGADCNXEOM
'BESZMXITUP
'QGHMLNRJUW
'JJFRYCYEMJ
'PASYHFYWTQ
'GQOQPMXFRO
'EDURSZDGWN
'HXWOIHBVXM
'IVRXQVLARD
'SCNEMBNOJG
'ZRINTCJFEF
'DZGRDADLLC
'ACEDOONSTJ
]
pagename=[
'Page_1
'Page_2
'Page_3
'Page_4
'Page_5
'Page_6
'Page_7
'Page_8
'Page_9
'Page_10
'Page_11
'Page_12
'Page_13
'Page_14
'Page_15
'Page_16
'Page_17
'Page_18
]
pagenote=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
pagetitle=[
'Main
'Intermediari + Dipendenze
'Soggetti
'Rapporti + Informazioni
'Frazionate + Operazioni
'Titolari
'Rapporti (AGE)
'Anagrafe Rapporti
'Deleghe + OPEX (AGE)
'Rapporti AUI (P)
'Operazioni + Frazionate (P)
'Titolari (P)
'Operazioni Extraconto
'Operazioni + Frazionate (S)
'Saldi AGE
'Garantiti
'Storico XBRL
'Supporto AGE
]
runtime_filters=2
tpl_name='Routine
work_file=[
'aederig
'aeoprig
'aeopstor
'aerighe
'aetesta
'anadip
'anarapbo
'beneficfrz
'beneficope
'clientifrz
'clientiope
'cpwarn
'delegabo
'f_aederig
'f_aeoprig
'f_aerighe
'f_aetesta
'f_anadip
'f_anarapbo
'f_benefic
'f_clienti
'f_fraziobo
'f_inter2bo
'f_intermbo
'f_intestbo
'f_japopebo
'f_jnarapbo
'f_jntestbo
'f_operazbo
'f_opextrbo
'f_personbo
'f_rapopebo
'f_rapotit
'f_soggetbo
'f_terzisti
'f_wenefic
'f_werzisti
'f_wlienti
'f_woggetbo
'f_wperazbo
'f_wraziobo
'f_xapopebo
'f_xapotit
'f_xenefic
'f_xerzisti
'f_xlienti
'f_xnarapbo
'f_xntestbo
'f_xoggetbo
'f_xperazbo
'f_xraziobo
'fraziobo
'inter2bo
'intermbo
'intestbo
'japopebo
'jelegabo
'jnarapbo
'jntestbo
'joginfo
'jogopebo
'jperazbo
'knarapbo
'operazbo
'opextrbo
'personbo
'rapopebo
'rapotit
'soginfo
'sogopebo
'sogopefbo
'tbcauana
'tbcitta
'tbvalute
'terzistifrz
'terzistiope
'titolabo
'titopers
'weneficfrz
'weneficope
'wersonbo
'werzistifrz
'werzistiope
'wlientifrz
'wlientiope
'wogopebo
'wogopefbo
'wperazbo
'wraziobo
'xapopebo
'xapotit
'xelegabo
'xeneficfrz
'xeneficope
'xerzistifrz
'xerzistiope
'xlientifrz
'xlientiope
'xnarapbo
'xntestbo
'xoginfo
'xogopebo
'xogopefbo
'xperazbo
'xraziobo
'f_aesaldi
'f_aeannora
'aeannora
'f_aestor
'f_aedestor
'aedestor
'f_aedecanc
'aedecanc
'f_aeinvio
'aeinvio
'aesaldi
'f_wersonbo
'f_inttitbo
'intestit
'f_xnttitbo
'xntestit
'f_delegabo
'f_garantbo
'garantbo
'f_storicoxbrl
'storicoxbrl
'f_storicoxbrl_dett
'storicoxbrl_dett
'f_aefaminvio
'aefaminvio
'f_operazbo_agg
'operazbo_agg
'f_fraziobo_agg
'fraziobo_agg
'f_personbo_agg
'personbo_agg
'f_wersonbo_agg
'wersonbo_agg
'qbe_f_aeoprig_totale
]
work_filter=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
I
*--*
*----*
