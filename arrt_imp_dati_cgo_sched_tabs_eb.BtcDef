* --- CodePainter Revolution Batch Vers. 5.1
￼Icpbatch.CPBatch
Items=[
Icpitembatch.CPBeginEnd
comment='Definizione variabili Locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='variabili copia
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='variabili locali per leggere i file
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili globali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili di pagina per operazioni
h=[
19
19
]
next=Icpitembatch.CPMessage
frm_calc=''Attivazione Import Dati'
msg_type='Debug
next=Icpitembatch.CPExec
frm_calc='Utilities.SetUserCode(1)
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetCompany()
len=10
name='_oldazi
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_chiave
next=Icpitembatch.CPVarDecl
frm_calc=''Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + NL
len=10
name='_gMsgProc
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='Utilities.SetCompany(_oldazi)
next=Icpitembatch.CPVarDecl
frm_calc='_gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + NL
len=10
name='_gMsgProc
obj='Var
obj_type='M
pag=1
prev=O20
var_op='asgn
I
obj='Exec
pag=1
prev=O18
I
obj='Select
pag=1
prev=O17
sel_field='*
sel_name='cpazi
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O18
fatherSonIndex=0
frm_calc='Utilities.SetCompany(LRTrim(cpazi->codazi))
next=Icpitembatch.CPVarDecl
comment='Azienda
frm_calc='LRTrim(cpazi->codazi)
len=10
name='_gAzienda
next=Icpitembatch.CPRemark
frm_calc='Legge dati intermediario per metteri su operazbo,fraziobo,rapopebo se mancanti
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Import Soggetti
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_gMsgProc
next=Icpitembatch.CPRemark
frm_calc='Cicla sul file della lista e lancia la pagina appropriata
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_esito
next=Icpitembatch.CPVarDecl
frm_calc=''N'
len=1
name='_flgfile
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
obj='Try
pag=1
prev=O34
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Azzera contatori
father=O35
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPExec
check='page
frm_calc='2
next=Icpitembatch.CPExec
check='page
frm_calc='3
next=Icpitembatch.CPExec
check='page
frm_calc='4
next=Icpitembatch.CPExec
check='page
frm_calc='5
next=Icpitembatch.CPExec
check='page
frm_calc='6
next=Icpitembatch.CPExec
check='page
frm_calc='14
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=1
prev=O46
I
obj='Exec
pag=1
prev=O45
I
obj='Exec
pag=1
prev=O44
I
obj='Exec
pag=1
prev=O43
I
obj='Exec
pag=1
prev=O42
I
obj='Exec
pag=1
prev=O41
I
obj='Exec
pag=1
prev=O39
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O39
fatherSonIndex=0
frm_calc='0
len=10
name='nTotErr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='dNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='dNumMod
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='dNumErr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='sNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='sNumMod
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='sNumInv
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='sNumErr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='rNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='rNumMod
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='rNumErr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='oNumero
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='oNumErr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='uNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='uNumMod
obj='Var
obj_type='N
pag=1
prev=O63
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O62
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O61
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O60
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O59
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O58
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O57
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O56
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O55
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O54
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O53
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O52
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O51
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O50
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O35
fatherSonIndex=1
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPVarDecl
frm_calc='"Rilevati errori nell'importazione dei file! Ricreare il file segnalato e rieseguire l'import dei dati. La procedura annullera automaticamente l'importazione" + NL
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='_gMsgProc + 'Errore SQL: ' + m_Sql.TransactionErrorMessage() + NL
len=10
name='_gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='rollback
next=Icpitembatch.CPExec
frm_calc='Utilities.SetCompany(LRTrim(cpazi->codazi))
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGLOG\'"+LRTrim(_gAzienda)+"'",'',20)
len=20
name='cProg
next=Icpitembatch.CPInsert
arch='log_app
obj='Insert
pag=1
prev=O72
rd_kfield=[
'LOGCODICE
'LOGDATORA
'LOGUTENTE
'LOGTIPOPE
'LOGTESTO
'LOGTABELLA
'LOGCHIAVE
'LOGTYPE
]
rd_kvar=[
'cProg
'DateTime()
'1
''Import Dati'
'_gMsgProc
''Scheduler'
''ERRORS'
''S'
]
I
obj='Var
pag=1
prev=O71
var_op='asgn
I
obj='Exec
pag=1
prev=O70
I
obj='Transaction
pag=1
prev=O69
I
obj='Var
obj_type='M
pag=1
prev=O68
var_op='asgn
I
obj='Var
obj_type='M
pag=1
prev=O67
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=1
prev=O33
I
obj='Var
pag=1
prev=O32
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O31
var_op='asgn
I
obj='Remark
pag=1
prev=O30
I
obj='Var
obj_type='M
pag=1
prev=O29
var_op='asgn
I
obj='Remark
pag=1
prev=O27
I
obj='Select
pag=1
prev=O26
sel_field='*
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O27
fatherSonIndex=0
frm_calc='intermbo->TIPINTER
len=2
name='_tipinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->CODINTER
len=11
name='_codinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->DESCCIT
len=30
name='_citinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->CODCAB
len=6
name='_cabinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->PROVINCIA
len=2
name='_prvinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->FLGTIPIMP
len=1
name='w_tipodest
next=Icpitembatch.CPVarDecl
dec=2
frm_calc='intermbo->MINFRZSNAI
len=12
name='_limoper
next=Icpitembatch.CPVarDecl
dec=2
frm_calc='intermbo->LIMITVLT
len=10
name='_limvlt
next=Icpitembatch.CPVarDecl
dec=2
frm_calc='intermbo->LIMITVNP
len=10
name='_limvnp
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->FLGNODOC
len=1
name='_flgnodoc
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->SNAISTOR
len=1
name='_snaistor
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->FLGLIGHT
len=1
name='_flglight
obj='Var
pag=1
prev=O89
var_op='asgn
I
obj='Var
pag=1
prev=O88
var_op='asgn
I
obj='Var
pag=1
prev=O87
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O86
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O85
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O84
var_op='asgn
I
obj='Var
pag=1
prev=O83
var_op='asgn
I
obj='Var
pag=1
prev=O82
var_op='asgn
I
obj='Var
pag=1
prev=O81
var_op='asgn
I
obj='Var
pag=1
prev=O80
var_op='asgn
I
obj='Var
pag=1
prev=O79
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=1
prev=O25
I
obj='Var
pag=1
prev=O24
var_op='asgn
I
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
prev=O16
var_op='asgn
I
obj='Var
pag=1
prev=O15
var_op='asgn
I
obj='Var
pag=1
prev=O14
var_op='asgn
I
obj='Exec
pag=1
prev=O13
I
obj='Message
pag=1
prev=O11
I
obj='Begin
pag=1
prev=O9
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O11
fatherSonIndex=0
len=5
name='_codcau
next=Icpitembatch.CPVarDecl
len=8
name='_datini
next=Icpitembatch.CPVarDecl
len=8
name='_datend
next=Icpitembatch.CPVarDecl
len=25
name='_codrap
next=Icpitembatch.CPVarDecl
len=16
name='_intcon
next=Icpitembatch.CPVarDecl
comment='Mezzo Pagamento
len=1
name='_mezpagam
next=Icpitembatch.CPVarDecl
len=10
name='_MsgAss
next=Icpitembatch.CPVarDecl
len=1
name='_omulti
next=Icpitembatch.CPVarDecl
len=1
name='_omultic
next=Icpitembatch.CPVarDecl
len=1
name='_omultic
next=Icpitembatch.CPVarDecl
len=15
name='_numopetele
next=Icpitembatch.CPVarDecl
len=5
name='_catipgio
next=Icpitembatch.CPVarDecl
len=5
name='_catipcon
next=Icpitembatch.CPVarDecl
len=10
name='_capv_cod
next=Icpitembatch.CPVarDecl
len=14
name='_cadataora
next=Icpitembatch.CPVarDecl
len=36
name='_iddocall
next=Icpitembatch.CPVarDecl
len=2
name='_vpcodice
next=Icpitembatch.CPVarDecl
len=12
name='cColleg
next=Icpitembatch.CPVarDecl
len=1
name='_flglight
next=Icpitembatch.CPVarDecl
len=1
name='_flgope
next=Icpitembatch.CPVarDecl
len=40
name='_cdessta
next=Icpitembatch.CPVarDecl
len=40
name='_cdescit
next=Icpitembatch.CPVarDecl
len=2
name='_ctipdoc
next=Icpitembatch.CPVarDecl
frm_seek='cgo_import_age
name='rowAgenzia
next=Icpitembatch.CPVarDecl
len=4
name='_cauana
next=Icpitembatch.CPVarDecl
len=2
name='_causin
next=Icpitembatch.CPVarDecl
len=10
name='_idb2
next=Icpitembatch.CPVarDecl
len=16
name='_connes
next=Icpitembatch.CPVarDecl
len=16
name='_codfisc
obj='Var
pag=1
prev=O122
I
obj='Var
pag=1
prev=O121
I
obj='Var
pag=1
prev=O120
I
obj='Var
pag=1
prev=O119
I
obj='Var
pag=1
prev=O118
I
obj='Var
obj_type='R
pag=1
prev=O117
I
obj='Var
pag=1
prev=O116
I
obj='Var
pag=1
prev=O115
I
obj='Var
pag=1
prev=O114
I
obj='Var
pag=1
prev=O113
I
obj='Var
pag=1
prev=O112
I
obj='Var
pag=1
prev=O111
I
obj='Var
pag=1
prev=O110
I
obj='Var
pag=1
prev=O109
I
obj='Var
obj_type='T
pag=1
prev=O108
I
obj='Var
obj_type='N
pag=1
prev=O107
I
obj='Var
obj_type='N
pag=1
prev=O106
I
obj='Var
obj_type='N
pag=1
prev=O105
I
obj='Var
pag=1
prev=O104
I
obj='Var
pag=1
prev=O103
I
obj='Var
pag=1
prev=O102
I
obj='Var
pag=1
prev=O101
I
obj='Var
obj_type='M
pag=1
prev=O100
I
obj='Var
pag=1
prev=O99
I
obj='Var
pag=1
prev=O98
I
obj='Var
pag=1
prev=O97
I
obj='Var
obj_type='D
pag=1
prev=O96
I
obj='Var
obj_type='D
pag=1
prev=O95
I
obj='Var
obj_type='N
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O7
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
comment='Azienda
father=O9
fatherSonIndex=0
len=10
name='_gAzienda
next=Icpitembatch.CPVarDecl
len=20
name='_chiave
next=Icpitembatch.CPVarDecl
len=1
name='_flgfile
next=Icpitembatch.CPVarDecl
len=10
name='_oldazi
next=Icpitembatch.CPVarDecl
dec=2
len=12
name='_limoper
next=Icpitembatch.CPVarDecl
len=15
name='ProgErr
next=Icpitembatch.CPVarDecl
dec=2
len=10
name='_limvlt
next=Icpitembatch.CPVarDecl
dec=2
len=10
name='_limvnp
next=Icpitembatch.CPVarDecl
len=15
name='_numope
next=Icpitembatch.CPVarDecl
len=1
name='_oidb
next=Icpitembatch.CPVarDecl
len=28
name='_idb
next=Icpitembatch.CPVarDecl
len=20
name='_seekid
next=Icpitembatch.CPVarDecl
len=1
name='_flgnodoc
next=Icpitembatch.CPVarDecl
len=1
name='_snaistor
next=Icpitembatch.CPVarDecl
len=15
name='_tottele
next=Icpitembatch.CPVarDecl
len=3
name='_codlob
next=Icpitembatch.CPVarDecl
len=3
name='_tipgio
next=Icpitembatch.CPVarDecl
len=15
name='nProgOpe
next=Icpitembatch.CPVarDecl
len=5
name='_cacodice
obj='Var
obj_type='N
pag=1
prev=O144
I
obj='Var
pag=1
prev=O143
I
obj='Var
pag=1
prev=O142
I
obj='Var
pag=1
prev=O141
I
obj='Var
obj_type='N
pag=1
prev=O140
I
obj='Var
pag=1
prev=O139
I
obj='Var
pag=1
prev=O138
I
obj='Var
pag=1
prev=O137
I
obj='Var
pag=1
prev=O136
I
obj='Var
pag=1
prev=O135
I
obj='Var
pag=1
prev=O134
I
obj='Var
obj_type='N
pag=1
prev=O133
I
obj='Var
obj_type='N
pag=1
prev=O132
I
obj='Var
pag=1
prev=O131
I
obj='Var
obj_type='N
pag=1
prev=O130
I
obj='Var
pag=1
prev=O129
I
obj='Var
pag=1
prev=O128
I
obj='Var
pag=1
prev=O127
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O5
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O7
fatherSonIndex=0
len=1
name='w_errchk
next=Icpitembatch.CPVarDecl
len=1
name='w_tipodest
next=Icpitembatch.CPVarDecl
len=100
name='filename
next=Icpitembatch.CPVarDecl
len=10
name='_conta
next=Icpitembatch.CPVarDecl
comment='Messaggio
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio
len=20
name='cProg
next=Icpitembatch.CPVarDecl
len=10
name='_totale
next=Icpitembatch.CPVarDecl
len=15
name='_max
next=Icpitembatch.CPVarDecl
len=15
name='_min
next=Icpitembatch.CPVarDecl
len=15
name='_cicli
next=Icpitembatch.CPVarDecl
len=15
name='_contacilci
next=Icpitembatch.CPVarDecl
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
len=15
name='_top
next=Icpitembatch.CPVarDecl
len=10
name='_movcod
next=Icpitembatch.CPVarDecl
len=10
name='dNumNew
next=Icpitembatch.CPVarDecl
len=10
name='dNumMod
next=Icpitembatch.CPVarDecl
len=10
name='dNumErr
next=Icpitembatch.CPVarDecl
len=10
name='oNumero
next=Icpitembatch.CPVarDecl
len=10
name='oNumErr
next=Icpitembatch.CPVarDecl
len=10
name='fNumero
next=Icpitembatch.CPVarDecl
len=10
name='sNumero
next=Icpitembatch.CPVarDecl
len=10
name='sNumNew
next=Icpitembatch.CPVarDecl
len=10
name='sNumMod
next=Icpitembatch.CPVarDecl
len=10
name='sNumInv
next=Icpitembatch.CPVarDecl
len=10
name='sNumErr
next=Icpitembatch.CPVarDecl
len=10
name='rNumErr
next=Icpitembatch.CPVarDecl
len=10
name='uNumNew
next=Icpitembatch.CPVarDecl
len=10
name='uNumMod
next=Icpitembatch.CPVarDecl
len=10
name='nTotErr
next=Icpitembatch.CPVarDecl
len=1
name='_recOK
next=Icpitembatch.CPVarDecl
len=8
name='xData
next=Icpitembatch.CPVarDecl
len=8
name='_datope
next=Icpitembatch.CPVarDecl
len=8
name='_datreg
next=Icpitembatch.CPVarDecl
len=8
name='_datimp
next=Icpitembatch.CPVarDecl
len=8
name='_datnas
next=Icpitembatch.CPVarDecl
len=8
name='_datemi
next=Icpitembatch.CPVarDecl
len=8
name='_datval
next=Icpitembatch.CPVarDecl
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
len=4
name='_codana
next=Icpitembatch.CPVarDecl
len=2
name='_codsin
next=Icpitembatch.CPVarDecl
len=1
name='_segno
next=Icpitembatch.CPVarDecl
len=2
name='_tipope
next=Icpitembatch.CPVarDecl
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
len=10
name='nIntest
next=Icpitembatch.CPVarDecl
len=1
name='_tiporap
next=Icpitembatch.CPVarDecl
len=1
name='_locrap
next=Icpitembatch.CPVarDecl
len=16
name='_codsog
next=Icpitembatch.CPVarDecl
len=1
name='xFLGSAE
next=Icpitembatch.CPVarDecl
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
len=20
name='_ipcol
next=Icpitembatch.CPVarDecl
len=10
name='_drcol
next=Icpitembatch.CPVarDecl
len=14
name='_orcol
next=Icpitembatch.CPVarDecl
len=28
name='_idbiglietto
next=Icpitembatch.CPVarDecl
len=25
name='_rapporto
next=Icpitembatch.CPVarDecl
len=1
name='_env
next=Icpitembatch.CPVarDecl
len=15
name='_importo
next=Icpitembatch.CPVarDecl
len=27
name='_iban
next=Icpitembatch.CPVarDecl
len=1
name='_flgaui
obj='Var
pag=1
prev=O207
I
obj='Var
pag=1
prev=O206
I
obj='Var
obj_type='N
pag=1
prev=O205
I
obj='Var
pag=1
prev=O204
I
obj='Var
pag=1
prev=O203
I
obj='Var
pag=1
prev=O202
I
obj='Var
obj_type='T
pag=1
prev=O201
I
obj='Var
obj_type='N
pag=1
prev=O200
I
obj='Var
pag=1
prev=O199
I
obj='Var
pag=1
prev=O198
I
obj='Var
pag=1
prev=O197
I
obj='Var
pag=1
prev=O196
I
obj='Var
pag=1
prev=O195
I
obj='Var
pag=1
prev=O194
I
obj='Var
obj_type='N
pag=1
prev=O193
I
obj='Var
obj_type='N
pag=1
prev=O192
I
obj='Var
pag=1
prev=O191
I
obj='Var
pag=1
prev=O190
I
obj='Var
pag=1
prev=O189
I
obj='Var
pag=1
prev=O188
I
obj='Var
pag=1
prev=O187
I
obj='Var
pag=1
prev=O186
I
obj='Var
obj_type='M
pag=1
prev=O185
I
obj='Var
obj_type='D
pag=1
prev=O184
I
obj='Var
obj_type='D
pag=1
prev=O183
I
obj='Var
obj_type='D
pag=1
prev=O182
I
obj='Var
obj_type='D
pag=1
prev=O181
I
obj='Var
obj_type='D
pag=1
prev=O180
I
obj='Var
obj_type='D
pag=1
prev=O179
I
obj='Var
pag=1
prev=O178
I
obj='Var
obj_type='N
pag=1
prev=O177
I
obj='Var
obj_type='N
pag=1
prev=O176
I
obj='Var
obj_type='N
pag=1
prev=O175
I
obj='Var
obj_type='N
pag=1
prev=O174
I
obj='Var
obj_type='N
pag=1
prev=O173
I
obj='Var
obj_type='N
pag=1
prev=O172
I
obj='Var
obj_type='N
pag=1
prev=O171
I
obj='Var
obj_type='N
pag=1
prev=O170
I
obj='Var
obj_type='N
pag=1
prev=O169
I
obj='Var
obj_type='N
pag=1
prev=O168
I
obj='Var
obj_type='N
pag=1
prev=O167
I
obj='Var
obj_type='N
pag=1
prev=O166
I
obj='Var
obj_type='N
pag=1
prev=O165
I
obj='Var
obj_type='N
pag=1
prev=O164
I
obj='Var
obj_type='N
pag=1
prev=O163
I
obj='Var
obj_type='N
pag=1
prev=O162
I
obj='Var
obj_type='N
pag=1
prev=O161
I
obj='Var
obj_type='N
pag=1
prev=O160
I
obj='Var
obj_type='N
pag=1
prev=O159
I
obj='Var
obj_type='N
pag=1
prev=O158
I
obj='Var
obj_type='N
pag=1
prev=O157
I
obj='Var
obj_type='N
pag=1
prev=O156
I
obj='Var
obj_type='N
pag=1
prev=O155
I
obj='Var
obj_type='N
pag=1
prev=O154
I
obj='Var
pag=1
prev=O153
I
obj='Var
obj_type='M
pag=1
prev=O152
I
obj='Var
obj_type='N
pag=1
prev=O151
I
obj='Var
pag=1
prev=O150
I
obj='Var
pag=1
prev=O149
I
obj='Var
obj_type='N
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O3
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O5
fatherSonIndex=0
len=10
name='ciidbase
next=Icpitembatch.CPVarDecl
len=8
name='cidataini
next=Icpitembatch.CPVarDecl
len=8
name='cidatafine
next=Icpitembatch.CPVarDecl
len=12
name='cicodinter
next=Icpitembatch.CPVarDecl
len=11
name='cinumprog
next=Icpitembatch.CPVarDecl
len=1
name='citiporap
obj='Var
pag=1
prev=O216
I
obj='Var
pag=1
prev=O215
I
obj='Var
pag=1
prev=O214
I
obj='Var
obj_type='D
pag=1
prev=O213
I
obj='Var
obj_type='D
pag=1
prev=O212
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3
fatherSonIndex=0
len=1
name='fhand
next=Icpitembatch.CPVarDecl
len=10
name='riga
next=Icpitembatch.CPVarDecl
len=1
name='_tdest
next=Icpitembatch.CPVarDecl
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
len=16
name='xCF
next=Icpitembatch.CPVarDecl
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
comment='Anno Di Nascita
len=2
name='xAnnNas
next=Icpitembatch.CPVarDecl
comment='Mese Di Nascita
len=2
name='xMesNas
next=Icpitembatch.CPVarDecl
comment='Giorno Di Nascita
len=2
name='xDayNas
next=Icpitembatch.CPVarDecl
len=1
name='xSesso
next=Icpitembatch.CPVarDecl
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
len=2
name='cPNAS
next=Icpitembatch.CPVarDecl
len=8
name='cDNAS
next=Icpitembatch.CPVarDecl
len=16
name='xSOCTCon
next=Icpitembatch.CPVarDecl
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
len=30
name='xCitta
next=Icpitembatch.CPVarDecl
len=6
name='cCliProg
next=Icpitembatch.CPVarDecl
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
len=1
name='xSesso
next=Icpitembatch.CPVarDecl
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
len=6
name='xCAB
next=Icpitembatch.CPVarDecl
len=6
name='xDIP
next=Icpitembatch.CPVarDecl
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
len=8
name='xData
next=Icpitembatch.CPVarDecl
len=8
name='xDatF
next=Icpitembatch.CPVarDecl
comment='Contatore record nuovi
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
comment='Contatore record nuovi
len=10
name='rNumNew
next=Icpitembatch.CPVarDecl
comment='Contatore record aggiornati
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
comment='Contatore record aggiornati
len=10
name='rNumMod
next=Icpitembatch.CPVarDecl
comment='Contatore record invariati
len=10
name='cNumInv
next=Icpitembatch.CPVarDecl
len=1
name='cFlagLire
next=Icpitembatch.CPVarDecl
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
len=1
name='xCFE
next=Icpitembatch.CPVarDecl
len=10
name='conta
next=Icpitembatch.CPVarDecl
len=1
name='_esito
next=Icpitembatch.CPVarDecl
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
len=10
name='_ucode
next=Icpitembatch.CPVarDecl
len=1
name='_salta
next=Icpitembatch.CPVarDecl
len=1
name='_allineamento
next=Icpitembatch.CPVarDecl
len=1
name='_allineatonomecnome
next=Icpitembatch.CPVarDecl
len=70
name='_ragsocold
next=Icpitembatch.CPVarDecl
len=6
name='_cabold
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
len=10
name='_idbase
next=Icpitembatch.CPVarDecl
len=2
name='_tipinter
next=Icpitembatch.CPVarDecl
len=11
name='_codinter
next=Icpitembatch.CPVarDecl
len=30
name='_citinter
next=Icpitembatch.CPVarDecl
len=6
name='_cabinter
next=Icpitembatch.CPVarDecl
len=2
name='_prvinter
next=Icpitembatch.CPVarDecl
len=2
name='_intertip
next=Icpitembatch.CPVarDecl
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
len=2
name='_interprv
next=Icpitembatch.CPVarDecl
len=70
name='xRagSoc
next=Icpitembatch.CPVarDecl
len=2
name='NSpazzi
next=Icpitembatch.CPVarDecl
len=2
name='NSpazzi2
next=Icpitembatch.CPVarDecl
len=25
name='xNome
next=Icpitembatch.CPVarDecl
len=26
name='xCognome
next=Icpitembatch.CPVarDecl
len=1
name='_allcn
next=Icpitembatch.CPVarDecl
len=2
name='Allineamento
next=Icpitembatch.CPVarDecl
len=70
name='SubRag
next=Icpitembatch.CPVarDecl
len=10
name='_i
next=Icpitembatch.CPVarDecl
len=103
name='Controllo
next=Icpitembatch.CPVarDecl
len=3
name='cSetSin
next=Icpitembatch.CPVarDecl
len=2
name='_tsogope
next=Icpitembatch.CPVarDecl
len=2
name='_rigsog
next=Icpitembatch.CPVarDecl
len=2
name='_rigint
next=Icpitembatch.CPVarDecl
len=10
name='cInfApri1
next=Icpitembatch.CPVarDecl
len=11
name='cInfApri2
next=Icpitembatch.CPVarDecl
len=10
name='cInfChiu1
next=Icpitembatch.CPVarDecl
len=11
name='cInfChiu2
next=Icpitembatch.CPVarDecl
len=1
name='_newop
next=Icpitembatch.CPVarDecl
len=10
name='_nprog
next=Icpitembatch.CPVarDecl
comment='Operazione Modificata
len=20
name='_operazmod
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
len=10
name='cNewProg
next=Icpitembatch.CPVarDecl
len=10
name='numriga
next=Icpitembatch.CPVarDecl
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
len=1
name='chkat
next=Icpitembatch.CPVarDecl
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
len=35
name='_benind
next=Icpitembatch.CPVarDecl
len=5
name='_bencap
next=Icpitembatch.CPVarDecl
len=11
name='abicab
next=Icpitembatch.CPVarDecl
len=1
name='_flgvnp
next=Icpitembatch.CPVarDecl
len=1
name='_flgvlt
next=Icpitembatch.CPVarDecl
len=15
name='cProgImp
next=Icpitembatch.CPVarDecl
len=5
name='_intest
next=Icpitembatch.CPVarDecl
len=1
name='_stoper
next=Icpitembatch.CPVarDecl
len=28
name='_biglietto
next=Icpitembatch.CPVarDecl
len=25
name='_numass
next=Icpitembatch.CPVarDecl
len=15
name='_oldmodi
obj='Var
pag=1
prev=O332
I
obj='Var
pag=1
prev=O331
I
obj='Var
pag=1
prev=O330
I
obj='Var
obj_type='N
pag=1
prev=O329
I
obj='Var
obj_type='N
pag=1
prev=O328
I
obj='Var
pag=1
prev=O327
I
obj='Var
pag=1
prev=O326
I
obj='Var
pag=1
prev=O325
I
obj='Var
pag=1
prev=O324
I
obj='Var
pag=1
prev=O323
I
obj='Var
pag=1
prev=O322
I
obj='Var
pag=1
prev=O321
I
obj='Var
pag=1
prev=O320
I
obj='Var
pag=1
prev=O319
I
obj='Var
pag=1
prev=O318
I
obj='Var
pag=1
prev=O317
I
obj='Var
obj_type='N
pag=1
prev=O316
I
obj='Var
pag=1
prev=O315
I
obj='Var
obj_type='N
pag=1
prev=O314
I
obj='Var
pag=1
prev=O313
I
obj='Var
pag=1
prev=O312
I
obj='Var
pag=1
prev=O311
I
obj='Var
pag=1
prev=O310
I
obj='Var
pag=1
prev=O309
I
obj='Var
pag=1
prev=O308
I
obj='Var
obj_type='N
pag=1
prev=O307
I
obj='Var
pag=1
prev=O306
I
obj='Var
pag=1
prev=O305
I
obj='Var
pag=1
prev=O304
I
obj='Var
pag=1
prev=O303
I
obj='Var
obj_type='N
pag=1
prev=O302
I
obj='Var
obj_type='N
pag=1
prev=O301
I
obj='Var
pag=1
prev=O300
I
obj='Var
pag=1
prev=O299
I
obj='Var
pag=1
prev=O298
I
obj='Var
obj_type='N
pag=1
prev=O297
I
obj='Var
pag=1
prev=O296
I
obj='Var
pag=1
prev=O295
I
obj='Var
obj_type='N
pag=1
prev=O294
I
obj='Var
pag=1
prev=O293
I
obj='Var
pag=1
prev=O292
I
obj='Var
obj_type='N
pag=1
prev=O291
I
obj='Var
obj_type='N
pag=1
prev=O290
I
obj='Var
pag=1
prev=O289
I
obj='Var
pag=1
prev=O288
I
obj='Var
pag=1
prev=O287
I
obj='Var
pag=1
prev=O286
I
obj='Var
pag=1
prev=O285
I
obj='Var
pag=1
prev=O284
I
obj='Var
pag=1
prev=O283
I
obj='Var
pag=1
prev=O282
I
obj='Var
pag=1
prev=O281
I
obj='Var
pag=1
prev=O280
I
obj='Var
pag=1
prev=O279
I
obj='Var
pag=1
prev=O278
I
obj='Var
pag=1
prev=O277
I
obj='Var
obj_type='N
pag=1
prev=O276
I
obj='Var
obj_type='N
pag=1
prev=O275
I
obj='Var
pag=1
prev=O274
I
obj='Var
pag=1
prev=O273
I
obj='Var
obj_type='N
pag=1
prev=O272
I
obj='Var
obj_type='N
pag=1
prev=O271
I
obj='Var
obj_type='N
pag=1
prev=O270
I
obj='Var
pag=1
prev=O269
I
obj='Var
pag=1
prev=O268
I
obj='Var
obj_type='N
pag=1
prev=O267
I
obj='Var
obj_type='N
pag=1
prev=O266
I
obj='Var
obj_type='N
pag=1
prev=O265
I
obj='Var
pag=1
prev=O264
I
obj='Var
obj_type='N
pag=1
prev=O263
I
obj='Var
pag=1
prev=O262
I
obj='Var
pag=1
prev=O261
I
obj='Var
pag=1
prev=O260
I
obj='Var
obj_type='N
pag=1
prev=O259
I
obj='Var
obj_type='N
pag=1
prev=O258
I
obj='Var
obj_type='N
pag=1
prev=O257
I
obj='Var
obj_type='N
pag=1
prev=O256
I
obj='Var
obj_type='N
pag=1
prev=O255
I
obj='Var
pag=1
prev=O254
I
obj='Var
pag=1
prev=O253
I
obj='Var
pag=1
prev=O252
I
obj='Var
pag=1
prev=O251
I
obj='Var
pag=1
prev=O250
I
obj='Var
pag=1
prev=O249
I
obj='Var
pag=1
prev=O248
I
obj='Var
pag=1
prev=O247
I
obj='Var
pag=1
prev=O246
I
obj='Var
pag=1
prev=O245
I
obj='Var
pag=1
prev=O244
I
obj='Var
pag=1
prev=O243
I
obj='Var
pag=1
prev=O242
I
obj='Var
pag=1
prev=O241
I
obj='Var
pag=1
prev=O240
I
obj='Var
pag=1
prev=O239
I
obj='Var
pag=1
prev=O238
I
obj='Var
pag=1
prev=O237
I
obj='Var
obj_type='D
pag=1
prev=O236
I
obj='Var
pag=1
prev=O235
I
obj='Var
pag=1
prev=O234
I
obj='Var
pag=1
prev=O233
I
obj='Var
pag=1
prev=O232
I
obj='Var
pag=1
prev=O231
I
obj='Var
pag=1
prev=O230
I
obj='Var
pag=1
prev=O229
I
obj='Var
obj_type='M
pag=1
prev=O228
I
obj='Var
obj_type='M
pag=1
prev=O227
I
obj='Var
obj_type='M
pag=1
prev=O226
I
obj='Var
obj_type='M
pag=1
prev=O225
I
obj='Var
pag=1
prev=O224
I
obj='Var
pag=1
prev=O223
I
obj='Var
pag=1
prev=O222
I
obj='Var
obj_type='M
pag=1
prev=O221
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
x=11
y=16
I
Icpitembatch.CPRemark
frm_calc='Import Dipendenze
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_totale
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_totale > 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O338
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O340
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc=''Dipendenze Inserite: '+LRTrim(Str(dNumNew,10,0)) + ' - Dipendenze Aggiornate: '+LRTrim(Str(dNumMod,10,0)) + NL
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGLOG\'"+LRTrim(_gAzienda)+"'",'',20)
len=20
name='cProg
next=Icpitembatch.CPInsert
arch='log_app
next=Icpitembatch.CPIfElse
frm_calc=[
'oNumErr > 0
]
h=[
19
19
]
obj='If
pag=2
prev=O349
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O350
fatherSonIndex=0
frm_calc=''Dipendenze Scartate: '+LRTrim(Str(dNumErr,10,0)) + NL
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGLOG\'"+LRTrim(_gAzienda)+"'",'',20)
len=20
name='cProg
next=Icpitembatch.CPInsert
arch='log_app
obj='Insert
pag=2
prev=O356
rd_kfield=[
'LOGCODICE
'LOGDATORA
'LOGUTENTE
'LOGTIPOPE
'LOGTESTO
'LOGTABELLA
'LOGCHIAVE
'LOGTYPE
]
rd_kvar=[
'cProg
'DateTime()
'1
''Import Dati'
'_gMsgProc
''ANADIP'
''Scartati '+LRTrim(Str(dNumErr,10,0))
''S'
]
I
obj='Var
pag=2
prev=O355
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=2
prev=O348
rd_kfield=[
'LOGCODICE
'LOGDATORA
'LOGUTENTE
'LOGTIPOPE
'LOGTESTO
'LOGTABELLA
'LOGCHIAVE
'LOGTYPE
]
rd_kvar=[
'cProg
'DateTime()
'1
''Import Dati'
'_gMsgProc
''ANADIP'
''Inseriti / Aggiornati '+LRTrim(Str(dNumNew+dNumMod,10,0))
''S'
]
I
obj='Var
pag=2
prev=O347
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O345
var_op='asgn
I
obj='Select
pag=2
sel_field='*
sel_name='cgo_anadip
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O345
fatherSonIndex=0
frm_calc='''
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_recOK
next=Icpitembatch.CPIfElse
frm_calc=[
'_snaistor='N'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_recOK=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPDelete
arch='cgo_anadip
next=Icpitembatch.CPVarDecl
frm_calc='_conta + 1
len=10
name='_conta
obj='Var
obj_type='N
pag=2
prev=O373
var_op='asgn
I
obj='Delete
pag=2
prev=O370
rd_kfield=[
'CODDIP
]
rd_kop=[
'=
]
rd_kvar=[
'cgo_anadip->CODDIP
]
I
obj='If
pag=2
prev=O367
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O370
fatherSonIndex=0
frm_calc='cgo_anadip->CODDIP
len=6
name='xDIP
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
frm_calc='cgo_anadip->CAB
len=6
name='xCodCab
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCodCab))
]
h=[
19
19
]
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDIPx))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O386
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPInsert
arch='anadip
father=O387
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='dNumNew + 1
len=10
name='dNumNew
obj='Var
obj_type='N
pag=2
prev=O392
var_op='asgn
I
obj='Insert
pag=2
rd_kfield=[
'CODDIP
'DESCRIZ
'DESCCIT
'PROVINCIA
'CAB
'IDBASE
'DOMICILIO
'TELEFONO
'CODLOC
]
rd_kvar=[
'xDIP
'cgo_anadip->DESCRIZ
'cgo_anadip->DESCCIT
'cgo_anadip->PROVINCIA
'xCodCab
'cgo_anadip->IDBASE
'cgo_anadip->DOMICILIO
'cgo_anadip->TELEFONO
'cgo_anadip->CODLOC
]
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='anadip
father=O387
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='dNumMod + 1
len=10
name='dNumMod
obj='Var
obj_type='N
pag=2
prev=O397
var_op='asgn
I
obj='Write
pag=2
rd_kfield=[
'CODDIP
]
rd_kop=[
'=
]
rd_kvar=[
'xDIP
]
wr_field=[
'DESCRIZ
'DESCCIT
'PROVINCIA
'CAB
'IDBASE
'DOMICILIO
'TELEFONO
'CODLOC
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'cgo_anadip->DESCRIZ
'cgo_anadip->DESCCIT
'cgo_anadip->PROVINCIA
'xCodCab
'cgo_anadip->IDBASE
'cgo_anadip->DOMICILIO
'cgo_anadip->TELEFONO
'cgo_anadip->CODLOC
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O383
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'xDIP
]
rd_var=[
'xDIPx
]
I
obj='If
pag=2
prev=O382
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O383
fatherSonIndex=0
frm_calc='cgo_anadip->DESCCIT
len=30
name='xCitta
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=2
prev=O412
sel_field='*
sel_name='tbcitta
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O413
fatherSonIndex=0
frm_calc=[
'LRTrim(Left(tbcitta->CITTA,30))=Upper(LRTrim(xCitta)) and tbcitta->PROV=cgo_anadip->PROVINCIA
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O417
fatherSonIndex=0
frm_calc='tbcitta->CAB
len=6
name='xCodCab
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O422
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O381
var_op='asgn
I
obj='Var
pag=2
prev=O380
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O370
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGDIPERR\'"+LRTrim(_gAzienda)+"'","",15)
len=15
name='ProgErr
next=Icpitembatch.CPInsert
arch='cgo_anadip_err
next=Icpitembatch.CPVarDecl
frm_calc='dNumErr + 1
len=10
name='dNumErr
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=2
prev=O430
sel_field='*
sel_name='cgo_telematico
sel_where='cgo_telematico->CODDIPE=cgo_anadip->CODDIP
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cgo_telematico_err
father=O431
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='oNumErr + 1
len=10
name='oNumErr
next=Icpitembatch.CPDelete
arch='cgo_telematico
obj='Delete
pag=2
prev=O436
rd_kfield=[
'SNAINUMOPE
]
rd_kop=[
'=
]
rd_kvar=[
'cgo_telematico->SNAINUMOPE
]
I
obj='Var
obj_type='N
pag=2
prev=O435
var_op='asgn
I
obj='Insert
pag=2
rd_kfield=[
'SNAINUMOPE
'ENV
'CODDIPE
'RAPPORTO
'TOTLIRE
'CACODICE
'CADATAORA
'CAIDBIGLIETTO
'CSMF_COD
'NUM_CONC
'P_VEND
'IPCOLLEG
'ORACOLLEG
'DUCOLLEG
'IBAN
'TXTERR
'FLGFULL
'MEZPAGAM
'TIPOGIOCO
'CODLOB
'CATIPGIO
'CATIPCON
'CAPV_COD
]
rd_kvar=[
'cgo_telematico->SNAINUMOPE
'cgo_telematico->ENV
'cgo_telematico->CODDIPE
'cgo_telematico->RAPPORTO
'cgo_telematico->TOTLIRE
'cgo_telematico->CACODICE
'cgo_telematico->CADATAORA
'cgo_telematico->CAIDBIGLIETTO
'cgo_telematico->CSMF_COD
'cgo_telematico->NUM_CONC
'cgo_telematico->P_VEND
'cgo_telematico->IPCOLLEG
'cgo_telematico->ORACOLLEG
'cgo_telematico->DUCOLLEG
'cgo_telematico->IBAN
'_txterr
''N'
'cgo_telematico->MEZPAGAM
'cgo_telematico->TIPOGIOCO
'cgo_telematico->CODLOB
'cgo_telematico->CATIPGIO
'cgo_telematico->CATIPCON
'cgo_telematico->CAPV_COD
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O429
var_op='asgn
I
obj='Insert
pag=2
prev=O428
rd_kfield=[
'PRGDIP
'CODDIP
'DESCRIZ
'DESCCIT
'PROVINCIA
'CAB
'IDBASE
'TXTERR
'FLGFULL
'CODLOC
]
rd_kvar=[
'ProgErr
'cgo_anadip->CODDIP
'cgo_anadip->DESCRIZ
'cgo_anadip->DESCCIT
'cgo_anadip->PROVINCIA
'cgo_anadip->CAB
'cgo_anadip->IDBASE
'_txterr
''N'
'cgo_anadip->CODLOC
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
prev=O366
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Controllo su dipendenze
father=O367
fatherSonIndex=0
h=[
19
19
]
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O449
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(cgo_anadip->CODDIP))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cgo_anadip->CAB)) and Empty(LRTrim(cgo_anadip->DESCCIT))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cgo_anadip->IDBASE))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cgo_anadip->CODLOC))
]
h=[
19
19
]
obj='If
pag=2
prev=O459
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O462
fatherSonIndex=0
frm_calc='_txterr + 'Manca il codice locale' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=2
prev=O467
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O456
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O459
fatherSonIndex=0
frm_calc='_txterr + 'Manca il riferimento interno della dipendenza' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=2
prev=O472
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O453
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O456
fatherSonIndex=0
frm_calc='_txterr + 'Mancano il CAB o la città della dipendenza' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=2
prev=O477
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O453
fatherSonIndex=0
frm_calc='_txterr + 'Manca il codice della dipendenza' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=2
prev=O482
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O365
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O340
fatherSonIndex=1
frm_calc='"Nessuna Dipendenza Inserita, Aggiornata o Scartata"
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGLOG\'"+LRTrim(_gAzienda)+"'",'',20)
len=20
name='cProg
next=Icpitembatch.CPInsert
arch='log_app
obj='Insert
pag=2
prev=O490
rd_kfield=[
'LOGCODICE
'LOGDATORA
'LOGUTENTE
'LOGTIPOPE
'LOGTESTO
'LOGTABELLA
'LOGCHIAVE
'LOGTYPE
]
rd_kvar=[
'cProg
'DateTime()
'1
''Import Dati'
'_gMsgProc
''ANADIP'
''NO RECORDS'
''S'
]
I
obj='Var
pag=2
prev=O489
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=2
prev=O337
sel_name='qbe_cgo_anadip_totali
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O338
fatherSonIndex=0
frm_calc='qbe_cgo_anadip_totali->TOTDIP
len=10
name='_totale
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O336
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O335
var_op='asgn
I
obj='Remark
pag=2
x=20
y=21
I
Icpitembatch.CPRemark
frm_calc='Soggetti
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_totale
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_totale > 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O502
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O504
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc=''Soggetti Inseriti: '+LRTrim(Str(sNumNew,10,0)) + ' - Soggetti Aggiornati: '+LRTrim(Str(sNumMod,10,0)) + NL
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGLOG\'"+LRTrim(_gAzienda)+"'",'',20)
len=20
name='cProg
next=Icpitembatch.CPInsert
arch='log_app
next=Icpitembatch.CPIfElse
frm_calc=[
'sNumErr > 0
]
h=[
19
19
]
obj='If
pag=3
prev=O513
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O514
fatherSonIndex=0
frm_calc=''Soggetti Scartati: '+LRTrim(Str(sNumErr,10,0)) + NL
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGLOG\'"+LRTrim(_gAzienda)+"'",'',20)
len=20
name='cProg
next=Icpitembatch.CPInsert
arch='log_app
obj='Insert
pag=3
prev=O520
rd_kfield=[
'LOGCODICE
'LOGDATORA
'LOGUTENTE
'LOGTIPOPE
'LOGTESTO
'LOGTABELLA
'LOGCHIAVE
'LOGTYPE
]
rd_kvar=[
'cProg
'DateTime()
'1
''Import Dati'
'_gMsgProc
''PERSONBO'
''Scartati '+LRTrim(Str(sNumErr,10,0))
''S'
]
I
obj='Var
pag=3
prev=O519
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=3
prev=O512
rd_kfield=[
'LOGCODICE
'LOGDATORA
'LOGUTENTE
'LOGTIPOPE
'LOGTESTO
'LOGTABELLA
'LOGCHIAVE
'LOGTYPE
]
rd_kvar=[
'cProg
'DateTime()
'1
''Import Dati'
'_gMsgProc
''PERSONBO'
''Inseriti / Aggiornati '+LRTrim(Str(sNumNew+sNumMod,10,0))
''S'
]
I
obj='Var
pag=3
prev=O511
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O509
var_op='asgn
I
obj='Select
pag=3
sel_field='*
sel_name='cgo_soggetti
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Azzeramento Variabili
father=O509
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='numriga + 1
len=10
name='numriga
next=Icpitembatch.CPVarDecl
frm_calc='cgo_soggetti->CONNES
len=16
name='_codsog
next=Icpitembatch.CPIfElse
frm_calc=[
'_snaistor='N'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_recOK=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPDelete
arch='cgo_soggetti
obj='Delete
pag=3
prev=O537
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'cgo_soggetti->CONNES
]
I
obj='If
pag=3
prev=O534
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O537
fatherSonIndex=0
frm_calc='''
len=3
name='cSetSin
next=Icpitembatch.CPBeginEnd
comment='Ricava i dati dalla riga di archpers
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifica l'esistenza della persona
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xConnes
next=Icpitembatch.CPRemark
frm_calc='Crea la riga di confronto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(xConnes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O555
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O556
fatherSonIndex=0
frm_calc=[
'Upper(LRTrim(xRiga1)+LRTrim(xRiga3)) <> Upper(LRTrim(xRiga2)+LRTrim(xRiga4))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Verifica se i rapporti sono in provvisorio o in definitivo
father=O561
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Storicizza le modifiche e crea record 31 e 32
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='personbo
frm_calc='Errore in aggiornamento ARCHPERS
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='sNumMod + 1
len=10
name='sNumMod
obj='Var
obj_type='N
pag=3
prev=O570
var_op='asgn
I
obj='Write
pag=3
prev=O568
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'xConnes
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O570
fatherSonIndex=0
frm_calc='_gMsgProc +"Rilevati errori nel file per il soggetto: "+LRTrim(xRagSoc)+" con codice: "+LRTrim(cgo_soggetti->CONNES)+". Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O579
I
obj='Var
obj_type='N
pag=3
prev=O578
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'SESSO
'DATAVALI
'COGNOME
'NOME
'TIPINTER
'CFESTERO
'NASSTATO
'PEP
'TIPOPERS
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xCodCab
'Left(xRagSoc,70)
'Left(cgo_soggetti->DOMICILIO,35)
'cgo_soggetti->CONNES
'cDNAS
'Left(cCNAS,30)
''600'
'''
''600'
'cgo_soggetti->TIPODOC
'Left(cgo_soggetti->NUMDOCUM,15)
'_datemi
'cgo_soggetti->AUTRILASC
'Left(cgo_soggetti->DESCCIT,30)
'cgo_soggetti->PROVINCIA
'cgo_soggetti->PAESE
'cgo_soggetti->CAP
'xSesso
'_datval
'xCognome
'xNome
'cPNAS
'xCFE
'Left(cSNAS,30)
'iif(Empty(cgo_soggetti->PEP),'N',cgo_soggetti->PEP)
''P'
]
I
obj='Begin
pag=3
prev=O566
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O568
fatherSonIndex=0
frm_calc=[
'_stoper=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Upper(LRTrim(xRiga1)) <> Upper(LRTrim(xRiga2))
]
h=[
19
19
]
obj='If
pag=3
prev=O587
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O590
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=3
sel_field='intestbo->RAPPORTO,intestbo->DATAFINE,intestbo->DATAINI
sel_name='intestbo
sel_where='intestbo->CODINTER=cCli1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O595
fatherSonIndex=0
frm_calc=[
'Empty(intestbo->DATAFINE)
]
h=[
19
19
]
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O599
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc=''I'+cInfProg2
len=12
name='cColleg
next=Icpitembatch.CPInsert
arch='rapopebo
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='rapopebo
obj='Insert
pag=3
prev=O611
rd_kfield=[
'CDATOPE
'CODCAB
'CODINTER
'DATAOPE
'DATAREG
'DESCCIT
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'VALUTA
'CDATREG
'COLLEG
]
rd_kvar=[
'DateToChar(Date())
'_cabinter
'_codinter
'Date()
'Date()
'_citinter
''3'
''0'
'cInfProg1
'DateToChar(Date())+cInfProg1+'0'
'cInfProg2
''2'
'nProgImp
'_prvinter
'intestbo->RAPPORTO
''0'
''1'
'_tipinter
''0'
''32'
''242'
'DateToChar(Date())
'cColleg
]
I
obj='Var
obj_type='N
pag=3
prev=O610
var_op='asgn
I
obj='Var
pag=3
prev=O609
var_op='asgn
I
obj='Var
pag=3
prev=O608
var_op='asgn
I
obj='Insert
pag=3
prev=O607
rd_kfield=[
'CDATOPE
'CODCAB
'CODINTER
'DATAOPE
'DATAREG
'DESCCIT
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'VALUTA
'CDATREG
'COLLEG
]
rd_kvar=[
'DateToChar(Date())
'_cabinter
'_codinter
'Date()
'Date()
'_citinter
''3'
''0'
'cInfProg1
'DateToChar(Date())+cInfProg1+'0'
'cInfProg2
''2'
'nProgImp
'_prvinter
'intestbo->RAPPORTO
''0'
''1'
'_tipinter
''0'
''31'
''242'
'DateToChar(Date())
'cColleg
]
I
obj='Var
pag=3
prev=O606
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O605
var_op='asgn
I
obj='Var
pag=3
prev=O604
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O587
fatherSonIndex=0
frm_calc='''
len=15
name='_oldmodi
next=Icpitembatch.CPRead
arch='wersonbo
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_allcn
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_oldmodi))
]
h=[
19
19
]
obj='If
pag=3
prev=O624
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O625
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(_gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=3
prev=O630
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=cCli1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O631
fatherSonIndex=0
h=[
19
19
]
obj='Insert
pag=3
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'datamodi
]
rd_kvar=[
'cProgSto
'personbo->CONNES
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'Date()
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O635
fatherSonIndex=0
frm_calc='_gMsgProc +"Rilevati errori nel file per il soggetto: "+LRTrim(xRagSoc)+" con codice: "+LRTrim(cgo_soggetti->CONNES)+". Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O642
I
obj='Var
obj_type='N
pag=3
prev=O641
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O623
var_op='asgn
I
obj='Read
pag=3
prev=O622
rd_field=[
'sanumpro
]
rd_kfield=[
'CONNES
'datamodi
]
rd_kvar=[
'cCli1
'Date()
]
rd_var=[
'_oldmodi
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O566
fatherSonIndex=0
frm_calc='0
len=5
name='_intest
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_stoper
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_intest=0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O657
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O659
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=3
sel_field='operazbo->IDBASE
sel_name='operazbo
sel_where='operazbo->CONNESCLI=cCli1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O664
fatherSonIndex=0
frm_calc='1
len=1
name='_stoper
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O659
fatherSonIndex=1
frm_calc='1
len=1
name='_stoper
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=3
prev=O656
sel_field='intestbo->RAPPORTO,intestbo->DATAFINE,intestbo->DATAINI
sel_name='intestbo
sel_where='intestbo->CODINTER=cCli1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O657
fatherSonIndex=0
frm_calc=[
'Empty(intestbo->DATAFINE)
]
h=[
19
19
]
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O675
fatherSonIndex=0
frm_calc='_intest + 1
len=5
name='_intest
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O655
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore record invariati
father=O561
fatherSonIndex=1
frm_calc='sNumInv + 1
len=10
name='sNumInv
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O556
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGIMPOCLI\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='personbo
frm_calc='Errore in inserimento ARCHPERS
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='sNumNew + 1
len=10
name='sNumNew
obj='Var
obj_type='N
pag=3
prev=O689
var_op='asgn
I
obj='Insert
pag=3
prev=O688
rd_kfield=[
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'CONNES
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOMICILIO
'NASCOMUN
'NASSTATO
'NOME
'NUMDOCUM
'PAESE
'PEP
'PROGIMPORT
'PROVINCIA
'RAGSOC
'RAMOGRUP
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'TIPOPERS
]
rd_kvar=[
'Left(cgo_soggetti->AUTRILASC,30)
'Left(cgo_soggetti->CAP,9)
'xCFE
'xCodCab
'xCF
'xCognome
'cCli1
'cDNAS
'_datemi
'_datval
'Left(cgo_soggetti->DESCCIT,30)
'Left(cgo_soggetti->DOMICILIO,35)
'Left(cCNAS,30)
'Left(cSNAS,30)
'xNome
'Left(cgo_soggetti->NUMDOCUM,15)
'Left(cgo_soggetti->PAESE,3)
'iif(Empty(cgo_soggetti->PEP),'N',cgo_soggetti->PEP)
'nProgImp
'Left(cgo_soggetti->PROVINCIA,2)
'Left(xRagSoc,70)
'''
'xSesso
''600'
''600'
'cPNAS
'Left(cgo_soggetti->TIPODOC,2)
''P'
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O689
fatherSonIndex=0
frm_calc='_gMsgProc +"Rilevati errori nel file per il soggetto: "+LRTrim(xRagSoc)+" con codice: "+LRTrim(cgo_soggetti->CONNES)+". Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O697
I
obj='Var
obj_type='N
pag=3
prev=O696
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=3
prev=O554
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O552
var_op='asgn
I
obj='Select
pag=3
prev=O551
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=cCli1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O552
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad(personbo->CODFISC,16)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->RAGSOC,70)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->DOMICILIO,35)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->DESCCIT,30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->PROVINCIA,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(LRTrim(personbo->CAP),5)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->PAESE,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->SOTGRUP,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->RAMOGRUP,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->SETTSINT,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(Left(personbo->NASCOMUN,30),30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->TIPINTER,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(Left(personbo->NASSTATO,30),30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + iif(DateToChar(personbo->DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATANASC),8),Space(8))
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->TIPODOC,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->NUMDOCUM,15)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + iif(DateToChar(personbo->DATARILASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATARILASC),8),Space(8))
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->AUTRILASC,30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='iif(DateToChar(personbo->DATAVALI) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATAVALI),8),Space(8))
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 +LibreriaMit.SpacePad(Str(personbo->CFESTERO,1,0),30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='personbo->CONNES
len=16
name='xConnes
obj='Var
pag=3
prev=O722
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O721
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O720
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O719
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O718
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O717
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O716
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O715
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O714
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O713
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O712
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O711
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O710
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O709
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O708
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O707
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O706
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O705
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O704
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O703
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=3
prev=O550
I
obj='Var
pag=3
prev=O549
var_op='asgn
I
obj='Remark
pag=3
prev=O547
I
obj='Begin
pag=3
prev=O546
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O547
fatherSonIndex=0
frm_calc='''
len=1
name='xFLGSAE
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPVarDecl
frm_calc='cgo_soggetti->DATANASC
len=8
name='_datnas
next=Icpitembatch.CPVarDecl
frm_calc='cgo_soggetti->DATARILASC
len=8
name='_datemi
next=Icpitembatch.CPVarDecl
frm_calc='cgo_soggetti->DATAVALI
len=8
name='_datval
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(cgo_soggetti->COGNOME)+" "+ LRTrim(cgo_soggetti->NOME)
len=70
name='xRagSoc
next=Icpitembatch.CPVarDecl
frm_calc='cgo_soggetti->NOME
len=25
name='xNome
next=Icpitembatch.CPVarDecl
frm_calc='cgo_soggetti->COGNOME
len=26
name='xCognome
next=Icpitembatch.CPVarDecl
frm_calc='cgo_soggetti->CONNES
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='cgo_soggetti->CONNES
len=16
name='xCF
next=Icpitembatch.CPVarDecl
frm_calc='cgo_soggetti->CFESTERO
len=1
name='xCFE
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCodCab))
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Se persona fisica ricava i dati di nascita
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.SpacePad(xCF,16)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad(xRagSoc,70)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad(cgo_soggetti->DOMICILIO,35)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad(cgo_soggetti->DESCCIT,30)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad(cgo_soggetti->PROVINCIA,2)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad(LRTrim(cgo_soggetti->CAP),5)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad(cgo_soggetti->PAESE,3)
len=10
name='xRiga1
next=Icpitembatch.CPIfElse
frm_calc=[
'cgo_soggetti->CFESTERO=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad(Left(cCNAS,30),30)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad(cPNAS,2)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad(Left(cSNAS,30),30)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + iif(DateToChar(_datnas) <> '01000101',LibreriaMit.SpacePad(DateToChar(_datnas),8),Space(8))
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 +LibreriaMit.SpacePad(cgo_soggetti->TIPODOC,2)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 +LibreriaMit.SpacePad(cgo_soggetti->NUMDOCUM,15)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + iif(DateToChar(_datemi) <> '01000101',LibreriaMit.SpacePad(DateToChar(_datemi),8),Space(8))
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 +LibreriaMit.SpacePad(cgo_soggetti->AUTRILASC,30)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='iif(DateToChar(_datval) <> '01000101',LibreriaMit.SpacePad(DateToChar(_datval),8),Space(8))
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='xRiga3 +LibreriaMit.SpacePad(Str(cgo_soggetti->CFESTERO,1,0),30)
len=10
name='xRiga3
obj='Var
obj_type='M
pag=3
prev=O761
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O760
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O759
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O758
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O757
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O756
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O755
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O754
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O753
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O750
var_op='asgn
I
obj='If
pag=3
prev=O749
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O750
fatherSonIndex=0
frm_calc='xRiga1 + LibreriaMit.SpacePad('600',3)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad('   ',3)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad('600',3)
len=10
name='xRiga1
obj='Var
obj_type='M
pag=3
pagelocal=True
prev=O766
var_op='asgn
I
obj='Var
obj_type='M
pag=3
pagelocal=True
prev=O765
var_op='asgn
I
obj='Var
obj_type='M
pag=3
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O750
fatherSonIndex=1
frm_calc='xRiga1 + LibreriaMit.SpacePad('77'+xFLGSAE,3)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad('   ',3)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad('711',3)
len=10
name='xRiga1
obj='Var
obj_type='M
pag=3
pagelocal=True
prev=O770
var_op='asgn
I
obj='Var
obj_type='M
pag=3
pagelocal=True
prev=O769
var_op='asgn
I
obj='Var
obj_type='M
pag=3
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='M
pag=3
prev=O748
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O747
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O746
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O745
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O744
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O743
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O741
var_op='asgn
I
obj='Begin
pag=3
prev=O738
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Anno Di Nascita
father=O741
fatherSonIndex=0
frm_calc='Substr(DateToChar(cgo_soggetti->DATANASC),1,4)
len=2
name='xAnnNas
next=Icpitembatch.CPVarDecl
comment='Mese Di Nascita
frm_calc='Substr(DateToChar(cgo_soggetti->DATANASC),5,2)
len=2
name='xMesNas
next=Icpitembatch.CPVarDecl
comment='Giorno Di Nascita
frm_calc='Substr(DateToChar(cgo_soggetti->DATANASC),7,2)
len=2
name='xDayNas
next=Icpitembatch.CPVarDecl
frm_calc='_datnas
len=8
name='cDNAS
next=Icpitembatch.CPVarDecl
frm_calc='iif(cgo_soggetti->SESSO='M','1',iif(cgo_soggetti->SESSO='F','2',''))
len=1
name='xSesso
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(cgo_soggetti->NASPROV)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O779
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O780
fatherSonIndex=0
frm_calc=[
'LRTrim(cgo_soggetti->NASPROV)='EE'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O785
fatherSonIndex=0
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cSNAS)
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='cPNAS
obj='Var
pag=3
prev=O795
var_op='asgn
I
obj='Var
pag=3
prev=O792
var_op='asgn
I
obj='If
pag=3
prev=O791
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O792
fatherSonIndex=0
frm_calc='cgo_soggetti->NASCOMUN
len=30
name='cSNAS
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=3
prev=O790
rd_field=[
'DESCRI
]
rd_kfield=[
'DESCRI
]
rd_kvar=[
'cgo_soggetti->NASSTATO
]
rd_var=[
'cSNAS
]
I
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O785
fatherSonIndex=1
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='cPNAS
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cCNAS)
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
obj='Var
pag=3
prev=O810
var_op='asgn
I
obj='If
pag=3
prev=O808
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O810
fatherSonIndex=0
frm_calc='cgo_soggetti->NASCOMUN
len=30
name='cCNAS
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=3
prev=O807
sel_field='*
sel_name='tbcitta
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O808
fatherSonIndex=0
frm_calc=[
'LRTrim(Left(tbcitta->CITTA,30))=Upper(LRTrim(cgo_soggetti->NASCOMUN)) and tbcitta->PROV=cgo_soggetti->NASPROV
]
h=[
19
19
]
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O820
fatherSonIndex=0
frm_calc='tbcitta->CITTA
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc='tbcitta->PROV
len=2
name='cPNAS
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O826
I
obj='Var
pag=3
prev=O825
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O806
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O780
fatherSonIndex=1
frm_calc='cgo_soggetti->NASSTATO
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='cgo_soggetti->NASCOMUN
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='cPNAS
obj='Var
pag=3
prev=O833
var_op='asgn
I
obj='Var
pag=3
prev=O832
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=3
prev=O778
var_op='asgn
I
obj='Var
obj_type='D
pag=3
prev=O777
var_op='asgn
I
obj='Var
pag=3
prev=O776
var_op='asgn
I
obj='Var
pag=3
prev=O775
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O737
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O738
fatherSonIndex=0
frm_calc='cgo_soggetti->DESCCIT
len=30
name='xCitta
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=3
prev=O839
sel_field='*
sel_name='tbcitta
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O840
fatherSonIndex=0
frm_calc=[
'LRTrim(Left(tbcitta->CITTA,30))=Upper(LRTrim(xCitta)) and tbcitta->PROV=cgo_soggetti->PROVINCIA
]
h=[
19
19
]
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O844
fatherSonIndex=0
frm_calc='tbcitta->CAB
len=6
name='xCodCab
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O849
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O736
var_op='asgn
I
obj='Var
pag=3
prev=O735
var_op='asgn
I
obj='Var
pag=3
prev=O734
var_op='asgn
I
obj='Var
pag=3
prev=O733
var_op='asgn
I
obj='Var
pag=3
prev=O732
var_op='asgn
I
obj='Var
pag=3
prev=O731
var_op='asgn
I
obj='Var
obj_type='D
pag=3
prev=O730
var_op='asgn
I
obj='Var
obj_type='D
pag=3
prev=O729
var_op='asgn
I
obj='Var
obj_type='D
pag=3
prev=O728
var_op='asgn
I
obj='Read
pag=3
prev=O727
rd_field=[
'FLGSAE
]
rd_kfield=[
'CODSTA
]
rd_kvar=[
'cgo_soggetti->PAESE
]
rd_var=[
'xFLGSAE
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O537
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGSOGERR\'"+LRTrim(_gAzienda)+"'","",15)
len=15
name='ProgErr
next=Icpitembatch.CPInsert
arch='cgo_soggetti_err
next=Icpitembatch.CPVarDecl
frm_calc='sNumErr + 1
len=10
name='sNumErr
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=3
prev=O865
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->CODINTER=cgo_soggetti->CONNES
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O867
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=3
sel_field='*
sel_name='cgo_telematico
sel_where='cgo_telematico->RAPPORTO=xntestbo->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cgo_telematico_err
father=O871
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='oNumErr + 1
len=10
name='oNumErr
next=Icpitembatch.CPDelete
arch='cgo_telematico
obj='Delete
pag=3
prev=O876
rd_kfield=[
'SNAINUMOPE
]
rd_kop=[
'=
]
rd_kvar=[
'cgo_telematico->SNAINUMOPE
]
I
obj='Var
obj_type='N
pag=3
prev=O875
var_op='asgn
I
obj='Insert
pag=3
rd_kfield=[
'SNAINUMOPE
'ENV
'CODDIPE
'RAPPORTO
'TOTLIRE
'CACODICE
'CADATAORA
'CAIDBIGLIETTO
'CSMF_COD
'NUM_CONC
'P_VEND
'IPCOLLEG
'ORACOLLEG
'DUCOLLEG
'IBAN
'TXTERR
'FLGFULL
'MEZPAGAM
'TIPOGIOCO
'CODLOB
'CATIPGIO
'CATIPCON
'CAPV_COD
]
rd_kvar=[
'cgo_telematico->SNAINUMOPE
'cgo_telematico->ENV
'cgo_telematico->CODDIPE
'cgo_telematico->RAPPORTO
'cgo_telematico->TOTLIRE
'cgo_telematico->CACODICE
'cgo_telematico->CADATAORA
'cgo_telematico->CAIDBIGLIETTO
'cgo_telematico->CSMF_COD
'cgo_telematico->NUM_CONC
'cgo_telematico->P_VEND
'cgo_telematico->IPCOLLEG
'cgo_telematico->ORACOLLEG
'cgo_telematico->DUCOLLEG
'cgo_telematico->IBAN
'_txterr
''N'
'cgo_telematico->MEZPAGAM
'cgo_telematico->TIPOGIOCO
'cgo_telematico->CODLOB
'cgo_telematico->CATIPGIO
'cgo_telematico->CATIPCON
'cgo_telematico->CAPV_COD
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=3
prev=O863
sel_field='*
sel_name='intestbo
sel_where='intestbo->CODINTER=cgo_soggetti->CONNES
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O865
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=3
sel_field='*
sel_name='cgo_telematico
sel_where='cgo_telematico->RAPPORTO=intestbo->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cgo_telematico_err
father=O887
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='oNumErr + 1
len=10
name='oNumErr
next=Icpitembatch.CPDelete
arch='cgo_telematico
obj='Delete
pag=3
prev=O892
rd_kfield=[
'SNAINUMOPE
]
rd_kop=[
'=
]
rd_kvar=[
'cgo_telematico->SNAINUMOPE
]
I
obj='Var
obj_type='N
pag=3
prev=O891
var_op='asgn
I
obj='Insert
pag=3
rd_kfield=[
'SNAINUMOPE
'ENV
'CODDIPE
'RAPPORTO
'TOTLIRE
'CACODICE
'CADATAORA
'CAIDBIGLIETTO
'CSMF_COD
'NUM_CONC
'P_VEND
'IPCOLLEG
'ORACOLLEG
'DUCOLLEG
'IBAN
'TXTERR
'FLGFULL
'MEZPAGAM
'TIPOGIOCO
'CODLOB
'CATIPGIO
'CATIPCON
'CAPV_COD
]
rd_kvar=[
'cgo_telematico->SNAINUMOPE
'cgo_telematico->ENV
'cgo_telematico->CODDIPE
'cgo_telematico->RAPPORTO
'cgo_telematico->TOTLIRE
'cgo_telematico->CACODICE
'cgo_telematico->CADATAORA
'cgo_telematico->CAIDBIGLIETTO
'cgo_telematico->CSMF_COD
'cgo_telematico->NUM_CONC
'cgo_telematico->P_VEND
'cgo_telematico->IPCOLLEG
'cgo_telematico->ORACOLLEG
'cgo_telematico->DUCOLLEG
'cgo_telematico->IBAN
'_txterr
''N'
'cgo_telematico->MEZPAGAM
'cgo_telematico->TIPOGIOCO
'cgo_telematico->CODLOB
'cgo_telematico->CATIPGIO
'cgo_telematico->CATIPCON
'cgo_telematico->CAPV_COD
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=3
prev=O862
sel_field='*
sel_name='cgo_rapporti
sel_where='cgo_rapporti->CODINTEST=cgo_soggetti->CONNES
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O863
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGDIPERR\'"+LRTrim(_gAzienda)+"'","",15)
len=15
name='ProgErr
next=Icpitembatch.CPInsert
arch='cgo_rapporti_err
next=Icpitembatch.CPVarDecl
frm_calc='rNumErr + 1
len=10
name='rNumErr
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='cgo_rapporti
obj='Delete
pag=3
prev=O906
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'cgo_rapporti->RAPPORTO
]
I
obj='Select
pag=3
prev=O905
sel_field='*
sel_name='cgo_telematico
sel_where='cgo_telematico->RAPPORTO=cgo_rapporti->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cgo_telematico_err
father=O906
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='oNumErr + 1
len=10
name='oNumErr
next=Icpitembatch.CPDelete
arch='cgo_telematico
obj='Delete
pag=3
prev=O915
rd_kfield=[
'SNAINUMOPE
]
rd_kop=[
'=
]
rd_kvar=[
'cgo_telematico->SNAINUMOPE
]
I
obj='Var
obj_type='N
pag=3
prev=O914
var_op='asgn
I
obj='Insert
pag=3
rd_kfield=[
'SNAINUMOPE
'ENV
'CODDIPE
'RAPPORTO
'TOTLIRE
'CACODICE
'CADATAORA
'CAIDBIGLIETTO
'CSMF_COD
'NUM_CONC
'P_VEND
'IPCOLLEG
'ORACOLLEG
'DUCOLLEG
'IBAN
'TXTERR
'FLGFULL
'MEZPAGAM
'TIPOGIOCO
'CODLOB
'CATIPGIO
'CATIPCON
'CAPV_COD
]
rd_kvar=[
'cgo_telematico->SNAINUMOPE
'cgo_telematico->ENV
'cgo_telematico->CODDIPE
'cgo_telematico->RAPPORTO
'cgo_telematico->TOTLIRE
'cgo_telematico->CACODICE
'cgo_telematico->CADATAORA
'cgo_telematico->CAIDBIGLIETTO
'cgo_telematico->CSMF_COD
'cgo_telematico->NUM_CONC
'cgo_telematico->P_VEND
'cgo_telematico->IPCOLLEG
'cgo_telematico->ORACOLLEG
'cgo_telematico->DUCOLLEG
'cgo_telematico->IBAN
'_txterr
''N'
'cgo_telematico->MEZPAGAM
'cgo_telematico->TIPOGIOCO
'cgo_telematico->CODLOB
'cgo_telematico->CATIPGIO
'cgo_telematico->CATIPCON
'cgo_telematico->CAPV_COD
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O904
var_op='asgn
I
obj='Insert
pag=3
prev=O903
rd_kfield=[
'PRGRAP
'RAPPORTO
'DESCRAP
'TIPOMOV
'DATAOPE
'CODINTEST
'TXTERR
'CASTATOC
'CASTATOM
]
rd_kvar=[
'ProgErr
'cgo_rapporti->RAPPORTO
'cgo_rapporti->DESCRAP
'cgo_rapporti->TIPOMOV
'cgo_rapporti->DATAOPE
'cgo_rapporti->CODINTEST
''Rapporto scartato per errori su intestatario'
'cgo_rapporti->CASTATOC
'cgo_rapporti->CASTATOM
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O861
var_op='asgn
I
obj='Insert
pag=3
prev=O860
rd_kfield=[
'PRGSOG
'CONNES
'COGNOME
'NOME
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'DATANASC
'NASCOMUN
'NASSTATO
'NASPROV
'SESSO
'TIPODOC
'NUMDOCUM
'DATARILASC
'DATAVALI
'AUTRILASC
'CFESTERO
'PEP
'TXTERR
'FLGFULL
]
rd_kvar=[
'ProgErr
'cgo_soggetti->CONNES
'cgo_soggetti->COGNOME
'cgo_soggetti->NOME
'cgo_soggetti->DOMICILIO
'cgo_soggetti->DESCCIT
'cgo_soggetti->PROVINCIA
'cgo_soggetti->PAESE
'cgo_soggetti->CAP
'cgo_soggetti->DATANASC
'cgo_soggetti->NASCOMUN
'cgo_soggetti->NASSTATO
'cgo_soggetti->NASPROV
'cgo_soggetti->SESSO
'cgo_soggetti->TIPODOC
'cgo_soggetti->NUMDOCUM
'cgo_soggetti->DATARILASC
'cgo_soggetti->DATAVALI
'cgo_soggetti->AUTRILASC
'cgo_soggetti->CFESTERO
'cgo_soggetti->PEP
'_txterr
''N'
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=3
prev=O533
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O534
fatherSonIndex=0
frm_calc='7
obj='Exec
pag=3
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O532
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O531
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O529
var_op='asgn
I
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Anno Di Nascita
father=O529
fatherSonIndex=0
frm_calc='''
len=2
name='xAnnNas
next=Icpitembatch.CPVarDecl
comment='Mese Di Nascita
frm_calc='''
len=2
name='xMesNas
next=Icpitembatch.CPVarDecl
comment='Giorno Di Nascita
frm_calc='''
len=2
name='xDayNas
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='cDNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='xSesso
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='cPNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_recOK
obj='Var
obj_type='N
pag=3
prev=O944
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O943
var_op='asgn
I
obj='Var
pag=3
prev=O942
var_op='asgn
I
obj='Var
pag=3
prev=O941
var_op='asgn
I
obj='Var
pag=3
prev=O940
var_op='asgn
I
obj='Var
pag=3
prev=O939
var_op='asgn
I
obj='Var
pag=3
prev=O938
var_op='asgn
I
obj='Var
obj_type='D
pag=3
prev=O937
var_op='asgn
I
obj='Var
pag=3
prev=O936
var_op='asgn
I
obj='Var
pag=3
prev=O935
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O504
fatherSonIndex=1
frm_calc='"Nessuna Soggetto Inserito, Aggiornato o Scartato"
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGLOG\'"+LRTrim(_gAzienda)+"'",'',20)
len=20
name='cProg
next=Icpitembatch.CPInsert
arch='log_app
obj='Insert
pag=3
prev=O950
rd_kfield=[
'LOGCODICE
'LOGDATORA
'LOGUTENTE
'LOGTIPOPE
'LOGTESTO
'LOGTABELLA
'LOGCHIAVE
'LOGTYPE
]
rd_kvar=[
'cProg
'DateTime()
'1
''Import Dati'
'_gMsgProc
''PERSONBO'
''NO RECORDS'
''S'
]
I
obj='Var
pag=3
prev=O949
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=3
prev=O501
sel_name='qbe_cgo_soggetti_totali
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O502
fatherSonIndex=0
frm_calc='qbe_cgo_soggetti_totali->TOTSOG
len=10
name='_totale
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O500
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O499
var_op='asgn
I
obj='Remark
pag=3
x=14
y=13
I
Icpitembatch.CPRemark
frm_calc='Import Rapporti
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_totale
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_totale > 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
prev=O962
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O964
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc=''Rapporti Inseriti: '+LRTrim(Str(rNumNew,10,0)) + ' - Rapporti Aggiornati: '+LRTrim(Str(rNumMod,10,0)) + NL
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGLOG\'"+LRTrim(_gAzienda)+"'",'',20)
len=20
name='cProg
next=Icpitembatch.CPInsert
arch='log_app
next=Icpitembatch.CPIfElse
frm_calc=[
'rNumErr > 0
]
h=[
19
19
]
obj='If
pag=4
prev=O973
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O974
fatherSonIndex=0
frm_calc=''Rapporti Scartati: '+LRTrim(Str(rNumErr,10,0))  + NL
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGLOG\'"+LRTrim(_gAzienda)+"'",'',20)
len=20
name='cProg
next=Icpitembatch.CPInsert
arch='log_app
obj='Insert
pag=4
prev=O980
rd_kfield=[
'LOGCODICE
'LOGDATORA
'LOGUTENTE
'LOGTIPOPE
'LOGTESTO
'LOGTABELLA
'LOGCHIAVE
'LOGTYPE
]
rd_kvar=[
'cProg
'DateTime()
'1
''Import Dati'
'_gMsgProc
''RAPPORTI'
''Scartati '+LRTrim(Str(rNumErr,10,0))
''S'
]
I
obj='Var
pag=4
prev=O979
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=4
prev=O972
rd_kfield=[
'LOGCODICE
'LOGDATORA
'LOGUTENTE
'LOGTIPOPE
'LOGTESTO
'LOGTABELLA
'LOGCHIAVE
'LOGTYPE
]
rd_kvar=[
'cProg
'DateTime()
'1
''Import Dati'
'_gMsgProc
''RAPPORTI'
''Inseriti / Aggiornati '+LRTrim(Str((rNumNew+rNumMod),10,0))
''S'
]
I
obj='Var
pag=4
prev=O971
var_op='asgn
I
obj='Var
obj_type='M
pag=4
prev=O969
var_op='asgn
I
obj='Select
pag=4
sel_field='*
sel_name='cgo_rapporti
sel_order='cgo_rapporti->STATORAP
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O969
fatherSonIndex=0
frm_calc='0
len=1
name='_recOK
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='xRapporto
next=Icpitembatch.CPIfElse
frm_calc=[
'_snaistor='N'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_recOK = 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPDelete
arch='cgo_rapporti
next=Icpitembatch.CPVarDecl
frm_calc='_conta + 1
len=10
name='_conta
obj='Var
obj_type='N
pag=4
prev=O998
var_op='asgn
I
obj='Delete
pag=4
prev=O995
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'cgo_rapporti->RAPPORTO
]
I
obj='If
pag=4
prev=O992
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O995
fatherSonIndex=0
frm_calc=[
'cgo_rapporti->TIPOMOV='A'
'cgo_rapporti->TIPOMOV='C'
'cgo_rapporti->TIPOMOV='S'
]
h=[
19
19
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anarapbo
father=O1005
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xRapporto))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xRapporto))
]
h=[
19
19
]
obj='If
pag=4
prev=O1011
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1014
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPInsert
arch='knarapbo
next=Icpitembatch.CPVarDecl
frm_calc='rNumNew + 1
len=10
name='rNumNew
obj='Var
obj_type='N
pag=4
prev=O1022
var_op='asgn
I
obj='Insert
pag=4
prev=O1019
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
]
rd_kvar=[
'cgo_rapporti->RAPPORTO
'cgo_rapporti->DESCRAP
'w_tipodest
]
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xnarapbo
father=O1019
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xapopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='xntestbo
obj='Insert
pag=4
prev=O1034
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'PRGIMPSOG
]
rd_kvar=[
'LibreriaMit.UniqueId()
'1
'cgo_rapporti->DATAOPE
'cgo_rapporti->CODINTEST
'cInfProg2
'cgo_rapporti->RAPPORTO
''0'
''0'
'nProgImp2
]
I
obj='Var
obj_type='N
pag=4
prev=O1032
var_op='asgn
I
obj='Insert
pag=4
prev=O1031
rd_kfield=[
'CDATOPE
'CODCAB
'CODINTER
'DATAOPE
'DATAREG
'DESCCIT
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOOPRAP
'VALUTA
'CDATREG
]
rd_kvar=[
'DateToChar(cgo_rapporti->DATAOPE)
'_cabinter
'_intercod
'cgo_rapporti->DATAOPE
'iif(_snaistor='N',Date(),iif(DateToChar(cgo_rapporti->DATAOPE) <= '20120531',CharToDate('20120601'),arfn_datesum(cgo_rapporti->DATAOPE,1)))
'_intercit
''3'
''0'
'cInfProg1
'DateToChar(cgo_rapporti->DATAOPE)+cInfProg1+'0'
'cInfProg2
''2'
'nProgImp
'_interprv
'cgo_rapporti->RAPPORTO
''0'
''1'
'_tipinter
''23'
''242'
'DateToChar(Date())
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1032
fatherSonIndex=0
frm_calc='_gMsgProc +"Rilevati errori nel file cgo_rapporti per l'informazione in data "+arfn_fdate(cgo_rapporti->DATAOPE)+" relativa al rapporto: "+LRTrim(cgo_rapporti->RAPPORTO)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='_gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1044
I
obj='Var
obj_type='N
pag=4
prev=O1043
var_op='asgn
I
obj='Exec
pag=4
prev=O1042
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O1030
var_op='asgn
I
obj='Var
pag=4
prev=O1029
var_op='asgn
I
obj='Var
pag=4
prev=O1028
var_op='asgn
I
obj='Insert
pag=4
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'CASTATOC
'CASTATOM
]
rd_kvar=[
'cgo_rapporti->RAPPORTO
'cgo_rapporti->DESCRAP
''0'
''E'
''242'
''22'
'cgo_rapporti->CASTATOC
'cgo_rapporti->CASTATOM
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anarapbo
father=O1019
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='rapopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='intestbo
obj='Insert
pag=4
prev=O1056
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'PRGIMPSOG
]
rd_kvar=[
'LibreriaMit.UniqueId()
'1
'cgo_rapporti->DATAOPE
'cgo_rapporti->CODINTEST
'cInfProg2
'cgo_rapporti->RAPPORTO
''0'
''0'
'nProgImp2
]
I
obj='Var
obj_type='N
pag=4
prev=O1054
var_op='asgn
I
obj='Insert
pag=4
prev=O1053
rd_kfield=[
'CDATOPE
'CODCAB
'CODINTER
'DATAOPE
'DATAREG
'DESCCIT
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOOPRAP
'VALUTA
'CDATREG
]
rd_kvar=[
'DateToChar(cgo_rapporti->DATAOPE)
'_cabinter
'_intercod
'cgo_rapporti->DATAOPE
'iif(_snaistor='N',Date(),iif(DateToChar(cgo_rapporti->DATAOPE) <= '20120531',CharToDate('20120601'),arfn_datesum(cgo_rapporti->DATAOPE,1)))
'_intercit
''3'
''0'
'cInfProg1
'DateToChar(cgo_rapporti->DATAOPE)+cInfProg1+'0'
'cInfProg2
''2'
'nProgImp
'_interprv
'cgo_rapporti->RAPPORTO
''0'
''1'
'_tipinter
''23'
''242'
'iif(_snaistor='N',DateToChar(Date()),iif(DateToChar(cgo_rapporti->DATAOPE) <= '20120531','20120601',DateToChar(arfn_datesum(cgo_rapporti->DATAOPE,1))))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1054
fatherSonIndex=0
frm_calc='_gMsgProc +"Rilevati errori nel file cgo_rapporti per l'informazione in data "+arfn_fdate(cgo_rapporti->DATAOPE)+" relativa al rapporto: "+LRTrim(cgo_rapporti->RAPPORTO)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='_gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1066
I
obj='Var
obj_type='N
pag=4
prev=O1065
var_op='asgn
I
obj='Exec
pag=4
prev=O1064
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O1052
var_op='asgn
I
obj='Var
pag=4
prev=O1051
var_op='asgn
I
obj='Var
pag=4
prev=O1050
var_op='asgn
I
obj='Insert
pag=4
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'CASTATOC
'CASTATOM
]
rd_kvar=[
'cgo_rapporti->RAPPORTO
'cgo_rapporti->DESCRAP
''0'
''E'
''242'
''22'
'cgo_rapporti->CASTATOC
'cgo_rapporti->CASTATOM
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O1010
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xnarapbo
father=O1011
fatherSonIndex=0
obj='Read
pag=4
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'cgo_rapporti->RAPPORTO
]
rd_var=[
'xRapporto
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'cgo_rapporti->RAPPORTO
]
rd_var=[
'xRapporto
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anarapbo
father=O1005
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xRapporto))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='rNumMod + 1
len=10
name='rNumMod
obj='Var
obj_type='N
pag=4
prev=O1087
var_op='asgn
I
obj='If
pag=4
prev=O1086
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1087
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGPINFO1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xapopebo
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='xntestbo
obj='Write
pag=4
prev=O1096
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'cgo_rapporti->RAPPORTO
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'cgo_rapporti->DATAOPE
'cInfProg2
]
I
obj='Insert
pag=4
prev=O1095
rd_kfield=[
'CDATOPE
'CODCAB
'CODINTER
'DATAOPE
'DATAREG
'DESCCIT
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOOPRAP
'VALUTA
'CDATREG
]
rd_kvar=[
'DateToChar(cgo_rapporti->DATAOPE)
'_cabinter
'_intercod
'cgo_rapporti->DATAOPE
'iif(_snaistor='N',Date(),iif(DateToChar(cgo_rapporti->DATAOPE) <= '20120531',CharToDate('20120601'),arfn_datesum(cgo_rapporti->DATAOPE,1)))
'_intercit
''3'
''0'
'cInfProg1
'DateToChar(cgo_rapporti->DATAOPE)+cInfProg1+'0'
'cInfProg2
''2'
'nProgImp
'_interprv
'cgo_rapporti->RAPPORTO
''0'
''1'
'_tipinter
''26'
''242'
'DateToChar(Date())
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1096
fatherSonIndex=0
frm_calc='_gMsgProc +"Rilevati errori nel file cgo_rapporti per l'informazione in data "+arfn_fdate(cgo_rapporti->DATAOPE)+" relativa al rapporto: "+LRTrim(cgo_rapporti->RAPPORTO)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='_gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1111
I
obj='Var
obj_type='N
pag=4
prev=O1110
var_op='asgn
I
obj='Exec
pag=4
prev=O1109
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O1094
var_op='asgn
I
obj='Var
pag=4
prev=O1093
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1087
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='rapopebo
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='intestbo
next=Icpitembatch.CPWrite
arch='anarapbo
obj='Write
pag=4
prev=O1120
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'cgo_rapporti->RAPPORTO
]
wr_field=[
'CASTATOC
'CASTATOM
]
wr_op=[
'=
'=
]
wr_var=[
'cgo_rapporti->CASTATOC
'cgo_rapporti->CASTATOM
]
I
obj='Write
pag=4
prev=O1118
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'cgo_rapporti->RAPPORTO
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'cgo_rapporti->DATAOPE
'cInfProg2
]
I
obj='Insert
pag=4
prev=O1117
rd_kfield=[
'CDATOPE
'CODCAB
'CODINTER
'DATAOPE
'DATAREG
'DESCCIT
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOOPRAP
'VALUTA
'CDATREG
]
rd_kvar=[
'DateToChar(cgo_rapporti->DATAOPE)
'_cabinter
'_intercod
'cgo_rapporti->DATAOPE
'iif(_snaistor='N',Date(),iif(DateToChar(cgo_rapporti->DATAOPE) <= '20120531',CharToDate('20120601'),arfn_datesum(cgo_rapporti->DATAOPE,1)))
'_intercit
''3'
''0'
'cInfProg1
'DateToChar(cgo_rapporti->DATAOPE)+cInfProg1+'0'
'cInfProg2
''2'
'nProgImp
'_interprv
'cgo_rapporti->RAPPORTO
''0'
''1'
'_tipinter
''26'
''242'
'iif(_snaistor='N',DateToChar(Date()),iif(DateToChar(cgo_rapporti->DATAOPE) <= '20120531','20120601',DateToChar(arfn_datesum(cgo_rapporti->DATAOPE,1))))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1118
fatherSonIndex=0
frm_calc='_gMsgProc +"Rilevati errori nel file cgo_rapporti per l'informazione in data "+arfn_fdate(cgo_rapporti->DATAOPE)+" relativa al rapporto: "+LRTrim(cgo_rapporti->RAPPORTO)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='_gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1140
I
obj='Var
obj_type='N
pag=4
prev=O1139
var_op='asgn
I
obj='Exec
pag=4
prev=O1138
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O1116
var_op='asgn
I
obj='Var
pag=4
prev=O1115
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=4
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'cgo_rapporti->RAPPORTO
]
rd_var=[
'xRapporto
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='anarapbo
father=O1005
fatherSonIndex=2
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'cgo_rapporti->RAPPORTO
]
wr_field=[
'CASTATOC
'CASTATOM
'CADSTATO
]
wr_op=[
'=
'=
'=
]
wr_var=[
'cgo_rapporti->CASTATOC
'cgo_rapporti->CASTATOM
'cgo_rapporti->DATAOPE
]
I
I
]
w=[
150
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O995
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGRAPERR\'"+LRTrim(_gAzienda)+"'","",15)
len=15
name='ProgErr
next=Icpitembatch.CPInsert
arch='cgo_rapporti_err
next=Icpitembatch.CPVarDecl
frm_calc='rNumErr + 1
len=10
name='rNumErr
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=4
prev=O1160
sel_field='*
sel_name='cgo_telematico
sel_where='cgo_telematico->RAPPORTO=cgo_rapporti->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cgo_telematico_err
father=O1161
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='cgo_telematico
next=Icpitembatch.CPVarDecl
frm_calc='oNumErr + 1
len=10
name='oNumErr
obj='Var
obj_type='N
pag=4
prev=O1166
var_op='asgn
I
obj='Delete
pag=4
prev=O1165
rd_kfield=[
'SNAINUMOPE
]
rd_kop=[
'=
]
rd_kvar=[
'cgo_telematico->SNAINUMOPE
]
I
obj='Insert
pag=4
rd_kfield=[
'SNAINUMOPE
'ENV
'CODDIPE
'RAPPORTO
'TOTLIRE
'CACODICE
'CADATAORA
'CAIDBIGLIETTO
'CSMF_COD
'NUM_CONC
'P_VEND
'IPCOLLEG
'ORACOLLEG
'DUCOLLEG
'IBAN
'TXTERR
'FLGFULL
'MEZPAGAM
'TIPOGIOCO
'CODLOB
'CATIPGIO
'CATIPCON
'CAPV_COD
]
rd_kvar=[
'cgo_telematico->SNAINUMOPE
'cgo_telematico->ENV
'cgo_telematico->CODDIPE
'cgo_telematico->RAPPORTO
'cgo_telematico->TOTLIRE
'cgo_telematico->CACODICE
'cgo_telematico->CADATAORA
'cgo_telematico->CAIDBIGLIETTO
'cgo_telematico->CSMF_COD
'cgo_telematico->NUM_CONC
'cgo_telematico->P_VEND
'cgo_telematico->IPCOLLEG
'cgo_telematico->ORACOLLEG
'cgo_telematico->DUCOLLEG
'cgo_telematico->IBAN
'_txterr
''N'
'cgo_telematico->MEZPAGAM
'cgo_telematico->TIPOGIOCO
'cgo_telematico->CODLOB
'cgo_telematico->CATIPGIO
'cgo_telematico->CATIPCON
'cgo_telematico->CAPV_COD
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O1159
var_op='asgn
I
obj='Insert
pag=4
prev=O1158
rd_kfield=[
'PRGRAP
'RAPPORTO
'DESCRAP
'TIPOMOV
'DATAOPE
'CODINTEST
'TXTERR
'FLGFULL
'CASTATOC
'CASTATOM
]
rd_kvar=[
'ProgErr
'cgo_rapporti->RAPPORTO
'cgo_rapporti->DESCRAP
'cgo_rapporti->TIPOMOV
'cgo_rapporti->DATAOPE
'cgo_rapporti->CODINTEST
'_txterr
''N'
'cgo_rapporti->CASTATOC
'cgo_rapporti->CASTATOM
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=4
prev=O991
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Controlli su rapporto
father=O992
fatherSonIndex=0
h=[
19
19
]
obj='Begin
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1179
fatherSonIndex=0
frm_calc=[
'Empty(cgo_rapporti->RAPPORTO)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cgo_rapporti->TIPOMOV)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cgo_rapporti->DATAOPE)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cgo_rapporti->CODINTEST)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(cgo_rapporti->TIPOMOV))) and (cgo_rapporti->TIPOMOV = 'C' or cgo_rapporti->TIPOMOV = 'S')
]
h=[
19
19
]
obj='If
pag=4
prev=O1192
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1195
fatherSonIndex=0
frm_calc='''
len=25
name='_rapporto
next=Icpitembatch.CPRead
arch='anarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_rapporto))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_rapporto))
]
h=[
19
19
]
obj='If
pag=4
prev=O1202
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1205
fatherSonIndex=0
frm_calc='_txterr + 'Operazione di chiusura/cambio stato per rapporto mai aperto' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=4
prev=O1210
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O1201
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xnarapbo
father=O1202
fatherSonIndex=0
obj='Read
pag=4
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'cgo_rapporti->RAPPORTO
]
rd_var=[
'_rapporto
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
prev=O1200
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'cgo_rapporti->RAPPORTO
]
rd_var=[
'_rapporto
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O1189
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1192
fatherSonIndex=0
frm_calc='_txterr + "Manca l'intestatario del rapporto" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=4
prev=O1228
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1192
fatherSonIndex=1
frm_calc='''
len=16
name='_codsog
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_codsog)
]
h=[
19
19
]
obj='If
pag=4
prev=O1232
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1233
fatherSonIndex=0
frm_calc='_txterr + 'Non trovata anagrafica soggetto intestatario rapporto' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=4
prev=O1238
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
prev=O1231
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'cgo_rapporti->CODINTEST
]
rd_var=[
'_codsog
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=4
prev=O1186
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1189
fatherSonIndex=0
frm_calc='_txterr + 'Manca la data del movimento del rapporto' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=4
prev=O1248
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1189
fatherSonIndex=1
frm_calc=[
'cgo_rapporti->DATAOPE > Date()
]
h=[
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1251
fatherSonIndex=0
frm_calc='_txterr + 'Data movimento del rapporto errata' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=4
prev=O1256
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=4
prev=O1183
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1186
fatherSonIndex=0
frm_calc='_txterr + 'Manca il tipo di movimento del rapporto' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=4
prev=O1262
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1186
fatherSonIndex=1
frm_calc=[
'cgo_rapporti->TIPOMOV <> 'A' and cgo_rapporti->TIPOMOV <> 'C' and cgo_rapporti->TIPOMOV <> 'S'
]
h=[
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1265
fatherSonIndex=0
frm_calc='_txterr + 'Tipo di movimento del rapporto errato' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=4
prev=O1270
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1183
fatherSonIndex=0
frm_calc='_txterr + 'Manca il codice del rapporto' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=4
prev=O1276
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
prev=O990
var_op='asgn
I
obj='Var
obj_type='M
pag=4
prev=O989
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O964
fatherSonIndex=1
frm_calc='"Nessun Rapporto Inserito, Aggiornato o Scartato"
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGLOG\'"+LRTrim(_gAzienda)+"'",'',20)
len=20
name='cProg
next=Icpitembatch.CPInsert
arch='log_app
obj='Insert
pag=4
prev=O1284
rd_kfield=[
'LOGCODICE
'LOGDATORA
'LOGUTENTE
'LOGTIPOPE
'LOGTESTO
'LOGTABELLA
'LOGCHIAVE
'LOGTYPE
]
rd_kvar=[
'cProg
'DateTime()
'1
''Import Dati'
'_gMsgProc
''RAPPORTI'
''NO RECORDS'
''S'
]
I
obj='Var
pag=4
prev=O1283
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=4
prev=O961
sel_name='qbe_cgo_rapporti_totali
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O962
fatherSonIndex=0
frm_calc='qbe_cgo_rapporti_totali->TOTRAP
len=10
name='_totale
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O960
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O959
var_op='asgn
I
obj='Remark
pag=4
x=20
y=23
I
Icpitembatch.CPRemark
frm_calc='Import Operazioni
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_totale
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_MsgAss
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_totale > 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1297
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1299
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPVarDecl
frm_calc=''Operazioni Inserite: '+LRTrim(Str(oNumero,10,0)) + ' - Frazionate Inserite: '+LRTrim(Str(fNumero,10,0)) + NL+LRTrim(_MsgAss)+NL
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGLOG\'"+LRTrim(_gAzienda)+"'",'',20)
len=20
name='cProg
next=Icpitembatch.CPInsert
arch='log_app
next=Icpitembatch.CPIfElse
frm_calc=[
'oNumErr > 0
]
h=[
19
19
]
obj='If
pag=5
prev=O1309
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1310
fatherSonIndex=0
frm_calc=''Movimenti Scartati: '+LRTrim(Str(oNumErr,10,0)) + NL
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGLOG\'"+LRTrim(_gAzienda)+"'",'',20)
len=20
name='cProg
next=Icpitembatch.CPInsert
arch='log_app
obj='Insert
pag=5
prev=O1316
rd_kfield=[
'LOGCODICE
'LOGDATORA
'LOGUTENTE
'LOGTIPOPE
'LOGTESTO
'LOGTABELLA
'LOGCHIAVE
'LOGTYPE
]
rd_kvar=[
'cProg
'DateTime()
'1
''Import Dati'
'_gMsgProc
''OPERAZIONI'
''Scartati '+LRTrim(Str(oNumErr,10,0))
''S'
]
I
obj='Var
pag=5
prev=O1315
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=5
prev=O1308
rd_kfield=[
'LOGCODICE
'LOGDATORA
'LOGUTENTE
'LOGTIPOPE
'LOGTESTO
'LOGTABELLA
'LOGCHIAVE
'LOGTYPE
]
rd_kvar=[
'cProg
'DateTime()
'1
''Import Dati'
'_gMsgProc
''OPERAZIONI'
''Inseriti / Aggiornati '+LRTrim(Str(oNumero+fNumero,10,0))
''S'
]
I
obj='Var
pag=5
prev=O1307
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O1306
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1304
var_op='asgn
I
obj='Select
pag=5
sel_field='*
sel_name='cgo_telematico
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1304
fatherSonIndex=0
frm_calc='0
len=1
name='_recOK
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc=''N'
len=1
name='_omulti
next=Icpitembatch.CPVarDecl
frm_calc=''N'
len=1
name='_omultic
next=Icpitembatch.CPIfElse
frm_calc=[
'_snaistor='N'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_recOK=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPDelete
arch='cgo_telematico
obj='Delete
pag=5
prev=O1332
rd_kfield=[
'SNAINUMOPE
]
rd_kop=[
'=
]
rd_kvar=[
'cgo_telematico->SNAINUMOPE
]
I
obj='If
pag=5
prev=O1329
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1332
fatherSonIndex=0
frm_calc='cgo_telematico->SNAINUMOPE
len=15
name='_numopetele
next=Icpitembatch.CPIfElse
frm_calc=[
'_snaistor='S'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1341
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1342
fatherSonIndex=0
frm_calc='10
obj='Exec
pag=5
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1342
fatherSonIndex=1
frm_calc='8
obj='Exec
pag=5
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cgo_telematico_err
father=O1332
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='oNumErr + 1
len=10
name='oNumErr
obj='Var
obj_type='N
pag=5
prev=O1352
var_op='asgn
I
obj='Insert
pag=5
rd_kfield=[
'SNAINUMOPE
'ENV
'CODDIPE
'RAPPORTO
'TOTLIRE
'CACODICE
'CADATAORA
'CAIDBIGLIETTO
'CSMF_COD
'NUM_CONC
'P_VEND
'IPCOLLEG
'ORACOLLEG
'DUCOLLEG
'IBAN
'TXTERR
'FLGFULL
'MEZPAGAM
'TIPOGIOCO
'CODLOB
'CATIPGIO
'CATIPCON
'CAPV_COD
]
rd_kvar=[
'cgo_telematico->SNAINUMOPE
'cgo_telematico->ENV
'cgo_telematico->CODDIPE
'cgo_telematico->RAPPORTO
'cgo_telematico->TOTLIRE
'cgo_telematico->CACODICE
'cgo_telematico->CADATAORA
'cgo_telematico->CAIDBIGLIETTO
'cgo_telematico->CSMF_COD
'cgo_telematico->NUM_CONC
'cgo_telematico->P_VEND
'cgo_telematico->IPCOLLEG
'cgo_telematico->ORACOLLEG
'cgo_telematico->DUCOLLEG
'cgo_telematico->IBAN
'_txterr
''N'
'cgo_telematico->MEZPAGAM
'cgo_telematico->TIPOGIOCO
'cgo_telematico->CODLOB
'cgo_telematico->CATIPGIO
'cgo_telematico->CATIPCON
'cgo_telematico->CAPV_COD
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=5
prev=O1328
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Controlli su operazione
father=O1329
fatherSonIndex=0
h=[
19
19
]
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1359
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(cgo_telematico->ENV))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cgo_telematico->CACODICE)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cgo_telematico->CAIDBIGLIETTO))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cgo_telematico->CADATAORA)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cgo_telematico->CODDIPE) and cgo_telematico->ENV='A'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cgo_telematico->ENV='W'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cgo_telematico->TOTLIRE=0
]
h=[
19
19
]
obj='If
pag=5
prev=O1378
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1381
fatherSonIndex=0
frm_calc='_txterr + "Manca l'importo dell'operazione" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=5
prev=O1386
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1375
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1378
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(cgo_telematico->MEZPAGAM))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cgo_telematico->DUCOLLEG = 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cgo_telematico->IPCOLLEG)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cgo_telematico->ORACOLLEG)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cgo_telematico->RAPPORTO)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1400
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1403
fatherSonIndex=0
frm_calc='_txterr + "Manca il rapporto collegato all'operazione" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=5
prev=O1408
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1403
fatherSonIndex=1
frm_calc='''
len=25
name='_codrap
next=Icpitembatch.CPRead
arch='anarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_codrap)))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPBeginEnd
comment='Controllo Documento Intestatario conto
h=[
19
19
]
obj='Begin
pag=5
prev=O1413
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1416
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(cgo_telematico->RAPPORTO)))
]
h=[
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1420
fatherSonIndex=0
frm_calc='''
len=16
name='_intcon
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_intcon))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_intcon)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1428
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1431
fatherSonIndex=0
frm_calc='NullDate()
len=8
name='_datini
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datend
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_datini) and Empty(_datend)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1438
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1440
fatherSonIndex=0
frm_calc='_txterr + "Mancano le date di rilascio e scadenza del documento dell'intestatario del rapporto collegato all'operazione" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=5
prev=O1445
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1440
fatherSonIndex=1
frm_calc=[
'_flgnodoc='S'
]
h=[
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1448
fatherSonIndex=0
frm_calc=[
'not(Empty(_datend)) and _datope > _datend
]
h=[
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1453
fatherSonIndex=0
frm_calc='_txterr + "Impossibile inserire un'operazione dopo la data di scadenza del documento del soggetto intestatario del rapporto" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=5
prev=O1458
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=5
prev=O1437
sel_field='personbo->DATAVALI,personbo->DATARILASC
sel_name='personbo
sel_where='personbo->CONNES=_intcon
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1438
fatherSonIndex=0
frm_calc='personbo->DATARILASC
len=8
name='_datini
next=Icpitembatch.CPVarDecl
frm_calc='personbo->DATAVALI
len=8
name='_datend
obj='Var
obj_type='D
pag=5
prev=O1465
var_op='asgn
I
obj='Var
obj_type='D
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='D
pag=5
prev=O1436
var_op='asgn
I
obj='Var
obj_type='D
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1431
fatherSonIndex=1
frm_calc='_txterr + "Manca il riferimento all'intestatario del rapporto collegato all'operazione" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=5
prev=O1469
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=5
prev=O1426
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1428
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_field='xntestbo->CODINTER
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=cgo_telematico->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1474
fatherSonIndex=0
frm_calc='xntestbo->CODINTER
len=16
name='_intcon
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1425
sel_field='intestbo->CODINTER
sel_name='intestbo
sel_where='intestbo->RAPPORTO=cgo_telematico->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1426
fatherSonIndex=0
frm_calc='intestbo->CODINTER
len=16
name='_intcon
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1412
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1413
fatherSonIndex=0
frm_calc='NullDate()
len=8
name='_datini
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datend
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_datini) and Empty(_datend)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_datini) and Empty(_datend)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1493
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1496
fatherSonIndex=0
frm_calc='_txterr + "Non esistono le informazioni di apertura ed eventuale chiusura del rapporto collegato all'operazione" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=5
prev=O1501
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1496
fatherSonIndex=1
frm_calc=[
'_datope < _datini
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_datend)) and _datope > _datend
]
h=[
19
19
]
obj='If
pag=5
prev=O1504
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1507
fatherSonIndex=0
frm_calc='_txterr + "Impossibile inserire un'operazione dopo la chiusura del rapporto" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=5
prev=O1512
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1504
fatherSonIndex=0
frm_calc='_txterr + "Impossibile inserire un'operazione prima dell'apertura del rapporto" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=5
prev=O1517
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=5
prev=O1491
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1493
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_field='xapopebo->DATAOPE
sel_name='xapopebo
sel_where='xapopebo->RAPPORTO=cgo_telematico->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1523
fatherSonIndex=0
frm_calc=[
'xapopebo->TIPOOPRAP='23'
'xapopebo->TIPOOPRAP='26'
]
h=[
19
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1527
fatherSonIndex=0
frm_calc='xapopebo->DATAOPE
len=8
name='_datini
obj='Var
obj_type='D
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1527
fatherSonIndex=1
frm_calc='xapopebo->DATAOPE
len=8
name='_datend
obj='Var
obj_type='D
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1490
sel_field='rapopebo->DATAOPE,rapopebo->TIPOOPRAP
sel_name='rapopebo
sel_where='rapopebo->RAPPORTO=cgo_telematico->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1491
fatherSonIndex=0
frm_calc=[
'rapopebo->TIPOOPRAP='23' or rapopebo->TIPOOPRAP='45' or rapopebo->TIPOOPRAP='35' or rapopebo->TIPOOPRAP='37'
'rapopebo->TIPOOPRAP='26' or rapopebo->TIPOOPRAP='46' or rapopebo->TIPOOPRAP='36' or rapopebo->TIPOOPRAP='38'
]
h=[
19
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1540
fatherSonIndex=0
frm_calc='rapopebo->DATAOPE
len=8
name='_datini
obj='Var
obj_type='D
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1540
fatherSonIndex=1
frm_calc='rapopebo->DATAOPE
len=8
name='_datend
obj='Var
obj_type='D
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='D
pag=5
prev=O1489
var_op='asgn
I
obj='Var
obj_type='D
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1413
fatherSonIndex=1
frm_calc='''
len=25
name='_codrap
next=Icpitembatch.CPRead
arch='xnarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_codrap)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1552
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1553
fatherSonIndex=0
frm_calc='NullDate()
len=8
name='_datini
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datend
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_datini) and Empty(_datend)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1560
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1562
fatherSonIndex=0
frm_calc='_txterr + "Non esistono le informazioni di apertura ed eventuale chiusura del rapporto collegato all'operazione" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=5
prev=O1567
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1562
fatherSonIndex=1
frm_calc=[
'_datope < _datini
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_datend)) and _datope > _datend
]
h=[
19
19
]
obj='If
pag=5
prev=O1570
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1573
fatherSonIndex=0
frm_calc='_txterr + "Impossibile inserire un'operazione dopo la chiusura del rapporto" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=5
prev=O1578
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1570
fatherSonIndex=0
frm_calc='_txterr + "Impossibile inserire un'operazione prima dell'apertura del rapporto" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=5
prev=O1583
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=5
prev=O1559
sel_field='xapopebo->DATAOPE,xapopebo->TIPOOPRAP
sel_name='xapopebo
sel_where='xapopebo->RAPPORTO=cgo_telematico->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1560
fatherSonIndex=0
frm_calc=[
'xapopebo->TIPOOPRAP='23' or xapopebo->TIPOOPRAP='45' or xapopebo->TIPOOPRAP='35' or xapopebo->TIPOOPRAP='37'
'xapopebo->TIPOOPRAP='26' or xapopebo->TIPOOPRAP='46' or xapopebo->TIPOOPRAP='36' or xapopebo->TIPOOPRAP='38'
]
h=[
19
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1589
fatherSonIndex=0
frm_calc='xapopebo->DATAOPE
len=8
name='_datini
obj='Var
obj_type='D
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1589
fatherSonIndex=1
frm_calc='xapopebo->DATAOPE
len=8
name='_datend
obj='Var
obj_type='D
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='D
pag=5
prev=O1558
var_op='asgn
I
obj='Var
obj_type='D
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1553
fatherSonIndex=1
frm_calc='_txterr + "Non esistono i dati base del rapporto collegato all'operazione" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=5
prev=O1600
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=5
prev=O1551
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'cgo_telematico->RAPPORTO
]
rd_var=[
'_codrap
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=5
prev=O1411
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'cgo_telematico->RAPPORTO
]
rd_var=[
'_codrap
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=5
prev=O1397
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1400
fatherSonIndex=0
frm_calc='_txterr + "Mancano data e ora inizio collegamento dell'operazione" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=5
prev=O1615
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1394
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1397
fatherSonIndex=0
frm_calc='_txterr + "Manca ip collegamento dell'operazione" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=5
prev=O1620
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1391
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1394
fatherSonIndex=0
frm_calc='_txterr + "Manca durata dell'operazione" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=5
prev=O1625
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1391
fatherSonIndex=0
frm_calc='_txterr + "Manca il mezzo di pagamento dell'operazione" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=5
prev=O1630
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1372
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1375
fatherSonIndex=0
frm_calc='_txterr + "Mancano il codice agenzia dell'operazione" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=5
prev=O1636
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1369
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1372
fatherSonIndex=0
frm_calc='_txterr + "Mancano data e ora dell'operazione" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=5
prev=O1641
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1372
fatherSonIndex=1
frm_calc='arfn_dttod(cgo_telematico->CADATAORA)
len=8
name='_datope
obj='Var
obj_type='D
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=5
prev=O1366
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1369
fatherSonIndex=0
frm_calc='_txterr + "Manca ID Biglietto all'operazione" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=5
prev=O1648
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1363
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1366
fatherSonIndex=0
frm_calc='_txterr + "Manca la causale dell'operazione" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=5
prev=O1653
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1366
fatherSonIndex=1
frm_calc='0
len=5
name='_codcau
next=Icpitembatch.CPRead
arch='cgo_causali
next=Icpitembatch.CPIfElse
frm_calc=[
'_codcau = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1657
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1658
fatherSonIndex=0
frm_calc='_txterr + "Causale non presente in archivio causali" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=5
prev=O1663
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1658
fatherSonIndex=1
frm_calc=[
'not(Empty(LRTrim(cgo_telematico->MEZPAGAM)))
]
h=[
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1666
fatherSonIndex=0
frm_calc='iif(At(LRTrim(cgo_telematico->MEZPAGAM), '|I|E|P')=0,'A',LRTrim(cgo_telematico->MEZPAGAM))
len=1
name='_mezpagam
next=Icpitembatch.CPRead
arch='cgo_causali
next=Icpitembatch.CPIfElse
frm_calc=[
'_codcau=0
]
h=[
19
19
]
obj='If
pag=5
prev=O1672
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1673
fatherSonIndex=0
frm_calc='_txterr + "Causale dell'operazione errata" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=5
prev=O1678
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O1671
rd_field=[
'CACODICE
]
rd_kfield=[
'CACODICE
'CATIPOPE
]
rd_kvar=[
'cgo_telematico->CACODICE
'_mezpagam
]
rd_var=[
'_codcau
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=5
prev=O1656
rd_field=[
'CACODICE
]
rd_kfield=[
'CACODICE
]
rd_kvar=[
'cgo_telematico->CACODICE
]
rd_var=[
'_codcau
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1363
fatherSonIndex=0
frm_calc='_txterr + "Manca il tipo di operazione" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=5
prev=O1694
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1327
var_op='asgn
I
obj='Var
pag=5
prev=O1326
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O1325
var_op='asgn
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1299
fatherSonIndex=1
frm_calc='"Nessuna Operazione/Frazionata Inserita"
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGLOG\'"+LRTrim(_gAzienda)+"'",'',20)
len=20
name='cProg
next=Icpitembatch.CPInsert
arch='log_app
obj='Insert
pag=5
prev=O1702
rd_kfield=[
'LOGCODICE
'LOGDATORA
'LOGUTENTE
'LOGTIPOPE
'LOGTESTO
'LOGTABELLA
'LOGCHIAVE
'LOGTYPE
]
rd_kvar=[
'cProg
'DateTime()
'1
''Import Dati'
'_gMsgProc
''OPERAZIONI'
''NO RECORDS'
''S'
]
I
obj='Var
pag=5
prev=O1701
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=5
prev=O1296
sel_name='qbe_cgo_telematico_totali
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1297
fatherSonIndex=0
frm_calc='qbe_cgo_telematico_totali->TOTALE
len=10
name='_totale
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=5
prev=O1295
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1294
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1293
var_op='asgn
I
obj='Remark
pag=5
x=10
y=17
I
Icpitembatch.CPIfElse
frm_calc=[
'_datope < _datini
]
h=[
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1711
fatherSonIndex=0
frm_calc='_txterr + "Impossibile inserire un'operazione prima della data di rilascio del documento del soggetto intestatario del rapporto" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=5
prev=O1716
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
x=1063
y=4871
I
Icpitembatch.CPRemark
frm_calc='Import Utenti + Dipendenze
next=Icpitembatch.CPVarDecl
len=10
name='nUser
next=Icpitembatch.CPVarDecl
len=10
name='mUser
next=Icpitembatch.CPVarDecl
len=20
name='cPassword
next=Icpitembatch.CPRemark
frm_calc='Azzera variabili per i conteggi
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_totale
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_totale > 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
prev=O1726
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1728
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc=''Utenti Inseriti: '+LRTrim(Str(uNumNew,10,0)) + ' - Utenti Aggiornati: '+LRTrim(Str(uNumMod,10,0)) + NL
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGLOG\'"+LRTrim(_gAzienda)+"'",'',20)
len=20
name='cProg
next=Icpitembatch.CPInsert
arch='log_app
obj='Insert
pag=6
prev=O1736
rd_kfield=[
'LOGCODICE
'LOGDATORA
'LOGUTENTE
'LOGTIPOPE
'LOGTESTO
'LOGTABELLA
'LOGCHIAVE
'LOGTYPE
]
rd_kvar=[
'cProg
'DateTime()
'1
''Import Dati'
'_gMsgProc
''UTENTI'
''Inseriti / Aggiornati '+LRTrim(Str(_conta,10,0))
''S'
]
I
obj='Var
pag=6
prev=O1735
var_op='asgn
I
obj='Var
obj_type='M
pag=6
prev=O1733
var_op='asgn
I
obj='Select
pag=6
sel_field='*
sel_name='cgo_users
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1733
fatherSonIndex=0
frm_calc='0
len=10
name='nUser
next=Icpitembatch.CPRead
arch='cpusers
next=Icpitembatch.CPIfElse
frm_calc=[
'nUser = 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPDelete
arch='cgo_users
next=Icpitembatch.CPVarDecl
frm_calc='_conta + 1
len=10
name='_conta
obj='Var
obj_type='N
pag=6
prev=O1747
var_op='asgn
I
obj='Delete
pag=6
prev=O1744
rd_kfield=[
'name
]
rd_kop=[
'=
]
rd_kvar=[
'cgo_users->name
]
I
obj='If
pag=6
prev=O1743
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O1744
fatherSonIndex=0
frm_calc='0
len=10
name='mUser
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='mUser+1
len=10
name='mUser
next=Icpitembatch.CPVarDecl
frm_calc='CPLib.CriptPwd(mUser,'mitwebanti')
len=20
name='cPassword
next=Icpitembatch.CPInsert
arch='cpusers
next=Icpitembatch.CPInsert
arch='cpusers_add
next=Icpitembatch.CPInsert
arch='cpusrgrp
next=Icpitembatch.CPVarDecl
frm_calc='uNumNew + 1
len=10
name='uNumNew
obj='Var
obj_type='N
pag=6
prev=O1761
var_op='asgn
I
obj='Insert
pag=6
prev=O1760
rd_kfield=[
'groupcode
'usercode
'companies
]
rd_kvar=[
'6
'mUser
'_gAzienda
]
I
obj='Insert
pag=6
prev=O1759
rd_kfield=[
'CODE
'CODDIP
]
rd_kvar=[
'mUser
'cgo_users->coddip
]
I
obj='Insert
pag=6
prev=O1758
rd_kfield=[
'code
'name
'passwd
'enabled
'companies
'fullname
]
rd_kvar=[
'mUser
'cgo_users->name
'cPassword
''E'
'_gAzienda
'cgo_users->fullname
]
I
obj='Var
pag=6
pagelocal=True
prev=O1757
var_op='asgn
I
obj='Var
obj_type='N
pag=6
pagelocal=True
prev=O1755
var_op='asgn
I
obj='Select
pag=6
prev=O1754
sel_name='qbe_cpusers_max
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1755
fatherSonIndex=0
frm_calc='qbe_cpusers_max->MAXUSR
len=10
name='mUser
obj='Var
obj_type='N
pag=6
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='cpusers
father=O1744
fatherSonIndex=1
next=Icpitembatch.CPWrite
arch='cpusers_add
next=Icpitembatch.CPVarDecl
frm_calc='uNumMod + 1
len=10
name='uNumMod
obj='Var
obj_type='N
pag=6
prev=O1775
var_op='asgn
I
obj='Write
pag=6
prev=O1774
rd_kfield=[
'CODE
]
rd_kop=[
'=
]
rd_kvar=[
'nUser
]
wr_field=[
'CODDIP
]
wr_op=[
'=
]
wr_var=[
'cgo_users->coddip
]
I
obj='Write
pag=6
rd_kfield=[
'code
]
rd_kop=[
'=
]
rd_kvar=[
'nUser
]
wr_field=[
'fullname
]
wr_op=[
'=
]
wr_var=[
'cgo_users->fullname
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=6
prev=O1742
rd_field=[
'code
]
rd_kfield=[
'name
]
rd_kvar=[
'cgo_users->name
]
rd_var=[
'nUser
]
I
obj='Var
obj_type='N
pag=6
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1728
fatherSonIndex=1
frm_calc='"Nessun Utente Inserito o Aggiornato"
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGLOG\'"+LRTrim(_gAzienda)+"'",'',20)
len=20
name='cProg
next=Icpitembatch.CPInsert
arch='log_app
obj='Insert
pag=6
prev=O1797
rd_kfield=[
'LOGCODICE
'LOGDATORA
'LOGUTENTE
'LOGTIPOPE
'LOGTESTO
'LOGTABELLA
'LOGCHIAVE
'LOGTYPE
]
rd_kvar=[
'cProg
'DateTime()
'1
''Import Dati'
'_gMsgProc
''UTENTI'
''NO RECORDS'
''S'
]
I
obj='Var
pag=6
prev=O1796
var_op='asgn
I
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=6
prev=O1725
sel_name='qbe_cgo_users_totali
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1726
fatherSonIndex=0
frm_calc='qbe_cgo_users_totali->TOTUSR
len=10
name='_totale
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O1724
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O1723
var_op='asgn
I
obj='Remark
pag=6
prev=O1722
I
obj='Var
pag=6
pagelocal=True
prev=O1721
I
obj='Var
obj_type='N
pag=6
pagelocal=True
prev=O1720
I
obj='Var
obj_type='N
pag=6
pagelocal=True
prev=O1719
I
obj='Remark
pag=6
x=14
y=21
I
Icpitembatch.CPRemark
frm_calc='Effettua le verifiche sui soggetti
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=7
prev=O1806
sel_field='*
sel_name='cgo_soggetti
sel_where='cgo_soggetti->CONNES=_codsog
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1807
fatherSonIndex=0
frm_calc=[
'Empty(cgo_soggetti->NASCOMUN) and Empty(cgo_soggetti->NASSTATO)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPBeginEnd
comment='Controllo dati documento
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cgo_soggetti->DATANASC)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cgo_soggetti->PAESE)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPBeginEnd
comment='Controllo codice fiscale (Formale)
h=[
19
19
]
obj='Begin
pag=7
prev=O1819
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1822
fatherSonIndex=0
frm_calc=[
'not(arfn_chkcodfis(cgo_soggetti->CONNES,cgo_soggetti->PAESE,cgo_soggetti->CFESTERO))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(arfn_cgo_calccodfis(Upper(LRTrim(cgo_soggetti->COGNOME)),Upper(LRTrim(cgo_soggetti->NOME)),cgo_soggetti->DATANASC,Upper(LRTrim(cgo_soggetti->NASCOMUN)),Upper(LRTrim(cgo_soggetti->NASSTATO)),Upper(LRTrim(cgo_soggetti->SESSO)),Upper(LRTrim(cgo_soggetti->NASPROV)),Upper(LRTrim(cgo_soggetti->CONNES)),''))
]
h=[
19
19
]
obj='If
pag=7
prev=O1826
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1829
fatherSonIndex=0
frm_calc='_txterr + 'Codice Fiscale non coerente con dati anagrafici' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=7
prev=O1834
var_op='asgn
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1826
fatherSonIndex=0
frm_calc='_txterr + 'Codice Fiscale Formalmente non valido' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=7
prev=O1839
var_op='asgn
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=7
prev=O1816
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1819
fatherSonIndex=0
frm_calc='_txterr + 'Manca il paese di residenza del soggetto' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=7
prev=O1845
var_op='asgn
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1819
fatherSonIndex=1
frm_calc=[
'cgo_soggetti->PAESE='086'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1848
fatherSonIndex=0
frm_calc=[
'Empty(cgo_soggetti->DOMICILIO)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cgo_soggetti->DESCCIT)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=7
prev=O1853
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1856
fatherSonIndex=0
frm_calc='_txterr + 'Manca il comune di residenza' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=7
prev=O1861
var_op='asgn
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1856
fatherSonIndex=1
frm_calc='''
len=40
name='_cdescit
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_cdescit)
]
h=[
19
19
]
obj='If
pag=7
prev=O1865
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1867
fatherSonIndex=0
frm_calc='_txterr + 'Città di residenza intestatario operazione errata' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=7
prev=O1872
var_op='asgn
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=7
prev=O1864
sel_field='*
sel_name='tbcitta
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1865
fatherSonIndex=0
frm_calc=[
'LRTrim(Left(tbcitta->CITTA,30))=Upper(LRTrim(cgo_soggetti->DESCCIT)) and tbcitta->PROV=cgo_soggetti->PROVINCIA
]
h=[
19
19
]
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1877
fatherSonIndex=0
frm_calc='tbcitta->CITTA
len=40
name='_cdescit
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=7
prev=O1882
I
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1853
fatherSonIndex=0
frm_calc='_txterr + "Manca il domicilio del soggetto" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=7
prev=O1889
var_op='asgn
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1848
fatherSonIndex=1
frm_calc=[
'Upper(LRTrim(cgo_soggetti->PROVINCIA)) <> 'EE' and not(Empty(cgo_soggetti->PROVINCIA))
]
h=[
19
19
]
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1893
fatherSonIndex=0
frm_calc='_txterr + "Provincia errata per soggetto residente all'estero" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=7
prev=O1898
var_op='asgn
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=7
prev=O1814
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1816
fatherSonIndex=0
frm_calc='_txterr + "Manca la data di nascita del soggetto" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=7
prev=O1905
var_op='asgn
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1816
fatherSonIndex=1
frm_calc=[
'cgo_soggetti->DATANASC > Date()
]
h=[
19
19
]
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1908
fatherSonIndex=0
frm_calc='_txterr + "Data di nascita del soggetto errata" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=7
prev=O1913
var_op='asgn
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=7
prev=O1811
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1814
fatherSonIndex=0
frm_calc=[
'_flglight='N' or (_flglight='S' and (cgo_soggetti->FLGLIGHT='N' or Empty(cgo_soggetti->FLGLIGHT)))
]
h=[
19
19
]
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1919
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(cgo_soggetti->AUTRILASC))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cgo_soggetti->NUMDOCUM))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cgo_soggetti->TIPODOC))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cgo_soggetti->DATARILASC)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cgo_soggetti->DATAVALI)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=7
prev=O1933
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1936
fatherSonIndex=0
frm_calc='_txterr + "Manca data scadenza del documento del soggetto" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_recOK
obj='Var
obj_type='N
pag=7
prev=O1941
var_op='asgn
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1936
fatherSonIndex=1
frm_calc=[
'cgo_soggetti->DATAVALI < cgo_soggetti->DATARILASC
]
h=[
19
19
]
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1944
fatherSonIndex=0
frm_calc='_txterr + "Data scadenza del documento del soggetto inferiore alla data di rilascio" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=7
prev=O1949
var_op='asgn
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=7
prev=O1930
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1933
fatherSonIndex=0
frm_calc='_txterr + "Manca data rilascio del documento del soggetto" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=7
prev=O1955
var_op='asgn
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1933
fatherSonIndex=1
frm_calc=[
'cgo_soggetti->DATARILASC > Date()
]
h=[
19
19
]
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1958
fatherSonIndex=0
frm_calc='_txterr + "Data rilascio del documento del soggetto errata" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=7
prev=O1963
var_op='asgn
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=7
prev=O1927
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1930
fatherSonIndex=0
frm_calc='_txterr + 'Manca tipo documento identità' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=7
prev=O1969
var_op='asgn
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1930
fatherSonIndex=1
frm_calc='''
len=2
name='_ctipdoc
next=Icpitembatch.CPRead
arch='tbtipdoc
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_ctipdoc))
]
h=[
19
19
]
obj='If
pag=7
prev=O1973
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1974
fatherSonIndex=0
frm_calc='_txterr + 'Tipo documento identità errato' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=7
prev=O1979
var_op='asgn
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=7
prev=O1972
rd_field=[
'TIPDOC
]
rd_kfield=[
'TIPDOC
]
rd_kvar=[
'cgo_soggetti->TIPODOC
]
rd_var=[
'_ctipdoc
]
I
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=7
prev=O1924
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1927
fatherSonIndex=0
frm_calc='_txterr + 'Manca numero documento identità' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=7
prev=O1989
var_op='asgn
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1924
fatherSonIndex=0
frm_calc='_txterr + 'Manca autorità rilascio del documento' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=7
prev=O1994
var_op='asgn
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1811
fatherSonIndex=0
frm_calc='_txterr + 'Manca il Comune o lo Stato di Nascita' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=7
prev=O2001
var_op='asgn
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1811
fatherSonIndex=1
frm_calc=[
'Empty(cgo_soggetti->NASPROV)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2004
fatherSonIndex=0
frm_calc='_txterr + 'Manca la provincia di Nascita' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=7
prev=O2009
var_op='asgn
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2004
fatherSonIndex=1
frm_calc=[
'Upper(LRTrim(cgo_soggetti->NASPROV))='EE'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2012
fatherSonIndex=0
frm_calc='''
len=40
name='_cdessta
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_cdessta)
]
h=[
19
19
]
obj='If
pag=7
prev=O2018
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbstatna
father=O2019
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_cdessta)
]
h=[
19
19
]
obj='If
pag=7
prev=O2024
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2025
fatherSonIndex=0
frm_calc='_txterr + 'Stato di nascita intestatario operazione errato' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=7
prev=O2030
var_op='asgn
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=7
rd_field=[
'DESCRI
]
rd_kfield=[
'DESCRI
]
rd_kvar=[
'Upper(LRTrim(cgo_soggetti->NASSTATO))
]
rd_var=[
'_cdessta
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=7
prev=O2017
rd_field=[
'DESCRI
]
rd_kfield=[
'DESCRI
]
rd_kvar=[
'Upper(LRTrim(cgo_soggetti->NASSTATO))
]
rd_var=[
'_cdessta
]
I
obj='Var
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2012
fatherSonIndex=1
frm_calc='''
len=40
name='_cdescit
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_cdescit)
]
h=[
19
19
]
obj='If
pag=7
prev=O2044
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcittna
father=O2046
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_cdescit)
]
h=[
19
19
]
obj='If
pag=7
prev=O2051
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2052
fatherSonIndex=0
frm_calc='_txterr + 'Città di nascita intestatario operazione errata' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=7
prev=O2057
var_op='asgn
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=7
rd_field=[
'CITTA
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'Upper(LRTrim(cgo_soggetti->NASCOMUN))
]
rd_var=[
'_cdescit
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=7
prev=O2043
sel_field='*
sel_name='tbcitta
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2044
fatherSonIndex=0
frm_calc=[
'LRTrim(Left(tbcitta->CITTA,30))=Upper(LRTrim(cgo_soggetti->NASCOMUN)) and tbcitta->PROV=cgo_soggetti->NASPROV
]
h=[
19
19
]
obj='If
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2067
fatherSonIndex=0
frm_calc='tbcitta->CITTA
len=40
name='_cdescit
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=7
prev=O2072
I
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=7
x=15
y=18
I
Icpitembatch.CPRemark
frm_calc='Scrive le operazioni corrette
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=8
prev=O2080
sel_field='*
sel_name='cgo_telematico
sel_where='cgo_telematico->SNAINUMOPE=_numopetele
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Inizializza Variabili per scrittura
father=O2081
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc=''D'
len=1
name='_locrap
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_tiporap
next=Icpitembatch.CPRead
arch='anarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_tiporap))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Left(DateTimeToChar(cgo_telematico->CADATAORA),8)
len=8
name='xData
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(xData)
len=8
name='_datope
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datreg
next=Icpitembatch.CPBeginEnd
comment='Selezione Causali
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xCF
next=Icpitembatch.CPVarDecl
frm_calc='cgo_telematico->CATIPGIO
len=5
name='_catipgio
next=Icpitembatch.CPVarDecl
frm_calc='cgo_telematico->CATIPCON
len=5
name='_catipcon
next=Icpitembatch.CPVarDecl
frm_calc='cgo_telematico->CAPV_COD
len=10
name='_capv_cod
next=Icpitembatch.CPVarDecl
frm_calc='cgo_telematico->CADATAORA
len=14
name='_cadataora
next=Icpitembatch.CPIfElse
frm_calc=[
'cgo_telematico->ENV='W'
'cgo_telematico->ENV='A' or cgo_telematico->ENV='V'
]
h=[
19
19
19
]
obj='If
pag=8
prev=O2104
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2105
fatherSonIndex=0
frm_calc='cgo_telematico->TOTLIRE
len=15
name='_tottele
next=Icpitembatch.CPVarDecl
frm_calc='cgo_telematico->CODLOB
len=3
name='_codlob
next=Icpitembatch.CPVarDecl
frm_calc='cgo_telematico->TIPOGIOCO
len=3
name='_tipgio
next=Icpitembatch.CPVarDecl
frm_calc='cgo_telematico->CACODICE
len=5
name='_cacodice
next=Icpitembatch.CPVarDecl
frm_calc='cgo_telematico->CAIDBIGLIETTO
len=28
name='_biglietto
next=Icpitembatch.CPIfElse
frm_calc=[
'_flgaui='N'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPExec
check='page
frm_calc='11
obj='Exec
pag=8
prev=O2115
I
obj='If
pag=8
prev=O2114
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2115
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSRAZ1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PSRAZ2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPSRZ\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='nIntest
next=Icpitembatch.CPInsert
arch='sraziobo
next=Icpitembatch.CPIfElse
frm_calc=[
'_locrap='D'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_mezpagam='I' or _mezpagam='E' or _mezpagam='P'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(cgo_telematico->IBAN))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='sNumero + 1
len=10
name='sNumero
obj='Var
obj_type='N
pag=8
prev=O2132
var_op='asgn
I
obj='If
pag=8
prev=O2129
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O2132
fatherSonIndex=0
frm_calc=[
'Left(cgo_telematico->IBAN,2)='IT'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2138
fatherSonIndex=0
frm_calc='Substr(cgo_telematico->IBAN,6,5)+"-"+Substr(cgo_telematico->IBAN,11,5)
len=11
name='abicab
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=8
prev=O2143
sel_field='*
sel_name='inter2bo
sel_where='inter2bo->CODINTER=abicab
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='sraziobo
father=O2144
fatherSonIndex=0
obj='Write
pag=8
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'inter2bo->TIPINTER
'abicab
'inter2bo->PAESE
'inter2bo->DESCCIT
'inter2bo->PROVINCIA
'inter2bo->CODCAB
'inter2bo->RAGSOC
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2138
fatherSonIndex=1
frm_calc='Left(cgo_telematico->IBAN,11)
len=11
name='abicab
next=Icpitembatch.CPWrite
arch='sraziobo
obj='Write
pag=8
prev=O2157
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CODINT2
]
wr_op=[
'=
]
wr_var=[
'abicab
]
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=8
prev=O2126
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2129
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=8
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=xCF
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='sraziobo
father=O2169
fatherSonIndex=0
obj='Write
pag=8
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CONNESBEN
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
'personbo->CONNES
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=8
prev=O2125
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPSelect
father=O2126
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=8
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=cgo_telematico->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2184
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=10
name='nIntest
obj='Var
obj_type='N
pag=8
prev=O2188
var_op='asgn
I
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2188
fatherSonIndex=0
frm_calc='intestbo->CODINTER
len=16
name='xCF
next=Icpitembatch.CPWrite
arch='sraziobo
obj='Write
pag=8
prev=O2194
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'intestbo->CODINTER
]
I
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='slientifrz
father=O2188
fatherSonIndex=1
obj='Insert
pag=8
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPSelect
father=O2126
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=8
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=cgo_telematico->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2209
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=10
name='nIntest
obj='Var
obj_type='N
pag=8
prev=O2213
var_op='asgn
I
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2213
fatherSonIndex=0
frm_calc='xntestbo->CODINTER
len=16
name='xCF
next=Icpitembatch.CPWrite
arch='sraziobo
obj='Write
pag=8
prev=O2219
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xntestbo->CODINTER
]
I
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='slientifrz
father=O2213
fatherSonIndex=1
obj='Insert
pag=8
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'xntestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=8
prev=O2124
rd_kfield=[
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'DATAIMP
'DATAOPE
'DATAREG
'DESCCIT
'DUCOLLEG
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'IPCOLLEG
'NOPROT
'NUMPROG
'OPRAP
'ORACOLLEG
'PRGIMPFRZ
'PROVINCIA
'RAPPORTO
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
'MTCN
]
rd_kvar=[
'xData
'xData
'DateToChar(Date())
'_codana
'_cabinter
'cgo_telematico->CODDIPE
'_codinter
'_codsin
'Date()
'_datope
'Date()
'_citinter
'cgo_telematico->DUCOLLEG
''0'
''0'
''3'
'_tiporap
'cOpeProg1
'xData+cOpeProg2+'0'
'cgo_telematico->IPCOLLEG
'0
'cOpeProg2
''1'
'cgo_telematico->ORACOLLEG
'nProgImp
'_prvinter
'cgo_telematico->RAPPORTO
'cgo_telematico->CAIDBIGLIETTO
'_segno
''0'
''1'
'_tipinter
''0'
'_tipope
'0
'cgo_telematico->TOTLIRE * 100
''242'
'cgo_telematico->ENV
]
I
obj='Var
obj_type='N
pag=8
prev=O2123
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O2122
var_op='asgn
I
obj='Var
pag=8
prev=O2121
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2115
fatherSonIndex=1
frm_calc=[
'cgo_telematico->TOTLIRE >= _limoper
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O2237
fatherSonIndex=0
frm_calc='12
obj='Exec
pag=8
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O2237
fatherSonIndex=1
frm_calc='13
obj='Exec
pag=8
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=8
prev=O2113
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O2112
var_op='asgn
I
obj='Var
pag=8
prev=O2111
var_op='asgn
I
obj='Var
pag=8
prev=O2110
var_op='asgn
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2105
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGIMCGOA\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc=''A'
len=1
name='_flgvnp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='_numass
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='_numope
next=Icpitembatch.CPIfElse
frm_calc=[
'cgo_telematico->ENV='V'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numope)))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='oNumero + 1
len=10
name='oNumero
obj='Var
obj_type='N
pag=8
prev=O2257
var_op='asgn
I
obj='If
pag=8
prev=O2254
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2257
fatherSonIndex=0
frm_calc=[
'_omulti='S'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_omulti='N' or (_omulti='S' and _omultic='S')
]
h=[
19
19
]
obj='If
pag=8
prev=O2263
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='bat
father=O2266
fatherSonIndex=0
frm_calc='arrt_writelog_imp('ELAB','CGO_OPERAZIONI',"Sto associando l'operazione con IDBIGLIETTO:"+_seekid)
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(nProgOpe)
len=15
name='cProgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_snai_oper_save(cProgImp,'X',_gAzienda)
obj='Exec
pag=8
prev=O2272
I
obj='Var
pag=8
prev=O2271
var_op='asgn
I
obj='Exec
pag=8
I
I
]
w=[
150
150
]
I
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2263
fatherSonIndex=0
frm_calc=''S'
len=1
name='_omultic
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_omultic='S'
]
h=[
19
19
]
obj='If
pag=8
prev=O2278
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2280
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_MsgAss + 'Associata Operazione Multipla Completa n. '+_numope + NL
len=10
name='_MsgAss
obj='Var
obj_type='M
pag=8
prev=O2285
var_op='asgn
I
obj='Select
pag=8
sel_field='*
sel_name='cgo_operazioni_dl_multi
sel_where='cgo_operazioni_dl_multi->SNAINUMOPE=_numope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2285
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGNUMOPE\'"+LRTrim(_gAzienda)+"'","",15)
len=15
name='nProgOpe
next=Icpitembatch.CPInsert
arch='cgo_operazioni
obj='Insert
pag=8
prev=O2290
rd_kfield=[
'ASSEGNO
'ATTIV
'AUTOM
'AUTRILASC
'CACODICE
'CADATAORA
'CADATIMP
'CAFLGOPE
'CAIDBIGLIETTO
'CAP
'CAPV_COD
'CATIPCON
'CATIPGIO
'CDATOPE
'CDATREG
'CFESTERO
'CGODIPCOM
'CGOFLGVLT
'CGOFLGVNP
'CGOTIPOPE
'CODANA
'CODCAB
'CODCABDIP
'CODDIPE
'CODFISC
'CODINTER
'CODLOB
'CODVOC
'COGNOME
'DATAIMP
'DATANASC
'DATAOPE
'DATAREG
'DATARILASC
'DATAVALI
'DESCCIT
'DESCCITDIP
'DOMICILIO
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLGDOCALL
'IBAN
'IDDOCALL
'MEZPAGAM
'NASCOMUN
'NASSTATO
'NOME
'NOPROT
'NOTE
'NUMDOCUM
'NUMOPEDL
'OPRAP
'PAESE
'PEP
'PROVINCIA
'PROVINCIADIP
'RAGSOC
'RAMOGRUP
'RAPPORTO
'RDCODAUT
'RDLOCAUT
'SEGNO
'SESSO
'SETTSINT
'SNAINUMOPE
'SOTGRUP
'STATOREG
'TIPINTER
'TIPODOC
'TIPOGIOCO
'TIPOINF
'TIPOOPRAP
'TIPOPEDL
'TIPOPERS
'TOTCONT
'TOTLIRE
'VALUTA
'VLTPLAT
]
rd_kvar=[
'cgo_operazioni_dl_multi->ASSEGNO
'cgo_operazioni_dl_multi->ATTIV
'cgo_operazioni_dl_multi->AUTOM
'cgo_operazioni_dl_multi->AUTRILASC
'cgo_operazioni_dl_multi->CACODICE
'_cadataora
'Date()
'cgo_operazioni_dl_multi->CAFLGOPE
'cgo_operazioni_dl_multi->CAIDBIGLIETTO
'cgo_operazioni_dl_multi->CAP
'_capv_cod
'_catipcon
'_catipgio
'xData
'DateToChar(Date())
'cgo_operazioni_dl_multi->CFESTERO
''S'
'cgo_operazioni_dl_multi->CGOFLGVLT
'cgo_operazioni_dl_multi->CGOFLGVNP
'cgo_telematico->ENV
'_codana
'cgo_operazioni_dl_multi->CODCAB
'_cabinter
'cgo_telematico->CODDIPE
'cgo_operazioni_dl_multi->CODFISC
'_codinter
'cgo_telematico->CODLOB
'_codsin
'cgo_operazioni_dl_multi->COGNOME
'Date()
'cgo_operazioni_dl_multi->DATANASC
'_datope
'Date()
'cgo_operazioni_dl_multi->DATARILASC
'cgo_operazioni_dl_multi->DATAVALI
'cgo_operazioni_dl_multi->DESCCIT
'_citinter
'cgo_operazioni_dl_multi->DOMICILIO
'cgo_operazioni_dl_multi->FLAGCONT
''0'
''3'
'_tiporap
'iif(Empty(cgo_operazioni_dl_multi->FLGDOCALL),'N',cgo_operazioni_dl_multi->FLGDOCALL)
'cgo_operazioni_dl_multi->IBAN
'iif(Empty(cgo_operazioni_dl_multi->IDDOCALL),LibreriaMit.nextUID(),cgo_operazioni_dl_multi->IDDOCALL)
'cgo_operazioni_dl_multi->MEZPAGAM
'cgo_operazioni_dl_multi->NASCOMUN
'cgo_operazioni_dl_multi->NASSTATO
'cgo_operazioni_dl_multi->NOME
'0
'cgo_operazioni_dl_multi->NOTE
'cgo_operazioni_dl_multi->NUMDOCUM
'_numope
''1'
'cgo_operazioni_dl_multi->PAESE
'cgo_operazioni_dl_multi->PEP
'cgo_operazioni_dl_multi->PROVINCIA
'_prvinter
'cgo_operazioni_dl_multi->RAGSOC
'cgo_operazioni_dl_multi->RAMOGRUP
'cgo_telematico->RAPPORTO
'cgo_operazioni_dl_multi->RDCODAUT
'cgo_operazioni_dl_multi->RDLOCAUT
'_segno
'cgo_operazioni_dl_multi->SESSO
'cgo_operazioni_dl_multi->SETTSINT
'nProgOpe
'cgo_operazioni_dl_multi->SOTGRUP
''0'
'cgo_operazioni_dl_multi->TIPINTER
'cgo_operazioni_dl_multi->TIPODOC
'cgo_telematico->TIPOGIOCO
''1'
'_tipope
''M'
'cgo_operazioni_dl_multi->TIPOPERS
'cgo_operazioni_dl_multi->TOTCONT
'cgo_operazioni_dl_multi->TOTLIRE
''242'
'_vpcodice
]
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=8
prev=O2277
sel_field='*
sel_name='cgo_operazioni_dl_multi_dt
sel_where='cgo_operazioni_dl_multi_dt->SNAINUMOPE=_numope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2278
fatherSonIndex=0
frm_calc=[
'cgo_operazioni_dl_multi_dt->FLGFULL='N' or Empty(cgo_operazioni_dl_multi_dt->FLGFULL)
]
h=[
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2298
fatherSonIndex=0
frm_calc=''N'
len=1
name='_omultic
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPSelect
father=O2263
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cgo_telematico->ENV='V'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
prev=O2307
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2309
fatherSonIndex=0
frm_calc='_MsgAss + 'Associata Operazione VLT n. '+_numope + NL
len=10
name='_MsgAss
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2309
fatherSonIndex=1
frm_calc=[
'_oidb='N'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2316
fatherSonIndex=0
frm_calc='_MsgAss + 'Associata Operazione Agenzia con ID Biglietto '+_idb+NL
len=10
name='_MsgAss
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2316
fatherSonIndex=1
frm_calc='_MsgAss + 'Associata Operazione Agenzia con ID Biglietto '+_idb + ' (Solo ID)'+NL
len=10
name='_MsgAss
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=8
sel_field='*
sel_name='cgo_operazioni_dl
sel_where='cgo_operazioni_dl->SNAINUMOPE=_numope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2307
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGNUMOPE\'"+LRTrim(_gAzienda)+"'","",15)
len=15
name='nProgOpe
next=Icpitembatch.CPInsert
arch='cgo_operazioni
obj='Insert
pag=8
prev=O2328
rd_kfield=[
'ASSEGNO
'ATTIV
'AUTRILASC
'CACODICE
'CADATAORA
'CAFLGOPE
'CAIDBIGLIETTO
'CAP
'CAPV_COD
'CATIPCON
'CATIPGIO
'CDATOPE
'CDATREG
'CFESTERO
'CGODIPCOM
'CGOFLGVLT
'CGOFLGVNP
'CGOTIPOPE
'CODANA
'CODCAB
'CODCABDIP
'CODDIPE
'CODFISC
'CODINTER
'CODLOB
'CODVOC
'COGNOME
'DATAIMP
'DATANASC
'DATAOPE
'DATAREG
'DATARILASC
'DATAVALI
'DESCCIT
'DESCCITDIP
'DOMICILIO
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLGDOCALL
'IBAN
'IDDOCALL
'MEZPAGAM
'NASCOMUN
'NASSTATO
'NOME
'NOPROT
'NOTE
'NUMDOCUM
'NUMOPEDL
'OPRAP
'PAESE
'PEP
'PROVINCIA
'PROVINCIADIP
'RAGSOC
'RAMOGRUP
'RAPPORTO
'RDCODAUT
'RDLOCAUT
'SEGNO
'SESSO
'SETTSINT
'SNAINUMOPE
'SOTGRUP
'STATOREG
'TIPINTER
'TIPODOC
'TIPOGIOCO
'TIPOINF
'TIPOOPRAP
'TIPOPEDL
'TIPOPERS
'TOTCONT
'TOTLIRE
'VALUTA
'VLTPLAT
]
rd_kvar=[
'cgo_operazioni_dl->ASSEGNO
'cgo_operazioni_dl->ATTIV
'cgo_operazioni_dl->AUTRILASC
'cgo_telematico->CACODICE
'_cadataora
'cgo_operazioni_dl->CAFLGOPE
'cgo_telematico->CAIDBIGLIETTO
'cgo_operazioni_dl->CAP
'_capv_cod
'_catipcon
'_catipgio
'xData
'DateToChar(Date())
'cgo_operazioni_dl->CFESTERO
''S'
'cgo_operazioni_dl->CGOFLGVLT
'cgo_operazioni_dl->CGOFLGVNP
'cgo_telematico->ENV
'_codana
'cgo_operazioni_dl->CODCAB
'_cabinter
'cgo_telematico->CODDIPE
'cgo_operazioni_dl->CODFISC
'_codinter
'cgo_telematico->CODLOB
'_codsin
'cgo_operazioni_dl->COGNOME
'Date()
'cgo_operazioni_dl->DATANASC
'_datope
'Date()
'cgo_operazioni_dl->DATARILASC
'cgo_operazioni_dl->DATAVALI
'cgo_operazioni_dl->DESCCIT
'_citinter
'cgo_operazioni_dl->DOMICILIO
'cgo_operazioni_dl->FLAGCONT
''0'
''3'
'_tiporap
'iif(Empty(cgo_operazioni_dl->FLGDOCALL),'N',cgo_operazioni_dl->FLGDOCALL)
'cgo_operazioni_dl->IBAN
'iif(Empty(cgo_operazioni_dl->IDDOCALL),LibreriaMit.nextUID(),cgo_operazioni_dl->IDDOCALL)
'cgo_operazioni_dl->MEZPAGAM
'cgo_operazioni_dl->NASCOMUN
'cgo_operazioni_dl->NASSTATO
'cgo_operazioni_dl->NOME
'0
'cgo_operazioni_dl->NOTE
'cgo_operazioni_dl->NUMDOCUM
'_numope
''1'
'cgo_operazioni_dl->PAESE
'cgo_operazioni_dl->PEP
'cgo_operazioni_dl->PROVINCIA
'_prvinter
'cgo_operazioni_dl->RAGSOC
'cgo_operazioni_dl->RAMOGRUP
'cgo_telematico->RAPPORTO
'cgo_operazioni_dl->RDCODAUT
'cgo_operazioni_dl->RDLOCAUT
'_segno
'cgo_operazioni_dl->SESSO
'cgo_operazioni_dl->SETTSINT
'nProgOpe
'cgo_operazioni_dl->SOTGRUP
''0'
'cgo_operazioni_dl->TIPINTER
'cgo_operazioni_dl->TIPODOC
'cgo_telematico->TIPOGIOCO
''1'
'_tipope
''S'
'cgo_operazioni_dl->TIPOPERS
'cgo_operazioni_dl->TOTCONT
'cgo_telematico->TOTLIRE
''242'
'_vpcodice
]
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='bat
father=O2257
fatherSonIndex=1
frm_calc='arrt_writelog_imp('INSERT','CGO_OPERAZIONI',"Sto inserendo l'operazione con IDBIGLIETTO:"+_seekid)
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGNUMOPE\'"+LRTrim(_gAzienda)+"'","",15)
len=15
name='nProgOpe
next=Icpitembatch.CPInsert
arch='cgo_operazioni
obj='Insert
pag=8
prev=O2336
rd_kfield=[
'ASSEGNO
'CACODICE
'CADATAORA
'CAFLGOPE
'CAIDBIGLIETTO
'CAPV_COD
'CATIPCON
'CATIPGIO
'CDATOPE
'CDATREG
'CGODIPCOM
'CGOFLGVLT
'CGOFLGVNP
'CGOTIPOPE
'CODANA
'CODCABDIP
'CODDIPE
'CODINTER
'CODLOB
'CODVOC
'DATAIMP
'DATAOPE
'DATAREG
'DESCCITDIP
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLGDOCALL
'IDDOCALL
'NOPROT
'OPRAP
'PEP
'PROVINCIADIP
'RAPPORTO
'SEGNO
'SNAINUMOPE
'STATOREG
'TIPOGIOCO
'TIPOINF
'TIPOOPRAP
'TIPOPEDL
'TOTCONT
'TOTLIRE
'VALUTA
'VLTPLAT
]
rd_kvar=[
'_numass
'cgo_telematico->CACODICE
'_cadataora
'_flgope
'cgo_telematico->CAIDBIGLIETTO
'_capv_cod
'_catipcon
'_catipgio
'xData
'DateToChar(Date())
''N'
'_flgvlt
'_flgvnp
'cgo_telematico->ENV
'_codana
'_cabinter
'cgo_telematico->CODDIPE
'_codinter
'cgo_telematico->CODLOB
'_codsin
'Date()
'_datope
'Date()
'_citinter
''0'
''0'
''3'
'_tiporap
''N'
'LibreriaMit.nextUID()
'0
''1'
''N'
'_prvinter
'cgo_telematico->RAPPORTO
'_segno
'nProgOpe
''0'
'cgo_telematico->TIPOGIOCO
''1'
'_tipope
''S'
'0
'cgo_telematico->TOTLIRE
''242'
'_vpcodice
]
I
obj='Var
pag=8
prev=O2335
var_op='asgn
I
obj='Exec
pag=8
I
I
]
w=[
150
150
150
]
I
obj='If
pag=8
prev=O2253
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2254
fatherSonIndex=0
frm_calc='''
len=15
name='_numope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_numope=''
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numope))) and cgo_telematico->TOTLIRE > 1000
]
h=[
19
19
]
obj='If
pag=8
prev=O2346
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O2349
fatherSonIndex=0
frm_calc='9
obj='Exec
pag=8
I
I
]
w=[
150
150
]
I
obj='If
pag=8
prev=O2344
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2346
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=8
sel_field='*
sel_name='cgo_operazioni_dl_multi
sel_where='cgo_operazioni_dl_multi->CODDIPE=cgo_telematico->CODDIPE and cgo_operazioni_dl_multi->TIPOGIOCO=cgo_telematico->TIPOGIOCO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2358
fatherSonIndex=0
frm_calc='cgo_operazioni_dl_multi->ASSEGNO
len=25
name='_numass
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=8
prev=O2362
sel_field='*
sel_name='cgo_operazioni_dl_multi_dt
sel_where='cgo_operazioni_dl_multi_dt->SNAINUMOPE=cgo_operazioni_dl_multi->SNAINUMOPE and cgo_operazioni_dl_multi_dt->DATOPE= _datope and cgo_operazioni_dl_multi_dt->TOTLIRE=cgo_telematico->TOTLIRE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2363
fatherSonIndex=0
frm_calc='cgo_operazioni_dl_multi_dt->SNAINUMOPE
len=15
name='_numope
next=Icpitembatch.CPWrite
arch='cgo_operazioni_dl_multi_dt
next=Icpitembatch.CPVarDecl
frm_calc=''S'
len=1
name='_omulti
obj='Var
pag=8
prev=O2368
var_op='asgn
I
obj='Write
pag=8
prev=O2367
rd_kfield=[
'SNAINUMOPE
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'cgo_operazioni_dl_multi_dt->SNAINUMOPE
'cgo_operazioni_dl_multi_dt->CPROWNUM
]
wr_field=[
'TOTLIRE
'FLGFULL
]
wr_op=[
'=
'=
]
wr_var=[
'cgo_telematico->TOTLIRE
''S'
]
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=8
prev=O2343
sel_field='cgo_operazioni_dl->SNAINUMOPE,cgo_operazioni_dl->ASSEGNO
sel_name='cgo_operazioni_dl
sel_where='cgo_operazioni_dl->DATAOPE= _datope and cgo_operazioni_dl->CODDIPE=cgo_telematico->CODDIPE and cgo_operazioni_dl->TOTLIRE=cgo_telematico->TOTLIRE and cgo_operazioni_dl->TIPOGIOCO=cgo_telematico->TIPOGIOCO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2344
fatherSonIndex=0
frm_calc='cgo_operazioni_dl->SNAINUMOPE
len=15
name='_numope
next=Icpitembatch.CPVarDecl
frm_calc='cgo_operazioni_dl->ASSEGNO
len=25
name='_numass
obj='Var
pag=8
prev=O2381
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2254
fatherSonIndex=1
frm_calc='''
len=28
name='_idb
next=Icpitembatch.CPVarDecl
frm_calc=''N'
len=1
name='_oidb
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='_numope
next=Icpitembatch.CPVarDecl
frm_calc='iif(Right(LRTrim(cgo_telematico->CAIDBIGLIETTO),8)='00000000',Left(LRTrim(cgo_telematico->CAIDBIGLIETTO),12),cgo_telematico->CAIDBIGLIETTO)
len=20
name='_seekid
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_numope))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_numope))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numope))) and (cgo_telematico->TOTLIRE > 1000 and  cgo_telematico->TOTLIRE < 15000)
]
h=[
19
19
]
obj='If
pag=8
prev=O2394
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O2397
fatherSonIndex=0
frm_calc='9
obj='Exec
pag=8
I
I
]
w=[
150
150
]
I
obj='If
pag=8
prev=O2391
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2394
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=8
sel_field='*
sel_name='cgo_operazioni_dl_multi
sel_where='cgo_operazioni_dl_multi->CODDIPE=cgo_telematico->CODDIPE and cgo_operazioni_dl->TIPOGIOCO=cgo_telematico->TIPOGIOCO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2406
fatherSonIndex=0
frm_calc='cgo_operazioni_dl_multi->ASSEGNO
len=25
name='_numass
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_numope))
]
h=[
19
19
]
obj='If
pag=8
prev=O2411
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2413
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=8
sel_field='*
sel_name='cgo_operazioni_dl_multi_dt
sel_where='cgo_operazioni_dl_multi_dt->SNAINUMOPE=cgo_operazioni_dl_multi->SNAINUMOPE and cgo_operazioni_dl_multi_dt->DATOPE= _datope and cgo_operazioni_dl_multi_dt->CAIDBIGLIETTO=_seekid
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2418
fatherSonIndex=0
frm_calc='cgo_operazioni_dl_multi_dt->SNAINUMOPE
len=15
name='_numope
next=Icpitembatch.CPVarDecl
frm_calc=''S'
len=1
name='_omulti
next=Icpitembatch.CPWrite
arch='cgo_operazioni_dl_multi_dt
obj='Write
pag=8
prev=O2423
rd_kfield=[
'SNAINUMOPE
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'cgo_operazioni_dl_multi_dt->SNAINUMOPE
'cgo_operazioni_dl_multi_dt->CPROWNUM
]
wr_field=[
'TOTLIRE
'FLGFULL
]
wr_op=[
'=
'=
]
wr_var=[
'cgo_telematico->TOTLIRE
''S'
]
I
obj='Var
pag=8
prev=O2422
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=8
prev=O2410
sel_field='*
sel_name='cgo_operazioni_dl_multi_dt
sel_where='cgo_operazioni_dl_multi_dt->SNAINUMOPE=cgo_operazioni_dl_multi->SNAINUMOPE and cgo_operazioni_dl_multi_dt->DATOPE= _datope and cgo_operazioni_dl_multi_dt->TOTLIRE=cgo_telematico->TOTLIRE and cgo_operazioni_dl_multi_dt->CAIDBIGLIETTO=_seekid
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2411
fatherSonIndex=0
frm_calc='cgo_operazioni_dl_multi_dt->SNAINUMOPE
len=15
name='_numope
next=Icpitembatch.CPVarDecl
frm_calc=''S'
len=1
name='_omulti
next=Icpitembatch.CPWrite
arch='cgo_operazioni_dl_multi_dt
obj='Write
pag=8
prev=O2436
rd_kfield=[
'SNAINUMOPE
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'cgo_operazioni_dl_multi_dt->SNAINUMOPE
'cgo_operazioni_dl_multi_dt->CPROWNUM
]
wr_field=[
'TOTLIRE
'FLGFULL
]
wr_op=[
'=
'=
]
wr_var=[
'cgo_telematico->TOTLIRE
''S'
]
I
obj='Var
pag=8
prev=O2435
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=8
prev=O2389
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2391
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=8
sel_field='cgo_operazioni_dl->SNAINUMOPE,cgo_operazioni_dl->ASSEGNO
sel_name='cgo_operazioni_dl
sel_where='cgo_operazioni_dl->DATAOPE= _datope and cgo_operazioni_dl->CODDIPE=cgo_telematico->CODDIPE and cgo_operazioni_dl->CAIDBIGLIETTO=_seekid and cgo_operazioni_dl->TIPOGIOCO=cgo_telematico->TIPOGIOCO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2449
fatherSonIndex=0
frm_calc='cgo_operazioni_dl->SNAINUMOPE
len=15
name='_numope
next=Icpitembatch.CPVarDecl
frm_calc='cgo_operazioni_dl->ASSEGNO
len=25
name='_numass
next=Icpitembatch.CPVarDecl
frm_calc='cgo_telematico->CAIDBIGLIETTO
len=28
name='_idb
next=Icpitembatch.CPVarDecl
frm_calc=''S'
len=1
name='_oidb
obj='Var
pag=8
prev=O2455
var_op='asgn
I
obj='Var
pag=8
prev=O2454
var_op='asgn
I
obj='Var
pag=8
prev=O2453
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=8
prev=O2388
sel_field='cgo_operazioni_dl->SNAINUMOPE,cgo_operazioni_dl->ASSEGNO
sel_name='cgo_operazioni_dl
sel_where='cgo_operazioni_dl->DATAOPE= _datope and cgo_operazioni_dl->CODDIPE=cgo_telematico->CODDIPE and cgo_operazioni_dl->TOTLIRE=cgo_telematico->TOTLIRE and cgo_operazioni_dl->CAIDBIGLIETTO=_seekid and cgo_operazioni_dl->TIPOGIOCO=cgo_telematico->TIPOGIOCO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2389
fatherSonIndex=0
frm_calc='cgo_operazioni_dl->SNAINUMOPE
len=15
name='_numope
next=Icpitembatch.CPVarDecl
frm_calc='cgo_operazioni_dl->ASSEGNO
len=25
name='_numass
next=Icpitembatch.CPVarDecl
frm_calc='cgo_telematico->CAIDBIGLIETTO
len=28
name='_idb
obj='Var
pag=8
prev=O2462
var_op='asgn
I
obj='Var
pag=8
prev=O2461
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
prev=O2387
var_op='asgn
I
obj='Var
pag=8
prev=O2386
var_op='asgn
I
obj='Var
pag=8
prev=O2385
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=8
prev=O2251
var_op='asgn
I
obj='Select
pag=8
prev=O2250
sel_field='*
sel_name='cgo_tbtipgio
sel_where='cgo_telematico->TIPOGIOCO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2251
fatherSonIndex=0
frm_calc=[
'cgo_telematico->TOTLIRE < cgo_tbtipgio->SOGTPGIO
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2468
fatherSonIndex=0
frm_calc='cgo_tbtipgio->DEFTPGIO
len=1
name='_flgvlt
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2468
fatherSonIndex=1
frm_calc='cgo_tbtipgio->DEFSPGIO
len=1
name='_flgvlt
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
prev=O2249
var_op='asgn
I
obj='Var
pag=8
prev=O2248
var_op='asgn
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='T
pag=8
prev=O2103
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O2102
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O2101
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O2100
var_op='asgn
I
obj='Var
pag=8
prev=O2098
var_op='asgn
I
obj='Begin
pag=8
prev=O2097
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2098
fatherSonIndex=0
frm_calc='''
len=4
name='_codana
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_codsin
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_flgaui
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_segno
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_tipope
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_flgope
next=Icpitembatch.CPVarDecl
frm_calc='iif(At(LRTrim(cgo_telematico->MEZPAGAM), '|I|E|P')=0,'A',LRTrim(cgo_telematico->MEZPAGAM))
len=1
name='_mezpagam
next=Icpitembatch.CPRead
arch='cgo_causali
next=Icpitembatch.CPIfElse
frm_calc=[
'_codana <> '26' and _codana <> '48' and _codana <> 'AA'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
prev=O2488
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2489
fatherSonIndex=0
frm_calc=''10'
len=2
name='_tipope
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2489
fatherSonIndex=1
frm_calc=[
'_segno = 'D'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2496
fatherSonIndex=0
frm_calc=''11'
len=2
name='_tipope
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2496
fatherSonIndex=1
frm_calc=''12'
len=2
name='_tipope
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=8
prev=O2487
rd_field=[
'CACODANA
'CACODSIN
'CASEGNO
'CAFLGAUI
'CAFLGOPE
]
rd_kfield=[
'CACODICE
'CATIPOPE
]
rd_kvar=[
'cgo_telematico->CACODICE
'_mezpagam
]
rd_var=[
'_codana
'_codsin
'_segno
'_flgaui
'_flgope
]
I
obj='Var
pag=8
prev=O2486
var_op='asgn
I
obj='Var
pag=8
prev=O2485
var_op='asgn
I
obj='Var
pag=8
pagelocal=True
prev=O2484
var_op='asgn
I
obj='Var
pag=8
prev=O2483
var_op='asgn
I
obj='Var
pag=8
prev=O2482
var_op='asgn
I
obj='Var
pag=8
prev=O2481
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='D
pag=8
prev=O2096
var_op='asgn
I
obj='Var
obj_type='D
pag=8
prev=O2095
var_op='asgn
I
obj='Var
pag=8
prev=O2092
var_op='asgn
I
obj='If
pag=8
prev=O2091
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xnarapbo
father=O2092
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc=''P'
len=1
name='_locrap
obj='Var
pag=8
prev=O2513
var_op='asgn
I
obj='Read
pag=8
rd_field=[
'TIPORAP
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'cgo_telematico->RAPPORTO
]
rd_var=[
'_tiporap
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
prev=O2090
rd_field=[
'TIPORAP
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'cgo_telematico->RAPPORTO
]
rd_var=[
'_tiporap
]
I
obj='Var
pag=8
prev=O2089
var_op='asgn
I
obj='Var
pag=8
prev=O2087
var_op='asgn
I
obj='Select
pag=8
prev=O2085
sel_field='*
sel_name='anadip
sel_where='anadip->CODDIP=cgo_telematico->CODDIPE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2087
fatherSonIndex=0
frm_calc='anadip->DESCCIT
len=30
name='_citinter
next=Icpitembatch.CPVarDecl
frm_calc='anadip->CAB
len=6
name='_cabinter
next=Icpitembatch.CPVarDecl
frm_calc='anadip->PROVINCIA
len=2
name='_prvinter
obj='Var
pag=8
prev=O2527
var_op='asgn
I
obj='Var
pag=8
prev=O2526
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2085
fatherSonIndex=0
frm_calc='cgo_telematico->CODDIPE
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='cgo_telematico->IPCOLLEG
len=20
name='_ipcol
next=Icpitembatch.CPVarDecl
frm_calc='cgo_telematico->DUCOLLEG
len=10
name='_drcol
next=Icpitembatch.CPVarDecl
frm_calc='cgo_telematico->ORACOLLEG
len=14
name='_orcol
next=Icpitembatch.CPVarDecl
frm_calc='cgo_telematico->CAIDBIGLIETTO
len=28
name='_idbiglietto
next=Icpitembatch.CPVarDecl
frm_calc='cgo_telematico->RAPPORTO
len=25
name='_rapporto
next=Icpitembatch.CPVarDecl
frm_calc='cgo_telematico->ENV
len=1
name='_env
next=Icpitembatch.CPVarDecl
frm_calc='cgo_telematico->TOTLIRE
len=15
name='_importo
next=Icpitembatch.CPVarDecl
frm_calc='cgo_telematico->IBAN
len=27
name='_iban
next=Icpitembatch.CPVarDecl
frm_calc='cgo_telematico->VPCODICE
len=2
name='_vpcodice
obj='Var
pag=8
prev=O2540
var_op='asgn
I
obj='Var
pag=8
prev=O2539
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O2538
var_op='asgn
I
obj='Var
pag=8
prev=O2537
var_op='asgn
I
obj='Var
pag=8
prev=O2536
var_op='asgn
I
obj='Var
pag=8
prev=O2535
var_op='asgn
I
obj='Var
obj_type='T
pag=8
prev=O2534
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O2533
var_op='asgn
I
obj='Var
pag=8
prev=O2532
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=8
x=20
y=15
I
Icpitembatch.CPVarDecl
frm_calc='cgo_telematico->MEZPAGAM
len=1
name='_mezpagam
obj='Var
pag=8
var_op='asgn
x=1323
y=1049
I
Icpitembatch.CPBeginEnd
comment='Azzera Variabili di Pagine
h=[
19
19
]
obj='Begin
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2545
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=9
sel_field='*
sel_name='cgo_telematico
sel_where='cgo_telematico->SNAINUMOPE=_numopetele
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2549
fatherSonIndex=0
frm_calc=[
'_omulti='S'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2553
fatherSonIndex=0
frm_calc=[
'cgo_telematico->TOTLIRE > 1000
]
h=[
19
19
]
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2558
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=9
sel_field='*
sel_name='cgo_operazioni_dl_multi
sel_where='cgo_operazioni_dl_multi->SNAINUMOPE=_numope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2563
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=9
sel_field='*
sel_name='cgo_operazioni_dl_multi_dt
sel_where='cgo_operazioni_dl_multi_dt->SNAINUMOPE=_numope and cgo_operazioni_dl_multi_dt->CAIDBIGLIETTO=cgo_telematico->CAIDBIGLIETTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2567
fatherSonIndex=0
frm_calc='Left(DateTimeToChar(cgo_telematico->CADATAORA),8)
len=8
name='xData
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='_cauana
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_causin
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_segno
next=Icpitembatch.CPVarDecl
frm_calc='iif(LRTrim(cgo_operazioni_dl_multi->MEZPAGAM) <> 'I' and LRTrim(cgo_operazioni_dl_multi->MEZPAGAM) <> 'E','A',LRTrim(cgo_operazioni_dl_multi->MEZPAGAM))
len=1
name='_mezpagam
next=Icpitembatch.CPRead
arch='cgo_causali
next=Icpitembatch.CPIfElse
frm_calc=[
'_cauana <> '26' and _cauana <> '48' and _cauana <> 'AA'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGAAMS1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGAAMS2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGAAMS3\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='cgo_aams_base
next=Icpitembatch.CPIfElse
frm_calc=[
'cgo_operazioni_dl_multi->MEZPAGAM='I' or cgo_operazioni_dl_multi->MEZPAGAM='E' or cgo_operazioni_dl_multi->MEZPAGAM='P'
]
h=[
19
19
]
obj='If
pag=9
prev=O2583
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2584
fatherSonIndex=0
frm_calc=[
'Left(Upper(cgo_operazioni_dl_multi->IBAN),2)='IT'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2589
fatherSonIndex=0
frm_calc='Substr(cgo_operazioni_dl_multi->IBAN,6,5)+"-"+Substr(cgo_operazioni_dl_multi->IBAN,11,5)
len=11
name='abicab
next=Icpitembatch.CPWrite
arch='cgo_aams_base
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=9
prev=O2595
sel_field='*
sel_name='inter2bo
sel_where='inter2bo->CODINTER=abicab
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cgo_aams_base
father=O2596
fatherSonIndex=0
obj='Write
pag=9
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'inter2bo->TIPINTER
'abicab
'inter2bo->PAESE
'inter2bo->DESCCIT
'inter2bo->PROVINCIA
'inter2bo->CODCAB
'inter2bo->RAGSOC
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=9
prev=O2594
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CODINT2
'TIPOINT2
]
wr_op=[
'=
'=
]
wr_var=[
'abicab
''02'
]
I
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2589
fatherSonIndex=1
frm_calc='Left(Upper(cgo_operazioni_dl_multi->IBAN),11)
len=11
name='abicab
next=Icpitembatch.CPWrite
arch='cgo_aams_base
obj='Write
pag=9
prev=O2615
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CODINT2
'TIPOINT2
]
wr_op=[
'=
'=
]
wr_var=[
'abicab
''12'
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=9
prev=O2582
rd_kfield=[
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'CONNESBEN
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPOPE
'PROVINCIA
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
]
rd_kvar=[
'xData
'xData
'DateToChar(cgo_operazioni_dl_multi->DATAREG)
'_cauana
'cgo_operazioni_dl_multi->CODCAB
'cgo_operazioni_dl_multi->CODDIPE
'cgo_operazioni_dl_multi->CODINTER
'_causin
'cgo_operazioni_dl_multi->CODFISC
'cgo_operazioni_dl_multi->CODFISC
'CharToDate(xData)
'cgo_operazioni_dl_multi->DATAREG
'cgo_operazioni_dl_multi->DESCCIT
''0'
''0'
''3'
''0'
'cOpeProg1
'DateToChar(cgo_operazioni_dl_multi->DATAOPE)+cOpeProg2+'Z'
'cOpeProg2
''1'
'nProgImp
'cgo_operazioni_dl_multi->PROVINCIA
'cgo_telematico->CAIDBIGLIETTO
'_segno
''0'
''1'
''0'
'_tipope
'cgo_operazioni_dl_multi->TOTCONT*100
'cgo_telematico->TOTLIRE*100
''242'
]
I
obj='Var
obj_type='N
pag=9
prev=O2581
var_op='asgn
I
obj='Var
pag=9
prev=O2580
var_op='asgn
I
obj='Var
pag=9
prev=O2577
var_op='asgn
I
obj='If
pag=9
prev=O2576
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2577
fatherSonIndex=0
frm_calc=''10'
len=2
name='_tipope
obj='Var
pag=9
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2577
fatherSonIndex=1
frm_calc=[
'_segno = 'D'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2631
fatherSonIndex=0
frm_calc=''11'
len=2
name='_tipope
obj='Var
pag=9
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2631
fatherSonIndex=1
frm_calc=''12'
len=2
name='_tipope
obj='Var
pag=9
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=9
prev=O2575
rd_field=[
'CACODANA
'CACODSIN
'CASEGNO
]
rd_kfield=[
'CACODICE
'CATIPOPE
]
rd_kvar=[
'cgo_telematico->CACODICE
'_mezpagam
]
rd_var=[
'_cauana
'_causin
'_segno
]
I
obj='Var
pag=9
prev=O2574
var_op='asgn
I
obj='Var
pag=9
pagelocal=True
prev=O2573
var_op='asgn
I
obj='Var
pag=9
prev=O2572
var_op='asgn
I
obj='Var
pag=9
prev=O2571
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPSelect
father=O2553
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=9
sel_field='*
sel_name='cgo_operazioni_dl
sel_where='cgo_operazioni_dl->SNAINUMOPE=_numope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2649
fatherSonIndex=0
frm_calc='Left(DateTimeToChar(cgo_telematico->CADATAORA),8)
len=8
name='xData
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='_cauana
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_causin
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_segno
next=Icpitembatch.CPVarDecl
frm_calc='iif(LRTrim(cgo_operazioni_dl->MEZPAGAM) <> 'I' and LRTrim(cgo_operazioni_dl->MEZPAGAM) <> 'E','A',LRTrim(cgo_operazioni_dl->MEZPAGAM))
len=1
name='_mezpagam
next=Icpitembatch.CPRead
arch='cgo_causali
next=Icpitembatch.CPIfElse
frm_calc=[
'_cauana <> '26' and _cauana <> '48' and _cauana <> 'AA'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGAAMS1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGAAMS2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGAAMS3\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='cgo_aams_base
next=Icpitembatch.CPIfElse
frm_calc=[
'cgo_operazioni_dl->MEZPAGAM='I' or cgo_operazioni_dl->MEZPAGAM='E' or cgo_operazioni_dl->MEZPAGAM='P'
]
h=[
19
19
]
obj='If
pag=9
prev=O2665
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2666
fatherSonIndex=0
frm_calc=[
'Left(Upper(cgo_operazioni_dl->IBAN),2)='IT'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2671
fatherSonIndex=0
frm_calc='Substr(cgo_operazioni_dl->IBAN,6,5)+"-"+Substr(cgo_operazioni_dl->IBAN,11,5)
len=11
name='abicab
next=Icpitembatch.CPWrite
arch='cgo_aams_base
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=9
prev=O2677
sel_field='*
sel_name='inter2bo
sel_where='inter2bo->CODINTER=abicab
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cgo_aams_base
father=O2678
fatherSonIndex=0
obj='Write
pag=9
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'inter2bo->TIPINTER
'abicab
'inter2bo->PAESE
'inter2bo->DESCCIT
'inter2bo->PROVINCIA
'inter2bo->CODCAB
'inter2bo->RAGSOC
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=9
prev=O2676
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CODINT2
'TIPOINT2
]
wr_op=[
'=
'=
]
wr_var=[
'abicab
''02'
]
I
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2671
fatherSonIndex=1
frm_calc='Left(Upper(cgo_operazioni_dl->IBAN),11)
len=11
name='abicab
next=Icpitembatch.CPWrite
arch='cgo_aams_base
obj='Write
pag=9
prev=O2697
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CODINT2
'TIPOINT2
]
wr_op=[
'=
'=
]
wr_var=[
'abicab
''12'
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=9
prev=O2664
rd_kfield=[
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'CONNESBEN
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPOPE
'PROVINCIA
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
]
rd_kvar=[
'xData
'xData
'DateToChar(cgo_operazioni_dl->DATAREG)
'_cauana
'cgo_operazioni_dl->CODCAB
'cgo_operazioni_dl->CODDIPE
'cgo_operazioni_dl->CODINTER
'_causin
'cgo_operazioni_dl->CODFISC
'cgo_operazioni_dl->CODFISC
'CharToDate(xData)
'cgo_operazioni_dl->DATAREG
'cgo_operazioni_dl->DESCCIT
''0'
''0'
''3'
''0'
'cOpeProg1
'DateToChar(cgo_operazioni_dl->DATAOPE)+cOpeProg2+'Z'
'cOpeProg2
''1'
'nProgImp
'cgo_operazioni_dl->PROVINCIA
'cgo_telematico->CAIDBIGLIETTO
'_segno
''0'
''1'
''0'
'_tipope
'cgo_operazioni_dl->TOTCONT*100
'cgo_telematico->TOTLIRE*100
''242'
]
I
obj='Var
obj_type='N
pag=9
prev=O2663
var_op='asgn
I
obj='Var
pag=9
prev=O2662
var_op='asgn
I
obj='Var
pag=9
prev=O2659
var_op='asgn
I
obj='If
pag=9
prev=O2658
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2659
fatherSonIndex=0
frm_calc=''10'
len=2
name='_tipope
obj='Var
pag=9
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2659
fatherSonIndex=1
frm_calc=[
'_segno = 'D'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2713
fatherSonIndex=0
frm_calc=''11'
len=2
name='_tipope
obj='Var
pag=9
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2713
fatherSonIndex=1
frm_calc=''12'
len=2
name='_tipope
obj='Var
pag=9
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=9
prev=O2657
rd_field=[
'CACODANA
'CACODSIN
'CASEGNO
]
rd_kfield=[
'CACODICE
'CATIPOPE
]
rd_kvar=[
'cgo_telematico->CACODICE
'_mezpagam
]
rd_var=[
'_cauana
'_causin
'_segno
]
I
obj='Var
pag=9
prev=O2656
var_op='asgn
I
obj='Var
pag=9
pagelocal=True
prev=O2655
var_op='asgn
I
obj='Var
pag=9
prev=O2654
var_op='asgn
I
obj='Var
pag=9
prev=O2653
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
x=10
y=18
I
Icpitembatch.CPRemark
frm_calc='Scrive le operazioni corrette
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=10
prev=O2731
sel_field='*
sel_name='cgo_telematico
sel_where='cgo_telematico->SNAINUMOPE=_numopetele
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2732
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc=''D'
len=1
name='_locrap
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_tiporap
next=Icpitembatch.CPRead
arch='anarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_tiporap))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Left(DateTimeToChar(cgo_telematico->CADATAORA),8)
len=8
name='xData
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(xData)
len=8
name='_datope
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datreg
next=Icpitembatch.CPBeginEnd
comment='Selezione Causali
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xCF
next=Icpitembatch.CPVarDecl
frm_calc='cgo_telematico->TOTLIRE
len=15
name='_tottele
next=Icpitembatch.CPVarDecl
frm_calc='cgo_telematico->CODLOB
len=3
name='_codlob
next=Icpitembatch.CPVarDecl
frm_calc='cgo_telematico->TIPOGIOCO
len=3
name='_tipgio
next=Icpitembatch.CPVarDecl
frm_calc='cgo_telematico->CACODICE
len=5
name='_cacodice
next=Icpitembatch.CPIfElse
frm_calc=[
'cgo_telematico->ENV='W'
'cgo_telematico->ENV='A' or cgo_telematico->ENV='V'
]
h=[
19
19
19
]
next=Icpitembatch.CPExec
check='page
frm_calc='11
obj='Exec
pag=10
prev=O2754
I
obj='If
pag=10
prev=O2753
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2754
fatherSonIndex=0
frm_calc=[
'cgo_telematico->TOTLIRE >= _limoper
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O2760
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2765
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PPOPER1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='nIntest
next=Icpitembatch.CPInsert
arch='xperazbo
next=Icpitembatch.CPIfElse
frm_calc=[
'_locrap='D'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_mezpagam='I' or _mezpagam='E' or _mezpagam='P'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(cgo_telematico->IBAN))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='oNumero + 1
len=10
name='oNumero
obj='Var
obj_type='N
pag=10
prev=O2781
var_op='asgn
I
obj='If
pag=10
prev=O2778
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2781
fatherSonIndex=0
frm_calc=[
'Left(cgo_telematico->IBAN,2)='IT'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2787
fatherSonIndex=0
frm_calc='Substr(cgo_telematico->IBAN,6,5)+"-"+Substr(cgo_telematico->IBAN,11,5)
len=11
name='abicab
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=10
prev=O2792
sel_field='*
sel_name='inter2bo
sel_where='inter2bo->CODINTER=abicab
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O2793
fatherSonIndex=0
obj='Write
pag=10
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'inter2bo->TIPINTER
'abicab
'inter2bo->PAESE
'inter2bo->DESCCIT
'inter2bo->PROVINCIA
'inter2bo->CODCAB
'inter2bo->RAGSOC
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2787
fatherSonIndex=1
frm_calc='Left(cgo_telematico->IBAN,11)
len=11
name='abicab
next=Icpitembatch.CPWrite
arch='xperazbo
obj='Write
pag=10
prev=O2806
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CODINT2
]
wr_op=[
'=
]
wr_var=[
'abicab
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O2775
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2778
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=10
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=xCF
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O2818
fatherSonIndex=0
obj='Write
pag=10
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CONNESBEN
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
'personbo->CONNES
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O2774
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2775
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=10
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=cgo_telematico->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2833
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=10
name='nIntest
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_codsog
next=Icpitembatch.CPRead
arch='cgo_totope
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_codsog))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
prev=O2842
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cgo_totope
father=O2843
fatherSonIndex=0
obj='Insert
pag=10
rd_kfield=[
'TODATOPE
'TOCODSOG
'TONUMOPE
'TO_SEGNO
'TOIMPORT
]
rd_kvar=[
'_datope
'intestbo->CODINTER
'1
'_segno
'cgo_telematico->TOTLIRE
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cgo_totope
father=O2843
fatherSonIndex=1
obj='Write
pag=10
rd_kfield=[
'TODATOPE
'TOCODSOG
'TO_SEGNO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'_datope
'_codsog
'_segno
]
wr_field=[
'TONUMOPE
'TOIMPORT
]
wr_op=[
'+
'+
]
wr_var=[
'1
'cgo_telematico->TOTLIRE
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=10
prev=O2841
rd_field=[
'TOCODSOG
]
rd_kfield=[
'TODATOPE
'TOCODSOG
'TO_SEGNO
]
rd_kvar=[
'_datope
'intestbo->CODINTER
'_segno
]
rd_var=[
'_codsog
]
I
obj='Var
pag=10
prev=O2840
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O2837
var_op='asgn
I
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2837
fatherSonIndex=0
frm_calc='intestbo->CODINTER
len=16
name='xCF
next=Icpitembatch.CPWrite
arch='xperazbo
obj='Write
pag=10
prev=O2866
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'intestbo->CODINTER
]
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientiope
father=O2837
fatherSonIndex=1
obj='Insert
pag=10
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2775
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=10
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=cgo_telematico->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2881
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=10
name='nIntest
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_codsog
next=Icpitembatch.CPRead
arch='cgo_totope
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_codsog))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
prev=O2890
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cgo_totope
father=O2891
fatherSonIndex=0
obj='Insert
pag=10
rd_kfield=[
'TODATOPE
'TOCODSOG
'TONUMOPE
'TO_SEGNO
'TOIMPORT
]
rd_kvar=[
'_datope
'xntestbo->CODINTER
'1
'_segno
'cgo_telematico->TOTLIRE
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cgo_totope
father=O2891
fatherSonIndex=1
obj='Write
pag=10
rd_kfield=[
'TODATOPE
'TOCODSOG
'TO_SEGNO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'_datope
'_codsog
'_segno
]
wr_field=[
'TONUMOPE
'TOIMPORT
]
wr_op=[
'+
'+
]
wr_var=[
'1
'cgo_telematico->TOTLIRE
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=10
prev=O2889
rd_field=[
'TOCODSOG
]
rd_kfield=[
'TODATOPE
'TOCODSOG
'TO_SEGNO
]
rd_kvar=[
'_datope
'xntestbo->CODINTER
'_segno
]
rd_var=[
'_codsog
]
I
obj='Var
pag=10
prev=O2888
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O2885
var_op='asgn
I
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2885
fatherSonIndex=0
frm_calc='xntestbo->CODINTER
len=16
name='xCF
next=Icpitembatch.CPWrite
arch='xperazbo
obj='Write
pag=10
prev=O2914
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xntestbo->CODINTER
]
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientiope
father=O2885
fatherSonIndex=1
obj='Insert
pag=10
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'xntestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=10
prev=O2773
rd_kfield=[
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'DATAIMP
'DATAOPE
'DATAREG
'DESCCIT
'DUCOLLEG
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'IPCOLLEG
'NOPROT
'NUMPROG
'OPRAP
'ORACOLLEG
'PRGIMPOPE
'PROVINCIA
'RAPPORTO
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
'MTCN
]
rd_kvar=[
'xData
'xData
'iif(DateToChar(_datope) <= '20120531','20120601',DateToChar(arfn_datesum(_datope,1)))
'_codana
'_cabinter
'cgo_telematico->CODDIPE
'_codinter
'_codsin
'Date()
'_datope
'iif(DateToChar(_datope) <= '20120531',CharToDate('20120601'),arfn_datesum(_datope,1))
'_citinter
'cgo_telematico->DUCOLLEG
''0'
''0'
''3'
'_tiporap
'cOpeProg1
'xData+cOpeProg2+'0'
'cgo_telematico->IPCOLLEG
'0
'cOpeProg2
''1'
'cgo_telematico->ORACOLLEG
'nProgImp
'_prvinter
'cgo_telematico->RAPPORTO
'cgo_telematico->CAIDBIGLIETTO
'_segno
''0'
''1'
'_tipinter
''0'
'_tipope
'0
'cgo_telematico->TOTLIRE * 100
''242'
'cgo_telematico->ENV
]
I
obj='Var
obj_type='N
pag=10
prev=O2772
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O2771
var_op='asgn
I
obj='Var
pag=10
prev=O2770
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2765
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("POPERAZ2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='nIntest
next=Icpitembatch.CPInsert
arch='operazbo
next=Icpitembatch.CPIfElse
frm_calc=[
'_locrap='D'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_mezpagam='I' or _mezpagam='E' or _mezpagam='P'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(cgo_telematico->IBAN))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='oNumero + 1
len=10
name='oNumero
obj='Var
obj_type='N
pag=10
prev=O2943
var_op='asgn
I
obj='If
pag=10
prev=O2940
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2943
fatherSonIndex=0
frm_calc=[
'Left(cgo_telematico->IBAN,2)='IT'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2949
fatherSonIndex=0
frm_calc='Substr(cgo_telematico->IBAN,6,5)+"-"+Substr(cgo_telematico->IBAN,11,5)
len=11
name='abicab
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=10
prev=O2954
sel_field='*
sel_name='inter2bo
sel_where='inter2bo->CODINTER=abicab
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O2955
fatherSonIndex=0
obj='Write
pag=10
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'inter2bo->TIPINTER
'abicab
'inter2bo->PAESE
'inter2bo->DESCCIT
'inter2bo->PROVINCIA
'inter2bo->CODCAB
'inter2bo->RAGSOC
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2949
fatherSonIndex=1
frm_calc='Left(cgo_telematico->IBAN,11)
len=11
name='abicab
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=10
prev=O2968
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CODINT2
]
wr_op=[
'=
]
wr_var=[
'abicab
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O2937
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2940
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=10
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=xCF
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O2980
fatherSonIndex=0
obj='Write
pag=10
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CONNESBEN
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
'personbo->CONNES
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O2936
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2937
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=10
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=cgo_telematico->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2995
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=10
name='nIntest
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_codsog
next=Icpitembatch.CPRead
arch='cgo_totope
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_codsog))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
prev=O3004
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cgo_totope
father=O3005
fatherSonIndex=0
obj='Insert
pag=10
rd_kfield=[
'TODATOPE
'TOCODSOG
'TONUMOPE
'TO_SEGNO
'TOIMPORT
]
rd_kvar=[
'_datope
'intestbo->CODINTER
'1
'_segno
'cgo_telematico->TOTLIRE
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cgo_totope
father=O3005
fatherSonIndex=1
obj='Write
pag=10
rd_kfield=[
'TODATOPE
'TOCODSOG
'TO_SEGNO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'_datope
'_codsog
'_segno
]
wr_field=[
'TONUMOPE
'TOIMPORT
]
wr_op=[
'+
'+
]
wr_var=[
'1
'cgo_telematico->TOTLIRE
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=10
prev=O3003
rd_field=[
'TOCODSOG
]
rd_kfield=[
'TODATOPE
'TOCODSOG
'TO_SEGNO
]
rd_kvar=[
'_datope
'intestbo->CODINTER
'_segno
]
rd_var=[
'_codsog
]
I
obj='Var
pag=10
prev=O3002
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O2999
var_op='asgn
I
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2999
fatherSonIndex=0
frm_calc='intestbo->CODINTER
len=16
name='xCF
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=10
prev=O3028
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'intestbo->CODINTER
]
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O2999
fatherSonIndex=1
obj='Insert
pag=10
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2937
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=10
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=cgo_telematico->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3043
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=10
name='nIntest
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_codsog
next=Icpitembatch.CPRead
arch='cgo_totope
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_codsog))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
prev=O3052
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cgo_totope
father=O3053
fatherSonIndex=0
obj='Insert
pag=10
rd_kfield=[
'TODATOPE
'TOCODSOG
'TONUMOPE
'TO_SEGNO
'TOIMPORT
]
rd_kvar=[
'_datope
'xntestbo->CODINTER
'1
'_segno
'cgo_telematico->TOTLIRE
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cgo_totope
father=O3053
fatherSonIndex=1
obj='Write
pag=10
rd_kfield=[
'TODATOPE
'TOCODSOG
'TO_SEGNO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'_datope
'_codsog
'_segno
]
wr_field=[
'TONUMOPE
'TOIMPORT
]
wr_op=[
'+
'+
]
wr_var=[
'1
'cgo_telematico->TOTLIRE
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=10
prev=O3051
rd_field=[
'TOCODSOG
]
rd_kfield=[
'TODATOPE
'TOCODSOG
'TO_SEGNO
]
rd_kvar=[
'_datope
'xntestbo->CODINTER
'_segno
]
rd_var=[
'_codsog
]
I
obj='Var
pag=10
prev=O3050
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O3047
var_op='asgn
I
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3047
fatherSonIndex=0
frm_calc='xntestbo->CODINTER
len=16
name='xCF
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=10
prev=O3076
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xntestbo->CODINTER
]
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O3047
fatherSonIndex=1
obj='Insert
pag=10
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'xntestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=10
prev=O2935
rd_kfield=[
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'DATAIMP
'DATAOPE
'DATAREG
'DESCCIT
'DUCOLLEG
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'IPCOLLEG
'NOPROT
'NUMPROG
'OPRAP
'ORACOLLEG
'PRGIMPOPE
'PROVINCIA
'RAPPORTO
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
'MTCN
]
rd_kvar=[
'xData
'xData
'iif(DateToChar(_datope) <= '20120531','20120601',DateToChar(arfn_datesum(_datope,1)))
'_codana
'_cabinter
'cgo_telematico->CODDIPE
'_codinter
'_codsin
'Date()
'_datope
'iif(DateToChar(_datope) <= '20120531',CharToDate('20120601'),arfn_datesum(_datope,1))
'_citinter
'cgo_telematico->DUCOLLEG
''0'
''0'
''3'
'_tiporap
'cOpeProg1
'xData+cOpeProg2+'0'
'cgo_telematico->IPCOLLEG
'0
'cOpeProg2
''1'
'cgo_telematico->ORACOLLEG
'nProgImp
'_prvinter
'cgo_telematico->RAPPORTO
'cgo_telematico->CAIDBIGLIETTO
'_segno
''0'
''1'
'_tipinter
''0'
'_tipope
'0
'cgo_telematico->TOTLIRE * 100
''242'
'cgo_telematico->ENV
]
I
obj='Var
obj_type='N
pag=10
prev=O2934
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O2933
var_op='asgn
I
obj='Var
pag=10
prev=O2932
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2760
fatherSonIndex=1
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3095
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PPFRAZ1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPFRAZ2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='nIntest
next=Icpitembatch.CPInsert
arch='xraziobo
next=Icpitembatch.CPIfElse
frm_calc=[
'_locrap='D'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_mezpagam='I' or _mezpagam='E' or _mezpagam='P'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(cgo_telematico->IBAN))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='fNumero + 1
len=10
name='fNumero
obj='Var
obj_type='N
pag=10
prev=O3111
var_op='asgn
I
obj='If
pag=10
prev=O3108
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3111
fatherSonIndex=0
frm_calc=[
'Left(cgo_telematico->IBAN,2)='IT'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3117
fatherSonIndex=0
frm_calc='Substr(cgo_telematico->IBAN,6,5)+"-"+Substr(cgo_telematico->IBAN,11,5)
len=11
name='abicab
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=10
prev=O3122
sel_field='*
sel_name='inter2bo
sel_where='inter2bo->CODINTER=abicab
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xraziobo
father=O3123
fatherSonIndex=0
obj='Write
pag=10
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'inter2bo->TIPINTER
'abicab
'inter2bo->PAESE
'inter2bo->DESCCIT
'inter2bo->PROVINCIA
'inter2bo->CODCAB
'inter2bo->RAGSOC
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3117
fatherSonIndex=1
frm_calc='Left(cgo_telematico->IBAN,11)
len=11
name='abicab
next=Icpitembatch.CPWrite
arch='xraziobo
obj='Write
pag=10
prev=O3136
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CODINT2
]
wr_op=[
'=
]
wr_var=[
'abicab
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O3105
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3108
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=10
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=xCF
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xraziobo
father=O3148
fatherSonIndex=0
obj='Write
pag=10
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CONNESBEN
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
'personbo->CONNES
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O3104
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3105
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=10
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=cgo_telematico->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3163
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=10
name='nIntest
obj='Var
obj_type='N
pag=10
prev=O3167
var_op='asgn
I
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3167
fatherSonIndex=0
frm_calc='intestbo->CODINTER
len=16
name='xCF
next=Icpitembatch.CPWrite
arch='xraziobo
obj='Write
pag=10
prev=O3173
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'intestbo->CODINTER
]
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientifrz
father=O3167
fatherSonIndex=1
obj='Insert
pag=10
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3105
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=10
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=cgo_telematico->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3188
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=10
name='nIntest
obj='Var
obj_type='N
pag=10
prev=O3192
var_op='asgn
I
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3192
fatherSonIndex=0
frm_calc='xntestbo->CODINTER
len=16
name='xCF
next=Icpitembatch.CPWrite
arch='xraziobo
obj='Write
pag=10
prev=O3198
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xntestbo->CODINTER
]
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientifrz
father=O3192
fatherSonIndex=1
obj='Insert
pag=10
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'xntestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=10
prev=O3103
rd_kfield=[
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'DATAIMP
'DATAOPE
'DATAREG
'DESCCIT
'DUCOLLEG
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'IPCOLLEG
'NOPROT
'NUMPROG
'OPRAP
'ORACOLLEG
'PRGIMPFRZ
'PROVINCIA
'RAPPORTO
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
'MTCN
]
rd_kvar=[
'xData
'xData
'iif(DateToChar(_datope) <= '20120531','20120601',DateToChar(arfn_datesum(_datope,1)))
'_codana
'_cabinter
'cgo_telematico->CODDIPE
'_codinter
'_codsin
'Date()
'_datope
'iif(DateToChar(_datope) <= '20120531',CharToDate('20120601'),arfn_datesum(_datope,1))
'_citinter
'cgo_telematico->DUCOLLEG
''0'
''0'
''3'
'_tiporap
'cOpeProg1
'xData+cOpeProg2+'0'
'cgo_telematico->IPCOLLEG
'0
'cOpeProg2
''1'
'cgo_telematico->ORACOLLEG
'nProgImp
'_prvinter
'cgo_telematico->RAPPORTO
'cgo_telematico->CAIDBIGLIETTO
'_segno
''0'
''1'
'_tipinter
''0'
'_tipope
'0
'cgo_telematico->TOTLIRE * 100
''242'
'cgo_telematico->ENV
]
I
obj='Var
obj_type='N
pag=10
prev=O3102
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O3101
var_op='asgn
I
obj='Var
pag=10
prev=O3100
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3095
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PFRAZIO2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='nIntest
next=Icpitembatch.CPInsert
arch='fraziobo
next=Icpitembatch.CPIfElse
frm_calc=[
'_locrap='D'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_mezpagam='I' or _mezpagam='E' or _mezpagam='P'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(cgo_telematico->IBAN))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='fNumero + 1
len=10
name='fNumero
obj='Var
obj_type='N
pag=10
prev=O3227
var_op='asgn
I
obj='If
pag=10
prev=O3224
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3227
fatherSonIndex=0
frm_calc=[
'Left(cgo_telematico->IBAN,2)='IT'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3233
fatherSonIndex=0
frm_calc='Substr(cgo_telematico->IBAN,6,5)+"-"+Substr(cgo_telematico->IBAN,11,5)
len=11
name='abicab
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=10
prev=O3238
sel_field='*
sel_name='inter2bo
sel_where='inter2bo->CODINTER=abicab
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='fraziobo
father=O3239
fatherSonIndex=0
obj='Write
pag=10
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'inter2bo->TIPINTER
'abicab
'inter2bo->PAESE
'inter2bo->DESCCIT
'inter2bo->PROVINCIA
'inter2bo->CODCAB
'inter2bo->RAGSOC
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3233
fatherSonIndex=1
frm_calc='Left(cgo_telematico->IBAN,11)
len=11
name='abicab
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=10
prev=O3252
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CODINT2
]
wr_op=[
'=
]
wr_var=[
'abicab
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O3221
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3224
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=10
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=xCF
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='fraziobo
father=O3264
fatherSonIndex=0
obj='Write
pag=10
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CONNESBEN
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
'personbo->CONNES
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O3220
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3221
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=10
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=cgo_telematico->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3279
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=10
name='nIntest
obj='Var
obj_type='N
pag=10
prev=O3283
var_op='asgn
I
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3283
fatherSonIndex=0
frm_calc='intestbo->CODINTER
len=16
name='xCF
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=10
prev=O3289
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'intestbo->CODINTER
]
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientifrz
father=O3283
fatherSonIndex=1
obj='Insert
pag=10
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3221
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=10
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=cgo_telematico->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3304
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=10
name='nIntest
obj='Var
obj_type='N
pag=10
prev=O3308
var_op='asgn
I
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3308
fatherSonIndex=0
frm_calc='xntestbo->CODINTER
len=16
name='xCF
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=10
prev=O3314
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xntestbo->CODINTER
]
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientifrz
father=O3308
fatherSonIndex=1
obj='Insert
pag=10
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'xntestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=10
prev=O3219
rd_kfield=[
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'DATAIMP
'DATAOPE
'DATAREG
'DESCCIT
'DUCOLLEG
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'IPCOLLEG
'NOPROT
'NUMPROG
'OPRAP
'ORACOLLEG
'PRGIMPFRZ
'PROVINCIA
'RAPPORTO
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
'MTCN
]
rd_kvar=[
'xData
'xData
'iif(DateToChar(_datope) <= '20120531','20120601',DateToChar(arfn_datesum(_datope,1)))
'_codana
'_cabinter
'cgo_telematico->CODDIPE
'_codinter
'_codsin
'Date()
'_datope
'iif(DateToChar(_datope) <= '20120531',CharToDate('20120601'),arfn_datesum(_datope,1))
'_citinter
'cgo_telematico->DUCOLLEG
''0'
''0'
''3'
'_tiporap
'cOpeProg1
'xData+cOpeProg2+'0'
'cgo_telematico->IPCOLLEG
'0
'cOpeProg2
''1'
'cgo_telematico->ORACOLLEG
'nProgImp
'_prvinter
'cgo_telematico->RAPPORTO
'cgo_telematico->CAIDBIGLIETTO
'_segno
''0'
''1'
'_tipinter
''0'
'_tipope
'0
'cgo_telematico->TOTLIRE * 100
''242'
'cgo_telematico->ENV
]
I
obj='Var
obj_type='N
pag=10
prev=O3218
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O3217
var_op='asgn
I
obj='Var
pag=10
prev=O3216
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2754
fatherSonIndex=1
frm_calc=[
'cgo_telematico->TOTLIRE >= _limoper
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O3334
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3339
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PPOPER1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='nIntest
next=Icpitembatch.CPInsert
arch='xperazbo
next=Icpitembatch.CPIfElse
frm_calc=[
'_mezpagam='I' or _mezpagam='E' or _mezpagam='P'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(cgo_telematico->IBAN))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='oNumero + 1
len=10
name='oNumero
obj='Var
obj_type='N
pag=10
prev=O3352
var_op='asgn
I
obj='If
pag=10
prev=O3349
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3352
fatherSonIndex=0
frm_calc=[
'Left(cgo_telematico->IBAN,2)='IT'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3358
fatherSonIndex=0
frm_calc='Substr(cgo_telematico->IBAN,6,5)+"-"+Substr(cgo_telematico->IBAN,11,5)
len=11
name='abicab
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=10
prev=O3363
sel_field='*
sel_name='inter2bo
sel_where='inter2bo->CODINTER=abicab
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O3364
fatherSonIndex=0
obj='Write
pag=10
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'inter2bo->TIPINTER
'abicab
'inter2bo->PAESE
'inter2bo->DESCCIT
'inter2bo->PROVINCIA
'inter2bo->CODCAB
'inter2bo->RAGSOC
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3358
fatherSonIndex=1
frm_calc='Left(cgo_telematico->IBAN,11)
len=11
name='abicab
next=Icpitembatch.CPWrite
arch='xperazbo
obj='Write
pag=10
prev=O3377
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CODINT2
]
wr_op=[
'=
]
wr_var=[
'abicab
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O3348
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3349
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=10
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=Left(LRTrim(cgo_telematico->RAPPORTO),16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O3389
fatherSonIndex=0
obj='Write
pag=10
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CONNESBEN
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
'personbo->CONNES
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=10
prev=O3347
rd_kfield=[
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'DATAIMP
'DATAOPE
'DATAREG
'DESCCIT
'DUCOLLEG
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'IPCOLLEG
'NOPROT
'NUMPROG
'OPRAP
'ORACOLLEG
'PRGIMPOPE
'PROVINCIA
'CONNESCLI
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
'MTCN
]
rd_kvar=[
'xData
'xData
'iif(DateToChar(_datope) <= '20120531','20120601',DateToChar(arfn_datesum(_datope,1)))
'_codana
'_cabinter
'cgo_telematico->CODDIPE
'_codinter
'_codsin
'Date()
'_datope
'iif(DateToChar(_datope) <= '20120531',CharToDate('20120601'),arfn_datesum(_datope,1))
'_citinter
'cgo_telematico->DUCOLLEG
''0'
''0'
''3'
'_tiporap
'cOpeProg1
'xData+cOpeProg2+'0'
'cgo_telematico->IPCOLLEG
'0
'cOpeProg2
''1'
'cgo_telematico->ORACOLLEG
'nProgImp
'_prvinter
'Left(LRTrim(cgo_telematico->RAPPORTO),16)
'cgo_telematico->CAIDBIGLIETTO
'_segno
''0'
''1'
'_tipinter
''0'
'_tipope
'0
'cgo_telematico->TOTLIRE * 100
''242'
'cgo_telematico->ENV
]
I
obj='Var
obj_type='N
pag=10
prev=O3346
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O3345
var_op='asgn
I
obj='Var
pag=10
prev=O3344
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3339
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("POPERAZ2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='nIntest
next=Icpitembatch.CPInsert
arch='operazbo
next=Icpitembatch.CPIfElse
frm_calc=[
'_mezpagam='I' or _mezpagam='E' or _mezpagam='P'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(cgo_telematico->IBAN))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='oNumero + 1
len=10
name='oNumero
obj='Var
obj_type='N
pag=10
prev=O3413
var_op='asgn
I
obj='If
pag=10
prev=O3410
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3413
fatherSonIndex=0
frm_calc=[
'Left(cgo_telematico->IBAN,2)='IT'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3419
fatherSonIndex=0
frm_calc='Substr(cgo_telematico->IBAN,6,5)+"-"+Substr(cgo_telematico->IBAN,11,5)
len=11
name='abicab
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=10
prev=O3424
sel_field='*
sel_name='inter2bo
sel_where='inter2bo->CODINTER=abicab
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O3425
fatherSonIndex=0
obj='Write
pag=10
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'inter2bo->TIPINTER
'abicab
'inter2bo->PAESE
'inter2bo->DESCCIT
'inter2bo->PROVINCIA
'inter2bo->CODCAB
'inter2bo->RAGSOC
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3419
fatherSonIndex=1
frm_calc='Left(cgo_telematico->IBAN,11)
len=11
name='abicab
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=10
prev=O3438
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CODINT2
]
wr_op=[
'=
]
wr_var=[
'abicab
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O3409
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3410
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=10
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=Left(LRTrim(cgo_telematico->RAPPORTO),16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O3450
fatherSonIndex=0
obj='Write
pag=10
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CONNESBEN
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
'personbo->CONNES
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=10
prev=O3408
rd_kfield=[
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'DATAIMP
'DATAOPE
'DATAREG
'DESCCIT
'DUCOLLEG
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'IPCOLLEG
'NOPROT
'NUMPROG
'OPRAP
'ORACOLLEG
'PRGIMPOPE
'PROVINCIA
'CONNESCLI
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
'MTCN
]
rd_kvar=[
'xData
'xData
'iif(DateToChar(_datope) <= '20120531','20120601',DateToChar(arfn_datesum(_datope,1)))
'_codana
'_cabinter
'cgo_telematico->CODDIPE
'_codinter
'_codsin
'Date()
'_datope
'iif(DateToChar(_datope) <= '20120531',CharToDate('20120601'),arfn_datesum(_datope,1))
'_citinter
'cgo_telematico->DUCOLLEG
''0'
''0'
''3'
'_tiporap
'cOpeProg1
'xData+cOpeProg2+'0'
'cgo_telematico->IPCOLLEG
'0
'cOpeProg2
''1'
'cgo_telematico->ORACOLLEG
'nProgImp
'_prvinter
'Left(LRTrim(cgo_telematico->RAPPORTO),16)
'cgo_telematico->CAIDBIGLIETTO
'_segno
''0'
''1'
'_tipinter
''0'
'_tipope
'0
'cgo_telematico->TOTLIRE * 100
''242'
'cgo_telematico->ENV
]
I
obj='Var
obj_type='N
pag=10
prev=O3407
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O3406
var_op='asgn
I
obj='Var
pag=10
prev=O3405
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3334
fatherSonIndex=1
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3467
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PPFRAZ1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPFRAZ2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='nIntest
next=Icpitembatch.CPInsert
arch='xraziobo
next=Icpitembatch.CPIfElse
frm_calc=[
'_mezpagam='I' or _mezpagam='E' or _mezpagam='P'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(cgo_telematico->IBAN))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='fNumero + 1
len=10
name='fNumero
obj='Var
obj_type='N
pag=10
prev=O3480
var_op='asgn
I
obj='If
pag=10
prev=O3477
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3480
fatherSonIndex=0
frm_calc=[
'Left(cgo_telematico->IBAN,2)='IT'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3486
fatherSonIndex=0
frm_calc='Substr(cgo_telematico->IBAN,6,5)+"-"+Substr(cgo_telematico->IBAN,11,5)
len=11
name='abicab
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=10
prev=O3491
sel_field='*
sel_name='inter2bo
sel_where='inter2bo->CODINTER=abicab
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xraziobo
father=O3492
fatherSonIndex=0
obj='Write
pag=10
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'inter2bo->TIPINTER
'abicab
'inter2bo->PAESE
'inter2bo->DESCCIT
'inter2bo->PROVINCIA
'inter2bo->CODCAB
'inter2bo->RAGSOC
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3486
fatherSonIndex=1
frm_calc='Left(cgo_telematico->IBAN,11)
len=11
name='abicab
next=Icpitembatch.CPWrite
arch='xraziobo
obj='Write
pag=10
prev=O3505
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CODINT2
]
wr_op=[
'=
]
wr_var=[
'abicab
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O3476
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3477
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=10
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=Left(LRTrim(cgo_telematico->RAPPORTO),16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xraziobo
father=O3517
fatherSonIndex=0
obj='Write
pag=10
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CONNESBEN
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
'personbo->CONNES
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=10
prev=O3475
rd_kfield=[
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'DATAIMP
'DATAOPE
'DATAREG
'DESCCIT
'DUCOLLEG
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'IPCOLLEG
'NOPROT
'NUMPROG
'OPRAP
'ORACOLLEG
'PRGIMPFRZ
'PROVINCIA
'CONNESCLI
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
'MTCN
]
rd_kvar=[
'xData
'xData
'iif(DateToChar(_datope) <= '20120531','20120601',DateToChar(arfn_datesum(_datope,1)))
'_codana
'_cabinter
'cgo_telematico->CODDIPE
'_codinter
'_codsin
'Date()
'_datope
'iif(DateToChar(_datope) <= '20120531',CharToDate('20120601'),arfn_datesum(_datope,1))
'_citinter
'cgo_telematico->DUCOLLEG
''0'
''0'
''3'
'_tiporap
'cOpeProg1
'xData+cOpeProg2+'0'
'cgo_telematico->IPCOLLEG
'0
'cOpeProg2
''1'
'cgo_telematico->ORACOLLEG
'nProgImp
'_prvinter
'Left(LRTrim(cgo_telematico->RAPPORTO),16)
'cgo_telematico->CAIDBIGLIETTO
'_segno
''0'
''1'
'_tipinter
''0'
'_tipope
'0
'cgo_telematico->TOTLIRE * 100
''242'
'cgo_telematico->ENV
]
I
obj='Var
obj_type='N
pag=10
prev=O3474
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O3473
var_op='asgn
I
obj='Var
pag=10
prev=O3472
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3467
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PFRAZIO2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='nIntest
next=Icpitembatch.CPInsert
arch='fraziobo
next=Icpitembatch.CPIfElse
frm_calc=[
'_mezpagam='I' or _mezpagam='E' or _mezpagam='P'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(cgo_telematico->IBAN))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='fNumero + 1
len=10
name='fNumero
obj='Var
obj_type='N
pag=10
prev=O3541
var_op='asgn
I
obj='If
pag=10
prev=O3538
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3541
fatherSonIndex=0
frm_calc=[
'Left(cgo_telematico->IBAN,2)='IT'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3547
fatherSonIndex=0
frm_calc='Substr(cgo_telematico->IBAN,6,5)+"-"+Substr(cgo_telematico->IBAN,11,5)
len=11
name='abicab
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=10
prev=O3552
sel_field='*
sel_name='inter2bo
sel_where='inter2bo->CODINTER=abicab
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='fraziobo
father=O3553
fatherSonIndex=0
obj='Write
pag=10
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'inter2bo->TIPINTER
'abicab
'inter2bo->PAESE
'inter2bo->DESCCIT
'inter2bo->PROVINCIA
'inter2bo->CODCAB
'inter2bo->RAGSOC
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3547
fatherSonIndex=1
frm_calc='Left(cgo_telematico->IBAN,11)
len=11
name='abicab
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=10
prev=O3566
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CODINT2
]
wr_op=[
'=
]
wr_var=[
'abicab
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O3537
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3538
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=10
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=Left(LRTrim(cgo_telematico->RAPPORTO),16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='fraziobo
father=O3578
fatherSonIndex=0
obj='Write
pag=10
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CONNESBEN
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
'personbo->CONNES
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=10
prev=O3536
rd_kfield=[
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'DATAIMP
'DATAOPE
'DATAREG
'DESCCIT
'DUCOLLEG
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'IPCOLLEG
'NOPROT
'NUMPROG
'OPRAP
'ORACOLLEG
'PRGIMPFRZ
'PROVINCIA
'CONNESCLI
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
'MTCN
]
rd_kvar=[
'xData
'xData
'iif(DateToChar(_datope) <= '20120531','20120601',DateToChar(arfn_datesum(_datope,1)))
'_codana
'_cabinter
'cgo_telematico->CODDIPE
'_codinter
'_codsin
'Date()
'_datope
'iif(DateToChar(_datope) <= '20120531',CharToDate('20120601'),arfn_datesum(_datope,1))
'_citinter
'cgo_telematico->DUCOLLEG
''0'
''0'
''3'
'_tiporap
'cOpeProg1
'xData+cOpeProg2+'0'
'cgo_telematico->IPCOLLEG
'0
'cOpeProg2
''1'
'cgo_telematico->ORACOLLEG
'nProgImp
'_prvinter
'Left(LRTrim(cgo_telematico->RAPPORTO),16)
'cgo_telematico->CAIDBIGLIETTO
'_segno
''0'
''1'
'_tipinter
''0'
'_tipope
'0
'cgo_telematico->TOTLIRE * 100
''242'
'cgo_telematico->ENV
]
I
obj='Var
obj_type='N
pag=10
prev=O3535
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O3534
var_op='asgn
I
obj='Var
pag=10
prev=O3533
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=10
prev=O2752
var_op='asgn
I
obj='Var
pag=10
prev=O2751
var_op='asgn
I
obj='Var
pag=10
prev=O2750
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O2749
var_op='asgn
I
obj='Var
pag=10
prev=O2747
var_op='asgn
I
obj='Begin
pag=10
prev=O2746
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2747
fatherSonIndex=0
frm_calc='''
len=4
name='_codana
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_codsin
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_segno
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_tipope
next=Icpitembatch.CPVarDecl
frm_calc='iif(LRTrim(cgo_telematico->MEZPAGAM) <> 'I' and LRTrim(cgo_telematico->MEZPAGAM) <> 'E' and LRTrim(cgo_telematico->MEZPAGAM) <> 'P','A',LRTrim(cgo_telematico->MEZPAGAM))
len=1
name='_mezpagam
next=Icpitembatch.CPRead
arch='cgo_causali
next=Icpitembatch.CPIfElse
frm_calc=[
'_codana <> '26' and _codana <> '48' and _codana <> 'AA'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
prev=O3603
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3604
fatherSonIndex=0
frm_calc=''10'
len=2
name='_tipope
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3604
fatherSonIndex=1
frm_calc=[
'_segno = 'D'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3611
fatherSonIndex=0
frm_calc=''11'
len=2
name='_tipope
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3611
fatherSonIndex=1
frm_calc=''12'
len=2
name='_tipope
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=10
prev=O3602
rd_field=[
'CACODANA
'CACODSIN
'CASEGNO
]
rd_kfield=[
'CACODICE
'CATIPOPE
]
rd_kvar=[
'cgo_telematico->CACODICE
'_mezpagam
]
rd_var=[
'_codana
'_codsin
'_segno
]
I
obj='Var
pag=10
prev=O3601
var_op='asgn
I
obj='Var
pag=10
pagelocal=True
prev=O3600
var_op='asgn
I
obj='Var
pag=10
prev=O3599
var_op='asgn
I
obj='Var
pag=10
prev=O3598
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='D
pag=10
prev=O2745
var_op='asgn
I
obj='Var
obj_type='D
pag=10
prev=O2744
var_op='asgn
I
obj='Var
pag=10
prev=O2741
var_op='asgn
I
obj='If
pag=10
prev=O2740
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xnarapbo
father=O2741
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc=''P'
len=1
name='_locrap
obj='Var
pag=10
prev=O3628
var_op='asgn
I
obj='Read
pag=10
rd_field=[
'TIPORAP
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'cgo_telematico->RAPPORTO
]
rd_var=[
'_tiporap
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
prev=O2739
rd_field=[
'TIPORAP
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'cgo_telematico->RAPPORTO
]
rd_var=[
'_tiporap
]
I
obj='Var
pag=10
prev=O2738
var_op='asgn
I
obj='Var
pag=10
prev=O2736
var_op='asgn
I
obj='Select
pag=10
sel_field='*
sel_name='anadip
sel_where='anadip->CODDIP=cgo_telematico->CODDIPE
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2736
fatherSonIndex=0
frm_calc='anadip->DESCCIT
len=30
name='_citinter
next=Icpitembatch.CPVarDecl
frm_calc='anadip->CAB
len=6
name='_cabinter
next=Icpitembatch.CPVarDecl
frm_calc='anadip->PROVINCIA
len=2
name='_prvinter
obj='Var
pag=10
prev=O3642
var_op='asgn
I
obj='Var
pag=10
prev=O3641
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=10
x=19
y=16
I
Icpitembatch.CPRemark
frm_calc='Scrive i dati aggiuntivi delle operazioni/frazionate
next=Icpitembatch.CPIfElse
frm_calc=[
'_flgaui='N'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=11
prev=O3646
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sraziobo_agg
father=O3647
fatherSonIndex=0
obj='Insert
pag=11
rd_kfield=[
'IDBASE
'CODLOB
'TIPOGIOCO
'CACODICE
'IDBIGLIETTO
'CATIPGIO
'CATIPCON
'CAPV_COD
'CADATAORA
'VPCODICE
]
rd_kvar=[
'cOpeProg1
'_codlob
'_tipgio
'_cacodice
'_biglietto
'_catipgio
'_catipcon
'_capv_cod
'_cadataora
'_vpcodice
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3647
fatherSonIndex=1
frm_calc=[
'_tottele >= _limoper
]
h=[
19
19
19
]
haselse=True
obj='If
pag=11
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3656
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=11
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xperazbo_agg
father=O3661
fatherSonIndex=0
obj='Insert
pag=11
rd_kfield=[
'IDBASE
'CODLOB
'TIPOGIOCO
'CACODICE
'IDBIGLIETTO
'CATIPGIO
'CATIPCON
'CAPV_COD
'CADATAORA
'VPCODICE
'CATEG01
'CATEGORIA
]
rd_kvar=[
'cOpeProg1
'_codlob
'_tipgio
'_cacodice
'_biglietto
'_catipgio
'_catipcon
'_capv_cod
'_cadataora
'_vpcodice
''ON'
''ON'
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='operazbo_agg
father=O3661
fatherSonIndex=1
obj='Insert
pag=11
rd_kfield=[
'IDBASE
'CODLOB
'TIPOGIOCO
'CACODICE
'IDBIGLIETTO
'CATIPGIO
'CATIPCON
'CAPV_COD
'CADATAORA
'VPCODICE
'CATEG01
'CATEGORIA
]
rd_kvar=[
'cOpeProg1
'_codlob
'_tipgio
'_cacodice
'_biglietto
'_catipgio
'_catipcon
'_capv_cod
'_cadataora
'_vpcodice
''ON'
''ON'
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3656
fatherSonIndex=1
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=11
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xraziobo_agg
father=O3675
fatherSonIndex=0
obj='Insert
pag=11
rd_kfield=[
'IDBASE
'CODLOB
'TIPOGIOCO
'CACODICE
'IDBIGLIETTO
'CATIPGIO
'CATIPCON
'CAPV_COD
'CADATAORA
'VPCODICE
'CATEG01
'CATEGORIA
]
rd_kvar=[
'cOpeProg1
'_codlob
'_tipgio
'_cacodice
'_biglietto
'_catipgio
'_catipcon
'_capv_cod
'_cadataora
'_vpcodice
''ON'
''ON'
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='fraziobo_agg
father=O3675
fatherSonIndex=1
obj='Insert
pag=11
rd_kfield=[
'IDBASE
'CODLOB
'TIPOGIOCO
'CACODICE
'IDBIGLIETTO
'CATIPGIO
'CATIPCON
'CAPV_COD
'CADATAORA
'VPCODICE
'CATEG01
'CATEGORIA
]
rd_kvar=[
'cOpeProg1
'_codlob
'_tipgio
'_cacodice
'_biglietto
'_catipgio
'_catipcon
'_capv_cod
'_cadataora
'_vpcodice
''ON'
''ON'
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=11
x=21
y=27
I
Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3690
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PPOPER1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPVarDecl
frm_calc=''O'+Right(cOpeProg2,9)+_idb2
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='nIntest
next=Icpitembatch.CPInsert
arch='xperazbo
next=Icpitembatch.CPIfElse
frm_calc=[
'_locrap='D'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_mezpagam='I' or _mezpagam='E' or _mezpagam='P'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_iban))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='oNumero + 1
len=10
name='oNumero
obj='Var
obj_type='N
pag=12
prev=O3708
var_op='asgn
I
obj='If
pag=12
prev=O3705
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3708
fatherSonIndex=0
frm_calc=[
'Left(_iban,2)='IT'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3714
fatherSonIndex=0
frm_calc='Substr(_iban,6,5)+"-"+Substr(_iban,11,5)
len=11
name='abicab
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=12
prev=O3719
sel_field='*
sel_name='inter2bo
sel_where='inter2bo->CODINTER=abicab
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O3720
fatherSonIndex=0
obj='Write
pag=12
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'inter2bo->TIPINTER
'abicab
'inter2bo->PAESE
'inter2bo->DESCCIT
'inter2bo->PROVINCIA
'inter2bo->CODCAB
'inter2bo->RAGSOC
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3714
fatherSonIndex=1
frm_calc='Left(_iban,11)
len=11
name='abicab
next=Icpitembatch.CPWrite
arch='xperazbo
obj='Write
pag=12
prev=O3733
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CODINT2
]
wr_op=[
'=
]
wr_var=[
'abicab
]
I
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=12
prev=O3702
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3705
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=12
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=xCF
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O3745
fatherSonIndex=0
obj='Write
pag=12
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CONNESBEN
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
'personbo->CONNES
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=12
prev=O3701
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3702
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=12
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3760
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=10
name='nIntest
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_codsog
next=Icpitembatch.CPRead
arch='cgo_totope
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_codsog))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=12
prev=O3769
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cgo_totope
father=O3770
fatherSonIndex=0
obj='Insert
pag=12
rd_kfield=[
'TODATOPE
'TOCODSOG
'TONUMOPE
'TO_SEGNO
'TOIMPORT
]
rd_kvar=[
'_datope
'intestbo->CODINTER
'1
'_segno
'_importo
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cgo_totope
father=O3770
fatherSonIndex=1
obj='Write
pag=12
rd_kfield=[
'TODATOPE
'TOCODSOG
'TO_SEGNO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'_datope
'_codsog
'_segno
]
wr_field=[
'TONUMOPE
'TOIMPORT
]
wr_op=[
'+
'+
]
wr_var=[
'1
'_importo
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=12
prev=O3768
rd_field=[
'TOCODSOG
]
rd_kfield=[
'TODATOPE
'TOCODSOG
'TO_SEGNO
]
rd_kvar=[
'_datope
'intestbo->CODINTER
'_segno
]
rd_var=[
'_codsog
]
I
obj='Var
pag=12
prev=O3767
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O3764
var_op='asgn
I
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3764
fatherSonIndex=0
frm_calc='intestbo->CODINTER
len=16
name='xCF
next=Icpitembatch.CPWrite
arch='xperazbo
obj='Write
pag=12
prev=O3793
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'intestbo->CODINTER
]
I
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientiope
father=O3764
fatherSonIndex=1
obj='Insert
pag=12
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3702
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=12
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3808
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=10
name='nIntest
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_codsog
next=Icpitembatch.CPRead
arch='cgo_totope
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_codsog))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=12
prev=O3817
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cgo_totope
father=O3818
fatherSonIndex=0
obj='Insert
pag=12
rd_kfield=[
'TODATOPE
'TOCODSOG
'TONUMOPE
'TO_SEGNO
'TOIMPORT
]
rd_kvar=[
'_datope
'xntestbo->CODINTER
'1
'_segno
'_importo
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cgo_totope
father=O3818
fatherSonIndex=1
obj='Write
pag=12
rd_kfield=[
'TODATOPE
'TOCODSOG
'TO_SEGNO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'_datope
'_codsog
'_segno
]
wr_field=[
'TONUMOPE
'TOIMPORT
]
wr_op=[
'+
'+
]
wr_var=[
'1
'_importo
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=12
prev=O3816
rd_field=[
'TOCODSOG
]
rd_kfield=[
'TODATOPE
'TOCODSOG
'TO_SEGNO
]
rd_kvar=[
'_datope
'xntestbo->CODINTER
'_segno
]
rd_var=[
'_codsog
]
I
obj='Var
pag=12
prev=O3815
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O3812
var_op='asgn
I
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3812
fatherSonIndex=0
frm_calc='xntestbo->CODINTER
len=16
name='xCF
next=Icpitembatch.CPWrite
arch='xperazbo
obj='Write
pag=12
prev=O3841
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xntestbo->CODINTER
]
I
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientiope
father=O3812
fatherSonIndex=1
obj='Insert
pag=12
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'xntestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=12
prev=O3700
rd_kfield=[
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'DATAIMP
'DATAOPE
'DATAREG
'DESCCIT
'DUCOLLEG
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'IPCOLLEG
'NOPROT
'NUMPROG
'OPRAP
'ORACOLLEG
'PRGIMPOPE
'PROVINCIA
'RAPPORTO
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
'MTCN
'IDBASE2
]
rd_kvar=[
'xData
'xData
'DateToChar(Date())
'_codana
'_cabinter
'_coddip
'_codinter
'_codsin
'Date()
'_datope
'Date()
'_citinter
'_drcol
''0'
''0'
''3'
'_tiporap
'cOpeProg1
'_idreg
'_ipcol
'0
'cOpeProg2
''1'
'_orcol
'nProgImp
'_prvinter
'_rapporto
'_idbiglietto
'_segno
''0'
''1'
'_tipinter
''0'
'_tipope
'0
'_importo * 100
''242'
'_env
'_idb2
]
I
obj='Var
obj_type='N
pag=12
prev=O3699
var_op='asgn
I
obj='Var
pag=12
prev=O3698
var_op='asgn
I
obj='Var
pag=12
prev=O3697
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O3696
var_op='asgn
I
obj='Var
pag=12
prev=O3695
var_op='asgn
I
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3690
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("POPERAZ2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPVarDecl
frm_calc=''O'+Right(cOpeProg2,9)+_idb2
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='nIntest
next=Icpitembatch.CPInsert
arch='operazbo
next=Icpitembatch.CPIfElse
frm_calc=[
'_locrap='D'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_mezpagam='I' or _mezpagam='E' or _mezpagam='P'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_iban))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='oNumero + 1
len=10
name='oNumero
obj='Var
obj_type='N
pag=12
prev=O3872
var_op='asgn
I
obj='If
pag=12
prev=O3869
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3872
fatherSonIndex=0
frm_calc=[
'Left(_iban,2)='IT'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3878
fatherSonIndex=0
frm_calc='Substr(_iban,6,5)+"-"+Substr(_iban,11,5)
len=11
name='abicab
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=12
prev=O3883
sel_field='*
sel_name='inter2bo
sel_where='inter2bo->CODINTER=abicab
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O3884
fatherSonIndex=0
obj='Write
pag=12
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'inter2bo->TIPINTER
'abicab
'inter2bo->PAESE
'inter2bo->DESCCIT
'inter2bo->PROVINCIA
'inter2bo->CODCAB
'inter2bo->RAGSOC
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3878
fatherSonIndex=1
frm_calc='Left(_iban,11)
len=11
name='abicab
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=12
prev=O3897
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CODINT2
]
wr_op=[
'=
]
wr_var=[
'abicab
]
I
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=12
prev=O3866
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3869
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=12
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=xCF
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O3909
fatherSonIndex=0
obj='Write
pag=12
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CONNESBEN
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
'personbo->CONNES
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=12
prev=O3865
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3866
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=12
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3924
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=10
name='nIntest
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_codsog
next=Icpitembatch.CPRead
arch='cgo_totope
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_codsog))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=12
prev=O3933
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cgo_totope
father=O3934
fatherSonIndex=0
obj='Insert
pag=12
rd_kfield=[
'TODATOPE
'TOCODSOG
'TONUMOPE
'TO_SEGNO
'TOIMPORT
]
rd_kvar=[
'_datope
'intestbo->CODINTER
'1
'_segno
'_importo
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cgo_totope
father=O3934
fatherSonIndex=1
obj='Write
pag=12
rd_kfield=[
'TODATOPE
'TOCODSOG
'TO_SEGNO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'_datope
'_codsog
'_segno
]
wr_field=[
'TONUMOPE
'TOIMPORT
]
wr_op=[
'+
'+
]
wr_var=[
'1
'_importo
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=12
prev=O3932
rd_field=[
'TOCODSOG
]
rd_kfield=[
'TODATOPE
'TOCODSOG
'TO_SEGNO
]
rd_kvar=[
'_datope
'intestbo->CODINTER
'_segno
]
rd_var=[
'_codsog
]
I
obj='Var
pag=12
prev=O3931
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O3928
var_op='asgn
I
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3928
fatherSonIndex=0
frm_calc='intestbo->CODINTER
len=16
name='xCF
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=12
prev=O3957
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'intestbo->CODINTER
]
I
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O3928
fatherSonIndex=1
obj='Insert
pag=12
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3866
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=12
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3972
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=10
name='nIntest
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_codsog
next=Icpitembatch.CPRead
arch='cgo_totope
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_codsog))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=12
prev=O3981
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cgo_totope
father=O3982
fatherSonIndex=0
obj='Insert
pag=12
rd_kfield=[
'TODATOPE
'TOCODSOG
'TONUMOPE
'TO_SEGNO
'TOIMPORT
]
rd_kvar=[
'_datope
'xntestbo->CODINTER
'1
'_segno
'_importo
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cgo_totope
father=O3982
fatherSonIndex=1
obj='Write
pag=12
rd_kfield=[
'TODATOPE
'TOCODSOG
'TO_SEGNO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'_datope
'_codsog
'_segno
]
wr_field=[
'TONUMOPE
'TOIMPORT
]
wr_op=[
'+
'+
]
wr_var=[
'1
'_importo
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=12
prev=O3980
rd_field=[
'TOCODSOG
]
rd_kfield=[
'TODATOPE
'TOCODSOG
'TO_SEGNO
]
rd_kvar=[
'_datope
'xntestbo->CODINTER
'_segno
]
rd_var=[
'_codsog
]
I
obj='Var
pag=12
prev=O3979
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O3976
var_op='asgn
I
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3976
fatherSonIndex=0
frm_calc='xntestbo->CODINTER
len=16
name='xCF
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=12
prev=O4005
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xntestbo->CODINTER
]
I
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O3976
fatherSonIndex=1
obj='Insert
pag=12
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'xntestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=12
prev=O3864
rd_kfield=[
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'DATAIMP
'DATAOPE
'DATAREG
'DESCCIT
'DUCOLLEG
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'IPCOLLEG
'NOPROT
'NUMPROG
'OPRAP
'ORACOLLEG
'PRGIMPOPE
'PROVINCIA
'RAPPORTO
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
'MTCN
'IDBASE2
]
rd_kvar=[
'xData
'xData
'DateToChar(Date())
'_codana
'_cabinter
'_coddip
'_codinter
'_codsin
'Date()
'_datope
'Date()
'_citinter
'_drcol
''0'
''0'
''3'
'_tiporap
'cOpeProg1
'_idreg
'_ipcol
'0
'cOpeProg2
''1'
'_orcol
'nProgImp
'_prvinter
'_rapporto
'_idbiglietto
'_segno
''0'
''1'
'_tipinter
''0'
'_tipope
'0
'_importo * 100
''242'
'_env
'_idb2
]
I
obj='Var
obj_type='N
pag=12
prev=O3863
var_op='asgn
I
obj='Var
pag=12
prev=O3862
var_op='asgn
I
obj='Var
pag=12
prev=O3861
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O3860
var_op='asgn
I
obj='Var
pag=12
prev=O3859
var_op='asgn
I
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
]
x=13
y=17
I
Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4023
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PPFRAZ1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPFRAZ2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='nIntest
next=Icpitembatch.CPInsert
arch='xraziobo
next=Icpitembatch.CPIfElse
frm_calc=[
'_locrap='D'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_mezpagam='I' or _mezpagam='E' or _mezpagam='P'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_iban))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='fNumero + 1
len=10
name='fNumero
obj='Var
obj_type='N
pag=13
prev=O4039
var_op='asgn
I
obj='If
pag=13
prev=O4036
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4039
fatherSonIndex=0
frm_calc=[
'Left(_iban,2)='IT'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4045
fatherSonIndex=0
frm_calc='Substr(_iban,6,5)+"-"+Substr(_iban,11,5)
len=11
name='abicab
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=13
prev=O4050
sel_field='*
sel_name='inter2bo
sel_where='inter2bo->CODINTER=abicab
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xraziobo
father=O4051
fatherSonIndex=0
obj='Write
pag=13
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'inter2bo->TIPINTER
'abicab
'inter2bo->PAESE
'inter2bo->DESCCIT
'inter2bo->PROVINCIA
'inter2bo->CODCAB
'inter2bo->RAGSOC
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4045
fatherSonIndex=1
frm_calc='Left(_iban,11)
len=11
name='abicab
next=Icpitembatch.CPWrite
arch='xraziobo
obj='Write
pag=13
prev=O4064
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CODINT2
]
wr_op=[
'=
]
wr_var=[
'abicab
]
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4033
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4036
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=13
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=xCF
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xraziobo
father=O4076
fatherSonIndex=0
obj='Write
pag=13
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CONNESBEN
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
'personbo->CONNES
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4032
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4033
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=13
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4091
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=10
name='nIntest
obj='Var
obj_type='N
pag=13
prev=O4095
var_op='asgn
I
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4095
fatherSonIndex=0
frm_calc='intestbo->CODINTER
len=16
name='xCF
next=Icpitembatch.CPWrite
arch='xraziobo
obj='Write
pag=13
prev=O4101
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'intestbo->CODINTER
]
I
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientifrz
father=O4095
fatherSonIndex=1
obj='Insert
pag=13
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4033
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=13
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4116
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=10
name='nIntest
obj='Var
obj_type='N
pag=13
prev=O4120
var_op='asgn
I
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4120
fatherSonIndex=0
frm_calc='xntestbo->CODINTER
len=16
name='xCF
next=Icpitembatch.CPWrite
arch='xraziobo
obj='Write
pag=13
prev=O4126
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xntestbo->CODINTER
]
I
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientifrz
father=O4120
fatherSonIndex=1
obj='Insert
pag=13
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'xntestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=13
prev=O4031
rd_kfield=[
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'DATAIMP
'DATAOPE
'DATAREG
'DESCCIT
'DUCOLLEG
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'IPCOLLEG
'NOPROT
'NUMPROG
'OPRAP
'ORACOLLEG
'PRGIMPFRZ
'PROVINCIA
'RAPPORTO
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
'MTCN
]
rd_kvar=[
'xData
'xData
'DateToChar(Date())
'_codana
'_cabinter
'_coddip
'_codinter
'_codsin
'Date()
'_datope
'Date()
'_citinter
'_drcol
''0'
''0'
''3'
'_tiporap
'cOpeProg1
'xData+cOpeProg2+'0'
'_ipcol
'0
'cOpeProg2
''1'
'_orcol
'nProgImp
'_prvinter
'_rapporto
'_idbiglietto
'_segno
''0'
''1'
'_tipinter
''0'
'_tipope
'0
'_importo * 100
''242'
'_env
]
I
obj='Var
obj_type='N
pag=13
prev=O4030
var_op='asgn
I
obj='Var
obj_type='N
pag=13
prev=O4029
var_op='asgn
I
obj='Var
pag=13
prev=O4028
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4023
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PFRAZIO2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='nIntest
next=Icpitembatch.CPInsert
arch='fraziobo
next=Icpitembatch.CPIfElse
frm_calc=[
'_locrap='D'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_mezpagam='I' or _mezpagam='E' or _mezpagam='P'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_iban))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='fNumero + 1
len=10
name='fNumero
obj='Var
obj_type='N
pag=13
prev=O4155
var_op='asgn
I
obj='If
pag=13
prev=O4152
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4155
fatherSonIndex=0
frm_calc=[
'Left(_iban,2)='IT'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4161
fatherSonIndex=0
frm_calc='Substr(_iban,6,5)+"-"+Substr(_iban,11,5)
len=11
name='abicab
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=13
prev=O4166
sel_field='*
sel_name='inter2bo
sel_where='inter2bo->CODINTER=abicab
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='fraziobo
father=O4167
fatherSonIndex=0
obj='Write
pag=13
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'inter2bo->TIPINTER
'abicab
'inter2bo->PAESE
'inter2bo->DESCCIT
'inter2bo->PROVINCIA
'inter2bo->CODCAB
'inter2bo->RAGSOC
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4161
fatherSonIndex=1
frm_calc='Left(_iban,11)
len=11
name='abicab
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=13
prev=O4180
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CODINT2
]
wr_op=[
'=
]
wr_var=[
'abicab
]
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4149
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4152
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=13
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=xCF
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='fraziobo
father=O4192
fatherSonIndex=0
obj='Write
pag=13
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CONNESBEN
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
'personbo->CONNES
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4148
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4149
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=13
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4207
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=10
name='nIntest
obj='Var
obj_type='N
pag=13
prev=O4211
var_op='asgn
I
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4211
fatherSonIndex=0
frm_calc='intestbo->CODINTER
len=16
name='xCF
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=13
prev=O4217
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'intestbo->CODINTER
]
I
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientifrz
father=O4211
fatherSonIndex=1
obj='Insert
pag=13
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4149
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=13
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=_rapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4232
fatherSonIndex=0
frm_calc=[
'nIntest=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='nIntest + 1
len=10
name='nIntest
obj='Var
obj_type='N
pag=13
prev=O4236
var_op='asgn
I
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4236
fatherSonIndex=0
frm_calc='xntestbo->CODINTER
len=16
name='xCF
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=13
prev=O4242
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xntestbo->CODINTER
]
I
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientifrz
father=O4236
fatherSonIndex=1
obj='Insert
pag=13
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
]
rd_kvar=[
'cOpeProg1
'xntestbo->CODINTER
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=13
prev=O4147
rd_kfield=[
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'DATAIMP
'DATAOPE
'DATAREG
'DESCCIT
'DUCOLLEG
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'IPCOLLEG
'NOPROT
'NUMPROG
'OPRAP
'ORACOLLEG
'PRGIMPFRZ
'PROVINCIA
'RAPPORTO
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
'MTCN
]
rd_kvar=[
'xData
'xData
'DateToChar(Date())
'_codana
'_cabinter
'_coddip
'_codinter
'_codsin
'Date()
'_datope
'Date()
'_citinter
'_drcol
''0'
''0'
''3'
'_tiporap
'cOpeProg1
'xData+cOpeProg2+'0'
'_ipcol
'0
'cOpeProg2
''1'
'_orcol
'nProgImp
'_prvinter
'_rapporto
'_idbiglietto
'_segno
''0'
''1'
'_tipinter
''0'
'_tipope
'0
'_importo * 100
''242'
'_env
]
I
obj='Var
obj_type='N
pag=13
prev=O4146
var_op='asgn
I
obj='Var
obj_type='N
pag=13
prev=O4145
var_op='asgn
I
obj='Var
pag=13
prev=O4144
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
x=14
y=15
I
Icpitembatch.CPRemark
frm_calc='Import Transazioni Agenzie
next=Icpitembatch.CPVarDecl
len=10
name='nProg
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_totale
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='oNumErr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='dNumNew
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_totale > 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
prev=O4266
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4268
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc=''Transazioni Agenzie Inserite: '+LRTrim(Str(dNumNew,10,0))
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGLOG\'"+LRTrim(_gAzienda)+"'",'',20)
len=20
name='cProg
next=Icpitembatch.CPInsert
arch='log_app
next=Icpitembatch.CPIfElse
frm_calc=[
'oNumErr > 0
]
h=[
19
19
]
obj='If
pag=14
prev=O4277
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4278
fatherSonIndex=0
frm_calc=''Transazioni Agenzie Scartate: '+LRTrim(Str(oNumErr,10,0)) + NL
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGLOG\'"+LRTrim(_gAzienda)+"'",'',20)
len=20
name='cProg
next=Icpitembatch.CPInsert
arch='log_app
obj='Insert
pag=14
prev=O4284
rd_kfield=[
'LOGCODICE
'LOGDATORA
'LOGUTENTE
'LOGTIPOPE
'LOGTESTO
'LOGTABELLA
'LOGCHIAVE
'LOGTYPE
]
rd_kvar=[
'cProg
'DateTime()
'1
''Import Dati'
'_gMsgProc
''Transazioni Agenzie'
''Scartati '+LRTrim(Str(dNumErr,10,0))
''S'
]
I
obj='Var
pag=14
prev=O4283
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=14
prev=O4276
rd_kfield=[
'LOGCODICE
'LOGDATORA
'LOGUTENTE
'LOGTIPOPE
'LOGTESTO
'LOGTABELLA
'LOGCHIAVE
'LOGTYPE
]
rd_kvar=[
'cProg
'DateTime()
'1
''Import Dati'
'_gMsgProc
''ANADIP'
''Inseriti / Aggiornati '+LRTrim(Str(dNumNew+dNumMod,10,0))
''S'
]
I
obj='Var
pag=14
prev=O4275
var_op='asgn
I
obj='Var
obj_type='M
pag=14
prev=O4273
var_op='asgn
I
obj='Select
pag=14
sel_field='*
sel_name='cgo_import_age
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4273
fatherSonIndex=0
frm_calc='0
len=10
name='nProg
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_recOK
next=Icpitembatch.CPBeginEnd
comment='Controlli sui dati anagrafici
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Controlli sui dati dell'operazione
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_recOK=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPDelete
arch='cgo_import_age
next=Icpitembatch.CPVarDecl
frm_calc='_conta + 1
len=10
name='_conta
obj='Var
obj_type='N
pag=14
prev=O4303
var_op='asgn
I
obj='Delete
pag=14
prev=O4300
rd_kfield=[
'NUMOPE
]
rd_kop=[
'=
]
rd_kvar=[
'cgo_import_age->NUMOPE
]
I
obj='If
pag=14
prev=O4298
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4300
fatherSonIndex=0
frm_calc='oNumErr + 1
len=10
name='oNumErr
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("IMPEB\'"+LRTrim(_gAzienda)+"'",0,10)
len=10
name='nProg
next=Icpitembatch.CPInsert
arch='cgo_errori_age
obj='Insert
pag=14
prev=O4311
rd_kfield=[
'CACODICE
'CADATIMP
'CANUMOPE
'CAIDBIGLIETTO
'CADATAORA
'CODDIPE
'CATIPGIO
'CAERRORI
]
rd_kvar=[
'nProg
'Date()
'cgo_import_age->NUMOPE
'cgo_import_age->CAIDBIGLIETTO
'cgo_import_age->CADATAORA
'cgo_import_age->CODDIPE
'cgo_import_age->TIPOGIOCO
'_txterr
]
I
obj='Var
obj_type='N
pag=14
pagelocal=True
prev=O4310
var_op='asgn
I
obj='Var
obj_type='N
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Crea la riga per l'elaborazione del soggetto e della transazione
father=O4300
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPExec
check='page
frm_calc='15
next=Icpitembatch.CPExec
check='page
frm_calc='16
obj='Exec
pag=14
prev=O4318
I
obj='Exec
pag=14
prev=O4316
I
obj='Begin
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4316
fatherSonIndex=0
frm_calc='cgo_import_age->NUMOPE
frm_seek='NUMOPE
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->CODFISC
frm_seek='CODFISC
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->CODCAB
frm_seek='CODCAB
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->RAGSOC
frm_seek='RAGSOC
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->DOMICILIO
frm_seek='DOMICILIO
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->DATANASC
frm_seek='DATANASC
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->NASCOMUN
frm_seek='NASCOMUN
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->TIPODOC
frm_seek='TIPODOC
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->NUMDOCUM
frm_seek='NUMDOCUM
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->DATARILASC
frm_seek='DATARILASC
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->AUTRILASC
frm_seek='AUTRILASC
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->DESCCIT
frm_seek='DESCCIT
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->PROVINCIA
frm_seek='PROVINCIA
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->PAESE
frm_seek='PAESE
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->CAP
frm_seek='CAP
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->TIPINTER
frm_seek='TIPINTER
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->SESSO
frm_seek='SESSO
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->DATAVALI
frm_seek='DATAVALI
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->NOME
frm_seek='NOME
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->COGNOME
frm_seek='COGNOME
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->CFESTERO
frm_seek='CFESTERO
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->PEP
frm_seek='PEP
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->DATAOPE
frm_seek='DATAOPE
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->CODDIPE
frm_seek='CODDIPE
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->FLAGCONT
frm_seek='FLAGCONT
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->RAPPORTO
frm_seek='RAPPORTO
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->FLAGLIRE
frm_seek='FLAGLIRE
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->VALUTA
frm_seek='VALUTA
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->SEGNO
frm_seek='SEGNO
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->TOTLIRE
frm_seek='TOTLIRE
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->TOTCONT
frm_seek='TOTCONT
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->CONNESCLI
frm_seek='CONNESCLI
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->CACODICE
frm_seek='CACODICE
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->CADATAORA
frm_seek='CADATAORA
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->CAIDBIGLIETTO
frm_seek='CAIDBIGLIETTO
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->IBAN
frm_seek='IBAN
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->MEZPAGAM
frm_seek='MEZPAGAM
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->CGOFLGVLT
frm_seek='CGOFLGVLT
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->CGOFLGVNP
frm_seek='CGOFLGVNP
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->CGOTIPOPE
frm_seek='CGOTIPOPE
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->CAFLGOPE
frm_seek='CAFLGOPE
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->TIPOGIOCO
frm_seek='TIPOGIOCO
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->ASSEGNO
frm_seek='ASSEGNO
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->CADATIMP
frm_seek='CADATIMP
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->RDCODAUT
frm_seek='RDCODAUT
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->RDLOCAUT
frm_seek='RDLOCAUT
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->VLTPLAT
frm_seek='VLTPLAT
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->CC4CIFRE
frm_seek='CC4CIFRE
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->CCDATSCA
frm_seek='CCDATSCA
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->NUMTEL
frm_seek='NUMTEL
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->IDDOCALL
frm_seek='IDDOCALL
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->FLGDOCALL
frm_seek='FLGDOCALL
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->CCANNSCA
frm_seek='CCANNSCA
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->CCMESSCA
frm_seek='CCMESSCA
name='rowAgenzia
next=Icpitembatch.CPVarDecl
frm_calc='cgo_import_age->PEPDESCRI
frm_seek='PEPDESCRI
name='rowAgenzia
obj='Var
obj_type='R
pag=14
prev=O4375
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4374
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4373
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4372
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4371
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4370
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4369
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4368
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4367
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4366
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4365
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4364
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4363
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4362
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4361
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4360
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4359
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4358
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4357
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4356
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4355
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4354
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4353
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4352
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4351
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4350
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4349
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4348
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4347
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4346
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4345
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4344
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4343
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4342
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4341
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4340
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4339
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4338
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4337
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4336
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4335
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4334
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4333
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4332
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4331
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4330
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4329
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4328
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4327
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4326
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4325
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4324
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4323
var_op='prop
I
obj='Var
obj_type='R
pag=14
prev=O4322
var_op='prop
I
obj='Var
obj_type='R
pag=14
var_op='prop
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=14
prev=O4296
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4298
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(cgo_import_age->MEZPAGAM))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'cgo_import_age->TOTLIRE=0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cgo_import_age->FLAGCONT='1' and cgo_import_age->TOTCONT=0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cgo_import_age->TOTCONT > cgo_import_age->TOTLIRE
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cgo_import_age->TIPOGIOCO))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cgo_import_age->CAIDBIGLIETTO))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cgo_import_age->DATAOPE)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cgo_import_age->CODDIPE))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cgo_import_age->CACODICE=0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
prev=O4402
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4405
fatherSonIndex=0
frm_calc='_txterr + "Manca la causale dell'operazione" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4410
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4405
fatherSonIndex=1
frm_calc='0
len=5
name='_codcau
next=Icpitembatch.CPRead
arch='cgo_causali
next=Icpitembatch.CPIfElse
frm_calc=[
'_codcau = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
prev=O4414
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4415
fatherSonIndex=0
frm_calc='_txterr + "Causale non presente in archivio causali" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4420
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4415
fatherSonIndex=1
frm_calc=[
'not(Empty(LRTrim(cgo_import_age->MEZPAGAM)))
]
h=[
19
19
]
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4423
fatherSonIndex=0
frm_calc='iif(At(LRTrim(cgo_import_age->MEZPAGAM), '|I|E|P')=0,'A',LRTrim(cgo_import_age->MEZPAGAM))
len=1
name='_mezpagam
next=Icpitembatch.CPRead
arch='cgo_causali
next=Icpitembatch.CPIfElse
frm_calc=[
'_codcau=0
]
h=[
19
19
]
obj='If
pag=14
prev=O4429
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4430
fatherSonIndex=0
frm_calc='_txterr + "Causale dell'operazione errata" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4435
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=14
prev=O4428
rd_field=[
'CACODICE
]
rd_kfield=[
'CACODICE
'CATIPOPE
]
rd_kvar=[
'cgo_import_age->CACODICE
'_mezpagam
]
rd_var=[
'_codcau
]
I
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=14
prev=O4413
rd_field=[
'CACODICE
]
rd_kfield=[
'CACODICE
]
rd_kvar=[
'cgo_import_age->CACODICE
]
rd_var=[
'_codcau
]
I
obj='Var
obj_type='N
pag=14
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=14
prev=O4399
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4402
fatherSonIndex=0
frm_calc='_txterr + "Manca il codice dell'agenzia" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4451
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O4396
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4399
fatherSonIndex=0
frm_calc='_txterr + "Manca la data dell'operazione" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4456
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O4393
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4396
fatherSonIndex=0
frm_calc='_txterr + "Manca l'ID Biglietto" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4461
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O4390
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4393
fatherSonIndex=0
frm_calc='_txterr + 'Manca tipo di gioco' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4466
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O4387
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4390
fatherSonIndex=0
frm_calc='_txterr + "Importo in contanti maggiore dell'importo totale" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4471
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O4384
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4387
fatherSonIndex=0
frm_calc='_txterr + 'Importo in contanti assente' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4476
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O4381
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4384
fatherSonIndex=0
frm_calc='_txterr + "Manca l'importo dell'operazione" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4481
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4381
fatherSonIndex=0
frm_calc='_txterr + 'Manca mezzo di pagamento' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4486
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O4381
fatherSonIndex=1
frm_calc=[
'cgo_import_age->MEZPAGAM='V'
'cgo_import_age->MEZPAGAM='C' or cgo_import_age->MEZPAGAM='B'
'cgo_import_age->MEZPAGAM = 'I' or cgo_import_age->MEZPAGAM = 'E' or cgo_import_age->MEZPAGAM = 'P'
]
h=[
19
19
19
19
]
obj='Case
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4489
fatherSonIndex=0
frm_calc=[
'not(arfn_cgo_chkcc(cgo_import_age->CC4CIFRE,cgo_import_age->DATAOPE,cgo_import_age->CCMESSCA,cgo_import_age->CCANNSCA,2,cgo_import_age->MEZPAGAM))
]
h=[
19
19
]
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4494
fatherSonIndex=0
frm_calc='_txterr + 'Carta di credito non valida' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4499
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4489
fatherSonIndex=1
frm_calc=[
'Empty(LRTrim(cgo_import_age->ASSEGNO))
]
h=[
19
19
]
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4503
fatherSonIndex=0
frm_calc='_txterr + "Manca il numero dell'assegno" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4508
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4489
fatherSonIndex=2
frm_calc=[
'not(arfn_chkiban(Upper(cgo_import_age->IBAN),cgo_import_age->MEZPAGAM))
]
h=[
19
19
]
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4512
fatherSonIndex=0
frm_calc='_txterr + 'Codice IBAN non valido' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4517
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=14
prev=O4295
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4296
fatherSonIndex=0
frm_calc=[
'Empty(cgo_import_age->NASCOMUN) and Empty(cgo_import_age->NASSTATO)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPBeginEnd
comment='Controllo dati documento
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Controllo codice fiscale (Formale)
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cgo_import_age->DATANASC)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cgo_import_age->PAESE)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
prev=O4532
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4535
fatherSonIndex=0
frm_calc='_txterr + 'Manca il paese di residenza del soggetto' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4540
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4535
fatherSonIndex=1
frm_calc=[
'cgo_import_age->PAESE='086'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4543
fatherSonIndex=0
frm_calc=[
'Empty(cgo_import_age->DOMICILIO)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cgo_import_age->DESCCIT)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
prev=O4548
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4551
fatherSonIndex=0
frm_calc='_txterr + 'Manca il comune di residenza' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4556
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4551
fatherSonIndex=1
frm_calc='''
len=40
name='_cdescit
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_cdescit)
]
h=[
19
19
]
obj='If
pag=14
prev=O4560
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4562
fatherSonIndex=0
frm_calc='_txterr + 'Città di residenza intestatario operazione errata' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4567
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=14
prev=O4559
sel_field='*
sel_name='tbcitta
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4560
fatherSonIndex=0
frm_calc=[
'LRTrim(Left(tbcitta->CITTA,30))=Upper(LRTrim(cgo_import_age->DESCCIT)) and tbcitta->PROV=cgo_import_age->PROVINCIA
]
h=[
19
19
]
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4572
fatherSonIndex=0
frm_calc='tbcitta->CITTA
len=40
name='_cdescit
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=14
prev=O4577
I
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4548
fatherSonIndex=0
frm_calc='_txterr + "Manca il domicilio del soggetto" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4584
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4543
fatherSonIndex=1
frm_calc=[
'Upper(LRTrim(cgo_import_age->PROVINCIA)) <> 'EE' and not(Empty(cgo_import_age->PROVINCIA))
]
h=[
19
19
]
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4588
fatherSonIndex=0
frm_calc='_txterr + "Provincia errata per soggetto residente all'estero" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4593
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=14
prev=O4530
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4532
fatherSonIndex=0
frm_calc='_txterr + "Manca la data di nascita del soggetto" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4600
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4532
fatherSonIndex=1
frm_calc=[
'cgo_import_age->DATANASC > Date()
]
h=[
19
19
]
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4603
fatherSonIndex=0
frm_calc='_txterr + "Data di nascita del soggetto errata" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4608
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=14
prev=O4528
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4530
fatherSonIndex=0
frm_calc=[
'not(arfn_chkcodfis(cgo_import_age->CODFISC,cgo_import_age->PAESE,cgo_import_age->CFESTERO))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(arfn_cgo_calccodfis(Upper(LRTrim(cgo_import_age->COGNOME)),Upper(LRTrim(cgo_import_age->NOME)),cgo_import_age->DATANASC,Upper(LRTrim(cgo_import_age->NASCOMUN)),Upper(LRTrim(cgo_import_age->NASSTATO)),Upper(LRTrim(cgo_import_age->SESSO)),Upper(LRTrim(cgo_import_age->TIPINTER)),Upper(LRTrim(cgo_import_age->CODFISC)),''))
]
h=[
19
19
]
obj='If
pag=14
prev=O4614
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4617
fatherSonIndex=0
frm_calc='_txterr + 'Codice Fiscale non coerente con dati anagrafici' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4622
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4614
fatherSonIndex=0
frm_calc='_txterr + 'Codice Fiscale Formalmente non valido' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4627
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=14
prev=O4525
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O4528
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(cgo_import_age->AUTRILASC))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cgo_import_age->NUMDOCUM))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cgo_import_age->TIPODOC))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cgo_import_age->DATARILASC)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cgo_import_age->DATAVALI)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
prev=O4642
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4645
fatherSonIndex=0
frm_calc='_txterr + "Manca data scadenza del documento del soggetto" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4650
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4645
fatherSonIndex=1
frm_calc=[
'cgo_import_age->DATAVALI < cgo_import_age->DATARILASC
]
h=[
19
19
]
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4653
fatherSonIndex=0
frm_calc='_txterr + "Data scadenza del documento del soggetto inferiore alla data di rilascio" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4658
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=14
prev=O4639
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4642
fatherSonIndex=0
frm_calc='_txterr + "Manca data rilascio del documento del soggetto" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4664
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4642
fatherSonIndex=1
frm_calc=[
'cgo_import_age->DATARILASC > Date()
]
h=[
19
19
]
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4667
fatherSonIndex=0
frm_calc='_txterr + "Data rilascio del documento del soggetto errata" + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4672
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=14
prev=O4636
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4639
fatherSonIndex=0
frm_calc='_txterr + 'Manca tipo documento identità' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4678
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4639
fatherSonIndex=1
frm_calc='''
len=2
name='_ctipdoc
next=Icpitembatch.CPRead
arch='tbtipdoc
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_ctipdoc))
]
h=[
19
19
]
obj='If
pag=14
prev=O4682
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4683
fatherSonIndex=0
frm_calc='_txterr + 'Tipo documento identità errato' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4688
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=14
prev=O4681
rd_field=[
'TIPDOC
]
rd_kfield=[
'TIPDOC
]
rd_kvar=[
'cgo_import_age->TIPODOC
]
rd_var=[
'_ctipdoc
]
I
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=14
prev=O4633
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4636
fatherSonIndex=0
frm_calc='_txterr + 'Manca numero documento identità' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4698
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4633
fatherSonIndex=0
frm_calc='_txterr + 'Manca autorità rilascio del documento' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4703
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4525
fatherSonIndex=0
frm_calc='_txterr + 'Manca il Comune o lo Stato di Nascita' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4709
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4525
fatherSonIndex=1
frm_calc=[
'Empty(cgo_import_age->TIPINTER)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4712
fatherSonIndex=0
frm_calc='_txterr + 'Manca la provincia di Nascita' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4717
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4712
fatherSonIndex=1
frm_calc=[
'Upper(LRTrim(cgo_import_age->TIPINTER))='EE'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4720
fatherSonIndex=0
frm_calc='''
len=40
name='_cdessta
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_cdessta)
]
h=[
19
19
]
obj='If
pag=14
prev=O4726
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4727
fatherSonIndex=0
frm_calc='_txterr + 'Stato di nascita intestatario operazione errato' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4732
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=14
prev=O4725
rd_field=[
'DESCRI
]
rd_kfield=[
'DESCRI
]
rd_kvar=[
'Upper(LRTrim(cgo_import_age->NASSTATO))
]
rd_var=[
'_cdessta
]
I
obj='Var
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4720
fatherSonIndex=1
frm_calc='''
len=40
name='_cdescit
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_cdescit)
]
h=[
19
19
]
obj='If
pag=14
prev=O4741
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4743
fatherSonIndex=0
frm_calc='_txterr + 'Città di nascita intestatario operazione errata' + NL
len=10
name='_txterr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_recOK
obj='Var
obj_type='N
pag=14
prev=O4748
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=14
prev=O4740
sel_field='*
sel_name='tbcitta
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4741
fatherSonIndex=0
frm_calc=[
'LRTrim(Left(tbcitta->CITTA,30))=Upper(LRTrim(cgo_import_age->NASCOMUN)) and tbcitta->PROV=cgo_import_age->TIPINTER
]
h=[
19
19
]
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4753
fatherSonIndex=0
frm_calc='tbcitta->CITTA
len=40
name='_cdescit
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=14
prev=O4758
I
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=14
prev=O4294
var_op='asgn
I
obj='Var
obj_type='M
pag=14
prev=O4293
var_op='asgn
I
obj='Var
obj_type='N
pag=14
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4268
fatherSonIndex=1
frm_calc='"Nessuna Transazione Agenzia da elaborare presente"
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGLOG\'"+LRTrim(_gAzienda)+"'",'',20)
len=20
name='cProg
next=Icpitembatch.CPInsert
arch='log_app
obj='Insert
pag=14
prev=O4769
rd_kfield=[
'LOGCODICE
'LOGDATORA
'LOGUTENTE
'LOGTIPOPE
'LOGTESTO
'LOGTABELLA
'LOGCHIAVE
'LOGTYPE
]
rd_kvar=[
'cProg
'DateTime()
'1
''Import Dati'
'_gMsgProc
''ANADIP'
''NO RECORDS'
''S'
]
I
obj='Var
pag=14
prev=O4768
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=14
prev=O4265
sel_name='qbe_cgo_import_age_totale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4266
fatherSonIndex=0
frm_calc='qbe_cgo_import_age_totale->TOTOPE
len=10
name='_totale
obj='Var
obj_type='N
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=14
prev=O4264
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O4263
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O4262
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O4261
var_op='asgn
I
obj='Var
obj_type='N
pag=14
pagelocal=True
prev=O4260
I
obj='Remark
pag=14
x=14
y=19
I
Icpitembatch.CPBeginEnd
comment='Scrive i dati del soggetto
h=[
19
19
]
obj='Begin
pag=15
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4778
fatherSonIndex=0
frm_calc='''
len=16
name='_connes
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='xFLGSAE
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(rowAgenzia.CONNESCLI))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_connes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
prev=O4787
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4790
fatherSonIndex=0
frm_calc='rowAgenzia.CODFISC
len=16
name='_connes
next=Icpitembatch.CPVarDecl
frm_calc='rowAgenzia.CODFISC
len=16
name='_codfisc
next=Icpitembatch.CPIfElse
frm_calc=[
'rowAgenzia.CFESTERO=1 and Empty(LRTrim(rowAgenzia.CODFISC))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOCLI\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='personbo
next=Icpitembatch.CPInsert
arch='personbo_agg
obj='Insert
pag=15
prev=O4801
rd_kfield=[
'CONNES
'RDCODAUT
'RDLOCAUT
'NUMTEL
'LASTOPER
]
rd_kvar=[
'_connes
'rowAgenzia.RDCODAUT
'rowAgenzia.RDLOCAUT
'rowAgenzia.NUMTEL
'rowAgenzia.NUMOPE
]
I
obj='Insert
pag=15
prev=O4800
rd_kfield=[
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'SESSO
'DATAVALI
'TIPOPERS
'COGNOME
'NOME
'TIPINTER
'CFESTERO
'NASSTATO
'PROGIMPORT
'PEP
]
rd_kvar=[
'_connes
'rowAgenzia.CODCAB
'rowAgenzia.RAGSOC
'rowAgenzia.DOMICILIO
'_codfisc
'rowAgenzia.DATANASC
'rowAgenzia.NASCOMUN
'iif(rowAgenzia.CFESTERO=0,'600','77'+xFLGSAE)
'''
'iif(rowAgenzia.CFESTERO=0,'600','711')
'rowAgenzia.TIPODOC
'rowAgenzia.NUMDOCUM
'rowAgenzia.DATARILASC
'rowAgenzia.AUTRILASC
'rowAgenzia.DESCCIT
'rowAgenzia.PROVINCIA
'rowAgenzia.PAESE
'rowAgenzia.CAP
'rowAgenzia.SESSO
'rowAgenzia.DATAVALI
''P'
'rowAgenzia.COGNOME
'rowAgenzia.NOME
'rowAgenzia.TIPINTER
'rowAgenzia.CFESTERO
'rowAgenzia.NASSTATO
'nProgImp
'rowAgenzia.PEP
]
I
obj='Var
obj_type='N
pag=15
prev=O4797
var_op='asgn
I
obj='If
pag=15
prev=O4796
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4797
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGCLIEST\'"+LRTrim(_gAzienda)+"'","",16)
len=16
name='_connes
next=Icpitembatch.CPVarDecl
frm_calc='_connes
len=16
name='_codfisc
obj='Var
pag=15
prev=O4809
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=15
prev=O4795
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Azzeramento Variabili
father=O4790
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Ricava i dati dalla riga cgo_operazioni
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Crea la riga di confronto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Upper(LRTrim(xRiga1)) <> Upper(LRTrim(xRiga2))
]
h=[
19
19
]
next=Icpitembatch.CPRead
arch='personbo_agg
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_codfisc))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('SAVE','PERSONBO',"Sto elaborando l'operazione con codice:"+rowAgenzia.NUMOPE+" - Salvataggio dati soggetto con codice:"+_connes)
obj='Exec
pag=15
prev=O4824
I
obj='If
pag=15
prev=O4823
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='personbo_agg
father=O4824
fatherSonIndex=0
obj='Insert
pag=15
rd_kfield=[
'CONNES
'RDCODAUT
'RDLOCAUT
'NUMTEL
'LASTOPER
]
rd_kvar=[
'_connes
'rowAgenzia.RDCODAUT
'rowAgenzia.RDLOCAUT
'rowAgenzia.NUMTEL
'rowAgenzia.NUMOPE
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='personbo_agg
father=O4824
fatherSonIndex=1
obj='Write
pag=15
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'_connes
]
wr_field=[
'RDCODAUT
'RDLOCAUT
'NUMTEL
'LASTOPER
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'rowAgenzia.RDCODAUT
'rowAgenzia.RDLOCAUT
'rowAgenzia.NUMTEL
'rowAgenzia.NUMOPE
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=15
prev=O4820
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'_connes
]
rd_var=[
'_codfisc
]
I
obj='If
pag=15
prev=O4818
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Storicizza le modifiche
father=O4820
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='personbo
frm_calc='Errore in aggiornamento ARCHPERS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_codfisc
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=15
prev=O4851
sel_field='intestbo->DATAINI,intestbo->DATAFINE,intestbo->RAPPORTO
sel_name='intestbo
sel_where='intestbo->CODINTER=_connes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4852
fatherSonIndex=0
frm_calc=[
'rowAgenzia.DATAOPE >= intestbo->DATAINI and (Empty(intestbo->DATAFINE) or intestbo->DATAFINE >= rowAgenzia.DATAOPE)
]
h=[
19
19
]
obj='If
pag=15
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4856
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc=''I'+cInfProg2
len=12
name='cColleg
next=Icpitembatch.CPInsert
arch='rapopebo
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='rapopebo
obj='Insert
pag=15
prev=O4868
rd_kfield=[
'CDATOPE
'CDATREG
'CODCAB
'CODINTER
'COLLEG
'DATAOPE
'DATAREG
'DESCCIT
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'VALUTA
]
rd_kvar=[
'DateToChar(Date())
'DateToChar(Date())
'_cabinter
'_codinter
'cColleg
'Date()
'Date()
'_citinter
''3'
''0'
'cInfProg1
'DateToChar(Date())+cInfProg1+'0'
'cInfProg2
''2'
'nProgImp
'_prvinter
'intestbo->RAPPORTO
''0'
''1'
'_tipinter
''0'
''32'
''242'
]
I
obj='Var
obj_type='N
pag=15
prev=O4867
var_op='asgn
I
obj='Var
pag=15
prev=O4866
var_op='asgn
I
obj='Var
pag=15
prev=O4865
var_op='asgn
I
obj='Insert
pag=15
prev=O4864
rd_kfield=[
'CDATOPE
'CDATREG
'CODCAB
'CODINTER
'COLLEG
'DATAOPE
'DATAREG
'DESCCIT
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'VALUTA
]
rd_kvar=[
'DateToChar(Date())
'DateToChar(Date())
'_cabinter
'_codinter
'cColleg
'Date()
'Date()
'_citinter
''3'
''0'
'cInfProg1
'DateToChar(Date())+cInfProg1+'0'
'cInfProg2
''2'
'nProgImp
'_prvinter
'intestbo->RAPPORTO
''0'
''1'
'_tipinter
''0'
''31'
''242'
]
I
obj='Var
pag=15
prev=O4863
var_op='asgn
I
obj='Var
obj_type='N
pag=15
prev=O4862
var_op='asgn
I
obj='Var
pag=15
prev=O4861
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=15
prev=O4850
var_op='asgn
I
obj='Write
pag=15
prev=O4848
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'_connes
]
wr_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'SESSO
'DATAVALI
'COGNOME
'NOME
'TIPINTER
'CFESTERO
'NASSTATO
'PEP
'TIPOPERS
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xCodCab
'Left(xRagSoc,70)
'Left(rowAgenzia.DOMICILIO,35)
'rowAgenzia.CODFISC
'cDNAS
'Left(cCNAS,30)
'iif(rowAgenzia.CFESTERO=0,'600','77'+xFLGSAE)
'''
'iif(rowAgenzia.CFESTERO=0,'600','711')
'rowAgenzia.TIPODOC
'Left(rowAgenzia.NUMDOCUM,15)
'_datemi
'rowAgenzia.AUTRILASC
'Left(rowAgenzia.DESCCIT,30)
'rowAgenzia.PROVINCIA
'rowAgenzia.PAESE
'rowAgenzia.CAP
'rowAgenzia.SESSO
'_datval
'rowAgenzia.COGNOME
'rowAgenzia.NOME
'cPNAS
'xCFE
'Left(cSNAS,30)
'iif(Empty(rowAgenzia.PEP),'N',rowAgenzia.PEP)
''P'
]
I
obj='Begin
pag=15
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4848
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(_gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=15
prev=O4884
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=cCli1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O4885
fatherSonIndex=0
obj='Insert
pag=15
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'datamodi
'PEP
]
rd_kvar=[
'cProgSto
'personbo->CONNES
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'Date()
'personbo->PEP
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=15
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=15
prev=O4817
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=cCli1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4818
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad(personbo->CODFISC,16)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->RAGSOC,70)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->DOMICILIO,35)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->DESCCIT,30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->PROVINCIA,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(LRTrim(personbo->CAP),5)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->PAESE,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->SOTGRUP,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->RAMOGRUP,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->SETTSINT,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(Left(personbo->NASCOMUN,30),30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->TIPINTER,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(Left(personbo->NASSTATO,30),30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + iif(DateToChar(personbo->DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATANASC),8),Space(8))
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->TIPODOC,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->NUMDOCUM,15)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + iif(DateToChar(personbo->DATARILASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATARILASC),8),Space(8))
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + iif(DateToChar(personbo->DATAVALI) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATAVALI),8),Space(8))
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->AUTRILASC,30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->PEP,1)
len=10
name='xRiga2
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4915
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4914
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4913
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4912
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4911
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4910
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4909
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4908
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4907
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4906
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4905
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4904
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4903
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4902
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4901
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4900
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4899
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4898
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4897
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=15
prev=O4815
I
obj='Begin
pag=15
prev=O4813
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4815
fatherSonIndex=0
frm_calc='rowAgenzia.DATANASC
len=8
name='_datnas
next=Icpitembatch.CPVarDecl
frm_calc='rowAgenzia.DATARILASC
len=8
name='_datemi
next=Icpitembatch.CPVarDecl
frm_calc='rowAgenzia.DATAVALI
len=8
name='_datval
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(rowAgenzia.COGNOME)+" "+ LRTrim(rowAgenzia.NOME)
len=70
name='xRagSoc
next=Icpitembatch.CPVarDecl
frm_calc='rowAgenzia.CODFISC
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='rowAgenzia.CODFISC
len=16
name='xCF
next=Icpitembatch.CPVarDecl
frm_calc='rowAgenzia.CFESTERO
len=1
name='xCFE
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCodCab))
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Se persona fisica ricava i dati di nascita
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.SpacePad(xCF,16)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad(xRagSoc,70)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad(rowAgenzia.DOMICILIO,35)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad(rowAgenzia.DESCCIT,30)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad(rowAgenzia.PROVINCIA,2)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad(LRTrim(rowAgenzia.CAP),5)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad(rowAgenzia.PAESE,3)
len=10
name='xRiga1
next=Icpitembatch.CPIfElse
frm_calc=[
'rowAgenzia.CFESTERO=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad(Left(cCNAS,30),30)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad(cPNAS,2)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad(Left(cSNAS,30),30)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + iif(DateToChar(_datnas) <> '01000101',LibreriaMit.SpacePad(DateToChar(_datnas),8),Space(8))
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 +LibreriaMit.SpacePad(rowAgenzia.TIPODOC,2)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 +LibreriaMit.SpacePad(rowAgenzia.NUMDOCUM,15)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + iif(DateToChar(_datemi) <> '01000101',LibreriaMit.SpacePad(DateToChar(_datemi),8),Space(8))
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + iif(DateToChar(_datval) <> '01000101',LibreriaMit.SpacePad(DateToChar(_datval),8),Space(8))
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 +LibreriaMit.SpacePad(rowAgenzia.AUTRILASC,30)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 +LibreriaMit.SpacePad(rowAgenzia.PEP,1)
len=10
name='xRiga1
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4950
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4949
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4948
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4947
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4946
var_op='asgn
I
obj='Var
obj_type='M
pag=15
prev=O4945
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4944
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4943
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4942
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4939
var_op='asgn
I
obj='If
pag=15
prev=O4938
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4939
fatherSonIndex=0
frm_calc='xRiga1 + LibreriaMit.SpacePad('600',3)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad('   ',3)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad('600',3)
len=10
name='xRiga1
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4955
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4954
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4939
fatherSonIndex=1
frm_calc='xRiga1 + LibreriaMit.SpacePad('77'+xFLGSAE,3)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad('   ',3)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1 + LibreriaMit.SpacePad('711',3)
len=10
name='xRiga1
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4959
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4958
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4937
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4936
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4935
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4934
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4933
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4932
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4930
var_op='asgn
I
obj='Begin
pag=15
prev=O4927
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Anno Di Nascita
father=O4930
fatherSonIndex=0
frm_calc='Substr(DateToChar(rowAgenzia.DATANASC),1,4)
len=2
name='xAnnNas
next=Icpitembatch.CPVarDecl
comment='Mese Di Nascita
frm_calc='Substr(DateToChar(rowAgenzia.DATANASC),5,2)
len=2
name='xMesNas
next=Icpitembatch.CPVarDecl
comment='Giorno Di Nascita
frm_calc='Substr(DateToChar(rowAgenzia.DATANASC),7,2)
len=2
name='xDayNas
next=Icpitembatch.CPVarDecl
frm_calc='_datnas
len=8
name='cDNAS
next=Icpitembatch.CPVarDecl
frm_calc='rowAgenzia.SESSO
len=1
name='xSesso
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(rowAgenzia.TIPINTER)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
prev=O4968
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4969
fatherSonIndex=0
frm_calc=[
'LRTrim(rowAgenzia.TIPINTER)='EE'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4974
fatherSonIndex=0
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cSNAS)
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='cPNAS
obj='Var
pag=15
pagelocal=True
prev=O4984
var_op='asgn
I
obj='Var
pag=15
pagelocal=True
prev=O4981
var_op='asgn
I
obj='If
pag=15
prev=O4980
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4981
fatherSonIndex=0
frm_calc='rowAgenzia.NASCOMUN
len=30
name='cSNAS
obj='Var
pag=15
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=15
prev=O4979
rd_field=[
'DESCRI
]
rd_kfield=[
'DESCRI
]
rd_kvar=[
'rowAgenzia.NASSTATO
]
rd_var=[
'cSNAS
]
I
obj='Var
pag=15
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4974
fatherSonIndex=1
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='cPNAS
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(cCNAS)
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
obj='Var
pag=15
pagelocal=True
prev=O4999
var_op='asgn
I
obj='If
pag=15
prev=O4997
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4999
fatherSonIndex=0
frm_calc='rowAgenzia.NASCOMUN
len=30
name='cCNAS
obj='Var
pag=15
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=15
prev=O4996
sel_field='*
sel_name='tbcitta
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4997
fatherSonIndex=0
frm_calc=[
'LRTrim(Left(tbcitta->CITTA,30))=Upper(LRTrim(rowAgenzia.NASCOMUN)) and tbcitta->PROV=rowAgenzia.TIPINTER
]
h=[
19
19
]
obj='If
pag=15
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5009
fatherSonIndex=0
frm_calc='tbcitta->CITTA
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc='tbcitta->PROV
len=2
name='cPNAS
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=15
prev=O5015
I
obj='Var
pag=15
prev=O5014
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=15
pagelocal=True
prev=O4995
var_op='asgn
I
obj='Var
pag=15
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4969
fatherSonIndex=1
frm_calc='rowAgenzia.NASSTATO
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='rowAgenzia.NASCOMUN
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='cPNAS
obj='Var
pag=15
pagelocal=True
prev=O5022
var_op='asgn
I
obj='Var
pag=15
pagelocal=True
prev=O5021
var_op='asgn
I
obj='Var
pag=15
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=15
pagelocal=True
prev=O4967
var_op='asgn
I
obj='Var
obj_type='D
pag=15
pagelocal=True
prev=O4966
var_op='asgn
I
obj='Var
pag=15
pagelocal=True
prev=O4965
var_op='asgn
I
obj='Var
pag=15
pagelocal=True
prev=O4964
var_op='asgn
I
obj='Var
pag=15
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=15
prev=O4926
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4927
fatherSonIndex=0
frm_calc='rowAgenzia.DESCCIT
len=30
name='xCitta
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=15
prev=O5028
sel_field='*
sel_name='tbcitta
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5029
fatherSonIndex=0
frm_calc=[
'LRTrim(Left(tbcitta->CITTA,30))=Upper(LRTrim(xCitta)) and tbcitta->PROV=rowAgenzia.PROVINCIA
]
h=[
19
19
]
obj='If
pag=15
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5033
fatherSonIndex=0
frm_calc='tbcitta->CAB
len=6
name='xCodCab
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=15
prev=O5038
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=15
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=15
pagelocal=True
prev=O4925
var_op='asgn
I
obj='Var
pag=15
pagelocal=True
prev=O4924
var_op='asgn
I
obj='Var
pag=15
pagelocal=True
prev=O4923
var_op='asgn
I
obj='Var
pag=15
pagelocal=True
prev=O4922
var_op='asgn
I
obj='Var
obj_type='D
pag=15
pagelocal=True
prev=O4921
var_op='asgn
I
obj='Var
obj_type='D
pag=15
pagelocal=True
prev=O4920
var_op='asgn
I
obj='Var
obj_type='D
pag=15
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=15
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Anno Di Nascita
father=O4813
fatherSonIndex=0
frm_calc='''
len=2
name='xAnnNas
next=Icpitembatch.CPVarDecl
comment='Mese Di Nascita
frm_calc='''
len=2
name='xMesNas
next=Icpitembatch.CPVarDecl
comment='Giorno Di Nascita
frm_calc='''
len=2
name='xDayNas
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='cDNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='xSesso
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='cPNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='xCodCab
obj='Var
pag=15
pagelocal=True
prev=O5053
var_op='asgn
I
obj='Var
pag=15
pagelocal=True
prev=O5052
var_op='asgn
I
obj='Var
pag=15
pagelocal=True
prev=O5051
var_op='asgn
I
obj='Var
pag=15
pagelocal=True
prev=O5050
var_op='asgn
I
obj='Var
pag=15
pagelocal=True
prev=O5049
var_op='asgn
I
obj='Var
obj_type='D
pag=15
pagelocal=True
prev=O5048
var_op='asgn
I
obj='Var
pag=15
pagelocal=True
prev=O5047
var_op='asgn
I
obj='Var
pag=15
pagelocal=True
prev=O5046
var_op='asgn
I
obj='Var
pag=15
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=15
prev=O4786
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O4787
fatherSonIndex=0
obj='Read
pag=15
rd_field=[
'CONNES
'CODFISC
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'rowAgenzia.CONNESCLI
]
rd_var=[
'_connes
'_codfisc
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4787
fatherSonIndex=1
frm_calc=[
'not(Empty(LRTrim(rowAgenzia.CODFISC)))
]
h=[
19
19
]
obj='If
pag=15
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O5065
fatherSonIndex=0
obj='Read
pag=15
rd_field=[
'CONNES
'CODFISC
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'rowAgenzia.CODFISC
]
rd_var=[
'_connes
'_codfisc
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=15
prev=O4785
rd_field=[
'FLGSAE
]
rd_kfield=[
'CODSTA
]
rd_kvar=[
'rowAgenzia.PAESE
]
rd_var=[
'xFLGSAE
]
I
obj='Var
pag=15
prev=O4784
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4783
var_op='asgn
I
obj='Var
obj_type='M
pag=15
pagelocal=True
prev=O4782
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
x=7
y=15
I
Icpitembatch.CPBeginEnd
comment='Definizione variabili locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Scrive i dati della transazione
h=[
19
19
]
obj='Begin
pag=16
prev=O5082
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5084
fatherSonIndex=0
frm_calc='dNumNew + 1
len=10
name='dNumNew
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_cabdip
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_provdip
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_cittadip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='_cauana
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_causin
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_segno
next=Icpitembatch.CPVarDecl
frm_calc='iif(At(LRTrim(rowAgenzia.MEZPAGAM), '|I|E|P')=0,'A',LRTrim(rowAgenzia.MEZPAGAM))
len=1
name='_mezpagam
next=Icpitembatch.CPRead
arch='cgo_causali
next=Icpitembatch.CPIfElse
frm_calc=[
'_cauana <> '26' and _cauana <> '48' and _cauana <> 'AA'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPBeginEnd
comment='Scrive operazione in provvisorio
h=[
19
19
]
obj='Begin
pag=16
prev=O5098
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5101
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PPOPER1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPInsert
arch='xperazbo
next=Icpitembatch.CPInsert
arch='xperazbo_agg
next=Icpitembatch.CPIfElse
frm_calc=[
'rowAgenzia.MEZPAGAM='I' or rowAgenzia.MEZPAGAM='E' or rowAgenzia.MEZPAGAM='P'
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('SAVE','XPERAZBO',"Sto elaborando l'operazione con codice:"+rowAgenzia.NUMOPE)
obj='Exec
pag=16
prev=O5111
I
obj='If
pag=16
prev=O5110
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5111
fatherSonIndex=0
frm_calc=[
'Left(Upper(rowAgenzia.IBAN),2)='IT'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=16
prev=O5117
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=_connes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O5120
fatherSonIndex=0
obj='Write
pag=16
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CONNESBEN
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'personbo->RAGSOC
'personbo->PAESE
'personbo->DESCCIT
'personbo->CODCAB
'personbo->PROVINCIA
'personbo->DOMICILIO
'personbo->CAP
'personbo->CONNES
]
I
I
]
w=[
150
150
]
I
obj='If
pag=16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5117
fatherSonIndex=0
frm_calc='Substr(rowAgenzia.IBAN,6,5)+"-"+Substr(rowAgenzia.IBAN,11,5)
len=11
name='abicab
next=Icpitembatch.CPWrite
arch='xperazbo
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=16
prev=O5135
sel_field='*
sel_name='inter2bo
sel_where='inter2bo->CODINTER=abicab
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O5136
fatherSonIndex=0
obj='Write
pag=16
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'inter2bo->TIPINTER
'abicab
'inter2bo->PAESE
'inter2bo->DESCCIT
'inter2bo->PROVINCIA
'inter2bo->CODCAB
'inter2bo->RAGSOC
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=16
prev=O5134
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CODINT2
'TIPOINT2
]
wr_op=[
'=
'=
]
wr_var=[
'abicab
''02'
]
I
obj='Var
pag=16
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5117
fatherSonIndex=1
frm_calc='Left(Upper(rowAgenzia.IBAN),11)
len=11
name='abicab
next=Icpitembatch.CPWrite
arch='xperazbo
obj='Write
pag=16
prev=O5155
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CODINT2
'TIPOINT2
]
wr_op=[
'=
'=
]
wr_var=[
'abicab
''12'
]
I
obj='Var
pag=16
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=16
prev=O5109
rd_kfield=[
'IDBASE
'CODLOB
'TIPOGIOCO
'CACODICE
'IDBIGLIETTO
'CADATAORA
'IDDOCALL
'VPCODICE
'CATEG01
'CATEGORIA
]
rd_kvar=[
'cOpeProg1
'rowAgenzia.CODLOB
'rowAgenzia.TIPOGIOCO
'rowAgenzia.CACODICE
'rowAgenzia.CAIDBIGLIETTO
'rowAgenzia.CADATAORA
'rowAgenzia.IDDOCALL
'rowAgenzia.VLTPLAT
''FI'
''FI'
]
I
obj='Insert
pag=16
prev=O5108
rd_kfield=[
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPOPE
'PROVINCIA
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
'MTCN
'TIPOINTER
'IDBASE2
]
rd_kvar=[
'DateToChar(rowAgenzia.DATAOPE)
'DateToChar(rowAgenzia.DATAOPE)
'DateToChar(Date())
'_cauana
'_cabdip
'rowAgenzia.CODDIPE
'_codinter
'_causin
'_connes
'rowAgenzia.DATAOPE
'Date()
'_cittadip
'iif(rowAgenzia.TOTCONT>0,'1','0')
''0'
''3'
'cOpeProg1
''O'+Right(cOpeProg2,9)+_idb2
'cOpeProg2
''1'
'nProgImp
'_provdip
'rowAgenzia.CAIDBIGLIETTO
'_segno
''0'
''1'
'_tipope
'rowAgenzia.TOTCONT*100
'rowAgenzia.TOTLIRE*100
''242'
'rowAgenzia.CGOTIPOPE
'_tipinter
'_idb2
]
I
obj='Var
pag=16
prev=O5107
var_op='asgn
I
obj='Var
obj_type='N
pag=16
prev=O5106
var_op='asgn
I
obj='Var
pag=16
pagelocal=True
prev=O5105
var_op='asgn
I
obj='Var
pag=16
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=16
prev=O5097
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5098
fatherSonIndex=0
frm_calc=''10'
len=2
name='_tipope
obj='Var
pag=16
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5098
fatherSonIndex=1
frm_calc=[
'_segno = 'D'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5174
fatherSonIndex=0
frm_calc=''11'
len=2
name='_tipope
obj='Var
pag=16
pagelocal=True
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5174
fatherSonIndex=1
frm_calc=''12'
len=2
name='_tipope
obj='Var
pag=16
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=16
prev=O5096
rd_field=[
'CACODANA
'CACODSIN
'CASEGNO
'CAFLGAUI
'CAFLGOPE
]
rd_kfield=[
'CACODICE
'CATIPOPE
]
rd_kvar=[
'rowAgenzia.CACODICE
'_mezpagam
]
rd_var=[
'_cauana
'_causin
'_segno
'_flgaui
'_flgope
]
I
obj='Var
pag=16
prev=O5095
var_op='asgn
I
obj='Var
pag=16
pagelocal=True
prev=O5094
var_op='asgn
I
obj='Var
pag=16
pagelocal=True
prev=O5093
var_op='asgn
I
obj='Var
pag=16
pagelocal=True
prev=O5092
var_op='asgn
I
obj='Read
pag=16
prev=O5091
rd_field=[
'DESCCIT
'PROVINCIA
'CAB
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'rowAgenzia.CODDIPE
]
rd_var=[
'_cabdip
'_provdip
'_cabdip
]
I
obj='Var
pag=16
pagelocal=True
prev=O5090
var_op='asgn
I
obj='Var
pag=16
pagelocal=True
prev=O5089
var_op='asgn
I
obj='Var
pag=16
pagelocal=True
prev=O5088
var_op='asgn
I
obj='Var
obj_type='N
pag=16
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5082
fatherSonIndex=0
len=6
name='_cabdip
next=Icpitembatch.CPVarDecl
len=2
name='_provdip
next=Icpitembatch.CPVarDecl
len=30
name='_cittadip
obj='Var
pag=16
pagelocal=True
prev=O5196
I
obj='Var
pag=16
pagelocal=True
prev=O5195
I
obj='Var
pag=16
pagelocal=True
I
I
]
w=[
150
150
]
x=8
y=20
I
]
ManualBlocks={
'BO - Header
Icpmanualblocks.CPManualBlocks
code='import java.io.File;﷯import java.io.FileReader;﷯import java.io.FileWriter;
name='BO - Header
I
'BO - Properties
Icpmanualblocks.CPManualBlocks
code='public String[] lista;﷯public int conteggio;﷯public int i;﷯public int contanome;
name='BO - Properties
I
}
comment='Importa i dati da CGO (Scheduler)
date_creat=#2006-06-20
date_rev=#2020-08-16
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'FileLibMit
'Utilities
'LibreriaMit
]
merge=True
modcnt=937
page_result_class=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
page_result_type=[
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
]
page_uid=[
'JPHNMEUYHC
'EYHDKBFRDK
'OJCJCEAUZN
'SXGUFBXBOL
'CCEPDLCHTX
'WWKTNJTNKH
'WOZTKJMTDA
'KNDVGIIHLB
'PTMSTGFKEJ
'JKGMKFMPYY
'QRGTVPDRPN
'EEXJYFNKCH
'ZYZVRPXAEK
'NXRZEBJBUH
'GKIYXGLDMV
'MUQDLPMSJV
]
pagename=[
'Page_1
'Page_2
'Page_3
'Page_4
'Page_5
'Page_6
'Page_7
'Page_8
'Page_9
'Page_10
'Page_11
'Page_12
'Page_13
'Page_14
'Page_15
'Page_16
]
pagenote=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
pagetitle=[
'Main
'Dipendenze
'Soggetti
'Rapporti
'Operazioni / Frazionate
'Utenti
'Controllo Soggetti
'Scrittura Operazioni (Std)
'Scrive i dati per AAMS
'Scrittura Operazioni (Stor)
'Scrive dati aggiuntivi operazioni
'Scrive Dati Operazioni
'Scrive Dati Frazionate
'TRX Agenzie
'Scrive Soggetto Agenzie
'Scrive TRX Agenzie
]
public=True
runtime_filters=2
tpl_name='Routine
work_file=[
'anadip
'anarapbo
'cgo_aams_base
'cgo_anadip
'cgo_anadip_err
'cgo_causali
'cgo_operazioni
'cgo_operazioni_dl
'cgo_operazioni_dl_multi
'cgo_operazioni_dl_multi_dt
'cgo_operazioni_storico_multi
'cgo_rapporti
'cgo_rapporti_err
'cgo_soggetti
'cgo_soggetti_err
'cgo_tbtipgio
'cgo_telematico
'cgo_telematico_err
'cgo_totope
'cgo_users
'clientifrz
'clientiope
'cpazi
'cpusers
'cpusers_add
'cpusrgrp
'fraziobo
'fraziobo_agg
'inter2bo
'intermbo
'intestbo
'knarapbo
'log_app
'operazbo
'operazbo_agg
'personbo
'rapopebo
'slientifrz
'sogopebo
'sogopefbo
'sraziobo
'sraziobo_agg
'tbcauana
'tbcitta
'tbstati
'tbtipdoc
'tbvalute
'wersonbo
'xapopebo
'xlientifrz
'xlientiope
'xnarapbo
'xntestbo
'xperazbo
'xperazbo_agg
'xraziobo
'xraziobo_agg
'cgo_import_age
'cgo_errori_age
'personbo_agg
'tbstatna
'tbcittna
]
work_filter=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
I
*--*
*----*
