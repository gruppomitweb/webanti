* --- CodePainter Revolution Batch Vers. 5.1
￼Icpbatch.CPBatch
Items=[
Icpitembatch.CPBeginEnd
comment='Variabili del caller
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili globali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili per la creazione dei file
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc=''Ora Inizio Elaborazione: '+ arfn_fdatetime(DateTime()) + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPBeginEnd
comment='Crea il file per l'elenco
h=[
19
19
]
next=Ispitembatch.CPClearCache
cache_name='chOpex
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Fine Elaborazione: '+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=1
prev=O16
var_op='asgn
I
obj='Try
pag=1
prev=O15
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O16
fatherSonIndex=0
frm_calc='0
len=9
name='_tipo1
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo2
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo3
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo4
next=Icpitembatch.CPVarDecl
frm_calc='Str(w_anno,4,0)
len=4
name='w_annoc
next=Icpitembatch.CPVarDecl
frm_calc='w_dadata
len=8
name='_dataini
next=Icpitembatch.CPVarDecl
frm_calc='w_a_data
len=8
name='_datafin
next=Icpitembatch.CPVarDecl
frm_calc='w_mese
len=2
name='_mese
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgnew='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgagg='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgdel='S'
]
h=[
19
19
]
next=Icpitembatch.CPTransaction
frm_calc='commit
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Premere il tasto con la lente per prelevare i file'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=1
prev=O38
var_op='asgn
I
obj='Transaction
pag=1
prev=O35
I
obj='If
pag=1
prev=O32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O35
fatherSonIndex=0
frm_calc='0
len=9
name='_tipo1
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo2
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo3
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo4
next=Icpitembatch.CPBeginEnd
comment='Azzera i cursori
h=[
19
19
]
next=Icpitembatch.CPExec
check='page
frm_calc='7
next=Icpitembatch.CPExec
check='page
frm_calc='6
obj='Exec
pag=1
prev=O48
I
obj='Exec
pag=1
prev=O46
I
obj='Begin
pag=1
prev=O45
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O46
fatherSonIndex=0
frm_seek='Zap
name='mcSID0
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID1
obj='Var
obj_type='MC
pag=1
prev=O52
var_op='meth
I
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O44
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O43
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O42
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O29
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O32
fatherSonIndex=0
frm_calc='0
len=9
name='_tipo1
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo2
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo3
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo4
next=Icpitembatch.CPBeginEnd
comment='Azzera i cursori
h=[
19
19
]
next=Icpitembatch.CPExec
check='page
frm_calc='7
next=Icpitembatch.CPExec
check='page
frm_calc='3
obj='Exec
pag=1
prev=O64
I
obj='Exec
pag=1
prev=O62
I
obj='Begin
pag=1
prev=O61
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O62
fatherSonIndex=0
frm_seek='Zap
name='mcSID0
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID1
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID2
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID3
obj='Var
obj_type='MC
pag=1
prev=O70
var_op='meth
I
obj='Var
obj_type='MC
pag=1
prev=O69
var_op='meth
I
obj='Var
obj_type='MC
pag=1
prev=O68
var_op='meth
I
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O60
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O59
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O58
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O28
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPBeginEnd
comment='Azzera i cursori
father=O29
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Inizio Elaborazione Nuovi Rapporti: '+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPExec
check='page
frm_calc='7
next=Icpitembatch.CPExec
check='page
frm_calc='2
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Fine Elaborazione Nuovi Rapporti: '+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo1
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo2
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo3
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo4
next=Icpitembatch.CPExec
check='page
frm_calc='7
next=Icpitembatch.CPExec
check='page
frm_calc='5
obj='Exec
pag=1
prev=O86
I
obj='Exec
pag=1
prev=O85
I
obj='Var
obj_type='N
pag=1
prev=O84
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O83
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O82
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O81
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
prev=O80
var_op='asgn
I
obj='Exec
pag=1
prev=O79
I
obj='Exec
pag=1
prev=O78
I
nonlocal=True
obj='Var
pag=1
prev=O76
var_op='asgn
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O76
fatherSonIndex=0
frm_seek='Zap
name='mcSID0
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID1
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID2
obj='Var
obj_type='MC
pag=1
prev=O91
var_op='meth
I
obj='Var
obj_type='MC
pag=1
prev=O90
var_op='meth
I
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O27
var_op='asgn
I
obj='Var
obj_type='D
pag=1
prev=O26
var_op='asgn
I
obj='Var
obj_type='D
pag=1
prev=O25
var_op='asgn
I
obj='Var
pag=1
prev=O24
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O23
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O22
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O21
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O16
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPTransaction
frm_calc='rollback
next=Icpitembatch.CPBeginEnd
comment='Cancella eventuali altri file creati
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Elaborazione Terminata con errori. Consultare l'assistenza"
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=1
prev=O99
var_op='asgn
I
obj='Begin
pag=1
prev=O98
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O99
fatherSonIndex=0
frm_calc='// Legge i file degli esiti﷯File di = new File(CPLib.LRTrim(gPathDoc)+"/SID/INVII/DAP/"+CPLib.LRTrim(gAzienda)+"/");﷯File fl[] = di.listFiles();﷯int _i;﷯int count=0;﷯for (_i=0; _i < fl.length; _i++)  {﷯  fl[_i].delete();﷯}﷯di = new File(CPLib.LRTrim(gPathDoc)+"/SID/INVII/PRE/"+CPLib.LRTrim(gAzienda)+"/");﷯File fl1[] = di.listFiles();﷯count=0;﷯for (_i=0; _i < fl1.length; _i++)  {﷯  fl1[_i].delete();﷯}
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Transaction
pag=1
prev=O96
I
obj='Select
pag=1
sel_name='tmp_listafile
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O96
fatherSonIndex=0
frm_calc='LRTrim(gPathDoc)+'/flussi/'+LRTrim(gAzienda)+"/"+LRTrim(tmp_listafile->nomefile)+".zip"
len=100
name='cNomeFile
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(cNomeFile)
obj='Exec
pag=1
prev=O108
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=1
prev=O14
I
obj='ClearCache
pag=1
prev=O12
type_action='CREATE
I
obj='Begin
pag=1
prev=O11
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDropTemporaryTable
father=O12
fatherSonIndex=0
next=Icpitembatch.CPDropTemporaryTable
next=Icpitembatch.CPServerTemporaryTable
next=Icpitembatch.CPServerTemporaryTable
obj='TempTable
pag=1
prev=O116
sel_type='def
server_table='tmp_list_imprich
I
obj='TempTable
pag=1
prev=O115
sel_type='def
server_table='tmp_listafile
I
obj='DropTempTable
pag=1
prev=O114
server_table='tmp_list_imprich
I
obj='DropTempTable
pag=1
server_table='tmp_listafile
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=1
prev=O9
var_op='asgn
I
obj='Begin
pag=1
prev=O7
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O9
fatherSonIndex=0
len=10
name='fhand
next=Icpitembatch.CPVarDecl
len=10
name='_nomefile
next=Icpitembatch.CPVarDecl
len=100
name='cNomeFile
next=Icpitembatch.CPVarDecl
len=2
name='_mese
next=Icpitembatch.CPVarDecl
len=398
name='_riga
next=Icpitembatch.CPVarDecl
len=9
name='_tipo1
next=Icpitembatch.CPVarDecl
len=9
name='_tipo2
next=Icpitembatch.CPVarDecl
len=9
name='_tipo3
next=Icpitembatch.CPVarDecl
len=9
name='_tipo4
next=Icpitembatch.CPVarDecl
len=100
name='_oldmsg
next=Icpitembatch.CPVarDecl
len=16
name='_cfinter
next=Icpitembatch.CPVarDecl
len=16
name='_intercod
next=Icpitembatch.CPVarDecl
len=5
name='_intercab
obj='Var
pag=1
prev=O132
I
obj='Var
pag=1
prev=O131
I
obj='Var
pag=1
prev=O130
I
obj='Var
pag=1
prev=O129
I
obj='Var
obj_type='N
pag=1
prev=O128
I
obj='Var
obj_type='N
pag=1
prev=O127
I
obj='Var
obj_type='N
pag=1
prev=O126
I
obj='Var
obj_type='N
pag=1
prev=O125
I
obj='Var
pag=1
prev=O124
I
obj='Var
pag=1
prev=O123
I
obj='Var
pag=1
prev=O122
I
obj='Var
pag=1
prev=O121
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7
fatherSonIndex=0
len=10
name='_conta
next=Icpitembatch.CPVarDecl
len=10
name='_errore
next=Icpitembatch.CPVarDecl
frm_seek='tmp_stpperiodo
name='mcTemp
next=Icpitembatch.CPVarDecl
frm_seek='tmp_stpperiodo
name='rowTemp
next=Icpitembatch.CPVarDecl
frm_seek='sid_invio
name='mcSID0
next=Icpitembatch.CPVarDecl
frm_seek='sid_invio
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_seek='sid_invio1
name='mcSID1
next=Icpitembatch.CPVarDecl
frm_seek='sid_invio1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_seek='sid_invio2
name='mcSID2
next=Icpitembatch.CPVarDecl
frm_seek='sid_invio2
name='rowSID2
next=Icpitembatch.CPVarDecl
frm_seek='sid_invio2
name='mcSID2r
next=Icpitembatch.CPVarDecl
frm_seek='sid_invio3
name='mcSID3
next=Icpitembatch.CPVarDecl
frm_seek='sid_invio3
name='rowSID3
next=Icpitembatch.CPVarDecl
frm_seek='sid_invio3
name='mcSID3r
next=Icpitembatch.CPVarDecl
frm_seek='sid_invio4
name='mcSID4
next=Icpitembatch.CPVarDecl
frm_seek='sid_invio4
name='rowSID4
next=Icpitembatch.CPVarDecl
len=1
name='_crea
next=Icpitembatch.CPVarDecl
len=8
name='_dataini
next=Icpitembatch.CPVarDecl
len=8
name='_datafin
next=Icpitembatch.CPVarDecl
len=8
name='_datamin
next=Icpitembatch.CPVarDecl
len=10
name='_invio
next=Icpitembatch.CPVarDecl
comment='Errori del sid
frm_seek='mcMessaggi.MCRDef
name='_sid
next=Icpitembatch.CPVarDecl
len=15
name='_max
next=Icpitembatch.CPVarDecl
len=15
name='_min
next=Icpitembatch.CPVarDecl
len=15
name='_tot
next=Icpitembatch.CPVarDecl
len=1
name='_mono
next=Icpitembatch.CPVarDecl
len=15
name='_contacicli
next=Icpitembatch.CPVarDecl
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
len=15
name='_top
next=Icpitembatch.CPVarDecl
len=15
name='_cicli
next=Icpitembatch.CPVarDecl
len=10
name='_totrecord
next=Icpitembatch.CPVarDecl
name='_reccount
next=Icpitembatch.CPVarDecl
len=50
name='_unique
next=Icpitembatch.CPVarDecl
len=1
name='_newuc
next=Icpitembatch.CPVarDecl
len=4
name='w_annoc
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
len=10
name='cProg
next=Icpitembatch.CPVarDecl
len=4
name='_asaldi
next=Icpitembatch.CPVarDecl
len=5
name='_cabinter
next=Icpitembatch.CPVarDecl
len=1
name='_tipinvio
next=Icpitembatch.CPVarDecl
name='chOpex
next=Icpitembatch.CPVarDecl
len=10
name='_contarighe
next=Icpitembatch.CPVarDecl
len=1
name='_numfile
next=Icpitembatch.CPVarDecl
len=10
name='_contarec
next=Icpitembatch.CPVarDecl
len=1
name='_tipinvioc
obj='Var
pag=1
prev=O180
I
obj='Var
obj_type='N
pag=1
prev=O179
I
obj='Var
obj_type='N
pag=1
prev=O178
I
obj='Var
obj_type='N
pag=1
prev=O177
I
obj='Var
pag=1
prev=O176
I
obj='Var
pag=1
prev=O175
I
obj='Var
pag=1
prev=O174
I
obj='Var
obj_type='N
pag=1
prev=O173
I
obj='Var
pag=1
prev=O172
I
obj='Var
obj_type='N
pag=1
prev=O171
I
obj='Var
pag=1
prev=O170
I
obj='Var
pag=1
prev=O169
I
obj='Var
pag=1
prev=O168
I
obj='Var
obj_type='N
pag=1
prev=O167
I
obj='Var
obj_type='N
pag=1
prev=O166
I
obj='Var
obj_type='N
pag=1
prev=O165
I
obj='Var
obj_type='N
pag=1
prev=O164
I
obj='Var
obj_type='N
pag=1
prev=O163
I
obj='Var
obj_type='N
pag=1
prev=O162
I
obj='Var
obj_type='N
pag=1
prev=O161
I
obj='Var
obj_type='N
pag=1
prev=O160
I
obj='Var
obj_type='N
pag=1
prev=O159
I
obj='Var
obj_type='N
pag=1
prev=O158
I
obj='Var
obj_type='MC
pag=1
prev=O157
I
obj='Var
pag=1
prev=O156
I
obj='Var
obj_type='D
pag=1
prev=O155
I
obj='Var
obj_type='D
pag=1
prev=O154
I
obj='Var
obj_type='D
pag=1
prev=O153
I
obj='Var
obj_type='N
pag=1
prev=O152
I
obj='Var
obj_type='R
pag=1
prev=O151
I
obj='Var
obj_type='MC
pag=1
prev=O150
I
obj='Var
obj_type='MC
pag=1
prev=O149
I
obj='Var
obj_type='R
pag=1
prev=O148
I
obj='Var
obj_type='MC
pag=1
prev=O147
I
obj='Var
obj_type='MC
pag=1
prev=O146
I
obj='Var
obj_type='R
pag=1
prev=O145
I
obj='Var
obj_type='MC
pag=1
prev=O144
I
obj='Var
obj_type='R
pag=1
prev=O143
I
obj='Var
obj_type='MC
pag=1
prev=O142
I
obj='Var
obj_type='R
pag=1
prev=O141
I
obj='Var
obj_type='MC
pag=1
prev=O140
I
obj='Var
obj_type='R
pag=1
prev=O139
I
obj='Var
obj_type='MC
pag=1
prev=O138
I
obj='Var
obj_type='M
pag=1
prev=O137
I
obj='Var
obj_type='N
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Azienda
father=O5
fatherSonIndex=0
global=True
len=10
name='gAzienda
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='Messaggio
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Intermediario
global=True
len=11
name='gIntemediario
next=Icpitembatch.CPVarDecl
comment='Path Applicazione
global=True
len=80
name='gPathApp
next=Icpitembatch.CPVarDecl
comment='Path Applicazione
global=True
len=80
name='gPathDoc
next=Icpitembatch.CPVarDecl
comment='Scadenza Invio Saldi
global=True
len=8
name='gScadSaldi
nonlocal=True
obj='Var
obj_type='D
pag=1
prev=O190
I
nonlocal=True
obj='Var
pag=1
prev=O189
I
nonlocal=True
obj='Var
pag=1
prev=O188
I
nonlocal=True
obj='Var
pag=1
prev=O187
I
nonlocal=True
obj='Var
pag=1
prev=O186
I
nonlocal=True
obj='Var
pag=1
prev=O185
I
nonlocal=True
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Anno RIferimento
father=O3
fatherSonIndex=0
len=4
name='w_anno
next=Icpitembatch.CPVarDecl
comment='Mese Riferimento
len=2
name='w_mese
next=Icpitembatch.CPVarDecl
comment='Data Inizio Periodo
len=8
name='w_dadata
next=Icpitembatch.CPVarDecl
comment='Data Fine Periodo
len=8
name='w_a_data
next=Icpitembatch.CPVarDecl
comment='Aggiornamenti/Rettifiche
len=1
name='w_flgagg
next=Icpitembatch.CPVarDecl
comment='Annullamento/Cancellazione
len=1
name='w_flgdel
next=Icpitembatch.CPVarDecl
comment='Nuovi Rapporti/Chiusure
len=1
name='w_flgnew
next=Icpitembatch.CPVarDecl
comment='Registrazione record per file stampa
len=1
name='w_flgstp
next=Icpitembatch.CPVarDecl
comment='Dettaglio su chiusure
len=1
name='w_flgdett
nonlocal=True
obj='Var
pag=1
prev=O202
I
nonlocal=True
obj='Var
pag=1
prev=O201
I
nonlocal=True
obj='Var
pag=1
prev=O200
I
nonlocal=True
obj='Var
pag=1
prev=O199
I
nonlocal=True
obj='Var
pag=1
prev=O198
I
nonlocal=True
obj='Var
obj_type='D
pag=1
prev=O197
I
nonlocal=True
obj='Var
obj_type='D
pag=1
prev=O196
I
nonlocal=True
obj='Var
pag=1
prev=O195
I
nonlocal=True
obj='Var
obj_type='N
pag=1
I
I
]
w=[
150
150
]
x=17
y=26
I
Icpitembatch.CPBeginEnd
comment='Legge i dati e effettua le verifiche
h=[
19
19
]
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O205
fatherSonIndex=0
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Inizio Elaborazione periodo '+w_annoc+"-"+_mese+" : "+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPBeginEnd
comment='Ordinario - Nuovi Rapporti (1-1)
h=[
19
19
]
obj='Begin
pag=2
prev=O210
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O211
fatherSonIndex=0
frm_calc='"Attendere. Estrazione dati per il periodo ..."
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_totrecord
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_totrecord > 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Fine Elaborazione periodo '+w_annoc+'-'+_mese+" : "+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=2
prev=O219
var_op='asgn
I
obj='If
pag=2
prev=O217
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Azzera i cursori
father=O219
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Apre il file di scrittura
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Crea Testata
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Rapporti Continuativi
h=[
19
19
]
next=Icpitembatch.CPExec
check='page
frm_calc='4
next=Icpitembatch.CPBeginEnd
comment='Crea Piede
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPInsert
arch='aesaldi
next=Icpitembatch.CPVarDecl
frm_calc='arfn_exec_sid(_nomefile,w_annoc)
name='_sid
next=Icpitembatch.CPIfElse
frm_calc=[
'_sid.RecCount() > 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Sono stati generati '+LRTrim(Str(_conta,10,0))+" record" +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Fine controllo periodo: '+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=2
prev=O242
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
prev=O239
var_op='asgn
I
obj='If
pag=2
prev=O238
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O239
fatherSonIndex=0
for_variable='rowErrore
for_variable_type='mcMessaggi.MCRDef
h=[
19
19
]
iterator_expr='_sid
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''Rilevati errori durante il controllo da parte del SID - Nuovi'
obj='Transaction
pag=2
prev=O246
raise_on_trans_err=True
I
obj='ForEach
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O246
fatherSonIndex=0
frm_calc='gMsgProc + LRTrim(rowErrore.testata) + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O239
fatherSonIndex=1
frm_calc=[
'w_flgstp='N'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Azzera se avevo scritto qualcosa
father=O254
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Inizio Aggiornamento Dati: '+arfn_fdatetime(DateTime())+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_oldmsg
next=Icpitembatch.CPForEach
for_variable='rowSID1
for_variable_type='sid_invio1
h=[
19
19
]
iterator_expr='mcSID1
next=Icpitembatch.CPForEach
for_variable='rowSID2
for_variable_type='sid_invio2
h=[
19
19
]
iterator_expr='mcSID2
next=Icpitembatch.CPIfElse
frm_calc=[
'_tipinvio='2'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + NL + 'Ora Fine Aggiornamento Dati: '+arfn_fdatetime(DateTime())+NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O268
var_op='asgn
I
obj='If
pag=2
prev=O266
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O268
fatherSonIndex=0
for_variable='rowSID3
for_variable_type='sid_invio3
h=[
19
19
]
iterator_expr='mcSID3
obj='ForEach
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sid_invio3
father=O274
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'CODINVIO3
'RAPINVIO3
'TPRINVIO3
'ANNINVIO3
'VALINVIO3
'IM1INVIO3
'FI1INVIO3
'IM2INVIO3
'FI2INVIO3
'IM3INVIO3
'FI3INVIO3
'IM4INVIO3
'FI4INVIO3
'IM5INVIO3
'FI5INVIO3
'IM6INVIO3
'FI6INVIO3
'UNIQUE3
'FLGUNQ3
]
rd_kvar=[
'rowSID3.CODINVIO3
'rowSID3.RAPINVIO3
'rowSID3.TPRINVIO3
'rowSID3.ANNINVIO3
'rowSID3.VALINVIO3
'rowSID3.IM1INVIO3
'rowSID3.FI1INVIO3
'rowSID3.IM2INVIO3
'rowSID3.FI2INVIO3
'rowSID3.IM3INVIO3
'rowSID3.FI3INVIO3
'rowSID3.IM4INVIO3
'rowSID3.FI4INVIO3
'rowSID3.IM5INVIO3
'rowSID3.FI5INVIO3
'rowSID3.IM6INVIO3
'rowSID3.FI6INVIO3
'rowSID3.UNIQUE3
'rowSID3.FLGUNQ3
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=2
prev=O264
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sid_invio2
father=O266
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'CODINVIO2
'RAPINVIO2
'APRINVIO2
'INIINVIO2
'FININVIO2
'FCFINVIO2
'CFSINVIO2
'RUOINVIO2
'COGINVIO2
'NOMINVIO2
'SEXINVIO2
'DNSINVIO2
'CNSINVIO2
'PNSINVIO2
'RGSINVIO2
'CSLINVIO2
'PLSINVIO2
]
rd_kvar=[
'rowSID2.CODINVIO2
'rowSID2.RAPINVIO2
'rowSID2.APRINVIO2
'rowSID2.INIINVIO2
'rowSID2.FININVIO2
'rowSID2.FCFINVIO2
'rowSID2.CFSINVIO2
'rowSID2.RUOINVIO2
'rowSID2.COGINVIO2
'rowSID2.NOMINVIO2
'rowSID2.SEXINVIO2
'rowSID2.DNSINVIO2
'rowSID2.CNSINVIO2
'rowSID2.PNSINVIO2
'rowSID2.RGSINVIO2
'rowSID2.CSLINVIO2
'rowSID2.PLSINVIO2
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=2
prev=O263
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O264
fatherSonIndex=0
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Sto aggiornando l'operazione " + LRTrim(Str(_conta,10,0)) + " su " + LRTrim(Str(_totrecord,10,0))
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_oldmsg)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='"Sto aggiornando l'operazione " + LRTrim(Str(_conta,10,0)) + " su " + LRTrim(Str(_totrecord,10,0))
len=10
name='_oldmsg
next=Icpitembatch.CPInsert
arch='sid_invio1
next=Icpitembatch.CPIfElse
frm_calc=[
'rowSID1.TPRINVIO1='98'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Ho aggiornato l'operazione " + LRTrim(Str(_conta,10,0)) + " su " + LRTrim(Str(_totrecord,10,0))
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_oldmsg)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gMsgImp)
len=10
name='_oldmsg
obj='Var
obj_type='M
pag=2
prev=O302
var_op='asgn
I
obj='If
pag=2
prev=O301
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O302
fatherSonIndex=0
frm_calc='gMsgProc + LRTrim(gMsgImp)
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O302
fatherSonIndex=1
frm_calc='Strtran(gMsgProc,LRTrim(_oldmsg),LRTrim(gMsgImp))
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
pag=2
prev=O298
var_op='asgn
I
obj='If
pag=2
prev=O297
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O298
fatherSonIndex=0
frm_calc='"Sto aggiornando l'operazione con codice: "+rowSID1.RAPINVIO1
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='opextrbo
obj='Write
pag=2
prev=O314
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'INVIATO
'DATAINVIO
'UNIQUER
]
wr_op=[
'=
'=
'=
]
wr_var=[
'1
'Date()
'rowSID1.UNIQUE1
]
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O298
fatherSonIndex=1
frm_calc='"Sto aggiornando il rapporto: "+rowSID1.RAPINVIO1
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='aetesta
next=Icpitembatch.CPIfElse
frm_calc=[
'_tipinvio='2' and not(Empty(rowSID1.FININVIO1))
]
h=[
19
19
]
obj='If
pag=2
prev=O324
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aetesta
father=O325
fatherSonIndex=0
obj='Write
pag=2
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'INVIATOC
'DATAINVIOC
]
wr_op=[
'=
'=
]
wr_var=[
'1
'Date()
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=2
prev=O323
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'INVIATO
'DATAINVIO
'UNIQUER
'UNIQUECODE
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'1
'Date()
'rowSID1.UNIQUE1
'rowSID1.UNIQUE1
]
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=2
prev=O296
rd_kfield=[
'CODINVIO1
'RAPINVIO1
'TPRINVIO1
'INIINVIO1
'FININVIO1
'TIPINVIO1
'TPCINVIO1
]
rd_kvar=[
'rowSID1.CODINVIO1
'rowSID1.RAPINVIO1
'rowSID1.TPRINVIO1
'rowSID1.INIINVIO1
'rowSID1.FININVIO1
'rowSID1.TIPINVIO1
'rowSID1.TPCINVIO1
]
I
obj='Var
obj_type='M
pag=2
prev=O293
var_op='asgn
I
obj='If
pag=2
prev=O292
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O293
fatherSonIndex=0
frm_calc='gMsgProc + LRTrim(gMsgImp)
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O293
fatherSonIndex=1
frm_calc='Strtran(gMsgProc,LRTrim(_oldmsg),LRTrim(gMsgImp))
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
pag=2
prev=O291
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
prev=O262
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O261
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O259
var_op='asgn
I
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O259
fatherSonIndex=0
frm_calc=[
'_tipinvio='2'
]
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='sid_invio2
next=Icpitembatch.CPDelete
arch='sid_invio1
obj='Delete
pag=2
prev=O359
rd_kfield=[
'CODINVIO1
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='Delete
pag=2
prev=O356
rd_kfield=[
'CODINVIO2
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='sid_invio3
father=O356
fatherSonIndex=0
obj='Delete
pag=2
rd_kfield=[
'CODINVIO3
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='MC
pag=2
prev=O237
var_op='asgn
I
obj='Insert
pag=2
prev=O236
rd_kfield=[
'IDBASE
'NOMEFILE
'ANNO
'MESE
'TIPOINVIO
'TIPOCOMU
'CODINVIO
]
rd_kvar=[
'LibreriaMit.UniqueId()
'Left(_nomefile,50)
'w_annoc
'_mese
''1'
''1'
'_invio
]
I
obj='Exec
pag=2
prev=O234
I
obj='Begin
pag=2
prev=O233
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPBeginEnd
comment='Scrive Ultima riga
father=O234
fatherSonIndex=0
h=[
19
19
]
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O381
fatherSonIndex=0
frm_calc=''9'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo1,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo2,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo3,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo4,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + Space(360)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=2
prev=O391
I
obj='Var
pag=2
prev=O390
var_op='asgn
I
obj='Var
pag=2
prev=O389
var_op='asgn
I
obj='Var
pag=2
prev=O388
var_op='asgn
I
obj='Var
pag=2
prev=O387
var_op='asgn
I
obj='Var
pag=2
prev=O386
var_op='asgn
I
obj='Var
pag=2
prev=O385
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=2
prev=O231
I
obj='Begin
pag=2
prev=O229
sons=[
Icpitembatch.CPItemSon
instr=Ispitembatch.CPMemoryCursor
data_source='tmp_stpperiodo
expected_rows=100000
father=O231
fatherSonIndex=0
mem_curs_name='mcTemp
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTemp.RecCount() > 0
]
h=[
19
19
]
obj='If
pag=2
prev=O397
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O398
fatherSonIndex=0
for_variable='rowTemp
for_variable_type='tmp_stpperiodo
h=[
19
19
]
iterator_expr='mcTemp
obj='ForEach
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Record Tipo 1
father=O403
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fam_mesefile02(rowSID1,_dataini,_datafin,rowTemp.TIPO)
name='mcSID2r
next=Icpitembatch.CPForEach
for_variable='rowSID2
for_variable_type='sid_invio2
h=[
19
19
]
iterator_expr='mcSID2r
next=Icpitembatch.CPIfElse
frm_calc=[
'_tipinvio='2'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGAGESID\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProg
next=Icpitembatch.CPInsert
arch='aefaminvio
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati generati '+LRTrim(Str(_conta,10,0))+" record"
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=2
prev=O417
var_op='asgn
I
obj='Insert
pag=2
prev=O416
rd_kfield=[
'IDBASE
'TIPO
'TIPOINVIO
'ANNO
'MESE
'TIPOCOM
'RAPPORTO
'NOMEFILE
'PROG
'IDIDBASE
]
rd_kvar=[
'cProg
'rowTemp.TIPO
''2'
'w_annoc
'_mese
''1'
'rowTemp.RAPPORTO
'_nomefile
'_conta
'_invio
]
I
obj='Var
pag=2
prev=O415
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O412
var_op='asgn
I
obj='If
pag=2
prev=O410
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O412
fatherSonIndex=0
frm_calc=[
'At(rowTemp.TIPOAG,"01;02;03;04;05;06;07;09;10;12;14;15;23;24;98") <> 0
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O423
fatherSonIndex=0
frm_calc='iif(DateDiff(gScadSaldi,Date()) < 90,Year(Date())-2,Year(Date())-1)
len=4
name='_asaldi
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fam_mesefile03(rowSID1,_asaldi,rowTemp.TIPO,rowTemp.VALUTA)
name='mcSID3r
next=Icpitembatch.CPForEach
for_variable='rowSID3
for_variable_type='sid_invio3
h=[
19
19
]
iterator_expr='mcSID3r
obj='ForEach
pag=2
prev=O429
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O430
fatherSonIndex=0
frm_calc='rowSID3
frm_seek='AppendRow
name='mcSID3
next=Icpitembatch.CPVarDecl
frm_calc='_tipo3 + 1
len=9
name='_tipo3
next=Icpitembatch.CPVarDecl
frm_calc=''3'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + rowTemp.TIPOAG
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.ANNINVIO3,4,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM1INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM1INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM1INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI1INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM2INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM2INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM2INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI2INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM3INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM3INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM3INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI3INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM4INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM4INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM4INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI4INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM5INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM5INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM5INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI5INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM6INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM6INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM6INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI6INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + rowTemp.VALUTA
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(229)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=2
prev=O454
I
obj='Var
pag=2
prev=O453
var_op='asgn
I
obj='Var
pag=2
prev=O452
var_op='asgn
I
obj='Var
pag=2
prev=O451
var_op='asgn
I
obj='Var
pag=2
prev=O450
var_op='asgn
I
obj='Var
pag=2
prev=O449
var_op='asgn
I
obj='Var
pag=2
prev=O448
var_op='asgn
I
obj='Var
pag=2
prev=O447
var_op='asgn
I
obj='Var
pag=2
prev=O446
var_op='asgn
I
obj='Var
pag=2
prev=O445
var_op='asgn
I
obj='Var
pag=2
prev=O444
var_op='asgn
I
obj='Var
pag=2
prev=O443
var_op='asgn
I
obj='Var
pag=2
prev=O442
var_op='asgn
I
obj='Var
pag=2
prev=O441
var_op='asgn
I
obj='Var
pag=2
prev=O440
var_op='asgn
I
obj='Var
pag=2
prev=O439
var_op='asgn
I
obj='Var
pag=2
prev=O438
var_op='asgn
I
obj='Var
pag=2
prev=O437
var_op='asgn
I
obj='Var
pag=2
prev=O436
var_op='asgn
I
obj='Var
pag=2
prev=O435
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O434
var_op='asgn
I
obj='Var
obj_type='MC
pag=2
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=2
prev=O428
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=2
prev=O409
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O410
fatherSonIndex=0
frm_calc=[
'w_flgstp='N'
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Scrive la riga
h=[
19
19
]
obj='Begin
pag=2
prev=O461
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O464
fatherSonIndex=0
frm_calc='_tipo2 + 1
len=9
name='_tipo2
next=Icpitembatch.CPVarDecl
frm_calc=''2'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(rowSID2.APRINVIO2,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + arfn_fdate_nd(rowSID2.INIINVIO2,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + arfn_fdate_nd(rowSID2.FININVIO2,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID2.FCFINVIO2,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(Upper(rowSID2.CFSINVIO2)),16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + rowSID2.RUOINVIO2
len=398
name='_riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(rowSID2.SEXINVIO2))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(99)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=2
prev=O481
I
obj='Var
pag=2
prev=O480
var_op='asgn
I
obj='Var
pag=2
prev=O477
var_op='asgn
I
obj='If
pag=2
prev=O476
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O477
fatherSonIndex=0
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(rowSID2.COGINVIO2,' '),26)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(rowSID2.NOMINVIO2,' '),25)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(rowSID2.SEXINVIO2,1)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +arfn_fdate_nd(rowSID2.DNSINVIO2,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(arfn_agechar(rowSID2.CNSINVIO2,' ')),40)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(rowSID2.PNSINVIO2,2)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(102)
len=398
name='_riga
obj='Var
pag=2
prev=O490
var_op='asgn
I
obj='Var
pag=2
prev=O489
var_op='asgn
I
obj='Var
pag=2
prev=O488
var_op='asgn
I
obj='Var
pag=2
prev=O487
var_op='asgn
I
obj='Var
pag=2
prev=O486
var_op='asgn
I
obj='Var
pag=2
prev=O485
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O477
fatherSonIndex=1
frm_calc='_riga +Space(102)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(arfn_agechar(rowSID2.RGSINVIO2,' ')),60)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(arfn_agechar(rowSID2.CSLINVIO2,' ')),40)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(rowSID2.PLSINVIO2),2)
len=398
name='_riga
obj='Var
pag=2
prev=O495
var_op='asgn
I
obj='Var
pag=2
prev=O494
var_op='asgn
I
obj='Var
pag=2
prev=O493
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O475
var_op='asgn
I
obj='Var
pag=2
prev=O474
var_op='asgn
I
obj='Var
pag=2
prev=O473
var_op='asgn
I
obj='Var
pag=2
prev=O472
var_op='asgn
I
obj='Var
pag=2
prev=O471
var_op='asgn
I
obj='Var
pag=2
prev=O470
var_op='asgn
I
obj='Var
pag=2
prev=O469
var_op='asgn
I
obj='Var
pag=2
prev=O468
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O461
fatherSonIndex=0
frm_calc='rowSID2
frm_seek='AppendRow
name='mcSID2
obj='Var
obj_type='MC
pag=2
var_op='meth
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=2
prev=O407
var_op='asgn
I
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Aggiorna codice Univoco
father=O407
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_invio
frm_seek='CODINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.RAPPORTO
frm_seek='RAPINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.TIPOAG
frm_seek='TPRINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAINI
frm_seek='INIINVIO1
name='rowSID1
next=Icpitembatch.CPIfElse
frm_calc=[
'_tipinvio='2'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_tipinvio
frm_seek='TIPINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc=''1'
frm_seek='TPCINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_unique
frm_seek='UNIQUE1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_newuc
frm_seek='FLGUNQ1
name='rowSID1
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgstp='N'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_tipo1 + 1
len=9
name='_tipo1
next=Icpitembatch.CPBeginEnd
comment='Scrive la riga
h=[
19
19
]
obj='Begin
pag=2
prev=O522
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O523
fatherSonIndex=0
frm_calc=''1'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowTemp.TIPOAG),2)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowTemp.TIPOAG='99',LibreriaMit.SpacePad(LRTrim(Upper(arfn_agechar(rowTemp.DESCRAP,' '))),24),Space(24))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + arfn_fdate_nd(rowTemp.DATAINI,'N')
len=398
name='_riga
next=Icpitembatch.CPIfElse
frm_calc=[
'_tipinvio='2'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'At(rowTemp.TIPOAG,"01;02;03;12;13") <> 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(_tipinvio='2' and not(Empty(rowTemp.IDESITO)), LibreriaMit.SpacePad(LRTrim(rowTemp.IDESITO),13),Space(13))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(286)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=2
prev=O540
I
obj='Var
pag=2
prev=O539
var_op='asgn
I
obj='Var
pag=2
prev=O538
var_op='asgn
I
obj='Var
pag=2
prev=O535
var_op='asgn
I
obj='If
pag=2
prev=O532
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O535
fatherSonIndex=0
frm_calc='_riga + iif(Empty(LRTrim(rowTemp.CAB)),LibreriaMit.SpacePad(LRTrim(_cabinter),5),LibreriaMit.SpacePad(LRTrim(rowTemp.CAB),5))
len=398
name='_riga
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O535
fatherSonIndex=1
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowTemp.CAB),5)
len=398
name='_riga
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=2
prev=O531
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O532
fatherSonIndex=0
frm_calc='_riga + iif(not(Empty(rowTemp.DATAFINE)),arfn_fdate_nd(rowTemp.DATAFINE,'N'),'01010001')
len=398
name='_riga
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O532
fatherSonIndex=1
frm_calc='_riga + iif(rowTemp.DATAFINE>= _dataini and rowTemp.DATAFINE<= _datafin,arfn_fdate_nd(rowTemp.DATAFINE,'N'),'01010001')
len=398
name='_riga
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O530
var_op='asgn
I
obj='Var
pag=2
prev=O529
var_op='asgn
I
obj='Var
pag=2
prev=O528
var_op='asgn
I
obj='Var
pag=2
prev=O527
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O519
var_op='asgn
I
obj='If
pag=2
prev=O518
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O519
fatherSonIndex=0
frm_calc='rowSID1
frm_seek='AppendRow
name='mcSID1
obj='Var
obj_type='MC
pag=2
var_op='meth
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aetesta
father=O519
fatherSonIndex=1
obj='Write
pag=2
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'UNIQUER
'UNIQUECODE
'INVIATO
'DATAINVIO
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'_unique
'_unique
'1
'Date()
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='R
pag=2
prev=O517
var_op='prop
I
obj='Var
obj_type='R
pag=2
prev=O516
var_op='prop
I
obj='Var
obj_type='R
pag=2
prev=O515
var_op='prop
I
obj='Var
obj_type='R
pag=2
prev=O512
var_op='prop
I
obj='If
pag=2
prev=O511
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O512
fatherSonIndex=0
frm_calc='iif(not(Empty(rowTemp.DATAFINE)),rowTemp.DATAFINE,NullDate())
frm_seek='FININVIO1
name='rowSID1
obj='Var
obj_type='R
pag=2
var_op='prop
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O512
fatherSonIndex=1
frm_calc='iif(rowTemp.DATAFINE>= _dataini and rowTemp.DATAFINE<= _datafin,rowTemp.DATAFINE,NullDate())
frm_seek='FININVIO1
name='rowSID1
obj='Var
obj_type='R
pag=2
var_op='prop
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='R
pag=2
prev=O510
var_op='prop
I
obj='Var
obj_type='R
pag=2
prev=O509
var_op='prop
I
obj='Var
obj_type='R
pag=2
prev=O508
var_op='prop
I
obj='Var
obj_type='R
pag=2
prev=O506
var_op='prop
I
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O506
fatherSonIndex=0
frm_calc='iif(not(Empty(rowTemp.UNIQUECODE)),rowTemp.UNIQUECODE,iif(Empty(rowTemp.OLDINTER),LRTrim(_cfinter),LRTrim(rowTemp.OLDINTER))+"_"+w_annoc+"_"+(LRTrim(rowTemp.RAPPORTO)))
len=50
name='_unique
next=Icpitembatch.CPVarDecl
frm_calc='arfn_agechar(_unique,"_")
len=50
name='_unique
next=Icpitembatch.CPVarDecl
frm_calc='Strtran(LRTrim(_unique)," ","_")
len=50
name='_unique
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(rowTemp.UNIQUECODE)),'N','S')
len=1
name='_newuc
obj='Var
pag=2
prev=O577
var_op='asgn
I
obj='Var
pag=2
prev=O576
var_op='asgn
I
obj='Var
pag=2
prev=O575
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='MemoryCursor
pag=2
par_expr=[
'_dataini
'_datafin
'0
]
par_name=[
'_dadata
'_adata
'_inviato
]
sel_name='qbe_fam_periodo01
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O227
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O229
fatherSonIndex=0
frm_calc='_invio
frm_seek='CODINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='_tipinvio
frm_seek='TIPINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc=''1'
frm_seek='TPCINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='w_annoc
frm_seek='ANNINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='_mese
frm_seek='MESINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='_nomefile
frm_seek='FLEINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='rowSID0
frm_seek='AppendRow
name='mcSID0
next=Icpitembatch.CPDelete
arch='sid_invio
next=Icpitembatch.CPInsert
arch='sid_invio
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_crea
next=Icpitembatch.CPBeginEnd
comment='Scrive testata
h=[
19
19
]
obj='Begin
pag=2
prev=O597
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O598
fatherSonIndex=0
frm_calc=''0'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'ARU00'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + _tipinvio
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '1'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + w_annoc
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + _mese
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(24)
len=398
name='_riga
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +'0'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + Space(112)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=2
prev=O614
I
obj='Var
pag=2
prev=O613
var_op='asgn
I
obj='Var
pag=2
prev=O612
var_op='asgn
I
obj='Var
pag=2
prev=O611
var_op='asgn
I
obj='Var
pag=2
prev=O609
var_op='asgn
I
obj='Select
pag=2
prev=O608
sel_field='*
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O609
fatherSonIndex=0
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(intermbo->CODFISC),16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(intermbo->CODFISC)
len=16
name='_cfinter
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(intermbo->CODCAB),5)
len=5
name='_cabinter
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(intermbo->CODFISC)) = 16
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O620
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O621
fatherSonIndex=0
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->COGNOME,26)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->NOME,25)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->SESSO,1)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +arfn_fdate_nd(intermbo->DATANASC,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->NASCOMUN,40)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->PROVNA,2)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(112)
len=10
name='_riga
obj='Var
obj_type='M
pag=2
prev=O631
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O630
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O629
var_op='asgn
I
obj='Var
pag=2
prev=O628
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O627
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O626
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O621
fatherSonIndex=1
frm_calc='_riga +Space(102)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(intermbo->RAGSOC,' '),70)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(intermbo->DESCCIT,' '),40)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->PROVINCIA,2)
len=10
name='_riga
obj='Var
obj_type='M
pag=2
prev=O636
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O635
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O634
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O619
var_op='asgn
I
obj='Var
pag=2
prev=O618
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O607
var_op='asgn
I
obj='Var
pag=2
prev=O606
var_op='asgn
I
obj='Var
pag=2
prev=O605
var_op='asgn
I
obj='Var
pag=2
prev=O604
var_op='asgn
I
obj='Var
pag=2
prev=O603
var_op='asgn
I
obj='Var
pag=2
prev=O602
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O596
var_op='asgn
I
obj='Insert
pag=2
prev=O595
rd_kfield=[
'CODINVIO
'TIPINVIO
'TPCINVIO
'DATINVIO
'ANNINVIO
'MESINVIO
'FLEINVIO
]
rd_kvar=[
'_invio
''1'
''1'
'Date()
'w_annoc
'w_mese
'_invio
]
I
obj='Delete
pag=2
prev=O594
rd_kfield=[
'CODINVIO
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='Var
obj_type='MC
pag=2
prev=O593
var_op='meth
I
obj='Var
obj_type='R
pag=2
prev=O592
var_op='prop
I
obj='Var
obj_type='R
pag=2
prev=O591
var_op='prop
I
obj='Var
obj_type='R
pag=2
prev=O590
var_op='prop
I
obj='Var
obj_type='R
pag=2
prev=O589
var_op='prop
I
obj='Var
obj_type='R
pag=2
prev=O588
var_op='prop
I
obj='Var
obj_type='R
pag=2
var_op='prop
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O225
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O227
fatherSonIndex=0
frm_calc=''1'
len=1
name='_tipinvio
next=Icpitembatch.CPIfElse
frm_calc=[
'Date() >  arfn_finemese(arfn_datesum(w_a_data,1))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='w_annoc+_mese+"_"+_tipinvio+"_1"
len=10
name='_invio
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gIntemediario)+"_"+_invio+"_"+DateTimeToChar(DateTime())
len=10
name='_nomefile
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWritePath(LRTrim(gPathDoc)+'/SID/INVII/DAP/'+LRTrim(gAzienda)+"/"+LRTrim(_nomefile))
len=10
name='fhand
next=Icpitembatch.CPInsert
arch='tmp_list_imprich
obj='Insert
pag=2
prev=O655
rd_kfield=[
'nomefile
]
rd_kvar=[
'_invio
]
I
obj='Var
pag=2
prev=O654
var_op='asgn
I
obj='Var
pag=2
prev=O653
var_op='asgn
I
obj='Var
pag=2
prev=O650
var_op='asgn
I
obj='If
pag=2
prev=O649
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O650
fatherSonIndex=0
frm_calc=''2'
len=1
name='_tipinvio
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O225
fatherSonIndex=0
frm_seek='Zap
name='mcSID0
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID1
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID2
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID2r
obj='Var
obj_type='MC
pag=2
prev=O668
var_op='meth
I
obj='Var
obj_type='MC
pag=2
prev=O667
var_op='meth
I
obj='Var
obj_type='MC
pag=2
prev=O666
var_op='meth
I
obj='Var
obj_type='MC
pag=2
var_op='meth
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O219
fatherSonIndex=1
frm_calc='gMsgProc + 'Non ci sono dati per il periodo considerato: '+arfn_fdate(_dataini)+" - " +arfn_fdate(_datafin)+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=2
par_expr=[
'_dataini
'_datafin
'0
]
par_name=[
'_dadata
'_adata
'_inviato
]
prev=O216
sel_name='qbe_fam_periodo01_minmax
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O217
fatherSonIndex=0
frm_calc='_totrecord + qbe_fam_periodo01_minmax->TOTPRG
len=10
name='_totrecord
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O215
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=2
prev=O209
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
x=9
y=22
I
Icpitembatch.CPBeginEnd
comment='Legge i dati e effettua le verifiche
h=[
19
19
]
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O682
fatherSonIndex=0
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Inizio Elaborazione Cancellazioni '+w_annoc+"-"+w_mese+" :"+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPBeginEnd
comment='Ordinario - Cancellazioni (2-4)
h=[
19
19
]
obj='Begin
pag=6
prev=O687
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O688
fatherSonIndex=0
frm_calc='"Attendere. Estrazione dati per il periodo ..."
global=True
len=120
name='gMsgImp
next=Ispitembatch.CPMemoryCursor
data_source='tmp_stpperiodo
mem_curs_name='mcTemp
next=Icpitembatch.CPVarDecl
frm_calc='mcTemp.RecCount()
len=10
name='_totrecord
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTemp.RecCount() > 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Fine Elaborazione Cancellazioni '+w_annoc+"-"+w_mese+" :"+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=6
prev=O695
var_op='asgn
I
obj='If
pag=6
prev=O694
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Azzera i cursori
father=O695
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Apre il file di scrittura
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Crea Testata
h=[
19
19
]
next=Icpitembatch.CPForEach
for_variable='rowTemp
for_variable_type='tmp_stpperiodo
h=[
19
19
]
iterator_expr='mcTemp
next=Icpitembatch.CPBeginEnd
comment='Crea Piede
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPInsert
arch='aesaldi
next=Icpitembatch.CPVarDecl
frm_calc='arfn_exec_sid(_nomefile,w_annoc)
name='_sid
next=Icpitembatch.CPIfElse
frm_calc=[
'_sid.RecCount() > 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Sono stati generati '+LRTrim(Str(_conta,10,0))+" record" +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Fine controllo periodo: '+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=6
prev=O717
var_op='asgn
I
nonlocal=True
obj='Var
pag=6
prev=O714
var_op='asgn
I
obj='If
pag=6
prev=O713
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O714
fatherSonIndex=0
for_variable='rowErrore
for_variable_type='mcMessaggi.MCRDef
h=[
19
19
]
iterator_expr='_sid
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''Rilevati errori durante il controllo da parte del SID - Cancellazioni'
obj='Transaction
pag=6
prev=O721
raise_on_trans_err=True
I
obj='ForEach
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O721
fatherSonIndex=0
frm_calc='gMsgProc + LRTrim(rowErrore.testata) + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Azzera se avevo scritto qualcosa
father=O714
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Inizio Aggiornamento Dati: '+arfn_fdatetime(DateTime())+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_oldmsg
next=Icpitembatch.CPForEach
for_variable='rowSID1
for_variable_type='sid_invio1
h=[
19
19
]
iterator_expr='mcSID1
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + NL + 'Ora Fine Aggiornamento Dati: '+arfn_fdatetime(DateTime())+NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O734
var_op='asgn
I
obj='ForEach
pag=6
prev=O733
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O734
fatherSonIndex=0
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Sto aggiornando l'operazione " + LRTrim(Str(_conta,10,0)) + " su " + LRTrim(Str(_totrecord,10,0))
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_oldmsg)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='"Sto aggiornando l'operazione " + LRTrim(Str(_conta,10,0)) + " su " + LRTrim(Str(_totrecord,10,0))
len=10
name='_oldmsg
next=Icpitembatch.CPInsert
arch='sid_invio1
next=Icpitembatch.CPIfElse
frm_calc=[
'rowSID1.TPRINVIO1='98'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Ho aggiornato l'operazione " + LRTrim(Str(_conta,10,0)) + " su " + LRTrim(Str(_totrecord,10,0))
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_oldmsg)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gMsgImp)
len=10
name='_oldmsg
obj='Var
obj_type='M
pag=6
prev=O750
var_op='asgn
I
obj='If
pag=6
prev=O749
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O750
fatherSonIndex=0
frm_calc='gMsgProc + LRTrim(gMsgImp)
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O750
fatherSonIndex=1
frm_calc='Strtran(gMsgProc,LRTrim(_oldmsg),LRTrim(gMsgImp))
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
pag=6
prev=O746
var_op='asgn
I
obj='If
pag=6
prev=O745
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O746
fatherSonIndex=0
frm_calc='"Sto aggiornando l'operazione con codice: "+rowSID1.RAPINVIO1
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='opextrbo
obj='Write
pag=6
prev=O762
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'ANNULLA
]
wr_op=[
'=
]
wr_var=[
'1
]
I
nonlocal=True
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O746
fatherSonIndex=1
frm_calc='"Sto aggiornando il rapporto: "+rowSID1.RAPINVIO1
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='aetesta
obj='Write
pag=6
prev=O771
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'ANNULLA
]
wr_op=[
'=
]
wr_var=[
'1
]
I
nonlocal=True
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=6
prev=O744
rd_kfield=[
'CODINVIO1
'RAPINVIO1
'TPRINVIO1
'INIINVIO1
'FININVIO1
'TIPINVIO1
'TPCINVIO1
'MODINVIO1
]
rd_kvar=[
'rowSID1.CODINVIO1
'rowSID1.RAPINVIO1
'rowSID1.TPRINVIO1
'rowSID1.INIINVIO1
'rowSID1.FININVIO1
'rowSID1.TIPINVIO1
'rowSID1.TPCINVIO1
'rowSID1.MODINVIO1
]
I
obj='Var
obj_type='M
pag=6
prev=O741
var_op='asgn
I
obj='If
pag=6
prev=O740
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O741
fatherSonIndex=0
frm_calc='gMsgProc + LRTrim(gMsgImp)
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O741
fatherSonIndex=1
frm_calc='Strtran(gMsgProc,LRTrim(_oldmsg),LRTrim(gMsgImp))
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
pag=6
prev=O739
var_op='asgn
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=6
prev=O732
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O731
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O729
var_op='asgn
I
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='sid_invio1
father=O729
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='sid_invio
obj='Delete
pag=6
prev=O791
rd_kfield=[
'CODINVIO
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='Delete
pag=6
rd_kfield=[
'CODINVIO1
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='MC
pag=6
prev=O712
var_op='asgn
I
obj='Insert
pag=6
prev=O711
rd_kfield=[
'IDBASE
'NOMEFILE
'ANNO
'MESE
'TIPOINVIO
'TIPOCOMU
'CODINVIO
]
rd_kvar=[
'LibreriaMit.UniqueId()
'Left(_nomefile,50)
'w_annoc
'_mese
''2'
''4'
'_invio
]
I
obj='Exec
pag=6
prev=O709
I
obj='Begin
pag=6
prev=O707
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Scrive Ultima riga
father=O709
fatherSonIndex=0
h=[
19
19
]
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O805
fatherSonIndex=0
frm_calc=''9'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo1,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo2,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo3,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo4,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + Space(360)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=6
prev=O815
I
obj='Var
pag=6
prev=O814
var_op='asgn
I
obj='Var
pag=6
prev=O813
var_op='asgn
I
obj='Var
pag=6
prev=O812
var_op='asgn
I
obj='Var
pag=6
prev=O811
var_op='asgn
I
obj='Var
pag=6
prev=O810
var_op='asgn
I
obj='Var
pag=6
prev=O809
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=6
prev=O705
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Record Tipo 1
father=O707
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGAGESID\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProg
next=Icpitembatch.CPInsert
arch='aefaminvio
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati generati '+LRTrim(Str(_conta,10,0))+" record"
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=6
prev=O825
var_op='asgn
I
obj='Insert
pag=6
prev=O824
rd_kfield=[
'IDBASE
'TIPO
'TIPOINVIO
'ANNO
'MESE
'TIPOCOM
'RAPPORTO
'NOMEFILE
'PROG
'IDIDBASE
]
rd_kvar=[
'cProg
'rowTemp.TIPO
''2'
'w_annoc
'_mese
''4'
'rowTemp.RAPPORTO
'_nomefile
'_conta
'_invio
]
I
obj='Var
pag=6
prev=O823
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O821
var_op='asgn
I
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Aggiorna codice Univoco
father=O821
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_invio
frm_seek='CODINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.RAPPORTO
frm_seek='RAPINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.TIPOAG
frm_seek='TPRINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAINI
frm_seek='INIINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAFINE
frm_seek='FININVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc=''2'
frm_seek='TIPINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc=''4'
frm_seek='TPCINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_unique
frm_seek='UNIQUE1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_newuc
frm_seek='FLGUNQ1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAMODI
frm_seek='MODINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowSID1
frm_seek='AppendRow
name='mcSID1
next=Icpitembatch.CPVarDecl
frm_calc='_tipo1 + 1
len=9
name='_tipo1
next=Icpitembatch.CPBeginEnd
comment='Scrive la riga
h=[
19
19
]
obj='Begin
pag=6
prev=O844
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O845
fatherSonIndex=0
frm_calc=''1'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowTemp.TIPOAG),2)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowTemp.TIPOAG='99',LibreriaMit.SpacePad(LRTrim(Upper(arfn_agechar(rowTemp.DESCRAP,' '))),24),Space(24))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + arfn_fdate_nd(rowTemp.DATAINI,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowTemp.TIPOAG='98' or Empty(rowTemp.DATAFINE),'01010001',arfn_fdate_nd(rowTemp.DATAFINE,'N'))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowTemp.CAB),5)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(_tipinvio='2' and not(Empty(rowTemp.IDESITO)), LibreriaMit.SpacePad(LRTrim(rowTemp.IDESITO),13),Space(13))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(286)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=6
prev=O858
I
obj='Var
pag=6
prev=O857
var_op='asgn
I
obj='Var
pag=6
prev=O856
var_op='asgn
I
obj='Var
pag=6
prev=O855
var_op='asgn
I
obj='Var
pag=6
prev=O854
var_op='asgn
I
obj='Var
pag=6
prev=O853
var_op='asgn
I
obj='Var
pag=6
prev=O852
var_op='asgn
I
obj='Var
pag=6
prev=O851
var_op='asgn
I
obj='Var
pag=6
prev=O850
var_op='asgn
I
obj='Var
pag=6
prev=O849
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O843
var_op='asgn
I
obj='Var
obj_type='MC
pag=6
prev=O842
var_op='meth
I
obj='Var
obj_type='R
pag=6
prev=O841
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O840
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O839
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O838
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O837
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O836
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O835
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O834
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O833
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O831
var_op='prop
I
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O831
fatherSonIndex=0
frm_calc='arfn_agechar(LRTrim(rowTemp.UNIQUECODE),"_")
len=50
name='_unique
next=Icpitembatch.CPVarDecl
frm_calc=''N'
len=1
name='_newuc
obj='Var
pag=6
prev=O863
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
prev=O703
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O705
fatherSonIndex=0
frm_calc='_invio
frm_seek='CODINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc=''2'
frm_seek='TIPINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc=''4'
frm_seek='TPCINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='w_annoc
frm_seek='ANNINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='_mese
frm_seek='MESINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='_nomefile
frm_seek='FLEINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='rowSID0
frm_seek='AppendRow
name='mcSID0
next=Icpitembatch.CPDelete
arch='sid_invio
next=Icpitembatch.CPInsert
arch='sid_invio
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_crea
next=Icpitembatch.CPBeginEnd
comment='Scrive testata
h=[
19
19
]
obj='Begin
pag=6
prev=O879
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O880
fatherSonIndex=0
frm_calc=''0'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'ARU00'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '2'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '4'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '0000'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '00'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(24)
len=398
name='_riga
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +'0'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + Space(112)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=6
prev=O896
I
obj='Var
pag=6
prev=O895
var_op='asgn
I
obj='Var
pag=6
prev=O894
var_op='asgn
I
obj='Var
pag=6
prev=O893
var_op='asgn
I
obj='Var
pag=6
prev=O891
var_op='asgn
I
obj='Select
pag=6
prev=O890
sel_field='*
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O891
fatherSonIndex=0
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(intermbo->CODFISC),16)
len=398
name='_riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(intermbo->CODFISC)) = 16
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
prev=O900
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O901
fatherSonIndex=0
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->COGNOME,26)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->NOME,25)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->SESSO,1)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +arfn_fdate_nd(intermbo->DATANASC,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->NASCOMUN,40)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->PROVNA,2)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(112)
len=10
name='_riga
obj='Var
obj_type='M
pag=6
prev=O911
var_op='asgn
I
obj='Var
obj_type='M
pag=6
prev=O910
var_op='asgn
I
obj='Var
obj_type='M
pag=6
prev=O909
var_op='asgn
I
obj='Var
pag=6
prev=O908
var_op='asgn
I
obj='Var
obj_type='M
pag=6
prev=O907
var_op='asgn
I
obj='Var
obj_type='M
pag=6
prev=O906
var_op='asgn
I
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O901
fatherSonIndex=1
frm_calc='_riga +Space(102)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(intermbo->RAGSOC,' '),70)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(intermbo->DESCCIT,' '),40)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->PROVINCIA,2)
len=10
name='_riga
obj='Var
obj_type='M
pag=6
prev=O916
var_op='asgn
I
obj='Var
obj_type='M
pag=6
prev=O915
var_op='asgn
I
obj='Var
obj_type='M
pag=6
prev=O914
var_op='asgn
I
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O889
var_op='asgn
I
obj='Var
pag=6
prev=O888
var_op='asgn
I
obj='Var
pag=6
prev=O887
var_op='asgn
I
obj='Var
pag=6
prev=O886
var_op='asgn
I
obj='Var
pag=6
prev=O885
var_op='asgn
I
obj='Var
pag=6
prev=O884
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O878
var_op='asgn
I
obj='Insert
pag=6
prev=O877
rd_kfield=[
'CODINVIO
'TIPINVIO
'TPCINVIO
'DATINVIO
'ANNINVIO
'MESINVIO
'FLEINVIO
]
rd_kvar=[
'_invio
''2'
''4'
'Date()
''0000'
''00'
'_invio
]
I
obj='Delete
pag=6
prev=O876
rd_kfield=[
'CODINVIO
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='Var
obj_type='MC
pag=6
prev=O875
var_op='meth
I
obj='Var
obj_type='R
pag=6
prev=O874
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O873
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O872
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O871
var_op='prop
I
obj='Var
obj_type='R
pag=6
prev=O870
var_op='prop
I
obj='Var
obj_type='R
pag=6
var_op='prop
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
prev=O701
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O703
fatherSonIndex=0
frm_calc='w_annoc+w_mese+'_2_4'
len=10
name='_invio
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gIntemediario)+"_"+_invio+"_"+DateTimeToChar(DateTime())
len=10
name='_nomefile
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWritePath(LRTrim(gPathDoc)+'/SID/INVII/DAP/'+LRTrim(gAzienda)+"/"+LRTrim(_nomefile))
len=10
name='fhand
next=Icpitembatch.CPInsert
arch='tmp_list_imprich
obj='Insert
pag=6
prev=O931
rd_kfield=[
'nomefile
]
rd_kvar=[
'_invio
]
I
obj='Var
pag=6
prev=O930
var_op='asgn
I
obj='Var
pag=6
prev=O929
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O701
fatherSonIndex=0
frm_seek='Zap
name='mcSID0
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID1
obj='Var
obj_type='MC
pag=6
prev=O938
var_op='meth
I
obj='Var
obj_type='MC
pag=6
var_op='meth
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O695
fatherSonIndex=1
frm_calc='gMsgProc + 'Non ci sono cancellazioni per il periodo considerato: '+arfn_fdate(_dataini)+" - " +arfn_fdate(_datafin)+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O693
var_op='asgn
I
obj='MemoryCursor
pag=6
par_expr=[
'_dataini
'_datafin
]
par_name=[
'_dadata
'_adata
]
prev=O692
sel_name='qbe_fam_delete_rap
I
nonlocal=True
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=6
prev=O686
var_op='asgn
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
x=13
y=25
I
Icpitembatch.CPBeginEnd
comment='Cerca i limiti di selezione
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_tot > 0
]
h=[
19
19
]
obj='If
pag=4
prev=O948
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Azzera variabili
father=O950
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Calcola il numero dei cicli
h=[
19
19
]
next=Icpitembatch.CPWhile
frm_calc='_contacicli <= _cicli
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=4
prev=O959
var_op='asgn
I
obj='While
pag=4
prev=O957
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O959
fatherSonIndex=0
frm_calc=[
'_mono = 1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Lettura operazioni extraconto in corso ... Ciclo N. '+LRTrim(Str(_contacicli,10,0)) + " su " +LRTrim(Str(_cicli,10,0))
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_oldmsg)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc=''Periodo: '+w_annoc+'-'+_mese+' - Lettura operazioni extraconto in corso ... Ciclo N. '+LRTrim(Str(_contacicli,10,0)) + " su " +LRTrim(Str(_cicli,10,0))
len=100
name='_oldmsg
next=Icpitembatch.CPIfElse
frm_calc=[
'_top>=_min
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_contacicli+1
len=15
name='_contacicli
obj='Var
obj_type='N
pag=4
prev=O972
var_op='asgn
I
obj='If
pag=4
prev=O971
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Operazioni Extraconto
father=O972
fatherSonIndex=0
h=[
19
19
]
obj='Begin
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O978
fatherSonIndex=0
frm_calc=''Lettura operazioni extraconto in corso ...'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcTemp
next=Ispitembatch.CPMemoryCursor
cache_name='chOpex
data_source='tmp_stpperiodo
expected_rows=5000
mem_curs_name='mcTemp
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTemp.RecCount() > 0
]
h=[
19
19
]
obj='If
pag=4
prev=O984
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O985
fatherSonIndex=0
for_variable='rowTemp
for_variable_type='tmp_stpperiodo
h=[
19
19
]
iterator_expr='mcTemp
obj='ForEach
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Record Tipo 1
father=O990
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fam_mesefile02(rowSID1,_dataini,_datafin,rowTemp.TIPO)
name='mcSID2r
next=Icpitembatch.CPForEach
for_variable='rowSID2
for_variable_type='sid_invio2
h=[
19
19
]
iterator_expr='mcSID2r
next=Icpitembatch.CPIfElse
frm_calc=[
'_tipinvio='2'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGAGESID\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProg
next=Icpitembatch.CPInsert
arch='aefaminvio
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati generati '+LRTrim(Str(_conta,10,0))+" record su un totale di "+LRTrim(Str(_tot,10,0))
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=4
prev=O1004
var_op='asgn
I
obj='Insert
pag=4
prev=O1003
rd_kfield=[
'IDBASE
'TIPO
'TIPOINVIO
'ANNO
'MESE
'TIPOCOM
'RAPPORTO
'NOMEFILE
'PROG
'IDIDBASE
]
rd_kvar=[
'cProg
'rowTemp.TIPO
''1'
'w_annoc
'_mese
''1'
'rowTemp.RAPPORTO
'_nomefile
'_conta
'_invio
]
I
obj='Var
pag=4
prev=O1002
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O999
var_op='asgn
I
obj='If
pag=4
prev=O997
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O999
fatherSonIndex=0
frm_calc=[
'(Year(Date()) -Year(rowTemp.DATAINI)=1 and DateDiff(gScadSaldi,Date()) < 90) or (Year(Date()) -Year(rowTemp.DATAINI)=0)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fam_mesefile03(rowSID1,_asaldi,rowTemp.TIPO,rowTemp.VALUTA)
name='mcSID3r
next=Icpitembatch.CPForEach
for_variable='rowSID3
for_variable_type='sid_invio3
h=[
19
19
]
iterator_expr='mcSID3r
obj='ForEach
pag=4
prev=O1013
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1014
fatherSonIndex=0
frm_calc='rowSID3
frm_seek='AppendRow
name='mcSID3
next=Icpitembatch.CPVarDecl
frm_calc='_tipo3 + 1
len=9
name='_tipo3
next=Icpitembatch.CPVarDecl
frm_calc=''3'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + rowTemp.TIPOAG
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.ANNINVIO3,4,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM1INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM1INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM1INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI1INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM2INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM2INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM2INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI2INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM3INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM3INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM3INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI3INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM4INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM4INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM4INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI4INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM5INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM5INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM5INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI5INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM6INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM6INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM6INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI6INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + rowTemp.VALUTA
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(229)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=4
prev=O1038
I
obj='Var
pag=4
prev=O1037
var_op='asgn
I
obj='Var
pag=4
prev=O1036
var_op='asgn
I
obj='Var
pag=4
prev=O1035
var_op='asgn
I
obj='Var
pag=4
prev=O1034
var_op='asgn
I
obj='Var
pag=4
prev=O1033
var_op='asgn
I
obj='Var
pag=4
prev=O1032
var_op='asgn
I
obj='Var
pag=4
prev=O1031
var_op='asgn
I
obj='Var
pag=4
prev=O1030
var_op='asgn
I
obj='Var
pag=4
prev=O1029
var_op='asgn
I
obj='Var
pag=4
prev=O1028
var_op='asgn
I
obj='Var
pag=4
prev=O1027
var_op='asgn
I
obj='Var
pag=4
prev=O1026
var_op='asgn
I
obj='Var
pag=4
prev=O1025
var_op='asgn
I
obj='Var
pag=4
prev=O1024
var_op='asgn
I
obj='Var
pag=4
prev=O1023
var_op='asgn
I
obj='Var
pag=4
prev=O1022
var_op='asgn
I
obj='Var
pag=4
prev=O1021
var_op='asgn
I
obj='Var
pag=4
prev=O1020
var_op='asgn
I
obj='Var
pag=4
prev=O1019
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1018
var_op='asgn
I
obj='Var
obj_type='MC
pag=4
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=4
prev=O1010
var_op='asgn
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1010
fatherSonIndex=0
frm_calc='0
len=4
name='_asaldi
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1010
fatherSonIndex=1
frm_calc='Year(rowTemp.DATAINI)
len=4
name='_asaldi
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=4
prev=O996
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O997
fatherSonIndex=0
frm_calc=[
'w_flgstp='N'
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Scrive la riga
h=[
19
19
]
obj='Begin
pag=4
prev=O1050
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1053
fatherSonIndex=0
frm_calc='_tipo2 + 1
len=9
name='_tipo2
next=Icpitembatch.CPVarDecl
frm_calc=''2'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(rowSID2.APRINVIO2,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + arfn_fdate_nd(rowSID2.INIINVIO2,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '01010001'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID2.FCFINVIO2,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(Upper(rowSID2.CFSINVIO2)),16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + rowSID2.RUOINVIO2
len=398
name='_riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(rowSID2.SEXINVIO2))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(99)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=4
prev=O1070
I
obj='Var
pag=4
prev=O1069
var_op='asgn
I
obj='Var
pag=4
prev=O1066
var_op='asgn
I
obj='If
pag=4
prev=O1065
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O1066
fatherSonIndex=0
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(rowSID2.COGINVIO2,' '),26)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(rowSID2.NOMINVIO2,' '),25)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(rowSID2.SEXINVIO2,1)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +arfn_fdate_nd(rowSID2.DNSINVIO2,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(arfn_agechar(rowSID2.CNSINVIO2,' ')),40)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(rowSID2.PNSINVIO2,2)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(102)
len=398
name='_riga
obj='Var
pag=4
prev=O1079
var_op='asgn
I
obj='Var
pag=4
prev=O1078
var_op='asgn
I
obj='Var
pag=4
prev=O1077
var_op='asgn
I
obj='Var
pag=4
prev=O1076
var_op='asgn
I
obj='Var
pag=4
prev=O1075
var_op='asgn
I
obj='Var
pag=4
prev=O1074
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O1066
fatherSonIndex=1
frm_calc='_riga +Space(102)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(arfn_agechar(rowSID2.RGSINVIO2,' ')),60)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(arfn_agechar(rowSID2.CSLINVIO2,' ')),40)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(rowSID2.PLSINVIO2),2)
len=398
name='_riga
obj='Var
pag=4
prev=O1084
var_op='asgn
I
obj='Var
pag=4
prev=O1083
var_op='asgn
I
obj='Var
pag=4
prev=O1082
var_op='asgn
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=4
prev=O1064
var_op='asgn
I
obj='Var
pag=4
prev=O1063
var_op='asgn
I
obj='Var
pag=4
prev=O1062
var_op='asgn
I
obj='Var
pag=4
prev=O1061
var_op='asgn
I
obj='Var
pag=4
prev=O1060
var_op='asgn
I
obj='Var
pag=4
prev=O1059
var_op='asgn
I
obj='Var
pag=4
prev=O1058
var_op='asgn
I
obj='Var
pag=4
prev=O1057
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1050
fatherSonIndex=0
frm_calc='rowSID2
frm_seek='AppendRow
name='mcSID2
obj='Var
obj_type='MC
pag=4
var_op='meth
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=4
prev=O994
var_op='asgn
I
obj='Begin
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Aggiorna codice Univoco
father=O994
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_invio
frm_seek='CODINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.RAPPORTO
frm_seek='RAPINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.TIPOAG
frm_seek='TPRINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAINI
frm_seek='INIINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAFINE
frm_seek='FININVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_tipinvio
frm_seek='TIPINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc=''1'
frm_seek='TPCINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_unique
frm_seek='UNIQUE1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_newuc
frm_seek='FLGUNQ1
name='rowSID1
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgstp='S'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_tipo1 + 1
len=9
name='_tipo1
next=Icpitembatch.CPBeginEnd
comment='Scrive la riga
h=[
19
19
]
obj='Begin
pag=4
prev=O1109
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1110
fatherSonIndex=0
frm_calc=''1'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowTemp.TIPOAG),2)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowTemp.TIPOAG='99',LibreriaMit.SpacePad(LRTrim(Upper(arfn_agechar(rowTemp.DESCRAP,' '))),24),Space(24))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + arfn_fdate_nd(rowTemp.DATAINI,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '01010001'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowTemp.CAB),5)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(_tipinvio='2' and not(Empty(rowTemp.IDESITO)), LibreriaMit.SpacePad(LRTrim(rowTemp.IDESITO),13),Space(13))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(286)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=4
prev=O1123
I
obj='Var
pag=4
prev=O1122
var_op='asgn
I
obj='Var
pag=4
prev=O1121
var_op='asgn
I
obj='Var
pag=4
prev=O1120
var_op='asgn
I
obj='Var
pag=4
prev=O1119
var_op='asgn
I
obj='Var
pag=4
prev=O1118
var_op='asgn
I
obj='Var
pag=4
prev=O1117
var_op='asgn
I
obj='Var
pag=4
prev=O1116
var_op='asgn
I
obj='Var
pag=4
prev=O1115
var_op='asgn
I
obj='Var
pag=4
prev=O1114
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O1106
var_op='asgn
I
obj='If
pag=4
prev=O1105
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O1106
fatherSonIndex=0
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'INVIATO
'DATAINVIO
'UNIQUER
]
wr_op=[
'=
'=
'=
]
wr_var=[
'1
'Date()
'_unique
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1106
fatherSonIndex=1
frm_calc='rowSID1
frm_seek='AppendRow
name='mcSID1
obj='Var
obj_type='MC
pag=4
var_op='meth
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='R
pag=4
prev=O1104
var_op='prop
I
obj='Var
obj_type='R
pag=4
prev=O1103
var_op='prop
I
obj='Var
obj_type='R
pag=4
prev=O1102
var_op='prop
I
obj='Var
obj_type='R
pag=4
prev=O1101
var_op='prop
I
obj='Var
obj_type='R
pag=4
prev=O1100
var_op='prop
I
obj='Var
obj_type='R
pag=4
prev=O1099
var_op='prop
I
obj='Var
obj_type='R
pag=4
prev=O1098
var_op='prop
I
obj='Var
obj_type='R
pag=4
prev=O1097
var_op='prop
I
obj='Var
obj_type='R
pag=4
prev=O1095
var_op='prop
I
obj='Begin
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1095
fatherSonIndex=0
frm_calc='iif(not(Empty(rowTemp.UNIQUECODE)),rowTemp.UNIQUECODE,iif(Empty(rowTemp.OLDINTER),LRTrim(_cfinter),LRTrim(rowTemp.OLDINTER))+"_"+LRTrim(rowTemp.RAPPORTO))
len=50
name='_unique
next=Icpitembatch.CPVarDecl
frm_calc='arfn_agechar(_unique,"_")
len=50
name='_unique
next=Icpitembatch.CPVarDecl
frm_calc='Strtran(LRTrim(_unique)," ","_")
len=50
name='_unique
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(rowTemp.UNIQUECODE)),'N','S')
len=1
name='_newuc
obj='Var
pag=4
prev=O1142
var_op='asgn
I
obj='Var
pag=4
prev=O1141
var_op='asgn
I
obj='Var
pag=4
prev=O1140
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='MemoryCursor
pag=4
par_expr=[
'_dataini
'_datafin
'0
'_bottom
'_top
]
par_name=[
'_dadata
'_adata
'_inviato
'_bottom
'_top
]
prev=O983
sel_name='qbe_famperiodo_opx01
I
obj='Var
obj_type='MC
pag=4
prev=O982
var_op='meth
I
nonlocal=True
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O972
fatherSonIndex=1
frm_calc=''Lettura operazioni extraconto in corso ...'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=4
prev=O968
var_op='asgn
I
obj='If
pag=4
prev=O967
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O968
fatherSonIndex=0
frm_calc='gMsgProc + 'Periodo: '+w_annoc+'-'+_mese+' - Lettura operazioni extraconto in corso ... Ciclo N. '+LRTrim(Str(_contacicli,10,0)) + " su " +LRTrim(Str(_cicli,10,0))
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O968
fatherSonIndex=1
frm_calc='Strtran(gMsgProc,_oldmsg,'Periodo: '+w_annoc+'-'+_mese+" - " + LRTrim(gMsgImp))
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
pag=4
prev=O964
var_op='asgn
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O964
fatherSonIndex=0
frm_calc='_min
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_max
len=15
name='_top
obj='Var
obj_type='N
pag=4
prev=O1162
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O964
fatherSonIndex=1
frm_calc=[
'_contacicli=1
'_contacicli = _cicli
]
h=[
19
19
19
19
]
haselse=True
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1165
fatherSonIndex=0
frm_calc='_min
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_min + 999
len=15
name='_top
obj='Var
obj_type='N
pag=4
prev=O1170
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1165
fatherSonIndex=1
frm_calc='_top + 1
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_max
len=15
name='_top
obj='Var
obj_type='N
pag=4
prev=O1173
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1165
fatherSonIndex=2
frm_calc='_top + 1
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_bottom + 999
len=15
name='_top
obj='Var
obj_type='N
pag=4
prev=O1176
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=4
prev=O955
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O957
fatherSonIndex=0
frm_calc='iif(_tot > 5000,0,1)
len=1
name='_mono
next=Icpitembatch.CPIfElse
frm_calc=[
'_mono = 1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='1
len=15
name='_contacicli
obj='Var
obj_type='N
pag=4
prev=O1184
var_op='asgn
I
obj='If
pag=4
prev=O1183
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1184
fatherSonIndex=0
frm_calc=[
'_tot = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1190
fatherSonIndex=0
frm_calc='0
len=15
name='_cicli
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1190
fatherSonIndex=1
frm_calc='1
len=15
name='_cicli
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1184
fatherSonIndex=1
frm_calc='_max - _min
name='_reccount
next=Icpitembatch.CPVarDecl
frm_calc='iif(Mod(_reccount,1000) <> 0,Int(_reccount/1000) + 1,Int(_reccount/1000))
len=15
name='_cicli
obj='Var
obj_type='N
pag=4
prev=O1200
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O955
fatherSonIndex=0
frm_calc='0
len=1
name='_mono
next=Icpitembatch.CPVarDecl
frm_calc='''
len=100
name='_oldmsg
obj='Var
pag=4
prev=O1206
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=4
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O948
fatherSonIndex=0
frm_calc='0
len=15
name='_max
next=Icpitembatch.CPVarDecl
frm_calc='0
len=15
name='_min
next=Icpitembatch.CPVarDecl
frm_calc='0
len=15
name='_tot
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=4
par_expr=[
'_dataini
'_datafin
'0
]
par_name=[
'_dadata
'_adata
'_inviato
]
prev=O1214
sel_name='qbe_famperiodo_opx_min_max
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1215
fatherSonIndex=0
frm_calc='qbe_famperiodo_opx_min_max->MINPRG
len=15
name='_min
next=Icpitembatch.CPVarDecl
frm_calc='qbe_famperiodo_opx_min_max->MAXPRG
len=15
name='_max
next=Icpitembatch.CPVarDecl
frm_calc='qbe_famperiodo_opx_min_max->TOTPRG
len=15
name='_tot
obj='Var
obj_type='N
pag=4
prev=O1222
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1221
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O1213
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1212
var_op='asgn
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
x=14
y=18
I
Icpitembatch.CPBeginEnd
comment='Legge i dati e effettua le chiusure
h=[
19
19
]
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1226
fatherSonIndex=0
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Inizio Elaborazione Chiusure '+w_annoc+"-"+w_mese+" :"+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPBeginEnd
comment='Ordinario - Chiusure
h=[
19
19
]
obj='Begin
pag=5
prev=O1231
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1232
fatherSonIndex=0
frm_calc='CharToDate(Left(DateToChar(Date()),6)+"01")
len=8
name='_datamin
next=Icpitembatch.CPVarDecl
frm_calc='iif(DateDiff(_datafin,_datamin) > 1,'S','O')
len=1
name='_tipinvioc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Attendere. Estrazione dati per il periodo ..."
global=True
len=120
name='gMsgImp
next=Ispitembatch.CPMemoryCursor
data_source='tmp_stpperiodo
mem_curs_name='mcTemp
next=Icpitembatch.CPVarDecl
frm_calc='mcTemp.RecCount()
len=10
name='_totrecord
next=Icpitembatch.CPIfElse
frm_calc=[
'mcTemp.RecCount() > 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Fine Elaborazione Chiusure '+w_annoc+"-"+w_mese+" :"+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=5
prev=O1241
var_op='asgn
I
obj='If
pag=5
prev=O1240
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1241
fatherSonIndex=0
frm_calc=[
'_tipinvioc='O'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Sono stati generati '+LRTrim(Str(_conta,10,0))+" record" +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Fine controllo periodo: '+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=5
prev=O1250
var_op='asgn
I
nonlocal=True
obj='Var
pag=5
prev=O1247
var_op='asgn
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Azzera i cursori
father=O1247
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Apre il file di scrittura
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Crea Testata
h=[
19
19
]
next=Icpitembatch.CPForEach
for_variable='rowTemp
for_variable_type='tmp_stpperiodo
h=[
19
19
]
iterator_expr='mcTemp
next=Icpitembatch.CPBeginEnd
comment='Crea Piede
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPInsert
arch='aesaldi
next=Icpitembatch.CPVarDecl
frm_calc='arfn_exec_sid(_nomefile,w_annoc)
name='_sid
next=Icpitembatch.CPIfElse
frm_calc=[
'_sid.RecCount() > 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1266
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O1267
fatherSonIndex=0
for_variable='rowErrore
for_variable_type='mcMessaggi.MCRDef
h=[
19
19
]
iterator_expr='_sid
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''Rilevati errori durante il controllo da parte del SID - Chiusure'
obj='Transaction
pag=5
prev=O1272
raise_on_trans_err=True
I
obj='ForEach
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O1272
fatherSonIndex=0
frm_calc='gMsgProc + LRTrim(rowErrore.testata) + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPBeginEnd
comment='Azzera se avevo scritto qualcosa
father=O1267
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Inizio Aggiornamento Dati: '+arfn_fdatetime(DateTime())+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_oldmsg
next=Icpitembatch.CPForEach
for_variable='rowSID1
for_variable_type='sid_invio1
h=[
19
19
]
iterator_expr='mcSID1
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgdett='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + NL + 'Ora Fine Aggiornamento Dati: '+arfn_fdatetime(DateTime())+NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1287
var_op='asgn
I
obj='If
pag=5
prev=O1285
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O1287
fatherSonIndex=0
for_variable='rowSID2
for_variable_type='sid_invio2
h=[
19
19
]
iterator_expr='mcSID2
obj='ForEach
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sid_invio2
father=O1293
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'CODINVIO2
'RAPINVIO2
'APRINVIO2
'INIINVIO2
'FININVIO2
'FCFINVIO2
'CFSINVIO2
'RUOINVIO2
'COGINVIO2
'NOMINVIO2
'DNSINVIO2
'CNSINVIO2
'PNSINVIO2
'RGSINVIO2
'CSLINVIO2
'PLSINVIO2
'SEXINVIO2
]
rd_kvar=[
'rowSID2.CODINVIO2
'rowSID2.RAPINVIO2
'rowSID2.APRINVIO2
'rowSID2.INIINVIO2
'rowSID2.FININVIO2
'rowSID2.FCFINVIO2
'rowSID2.CFSINVIO2
'rowSID2.RUOINVIO2
'rowSID2.COGINVIO2
'rowSID2.NOMINVIO2
'rowSID2.DNSINVIO2
'rowSID2.CNSINVIO2
'rowSID2.PNSINVIO2
'rowSID2.RGSINVIO2
'rowSID2.CSLINVIO2
'rowSID2.PLSINVIO2
'rowSID2.SEXINVIO2
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=5
prev=O1284
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1285
fatherSonIndex=0
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Sto aggiornando l'operazione " + LRTrim(Str(_conta,10,0)) + " su " + LRTrim(Str(_totrecord,10,0))
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_oldmsg)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='"Sto aggiornando l'operazione " + LRTrim(Str(_conta,10,0)) + " su " + LRTrim(Str(_totrecord,10,0))
len=10
name='_oldmsg
next=Icpitembatch.CPInsert
arch='sid_invio1
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Sto aggiornando il rapporto: "+rowSID1.RAPINVIO1
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='aetesta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"Ho aggiornato l'operazione " + LRTrim(Str(_conta,10,0)) + " su " + LRTrim(Str(_totrecord,10,0))
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_oldmsg)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gMsgImp)
len=10
name='_oldmsg
obj='Var
obj_type='M
pag=5
prev=O1314
var_op='asgn
I
obj='If
pag=5
prev=O1313
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O1314
fatherSonIndex=0
frm_calc='gMsgProc + LRTrim(gMsgImp)
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O1314
fatherSonIndex=1
frm_calc='Strtran(gMsgProc,LRTrim(_oldmsg),LRTrim(gMsgImp))
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
pag=5
prev=O1312
var_op='asgn
I
obj='Write
pag=5
prev=O1311
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'DATAINVIOC
'INVIATOC
]
wr_op=[
'=
'=
]
wr_var=[
'Date()
'1
]
I
nonlocal=True
obj='Var
pag=5
prev=O1310
var_op='asgn
I
obj='Insert
pag=5
prev=O1309
rd_kfield=[
'CODINVIO1
'RAPINVIO1
'TPRINVIO1
'INIINVIO1
'FININVIO1
'TIPINVIO1
'TPCINVIO1
]
rd_kvar=[
'rowSID1.CODINVIO1
'rowSID1.RAPINVIO1
'rowSID1.TPRINVIO1
'rowSID1.INIINVIO1
'rowSID1.FININVIO1
'rowSID1.TIPINVIO1
'rowSID1.TPCINVIO1
]
I
obj='Var
obj_type='M
pag=5
prev=O1306
var_op='asgn
I
obj='If
pag=5
prev=O1305
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O1306
fatherSonIndex=0
frm_calc='gMsgProc + LRTrim(gMsgImp)
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O1306
fatherSonIndex=1
frm_calc='Strtran(gMsgProc,LRTrim(_oldmsg),LRTrim(gMsgImp))
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
pag=5
prev=O1304
var_op='asgn
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=5
prev=O1283
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1282
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1280
var_op='asgn
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='sid_invio1
father=O1280
fatherSonIndex=0
obj='Delete
pag=5
rd_kfield=[
'CODINVIO1
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='MC
pag=5
prev=O1265
var_op='asgn
I
obj='Insert
pag=5
prev=O1264
rd_kfield=[
'IDBASE
'NOMEFILE
'ANNO
'MESE
'TIPOINVIO
'TIPOCOMU
'CODINVIO
]
rd_kvar=[
'LibreriaMit.UniqueId()
'Left(_nomefile,50)
'w_annoc
'_mese
''1'
''5'
'_invio
]
I
obj='Exec
pag=5
prev=O1262
I
obj='Begin
pag=5
prev=O1260
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPBeginEnd
comment='Scrive Ultima riga
father=O1262
fatherSonIndex=0
h=[
19
19
]
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1351
fatherSonIndex=0
frm_calc=''9'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo1,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo2,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo3,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo4,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + Space(360)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=5
prev=O1361
I
obj='Var
pag=5
prev=O1360
var_op='asgn
I
obj='Var
pag=5
prev=O1359
var_op='asgn
I
obj='Var
pag=5
prev=O1358
var_op='asgn
I
obj='Var
pag=5
prev=O1357
var_op='asgn
I
obj='Var
pag=5
prev=O1356
var_op='asgn
I
obj='Var
pag=5
prev=O1355
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=5
prev=O1258
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1260
fatherSonIndex=0
frm_calc=[
'not(Month(mcTemp.DATAINI) = Month(mcTemp.DATAFINE) and Year(mcTemp.DATAINI) = Year(mcTemp.DATAFINE))
]
h=[
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Record Tipo 1
father=O1367
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGAGESID\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProg
next=Icpitembatch.CPInsert
arch='aefaminvio
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati generati '+LRTrim(Str(_conta,10,0))+" record"
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=5
prev=O1376
var_op='asgn
I
obj='Insert
pag=5
prev=O1375
rd_kfield=[
'IDBASE
'TIPO
'TIPOINVIO
'ANNO
'MESE
'TIPOCOM
'RAPPORTO
'NOMEFILE
'PROG
'IDIDBASE
]
rd_kvar=[
'cProg
'rowTemp.TIPO
''1'
'w_annoc
'_mese
''5'
'rowTemp.RAPPORTO
'_nomefile
'_conta
'_invio
]
I
obj='Var
pag=5
prev=O1374
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1372
var_op='asgn
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Aggiorna codice Univoco
father=O1372
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_invio
frm_seek='CODINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.RAPPORTO
frm_seek='RAPINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.TIPOAG
frm_seek='TPRINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAINI
frm_seek='INIINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAFINE
frm_seek='FININVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc=''1'
frm_seek='TIPINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc=''5'
frm_seek='TPCINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_unique
frm_seek='UNIQUE1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_newuc
frm_seek='FLGUNQ1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowSID1
frm_seek='AppendRow
name='mcSID1
next=Icpitembatch.CPVarDecl
frm_calc='_tipo1 + 1
len=9
name='_tipo1
next=Icpitembatch.CPBeginEnd
comment='Scrive la riga
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgdett='S'
]
h=[
19
19
]
obj='If
pag=5
prev=O1395
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1397
fatherSonIndex=0
frm_calc='arfn_fam_mesefile02(rowSID1,_dataini,_datafin,rowTemp.TIPO)
name='mcSID2r
next=Icpitembatch.CPForEach
for_variable='rowSID2
for_variable_type='sid_invio2
h=[
19
19
]
iterator_expr='mcSID2r
obj='ForEach
pag=5
prev=O1402
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1403
fatherSonIndex=0
frm_calc='rowSID2
frm_seek='AppendRow
name='mcSID2
next=Icpitembatch.CPVarDecl
frm_calc='_tipo2 + 1
len=9
name='_tipo2
obj='Var
obj_type='N
pag=5
prev=O1407
var_op='asgn
I
obj='Var
obj_type='MC
pag=5
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
prev=O1394
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1395
fatherSonIndex=0
frm_calc=''1'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowTemp.TIPOAG),2)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowTemp.TIPOAG='99',LibreriaMit.SpacePad(LRTrim(Upper(arfn_agechar(rowTemp.DESCRAP,' '))),24),Space(24))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + arfn_fdate_nd(rowTemp.DATAINI,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowTemp.TIPOAG='98' or Empty(rowTemp.DATAFINE),'01010001',arfn_fdate_nd(rowTemp.DATAFINE,'N'))
len=398
name='_riga
next=Icpitembatch.CPIfElse
frm_calc=[
'At(rowTemp.TIPOAG,"01;02;03;12;13") <> 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(13)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(286)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=5
prev=O1424
I
obj='Var
pag=5
prev=O1423
var_op='asgn
I
obj='Var
pag=5
prev=O1422
var_op='asgn
I
obj='Var
pag=5
prev=O1419
var_op='asgn
I
obj='If
pag=5
prev=O1418
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1419
fatherSonIndex=0
frm_calc='_riga + iif(Empty(LRTrim(rowTemp.CAB)),LibreriaMit.SpacePad(LRTrim(_cabinter),5),LibreriaMit.SpacePad(LRTrim(rowTemp.CAB),5))
len=398
name='_riga
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1419
fatherSonIndex=1
frm_calc='_riga + Space(5)
len=398
name='_riga
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=5
prev=O1417
var_op='asgn
I
obj='Var
pag=5
prev=O1416
var_op='asgn
I
obj='Var
pag=5
prev=O1415
var_op='asgn
I
obj='Var
pag=5
prev=O1414
var_op='asgn
I
obj='Var
pag=5
prev=O1413
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1393
var_op='asgn
I
obj='Var
obj_type='MC
pag=5
prev=O1392
var_op='meth
I
obj='Var
obj_type='R
pag=5
prev=O1391
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1390
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1389
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1388
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1387
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1386
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1385
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1384
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1382
var_op='prop
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1382
fatherSonIndex=0
frm_calc='arfn_agechar(LRTrim(rowTemp.UNIQUECODE),"_")
len=50
name='_unique
next=Icpitembatch.CPVarDecl
frm_calc=''N'
len=1
name='_newuc
obj='Var
pag=5
prev=O1435
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
prev=O1256
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1258
fatherSonIndex=0
frm_calc='_invio
frm_seek='CODINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc=''1'
frm_seek='TIPINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc=''5'
frm_seek='TPCINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='w_annoc
frm_seek='ANNINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='w_mese
frm_seek='MESINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='_nomefile
frm_seek='FLEINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='rowSID0
frm_seek='AppendRow
name='mcSID0
next=Icpitembatch.CPDelete
arch='sid_invio
next=Icpitembatch.CPInsert
arch='sid_invio
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_crea
next=Icpitembatch.CPBeginEnd
comment='Scrive testata
h=[
19
19
]
obj='Begin
pag=5
prev=O1452
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1453
fatherSonIndex=0
frm_calc=''0'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'ARU00'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '1'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '5'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + w_annoc
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + w_mese
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(24)
len=398
name='_riga
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +'0'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + Space(112)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=5
prev=O1469
I
obj='Var
pag=5
prev=O1468
var_op='asgn
I
obj='Var
pag=5
prev=O1467
var_op='asgn
I
obj='Var
pag=5
prev=O1466
var_op='asgn
I
obj='Var
pag=5
prev=O1464
var_op='asgn
I
obj='Select
pag=5
prev=O1463
sel_field='*
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1464
fatherSonIndex=0
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(intermbo->CODFISC),16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(intermbo->CODCAB),5)
len=5
name='_cabinter
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(intermbo->CODFISC)) = 16
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1474
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O1475
fatherSonIndex=0
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->COGNOME,26)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->NOME,25)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->SESSO,1)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +arfn_fdate_nd(intermbo->DATANASC,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->NASCOMUN,40)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->PROVNA,2)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(112)
len=10
name='_riga
obj='Var
obj_type='M
pag=5
prev=O1485
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O1484
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O1483
var_op='asgn
I
obj='Var
pag=5
prev=O1482
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O1481
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O1480
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O1475
fatherSonIndex=1
frm_calc='_riga +Space(102)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(intermbo->RAGSOC,' '),70)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(intermbo->DESCCIT,' '),40)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->PROVINCIA,2)
len=10
name='_riga
obj='Var
obj_type='M
pag=5
prev=O1490
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O1489
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O1488
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=5
prev=O1473
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1462
var_op='asgn
I
obj='Var
pag=5
prev=O1461
var_op='asgn
I
obj='Var
pag=5
prev=O1460
var_op='asgn
I
obj='Var
pag=5
prev=O1459
var_op='asgn
I
obj='Var
pag=5
prev=O1458
var_op='asgn
I
obj='Var
pag=5
prev=O1457
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1451
var_op='asgn
I
obj='Insert
pag=5
prev=O1450
rd_kfield=[
'CODINVIO
'TIPINVIO
'TPCINVIO
'DATINVIO
'ANNINVIO
'MESINVIO
'FLEINVIO
]
rd_kvar=[
'_invio
''1'
''5'
'Date()
'w_annoc
'w_mese
'_invio
]
I
obj='Delete
pag=5
prev=O1449
rd_kfield=[
'CODINVIO
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='Var
obj_type='MC
pag=5
prev=O1448
var_op='meth
I
obj='Var
obj_type='R
pag=5
prev=O1447
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1446
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1445
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1444
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1443
var_op='prop
I
obj='Var
obj_type='R
pag=5
var_op='prop
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
prev=O1254
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1256
fatherSonIndex=0
frm_calc='w_annoc+w_mese+'_1_5'
len=10
name='_invio
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gIntemediario)+"_"+_invio+"_"+DateTimeToChar(DateTime())
len=10
name='_nomefile
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWritePath(LRTrim(gPathDoc)+'/SID/INVII/DAP/'+LRTrim(gAzienda)+"/"+LRTrim(_nomefile))
len=10
name='fhand
next=Icpitembatch.CPInsert
arch='tmp_list_imprich
obj='Insert
pag=5
prev=O1505
rd_kfield=[
'nomefile
]
rd_kvar=[
'_invio
]
I
obj='Var
pag=5
prev=O1504
var_op='asgn
I
obj='Var
pag=5
prev=O1503
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1254
fatherSonIndex=0
frm_seek='Zap
name='mcSID0
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID1
obj='Var
obj_type='MC
pag=5
prev=O1512
var_op='meth
I
obj='Var
obj_type='MC
pag=5
var_op='meth
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1247
fatherSonIndex=1
frm_calc='1
len=10
name='_contarighe
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_numfile
next=Icpitembatch.CPForEach
for_variable='rowTemp
for_variable_type='tmp_stpperiodo
h=[
19
19
]
iterator_expr='mcTemp
obj='ForEach
pag=5
prev=O1517
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1518
fatherSonIndex=0
frm_calc=[
'_contarighe=1
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Record Tipo 1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fam_mesefile02(rowSID1,_dataini,_datafin,rowTemp.TIPO)
name='mcSID2r
next=Icpitembatch.CPForEach
for_variable='rowSID2
for_variable_type='sid_invio2
h=[
19
19
]
iterator_expr='mcSID2r
next=Icpitembatch.CPIfElse
frm_calc=[
'At(rowTemp.TIPOAG,"01;02;03;04;05;06;07;09;10;12;14;15;23;24;98") <> 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGAGESID\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProg
next=Icpitembatch.CPInsert
arch='aefaminvio
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati generati '+LRTrim(Str(_conta,10,0))+" record"
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='_contarighe + 1
len=10
name='_contarighe
next=Icpitembatch.CPIfElse
frm_calc=[
'_contarighe=400000 or _conta=_totrecord
]
h=[
19
19
]
obj='If
pag=5
prev=O1537
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Crea Piede
father=O1538
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPInsert
arch='aesaldi
next=Icpitembatch.CPVarDecl
frm_calc='arfn_exec_sid(_nomefile,w_annoc)
name='_sid
next=Icpitembatch.CPIfElse
frm_calc=[
'_sid.RecCount() > 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='_contarighe
obj='Var
obj_type='N
pag=5
prev=O1548
var_op='asgn
I
obj='If
pag=5
prev=O1547
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O1548
fatherSonIndex=0
for_variable='rowErrore
for_variable_type='mcMessaggi.MCRDef
h=[
19
19
]
iterator_expr='_sid
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''Rilevati errori durante il controllo da parte del SID - Modifiche'
obj='Transaction
pag=5
prev=O1554
raise_on_trans_err=True
I
obj='ForEach
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O1554
fatherSonIndex=0
frm_calc='gMsgProc + LRTrim(rowErrore.testata) + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Azzera se avevo scritto qualcosa
father=O1548
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPForEach
for_variable='rowSID1
for_variable_type='sid_invio1
h=[
19
19
]
iterator_expr='mcSID1
next=Icpitembatch.CPForEach
for_variable='rowSID2
for_variable_type='sid_invio2
h=[
19
19
]
iterator_expr='mcSID2
next=Icpitembatch.CPForEach
for_variable='rowSID3
for_variable_type='sid_invio3
h=[
19
19
]
iterator_expr='mcSID3
obj='ForEach
pag=5
prev=O1566
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sid_invio3
father=O1568
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'CODINVIO3
'RAPINVIO3
'TPRINVIO3
'ANNINVIO3
'VALINVIO3
'IM1INVIO3
'FI1INVIO3
'IM2INVIO3
'FI2INVIO3
'IM3INVIO3
'FI3INVIO3
'IM4INVIO3
'FI4INVIO3
'IM5INVIO3
'FI5INVIO3
'IM6INVIO3
'FI6INVIO3
]
rd_kvar=[
'rowSID3.CODINVIO3
'rowSID3.RAPINVIO3
'rowSID3.TPRINVIO3
'rowSID3.ANNINVIO3
'rowSID3.VALINVIO3
'rowSID3.IM1INVIO3
'rowSID3.FI1INVIO3
'rowSID3.IM2INVIO3
'rowSID3.FI2INVIO3
'rowSID3.IM3INVIO3
'rowSID3.FI3INVIO3
'rowSID3.IM4INVIO3
'rowSID3.FI4INVIO3
'rowSID3.IM5INVIO3
'rowSID3.FI5INVIO3
'rowSID3.IM6INVIO3
'rowSID3.FI6INVIO3
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=5
prev=O1564
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sid_invio2
father=O1566
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'CODINVIO2
'RAPINVIO2
'APRINVIO2
'INIINVIO2
'FININVIO2
'FCFINVIO2
'CFSINVIO2
'RUOINVIO2
'COGINVIO2
'NOMINVIO2
'DNSINVIO2
'CNSINVIO2
'PNSINVIO2
'RGSINVIO2
'CSLINVIO2
'PLSINVIO2
'SEXINVIO2
]
rd_kvar=[
'rowSID2.CODINVIO2
'rowSID2.RAPINVIO2
'rowSID2.APRINVIO2
'rowSID2.INIINVIO2
'rowSID2.FININVIO2
'rowSID2.FCFINVIO2
'rowSID2.CFSINVIO2
'rowSID2.RUOINVIO2
'rowSID2.COGINVIO2
'rowSID2.NOMINVIO2
'rowSID2.DNSINVIO2
'rowSID2.CNSINVIO2
'rowSID2.PNSINVIO2
'rowSID2.RGSINVIO2
'rowSID2.CSLINVIO2
'rowSID2.PLSINVIO2
'rowSID2.SEXINVIO2
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=5
prev=O1562
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sid_invio1
father=O1564
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'rowSID1.TPRINVIO1='98'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1584
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O1585
fatherSonIndex=0
frm_calc='"Sto aggiornando l'operazione con codice: "+rowSID1.RAPINVIO1
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='opextrbo
obj='Write
pag=5
prev=O1590
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'DATAMODI
]
wr_op=[
'=
]
wr_var=[
'NullDate()
]
I
nonlocal=True
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O1585
fatherSonIndex=1
frm_calc='"Sto aggiornando il rapporto: "+rowSID1.RAPINVIO1
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='aetesta
obj='Write
pag=5
prev=O1599
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'DATAINVIOC
'INVIATOC
]
wr_op=[
'=
'=
]
wr_var=[
'Date()
'1
]
I
nonlocal=True
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=5
rd_kfield=[
'CODINVIO1
'RAPINVIO1
'TPRINVIO1
'INIINVIO1
'FININVIO1
'TIPINVIO1
'TPCINVIO1
'MODINVIO1
]
rd_kvar=[
'rowSID1.CODINVIO1
'rowSID1.RAPINVIO1
'rowSID1.TPRINVIO1
'rowSID1.INIINVIO1
'rowSID1.FININVIO1
'rowSID1.TIPINVIO1
'rowSID1.TPCINVIO1
'rowSID1.MODINVIO1
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='sid_invio3
father=O1562
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='sid_invio2
next=Icpitembatch.CPDelete
arch='sid_invio1
obj='Delete
pag=5
prev=O1614
rd_kfield=[
'CODINVIO1
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='Delete
pag=5
prev=O1613
rd_kfield=[
'CODINVIO2
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='Delete
pag=5
rd_kfield=[
'CODINVIO3
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='MC
pag=5
prev=O1546
var_op='asgn
I
obj='Insert
pag=5
prev=O1545
rd_kfield=[
'IDBASE
'NOMEFILE
'ANNO
'MESE
'TIPOINVIO
'TIPOCOMU
'CODINVIO
]
rd_kvar=[
'LibreriaMit.UniqueId()
'Left(_nomefile,50)
'w_annoc
'_mese
''2'
''2'
'_invio
]
I
obj='Exec
pag=5
prev=O1543
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Scrive Ultima riga
father=O1543
fatherSonIndex=0
h=[
19
19
]
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1631
fatherSonIndex=0
frm_calc=''9'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo1,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo2,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo3,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo4,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + Space(360)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=5
prev=O1641
I
obj='Var
pag=5
prev=O1640
var_op='asgn
I
obj='Var
pag=5
prev=O1639
var_op='asgn
I
obj='Var
pag=5
prev=O1638
var_op='asgn
I
obj='Var
pag=5
prev=O1637
var_op='asgn
I
obj='Var
pag=5
prev=O1636
var_op='asgn
I
obj='Var
pag=5
prev=O1635
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1536
var_op='asgn
I
nonlocal=True
obj='Var
pag=5
prev=O1535
var_op='asgn
I
obj='Insert
pag=5
prev=O1534
rd_kfield=[
'IDBASE
'TIPO
'TIPOINVIO
'ANNO
'MESE
'TIPOCOM
'RAPPORTO
'NOMEFILE
'PROG
'IDIDBASE
'OLDDATA
]
rd_kvar=[
'cProg
'rowTemp.TIPO
''2'
''0000'
''00'
''2'
'rowTemp.RAPPORTO
'_nomefile
'_conta
'_invio
'rowTemp.DATAMODI
]
I
obj='Var
pag=5
prev=O1533
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1530
var_op='asgn
I
obj='If
pag=5
prev=O1528
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1530
fatherSonIndex=0
frm_calc=[
'rowTemp.TIPOAG <> '98'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fam_mesefile03(rowSID1,_asaldi,rowTemp.TIPO,rowTemp.VALUTA)
name='mcSID3r
next=Icpitembatch.CPForEach
for_variable='rowSID3
for_variable_type='sid_invio3
h=[
19
19
]
iterator_expr='mcSID3r
obj='ForEach
pag=5
prev=O1653
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1654
fatherSonIndex=0
frm_calc='rowSID3
frm_seek='AppendRow
name='mcSID3
next=Icpitembatch.CPVarDecl
frm_calc='_tipo3 + 1
len=9
name='_tipo3
next=Icpitembatch.CPVarDecl
frm_calc=''3'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + rowTemp.TIPOAG
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.ANNINVIO3,4,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM1INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM1INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM1INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI1INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM2INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM2INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM2INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI2INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM3INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM3INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM3INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI3INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM4INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM4INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM4INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI4INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM5INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM5INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM5INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI5INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM6INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM6INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM6INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI6INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + rowTemp.VALUTA
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(229)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=5
prev=O1678
I
obj='Var
pag=5
prev=O1677
var_op='asgn
I
obj='Var
pag=5
prev=O1676
var_op='asgn
I
obj='Var
pag=5
prev=O1675
var_op='asgn
I
obj='Var
pag=5
prev=O1674
var_op='asgn
I
obj='Var
pag=5
prev=O1673
var_op='asgn
I
obj='Var
pag=5
prev=O1672
var_op='asgn
I
obj='Var
pag=5
prev=O1671
var_op='asgn
I
obj='Var
pag=5
prev=O1670
var_op='asgn
I
obj='Var
pag=5
prev=O1669
var_op='asgn
I
obj='Var
pag=5
prev=O1668
var_op='asgn
I
obj='Var
pag=5
prev=O1667
var_op='asgn
I
obj='Var
pag=5
prev=O1666
var_op='asgn
I
obj='Var
pag=5
prev=O1665
var_op='asgn
I
obj='Var
pag=5
prev=O1664
var_op='asgn
I
obj='Var
pag=5
prev=O1663
var_op='asgn
I
obj='Var
pag=5
prev=O1662
var_op='asgn
I
obj='Var
pag=5
prev=O1661
var_op='asgn
I
obj='Var
pag=5
prev=O1660
var_op='asgn
I
obj='Var
pag=5
prev=O1659
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1658
var_op='asgn
I
obj='Var
obj_type='MC
pag=5
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=5
prev=O1650
var_op='asgn
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1650
fatherSonIndex=0
frm_calc='iif(DateDiff(gScadSaldi,Date()) <= 90,Year(Date())-2,Year(Date())-1)
len=4
name='_asaldi
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1650
fatherSonIndex=1
frm_calc=[
'(Year(Date()) -Year(rowTemp.DATAINI)=1 and DateDiff(gScadSaldi,Date()) <= 90) or (Year(Date()) -Year(rowTemp.DATAINI)=0)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1685
fatherSonIndex=0
frm_calc='0
len=4
name='_asaldi
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1685
fatherSonIndex=1
frm_calc='Year(rowTemp.DATAINI)
len=4
name='_asaldi
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=5
prev=O1527
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1528
fatherSonIndex=0
frm_calc='rowSID2
frm_seek='AppendRow
name='mcSID2
next=Icpitembatch.CPVarDecl
frm_calc='_tipo2 + 1
len=9
name='_tipo2
next=Icpitembatch.CPBeginEnd
comment='Scrive la riga
h=[
19
19
]
obj='Begin
pag=5
prev=O1699
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1700
fatherSonIndex=0
frm_calc=''2'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(rowSID2.APRINVIO2,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + arfn_fdate_nd(rowSID2.INIINVIO2,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowTemp.TIPO='O','01010001',arfn_fdate_nd(rowSID2.FININVIO2,'N'))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID2.FCFINVIO2,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowSID2.CFSINVIO2),16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + rowSID2.RUOINVIO2
len=398
name='_riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(rowSID2.SEXINVIO2))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(99)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=5
prev=O1716
I
obj='Var
pag=5
prev=O1715
var_op='asgn
I
obj='Var
pag=5
prev=O1712
var_op='asgn
I
obj='If
pag=5
prev=O1711
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O1712
fatherSonIndex=0
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(rowSID2.COGINVIO2,' '),26)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(rowSID2.NOMINVIO2,' '),25)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(rowSID2.SEXINVIO2,1)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +arfn_fdate_nd(rowSID2.DNSINVIO2,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(arfn_agechar(rowSID2.CNSINVIO2,' ')),40)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(rowSID2.PNSINVIO2,2)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(102)
len=398
name='_riga
obj='Var
pag=5
prev=O1725
var_op='asgn
I
obj='Var
pag=5
prev=O1724
var_op='asgn
I
obj='Var
pag=5
prev=O1723
var_op='asgn
I
obj='Var
pag=5
prev=O1722
var_op='asgn
I
obj='Var
pag=5
prev=O1721
var_op='asgn
I
obj='Var
pag=5
prev=O1720
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O1712
fatherSonIndex=1
frm_calc='_riga +Space(102)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(arfn_agechar(rowSID2.RGSINVIO2,' ')),60)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(arfn_agechar(rowSID2.CSLINVIO2,' ')),40)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(rowSID2.PLSINVIO2),2)
len=398
name='_riga
obj='Var
pag=5
prev=O1730
var_op='asgn
I
obj='Var
pag=5
prev=O1729
var_op='asgn
I
obj='Var
pag=5
prev=O1728
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=5
prev=O1710
var_op='asgn
I
obj='Var
pag=5
prev=O1709
var_op='asgn
I
obj='Var
pag=5
prev=O1708
var_op='asgn
I
obj='Var
pag=5
prev=O1707
var_op='asgn
I
obj='Var
pag=5
prev=O1706
var_op='asgn
I
obj='Var
pag=5
prev=O1705
var_op='asgn
I
obj='Var
pag=5
prev=O1704
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1698
var_op='asgn
I
obj='Var
obj_type='MC
pag=5
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=5
prev=O1525
var_op='asgn
I
obj='Begin
pag=5
prev=O1522
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPBeginEnd
comment='Aggiorna codice Univoco
father=O1525
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_invio
frm_seek='CODINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.RAPPORTO
frm_seek='RAPINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.TIPOAG
frm_seek='TPRINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAINI
frm_seek='INIINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAFINE
frm_seek='FININVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc=''2'
frm_seek='TIPINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc=''2'
frm_seek='TPCINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_unique
frm_seek='UNIQUE1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_newuc
frm_seek='FLGUNQ1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAMODI
frm_seek='MODINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowSID1
frm_seek='AppendRow
name='mcSID1
next=Icpitembatch.CPVarDecl
frm_calc='_tipo1 + 1
len=9
name='_tipo1
next=Icpitembatch.CPBeginEnd
comment='Scrive la riga
h=[
19
19
]
obj='Begin
pag=5
prev=O1750
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1751
fatherSonIndex=0
frm_calc=''1'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowTemp.TIPOAG),2)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowTemp.TIPOAG='99',LibreriaMit.SpacePad(LRTrim(Upper(arfn_agechar(rowTemp.DESCRAP,' '))),24),Space(24))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + arfn_fdate_nd(rowTemp.DATAINI,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowTemp.TIPO='O','01010001',arfn_fdate_nd(rowTemp.DATAFINE,'N'))
len=398
name='_riga
next=Icpitembatch.CPIfElse
frm_calc=[
'At(rowTemp.TIPOAG,"01;02;03;12;13") <> 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(_tipinvio='2' and not(Empty(rowTemp.IDESITO)), LibreriaMit.SpacePad(LRTrim(rowTemp.IDESITO),13),Space(13))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(286)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=5
prev=O1766
I
obj='Var
pag=5
prev=O1765
var_op='asgn
I
obj='Var
pag=5
prev=O1764
var_op='asgn
I
obj='Var
pag=5
prev=O1761
var_op='asgn
I
obj='If
pag=5
prev=O1760
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1761
fatherSonIndex=0
frm_calc='_riga + iif(Empty(LRTrim(rowTemp.CAB)),LibreriaMit.SpacePad(LRTrim(_cabinter),5),LibreriaMit.SpacePad(LRTrim(rowTemp.CAB),5))
len=398
name='_riga
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1761
fatherSonIndex=1
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowTemp.CAB),5)
len=398
name='_riga
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=5
prev=O1759
var_op='asgn
I
obj='Var
pag=5
prev=O1758
var_op='asgn
I
obj='Var
pag=5
prev=O1757
var_op='asgn
I
obj='Var
pag=5
prev=O1756
var_op='asgn
I
obj='Var
pag=5
prev=O1755
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1749
var_op='asgn
I
obj='Var
obj_type='MC
pag=5
prev=O1748
var_op='meth
I
obj='Var
obj_type='R
pag=5
prev=O1747
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1746
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1745
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1744
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1743
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1742
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1741
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1740
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1739
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1737
var_op='prop
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1737
fatherSonIndex=0
frm_calc='arfn_agechar(LRTrim(rowTemp.UNIQUECODE),"_")
len=50
name='_unique
next=Icpitembatch.CPVarDecl
frm_calc=''N'
len=1
name='_newuc
obj='Var
pag=5
prev=O1777
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1522
fatherSonIndex=0
frm_calc='_numfile + 1
len=1
name='_numfile
next=Icpitembatch.CPBeginEnd
comment='Azzera i cursori
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Apre il file di scrittura
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Crea Testata
h=[
19
19
]
obj='Begin
pag=5
prev=O1786
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1788
fatherSonIndex=0
frm_calc='_invio
frm_seek='CODINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc=''2'
frm_seek='TIPINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc=''2'
frm_seek='TPCINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='w_annoc
frm_seek='ANNINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='_mese
frm_seek='MESINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='_nomefile
frm_seek='FLEINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='rowSID0
frm_seek='AppendRow
name='mcSID0
next=Icpitembatch.CPDelete
arch='sid_invio
next=Icpitembatch.CPInsert
arch='sid_invio
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_crea
next=Icpitembatch.CPBeginEnd
comment='Scrive testata
h=[
19
19
]
obj='Begin
pag=5
prev=O1801
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1802
fatherSonIndex=0
frm_calc=''0'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'ARU00'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '2'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '2'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '0000'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '00'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(24)
len=398
name='_riga
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +'0'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + Space(112)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=5
prev=O1818
I
obj='Var
pag=5
prev=O1817
var_op='asgn
I
obj='Var
pag=5
prev=O1816
var_op='asgn
I
obj='Var
pag=5
prev=O1815
var_op='asgn
I
obj='Var
pag=5
prev=O1813
var_op='asgn
I
obj='Select
pag=5
prev=O1812
sel_field='*
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1813
fatherSonIndex=0
frm_calc='_riga + LibreriaMit.SpacePad(Upper(LRTrim(intermbo->CODFISC)),16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(intermbo->CODFISC)
len=16
name='_cfinter
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(intermbo->CODCAB),5)
len=5
name='_cabinter
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(intermbo->CODFISC)) = 16
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1824
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O1825
fatherSonIndex=0
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->COGNOME,26)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->NOME,25)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->SESSO,1)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +arfn_fdate_nd(intermbo->DATANASC,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->NASCOMUN,40)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->PROVNA,2)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(112)
len=10
name='_riga
obj='Var
obj_type='M
pag=5
prev=O1835
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O1834
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O1833
var_op='asgn
I
obj='Var
pag=5
prev=O1832
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O1831
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O1830
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O1825
fatherSonIndex=1
frm_calc='_riga +Space(102)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(intermbo->RAGSOC,' '),70)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(intermbo->DESCCIT,' '),40)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->PROVINCIA,2)
len=10
name='_riga
obj='Var
obj_type='M
pag=5
prev=O1840
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O1839
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O1838
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=5
prev=O1823
var_op='asgn
I
obj='Var
pag=5
prev=O1822
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1811
var_op='asgn
I
obj='Var
pag=5
prev=O1810
var_op='asgn
I
obj='Var
pag=5
prev=O1809
var_op='asgn
I
obj='Var
pag=5
prev=O1808
var_op='asgn
I
obj='Var
pag=5
prev=O1807
var_op='asgn
I
obj='Var
pag=5
prev=O1806
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1800
var_op='asgn
I
obj='Insert
pag=5
prev=O1799
rd_kfield=[
'CODINVIO
'TIPINVIO
'TPCINVIO
'DATINVIO
'ANNINVIO
'MESINVIO
'FLEINVIO
]
rd_kvar=[
'_invio
''2'
''2'
'Date()
''0000'
''00'
'_nomefile
]
I
obj='Delete
pag=5
prev=O1798
rd_kfield=[
'CODINVIO
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='Var
obj_type='MC
pag=5
prev=O1797
var_op='meth
I
obj='Var
obj_type='R
pag=5
prev=O1796
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1795
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1794
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1793
var_op='prop
I
obj='Var
obj_type='R
pag=5
prev=O1792
var_op='prop
I
obj='Var
obj_type='R
pag=5
var_op='prop
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
prev=O1784
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1786
fatherSonIndex=0
frm_calc='w_annoc+w_mese+'_2_2_'+Str(_numfile,1,0)
len=10
name='_invio
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gIntemediario)+"_"+_invio+"_"+DateTimeToChar(DateTime())
len=10
name='_nomefile
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWritePath(LRTrim(gPathDoc)+'/SID/INVII/DAP/'+LRTrim(gAzienda)+"/"+LRTrim(_nomefile))
len=10
name='fhand
next=Icpitembatch.CPInsert
arch='tmp_list_imprich
obj='Insert
pag=5
prev=O1855
rd_kfield=[
'nomefile
]
rd_kvar=[
'_invio
]
I
obj='Var
pag=5
prev=O1854
var_op='asgn
I
obj='Var
pag=5
prev=O1853
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
prev=O1783
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1784
fatherSonIndex=0
frm_seek='Zap
name='mcSID0
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID1
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID2
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID2r
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID3
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID3r
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo1
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo2
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo3
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo4
obj='Var
obj_type='N
pag=5
prev=O1870
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1869
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1868
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1867
var_op='asgn
I
obj='Var
obj_type='MC
pag=5
prev=O1866
var_op='meth
I
obj='Var
obj_type='MC
pag=5
prev=O1865
var_op='meth
I
obj='Var
obj_type='MC
pag=5
prev=O1864
var_op='meth
I
obj='Var
obj_type='MC
pag=5
prev=O1863
var_op='meth
I
obj='Var
obj_type='MC
pag=5
prev=O1862
var_op='meth
I
obj='Var
obj_type='MC
pag=5
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1516
var_op='asgn
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O1241
fatherSonIndex=1
frm_calc='gMsgProc + 'Non ci sono chiusure per il periodo considerato: '+arfn_fdate(_dataini)+" - " +arfn_fdate(_datafin)+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1239
var_op='asgn
I
obj='MemoryCursor
pag=5
par_expr=[
'_dataini
'_datafin
]
par_name=[
'_dadata
'_adata
]
prev=O1238
sel_name='qbe_fam_chiudi_aui
I
nonlocal=True
obj='Var
pag=5
prev=O1237
var_op='asgn
I
obj='Var
pag=5
prev=O1236
var_op='asgn
I
obj='Var
obj_type='D
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=5
prev=O1230
var_op='asgn
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
x=12
y=16
I
Icpitembatch.CPBeginEnd
comment='Legge i dati e effettua le verifiche
h=[
19
19
]
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1883
fatherSonIndex=0
frm_calc='0
len=10
name='_conta
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='_contarighe
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_numfile
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Inizio Elaborazione Modifiche '+w_annoc+"-"+w_mese+' : '+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPBeginEnd
comment='Straordinario - Rettifiche (2-2)
h=[
19
19
]
obj='Begin
pag=3
prev=O1890
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O1891
fatherSonIndex=0
frm_calc='"Attendere. Estrazione dati per il periodo ..."
global=True
len=120
name='gMsgImp
next=Ispitembatch.CPMemoryCursor
data_source='tmp_stpperiodo
mem_curs_name='mcTemp
next=Icpitembatch.CPVarDecl
frm_calc='mcTemp.RecCount()
len=10
name='_contarec
next=Icpitembatch.CPIfElse
frm_calc=[
'_contarec > 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Fine Elaborazione Modifiche 2015: '+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=3
prev=O1898
var_op='asgn
I
obj='If
pag=3
prev=O1897
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O1898
fatherSonIndex=0
for_variable='rowTemp
for_variable_type='tmp_stpperiodo
h=[
19
19
]
iterator_expr='mcTemp
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Sono stati generati '+LRTrim(Str(_conta,10,0))+" record" +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Fine controllo periodo: '+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=3
prev=O1906
var_op='asgn
I
nonlocal=True
obj='Var
pag=3
prev=O1904
var_op='asgn
I
obj='ForEach
pag=3
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1904
fatherSonIndex=0
frm_calc=[
'_contarighe=1
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Record Tipo 1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fam_mesefile02(rowSID1,_dataini,_datafin,rowTemp.TIPO)
name='mcSID2r
next=Icpitembatch.CPForEach
for_variable='rowSID2
for_variable_type='sid_invio2
h=[
19
19
]
iterator_expr='mcSID2r
next=Icpitembatch.CPIfElse
frm_calc=[
'At(rowTemp.TIPOAG,"01;02;03;04;05;06;07;09;10;12;14;15;23;24;98") <> 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGAGESID\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProg
next=Icpitembatch.CPInsert
arch='aefaminvio
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati generati '+LRTrim(Str(_conta,10,0))+" record"
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='_contarighe + 1
len=10
name='_contarighe
next=Icpitembatch.CPIfElse
frm_calc=[
'_contarighe=100000 or _conta=_contarec
]
h=[
19
19
]
obj='If
pag=3
prev=O1925
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Crea Piede
father=O1926
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPInsert
arch='aesaldi
next=Icpitembatch.CPVarDecl
frm_calc='arfn_exec_sid(_nomefile,w_annoc)
name='_sid
next=Icpitembatch.CPIfElse
frm_calc=[
'_sid.RecCount() > 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='_contarighe
obj='Var
obj_type='N
pag=3
prev=O1936
var_op='asgn
I
obj='If
pag=3
prev=O1935
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O1936
fatherSonIndex=0
for_variable='rowErrore
for_variable_type='mcMessaggi.MCRDef
h=[
19
19
]
iterator_expr='_sid
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''Rilevati errori durante il controllo da parte del SID - Modifiche'
obj='Transaction
pag=3
prev=O1942
raise_on_trans_err=True
I
obj='ForEach
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O1942
fatherSonIndex=0
frm_calc='gMsgProc + LRTrim(rowErrore.testata) + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Azzera se avevo scritto qualcosa
father=O1936
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPForEach
for_variable='rowSID1
for_variable_type='sid_invio1
h=[
19
19
]
iterator_expr='mcSID1
next=Icpitembatch.CPForEach
for_variable='rowSID2
for_variable_type='sid_invio2
h=[
19
19
]
iterator_expr='mcSID2
next=Icpitembatch.CPForEach
for_variable='rowSID3
for_variable_type='sid_invio3
h=[
19
19
]
iterator_expr='mcSID3
obj='ForEach
pag=3
prev=O1954
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sid_invio3
father=O1956
fatherSonIndex=0
obj='Insert
pag=3
rd_kfield=[
'CODINVIO3
'RAPINVIO3
'TPRINVIO3
'ANNINVIO3
'VALINVIO3
'IM1INVIO3
'FI1INVIO3
'IM2INVIO3
'FI2INVIO3
'IM3INVIO3
'FI3INVIO3
'IM4INVIO3
'FI4INVIO3
'IM5INVIO3
'FI5INVIO3
'IM6INVIO3
'FI6INVIO3
]
rd_kvar=[
'rowSID3.CODINVIO3
'rowSID3.RAPINVIO3
'rowSID3.TPRINVIO3
'rowSID3.ANNINVIO3
'rowSID3.VALINVIO3
'rowSID3.IM1INVIO3
'rowSID3.FI1INVIO3
'rowSID3.IM2INVIO3
'rowSID3.FI2INVIO3
'rowSID3.IM3INVIO3
'rowSID3.FI3INVIO3
'rowSID3.IM4INVIO3
'rowSID3.FI4INVIO3
'rowSID3.IM5INVIO3
'rowSID3.FI5INVIO3
'rowSID3.IM6INVIO3
'rowSID3.FI6INVIO3
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=3
prev=O1952
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sid_invio2
father=O1954
fatherSonIndex=0
obj='Insert
pag=3
rd_kfield=[
'CODINVIO2
'RAPINVIO2
'APRINVIO2
'INIINVIO2
'FININVIO2
'FCFINVIO2
'CFSINVIO2
'RUOINVIO2
'COGINVIO2
'NOMINVIO2
'DNSINVIO2
'CNSINVIO2
'PNSINVIO2
'RGSINVIO2
'CSLINVIO2
'PLSINVIO2
'SEXINVIO2
]
rd_kvar=[
'rowSID2.CODINVIO2
'rowSID2.RAPINVIO2
'rowSID2.APRINVIO2
'rowSID2.INIINVIO2
'rowSID2.FININVIO2
'rowSID2.FCFINVIO2
'rowSID2.CFSINVIO2
'rowSID2.RUOINVIO2
'rowSID2.COGINVIO2
'rowSID2.NOMINVIO2
'rowSID2.DNSINVIO2
'rowSID2.CNSINVIO2
'rowSID2.PNSINVIO2
'rowSID2.RGSINVIO2
'rowSID2.CSLINVIO2
'rowSID2.PLSINVIO2
'rowSID2.SEXINVIO2
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=3
prev=O1950
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sid_invio1
father=O1952
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'rowSID1.TPRINVIO1='98'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O1972
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O1973
fatherSonIndex=0
frm_calc='"Sto aggiornando l'operazione con codice: "+rowSID1.RAPINVIO1
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='opextrbo
obj='Write
pag=3
prev=O1978
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'DATAMODI
]
wr_op=[
'=
]
wr_var=[
'NullDate()
]
I
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O1973
fatherSonIndex=1
frm_calc='"Sto aggiornando il rapporto: "+rowSID1.RAPINVIO1
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='aetesta
obj='Write
pag=3
prev=O1987
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'DATAMODI
]
wr_op=[
'=
]
wr_var=[
'NullDate()
]
I
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=3
rd_kfield=[
'CODINVIO1
'RAPINVIO1
'TPRINVIO1
'INIINVIO1
'FININVIO1
'TIPINVIO1
'TPCINVIO1
'MODINVIO1
]
rd_kvar=[
'rowSID1.CODINVIO1
'rowSID1.RAPINVIO1
'rowSID1.TPRINVIO1
'rowSID1.INIINVIO1
'rowSID1.FININVIO1
'rowSID1.TIPINVIO1
'rowSID1.TPCINVIO1
'rowSID1.MODINVIO1
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='sid_invio3
father=O1950
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='sid_invio2
next=Icpitembatch.CPDelete
arch='sid_invio1
obj='Delete
pag=3
prev=O2002
rd_kfield=[
'CODINVIO1
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='Delete
pag=3
prev=O2001
rd_kfield=[
'CODINVIO2
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='Delete
pag=3
rd_kfield=[
'CODINVIO3
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='MC
pag=3
prev=O1934
var_op='asgn
I
obj='Insert
pag=3
prev=O1933
rd_kfield=[
'IDBASE
'NOMEFILE
'ANNO
'MESE
'TIPOINVIO
'TIPOCOMU
'CODINVIO
]
rd_kvar=[
'LibreriaMit.UniqueId()
'Left(_nomefile,50)
'w_annoc
'_mese
''2'
''2'
'_invio
]
I
obj='Exec
pag=3
prev=O1931
I
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Scrive Ultima riga
father=O1931
fatherSonIndex=0
h=[
19
19
]
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2019
fatherSonIndex=0
frm_calc=''9'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo1,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo2,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo3,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo4,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + Space(360)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=3
prev=O2029
I
obj='Var
pag=3
prev=O2028
var_op='asgn
I
obj='Var
pag=3
prev=O2027
var_op='asgn
I
obj='Var
pag=3
prev=O2026
var_op='asgn
I
obj='Var
pag=3
prev=O2025
var_op='asgn
I
obj='Var
pag=3
prev=O2024
var_op='asgn
I
obj='Var
pag=3
prev=O2023
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O1924
var_op='asgn
I
nonlocal=True
obj='Var
pag=3
prev=O1923
var_op='asgn
I
obj='Insert
pag=3
prev=O1922
rd_kfield=[
'IDBASE
'TIPO
'TIPOINVIO
'ANNO
'MESE
'TIPOCOM
'RAPPORTO
'NOMEFILE
'PROG
'IDIDBASE
'OLDDATA
]
rd_kvar=[
'cProg
'rowTemp.TIPO
''2'
''0000'
''00'
''2'
'rowTemp.RAPPORTO
'_nomefile
'_conta
'_invio
'rowTemp.DATAMODI
]
I
obj='Var
pag=3
prev=O1921
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1918
var_op='asgn
I
obj='If
pag=3
prev=O1916
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1918
fatherSonIndex=0
frm_calc=[
'rowTemp.TIPOAG <> '98'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fam_mesefile03(rowSID1,_asaldi,rowTemp.TIPO,rowTemp.VALUTA)
name='mcSID3r
next=Icpitembatch.CPForEach
for_variable='rowSID3
for_variable_type='sid_invio3
h=[
19
19
]
iterator_expr='mcSID3r
obj='ForEach
pag=3
prev=O2041
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2042
fatherSonIndex=0
frm_calc='rowSID3
frm_seek='AppendRow
name='mcSID3
next=Icpitembatch.CPVarDecl
frm_calc='_tipo3 + 1
len=9
name='_tipo3
next=Icpitembatch.CPVarDecl
frm_calc=''3'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + rowTemp.TIPOAG
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.ANNINVIO3,4,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM1INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM1INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM1INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI1INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM2INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM2INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM2INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI2INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM3INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM3INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM3INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI3INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM4INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM4INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM4INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI4INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM5INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM5INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM5INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI5INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM6INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM6INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM6INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI6INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + rowTemp.VALUTA
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(229)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=3
prev=O2066
I
obj='Var
pag=3
prev=O2065
var_op='asgn
I
obj='Var
pag=3
prev=O2064
var_op='asgn
I
obj='Var
pag=3
prev=O2063
var_op='asgn
I
obj='Var
pag=3
prev=O2062
var_op='asgn
I
obj='Var
pag=3
prev=O2061
var_op='asgn
I
obj='Var
pag=3
prev=O2060
var_op='asgn
I
obj='Var
pag=3
prev=O2059
var_op='asgn
I
obj='Var
pag=3
prev=O2058
var_op='asgn
I
obj='Var
pag=3
prev=O2057
var_op='asgn
I
obj='Var
pag=3
prev=O2056
var_op='asgn
I
obj='Var
pag=3
prev=O2055
var_op='asgn
I
obj='Var
pag=3
prev=O2054
var_op='asgn
I
obj='Var
pag=3
prev=O2053
var_op='asgn
I
obj='Var
pag=3
prev=O2052
var_op='asgn
I
obj='Var
pag=3
prev=O2051
var_op='asgn
I
obj='Var
pag=3
prev=O2050
var_op='asgn
I
obj='Var
pag=3
prev=O2049
var_op='asgn
I
obj='Var
pag=3
prev=O2048
var_op='asgn
I
obj='Var
pag=3
prev=O2047
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O2046
var_op='asgn
I
obj='Var
obj_type='MC
pag=3
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=3
prev=O2038
var_op='asgn
I
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2038
fatherSonIndex=0
frm_calc='iif(DateDiff(gScadSaldi,Date()) <= 90,Year(Date())-2,Year(Date())-1)
len=4
name='_asaldi
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2038
fatherSonIndex=1
frm_calc=[
'(Year(Date()) -Year(rowTemp.DATAINI)=1 and DateDiff(gScadSaldi,Date()) <= 90) or (Year(Date()) -Year(rowTemp.DATAINI)=0)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2073
fatherSonIndex=0
frm_calc='0
len=4
name='_asaldi
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2073
fatherSonIndex=1
frm_calc='Year(rowTemp.DATAINI)
len=4
name='_asaldi
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=3
prev=O1915
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1916
fatherSonIndex=0
frm_calc='rowSID2
frm_seek='AppendRow
name='mcSID2
next=Icpitembatch.CPVarDecl
frm_calc='_tipo2 + 1
len=9
name='_tipo2
next=Icpitembatch.CPBeginEnd
comment='Scrive la riga
h=[
19
19
]
obj='Begin
pag=3
prev=O2087
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2088
fatherSonIndex=0
frm_calc=''2'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(rowSID2.APRINVIO2,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + arfn_fdate_nd(rowSID2.INIINVIO2,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowTemp.TIPO='O','01010001',arfn_fdate_nd(rowSID2.FININVIO2,'N'))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID2.FCFINVIO2,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowSID2.CFSINVIO2),16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + rowSID2.RUOINVIO2
len=398
name='_riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(rowSID2.SEXINVIO2))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(99)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=3
prev=O2104
I
obj='Var
pag=3
prev=O2103
var_op='asgn
I
obj='Var
pag=3
prev=O2100
var_op='asgn
I
obj='If
pag=3
prev=O2099
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O2100
fatherSonIndex=0
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(rowSID2.COGINVIO2,' '),26)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(rowSID2.NOMINVIO2,' '),25)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(rowSID2.SEXINVIO2,1)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +arfn_fdate_nd(rowSID2.DNSINVIO2,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(arfn_agechar(rowSID2.CNSINVIO2,' ')),40)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(rowSID2.PNSINVIO2,2)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(102)
len=398
name='_riga
obj='Var
pag=3
prev=O2113
var_op='asgn
I
obj='Var
pag=3
prev=O2112
var_op='asgn
I
obj='Var
pag=3
prev=O2111
var_op='asgn
I
obj='Var
pag=3
prev=O2110
var_op='asgn
I
obj='Var
pag=3
prev=O2109
var_op='asgn
I
obj='Var
pag=3
prev=O2108
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O2100
fatherSonIndex=1
frm_calc='_riga +Space(102)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(arfn_agechar(rowSID2.RGSINVIO2,' ')),60)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(arfn_agechar(rowSID2.CSLINVIO2,' ')),40)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(rowSID2.PLSINVIO2),2)
len=398
name='_riga
obj='Var
pag=3
prev=O2118
var_op='asgn
I
obj='Var
pag=3
prev=O2117
var_op='asgn
I
obj='Var
pag=3
prev=O2116
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=3
prev=O2098
var_op='asgn
I
obj='Var
pag=3
prev=O2097
var_op='asgn
I
obj='Var
pag=3
prev=O2096
var_op='asgn
I
obj='Var
pag=3
prev=O2095
var_op='asgn
I
obj='Var
pag=3
prev=O2094
var_op='asgn
I
obj='Var
pag=3
prev=O2093
var_op='asgn
I
obj='Var
pag=3
prev=O2092
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O2086
var_op='asgn
I
obj='Var
obj_type='MC
pag=3
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=3
prev=O1913
var_op='asgn
I
obj='Begin
pag=3
prev=O1910
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPBeginEnd
comment='Aggiorna codice Univoco
father=O1913
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_invio
frm_seek='CODINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.RAPPORTO
frm_seek='RAPINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.TIPOAG
frm_seek='TPRINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAINI
frm_seek='INIINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAFINE
frm_seek='FININVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc=''2'
frm_seek='TIPINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc=''2'
frm_seek='TPCINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_unique
frm_seek='UNIQUE1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_newuc
frm_seek='FLGUNQ1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAMODI
frm_seek='MODINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowSID1
frm_seek='AppendRow
name='mcSID1
next=Icpitembatch.CPVarDecl
frm_calc='_tipo1 + 1
len=9
name='_tipo1
next=Icpitembatch.CPBeginEnd
comment='Scrive la riga
h=[
19
19
]
obj='Begin
pag=3
prev=O2138
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2139
fatherSonIndex=0
frm_calc=''1'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowTemp.TIPOAG),2)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowTemp.TIPOAG='99',LibreriaMit.SpacePad(LRTrim(Upper(arfn_agechar(rowTemp.DESCRAP,' '))),24),Space(24))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + arfn_fdate_nd(rowTemp.DATAINI,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowTemp.TIPO='O','01010001',arfn_fdate_nd(rowTemp.DATAFINE,'N'))
len=398
name='_riga
next=Icpitembatch.CPIfElse
frm_calc=[
'At(rowTemp.TIPOAG,"01;02;03;12;13") <> 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(_tipinvio='2' and not(Empty(rowTemp.IDESITO)), LibreriaMit.SpacePad(LRTrim(rowTemp.IDESITO),13),Space(13))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(286)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=3
prev=O2154
I
obj='Var
pag=3
prev=O2153
var_op='asgn
I
obj='Var
pag=3
prev=O2152
var_op='asgn
I
obj='Var
pag=3
prev=O2149
var_op='asgn
I
obj='If
pag=3
prev=O2148
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2149
fatherSonIndex=0
frm_calc='_riga + iif(Empty(LRTrim(rowTemp.CAB)),LibreriaMit.SpacePad(LRTrim(_cabinter),5),LibreriaMit.SpacePad(LRTrim(rowTemp.CAB),5))
len=398
name='_riga
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2149
fatherSonIndex=1
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowTemp.CAB),5)
len=398
name='_riga
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=3
prev=O2147
var_op='asgn
I
obj='Var
pag=3
prev=O2146
var_op='asgn
I
obj='Var
pag=3
prev=O2145
var_op='asgn
I
obj='Var
pag=3
prev=O2144
var_op='asgn
I
obj='Var
pag=3
prev=O2143
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O2137
var_op='asgn
I
obj='Var
obj_type='MC
pag=3
prev=O2136
var_op='meth
I
obj='Var
obj_type='R
pag=3
prev=O2135
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2134
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2133
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2132
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2131
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2130
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2129
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2128
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2127
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2125
var_op='prop
I
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2125
fatherSonIndex=0
frm_calc='arfn_agechar(LRTrim(rowTemp.UNIQUECODE),"_")
len=50
name='_unique
next=Icpitembatch.CPVarDecl
frm_calc=''N'
len=1
name='_newuc
obj='Var
pag=3
prev=O2165
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1910
fatherSonIndex=0
frm_calc='_numfile + 1
len=1
name='_numfile
next=Icpitembatch.CPBeginEnd
comment='Azzera i cursori
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Apre il file di scrittura
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Crea Testata
h=[
19
19
]
obj='Begin
pag=3
prev=O2174
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2176
fatherSonIndex=0
frm_calc='_invio
frm_seek='CODINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc=''2'
frm_seek='TIPINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc=''2'
frm_seek='TPCINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='w_annoc
frm_seek='ANNINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='_mese
frm_seek='MESINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='_nomefile
frm_seek='FLEINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='rowSID0
frm_seek='AppendRow
name='mcSID0
next=Icpitembatch.CPDelete
arch='sid_invio
next=Icpitembatch.CPInsert
arch='sid_invio
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_crea
next=Icpitembatch.CPBeginEnd
comment='Scrive testata
h=[
19
19
]
obj='Begin
pag=3
prev=O2189
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2190
fatherSonIndex=0
frm_calc=''0'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'ARU00'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '2'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '2'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '0000'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '00'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(24)
len=398
name='_riga
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +'0'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + Space(112)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=3
prev=O2206
I
obj='Var
pag=3
prev=O2205
var_op='asgn
I
obj='Var
pag=3
prev=O2204
var_op='asgn
I
obj='Var
pag=3
prev=O2203
var_op='asgn
I
obj='Var
pag=3
prev=O2201
var_op='asgn
I
obj='Select
pag=3
prev=O2200
sel_field='*
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2201
fatherSonIndex=0
frm_calc='_riga + LibreriaMit.SpacePad(Upper(LRTrim(intermbo->CODFISC)),16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(intermbo->CODFISC)
len=16
name='_cfinter
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(intermbo->CODCAB),5)
len=5
name='_cabinter
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(intermbo->CODFISC)) = 16
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O2212
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O2213
fatherSonIndex=0
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->COGNOME,26)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->NOME,25)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->SESSO,1)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +arfn_fdate_nd(intermbo->DATANASC,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->NASCOMUN,40)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->PROVNA,2)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(112)
len=10
name='_riga
obj='Var
obj_type='M
pag=3
prev=O2223
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O2222
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O2221
var_op='asgn
I
obj='Var
pag=3
prev=O2220
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O2219
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O2218
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O2213
fatherSonIndex=1
frm_calc='_riga +Space(102)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(intermbo->RAGSOC,' '),70)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(intermbo->DESCCIT,' '),40)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->PROVINCIA,2)
len=10
name='_riga
obj='Var
obj_type='M
pag=3
prev=O2228
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O2227
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O2226
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=3
prev=O2211
var_op='asgn
I
obj='Var
pag=3
prev=O2210
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O2199
var_op='asgn
I
obj='Var
pag=3
prev=O2198
var_op='asgn
I
obj='Var
pag=3
prev=O2197
var_op='asgn
I
obj='Var
pag=3
prev=O2196
var_op='asgn
I
obj='Var
pag=3
prev=O2195
var_op='asgn
I
obj='Var
pag=3
prev=O2194
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O2188
var_op='asgn
I
obj='Insert
pag=3
prev=O2187
rd_kfield=[
'CODINVIO
'TIPINVIO
'TPCINVIO
'DATINVIO
'ANNINVIO
'MESINVIO
'FLEINVIO
]
rd_kvar=[
'_invio
''2'
''2'
'Date()
''0000'
''00'
'_nomefile
]
I
obj='Delete
pag=3
prev=O2186
rd_kfield=[
'CODINVIO
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='Var
obj_type='MC
pag=3
prev=O2185
var_op='meth
I
obj='Var
obj_type='R
pag=3
prev=O2184
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2183
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2182
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2181
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2180
var_op='prop
I
obj='Var
obj_type='R
pag=3
var_op='prop
I
I
]
w=[
150
150
]
I
obj='Begin
pag=3
prev=O2172
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2174
fatherSonIndex=0
frm_calc='w_annoc+w_mese+'_2_2_'+Str(_numfile,1,0)
len=10
name='_invio
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gIntemediario)+"_"+_invio+"_"+DateTimeToChar(DateTime())
len=10
name='_nomefile
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWritePath(LRTrim(gPathDoc)+'/SID/INVII/DAP/'+LRTrim(gAzienda)+"/"+LRTrim(_nomefile))
len=10
name='fhand
next=Icpitembatch.CPInsert
arch='tmp_list_imprich
obj='Insert
pag=3
prev=O2243
rd_kfield=[
'nomefile
]
rd_kvar=[
'_invio
]
I
obj='Var
pag=3
prev=O2242
var_op='asgn
I
obj='Var
pag=3
prev=O2241
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=3
prev=O2171
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2172
fatherSonIndex=0
frm_seek='Zap
name='mcSID0
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID1
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID2
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID2r
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID3
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID3r
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo1
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo2
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo3
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo4
obj='Var
obj_type='N
pag=3
prev=O2258
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O2257
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O2256
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O2255
var_op='asgn
I
obj='Var
obj_type='MC
pag=3
prev=O2254
var_op='meth
I
obj='Var
obj_type='MC
pag=3
prev=O2253
var_op='meth
I
obj='Var
obj_type='MC
pag=3
prev=O2252
var_op='meth
I
obj='Var
obj_type='MC
pag=3
prev=O2251
var_op='meth
I
obj='Var
obj_type='MC
pag=3
prev=O2250
var_op='meth
I
obj='Var
obj_type='MC
pag=3
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O1898
fatherSonIndex=1
frm_calc='gMsgProc + 'Non ci sono modifiche per il periodo considerato: '+arfn_fdate(_dataini)+" - " +arfn_fdate(_datafin)+NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O1896
var_op='asgn
I
obj='MemoryCursor
pag=3
par_expr=[
'_dataini
'_datafin
]
par_name=[
'_dadata
'_adata
]
prev=O1895
sel_name='qbe_fam_periodo05
I
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=3
prev=O1889
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1888
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1887
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
x=1091
y=169
I
Icpitembatch.CPBeginEnd
comment='Cerca i limiti di selezione
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_oldmsg
next=Icpitembatch.CPVarDecl
frm_calc='_reccount
len=10
name='_contarec
next=Icpitembatch.CPWhile
frm_calc='_contacicli <= _cicli
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_contarighe<100000
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Sono stati generati '+LRTrim(Str(_conta,10,0))+" record" +NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Ora Fine controllo periodo: '+arfn_fdatetime(DateTime())+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O2280
var_op='asgn
I
nonlocal=True
obj='Var
pag=3
prev=O2279
var_op='asgn
I
nonlocal=True
obj='Var
pag=3
prev=O2276
var_op='asgn
I
obj='If
pag=3
prev=O2274
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Crea Piede
father=O2276
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='arfn_exec_sid(_nomefile,w_annoc)
name='_sid
next=Icpitembatch.CPIfElse
frm_calc=[
'_sid.RecCount() > 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O2287
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2288
fatherSonIndex=0
frm_calc='gMsgProc + 'Errori rilevati sul file: '+_invio+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPForEach
for_variable='rowErrore
for_variable_type='mcMessaggi.MCRDef
h=[
19
19
]
iterator_expr='_sid
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''Rilevati errori durante il controllo da parte del SID - Modifiche'
obj='Transaction
pag=3
prev=O2294
raise_on_trans_err=True
I
obj='ForEach
pag=3
prev=O2293
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O2294
fatherSonIndex=0
frm_calc='gMsgProc + LRTrim(rowErrore.testata) + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='aesaldi
father=O2288
fatherSonIndex=1
next=Icpitembatch.CPBeginEnd
comment='Azzera se avevo scritto qualcosa
h=[
19
19
]
next=Icpitembatch.CPForEach
for_variable='rowSID1
for_variable_type='sid_invio1
h=[
19
19
]
iterator_expr='mcSID1
next=Icpitembatch.CPForEach
for_variable='rowSID2
for_variable_type='sid_invio2
h=[
19
19
]
iterator_expr='mcSID2
next=Icpitembatch.CPForEach
for_variable='rowSID3
for_variable_type='sid_invio3
h=[
19
19
]
iterator_expr='mcSID3
next=Icpitembatch.CPExec
check='page
frm_calc='7
obj='Exec
pag=3
prev=O2309
I
obj='ForEach
pag=3
prev=O2307
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sid_invio3
father=O2309
fatherSonIndex=0
obj='Insert
pag=3
rd_kfield=[
'CODINVIO3
'RAPINVIO3
'TPRINVIO3
'ANNINVIO3
'VALINVIO3
'IM1INVIO3
'FI1INVIO3
'IM2INVIO3
'FI2INVIO3
'IM3INVIO3
'FI3INVIO3
'IM4INVIO3
'FI4INVIO3
'IM5INVIO3
'FI5INVIO3
'IM6INVIO3
'FI6INVIO3
]
rd_kvar=[
'rowSID3.CODINVIO3
'rowSID3.RAPINVIO3
'rowSID3.TPRINVIO3
'rowSID3.ANNINVIO3
'rowSID3.VALINVIO3
'rowSID3.IM1INVIO3
'rowSID3.FI1INVIO3
'rowSID3.IM2INVIO3
'rowSID3.FI2INVIO3
'rowSID3.IM3INVIO3
'rowSID3.FI3INVIO3
'rowSID3.IM4INVIO3
'rowSID3.FI4INVIO3
'rowSID3.IM5INVIO3
'rowSID3.FI5INVIO3
'rowSID3.IM6INVIO3
'rowSID3.FI6INVIO3
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=3
prev=O2305
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sid_invio2
father=O2307
fatherSonIndex=0
obj='Insert
pag=3
rd_kfield=[
'CODINVIO2
'RAPINVIO2
'APRINVIO2
'INIINVIO2
'FININVIO2
'FCFINVIO2
'CFSINVIO2
'RUOINVIO2
'COGINVIO2
'NOMINVIO2
'DNSINVIO2
'CNSINVIO2
'PNSINVIO2
'RGSINVIO2
'CSLINVIO2
'PLSINVIO2
'SEXINVIO2
]
rd_kvar=[
'rowSID2.CODINVIO2
'rowSID2.RAPINVIO2
'rowSID2.APRINVIO2
'rowSID2.INIINVIO2
'rowSID2.FININVIO2
'rowSID2.FCFINVIO2
'rowSID2.CFSINVIO2
'rowSID2.RUOINVIO2
'rowSID2.COGINVIO2
'rowSID2.NOMINVIO2
'rowSID2.DNSINVIO2
'rowSID2.CNSINVIO2
'rowSID2.PNSINVIO2
'rowSID2.RGSINVIO2
'rowSID2.CSLINVIO2
'rowSID2.PLSINVIO2
'rowSID2.SEXINVIO2
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=3
prev=O2303
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sid_invio1
father=O2305
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'rowSID1.TPRINVIO1='98'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O2326
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O2327
fatherSonIndex=0
frm_calc='"Sto aggiornando l'operazione con codice: "+rowSID1.RAPINVIO1
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='opextrbo
obj='Write
pag=3
prev=O2332
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'DATAMODI
]
wr_op=[
'=
]
wr_var=[
'NullDate()
]
I
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O2327
fatherSonIndex=1
frm_calc='"Sto aggiornando il rapporto: "+rowSID1.RAPINVIO1
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='aetesta
obj='Write
pag=3
prev=O2341
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'DATAMODI
]
wr_op=[
'=
]
wr_var=[
'NullDate()
]
I
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=3
rd_kfield=[
'CODINVIO1
'RAPINVIO1
'TPRINVIO1
'INIINVIO1
'FININVIO1
'TIPINVIO1
'TPCINVIO1
'MODINVIO1
]
rd_kvar=[
'rowSID1.CODINVIO1
'rowSID1.RAPINVIO1
'rowSID1.TPRINVIO1
'rowSID1.INIINVIO1
'rowSID1.FININVIO1
'rowSID1.TIPINVIO1
'rowSID1.TPCINVIO1
'rowSID1.MODINVIO1
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=3
prev=O2302
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='sid_invio3
father=O2303
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='sid_invio2
next=Icpitembatch.CPDelete
arch='sid_invio1
obj='Delete
pag=3
prev=O2356
rd_kfield=[
'CODINVIO1
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='Delete
pag=3
prev=O2355
rd_kfield=[
'CODINVIO2
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='Delete
pag=3
rd_kfield=[
'CODINVIO3
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=3
rd_kfield=[
'IDBASE
'NOMEFILE
'ANNO
'MESE
'TIPOINVIO
'TIPOCOMU
'CODINVIO
]
rd_kvar=[
'LibreriaMit.UniqueId()
'Left(_nomefile,50)
'w_annoc
'_mese
''2'
''2'
'_invio
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='MC
pag=3
prev=O2286
var_op='asgn
I
obj='Exec
pag=3
prev=O2284
I
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Scrive Ultima riga
father=O2284
fatherSonIndex=0
h=[
19
19
]
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2373
fatherSonIndex=0
frm_calc=''9'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo1,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo2,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo3,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo4,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + Space(360)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=3
prev=O2383
I
obj='Var
pag=3
prev=O2382
var_op='asgn
I
obj='Var
pag=3
prev=O2381
var_op='asgn
I
obj='Var
pag=3
prev=O2380
var_op='asgn
I
obj='Var
pag=3
prev=O2379
var_op='asgn
I
obj='Var
pag=3
prev=O2378
var_op='asgn
I
obj='Var
pag=3
prev=O2377
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='While
pag=3
prev=O2273
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2274
fatherSonIndex=0
frm_calc=[
'_mono = 1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Lettura operazioni extraconto in corso ... Ciclo N. '+LRTrim(Str(_contacicli,10,0)) + " su " +LRTrim(Str(_cicli,10,0))
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_oldmsg)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgImp
len=10
name='_oldmsg
next=Icpitembatch.CPIfElse
frm_calc=[
'_top>=_min
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_contacicli+1
len=15
name='_contacicli
obj='Var
obj_type='N
pag=3
prev=O2398
var_op='asgn
I
obj='If
pag=3
prev=O2397
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O2398
fatherSonIndex=0
frm_calc='"Attendere. Estrazione dati per il periodo ..."
global=True
len=120
name='gMsgImp
next=Ispitembatch.CPMemoryCursor
data_source='tmp_stpperiodo
mem_curs_name='mcTemp
next=Icpitembatch.CPForEach
for_variable='rowTemp
for_variable_type='tmp_stpperiodo
h=[
19
19
]
iterator_expr='mcTemp
obj='ForEach
pag=3
prev=O2405
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2406
fatherSonIndex=0
frm_calc=[
'_contarighe=1
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Record Tipo 1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fam_mesefile02(rowSID1,_dataini,_datafin,rowTemp.TIPO)
name='mcSID2r
next=Icpitembatch.CPForEach
for_variable='rowSID2
for_variable_type='sid_invio2
h=[
19
19
]
iterator_expr='mcSID2r
next=Icpitembatch.CPIfElse
frm_calc=[
'At(rowTemp.TIPOAG,"01;02;03;04;05;06;07;09;10;12;14;15;23;24;98") <> 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_conta + 1
len=10
name='_conta
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGAGESID\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProg
next=Icpitembatch.CPInsert
arch='aefaminvio
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati generati '+LRTrim(Str(_conta,10,0))+" record"
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'_contarighe=100000
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_contarighe + 1
len=10
name='_contarighe
obj='Var
obj_type='N
pag=3
prev=O2425
var_op='asgn
I
obj='If
pag=3
prev=O2424
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Crea Piede
father=O2425
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='arfn_exec_sid(_nomefile,w_annoc)
name='_sid
next=Icpitembatch.CPIfElse
frm_calc=[
'_sid.RecCount() > 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O2434
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2435
fatherSonIndex=0
frm_calc='gMsgProc + 'Errori rilevati sul file: '+_invio+NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPForEach
for_variable='rowErrore
for_variable_type='mcMessaggi.MCRDef
h=[
19
19
]
iterator_expr='_sid
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''Rilevati errori durante il controllo da parte del SID - Modifiche'
obj='Transaction
pag=3
prev=O2441
raise_on_trans_err=True
I
obj='ForEach
pag=3
prev=O2440
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O2441
fatherSonIndex=0
frm_calc='gMsgProc + LRTrim(rowErrore.testata) + NL
global=True
len=120
name='gMsgProc
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='aesaldi
father=O2435
fatherSonIndex=1
next=Icpitembatch.CPBeginEnd
comment='Azzera se avevo scritto qualcosa
h=[
19
19
]
next=Icpitembatch.CPForEach
for_variable='rowSID1
for_variable_type='sid_invio1
h=[
19
19
]
iterator_expr='mcSID1
next=Icpitembatch.CPForEach
for_variable='rowSID2
for_variable_type='sid_invio2
h=[
19
19
]
iterator_expr='mcSID2
next=Icpitembatch.CPForEach
for_variable='rowSID3
for_variable_type='sid_invio3
h=[
19
19
]
iterator_expr='mcSID3
next=Icpitembatch.CPExec
check='page
frm_calc='7
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_contarighe
obj='Var
obj_type='N
pag=3
prev=O2458
var_op='asgn
I
obj='Exec
pag=3
prev=O2456
I
obj='ForEach
pag=3
prev=O2454
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sid_invio3
father=O2456
fatherSonIndex=0
obj='Insert
pag=3
rd_kfield=[
'CODINVIO3
'RAPINVIO3
'TPRINVIO3
'ANNINVIO3
'VALINVIO3
'IM1INVIO3
'FI1INVIO3
'IM2INVIO3
'FI2INVIO3
'IM3INVIO3
'FI3INVIO3
'IM4INVIO3
'FI4INVIO3
'IM5INVIO3
'FI5INVIO3
'IM6INVIO3
'FI6INVIO3
]
rd_kvar=[
'rowSID3.CODINVIO3
'rowSID3.RAPINVIO3
'rowSID3.TPRINVIO3
'rowSID3.ANNINVIO3
'rowSID3.VALINVIO3
'rowSID3.IM1INVIO3
'rowSID3.FI1INVIO3
'rowSID3.IM2INVIO3
'rowSID3.FI2INVIO3
'rowSID3.IM3INVIO3
'rowSID3.FI3INVIO3
'rowSID3.IM4INVIO3
'rowSID3.FI4INVIO3
'rowSID3.IM5INVIO3
'rowSID3.FI5INVIO3
'rowSID3.IM6INVIO3
'rowSID3.FI6INVIO3
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=3
prev=O2452
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sid_invio2
father=O2454
fatherSonIndex=0
obj='Insert
pag=3
rd_kfield=[
'CODINVIO2
'RAPINVIO2
'APRINVIO2
'INIINVIO2
'FININVIO2
'FCFINVIO2
'CFSINVIO2
'RUOINVIO2
'COGINVIO2
'NOMINVIO2
'DNSINVIO2
'CNSINVIO2
'PNSINVIO2
'RGSINVIO2
'CSLINVIO2
'PLSINVIO2
'SEXINVIO2
]
rd_kvar=[
'rowSID2.CODINVIO2
'rowSID2.RAPINVIO2
'rowSID2.APRINVIO2
'rowSID2.INIINVIO2
'rowSID2.FININVIO2
'rowSID2.FCFINVIO2
'rowSID2.CFSINVIO2
'rowSID2.RUOINVIO2
'rowSID2.COGINVIO2
'rowSID2.NOMINVIO2
'rowSID2.DNSINVIO2
'rowSID2.CNSINVIO2
'rowSID2.PNSINVIO2
'rowSID2.RGSINVIO2
'rowSID2.CSLINVIO2
'rowSID2.PLSINVIO2
'rowSID2.SEXINVIO2
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=3
prev=O2450
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sid_invio1
father=O2452
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'rowSID1.TPRINVIO1='98'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O2474
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O2475
fatherSonIndex=0
frm_calc='"Sto aggiornando l'operazione con codice: "+rowSID1.RAPINVIO1
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='opextrbo
obj='Write
pag=3
prev=O2480
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'DATAMODI
]
wr_op=[
'=
]
wr_var=[
'NullDate()
]
I
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O2475
fatherSonIndex=1
frm_calc='"Sto aggiornando il rapporto: "+rowSID1.RAPINVIO1
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='aetesta
obj='Write
pag=3
prev=O2489
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'rowSID1.RAPINVIO1
]
wr_field=[
'DATAMODI
]
wr_op=[
'=
]
wr_var=[
'NullDate()
]
I
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=3
rd_kfield=[
'CODINVIO1
'RAPINVIO1
'TPRINVIO1
'INIINVIO1
'FININVIO1
'TIPINVIO1
'TPCINVIO1
'MODINVIO1
]
rd_kvar=[
'rowSID1.CODINVIO1
'rowSID1.RAPINVIO1
'rowSID1.TPRINVIO1
'rowSID1.INIINVIO1
'rowSID1.FININVIO1
'rowSID1.TIPINVIO1
'rowSID1.TPCINVIO1
'rowSID1.MODINVIO1
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=3
prev=O2449
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='sid_invio3
father=O2450
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='sid_invio2
next=Icpitembatch.CPDelete
arch='sid_invio1
obj='Delete
pag=3
prev=O2504
rd_kfield=[
'CODINVIO1
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='Delete
pag=3
prev=O2503
rd_kfield=[
'CODINVIO2
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='Delete
pag=3
rd_kfield=[
'CODINVIO3
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=3
rd_kfield=[
'IDBASE
'NOMEFILE
'ANNO
'MESE
'TIPOINVIO
'TIPOCOMU
'CODINVIO
]
rd_kvar=[
'LibreriaMit.UniqueId()
'Left(_nomefile,50)
'w_annoc
'_mese
''2'
''2'
'_invio
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='MC
pag=3
prev=O2433
var_op='asgn
I
obj='Exec
pag=3
prev=O2431
I
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Scrive Ultima riga
father=O2431
fatherSonIndex=0
h=[
19
19
]
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2521
fatherSonIndex=0
frm_calc=''9'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo1,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo2,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo3,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(_tipo4,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + Space(360)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=3
prev=O2531
I
obj='Var
pag=3
prev=O2530
var_op='asgn
I
obj='Var
pag=3
prev=O2529
var_op='asgn
I
obj='Var
pag=3
prev=O2528
var_op='asgn
I
obj='Var
pag=3
prev=O2527
var_op='asgn
I
obj='Var
pag=3
prev=O2526
var_op='asgn
I
obj='Var
pag=3
prev=O2525
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=3
prev=O2423
var_op='asgn
I
obj='Insert
pag=3
prev=O2422
rd_kfield=[
'IDBASE
'TIPO
'TIPOINVIO
'ANNO
'MESE
'TIPOCOM
'RAPPORTO
'NOMEFILE
'PROG
'IDIDBASE
'OLDDATA
]
rd_kvar=[
'cProg
'rowTemp.TIPO
''2'
''0000'
''00'
''2'
'rowTemp.RAPPORTO
'_nomefile
'_conta
'_invio
'rowTemp.DATAMODI
]
I
obj='Var
pag=3
prev=O2421
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O2418
var_op='asgn
I
obj='If
pag=3
prev=O2416
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O2418
fatherSonIndex=0
frm_calc=[
'rowTemp.TIPOAG <> '98'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='arfn_fam_mesefile03(rowSID1,_asaldi,rowTemp.TIPO,rowTemp.VALUTA)
name='mcSID3r
next=Icpitembatch.CPForEach
for_variable='rowSID3
for_variable_type='sid_invio3
h=[
19
19
]
iterator_expr='mcSID3r
obj='ForEach
pag=3
prev=O2543
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2544
fatherSonIndex=0
frm_calc='rowSID3
frm_seek='AppendRow
name='mcSID3
next=Icpitembatch.CPVarDecl
frm_calc='_tipo3 + 1
len=9
name='_tipo3
next=Icpitembatch.CPVarDecl
frm_calc=''3'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + rowTemp.TIPOAG
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.ANNINVIO3,4,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM1INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM1INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM1INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI1INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM2INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM2INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM2INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI2INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM3INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM3INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM3INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI3INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM4INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM4INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM4INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI4INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM5INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM5INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM5INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI5INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowSID3.IM6INVIO3 <0,'-'+Right('0000000000000000'+LRTrim(Str(rowSID3.IM6INVIO3*-1,16,0)),16),Right('00000000000000000'+LRTrim(Str(rowSID3.IM6INVIO3,17,0)),17))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID3.FI6INVIO3,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + rowTemp.VALUTA
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(229)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=3
prev=O2568
I
obj='Var
pag=3
prev=O2567
var_op='asgn
I
obj='Var
pag=3
prev=O2566
var_op='asgn
I
obj='Var
pag=3
prev=O2565
var_op='asgn
I
obj='Var
pag=3
prev=O2564
var_op='asgn
I
obj='Var
pag=3
prev=O2563
var_op='asgn
I
obj='Var
pag=3
prev=O2562
var_op='asgn
I
obj='Var
pag=3
prev=O2561
var_op='asgn
I
obj='Var
pag=3
prev=O2560
var_op='asgn
I
obj='Var
pag=3
prev=O2559
var_op='asgn
I
obj='Var
pag=3
prev=O2558
var_op='asgn
I
obj='Var
pag=3
prev=O2557
var_op='asgn
I
obj='Var
pag=3
prev=O2556
var_op='asgn
I
obj='Var
pag=3
prev=O2555
var_op='asgn
I
obj='Var
pag=3
prev=O2554
var_op='asgn
I
obj='Var
pag=3
prev=O2553
var_op='asgn
I
obj='Var
pag=3
prev=O2552
var_op='asgn
I
obj='Var
pag=3
prev=O2551
var_op='asgn
I
obj='Var
pag=3
prev=O2550
var_op='asgn
I
obj='Var
pag=3
prev=O2549
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O2548
var_op='asgn
I
obj='Var
obj_type='MC
pag=3
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=3
prev=O2540
var_op='asgn
I
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2540
fatherSonIndex=0
frm_calc='iif(DateDiff(gScadSaldi,Date()) <= 90,Year(Date())-2,Year(Date())-1)
len=4
name='_asaldi
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2540
fatherSonIndex=1
frm_calc=[
'(Year(Date()) -Year(rowTemp.DATAINI)=1 and DateDiff(gScadSaldi,Date()) <= 90) or (Year(Date()) -Year(rowTemp.DATAINI)=0)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2575
fatherSonIndex=0
frm_calc='0
len=4
name='_asaldi
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2575
fatherSonIndex=1
frm_calc='Year(rowTemp.DATAINI)
len=4
name='_asaldi
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=3
prev=O2415
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2416
fatherSonIndex=0
frm_calc='rowSID2
frm_seek='AppendRow
name='mcSID2
next=Icpitembatch.CPVarDecl
frm_calc='_tipo2 + 1
len=9
name='_tipo2
next=Icpitembatch.CPBeginEnd
comment='Scrive la riga
h=[
19
19
]
obj='Begin
pag=3
prev=O2589
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2590
fatherSonIndex=0
frm_calc=''2'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Right('000000000'+LRTrim(Str(rowSID2.APRINVIO2,9,0)),9)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + arfn_fdate_nd(rowSID2.INIINVIO2,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowTemp.TIPO='O','01010001',arfn_fdate_nd(rowSID2.FININVIO2,'N'))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Str(rowSID2.FCFINVIO2,1,0)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(Upper(rowSID2.CFSINVIO2)),16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + rowSID2.RUOINVIO2
len=398
name='_riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(rowSID2.SEXINVIO2))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(99)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=3
prev=O2606
I
obj='Var
pag=3
prev=O2605
var_op='asgn
I
obj='Var
pag=3
prev=O2602
var_op='asgn
I
obj='If
pag=3
prev=O2601
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O2602
fatherSonIndex=0
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(rowSID2.COGINVIO2,' '),26)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(rowSID2.NOMINVIO2,' '),25)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(rowSID2.SEXINVIO2,1)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +arfn_fdate_nd(rowSID2.DNSINVIO2,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(arfn_agechar(rowSID2.CNSINVIO2,' ')),40)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(rowSID2.PNSINVIO2,2)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(102)
len=398
name='_riga
obj='Var
pag=3
prev=O2615
var_op='asgn
I
obj='Var
pag=3
prev=O2614
var_op='asgn
I
obj='Var
pag=3
prev=O2613
var_op='asgn
I
obj='Var
pag=3
prev=O2612
var_op='asgn
I
obj='Var
pag=3
prev=O2611
var_op='asgn
I
obj='Var
pag=3
prev=O2610
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O2602
fatherSonIndex=1
frm_calc='_riga +Space(102)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(arfn_agechar(rowSID2.RGSINVIO2,' ')),60)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(arfn_agechar(rowSID2.CSLINVIO2,' ')),40)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(LRTrim(rowSID2.PLSINVIO2),2)
len=398
name='_riga
obj='Var
pag=3
prev=O2620
var_op='asgn
I
obj='Var
pag=3
prev=O2619
var_op='asgn
I
obj='Var
pag=3
prev=O2618
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=3
prev=O2600
var_op='asgn
I
obj='Var
pag=3
prev=O2599
var_op='asgn
I
obj='Var
pag=3
prev=O2598
var_op='asgn
I
obj='Var
pag=3
prev=O2597
var_op='asgn
I
obj='Var
pag=3
prev=O2596
var_op='asgn
I
obj='Var
pag=3
prev=O2595
var_op='asgn
I
obj='Var
pag=3
prev=O2594
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O2588
var_op='asgn
I
obj='Var
obj_type='MC
pag=3
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=3
prev=O2413
var_op='asgn
I
obj='Begin
pag=3
prev=O2410
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Aggiorna codice Univoco
father=O2413
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_invio
frm_seek='CODINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.RAPPORTO
frm_seek='RAPINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.TIPOAG
frm_seek='TPRINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAINI
frm_seek='INIINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAFINE
frm_seek='FININVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc=''2'
frm_seek='TIPINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc=''2'
frm_seek='TPCINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_unique
frm_seek='UNIQUE1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='_newuc
frm_seek='FLGUNQ1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowTemp.DATAMODI
frm_seek='MODINVIO1
name='rowSID1
next=Icpitembatch.CPVarDecl
frm_calc='rowSID1
frm_seek='AppendRow
name='mcSID1
next=Icpitembatch.CPVarDecl
frm_calc='_tipo1 + 1
len=9
name='_tipo1
next=Icpitembatch.CPBeginEnd
comment='Scrive la riga
h=[
19
19
]
obj='Begin
pag=3
prev=O2640
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2641
fatherSonIndex=0
frm_calc=''1'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(_unique),50)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowTemp.TIPOAG),2)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowTemp.TIPOAG='99',LibreriaMit.SpacePad(LRTrim(Upper(arfn_agechar(rowTemp.DESCRAP,' '))),24),Space(24))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + arfn_fdate_nd(rowTemp.DATAINI,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(rowTemp.TIPO='O','01010001',arfn_fdate_nd(rowTemp.DATAFINE,'N'))
len=398
name='_riga
next=Icpitembatch.CPIfElse
frm_calc=[
'At(rowTemp.TIPOAG,"01;02;03;12;13") <> 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='_riga + iif(_tipinvio='2' and not(Empty(rowTemp.IDESITO)), LibreriaMit.SpacePad(LRTrim(rowTemp.IDESITO),13),Space(13))
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(286)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=3
prev=O2656
I
obj='Var
pag=3
prev=O2655
var_op='asgn
I
obj='Var
pag=3
prev=O2654
var_op='asgn
I
obj='Var
pag=3
prev=O2651
var_op='asgn
I
obj='If
pag=3
prev=O2650
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2651
fatherSonIndex=0
frm_calc='_riga + iif(Empty(LRTrim(rowTemp.CAB)),LibreriaMit.SpacePad(LRTrim(_cabinter),5),LibreriaMit.SpacePad(LRTrim(rowTemp.CAB),5))
len=398
name='_riga
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2651
fatherSonIndex=1
frm_calc='_riga + LibreriaMit.SpacePad(LRTrim(rowTemp.CAB),5)
len=398
name='_riga
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=3
prev=O2649
var_op='asgn
I
obj='Var
pag=3
prev=O2648
var_op='asgn
I
obj='Var
pag=3
prev=O2647
var_op='asgn
I
obj='Var
pag=3
prev=O2646
var_op='asgn
I
obj='Var
pag=3
prev=O2645
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O2639
var_op='asgn
I
obj='Var
obj_type='MC
pag=3
prev=O2638
var_op='meth
I
obj='Var
obj_type='R
pag=3
prev=O2637
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2636
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2635
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2634
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2633
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2632
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2631
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2630
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2629
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2627
var_op='prop
I
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2627
fatherSonIndex=0
frm_calc='arfn_agechar(LRTrim(rowTemp.UNIQUECODE),"_")
len=50
name='_unique
next=Icpitembatch.CPVarDecl
frm_calc=''N'
len=1
name='_newuc
obj='Var
pag=3
prev=O2667
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2410
fatherSonIndex=0
frm_calc='_numfile + 1
len=1
name='_numfile
next=Icpitembatch.CPBeginEnd
comment='Azzera i cursori
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Apre il file di scrittura
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Crea Testata
h=[
19
19
]
obj='Begin
pag=3
prev=O2676
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2678
fatherSonIndex=0
frm_calc='_invio
frm_seek='CODINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc=''2'
frm_seek='TIPINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc=''2'
frm_seek='TPCINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='w_annoc
frm_seek='ANNINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='_mese
frm_seek='MESINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='_nomefile
frm_seek='FLEINVIO
name='rowSID0
next=Icpitembatch.CPVarDecl
frm_calc='rowSID0
frm_seek='AppendRow
name='mcSID0
next=Icpitembatch.CPDelete
arch='sid_invio
next=Icpitembatch.CPInsert
arch='sid_invio
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_crea
next=Icpitembatch.CPBeginEnd
comment='Scrive testata
h=[
19
19
]
obj='Begin
pag=3
prev=O2691
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2692
fatherSonIndex=0
frm_calc=''0'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + 'ARU00'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '2'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '2'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '0000'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + '00'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='_riga + Space(24)
len=398
name='_riga
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +'0'
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + Space(112)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga + 'A' + LibreriaMit.CloseLine()
len=398
name='_riga
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Write(fhand,_riga)
obj='Exec
pag=3
prev=O2708
I
obj='Var
pag=3
prev=O2707
var_op='asgn
I
obj='Var
pag=3
prev=O2706
var_op='asgn
I
obj='Var
pag=3
prev=O2705
var_op='asgn
I
obj='Var
pag=3
prev=O2703
var_op='asgn
I
obj='Select
pag=3
prev=O2702
sel_field='*
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2703
fatherSonIndex=0
frm_calc='_riga + LibreriaMit.SpacePad(Upper(LRTrim(intermbo->CODFISC)),16)
len=398
name='_riga
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(intermbo->CODFISC)
len=16
name='_cfinter
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(intermbo->CODCAB),5)
len=5
name='_cabinter
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(intermbo->CODFISC)) = 16
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O2714
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O2715
fatherSonIndex=0
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->COGNOME,26)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->NOME,25)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->SESSO,1)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +arfn_fdate_nd(intermbo->DATANASC,'N')
len=398
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->NASCOMUN,40)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->PROVNA,2)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +Space(112)
len=10
name='_riga
obj='Var
obj_type='M
pag=3
prev=O2725
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O2724
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O2723
var_op='asgn
I
obj='Var
pag=3
prev=O2722
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O2721
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O2720
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Invio Ordinario
father=O2715
fatherSonIndex=1
frm_calc='_riga +Space(102)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(intermbo->RAGSOC,' '),70)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(arfn_agechar(intermbo->DESCCIT,' '),40)
len=10
name='_riga
next=Icpitembatch.CPVarDecl
comment='Invio Ordinario
frm_calc='_riga +LibreriaMit.SpacePad(intermbo->PROVINCIA,2)
len=10
name='_riga
obj='Var
obj_type='M
pag=3
prev=O2730
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O2729
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O2728
var_op='asgn
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=3
prev=O2713
var_op='asgn
I
obj='Var
pag=3
prev=O2712
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O2701
var_op='asgn
I
obj='Var
pag=3
prev=O2700
var_op='asgn
I
obj='Var
pag=3
prev=O2699
var_op='asgn
I
obj='Var
pag=3
prev=O2698
var_op='asgn
I
obj='Var
pag=3
prev=O2697
var_op='asgn
I
obj='Var
pag=3
prev=O2696
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O2690
var_op='asgn
I
obj='Insert
pag=3
prev=O2689
rd_kfield=[
'CODINVIO
'TIPINVIO
'TPCINVIO
'DATINVIO
'ANNINVIO
'MESINVIO
'FLEINVIO
]
rd_kvar=[
'_invio
''2'
''2'
'Date()
''0000'
''00'
'_nomefile
]
I
obj='Delete
pag=3
prev=O2688
rd_kfield=[
'CODINVIO
]
rd_kop=[
'=
]
rd_kvar=[
'_invio
]
I
obj='Var
obj_type='MC
pag=3
prev=O2687
var_op='meth
I
obj='Var
obj_type='R
pag=3
prev=O2686
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2685
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2684
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2683
var_op='prop
I
obj='Var
obj_type='R
pag=3
prev=O2682
var_op='prop
I
obj='Var
obj_type='R
pag=3
var_op='prop
I
I
]
w=[
150
150
]
I
obj='Begin
pag=3
prev=O2674
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2676
fatherSonIndex=0
frm_calc='w_annoc+w_mese+'_2_2_'+Str(_numfile,1,0)
len=10
name='_invio
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gIntemediario)+"_"+_invio+"_"+DateTimeToChar(DateTime())
len=10
name='_nomefile
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWritePath(LRTrim(gPathDoc)+'/SID/INVII/DAP/'+LRTrim(gAzienda)+"/"+LRTrim(_nomefile))
len=10
name='fhand
next=Icpitembatch.CPInsert
arch='tmp_list_imprich
obj='Insert
pag=3
prev=O2745
rd_kfield=[
'nomefile
]
rd_kvar=[
'_invio
]
I
obj='Var
pag=3
prev=O2744
var_op='asgn
I
obj='Var
pag=3
prev=O2743
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=3
prev=O2673
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2674
fatherSonIndex=0
frm_seek='Zap
name='mcSID0
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID1
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID2
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID2r
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID3
next=Icpitembatch.CPVarDecl
frm_seek='Zap
name='mcSID3r
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo1
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo2
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo3
next=Icpitembatch.CPVarDecl
frm_calc='0
len=9
name='_tipo4
obj='Var
obj_type='N
pag=3
prev=O2760
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O2759
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O2758
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O2757
var_op='asgn
I
obj='Var
obj_type='MC
pag=3
prev=O2756
var_op='meth
I
obj='Var
obj_type='MC
pag=3
prev=O2755
var_op='meth
I
obj='Var
obj_type='MC
pag=3
prev=O2754
var_op='meth
I
obj='Var
obj_type='MC
pag=3
prev=O2753
var_op='meth
I
obj='Var
obj_type='MC
pag=3
prev=O2752
var_op='meth
I
obj='Var
obj_type='MC
pag=3
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='MemoryCursor
pag=3
par_expr=[
'_dataini
'_datafin
'_bottom
'_top
]
par_name=[
'_dadata
'_adata
'_bottom
'_top
]
prev=O2404
sel_name='qbe_fam_rettifiche_opx
I
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O2398
fatherSonIndex=1
frm_calc=''Lettura operazioni extraconto in corso ...'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='M
pag=3
prev=O2394
var_op='asgn
I
obj='If
pag=3
prev=O2393
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O2394
fatherSonIndex=0
frm_calc='gMsgProc + LRTrim(gMsgImp)
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio
father=O2394
fatherSonIndex=1
frm_calc='Strtran(gMsgProc,LRTrim(_oldmsg),LRTrim(gMsgImp))
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
pag=3
prev=O2390
var_op='asgn
I
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2390
fatherSonIndex=0
frm_calc='_min
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_max
len=15
name='_top
obj='Var
obj_type='N
pag=3
prev=O2778
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2390
fatherSonIndex=1
frm_calc=[
'_contacicli=1
'_contacicli = _cicli
]
h=[
19
19
19
19
]
haselse=True
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2781
fatherSonIndex=0
frm_calc='_min
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_min + 4999
len=15
name='_top
obj='Var
obj_type='N
pag=3
prev=O2786
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2781
fatherSonIndex=1
frm_calc='_top + 1
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_max
len=15
name='_top
obj='Var
obj_type='N
pag=3
prev=O2789
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2781
fatherSonIndex=2
frm_calc='_top + 1
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_bottom + 4999
len=15
name='_top
obj='Var
obj_type='N
pag=3
prev=O2792
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O2272
var_op='asgn
I
obj='Var
obj_type='M
pag=3
prev=O2270
var_op='asgn
I
obj='Begin
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2270
fatherSonIndex=0
frm_calc='0
len=15
name='_max
next=Icpitembatch.CPVarDecl
frm_calc='0
len=15
name='_min
next=Icpitembatch.CPVarDecl
frm_calc='0
len=15
name='_tot
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_mono
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='_contarighe
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_tot > 15000,0,1)
len=1
name='_mono
next=Icpitembatch.CPIfElse
frm_calc=[
'_mono = 1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='1
len=15
name='_contacicli
obj='Var
obj_type='N
pag=3
prev=O2807
var_op='asgn
I
obj='If
pag=3
prev=O2806
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2807
fatherSonIndex=0
frm_calc=[
'_tot = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2813
fatherSonIndex=0
frm_calc='0
len=15
name='_cicli
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2813
fatherSonIndex=1
frm_calc='1
len=15
name='_cicli
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2807
fatherSonIndex=1
frm_calc='_max - _min
name='_reccount
next=Icpitembatch.CPVarDecl
frm_calc='iif(Mod(_reccount,5000) <> 0,Int(_reccount/5000) + 1,Int(_reccount/5000))
len=15
name='_cicli
obj='Var
obj_type='N
pag=3
prev=O2823
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O2804
var_op='asgn
I
obj='Select
pag=3
par_expr=[
'_dataini
'_datafin
]
par_name=[
'_dadata
'_adata
]
prev=O2803
sel_name='qbe_famrett_opx_minmax
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2804
fatherSonIndex=0
frm_calc='qbe_famrett_opx_minmax->MINPRG
len=15
name='_min
next=Icpitembatch.CPVarDecl
frm_calc='qbe_famrett_opx_minmax->MAXPRG
len=15
name='_max
next=Icpitembatch.CPVarDecl
frm_calc='qbe_famrett_opx_minmax->TOTPRG
len=15
name='_tot
obj='Var
obj_type='N
pag=3
prev=O2831
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O2830
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O2802
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O2801
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O2800
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O2799
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
x=13
y=14
I
Icpitembatch.CPBeginEnd
comment='Cancella i file vecchi
h=[
19
19
]
obj='Begin
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O2835
fatherSonIndex=0
frm_calc='// Legge i file degli esiti﷯File di = new File(CPLib.LRTrim(gPathDoc)+"/SID/INVII/DAP/"+CPLib.LRTrim(gAzienda)+"/");﷯File fl[] = di.listFiles();﷯int _i;﷯int count=0;﷯for (_i=0; _i < fl.length; _i++)  {﷯  fl[_i].delete();﷯}﷯di = new File(CPLib.LRTrim(gPathDoc)+"/SID/INVII/PRE/"+CPLib.LRTrim(gAzienda)+"/");﷯File fl1[] = di.listFiles();﷯count=0;﷯for (_i=0; _i < fl1.length; _i++)  {﷯  fl1[_i].delete();﷯}﷯di = new File(CPLib.LRTrim(gPathDoc)+"/SID/INVII/ESI/"+CPLib.LRTrim(gAzienda)+"/");﷯File fl2[] = di.listFiles();﷯count=0;﷯for (_i=0; _i < fl2.length; _i++)  {﷯  fl2[_i].delete();﷯}
obj='Exec
pag=7
I
I
]
w=[
150
150
]
x=15
y=27
I
]
ManualBlocks={
'BO - Header
Icpmanualblocks.CPManualBlocks
code='import java.io.*;﷯import java.util.*;
name='BO - Header
I
'BO - Properties
Icpmanualblocks.CPManualBlocks
code='public int _r;
name='BO - Properties
I
}
comment='Lancia la creazione dei file SID per il periodo
date_creat=#2016-03-01
date_rev=#2021-04-08
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'FileLibMit
'Utilities
'FileLibMit
]
modcnt=252
page_result_class=[
'
'
'
'
'
'
'
]
page_result_type=[
'U
'U
'U
'U
'U
'U
'U
]
page_uid=[
'ZBJRUTRGEM
'WUQMDVOIKS
'ZVAAMYAXSC
'PCJYYHNAJH
'RLWJUUNFCU
'BHJPFBFXSM
'ZPGXSRRYPM
]
pagename=[
'Page_1
'Page_2
'Page_3
'Page_4
'Page_5
'Page_6
'Page_7
]
pagenote=[
'
'
'
'
'
'
'
]
pagetitle=[
'Main
'Nuovi Rapporti
'Modifiche
'Operazioni Extraconto
'Chiusure
'Cancellazioni
'Cancella File in DAP
]
runtime_filters=2
tpl_name='Routine
work_file=[
'aesaldi
'aetesta
'intermbo
'opextrbo
'sid_invio
'sid_invio1
'sid_invio2
'sid_invio3
'sid_invio4
'tmp_listafile
'tmp_list_imprich
'aefaminvio
'anarapbo
]
work_filter=[
'
'
'
'
'
'
'
]
I
*--*
*----*
