* --- CodePainter Revolution Batch Vers. 5.1
￼Icpbatch.CPBatch
Items=[
Icpitembatch.CPBeginEnd
comment='Definizione variabili caller
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Cursori Lettura Tabelle
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili Locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='variabili copia
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='variabili locali per decoprimere il file
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili globali
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Legge dati intermediario per metteri su operazbo,fraziobo,rapopebo se mancanti
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Import Soggetti
next=Icpitembatch.CPVarDecl
frm_calc='''
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPRemark
frm_calc='Cicla sul file della lista e lancia la pagina appropriata
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_esito
next=Icpitembatch.CPExec
check='page
frm_calc='27
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_chkerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_opeerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_frzerr
next=Icpitembatch.CPIfElse
frm_calc=[
'w_chkaui='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_chkaui = 'N' or (w_chkaui='S' and w_imperr='S') or  (w_chkaui='S' and w_imperr='N' and _chkerr=0)
]
h=[
19
19
19
]
haselse=True
next=Ispitembatch.CPReturn
frm_calc='_chkerr
obj='Return
pag=1
prev=O33
I
obj='If
pag=1
prev=O30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDropTemporaryTable
father=O33
fatherSonIndex=0
next=Icpitembatch.CPServerTemporaryTable
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWrite('./output/'+LRTrim(gAzienda)+'/archope_scarti')
len=1
name='ohand
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWrite('./output/'+LRTrim(gAzienda)+'/archfraz_scarti')
len=1
name='zhand
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWrite('./output/'+LRTrim(gAzienda)+'/opex_scarti')
len=1
name='xhand
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenWrite('./output/'+LRTrim(gAzienda)+'/saldopex_scarti')
len=1
name='shand
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
obj='Try
pag=1
prev=O45
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O46
fatherSonIndex=0
frm_calc=[
'gFlgRet='S'
]
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione dati. Inizio fase di commit. Attendere prego...'
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'_esito=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPBeginEnd
comment='Scrittura file con errori
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Importazione dati terminata.'
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O59
var_op='asgn
I
obj='Begin
pag=1
prev=O56
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O59
fatherSonIndex=0
frm_calc='FileLibMit.Close(ohand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(zhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(xhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(shand)
next=Icpitembatch.CPIfElse
frm_calc=[
'_opeerr=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_frzerr=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_opxerr=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_soxerr=0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O74
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O77
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/saldopex_scarti')
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O77
fatherSonIndex=1
frm_calc='2
len=1
name='_chkerr
next=Icpitembatch.CPVarDecl
frm_calc='"saldopex_scarti.zip"
len=20
name='_czip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/"+_czip
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/saldopex_scarti"
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='"saldopex_scarti"
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc='// These are the files to include in the ZIP file﷯filenames.clear();﷯fileonames.clear();﷯filenames.add(cNomeFile);﷯fileonames.add(cOnlyNomeFile);
next=Icpitembatch.CPExec
check='page
frm_calc='36
next=Icpitembatch.CPInsert
arch='tmp_listafile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevate operazioni extraconto senza i dati del soggetto. Prelevare il file saldopex_scarti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/saldopex_scarti')
obj='Exec
pag=1
prev=O92
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O91
var_op='asgn
I
obj='Insert
pag=1
prev=O90
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
''saldopex_scarti'
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/saldopex_scarti.zip"
]
I
obj='Exec
pag=1
prev=O89
I
obj='Exec
pag=1
prev=O88
I
obj='Var
pag=1
prev=O87
var_op='asgn
I
obj='Var
pag=1
prev=O86
var_op='asgn
I
obj='Var
pag=1
prev=O85
var_op='asgn
I
obj='Var
pag=1
prev=O84
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=1
prev=O71
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O74
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/opex_scarti')
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O74
fatherSonIndex=1
frm_calc='2
len=1
name='_chkerr
next=Icpitembatch.CPVarDecl
frm_calc='"opex_scarti.zip"
len=20
name='_czip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/"+_czip
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/opex_scarti"
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='"opex_scarti"
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc='// These are the files to include in the ZIP file﷯filenames.clear();﷯fileonames.clear();﷯filenames.add(cNomeFile);﷯fileonames.add(cOnlyNomeFile);
next=Icpitembatch.CPExec
check='page
frm_calc='36
next=Icpitembatch.CPInsert
arch='tmp_listafile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevate operazioni extraconto senza i dati del soggetto. Prelevare il file opex_scarti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/opex_scarti')
obj='Exec
pag=1
prev=O109
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O108
var_op='asgn
I
obj='Insert
pag=1
prev=O107
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
''opex_scarti'
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/opex_scarti.zip"
]
I
obj='Exec
pag=1
prev=O106
I
obj='Exec
pag=1
prev=O105
I
obj='Var
pag=1
prev=O104
var_op='asgn
I
obj='Var
pag=1
prev=O103
var_op='asgn
I
obj='Var
pag=1
prev=O102
var_op='asgn
I
obj='Var
pag=1
prev=O101
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=1
prev=O68
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O71
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/archfraz_scarti')
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O71
fatherSonIndex=1
frm_calc='2
len=1
name='_chkerr
next=Icpitembatch.CPVarDecl
frm_calc='"archfraz_scarti.zip"
len=20
name='_czip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/"+_czip
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/archfraz_scarti"
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='"archfraz_scarti"
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc='// These are the files to include in the ZIP file﷯filenames.clear();﷯fileonames.clear();﷯filenames.add(cNomeFile);﷯fileonames.add(cOnlyNomeFile);
next=Icpitembatch.CPExec
check='page
frm_calc='36
next=Icpitembatch.CPInsert
arch='tmp_listafile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevate frazionate senza i dati del soggetto. Prelevare il file archfraz_scarti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/archfraz_scarti')
obj='Exec
pag=1
prev=O126
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O125
var_op='asgn
I
obj='Insert
pag=1
prev=O124
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
''archfraz_scarti'
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/archfraz_scarti.zip"
]
I
obj='Exec
pag=1
prev=O123
I
obj='Exec
pag=1
prev=O122
I
obj='Var
pag=1
prev=O121
var_op='asgn
I
obj='Var
pag=1
prev=O120
var_op='asgn
I
obj='Var
pag=1
prev=O119
var_op='asgn
I
obj='Var
pag=1
prev=O118
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=1
prev=O67
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O68
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/archope_scarti')
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O68
fatherSonIndex=1
frm_calc='2
len=1
name='_chkerr
next=Icpitembatch.CPVarDecl
frm_calc='"archope_scarti.zip"
len=20
name='_czip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/"+_czip
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/archope_scarti"
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='"archope_scarti"
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc='// These are the files to include in the ZIP file﷯filenames.clear();﷯fileonames.clear();﷯filenames.add(cNomeFile);﷯fileonames.add(cOnlyNomeFile);
next=Icpitembatch.CPExec
check='page
frm_calc='36
next=Icpitembatch.CPInsert
arch='tmp_listafile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevate operazioni senza i dati del soggetto. Prelevare il file archope_scarti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/archope_scarti')
obj='Exec
pag=1
prev=O143
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O142
var_op='asgn
I
obj='Insert
pag=1
prev=O141
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
''archope_scarti'
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/archope_scarti.zip"
]
I
obj='Exec
pag=1
prev=O140
I
obj='Exec
pag=1
prev=O139
I
obj='Var
pag=1
prev=O138
var_op='asgn
I
obj='Var
pag=1
prev=O137
var_op='asgn
I
obj='Var
pag=1
prev=O136
var_op='asgn
I
obj='Var
pag=1
prev=O135
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=1
prev=O66
I
obj='Exec
pag=1
prev=O65
I
obj='Exec
pag=1
prev=O64
I
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O55
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O56
fatherSonIndex=0
frm_calc='commit
obj='Transaction
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O56
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=1
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O53
var_op='asgn
I
obj='Select
pag=1
prev=O50
sel_field='*
sel_name='tmp_list_imprich
sel_order='tmp_list_imprich->priorita,tmp_list_imprich->nomefile
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O53
fatherSonIndex=0
frm_calc=[
'_esito = 0
]
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='tmp_list_imprich
obj='Delete
pag=1
prev=O157
rd_kfield=[
'nomefile
]
rd_kop=[
'=
]
rd_kvar=[
'tmp_list_imprich->nomefile
]
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O157
fatherSonIndex=0
frm_calc='LRTrim(tmp_list_imprich->nomefile)
len=50
name='nomefileimport
next=Icpitembatch.CPCase
frm_calc=[
'At('archpers.txt',Lower(nomefileimport)) <> 0
'At('archdip.txt',Lower(nomefileimport)) <> 0
'At('archtito.txt',Lower(nomefileimport)) <> 0
'At('sogcli.txt',Lower(nomefileimport)) <> 0
'At('archrap.txt',Lower(nomefileimport)) <> 0
'At('archinf.txt',Lower(nomefileimport)) <> 0
'At('archope.txt',Lower(nomefileimport)) <> 0
'At('archfraz.txt',Lower(nomefileimport)) <> 0
'At('intest.txt',Lower(nomefileimport)) <> 0
'At('rapage.txt',Lower(nomefileimport)) <> 0
'At('infage.txt',Lower(nomefileimport)) <> 0
'At('opeage.txt',Lower(nomefileimport)) <> 0
'At('procdel.txt',Lower(nomefileimport)) <> 0
'At('procage.txt',Lower(nomefileimport)) <> 0
'At('sogope.txt',Lower(nomefileimport)) <> 0
'At('sogage.txt',Lower(nomefileimport)) <> 0
'At('intage.txt',Lower(nomefileimport)) <> 0
'At('sogben.txt',Lower(nomefileimport)) <> 0
'At('sogaltro.txt',Lower(nomefileimport)) <> 0
'At('persnew.txt',Lower(nomefileimport)) <> 0
'At('saldopex.txt',Lower(nomefileimport)) <> 0 or At('saldopex.xls',Lower(nomefileimport)) <> 0
'At('saldrapp.txt',Lower(nomefileimport)) <> 0 or At('saldrapp.xls',Lower(nomefileimport)) <> 0
'At('opex.txt',Lower(nomefileimport)) <> 0
'At('titosupp.txt',Lower(nomefileimport)) <> 0
'At('archope.xls',Lower(nomefileimport)) <> 0
'At('agetit.txt',Lower(nomefileimport)) <> 0
'At('agetsupp.txt',Lower(nomefileimport)) <> 0
'At('saldisv.txt',Lower(nomefileimport)) <> 0
]
h=[
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
]
obj='Case
pag=1
prev=O166
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O167
fatherSonIndex=0
frm_calc='2
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O167
fatherSonIndex=1
frm_calc='14
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O167
fatherSonIndex=2
frm_calc='15
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O167
fatherSonIndex=3
frm_calc='26
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O167
fatherSonIndex=4
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O180
fatherSonIndex=0
frm_calc='7
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O180
fatherSonIndex=1
frm_calc='3
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O167
fatherSonIndex=5
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=0
frm_calc='8
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O190
fatherSonIndex=1
frm_calc='4
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O167
fatherSonIndex=6
frm_calc=[
'w_flgimposv='S'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O200
fatherSonIndex=0
frm_calc='31
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O200
fatherSonIndex=1
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O207
fatherSonIndex=0
frm_calc='9
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O207
fatherSonIndex=1
frm_calc='5
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O167
fatherSonIndex=7
frm_calc=[
'w_flgimposv='S'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O218
fatherSonIndex=0
frm_calc='31
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O218
fatherSonIndex=1
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O225
fatherSonIndex=0
frm_calc='10
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O225
fatherSonIndex=1
frm_calc='6
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O167
fatherSonIndex=8
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O236
fatherSonIndex=0
frm_calc='22
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O236
fatherSonIndex=1
frm_calc='19
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O167
fatherSonIndex=9
frm_calc='11
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O167
fatherSonIndex=10
frm_calc='12
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O167
fatherSonIndex=11
frm_calc='13
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O167
fatherSonIndex=12
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O252
fatherSonIndex=0
frm_calc='20
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O252
fatherSonIndex=1
frm_calc='17
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O167
fatherSonIndex=13
frm_calc='23
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O167
fatherSonIndex=14
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O264
fatherSonIndex=0
frm_calc='21
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O264
fatherSonIndex=1
frm_calc='18
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O167
fatherSonIndex=15
frm_calc='24
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O167
fatherSonIndex=16
frm_calc='25
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O167
fatherSonIndex=17
frm_calc='28
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O167
fatherSonIndex=18
frm_calc='29
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O167
fatherSonIndex=19
frm_calc='30
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O167
fatherSonIndex=20
frm_calc='33
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O167
fatherSonIndex=21
frm_calc='34
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O167
fatherSonIndex=22
frm_calc='16
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O167
fatherSonIndex=23
frm_calc='35
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O167
fatherSonIndex=24
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O292
fatherSonIndex=0
frm_calc='38
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O292
fatherSonIndex=1
frm_calc='37
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O167
fatherSonIndex=25
frm_calc='40
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O167
fatherSonIndex=26
frm_calc='41
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O167
fatherSonIndex=27
frm_calc='42
obj='Exec
pag=1
I
I
]
w=[
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
]
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intermbo
father=O50
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='xersonbo
next=Icpitembatch.CPDelete
arch='xarchope
next=Icpitembatch.CPDelete
arch='xarchfraz
next=Icpitembatch.CPDelete
arch='xnadip
obj='Delete
pag=1
prev=O315
sel_type='all
I
obj='Delete
pag=1
prev=O314
sel_type='all
I
obj='Delete
pag=1
prev=O313
sel_type='all
I
obj='Delete
pag=1
prev=O312
sel_type='all
I
obj='Write
pag=1
sel_type='all
wr_field=[
'SBLRITORNO
]
wr_op=[
'=
]
wr_var=[
''N'
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O46
fatherSonIndex=1
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Rilevati errori nell'impotazione dei file! Ricreare il file segnalato e rieseguire l'import dei dati. La procedura annullera automaticamente l'importazione" + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Errore SQL: ' + m_Sql.TransactionErrorMessage() + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='rollback
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(ohand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(zhand)
obj='Exec
pag=1
prev=O326
I
obj='Exec
pag=1
prev=O325
I
obj='Transaction
pag=1
prev=O324
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O323
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O322
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=1
prev=O44
I
obj='Var
pag=1
prev=O43
var_op='asgn
I
obj='Var
pag=1
prev=O42
var_op='asgn
I
obj='Var
pag=1
prev=O41
var_op='asgn
I
obj='Var
pag=1
prev=O40
var_op='asgn
I
obj='TempTable
pag=1
prev=O39
sel_type='def
server_table='tmp_listafile
I
obj='DropTempTable
pag=1
server_table='tmp_listafile
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O33
fatherSonIndex=1
frm_calc='gMsgProc + 'Sono state rilevati errori nei dati anagrafici. Effettuare la stampa' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Elaborazione terminata.'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=1
prev=O330
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=1
prev=O29
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O30
fatherSonIndex=0
frm_calc='32
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O28
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O27
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O26
var_op='asgn
I
obj='Exec
pag=1
prev=O25
I
obj='Var
obj_type='N
pag=1
prev=O23
var_op='asgn
I
obj='Select
pag=1
prev=O22
sel_field='*
sel_name='tmp_list_imprich
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O23
fatherSonIndex=0
frm_calc=[
'At('.zip',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O339
fatherSonIndex=0
frm_calc='LRTrim(tmp_list_imprich->nomefile)
len=100
name='czipfile
next=Icpitembatch.CPExec
check='page
frm_calc='39
obj='Exec
pag=1
prev=O344
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=1
prev=O21
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O20
var_op='asgn
I
obj='Remark
pag=1
prev=O18
I
obj='Select
pag=1
prev=O17
sel_field='*
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O18
fatherSonIndex=0
frm_calc='intermbo->CODINTER
len=11
name='_codinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->DESCCIT
len=30
name='_citinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->CODCAB
len=6
name='_cabinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->PROVINCIA
len=2
name='_prvinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->FLGOPEXTR
len=1
name='_flgmodi
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->FLGDATAIM
len=1
name='_flgdataim
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->FLGRAPCLI
len=1
name='_frapcli
obj='Var
pag=1
prev=O355
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O354
var_op='asgn
I
obj='Var
pag=1
prev=O353
var_op='asgn
I
obj='Var
pag=1
prev=O352
var_op='asgn
I
obj='Var
pag=1
prev=O351
var_op='asgn
I
obj='Var
pag=1
prev=O350
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=1
prev=O15
I
obj='Begin
pag=1
prev=O13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Path Applicazione
father=O15
fatherSonIndex=0
global=True
len=80
name='gPathApp
next=Icpitembatch.CPVarDecl
comment='Azienda
global=True
len=10
name='gAzienda
next=Icpitembatch.CPVarDecl
comment='URL Applicazione
global=True
len=80
name='gUrlApp
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='Messaggio
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Flag Creazione File di Ritorno
global=True
len=1
name='gFlgRet
next=Icpitembatch.CPVarDecl
comment='Tipo Intermediario
global=True
len=2
name='gTipInter
next=Icpitembatch.CPVarDecl
comment='Path Documenti
global=True
len=128
name='gPathDoc
nonlocal=True
obj='Var
pag=1
prev=O366
I
nonlocal=True
obj='Var
pag=1
prev=O365
I
nonlocal=True
obj='Var
pag=1
prev=O364
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O363
I
nonlocal=True
obj='Var
pag=1
prev=O362
I
nonlocal=True
obj='Var
pag=1
prev=O361
I
nonlocal=True
obj='Var
pag=1
prev=O360
I
nonlocal=True
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O11
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O13
fatherSonIndex=0
len=25
name='column01
next=Icpitembatch.CPVarDecl
len=25
name='column02
next=Icpitembatch.CPVarDecl
len=25
name='column03
next=Icpitembatch.CPVarDecl
len=25
name='column04
next=Icpitembatch.CPVarDecl
len=25
name='column05
next=Icpitembatch.CPVarDecl
len=25
name='column06
next=Icpitembatch.CPVarDecl
len=25
name='column07
next=Icpitembatch.CPVarDecl
len=25
name='column08
next=Icpitembatch.CPVarDecl
len=25
name='column09
next=Icpitembatch.CPVarDecl
len=25
name='column10
next=Icpitembatch.CPVarDecl
len=25
name='column11
next=Icpitembatch.CPVarDecl
len=25
name='column12
next=Icpitembatch.CPVarDecl
len=25
name='column13
next=Icpitembatch.CPVarDecl
len=25
name='column14
next=Icpitembatch.CPVarDecl
len=25
name='column15
next=Icpitembatch.CPVarDecl
len=25
name='column16
next=Icpitembatch.CPVarDecl
len=25
name='column17
next=Icpitembatch.CPVarDecl
len=25
name='column18
next=Icpitembatch.CPVarDecl
len=25
name='column19
next=Icpitembatch.CPVarDecl
len=25
name='column20
next=Icpitembatch.CPVarDecl
len=25
name='column21
next=Icpitembatch.CPVarDecl
len=25
name='column22
next=Icpitembatch.CPVarDecl
len=25
name='column23
next=Icpitembatch.CPVarDecl
len=25
name='column24
next=Icpitembatch.CPVarDecl
len=25
name='column25
next=Icpitembatch.CPVarDecl
len=25
name='column26
next=Icpitembatch.CPVarDecl
len=25
name='column27
next=Icpitembatch.CPVarDecl
len=25
name='column28
next=Icpitembatch.CPVarDecl
len=25
name='column29
next=Icpitembatch.CPVarDecl
len=25
name='column30
next=Icpitembatch.CPVarDecl
len=25
name='column31
next=Icpitembatch.CPVarDecl
len=25
name='column32
next=Icpitembatch.CPVarDecl
len=25
name='column33
next=Icpitembatch.CPVarDecl
len=25
name='column34
next=Icpitembatch.CPVarDecl
len=25
name='column35
next=Icpitembatch.CPVarDecl
len=25
name='column36
next=Icpitembatch.CPVarDecl
len=25
name='column37
next=Icpitembatch.CPVarDecl
len=25
name='column38
next=Icpitembatch.CPVarDecl
len=25
name='column39
next=Icpitembatch.CPVarDecl
len=25
name='column40
next=Icpitembatch.CPVarDecl
len=25
name='column41
next=Icpitembatch.CPVarDecl
len=25
name='column42
next=Icpitembatch.CPVarDecl
len=25
name='column43
next=Icpitembatch.CPVarDecl
len=25
name='column44
next=Icpitembatch.CPVarDecl
len=25
name='column45
next=Icpitembatch.CPVarDecl
len=25
name='column46
next=Icpitembatch.CPVarDecl
len=25
name='column47
next=Icpitembatch.CPVarDecl
len=25
name='column48
next=Icpitembatch.CPVarDecl
len=25
name='column49
next=Icpitembatch.CPVarDecl
len=25
name='column50
next=Icpitembatch.CPVarDecl
len=25
name='column51
next=Icpitembatch.CPVarDecl
len=25
name='column52
next=Icpitembatch.CPVarDecl
len=25
name='column53
next=Icpitembatch.CPVarDecl
len=25
name='column54
next=Icpitembatch.CPVarDecl
len=25
name='column55
next=Icpitembatch.CPVarDecl
len=25
name='column56
next=Icpitembatch.CPVarDecl
len=25
name='column57
next=Icpitembatch.CPVarDecl
len=25
name='column58
next=Icpitembatch.CPVarDecl
len=25
name='column59
next=Icpitembatch.CPVarDecl
len=25
name='column60
next=Icpitembatch.CPVarDecl
len=25
name='column61
next=Icpitembatch.CPVarDecl
len=25
name='column62
next=Icpitembatch.CPVarDecl
len=25
name='column63
next=Icpitembatch.CPVarDecl
len=25
name='column64
next=Icpitembatch.CPVarDecl
len=25
name='column65
next=Icpitembatch.CPVarDecl
len=25
name='column66
next=Icpitembatch.CPVarDecl
len=25
name='column67
obj='Var
pag=1
prev=O436
I
obj='Var
pag=1
prev=O435
I
obj='Var
pag=1
prev=O434
I
obj='Var
pag=1
prev=O433
I
obj='Var
pag=1
prev=O432
I
obj='Var
pag=1
prev=O431
I
obj='Var
pag=1
prev=O430
I
obj='Var
pag=1
prev=O429
I
obj='Var
pag=1
prev=O428
I
obj='Var
pag=1
prev=O427
I
obj='Var
pag=1
prev=O426
I
obj='Var
pag=1
prev=O425
I
obj='Var
pag=1
prev=O424
I
obj='Var
pag=1
prev=O423
I
obj='Var
pag=1
prev=O422
I
obj='Var
pag=1
prev=O421
I
obj='Var
pag=1
prev=O420
I
obj='Var
pag=1
prev=O419
I
obj='Var
pag=1
prev=O418
I
obj='Var
pag=1
prev=O417
I
obj='Var
pag=1
prev=O416
I
obj='Var
pag=1
prev=O415
I
obj='Var
pag=1
prev=O414
I
obj='Var
pag=1
prev=O413
I
obj='Var
pag=1
prev=O412
I
obj='Var
pag=1
prev=O411
I
obj='Var
pag=1
prev=O410
I
obj='Var
pag=1
prev=O409
I
obj='Var
pag=1
prev=O408
I
obj='Var
pag=1
prev=O407
I
obj='Var
pag=1
prev=O406
I
obj='Var
pag=1
prev=O405
I
obj='Var
pag=1
prev=O404
I
obj='Var
pag=1
prev=O403
I
obj='Var
pag=1
prev=O402
I
obj='Var
pag=1
prev=O401
I
obj='Var
pag=1
prev=O400
I
obj='Var
pag=1
prev=O399
I
obj='Var
pag=1
prev=O398
I
obj='Var
pag=1
prev=O397
I
obj='Var
pag=1
prev=O396
I
obj='Var
pag=1
prev=O395
I
obj='Var
pag=1
prev=O394
I
obj='Var
pag=1
prev=O393
I
obj='Var
pag=1
prev=O392
I
obj='Var
pag=1
prev=O391
I
obj='Var
pag=1
prev=O390
I
obj='Var
pag=1
prev=O389
I
obj='Var
pag=1
prev=O388
I
obj='Var
pag=1
prev=O387
I
obj='Var
pag=1
prev=O386
I
obj='Var
pag=1
prev=O385
I
obj='Var
pag=1
prev=O384
I
obj='Var
pag=1
prev=O383
I
obj='Var
pag=1
prev=O382
I
obj='Var
pag=1
prev=O381
I
obj='Var
pag=1
prev=O380
I
obj='Var
pag=1
prev=O379
I
obj='Var
pag=1
prev=O378
I
obj='Var
pag=1
prev=O377
I
obj='Var
pag=1
prev=O376
I
obj='Var
pag=1
prev=O375
I
obj='Var
pag=1
prev=O374
I
obj='Var
pag=1
prev=O373
I
obj='Var
pag=1
prev=O372
I
obj='Var
pag=1
prev=O371
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O11
fatherSonIndex=0
len=100
name='czipfile
next=Icpitembatch.CPVarDecl
len=200
name='cpercorsozip
next=Icpitembatch.CPVarDecl
len=200
name='cdirectoryfile
next=Icpitembatch.CPVarDecl
len=100
name='buffernomefile
next=Icpitembatch.CPVarDecl
len=50
name='nomefileimport
next=Icpitembatch.CPVarDecl
len=3
name='_priorita
obj='Var
obj_type='N
pag=1
prev=O445
I
obj='Var
pag=1
prev=O444
I
obj='Var
pag=1
prev=O443
I
obj='Var
pag=1
prev=O442
I
obj='Var
pag=1
prev=O441
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O7
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O9
fatherSonIndex=0
len=10
name='ciidbase
next=Icpitembatch.CPVarDecl
len=8
name='cidataini
next=Icpitembatch.CPVarDecl
len=8
name='cidatafine
next=Icpitembatch.CPVarDecl
len=12
name='cicodinter
next=Icpitembatch.CPVarDecl
len=11
name='cinumprog
next=Icpitembatch.CPVarDecl
len=1
name='citiporap
obj='Var
pag=1
prev=O454
I
obj='Var
pag=1
prev=O453
I
obj='Var
pag=1
prev=O452
I
obj='Var
obj_type='D
pag=1
prev=O451
I
obj='Var
obj_type='D
pag=1
prev=O450
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O5
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O7
fatherSonIndex=0
len=10
name='_z
next=Icpitembatch.CPVarDecl
len=1
name='fhand
next=Icpitembatch.CPVarDecl
len=1
name='ohand
next=Icpitembatch.CPVarDecl
len=1
name='zhand
next=Icpitembatch.CPVarDecl
len=1
name='xhand
next=Icpitembatch.CPVarDecl
len=1
name='shand
next=Icpitembatch.CPVarDecl
len=10
name='riga
next=Icpitembatch.CPVarDecl
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
len=1
name='_tdest
next=Icpitembatch.CPVarDecl
len=16
name='xCF
next=Icpitembatch.CPVarDecl
len=16
name='xSOCTCon
next=Icpitembatch.CPVarDecl
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
len=30
name='xCitta
next=Icpitembatch.CPVarDecl
len=6
name='cCliProg
next=Icpitembatch.CPVarDecl
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
len=1
name='xSesso
next=Icpitembatch.CPVarDecl
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
len=6
name='xCAB
next=Icpitembatch.CPVarDecl
len=2
name='xPrv
next=Icpitembatch.CPVarDecl
len=6
name='xDIP
next=Icpitembatch.CPVarDecl
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
len=8
name='xData
next=Icpitembatch.CPVarDecl
len=8
name='xDatF
next=Icpitembatch.CPVarDecl
comment='Contatore record nuovi
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
comment='Contatore record aggiornati
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
comment='Contatore record invariati
len=10
name='cNumInv
next=Icpitembatch.CPVarDecl
len=1
name='cFlagLire
next=Icpitembatch.CPVarDecl
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
len=1
name='xCFE
next=Icpitembatch.CPVarDecl
len=10
name='conta
next=Icpitembatch.CPVarDecl
len=1
name='_esito
next=Icpitembatch.CPVarDecl
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
len=1
name='_salta
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
len=10
name='nProgSto
next=Icpitembatch.CPVarDecl
len=10
name='_idbase
next=Icpitembatch.CPVarDecl
len=11
name='_codinter
next=Icpitembatch.CPVarDecl
len=30
name='_citinter
next=Icpitembatch.CPVarDecl
len=6
name='_cabinter
next=Icpitembatch.CPVarDecl
len=2
name='_prvinter
next=Icpitembatch.CPVarDecl
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
len=2
name='_interprv
next=Icpitembatch.CPVarDecl
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
len=35
name='_benind
next=Icpitembatch.CPVarDecl
len=5
name='_bencap
next=Icpitembatch.CPVarDecl
len=1
name='_flgmodi
next=Icpitembatch.CPVarDecl
len=16
name='_conadd
next=Icpitembatch.CPVarDecl
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
len=8
name='_datvarage
next=Icpitembatch.CPVarDecl
len=1
name='_flgdataim
next=Icpitembatch.CPVarDecl
len=1
name='_chkerr
next=Icpitembatch.CPVarDecl
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
len=8
name='_datarett
next=Icpitembatch.CPVarDecl
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
len=1
name='_opeerr
next=Icpitembatch.CPVarDecl
len=1
name='_frzerr
next=Icpitembatch.CPVarDecl
len=1
name='_opxerr
next=Icpitembatch.CPVarDecl
len=1
name='_soxerr
next=Icpitembatch.CPVarDecl
len=11
name='_numprog
next=Icpitembatch.CPVarDecl
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
len=1
name='_frapcli
next=Icpitembatch.CPVarDecl
len=1
name='_tiporap
next=Icpitembatch.CPVarDecl
len=20
name='_czip
next=Icpitembatch.CPVarDecl
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPVarDecl
len=30
name='_file1
next=Icpitembatch.CPVarDecl
len=30
name='_file2
next=Icpitembatch.CPVarDecl
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
len=1
name='_oldest
next=Icpitembatch.CPVarDecl
len=1
name='_newest
next=Icpitembatch.CPVarDecl
len=10
name='_idb2
next=Icpitembatch.CPVarDecl
len=15
name='_totin
next=Icpitembatch.CPVarDecl
len=15
name='_totout
next=Icpitembatch.CPVarDecl
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
len=50
name='_icrag
next=Icpitembatch.CPVarDecl
frm_seek='mcConnes.MCRDef
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_seek='mcConnes.MCRDef
name='rowSoggetti
next=Icpitembatch.CPVarDecl
len=1
name='_flgvali
next=Icpitembatch.CPVarDecl
len=1
name='_flganag
next=Icpitembatch.CPVarDecl
len=16
name='_oldcf
next=Icpitembatch.CPVarDecl
len=26
name='_oldcog
next=Icpitembatch.CPVarDecl
len=26
name='_oldnom
next=Icpitembatch.CPVarDecl
len=70
name='_oldrgs
next=Icpitembatch.CPVarDecl
len=30
name='_oldncm
next=Icpitembatch.CPVarDecl
len=30
name='_oldnst
next=Icpitembatch.CPVarDecl
len=8
name='_oldndt
next=Icpitembatch.CPVarDecl
len=2
name='_oldnpv
next=Icpitembatch.CPVarDecl
len=1
name='_oldnsx
next=Icpitembatch.CPVarDecl
len=1
name='_oldncf
next=Icpitembatch.CPVarDecl
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
len=10
name='cNewProg
next=Icpitembatch.CPVarDecl
len=2
name='_tipooprap
next=Icpitembatch.CPVarDecl
len=8
name='_oldreg
obj='Var
obj_type='D
pag=1
prev=O585
I
obj='Var
pag=1
prev=O584
I
obj='Var
pag=1
prev=O583
I
obj='Var
obj_type='M
pag=1
prev=O582
I
obj='Var
obj_type='M
pag=1
prev=O581
I
obj='Var
obj_type='M
pag=1
prev=O580
I
obj='Var
obj_type='M
pag=1
prev=O579
I
obj='Var
obj_type='M
pag=1
prev=O578
I
obj='Var
obj_type='M
pag=1
prev=O577
I
obj='Var
pag=1
prev=O576
I
obj='Var
obj_type='N
pag=1
prev=O575
I
obj='Var
pag=1
prev=O574
I
obj='Var
pag=1
prev=O573
I
obj='Var
obj_type='D
pag=1
prev=O572
I
obj='Var
pag=1
prev=O571
I
obj='Var
pag=1
prev=O570
I
obj='Var
pag=1
prev=O569
I
obj='Var
pag=1
prev=O568
I
obj='Var
pag=1
prev=O567
I
obj='Var
pag=1
prev=O566
I
obj='Var
pag=1
prev=O565
I
obj='Var
pag=1
prev=O564
I
obj='Var
obj_type='R
pag=1
prev=O563
I
obj='Var
obj_type='MC
pag=1
prev=O562
I
obj='Var
pag=1
prev=O561
I
obj='Var
pag=1
prev=O560
I
obj='Var
pag=1
prev=O559
I
obj='Var
pag=1
prev=O558
I
obj='Var
pag=1
prev=O557
I
obj='Var
obj_type='N
pag=1
prev=O556
I
obj='Var
obj_type='N
pag=1
prev=O555
I
obj='Var
pag=1
prev=O554
I
obj='Var
obj_type='N
pag=1
prev=O553
I
obj='Var
obj_type='N
pag=1
prev=O552
I
obj='Var
pag=1
prev=O551
I
obj='Var
pag=1
prev=O550
I
obj='Var
pag=1
prev=O549
I
obj='Var
pag=1
prev=O548
I
obj='Var
pag=1
prev=O547
I
obj='Var
pag=1
prev=O546
I
obj='Var
pag=1
prev=O545
I
obj='Var
pag=1
prev=O544
I
obj='Var
pag=1
prev=O543
I
obj='Var
pag=1
prev=O542
I
obj='Var
pag=1
prev=O541
I
obj='Var
obj_type='N
pag=1
prev=O540
I
obj='Var
obj_type='N
pag=1
prev=O539
I
obj='Var
obj_type='N
pag=1
prev=O538
I
obj='Var
obj_type='N
pag=1
prev=O537
I
obj='Var
obj_type='N
pag=1
prev=O536
I
obj='Var
pag=1
prev=O535
I
obj='Var
pag=1
prev=O534
I
obj='Var
obj_type='D
pag=1
prev=O533
I
obj='Var
pag=1
prev=O532
I
obj='Var
pag=1
prev=O531
I
obj='Var
pag=1
prev=O530
I
obj='Var
pag=1
prev=O529
I
obj='Var
obj_type='N
pag=1
prev=O528
I
obj='Var
obj_type='N
pag=1
prev=O527
I
obj='Var
obj_type='D
pag=1
prev=O526
I
obj='Var
obj_type='D
pag=1
prev=O525
I
obj='Var
obj_type='D
pag=1
prev=O524
I
obj='Var
pag=1
prev=O523
I
obj='Var
pag=1
prev=O522
I
obj='Var
pag=1
prev=O521
I
obj='Var
pag=1
prev=O520
I
obj='Var
pag=1
prev=O519
I
obj='Var
pag=1
prev=O518
I
obj='Var
pag=1
prev=O517
I
obj='Var
pag=1
prev=O516
I
obj='Var
pag=1
prev=O515
I
obj='Var
pag=1
prev=O514
I
obj='Var
pag=1
prev=O513
I
obj='Var
pag=1
prev=O512
I
obj='Var
pag=1
prev=O511
I
obj='Var
pag=1
prev=O510
I
obj='Var
pag=1
prev=O509
I
obj='Var
pag=1
prev=O508
I
obj='Var
pag=1
prev=O507
I
obj='Var
pag=1
prev=O506
I
obj='Var
pag=1
prev=O505
I
obj='Var
obj_type='N
pag=1
prev=O504
I
obj='Var
obj_type='N
pag=1
prev=O503
I
obj='Var
obj_type='N
pag=1
prev=O502
I
obj='Var
obj_type='N
pag=1
prev=O501
I
obj='Var
pag=1
prev=O500
I
obj='Var
pag=1
prev=O499
I
obj='Var
pag=1
prev=O498
I
obj='Var
obj_type='N
pag=1
prev=O497
I
obj='Var
obj_type='N
pag=1
prev=O496
I
obj='Var
obj_type='N
pag=1
prev=O495
I
obj='Var
pag=1
prev=O494
I
obj='Var
obj_type='N
pag=1
prev=O493
I
obj='Var
pag=1
prev=O492
I
obj='Var
pag=1
prev=O491
I
obj='Var
pag=1
prev=O490
I
obj='Var
obj_type='N
pag=1
prev=O489
I
obj='Var
obj_type='N
pag=1
prev=O488
I
obj='Var
obj_type='N
pag=1
prev=O487
I
obj='Var
pag=1
prev=O486
I
obj='Var
pag=1
prev=O485
I
obj='Var
pag=1
prev=O484
I
obj='Var
pag=1
prev=O483
I
obj='Var
pag=1
prev=O482
I
obj='Var
pag=1
prev=O481
I
obj='Var
pag=1
prev=O480
I
obj='Var
pag=1
prev=O479
I
obj='Var
pag=1
prev=O478
I
obj='Var
pag=1
prev=O477
I
obj='Var
pag=1
prev=O476
I
obj='Var
pag=1
prev=O475
I
obj='Var
pag=1
prev=O474
I
obj='Var
pag=1
prev=O473
I
obj='Var
pag=1
prev=O472
I
obj='Var
pag=1
prev=O471
I
obj='Var
pag=1
prev=O470
I
obj='Var
pag=1
prev=O469
I
obj='Var
pag=1
prev=O468
I
obj='Var
pag=1
prev=O467
I
obj='Var
pag=1
prev=O466
I
obj='Var
pag=1
prev=O465
I
obj='Var
obj_type='M
pag=1
prev=O464
I
obj='Var
pag=1
prev=O463
I
obj='Var
pag=1
prev=O462
I
obj='Var
pag=1
prev=O461
I
obj='Var
pag=1
prev=O460
I
obj='Var
pag=1
prev=O459
I
obj='Var
obj_type='N
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5
fatherSonIndex=0
frm_seek='tbcitta
name='mcTBCITTA
next=Icpitembatch.CPVarDecl
frm_seek='personbo
name='mcPersonbo
next=Icpitembatch.CPVarDecl
frm_seek='personbo
name='rowPersonbo
obj='Var
obj_type='R
pag=1
prev=O591
I
obj='Var
obj_type='MC
pag=1
prev=O590
I
obj='Var
obj_type='MC
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3
fatherSonIndex=0
len=1
name='w_tipodest
next=Icpitembatch.CPVarDecl
len=1
name='w_chkaui
next=Icpitembatch.CPVarDecl
len=1
name='w_imperr
next=Icpitembatch.CPVarDecl
len=1
name='w_flgaggfam
next=Icpitembatch.CPVarDecl
len=1
name='w_flgimposv
next=Icpitembatch.CPVarDecl
len=1
name='w_creamo
next=Icpitembatch.CPVarDecl
len=1
name='w_norifimp
next=Icpitembatch.CPVarDecl
len=1
name='w_flgforzaagg
obj='Var
pag=1
param=True
prev=O602
I
obj='Var
pag=1
param=True
prev=O601
I
obj='Var
pag=1
param=True
prev=O600
I
obj='Var
pag=1
param=True
prev=O599
I
obj='Var
pag=1
param=True
prev=O598
I
obj='Var
pag=1
param=True
prev=O597
I
obj='Var
pag=1
param=True
prev=O596
I
obj='Var
pag=1
param=True
I
I
]
w=[
150
150
]
x=13
y=16
I
Icpitembatch.CPIfElse
frm_calc=[
'mcSoggetti.RecCount() > 0
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O605
fatherSonIndex=0
frm_calc='FileLibMit.OpenWrite('./output/'+LRTrim(gAzienda)+'/ndg_sovrascritti')
len=1
name='fhand
next=Icpitembatch.CPForEach
for_variable='rowSoggetti
for_variable_type='mcConnes.MCRDef
h=[
19
19
]
iterator_expr='mcSoggetti
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='2
len=1
name='_chkerr
next=Icpitembatch.CPVarDecl
frm_calc='"ndg_sovrascritti.zip"
len=20
name='_czip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/"+_czip
len=30
name='cNomeFileZip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+'/output/'+LRTrim(gAzienda)+"/ndg_sovrascritti"
len=30
name='cNomeFile
next=Icpitembatch.CPVarDecl
frm_calc='"ndg_sovrascritti"
len=30
name='cOnlyNomeFile
next=Icpitembatch.CPExec
check='man
frm_calc='// These are the files to include in the ZIP file﷯filenames.clear();﷯fileonames.clear();﷯filenames.add(cNomeFile);﷯fileonames.add(cOnlyNomeFile);
next=Icpitembatch.CPExec
check='page
frm_calc='36
next=Icpitembatch.CPInsert
arch='tmp_listafile
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Sono state rilevati soggetti che hanno sovrascritto anagrafiche esistenti. Prelevare il file ndg_sovrascritti' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./output/'+LRTrim(gAzienda)+'/opex_scarti')
obj='Exec
pag=1
prev=O622
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O621
var_op='asgn
I
obj='Insert
pag=1
prev=O620
rd_kfield=[
'nomefile
'hyperlynk
]
rd_kvar=[
''ndg_sovraSCRITTI'
'LRTrim(gUrlApp)+"output/"+LRTrim(gAzienda)+"/ndg_sovrascritti.zip"
]
I
obj='Exec
pag=1
prev=O619
I
obj='Exec
pag=1
prev=O618
I
obj='Var
pag=1
prev=O617
var_op='asgn
I
obj='Var
pag=1
prev=O616
var_op='asgn
I
obj='Var
pag=1
prev=O615
var_op='asgn
I
obj='Var
pag=1
prev=O614
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O613
var_op='asgn
I
obj='Exec
pag=1
prev=O611
I
obj='ForEach
pag=1
prev=O610
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O611
fatherSonIndex=0
frm_calc='FileLibMit.WriteLine(fhand,rowSoggetti.connes)
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
x=1190
y=7126
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumInv
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='nProgSto
next=Icpitembatch.CPVarDecl
frm_calc='0
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Ispitembatch.CPMemoryCursor
data_source='tbcitta
expected_rows=10000
key_expression='tbcitta->CITTA
mem_curs_name='mcTBCITTA
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'nProgImp > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'nProgSto > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Soggetti Nuovi: '+LRTrim(Str(cNumNew,10,0)) + ' - Soggetti Modificati: '+LRTrim(Str(cNumMod,10,0)) + ' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','ARCHPERS','Soggetti Corretti: '+LRTrim(Str(cNumNew,10,0)) + ' - Soggetti Errati: '+LRTrim(Str(cNumMod,10,0)))
obj='Exec
pag=2
prev=O656
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O655
var_op='asgn
I
obj='Exec
pag=2
prev=O654
I
obj='Exec
pag=2
prev=O653
I
obj='Exec
pag=2
prev=O652
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O651
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O648
var_op='asgn
I
obj='If
pag=2
prev=O645
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O648
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'm_nUpdatedRows=0
]
h=[
19
19
]
obj='If
pag=2
prev=O660
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O661
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'tablecode
'warncode
'autonum
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
'nProgSto + 1
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=2
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'nProgSto + 1
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O643
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O645
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'm_nUpdatedRows=0
]
h=[
19
19
]
obj='If
pag=2
prev=O679
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O680
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'tablecode
'warncode
'autonum
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
'nProgImp + 1
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=2
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'nProgImp + 1
]
I
I
]
w=[
150
150
]
I
obj='While
pag=2
prev=O642
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O643
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=2
prev=O698
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O699
fatherSonIndex=0
frm_seek='Zap
name='mcPersonbo
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,504,8)),NullDate(),CharToDate(Substr(riga,508,4)+Substr(riga,506,2)+Substr(riga,504,2)))
len=8
name='_datvarage
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgRet='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' nominativi del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,112,16))
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,488,16))
len=16
name='_conadd
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(_conadd)),cCli1,_conadd)
len=16
name='cCli1
next=Icpitembatch.CPRemark
frm_calc='Prima la Read si faceva per CF
next=Icpitembatch.CPBeginEnd
comment='Azzera vecchi valori
h=[
19
19
]
next=Ispitembatch.CPMemoryCursor
data_source='personbo
mem_curs_name='mcPersonbo
next=Icpitembatch.CPForEach
for_variable='rwPersonbo
for_variable_type='personbo
h=[
19
19
]
iterator_expr='mcPersonbo
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_flgvali
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_flganag
next=Icpitembatch.CPRead
arch='personbo_agg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,288,1))),'G','P')
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,288,1)='M','1',iif(Substr(riga,288,1)='F','2',Substr(riga,288,1)))
len=1
name='xSesso
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,450,1)='0' or Substr(riga,450,1)='1' or Substr(riga,450,1) = ''
'Substr(riga,450,1)='N' or Substr(riga,450,1)='S'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgvali='S',0,xCFE)
len=1
name='xCFE
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgvali='S',Upper(_oldcf),Upper(LRTrim(Substr(riga,112,16))))
len=16
name='xCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,6)
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,260,2))
len=2
name='xPrv
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCodCab))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,136,30))
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'(Substr(xCF,12,1) = 'Z' or Substr(riga,448,2)='EE') and (Substr(riga,288,1)='M' or Substr(riga,288,1)='F')
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Assegna Valori in base a flag
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico se il soggetto in esame non è già presente l'inserisco
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xConnes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O750
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O751
fatherSonIndex=0
frm_calc='nProgImp + 1
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='personbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=2
prev=O757
var_op='asgn
I
obj='Insert
pag=2
prev=O756
rd_kfield=[
'ALLINEATO
'ALLINEATONOMECNOME
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'CODORO
'COGNOME
'COMPORT
'CONNES
'DATANASC
'DATAPROF
'DATAREVPROF
'DATARILASC
'DATAVALI
'DATAVARAGE
'DESCCIT
'DOCFILE
'DOMICILIO
'FATCA
'IDENT
'MITIG
'NASCOMUN
'NASSTATO
'NOME
'NOSARA
'NOTIT
'NUMDOCUM
'ODB
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROGIMPORT
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RISGLOB
'RNATGIU
'SESSO
'SETTSINT
'SOTGRUP
'TIN
'TIPINTER
'TIPODOC
'TIPOORO
'TIPOPERS
]
rd_kvar=[
'0
'0
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,470,5)),3))
'Substr(riga,460,10)
'Upper(Substr(riga,200,30))
'Substr(riga,265,9)
'xCFE
'xCodCab
'Upper(xCF)
'Substr(riga,548,11)
'_oldcog
'Substr(riga,455,5)
'LRTrim(cCli1)
'_oldndt
'iif(not(Empty(Substr(riga,565,8))),CharToDate(Substr(riga,565,8)),NullDate())
'iif(not(Empty(Substr(riga,573,8))),CharToDate(Substr(riga,573,8)),NullDate())
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'_datvarage
'Upper(Substr(riga,230,30))
'Substr(riga,348,100)
'Upper(Substr(riga,77,35))
'Substr(riga,512,3)
'Substr(riga,584,3)
'iif(Empty(LRTrim(Substr(riga,560,4))),0,Val(Substr(riga,560,4)))
'_oldncm
'_oldnst
'_oldnom
'iif(Empty(LRTrim(Substr(riga,564,1))) or Substr(riga,564,1)='0' or Substr(riga,564,1)='N','N','S')
'iif(Empty(LRTrim(Substr(riga,559,1))),0,Val(Substr(riga,559,1)))
'Upper(Substr(riga,177,15))
'iif(Empty(Substr(riga,531,1)),0,Val(Substr(riga,531,1)))
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'iif(Empty(Substr(riga,487,1)),'N',Substr(riga,487,1))
'Substr(riga,451,4)
'nProgImp
'xPrv
'_oldrgs
'_oldrgs
'Substr(riga,169,3)
'Val(Substr(riga,484,3))
'Val(Substr(riga,481,3))
'Val(Substr(riga,478,3))
'Substr(riga,581,3)
'Val(Substr(riga,475,3))
'_oldnsx
'Substr(riga,172,3)
'Substr(riga,166,3)
'Substr(riga,515,16)
'_oldnpv
'Substr(riga,175,2)
'Substr(riga,547,1)
'_tipper
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O757
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+LRTrim(Substr(riga,7,70))+" con codice fiscale: "+LRTrim(Substr(riga,112,16))+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O767
I
obj='Exec
pag=2
prev=O766
I
obj='Var
obj_type='N
pag=2
prev=O765
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O764
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPVarDecl
father=O751
fatherSonIndex=1
frm_calc='Upper(xCF)+Substr(riga,7,70)+Substr(riga,77,35)+Substr(riga,230,30)+Substr(riga,260,2)+LibreriaMit.SpacePad(LRTrim(Substr(riga,265,9)),5)+Substr(riga,262,3)+Substr(riga,166,3)+Substr(riga,169,3)+Substr(riga,172,3)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+LibreriaMit.SpacePad(Left(cCNAS,30),30)+Substr(riga,448,2)+LibreriaMit.SpacePad(Left(cSNAS,30),30)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+Substr(riga,175,2)+Substr(riga,177,15)+Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2)+Substr(riga,200,30)+Substr(riga,274,14)+xCodCab
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='Upper(xCF)+Substr(riga,7,70)+Substr(riga,230,30)+Substr(riga,260,2)
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='xRiga3+LibreriaMit.SpacePad(Left(cCNAS,30),30)+Substr(riga,448,2)+LibreriaMit.SpacePad(Left(cSNAS,30),30)
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='xRiga3+CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))+xSesso
len=10
name='xRiga3
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgaggfam='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.SpacePad(rowPersonbo.CODFISC,16)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.RAGSOC,70)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.DOMICILIO,35)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.DESCCIT,30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.PROVINCIA,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(LRTrim(rowPersonbo.CAP),5)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.PAESE,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.SOTGRUP,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.RAMOGRUP,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.SETTSINT,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(Left(rowPersonbo.NASCOMUN,30),30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(rowPersonbo.TIPINTER,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(Left(rowPersonbo.NASSTATO,30),30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + iif(DateToChar(rowPersonbo.DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(rowPersonbo.DATANASC),8),Space(8))
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(rowPersonbo.TIPODOC,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(rowPersonbo.NUMDOCUM,15)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + iif(DateToChar(rowPersonbo.DATARILASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(rowPersonbo.DATARILASC),8),Space(8))
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(rowPersonbo.AUTRILASC,30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(rowPersonbo.PARTIVA,14)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(rowPersonbo.CODCAB,6)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.SpacePad(rowPersonbo.CODFISC,16)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(rowPersonbo.RAGSOC,70)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(rowPersonbo.DESCCIT,30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(rowPersonbo.PROVINCIA,2)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(Left(rowPersonbo.NASCOMUN,30),30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(rowPersonbo.TIPINTER,2)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(Left(rowPersonbo.NASSTATO,30),30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + iif(DateToChar(rowPersonbo.DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(rowPersonbo.DATANASC),8),Space(8))
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(rowPersonbo.SESSO,1)
len=10
name='xRiga4
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgaggfam='S'
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Se le due stringhe sono diverse, ci sono delle modifiche da fare. Quindi storicizzo in wersonbo le modifche.
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(xRiga1) <> LRTrim(xRiga2)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgaggfam='S'
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico se il soggetto è una persona fisica
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,288,1)='M' or Substr(riga,288,1)='F'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=2
par_expr=[
'xConnes
]
par_name=[
'w_CONNES
]
prev=O821
sel_name='qbe_aggfam_opextrbo_new
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O824
fatherSonIndex=0
obj='Write
pag=2
rd_kfield=[
'ANNO
'COLLEG
]
rd_kop=[
'=
'=
]
rd_kvar=[
'qbe_aggfam_opextrbo_new->ANNO
'qbe_aggfam_opextrbo_new->COLLEG
]
wr_field=[
'CFESTERO
]
wr_op=[
'=
]
wr_var=[
'iif(_oldest=1,'S','N')
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O820
sons=[
Icpitembatch.CPItemSon
comment='se persona fisica
instr=Icpitembatch.CPWrite
arch='personbo
father=O821
fatherSonIndex=0
frm_calc='Errore in aggiornamento ARCHPERS
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=2
prev=O840
var_op='asgn
I
obj='Write
pag=2
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(xConnes)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O840
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
frm_calc='m_cLastMsgError = ""
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O850
I
obj='Exec
pag=2
prev=O849
I
obj='Var
obj_type='N
pag=2
prev=O848
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'IDNASSTATO
'IDNASCOMUN
'DATAVARAGE
'COGNOME
'CFESTERO
'NASCOMUN
'DATANASC
'NOME
'TIPINTER
'NASSTATO
'SESSO
'RAGSOCOLD
'RAGSOC
'AREAGEO
'PAESE
'DATARILASC
'DATAVALI
'NOTIT
'MITIG
'NOSARA
'ODB
'DATAPROF
'DATAREVPROF
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'CAP
'PARTIVA
'DOCFILE
'PKTBSPECIE
'COMPORT
'ATTIV
'FATCA
'TIN
'TIPOORO
'CODORO
'RISGLOB
'IDENT
'NUMDOCUM
'AUTRILASC
'DESCCIT
'DOMICILIO
'RNATGIU
'RCOMP
'RATTIV
'RAREA
'CODFISC
'CODCAB
'PROVINCIA
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'''
'''
'_datvarage
'_oldcog
'_oldest
'_oldncm
'_oldndt
'_oldnom
'_oldnpv
'_oldnst
'_oldnsx
'_oldrgs
'_oldrgs
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,470,5)),3))
'arfn_conv_stato_uic(Substr(riga,262,3))
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'iif(Empty(LRTrim(Substr(riga,559,1))),0,Val(Substr(riga,559,1)))
'iif(Empty(LRTrim(Substr(riga,560,4))),0,Val(Substr(riga,560,4)))
'iif(Empty(LRTrim(Substr(riga,564,1))) or Substr(riga,564,1)='0' or Substr(riga,564,1)='N','N','S')
'iif(Empty(Substr(riga,531,1)),0,Val(Substr(riga,531,1)))
'iif(not(Empty(Substr(riga,565,8))),CharToDate(Substr(riga,565,8)),NullDate())
'iif(not(Empty(Substr(riga,573,8))),CharToDate(Substr(riga,573,8)),NullDate())
'Substr(riga,166,3)
'Substr(riga,169,3)
'Substr(riga,172,3)
'Substr(riga,175,2)
'Substr(riga,265,9)
'Substr(riga,274,14)
'Substr(riga,348,100)
'Substr(riga,451,4)
'Substr(riga,455,5)
'Substr(riga,460,10)
'Substr(riga,512,3)
'Substr(riga,515,16)
'Substr(riga,547,1)
'Substr(riga,548,11)
'Substr(riga,581,3)
'Substr(riga,584,3)
'Upper(Substr(riga,177,15))
'Upper(Substr(riga,200,30))
'Upper(Substr(riga,230,30))
'Upper(Substr(riga,77,35))
'Val(Substr(riga,475,3))
'Val(Substr(riga,478,3))
'Val(Substr(riga,481,3))
'Val(Substr(riga,484,3))
'xCF
'xCodCab
'xPrv
]
I
I
Icpitembatch.CPItemSon
comment='se persona giuridica
instr=Icpitembatch.CPRemark
father=O821
fatherSonIndex=1
frm_calc='Se non è persona fisica
next=Icpitembatch.CPWrite
arch='personbo
frm_calc='Errore in aggiornamento ARCHPERS
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=2
prev=O858
var_op='asgn
I
obj='Write
pag=2
prev=O857
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(xConnes)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O858
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O867
I
obj='Var
obj_type='N
pag=2
prev=O866
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'CODORO
'COGNOME
'COMPORT
'DATANASC
'DATAPROF
'DATAREVPROF
'DATARILASC
'DATAVALI
'DATAVARAGE
'DESCCIT
'DOCFILE
'DOMICILIO
'FATCA
'IDENT
'MITIG
'NASCOMUN
'NASSTATO
'NOME
'NOSARA
'NOTIT
'NUMDOCUM
'ODB
'PAESE
'PARTIVA
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RISGLOB
'RNATGIU
'SESSO
'SETTSINT
'SOTGRUP
'TIN
'TIPINTER
'TIPODOC
'TIPOORO
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,470,5)),3))
'Substr(riga,460,10)
'Upper(Substr(riga,200,30))
'Substr(riga,265,9)
'_oldest
'xCodCab
'xCF
'Substr(riga,548,11)
'_oldcog
'Substr(riga,455,5)
'_oldndt
'iif(not(Empty(Substr(riga,565,8))),CharToDate(Substr(riga,565,8)),NullDate())
'iif(not(Empty(Substr(riga,573,8))),CharToDate(Substr(riga,573,8)),NullDate())
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'_datvarage
'Upper(Substr(riga,230,30))
'Substr(riga,348,100)
'Upper(Substr(riga,77,35))
'Substr(riga,512,3)
'Substr(riga,584,3)
'iif(Empty(LRTrim(Substr(riga,560,4))),0,Val(Substr(riga,560,4)))
'_oldncm
'_oldnst
'_oldnom
'iif(Empty(LRTrim(Substr(riga,564,1))) or Substr(riga,564,1)='0' or Substr(riga,564,1)='N','N','S')
'iif(Empty(LRTrim(Substr(riga,559,1))),0,Val(Substr(riga,559,1)))
'Upper(Substr(riga,177,15))
'iif(Empty(Substr(riga,531,1)),0,Val(Substr(riga,531,1)))
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'Substr(riga,451,4)
'xPrv
'_oldrgs
'_oldrgs
'Substr(riga,169,3)
'Val(Substr(riga,484,3))
'Val(Substr(riga,481,3))
'Val(Substr(riga,478,3))
'Substr(riga,581,3)
'Val(Substr(riga,475,3))
'_oldnsx
'Substr(riga,172,3)
'Substr(riga,166,3)
'Substr(riga,515,16)
'_oldnpv
'Substr(riga,175,2)
'Substr(riga,547,1)
]
I
obj='Remark
pag=2
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=2
prev=O817
I
obj='If
pag=2
prev=O814
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O817
fatherSonIndex=0
frm_calc=[
'LRTrim(xRiga5) <> LRTrim(xRiga6) or w_flgforzaagg='S'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='bat
father=O876
fatherSonIndex=0
frm_calc='arrt_ae_agg_aetesta_sog(xConnes,_oldest)
obj='Exec
pag=2
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O813
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O814
fatherSonIndex=0
frm_calc='Verifico se c'è già una variazione
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
obj='If
pag=2
prev=O889
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O891
fatherSonIndex=0
frm_calc='Calcola il progressivo di registrazione
next=Icpitembatch.CPVarDecl
frm_calc='nProgSto + 1
len=10
name='nProgSto
next=Icpitembatch.CPVarDecl
frm_calc='Right('000000000000000'+LRTrim(Str(nProgSto,15,0)),15)
len=15
name='cProgSto
next=Icpitembatch.CPInsert
arch='wersonbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_creamo='S'
]
h=[
19
19
]
obj='If
pag=2
prev=O899
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O901
fatherSonIndex=0
frm_calc=[
'LRTrim(xRiga3) <> LRTrim(xRiga4)
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O906
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=2
prev=O911
sel_field='fraziobo->IDBASE
sel_name='fraziobo
sel_where='fraziobo->CONNESCLI=xConnes or fraziobo->CONNESOPER=xConnes or fraziobo->CONNESBEN=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O913
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(gAzienda)+"'",Space(10),10)
len=10
name='cNewProg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc=''JLMNOTUV?'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='fraziobo->IDBASE
len=10
name='_idbase
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=2
prev=O919
sel_field='*
sel_name='fraziobo
sel_where='fraziobo->IDBASE=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O920
fatherSonIndex=0
frm_calc='iif(Empty(fraziobo->FLAGRAP2),Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(fraziobo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPInsert
arch='fraziobo
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(operazbo->DATAOPE)+"F"+LibreriaMit.UniqueId()+"X"
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=2
prev=O926
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_idbase
]
wr_field=[
'OPERAZMOD
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
'=
]
wr_var=[
'fraziobo->IDEREG
''1'
'Date()
]
I
obj='Var
pag=2
prev=O925
var_op='asgn
I
obj='Insert
pag=2
prev=O924
rd_kfield=[
'ANNOOPE
'AREAGEO
'AUTOM
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESDOC
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'DUCOLLEG
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'IDFILE
'INFORM
'IPCOLLEG
'MODSVOL
'MTCN
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
]
rd_kvar=[
'fraziobo->ANNOOPE
'fraziobo->AREAGEO
'fraziobo->AUTOM
'fraziobo->C_CAB
'fraziobo->C_CAP
'fraziobo->C_CTA
'fraziobo->C_IND
'fraziobo->C_PRV
'fraziobo->C_RAG
'fraziobo->C_RAPPORTO
'fraziobo->C_STA
'fraziobo->CAMBIO
'fraziobo->CDATAOPE
'fraziobo->CDATOPE
'fraziobo->CDATREG
'fraziobo->CODANA
'fraziobo->CODCAB
'fraziobo->CODCAB2
'fraziobo->CODDIPE
'fraziobo->CODINT2
'fraziobo->CODINTER
'fraziobo->CODVOC
'fraziobo->COLLEG
'fraziobo->CONNALTRO
'fraziobo->CONNESBEN
'fraziobo->CONNESCLI
'fraziobo->CONNESDOC
'fraziobo->CONNESOPER
'fraziobo->DATAIMP
'fraziobo->DATAOPE
'fraziobo->DATAREG
'Date()
'fraziobo->DESC2
'fraziobo->DESCCIT
'fraziobo->DESCINTER
'fraziobo->DOCFILE
'fraziobo->DUCOLLEG
'fraziobo->FLAGCONT
'fraziobo->FLAGFRAZ
'fraziobo->FLAGLIRE
'fraziobo->FLAGRAP
'_flagrap2
'cNewProg
'fraziobo->idcauana
'fraziobo->IDEREG
'fraziobo->IDFILE
'fraziobo->INFORM
'fraziobo->IPCOLLEG
'fraziobo->MODSVOL
'fraziobo->MTCN
'fraziobo->NATURA
'fraziobo->NOPROT
'fraziobo->NUMPROG
'fraziobo->OPERAG
'fraziobo->OPERATORE
'fraziobo->OPERAZMOD
'fraziobo->OPRAP
'fraziobo->ORACOLLEG
'fraziobo->PAESE
'fraziobo->PAGASOGOP
'fraziobo->PRGIMPFRZ
'fraziobo->PROV2
'fraziobo->PROVINCIA
'fraziobo->RAGIO
'fraziobo->RAPPORTBEN
'fraziobo->RAPPORTO
'fraziobo->RAREA
'fraziobo->RCOMP
'fraziobo->RESPINS
'fraziobo->RFREQ
'fraziobo->RIFIMP
'fraziobo->RIMP
'fraziobo->RRAGIO
'fraziobo->RTIPO
'fraziobo->SCOPO
'fraziobo->SEGNO
''3'
'fraziobo->TIPO
'fraziobo->TIPOINF
'fraziobo->TIPOINT2
'fraziobo->TIPOINTER
'fraziobo->TIPOLEG
'fraziobo->TIPOOPRAP
'fraziobo->TOTCONT
'fraziobo->TOTLIRE
'fraziobo->UCODE
'fraziobo->UNIQUECODE
'fraziobo->VALUTA
'fraziobo->ZCPARTE
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O918
var_op='asgn
I
obj='Var
pag=2
prev=O917
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=2
sel_field='operazbo->IDBASE
sel_name='operazbo
sel_where='operazbo->CONNESCLI=xConnes or operazbo->CONNESOPER=xConnes or operazbo->CONNESBEN=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O911
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",Space(10),10)
len=10
name='cNewProg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='operazbo->IDBASE
len=10
name='_idbase
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=2
prev=O942
sel_field='*
sel_name='operazbo
sel_where='operazbo->IDBASE=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O943
fatherSonIndex=0
frm_calc='iif(Empty(operazbo->FLAGRAP2),Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(operazbo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPInsert
arch='operazbo
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(operazbo->DATAOPE)+"O"+LibreriaMit.UniqueId()+"X"
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=2
prev=O949
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_idbase
]
wr_field=[
'OPERAZMOD
'STATOREG
'DATARETT
'IDEREG
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'operazbo->IDEREG
''1'
'Date()
'_idreg
]
I
obj='Var
pag=2
prev=O948
var_op='asgn
I
obj='Insert
pag=2
prev=O947
rd_kfield=[
'AMMONT
'AREAGEO
'AUTOM
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESDOC
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'IDFILE
'INFORM
'IPCOLLEG
'MODSVOL
'MTCN
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
'ANNOOPE
]
rd_kvar=[
'operazbo->AMMONT
'operazbo->AREAGEO
'operazbo->AUTOM
'operazbo->C_CAB
'operazbo->C_CAP
'operazbo->C_CTA
'operazbo->C_IND
'operazbo->C_PRV
'operazbo->C_RAG
'operazbo->C_RAPPORTO
'operazbo->C_STA
'operazbo->CAMBIO
'operazbo->CDATAOPE
'operazbo->CDATOPE
'operazbo->CDATREG
'operazbo->CODANA
'operazbo->CODCAB
'operazbo->CODCAB2
'operazbo->CODDIPE
'operazbo->CODINT2
'operazbo->CODINTER
'operazbo->CODVOC
'operazbo->COLLEG
'operazbo->CONNALTRO
'operazbo->CONNESBEN
'operazbo->CONNESCLI
'operazbo->CONNESDOC
'operazbo->CONNESOPER
'operazbo->DATAIMP
'operazbo->DATAOPE
'operazbo->DATAREG
'Date()
'operazbo->DESC2
'operazbo->DESCCIT
'operazbo->DESCINTER
'operazbo->DOCFILE
'operazbo->DUCOLLEG
'operazbo->DURAT
'operazbo->FLAGCONT
'operazbo->FLAGFRAZ
'operazbo->FLAGLIRE
'operazbo->FLAGRAP
'_flagrap2
'cNewProg
'operazbo->idcauana
'operazbo->IDEREG
'operazbo->IDFILE
'operazbo->INFORM
'operazbo->IPCOLLEG
'operazbo->MODSVOL
'operazbo->MTCN
'operazbo->NATURA
'operazbo->NOPROT
'operazbo->NUMPROG
'operazbo->OPERAG
'operazbo->OPERATORE
'operazbo->OPERAZMOD
'operazbo->OPRAP
'operazbo->ORACOLLEG
'operazbo->PAESE
'operazbo->PAGASOGOP
'operazbo->PRGIMPOPE
'operazbo->PROV2
'operazbo->PROVINCIA
'operazbo->RAGIO
'operazbo->RAPPORTBEN
'operazbo->RAPPORTO
'operazbo->RAREA
'operazbo->RCOMP
'operazbo->RESPINS
'operazbo->RFREQ
'operazbo->RIFIMP
'operazbo->RIMP
'operazbo->RRAGIO
'operazbo->RTIPO
'operazbo->SCOPO
'operazbo->SEGNO
''3'
'operazbo->TIPO
'operazbo->TIPOINF
'operazbo->TIPOINT2
'operazbo->TIPOINTER
'operazbo->TIPOLEG
'operazbo->TIPOOPRAP
'operazbo->TOTCONT
'operazbo->TOTLIRE
'operazbo->UCODE
'operazbo->UNIQUECODE
'operazbo->VALUTA
'operazbo->ZCPARTE
'operazbo->ANNOOPE
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O941
var_op='asgn
I
obj='Var
pag=2
prev=O940
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=2
prev=O898
rd_kfield=[
'ALLINEATO
'ALLINEATONOMECNOME
'ALTROCAP
'ALTRODOM
'AREAGEO
'ATTIV
'AUTRILASC
'BANCABEN
'CAP
'CFESTERO
'CITTADIN1
'CITTADIN2
'CODCAB
'CODDIPE
'CODFISC
'CODINTER
'CODORO
'COGNOME
'COMPORT
'CONNES
'CRIME
'CRIMEDATE
'DAC6
'datamodi
'DATANASC
'DATAPROF
'DATAREVPROF
'DATARILASC
'DATASEGN
'DATAVALI
'DATEXTRA
'DESCCIT
'DOCFILE
'DOMICILIO
'FATCA
'FLAGDAC6
'FLGVALIDO
'IDBASE
'idcitta
'IDENT
'IDFILE
'IDNASCOMUN
'IDNASSTATO
'MACROAGENTE
'MITGDOC
'MITIG
'NASCOMUN
'NASSTATO
'NOME
'NOSARA
'NOTE
'NOTIT
'NUMDOCUM
'ODB
'OLDCODFISC
'OLDCONNES
'OLDSETSIN
'PAESE
'PARTIVA
'PEP
'PEPDATE
'PKTBSPECIE
'PROGIMP_C
'PROGIMPORT
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RESFISC
'RISGLOB
'RNATGIU
'sanumpro
'SESSO
'SETTSINT
'SETTSINT2
'SOSPMAF
'SOTGRUP
'SPOTID
'TELEF
'TIN
'TIPINTER
'TIPODOC
'TIPOORO
'TIPOPERS
]
rd_kvar=[
'rowPersonbo.ALLINEATO
'rowPersonbo.ALLINEATONOMECNOME
'rowPersonbo.ALTROCAP
'rowPersonbo.ALTRODOM
'rowPersonbo.AREAGEO
'rowPersonbo.ATTIV
'rowPersonbo.AUTRILASC
'rowPersonbo.BANCABEN
'rowPersonbo.CAP
'rowPersonbo.CFESTERO
'rowPersonbo.CITTADIN1
'rowPersonbo.CITTADIN2
'rowPersonbo.CODCAB
'rowPersonbo.CODDIPE
'rowPersonbo.CODFISC
'rowPersonbo.CODINTER
'rowPersonbo.CODORO
'rowPersonbo.COGNOME
'rowPersonbo.COMPORT
'xConnes
'rowPersonbo.CRIME
'rowPersonbo.CRIMEDATE
'rowPersonbo.DAC6
'_datarett
'rowPersonbo.DATANASC
'rowPersonbo.DATAPROF
'rowPersonbo.DATAREVPROF
'rowPersonbo.DATARILASC
'rowPersonbo.DATASEGN
'rowPersonbo.DATAVALI
'rowPersonbo.DATEXTRA
'rowPersonbo.DESCCIT
'rowPersonbo.DOCFILE
'rowPersonbo.DOMICILIO
'rowPersonbo.FATCA
'rowPersonbo.FLAGDAC6
'rowPersonbo.FLGVALIDO
'rowPersonbo.IDBASE
'rowPersonbo.idcitta
'rowPersonbo.IDENT
'rowPersonbo.IDFILE
'rowPersonbo.IDNASCOMUN
'rowPersonbo.IDNASSTATO
'rowPersonbo.MACROAGENTE
'rowPersonbo.MITIGDOC
'rowPersonbo.MITIG
'rowPersonbo.NASCOMUN
'rowPersonbo.NASSTATO
'rowPersonbo.NOME
'rowPersonbo.NOSARA
'rowPersonbo.NOTE
'rowPersonbo.NOTIT
'rowPersonbo.NUMDOCUM
'rowPersonbo.ODB
'rowPersonbo.OLDCODFISC
'rowPersonbo.OLDCONNES
'rowPersonbo.OLDSETSIN
'rowPersonbo.PAESE
'rowPersonbo.PARTIVA
'rowPersonbo.PEP
'rowPersonbo.PEPDATE
'rowPersonbo.PKTBSPECIE
'rowPersonbo.PROGIMP_C
'rowPersonbo.PROGIMPORT
'rowPersonbo.PROVINCIA
'rowPersonbo.RAGSOC
'rowPersonbo.RAGSOCOLD
'rowPersonbo.RAMOGRUP
'rowPersonbo.RAREA
'rowPersonbo.RATTIV
'rowPersonbo.RCOMP
'rowPersonbo.RESFISC
'rowPersonbo.RISGLOB
'rowPersonbo.RNATGIU
'cProgSto
'rowPersonbo.SESSO
'rowPersonbo.SETTSINT
'rowPersonbo.SETTSINT2
'rowPersonbo.SOSPMAF
'rowPersonbo.SOTGRUP
'rowPersonbo.SPOTID
'rowPersonbo.TELEF
'rowPersonbo.TIN
'rowPersonbo.TIPINTER
'rowPersonbo.TIPODOC
'rowPersonbo.TIPOORO
'rowPersonbo.TIPOPERS
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O899
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
frm_calc='m_cLastMsgError = ""
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O969
I
obj='Exec
pag=2
prev=O968
I
obj='Var
obj_type='N
pag=2
prev=O967
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=2
prev=O897
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O896
var_op='asgn
I
obj='Remark
pag=2
I
I
]
w=[
150
150
]
I
obj='Select
pag=2
prev=O888
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=xConnes and wersonbo->datamodi=_datarett
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O889
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='D
pag=2
prev=O887
var_op='asgn
I
obj='Var
pag=2
prev=O886
var_op='asgn
I
obj='Remark
pag=2
I
I
]
w=[
150
150
]
I
obj='Remark
pag=2
prev=O810
I
obj='If
pag=2
prev=O809
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O810
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad(rowPersonbo.CODFISC,16)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(rowPersonbo.RAGSOC,70)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(rowPersonbo.DESCCIT,30)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(rowPersonbo.PAESE,3)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(rowPersonbo.PROVINCIA,2)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(rowPersonbo.COGNOME,26)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(rowPersonbo.NOME,25)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(rowPersonbo.SESSO,1)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + iif(DateToChar(rowPersonbo.DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(rowPersonbo.DATANASC),8),Space(8))
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(Left(rowPersonbo.NASCOMUN,30),30)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(rowPersonbo.TIPINTER,2)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(Left(rowPersonbo.NASSTATO,30),30)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='iif(rowPersonbo.CFESTERO=1,'1','0')
len=10
name='xRiga6
obj='Var
obj_type='M
pag=2
prev=O991
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O990
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O989
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O988
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O987
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O986
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O985
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O984
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O983
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O982
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O981
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O980
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
prev=O808
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O807
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O806
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O805
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O804
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O803
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O802
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O801
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O800
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O799
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O798
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O797
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O796
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O795
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O794
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O793
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O792
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O791
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O790
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O789
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O788
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O787
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O786
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O785
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O784
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O783
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O782
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O781
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O778
var_op='asgn
I
obj='If
pag=2
prev=O777
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O778
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad(Upper(xCF),16)+Substr(riga,7,70)+Substr(riga,230,30)+Substr(riga,262,3)+Substr(riga,260,2)
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+Substr(riga,297,26)+Substr(riga,323,25)+xSesso
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2)+LibreriaMit.SpacePad(Left(cCNAS,30),30)+Substr(riga,448,2)
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+LibreriaMit.SpacePad(Left(cSNAS,30),30)+xCFE
len=10
name='xRiga5
obj='Var
obj_type='M
pag=2
prev=O998
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O997
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O996
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
prev=O776
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O775
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O774
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O773
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O772
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O771
var_op='asgn
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Remark
pag=2
prev=O748
I
obj='Begin
pag=2
prev=O745
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O748
fatherSonIndex=0
frm_calc='iif(_flganag='S',_oldcog,Upper(Substr(riga,297,26)))
len=26
name='_oldcog
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnom,Upper(Substr(riga,323,25)))
len=26
name='_oldnom
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldrgs,Upper(Substr(riga,7,70)))
len=70
name='_oldrgs
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldncm,cCNAS)
len=30
name='_oldncm
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnst,cSNAS)
len=30
name='_oldnst
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldndt,CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2)))
len=8
name='_oldndt
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnpv,Upper(Substr(riga,448,2)))
len=2
name='_oldnpv
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnsx,xSesso)
len=1
name='_oldnsx
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgvali='S',_oldest,xCFE)
len=1
name='_oldest
obj='Var
obj_type='N
pag=2
prev=O1011
var_op='asgn
I
obj='Var
pag=2
prev=O1010
var_op='asgn
I
obj='Var
pag=2
prev=O1009
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O1008
var_op='asgn
I
obj='Var
pag=2
prev=O1007
var_op='asgn
I
obj='Var
pag=2
prev=O1006
var_op='asgn
I
obj='Var
pag=2
prev=O1005
var_op='asgn
I
obj='Var
pag=2
prev=O1004
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O744
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O745
fatherSonIndex=0
frm_calc='Upper(Substr(riga,136,30))
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=2
prev=O1016
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O743
var_op='asgn
I
obj='Var
pag=2
prev=O740
var_op='asgn
I
obj='If
pag=2
prev=O739
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O740
fatherSonIndex=0
frm_calc='Upper(Substr(riga,230,30))
len=30
name='xCitta
next=Icpitembatch.CPForEach
for_variable='rowTBCITTA
for_variable_type='tbcitta
h=[
19
19
]
iterator_expr='mcTBCITTA
obj='ForEach
pag=2
prev=O1021
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1022
fatherSonIndex=0
frm_calc=[
'LRTrim(rowTBCITTA.CITTA)=LRTrim(xCitta)
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1026
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(xPrv))) and rowTBCITTA.PROV=xPrv
'not(Empty(LRTrim(xPrv))) and rowTBCITTA.PROV=xPrv
]
h=[
19
19
19
19
]
haselse=True
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1031
fatherSonIndex=0
frm_calc='rowTBCITTA.CAB
len=6
name='xCodCab
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O1036
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1031
fatherSonIndex=1
frm_calc='rowTBCITTA.CAB
len=6
name='xCodCab
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1031
fatherSonIndex=2
frm_calc='rowTBCITTA.CAB
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
frm_calc='rowTBCITTA.PROV
len=2
name='xPrv
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O1042
I
obj='Var
pag=2
prev=O1041
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O738
var_op='asgn
I
obj='Var
pag=2
prev=O737
var_op='asgn
I
obj='Var
pag=2
prev=O736
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O733
var_op='asgn
I
obj='If
pag=2
prev=O732
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O733
fatherSonIndex=0
frm_calc='iif(LRTrim(Substr(riga,450,1))='1',1,0)
len=1
name='xCFE
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O733
fatherSonIndex=1
frm_calc='iif(LRTrim(Substr(riga,450,1))='S',1,0)
len=1
name='xCFE
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O731
var_op='asgn
I
obj='Var
pag=2
prev=O730
var_op='asgn
I
obj='Read
pag=2
prev=O729
rd_field=[
'FLGVALIDO
'FLGANAVAL
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'cCli1
]
rd_var=[
'_flgvali
'_flganag
]
I
obj='Var
pag=2
prev=O728
var_op='asgn
I
obj='Var
pag=2
prev=O726
var_op='asgn
I
obj='ForEach
pag=2
prev=O725
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O726
fatherSonIndex=0
frm_calc='rwPersonbo
frm_seek='Copy
name='rowPersonbo
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.CONNES
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.CFESTERO
len=1
name='_oldest
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.CODFISC
len=16
name='_oldcf
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.COGNOME
len=26
name='_oldcog
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.NOME
len=26
name='_oldnom
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.RAGSOC
len=70
name='_oldrgs
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.NASCOMUN
len=30
name='_oldncm
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.NASSTATO
len=30
name='_oldnst
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.DATANASC
len=8
name='_oldndt
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.TIPINTER
len=2
name='_oldnpv
next=Icpitembatch.CPVarDecl
frm_calc='rowPersonbo.SESSO
len=1
name='_oldnsx
obj='Var
pag=2
prev=O1070
var_op='asgn
I
obj='Var
pag=2
prev=O1069
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O1068
var_op='asgn
I
obj='Var
pag=2
prev=O1067
var_op='asgn
I
obj='Var
pag=2
prev=O1066
var_op='asgn
I
obj='Var
pag=2
prev=O1065
var_op='asgn
I
obj='Var
pag=2
prev=O1064
var_op='asgn
I
obj='Var
pag=2
prev=O1063
var_op='asgn
I
obj='Var
pag=2
prev=O1062
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O1061
var_op='asgn
I
obj='Var
pag=2
prev=O1060
var_op='asgn
I
obj='Var
obj_type='R
pag=2
var_op='meth
I
I
]
w=[
150
150
]
I
obj='MemoryCursor
pag=2
prev=O723
sel_field='*
sel_name='personbo
sel_type='fltb
sel_where='personbo->CONNES=cCli1
I
obj='Begin
pag=2
prev=O722
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O723
fatherSonIndex=0
frm_calc='0
len=1
name='_oldest
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_oldcf
next=Icpitembatch.CPVarDecl
frm_calc='''
len=26
name='_oldcog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=26
name='_oldnom
next=Icpitembatch.CPVarDecl
frm_calc='''
len=70
name='_oldrgs
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_oldncm
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_oldnst
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_oldndt
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_oldnpv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_oldnsx
obj='Var
pag=2
prev=O1083
var_op='asgn
I
obj='Var
pag=2
prev=O1082
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O1081
var_op='asgn
I
obj='Var
pag=2
prev=O1080
var_op='asgn
I
obj='Var
pag=2
prev=O1079
var_op='asgn
I
obj='Var
pag=2
prev=O1078
var_op='asgn
I
obj='Var
pag=2
prev=O1077
var_op='asgn
I
obj='Var
pag=2
prev=O1076
var_op='asgn
I
obj='Var
pag=2
prev=O1075
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=2
prev=O721
I
obj='Var
pag=2
prev=O720
var_op='asgn
I
obj='Var
pag=2
prev=O719
var_op='asgn
I
obj='Var
pag=2
prev=O718
var_op='asgn
I
obj='Var
pag=2
prev=O717
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O714
var_op='asgn
I
obj='If
pag=2
prev=O713
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xersonbo
father=O714
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'COGNOME
'COMPORT
'CONNES
'DATANASC
'DATARILASC
'DATAVALI
'DESCCIT
'DOCFILE
'DOMICILIO
'NASCOMUN
'NOME
'NUMDOCUM
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RNATGIU
'SESSO
'SETTSINT
'SOTGRUP
'TIPINTER
'TIPODOC
'IDPROG
]
rd_kvar=[
'Substr(riga,470,3)
'Substr(riga,460,10)
'Substr(riga,200,30)
'Substr(riga,265,9)
'Substr(riga,450,1)
'Left(riga,6)
'Substr(riga,112,16)
'Substr(riga,297,26)
'Substr(riga,455,5)
'Substr(riga,488,16)
'Substr(riga,128,8)
'Substr(riga,192,8)
'Substr(riga,289,8)
'Substr(riga,230,30)
'Substr(riga,348,100)
'Substr(riga,77,35)
'Substr(riga,136,30)
'Substr(riga,323,25)
'Substr(riga,177,15)
'Substr(riga,262,3)
'Substr(riga,274,14)
'Substr(riga,487,1)
'Substr(riga,451,4)
'Substr(riga,260,2)
'Substr(riga,7,70)
'Substr(riga,7,70)
'Substr(riga,169,3)
'Substr(riga,484,3)
'Substr(riga,481,3)
'Substr(riga,478,3)
'Substr(riga,475,3)
'Substr(riga,288,1)
'Substr(riga,172,3)
'Substr(riga,166,3)
'Substr(riga,448,2)
'Substr(riga,175,2)
'conta
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O712
var_op='asgn
I
obj='Var
pag=2
prev=O711
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O710
var_op='asgn
I
obj='Var
obj_type='M
pag=2
pagelocal=True
prev=O709
var_op='asgn
I
obj='Var
obj_type='M
pag=2
pagelocal=True
prev=O708
var_op='asgn
I
obj='Var
obj_type='M
pag=2
pagelocal=True
prev=O707
var_op='asgn
I
obj='Var
obj_type='M
pag=2
pagelocal=True
prev=O706
var_op='asgn
I
obj='Var
obj_type='M
pag=2
pagelocal=True
prev=O705
var_op='asgn
I
obj='Var
obj_type='M
pag=2
pagelocal=True
prev=O704
var_op='asgn
I
obj='Var
obj_type='MC
pag=2
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O641
var_op='asgn
I
obj='Read
pag=2
prev=O640
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
rd_var=[
'nProgSto
]
I
obj='Read
pag=2
prev=O639
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
rd_var=[
'nProgImp
]
I
obj='MemoryCursor
pag=2
prev=O638
sel_field='*
sel_name='tbcitta
sel_type='fltb
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O637
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O636
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O635
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O634
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O633
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O632
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O631
var_op='asgn
I
obj='Remark
pag=2
x=15
y=15
I
Icpitembatch.CPRead
arch='personbo
obj='Read
pag=2
rd_field=[
'CONNES
'CFESTERO
'CODFISC
'COGNOME
'NOME
'RAGSOC
'NASCOMUN
'NASSTATO
'DATANASC
'TIPINTER
'SESSO
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'cCli1
]
rd_var=[
'xConnes
'_oldest
'_oldcf
'_oldcog
'_oldnom
'_oldrgs
'_oldncm
'_oldnst
'_oldndt
'_oldnpv
'_oldnsx
]
x=626
y=1177
I
Icpitembatch.CPVarDecl
frm_seek='AppendBlank
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(xConnes)
frm_seek='connes
name='mcSoggetti
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcSoggetti
obj='Var
obj_type='MC
pag=2
prev=O1108
var_op='meth
I
obj='Var
obj_type='MC
pag=2
prev=O1107
var_op='prop
I
obj='Var
obj_type='MC
pag=2
var_op='meth
x=1403
y=6599
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime())  + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Rapporti Inseriti: '+LRTrim(Str(cNumNew,10,0)) +' - Rapporti Aggiornati: '+LRTrim(Str(cNumMod,10,0))+' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1122
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1121
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1120
var_op='asgn
I
obj='Exec
pag=3
prev=O1119
I
obj='Exec
pag=3
prev=O1118
I
obj='Exec
pag=3
prev=O1116
I
obj='While
pag=3
prev=O1115
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1116
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=3
prev=O1126
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1127
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' rapporti del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='cFlagLire
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,77,1)='S'
'Substr(riga,77,1)='E'
'Substr(riga,77,1)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='xRapporto
next=Icpitembatch.CPRead
arch='anarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xRapporto))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O1139
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O1140
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='anarapbo
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='knarapbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,83,1)<>'1'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=3
prev=O1150
var_op='asgn
I
obj='If
pag=3
prev=O1148
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1150
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PROGAET\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aetesta
h=[
19
19
]
obj='Insert
pag=3
prev=O1156
rd_kfield=[
'RAPPORTO
'TIPOAG
'COINT
'DESCRI
'VALUTA
'PROGAET
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,81,2)
'iif(Substr(riga,76,1)='1','1','2')
'iif(Substr(riga,81,2)='99',Upper(Substr(riga,26,24)),'')
'Substr(riga,78,3)
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1157
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O1165
I
obj='Var
obj_type='N
pag=3
prev=O1164
var_op='asgn
I
obj='Exec
pag=3
prev=O1163
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=3
prev=O1146
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGRAP
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
''D'
'Substr(riga,76,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1148
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O1175
I
obj='Var
obj_type='N
pag=3
prev=O1174
var_op='asgn
I
obj='Exec
pag=3
prev=O1173
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Insert
pag=3
prev=O1145
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
'AMMONT
'DURAT
'TIPO
'RRAGIO
'RCOMP
'RAREA
'RIMP
'RFREQ
'RTIPO
'NATURA
'SCOPO
'MITIG
'PRGIMPRAP
'RISGLOB
'DATAPROF
'DATAREVPROF
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,94,5)),3))
'Substr(riga,99,5)
'Substr(riga,104,5)
'Substr(riga,109,5)
'Val(Substr(riga,114,3))
'Val(Substr(riga,117,3))
'Val(Substr(riga,120,3))
'Val(Substr(riga,123,3))
'Val(Substr(riga,126,3))
'Val(Substr(riga,129,3))
'Substr(riga,132,50)
'Substr(riga,182,50)
'Val(Substr(riga,298,4))
'nProgImp
'Substr(riga,318,3)
'CharToDate(Substr(riga,306,4)+Substr(riga,304,2)+Substr(riga,302,2))
'CharToDate(Substr(riga,314,4)+Substr(riga,312,2)+Substr(riga,310,2))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1146
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O1184
I
obj='Var
obj_type='N
pag=3
prev=O1183
var_op='asgn
I
obj='Exec
pag=3
prev=O1182
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='anarapbo
father=O1140
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='knarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,83,1)<>'1'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=3
prev=O1191
var_op='asgn
I
obj='If
pag=3
prev=O1190
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aetesta
father=O1191
fatherSonIndex=0
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'TIPOAG
'COINT
'DESCRI
'VALUTA
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,81,2)
'iif(Substr(riga,76,1)='1','1','2')
'iif(Substr(riga,81,2)='99',Upper(Substr(riga,26,24)),'')
'Substr(riga,78,3)
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=3
prev=O1188
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'DESCRAP
'FLAGRAP
'TIPORAP
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Substr(riga,26,50)
'Substr(riga,76,1)
''D'
]
I
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1188
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=3
prev=O1218
I
obj='Var
obj_type='N
pag=3
prev=O1217
var_op='asgn
I
obj='Exec
pag=3
prev=O1216
I
nonlocal=True
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
'AMMONT
'DURAT
'TIPO
'RRAGIO
'RCOMP
'RAREA
'RIMP
'RFREQ
'RTIPO
'NATURA
'SCOPO
'MITIG
'RISGLOB
'DATAPROF
'DATAREVPROF
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,94,5)),3))
'Substr(riga,99,5)
'Substr(riga,104,5)
'Substr(riga,109,5)
'Val(Substr(riga,114,3))
'Val(Substr(riga,117,3))
'Val(Substr(riga,120,3))
'Val(Substr(riga,123,3))
'Val(Substr(riga,126,3))
'Val(Substr(riga,129,3))
'Substr(riga,132,50)
'Substr(riga,182,50)
'Val(Substr(riga,298,4))
'Substr(riga,318,3)
'CharToDate(Substr(riga,306,4)+Substr(riga,304,2)+Substr(riga,302,2))
'CharToDate(Substr(riga,314,4)+Substr(riga,312,2)+Substr(riga,310,2))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=3
prev=O1138
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Left(riga,25)
]
rd_var=[
'xRapporto
]
I
obj='Var
pag=3
prev=O1135
var_op='asgn
I
obj='Case
pag=3
prev=O1134
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1135
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1135
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1135
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1135
fatherSonIndex=3
frm_calc='Substr(riga,77,1)
len=1
name='cFlagLire
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Var
pag=3
prev=O1133
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1132
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O1114
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1113
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1112
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1111
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1110
var_op='asgn
I
obj='Remark
pag=3
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Informazione Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O1252
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O1251
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O1250
var_op='asgn
I
obj='Exec
pag=4
prev=O1249
I
obj='Exec
pag=4
prev=O1248
I
obj='Exec
pag=4
prev=O1246
I
obj='While
pag=4
prev=O1245
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1246
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=4
prev=O1256
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O1257
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,75,16)
len=16
name='xConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,50,16)
len=16
name='xSOCTCon
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xSOCTCon)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' informazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,46,1)='S'
'Substr(riga,46,1)='E'
'Substr(riga,46,1)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,159,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,36,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPInsert
arch='rapopebo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,219,16)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,44,2) <> '25' and Substr(riga,44,2) <> '28'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
prev=O1298
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1301
fatherSonIndex=0
frm_calc=[
'not(Empty(cCli1))
]
h=[
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1306
fatherSonIndex=0
frm_calc=[
'Substr(riga,44,2)  = '25'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='delegabo
father=O1311
fatherSonIndex=0
h=[
19
19
]
obj='Insert
pag=4
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1316
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1324
I
obj='Var
obj_type='N
pag=4
prev=O1323
var_op='asgn
I
obj='Exec
pag=4
prev=O1322
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1311
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='intestbo
h=[
19
19
]
obj='Insert
pag=4
prev=O1328
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
'PRGIMPSOG
'PROQUOTA
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
'nProgImp2
'Val(Substr(riga,235,3))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1329
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1337
I
obj='Var
obj_type='N
pag=4
prev=O1336
var_op='asgn
I
obj='Exec
pag=4
prev=O1335
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1301
fatherSonIndex=1
frm_calc=[
'Substr(riga,44,2)='28'
'Substr(riga,45,1)='6' or Substr(riga,44,2)='38'
]
h=[
19
19
19
19
]
haselse=True
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='delegabo
father=O1343
fatherSonIndex=0
h=[
19
19
]
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cCli1
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1348
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1357
I
obj='Var
obj_type='N
pag=4
prev=O1356
var_op='asgn
I
obj='Exec
pag=4
prev=O1355
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestbo
father=O1343
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'Substr(riga,9,25)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1364
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1373
I
obj='Var
obj_type='N
pag=4
prev=O1372
var_op='asgn
I
obj='Exec
pag=4
prev=O1371
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestbo
father=O1343
fatherSonIndex=2
h=[
19
19
]
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cCli1
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1380
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1389
I
obj='Var
obj_type='N
pag=4
prev=O1388
var_op='asgn
I
obj='Exec
pag=4
prev=O1387
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'NUMPROG1
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
]
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=4
prev=O1297
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1298
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=4
sel_field='*
sel_name='intestbo
sel_order='intestbo->CPROWNUM
sel_where='intestbo->RAPPORTO=Substr(riga,9,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1399
fatherSonIndex=0
frm_calc=[
'intestbo->CODINTER=cCli1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=4
prev=O1403
var_op='asgn
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1403
fatherSonIndex=0
frm_calc='intestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1298
fatherSonIndex=1
frm_calc=[
'Substr(riga,44,2)  = '25'
'Substr(riga,44,2) = '28'
]
h=[
19
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1413
fatherSonIndex=0
frm_calc='0
len=10
name='cNumMod
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1413
fatherSonIndex=1
frm_calc='1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O1296
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1295
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1292
var_op='asgn
I
obj='If
pag=4
prev=O1290
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='fiduciabo
father=O1292
fatherSonIndex=0
obj='Insert
pag=4
rd_kfield=[
'IDFILEBO
'CODSOG
'NUMCOL
'RAPCOL
'IDBASE
]
rd_kvar=[
'cInfProg1
'LRTrim(Substr(riga,219,16))
'cInfProg2
'Substr(riga,9,25)
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=4
prev=O1289
rd_kfield=[
'CDATOPE
'CDATREG
'CODCAB
'CODDIPE
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'VALUTA
'IDBASE2
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'_intercab
'Substr(riga,115,6)
'_intercod
'iif((_dataope < CharToDate('20100601') or _dataope > CharToDate('20131231')),xSOCTCF,'')
'_dataope
'_datareg
'_intercit
'Substr(riga,169,50)
'cFlagLire
'Substr(riga,34,1)
'cInfProg1
'"I"+Right(cInfProg2,9)+_idb2
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'iif((_dataope < CharToDate('20100601') or _dataope > CharToDate('20131231')),Substr(riga,35,1),' ')
'Substr(riga,44,2)
'Substr(riga,159,10)
'Substr(riga,47,3)
'_idb2
]
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1290
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1435
I
obj='Var
obj_type='N
pag=4
prev=O1434
var_op='asgn
I
obj='Exec
pag=4
prev=O1433
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=4
prev=O1288
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1287
var_op='asgn
I
obj='Var
pag=4
prev=O1286
var_op='asgn
I
obj='Var
pag=4
prev=O1285
var_op='asgn
I
obj='Var
obj_type='D
pag=4
prev=O1284
var_op='asgn
I
obj='Var
obj_type='D
pag=4
prev=O1281
var_op='asgn
I
obj='If
pag=4
prev=O1280
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='rapopebo
father=O1281
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'_unicode<>''
]
h=[
19
19
]
obj='If
pag=4
prev=O1440
sons=[
Icpitembatch.CPItemSon
comment='In caso di _unicode doppio blocco l'importazione
instr=Icpitembatch.CPVarDecl
father=O1441
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=4
prev=O1447
I
obj='Var
obj_type='N
pag=4
prev=O1446
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,159,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
prev=O1279
var_op='asgn
I
obj='Remark
pag=4
prev=O1276
I
obj='Case
pag=4
prev=O1275
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1276
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1276
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1276
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1276
fatherSonIndex=3
frm_calc='Substr(riga,46,1)
len=1
name='cFlagLire
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O1274
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1271
var_op='asgn
I
obj='If
pag=4
prev=O1270
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='personbo
father=O1271
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=4
prev=O1467
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O1468
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=4
prev=O1473
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1474
fatherSonIndex=0
frm_calc='xSOCTCon
len=16
name='xSOCTCF
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
prev=O1269
var_op='asgn
I
obj='Var
pag=4
prev=O1266
var_op='asgn
I
obj='If
pag=4
prev=O1265
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='personbo
father=O1266
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
obj='If
pag=4
prev=O1493
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1494
fatherSonIndex=0
frm_calc='xConnes
len=16
name='cCli1
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
prev=O1264
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
obj='Var
pag=4
prev=O1262
var_op='asgn
I
obj='Begin
pag=4
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1262
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,104,11))),_codinter,Substr(riga,104,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,121,30))),_citinter,Substr(riga,121,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,153,6))),_cabinter,Substr(riga,153,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,151,2))),_prvinter,Substr(riga,151,2))
len=2
name='_interprv
obj='Var
pag=4
prev=O1514
var_op='asgn
I
obj='Var
pag=4
prev=O1513
var_op='asgn
I
obj='Var
pag=4
prev=O1512
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O1244
var_op='asgn
I
obj='Var
obj_type='N
pag=4
prev=O1243
var_op='asgn
I
obj='Var
pag=4
prev=O1242
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=4
prev=O1241
var_op='asgn
I
obj='Remark
pag=4
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Inserite o modificate: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','OPERAZBO','Operazioni Inserite o modificate: '+LRTrim(Str(cNumNew,10,0)))
obj='Exec
pag=5
prev=O1532
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1531
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1530
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1529
var_op='asgn
I
obj='Exec
pag=5
prev=O1528
I
obj='Exec
pag=5
prev=O1527
I
obj='Exec
pag=5
prev=O1525
I
obj='While
pag=5
prev=O1524
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1525
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=5
prev=O1536
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1537
fatherSonIndex=0
frm_calc='NullDate()
len=8
name='_oldreg
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1545
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O1547
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,257,6))))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,318,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc='_flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,331,9))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))) or (Empty(LRTrim(_numprog)) and not(Empty(LRTrim(Left(riga,8)))))
]
h=[
19
19
]
obj='If
pag=5
prev=O1569
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1572
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,155,1)='S'
'Substr(riga,155,1)='E'
'Substr(riga,155,1)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,9,1)='1' or Substr(riga,9,1)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,301,1)),'0',iif(Substr(riga,301,1)='S','1',iif(Substr(riga,301,1)='N','0',Substr(riga,301,1))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,231,11))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,852,19))),0,Val(LRTrim(Substr(riga,852,19))))
len=15
name='_totin
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,871,19))),0,Val(LRTrim(Substr(riga,871,19))))
len=15
name='_totout
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge i dati dell'intermediario controparte
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='operazbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_oldidb)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=5
prev=O1603
var_op='asgn
I
obj='If
pag=5
prev=O1601
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1603
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='sogopebo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='clientiope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='beneficope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='terzistiope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1621
sel_field='*
sel_name='rapcoll
sel_where='rapcoll->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='rapcoll
father=O1623
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'RAPPORTO
'IDBASE
]
rd_kvar=[
'cOpeProg1
'rapcoll->RAPPORTO
'rapcoll->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1620
sel_field='*
sel_name='operazbo_agg
sel_where='operazbo_agg->IDBASE=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='operazbo_agg
father=O1621
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDBASE
'CODLOB
'TIPOGIOCO
'CACODICE
'IDBIGLIETTO
'CADATAORA
'CATIPGIO
'CATIPCON
'CAPV_COD
'IDDOCALL
'VPCODICE
'WUDATRET
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
]
rd_kvar=[
'cOpeProg1
'operazbo_agg->CODLOB
'operazbo_agg->TIPOGIOCO
'operazbo_agg->CACODICE
'operazbo_agg->IDBIGLIETTO
'operazbo_agg->CADATAORA
'operazbo_agg->CATIPGIO
'operazbo_agg->CATIPCON
'operazbo_agg->CAPV_COD
'operazbo_agg->IDDOCALL
'operazbo_agg->VPCODICE
'operazbo_agg->WUDATRET
'operazbo_agg->CATEG01
'operazbo_agg->CATEG02
'operazbo_agg->CATEG03
'operazbo_agg->CATEG04
'operazbo_agg->CATEG05
'operazbo_agg->CATEGORIA
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=5
prev=O1618
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=5
prev=O1617
sel_field='*
sel_name='terzistiope
sel_where='terzistiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistiope
father=O1618
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'cOpeProg1
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=5
prev=O1615
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=5
prev=O1614
sel_field='*
sel_name='beneficope
sel_where='beneficope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficope
father=O1615
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
]
rd_kvar=[
'cOpeProg1
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=5
prev=O1612
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=5
prev=O1611
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O1612
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'PROQUOTA
'IMPSARA
]
rd_kvar=[
'cOpeProg1
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
'clientiope->PROQUOTA
'clientiope->IMPSARA
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=5
prev=O1609
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=5
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sogopebo
father=O1609
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=5
prev=O1599
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
'IMPIN
'IMPOUT
'MITIG
'SV58550
'PROQUOTA
'IMPSARA
'SV58550MA
'NOSARA
]
rd_kvar=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'Substr(riga,10,4)
'_intercab
'_iccab
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'LRTrim(Substr(riga,484,16))
'LRTrim(Substr(riga,302,16))
'LRTrim(Substr(riga,190,16))
'LRTrim(Substr(riga,206,16))
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_datarett
'_iccit
'_intercit
'_icrag
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'_flagrap2
'cOpeProg1
'cIdCau
'"O"+Right(cOpeProg2,9)+_idb2
'Substr(riga,424,30)
'Substr(riga,813,15)
'Substr(riga,414,5)
'Substr(riga,662,50)
'cOpeProg2
'Substr(riga,328,3)
'_idreg
''1'
'iif(Empty(Substr(riga,828,14)) or Substr(riga,828,14)='01010001000000',NullDateTime(),CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6)))
'_icsta
'Substr(riga,812,1)
'nProgImp
'_icprv
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
'_statoreg
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'_colleg
'_idb2
'_totin / 100
'_totout / 100
'Val(Substr(riga,893,4))
'Substr(riga,897,1)
'Val(Substr(riga,898,3))
'Val(Substr(riga,901,19))/100
'Substr(riga,920,2)
'iif(Empty(LRTrim(Substr(riga,922,1))) or Substr(riga,922,1)='0' or Substr(riga,922,1)='N','N','S')
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1601
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O1680
I
obj='Var
obj_type='N
pag=5
prev=O1679
var_op='asgn
I
obj='Exec
pag=5
prev=O1678
I
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Begin
pag=5
prev=O1597
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1599
fatherSonIndex=0
frm_calc='''
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=50
name='_icrag
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,18,11)))) and Len(LRTrim(Substr(riga,64,6)+Substr(riga,70,50)+Substr(riga,29,3)+Substr(riga,62,2)+Substr(riga,32,30))) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1689
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O1690
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(_icrag),50)
len=50
name='_icrag
obj='Var
pag=5
prev=O1695
var_op='asgn
I
obj='Read
pag=5
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'Substr(riga,18,11)
]
rd_var=[
'_iccab
'_iccit
'_icprv
'_icsta
'_icrag
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1690
fatherSonIndex=1
frm_calc='Substr(riga,64,6)
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,32,30)
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,62,2)
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,29,3))
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,70,50)
len=50
name='_icrag
obj='Var
pag=5
prev=O1705
var_op='asgn
I
obj='Var
pag=5
prev=O1704
var_op='asgn
I
obj='Var
pag=5
prev=O1703
var_op='asgn
I
obj='Var
pag=5
prev=O1702
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=5
prev=O1688
var_op='asgn
I
obj='Var
pag=5
prev=O1687
var_op='asgn
I
obj='Var
pag=5
prev=O1686
var_op='asgn
I
obj='Var
pag=5
prev=O1685
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
prev=O1596
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1597
fatherSonIndex=0
frm_calc='Upper(Substr(riga,511,70))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,581,3))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,584,30))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,614,6)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,620,2))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,622,35))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,657,5))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,302,16))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=5
prev=O1721
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1724
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,120,25))))
]
h=[
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1729
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1734
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O1745
I
obj='Read
pag=5
prev=O1744
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=5
prev=O1743
var_op='asgn
I
obj='Var
pag=5
prev=O1742
var_op='asgn
I
obj='Var
pag=5
prev=O1741
var_op='asgn
I
obj='Var
pag=5
prev=O1740
var_op='asgn
I
obj='Var
pag=5
prev=O1739
var_op='asgn
I
obj='Var
pag=5
prev=O1738
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1718
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1721
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=5
prev=O1762
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,302,16)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=5
prev=O1761
var_op='asgn
I
obj='Var
pag=5
prev=O1760
var_op='asgn
I
obj='Var
pag=5
prev=O1759
var_op='asgn
I
obj='Var
pag=5
prev=O1758
var_op='asgn
I
obj='Var
pag=5
prev=O1757
var_op='asgn
I
obj='Var
pag=5
prev=O1756
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1717
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O1718
fatherSonIndex=0
obj='Read
pag=5
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1716
var_op='asgn
I
obj='Var
pag=5
prev=O1715
var_op='asgn
I
obj='Var
pag=5
prev=O1714
var_op='asgn
I
obj='Var
pag=5
prev=O1713
var_op='asgn
I
obj='Var
pag=5
prev=O1712
var_op='asgn
I
obj='Var
pag=5
prev=O1711
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1595
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1594
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1593
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1592
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1590
var_op='asgn
I
obj='Select
pag=5
par_expr=[
'Substr(riga,10,4)
'Substr(riga,14,2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O1589
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1590
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1588
var_op='asgn
I
obj='Var
pag=5
prev=O1587
var_op='asgn
I
obj='Var
pag=5
prev=O1586
var_op='asgn
I
obj='Var
pag=5
prev=O1585
var_op='asgn
I
obj='Var
pag=5
prev=O1582
var_op='asgn
I
obj='Case
pag=5
prev=O1581
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1582
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1582
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1582
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1582
fatherSonIndex=3
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Var
pag=5
prev=O1580
var_op='asgn
I
obj='Var
pag=5
prev=O1577
var_op='asgn
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1577
fatherSonIndex=0
frm_calc='_numprog
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''1'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
next=Icpitembatch.CPVarDecl
frm_calc='_oldreg
len=8
name='_datareg
obj='Var
obj_type='D
pag=5
prev=O1798
var_op='asgn
I
obj='Var
obj_type='D
pag=5
prev=O1797
var_op='asgn
I
obj='Var
pag=5
prev=O1796
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1577
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("POPERAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''0'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datarett
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0 or Empty(Substr(riga,147,8)),Date(),arfn_datefchar(Substr(riga,147,8)))
len=8
name='_datareg
obj='Var
obj_type='D
pag=5
prev=O1803
var_op='asgn
I
obj='Var
obj_type='D
pag=5
prev=O1802
var_op='asgn
I
obj='Var
pag=5
prev=O1801
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1566
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1569
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Left(riga,8)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1809
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1814
sel_field='operazbo->IDBASE
sel_name='operazbo
sel_where='operazbo->NUMPROG=_numprog and (operazbo->STATOREG='0'  or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O1815
fatherSonIndex=0
frm_calc='"E' stata cancellata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=5
prev=O1819
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'operazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
]
wr_var=[
''2'
'Date()
]
I
nonlocal=True
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
father=O1809
fatherSonIndex=1
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"E' stata variata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1830
sel_field='operazbo->IDBASE,operazbo->NUMPROG,operazbo->DATAOPE,operazbo->FLAGRAP2,operazbo->IDEREG,operazbo->DATAREG
sel_name='operazbo
sel_where='operazbo->NUMPROG=_numprog and (operazbo->STATOREG='0'  or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1831
fatherSonIndex=0
frm_calc='operazbo->IDBASE
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(operazbo->FLAGRAP2) or operazbo->FLAGRAP2='S',Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(operazbo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='operazbo->IDEREG
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
frm_calc='operazbo->DATAREG
len=8
name='_oldreg
next=Icpitembatch.CPWrite
arch='operazbo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1844
sel_field='*
sel_name='terzistiope
sel_where='terzistiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='merzistiope
father=O1846
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'IDREG
]
rd_kvar=[
'_oldidb
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1842
sel_field='*
sel_name='beneficope
sel_where='beneficope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='meneficope
father=O1844
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
'IDREG
]
rd_kvar=[
'_oldidb
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1840
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mlientiope
father=O1842
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
'PROQUOTA
'IMPSARA
]
rd_kvar=[
'_oldidb
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
'_idreg
'clientiope->PROQUOTA
'clientiope->IMPSARA
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1839
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mogopebo
father=O1840
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=5
prev=O1838
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'operazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
'FLAGRAP2
]
wr_op=[
'=
'=
'=
]
wr_var=[
''3'
'iif(Empty(LRTrim(Substr(riga,147,8))),Date(),arfn_datefchar(Substr(riga,147,8)))
'_flagrap2
]
I
obj='Var
obj_type='D
pag=5
prev=O1837
var_op='asgn
I
obj='Var
pag=5
prev=O1836
var_op='asgn
I
obj='Var
pag=5
prev=O1835
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=5
prev=O1829
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1565
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1566
fatherSonIndex=0
frm_calc=[
'w_norifimp='N'
]
h=[
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1883
fatherSonIndex=0
frm_calc=[
'Upper(Substr(riga,331,9))='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1888
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=5
sel_field='operazbo->NUMPROG
sel_name='operazbo
sel_where='operazbo->INFORM = Substr(riga,424,30) and (operazbo->STATOREG='0' or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1893
fatherSonIndex=0
frm_calc='operazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1888
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=5
sel_field='operazbo->NUMPROG
sel_name='operazbo
sel_where='operazbo->RIFIMP = Substr(riga,331,9) and (operazbo->STATOREG='0' or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1900
fatherSonIndex=0
frm_calc='operazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1564
var_op='asgn
I
obj='Var
pag=5
prev=O1563
var_op='asgn
I
obj='Var
pag=5
prev=O1562
var_op='asgn
I
obj='Var
pag=5
prev=O1559
var_op='asgn
I
obj='If
pag=5
prev=O1558
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O1559
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=5
prev=O1911
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1912
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O1918
I
obj='Var
obj_type='N
pag=5
prev=O1917
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,318,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1557
var_op='asgn
I
obj='Remark
pag=5
prev=O1554
I
obj='If
pag=5
prev=O1552
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1554
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,263,30))+LRTrim(Substr(riga,295,6))+LRTrim(Substr(riga,293,2))))
]
h=[
19
19
]
obj='If
pag=5
prev=O1930
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1933
fatherSonIndex=0
frm_calc='LRTrim(Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=5
prev=O1939
var_op='asgn
I
obj='Var
pag=5
prev=O1938
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1929
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1930
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(Substr(riga,257,6))+" non è presente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=5
prev=O1945
I
obj='Var
obj_type='N
pag=5
prev=O1944
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O1928
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'Substr(riga,257,6)
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=5
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1552
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,246,11))),_codinter,Substr(riga,246,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,263,30))),_citinter,Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,295,6))),_cabinter,Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,293,2))),_prvinter,Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=5
prev=O1957
var_op='asgn
I
obj='Var
pag=5
prev=O1956
var_op='asgn
I
obj='Var
pag=5
prev=O1955
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1547
fatherSonIndex=1
frm_calc='1
len=1
name='_opeerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(ohand,riga+" - "+_descerr)
obj='Exec
pag=5
prev=O1961
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=5
prev=O1544
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1545
fatherSonIndex=0
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Left(riga,8))))
]
h=[
19
19
]
obj='If
pag=5
prev=O1966
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1967
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,190,16))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,206,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,484,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,190,16))) and Empty(LRTrim(Substr(riga,120,25))) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=5
prev=O1981
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1984
fatherSonIndex=0
frm_calc=''Rapporto continuativo o Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O1989
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1978
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1981
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=5
prev=O1995
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1996
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto per conto del quale assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O2001
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O1994
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,484,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1975
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1978
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=5
prev=O2012
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2013
fatherSonIndex=0
frm_calc=''Anagrafica Controparte Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O2018
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O2011
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,302,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1972
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1975
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=5
prev=O2029
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2030
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto Operante Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O2035
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O2028
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,206,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1972
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=5
prev=O2046
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2047
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=5
prev=O2052
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O2045
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,190,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1543
var_op='asgn
I
obj='Var
pag=5
prev=O1542
var_op='asgn
I
obj='Var
obj_type='D
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O1523
var_op='asgn
I
obj='Var
pag=5
prev=O1522
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=5
prev=O1521
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1520
var_op='asgn
I
obj='Var
pag=5
pagelocal=True
prev=O1519
I
obj='Remark
pag=5
x=15
y=15
I
Icpitembatch.CPRead
arch='tbcauana
obj='Read
pag=5
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,10,4)
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
x=607
y=4557
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Frazionate Inserite o Modificate: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','FRAZIOBO','Frazionate Inserite o modificate: '+LRTrim(Str(cNumNew,10,0)))
obj='Exec
pag=6
prev=O2082
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O2081
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O2080
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O2079
var_op='asgn
I
obj='Exec
pag=6
prev=O2078
I
obj='Exec
pag=6
prev=O2077
I
obj='Exec
pag=6
prev=O2075
I
obj='While
pag=6
prev=O2074
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2075
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=6
prev=O2086
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2087
fatherSonIndex=0
frm_calc='NullDate()
len=8
name='_oldreg
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
prev=O2095
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O2097
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,257,6))))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,318,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc='_flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,331,9))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))) or (Empty(LRTrim(_numprog)) and not(Empty(LRTrim(Left(riga,8)))))
]
h=[
19
19
]
obj='If
pag=6
prev=O2119
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2122
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,155,1)='S'
'Substr(riga,155,1)='E'
'Substr(riga,155,1)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,9,1)='1' or Substr(riga,9,1)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,301,1)),'0',iif(Substr(riga,301,1)='S','1',iif(Substr(riga,301,1)='N','0',Substr(riga,301,1))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,231,11))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' frazionate del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,852,19))),0,Val(LRTrim(Substr(riga,852,19))))
len=15
name='_totin
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,871,19))),0,Val(LRTrim(Substr(riga,871,19))))
len=15
name='_totout
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge i dati dell'intermediario controparte
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='fraziobo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_oldidb)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=6
prev=O2153
var_op='asgn
I
obj='If
pag=6
prev=O2151
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2153
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='sogopefbo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='clientifrz
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='beneficfrz
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='terzistifrz
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=6
prev=O2170
sel_field='*
sel_name='fraziobo_agg
sel_where='fraziobo_agg->IDBASE=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='fraziobo_agg
father=O2171
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDBASE
'CODLOB
'TIPOGIOCO
'CACODICE
'IDBIGLIETTO
'CADATAORA
'CATIPGIO
'CATIPCON
'CAPV_COD
'IDDOCALL
'VPCODICE
'WUDATRET
'CATEG01
'CATEG02
'CATEG03
'CATEG04
'CATEG05
'CATEGORIA
]
rd_kvar=[
'cOpeProg1
'fraziobo_agg->CODLOB
'fraziobo_agg->TIPOGIOCO
'fraziobo_agg->CACODICE
'fraziobo_agg->IDBIGLIETTO
'fraziobo_agg->CADATAORA
'fraziobo_agg->CATIPGIO
'fraziobo_agg->CATIPCON
'fraziobo_agg->CAPV_COD
'fraziobo_agg->IDDOCALL
'fraziobo_agg->VPCODICE
'fraziobo_agg->WUDATRET
'fraziobo_agg->CATEG01
'fraziobo_agg->CATEG02
'fraziobo_agg->CATEG03
'fraziobo_agg->CATEG04
'fraziobo_agg->CATEG05
'fraziobo_agg->CATEGORIA
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=6
prev=O2168
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=6
prev=O2167
sel_field='*
sel_name='terzistifrz
sel_where='terzistifrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistifrz
father=O2168
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'cOpeProg1
'terzistifrz->CODSOG
'terzistifrz->TIPOFILE
'terzistifrz->NUMCOL
'terzistifrz->LEGAME
'terzistifrz->RAPCOL
'terzistifrz->UCODE
'terzistifrz->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=6
prev=O2165
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=6
prev=O2164
sel_field='*
sel_name='beneficfrz
sel_where='beneficfrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficfrz
father=O2165
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
]
rd_kvar=[
'cOpeProg1
'beneficfrz->CPROWNUM
'beneficfrz->CODSOG
'beneficfrz->TIPOFILE
'beneficfrz->NUMCOL
'beneficfrz->LEGAME
'beneficfrz->RAPCOL
'beneficfrz->UCODE
'beneficfrz->IDBASE
'beneficfrz->C_RAG
'beneficfrz->C_STA
'beneficfrz->C_CTA
'beneficfrz->C_CAB
'beneficfrz->C_PRV
'beneficfrz->C_IND
'beneficfrz->C_CAP
'beneficfrz->C_RAPPORTO
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=6
prev=O2162
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=6
prev=O2161
sel_field='*
sel_name='clientifrz
sel_where='clientifrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientifrz
father=O2162
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'PROQUOTA
'IMPSARA
]
rd_kvar=[
'cOpeProg1
'clientifrz->CODSOG
'clientifrz->LEGAME
'clientifrz->IDBASE
'clientifrz->NUMCOL
'clientifrz->TIPOFILE
'clientifrz->RAPCOL
'clientifrz->UCODE
'clientifrz->PROQUOTA
'clientifrz->IMPSARA
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=6
prev=O2159
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=6
sel_field='*
sel_name='sogopefbo
sel_where='sogopefbo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sogopefbo
father=O2159
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'sogopefbo->CPROWNUM
'sogopefbo->CODSOG
'sogopefbo->LEGAME
'sogopefbo->IDBASE
'sogopefbo->NUMCOL
'sogopefbo->TIPOFILE
'sogopefbo->RAPCOL
'sogopefbo->UCODE
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=6
prev=O2149
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
'IMPIN
'IMPOUT
'MITIG
'SV58550
'PROQUOTA
'IMPSARA
'SV58550MA
'NOSARA
]
rd_kvar=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'Substr(riga,10,4)
'_intercab
'_iccab
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'LRTrim(Substr(riga,484,16))
'LRTrim(Substr(riga,302,16))
'LRTrim(Substr(riga,190,16))
'LRTrim(Substr(riga,206,16))
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_datarett
'_iccit
'_intercit
'_icrag
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'_flagrap2
'cOpeProg1
'cIdCau
'"F"+Right(cOpeProg2,9)+_idb2
'Substr(riga,424,30)
'Substr(riga,813,15)
'Substr(riga,414,5)
'Substr(riga,662,50)
'cOpeProg2
'Substr(riga,328,3)
'_idreg
''1'
'iif(Empty(Substr(riga,828,14)) or Substr(riga,828,14)='01010001000000',NullDateTime(),CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6)))
'_icsta
'Substr(riga,812,1)
'nProgImp
'_icprv
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
'_statoreg
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'_colleg
'_idb2
'_totin / 100
'_totout / 100
'Val(Substr(riga,893,4))
'Substr(riga,897,1)
'Val(Substr(riga,898,3))
'Val(Substr(riga,901,19))/100
'Substr(riga,920,2)
'iif(Empty(LRTrim(Substr(riga,922,1))) or Substr(riga,922,1)='0' or Substr(riga,922,1)='N','N','S')
]
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2151
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=6
prev=O2222
I
obj='Var
obj_type='N
pag=6
prev=O2221
var_op='asgn
I
obj='Exec
pag=6
prev=O2220
I
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Begin
pag=6
prev=O2147
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2149
fatherSonIndex=0
frm_calc='''
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=50
name='_icrag
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,18,11)))) and Len(LRTrim(Substr(riga,64,6)+Substr(riga,70,50)+Substr(riga,29,3)+Substr(riga,62,2)+Substr(riga,32,30))) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
prev=O2231
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O2232
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(_icrag),50)
len=50
name='_icrag
obj='Var
pag=6
prev=O2237
var_op='asgn
I
obj='Read
pag=6
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'Substr(riga,18,11)
]
rd_var=[
'_iccab
'_iccit
'_icprv
'_icsta
'_icrag
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2232
fatherSonIndex=1
frm_calc='Substr(riga,64,6)
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,32,30)
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,62,2)
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,29,3))
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,70,50)
len=50
name='_icrag
obj='Var
pag=6
prev=O2247
var_op='asgn
I
obj='Var
pag=6
prev=O2246
var_op='asgn
I
obj='Var
pag=6
prev=O2245
var_op='asgn
I
obj='Var
pag=6
prev=O2244
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=6
prev=O2230
var_op='asgn
I
obj='Var
pag=6
prev=O2229
var_op='asgn
I
obj='Var
pag=6
prev=O2228
var_op='asgn
I
obj='Var
pag=6
prev=O2227
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
prev=O2146
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2147
fatherSonIndex=0
frm_calc='Upper(Substr(riga,511,70))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,581,3))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,584,30))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,614,6)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,620,2))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,622,35))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,657,5))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,302,16))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=6
prev=O2263
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2266
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,120,25))))
]
h=[
19
19
]
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2271
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=6
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2276
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=6
prev=O2287
I
obj='Read
pag=6
prev=O2286
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=6
prev=O2285
var_op='asgn
I
obj='Var
pag=6
prev=O2284
var_op='asgn
I
obj='Var
pag=6
prev=O2283
var_op='asgn
I
obj='Var
pag=6
prev=O2282
var_op='asgn
I
obj='Var
pag=6
prev=O2281
var_op='asgn
I
obj='Var
pag=6
prev=O2280
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O2260
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2263
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=6
prev=O2304
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,302,16)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=6
prev=O2303
var_op='asgn
I
obj='Var
pag=6
prev=O2302
var_op='asgn
I
obj='Var
pag=6
prev=O2301
var_op='asgn
I
obj='Var
pag=6
prev=O2300
var_op='asgn
I
obj='Var
pag=6
prev=O2299
var_op='asgn
I
obj='Var
pag=6
prev=O2298
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O2259
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O2260
fatherSonIndex=0
obj='Read
pag=6
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O2258
var_op='asgn
I
obj='Var
pag=6
prev=O2257
var_op='asgn
I
obj='Var
pag=6
prev=O2256
var_op='asgn
I
obj='Var
pag=6
prev=O2255
var_op='asgn
I
obj='Var
pag=6
prev=O2254
var_op='asgn
I
obj='Var
pag=6
prev=O2253
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O2145
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O2144
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O2143
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O2142
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O2140
var_op='asgn
I
obj='Select
pag=6
par_expr=[
'Substr(riga,10,4)
'Substr(riga,14,2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O2139
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2140
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O2138
var_op='asgn
I
obj='Var
pag=6
prev=O2137
var_op='asgn
I
obj='Var
pag=6
prev=O2136
var_op='asgn
I
obj='Var
pag=6
prev=O2135
var_op='asgn
I
obj='Var
pag=6
prev=O2132
var_op='asgn
I
obj='Case
pag=6
prev=O2131
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2132
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2132
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2132
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2132
fatherSonIndex=3
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Var
pag=6
prev=O2130
var_op='asgn
I
obj='Var
pag=6
prev=O2127
var_op='asgn
I
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2127
fatherSonIndex=0
frm_calc='_numprog
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''1'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
next=Icpitembatch.CPVarDecl
frm_calc='_oldreg
len=8
name='_datareg
obj='Var
obj_type='D
pag=6
prev=O2340
var_op='asgn
I
obj='Var
obj_type='D
pag=6
prev=O2339
var_op='asgn
I
obj='Var
pag=6
prev=O2338
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2127
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PFRAZIO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''0'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datarett
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0 or Empty(Substr(riga,147,8)),Date(),arfn_datefchar(Substr(riga,147,8)))
len=8
name='_datareg
obj='Var
obj_type='D
pag=6
prev=O2345
var_op='asgn
I
obj='Var
obj_type='D
pag=6
prev=O2344
var_op='asgn
I
obj='Var
pag=6
prev=O2343
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O2116
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2119
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Left(riga,8)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2351
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=6
prev=O2356
sel_field='fraziobo->IDBASE
sel_name='fraziobo
sel_where='fraziobo->NUMPROG=_numprog and (fraziobo->STATOREG='0'  or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O2357
fatherSonIndex=0
frm_calc='"E' stata cancellata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=6
prev=O2361
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'fraziobo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
]
wr_var=[
''2'
'Date()
]
I
nonlocal=True
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
father=O2351
fatherSonIndex=1
frm_calc=''JLMNOTUV?'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"E' stata variata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=6
prev=O2372
sel_field='fraziobo->IDBASE,fraziobo->NUMPROG,fraziobo->DATAOPE,fraziobo->FLAGRAP2,fraziobo->IDEREG,fraziobo->DATAREG
sel_name='fraziobo
sel_where='fraziobo->NUMPROG=_numprog and (fraziobo->STATOREG='0'  or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2373
fatherSonIndex=0
frm_calc='fraziobo->IDBASE
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(fraziobo->FLAGRAP2) or fraziobo->FLAGRAP2='Z',Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(fraziobo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='fraziobo->IDEREG
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
frm_calc='fraziobo->DATAREG
len=8
name='_oldreg
next=Icpitembatch.CPWrite
arch='fraziobo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=6
prev=O2386
sel_field='*
sel_name='terzistifrz
sel_where='terzistifrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='merzistifrz
father=O2388
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'IDREG
]
rd_kvar=[
'_oldidb
'terzistifrz->CODSOG
'terzistifrz->TIPOFILE
'terzistifrz->NUMCOL
'terzistifrz->LEGAME
'terzistifrz->RAPCOL
'terzistifrz->UCODE
'terzistifrz->IDBASE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=6
prev=O2384
sel_field='*
sel_name='beneficfrz
sel_where='beneficfrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='meneficfrz
father=O2386
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
'IDREG
]
rd_kvar=[
'_oldidb
'beneficfrz->CPROWNUM
'beneficfrz->CODSOG
'beneficfrz->TIPOFILE
'beneficfrz->NUMCOL
'beneficfrz->LEGAME
'beneficfrz->RAPCOL
'beneficfrz->UCODE
'beneficfrz->IDBASE
'beneficfrz->C_RAG
'beneficfrz->C_STA
'beneficfrz->C_CTA
'beneficfrz->C_CAB
'beneficfrz->C_PRV
'beneficfrz->C_IND
'beneficfrz->C_CAP
'beneficfrz->C_RAPPORTO
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=6
prev=O2382
sel_field='*
sel_name='clientifrz
sel_where='clientifrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mlientifrz
father=O2384
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
'PROQUOTA
'IMPSARA
]
rd_kvar=[
'_oldidb
'clientifrz->CODSOG
'clientifrz->LEGAME
'clientifrz->IDBASE
'clientifrz->NUMCOL
'clientifrz->TIPOFILE
'clientifrz->RAPCOL
'clientifrz->UCODE
'_idreg
'clientifrz->PROQUOTA
'clientifrz->IMPSARA
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=6
prev=O2381
sel_field='*
sel_name='sogopefbo
sel_where='sogopefbo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mogopefbo
father=O2382
fatherSonIndex=0
obj='Insert
pag=6
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'sogopefbo->CPROWNUM
'sogopefbo->CODSOG
'sogopefbo->LEGAME
'sogopefbo->IDBASE
'sogopefbo->NUMCOL
'sogopefbo->TIPOFILE
'sogopefbo->RAPCOL
'sogopefbo->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=6
prev=O2380
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'fraziobo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
'FLAGRAP2
]
wr_op=[
'=
'=
'=
]
wr_var=[
''3'
'iif(Empty(LRTrim(Substr(riga,147,8))),Date(),arfn_datefchar(Substr(riga,147,8)))
'_flagrap2
]
I
obj='Var
obj_type='D
pag=6
prev=O2379
var_op='asgn
I
obj='Var
pag=6
prev=O2378
var_op='asgn
I
obj='Var
pag=6
prev=O2377
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=6
prev=O2371
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O2115
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2116
fatherSonIndex=0
frm_calc=[
'w_norifimp='N'
]
h=[
19
19
]
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2425
fatherSonIndex=0
frm_calc=[
'Upper(Substr(riga,331,9))='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2430
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=6
sel_field='fraziobo->NUMPROG
sel_name='fraziobo
sel_where='fraziobo->INFORM = Substr(riga,424,30) and (fraziobo->STATOREG='0' or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2435
fatherSonIndex=0
frm_calc='fraziobo->NUMPROG
len=11
name='_numprog
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2430
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=6
sel_field='fraziobo->NUMPROG
sel_name='fraziobo
sel_where='fraziobo->RIFIMP = Substr(riga,331,9) and (fraziobo->STATOREG='0' or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2442
fatherSonIndex=0
frm_calc='fraziobo->NUMPROG
len=11
name='_numprog
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O2114
var_op='asgn
I
obj='Var
pag=6
prev=O2113
var_op='asgn
I
obj='Var
pag=6
prev=O2112
var_op='asgn
I
obj='Var
pag=6
prev=O2109
var_op='asgn
I
obj='If
pag=6
prev=O2108
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='fraziobo
father=O2109
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=6
prev=O2453
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2454
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=6
prev=O2460
I
obj='Var
obj_type='N
pag=6
prev=O2459
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,318,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
prev=O2107
var_op='asgn
I
obj='Remark
pag=6
prev=O2104
I
obj='If
pag=6
prev=O2102
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2104
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,263,30))+LRTrim(Substr(riga,295,6))+LRTrim(Substr(riga,293,2))))
]
h=[
19
19
]
obj='If
pag=6
prev=O2472
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2475
fatherSonIndex=0
frm_calc='LRTrim(Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=6
prev=O2481
var_op='asgn
I
obj='Var
pag=6
prev=O2480
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O2471
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2472
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(Substr(riga,257,6))+" non è presente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=6
prev=O2487
I
obj='Var
obj_type='N
pag=6
prev=O2486
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O2470
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'Substr(riga,257,6)
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=6
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2102
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,246,11))),_codinter,Substr(riga,246,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,263,30))),_citinter,Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,295,6))),_cabinter,Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,293,2))),_prvinter,Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=6
prev=O2499
var_op='asgn
I
obj='Var
pag=6
prev=O2498
var_op='asgn
I
obj='Var
pag=6
prev=O2497
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2097
fatherSonIndex=1
frm_calc='1
len=1
name='_frzerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(zhand,riga+" - "+_descerr)
obj='Exec
pag=6
prev=O2503
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=6
prev=O2094
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2095
fatherSonIndex=0
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Left(riga,8))))
]
h=[
19
19
]
obj='If
pag=6
prev=O2508
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2509
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,190,16))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,206,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,484,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,190,16))) and Empty(LRTrim(Substr(riga,120,25))) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=6
prev=O2523
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2526
fatherSonIndex=0
frm_calc=''Rapporto continuativo Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O2531
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O2520
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2523
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=6
prev=O2537
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2538
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto per conto del quale assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O2543
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O2536
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,484,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O2517
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2520
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=6
prev=O2554
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2555
fatherSonIndex=0
frm_calc=''Anagrafica Controparte Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O2560
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O2553
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,302,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
prev=O2514
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2517
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=6
prev=O2571
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2572
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto Operante Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O2577
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O2570
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,206,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2514
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=6
prev=O2588
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2589
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=6
prev=O2594
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O2587
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,190,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O2093
var_op='asgn
I
obj='Var
pag=6
prev=O2092
var_op='asgn
I
obj='Var
obj_type='D
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
prev=O2073
var_op='asgn
I
obj='Var
pag=6
prev=O2072
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O2071
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O2070
var_op='asgn
I
obj='Var
pag=6
pagelocal=True
prev=O2069
I
obj='Remark
pag=6
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Rapporti Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Rapporti Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=7
prev=O2618
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=7
prev=O2617
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=7
prev=O2616
var_op='asgn
I
obj='Exec
pag=7
prev=O2615
I
obj='Exec
pag=7
prev=O2614
I
obj='Exec
pag=7
prev=O2612
I
obj='While
pag=7
prev=O2611
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2612
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=7
prev=O2622
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2623
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' rapporti del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='cFlagLire
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,77,1)='S'
'Substr(riga,77,1)='E'
'Substr(riga,77,1)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='xRapporto
next=Icpitembatch.CPRead
arch='xnarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xRapporto))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=7
prev=O2635
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O2636
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xnarapbo
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='knarapbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=7
prev=O2644
var_op='asgn
I
obj='Insert
pag=7
prev=O2642
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGRAP
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
''P'
'Substr(riga,76,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2644
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=7
prev=O2653
I
obj='Var
obj_type='N
pag=7
prev=O2652
var_op='asgn
I
obj='Exec
pag=7
prev=O2651
I
nonlocal=True
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Insert
pag=7
prev=O2641
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
'AMMONT
'DURAT
'TIPO
'RRAGIO
'RCOMP
'RAREA
'RIMP
'RFREQ
'RTIPO
'NATURA
'SCOPO
'MITIG
'PRGIMPRAP
'RISGLOB
'DATAPROF
'DATAREVPROF
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,94,5)),3))
'Substr(riga,99,5)
'Substr(riga,104,5)
'Substr(riga,109,5)
'Val(Substr(riga,114,3))
'Val(Substr(riga,117,3))
'Val(Substr(riga,120,3))
'Val(Substr(riga,123,3))
'Val(Substr(riga,126,3))
'Val(Substr(riga,129,3))
'Substr(riga,132,50)
'Substr(riga,182,50)
'Val(Substr(riga,298,4))
'nProgImp
'Substr(riga,318,3)
'CharToDate(Substr(riga,306,4)+Substr(riga,304,2)+Substr(riga,302,2))
'CharToDate(Substr(riga,314,4)+Substr(riga,312,2)+Substr(riga,310,2))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2642
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=7
prev=O2662
I
obj='Var
obj_type='N
pag=7
prev=O2661
var_op='asgn
I
obj='Exec
pag=7
prev=O2660
I
nonlocal=True
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='xnarapbo
father=O2636
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='knarapbo
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=7
prev=O2668
var_op='asgn
I
obj='Write
pag=7
prev=O2666
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'DESCRAP
'FLAGRAP
'TIPORAP
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Substr(riga,26,50)
'Substr(riga,76,1)
''P'
]
I
obj='Write
pag=7
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2666
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=7
prev=O2683
I
obj='Var
obj_type='N
pag=7
prev=O2682
var_op='asgn
I
obj='Exec
pag=7
prev=O2681
I
nonlocal=True
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
'AMMONT
'DURAT
'TIPO
'RRAGIO
'RCOMP
'RAREA
'RIMP
'RFREQ
'RTIPO
'NATURA
'SCOPO
'MITIG
'RISGLOB
'DATAPROF
'DATAREVPROF
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,94,5)),3))
'Substr(riga,99,5)
'Substr(riga,104,5)
'Substr(riga,109,5)
'Val(Substr(riga,114,3))
'Val(Substr(riga,117,3))
'Val(Substr(riga,120,3))
'Val(Substr(riga,123,3))
'Val(Substr(riga,126,3))
'Val(Substr(riga,129,3))
'Substr(riga,132,50)
'Substr(riga,182,50)
'Val(Substr(riga,298,4))
'Substr(riga,318,3)
'CharToDate(Substr(riga,306,4)+Substr(riga,304,2)+Substr(riga,302,2))
'CharToDate(Substr(riga,314,4)+Substr(riga,312,2)+Substr(riga,310,2))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=7
prev=O2634
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Left(riga,25)
]
rd_var=[
'xRapporto
]
I
obj='Var
pag=7
prev=O2631
var_op='asgn
I
obj='Case
pag=7
prev=O2630
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2631
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2631
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2631
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2631
fatherSonIndex=3
frm_calc='Substr(riga,77,1)
len=1
name='cFlagLire
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Var
pag=7
prev=O2629
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=7
prev=O2628
var_op='asgn
I
obj='Var
obj_type='N
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=7
prev=O2610
var_op='asgn
I
obj='Var
pag=7
prev=O2609
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=7
prev=O2608
var_op='asgn
I
obj='Var
obj_type='N
pag=7
prev=O2607
var_op='asgn
I
obj='Var
obj_type='N
pag=7
prev=O2606
var_op='asgn
I
obj='Remark
pag=7
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Informazione Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O2717
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O2716
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O2715
var_op='asgn
I
obj='Exec
pag=8
prev=O2714
I
obj='Exec
pag=8
prev=O2713
I
obj='Exec
pag=8
prev=O2711
I
obj='While
pag=8
prev=O2710
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2711
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=8
prev=O2721
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O2722
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='cCli1
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,75,16)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,50,16)
len=16
name='xSOCTCon
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xSOCTCon)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' informazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,46,1)='S'
'Substr(riga,46,1)='E'
'Substr(riga,46,1)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,159,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,36,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPInsert
arch='xapopebo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,219,16)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,44,2) <> '25' and Substr(riga,44,2) <> '28'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
prev=O2762
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2765
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(cCli1))
]
h=[
19
19
]
obj='If
pag=8
prev=O2770
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2771
fatherSonIndex=0
frm_calc=[
'Substr(riga,44,2)='25' or Substr(riga,44,2)='28'
'Substr(riga,45,1)='6' or Substr(riga,44,2)='38'
]
h=[
19
19
19
19
]
haselse=True
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2776
fatherSonIndex=0
frm_calc=[
'Substr(riga,44,2)='25'
'Substr(riga,44,2)='28'
]
h=[
19
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xelegabo
father=O2781
fatherSonIndex=0
h=[
19
19
]
obj='Insert
pag=8
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2786
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O2794
I
obj='Var
obj_type='N
pag=8
prev=O2793
var_op='asgn
I
obj='Exec
pag=8
prev=O2792
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xelegabo
father=O2781
fatherSonIndex=1
h=[
19
19
]
obj='Insert
pag=8
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAFINE
'TIPOPERS
'CODINTER
'NUMPROG2
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2798
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O2806
I
obj='Var
obj_type='N
pag=8
prev=O2805
var_op='asgn
I
obj='Exec
pag=8
prev=O2804
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPInsert
arch='xntestbo
father=O2776
fatherSonIndex=1
h=[
19
19
]
obj='Insert
pag=8
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAFINE
'TIPOPERS
'CODINTER
'NUMPROG2
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2811
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O2819
I
obj='Var
obj_type='N
pag=8
prev=O2818
var_op='asgn
I
obj='Exec
pag=8
prev=O2817
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xntestbo
father=O2776
fatherSonIndex=2
h=[
19
19
]
obj='Insert
pag=8
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
'PRGIMPSOG
'PROQUOTA
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
'nProgImp2
'Val(Substr(riga,235,3))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2823
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O2831
I
obj='Var
obj_type='N
pag=8
prev=O2830
var_op='asgn
I
obj='Exec
pag=8
prev=O2829
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2765
fatherSonIndex=1
frm_calc=[
'Substr(riga,44,2)='25' or Substr(riga,44,2)='28'
'Substr(riga,45,1)='6' or Substr(riga,44,2)='38'
]
h=[
19
19
19
19
]
haselse=True
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xntestbo
father=O2837
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=8
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cNumMod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2843
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O2852
I
obj='Var
obj_type='N
pag=8
prev=O2851
var_op='asgn
I
obj='Exec
pag=8
prev=O2850
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
'PROQUOTA
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'Val(Substr(riga,235,3))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xntestbo
father=O2837
fatherSonIndex=2
h=[
19
19
]
obj='Write
pag=8
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cNumMod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2859
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O2868
I
obj='Var
obj_type='N
pag=8
prev=O2867
var_op='asgn
I
obj='Exec
pag=8
prev=O2866
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'PROQUOTA
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'Val(Substr(riga,235,3))
]
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=8
prev=O2761
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O2762
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=8
sel_field='*
sel_name='xntestbo
sel_order='xntestbo->CPROWNUM
sel_where='xntestbo->RAPPORTO=Substr(riga,9,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2878
fatherSonIndex=0
frm_calc=[
'xntestbo->CODINTER=cCli1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=8
prev=O2882
var_op='asgn
I
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2882
fatherSonIndex=0
frm_calc='xntestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
prev=O2760
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O2759
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O2756
var_op='asgn
I
obj='If
pag=8
prev=O2754
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xiduciabo
father=O2756
fatherSonIndex=0
obj='Insert
pag=8
rd_kfield=[
'IDFILEBO
'CODSOG
'NUMCOL
'RAPCOL
'IDBASE
]
rd_kvar=[
'cInfProg1
'LRTrim(Substr(riga,219,16))
'cInfProg2
'Substr(riga,9,25)
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=8
prev=O2753
rd_kfield=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'VALUTA
'CDATREG
'IDBASE2
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'_cabinter
'Substr(riga,115,6)
'_intercod
'iif((_dataope < CharToDate('20100601') or _dataope > CharToDate('20131231')),xSOCTCF,'')
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_intercit
'Substr(riga,169,50)
'cFlagLire
'Substr(riga,34,1)
'cInfProg1
''I'+Right(cInfProg2,9)+_idb2
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'iif((_dataope < CharToDate('20100601') or _dataope > CharToDate('20131231')),Substr(riga,35,1),' ')
'Substr(riga,44,2)
'Substr(riga,159,10)
'Substr(riga,47,3)
'DateToChar(_datareg)
'_idb2
]
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2754
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O2904
I
obj='Var
obj_type='N
pag=8
prev=O2903
var_op='asgn
I
obj='Exec
pag=8
prev=O2902
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=8
prev=O2752
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O2751
var_op='asgn
I
obj='Var
pag=8
prev=O2750
var_op='asgn
I
obj='Var
pag=8
prev=O2749
var_op='asgn
I
obj='Var
obj_type='D
pag=8
prev=O2748
var_op='asgn
I
obj='Var
obj_type='D
pag=8
prev=O2745
var_op='asgn
I
obj='If
pag=8
prev=O2744
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xapopebo
father=O2745
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'_unicode<>''
]
h=[
19
19
]
obj='If
pag=8
prev=O2909
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2910
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=8
prev=O2916
I
obj='Var
obj_type='N
pag=8
prev=O2915
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,159,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
prev=O2743
var_op='asgn
I
obj='Remark
pag=8
prev=O2740
I
obj='Case
pag=8
prev=O2739
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2740
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2740
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2740
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2740
fatherSonIndex=3
frm_calc='Substr(riga,46,1)
len=1
name='cFlagLire
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O2738
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O2735
var_op='asgn
I
obj='If
pag=8
prev=O2734
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='personbo
father=O2735
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=8
prev=O2936
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O2937
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=8
prev=O2942
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2943
fatherSonIndex=0
frm_calc='xSOCTCon
len=16
name='xSOCTCF
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
prev=O2733
var_op='asgn
I
obj='Var
pag=8
prev=O2730
var_op='asgn
I
obj='If
pag=8
prev=O2729
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2730
fatherSonIndex=0
frm_calc='Substr(riga,75,16)
len=16
name='xConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
obj='If
pag=8
prev=O2963
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O2964
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
obj='If
pag=8
prev=O2969
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2970
fatherSonIndex=0
frm_calc='xConnes
len=16
name='cCli1
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
prev=O2962
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
prev=O2727
var_op='asgn
I
obj='Begin
pag=8
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2727
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,104,11))),_codinter,Substr(riga,104,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,121,30))),_citinter,Substr(riga,121,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,153,6))),_cabinter,Substr(riga,153,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,151,2))),_prvinter,Substr(riga,151,2))
len=2
name='_interprv
obj='Var
pag=8
prev=O2991
var_op='asgn
I
obj='Var
pag=8
prev=O2990
var_op='asgn
I
obj='Var
pag=8
prev=O2989
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=8
prev=O2709
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O2708
var_op='asgn
I
obj='Var
pag=8
prev=O2707
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O2706
var_op='asgn
I
obj='Remark
pag=8
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','XPERAZBO','Operazioni Inserite: '+LRTrim(Str(cNumNew,10,0)))
obj='Exec
pag=9
prev=O3008
I
nonlocal=True
obj='Var
obj_type='M
pag=9
prev=O3007
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=9
prev=O3006
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=9
prev=O3005
var_op='asgn
I
obj='Exec
pag=9
prev=O3004
I
obj='Exec
pag=9
prev=O3003
I
obj='Exec
pag=9
prev=O3001
I
obj='While
pag=9
prev=O3000
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3001
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=9
prev=O3013
var_op='asgn
I
obj='If
pag=9
prev=O3012
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3013
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_oldidb
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgRet='S'
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
prev=O3024
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O3026
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,257,6))))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,318,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc='_flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,331,9))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog))) and Empty(LRTrim(Left(riga,8)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Left(riga,8)))) 
]
h=[
19
19
]
obj='If
pag=9
prev=O3048
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Prepara i dati comuni
father=O3051
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog)))
'Empty(LRTrim(_numprog))
]
h=[
19
19
19
]
obj='If
pag=9
prev=O3056
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O3058
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=9
prev=O3063
var_op='asgn
I
obj='Write
pag=9
rd_kfield=[
'NUMPROG
]
rd_kop=[
'=
]
rd_kvar=[
'_numprog
]
wr_field=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'idcauana
'IMPIN
'IMPOUT
'INFORM
'IPCOLLEG
'MITIG
'MODSVOL
'NATURA
'OPERAG
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROQUOTA
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'SV58550
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'IMPSARA
'SV58550MA
'NOSARA
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'Substr(riga,10,4)
'_intercab
'_iccab
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'_colleg
'LRTrim(Substr(riga,484,16))
'LRTrim(Substr(riga,302,16))
'LRTrim(Substr(riga,190,16))
'LRTrim(Substr(riga,206,16))
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_iccit
'_intercit
'_icrag
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'_flagrap2
'cIdCau
'_totin / 100
'_totout / 100
'Substr(riga,424,30)
'Substr(riga,813,15)
'Val(Substr(riga,893,4))
'Substr(riga,414,5)
'Substr(riga,662,50)
'Substr(riga,328,3)
''1'
'iif(Empty(Substr(riga,828,14)) or Substr(riga,828,14)='01010001000000',NullDateTime(),CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6)))
'_icsta
'Substr(riga,812,1)
'nProgImp
'Val(Substr(riga,898,3))
'_icprv
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
''0'
'Substr(riga,897,1)
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'Val(Substr(riga,901,19))/100
'Substr(riga,920,2)
'iif(Empty(LRTrim(Substr(riga,922,1))) or Substr(riga,922,1)='0' or Substr(riga,922,1)='N','N','S')
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3058
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PPOPER1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPInsert
arch='xperazbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=9
prev=O3074
var_op='asgn
I
obj='Insert
pag=9
prev=O3073
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
'IMPIN
'IMPOUT
'MITIG
'SV58550
'PROQUOTA
'IMPSARA
'SV58550MA
'NOSARA
]
rd_kvar=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'Substr(riga,10,4)
'_intercab
'_iccab
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'LRTrim(Substr(riga,484,16))
'LRTrim(Substr(riga,302,16))
'LRTrim(Substr(riga,190,16))
'LRTrim(Substr(riga,206,16))
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_iccit
'_intercit
'_icrag
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'cOpeProg1
'cIdCau
'"O"+Right(cOpeProg2,9)+_idb2
'Substr(riga,424,30)
'Substr(riga,813,15)
'Substr(riga,414,5)
'Substr(riga,662,50)
'cOpeProg2
'Substr(riga,328,3)
''1'
'iif(Empty(Substr(riga,828,14)) or Substr(riga,828,14)='01010001000000',NullDateTime(),CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6)))
'_icsta
'Substr(riga,812,1)
'nProgImp
'_icprv
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
''0'
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'_colleg
'_idb2
'_totin / 100
'_totout / 100
'Val(Substr(riga,893,4))
'Substr(riga,897,1)
'Val(Substr(riga,898,3))
'Val(Substr(riga,901,19))/100
'Substr(riga,920,2)
'iif(Empty(LRTrim(Substr(riga,922,1))) or Substr(riga,922,1)='0' or Substr(riga,922,1)='N','N','S')
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3074
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=9
prev=O3083
I
obj='Var
obj_type='N
pag=9
prev=O3082
var_op='asgn
I
obj='Exec
pag=9
prev=O3081
I
nonlocal=True
obj='Var
obj_type='M
pag=9
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=9
prev=O3072
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O3056
fatherSonIndex=0
frm_calc=[
'Substr(riga,155,1)='S'
'Substr(riga,155,1)='E'
'Substr(riga,155,1)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,147,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,9,1)='1' or Substr(riga,9,1)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,301,1)),'0',iif(Substr(riga,301,1)='S','1',iif(Substr(riga,301,1)='N','0',Substr(riga,301,1))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,231,11))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,852,19))),0,Val(LRTrim(Substr(riga,852,19))))
len=15
name='_totin
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,871,19))),0,Val(LRTrim(Substr(riga,871,19))))
len=15
name='_totout
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge i dati dell'intermediario controparte
h=[
19
19
]
obj='Begin
pag=9
prev=O3105
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3107
fatherSonIndex=0
frm_calc='''
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=50
name='_icrag
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,18,11)))) and Len(LRTrim(Substr(riga,64,6)+Substr(riga,70,50)+Substr(riga,29,3)+Substr(riga,62,2)+Substr(riga,32,30))) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
prev=O3115
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O3116
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(_icrag),50)
len=50
name='_icrag
obj='Var
pag=9
prev=O3121
var_op='asgn
I
obj='Read
pag=9
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'Substr(riga,18,11)
]
rd_var=[
'_iccab
'_iccit
'_icprv
'_icsta
'_icrag
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3116
fatherSonIndex=1
frm_calc='Substr(riga,64,6)
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,32,30)
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,62,2)
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,29,3))
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,70,50)
len=50
name='_icrag
obj='Var
pag=9
prev=O3131
var_op='asgn
I
obj='Var
pag=9
prev=O3130
var_op='asgn
I
obj='Var
pag=9
prev=O3129
var_op='asgn
I
obj='Var
pag=9
prev=O3128
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=9
prev=O3114
var_op='asgn
I
obj='Var
pag=9
prev=O3113
var_op='asgn
I
obj='Var
pag=9
prev=O3112
var_op='asgn
I
obj='Var
pag=9
prev=O3111
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=9
prev=O3104
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3105
fatherSonIndex=0
frm_calc='Upper(Substr(riga,511,70))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,581,3))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,584,30))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,614,6)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,620,2))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,622,35))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,657,5))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,302,16))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=9
prev=O3147
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3150
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,120,25))))
]
h=[
19
19
]
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3155
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=9
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3160
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=9
prev=O3171
I
obj='Read
pag=9
prev=O3170
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=9
prev=O3169
var_op='asgn
I
obj='Var
pag=9
prev=O3168
var_op='asgn
I
obj='Var
pag=9
prev=O3167
var_op='asgn
I
obj='Var
pag=9
prev=O3166
var_op='asgn
I
obj='Var
pag=9
prev=O3165
var_op='asgn
I
obj='Var
pag=9
prev=O3164
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O3144
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3147
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=9
prev=O3188
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,302,16)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=9
prev=O3187
var_op='asgn
I
obj='Var
pag=9
prev=O3186
var_op='asgn
I
obj='Var
pag=9
prev=O3185
var_op='asgn
I
obj='Var
pag=9
prev=O3184
var_op='asgn
I
obj='Var
pag=9
prev=O3183
var_op='asgn
I
obj='Var
pag=9
prev=O3182
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O3143
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O3144
fatherSonIndex=0
obj='Read
pag=9
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O3142
var_op='asgn
I
obj='Var
pag=9
prev=O3141
var_op='asgn
I
obj='Var
pag=9
prev=O3140
var_op='asgn
I
obj='Var
pag=9
prev=O3139
var_op='asgn
I
obj='Var
pag=9
prev=O3138
var_op='asgn
I
obj='Var
pag=9
prev=O3137
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=9
prev=O3103
var_op='asgn
I
obj='Var
obj_type='N
pag=9
prev=O3102
var_op='asgn
I
obj='Var
obj_type='N
pag=9
prev=O3100
var_op='asgn
I
obj='Select
pag=9
par_expr=[
'Substr(riga,10,4)
'Substr(riga,14,2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O3099
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3100
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O3098
var_op='asgn
I
obj='Var
pag=9
prev=O3097
var_op='asgn
I
obj='Var
pag=9
prev=O3096
var_op='asgn
I
obj='Var
pag=9
prev=O3095
var_op='asgn
I
obj='Var
pag=9
prev=O3094
var_op='asgn
I
obj='Var
obj_type='D
pag=9
prev=O3093
var_op='asgn
I
obj='Var
pag=9
prev=O3092
var_op='asgn
I
obj='Var
pag=9
prev=O3089
var_op='asgn
I
obj='Case
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3089
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3089
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3089
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3089
fatherSonIndex=3
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O3045
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3048
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=9
sel_field='xperazbo->IDBASE
sel_name='xperazbo
sel_where='xperazbo->NUMPROG=_numprog
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O3224
fatherSonIndex=0
frm_calc='"E' stata cancellata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPDelete
arch='xperazbo
obj='Delete
pag=9
prev=O3228
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'xperazbo->IDBASE
]
I
nonlocal=True
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O3044
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3045
fatherSonIndex=0
frm_calc=[
'Upper(Substr(riga,331,9))='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3237
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=9
sel_field='xperazbo->NUMPROG
sel_name='xperazbo
sel_where='xperazbo->INFORM = Substr(riga,424,30)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3242
fatherSonIndex=0
frm_calc='xperazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3237
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=9
sel_field='xperazbo->NUMPROG
sel_name='xperazbo
sel_where='xperazbo->RIFIMP = Substr(riga,331,9)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3249
fatherSonIndex=0
frm_calc='xperazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O3043
var_op='asgn
I
obj='Var
pag=9
prev=O3042
var_op='asgn
I
obj='Var
pag=9
prev=O3041
var_op='asgn
I
obj='Var
pag=9
prev=O3038
var_op='asgn
I
obj='If
pag=9
prev=O3037
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O3038
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=9
prev=O3259
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3260
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=9
prev=O3266
I
obj='Var
obj_type='N
pag=9
prev=O3265
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=9
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,318,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O3036
var_op='asgn
I
obj='Remark
pag=9
prev=O3033
I
obj='If
pag=9
prev=O3031
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3033
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Substr(riga,263,30))+LRTrim(Substr(riga,295,6))+LRTrim(Substr(riga,293,2)))
]
h=[
19
19
]
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anadip
father=O3276
fatherSonIndex=0
obj='Read
pag=9
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'Substr(riga,257,6)
]
rd_var=[
'_intercit
'_intercab
'_interprv
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=9
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3031
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,246,11))),_codinter,Substr(riga,246,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,263,30))),_citinter,Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,295,6))),_cabinter,Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,293,2))),_prvinter,Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=9
prev=O3292
var_op='asgn
I
obj='Var
pag=9
prev=O3291
var_op='asgn
I
obj='Var
pag=9
prev=O3290
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3026
fatherSonIndex=1
frm_calc='1
len=1
name='_opeerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(ohand,riga+" - "+_descerr)
obj='Exec
pag=9
prev=O3296
I
obj='Var
obj_type='N
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=9
prev=O3021
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3024
fatherSonIndex=0
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,190,16))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,206,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,484,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,190,16))) and Empty(LRTrim(Substr(riga,120,25))) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=9
prev=O3312
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3315
fatherSonIndex=0
frm_calc=''Rapporto continuativo Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=9
prev=O3320
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O3309
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3312
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=9
prev=O3326
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3327
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto per conto del quale assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=9
prev=O3332
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=9
prev=O3325
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,484,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O3306
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3309
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=9
prev=O3343
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3344
fatherSonIndex=0
frm_calc=''Anagrafica Controparte Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=9
prev=O3349
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=9
prev=O3342
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,302,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O3303
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3306
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=9
prev=O3360
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3361
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto Operante Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=9
prev=O3366
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=9
prev=O3359
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,206,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O3302
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3303
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=9
prev=O3377
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3378
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=9
prev=O3383
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=9
prev=O3376
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,190,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=9
prev=O3301
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O3020
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xarchope
father=O3021
fatherSonIndex=0
obj='Insert
pag=9
rd_kfield=[
'IDPROG
'DATAOPE
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'CONNESCLI
'CONNESOPER
'CAMBIO
'NUMPROG
'TIPOOPRAP
'TIPOINTER
'CODINTER
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'CONNESBEN
'UNIQUECODE
'AGOPER
'RIFIMP
'ZCPARTE
'RAGIO
'MODSVOL
'AREAGEO
'INFORM
'AMMONT
'DURAT
'TIPO
'RRAGIO
'RCOMP
'RAREA
'RIMP
'RFREQ
'CONNALTRO
'DATAIMP
'RTIPO
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'NATURA
'SCOPO
'C_RAPPORTO
'RAPPORTBEN
'PAGASOGOP
'IPCOLLEG
'ORACOLLEG
'DUCOLLEG
'IMPIN
'IMPOUT
'TIPOORO
'MITIG
'SV58550
'PROQUOTA
'IMPSARA
'SV58550MA
]
rd_kvar=[
'conta
'Substr(riga,1,8)        
'Substr(riga,9,1)        
'Substr(riga,10,4)       
'Substr(riga,14,2)       
'Substr(riga,16,2)       
'Substr(riga,18,11)      
'Substr(riga,29,3)       
'Substr(riga,32,30)      
'Substr(riga,62,2)       
'Substr(riga,64,6)       
'Substr(riga,70,50)      
'Substr(riga,120,25)     
'Substr(riga,145,1)      
'Substr(riga,146,1)      
'Substr(riga,147,8)      
'Substr(riga,155,1)      
'Substr(riga,156,3)      
'Substr(riga,159,1)      
'Substr(riga,160,15)     
'Substr(riga,175,15)     
'Substr(riga,190,16)     
'Substr(riga,206,16)     
'Substr(riga,222,9)      
'Substr(riga,231,11)     
'Substr(riga,242,2)      
'Substr(riga,244,2)      
'Substr(riga,246,11)     
'Substr(riga,257,6)      
'Substr(riga,263,30)     
'Substr(riga,293,2)      
'Substr(riga,295,6)      
'Substr(riga,301,1)      
'Substr(riga,302,16)     
'Substr(riga,318,10)     
'Substr(riga,328,3)      
'Substr(riga,331,9)      
'Substr(riga,340,69)     
'Substr(riga,409,5)      
'Substr(riga,414,5)      
'Substr(riga,419,5)      
'Substr(riga,424,30)     
'Substr(riga,454,5)      
'Substr(riga,459,5)      
'Substr(riga,464,5)      
'Substr(riga,469,3)      
'Substr(riga,472,3)      
'Substr(riga,475,3)      
'Substr(riga,478,3)      
'Substr(riga,481,3)      
'Substr(riga,484,16)     
'Substr(riga,500,8)      
'Substr(riga,508,3)      
'Substr(riga,511,70)     
'Substr(riga,581,3)      
'Substr(riga,584,30)     
'Substr(riga,614,6)      
'Substr(riga,620,2)      
'Substr(riga,622,35)     
'Substr(riga,657,5)      
'Substr(riga,662,50)     
'Substr(riga,712,50)     
'Substr(riga,762,25)     
'Substr(riga,787,25)     
'Substr(riga,812,1)      
'Substr(riga,813,15)     
'Substr(riga,828,14)     
'Substr(riga,842,10)     
'Val(Substr(riga,852,19)) / 100
'Val(Substr(riga,871,19)) / 100
'Substr(riga,890,3)
'Val(Substr(riga,893,4))
'Substr(riga,897,1)
'Val(Substr(riga,898,3))
'Val(Substr(riga,901,19))/100
'Substr(riga,920,2)
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O3019
var_op='asgn
I
obj='Var
obj_type='N
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=9
prev=O2999
var_op='asgn
I
obj='Var
pag=9
prev=O2998
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=9
prev=O2997
var_op='asgn
I
obj='Var
obj_type='N
pag=9
prev=O2996
var_op='asgn
I
obj='Remark
pag=9
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Frazionate Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','XRAZIOBO','Frazionate Inserite: '+LRTrim(Str(cNumNew,10,0)))
obj='Exec
pag=10
prev=O3412
I
nonlocal=True
obj='Var
obj_type='M
pag=10
prev=O3411
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=10
prev=O3410
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=10
prev=O3409
var_op='asgn
I
obj='Exec
pag=10
prev=O3408
I
obj='Exec
pag=10
prev=O3407
I
obj='Exec
pag=10
prev=O3405
I
obj='While
pag=10
prev=O3404
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3405
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=10
prev=O3416
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3417
fatherSonIndex=0
frm_calc='''
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgRet='S'
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
prev=O3427
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O3429
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,257,6))))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,318,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc='_flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,331,9))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog))) and Empty(LRTrim(Left(riga,8)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Left(riga,8))))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' frazionate del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=10
prev=O3457
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=10
prev=O3454
var_op='asgn
I
obj='If
pag=10
prev=O3451
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati comuni
father=O3454
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog)))
'Empty(LRTrim(_numprog))
]
h=[
19
19
19
]
obj='If
pag=10
prev=O3461
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xraziobo
father=O3463
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=10
prev=O3468
var_op='asgn
I
obj='Write
pag=10
rd_kfield=[
'NUMPROG
]
rd_kop=[
'=
]
rd_kvar=[
'_numprog
]
wr_field=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'idcauana
'IMPIN
'IMPOUT
'INFORM
'IPCOLLEG
'MITIG
'MODSVOL
'NATURA
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPFRZ
'PROQUOTA
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'SV58550
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'IMPSARA
'SV58550MA
'NOSARA
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'Substr(riga,10,4)
'_intercab
'_iccab
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'_colleg
'LRTrim(Substr(riga,484,16))
'LRTrim(Substr(riga,302,16))
'LRTrim(Substr(riga,190,16))
'LRTrim(Substr(riga,206,16))
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_iccit
'_intercit
'_icrag
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'_flagrap2
'cIdCau
'_totin / 100
'_totout / 100
'Substr(riga,424,30)
'Substr(riga,813,15)
'Val(Substr(riga,893,4))
'Substr(riga,414,5)
'Substr(riga,662,50)
'Substr(riga,328,3)
'''
''1'
'iif(Empty(Substr(riga,828,14)) or Substr(riga,828,14)='01010001000000',NullDateTime(),CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6)))
'_icsta
'Substr(riga,812,1)
'nProgImp
'Val(Substr(riga,898,3))
'_icprv
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
''0'
'Substr(riga,897,1)
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'Val(Substr(riga,901,19))/100
'Substr(riga,920,2)
'iif(Empty(LRTrim(Substr(riga,922,1))) or Substr(riga,922,1)='0' or Substr(riga,922,1)='N','N','S')
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3463
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PPFRAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPFRAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPInsert
arch='xraziobo
h=[
19
19
]
obj='Insert
pag=10
prev=O3478
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
'IMPIN
'IMPOUT
'MITIG
'SV58550
'PROQUOTA
'IMPSARA
'SV58550MA
'NOSARA
]
rd_kvar=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'Substr(riga,10,4)
'_intercab
'_iccab
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'LRTrim(Substr(riga,484,16))
'LRTrim(Substr(riga,302,16))
'LRTrim(Substr(riga,190,16))
'LRTrim(Substr(riga,206,16))
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_iccit
'_intercit
'_icrag
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'cOpeProg1
'cIdCau
''F'+Right(cOpeProg2,9)+_idb2
'Substr(riga,424,30)
'Substr(riga,813,15)
'Substr(riga,414,5)
'Substr(riga,662,50)
'cOpeProg2
'Substr(riga,328,3)
''1'
'iif(Empty(Substr(riga,828,14)) or Substr(riga,828,14)='01010001000000',NullDateTime(),CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6)))
'_icsta
'Substr(riga,812,1)
'nProgImp
'_icprv
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
''0'
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'_colleg
'_idb2
'_totin / 100
'_totout / 100
'Val(Substr(riga,893,4))
'Substr(riga,897,1)
'Val(Substr(riga,898,3))
'Val(Substr(riga,901,19))/100
'Substr(riga,920,2)
'iif(Empty(LRTrim(Substr(riga,922,1))) or Substr(riga,922,1)='0' or Substr(riga,922,1)='N','N','S')
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3479
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=10
prev=O3487
I
obj='Var
obj_type='N
pag=10
prev=O3486
var_op='asgn
I
obj='Exec
pag=10
prev=O3485
I
nonlocal=True
obj='Var
obj_type='M
pag=10
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=10
prev=O3477
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=10
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPCase
father=O3461
fatherSonIndex=0
frm_calc=[
'Substr(riga,155,1)='S'
'Substr(riga,155,1)='E'
'Substr(riga,155,1)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,9,1)='1' or Substr(riga,9,1)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,301,1)),'0',iif(Substr(riga,301,1)='S','1',iif(Substr(riga,301,1)='N','0',Substr(riga,301,1))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,231,11))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,852,19))),0,Val(LRTrim(Substr(riga,852,19))))
len=15
name='_totin
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,871,19))),0,Val(LRTrim(Substr(riga,871,19))))
len=15
name='_totout
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge i dati dell'intermediario controparte
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,147,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
obj='Var
pag=10
prev=O3511
var_op='asgn
I
obj='Var
obj_type='D
pag=10
prev=O3509
var_op='asgn
I
obj='Begin
pag=10
prev=O3507
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3509
fatherSonIndex=0
frm_calc='''
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=50
name='_icrag
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,18,11)))) and Len(LRTrim(Substr(riga,64,6)+Substr(riga,70,50)+Substr(riga,29,3)+Substr(riga,62,2)+Substr(riga,32,30))) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
prev=O3519
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O3520
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(_icrag),50)
len=50
name='_icrag
obj='Var
pag=10
prev=O3525
var_op='asgn
I
obj='Read
pag=10
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'Substr(riga,18,11)
]
rd_var=[
'_iccab
'_iccit
'_icprv
'_icsta
'_icrag
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3520
fatherSonIndex=1
frm_calc='Substr(riga,64,6)
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,32,30)
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,62,2)
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,29,3))
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,70,50)
len=50
name='_icrag
obj='Var
pag=10
prev=O3535
var_op='asgn
I
obj='Var
pag=10
prev=O3534
var_op='asgn
I
obj='Var
pag=10
prev=O3533
var_op='asgn
I
obj='Var
pag=10
prev=O3532
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=10
prev=O3518
var_op='asgn
I
obj='Var
pag=10
prev=O3517
var_op='asgn
I
obj='Var
pag=10
prev=O3516
var_op='asgn
I
obj='Var
pag=10
prev=O3515
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=10
prev=O3506
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3507
fatherSonIndex=0
frm_calc='Upper(Substr(riga,511,70))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,581,3))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,584,30))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,614,6)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,620,2))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,622,35))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,657,5))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,302,16))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=10
prev=O3551
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3554
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,120,25))))
]
h=[
19
19
]
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3559
fatherSonIndex=0
frm_calc='''
len=1
name='_tiporap
next=Icpitembatch.CPRead
arch='knarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'_tiporap='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
prev=O3565
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3566
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=10
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3571
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=10
prev=O3582
I
obj='Read
pag=10
prev=O3581
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xntestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=10
prev=O3580
var_op='asgn
I
obj='Var
pag=10
prev=O3579
var_op='asgn
I
obj='Var
pag=10
prev=O3578
var_op='asgn
I
obj='Var
pag=10
prev=O3577
var_op='asgn
I
obj='Var
pag=10
prev=O3576
var_op='asgn
I
obj='Var
pag=10
prev=O3575
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3566
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=10
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3590
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=10
prev=O3601
I
obj='Read
pag=10
prev=O3600
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=10
prev=O3599
var_op='asgn
I
obj='Var
pag=10
prev=O3598
var_op='asgn
I
obj='Var
pag=10
prev=O3597
var_op='asgn
I
obj='Var
pag=10
prev=O3596
var_op='asgn
I
obj='Var
pag=10
prev=O3595
var_op='asgn
I
obj='Var
pag=10
prev=O3594
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=10
prev=O3564
rd_field=[
'TIPORAP
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Substr(riga,120,25)
]
rd_var=[
'_tiporap
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O3548
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3551
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=10
prev=O3623
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,302,16)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=10
prev=O3622
var_op='asgn
I
obj='Var
pag=10
prev=O3621
var_op='asgn
I
obj='Var
pag=10
prev=O3620
var_op='asgn
I
obj='Var
pag=10
prev=O3619
var_op='asgn
I
obj='Var
pag=10
prev=O3618
var_op='asgn
I
obj='Var
pag=10
prev=O3617
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O3547
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O3548
fatherSonIndex=0
obj='Read
pag=10
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
prev=O3546
var_op='asgn
I
obj='Var
pag=10
prev=O3545
var_op='asgn
I
obj='Var
pag=10
prev=O3544
var_op='asgn
I
obj='Var
pag=10
prev=O3543
var_op='asgn
I
obj='Var
pag=10
prev=O3542
var_op='asgn
I
obj='Var
pag=10
prev=O3541
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
prev=O3505
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O3504
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O3502
var_op='asgn
I
obj='Select
pag=10
par_expr=[
'Substr(riga,10,4)
'Substr(riga,14,2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O3501
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3502
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
prev=O3500
var_op='asgn
I
obj='Var
pag=10
prev=O3499
var_op='asgn
I
obj='Var
pag=10
prev=O3498
var_op='asgn
I
obj='Var
pag=10
prev=O3497
var_op='asgn
I
obj='Var
pag=10
prev=O3496
var_op='asgn
I
obj='Var
obj_type='D
pag=10
prev=O3493
var_op='asgn
I
obj='Case
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3493
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3493
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3493
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3493
fatherSonIndex=3
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O3448
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3451
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=10
prev=O3659
sel_field='xraziobo->IDBASE
sel_name='xraziobo
sel_where='xraziobo->NUMPROG=_numprog
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O3660
fatherSonIndex=0
frm_calc='"E' stata cancellata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPDelete
arch='xraziobo
obj='Delete
pag=10
prev=O3664
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'xraziobo->IDBASE
]
I
nonlocal=True
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O3447
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3448
fatherSonIndex=0
frm_calc=[
'Upper(Substr(riga,331,9))='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3673
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=10
sel_field='xraziobo->NUMPROG
sel_name='xraziobo
sel_where='xraziobo->INFORM = Substr(riga,424,30)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3678
fatherSonIndex=0
frm_calc='xraziobo->NUMPROG
len=11
name='_numprog
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O3673
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=10
sel_field='xraziobo->NUMPROG
sel_name='xraziobo
sel_where='xraziobo->RIFIMP = Substr(riga,331,9)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3685
fatherSonIndex=0
frm_calc='xraziobo->NUMPROG
len=11
name='_numprog
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
prev=O3446
var_op='asgn
I
obj='Var
pag=10
prev=O3445
var_op='asgn
I
obj='Var
pag=10
prev=O3444
var_op='asgn
I
obj='Var
pag=10
prev=O3441
var_op='asgn
I
obj='If
pag=10
prev=O3440
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O3441
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=10
prev=O3695
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3696
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=10
prev=O3702
I
obj='Var
obj_type='N
pag=10
prev=O3701
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,318,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
prev=O3439
var_op='asgn
I
obj='Remark
pag=10
prev=O3436
I
obj='If
pag=10
prev=O3434
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3436
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Substr(riga,263,30))+LRTrim(Substr(riga,295,6))+LRTrim(Substr(riga,293,2)))
]
h=[
19
19
]
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anadip
father=O3712
fatherSonIndex=0
obj='Read
pag=10
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'Substr(riga,257,6)
]
rd_var=[
'_intercit
'_intercab
'_interprv
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=10
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3434
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,246,11))),_codinter,Substr(riga,246,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,263,30))),_citinter,Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,295,6))),_cabinter,Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,293,2))),_prvinter,Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=10
prev=O3728
var_op='asgn
I
obj='Var
pag=10
prev=O3727
var_op='asgn
I
obj='Var
pag=10
prev=O3726
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3429
fatherSonIndex=1
frm_calc='1
len=1
name='_frzerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(zhand,riga+" - "+_descerr)
obj='Exec
pag=10
prev=O3732
I
obj='Var
obj_type='N
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=10
prev=O3424
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3427
fatherSonIndex=0
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,190,16))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,206,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,484,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,190,16))) and Empty(LRTrim(Substr(riga,120,25))) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=10
prev=O3748
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3751
fatherSonIndex=0
frm_calc=''Rapporto continuativo Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=10
prev=O3756
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O3745
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3748
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=10
prev=O3762
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3763
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto per conto del quale assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=10
prev=O3768
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
prev=O3761
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,484,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O3742
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3745
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=10
prev=O3779
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3780
fatherSonIndex=0
frm_calc=''Anagrafica Controparte Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=10
prev=O3785
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
prev=O3778
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,302,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O3739
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3742
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=10
prev=O3796
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3797
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto Operante Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=10
prev=O3802
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
prev=O3795
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,206,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O3738
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3739
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=10
prev=O3813
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3814
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=10
prev=O3819
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
prev=O3812
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,190,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
prev=O3737
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=10
prev=O3423
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xarchfraz
father=O3424
fatherSonIndex=0
obj='Insert
pag=10
rd_kfield=[
'IDPROG
'DATAOPE
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'CONNESCLI
'CONNESOPER
'CAMBIO
'NUMPROG
'TIPOOPRAP
'TIPOINTER
'CODINTER
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'CONNESBEN
'UNIQUECODE
'AGOPER
'RIFIMP
'ZCPARTE
'RAGIO
'MODSVOL
'AREAGEO
'INFORM
'AMMONT
'DURAT
'TIPO
'RRAGIO
'RCOMP
'RAREA
'RIMP
'RFREQ
'CONNALTRO
'DATAIMP
'RTIPO
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'NATURA
'SCOPO
'C_RAPPORTO
'RAPPORTBEN
'PAGASOGOP
'IPCOLLEG
'ORACOLLEG
'DUCOLLEG
'IMPIN
'IMPOUT
'TIPOORO
'MITIG
'SV58550
'PROQUOTA
'IMPSARA
'SV58550MA
]
rd_kvar=[
'conta
'Substr(riga,1,8)        
'Substr(riga,9,1)        
'Substr(riga,10,4)       
'Substr(riga,14,2)       
'Substr(riga,16,2)       
'Substr(riga,18,11)      
'Substr(riga,29,3)       
'Substr(riga,32,30)      
'Substr(riga,62,2)       
'Substr(riga,64,6)       
'Substr(riga,70,50)      
'Substr(riga,120,25)     
'Substr(riga,145,1)      
'Substr(riga,146,1)      
'Substr(riga,147,8)      
'Substr(riga,155,1)      
'Substr(riga,156,3)      
'Substr(riga,159,1)      
'Substr(riga,160,15)     
'Substr(riga,175,15)     
'Substr(riga,190,16)     
'Substr(riga,206,16)     
'Substr(riga,222,9)      
'Substr(riga,231,11)     
'Substr(riga,242,2)      
'Substr(riga,244,2)      
'Substr(riga,246,11)     
'Substr(riga,257,6)      
'Substr(riga,263,30)     
'Substr(riga,293,2)      
'Substr(riga,295,6)      
'Substr(riga,301,1)      
'Substr(riga,302,16)     
'Substr(riga,318,10)     
'Substr(riga,328,3)      
'Substr(riga,331,9)      
'Substr(riga,340,69)     
'Substr(riga,409,5)      
'Substr(riga,414,5)      
'Substr(riga,419,5)      
'Substr(riga,424,30)     
'Substr(riga,454,5)      
'Substr(riga,459,5)      
'Substr(riga,464,5)      
'Substr(riga,469,3)      
'Substr(riga,472,3)      
'Substr(riga,475,3)      
'Substr(riga,478,3)      
'Substr(riga,481,3)      
'Substr(riga,484,16)     
'Substr(riga,500,8)      
'Substr(riga,508,3)      
'Substr(riga,511,70)     
'Substr(riga,581,3)      
'Substr(riga,584,30)     
'Substr(riga,614,6)      
'Substr(riga,620,2)      
'Substr(riga,622,35)     
'Substr(riga,657,5)      
'Substr(riga,662,50)     
'Substr(riga,712,50)     
'Substr(riga,762,25)     
'Substr(riga,787,25)     
'Substr(riga,812,1)      
'Substr(riga,813,15)     
'Substr(riga,828,14)     
'Substr(riga,842,10)     
'Val(Substr(riga,852,19)) / 100
'Val(Substr(riga,871,19)) / 100
'Substr(riga,890,3)
'Val(Substr(riga,893,4))
'Substr(riga,897,1)
'Val(Substr(riga,898,3))
'Val(Substr(riga,901,19))/100
'Substr(riga,920,2)
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
prev=O3422
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
prev=O3403
var_op='asgn
I
obj='Var
pag=10
prev=O3402
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=10
prev=O3401
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O3400
var_op='asgn
I
obj='Remark
pag=10
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Rapporti AGE Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Rapporti AGE Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=11
prev=O3848
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=11
prev=O3847
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=11
prev=O3846
var_op='asgn
I
obj='Exec
pag=11
prev=O3845
I
obj='Exec
pag=11
prev=O3844
I
obj='Exec
pag=11
prev=O3842
I
obj='While
pag=11
prev=O3841
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3842
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='cFlagLire
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,77,1)='S'
'Substr(riga,77,1)='E'
'Substr(riga,77,1)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='xRapporto
next=Icpitembatch.CPRead
arch='jnarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xRapporto))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=11
prev=O3858
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O3859
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPRAPAGE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='jnarapbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,83,1)<>'1'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=11
prev=O3867
var_op='asgn
I
obj='If
pag=11
prev=O3865
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3867
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PROGAET\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aetesta
h=[
19
19
]
obj='Insert
pag=11
prev=O3873
rd_kfield=[
'RAPPORTO
'TIPOAG
'COINT
'DESCRI
'VALUTA
'PROGAET
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,81,2)
'iif(Substr(riga,76,1)='1','1','2')
'iif(Substr(riga,81,2)='99',Upper(Substr(riga,26,24)),'')
'Substr(riga,78,3)
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3874
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file RAPAGE.TXT
obj='Transaction
pag=11
prev=O3880
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=11
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=11
prev=O3864
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
'PRGIMPRAP
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,94,5)),3))
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3865
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file RAPAGE.TXT
obj='Transaction
pag=11
prev=O3888
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='jnarapbo
father=O3859
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,83,1)<>'1'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=11
prev=O3894
var_op='asgn
I
obj='If
pag=11
prev=O3892
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aetesta
father=O3894
fatherSonIndex=0
h=[
19
19
]
obj='Write
pag=11
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3900
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file RAPAGE.TXT
obj='Transaction
pag=11
prev=O3907
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'TIPOAG
'COINT
'DESCRI
'VALUTA
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,81,2)
'iif(Substr(riga,76,1)='1','1','2')
'iif(Substr(riga,81,2)='99',Upper(Substr(riga,26,24)),'')
'Substr(riga,78,3)
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=11
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3892
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il rapporto: "+Left(riga,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file RAPAGE.TXT
obj='Transaction
pag=11
prev=O3919
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'NOPROT
'RAGIO
'MODSVOL
'AREAGEO
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,26,50)
'Substr(riga,76,1)
'cFlagLire
'Substr(riga,78,3)
'Substr(riga,81,2)
'Val(Substr(riga,83,1))
'Substr(riga,84,5)
'Substr(riga,89,5)
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,94,5)),3))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=11
prev=O3857
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Left(riga,25)
]
rd_var=[
'xRapporto
]
I
obj='Var
pag=11
prev=O3854
var_op='asgn
I
obj='Case
pag=11
prev=O3853
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3854
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3854
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3854
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3854
fatherSonIndex=3
frm_calc='Substr(riga,77,1)
len=1
name='cFlagLire
obj='Var
pag=11
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Var
pag=11
prev=O3852
var_op='asgn
I
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=11
prev=O3840
var_op='asgn
I
obj='Var
pag=11
prev=O3839
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=11
prev=O3838
var_op='asgn
I
obj='Var
obj_type='N
pag=11
prev=O3837
var_op='asgn
I
obj='Var
obj_type='N
pag=11
prev=O3836
var_op='asgn
I
obj='Remark
pag=11
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Informazione Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O3952
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O3951
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O3950
var_op='asgn
I
obj='Exec
pag=12
prev=O3949
I
obj='Exec
pag=12
prev=O3948
I
obj='Exec
pag=12
prev=O3946
I
obj='While
pag=12
prev=O3945
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3946
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPBeginEnd
comment='Dati intermediario
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,75,16)
len=16
name='xConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xSOCTCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,50,16)
len=16
name='xSOCTCon
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xSOCTCon)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' informazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,46,1)='S'
'Substr(riga,46,1)='E'
'Substr(riga,46,1)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPRemark
frm_calc='Da sentire Bruno sembra che l'importazione dei soggetti operanti in agenzia delle entrate non sia più attiva.﷯Ma sul tracciato c'è ancora.
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,36,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,159,10)),Utilities.GetAutonumber("PRGINFAGE1\'"+LRTrim(gAzienda)+"'",'',10),Substr(riga,159,10))
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFAGE2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINFAGE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='japopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=12
prev=O3984
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3986
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOGAGE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='jntestbo
h=[
19
19
]
obj='Insert
pag=12
prev=O3991
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'cMaxRow + 1
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'iif(Substr(riga,44,2)='25' or Substr(riga,44,2)='28','D','P')
'cCli1
'cInfProg2
'Substr(riga,9,25)
'Substr(riga,34,1)
''0'
'cCli1
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3992
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file INFAGE.TXT
obj='Transaction
pag=12
prev=O3998
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3986
fatherSonIndex=1
frm_calc=[
'Substr(riga,44,2)='23'
'Substr(riga,44,2)='26'
]
h=[
19
19
19
]
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='jntestbo
father=O4002
fatherSonIndex=0
h=[
19
19
]
obj='Write
pag=12
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,9,25)
'cNumMod
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4007
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file INFAGE.TXT
obj='Transaction
pag=12
prev=O4014
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'NUMPROG1
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='jntestbo
father=O4002
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=12
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'Substr(riga,9,25)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4021
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario dell'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file INFAGE.TXT
obj='Transaction
pag=12
prev=O4028
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=12
prev=O3983
sel_field='*
sel_name='jntestbo
sel_order='jntestbo->CPROWNUM
sel_where='jntestbo->RAPPORTO=Substr(riga,9,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O3984
fatherSonIndex=0
frm_calc=[
'jntestbo->CODINTER=cCli1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=12
prev=O4038
var_op='asgn
I
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4038
fatherSonIndex=0
frm_calc='jntestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
prev=O3982
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O3981
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O3979
var_op='asgn
I
obj='Insert
pag=12
prev=O3978
rd_kfield=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'CONNESOPER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'VALUTA
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'_intercab
'Substr(riga,115,6)
'_intercod
'xSOCTCF
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_intercit
'Substr(riga,169,50)
'cFlagLire
'Substr(riga,34,1)
'cInfProg1
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)+"J"+LibreriaMit.UniqueId()+"X"
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,47,3)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3979
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'informazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al rapporto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file INFAGE.TXT
obj='Transaction
pag=12
prev=O4051
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
prev=O3977
var_op='asgn
I
obj='Var
pag=12
prev=O3976
var_op='asgn
I
obj='Var
pag=12
prev=O3975
var_op='asgn
I
obj='Var
obj_type='D
pag=12
prev=O3974
var_op='asgn
I
obj='Remark
pag=12
prev=O3971
I
obj='Case
pag=12
prev=O3970
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3971
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3971
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3971
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3971
fatherSonIndex=3
frm_calc='Substr(riga,46,1)
len=1
name='cFlagLire
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O3969
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O3966
var_op='asgn
I
obj='If
pag=12
prev=O3965
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O3966
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=12
prev=O4066
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O4067
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xSOCTCF))
]
h=[
19
19
]
obj='If
pag=12
prev=O4072
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4073
fatherSonIndex=0
frm_calc='xSOCTCon
len=16
name='xSOCTCF
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xSOCTCon
]
rd_var=[
'xSOCTCF
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=12
prev=O3964
var_op='asgn
I
obj='Var
pag=12
prev=O3961
var_op='asgn
I
obj='If
pag=12
prev=O3960
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='personbo
father=O3961
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cCli1))
]
h=[
19
19
]
obj='If
pag=12
prev=O4092
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4093
fatherSonIndex=0
frm_calc='xConnes
len=16
name='cCli1
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
prev=O3959
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'cCli1
]
I
obj='Var
pag=12
prev=O3957
var_op='asgn
I
obj='Begin
pag=12
prev=O3956
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3957
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,104,11))),_codinter,Substr(riga,104,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,121,30))),_citinter,Substr(riga,121,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,153,6))),_cabinter,Substr(riga,153,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,151,2))),_prvinter,Substr(riga,151,2))
len=2
name='_interprv
obj='Var
pag=12
prev=O4113
var_op='asgn
I
obj='Var
pag=12
prev=O4112
var_op='asgn
I
obj='Var
pag=12
prev=O4111
var_op='asgn
I
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=12
prev=O3944
var_op='asgn
I
obj='Var
obj_type='N
pag=12
prev=O3943
var_op='asgn
I
obj='Var
pag=12
prev=O3942
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=12
prev=O3941
var_op='asgn
I
obj='Remark
pag=12
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni AGE Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','JPERAZBO','Operazioni AGE Inserite: '+LRTrim(Str(cNumNew,10,0)))
obj='Exec
pag=13
prev=O4130
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O4129
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O4128
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O4127
var_op='asgn
I
obj='Exec
pag=13
prev=O4126
I
obj='Exec
pag=13
prev=O4125
I
obj='Exec
pag=13
prev=O4123
I
obj='While
pag=13
prev=O4122
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4123
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=13
prev=O4134
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
father=O4135
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
prev=O4140
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O4142
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,257,6))))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,318,10))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc='_flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(Substr(riga,331,9))) > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))) or (Empty(LRTrim(_numprog)) and not(Empty(LRTrim(Left(riga,8)))))
]
h=[
19
19
]
obj='If
pag=13
prev=O4164
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4167
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(Left(riga,8))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,318,10)),Utilities.GetAutonumber("POPERAGE1\'"+LRTrim(gAzienda)+"'",'',10),Substr(riga,318,10))
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,155,1)='S'
'Substr(riga,155,1)='E'
'Substr(riga,155,1)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,147,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,9,1)='1' or Substr(riga,9,1)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(Substr(riga,301,1)),'0',iif(Substr(riga,301,1)='S','1',iif(Substr(riga,301,1)='N','0',Substr(riga,301,1))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,231,11))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPEAGE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,852,19))),0,Val(LRTrim(Substr(riga,852,19))))
len=15
name='_totin
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,871,19))),0,Val(LRTrim(Substr(riga,871,19))))
len=15
name='_totout
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Legge i dati dell'intermediario controparte
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='jperazbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=13
prev=O4197
var_op='asgn
I
obj='Insert
pag=13
prev=O4195
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
'IMPIN
'IMPOUT
]
rd_kvar=[
'Substr(riga,454,5)
'Val(Right(Left(riga,8),4))
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,419,5)),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'Substr(riga,762,25)
'_bensta
'Val(Substr(riga,222,9)) / 10000
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'Substr(riga,10,4)
'_intercab
'_iccab
'Substr(riga,257,6)
'Substr(riga,18,11)
'_intercod
'Substr(riga,14,2)
'Substr(riga,484,16)
'Substr(riga,302,16)
'Substr(riga,190,16)
'Substr(riga,206,16)
'CharToDate(Right(Substr(riga,500,8),4)+Substr(Substr(riga,500,8),3,2)+Left(Substr(riga,500,8),2))
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_datarett
'_iccit
'_intercit
'_icrag
'Val(Substr(riga,842,10))
'Substr(riga,459,5)
'cFlagCont
'cFlagFraz
'cFlagLire
'Substr(riga,145,1)
'_flagrap2
'cOpeProg1
'cIdCau
'"O"+Right(cOpeProg2,9)+_idb2
'Substr(riga,424,30)
'Substr(riga,813,15)
'Substr(riga,414,5)
'Substr(riga,662,50)
'cOpeProg2
'Substr(riga,328,3)
'_idreg
''1'
'iif(Empty(Substr(riga,828,14)) or Substr(riga,828,14)='01010001000000',NullDateTime(),CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6)))
'_icsta
'Substr(riga,812,1)
'nProgImp
'_icprv
'_interprv
'Substr(riga,409,5)
'Substr(riga,787,25)
'Substr(riga,120,25)
'Val(Substr(riga,475,3))
'Val(Substr(riga,472,3))
'Val(Substr(riga,481,3))
'Substr(riga,331,9)
'Val(Substr(riga,478,3))
'Val(Substr(riga,469,3))
'Val(Substr(riga,508,3))
'Substr(riga,712,50)
'Substr(riga,159,1)
'_statoreg
'Substr(riga,464,3)
''1'
'Substr(riga,16,2)
'Substr(riga,244,2)
'Substr(riga,146,1)
'Substr(riga,242,2)
'Val(Substr(riga,175,15))
'Val(Substr(riga,160,15))
'Substr(riga,318,10)
'Substr(riga,156,3)
'Substr(riga,340,69)
'_colleg
'_idb2
'_totin / 100
'_totout / 100
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4197
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file OPEAGE.TXT
obj='Transaction
pag=13
prev=O4205
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O4204
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Begin
pag=13
prev=O4193
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4195
fatherSonIndex=0
frm_calc='''
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=50
name='_icrag
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,18,11)))) and Len(LRTrim(Substr(riga,64,6)+Substr(riga,70,50)+Substr(riga,29,3)+Substr(riga,62,2)+Substr(riga,32,30))) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
prev=O4214
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O4215
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='Left(LRTrim(_icrag),50)
len=50
name='_icrag
obj='Var
pag=13
prev=O4220
var_op='asgn
I
obj='Read
pag=13
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'Substr(riga,18,11)
]
rd_var=[
'_iccab
'_iccit
'_icprv
'_icsta
'_icrag
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4215
fatherSonIndex=1
frm_calc='Substr(riga,64,6)
len=6
name='_iccab
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,32,30)
len=30
name='_iccit
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,62,2)
len=2
name='_icprv
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,29,3))
len=3
name='_icsta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,70,50)
len=50
name='_icrag
obj='Var
pag=13
prev=O4230
var_op='asgn
I
obj='Var
pag=13
prev=O4229
var_op='asgn
I
obj='Var
pag=13
prev=O4228
var_op='asgn
I
obj='Var
pag=13
prev=O4227
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=13
prev=O4213
var_op='asgn
I
obj='Var
pag=13
prev=O4212
var_op='asgn
I
obj='Var
pag=13
prev=O4211
var_op='asgn
I
obj='Var
pag=13
prev=O4210
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=13
prev=O4192
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4193
fatherSonIndex=0
frm_calc='Upper(Substr(riga,511,70))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(Substr(riga,581,3))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,584,30))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,614,6)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,620,2))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,622,35))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,657,5))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,302,16))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=13
prev=O4246
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4249
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,120,25))))
]
h=[
19
19
]
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4254
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=13
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=Substr(riga,120,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4259
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=13
prev=O4270
I
obj='Read
pag=13
prev=O4269
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=13
prev=O4268
var_op='asgn
I
obj='Var
pag=13
prev=O4267
var_op='asgn
I
obj='Var
pag=13
prev=O4266
var_op='asgn
I
obj='Var
pag=13
prev=O4265
var_op='asgn
I
obj='Var
pag=13
prev=O4264
var_op='asgn
I
obj='Var
pag=13
prev=O4263
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4243
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4246
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=13
prev=O4287
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'Substr(riga,302,16)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=13
prev=O4286
var_op='asgn
I
obj='Var
pag=13
prev=O4285
var_op='asgn
I
obj='Var
pag=13
prev=O4284
var_op='asgn
I
obj='Var
pag=13
prev=O4283
var_op='asgn
I
obj='Var
pag=13
prev=O4282
var_op='asgn
I
obj='Var
pag=13
prev=O4281
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4242
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O4243
fatherSonIndex=0
obj='Read
pag=13
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
prev=O4241
var_op='asgn
I
obj='Var
pag=13
prev=O4240
var_op='asgn
I
obj='Var
pag=13
prev=O4239
var_op='asgn
I
obj='Var
pag=13
prev=O4238
var_op='asgn
I
obj='Var
pag=13
prev=O4237
var_op='asgn
I
obj='Var
pag=13
prev=O4236
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=13
prev=O4191
var_op='asgn
I
obj='Var
obj_type='N
pag=13
prev=O4190
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O4189
var_op='asgn
I
obj='Var
obj_type='N
pag=13
prev=O4188
var_op='asgn
I
obj='Var
obj_type='N
pag=13
prev=O4186
var_op='asgn
I
obj='Select
pag=13
par_expr=[
'Substr(riga,10,4)
'Substr(riga,14,2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O4185
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4186
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
prev=O4184
var_op='asgn
I
obj='Var
pag=13
prev=O4183
var_op='asgn
I
obj='Var
pag=13
prev=O4182
var_op='asgn
I
obj='Var
pag=13
prev=O4181
var_op='asgn
I
obj='Var
pag=13
prev=O4180
var_op='asgn
I
obj='Var
obj_type='D
pag=13
prev=O4177
var_op='asgn
I
obj='Case
pag=13
prev=O4176
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4177
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4177
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4177
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4177
fatherSonIndex=3
frm_calc='Substr(riga,155,1)
len=1
name='cFlagLire
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Var
pag=13
prev=O4175
var_op='asgn
I
obj='Var
pag=13
prev=O4172
var_op='asgn
I
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4172
fatherSonIndex=0
frm_calc='_numprog
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''1'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
obj='Var
obj_type='D
pag=13
prev=O4322
var_op='asgn
I
obj='Var
pag=13
prev=O4321
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4172
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("POPERAGE2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''0'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datarett
obj='Var
obj_type='D
pag=13
prev=O4326
var_op='asgn
I
obj='Var
pag=13
prev=O4325
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4161
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4164
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Left(riga,8)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4332
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=13
prev=O4337
sel_field='jperazbo->IDBASE
sel_name='jperazbo
sel_where='jperazbo->NUMPROG=_numprog and (jperazbo->STATOREG='0'  or jperazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O4338
fatherSonIndex=0
frm_calc='"E' stata cancellata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='jperazbo
h=[
19
19
]
obj='Write
pag=13
prev=O4342
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'jperazbo->IDBASE
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4343
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file OPEAGE.TXT
obj='Transaction
pag=13
prev=O4350
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=13
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
]
wr_var=[
''2'
'Date()
]
I
nonlocal=True
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=13
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
father=O4332
fatherSonIndex=1
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"E' stata variata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=13
prev=O4359
sel_field='jperazbo->IDBASE,jperazbo->NUMPROG,jperazbo->DATAOPE,jperazbo->FLAGRAP2
sel_name='jperazbo
sel_where='jperazbo->NUMPROG=_numprog and (jperazbo->STATOREG='0'  or jperazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4360
fatherSonIndex=0
frm_calc='jperazbo->IDBASE
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(jperazbo->FLAGRAP2) or jperazbo->FLAGRAP2='S',Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(jperazbo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='jperazbo->IDEREG
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='jperazbo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=13
prev=O4372
sel_field='*
sel_name='terzistiope
sel_where='terzistiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='merzistiope
father=O4374
fatherSonIndex=0
obj='Insert
pag=13
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'IDREG
]
rd_kvar=[
'_oldidb
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=13
prev=O4370
sel_field='*
sel_name='beneficope
sel_where='beneficope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='meneficope
father=O4372
fatherSonIndex=0
obj='Insert
pag=13
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
'IDREG
]
rd_kvar=[
'_oldidb
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=13
prev=O4368
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mlientiope
father=O4370
fatherSonIndex=0
obj='Insert
pag=13
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=13
prev=O4367
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mogopebo
father=O4368
fatherSonIndex=0
obj='Insert
pag=13
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=13
prev=O4366
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'jperazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
'FLAGRAP2
]
wr_op=[
'=
'=
'=
]
wr_var=[
''3'
'Date()
'_flagrap2
]
I
obj='Var
pag=13
prev=O4365
var_op='asgn
I
obj='Var
pag=13
prev=O4364
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=13
prev=O4358
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4160
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4161
fatherSonIndex=0
frm_calc=[
'Upper(Substr(riga,331,9))='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4411
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=13
sel_field='jperazbo->NUMPROG
sel_name='jperazbo
sel_where='jperazbo->INFORM = Substr(riga,424,30) and (jperazbo->STATOREG='0' or jperazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4416
fatherSonIndex=0
frm_calc='jperazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4411
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=13
sel_field='jperazbo->NUMPROG
sel_name='jperazbo
sel_where='jperazbo->RIFIMP = Substr(riga,331,9) and (jperazbo->STATOREG='0' or jperazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4423
fatherSonIndex=0
frm_calc='jperazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
prev=O4159
var_op='asgn
I
obj='Var
pag=13
prev=O4158
var_op='asgn
I
obj='Var
pag=13
prev=O4157
var_op='asgn
I
obj='Var
pag=13
prev=O4154
var_op='asgn
I
obj='If
pag=13
prev=O4153
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='jperazbo
father=O4154
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=13
prev=O4433
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4434
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file OPEAGE.TXT
obj='Transaction
pag=13
prev=O4439
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,318,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=13
prev=O4152
var_op='asgn
I
obj='Remark
pag=13
prev=O4149
I
obj='If
pag=13
prev=O4147
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4149
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,263,30))+LRTrim(Substr(riga,295,6))+LRTrim(Substr(riga,293,2))))
]
h=[
19
19
]
obj='If
pag=13
prev=O4451
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4454
fatherSonIndex=0
frm_calc='LRTrim(Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=13
prev=O4460
var_op='asgn
I
obj='Var
pag=13
prev=O4459
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4450
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4451
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(Substr(riga,257,6))+" non è presente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file OPEAGE.TXT
obj='Transaction
pag=13
prev=O4465
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
prev=O4449
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'Substr(riga,257,6)
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=13
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4147
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,246,11))),_codinter,Substr(riga,246,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,263,30))),_citinter,Substr(riga,263,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,295,6))),_cabinter,Substr(riga,295,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,293,2))),_prvinter,Substr(riga,293,2))
len=2
name='_interprv
obj='Var
pag=13
prev=O4477
var_op='asgn
I
obj='Var
pag=13
prev=O4476
var_op='asgn
I
obj='Var
pag=13
prev=O4475
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4142
fatherSonIndex=1
frm_calc='1
len=1
name='_opeerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(ohand,riga+" - "+_descerr)
obj='Exec
pag=13
prev=O4481
I
obj='Var
obj_type='N
pag=13
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=13
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O4140
fatherSonIndex=0
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,190,16))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,206,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,484,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,190,16))) and Empty(LRTrim(Substr(riga,120,25))) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=13
prev=O4497
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4500
fatherSonIndex=0
frm_calc=''Rapporto continuativo o Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=13
prev=O4505
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4494
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4497
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=13
prev=O4511
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4512
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto per conto del quale assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=13
prev=O4517
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
prev=O4510
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,484,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4491
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4494
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=13
prev=O4528
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4529
fatherSonIndex=0
frm_calc=''Anagrafica Controparte Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=13
prev=O4534
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
prev=O4527
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,302,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4488
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4491
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=13
prev=O4545
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4546
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto Operante Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=13
prev=O4551
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
prev=O4544
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,206,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=13
prev=O4487
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4488
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=13
prev=O4562
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4563
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=13
prev=O4568
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=13
prev=O4561
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,190,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=13
prev=O4486
var_op='asgn
I
obj='Var
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=13
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=13
prev=O4121
var_op='asgn
I
obj='Var
pag=13
prev=O4120
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=13
prev=O4119
var_op='asgn
I
obj='Var
obj_type='N
pag=13
prev=O4118
var_op='asgn
I
obj='Var
pag=13
pagelocal=True
prev=O4117
I
obj='Remark
pag=13
x=15
y=15
I
Icpitembatch.CPRead
arch='tbcauana
obj='Read
pag=13
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,10,4)
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
x=522
y=720
I
Icpitembatch.CPRemark
frm_calc='Import Dipendenze
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumNew <> 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod <> 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','ANADIP','Dipendenze Inserite: '+LRTrim(Str(cNumNew,10,0)) + ' - Dipendenze Aggiornate: '+LRTrim(Str(cNumMod,10,0)))
obj='Exec
pag=14
prev=O4602
I
nonlocal=True
obj='Var
obj_type='M
pag=14
prev=O4601
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=14
prev=O4598
var_op='asgn
I
obj='If
pag=14
prev=O4595
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4598
fatherSonIndex=0
frm_calc='gMsgProc + 'Dipendenze Aggiornate: '+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O4594
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4595
fatherSonIndex=0
frm_calc='gMsgProc + 'Dipendenze Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Exec
pag=14
prev=O4593
I
obj='Exec
pag=14
prev=O4592
I
obj='Exec
pag=14
prev=O4590
I
obj='While
pag=14
prev=O4589
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4590
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,6)
len=6
name='xDIP
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,69,6)
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Caricamento dipendenza con codice '+xDIP
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCodCab))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgRet='S'
]
h=[
19
19
]
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDIPx))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
prev=O4625
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPInsert
arch='anadip
father=O4626
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=14
prev=O4631
var_op='asgn
I
obj='Insert
pag=14
rd_kfield=[
'CODDIP
'DESCRIZ
'DESCCIT
'PROVINCIA
'CAB
'AGENTE
'IDBASE
'CAP
'TIPOSV
]
rd_kvar=[
'xDIP
'Substr(riga,7,30)
'Substr(riga,37,30)
'Substr(riga,67,2)
'xCodCab
'iif(Upper(Substr(riga,85,1))='S','S','N')
'LibreriaMit.UniqueId()
'Substr(riga,86,5)
'Substr(riga,91,3)
]
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='anadip
father=O4626
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=14
prev=O4636
var_op='asgn
I
obj='Write
pag=14
rd_kfield=[
'CODDIP
]
rd_kop=[
'=
]
rd_kvar=[
'xDIP
]
wr_field=[
'DESCRIZ
'DESCCIT
'PROVINCIA
'CAB
'AGENTE
'CAP
'TIPOSV
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,7,30)
'Substr(riga,37,30)
'Substr(riga,67,2)
'xCodCab
'iif(Upper(Substr(riga,85,1))='S','S','N')
'Substr(riga,86,5)
'Substr(riga,91,3)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=14
prev=O4622
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'xDIP
]
rd_var=[
'xDIPx
]
I
obj='If
pag=14
prev=O4619
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xnadip
father=O4622
fatherSonIndex=0
obj='Insert
pag=14
rd_kfield=[
'IDPROG
'CODDIP
'DESCRIZ
'DESCCIT
'PROVINCIA
'CAB
'AGENTE
]
rd_kvar=[
'conta
'xDIP
'Substr(riga,7,30)
'Substr(riga,37,30)
'Substr(riga,67,2)
'Substr(riga,69,6)
'Substr(riga,85,1)
]
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O4618
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4619
fatherSonIndex=0
frm_calc='Substr(riga,37,30)
len=30
name='xCitta
next=Icpitembatch.CPRead
arch='tbcitta
obj='Read
pag=14
prev=O4657
rd_field=[
'CAB
]
rd_kfield=[
'CITTA
'PROV
]
rd_kvar=[
'xCitta
'Substr(riga,67,2)
]
rd_var=[
'xCodCab
]
I
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=14
prev=O4617
var_op='asgn
I
nonlocal=True
obj='Var
pag=14
prev=O4616
var_op='asgn
I
obj='Var
pag=14
prev=O4615
var_op='asgn
I
obj='Var
pag=14
prev=O4614
var_op='asgn
I
obj='Var
obj_type='M
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=14
prev=O4588
var_op='asgn
I
obj='Var
pag=14
prev=O4587
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=14
prev=O4586
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O4585
var_op='asgn
I
obj='Var
obj_type='N
pag=14
prev=O4584
var_op='asgn
I
obj='Remark
pag=14
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Titolari Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Titolari Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=15
prev=O4676
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=15
prev=O4675
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=15
prev=O4674
var_op='asgn
I
obj='Exec
pag=15
prev=O4673
I
obj='Exec
pag=15
prev=O4672
I
obj='Exec
pag=15
prev=O4670
I
obj='While
pag=15
prev=O4669
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4670
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=15
prev=O4680
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O4681
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,159,10)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
prev=O4689
sons=[
Icpitembatch.CPItemSon
comment='Unicode Assente o vuoto
instr=Icpitembatch.CPVarDecl
father=O4692
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,36,8)))
len=8
name='_datareg
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
prev=O4698
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4699
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGPTIT1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPTIT2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTIT\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xapotit
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,44,2)='50'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
prev=O4707
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4709
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xntestit
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=15
prev=O4715
var_op='asgn
I
obj='Insert
pag=15
prev=O4714
rd_kfield=[
'CODCLI
'CODINTER
'DATAINI
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
'NUMPROG1
]
rd_kvar=[
'Substr(riga,75,16)
'Substr(riga,50,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'Substr(riga,219,30)
'Substr(riga,9,25)
'nProgImp
'LibreriaMit.UniqueId()
'cInfProg2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4715
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file ARCHTITO.TXT
obj='Transaction
pag=15
prev=O4722
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=15
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xntestit
father=O4709
fatherSonIndex=1
h=[
19
19
]
obj='Insert
pag=15
rd_kfield=[
'CODCLI
'CODINTER
'DATAFINE
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
'NUMPROG2
]
rd_kvar=[
'Substr(riga,75,16)
'Substr(riga,50,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'Substr(riga,219,30)
'Substr(riga,9,25)
'nProgImp
'LibreriaMit.UniqueId()
'cInfProg2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4726
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file ARCHTITO.TXT
obj='Transaction
pag=15
prev=O4732
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=15
prev=O4706
rd_kfield=[
'CDATOPE
'CDATREG
'CODCAB
'CODDIPE
'CODINTER
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPTIT
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'IDBASE2
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'_intercab
'Substr(riga,115,6)
'_intercod
'Substr(riga,75,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'cInfProg1
'"T"+Right(cInfProg2,9)+_idb2
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,159,10)
'_idb2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4707
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file ARCHTITO.TXT
obj='Transaction
pag=15
prev=O4740
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=15
prev=O4705
var_op='asgn
I
obj='Var
pag=15
prev=O4704
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4699
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGTITO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGTITO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTIT\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='rapotit
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,44,2)='50'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
prev=O4747
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4749
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='intestit
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=15
prev=O4755
var_op='asgn
I
obj='Insert
pag=15
prev=O4754
rd_kfield=[
'CODCLI
'CODINTER
'DATAINI
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
'STATOREG
'NUMPROG1
]
rd_kvar=[
'Substr(riga,75,16)
'Substr(riga,50,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'Substr(riga,219,30)
'Substr(riga,9,25)
'nProgImp
'LibreriaMit.UniqueId()
''0'
'cInfProg2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4755
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file ARCHTITO.TXT
obj='Transaction
pag=15
prev=O4762
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=15
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestit
father=O4749
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=15
rd_kfield=[
'CODCLI
'CODINTER
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Substr(riga,75,16)
'Substr(riga,50,16)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4766
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file ARCHTITO.TXT
obj='Transaction
pag=15
prev=O4773
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg2
]
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=15
prev=O4746
rd_kfield=[
'CDATOPE
'CDATREG
'CODCAB
'CODDIPE
'CODINTER
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPTIT
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'IDBASE2
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'_intercab
'Substr(riga,115,6)
'_intercod
'Substr(riga,75,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'cInfProg1
'"T"+Right(cInfProg2,9)+_idb2
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,159,10)
'_idb2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4747
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file ARCHTITO.TXT
obj='Transaction
pag=15
prev=O4784
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=15
prev=O4745
var_op='asgn
I
obj='Var
pag=15
prev=O4744
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='D
pag=15
prev=O4697
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='Aggiornamento
instr=Icpitembatch.CPIfElse
father=O4692
fatherSonIndex=1
frm_calc=[
'_tdest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4789
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=15
sel_field='*
sel_name='xapotit
sel_where='xapotit->IDBASE=_unicode and (xapotit->STATOREG='0' or xapotit->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4794
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGPTIT1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPInsert
arch='xapotit
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='xapotit
obj='Write
pag=15
prev=O4799
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_unicode
]
wr_field=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDEREG
'OPRAP
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'CONNESCLI
'DATARETT
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'_intercab
'Substr(riga,115,6)
'_intercod
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'CharToDate(Right(Substr(riga,36,8),4)+Substr(Substr(riga,36,8),3,2)+Left(Substr(riga,36,8),2))
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'xapotit->IDEREG
'Left(Substr(riga,44,2),1)
'_interprv
'Substr(riga,9,25)
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,75,16)
'Date()
]
I
obj='Insert
pag=15
prev=O4798
rd_kfield=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPTIT
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
]
rd_kvar=[
'xapotit->CDATOPE
'xapotit->CODCAB
'xapotit->CODDIPE
'xapotit->CODINTER
'xapotit->CONNESCLI
'xapotit->DATAOPE
'xapotit->DATAREG
'xapotit->DESCCIT
'xapotit->DESCINTER
'xapotit->FLAGRAP
'cInfProg1
'xapotit->IDEREG
'xapotit->NUMPROG
'xapotit->OPRAP
'xapotit->PRGIMPTIT
'xapotit->PROVINCIA
'xapotit->RAPPORTO
''3'
''1'
'xapotit->TIPOINTER
'xapotit->TIPOLEG
'xapotit->TIPOOPRAP
'xapotit->UNIQUECODE
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4799
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file ARCHTITO.TXT
obj='Transaction
pag=15
prev=O4812
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O4789
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=15
sel_field='*
sel_name='rapotit
sel_where='rapotit->IDBASE=_unicode and (rapotit->STATOREG='0' or rapotit->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4817
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGTITO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPInsert
arch='rapotit
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='rapotit
obj='Write
pag=15
prev=O4822
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_unicode
]
wr_field=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDEREG
'OPRAP
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'CONNESCLI
'DATARETT
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'_intercab
'Substr(riga,115,6)
'_intercod
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'CharToDate(Right(Substr(riga,36,8),4)+Substr(Substr(riga,36,8),3,2)+Left(Substr(riga,36,8),2))
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'rapotit->IDEREG
'Left(Substr(riga,44,2),1)
'_interprv
'Substr(riga,9,25)
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,75,16)
'Date()
]
I
obj='Insert
pag=15
prev=O4821
rd_kfield=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPTIT
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
]
rd_kvar=[
'rapotit->CDATOPE
'rapotit->CODCAB
'rapotit->CODDIPE
'rapotit->CODINTER
'rapotit->CONNESCLI
'rapotit->DATAOPE
'rapotit->DATAREG
'rapotit->DESCCIT
'rapotit->DESCINTER
'rapotit->FLAGRAP
'cInfProg1
'rapotit->IDEREG
'rapotit->NUMPROG
'rapotit->OPRAP
'rapotit->PRGIMPTIT
'rapotit->PROVINCIA
'rapotit->RAPPORTO
''3'
''1'
'rapotit->TIPOINTER
'rapotit->TIPOLEG
'rapotit->TIPOOPRAP
'rapotit->UNIQUECODE
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4822
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file ARCHTITO.TXT
obj='Transaction
pag=15
prev=O4835
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=15
prev=O4688
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4689
fatherSonIndex=0
frm_calc='''
len=1
name='_tdest
next=Icpitembatch.CPRead
arch='xapotit
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_unicode)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=15
prev=O4844
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='rapotit
father=O4845
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_unicode))
]
h=[
19
19
]
obj='If
pag=15
prev=O4850
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4851
fatherSonIndex=0
frm_calc=''D'
len=1
name='_tdest
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=15
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,159,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4845
fatherSonIndex=1
frm_calc=''P'
len=1
name='_tdest
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=15
prev=O4843
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,159,10)
]
rd_var=[
'_unicode
]
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=15
prev=O4686
var_op='asgn
I
obj='Begin
pag=15
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O4686
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,104,11))),_codinter,Substr(riga,104,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,121,30))),_citinter,Substr(riga,121,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,153,6))),_cabinter,Substr(riga,153,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,151,2))),_prvinter,Substr(riga,151,2))
len=2
name='_interprv
obj='Var
pag=15
prev=O4874
var_op='asgn
I
obj='Var
pag=15
prev=O4873
var_op='asgn
I
obj='Var
pag=15
prev=O4872
var_op='asgn
I
obj='Var
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=15
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=15
prev=O4668
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=15
prev=O4667
var_op='asgn
I
obj='Var
obj_type='N
pag=15
prev=O4666
var_op='asgn
I
obj='Var
obj_type='N
pag=15
prev=O4665
var_op='asgn
I
obj='Remark
pag=15
x=15
y=15
I
Icpitembatch.CPBeginEnd
comment='Variabili di pagina
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella (Operazioni ExtraConto)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_opxerr
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Inizio Elaborazione File Operazioni Extraconto (OPEX.TXT)"+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni ExtraConto Inserite: '+LRTrim(Str(cNumNew,10,0)) + " - Operazioni ExtraConto Scartate: "+LRTrim(Str(cNumMod,10,0))+' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=16
prev=O4895
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=16
prev=O4894
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=16
prev=O4893
var_op='asgn
I
obj='Exec
pag=16
prev=O4892
I
obj='Exec
pag=16
prev=O4891
I
obj='Exec
pag=16
prev=O4889
I
obj='While
pag=16
prev=O4888
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O4889
fatherSonIndex=0
frm_calc=''Sono state elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=16
prev=O4901
var_op='asgn
I
obj='If
pag=16
prev=O4900
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4901
fatherSonIndex=0
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datx
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,16)
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,25,4)+Substr(riga,23,2)+Substr(riga,21,2)
len=8
name='xData
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,1,16)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=16
prev=O4910
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4911
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(Substr(riga,30,30))))
]
h=[
19
19
]
obj='If
pag=16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4916
fatherSonIndex=0
frm_calc='0
len=1
name='_inviato
next=Icpitembatch.CPRead
arch='opextrbo
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xIDB)))
]
h=[
19
19
]
obj='If
pag=16
prev=O4922
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O4923
fatherSonIndex=0
frm_calc=[
'_inviato=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=16
prev=O4928
var_op='asgn
I
obj='If
pag=16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='opextrbo
father=O4928
fatherSonIndex=0
obj='Delete
pag=16
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'xIDB
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O4928
fatherSonIndex=1
obj='Write
pag=16
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'xIDB
]
wr_field=[
'DATAANNU
]
wr_op=[
'=
]
wr_var=[
'Date()
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=16
prev=O4921
rd_field=[
'IDBASE
'COLLEG
'INVIATO
]
rd_kfield=[
'RIFIMP
]
rd_kvar=[
'Substr(riga,30,30)
]
rd_var=[
'xIDB
'cCli1
'_inviato
]
I
obj='Var
obj_type='N
pag=16
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4911
fatherSonIndex=1
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=16
prev=O4957
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='opextrbo
father=O4960
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=16
prev=O4965
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O4966
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGOPEX\'"+LRTrim(gAzienda)+"'",0,10)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='opextrbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=16
prev=O4973
var_op='asgn
I
obj='Insert
pag=16
prev=O4972
rd_kfield=[
'COLLEG
'ANNO
'IDBASE
'DATAOPE
'COINT
'RIFIMP
'PROGOPEX
'RAPPORTO
]
rd_kvar=[
'cCli1
'Substr(riga,17,4)
'xIDB
'CharToDate(xData)
'Substr(riga,29,1)
'Substr(riga,30,30)
'nProgImp
'Substr(riga,17,4)+"_"+LRTrim(cCli1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4973
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,1,16)+" per l'operazione extraconto in data: "+Substr(riga,21,8)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=16
prev=O4982
I
obj='Var
obj_type='N
pag=16
prev=O4981
var_op='asgn
I
obj='Exec
pag=16
prev=O4980
I
nonlocal=True
obj='Var
obj_type='M
pag=16
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=16
prev=O4971
var_op='asgn
I
obj='Var
pag=16
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O4966
fatherSonIndex=1
obj='Write
pag=16
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'xIDB
]
wr_field=[
'DATAOPE
'COINT
'DATAMODI
]
wr_op=[
'=
'=
'=
]
wr_var=[
'CharToDate(xData)
'Substr(riga,29,1)
'Date()
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=16
rd_field=[
'IDBASE
]
rd_kfield=[
'COLLEG
'ANNO
]
rd_kvar=[
'cCli1
'Substr(riga,17,4)
]
rd_var=[
'xIDB
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4960
fatherSonIndex=1
frm_calc='1
len=1
name='_opxerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(xhand,riga+" - Intestatario operazione extraconto non esiste")
obj='Exec
pag=16
prev=O4999
I
obj='Var
obj_type='N
pag=16
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=16
prev=O4956
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4957
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=16
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=16
prev=O4955
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,1,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=16
prev=O4954
var_op='asgn
I
obj='Var
obj_type='N
pag=16
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=16
prev=O4909
var_op='asgn
I
obj='Var
pag=16
prev=O4908
var_op='asgn
I
obj='Var
obj_type='D
pag=16
pagelocal=True
prev=O4907
var_op='asgn
I
obj='Var
pag=16
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=16
prev=O4899
var_op='asgn
I
nonlocal=True
obj='Var
pag=16
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=16
prev=O4887
var_op='asgn
I
obj='Var
pag=16
prev=O4886
var_op='asgn
I
obj='Var
obj_type='N
pag=16
prev=O4885
var_op='asgn
I
obj='Var
obj_type='N
pag=16
prev=O4884
var_op='asgn
I
obj='Var
obj_type='N
pag=16
prev=O4883
var_op='asgn
I
obj='Var
obj_type='N
pag=16
prev=O4882
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=16
prev=O4881
var_op='asgn
I
obj='Remark
pag=16
prev=O4879
I
obj='Begin
pag=16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O4879
fatherSonIndex=0
len=25
name='_aprog
next=Icpitembatch.CPVarDecl
len=15
name='_afile
next=Icpitembatch.CPVarDecl
len=25
name='_dprog
next=Icpitembatch.CPVarDecl
len=15
name='_dfile
next=Icpitembatch.CPVarDecl
len=8
name='_datx
next=Icpitembatch.CPVarDecl
len=1
name='_inviato
obj='Var
obj_type='N
pag=16
prev=O5019
I
obj='Var
obj_type='D
pag=16
pagelocal=True
prev=O5018
I
obj='Var
pag=16
pagelocal=True
prev=O5017
I
obj='Var
pag=16
pagelocal=True
prev=O5016
I
obj='Var
pag=16
pagelocal=True
prev=O5015
I
obj='Var
pag=16
pagelocal=True
I
I
]
w=[
150
150
]
x=18
y=18
I
Icpitembatch.CPRemark
frm_calc='Deleghe sui rapporti
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Deleghe Rapporti Inserite: '+LRTrim(Str(cNumNew,10,0)) + " - Deleghe Rapporti Aggiornate: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=17
prev=O5033
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=17
prev=O5032
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=17
prev=O5031
var_op='asgn
I
obj='Exec
pag=17
prev=O5030
I
obj='Exec
pag=17
prev=O5029
I
obj='Exec
pag=17
prev=O5027
I
obj='While
pag=17
prev=O5026
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5027
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,46,4)+Substr(riga,44,2)+Substr(riga,42,2)
len=8
name='xData
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,55,4)+Substr(riga,53,2)+Substr(riga,51,2)
len=8
name='xDatF
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(xDatF)),CharToDate(xData),CharToDate(xDatF))
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,60,10))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_rifimp))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_rifimp))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=17
prev=O5045
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5048
fatherSonIndex=0
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPRead
arch='delegabo
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=17
prev=O5054
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPSelect
father=O5055
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='delegabo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=17
prev=O5063
var_op='asgn
I
obj='Insert
pag=17
prev=O5062
rd_kfield=[
'RAPPORTO
'CPROWNUM
'CODINTER
'DATAINI
'TIPORAP
'DATAFINE
'IDBASE
'NOAGE
'STATOREG
'NUMPROG1
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
'Substr(riga,26,16)
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
'LibreriaMit.UniqueId()
'iif(Empty(LRTrim(Substr(riga,59,1))),'N',Substr(riga,59,1))
''0'
'_rifimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5063
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=17
prev=O5072
I
obj='Var
obj_type='N
pag=17
prev=O5071
var_op='asgn
I
obj='Exec
pag=17
prev=O5070
I
nonlocal=True
obj='Var
obj_type='M
pag=17
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=17
prev=O5060
var_op='asgn
I
obj='Select
pag=17
sel_field='*
sel_name='delegabo
sel_order='delegabo->CPROWNUM
sel_where='delegabo->RAPPORTO=Left(riga,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5060
fatherSonIndex=0
frm_calc='delegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=17
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPIfElse
father=O5055
fatherSonIndex=1
frm_calc=[
'Empty(LRTrim(xDatF))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=17
prev=O5080
var_op='asgn
I
obj='If
pag=17
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='delegabo
father=O5080
fatherSonIndex=0
h=[
19
19
]
obj='Write
pag=17
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5086
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=17
prev=O5095
I
obj='Var
obj_type='N
pag=17
prev=O5094
var_op='asgn
I
obj='Exec
pag=17
prev=O5093
I
nonlocal=True
obj='Var
obj_type='M
pag=17
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'TIPORAP
'DATAINI
'NUMPROG1
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Substr(riga,50,1)
'CharToDate(xData)
'_rifimp
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='delegabo
father=O5080
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=17
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5102
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=17
prev=O5111
I
obj='Var
obj_type='N
pag=17
prev=O5110
var_op='asgn
I
obj='Exec
pag=17
prev=O5109
I
nonlocal=True
obj='Var
obj_type='M
pag=17
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'TIPORAP
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Substr(riga,50,1)
'CharToDate(xDatF)
'_rifimp
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=17
prev=O5053
rd_field=[
'CPROWNUM
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,16)
]
rd_var=[
'cMaxRow
]
I
obj='Var
obj_type='N
pag=17
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5048
fatherSonIndex=1
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=17
prev=O5126
I
obj='Var
obj_type='N
pag=17
prev=O5125
var_op='asgn
I
obj='Exec
pag=17
prev=O5124
I
nonlocal=True
obj='Var
obj_type='M
pag=17
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=17
prev=O5042
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5045
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_rifimp))
]
h=[
19
19
]
obj='If
pag=17
prev=O5131
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5133
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=17
sel_field='*
sel_name='rapopebo
sel_where='rapopebo->RAPPORTO=Left(riga,25) and rapopebo->DATAOPE=_dataope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5138
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(xDatF))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=17
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5142
fatherSonIndex=0
frm_calc=[
'(At(rapopebo->STATOREG,'|0|1') > 0 or Empty(rapopebo->STATOREG)) and At(rapopebo->TIPOOPRAP,'|25|39|40') > 0
]
h=[
19
19
]
obj='If
pag=17
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5147
fatherSonIndex=0
frm_calc='rapopebo->NUMPROG
len=11
name='_rifimp
obj='Var
pag=17
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5142
fatherSonIndex=1
frm_calc=[
'(At(rapopebo->STATOREG,'|0|1') > 0 or Empty(rapopebo->STATOREG)) and At(rapopebo->TIPOOPRAP,'|28|41|47') > 0
]
h=[
19
19
]
obj='If
pag=17
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5155
fatherSonIndex=0
frm_calc='rapopebo->NUMPROG
len=11
name='_rifimp
obj='Var
pag=17
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=17
sel_field='*
sel_name='rapopebo
sel_where='rapopebo->RAPPORTO=Left(riga,25) and rapopebo->DATAOPE=_dataope and rapopebo->CONNESOPER=LRTrim(Substr(riga,26,16))
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5131
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(xDatF))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=17
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5167
fatherSonIndex=0
frm_calc=[
'(At(rapopebo->STATOREG,'|0|1') > 0 or Empty(rapopebo->STATOREG)) and At(rapopebo->TIPOOPRAP,'|25|39|40') > 0
]
h=[
19
19
]
obj='If
pag=17
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5172
fatherSonIndex=0
frm_calc='rapopebo->NUMPROG
len=11
name='_rifimp
obj='Var
pag=17
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5167
fatherSonIndex=1
frm_calc=[
'(At(rapopebo->STATOREG,'|0|1') > 0 or Empty(rapopebo->STATOREG)) and At(rapopebo->TIPOOPRAP,'|28|41|47') > 0
]
h=[
19
19
]
obj='If
pag=17
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5180
fatherSonIndex=0
frm_calc='rapopebo->NUMPROG
len=11
name='_rifimp
obj='Var
pag=17
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=17
prev=O5041
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='rapopebo
father=O5042
fatherSonIndex=0
obj='Read
pag=17
rd_field=[
'NUMPROG
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'LRTrim(Substr(riga,60,10))
]
rd_var=[
'_rifimp
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=17
prev=O5040
var_op='asgn
I
obj='Var
obj_type='D
pag=17
prev=O5039
var_op='asgn
I
obj='Var
pag=17
prev=O5038
var_op='asgn
I
obj='Var
pag=17
prev=O5037
var_op='asgn
I
obj='Var
obj_type='M
pag=17
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=17
prev=O5025
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=17
prev=O5024
var_op='asgn
I
obj='Var
obj_type='N
pag=17
prev=O5023
var_op='asgn
I
obj='Var
obj_type='N
pag=17
prev=O5022
var_op='asgn
I
obj='Remark
pag=17
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file SOGOPE.TXT altri soggetti operanti
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport')
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Soggetti operanti inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Soggetti operanti aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=18
prev=O5210
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=18
prev=O5209
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=18
prev=O5208
var_op='asgn
I
obj='Exec
pag=18
prev=O5207
I
obj='Exec
pag=18
prev=O5206
I
obj='Exec
pag=18
prev=O5204
I
obj='While
pag=18
prev=O5203
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5204
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_salta
next=Icpitembatch.CPRemark
frm_calc='Verfico la presenza di _unicode nelle tabelle rapopebo/operazbo/fraziobo
next=Icpitembatch.CPRead
arch='rapopebo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=18
prev=O5219
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5221
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='soginfo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=18
prev=O5228
var_op='asgn
I
obj='Insert
pag=18
prev=O5226
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cInfProg2
'Substr(riga,48,1)
'Substr(riga,50,25)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5228
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=18
prev=O5237
I
obj='Var
obj_type='N
pag=18
prev=O5236
var_op='asgn
I
obj='Exec
pag=18
prev=O5235
I
nonlocal=True
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=18
sel_field='*
sel_name='soginfo
sel_where='soginfo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5226
fatherSonIndex=0
frm_calc='soginfo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=18
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=18
prev=O5218
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cOpeProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O5219
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=18
prev=O5251
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5253
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='sogopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=18
prev=O5260
var_op='asgn
I
obj='Insert
pag=18
prev=O5258
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cOpeProg2
'Substr(riga,48,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5260
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=18
prev=O5269
I
obj='Var
obj_type='N
pag=18
prev=O5268
var_op='asgn
I
obj='Exec
pag=18
prev=O5267
I
nonlocal=True
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=18
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5258
fatherSonIndex=0
frm_calc='sogopebo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=18
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=18
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cOpeProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O5251
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=18
prev=O5283
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5285
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='sogopefbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_salta
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=18
prev=O5294
var_op='asgn
I
obj='Var
obj_type='N
pag=18
prev=O5292
var_op='asgn
I
obj='Insert
pag=18
prev=O5290
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cOpeProg2
'Substr(riga,48,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5292
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=18
prev=O5302
I
obj='Var
obj_type='N
pag=18
prev=O5301
var_op='asgn
I
obj='Exec
pag=18
prev=O5300
I
nonlocal=True
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=18
sel_field='*
sel_name='sogopefbo
sel_where='sogopefbo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5290
fatherSonIndex=0
frm_calc='sogopefbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=18
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=18
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cOpeProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
comment='se non trova il valore nelle tre tabelle da errore e stoppa la procedura
instr=Icpitembatch.CPVarDecl
father=O5283
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errore nella valorizazione del campo IDFILEBO nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,21,16)+" non risulta associabile a nessuna informazione/operazione.  Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_salta
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=18
prev=O5319
I
obj='Var
obj_type='N
pag=18
prev=O5318
var_op='asgn
I
obj='Var
obj_type='N
pag=18
prev=O5317
var_op='asgn
I
obj='Exec
pag=18
prev=O5316
I
nonlocal=True
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Remark
pag=18
prev=O5217
I
obj='Var
obj_type='N
pag=18
prev=O5216
var_op='asgn
I
obj='Var
pag=18
prev=O5215
var_op='asgn
I
obj='Var
obj_type='N
pag=18
prev=O5214
var_op='asgn
I
obj='Var
obj_type='M
pag=18
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=18
prev=O5202
var_op='asgn
I
obj='Var
obj_type='N
pag=18
prev=O5201
var_op='asgn
I
obj='Var
pag=18
prev=O5200
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=18
prev=O5199
var_op='asgn
I
obj='Remark
pag=18
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file INTEST.TXT altri intestatari
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Intestatari inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Intestatari aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=19
prev=O5336
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=19
prev=O5335
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=19
prev=O5334
var_op='asgn
I
obj='Exec
pag=19
prev=O5333
I
obj='Exec
pag=19
prev=O5332
I
obj='Exec
pag=19
prev=O5330
I
obj='While
pag=19
prev=O5329
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5330
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPRemark
frm_calc='Verifico in intestbo che ci sia già un recod con lo stesso codice rapporto e memorizzo i dati della riga necessari per crearne una nuova.
next=Icpitembatch.CPSelect
h=[
19
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Se trovo il record inserisco il nuovo intestatario
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
]
obj='If
pag=19
prev=O5346
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='intestbo
father=O5347
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=19
prev=O5352
var_op='asgn
I
obj='Insert
pag=19
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
'PROQUOTA
]
rd_kvar=[
'ciidbase
'cMaxRow + 1
'cidataini
'iif(Empty(Substr(riga,121,1)) ,'P',Substr(riga,121,1))
'Substr(riga,26,16)
'cinumprog
'Substr(riga,1,25)
'citiporap
''0'
'DateToChar(cidataini)+cinumprog+'O'
'Left(LRTrim(Substr(riga,26,16))+Space(5),16)
'Val(Substr(riga,221,3))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5352
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=19
prev=O5361
I
obj='Var
obj_type='N
pag=19
prev=O5360
var_op='asgn
I
obj='Exec
pag=19
prev=O5359
I
nonlocal=True
obj='Var
obj_type='M
pag=19
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=19
prev=O5344
I
obj='Select
pag=19
prev=O5343
sel_field='*
sel_name='intestbo
sel_order='intestbo->CPROWNUM
sel_where='intestbo->RAPPORTO=Substr(riga,1,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5344
fatherSonIndex=0
frm_calc=[
'Substr(riga,26,16)=intestbo->CODINTER
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->CPROWNUM
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->IDBASE
len=10
name='ciidbase
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->DATAINI
len=8
name='cidataini
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->DATAFINE
len=8
name='cidatafine
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->CODINTER
len=12
name='cicodinter
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->NUMPROG1
len=11
name='cinumprog
next=Icpitembatch.CPVarDecl
frm_calc='intestbo->TIPORAP
len=1
name='citiporap
obj='Var
pag=19
prev=O5375
var_op='asgn
I
obj='Var
pag=19
prev=O5374
var_op='asgn
I
obj='Var
pag=19
prev=O5373
var_op='asgn
I
obj='Var
obj_type='D
pag=19
prev=O5372
var_op='asgn
I
obj='Var
obj_type='D
pag=19
prev=O5371
var_op='asgn
I
obj='Var
pag=19
prev=O5370
var_op='asgn
I
obj='Var
obj_type='N
pag=19
prev=O5367
var_op='asgn
I
obj='If
pag=19
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5367
fatherSonIndex=0
frm_calc='intestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=19
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5344
fatherSonIndex=1
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=19
prev=O5384
I
obj='Var
obj_type='N
pag=19
prev=O5383
var_op='asgn
I
obj='Exec
pag=19
prev=O5382
I
nonlocal=True
obj='Var
obj_type='M
pag=19
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
150
]
I
obj='Remark
pag=19
prev=O5342
I
obj='Var
obj_type='N
pag=19
prev=O5341
var_op='asgn
I
obj='Var
obj_type='N
pag=19
prev=O5340
var_op='asgn
I
obj='Var
obj_type='M
pag=19
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=19
prev=O5328
var_op='asgn
I
obj='Var
obj_type='N
pag=19
prev=O5327
var_op='asgn
I
obj='Var
pag=19
prev=O5326
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=19
prev=O5325
var_op='asgn
I
obj='Remark
pag=19
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Deleghe sui rapporti
next=Icpitembatch.CPVarDecl
len=11
name='_nprg1
next=Icpitembatch.CPVarDecl
len=11
name='_nprg2
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Deleghe Rapporti Inserite: '+LRTrim(Str(cNumNew,10,0)) + " - Deleghe Rapporti Aggiornate: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=20
prev=O5401
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=20
prev=O5400
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=20
prev=O5399
var_op='asgn
I
obj='Exec
pag=20
prev=O5398
I
obj='Exec
pag=20
prev=O5397
I
obj='Exec
pag=20
prev=O5395
I
obj='While
pag=20
prev=O5394
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5395
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,46,4)+Substr(riga,44,2)+Substr(riga,42,2)
len=8
name='xData
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,55,4)+Substr(riga,53,2)+Substr(riga,51,2)
len=8
name='xDatF
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(xDatF)),CharToDate(xData),CharToDate(xDatF))
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,60,10))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_rifimp))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_rifimp))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=20
prev=O5413
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5416
fatherSonIndex=0
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPRead
arch='xelegabo
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=20
prev=O5422
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPSelect
father=O5423
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDatF))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=20
prev=O5431
var_op='asgn
I
obj='If
pag=20
prev=O5430
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xelegabo
father=O5431
fatherSonIndex=0
h=[
19
19
]
obj='Insert
pag=20
rd_kfield=[
'RAPPORTO
'CPROWNUM
'CODINTER
'DATAINI
'TIPORAP
'DATAFINE
'IDBASE
'NOAGE
'STATOREG
'NUMPROG1
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
'Substr(riga,26,16)
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
'LibreriaMit.UniqueId()
'iif(Empty(LRTrim(Substr(riga,59,1))),'N',Substr(riga,59,1))
''0'
'_rifimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5437
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=20
prev=O5445
I
obj='Var
obj_type='N
pag=20
prev=O5444
var_op='asgn
I
obj='Exec
pag=20
prev=O5443
I
nonlocal=True
obj='Var
obj_type='M
pag=20
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xelegabo
father=O5431
fatherSonIndex=1
h=[
19
19
]
obj='Insert
pag=20
rd_kfield=[
'RAPPORTO
'CPROWNUM
'CODINTER
'DATAINI
'TIPORAP
'DATAFINE
'IDBASE
'NOAGE
'STATOREG
'NUMPROG2
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
'Substr(riga,26,16)
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
'LibreriaMit.UniqueId()
'iif(Empty(LRTrim(Substr(riga,59,1))),'N',Substr(riga,59,1))
''0'
'_rifimp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5449
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=20
prev=O5457
I
obj='Var
obj_type='N
pag=20
prev=O5456
var_op='asgn
I
obj='Exec
pag=20
prev=O5455
I
nonlocal=True
obj='Var
obj_type='M
pag=20
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=20
prev=O5428
var_op='asgn
I
obj='Select
pag=20
sel_field='*
sel_name='xelegabo
sel_order='xelegabo->CPROWNUM
sel_where='xelegabo->RAPPORTO=Left(riga,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5428
fatherSonIndex=0
frm_calc='xelegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=20
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
comment='se il soggetto esiste
instr=Icpitembatch.CPIfElse
father=O5423
fatherSonIndex=1
frm_calc=[
'Empty(LRTrim(xDatF))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=20
prev=O5466
var_op='asgn
I
obj='If
pag=20
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xelegabo
father=O5466
fatherSonIndex=0
h=[
19
19
]
obj='Write
pag=20
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5472
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=20
prev=O5481
I
obj='Var
obj_type='N
pag=20
prev=O5480
var_op='asgn
I
obj='Exec
pag=20
prev=O5479
I
nonlocal=True
obj='Var
obj_type='M
pag=20
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'TIPORAP
'DATAINI
'NUMPROG1
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Substr(riga,50,1)
'CharToDate(xData)
'_rifimp
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xelegabo
father=O5466
fatherSonIndex=1
h=[
19
19
]
obj='Write
pag=20
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5488
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=20
prev=O5497
I
obj='Var
obj_type='N
pag=20
prev=O5496
var_op='asgn
I
obj='Exec
pag=20
prev=O5495
I
nonlocal=True
obj='Var
obj_type='M
pag=20
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'TIPORAP
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Substr(riga,50,1)
'CharToDate(xDatF)
'_rifimp
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=20
prev=O5421
rd_field=[
'CPROWNUM
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,16)
]
rd_var=[
'cMaxRow
]
I
obj='Var
obj_type='N
pag=20
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5416
fatherSonIndex=1
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=20
prev=O5512
I
obj='Var
obj_type='N
pag=20
prev=O5511
var_op='asgn
I
obj='Exec
pag=20
prev=O5510
I
nonlocal=True
obj='Var
obj_type='M
pag=20
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=20
prev=O5410
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5413
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_rifimp))
]
h=[
19
19
]
obj='If
pag=20
prev=O5517
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5519
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=20
sel_field='*
sel_name='xapopebo
sel_where='xapopebo->RAPPORTO=Left(riga,25) and xapopebo->DATAOPE=_dataope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5524
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(xDatF))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=20
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5528
fatherSonIndex=0
frm_calc=[
'(At(xapopebo->STATOREG,'|0|1') > 0 or Empty(xapopebo->STATOREG)) and At(xapopebo->TIPOOPRAP,'|25|39|40') > 0
]
h=[
19
19
]
obj='If
pag=20
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5533
fatherSonIndex=0
frm_calc='xapopebo->NUMPROG
len=11
name='_rifimp
obj='Var
pag=20
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5528
fatherSonIndex=1
frm_calc=[
'(At(xapopebo->STATOREG,'|0|1') > 0 or Empty(xapopebo->STATOREG)) and At(xapopebo->TIPOOPRAP,'|28|41|47') > 0
]
h=[
19
19
]
obj='If
pag=20
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5541
fatherSonIndex=0
frm_calc='xapopebo->NUMPROG
len=11
name='_rifimp
obj='Var
pag=20
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=20
sel_field='*
sel_name='xapopebo
sel_where='xapopebo->RAPPORTO=Left(riga,25) and xapopebo->DATAOPE=_dataope and xapopebo->CONNESOPER=LRTrim(Substr(riga,26,16))
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5517
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(xDatF))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=20
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5553
fatherSonIndex=0
frm_calc=[
'(At(xapopebo->STATOREG,'|0|1') > 0 or Empty(xapopebo->STATOREG)) and At(xapopebo->TIPOOPRAP,'|25|39|40') > 0
]
h=[
19
19
]
obj='If
pag=20
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5558
fatherSonIndex=0
frm_calc='xapopebo->NUMPROG
len=11
name='_rifimp
obj='Var
pag=20
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5553
fatherSonIndex=1
frm_calc=[
'(At(xapopebo->STATOREG,'|0|1') > 0 or Empty(xapopebo->STATOREG)) and At(xapopebo->TIPOOPRAP,'|28|41|47') > 0
]
h=[
19
19
]
obj='If
pag=20
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5566
fatherSonIndex=0
frm_calc='xapopebo->NUMPROG
len=11
name='_rifimp
obj='Var
pag=20
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=20
prev=O5409
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xapopebo
father=O5410
fatherSonIndex=0
obj='Read
pag=20
rd_field=[
'NUMPROG
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'LRTrim(Substr(riga,60,10))
]
rd_var=[
'_rifimp
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=20
prev=O5408
var_op='asgn
I
obj='Var
obj_type='D
pag=20
prev=O5407
var_op='asgn
I
obj='Var
pag=20
prev=O5406
var_op='asgn
I
obj='Var
pag=20
prev=O5405
var_op='asgn
I
obj='Var
obj_type='M
pag=20
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=20
prev=O5393
var_op='asgn
I
obj='Var
obj_type='N
pag=20
prev=O5392
var_op='asgn
I
obj='Var
obj_type='N
pag=20
prev=O5391
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=20
prev=O5390
var_op='asgn
I
obj='Var
pag=20
pagelocal=True
prev=O5389
I
obj='Var
pag=20
pagelocal=True
prev=O5388
I
obj='Remark
pag=20
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file SOGOPE.TXT altri soggetti operanti in Provvisorio
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport')
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Soggetti operanti inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Soggetti operanti aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=21
prev=O5596
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=21
prev=O5595
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=21
prev=O5594
var_op='asgn
I
obj='Exec
pag=21
prev=O5593
I
obj='Exec
pag=21
prev=O5592
I
obj='Exec
pag=21
prev=O5590
I
obj='While
pag=21
prev=O5589
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5590
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_salta
next=Icpitembatch.CPRemark
frm_calc='Verfico la presenza di _unicode nelle tabelle rapopebo/operazbo/fraziobo
next=Icpitembatch.CPRead
arch='xapopebo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=21
prev=O5605
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5607
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xoginfo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=21
prev=O5614
var_op='asgn
I
obj='Insert
pag=21
prev=O5612
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cInfProg2
'Substr(riga,48,1)
'Substr(riga,50,25)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5614
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=21
prev=O5623
I
obj='Var
obj_type='N
pag=21
prev=O5622
var_op='asgn
I
obj='Exec
pag=21
prev=O5621
I
nonlocal=True
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=21
sel_field='*
sel_name='xoginfo
sel_where='xoginfo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5612
fatherSonIndex=0
frm_calc='xoginfo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=21
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=21
prev=O5604
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cInfProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O5605
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=21
prev=O5637
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5639
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xogopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=21
prev=O5646
var_op='asgn
I
obj='Insert
pag=21
prev=O5644
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cOpeProg2
'Substr(riga,48,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5646
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=21
prev=O5655
I
obj='Var
obj_type='N
pag=21
prev=O5654
var_op='asgn
I
obj='Exec
pag=21
prev=O5653
I
nonlocal=True
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=21
sel_field='*
sel_name='xogopebo
sel_where='xogopebo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5644
fatherSonIndex=0
frm_calc='xogopebo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=21
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=21
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_idbase
'cInfProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O5637
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=21
prev=O5669
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5671
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xogopefbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_salta
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=21
prev=O5680
var_op='asgn
I
obj='Var
obj_type='N
pag=21
prev=O5678
var_op='asgn
I
obj='Insert
pag=21
prev=O5676
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
]
rd_kvar=[
'_idbase
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'LibreriaMit.UniqueId()
'cOpeProg2
'Substr(riga,48,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5678
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=21
prev=O5688
I
obj='Var
obj_type='N
pag=21
prev=O5687
var_op='asgn
I
obj='Exec
pag=21
prev=O5686
I
nonlocal=True
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=21
sel_field='*
sel_name='xogopefbo
sel_where='xogopefbo->IDFILEBO=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5676
fatherSonIndex=0
frm_calc='xogopefbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=21
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=21
rd_field=[
'IDBASE
'NUMPROG
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_idbase
'cInfProg2
'_unicode
]
sons=[
Icpitembatch.CPItemSon
comment='se non trova il valore nelle tre tabelle da errore e stoppa la procedura
instr=Icpitembatch.CPVarDecl
father=O5669
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errore nella valorizazione del campo IDFILEBO nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,21,16)+" non risulta associabile a nessuna informazione/operazione.  Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_salta
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=21
prev=O5705
I
obj='Var
obj_type='N
pag=21
prev=O5704
var_op='asgn
I
obj='Exec
pag=21
prev=O5703
I
obj='Var
obj_type='N
pag=21
prev=O5702
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Remark
pag=21
prev=O5603
I
obj='Var
obj_type='N
pag=21
prev=O5602
var_op='asgn
I
obj='Var
pag=21
prev=O5601
var_op='asgn
I
obj='Var
obj_type='N
pag=21
prev=O5600
var_op='asgn
I
obj='Var
obj_type='M
pag=21
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=21
prev=O5588
var_op='asgn
I
obj='Var
obj_type='N
pag=21
prev=O5587
var_op='asgn
I
obj='Var
pag=21
prev=O5586
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=21
prev=O5585
var_op='asgn
I
obj='Remark
pag=21
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file INTEST.TXT altri intestatari
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Intestatari inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Intestatari aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=22
prev=O5722
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=22
prev=O5721
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=22
prev=O5720
var_op='asgn
I
obj='Exec
pag=22
prev=O5719
I
obj='Exec
pag=22
prev=O5718
I
obj='Exec
pag=22
prev=O5716
I
obj='While
pag=22
prev=O5715
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5716
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPRemark
frm_calc='Verifico in intestbo che ci sia già un recod con lo stesso codice rapporto e memorizzo i dati della riga necessari per crearne una nuova.
next=Icpitembatch.CPSelect
h=[
19
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Se trovo il record inserisco il nuovo intestatario
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
]
obj='If
pag=22
prev=O5732
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xntestbo
father=O5733
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=22
prev=O5738
var_op='asgn
I
obj='Insert
pag=22
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
]
rd_kvar=[
'ciidbase
'cMaxRow + 1
'cidataini
'iif(Empty(Substr(riga,121,1)) ,'P',Substr(riga,121,1))
'Substr(riga,26,16)
'cinumprog
'Substr(riga,1,25)
'citiporap
''0'
'DateToChar(cidataini)+cinumprog+'O'
'Left(LRTrim(Substr(riga,26,16))+Space(5),16)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5738
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=22
prev=O5747
I
obj='Var
obj_type='N
pag=22
prev=O5746
var_op='asgn
I
obj='Exec
pag=22
prev=O5745
I
nonlocal=True
obj='Var
obj_type='M
pag=22
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=22
prev=O5730
I
obj='Select
pag=22
prev=O5729
sel_field='*
sel_name='xntestbo
sel_order='xntestbo->CPROWNUM
sel_where='xntestbo->RAPPORTO=Substr(riga,1,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5730
fatherSonIndex=0
frm_calc=[
'Substr(riga,26,16)=xntestbo->CODINTER
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->CPROWNUM
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->IDBASE
len=10
name='ciidbase
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->DATAINI
len=8
name='cidataini
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->DATAFINE
len=8
name='cidatafine
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->CODINTER
len=12
name='cicodinter
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->NUMPROG1
len=11
name='cinumprog
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->TIPORAP
len=1
name='citiporap
obj='Var
pag=22
prev=O5761
var_op='asgn
I
obj='Var
pag=22
prev=O5760
var_op='asgn
I
obj='Var
pag=22
prev=O5759
var_op='asgn
I
obj='Var
obj_type='D
pag=22
prev=O5758
var_op='asgn
I
obj='Var
obj_type='D
pag=22
prev=O5757
var_op='asgn
I
obj='Var
pag=22
prev=O5756
var_op='asgn
I
obj='Var
obj_type='N
pag=22
prev=O5753
var_op='asgn
I
obj='If
pag=22
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5753
fatherSonIndex=0
frm_calc='xntestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=22
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5730
fatherSonIndex=1
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=22
prev=O5770
I
obj='Var
obj_type='N
pag=22
prev=O5769
var_op='asgn
I
obj='Exec
pag=22
prev=O5768
I
nonlocal=True
obj='Var
obj_type='M
pag=22
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
150
]
I
obj='Remark
pag=22
prev=O5728
I
obj='Var
obj_type='N
pag=22
prev=O5727
var_op='asgn
I
obj='Var
obj_type='N
pag=22
prev=O5726
var_op='asgn
I
obj='Var
obj_type='M
pag=22
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=22
prev=O5714
var_op='asgn
I
obj='Var
obj_type='N
pag=22
prev=O5713
var_op='asgn
I
obj='Var
pag=22
prev=O5712
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=22
prev=O5711
var_op='asgn
I
obj='Remark
pag=22
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Deleghe sui rapporti
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Deleghe Rapporti Inserite: '+LRTrim(Str(cNumNew,10,0)) + " - Deleghe Rapporti Aggiornate: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=23
prev=O5785
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=23
prev=O5784
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=23
prev=O5783
var_op='asgn
I
obj='Exec
pag=23
prev=O5782
I
obj='Exec
pag=23
prev=O5781
I
obj='Exec
pag=23
prev=O5779
I
obj='While
pag=23
prev=O5778
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5779
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPRead
arch='jelegabo
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,46,4)+Substr(riga,44,2)+Substr(riga,42,2)
len=8
name='xData
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,55,4)+Substr(riga,53,2)+Substr(riga,51,2)
len=8
name='xDatF
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=23
prev=O5793
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPSelect
father=O5794
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='jelegabo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=23
prev=O5802
var_op='asgn
I
obj='Insert
pag=23
prev=O5801
rd_kfield=[
'RAPPORTO
'CPROWNUM
'CODINTER
'DATAINI
'TIPORAP
'DATAFINE
'IDBASE
'NOAGE
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
'Substr(riga,26,16)
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
'LibreriaMit.UniqueId()
'iif(Empty(LRTrim(Substr(riga,59,1))),'N',Substr(riga,59,1))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5802
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=23
prev=O5811
I
obj='Var
obj_type='N
pag=23
prev=O5810
var_op='asgn
I
obj='Exec
pag=23
prev=O5809
I
nonlocal=True
obj='Var
obj_type='M
pag=23
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=23
prev=O5799
var_op='asgn
I
obj='Select
pag=23
sel_field='*
sel_name='jelegabo
sel_order='jelegabo->CPROWNUM
sel_where='jelegabo->RAPPORTO=Left(riga,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5799
fatherSonIndex=0
frm_calc='jelegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=23
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
collapsed=True
comment='se il soggetto esiste
instr=Icpitembatch.CPWrite
arch='jelegabo
father=O5794
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=23
prev=O5819
var_op='asgn
I
obj='Write
pag=23
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,25)
'cMaxRow
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5819
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,26,16)+" per il rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=23
prev=O5829
I
obj='Var
obj_type='N
pag=23
prev=O5828
var_op='asgn
I
obj='Exec
pag=23
prev=O5827
I
nonlocal=True
obj='Var
obj_type='M
pag=23
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'DATAINI
'TIPORAP
'DATAFINE
]
wr_op=[
'=
'=
'=
]
wr_var=[
'CharToDate(xData)
'Substr(riga,50,1)
'CharToDate(xDatF)
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=23
prev=O5792
var_op='asgn
I
obj='Var
pag=23
prev=O5791
var_op='asgn
I
obj='Read
pag=23
prev=O5790
rd_field=[
'CPROWNUM
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,16)
]
rd_var=[
'cMaxRow
]
I
obj='Var
obj_type='N
pag=23
prev=O5789
var_op='asgn
I
obj='Var
obj_type='M
pag=23
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=23
prev=O5777
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=23
prev=O5776
var_op='asgn
I
obj='Var
obj_type='N
pag=23
prev=O5775
var_op='asgn
I
obj='Var
obj_type='N
pag=23
prev=O5774
var_op='asgn
I
obj='Remark
pag=23
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file SOGAGE.TXT altri soggetti operanti in Provvisorio
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport')
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Soggetti operanti inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Soggetti operanti aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=24
prev=O5852
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=24
prev=O5851
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=24
prev=O5850
var_op='asgn
I
obj='Exec
pag=24
prev=O5849
I
obj='Exec
pag=24
prev=O5848
I
obj='Exec
pag=24
prev=O5846
I
obj='While
pag=24
prev=O5845
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5846
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_salta
next=Icpitembatch.CPRemark
frm_calc='Verfico la presenza di _unicode nelle tabelle rapopebo/operazbo/fraziobo
next=Icpitembatch.CPRead
arch='japopebo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=24
prev=O5861
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5863
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='joginfo
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=24
prev=O5870
var_op='asgn
I
obj='Insert
pag=24
prev=O5868
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
]
rd_kvar=[
'_unicode
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'_unicode
'cInfProg2
'Substr(riga,48,1)
'Substr(riga,50,25)
]
I
obj='Select
pag=24
sel_field='*
sel_name='joginfo
sel_where='joginfo->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5868
fatherSonIndex=0
frm_calc='joginfo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=24
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=24
prev=O5860
rd_field=[
'IDBASE
'NUMPROG
]
rd_kfield=[
'IDBASE
]
rd_kvar=[
'Substr(riga,11,10) 
]
rd_var=[
'_unicode
'cInfProg2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='jperazbo
father=O5861
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_salta=0 and Substr(riga,11,10) = _unicode
]
h=[
19
19
]
obj='If
pag=24
prev=O5885
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O5887
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='jogopebo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=24
prev=O5894
var_op='asgn
I
obj='Insert
pag=24
prev=O5892
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
]
rd_kvar=[
'_unicode
'cMaxRow + 1
'Substr(riga,21,16)
'Substr(riga,49,1)
'_unicode
'cOpeProg2
'Substr(riga,48,1)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5894
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto operante con codice fiscale: "+Substr(riga,21,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=24
prev=O5903
I
obj='Var
obj_type='N
pag=24
prev=O5902
var_op='asgn
I
obj='Exec
pag=24
prev=O5901
I
nonlocal=True
obj='Var
obj_type='M
pag=24
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=24
sel_field='*
sel_name='jogopebo
sel_where='jogopebo->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5892
fatherSonIndex=0
frm_calc='jogopebo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=24
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=24
rd_field=[
'IDBASE
'NUMPROG
]
rd_kfield=[
'IDBASE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
'cOpeProg2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5885
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errore nella valorizazione del campo IDFILEBO nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,21,16)+" non risulta associabile a nessuna informazione/operazione.  Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_salta
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=24
prev=O5920
I
obj='Var
obj_type='N
pag=24
prev=O5919
var_op='asgn
I
obj='Exec
pag=24
prev=O5918
I
obj='Var
obj_type='N
pag=24
prev=O5917
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=24
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Remark
pag=24
prev=O5859
I
obj='Var
obj_type='N
pag=24
prev=O5858
var_op='asgn
I
obj='Var
pag=24
prev=O5857
var_op='asgn
I
obj='Var
obj_type='N
pag=24
prev=O5856
var_op='asgn
I
obj='Var
obj_type='M
pag=24
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=24
prev=O5844
var_op='asgn
I
obj='Var
obj_type='N
pag=24
prev=O5843
var_op='asgn
I
obj='Var
obj_type='N
pag=24
prev=O5842
var_op='asgn
I
obj='Var
pag=24
prev=O5841
var_op='asgn
I
obj='Remark
pag=24
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Importazione file INTAGE.TXT altri intestatari
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + "Intestatari inseriti: "+LRTrim(Str(cNumNew,10,0)) + " - Intestatari aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=25
prev=O5936
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=25
prev=O5935
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=25
prev=O5934
var_op='asgn
I
obj='Exec
pag=25
prev=O5933
I
obj='Exec
pag=25
prev=O5932
I
obj='Exec
pag=25
prev=O5930
I
obj='While
pag=25
prev=O5929
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5930
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPRemark
frm_calc='Verifico in intestbo che ci sia già un recod con lo stesso codice rapporto e memorizzo i dati della riga necessari per crearne una nuova.
next=Icpitembatch.CPSelect
h=[
19
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Se trovo il record inserisco il nuovo intestatario
next=Icpitembatch.CPIfElse
frm_calc=[
'cNumMod = 0
]
h=[
19
19
]
obj='If
pag=25
prev=O5946
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='jntestbo
father=O5947
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=25
prev=O5952
var_op='asgn
I
obj='Insert
pag=25
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
]
rd_kvar=[
'ciidbase
'cMaxRow + 1
'cidataini
'iif(Empty(Substr(riga,121,1)) ,'P',Substr(riga,121,1))
'Substr(riga,26,16)
'cinumprog
'Substr(riga,1,25)
'citiporap
''0'
'DateToChar(cidataini)+cinumprog+'O'
'Left(LRTrim(Substr(riga,26,16))+Space(5),16)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5952
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=25
prev=O5961
I
obj='Var
obj_type='N
pag=25
prev=O5960
var_op='asgn
I
obj='Exec
pag=25
prev=O5959
I
nonlocal=True
obj='Var
obj_type='M
pag=25
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=25
prev=O5944
I
obj='Select
pag=25
prev=O5943
sel_field='*
sel_name='jntestbo
sel_order='jntestbo->CPROWNUM
sel_where='jntestbo->RAPPORTO=Substr(riga,1,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O5944
fatherSonIndex=0
frm_calc=[
'Substr(riga,26,16)=jntestbo->CODINTER
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->CPROWNUM
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->IDBASE
len=10
name='ciidbase
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->DATAINI
len=8
name='cidataini
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->DATAFINE
len=8
name='cidatafine
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->CODINTER
len=12
name='cicodinter
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->NUMPROG1
len=11
name='cinumprog
next=Icpitembatch.CPVarDecl
frm_calc='jntestbo->TIPORAP
len=1
name='citiporap
obj='Var
pag=25
prev=O5975
var_op='asgn
I
obj='Var
pag=25
prev=O5974
var_op='asgn
I
obj='Var
pag=25
prev=O5973
var_op='asgn
I
obj='Var
obj_type='D
pag=25
prev=O5972
var_op='asgn
I
obj='Var
obj_type='D
pag=25
prev=O5971
var_op='asgn
I
obj='Var
pag=25
prev=O5970
var_op='asgn
I
obj='Var
obj_type='N
pag=25
prev=O5967
var_op='asgn
I
obj='If
pag=25
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5967
fatherSonIndex=0
frm_calc='jntestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=25
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5944
fatherSonIndex=1
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per la registrazione dell'intestatario con codice fiscale "+Substr(riga,26,16)+" relativa al rapporto: "+Substr(riga,1,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=25
prev=O5984
I
obj='Var
obj_type='N
pag=25
prev=O5983
var_op='asgn
I
obj='Exec
pag=25
prev=O5982
I
nonlocal=True
obj='Var
obj_type='M
pag=25
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
150
]
I
obj='Remark
pag=25
prev=O5942
I
obj='Var
obj_type='N
pag=25
prev=O5941
var_op='asgn
I
obj='Var
obj_type='N
pag=25
prev=O5940
var_op='asgn
I
obj='Var
obj_type='M
pag=25
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=25
prev=O5928
var_op='asgn
I
obj='Var
obj_type='N
pag=25
prev=O5927
var_op='asgn
I
obj='Var
obj_type='N
pag=25
prev=O5926
var_op='asgn
I
obj='Var
pag=25
prev=O5925
var_op='asgn
I
obj='Remark
pag=25
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Intestatari Operazioni Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Intestatari Operazioni Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=26
prev=O5999
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=26
prev=O5998
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=26
prev=O5997
var_op='asgn
I
obj='Exec
pag=26
prev=O5996
I
obj='Exec
pag=26
prev=O5995
I
obj='Exec
pag=26
prev=O5993
I
obj='While
pag=26
prev=O5992
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5993
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,48,1)='F'
'Substr(riga,48,1)='O'
]
h=[
19
19
19
]
obj='If
pag=26
prev=O6006
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O6007
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=26
prev=O6012
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O6013
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=26
prev=O6018
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientifrz
father=O6019
fatherSonIndex=0
obj='Insert
pag=26
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'PROQUOTA
'IMPSARA
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Val(Substr(riga,75,3))
'Val(Substr(riga,78,19))/100
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=26
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientifrz
father=O6013
fatherSonIndex=1
obj='Insert
pag=26
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'PROQUOTA
'IMPSARA
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Val(Substr(riga,75,3))
'Val(Substr(riga,78,19))/100
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=26
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O6007
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=26
prev=O6042
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O6043
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=26
prev=O6048
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O6049
fatherSonIndex=0
obj='Insert
pag=26
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'PROQUOTA
'IMPSARA
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Val(Substr(riga,75,3))
'Val(Substr(riga,78,19))/100
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=26
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientiope
father=O6043
fatherSonIndex=1
obj='Insert
pag=26
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'PROQUOTA
'IMPSARA
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Val(Substr(riga,75,3))
'Val(Substr(riga,78,19))/100
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=26
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=26
prev=O6005
var_op='asgn
I
obj='Var
obj_type='N
pag=26
prev=O6004
var_op='asgn
I
obj='Var
obj_type='N
pag=26
prev=O6003
var_op='asgn
I
obj='Var
obj_type='M
pag=26
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=26
prev=O5991
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=26
prev=O5990
var_op='asgn
I
obj='Var
obj_type='N
pag=26
prev=O5989
var_op='asgn
I
obj='Var
obj_type='N
pag=26
prev=O5988
var_op='asgn
I
obj='Remark
pag=26
x=15
y=15
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Altri Soggetti Operazioni Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Altri Soggetti Operazioni Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=29
prev=O6084
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=29
prev=O6083
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=29
prev=O6082
var_op='asgn
I
obj='Exec
pag=29
prev=O6081
I
obj='Exec
pag=29
prev=O6080
I
obj='Exec
pag=29
prev=O6078
I
obj='While
pag=29
prev=O6077
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6078
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,48,1)='F'
'Substr(riga,48,1)='O'
]
h=[
19
19
19
]
obj='If
pag=29
prev=O6091
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O6092
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=29
prev=O6097
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O6098
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=29
prev=O6103
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistifrz
father=O6104
fatherSonIndex=0
obj='Insert
pag=29
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=29
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xerzistifrz
father=O6098
fatherSonIndex=1
obj='Insert
pag=29
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=29
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O6092
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=29
prev=O6127
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O6128
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=29
prev=O6133
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistiope
father=O6134
fatherSonIndex=0
obj='Insert
pag=29
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=29
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xerzistiope
father=O6128
fatherSonIndex=1
obj='Insert
pag=29
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=29
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=29
prev=O6090
var_op='asgn
I
obj='Var
obj_type='N
pag=29
prev=O6089
var_op='asgn
I
obj='Var
obj_type='N
pag=29
prev=O6088
var_op='asgn
I
obj='Var
obj_type='M
pag=29
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=29
prev=O6076
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=29
prev=O6075
var_op='asgn
I
obj='Var
obj_type='N
pag=29
prev=O6074
var_op='asgn
I
obj='Var
obj_type='N
pag=29
prev=O6073
var_op='asgn
I
obj='Remark
pag=29
x=23
y=25
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Beneficiari Operazioni Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Beneficiari Operazioni Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=28
prev=O6169
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=28
prev=O6168
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=28
prev=O6167
var_op='asgn
I
obj='Exec
pag=28
prev=O6166
I
obj='Exec
pag=28
prev=O6165
I
obj='Exec
pag=28
prev=O6163
I
obj='While
pag=28
prev=O6162
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6163
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=28
prev=O6173
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6174
fatherSonIndex=0
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,48,1)='F'
'Substr(riga,48,1)='O'
'Substr(riga,48,1)='I'
]
h=[
19
19
19
19
]
obj='If
pag=28
prev=O6181
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='xraziobo
father=O6182
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=28
prev=O6187
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O6188
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=28
prev=O6193
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O6194
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='beneficfrz
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O6202
var_op='asgn
I
obj='Insert
pag=28
prev=O6201
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'Substr(riga,75,70)
'Substr(riga,145,3)
'Substr(riga,148,30)
'Substr(riga,178,6)
'Substr(riga,184,2)
'Substr(riga,186,35)
'Substr(riga,221,5)
'cMaxRow
]
I
obj='Var
obj_type='N
pag=28
prev=O6199
var_op='asgn
I
obj='Select
pag=28
sel_field='*
sel_name='beneficfrz
sel_order='beneficfrz->CPROWNUM
sel_where='beneficfrz->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6199
fatherSonIndex=0
frm_calc='beneficfrz->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O6188
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='xeneficfrz
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O6219
var_op='asgn
I
obj='Insert
pag=28
prev=O6218
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'Substr(riga,75,70)
'Substr(riga,145,3)
'Substr(riga,148,30)
'Substr(riga,178,6)
'Substr(riga,184,2)
'Substr(riga,186,35)
'Substr(riga,221,5)
'cMaxRow
]
I
obj='Var
obj_type='N
pag=28
prev=O6216
var_op='asgn
I
obj='Select
pag=28
sel_field='*
sel_name='xeneficfrz
sel_order='xeneficfrz->CPROWNUM
sel_where='xeneficfrz->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6216
fatherSonIndex=0
frm_calc='xeneficfrz->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='xperazbo
father=O6182
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=28
prev=O6233
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O6234
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=28
prev=O6239
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O6240
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='beneficope
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O6248
var_op='asgn
I
obj='Insert
pag=28
prev=O6247
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'Substr(riga,75,70)
'Substr(riga,145,3)
'Substr(riga,148,30)
'Substr(riga,178,6)
'Substr(riga,184,2)
'Substr(riga,186,35)
'Substr(riga,221,5)
'cMaxRow
]
I
obj='Var
obj_type='N
pag=28
prev=O6245
var_op='asgn
I
obj='Select
pag=28
sel_field='*
sel_name='beneficope
sel_order='beneficope->CPROWNUM
sel_where='beneficope->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6245
fatherSonIndex=0
frm_calc='beneficope->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O6234
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='xeneficope
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O6265
var_op='asgn
I
obj='Insert
pag=28
prev=O6264
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'CPROWNUM
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
'Substr(riga,75,70)
'Substr(riga,145,3)
'Substr(riga,148,30)
'Substr(riga,178,6)
'Substr(riga,184,2)
'Substr(riga,186,35)
'Substr(riga,221,5)
'cMaxRow
]
I
obj='Var
obj_type='N
pag=28
prev=O6262
var_op='asgn
I
obj='Select
pag=28
sel_field='*
sel_name='xeneficope
sel_order='xeneficope->CPROWNUM
sel_where='xeneficope->IDFILEBO=_unicode
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6262
fatherSonIndex=0
frm_calc='xeneficope->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xapopebo
father=O6182
fatherSonIndex=2
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=28
prev=O6279
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='rapopebo
father=O6280
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=28
prev=O6285
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='fiduciabo
father=O6286
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O6291
var_op='asgn
I
obj='Insert
pag=28
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xiduciabo
father=O6280
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=28
prev=O6301
var_op='asgn
I
obj='Insert
pag=28
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'LEGAME
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Substr(riga,49,1)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=28
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=28
prev=O6180
var_op='asgn
I
obj='Var
obj_type='N
pag=28
prev=O6179
var_op='asgn
I
obj='Var
obj_type='N
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=28
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=28
prev=O6161
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=28
prev=O6160
var_op='asgn
I
obj='Var
obj_type='N
pag=28
prev=O6159
var_op='asgn
I
obj='Var
obj_type='N
pag=28
prev=O6158
var_op='asgn
I
obj='Remark
pag=28
x=21
y=20
I
Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumInv
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='nProgSto
next=Icpitembatch.CPVarDecl
frm_calc='0
len=15
name='nProgImp
next=Ispitembatch.CPMemoryCursor
data_source='tbcitta
expected_rows=10000
key_expression='tbcitta->CITTA
mem_curs_name='mcTBCITTA
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPRead
arch='cpwarn
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'nProgImp > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'nProgSto > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Soggetti Inseriti: '+LRTrim(Str(cNumNew,10,0)) + ' - Soggetti Aggiornati: '+LRTrim(Str(cNumMod,10,0)) + ' - Soggetti Invariati: '+LRTrim(Str(cNumInv,10,0)) + ' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','PERSNEW','Soggetti Inseriti: '+LRTrim(Str(cNumNew,10,0)) + ' - Soggetti Aggiornati: '+LRTrim(Str(cNumMod,10,0)) + ' - Soggetti Invariati: '+LRTrim(Str(cNumInv,10,0)))
obj='Exec
pag=30
prev=O6337
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O6336
var_op='asgn
I
obj='Exec
pag=30
prev=O6335
I
obj='Exec
pag=30
prev=O6334
I
obj='Exec
pag=30
prev=O6333
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O6332
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O6329
var_op='asgn
I
obj='If
pag=30
prev=O6326
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O6329
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'm_nUpdatedRows=0
]
h=[
19
19
]
obj='If
pag=30
prev=O6341
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O6342
fatherSonIndex=0
obj='Insert
pag=30
rd_kfield=[
'tablecode
'warncode
'autonum
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
'nProgSto + 1
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=30
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'nProgSto + 1
]
I
I
]
w=[
150
150
]
I
obj='If
pag=30
prev=O6324
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cpwarn
father=O6326
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'm_nUpdatedRows=0
]
h=[
19
19
]
obj='If
pag=30
prev=O6360
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cpwarn
father=O6361
fatherSonIndex=0
obj='Insert
pag=30
rd_kfield=[
'tablecode
'warncode
'autonum
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
'nProgImp + 1
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=30
rd_kfield=[
'tablecode
'warncode
]
rd_kop=[
'=
'=
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
wr_field=[
'autonum
]
wr_op=[
'=
]
wr_var=[
'nProgImp + 1
]
I
I
]
w=[
150
150
]
I
obj='While
pag=30
prev=O6323
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6324
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=30
prev=O6379
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6380
fatherSonIndex=0
frm_calc=[
'w_creamo='S'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datvarage
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' nominativi del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,112,16)
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,112,16)
len=16
name='xCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,496,16)
len=16
name='_conadd
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(_conadd)),cCli1,_conadd)
len=16
name='cCli1
next=Icpitembatch.CPRemark
frm_calc='Prima la Read si faceva per CF
next=Icpitembatch.CPBeginEnd
comment='Azzera vecchi valori
h=[
19
19
]
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_flgvali
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_flganag
next=Icpitembatch.CPRead
arch='personbo_agg
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,288,1))),'G','P')
len=1
name='_tipper
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,288,1)='M','1',iif(Substr(riga,288,1)='F','2',Substr(riga,288,1)))
len=1
name='xSesso
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,458,1)='0' or Substr(riga,458,1)='1' or Substr(riga,458,1) = ''
'Substr(riga,458,1)='N' or Substr(riga,458,1)='S'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgvali='S',0,xCFE)
len=1
name='xCFE
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgvali='S',Upper(_oldcf),Upper(LRTrim(Substr(riga,112,16))))
len=16
name='xCF
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,6)
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(Substr(riga,260,2))
len=2
name='xPrv
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCodCab))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,136,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'(Substr(xCF,12,1) = 'Z' or Substr(riga,456,2)='EE') and (Substr(riga,288,1)='M' or Substr(riga,288,1)='F')
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Assegna Valori in base a flag
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xConnes)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=30
prev=O6427
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6429
fatherSonIndex=0
frm_calc='nProgImp + 1
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='personbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=30
prev=O6435
var_op='asgn
I
obj='Insert
pag=30
prev=O6434
rd_kfield=[
'ALLINEATO
'ALLINEATONOMECNOME
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'CODORO
'COGNOME
'COMPORT
'CONNES
'DATANASC
'DATAPROF
'DATAREVPROF
'DATARILASC
'DATAVALI
'DATAVARAGE
'DESCCIT
'DOCFILE
'DOMICILIO
'FATCA
'IDENT
'MITIG
'NASCOMUN
'NASSTATO
'NOME
'NOSARA
'NOTIT
'NUMDOCUM
'ODB
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROGIMPORT
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RISGLOB
'RNATGIU
'SESSO
'SETTSINT
'SOTGRUP
'TIN
'TIPINTER
'TIPODOC
'TIPOORO
'TIPOPERS
]
rd_kvar=[
'0
'0
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,478,5)),3))
'Substr(riga,468,10)
'Substr(riga,200,30)
'Substr(riga,265,9)
'xCFE
'xCodCab
'xCF
'Substr(riga,556,11)
'_oldcog
'Upper(Substr(riga,463,5))
'cCli1
'_oldndt
'iif(not(Empty(Substr(riga,565,8))),CharToDate(Substr(riga,573,8)),NullDate())
'iif(not(Empty(Substr(riga,573,8))),CharToDate(Substr(riga,581,8)),NullDate())
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'_datvarage
'Upper(Substr(riga,230,30))
'Substr(riga,356,100)
'Substr(riga,77,35)
'Substr(riga,520,3)
'Substr(riga,592,3)
'iif(Empty(LRTrim(Substr(riga,568,4))),0,Val(Substr(riga,568,4)))
'_oldncm
'_oldnst
'_oldnom
'iif(Empty(LRTrim(Substr(riga,572,1))) or Substr(riga,572,1)='0' or Substr(riga,572,1)='N','N','S')
'iif(Empty(LRTrim(Substr(riga,567,1))),0,Val(Substr(riga,567,1)))
'Substr(riga,177,15)
'iif(Empty(Substr(riga,539,1)),0,Val(Substr(riga,539,1)))
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'iif(Empty(Substr(riga,495,1)),'N',Substr(riga,495,1))
'Substr(riga,459,4)
'nProgImp
'Upper(Substr(riga,260,2))
'_oldrgs
'_oldrgs
'Substr(riga,169,3)
'Val(Substr(riga,492,3))
'Val(Substr(riga,489,3))
'Val(Substr(riga,486,3))
'Substr(riga,589,3)
'Val(Substr(riga,483,3))
'_oldnsx
'Substr(riga,172,3)
'Substr(riga,166,3)
'Substr(riga,523,16)
'_oldnpv
'Substr(riga,175,2)
'Substr(riga,555,1)
'_tipper
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6435
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+LRTrim(Substr(riga,7,70))+" con codice fiscale: "+LRTrim(Substr(riga,112,16))+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore Import file PersNew.txt. Operazione Abortita. Non sono stati importati dati
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=30
prev=O6446
I
obj='Transaction
pag=30
prev=O6445
I
obj='Exec
pag=30
prev=O6444
I
obj='Var
obj_type='N
pag=30
prev=O6443
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O6442
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6429
fatherSonIndex=1
frm_calc='Upper(xCF)+Substr(riga,7,70)+Substr(riga,77,35)+Substr(riga,230,30)+Substr(riga,260,2)+LibreriaMit.SpacePad(LRTrim(Substr(riga,265,9)),5)+Substr(riga,262,3)+Substr(riga,166,3)+Substr(riga,169,3)+Substr(riga,172,3)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+LibreriaMit.SpacePad(Left(cCNAS,30),30)+Substr(riga,456,2)+LibreriaMit.SpacePad(Left(cSNAS,30),30)
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='xRiga1+Substr(riga,175,2)+Substr(riga,177,15)+Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2)+Substr(riga,200,30)+Substr(riga,274,14)+xCodCab
len=10
name='xRiga1
next=Icpitembatch.CPVarDecl
frm_calc='Upper(xCF)+Substr(riga,7,70)+Substr(riga,230,30)+Substr(riga,260,2)
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='xRiga3+LibreriaMit.SpacePad(Left(cCNAS,30),30)+Substr(riga,456,2)+LibreriaMit.SpacePad(Left(cSNAS,30),30)
len=10
name='xRiga3
next=Icpitembatch.CPVarDecl
frm_calc='xRiga3+CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2))+xSesso
len=10
name='xRiga3
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgaggfam='S'
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Crea la riga di confronto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico se il soggetto è una persona fisica
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Substr(riga,516,4)+Substr(riga,514,2)+Substr(riga,512,2))
len=8
name='_datvarage
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,288,1)='M' or Substr(riga,288,1)='F'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=30
par_expr=[
'xConnes
]
par_name=[
'w_CONNES
]
prev=O6465
sel_name='qbe_aggfam_opextrbo_new
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O6468
fatherSonIndex=0
obj='Write
pag=30
rd_kfield=[
'ANNO
'COLLEG
]
rd_kop=[
'=
'=
]
rd_kvar=[
'qbe_aggfam_opextrbo_new->ANNO
'qbe_aggfam_opextrbo_new->COLLEG
]
wr_field=[
'CFESTERO
]
wr_op=[
'=
]
wr_var=[
'iif(_oldest=1,'S','N')
]
I
I
]
w=[
150
150
]
I
obj='If
pag=30
prev=O6464
sons=[
Icpitembatch.CPItemSon
comment='se persona fisica
instr=Icpitembatch.CPWrite
arch='personbo
father=O6465
fatherSonIndex=0
frm_calc='Errore in aggiornamento PERSNEW
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=30
prev=O6484
var_op='asgn
I
obj='Write
pag=30
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'xConnes
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6484
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
frm_calc='m_cLastMsgError = ""
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=30
prev=O6494
I
obj='Exec
pag=30
prev=O6493
I
obj='Var
obj_type='N
pag=30
prev=O6492
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'CODORO
'COGNOME
'COMPORT
'DATANASC
'DATAPROF
'DATAREVPROF
'DATARILASC
'DATAVALI
'DATAVARAGE
'DESCCIT
'DOCFILE
'DOMICILIO
'FATCA
'IDENT
'IDNASCOMUN
'IDNASSTATO
'MITIG
'NASCOMUN
'NASSTATO
'NOME
'NOSARA
'NOTIT
'NUMDOCUM
'ODB
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RISGLOB
'RNATGIU
'SESSO
'SETTSINT
'SOTGRUP
'TIN
'TIPINTER
'TIPODOC
'TIPOORO
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,478,5)),3))
'Substr(riga,468,10)
'Substr(riga,200,30)
'Substr(riga,265,9)
'_oldest
'xCodCab
'xCF
'Substr(riga,556,11)
'_oldcog
'Substr(riga,463,5)
'_oldndt
'iif(not(Empty(Substr(riga,565,8))),CharToDate(Substr(riga,573,8)),NullDate())
'iif(not(Empty(Substr(riga,573,8))),CharToDate(Substr(riga,581,8)),NullDate())
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'_datvarage
'Upper(Substr(riga,230,30))
'Substr(riga,356,100)
'Substr(riga,77,35)
'Substr(riga,520,3)
'Substr(riga,592,3)
'''
'''
'iif(Empty(LRTrim(Substr(riga,568,4))),0,Val(Substr(riga,568,4)))
'_oldncm
'_oldnst
'_oldnom
'iif(Empty(LRTrim(Substr(riga,572,1))) or Substr(riga,572,1)='0' or Substr(riga,572,1)='N','N','S')
'iif(Empty(LRTrim(Substr(riga,567,1))),0,Val(Substr(riga,567,1)))
'Substr(riga,177,15)
'iif(Empty(Substr(riga,539,1)),0,Val(Substr(riga,539,1)))
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'iif(Empty(Substr(riga,495,1)),'N',Substr(riga,495,1))
'Substr(riga,459,4)
'Upper(Substr(riga,260,2))
'_oldrgs
'_oldrgs
'Substr(riga,169,3)
'Val(Substr(riga,492,3))
'Val(Substr(riga,489,3))
'Val(Substr(riga,486,3))
'Substr(riga,589,3)
'Val(Substr(riga,483,3))
'_oldnsx
'Substr(riga,172,3)
'Substr(riga,166,3)
'Substr(riga,523,16)
'_oldnpv
'Substr(riga,175,2)
'Substr(riga,555,1)
]
I
I
Icpitembatch.CPItemSon
comment='se persona giuridica
instr=Icpitembatch.CPRemark
father=O6465
fatherSonIndex=1
frm_calc='Se non è persona fisica
next=Icpitembatch.CPWrite
arch='personbo
frm_calc='Errore in aggiornamento PERSNEW
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=30
prev=O6502
var_op='asgn
I
obj='Write
pag=30
prev=O6501
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'xConnes
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6502
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=30
prev=O6511
I
obj='Var
obj_type='N
pag=30
prev=O6510
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'AREAGEO
'ATTIV
'AUTRILASC
'CAP
'CFESTERO
'CODCAB
'CODFISC
'CODORO
'COGNOME
'COMPORT
'DATANASC
'DATAPROF
'DATAREVPROF
'DATARILASC
'DATAVALI
'DATAVARAGE
'DESCCIT
'DOCFILE
'DOMICILIO
'FATCA
'IDENT
'MITIG
'NASCOMUN
'NASSTATO
'NOME
'NOSARA
'NOTIT
'NUMDOCUM
'ODB
'PAESE
'PARTIVA
'PEP
'PKTBSPECIE
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RISGLOB
'RNATGIU
'SESSO
'SETTSINT
'SOTGRUP
'TIN
'TIPINTER
'TIPODOC
'TIPOORO
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'arfn_conv_stato_uic(Left(LRTrim(Substr(riga,478,5)),3))
'Substr(riga,468,10)
'Substr(riga,200,30)
'Substr(riga,265,9)
'_oldest
'xCodCab
'xCF
'Substr(riga,556,11)
'_oldcog
'Substr(riga,463,5)
'_oldndt
'iif(not(Empty(Substr(riga,565,8))),CharToDate(Substr(riga,573,8)),NullDate())
'iif(not(Empty(Substr(riga,573,8))),CharToDate(Substr(riga,581,8)),NullDate())
'CharToDate(Substr(riga,196,4)+Substr(riga,194,2)+Substr(riga,192,2))
'CharToDate(Substr(riga,293,4)+Substr(riga,291,2)+Substr(riga,289,2))
'_datvarage
'Upper(Substr(riga,230,30))
'Substr(riga,356,100)
'Substr(riga,77,35)
'Substr(riga,520,3)
'Substr(riga,592,3)
'iif(Empty(LRTrim(Substr(riga,568,4))),0,Val(Substr(riga,568,4)))
'_oldncm
'_oldnst
'_oldnom
'iif(Empty(LRTrim(Substr(riga,572,1))) or Substr(riga,572,1)='0' or Substr(riga,572,1)='N','N','S')
'iif(Empty(LRTrim(Substr(riga,567,1))),0,Val(Substr(riga,567,1)))
'Substr(riga,177,15)
'iif(Empty(Substr(riga,539,1)),0,Val(Substr(riga,539,1)))
'arfn_conv_stato_uic(Substr(riga,262,3))
'Substr(riga,274,14)
'iif(Empty(Substr(riga,495,1)),'N',Substr(riga,495,1))
'Substr(riga,459,4)
'Upper(Substr(riga,260,2))
'_oldrgs
'_oldrgs
'Substr(riga,169,3)
'Val(Substr(riga,492,3))
'Val(Substr(riga,489,3))
'Val(Substr(riga,486,3))
'Substr(riga,589,3)
'Val(Substr(riga,483,3))
'_oldnsx
'Substr(riga,172,3)
'Substr(riga,166,3)
'Substr(riga,523,16)
'_oldnpv
'Substr(riga,175,2)
'Substr(riga,555,1)
]
I
obj='Remark
pag=30
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='D
pag=30
prev=O6463
var_op='asgn
I
obj='Remark
pag=30
prev=O6461
I
obj='Select
pag=30
prev=O6460
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Riga 2 e Riga 4 e Riga 6
father=O6461
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Se le due stringhe sono diverse, ci sono delle modifiche da fare. Quindi storicizzo in wersonbo le modifche.
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(xRiga1) <> LRTrim(xRiga2)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgaggfam='S'
]
h=[
19
19
]
obj='If
pag=30
prev=O6523
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6526
fatherSonIndex=0
frm_calc=[
'LRTrim(xRiga5) <> LRTrim(xRiga6) or w_flgforzaagg='S'
]
h=[
19
19
]
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='bat
father=O6531
fatherSonIndex=0
frm_calc='arrt_ae_agg_aetesta_sog(xConnes,_oldest)
obj='Exec
pag=30
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=30
prev=O6522
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O6523
fatherSonIndex=0
frm_calc='Verifico se c'è già una variazione
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,297,8)))
'DateDiff(CharToDate(Substr(riga,301,4)+Substr(riga,299,2)+Substr(riga,297,2)),Date()) > 30
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
obj='If
pag=30
prev=O6546
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O6548
fatherSonIndex=0
frm_calc='Calcola il progressivo di registrazione
next=Icpitembatch.CPVarDecl
frm_calc='nProgSto + 1
len=10
name='nProgSto
next=Icpitembatch.CPVarDecl
frm_calc='Right('000000000000000'+LRTrim(Str(nProgSto,15,0)),15)
len=15
name='cProgSto
next=Icpitembatch.CPInsert
arch='wersonbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_creamo='S'
]
h=[
19
19
]
obj='If
pag=30
prev=O6556
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6558
fatherSonIndex=0
frm_calc=[
'LRTrim(xRiga3) <> LRTrim(xRiga4)
]
h=[
19
19
]
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O6563
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=30
prev=O6568
sel_field='fraziobo->IDBASE
sel_name='fraziobo
sel_where='fraziobo->CONNESCLI=xConnes or fraziobo->CONNESOPER=xConnes or fraziobo->CONNESBEN=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6570
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(gAzienda)+"'",Space(10),10)
len=10
name='cNewProg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc=''JLMNOTUV?'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='fraziobo->IDBASE
len=10
name='_idbase
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=30
prev=O6576
sel_field='*
sel_name='fraziobo
sel_where='fraziobo->IDBASE=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6577
fatherSonIndex=0
frm_calc='iif(Empty(fraziobo->FLAGRAP2),Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(fraziobo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPInsert
arch='fraziobo
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(operazbo->DATAOPE)+"F"+LibreriaMit.UniqueId()+"X"
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=30
prev=O6583
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_idbase
]
wr_field=[
'OPERAZMOD
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
'=
]
wr_var=[
'fraziobo->IDEREG
''1'
'Date()
]
I
obj='Var
pag=30
prev=O6582
var_op='asgn
I
obj='Insert
pag=30
prev=O6581
rd_kfield=[
'AREAGEO
'AUTOM
'CAMBIO
'CDATAOPE
'CDATOPE
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'MODSVOL
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'PAESE
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
'CONNALTRO
'CONNESDOC
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'DATAIMP
'C_RAPPORTO
'PAGASOGOP
'MTCN
'IDFILE
'CDATREG
'IPCOLLEG
'ORACOLLEG
'DUCOLLEG
'ANNOOPE
]
rd_kvar=[
'fraziobo->AREAGEO
'fraziobo->AUTOM
'fraziobo->CAMBIO
'fraziobo->CDATAOPE
'fraziobo->CDATOPE
'fraziobo->CODANA
'fraziobo->CODCAB
'fraziobo->CODCAB2
'fraziobo->CODDIPE
'fraziobo->CODINT2
'fraziobo->CODINTER
'fraziobo->CODVOC
'fraziobo->COLLEG
'fraziobo->CONNESBEN
'fraziobo->CONNESCLI
'fraziobo->CONNESOPER
'fraziobo->DATAOPE
'fraziobo->DATAREG
'Date()
'fraziobo->DESC2
'fraziobo->DESCCIT
'fraziobo->DESCINTER
'fraziobo->DOCFILE
'fraziobo->FLAGCONT
'fraziobo->FLAGFRAZ
'fraziobo->FLAGLIRE
'fraziobo->FLAGRAP
'_flagrap2
'cNewProg
'fraziobo->idcauana
'fraziobo->IDEREG
'fraziobo->INFORM
'fraziobo->MODSVOL
'fraziobo->NATURA
'fraziobo->NOPROT
'fraziobo->NUMPROG
'fraziobo->OPERAG
'fraziobo->OPERATORE
'fraziobo->OPERAZMOD
'fraziobo->OPRAP
'fraziobo->PAESE
'fraziobo->PRGIMPFRZ
'fraziobo->PROV2
'fraziobo->PROVINCIA
'fraziobo->RAGIO
'fraziobo->RAPPORTBEN
'fraziobo->RAPPORTO
'fraziobo->RAREA
'fraziobo->RCOMP
'fraziobo->RESPINS
'fraziobo->RFREQ
'fraziobo->RIFIMP
'fraziobo->RIMP
'fraziobo->RRAGIO
'fraziobo->RTIPO
'fraziobo->SCOPO
'fraziobo->SEGNO
''3'
'fraziobo->TIPO
'fraziobo->TIPOINF
'fraziobo->TIPOINT2
'fraziobo->TIPOINTER
'fraziobo->TIPOLEG
'fraziobo->TIPOOPRAP
'fraziobo->TOTCONT
'fraziobo->TOTLIRE
'fraziobo->UCODE
'fraziobo->UNIQUECODE
'fraziobo->VALUTA
'fraziobo->ZCPARTE
'fraziobo->CONNALTRO
'fraziobo->CONNESDOC
'fraziobo->C_RAG
'fraziobo->C_STA
'fraziobo->C_CTA
'fraziobo->C_CAB
'fraziobo->C_PRV
'fraziobo->C_IND
'fraziobo->C_CAP
'fraziobo->DATAIMP
'fraziobo->C_RAPPORTO
'fraziobo->PAGASOGOP
'fraziobo->MTCN
'fraziobo->IDFILE
'fraziobo->CDATREG
'fraziobo->IPCOLLEG
'fraziobo->ORACOLLEG
'fraziobo->DUCOLLEG
'fraziobo->ANNOOPE
]
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=30
prev=O6575
var_op='asgn
I
obj='Var
pag=30
prev=O6574
var_op='asgn
I
obj='Var
pag=30
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=30
sel_field='operazbo->IDBASE
sel_name='operazbo
sel_where='operazbo->CONNESCLI=xConnes or operazbo->CONNESOPER=xConnes or operazbo->CONNESBEN=xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6568
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",Space(10),10)
len=10
name='cNewProg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='operazbo->IDBASE
len=10
name='_idbase
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=30
prev=O6599
sel_field='*
sel_name='operazbo
sel_where='operazbo->IDBASE=_idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6600
fatherSonIndex=0
frm_calc='iif(Empty(operazbo->FLAGRAP2),Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(operazbo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPInsert
arch='operazbo
next=Icpitembatch.CPVarDecl
frm_calc='DateToChar(operazbo->DATAOPE)+"O"+LibreriaMit.UniqueId()+"X"
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=30
prev=O6606
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_idbase
]
wr_field=[
'OPERAZMOD
'STATOREG
'DATARETT
'IDEREG
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'operazbo->IDEREG
''1'
'Date()
'_idreg
]
I
obj='Var
pag=30
prev=O6605
var_op='asgn
I
obj='Insert
pag=30
prev=O6604
rd_kfield=[
'AMMONT
'AREAGEO
'AUTOM
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESDOC
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DOCFILE
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'IDFILE
'INFORM
'IPCOLLEG
'MODSVOL
'MTCN
'NATURA
'NOPROT
'NUMPROG
'OPERAG
'OPERATORE
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RESPINS
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UCODE
'UNIQUECODE
'VALUTA
'ZCPARTE
'ANNOOPE
]
rd_kvar=[
'operazbo->AMMONT
'operazbo->AREAGEO
'operazbo->AUTOM
'operazbo->C_CAB
'operazbo->C_CAP
'operazbo->C_CTA
'operazbo->C_IND
'operazbo->C_PRV
'operazbo->C_RAG
'operazbo->C_RAPPORTO
'operazbo->C_STA
'operazbo->CAMBIO
'operazbo->CDATAOPE
'operazbo->CDATOPE
'operazbo->CDATREG
'operazbo->CODANA
'operazbo->CODCAB
'operazbo->CODCAB2
'operazbo->CODDIPE
'operazbo->CODINT2
'operazbo->CODINTER
'operazbo->CODVOC
'operazbo->COLLEG
'operazbo->CONNALTRO
'operazbo->CONNESBEN
'operazbo->CONNESCLI
'operazbo->CONNESDOC
'operazbo->CONNESOPER
'operazbo->DATAIMP
'operazbo->DATAOPE
'operazbo->DATAREG
'Date()
'operazbo->DESC2
'operazbo->DESCCIT
'operazbo->DESCINTER
'operazbo->DOCFILE
'operazbo->DUCOLLEG
'operazbo->DURAT
'operazbo->FLAGCONT
'operazbo->FLAGFRAZ
'operazbo->FLAGLIRE
'operazbo->FLAGRAP
'_flagrap2
'cNewProg
'operazbo->idcauana
'operazbo->IDEREG
'operazbo->IDFILE
'operazbo->INFORM
'operazbo->IPCOLLEG
'operazbo->MODSVOL
'operazbo->MTCN
'operazbo->NATURA
'operazbo->NOPROT
'operazbo->NUMPROG
'operazbo->OPERAG
'operazbo->OPERATORE
'operazbo->OPERAZMOD
'operazbo->OPRAP
'operazbo->ORACOLLEG
'operazbo->PAESE
'operazbo->PAGASOGOP
'operazbo->PRGIMPOPE
'operazbo->PROV2
'operazbo->PROVINCIA
'operazbo->RAGIO
'operazbo->RAPPORTBEN
'operazbo->RAPPORTO
'operazbo->RAREA
'operazbo->RCOMP
'operazbo->RESPINS
'operazbo->RFREQ
'operazbo->RIFIMP
'operazbo->RIMP
'operazbo->RRAGIO
'operazbo->RTIPO
'operazbo->SCOPO
'operazbo->SEGNO
''3'
'operazbo->TIPO
'operazbo->TIPOINF
'operazbo->TIPOINT2
'operazbo->TIPOINTER
'operazbo->TIPOLEG
'operazbo->TIPOOPRAP
'operazbo->TOTCONT
'operazbo->TOTLIRE
'operazbo->UCODE
'operazbo->UNIQUECODE
'operazbo->VALUTA
'operazbo->ZCPARTE
'operazbo->ANNOOPE
]
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=30
prev=O6598
var_op='asgn
I
obj='Var
pag=30
prev=O6597
var_op='asgn
I
obj='Var
pag=30
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=30
prev=O6555
rd_kfield=[
'ALLINEATO
'ALLINEATONOMECNOME
'ALTROCAP
'ALTRODOM
'AREAGEO
'ATTIV
'AUTRILASC
'BANCABEN
'CAP
'CFESTERO
'CITTADIN1
'CITTADIN2
'CODCAB
'CODDIPE
'CODFISC
'CODINTER
'CODORO
'COGNOME
'COMPORT
'CONNES
'CRIME
'CRIMEDATE
'DAC6
'datamodi
'DATANASC
'DATAPROF
'DATAREVPROF
'DATARILASC
'DATASEGN
'DATAVALI
'DATEXTRA
'DESCCIT
'DOCFILE
'DOMICILIO
'FATCA
'FLAGDAC6
'FLGVALIDO
'IDBASE
'idcitta
'IDENT
'IDFILE
'IDNASCOMUN
'IDNASSTATO
'MACROAGENTE
'MITGDOC
'MITIG
'NASCOMUN
'NASSTATO
'NOME
'NOSARA
'NOTE
'NOTIT
'NUMDOCUM
'ODB
'OLDCODFISC
'OLDCONNES
'OLDSETSIN
'PAESE
'PARTIVA
'PEP
'PEPDATE
'PKTBSPECIE
'PROGIMP_C
'PROGIMPORT
'PROVINCIA
'RAGSOC
'RAGSOCOLD
'RAMOGRUP
'RAREA
'RATTIV
'RCOMP
'RESFISC
'RISGLOB
'RNATGIU
'sanumpro
'SESSO
'SETTSINT
'SETTSINT2
'SOSPMAF
'SOTGRUP
'SPOTID
'TELEF
'TIN
'TIPINTER
'TIPODOC
'TIPOORO
'TIPOPERS
]
rd_kvar=[
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->ALTROCAP
'personbo->ALTRODOM
'personbo->AREAGEO
'personbo->ATTIV
'personbo->AUTRILASC
'personbo->BANCABEN
'personbo->CAP
'personbo->CFESTERO
'personbo->CITTADIN1
'personbo->CITTADIN2
'personbo->CODCAB
'personbo->CODDIPE
'personbo->CODFISC
'personbo->CODINTER
'personbo->CODORO
'personbo->COGNOME
'personbo->COMPORT
'xConnes
'personbo->CRIME
'personbo->CRIMEDATE
'personbo->DAC6
'_datarett
'personbo->DATANASC
'personbo->DATAPROF
'personbo->DATAREVPROF
'personbo->DATARILASC
'personbo->DATASEGN
'personbo->DATAVALI
'personbo->DATEXTRA
'personbo->DESCCIT
'personbo->DOCFILE
'personbo->DOMICILIO
'personbo->FATCA
'personbo->FLAGDAC6
'personbo->FLGVALIDO
'personbo->IDBASE
'personbo->idcitta
'personbo->IDENT
'personbo->IDFILE
'personbo->IDNASCOMUN
'personbo->IDNASSTATO
'personbo->MACROAGENTE
'personbo->MITIGDOC
'personbo->MITIG
'personbo->NASCOMUN
'personbo->NASSTATO
'personbo->NOME
'personbo->NOSARA
'personbo->NOTE
'personbo->NOTIT
'personbo->NUMDOCUM
'personbo->ODB
'personbo->OLDCODFISC
'personbo->OLDCONNES
'personbo->OLDSETSIN
'personbo->PAESE
'personbo->PARTIVA
'personbo->PEP
'personbo->PEPDATE
'personbo->PKTBSPECIE
'personbo->PROGIMP_C
'personbo->PROGIMPORT
'personbo->PROVINCIA
'personbo->RAGSOC
'personbo->RAGSOCOLD
'personbo->RAMOGRUP
'personbo->RAREA
'personbo->RATTIV
'personbo->RCOMP
'personbo->RESFISC
'personbo->RISGLOB
'personbo->RNATGIU
'cProgSto
'personbo->SESSO
'personbo->SETTSINT
'personbo->SETTSINT2
'personbo->SOSPMAF
'personbo->SOTGRUP
'personbo->SPOTID
'personbo->TELEF
'personbo->TIN
'personbo->TIPINTER
'personbo->TIPODOC
'personbo->TIPOORO
'personbo->TIPOPERS
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6556
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto: "+Substr(riga,7,70)+" con codice fiscale: "+Substr(riga,112,16)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
frm_calc='m_cLastMsgError = ""
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=30
prev=O6626
I
obj='Exec
pag=30
prev=O6625
I
obj='Var
obj_type='N
pag=30
prev=O6624
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=30
pagelocal=True
prev=O6554
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O6553
var_op='asgn
I
obj='Remark
pag=30
I
I
]
w=[
150
150
]
I
obj='Select
pag=30
prev=O6543
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=xConnes and wersonbo->datamodi=_datarett
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6546
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=30
prev=O6542
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6543
fatherSonIndex=0
frm_calc='Date()
len=8
name='_datarett
obj='Var
obj_type='D
pag=30
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6543
fatherSonIndex=1
frm_calc='arfn_dateminus(Date(),30)
len=8
name='_datarett
obj='Var
obj_type='D
pag=30
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6543
fatherSonIndex=2
frm_calc='CharToDate(Substr(riga,301,4)+Substr(riga,299,2)+Substr(riga,297,2))
len=8
name='_datarett
obj='Var
obj_type='D
pag=30
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=30
prev=O6541
var_op='asgn
I
obj='Remark
pag=30
I
I
]
w=[
150
150
]
I
obj='Remark
pag=30
prev=O6520
I
obj='Begin
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6520
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad(personbo->CODFISC,16)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->RAGSOC,70)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->DOMICILIO,35)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->DESCCIT,30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->PROVINCIA,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(LRTrim(personbo->CAP),5)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->PAESE,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->SOTGRUP,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->RAMOGRUP,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->SETTSINT,3)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(Left(personbo->NASCOMUN,30),30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(personbo->TIPINTER,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + LibreriaMit.SpacePad(Left(personbo->NASSTATO,30),30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + iif(DateToChar(personbo->DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATANASC),8),Space(8))
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->TIPODOC,2)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->NUMDOCUM,15)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 + iif(DateToChar(personbo->DATARILASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATARILASC),8),Space(8))
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->AUTRILASC,30)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->PARTIVA,14)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='xRiga2 +LibreriaMit.SpacePad(personbo->CODCAB,6)
len=10
name='xRiga2
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.SpacePad(personbo->CODFISC,16)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->RAGSOC,70)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->DESCCIT,30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->PROVINCIA,2)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(Left(personbo->NASCOMUN,30),30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->TIPINTER,2)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(Left(personbo->NASSTATO,30),30)
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + iif(DateToChar(personbo->DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATANASC),8),Space(8))
len=10
name='xRiga4
next=Icpitembatch.CPVarDecl
frm_calc='xRiga4 + LibreriaMit.SpacePad(personbo->SESSO,1)
len=10
name='xRiga4
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgaggfam='S'
]
h=[
19
19
]
obj='If
pag=30
prev=O6673
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6674
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad(personbo->CODFISC,16)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->RAGSOC,70)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->DESCCIT,30)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->PAESE,3)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->PROVINCIA,2)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->COGNOME,26)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->NOME,25)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->SESSO,1)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + iif(DateToChar(personbo->DATANASC) <> '01000101',LibreriaMit.SpacePad(DateToChar(personbo->DATANASC),8),Space(8))
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(Left(personbo->NASCOMUN,30),30)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(personbo->TIPINTER,2)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='xRiga6 + LibreriaMit.SpacePad(Left(personbo->NASSTATO,30),30)
len=10
name='xRiga6
next=Icpitembatch.CPVarDecl
frm_calc='iif(personbo->CFESTERO=1,'1','0')
len=10
name='xRiga6
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6690
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6689
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6688
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6687
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6686
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6685
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6684
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6683
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6682
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6681
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6680
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6679
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6672
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6671
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6670
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6669
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6668
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6667
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6666
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6665
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6664
var_op='asgn
I
obj='Var
obj_type='M
pag=30
prev=O6663
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6662
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6661
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6660
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6659
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6658
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6657
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6656
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6655
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6654
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6653
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6652
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6651
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6650
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6649
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6648
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6647
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6646
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6645
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=30
prev=O6457
I
obj='If
pag=30
prev=O6456
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6457
fatherSonIndex=0
frm_calc='LibreriaMit.SpacePad(Upper(xCF),16)+Substr(riga,7,70)+Substr(riga,230,30)+Substr(riga,262,3)+Substr(riga,260,2)
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+Substr(riga,305,26)+Substr(riga,331,25)+xSesso
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2)+LibreriaMit.SpacePad(Left(cCNAS,30),30)+Substr(riga,456,2)
len=10
name='xRiga5
next=Icpitembatch.CPVarDecl
frm_calc='xRiga5+LibreriaMit.SpacePad(Left(cSNAS,30),30)+xCFE
len=10
name='xRiga5
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6699
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6698
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6697
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6455
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6454
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6453
var_op='asgn
I
obj='Var
obj_type='M
pag=30
prev=O6452
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6451
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6450
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=30
prev=O6424
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6427
fatherSonIndex=0
frm_calc='iif(_flganag='S',_oldcog,Upper(Substr(riga,305,26)))
len=26
name='_oldcog
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnom,Upper(Substr(riga,331,25)))
len=26
name='_oldnom
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldrgs,Upper(Substr(riga,7,70)))
len=70
name='_oldrgs
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldncm,cCNAS)
len=30
name='_oldncm
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnst,cSNAS)
len=30
name='_oldnst
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldndt,CharToDate(Substr(riga,132,4)+Substr(riga,130,2)+Substr(riga,128,2)))
len=8
name='_oldndt
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnpv,Upper(Substr(riga,456,2)))
len=2
name='_oldnpv
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flganag='S',_oldnsx,xSesso)
len=1
name='_oldnsx
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgvali='S',_oldest,xCFE)
len=1
name='_oldest
obj='Var
obj_type='N
pag=30
prev=O6712
var_op='asgn
I
obj='Var
pag=30
prev=O6711
var_op='asgn
I
obj='Var
pag=30
prev=O6710
var_op='asgn
I
obj='Var
obj_type='D
pag=30
prev=O6709
var_op='asgn
I
obj='Var
pag=30
prev=O6708
var_op='asgn
I
obj='Var
pag=30
prev=O6707
var_op='asgn
I
obj='Var
pag=30
prev=O6706
var_op='asgn
I
obj='Var
pag=30
prev=O6705
var_op='asgn
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=30
prev=O6423
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6424
fatherSonIndex=0
frm_calc='Substr(riga,136,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=30
prev=O6717
var_op='asgn
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=30
prev=O6422
var_op='asgn
I
obj='Var
pag=30
prev=O6419
var_op='asgn
I
obj='If
pag=30
prev=O6418
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6419
fatherSonIndex=0
frm_calc='Upper(Substr(riga,230,30))
len=30
name='xCitta
next=Icpitembatch.CPForEach
for_variable='rowTBCITTA
for_variable_type='tbcitta
h=[
19
19
]
iterator_expr='mcTBCITTA
obj='ForEach
pag=30
prev=O6722
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6723
fatherSonIndex=0
frm_calc=[
'LRTrim(rowTBCITTA.CITTA)=LRTrim(xCitta)
]
h=[
19
19
]
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6727
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(xPrv))) and rowTBCITTA.PROV=xPrv
'not(Empty(LRTrim(xPrv))) and rowTBCITTA.PROV=xPrv
]
h=[
19
19
19
19
]
haselse=True
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6732
fatherSonIndex=0
frm_calc='rowTBCITTA.CAB
len=6
name='xCodCab
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=30
prev=O6737
I
obj='Var
pag=30
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6732
fatherSonIndex=1
frm_calc='rowTBCITTA.CAB
len=6
name='xCodCab
obj='Var
pag=30
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6732
fatherSonIndex=2
frm_calc='rowTBCITTA.CAB
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
frm_calc='rowTBCITTA.PROV
len=2
name='xPrv
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=30
prev=O6743
I
obj='Var
pag=30
prev=O6742
var_op='asgn
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=30
prev=O6417
var_op='asgn
I
obj='Var
pag=30
prev=O6416
var_op='asgn
I
obj='Var
pag=30
prev=O6415
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O6412
var_op='asgn
I
obj='If
pag=30
prev=O6411
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6412
fatherSonIndex=0
frm_calc='iif(LRTrim(Substr(riga,458,1))='1',1,0)
len=1
name='xCFE
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6412
fatherSonIndex=1
frm_calc='iif(LRTrim(Substr(riga,458,1))='S',1,0)
len=1
name='xCFE
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=30
prev=O6410
var_op='asgn
I
obj='Var
pag=30
prev=O6409
var_op='asgn
I
obj='Read
pag=30
prev=O6408
rd_field=[
'FLGVALIDO
'FLGANAVAL
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'cCli1
]
rd_var=[
'_flgvali
'_flganag
]
I
obj='Var
pag=30
prev=O6407
var_op='asgn
I
obj='Var
pag=30
prev=O6406
var_op='asgn
I
obj='Read
pag=30
prev=O6404
rd_field=[
'CONNES
'CFESTERO
'CODFISC
'COGNOME
'NOME
'RAGSOC
'NASCOMUN
'NASSTATO
'DATANASC
'TIPINTER
'SESSO
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'cCli1
]
rd_var=[
'xConnes
'_oldest
'_oldcf
'_oldcog
'_oldnom
'_oldrgs
'_oldncm
'_oldnst
'_oldndt
'_oldnpv
'_oldnsx
]
I
obj='Begin
pag=30
prev=O6403
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6404
fatherSonIndex=0
frm_calc='0
len=1
name='_oldest
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_oldcf
next=Icpitembatch.CPVarDecl
frm_calc='''
len=26
name='_oldcog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=26
name='_oldnom
next=Icpitembatch.CPVarDecl
frm_calc='''
len=70
name='_oldrgs
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_oldncm
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_oldnst
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_oldndt
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_oldnpv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_oldnsx
obj='Var
pag=30
prev=O6773
var_op='asgn
I
obj='Var
pag=30
prev=O6772
var_op='asgn
I
obj='Var
obj_type='D
pag=30
prev=O6771
var_op='asgn
I
obj='Var
pag=30
prev=O6770
var_op='asgn
I
obj='Var
pag=30
prev=O6769
var_op='asgn
I
obj='Var
pag=30
prev=O6768
var_op='asgn
I
obj='Var
pag=30
prev=O6767
var_op='asgn
I
obj='Var
pag=30
prev=O6766
var_op='asgn
I
obj='Var
pag=30
prev=O6765
var_op='asgn
I
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=30
prev=O6402
I
obj='Var
pag=30
prev=O6401
var_op='asgn
I
obj='Var
pag=30
prev=O6400
var_op='asgn
I
obj='Var
pag=30
prev=O6399
var_op='asgn
I
obj='Var
pag=30
prev=O6398
var_op='asgn
I
obj='Var
pag=30
prev=O6397
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O6396
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O6395
var_op='asgn
I
obj='Var
pag=30
prev=O6394
var_op='asgn
I
obj='Var
obj_type='D
pag=30
prev=O6393
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6392
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6391
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6390
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6389
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6388
var_op='asgn
I
obj='Var
obj_type='M
pag=30
pagelocal=True
prev=O6385
var_op='asgn
I
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6385
fatherSonIndex=0
frm_calc='Substr(riga,112,16)
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,496,16)
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(xConnes)
]
h=[
19
19
]
obj='If
pag=30
prev=O6780
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='personbo
father=O6781
fatherSonIndex=0
obj='Insert
pag=30
rd_kfield=[
'CONNES
]
rd_kvar=[
'_conadd
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=30
prev=O6779
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'_conadd
]
rd_var=[
'xConnes
]
I
obj='Var
pag=30
prev=O6778
var_op='asgn
I
obj='Var
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=30
prev=O6322
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PSTOPERS\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
rd_var=[
'nProgSto
]
I
obj='Read
pag=30
prev=O6321
rd_field=[
'autonum
]
rd_kfield=[
'tablecode
'warncode
]
rd_kvar=[
'"prog\PRGIMPOCLI\'"+LRTrim(gAzienda)+"'"
'gAzienda
]
rd_var=[
'nProgImp
]
I
obj='MemoryCursor
pag=30
prev=O6320
sel_field='*
sel_name='tbcitta
sel_type='fltb
I
obj='Var
obj_type='N
pag=30
prev=O6319
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O6318
var_op='asgn
I
obj='Var
pag=30
prev=O6317
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=30
prev=O6316
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O6315
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O6314
var_op='asgn
I
obj='Var
obj_type='N
pag=30
prev=O6313
var_op='asgn
I
obj='Var
obj_type='N
pag=30
var_op='asgn
x=8
y=16
I
Icpitembatch.CPRemark
frm_calc='Inserisce priorità sui nomi file
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=27
prev=O6805
sel_name='tmp_list_imprich
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O6806
fatherSonIndex=0
frm_calc=[
'At('archdip.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('archpers.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('archrap.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('archinf.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('archope.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('archfraz.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('opex.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('archtito.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('procdel.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('sogope.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('intest.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('stopers.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('persnew.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('rapage.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('infage.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('intage.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('opeage.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('procage.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('sogcli.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('sogben.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('sogaltro.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('saldopex.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0 or At('saldopex.xls',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('saldrapp.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0 or At('saldrapp.xls',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
'At('titosupp.txt',Lower(LRTrim(tmp_list_imprich->nomefile))) <> 0
]
h=[
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
19
]
next=Icpitembatch.CPWrite
arch='tmp_list_imprich
obj='Write
pag=27
prev=O6810
rd_kfield=[
'nomefile
]
rd_kop=[
'=
]
rd_kvar=[
'tmp_list_imprich->nomefile
]
wr_field=[
'priorita
]
wr_op=[
'=
]
wr_var=[
'_priorita
]
I
obj='Case
pag=27
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6810
fatherSonIndex=0
frm_calc='1
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6810
fatherSonIndex=1
frm_calc='2
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6810
fatherSonIndex=2
frm_calc='5
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6810
fatherSonIndex=3
frm_calc='6
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6810
fatherSonIndex=4
frm_calc='7
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6810
fatherSonIndex=5
frm_calc='8
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6810
fatherSonIndex=6
frm_calc='9
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6810
fatherSonIndex=7
frm_calc='10
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6810
fatherSonIndex=8
frm_calc='11
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6810
fatherSonIndex=9
frm_calc='12
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6810
fatherSonIndex=10
frm_calc='13
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6810
fatherSonIndex=11
frm_calc='3
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6810
fatherSonIndex=12
frm_calc='4
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6810
fatherSonIndex=13
frm_calc='14
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6810
fatherSonIndex=14
frm_calc='15
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6810
fatherSonIndex=15
frm_calc='16
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6810
fatherSonIndex=16
frm_calc='17
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6810
fatherSonIndex=17
frm_calc='18
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6810
fatherSonIndex=18
frm_calc='19
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6810
fatherSonIndex=19
frm_calc='20
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6810
fatherSonIndex=20
frm_calc='21
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6810
fatherSonIndex=21
frm_calc='22
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6810
fatherSonIndex=22
frm_calc='23
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6810
fatherSonIndex=23
frm_calc='24
len=3
name='_priorita
obj='Var
obj_type='N
pag=27
var_op='asgn
I
I
]
w=[
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Remark
pag=27
x=18
y=21
I
Icpitembatch.CPBeginEnd
comment='Definizine variabili locali
h=[
19
19
]
next=Icpitembatch.CPDropTemporaryTable
next=Icpitembatch.CPServerTemporaryTable
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=32
prev=O6874
sel_field='*
sel_name='tmp_list_imprich
sel_order='tmp_list_imprich->priorita,tmp_list_imprich->nomefile
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6875
fatherSonIndex=0
frm_calc='LRTrim(tmp_list_imprich->nomefile)
len=50
name='nomefileimport
next=Icpitembatch.CPIfElse
frm_calc=[
'At('archpers.txt',Lower(nomefileimport)) <> 0 or At('persnew.txt',Lower(nomefileimport)) <> 0 or At('stopers.txt',Lower(nomefileimport)) <> 0
]
h=[
19
19
]
obj='If
pag=32
prev=O6879
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6880
fatherSonIndex=0
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
obj='Exec
pag=32
prev=O6887
I
obj='While
pag=32
prev=O6886
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6887
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=32
prev=O6893
var_op='asgn
I
obj='If
pag=32
prev=O6892
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6893
fatherSonIndex=0
frm_calc='''
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='''
len=128
name='_testata
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_ferr
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati controllati '+LRTrim(Str(conta,10,0))+' nominativi del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='"Codice: "+ LRTrim(Substr(riga,112,16)) + " - Soggetto "+LRTrim(Upper(Substr(riga,7,70)))
len=128
name='_testata
next=Icpitembatch.CPBeginEnd
comment='Effettua Controlli
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_ferr = 1
]
h=[
19
19
]
obj='If
pag=32
prev=O6904
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6906
fatherSonIndex=0
frm_calc='1
len=1
name='_chkerr
next=Icpitembatch.CPInsert
arch='tmp_errimp
obj='Insert
pag=32
prev=O6911
rd_kfield=[
'nomearch
'numriga
'errore
'txtini
]
rd_kvar=[
'LRTrim(nomefileimport)
'conta
'_listaerr
'_testata
]
I
obj='Var
obj_type='N
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=32
prev=O6903
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6904
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Upper(Substr(riga,7,70))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,112,16))) and Substr(riga,450,1)<>'S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,262,3)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'LRTrim(Substr(riga,262,3)) = '086' or Empty(LRTrim(Substr(riga,262,3)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,166,3)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,172,3)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'At("archpers.txt",Lower(nomefileimport)) <> 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,288,1)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=32
prev=O6936
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6939
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Substr(riga,136,30)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,128,8)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,175,2)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,177,15)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,192,8)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,200,30)))
]
h=[
19
19
]
obj='If
pag=32
prev=O6956
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6959
fatherSonIndex=0
frm_calc='_listaerr + "non è presente l'autorità di rilascio del documento" + NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6964
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6953
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6956
fatherSonIndex=0
frm_calc='_listaerr + "non è presente la data rilascio del documento"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6969
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6950
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6953
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il numero documento" + NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6974
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6947
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6950
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il tipo di documento"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6979
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6944
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6947
fatherSonIndex=0
frm_calc='_listaerr + "non è presente la data di nascita"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6984
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6944
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il luogo di nascita"
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6989
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6939
fatherSonIndex=1
frm_calc=[
'not(Empty(LRTrim(Substr(riga,136,30))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,128,8))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,175,2))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,177,15))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,192,8))))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,200,30))))
]
h=[
19
19
]
obj='If
pag=32
prev=O7005
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7008
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente l'autorità di rilascio del documento" + NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7013
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O7002
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7005
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente la data rilascio del documento"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7018
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6999
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7002
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente il numero documento" + NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7023
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6996
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6999
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente il tipo di documento"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7028
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6993
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6996
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente la data di nascita"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7033
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6993
fatherSonIndex=0
frm_calc='_listaerr + "(persona non fisica) è presente il luogo di nascita"
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7038
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=32
prev=O6933
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6936
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Substr(riga,460,10))) and Empty(LRTrim(Substr(riga,288,1))) and not(Empty(LRTrim(Substr(riga,166,3))))
]
h=[
19
19
]
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7044
fatherSonIndex=0
frm_calc='''
len=1
name='_tiposot
next=Icpitembatch.CPRead
arch='tbstgru
next=Icpitembatch.CPIfElse
frm_calc=[
'_tiposot='1'
]
h=[
19
19
]
obj='If
pag=32
prev=O7050
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7051
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice ATECO"
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7056
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=32
prev=O7049
rd_field=[
'TIPOSOT
]
rd_kfield=[
'SOTGRU
]
rd_kvar=[
'Substr(riga,166,3)
]
rd_var=[
'_tiposot
]
I
obj='Var
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6936
fatherSonIndex=1
frm_calc=[
'Empty(LRTrim(Substr(riga,468,10))) and Empty(LRTrim(Substr(riga,288,1))) and not(Empty(LRTrim(Substr(riga,166,3))))
]
h=[
19
19
]
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7065
fatherSonIndex=0
frm_calc='''
len=1
name='_tiposot
next=Icpitembatch.CPRead
arch='tbstgru
next=Icpitembatch.CPIfElse
frm_calc=[
'_tiposot='1'
]
h=[
19
19
]
obj='If
pag=32
prev=O7071
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7072
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice ATECO"
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7077
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=32
prev=O7070
rd_field=[
'TIPOSOT
]
rd_kfield=[
'SOTGRU
]
rd_kvar=[
'Substr(riga,166,3)
]
rd_var=[
'_tiposot
]
I
obj='Var
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=32
prev=O6930
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6933
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice Settorizzazione sintetica"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7088
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6927
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6930
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice SAE"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7093
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6924
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O6927
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(Substr(riga,1,6))) and Empty(LRTrim(Substr(riga,230,30)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,230,30)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,260,2)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,77,35)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(Substr(riga,265,9)))
]
h=[
19
19
]
obj='If
pag=32
prev=O7107
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7110
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il cap di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7115
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O7104
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7107
fatherSonIndex=0
frm_calc='_listaerr + "non è presente l'indirizzo di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7120
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O7101
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7104
fatherSonIndex=0
frm_calc='_listaerr + "non è presente la provincia di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7125
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O7098
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7101
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il comune di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7130
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7098
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice CAB (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7135
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6921
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O6924
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice stato di residenza (OBBLIGATORIO SE IL SOGGETTO NON E' CONTROPARTE)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7141
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
prev=O6918
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6921
fatherSonIndex=0
frm_calc='_listaerr + "non è presente il codice fiscale (ASSOLUTAMENTE OBBLIGATORIO)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7146
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6918
fatherSonIndex=0
frm_calc='_listaerr + " non è presente la ragione sociale (ASSOLUTAMENTE OBBLIGATORIO)"+NL
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_ferr
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7151
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=32
pagelocal=True
prev=O6902
var_op='asgn
I
nonlocal=True
obj='Var
pag=32
prev=O6901
var_op='asgn
I
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O6900
var_op='asgn
I
obj='Var
pag=32
pagelocal=True
prev=O6899
var_op='asgn
I
obj='Var
obj_type='M
pag=32
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=32
prev=O6885
var_op='asgn
I
obj='Var
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=32
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='TempTable
pag=32
prev=O6873
sel_type='def
server_table='tmp_errimp
I
obj='DropTempTable
pag=32
prev=O6871
server_table='tmp_errimp
I
obj='Begin
pag=32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O6871
fatherSonIndex=0
len=10
name='_listaerr
next=Icpitembatch.CPVarDecl
len=128
name='_testata
next=Icpitembatch.CPVarDecl
len=1
name='_ferr
next=Icpitembatch.CPVarDecl
len=1
name='_tiposot
obj='Var
pag=32
pagelocal=True
prev=O7163
I
obj='Var
obj_type='N
pag=32
pagelocal=True
prev=O7162
I
obj='Var
pag=32
pagelocal=True
prev=O7161
I
obj='Var
obj_type='M
pag=32
pagelocal=True
I
I
]
w=[
150
150
]
x=17
y=18
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'Lower(LRTrim(nomefileimport))='saldopex.txt'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Saldi operazioni extraconto Inseriti: '+LRTrim(Str(cNumNew,10,0))  +  NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Saldi operazioni extraconto Aggiornati: '+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O7176
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O7175
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O7174
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O7171
var_op='asgn
I
obj='If
pag=33
prev=O7170
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7171
fatherSonIndex=0
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
obj='Exec
pag=33
prev=O7184
I
obj='Exec
pag=33
prev=O7183
I
obj='Exec
pag=33
prev=O7181
I
obj='While
pag=33
prev=O7180
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7181
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record dei saldi opex del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=33
prev=O7192
var_op='asgn
I
nonlocal=True
obj='Var
pag=33
prev=O7189
var_op='asgn
I
obj='If
pag=33
prev=O7188
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7189
fatherSonIndex=0
frm_calc='Substr(riga,1,16)
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Val(Substr(riga,21,17))=0 and Val(Substr(riga,38,6))=0 and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Val(Substr(riga,21,17))=0 and Val(Substr(riga,38,6)) <> 0 and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Val(Substr(riga,21,17))<>0 and Val(Substr(riga,38,6))=0 and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub = 1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=33
prev=O7213
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O7216
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=33
prev=O7221
var_op='asgn
I
obj='Write
pag=33
rd_kfield=[
'COLLEG
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,16)
'Substr(riga,17,4)
]
wr_field=[
'SALDO
'QUANTITA
'VALUTA
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Val(Substr(riga,21,17))
'Val(Substr(riga,38,6))
'iif(Empty(LRTrim(Substr(riga,44,3))),'242',Substr(riga,44,3))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7216
fatherSonIndex=1
frm_calc='1
len=1
name='_soxerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(shand,riga+" - "+_descerr)
obj='Exec
pag=33
prev=O7230
I
obj='Var
obj_type='N
pag=33
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=33
prev=O7210
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7213
fatherSonIndex=0
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPRead
arch='opextrbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
]
obj='If
pag=33
prev=O7236
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7237
fatherSonIndex=0
frm_calc='"Assente operazione extraconto per l'anno indicato"
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O7242
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=33
prev=O7235
rd_field=[
'IDBASE
]
rd_kfield=[
'COLLEG
'ANNO
]
rd_kvar=[
'cCli1
'Substr(riga,17,4)
]
rd_var=[
'xIDB
]
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=33
prev=O7207
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7210
fatherSonIndex=0
frm_calc=''Numero Operazioni non valorizzato'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O7252
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=33
prev=O7204
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7207
fatherSonIndex=0
frm_calc=''Saldo non valorizzato'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O7257
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=33
prev=O7201
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7204
fatherSonIndex=0
frm_calc=''Saldo e Numero operazioni entrambi non valorizzati'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O7262
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=33
prev=O7200
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7201
fatherSonIndex=0
frm_calc=''Anagrafica soggetto non presente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=33
prev=O7267
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=33
prev=O7199
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,1,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=33
prev=O7198
var_op='asgn
I
obj='Var
pag=33
prev=O7197
var_op='asgn
I
obj='Var
obj_type='N
pag=33
prev=O7196
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=33
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Apro il foglio e verifico quante pagine ha
father=O7171
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='_i = 0
next=Icpitembatch.CPWhile
frm_calc='_i < _conta
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='workbook.close()
obj='Exec
pag=33
prev=O7280
I
obj='While
pag=33
prev=O7279
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O7280
fatherSonIndex=0
frm_calc='_righe = 0;﷯Sheet sheet = workbook.getSheet(_i);﷯_righe = sheet.getRows();﷯_y = 1;
next=Icpitembatch.CPWhile
frm_calc='_y < _righe
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=33
prev=O7286
I
obj='While
pag=33
prev=O7285
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Legge le colonne e scrive i dati nelle variabili appoggio
father=O7286
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column06)))
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_y++;
obj='Exec
pag=33
prev=O7293
I
obj='If
pag=33
prev=O7291
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O7293
fatherSonIndex=0
frm_calc=''Elaborazione Foglio N.'+LRTrim(Str(_i+1,2,0))+' - Riga N. '+LRTrim(Str(_y+1,7,0))+' - Rapporto N. : '+LRTrim(column01)
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPRead
arch='opextrbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record dei saldi opex del file '+nomefileimport
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=33
prev=O7302
var_op='asgn
I
obj='If
pag=33
prev=O7301
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O7302
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGOPEX\'"+LRTrim(gAzienda)+"'",0,10)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='opextrbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=33
prev=O7310
var_op='asgn
I
obj='Insert
pag=33
prev=O7309
rd_kfield=[
'COLLEG
'ANNO
'IDBASE
'SALDO
'QUANTITA
'VALUTA
'PROGOPEX
]
rd_kvar=[
'Left(LRTrim(column01),16)
'Left(LRTrim(column02),4)
'xIDB
'Val(LRTrim(column03))
'Val(LRTrim(column04))
'iif(Empty(LRTrim(column05)),'242',Left(LRTrim(column05),3))
'nProgImp
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7310
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,1,16)+" per l'operazione extraconto in data: "+Substr(riga,21,8)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=33
prev=O7319
I
obj='Var
obj_type='N
pag=33
prev=O7318
var_op='asgn
I
obj='Exec
pag=33
prev=O7317
I
nonlocal=True
obj='Var
obj_type='M
pag=33
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=33
prev=O7308
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O7302
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=33
prev=O7323
var_op='asgn
I
obj='Write
pag=33
rd_kfield=[
'COLLEG
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(LRTrim(column01),16)
'Left(LRTrim(column02),4)
]
wr_field=[
'SALDO
'QUANTITA
'VALUTA
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Val(LRTrim(column03))
'Val(LRTrim(column04))
'iif(Empty(LRTrim(column05)),'242',Left(LRTrim(column05),3))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=33
prev=O7300
rd_field=[
'IDBASE
]
rd_kfield=[
'COLLEG
'ANNO
]
rd_kvar=[
'Left(LRTrim(column01),16)
'Left(LRTrim(column02),4)
]
rd_var=[
'xIDB
]
I
obj='Var
pag=33
prev=O7299
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=33
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O7291
fatherSonIndex=0
frm_calc='// Legge il contenuto delle celle﷯Cell a01 = sheet.getCell(0,_y);﷯Cell a02 = sheet.getCell(1,_y);﷯Cell a03 = sheet.getCell(2,_y);﷯Cell a04 = sheet.getCell(3,_y);﷯Cell a05 = sheet.getCell(4,_y);﷯Cell a06 = sheet.getCell(5,_y);
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
obj='Begin
pag=33
prev=O7339
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7340
fatherSonIndex=0
frm_calc='a01.getContents()
len=25
name='column01
next=Icpitembatch.CPVarDecl
frm_calc='a02.getContents()
len=25
name='column02
next=Icpitembatch.CPVarDecl
frm_calc='a03.getContents()
len=25
name='column03
next=Icpitembatch.CPVarDecl
frm_calc='a04.getContents()
len=25
name='column04
next=Icpitembatch.CPVarDecl
frm_calc='a05.getContents()
len=25
name='column05
next=Icpitembatch.CPVarDecl
frm_calc='a06.getContents()
len=25
name='column06
obj='Var
pag=33
prev=O7348
var_op='asgn
I
obj='Var
pag=33
prev=O7347
var_op='asgn
I
obj='Var
pag=33
prev=O7346
var_op='asgn
I
obj='Var
pag=33
prev=O7345
var_op='asgn
I
obj='Var
pag=33
prev=O7344
var_op='asgn
I
obj='Var
pag=33
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Exec
pag=33
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=33
I
I
]
w=[
150
150
]
I
obj='Exec
pag=33
prev=O7277
I
obj='Begin
pag=33
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O7277
fatherSonIndex=0
frm_calc='//base﷯Workbook workbook = Workbook.getWorkbook(new File(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(gAzienda)+"/"+CPLib.LRTrim(nomefileimport)));﷯_conta = workbook.getNumberOfSheets();
obj='Exec
pag=33
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=33
prev=O7169
var_op='asgn
I
obj='Var
obj_type='N
pag=33
prev=O7168
var_op='asgn
I
obj='Var
obj_type='N
pag=33
prev=O7167
var_op='asgn
I
obj='Var
obj_type='N
pag=33
prev=O7166
var_op='asgn
I
obj='Remark
pag=33
x=12
y=20
I
Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOCLI\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
obj='Var
obj_type='N
pag=30
var_op='asgn
x=1165
y=1413
I
Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
obj='Var
pag=30
pagelocal=True
var_op='asgn
x=1188
y=2847
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
len=2
name='_tipoag
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'Lower(LRTrim(nomefileimport))='saldrapp.txt'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Saldi Rapporti Creati: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Saldi Rapporti Aggiornati: '+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O7371
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O7370
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O7369
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O7366
var_op='asgn
I
obj='If
pag=34
prev=O7365
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7366
fatherSonIndex=0
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
obj='Exec
pag=34
prev=O7379
I
obj='Exec
pag=34
prev=O7378
I
obj='Exec
pag=34
prev=O7376
I
obj='While
pag=34
prev=O7375
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7376
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,1,25)
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_tipoag
next=Icpitembatch.CPRead
arch='aetesta
next=Icpitembatch.CPRead
arch='aeannora
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPWrite
arch='aetesta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record dei saldi rapporti del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
obj='Var
obj_type='N
pag=34
prev=O7393
var_op='asgn
I
nonlocal=True
obj='Var
pag=34
prev=O7392
var_op='asgn
I
obj='Write
pag=34
prev=O7389
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'VALUTA
'CAB
]
wr_op=[
'=
'=
]
wr_var=[
'iif(Empty(LRTrim(Substr(riga,104,3))),'242',Substr(riga,104,3))
'Substr(riga,107,5)
]
I
obj='If
pag=34
prev=O7388
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O7389
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGSAR\'"+LRTrim(gAzienda)+"'",0,10)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aeannora
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=34
prev=O7405
var_op='asgn
I
obj='Insert
pag=34
prev=O7404
rd_kfield=[
'RAPPORTO
'ANNO
'IDBASE
'IMPORTO1
'IMPORTO2
'IMPORTO3
'IMPORTO4
'IMPORTO5
'TIPRAP
]
rd_kvar=[
'xRapporto
'Substr(riga,26,4)
'xIDB
'Val(Substr(riga,30,17))
'Val(Substr(riga,47,17))
'Val(Substr(riga,64,17))
'Val(Substr(riga,81,17))
'Val(Substr(riga,98,6))
'_tipoag
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7405
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,1,16)+" per il rapporto in data: "+Substr(riga,21,8)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=34
prev=O7414
I
obj='Var
obj_type='N
pag=34
prev=O7413
var_op='asgn
I
obj='Exec
pag=34
prev=O7412
I
nonlocal=True
obj='Var
obj_type='M
pag=34
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=34
prev=O7403
var_op='asgn
I
obj='Var
pag=34
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aeannora
father=O7389
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=34
prev=O7418
var_op='asgn
I
obj='Write
pag=34
rd_kfield=[
'RAPPORTO
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,25)
'Substr(riga,26,4)
]
wr_field=[
'IMPORTO1
'IMPORTO2
'IMPORTO3
'IMPORTO4
'IMPORTO5
'TIPRAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Val(Substr(riga,30,17))
'Val(Substr(riga,47,17))
'Val(Substr(riga,64,17))
'Val(Substr(riga,81,17))
'Val(Substr(riga,98,6))
'_tipoag
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=34
prev=O7387
rd_field=[
'IDBASE
]
rd_kfield=[
'RAPPORTO
'ANNO
]
rd_kvar=[
'xRapporto
'Substr(riga,26,4)
]
rd_var=[
'xIDB
]
I
obj='Read
pag=34
prev=O7386
rd_field=[
'TIPOAG
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'xRapporto
]
rd_var=[
'_tipoag
]
I
obj='Var
pag=34
pagelocal=True
prev=O7385
var_op='asgn
I
obj='Var
pag=34
prev=O7384
var_op='asgn
I
obj='Var
pag=34
prev=O7383
var_op='asgn
I
obj='Var
obj_type='M
pag=34
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=34
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Apro il foglio e verifico quante pagine ha
father=O7366
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='_i = 0
next=Icpitembatch.CPWhile
frm_calc='_i < _conta
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='workbook.close()
obj='Exec
pag=34
prev=O7440
I
obj='While
pag=34
prev=O7439
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O7440
fatherSonIndex=0
frm_calc='_righe = 0;﷯Sheet sheet = workbook.getSheet(_i);﷯_righe = sheet.getRows();﷯_y = 1;
next=Icpitembatch.CPWhile
frm_calc='_y < _righe
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=34
prev=O7446
I
obj='While
pag=34
prev=O7445
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Legge le colonne e scrive i dati nelle variabili appoggio
father=O7446
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column11)))
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_y++;
obj='Exec
pag=34
prev=O7453
I
obj='If
pag=34
prev=O7451
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O7453
fatherSonIndex=0
frm_calc=''Elaborazione Foglio N.'+LRTrim(Str(_i+1,2,0))+' - Riga N. '+LRTrim(Str(_y+1,7,0))+' - Rapporto N. : '+LRTrim(column01)
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='column01
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_tipoag
next=Icpitembatch.CPRead
arch='aetesta
next=Icpitembatch.CPRead
arch='aeannora
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPWrite
arch='aetesta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborati '+LRTrim(Str(conta,10,0))+' record dei saldi rapporti del file '+nomefileimport
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=34
prev=O7468
var_op='asgn
I
obj='Write
pag=34
prev=O7465
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'VALUTA
'CAB
]
wr_op=[
'=
'=
]
wr_var=[
'iif(Empty(LRTrim(column09)),'242',Left(LRTrim(column09),3))
'Left(LRTrim(column10),5)
]
I
obj='If
pag=34
prev=O7464
sons=[
Icpitembatch.CPItemSon
comment='Se il soggetto non esiste
instr=Icpitembatch.CPVarDecl
father=O7465
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PROGSAR\'"+LRTrim(gAzienda)+"'",0,10)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='aeannora
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=34
prev=O7480
var_op='asgn
I
obj='Insert
pag=34
prev=O7479
rd_kfield=[
'RAPPORTO
'ANNO
'IDBASE
'IMPORTO1
'IMPORTO2
'IMPORTO3
'IMPORTO4
'IMPORTO5
'IMPORTO6
'TIPRAP
]
rd_kvar=[
'Left(LRTrim(column01),25)
'Left(LRTrim(column02),4)
'xIDB
'Val(LRTrim(column03))
'Val(LRTrim(column04))
'Val(LRTrim(column05))
'Val(LRTrim(column06))
'Val(LRTrim(column07))
'Val(LRTrim(column08))
'_tipoag
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7480
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il soggetto con codice fiscale: "+Substr(riga,1,16)+" per il rapporto in data: "+Substr(riga,21,8)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=34
prev=O7489
I
obj='Var
obj_type='N
pag=34
prev=O7488
var_op='asgn
I
obj='Exec
pag=34
prev=O7487
I
nonlocal=True
obj='Var
obj_type='M
pag=34
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=34
prev=O7478
var_op='asgn
I
obj='Var
pag=34
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='aeannora
father=O7465
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=34
prev=O7493
var_op='asgn
I
obj='Write
pag=34
rd_kfield=[
'RAPPORTO
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(LRTrim(column01),25)
'Left(LRTrim(column02),4)
]
wr_field=[
'IMPORTO1
'IMPORTO2
'IMPORTO3
'IMPORTO4
'IMPORTO5
'IMPORTO6
'TIPRAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Val(LRTrim(column03))
'Val(LRTrim(column04))
'Val(LRTrim(column05))
'Val(LRTrim(column06))
'Val(LRTrim(column07))
'Val(LRTrim(column08))
'_tipoag
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=34
prev=O7463
rd_field=[
'IDBASE
]
rd_kfield=[
'RAPPORTO
'ANNO
]
rd_kvar=[
'Left(LRTrim(column01),25)
'Left(LRTrim(column02),4)
]
rd_var=[
'xIDB
]
I
obj='Read
pag=34
prev=O7462
rd_field=[
'TIPOAG
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'Left(LRTrim(column01),25)
]
rd_var=[
'_tipoag
]
I
obj='Var
pag=34
pagelocal=True
prev=O7461
var_op='asgn
I
obj='Var
pag=34
prev=O7460
var_op='asgn
I
obj='Var
pag=34
prev=O7459
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=34
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=34
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O7451
fatherSonIndex=0
frm_calc='// Legge il contenuto delle celle﷯Cell a01 = sheet.getCell(0,_y);﷯Cell a02 = sheet.getCell(1,_y);﷯Cell a03 = sheet.getCell(2,_y);﷯Cell a04 = sheet.getCell(3,_y);﷯Cell a05 = sheet.getCell(4,_y);﷯Cell a06 = sheet.getCell(5,_y);﷯Cell a07 = sheet.getCell(6,_y);﷯Cell a08 = sheet.getCell(7,_y);﷯Cell a09 = sheet.getCell(8,_y);﷯Cell a10 = sheet.getCell(9,_y);﷯Cell a11 = sheet.getCell(10,_y);
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
obj='Begin
pag=34
prev=O7513
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7514
fatherSonIndex=0
frm_calc='a01.getContents()
len=25
name='column01
next=Icpitembatch.CPVarDecl
frm_calc='a02.getContents()
len=25
name='column02
next=Icpitembatch.CPVarDecl
frm_calc='a03.getContents()
len=25
name='column03
next=Icpitembatch.CPVarDecl
frm_calc='a04.getContents()
len=25
name='column04
next=Icpitembatch.CPVarDecl
frm_calc='a05.getContents()
len=25
name='column05
next=Icpitembatch.CPVarDecl
frm_calc='a06.getContents()
len=25
name='column06
next=Icpitembatch.CPVarDecl
frm_calc='a07.getContents()
len=25
name='column07
next=Icpitembatch.CPVarDecl
frm_calc='a08.getContents()
len=25
name='column08
next=Icpitembatch.CPVarDecl
frm_calc='a09.getContents()
len=25
name='column09
next=Icpitembatch.CPVarDecl
frm_calc='a10.getContents()
len=25
name='column10
next=Icpitembatch.CPVarDecl
frm_calc='a11.getContents()
len=25
name='column11
obj='Var
pag=34
prev=O7527
var_op='asgn
I
obj='Var
pag=34
prev=O7526
var_op='asgn
I
obj='Var
pag=34
prev=O7525
var_op='asgn
I
obj='Var
pag=34
prev=O7524
var_op='asgn
I
obj='Var
pag=34
prev=O7523
var_op='asgn
I
obj='Var
pag=34
prev=O7522
var_op='asgn
I
obj='Var
pag=34
prev=O7521
var_op='asgn
I
obj='Var
pag=34
prev=O7520
var_op='asgn
I
obj='Var
pag=34
prev=O7519
var_op='asgn
I
obj='Var
pag=34
prev=O7518
var_op='asgn
I
obj='Var
pag=34
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Exec
pag=34
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=34
I
I
]
w=[
150
150
]
I
obj='Exec
pag=34
prev=O7437
I
obj='Begin
pag=34
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O7437
fatherSonIndex=0
frm_calc='//base﷯Workbook workbook = Workbook.getWorkbook(new File(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(gAzienda)+"/"+CPLib.LRTrim(nomefileimport)));﷯_conta = workbook.getNumberOfSheets();
obj='Exec
pag=34
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=34
prev=O7364
var_op='asgn
I
obj='Var
obj_type='N
pag=34
prev=O7363
var_op='asgn
I
obj='Var
obj_type='N
pag=34
prev=O7362
var_op='asgn
I
obj='Var
pag=34
pagelocal=True
prev=O7361
I
obj='Remark
pag=34
x=10
y=22
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Titolari Effettivi Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Titolari Effettivi Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=35
prev=O7549
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=35
prev=O7548
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=35
prev=O7547
var_op='asgn
I
obj='Exec
pag=35
prev=O7546
I
obj='Exec
pag=35
prev=O7545
I
obj='Exec
pag=35
prev=O7543
I
obj='While
pag=35
prev=O7542
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7543
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
obj='Var
pag=35
prev=O7555
var_op='asgn
I
obj='If
pag=35
prev=O7554
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7555
fatherSonIndex=0
frm_calc='''
len=2
name='_tipooprap
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=35
prev=O7561
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xapotit
father=O7562
fatherSonIndex=0
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=35
prev=O7568
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7570
fatherSonIndex=0
frm_calc=[
'_tipooprap='50'
'_tipooprap='51'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=35
prev=O7575
var_op='asgn
I
obj='If
pag=35
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xntestit
father=O7575
fatherSonIndex=0
obj='Write
pag=35
rd_kfield=[
'CODCLI
'CODINTER
'RAPPORTO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'Left(riga,25)
]
wr_field=[
'DESCINTER
'DATAINI
'NUMPROG1
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Substr(riga,66,30)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'_numprog
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xntestit
father=O7575
fatherSonIndex=1
obj='Write
pag=35
rd_kfield=[
'CODCLI
'CODINTER
'RAPPORTO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'Left(riga,25)
]
wr_field=[
'DESCINTER
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Substr(riga,66,30)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'_numprog
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7570
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'_tipooprap='50'
'_tipooprap='51'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=35
prev=O7599
var_op='asgn
I
obj='If
pag=35
prev=O7598
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xntestit
father=O7599
fatherSonIndex=0
obj='Insert
pag=35
rd_kfield=[
'CODCLI
'CODINTER
'DATAINI
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
'NUMPROG1
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'Substr(riga,66,30)
'Left(riga,25)
'nProgImp
'LibreriaMit.UniqueId()
'_numprog
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xntestit
father=O7599
fatherSonIndex=1
obj='Insert
pag=35
rd_kfield=[
'CODCLI
'CODINTER
'DATAFINE
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
'NUMPROG2
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'Substr(riga,66,30)
'Left(riga,25)
'nProgImp
'LibreriaMit.UniqueId()
'_numprog
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=35
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=35
prev=O7567
sel_field='xntestit->IDBASE
sel_name='xntestit
sel_where='xntestit->CODCLI=Substr(riga,26,16) and xntestit->CODINTER=Substr(riga,42,16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7568
fatherSonIndex=0
frm_calc='1
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=35
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=35
rd_field=[
'NUMPROG
'TIPOOPRAP
]
rd_kfield=[
'CONNESCLI
]
rd_kvar=[
'Substr(riga,26,16)
]
rd_var=[
'_numprog
'_tipooprap
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='rapotit
father=O7562
fatherSonIndex=1
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=35
prev=O7624
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7626
fatherSonIndex=0
frm_calc=[
'_tipooprap='50'
'_tipooprap='51'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=35
prev=O7631
var_op='asgn
I
obj='If
pag=35
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestit
father=O7631
fatherSonIndex=0
obj='Write
pag=35
rd_kfield=[
'CODCLI
'CODINTER
'RAPPORTO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'Left(riga,25)
]
wr_field=[
'DESCINTER
'DATAINI
'NUMPROG1
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Substr(riga,66,30)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'_numprog
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestit
father=O7631
fatherSonIndex=1
obj='Write
pag=35
rd_kfield=[
'CODCLI
'CODINTER
'RAPPORTO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'Left(riga,25)
]
wr_field=[
'DESCINTER
'DATAINI
'NUMPROG1
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Substr(riga,66,30)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'_numprog
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7626
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'_tipooprap='50'
'_tipooprap='51'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=35
prev=O7655
var_op='asgn
I
obj='If
pag=35
prev=O7654
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='intestit
father=O7655
fatherSonIndex=0
obj='Insert
pag=35
rd_kfield=[
'CODCLI
'CODINTER
'DATAINI
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
'STATOREG
'NUMPROG1
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'Substr(riga,66,30)
'Left(riga,25)
'nProgImp
'LibreriaMit.UniqueId()
''0'
'_numprog
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='intestit
father=O7655
fatherSonIndex=1
obj='Insert
pag=35
rd_kfield=[
'CODCLI
'CODINTER
'DATAFINE
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
'STATOREG
'NUMPROG2
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'Substr(riga,66,30)
'Left(riga,25)
'nProgImp
'LibreriaMit.UniqueId()
''0'
'_numprog
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=35
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=35
prev=O7623
sel_field='intestit->IDBASE
sel_name='intestit
sel_where='intestit->CODCLI=Substr(riga,26,16) and intestit->CODINTER=Substr(riga,42,16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7624
fatherSonIndex=0
frm_calc='1
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=35
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=35
rd_field=[
'NUMPROG
'TIPOOPRAP
]
rd_kfield=[
'CONNESCLI
]
rd_kvar=[
'Substr(riga,26,16)
]
rd_var=[
'_numprog
'_tipooprap
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=35
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=35
prev=O7553
var_op='asgn
I
obj='Var
obj_type='M
pag=35
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=35
prev=O7541
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=35
prev=O7540
var_op='asgn
I
obj='Var
obj_type='N
pag=35
prev=O7539
var_op='asgn
I
obj='Var
obj_type='N
pag=35
prev=O7538
var_op='asgn
I
obj='Remark
pag=35
x=13
y=21
I
Icpitembatch.CPExec
check='man
frm_calc='// Create a buffer for reading the files﷯    byte[] buf = new byte[1024];﷯    ﷯    try {﷯        // Create the ZIP file﷯        String outFilename = cNomeFileZip;﷯        java.util.zip.ZipOutputStream out = new java.util.zip.ZipOutputStream(new java.io.FileOutputStream(outFilename));﷯    ﷯        // Compress the files﷯        for (int i=0; i<filenames.size(); i++) {﷯            _file1=(String)filenames.elementAt(i);﷯            _file2=(String)fileonames.elementAt(i);﷯            java.io.FileInputStream in = new java.io.FileInputStream(_file1);﷯    ﷯            // Add ZIP entry to output stream.﷯            out.putNextEntry(new java.util.zip.ZipEntry(_file2));﷯    ﷯            // Transfer bytes from the file to the ZIP file﷯            int len;﷯            while ((len = in.read(buf)) > 0) {﷯                out.write(buf, 0, len);﷯            }﷯    ﷯            // Complete the entry﷯            out.closeEntry();﷯            in.close();﷯            FileLibMit.DeleteFile(CPLib.LRTrim(gPathApp)+"/output/"+CPLib.LRTrim(gAzienda)+"/"+CPLib.LRTrim(_file2));﷯        }﷯    ﷯        // Complete the ZIP file﷯        out.close();﷯        filenames.removeAllElements();﷯        fileonames.removeAllElements();﷯    } catch (java.io.IOException e) {﷯    }﷯
obj='Exec
pag=36
x=15
y=21
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPBeginEnd
comment='Apro il foglio e verifico quante pagine ha
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='_i = 0
next=Icpitembatch.CPWhile
frm_calc='_i < _conta
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='workbook.close()
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Modificate: '+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=37
prev=O7695
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=37
prev=O7694
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=37
prev=O7693
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=37
prev=O7692
var_op='asgn
I
obj='Exec
pag=37
prev=O7690
I
obj='While
pag=37
prev=O7689
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O7690
fatherSonIndex=0
frm_calc='_righe = 0;﷯Sheet sheet = workbook.getSheet(_i);﷯_righe = sheet.getRows();﷯_y = 1;
next=Icpitembatch.CPWhile
frm_calc='_y < _righe
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=37
prev=O7700
I
obj='While
pag=37
prev=O7699
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Legge le colonne e scrive i dati nelle variabili appoggio
father=O7700
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPExec
check='man
frm_calc='_y++;
obj='Exec
pag=37
prev=O7711
I
obj='If
pag=37
prev=O7709
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O7711
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column28)))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(column34)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc='_flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(column36)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(LRTrim(column01))))) or Empty(LRTrim(_numprog))
]
h=[
19
19
]
obj='If
pag=37
prev=O7734
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7737
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(LRTrim(column01))))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPCase
frm_calc=[
'LRTrim(column16)='S'
'LRTrim(column16)='E'
'LRTrim(column16)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Left(column15,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPVarDecl
frm_calc='iif(LRTrim(column02)='1' or LRTrim(column02)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column32)),'0',iif(LRTrim(column32)='S','1',iif(LRTrim(column32)='N','0',LRTrim(column32))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(LRTrim(column24))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column06)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_z
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='operazbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_oldidb)))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=37
prev=O7771
var_op='asgn
I
obj='If
pag=37
prev=O7769
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O7771
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='sogopebo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='clientiope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='beneficope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='terzistiope
obj='Delete
pag=37
prev=O7786
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=37
prev=O7785
sel_field='*
sel_name='terzistiope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistiope
father=O7786
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'cOpeProg1
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=37
prev=O7783
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=37
prev=O7782
sel_field='*
sel_name='beneficope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficope
father=O7783
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
]
rd_kvar=[
'cOpeProg1
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=37
prev=O7780
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=37
prev=O7779
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O7780
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=37
prev=O7777
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=37
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sogopebo
father=O7777
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7771
fatherSonIndex=1
frm_calc=[
'Empty(LRTrim(column21)) and not(Empty(LRTrim(column12)))
]
h=[
19
19
]
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O7826
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=37
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=LRTrim(column12)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7831
fatherSonIndex=0
frm_calc=[
'LRTrim(intestbo->CODINTER) <> LRTrim(column21)
]
h=[
19
19
]
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O7835
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'RAPCOL
]
rd_kvar=[
'cOpeProg1
'intestbo->CODINTER
'LibreriaMit.UniqueId()
'LRTrim(column12)
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Insert
pag=37
prev=O7767
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
]
rd_kvar=[
'LRTrim(column42)
'Val(Right(LRTrim(column01),4))
'arfn_conv_stato_uic(Left(LRTrim(column40),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'LRTrim(column62)
'_bensta
'Val(LRTrim(column23)) / 10000
'Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2)
'Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2)
'DateToChar(_datareg)
'LRTrim(column03)
'_intercab
'LRTrim(column10)
'column28
'LRTrim(column06)
'_intercod
'LRTrim(column04)
'LRTrim(column50)
'LRTrim(column33)
'LRTrim(column21)
'LRTrim(column22)
'CharToDate(Right(LRTrim(column51),4)+Substr(LRTrim(column51),3,2)+Left(LRTrim(column51),2))
'CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))
'_datareg
'_datarett
'LRTrim(column08)
'_intercit
'Left(LRTrim(column11),50)
'Val(LRTrim(column67))
'LRTrim(column43)
'cFlagCont
'cFlagFraz
'cFlagLire
'LRTrim(column13)
'_flagrap2
'cOpeProg1
'cIdCau
'"O"+Right(cOpeProg2,9)+_idb2
'column41
'LRTrim(column65)
'LRTrim(column39)
'LRTrim(column60)
'cOpeProg2
'LRTrim(column35)
'_idreg
''1'
'CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6))
'arfn_conv_stato_uic(LRTrim(column07))
'LRTrim(column64)
'nProgImp
'LRTrim(column09)
'_interprv
'LRTrim(column38)
'LRTrim(column63)
'LRTrim(column12)
'Val(LRTrim(column47))
'Val(LRTrim(column46))
'Val(LRTrim(column49))
'column36
'Val(LRTrim(column48))
'Val(LRTrim(column45))
'Val(LRTrim(column52))
'LRTrim(column61)
'LRTrim(column18)
'_statoreg
'LRTrim(column44)
''1'
'LRTrim(column05)
'LRTrim(column26)
'LRTrim(column14)
'LRTrim(column25)
'Val(LRTrim(column20))
'Val(column19)
'column34
'LRTrim(column17)
'LRTrim(column37)
'_colleg
'_idb2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7769
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))+" con importo "+Str((Val(column19))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=37
prev=O7853
I
obj='Var
obj_type='N
pag=37
prev=O7852
var_op='asgn
I
obj='Exec
pag=37
prev=O7851
I
nonlocal=True
obj='Var
obj_type='M
pag=37
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=37
prev=O7766
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=LRTrim(column12)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7767
fatherSonIndex=0
frm_calc=[
'_z=0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_z + 1
len=10
name='_z
obj='Var
obj_type='N
pag=37
prev=O7858
var_op='asgn
I
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7858
fatherSonIndex=0
frm_calc='intestbo->CODINTER
len=25
name='column21
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=37
prev=O7763
var_op='asgn
I
obj='If
pag=37
prev=O7761
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O7763
fatherSonIndex=0
obj='Read
pag=37
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'LRTrim(column06)
]
rd_var=[
'column10
'column08
'column09
'column07
'column11
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=37
prev=O7760
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O7761
fatherSonIndex=0
frm_calc='Upper(LRTrim(column53))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(LRTrim(column54))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column55))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(column56)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column57))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column58))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column59))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(LRTrim(column33)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(LRTrim(column33))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=37
prev=O7887
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7890
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(column12)))
]
h=[
19
19
]
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O7895
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=37
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=LRTrim(column12)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7900
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=37
prev=O7911
I
obj='Read
pag=37
prev=O7910
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=37
prev=O7909
var_op='asgn
I
obj='Var
pag=37
prev=O7908
var_op='asgn
I
obj='Var
pag=37
prev=O7907
var_op='asgn
I
obj='Var
pag=37
prev=O7906
var_op='asgn
I
obj='Var
pag=37
prev=O7905
var_op='asgn
I
obj='Var
pag=37
prev=O7904
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O7884
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7887
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=37
prev=O7928
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column33)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=37
prev=O7927
var_op='asgn
I
obj='Var
pag=37
prev=O7926
var_op='asgn
I
obj='Var
pag=37
prev=O7925
var_op='asgn
I
obj='Var
pag=37
prev=O7924
var_op='asgn
I
obj='Var
pag=37
prev=O7923
var_op='asgn
I
obj='Var
pag=37
prev=O7922
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O7883
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O7884
fatherSonIndex=0
obj='Read
pag=37
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=37
prev=O7882
var_op='asgn
I
obj='Var
pag=37
prev=O7881
var_op='asgn
I
obj='Var
pag=37
prev=O7880
var_op='asgn
I
obj='Var
pag=37
prev=O7879
var_op='asgn
I
obj='Var
pag=37
prev=O7878
var_op='asgn
I
obj='Var
pag=37
prev=O7877
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=37
prev=O7759
var_op='asgn
I
obj='Var
obj_type='N
pag=37
prev=O7758
var_op='asgn
I
obj='Var
obj_type='N
pag=37
prev=O7756
var_op='asgn
I
obj='Select
pag=37
par_expr=[
'Left(LRTrim(column03),4)
'Left(LRTrim(column04),2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O7755
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7756
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=37
prev=O7754
var_op='asgn
I
obj='Var
pag=37
prev=O7753
var_op='asgn
I
obj='Var
pag=37
prev=O7752
var_op='asgn
I
obj='Var
pag=37
prev=O7751
var_op='asgn
I
obj='Var
pag=37
prev=O7750
var_op='asgn
I
obj='Var
pag=37
prev=O7749
var_op='asgn
I
obj='Var
obj_type='D
pag=37
prev=O7746
var_op='asgn
I
obj='Case
pag=37
prev=O7745
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7746
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=37
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7746
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=37
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7746
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=37
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7746
fatherSonIndex=3
frm_calc='LRTrim(column16)
len=1
name='cFlagLire
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Var
pag=37
prev=O7742
var_op='asgn
I
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7742
fatherSonIndex=0
frm_calc='_numprog
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''1'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
obj='Var
obj_type='D
pag=37
prev=O7963
var_op='asgn
I
obj='Var
pag=37
prev=O7962
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7742
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("POPERAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''0'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datarett
obj='Var
obj_type='D
pag=37
prev=O7967
var_op='asgn
I
obj='Var
pag=37
prev=O7966
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O7731
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O7734
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(LRTrim(column01)))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7973
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=37
prev=O7978
sel_field='operazbo->IDBASE
sel_name='operazbo
sel_where='operazbo->NUMPROG=_numprog and (operazbo->STATOREG='0'  or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O7979
fatherSonIndex=0
frm_calc='"E' stata cancellata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=37
prev=O7983
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'operazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
]
wr_var=[
''2'
'Date()
]
I
nonlocal=True
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
father=O7973
fatherSonIndex=1
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"E' stata variata l'operazione con codice "+_numprog
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=37
prev=O7994
sel_field='operazbo->IDBASE,operazbo->NUMPROG,operazbo->DATAOPE,operazbo->FLAGRAP2
sel_name='operazbo
sel_where='operazbo->NUMPROG=_numprog and (operazbo->STATOREG='0'  or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7995
fatherSonIndex=0
frm_calc='operazbo->IDBASE
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(operazbo->FLAGRAP2) or operazbo->FLAGRAP2='S',Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(operazbo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='operazbo->IDEREG
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='operazbo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=37
prev=O8007
sel_field='*
sel_name='terzistiope
sel_where='terzistiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='merzistiope
father=O8009
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'IDREG
]
rd_kvar=[
'_oldidb
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=37
prev=O8005
sel_field='*
sel_name='beneficope
sel_where='beneficope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='meneficope
father=O8007
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
'IDREG
]
rd_kvar=[
'_oldidb
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=37
prev=O8003
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mlientiope
father=O8005
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=37
prev=O8002
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mogopebo
father=O8003
fatherSonIndex=0
obj='Insert
pag=37
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=37
prev=O8001
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'operazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
'FLAGRAP2
]
wr_op=[
'=
'=
'=
]
wr_var=[
''3'
'Date()
'_flagrap2
]
I
obj='Var
pag=37
prev=O8000
var_op='asgn
I
obj='Var
pag=37
prev=O7999
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
pag=37
prev=O7993
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O7730
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O7731
fatherSonIndex=0
frm_calc=[
'w_norifimp='N'
]
h=[
19
19
]
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O8046
fatherSonIndex=0
frm_calc=[
'Upper(column36)='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O8051
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=37
sel_field='operazbo->NUMPROG
sel_name='operazbo
sel_where='operazbo->INFORM = column41 and (operazbo->STATOREG='0' or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8056
fatherSonIndex=0
frm_calc='operazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O8051
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=37
sel_field='operazbo->NUMPROG
sel_name='operazbo
sel_where='operazbo->RIFIMP = column36 and (operazbo->STATOREG='0' or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8063
fatherSonIndex=0
frm_calc='operazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=37
prev=O7729
var_op='asgn
I
obj='Var
pag=37
prev=O7728
var_op='asgn
I
obj='Var
pag=37
prev=O7727
var_op='asgn
I
obj='Var
pag=37
prev=O7724
var_op='asgn
I
obj='If
pag=37
prev=O7723
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O7724
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=37
prev=O8074
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8075
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))+" con importo "+Str((Val(column19))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=37
prev=O8081
I
obj='Var
obj_type='N
pag=37
prev=O8080
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=37
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'column34
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=37
prev=O7722
var_op='asgn
I
obj='Remark
pag=37
prev=O7719
I
obj='If
pag=37
prev=O7717
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7719
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column29)+LRTrim(column31)+LRTrim(column30)))
]
h=[
19
19
]
obj='If
pag=37
prev=O8093
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8096
fatherSonIndex=0
frm_calc='LRTrim(column29)
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(column31)
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(column30)
len=2
name='_interprv
obj='Var
pag=37
prev=O8102
var_op='asgn
I
obj='Var
pag=37
prev=O8101
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O8092
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8093
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))+" con importo "+Str((Val(column19))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(column28)+" non è presente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=37
prev=O8108
I
obj='Var
obj_type='N
pag=37
prev=O8107
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=37
prev=O8091
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'column28
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=37
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=37
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7717
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(column27)),_codinter,column27)
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column29)),_citinter,column29)
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column31)),_cabinter,column31)
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column30)),_prvinter,column30)
len=2
name='_interprv
obj='Var
pag=37
prev=O8120
var_op='asgn
I
obj='Var
pag=37
prev=O8119
var_op='asgn
I
obj='Var
pag=37
prev=O8118
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O7711
fatherSonIndex=1
frm_calc='1
len=1
name='_opeerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(ohand,riga)
obj='Exec
pag=37
prev=O8124
I
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=37
prev=O7707
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O7709
fatherSonIndex=0
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column21)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column22))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column33))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column50))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(column21)) and Empty(LRTrim(column12)) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=37
prev=O8139
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8142
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O8136
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8139
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=37
prev=O8152
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8153
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=37
prev=O8151
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column50)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O8133
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8136
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=37
prev=O8168
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8169
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=37
prev=O8167
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column33)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O8130
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8133
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=37
prev=O8184
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8185
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=37
prev=O8183
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column22)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=37
prev=O8129
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8130
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=37
prev=O8200
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8201
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=37
prev=O8199
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column21)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=37
prev=O7705
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O7707
fatherSonIndex=0
frm_calc='a01.getContents()
len=25
name='column01
next=Icpitembatch.CPVarDecl
frm_calc='a02.getContents()
len=25
name='column02
next=Icpitembatch.CPVarDecl
frm_calc='a03.getContents()
len=25
name='column03
next=Icpitembatch.CPVarDecl
frm_calc='a04.getContents()
len=25
name='column04
next=Icpitembatch.CPVarDecl
frm_calc='a05.getContents()
len=25
name='column05
next=Icpitembatch.CPVarDecl
frm_calc='a06.getContents()
len=25
name='column06
next=Icpitembatch.CPVarDecl
frm_calc='a07.getContents()
len=25
name='column07
next=Icpitembatch.CPVarDecl
frm_calc='a08.getContents()
len=25
name='column08
next=Icpitembatch.CPVarDecl
frm_calc='a09.getContents()
len=25
name='column09
next=Icpitembatch.CPVarDecl
frm_calc='a10.getContents()
len=25
name='column10
next=Icpitembatch.CPVarDecl
frm_calc='a11.getContents()
len=25
name='column11
next=Icpitembatch.CPVarDecl
frm_calc='a12.getContents()
len=25
name='column12
next=Icpitembatch.CPVarDecl
frm_calc='a13.getContents()
len=25
name='column13
next=Icpitembatch.CPVarDecl
frm_calc='a14.getContents()
len=25
name='column14
next=Icpitembatch.CPVarDecl
frm_calc='a15.getContents()
len=25
name='column15
next=Icpitembatch.CPVarDecl
frm_calc='a16.getContents()
len=25
name='column16
next=Icpitembatch.CPVarDecl
frm_calc='a17.getContents()
len=25
name='column17
next=Icpitembatch.CPVarDecl
frm_calc='a18.getContents()
len=25
name='column18
next=Icpitembatch.CPVarDecl
frm_calc='a19.getContents()
len=25
name='column19
next=Icpitembatch.CPVarDecl
frm_calc='a20.getContents()
len=25
name='column20
next=Icpitembatch.CPVarDecl
frm_calc='a21.getContents()
len=25
name='column21
next=Icpitembatch.CPVarDecl
frm_calc='a22.getContents()
len=25
name='column22
next=Icpitembatch.CPVarDecl
frm_calc='a23.getContents()
len=25
name='column23
next=Icpitembatch.CPVarDecl
frm_calc='a24.getContents()
len=25
name='column24
next=Icpitembatch.CPVarDecl
frm_calc='a25.getContents()
len=25
name='column25
next=Icpitembatch.CPVarDecl
frm_calc='a26.getContents()
len=25
name='column26
next=Icpitembatch.CPVarDecl
frm_calc='a27.getContents()
len=25
name='column27
next=Icpitembatch.CPVarDecl
frm_calc='a28.getContents()
len=25
name='column28
next=Icpitembatch.CPVarDecl
frm_calc='a29.getContents()
len=25
name='column29
next=Icpitembatch.CPVarDecl
frm_calc='a30.getContents()
len=25
name='column30
next=Icpitembatch.CPVarDecl
frm_calc='a31.getContents()
len=25
name='column31
next=Icpitembatch.CPVarDecl
frm_calc='a32.getContents()
len=25
name='column32
next=Icpitembatch.CPVarDecl
frm_calc='a33.getContents()
len=25
name='column33
next=Icpitembatch.CPVarDecl
frm_calc='a34.getContents()
len=25
name='column34
next=Icpitembatch.CPVarDecl
frm_calc='a35.getContents()
len=25
name='column35
next=Icpitembatch.CPVarDecl
frm_calc='a36.getContents()
len=25
name='column36
next=Icpitembatch.CPVarDecl
frm_calc='a37.getContents()
len=25
name='column37
next=Icpitembatch.CPVarDecl
frm_calc='a38.getContents()
len=25
name='column38
next=Icpitembatch.CPVarDecl
frm_calc='a39.getContents()
len=25
name='column39
next=Icpitembatch.CPVarDecl
frm_calc='a40.getContents()
len=25
name='column40
next=Icpitembatch.CPVarDecl
frm_calc='a41.getContents()
len=25
name='column41
next=Icpitembatch.CPVarDecl
frm_calc='a42.getContents()
len=25
name='column42
next=Icpitembatch.CPVarDecl
frm_calc='a43.getContents()
len=25
name='column43
next=Icpitembatch.CPVarDecl
frm_calc='a44.getContents()
len=25
name='column44
next=Icpitembatch.CPVarDecl
frm_calc='a45.getContents()
len=25
name='column45
next=Icpitembatch.CPVarDecl
frm_calc='a46.getContents()
len=25
name='column46
next=Icpitembatch.CPVarDecl
frm_calc='a47.getContents()
len=25
name='column47
next=Icpitembatch.CPVarDecl
frm_calc='a48.getContents()
len=25
name='column48
next=Icpitembatch.CPVarDecl
frm_calc='a49.getContents()
len=25
name='column49
next=Icpitembatch.CPVarDecl
frm_calc='a50.getContents()
len=25
name='column50
next=Icpitembatch.CPVarDecl
frm_calc='a51.getContents()
len=25
name='column51
next=Icpitembatch.CPVarDecl
frm_calc='a52.getContents()
len=25
name='column52
next=Icpitembatch.CPVarDecl
frm_calc='a53.getContents()
len=25
name='column53
next=Icpitembatch.CPVarDecl
frm_calc='a54.getContents()
len=25
name='column54
next=Icpitembatch.CPVarDecl
frm_calc='a55.getContents()
len=25
name='column55
next=Icpitembatch.CPVarDecl
frm_calc='a56.getContents()
len=25
name='column56
next=Icpitembatch.CPVarDecl
frm_calc='a57.getContents()
len=25
name='column57
next=Icpitembatch.CPVarDecl
frm_calc='a58.getContents()
len=25
name='column58
next=Icpitembatch.CPVarDecl
frm_calc='a59.getContents()
len=25
name='column59
next=Icpitembatch.CPVarDecl
frm_calc='a60.getContents()
len=25
name='column60
next=Icpitembatch.CPVarDecl
frm_calc='a61.getContents()
len=25
name='column61
next=Icpitembatch.CPVarDecl
frm_calc='a62.getContents()
len=25
name='column62
next=Icpitembatch.CPVarDecl
frm_calc='a63.getContents()
len=25
name='column63
next=Icpitembatch.CPVarDecl
frm_calc='a64.getContents()
len=25
name='column64
next=Icpitembatch.CPVarDecl
frm_calc='a65.getContents()
len=25
name='column65
next=Icpitembatch.CPVarDecl
frm_calc='a66.getContents()
len=25
name='column66
next=Icpitembatch.CPVarDecl
frm_calc='a67.getContents()
len=25
name='column67
obj='Var
pag=37
prev=O8281
var_op='asgn
I
obj='Var
pag=37
prev=O8280
var_op='asgn
I
obj='Var
pag=37
prev=O8279
var_op='asgn
I
obj='Var
pag=37
prev=O8278
var_op='asgn
I
obj='Var
pag=37
prev=O8277
var_op='asgn
I
obj='Var
pag=37
prev=O8276
var_op='asgn
I
obj='Var
pag=37
prev=O8275
var_op='asgn
I
obj='Var
pag=37
prev=O8274
var_op='asgn
I
obj='Var
pag=37
prev=O8273
var_op='asgn
I
obj='Var
pag=37
prev=O8272
var_op='asgn
I
obj='Var
pag=37
prev=O8271
var_op='asgn
I
obj='Var
pag=37
prev=O8270
var_op='asgn
I
obj='Var
pag=37
prev=O8269
var_op='asgn
I
obj='Var
pag=37
prev=O8268
var_op='asgn
I
obj='Var
pag=37
prev=O8267
var_op='asgn
I
obj='Var
pag=37
prev=O8266
var_op='asgn
I
obj='Var
pag=37
prev=O8265
var_op='asgn
I
obj='Var
pag=37
prev=O8264
var_op='asgn
I
obj='Var
pag=37
prev=O8263
var_op='asgn
I
obj='Var
pag=37
prev=O8262
var_op='asgn
I
obj='Var
pag=37
prev=O8261
var_op='asgn
I
obj='Var
pag=37
prev=O8260
var_op='asgn
I
obj='Var
pag=37
prev=O8259
var_op='asgn
I
obj='Var
pag=37
prev=O8258
var_op='asgn
I
obj='Var
pag=37
prev=O8257
var_op='asgn
I
obj='Var
pag=37
prev=O8256
var_op='asgn
I
obj='Var
pag=37
prev=O8255
var_op='asgn
I
obj='Var
pag=37
prev=O8254
var_op='asgn
I
obj='Var
pag=37
prev=O8253
var_op='asgn
I
obj='Var
pag=37
prev=O8252
var_op='asgn
I
obj='Var
pag=37
prev=O8251
var_op='asgn
I
obj='Var
pag=37
prev=O8250
var_op='asgn
I
obj='Var
pag=37
prev=O8249
var_op='asgn
I
obj='Var
pag=37
prev=O8248
var_op='asgn
I
obj='Var
pag=37
prev=O8247
var_op='asgn
I
obj='Var
pag=37
prev=O8246
var_op='asgn
I
obj='Var
pag=37
prev=O8245
var_op='asgn
I
obj='Var
pag=37
prev=O8244
var_op='asgn
I
obj='Var
pag=37
prev=O8243
var_op='asgn
I
obj='Var
pag=37
prev=O8242
var_op='asgn
I
obj='Var
pag=37
prev=O8241
var_op='asgn
I
obj='Var
pag=37
prev=O8240
var_op='asgn
I
obj='Var
pag=37
prev=O8239
var_op='asgn
I
obj='Var
pag=37
prev=O8238
var_op='asgn
I
obj='Var
pag=37
prev=O8237
var_op='asgn
I
obj='Var
pag=37
prev=O8236
var_op='asgn
I
obj='Var
pag=37
prev=O8235
var_op='asgn
I
obj='Var
pag=37
prev=O8234
var_op='asgn
I
obj='Var
pag=37
prev=O8233
var_op='asgn
I
obj='Var
pag=37
prev=O8232
var_op='asgn
I
obj='Var
pag=37
prev=O8231
var_op='asgn
I
obj='Var
pag=37
prev=O8230
var_op='asgn
I
obj='Var
pag=37
prev=O8229
var_op='asgn
I
obj='Var
pag=37
prev=O8228
var_op='asgn
I
obj='Var
pag=37
prev=O8227
var_op='asgn
I
obj='Var
pag=37
prev=O8226
var_op='asgn
I
obj='Var
pag=37
prev=O8225
var_op='asgn
I
obj='Var
pag=37
prev=O8224
var_op='asgn
I
obj='Var
pag=37
prev=O8223
var_op='asgn
I
obj='Var
pag=37
prev=O8222
var_op='asgn
I
obj='Var
pag=37
prev=O8221
var_op='asgn
I
obj='Var
pag=37
prev=O8220
var_op='asgn
I
obj='Var
pag=37
prev=O8219
var_op='asgn
I
obj='Var
pag=37
prev=O8218
var_op='asgn
I
obj='Var
pag=37
prev=O8217
var_op='asgn
I
obj='Var
pag=37
prev=O8216
var_op='asgn
I
obj='Var
pag=37
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=37
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPExec
check='man
father=O7705
fatherSonIndex=0
frm_calc='// Legge il contenuto delle celle﷯Cell a01 = sheet.getCell(0,_y);﷯Cell a02 = sheet.getCell(1,_y);﷯Cell a03 = sheet.getCell(2,_y);﷯Cell a04 = sheet.getCell(3,_y);﷯Cell a05 = sheet.getCell(4,_y);﷯Cell a06 = sheet.getCell(5,_y);﷯Cell a07 = sheet.getCell(6,_y);﷯Cell a08 = sheet.getCell(7,_y);﷯Cell a09 = sheet.getCell(8,_y);﷯Cell a10 = sheet.getCell(9,_y);﷯Cell a11 = sheet.getCell(10,_y);﷯Cell a12 = sheet.getCell(11,_y);﷯Cell a13 = sheet.getCell(12,_y);﷯Cell a14 = sheet.getCell(13,_y);﷯Cell a15 = sheet.getCell(14,_y);﷯Cell a16 = sheet.getCell(15,_y);﷯Cell a17 = sheet.getCell(16,_y);﷯Cell a18 = sheet.getCell(17,_y);﷯Cell a19 = sheet.getCell(18,_y);﷯Cell a20 = sheet.getCell(19,_y);﷯Cell a21 = sheet.getCell(20,_y);﷯Cell a22 = sheet.getCell(21,_y);﷯Cell a23 = sheet.getCell(22,_y);﷯Cell a24 = sheet.getCell(23,_y);﷯Cell a25 = sheet.getCell(24,_y);﷯Cell a26 = sheet.getCell(25,_y);﷯Cell a27 = sheet.getCell(26,_y);﷯Cell a28 = sheet.getCell(27,_y);﷯Cell a29 = sheet.getCell(28,_y);﷯Cell a30 = sheet.getCell(29,_y);﷯Cell a31 = sheet.getCell(30,_y);﷯Cell a32 = sheet.getCell(31,_y);﷯Cell a33 = sheet.getCell(32,_y);﷯Cell a34 = sheet.getCell(33,_y);﷯Cell a35 = sheet.getCell(34,_y);﷯Cell a36 = sheet.getCell(35,_y);﷯Cell a37 = sheet.getCell(36,_y);﷯Cell a38 = sheet.getCell(37,_y);﷯Cell a39 = sheet.getCell(38,_y);﷯Cell a40 = sheet.getCell(39,_y);﷯Cell a41 = sheet.getCell(40,_y);﷯Cell a42 = sheet.getCell(41,_y);﷯Cell a43 = sheet.getCell(42,_y);﷯Cell a44 = sheet.getCell(43,_y);﷯Cell a45 = sheet.getCell(44,_y);﷯Cell a46 = sheet.getCell(45,_y);﷯Cell a47 = sheet.getCell(46,_y);﷯Cell a48 = sheet.getCell(47,_y);﷯Cell a49 = sheet.getCell(48,_y);﷯Cell a50 = sheet.getCell(49,_y);﷯Cell a51 = sheet.getCell(50,_y);﷯Cell a52 = sheet.getCell(51,_y);﷯Cell a53 = sheet.getCell(52,_y);﷯Cell a54 = sheet.getCell(53,_y);﷯Cell a55 = sheet.getCell(54,_y);﷯Cell a56 = sheet.getCell(55,_y);﷯Cell a57 = sheet.getCell(56,_y);﷯Cell a58 = sheet.getCell(57,_y);﷯Cell a59 = sheet.getCell(58,_y);﷯Cell a60 = sheet.getCell(59,_y);﷯Cell a61 = sheet.getCell(60,_y);﷯Cell a62 = sheet.getCell(61,_y);﷯Cell a63 = sheet.getCell(62,_y);﷯Cell a64 = sheet.getCell(63,_y);﷯Cell a65 = sheet.getCell(64,_y);﷯Cell a66 = sheet.getCell(65,_y);﷯Cell a67 = sheet.getCell(66,_y);
obj='Exec
pag=37
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=37
I
I
]
w=[
150
150
]
I
obj='Exec
pag=37
prev=O7687
I
obj='Begin
pag=37
prev=O7686
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O7687
fatherSonIndex=0
frm_calc='//base﷯Workbook workbook = Workbook.getWorkbook(new File(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(gAzienda)+"/"+CPLib.LRTrim(nomefileimport)));﷯_conta = workbook.getNumberOfSheets();
obj='Exec
pag=37
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=37
prev=O7685
var_op='asgn
I
obj='Var
obj_type='N
pag=37
prev=O7684
var_op='asgn
I
obj='Var
obj_type='N
pag=37
prev=O7683
var_op='asgn
I
obj='Var
pag=37
pagelocal=True
prev=O7682
I
obj='Remark
pag=37
x=13
y=29
I
Icpitembatch.CPRead
arch='tbcauana
obj='Read
pag=37
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,10,4)
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
x=463
y=3942
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPBeginEnd
comment='Apro il foglio e verifico quante pagine ha
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='_i = 0
next=Icpitembatch.CPWhile
frm_calc='_i < _conta
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='workbook.close()
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Inserite: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Modificate: '+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=38
prev=O8312
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=38
prev=O8311
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=38
prev=O8310
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=38
prev=O8309
var_op='asgn
I
obj='Exec
pag=38
prev=O8307
I
obj='While
pag=38
prev=O8306
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O8307
fatherSonIndex=0
frm_calc='_righe = 0;﷯Sheet sheet = workbook.getSheet(_i);﷯_righe = sheet.getRows();﷯_y = 1;
next=Icpitembatch.CPWhile
frm_calc='_y < _righe
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=38
prev=O8317
I
obj='While
pag=38
prev=O8316
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Legge le colonne e scrive i dati nelle variabili appoggio
father=O8317
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPExec
check='man
frm_calc='_y++;
obj='Exec
pag=38
prev=O8328
I
obj='If
pag=38
prev=O8326
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O8328
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column28)))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(column34)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPCase
frm_calc=[
'LRTrim(column16)='S'
'LRTrim(column16)='E'
'LRTrim(column16)='V'
]
h=[
19
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Left(column15,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(LRTrim(column02)='1' or LRTrim(column02)='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column32)),'0',iif(LRTrim(column32)='S','1',iif(LRTrim(column32)='N','0',LRTrim(column32))))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(LRTrim(column24))
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' operazioni del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column06)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_z
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xperazbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=38
prev=O8369
var_op='asgn
I
obj='Insert
pag=38
prev=O8367
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
]
rd_kvar=[
'LRTrim(column42)
'Val(Right(LRTrim(column01),4))
'arfn_conv_stato_uic(Left(LRTrim(column40),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'LRTrim(column62)
'_bensta
'Val(LRTrim(column23)) / 10000
'Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2)
'Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2)
'DateToChar(_datareg)
'LRTrim(column03)
'_intercab
'LRTrim(column10)
'column28
'LRTrim(column06)
'_intercod
'LRTrim(column04)
'LRTrim(column50)
'LRTrim(column33)
'LRTrim(column21)
'LRTrim(column22)
'CharToDate(Right(LRTrim(column51),4)+Substr(LRTrim(column51),3,2)+Left(LRTrim(column51),2))
'CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))
'_datareg
'_datarett
'LRTrim(column08)
'_intercit
'Left(LRTrim(column11),50)
'Val(LRTrim(column67))
'LRTrim(column43)
'cFlagCont
'cFlagFraz
'cFlagLire
'LRTrim(column13)
'_flagrap2
'cOpeProg1
'cIdCau
'"O"+Right(cOpeProg2,9)+_idb2
'column41
'LRTrim(column65)
'LRTrim(column39)
'LRTrim(column60)
'cOpeProg2
'LRTrim(column35)
'_idreg
''1'
'CharToDateTime(Substr(riga,832,4)+Substr(riga,830,2)+Substr(riga,828,2)+Substr(riga,836,6))
'arfn_conv_stato_uic(LRTrim(column07))
'LRTrim(column64)
'nProgImp
'LRTrim(column09)
'_interprv
'LRTrim(column38)
'LRTrim(column63)
'LRTrim(column12)
'Val(LRTrim(column47))
'Val(LRTrim(column46))
'Val(LRTrim(column49))
'column36
'Val(LRTrim(column48))
'Val(LRTrim(column45))
'Val(LRTrim(column52))
'LRTrim(column61)
'LRTrim(column18)
'_statoreg
'LRTrim(column44)
''1'
'LRTrim(column05)
'LRTrim(column26)
'LRTrim(column14)
'LRTrim(column25)
'Val(LRTrim(column20))
'Val(column19)
'column34
'LRTrim(column17)
'LRTrim(column37)
'_colleg
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8369
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))+" con importo "+Str((Val(column19))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=38
prev=O8378
I
obj='Var
obj_type='N
pag=38
prev=O8377
var_op='asgn
I
obj='Exec
pag=38
prev=O8376
I
nonlocal=True
obj='Var
obj_type='M
pag=38
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=38
prev=O8366
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=LRTrim(column12)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O8367
fatherSonIndex=0
frm_calc=[
'_z=0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_z + 1
len=10
name='_z
obj='Var
obj_type='N
pag=38
prev=O8383
var_op='asgn
I
obj='If
pag=38
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8383
fatherSonIndex=0
frm_calc='intestbo->CODINTER
len=25
name='column21
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=38
prev=O8363
var_op='asgn
I
obj='If
pag=38
prev=O8361
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='inter2bo
father=O8363
fatherSonIndex=0
obj='Read
pag=38
rd_field=[
'CODCAB
'DESCCIT
'PROVINCIA
'PAESE
'RAGSOC
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'LRTrim(column06)
]
rd_var=[
'column10
'column08
'column09
'column07
'column11
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=38
prev=O8360
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O8361
fatherSonIndex=0
frm_calc='Upper(LRTrim(column53))
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(LRTrim(column54))
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column55))
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(column56)
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column57))
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column58))
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(column59))
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(LRTrim(column33)))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(LRTrim(column33))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=38
prev=O8412
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O8415
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(column12)))
]
h=[
19
19
]
obj='If
pag=38
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O8420
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=38
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=LRTrim(column12)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8425
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=38
prev=O8436
I
obj='Read
pag=38
prev=O8435
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=38
prev=O8434
var_op='asgn
I
obj='Var
pag=38
prev=O8433
var_op='asgn
I
obj='Var
pag=38
prev=O8432
var_op='asgn
I
obj='Var
pag=38
prev=O8431
var_op='asgn
I
obj='Var
pag=38
prev=O8430
var_op='asgn
I
obj='Var
pag=38
prev=O8429
var_op='asgn
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O8409
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8412
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=38
prev=O8453
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column33)
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=38
prev=O8452
var_op='asgn
I
obj='Var
pag=38
prev=O8451
var_op='asgn
I
obj='Var
pag=38
prev=O8450
var_op='asgn
I
obj='Var
pag=38
prev=O8449
var_op='asgn
I
obj='Var
pag=38
prev=O8448
var_op='asgn
I
obj='Var
pag=38
prev=O8447
var_op='asgn
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O8408
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O8409
fatherSonIndex=0
obj='Read
pag=38
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=38
prev=O8407
var_op='asgn
I
obj='Var
pag=38
prev=O8406
var_op='asgn
I
obj='Var
pag=38
prev=O8405
var_op='asgn
I
obj='Var
pag=38
prev=O8404
var_op='asgn
I
obj='Var
pag=38
prev=O8403
var_op='asgn
I
obj='Var
pag=38
prev=O8402
var_op='asgn
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=38
prev=O8359
var_op='asgn
I
obj='Var
obj_type='N
pag=38
prev=O8358
var_op='asgn
I
obj='Var
obj_type='N
pag=38
prev=O8356
var_op='asgn
I
obj='Select
pag=38
par_expr=[
'Left(LRTrim(column03),4)
'Left(LRTrim(column04),2)
''%'+LRTrim(gTipInter)+'%'
]
par_name=[
'pCODCAU
'pCAUSINT
'pTipInt
]
prev=O8355
sel_name='qbe_findcausale
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8356
fatherSonIndex=0
frm_calc='qbe_findcausale->idbase
len=4
name='cIdCau
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=38
prev=O8354
var_op='asgn
I
obj='Var
pag=38
prev=O8353
var_op='asgn
I
obj='Var
pag=38
prev=O8352
var_op='asgn
I
obj='Var
pag=38
prev=O8351
var_op='asgn
I
obj='Var
pag=38
prev=O8350
var_op='asgn
I
obj='Var
obj_type='D
pag=38
prev=O8347
var_op='asgn
I
obj='Case
pag=38
prev=O8346
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8347
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=38
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8347
fatherSonIndex=1
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=38
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8347
fatherSonIndex=2
frm_calc=''4'
len=1
name='cFlagLire
obj='Var
pag=38
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8347
fatherSonIndex=3
frm_calc='LRTrim(column16)
len=1
name='cFlagLire
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
150
150
150
]
I
obj='Var
pag=38
prev=O8345
var_op='asgn
I
obj='Var
pag=38
prev=O8344
var_op='asgn
I
obj='Var
pag=38
prev=O8341
var_op='asgn
I
obj='If
pag=38
prev=O8340
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O8341
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=38
prev=O8487
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8488
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))+" con importo "+Str((Val(column19))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=38
prev=O8494
I
obj='Var
obj_type='N
pag=38
prev=O8493
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=38
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'column34
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=38
prev=O8339
var_op='asgn
I
obj='Remark
pag=38
prev=O8336
I
obj='If
pag=38
prev=O8334
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8336
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column29)+LRTrim(column31)+LRTrim(column30)))
]
h=[
19
19
]
obj='If
pag=38
prev=O8506
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8509
fatherSonIndex=0
frm_calc='LRTrim(column29)
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(column31)
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(column30)
len=2
name='_interprv
obj='Var
pag=38
prev=O8515
var_op='asgn
I
obj='Var
pag=38
prev=O8514
var_op='asgn
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O8505
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8506
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(LRTrim(column01),4)+Substr(LRTrim(column01),3,2)+Left(LRTrim(column01),2))+" con importo "+Str((Val(column19))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(column28)+" non è presente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=38
prev=O8521
I
obj='Var
obj_type='N
pag=38
prev=O8520
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=38
prev=O8504
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'column28
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=38
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=38
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8334
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(column27)),_codinter,column27)
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column29)),_citinter,column29)
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column31)),_cabinter,column31)
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(column30)),_prvinter,column30)
len=2
name='_interprv
obj='Var
pag=38
prev=O8533
var_op='asgn
I
obj='Var
pag=38
prev=O8532
var_op='asgn
I
obj='Var
pag=38
prev=O8531
var_op='asgn
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8328
fatherSonIndex=1
frm_calc='1
len=1
name='_opeerr
next=Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(ohand,riga)
obj='Exec
pag=38
prev=O8537
I
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=38
prev=O8324
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O8326
fatherSonIndex=0
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column21)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column22))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column33))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column50))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(column21)) and Empty(LRTrim(column12)) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=38
prev=O8552
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8555
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O8549
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8552
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=38
prev=O8565
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8566
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=38
prev=O8564
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column50)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O8546
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8549
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=38
prev=O8581
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8582
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=38
prev=O8580
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column33)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O8543
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8546
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=38
prev=O8597
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8598
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=38
prev=O8596
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column22)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=38
prev=O8542
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8543
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=38
prev=O8613
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8614
fatherSonIndex=0
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=38
prev=O8612
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(column21)
]
rd_var=[
'_conadd
]
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=38
prev=O8322
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O8324
fatherSonIndex=0
frm_calc='a01.getContents()
len=25
name='column01
next=Icpitembatch.CPVarDecl
frm_calc='a02.getContents()
len=25
name='column02
next=Icpitembatch.CPVarDecl
frm_calc='a03.getContents()
len=25
name='column03
next=Icpitembatch.CPVarDecl
frm_calc='a04.getContents()
len=25
name='column04
next=Icpitembatch.CPVarDecl
frm_calc='a05.getContents()
len=25
name='column05
next=Icpitembatch.CPVarDecl
frm_calc='a06.getContents()
len=25
name='column06
next=Icpitembatch.CPVarDecl
frm_calc='a07.getContents()
len=25
name='column07
next=Icpitembatch.CPVarDecl
frm_calc='a08.getContents()
len=25
name='column08
next=Icpitembatch.CPVarDecl
frm_calc='a09.getContents()
len=25
name='column09
next=Icpitembatch.CPVarDecl
frm_calc='a10.getContents()
len=25
name='column10
next=Icpitembatch.CPVarDecl
frm_calc='a11.getContents()
len=25
name='column11
next=Icpitembatch.CPVarDecl
frm_calc='a12.getContents()
len=25
name='column12
next=Icpitembatch.CPVarDecl
frm_calc='a13.getContents()
len=25
name='column13
next=Icpitembatch.CPVarDecl
frm_calc='a14.getContents()
len=25
name='column14
next=Icpitembatch.CPVarDecl
frm_calc='a15.getContents()
len=25
name='column15
next=Icpitembatch.CPVarDecl
frm_calc='a16.getContents()
len=25
name='column16
next=Icpitembatch.CPVarDecl
frm_calc='a17.getContents()
len=25
name='column17
next=Icpitembatch.CPVarDecl
frm_calc='a18.getContents()
len=25
name='column18
next=Icpitembatch.CPVarDecl
frm_calc='a19.getContents()
len=25
name='column19
next=Icpitembatch.CPVarDecl
frm_calc='a20.getContents()
len=25
name='column20
next=Icpitembatch.CPVarDecl
frm_calc='a21.getContents()
len=25
name='column21
next=Icpitembatch.CPVarDecl
frm_calc='a22.getContents()
len=25
name='column22
next=Icpitembatch.CPVarDecl
frm_calc='a23.getContents()
len=25
name='column23
next=Icpitembatch.CPVarDecl
frm_calc='a24.getContents()
len=25
name='column24
next=Icpitembatch.CPVarDecl
frm_calc='a25.getContents()
len=25
name='column25
next=Icpitembatch.CPVarDecl
frm_calc='a26.getContents()
len=25
name='column26
next=Icpitembatch.CPVarDecl
frm_calc='a27.getContents()
len=25
name='column27
next=Icpitembatch.CPVarDecl
frm_calc='a28.getContents()
len=25
name='column28
next=Icpitembatch.CPVarDecl
frm_calc='a29.getContents()
len=25
name='column29
next=Icpitembatch.CPVarDecl
frm_calc='a30.getContents()
len=25
name='column30
next=Icpitembatch.CPVarDecl
frm_calc='a31.getContents()
len=25
name='column31
next=Icpitembatch.CPVarDecl
frm_calc='a32.getContents()
len=25
name='column32
next=Icpitembatch.CPVarDecl
frm_calc='a33.getContents()
len=25
name='column33
next=Icpitembatch.CPVarDecl
frm_calc='a34.getContents()
len=25
name='column34
next=Icpitembatch.CPVarDecl
frm_calc='a35.getContents()
len=25
name='column35
next=Icpitembatch.CPVarDecl
frm_calc='a36.getContents()
len=25
name='column36
next=Icpitembatch.CPVarDecl
frm_calc='a37.getContents()
len=25
name='column37
next=Icpitembatch.CPVarDecl
frm_calc='a38.getContents()
len=25
name='column38
next=Icpitembatch.CPVarDecl
frm_calc='a39.getContents()
len=25
name='column39
next=Icpitembatch.CPVarDecl
frm_calc='a40.getContents()
len=25
name='column40
next=Icpitembatch.CPVarDecl
frm_calc='a41.getContents()
len=25
name='column41
next=Icpitembatch.CPVarDecl
frm_calc='a42.getContents()
len=25
name='column42
next=Icpitembatch.CPVarDecl
frm_calc='a43.getContents()
len=25
name='column43
next=Icpitembatch.CPVarDecl
frm_calc='a44.getContents()
len=25
name='column44
next=Icpitembatch.CPVarDecl
frm_calc='a45.getContents()
len=25
name='column45
next=Icpitembatch.CPVarDecl
frm_calc='a46.getContents()
len=25
name='column46
next=Icpitembatch.CPVarDecl
frm_calc='a47.getContents()
len=25
name='column47
next=Icpitembatch.CPVarDecl
frm_calc='a48.getContents()
len=25
name='column48
next=Icpitembatch.CPVarDecl
frm_calc='a49.getContents()
len=25
name='column49
next=Icpitembatch.CPVarDecl
frm_calc='a50.getContents()
len=25
name='column50
next=Icpitembatch.CPVarDecl
frm_calc='a51.getContents()
len=25
name='column51
next=Icpitembatch.CPVarDecl
frm_calc='a52.getContents()
len=25
name='column52
next=Icpitembatch.CPVarDecl
frm_calc='a53.getContents()
len=25
name='column53
next=Icpitembatch.CPVarDecl
frm_calc='a54.getContents()
len=25
name='column54
next=Icpitembatch.CPVarDecl
frm_calc='a55.getContents()
len=25
name='column55
next=Icpitembatch.CPVarDecl
frm_calc='a56.getContents()
len=25
name='column56
next=Icpitembatch.CPVarDecl
frm_calc='a57.getContents()
len=25
name='column57
next=Icpitembatch.CPVarDecl
frm_calc='a58.getContents()
len=25
name='column58
next=Icpitembatch.CPVarDecl
frm_calc='a59.getContents()
len=25
name='column59
next=Icpitembatch.CPVarDecl
frm_calc='a60.getContents()
len=25
name='column60
next=Icpitembatch.CPVarDecl
frm_calc='a61.getContents()
len=25
name='column61
next=Icpitembatch.CPVarDecl
frm_calc='a62.getContents()
len=25
name='column62
next=Icpitembatch.CPVarDecl
frm_calc='a63.getContents()
len=25
name='column63
next=Icpitembatch.CPVarDecl
frm_calc='a64.getContents()
len=25
name='column64
next=Icpitembatch.CPVarDecl
frm_calc='a65.getContents()
len=25
name='column65
next=Icpitembatch.CPVarDecl
frm_calc='a66.getContents()
len=25
name='column66
next=Icpitembatch.CPVarDecl
frm_calc='a67.getContents()
len=25
name='column67
obj='Var
pag=38
prev=O8694
var_op='asgn
I
obj='Var
pag=38
prev=O8693
var_op='asgn
I
obj='Var
pag=38
prev=O8692
var_op='asgn
I
obj='Var
pag=38
prev=O8691
var_op='asgn
I
obj='Var
pag=38
prev=O8690
var_op='asgn
I
obj='Var
pag=38
prev=O8689
var_op='asgn
I
obj='Var
pag=38
prev=O8688
var_op='asgn
I
obj='Var
pag=38
prev=O8687
var_op='asgn
I
obj='Var
pag=38
prev=O8686
var_op='asgn
I
obj='Var
pag=38
prev=O8685
var_op='asgn
I
obj='Var
pag=38
prev=O8684
var_op='asgn
I
obj='Var
pag=38
prev=O8683
var_op='asgn
I
obj='Var
pag=38
prev=O8682
var_op='asgn
I
obj='Var
pag=38
prev=O8681
var_op='asgn
I
obj='Var
pag=38
prev=O8680
var_op='asgn
I
obj='Var
pag=38
prev=O8679
var_op='asgn
I
obj='Var
pag=38
prev=O8678
var_op='asgn
I
obj='Var
pag=38
prev=O8677
var_op='asgn
I
obj='Var
pag=38
prev=O8676
var_op='asgn
I
obj='Var
pag=38
prev=O8675
var_op='asgn
I
obj='Var
pag=38
prev=O8674
var_op='asgn
I
obj='Var
pag=38
prev=O8673
var_op='asgn
I
obj='Var
pag=38
prev=O8672
var_op='asgn
I
obj='Var
pag=38
prev=O8671
var_op='asgn
I
obj='Var
pag=38
prev=O8670
var_op='asgn
I
obj='Var
pag=38
prev=O8669
var_op='asgn
I
obj='Var
pag=38
prev=O8668
var_op='asgn
I
obj='Var
pag=38
prev=O8667
var_op='asgn
I
obj='Var
pag=38
prev=O8666
var_op='asgn
I
obj='Var
pag=38
prev=O8665
var_op='asgn
I
obj='Var
pag=38
prev=O8664
var_op='asgn
I
obj='Var
pag=38
prev=O8663
var_op='asgn
I
obj='Var
pag=38
prev=O8662
var_op='asgn
I
obj='Var
pag=38
prev=O8661
var_op='asgn
I
obj='Var
pag=38
prev=O8660
var_op='asgn
I
obj='Var
pag=38
prev=O8659
var_op='asgn
I
obj='Var
pag=38
prev=O8658
var_op='asgn
I
obj='Var
pag=38
prev=O8657
var_op='asgn
I
obj='Var
pag=38
prev=O8656
var_op='asgn
I
obj='Var
pag=38
prev=O8655
var_op='asgn
I
obj='Var
pag=38
prev=O8654
var_op='asgn
I
obj='Var
pag=38
prev=O8653
var_op='asgn
I
obj='Var
pag=38
prev=O8652
var_op='asgn
I
obj='Var
pag=38
prev=O8651
var_op='asgn
I
obj='Var
pag=38
prev=O8650
var_op='asgn
I
obj='Var
pag=38
prev=O8649
var_op='asgn
I
obj='Var
pag=38
prev=O8648
var_op='asgn
I
obj='Var
pag=38
prev=O8647
var_op='asgn
I
obj='Var
pag=38
prev=O8646
var_op='asgn
I
obj='Var
pag=38
prev=O8645
var_op='asgn
I
obj='Var
pag=38
prev=O8644
var_op='asgn
I
obj='Var
pag=38
prev=O8643
var_op='asgn
I
obj='Var
pag=38
prev=O8642
var_op='asgn
I
obj='Var
pag=38
prev=O8641
var_op='asgn
I
obj='Var
pag=38
prev=O8640
var_op='asgn
I
obj='Var
pag=38
prev=O8639
var_op='asgn
I
obj='Var
pag=38
prev=O8638
var_op='asgn
I
obj='Var
pag=38
prev=O8637
var_op='asgn
I
obj='Var
pag=38
prev=O8636
var_op='asgn
I
obj='Var
pag=38
prev=O8635
var_op='asgn
I
obj='Var
pag=38
prev=O8634
var_op='asgn
I
obj='Var
pag=38
prev=O8633
var_op='asgn
I
obj='Var
pag=38
prev=O8632
var_op='asgn
I
obj='Var
pag=38
prev=O8631
var_op='asgn
I
obj='Var
pag=38
prev=O8630
var_op='asgn
I
obj='Var
pag=38
prev=O8629
var_op='asgn
I
obj='Var
pag=38
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=38
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPExec
check='man
father=O8322
fatherSonIndex=0
frm_calc='// Legge il contenuto delle celle﷯Cell a01 = sheet.getCell(0,_y);﷯Cell a02 = sheet.getCell(1,_y);﷯Cell a03 = sheet.getCell(2,_y);﷯Cell a04 = sheet.getCell(3,_y);﷯Cell a05 = sheet.getCell(4,_y);﷯Cell a06 = sheet.getCell(5,_y);﷯Cell a07 = sheet.getCell(6,_y);﷯Cell a08 = sheet.getCell(7,_y);﷯Cell a09 = sheet.getCell(8,_y);﷯Cell a10 = sheet.getCell(9,_y);﷯Cell a11 = sheet.getCell(10,_y);﷯Cell a12 = sheet.getCell(11,_y);﷯Cell a13 = sheet.getCell(12,_y);﷯Cell a14 = sheet.getCell(13,_y);﷯Cell a15 = sheet.getCell(14,_y);﷯Cell a16 = sheet.getCell(15,_y);﷯Cell a17 = sheet.getCell(16,_y);﷯Cell a18 = sheet.getCell(17,_y);﷯Cell a19 = sheet.getCell(18,_y);﷯Cell a20 = sheet.getCell(19,_y);﷯Cell a21 = sheet.getCell(20,_y);﷯Cell a22 = sheet.getCell(21,_y);﷯Cell a23 = sheet.getCell(22,_y);﷯Cell a24 = sheet.getCell(23,_y);﷯Cell a25 = sheet.getCell(24,_y);﷯Cell a26 = sheet.getCell(25,_y);﷯Cell a27 = sheet.getCell(26,_y);﷯Cell a28 = sheet.getCell(27,_y);﷯Cell a29 = sheet.getCell(28,_y);﷯Cell a30 = sheet.getCell(29,_y);﷯Cell a31 = sheet.getCell(30,_y);﷯Cell a32 = sheet.getCell(31,_y);﷯Cell a33 = sheet.getCell(32,_y);﷯Cell a34 = sheet.getCell(33,_y);﷯Cell a35 = sheet.getCell(34,_y);﷯Cell a36 = sheet.getCell(35,_y);﷯Cell a37 = sheet.getCell(36,_y);﷯Cell a38 = sheet.getCell(37,_y);﷯Cell a39 = sheet.getCell(38,_y);﷯Cell a40 = sheet.getCell(39,_y);﷯Cell a41 = sheet.getCell(40,_y);﷯Cell a42 = sheet.getCell(41,_y);﷯Cell a43 = sheet.getCell(42,_y);﷯Cell a44 = sheet.getCell(43,_y);﷯Cell a45 = sheet.getCell(44,_y);﷯Cell a46 = sheet.getCell(45,_y);﷯Cell a47 = sheet.getCell(46,_y);﷯Cell a48 = sheet.getCell(47,_y);﷯Cell a49 = sheet.getCell(48,_y);﷯Cell a50 = sheet.getCell(49,_y);﷯Cell a51 = sheet.getCell(50,_y);﷯Cell a52 = sheet.getCell(51,_y);﷯Cell a53 = sheet.getCell(52,_y);﷯Cell a54 = sheet.getCell(53,_y);﷯Cell a55 = sheet.getCell(54,_y);﷯Cell a56 = sheet.getCell(55,_y);﷯Cell a57 = sheet.getCell(56,_y);﷯Cell a58 = sheet.getCell(57,_y);﷯Cell a59 = sheet.getCell(58,_y);﷯Cell a60 = sheet.getCell(59,_y);﷯Cell a61 = sheet.getCell(60,_y);﷯Cell a62 = sheet.getCell(61,_y);﷯Cell a63 = sheet.getCell(62,_y);﷯Cell a64 = sheet.getCell(63,_y);﷯Cell a65 = sheet.getCell(64,_y);﷯Cell a66 = sheet.getCell(65,_y);﷯Cell a67 = sheet.getCell(66,_y);
obj='Exec
pag=38
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=38
I
I
]
w=[
150
150
]
I
obj='Exec
pag=38
prev=O8304
I
obj='Begin
pag=38
prev=O8303
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O8304
fatherSonIndex=0
frm_calc='//base﷯Workbook workbook = Workbook.getWorkbook(new File(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(gAzienda)+"/"+CPLib.LRTrim(nomefileimport)));﷯_conta = workbook.getNumberOfSheets();
obj='Exec
pag=38
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=38
prev=O8302
var_op='asgn
I
obj='Var
obj_type='N
pag=38
prev=O8301
var_op='asgn
I
obj='Var
obj_type='N
pag=38
prev=O8300
var_op='asgn
I
obj='Var
pag=38
pagelocal=True
prev=O8299
I
obj='Remark
pag=38
x=14
y=20
I
Icpitembatch.CPRead
arch='tbcauana
obj='Read
pag=38
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,10,4)
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
x=666
y=2343
I
Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + czipfile + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Inizio estrazione del file '+ czipfile
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+"/"+czipfile
len=200
name='cpercorsozip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/appo/"+LRTrim(gAzienda)+"/"
len=200
name='cdirectoryfile
next=Icpitembatch.CPExec
check='man
frm_calc='try {﷯      // Apro il file zip﷯      java.util.zip.ZipFile zf = new java.util.zip.ZipFile(cpercorsozip);﷯﷯      //Conto il numero di file all interno del file zip e creo un array di stringhe per memorizzare i nomi file﷯      conteggio=zf.size();﷯      lista=new String[conteggio];﷯      ﷯      // Enumerate each entry﷯      i=0;﷯      for (java.util.Enumeration entries = zf.entries(); entries.hasMoreElements();) {﷯          // Get the entry name﷯          lista[i] = ((java.util.zip.ZipEntry)entries.nextElement()).getName();﷯          i++;﷯      }﷯     zf.close();﷯     } catch (java.io.IOException e) {﷯     }﷯try {﷯      // Apro il file zip﷯      java.util.zip.ZipFile zf = new java.util.zip.ZipFile(cpercorsozip);﷯﷯      byte[] buffer = new byte[1024]; ﷯      java.util.Enumeration entries = zf.entries();﷯      while(entries.hasMoreElements() ) {﷯        java.util.zip.ZipEntry entry = (java.util.zip.ZipEntry)entries.nextElement();﷯        java.io.InputStream in =zf.getInputStream(entry);﷯        java.io.OutputStream out = new java.io.BufferedOutputStream(new java.io.FileOutputStream(cdirectoryfile+entry.getName()));﷯﷯        int len;﷯﷯        while((len = in.read(buffer)) >= 0){﷯          out.write(buffer, 0, len);﷯        }﷯﷯          in.close();﷯          out.close();﷯      }﷯﷯      zf.close();﷯} catch (java.io.IOException ioe) {﷯      System.err.println("Unhandled exception:");﷯      ioe.printStackTrace();﷯      return;﷯}
next=Icpitembatch.CPDelete
arch='tmp_list_imprich
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='contanome
next=Icpitembatch.CPVarDecl
frm_calc='0
len=3
name='_priorita
next=Icpitembatch.CPWhile
frm_calc='contanome<conteggio
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+czipfile)
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine estrazione del file '+ czipfile
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +czipfile + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=39
prev=O8723
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=39
prev=O8722
var_op='asgn
I
obj='Exec
pag=39
prev=O8720
I
obj='While
pag=39
prev=O8719
sons=[
Icpitembatch.CPItemSon
comment='Assegnal apriorità ad ogni file e lo inserisce in tmp_list
instr=Icpitembatch.CPExec
check='man
father=O8720
fatherSonIndex=0
frm_calc='buffernomefile=lista[contanome];
next=Icpitembatch.CPInsert
arch='tmp_list_imprich
next=Icpitembatch.CPVarDecl
frm_calc='contanome+1
len=10
name='contanome
obj='Var
obj_type='N
pag=39
prev=O8728
var_op='asgn
I
obj='Insert
pag=39
prev=O8727
rd_kfield=[
'nomefile
]
rd_kvar=[
'buffernomefile
]
I
obj='Exec
pag=39
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=39
prev=O8718
var_op='asgn
I
obj='Var
obj_type='N
pag=39
prev=O8717
var_op='asgn
I
obj='Delete
pag=39
prev=O8716
rd_kfield=[
'nomefile
]
rd_kop=[
'=
]
rd_kvar=[
'czipfile
]
I
obj='Exec
pag=39
prev=O8715
I
obj='Var
pag=39
prev=O8714
var_op='asgn
I
obj='Var
pag=39
prev=O8713
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=39
prev=O8712
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=39
var_op='asgn
x=11
y=18
I
Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=4
sel_field='*
sel_name='xntestbo
sel_order='xntestbo->CPROWNUM
sel_where='xntestbo->RAPPORTO=Substr(riga,9,25)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O8736
fatherSonIndex=0
frm_calc=[
'xntestbo->CODINTER=cCli1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='xntestbo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=4
prev=O8740
var_op='asgn
I
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8740
fatherSonIndex=0
frm_calc='xntestbo->CPROWNUM
len=10
name='cNumMod
obj='Var
obj_type='N
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
x=1155
y=2003
I
Icpitembatch.CPIfElse
frm_calc=[
'_flgmodi='S'
]
h=[
19
19
]
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O8749
fatherSonIndex=0
frm_calc=[
'LRTrim(xRiga3) <> LRTrim(xRiga4)
]
h=[
19
19
]
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8754
fatherSonIndex=0
frm_calc='xCFE
len=1
name='_newest
next=Icpitembatch.CPExec
check='page
frm_calc='31
obj='Exec
pag=30
prev=O8759
I
obj='Var
obj_type='N
pag=30
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
x=1425
y=4437
I
Icpitembatch.CPIfElse
frm_calc=[
'Empty(_conadd)
]
h=[
19
19
]
obj='If
pag=30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O8763
fatherSonIndex=0
frm_calc='System.out.println('Riga '+Str(conta+1,10,0)+" - Codice "+_conadd)
obj='Exec
pag=30
I
I
]
w=[
150
150
]
x=1194
y=550
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Titolari AGE Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Titolari AGE Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=40
prev=O8781
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=40
prev=O8780
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=40
prev=O8779
var_op='asgn
I
obj='Exec
pag=40
prev=O8778
I
obj='Exec
pag=40
prev=O8777
I
obj='Exec
pag=40
prev=O8775
I
obj='While
pag=40
prev=O8774
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8775
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=40
prev=O8785
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O8786
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(Substr(riga,159,10)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=40
prev=O8794
sons=[
Icpitembatch.CPItemSon
comment='Unicode Assente o vuoto
instr=Icpitembatch.CPVarDecl
father=O8797
fatherSonIndex=0
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPVarDecl
frm_calc='iif(_flgdataim=0,Date(),arfn_datefchar(Substr(riga,36,8)))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGJTIT1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGJTIT2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTIT\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='japotit
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='jntestit
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew+1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=40
prev=O8810
var_op='asgn
I
obj='Insert
pag=40
prev=O8809
rd_kfield=[
'CODCLI
'CODINTER
'DATAINI
'NUMPROG1
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
]
rd_kvar=[
'Substr(riga,75,16)
'Substr(riga,50,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'cInfProg1
'Substr(riga,219,30)
'Substr(riga,9,25)
'nProgImp
'LibreriaMit.UniqueId()
]
I
obj='Var
obj_type='N
pag=40
prev=O8807
var_op='asgn
I
obj='Insert
pag=40
prev=O8806
rd_kfield=[
'CDATOPE
'CDATREG
'CODCAB
'CODDIPE
'CODINTER
'CONNESCLI
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPTIT
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'UNIQUECODE
'IDBASE2
]
rd_kvar=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'DateToChar(_datareg)
'_intercab
'Substr(riga,115,6)
'_intercod
'Substr(riga,75,16)
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'_datareg
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'cInfProg1
'"T"+Right(cInfProg2,9)+_idb2
'cInfProg2
'Left(Substr(riga,44,2),1)
'nProgImp
'_interprv
'Substr(riga,9,25)
''0'
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,159,10)
'_idb2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8807
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per il legame tra soggetti in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" relativa al soggetto: "+Substr(riga,9,25)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek='Errore in import del file AGETIT.TXT
obj='Transaction
pag=40
prev=O8818
raise_on_trans_err=True
I
nonlocal=True
obj='Var
obj_type='M
pag=40
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
obj_type='N
pag=40
prev=O8805
var_op='asgn
I
obj='Var
pag=40
prev=O8804
var_op='asgn
I
obj='Var
pag=40
prev=O8803
var_op='asgn
I
obj='Var
obj_type='D
pag=40
prev=O8802
var_op='asgn
I
obj='Var
pag=40
var_op='asgn
I
I
Icpitembatch.CPItemSon
comment='Aggiornamento
instr=Icpitembatch.CPWrite
arch='japotit
father=O8797
fatherSonIndex=1
obj='Write
pag=40
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_unicode
]
wr_field=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'DATAOPE
'DATAREG
'DESCCIT
'DESCINTER
'FLAGRAP
'OPRAP
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'CONNESCLI
'DATARETT
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2)
'_intercab
'Substr(riga,115,6)
'_intercod
'CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))
'CharToDate(Right(Substr(riga,36,8),4)+Substr(Substr(riga,36,8),3,2)+Left(Substr(riga,36,8),2))
'_intercit
'Substr(riga,169,50)
'Substr(riga,34,1)
'Left(Substr(riga,44,2),1)
'_interprv
'Substr(riga,9,25)
''1'
'Substr(riga,102,2)
'Substr(riga,35,1)
'Substr(riga,44,2)
'Substr(riga,75,16)
'Date()
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=40
prev=O8793
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8794
fatherSonIndex=0
frm_calc='''
len=1
name='_tdest
next=Icpitembatch.CPRead
arch='japotit
obj='Read
pag=40
prev=O8832
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,159,10)
]
rd_var=[
'_unicode
]
I
obj='Var
pag=40
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=40
prev=O8791
var_op='asgn
I
obj='Begin
pag=40
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8791
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(Substr(riga,104,11))),_codinter,Substr(riga,104,11))
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,121,30))),_citinter,Substr(riga,121,30))
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,153,6))),_cabinter,Substr(riga,153,6))
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,151,2))),_prvinter,Substr(riga,151,2))
len=2
name='_interprv
obj='Var
pag=40
prev=O8843
var_op='asgn
I
obj='Var
pag=40
prev=O8842
var_op='asgn
I
obj='Var
pag=40
prev=O8841
var_op='asgn
I
obj='Var
pag=40
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=40
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=40
prev=O8773
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=40
prev=O8772
var_op='asgn
I
obj='Var
obj_type='N
pag=40
prev=O8771
var_op='asgn
I
obj='Var
obj_type='N
pag=40
prev=O8770
var_op='asgn
I
obj='Remark
pag=40
x=14
y=18
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Titolari Effettivi AGE Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Titolari Effettivi AGE Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=41
prev=O8859
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=41
prev=O8858
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=41
prev=O8857
var_op='asgn
I
obj='Exec
pag=41
prev=O8856
I
obj='Exec
pag=41
prev=O8855
I
obj='Exec
pag=41
prev=O8853
I
obj='While
pag=41
prev=O8852
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8853
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
obj='Var
pag=41
prev=O8865
var_op='asgn
I
obj='If
pag=41
prev=O8864
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O8865
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=41
prev=O8871
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='jntestit
father=O8873
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=41
prev=O8878
var_op='asgn
I
obj='Write
pag=41
rd_kfield=[
'CODCLI
'CODINTER
'RAPPORTO
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'Left(riga,25)
]
wr_field=[
'DESCINTER
'DATAINI
]
wr_op=[
'=
'=
]
wr_var=[
'Substr(riga,66,30)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8873
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGIMPTITO\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='jntestit
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=41
prev=O8888
var_op='asgn
I
obj='Insert
pag=41
prev=O8887
rd_kfield=[
'CODCLI
'CODINTER
'DATAINI
'DESCINTER
'RAPPORTO
'PRGIMPTITE
'IDBASE
]
rd_kvar=[
'Substr(riga,26,16)
'Substr(riga,42,16)
'CharToDate(Substr(riga,62,4)+Substr(riga,60,2)+Substr(riga,58,2))
'Substr(riga,66,30)
'Left(riga,25)
'nProgImp
'LibreriaMit.UniqueId()
]
I
obj='Var
obj_type='N
pag=41
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=41
sel_field='jntestit->IDBASE
sel_name='jntestit
sel_where='jntestit->CODCLI=Substr(riga,26,16) and jntestit->CODINTER=Substr(riga,42,16)
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8871
fatherSonIndex=0
frm_calc='1
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=41
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=41
prev=O8863
var_op='asgn
I
obj='Var
obj_type='M
pag=41
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=41
prev=O8851
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=41
prev=O8850
var_op='asgn
I
obj='Var
obj_type='N
pag=41
prev=O8849
var_op='asgn
I
obj='Var
obj_type='N
pag=41
prev=O8848
var_op='asgn
I
obj='Remark
pag=41
x=16
y=18
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Saldi SV Inseriti: '+LRTrim(Str(cNumNew,10,0)) + " - Saldi SV Aggiornati: "+LRTrim(Str(cNumMod,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=42
prev=O8910
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=42
prev=O8909
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=42
prev=O8908
var_op='asgn
I
obj='Exec
pag=42
prev=O8907
I
obj='Exec
pag=42
prev=O8906
I
obj='Exec
pag=42
prev=O8904
I
obj='While
pag=42
prev=O8903
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8904
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
obj='Var
pag=42
prev=O8916
var_op='asgn
I
obj='If
pag=42
prev=O8915
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='saldi_idp
father=O8916
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'm_nUpdatedRows=0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=42
prev=O8922
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='saldi_idp
father=O8923
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=42
prev=O8928
var_op='asgn
I
obj='Insert
pag=42
rd_kfield=[
'RAPPORTO
'ANNO
'TRIMESTRE
'IMPORTO
'IDBASE
]
rd_kvar=[
'LRTrim(Left(riga,25))
'LRTrim(Substr(riga,26,4))
'LRTrim(Substr(riga,30,1))
'Val(LRTrim(Substr(riga,31,15)))/100
'LibreriaMit.UniqueId()
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8923
fatherSonIndex=1
frm_calc='cNumMod + 1
len=10
name='cNumMod
obj='Var
obj_type='N
pag=42
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Write
pag=42
rd_kfield=[
'RAPPORTO
'ANNO
'TRIMESTRE
]
rd_kop=[
'=
'=
'=
]
rd_kvar=[
'LRTrim(Left(riga,25))
'LRTrim(Substr(riga,26,4))
'LRTrim(Substr(riga,30,1))
]
wr_field=[
'IMPORTO
]
wr_op=[
'=
]
wr_var=[
'Val(LRTrim(Substr(riga,31,15)))/100
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=42
prev=O8914
var_op='asgn
I
obj='Var
obj_type='M
pag=42
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=42
prev=O8902
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=42
prev=O8901
var_op='asgn
I
obj='Var
obj_type='N
pag=42
prev=O8900
var_op='asgn
I
obj='Var
obj_type='N
pag=42
prev=O8899
var_op='asgn
I
obj='Remark
pag=42
x=15
y=25
I
Icpitembatch.CPBeginEnd
comment='Scrive Importo
h=[
19
19
]
obj='Begin
pag=31
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8943
fatherSonIndex=0
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPIfElse
frm_calc=[
'At('archope.txt',Lower(nomefileimport)) <> 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=31
prev=O8947
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O8948
fatherSonIndex=0
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni modificate: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','OPERAZBO','Operazioni modificate: '+LRTrim(Str(cNumNew,10,0)))
obj='Exec
pag=31
prev=O8963
I
nonlocal=True
obj='Var
obj_type='M
pag=31
prev=O8962
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=31
prev=O8961
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=31
prev=O8960
var_op='asgn
I
obj='Exec
pag=31
prev=O8959
I
obj='Exec
pag=31
prev=O8957
I
obj='While
pag=31
prev=O8956
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8957
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=31
prev=O8967
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O8968
fatherSonIndex=0
frm_calc=[
'Len(LRTrim(Substr(riga,331,9))) > 0
]
h=[
19
19
]
obj='If
pag=31
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O8973
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,871,19))),0,Val(LRTrim(Substr(riga,871,19))))
len=15
name='_totout
next=Icpitembatch.CPIfElse
frm_calc=[
'Upper(Substr(riga,331,9))='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=31
prev=O8979
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O8980
fatherSonIndex=0
obj='Write
pag=31
rd_kfield=[
'RIFIMP
'INFORM
]
rd_kop=[
'=
'=
]
rd_kvar=[
''XXXXXXXXX'
'Substr(riga,424,30)
]
wr_field=[
'IMPOUT
]
wr_op=[
'=
]
wr_var=[
'_totout/100
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O8980
fatherSonIndex=1
obj='Write
pag=31
rd_kfield=[
'RIFIMP
]
rd_kop=[
'=
]
rd_kvar=[
'Substr(riga,331,9)
]
wr_field=[
'IMPOUT
]
wr_op=[
'=
]
wr_var=[
'_totout/100
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=31
prev=O8978
var_op='asgn
I
obj='Var
obj_type='N
pag=31
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=31
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=31
prev=O8955
var_op='asgn
I
obj='Var
pag=31
prev=O8954
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=31
prev=O8953
var_op='asgn
I
obj='Remark
pag=31
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O8948
fatherSonIndex=1
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Frazionate modificate: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_writelog_imp('IMPORT','FRAZIOBO','Frazionate modificate: '+LRTrim(Str(cNumNew,10,0)))
obj='Exec
pag=31
prev=O9016
I
nonlocal=True
obj='Var
obj_type='M
pag=31
prev=O9015
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=31
prev=O9014
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=31
prev=O9013
var_op='asgn
I
obj='Exec
pag=31
prev=O9012
I
obj='Exec
pag=31
prev=O9011
I
obj='Exec
pag=31
prev=O9009
I
obj='While
pag=31
prev=O9008
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9009
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(riga)))
]
h=[
19
19
]
obj='If
pag=31
prev=O9020
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O9021
fatherSonIndex=0
frm_calc=[
'Len(LRTrim(Substr(riga,331,9))) > 0
]
h=[
19
19
]
obj='If
pag=31
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9026
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(Substr(riga,871,19))),0,Val(LRTrim(Substr(riga,871,19))))
len=15
name='_totout
next=Icpitembatch.CPIfElse
frm_calc=[
'Upper(Substr(riga,331,9))='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=31
prev=O9032
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='fraziobo
father=O9033
fatherSonIndex=0
obj='Write
pag=31
rd_kfield=[
'RIFIMP
'INFORM
]
rd_kop=[
'=
'=
]
rd_kvar=[
''XXXXXXXXX'
'Substr(riga,424,30)
]
wr_field=[
'IMPOUT
]
wr_op=[
'=
]
wr_var=[
'_totout/100
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='fraziobo
father=O9033
fatherSonIndex=1
obj='Write
pag=31
rd_kfield=[
'RIFIMP
]
rd_kop=[
'=
]
rd_kvar=[
'Substr(riga,331,9)
]
wr_field=[
'IMPOUT
]
wr_op=[
'=
]
wr_var=[
'_totout/100
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=31
prev=O9031
var_op='asgn
I
obj='Var
obj_type='N
pag=31
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=31
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=31
prev=O9007
var_op='asgn
I
obj='Var
pag=31
prev=O9006
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=31
prev=O9005
var_op='asgn
I
obj='Remark
pag=31
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=31
var_op='asgn
I
I
]
w=[
150
150
]
x=20
y=17
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('appo/'+LRTrim(gAzienda)+'/'+nomefileimport)
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.FileCopy(LRTrim(gPathApp)+'/appo/'+LRTrim(gAzienda)+'/'+nomefileimport,LRTrim(gPathDoc)+"/Import/"+LRTrim(gAzienda)+"/"+DateTimeToChar(Date())+"_"+LRTrim(nomefileimport))
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('appo/'+LRTrim(gAzienda)+"/"+nomefileimport)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Rapporti Collegati Inseriti: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=43
prev=O9069
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=43
prev=O9068
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=43
prev=O9067
var_op='asgn
I
obj='Exec
pag=43
prev=O9066
I
obj='Exec
pag=43
prev=O9065
I
obj='Exec
pag=43
prev=O9063
I
obj='While
pag=43
prev=O9062
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9063
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPVarDecl
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPRead
arch='xperazbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=43
prev=O9078
var_op='asgn
I
obj='If
pag=43
prev=O9077
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O9078
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=43
prev=O9084
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='rapcoll
father=O9085
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=43
prev=O9090
var_op='asgn
I
obj='Insert
pag=43
rd_kfield=[
'IDFILEBO
'RAPPORTO
'IDBASE
]
rd_kvar=[
'_unicode
'Substr(riga,21,25)
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=43
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xapcoll
father=O9078
fatherSonIndex=1
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=43
prev=O9100
var_op='asgn
I
obj='Insert
pag=43
rd_kfield=[
'IDFILEBO
'RAPPORTO
'IDBASE
]
rd_kvar=[
'_unicode
'Substr(riga,21,25)
'LibreriaMit.UniqueId()
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=43
prev=O9076
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
obj='Var
pag=43
prev=O9075
var_op='asgn
I
obj='Var
obj_type='N
pag=43
prev=O9074
var_op='asgn
I
obj='Var
obj_type='N
pag=43
prev=O9073
var_op='asgn
I
obj='Var
obj_type='M
pag=43
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=43
prev=O9061
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=43
prev=O9060
var_op='asgn
I
obj='Var
obj_type='N
pag=43
prev=O9059
var_op='asgn
I
obj='Remark
pag=43
x=8
y=21
I
Icpitembatch.CPIfElse
frm_calc=[
'Substr(riga,48,1)='F'
'Substr(riga,48,1)='O'
]
h=[
19
19
19
]
obj='If
pag=43
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xraziobo
father=O9110
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_unicode))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=43
prev=O9115
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O9116
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_unicode)))
]
h=[
19
19
]
obj='If
pag=43
prev=O9121
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientifrz
father=O9122
fatherSonIndex=0
obj='Insert
pag=43
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'PROQUOTA
'IMPSARA
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Val(Substr(riga,75,3))
'Val(Substr(riga,78,19))/100
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=43
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xlientifrz
father=O9116
fatherSonIndex=1
obj='Insert
pag=43
rd_kfield=[
'IDFILEBO
'CODSOG
'IDBASE
'PROQUOTA
'IMPSARA
]
rd_kvar=[
'_unicode
'Substr(riga,21,16)
'LibreriaMit.UniqueId()
'Val(Substr(riga,75,3))
'Val(Substr(riga,78,19))/100
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=43
rd_field=[
'IDBASE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'Substr(riga,11,10)
]
rd_var=[
'_unicode
]
I
I
Icpitembatch.CPItemSon
I
]
w=[
150
150
150
]
x=1301
y=258
I
]
ManualBlocks={
'BO - Header
Icpmanualblocks.CPManualBlocks
code='import java.io.File; ﷯import java.lang.Double;﷯import java.util.*;﷯import jxl.*;
name='BO - Header
I
'BO - Properties
Icpmanualblocks.CPManualBlocks
code='public String[] lista;﷯public int conteggio;﷯public int i;﷯public int _i;﷯public int _y;﷯public int contanome;﷯public int _righe;﷯public int _conta;﷯// These are the files to include in the ZIP file﷯Vector filenames = new Vector();﷯Vector fileonames = new Vector();
name='BO - Properties
I
}
comment='Importa i dati (Standard)
date_creat=#2006-06-20
date_rev=#2021-11-04
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'Utilities
'FileLibMit
'LibreriaMit
]
merge=True
modcnt=982
page_result_class=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
page_result_type=[
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
]
page_uid=[
'AHVZNXKOOX
'UKNWCURIZP
'VVERNPVGUJ
'NJDAPTIXHB
'NFQSTSMLAX
'RCTYUXDSQE
'CWXSSFAJKR
'VNWRBRKHOR
'LXYVCNDGXJ
'KBUDYHROVZ
'LYNZFJMARF
'BCDDIGVWEI
'NUVUGANGKH
'BCDBVDAIGN
'YWNGYQEOIM
'ODNUMZRUDM
'UQWVLYOUPO
'XYQTYCJDVF
'WPSSXVVPRN
'LCTYRIXNIR
'QFVUWDOVQJ
'EHJFKSDXAO
'KQLYCRCEND
'VWJMLMOSBD
'CRYCRJTMVP
'WXKLUXETTU
'TQQWCTNMUY
'WFXJLTAYZL
'JUYFDWZDHT
'FPPFVQERKU
'DHMUHURINX
'WYHNUACAYF
'DUMJTRBFGI
'RECUSIAFWL
'FOQQGPLWGB
'LBCELHVYJS
'QIPRKRDCMO
'GIQREITNVH
'JBOYCPPZUI
'TEKDKQDIEN
'JDJFXRYRYA
'KJQXTVBEBH
'AZXJBTPLZE
]
pagename=[
'Page_1
'Page_2
'Page_3
'Page_4
'Page_5
'Page_6
'Page_7
'Page_8
'Page_9
'Page_10
'Page_11
'Page_12
'Page_13
'Page_14
'Page_15
'Page_16
'Page_17
'Page_18
'Page_19
'Page_20
'Page_21
'Page_22
'Page_23
'Page_24
'Page_25
'Page_26
'Page_27
'Page_28
'Page_29
'Page_30
'Page_31
'Page_32
'Page_33
'Page_34
'Page_35
'Page_36
'Page_37
'Page_38
'Page_39
'Page_40
'Page_41
'Page_42
'Page_43
]
pagenote=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
pagetitle=[
'Main
'Soggetti
'Rapporti
'Informazioni
'Operazioni
'Frazionate
'Rapporti Provvisorio
'Informazioni Provvisorio
'Operazioni Provvisorio
'Frazionate Provvisorio
'Rapporti Agenzia Entrate
'Informazioni Agenzia Entrate
'Operazioni Agenzia Entrate
'Dipendenze
'Titolari Effettivi
'Operazioni extraconto
'Procuratori/delegati su rapporto
'Soggetti operanti
'Intestatari
'Procuratori/delegati su rapporto Provvisorio
'Soggetti operanti Provvisorio
'Intestatari Provvisorio
'Procuratori/delegati su rapporto Agenzia Entrate
'Soggetti operanti Agenzia Entrate
'Intestatari Agenzia Entrate
'Altri Intestatari Operazioni
'Inserisce priorità sui nomi file
'Altri Beneficiari Operazioni
'Altri Soggetti Operanti Operazioni
'Modifiche Soggetti
'Importo Netto Operazioni
'Controllo Anagrafiche
'Saldi Operazioni Extraconto
'Saldi Rapporti Continuativi
'Altri Titolari Effettivi
'Crea il file Zip
'Operazioni Definitive XLS
'Operazioni Provvisorie XLS
'Estrai zip
'Titolari AGE
'Altri Titolari AGE
'SALDI SV
'Rapporti Collegati
]
result_type='N
runtime_filters=2
tpl_name='Function
work_file=[
'aeannora
'aeopcanc
'aeoprig
'aeopstor
'aetesta
'anadip
'anarapbo
'beneficfrz
'beneficope
'clientifrz
'clientiope
'cpwarn
'delegabo
'fiduciabo
'fraziobo
'intermbo
'intestbo
'intestit
'japopebo
'jelegabo
'jnarapbo
'jntestbo
'joginfo
'jogopebo
'jperazbo
'knarapbo
'meneficfrz
'meneficope
'merzistifrz
'merzistiope
'mlientifrz
'mlientiope
'mogopebo
'mogopefbo
'operazbo
'opextrbo
'personbo
'rapopebo
'rapotit
'soginfo
'sogopebo
'sogopefbo
'tbcauana
'tbcitta
'tbstgru
'tbvalute
'terzistifrz
'terzistiope
'titolabo
'titopers
'tmp_errimp
'tmp_list_imprich
'tmp_listafile
'wersonbo
'xapopebo
'xapotit
'xelegabo
'xeneficfrz
'xeneficope
'xerzistifrz
'xerzistiope
'xiduciabo
'xlientifrz
'xlientiope
'xnarapbo
'xntestbo
'xntestit
'xoginfo
'xogopebo
'xogopefbo
'xperazbo
'xraziobo
'inter2bo
'xersonbo
'xnadip
'xarchope
'xarchfraz
'japotit
'jntestit
'personbo_agg
'saldi_idp
'operazbo_agg
'fraziobo_agg
'rapcoll
'xapcoll
]
work_filter=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
I
*--*
*----*
