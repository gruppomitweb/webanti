* --- CodePainter Revolution Batch Vers. 5.1
￼Icpbatch.CPBatch
Items=[
Icpitembatch.CPBeginEnd
comment='Definizione variabili caller
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili Locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='variabili locali per decoprimere il file
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='variabili per il calcolo del codice fiscale
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili globali
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Legge dati intermediario per metteri su operazbo,fraziobo,rapopebo se mancanti
next=Icpitembatch.CPBeginEnd
comment='Ripulisce file appoggio
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Import Soggetti
next=Icpitembatch.CPVarDecl
frm_calc='''
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPRemark
frm_calc='Cicla sul file della lista e lancia la pagina appropriata
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_esito
next=Icpitembatch.CPVarDecl
frm_calc=''Ora Inizio Elaborazione: '+ arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_nerrori
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_nerrage
next=Icpitembatch.CPIfElse
frm_calc=[
'w_impzip=1
]
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_nerrage > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_nerrori > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Elaborazione: '+ arfn_fdatetime(DateTime()) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'(_nerrori + _nerrage) > 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O36
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O37
fatherSonIndex=0
frm_calc=''Importazione dati terminata. Premere il bottone con la lente per prelevare i file degli scarti'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O37
fatherSonIndex=1
frm_calc=''Importazione dati terminata. Non sono stati rilevati errori'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O33
var_op='asgn
I
obj='If
pag=1
prev=O30
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O33
fatherSonIndex=0
frm_calc='9
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O28
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O30
fatherSonIndex=0
frm_calc='10
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Select
pag=1
prev=O25
sel_field='*
sel_name='tmp_list_imprich
sel_order='tmp_list_imprich->priorita,tmp_list_imprich->nomefile
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O28
fatherSonIndex=0
frm_calc='LRTrim(tmp_list_imprich->nomefile)
len=50
name='nomefileimport
next=Icpitembatch.CPVarDecl
frm_calc='NullDateTime()
len=14
name='_dtimport
next=Icpitembatch.CPVarDecl
comment='Nome file con path
frm_calc='gPathApp+"/appo/"+LRTrim(nomefileimport)
len=128
name='_filename
next=Icpitembatch.CPIfElse
frm_calc=[
'At('LOCATION',Upper(nomefileimport)) <> 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPDelete
arch='tmp_list_imprich
obj='Delete
pag=1
prev=O59
rd_kfield=[
'nomefile
]
rd_kop=[
'=
]
rd_kvar=[
'tmp_list_imprich->nomefile
]
I
obj='If
pag=1
prev=O58
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O59
fatherSonIndex=0
frm_calc='6
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='mtimport
father=O59
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_dtimport)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O70
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O71
fatherSonIndex=0
frm_calc='2
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O71
fatherSonIndex=1
frm_calc='gMsgProc +"Il file "+LRTrim(nomefileimport)+" è già stato importato per il MacroAgente selezionato"+NL+"Ricreare il file e rieseguire l'import dei dati."+ NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
rd_field=[
'MTDATIMP
]
rd_kfield=[
'MTCODMAGE
'MTNOMFIL
]
rd_kvar=[
''XXXXX'
'nomefileimport
]
rd_var=[
'_dtimport
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=1
prev=O57
var_op='asgn
I
obj='Var
obj_type='T
pag=1
prev=O56
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O24
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O25
fatherSonIndex=0
frm_calc='3
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O23
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O22
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O21
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O20
var_op='asgn
I
obj='Remark
pag=1
prev=O19
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O18
var_op='asgn
I
obj='Remark
pag=1
prev=O16
I
obj='Select
pag=1
prev=O14
sel_field='*
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O16
fatherSonIndex=0
frm_calc='intermbo->CODINTER
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->DESCCIT
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->CODCAB
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->PROVINCIA
len=2
name='_interprv
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->TIPINTER
len=2
name='_intertip
obj='Var
pag=1
prev=O95
var_op='asgn
I
obj='Var
pag=1
prev=O94
var_op='asgn
I
obj='Var
pag=1
prev=O93
var_op='asgn
I
obj='Var
pag=1
prev=O92
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDropTemporaryTable
father=O14
fatherSonIndex=0
next=Icpitembatch.CPServerTemporaryTable
indexes=[
'WUNOMEFILE,WURIFEMTCN
]
next=Icpitembatch.CPDropTemporaryTable
next=Icpitembatch.CPServerTemporaryTable
obj='TempTable
pag=1
prev=O103
sel_type='def
server_table='tmp_listafile
I
obj='DropTempTable
pag=1
prev=O101
server_table='tmp_listafile
I
obj='TempTable
pag=1
prev=O100
sel_type='def
server_table='tmp_impwu
I
obj='DropTempTable
pag=1
server_table='tmp_impwu
I
I
]
w=[
150
150
]
I
obj='Remark
pag=1
prev=O11
I
obj='Begin
pag=1
prev=O9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Path Applicazione
father=O11
fatherSonIndex=0
global=True
len=80
name='gPathApp
next=Icpitembatch.CPVarDecl
comment='Azienda
global=True
len=10
name='gAzienda
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='URL Applicazione
global=True
len=80
name='gUrlApp
nonlocal=True
obj='Var
pag=1
prev=O111
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O110
I
nonlocal=True
obj='Var
pag=1
prev=O109
I
nonlocal=True
obj='Var
pag=1
prev=O108
I
nonlocal=True
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O9
fatherSonIndex=0
len=1
name='_nocf
next=Icpitembatch.CPVarDecl
comment='Codice Fiscale
len=16
name='w_CODFISC
next=Icpitembatch.CPVarDecl
comment='Data Nascita
len=8
name='w_DATANASC
next=Icpitembatch.CPVarDecl
comment='Luogo di Nascita
len=30
name='w_NASCOMUN
next=Icpitembatch.CPVarDecl
comment='Stato di nascita
len=30
name='w_NASSTATO
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
len=26
name='w_COGNOME
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
len=70
name='w_RAGSOC
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
len=25
name='w_NOME
next=Icpitembatch.CPVarDecl
comment='Sesso
len=1
name='w_SESSO
obj='Var
pag=1
prev=O123
I
obj='Var
pag=1
prev=O122
I
obj='Var
pag=1
prev=O121
I
obj='Var
pag=1
prev=O120
I
obj='Var
pag=1
prev=O119
I
obj='Var
pag=1
prev=O118
I
obj='Var
obj_type='D
pag=1
prev=O117
I
obj='Var
pag=1
prev=O116
I
obj='Var
obj_type='N
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O5
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O7
fatherSonIndex=0
len=100
name='czipfile
next=Icpitembatch.CPVarDecl
len=200
name='cpercorsozip
next=Icpitembatch.CPVarDecl
len=200
name='cdirectoryfile
next=Icpitembatch.CPVarDecl
len=100
name='buffernomefile
next=Icpitembatch.CPVarDecl
len=50
name='nomefileimport
next=Icpitembatch.CPVarDecl
len=3
name='_priorita
obj='Var
obj_type='N
pag=1
prev=O132
I
obj='Var
pag=1
prev=O131
I
obj='Var
pag=1
prev=O130
I
obj='Var
pag=1
prev=O129
I
obj='Var
pag=1
prev=O128
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5
fatherSonIndex=0
len=1
name='fhand
next=Icpitembatch.CPVarDecl
len=16
name='_codrap
next=Icpitembatch.CPVarDecl
len=50
name='_luonas
next=Icpitembatch.CPVarDecl
len=10
name='nProg
next=Icpitembatch.CPVarDecl
len=50
name='nomefileimport
next=Icpitembatch.CPVarDecl
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
len=1
name='_tdest
next=Icpitembatch.CPVarDecl
len=3
name='_pos
next=Icpitembatch.CPVarDecl
len=1
name='_npos
next=Icpitembatch.CPVarDecl
len=1
name='_tipoop
next=Icpitembatch.CPVarDecl
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
len=10
name='_uniquecode
next=Icpitembatch.CPVarDecl
len=8
name='_datope
next=Icpitembatch.CPVarDecl
len=20
name='_impstr
next=Icpitembatch.CPVarDecl
dec=2
len=15
name='_importo
next=Icpitembatch.CPVarDecl
dec=2
len=15
name='_contanti
next=Icpitembatch.CPVarDecl
len=1
name='_flgcash
next=Icpitembatch.CPVarDecl
len=3
name='_statodest
next=Icpitembatch.CPVarDecl
len=3
name='_isodest
next=Icpitembatch.CPVarDecl
len=26
name='_cognome
next=Icpitembatch.CPVarDecl
len=25
name='_nome
next=Icpitembatch.CPVarDecl
len=40
name='_citta
next=Icpitembatch.CPVarDecl
len=5
name='_cap
next=Icpitembatch.CPVarDecl
len=35
name='_via
next=Icpitembatch.CPVarDecl
len=50
name='_paese
next=Icpitembatch.CPVarDecl
len=2
name='_prov
next=Icpitembatch.CPVarDecl
len=6
name='_cab
next=Icpitembatch.CPVarDecl
len=26
name='_cognomecp
next=Icpitembatch.CPVarDecl
len=25
name='_nomecp
next=Icpitembatch.CPVarDecl
len=1
name='_pep
next=Icpitembatch.CPVarDecl
len=1
name='_sesso
next=Icpitembatch.CPVarDecl
len=30
name='_nascitta
next=Icpitembatch.CPVarDecl
len=30
name='_nasstato
next=Icpitembatch.CPVarDecl
len=3
name='_resstato
next=Icpitembatch.CPVarDecl
len=2
name='_nasprov
next=Icpitembatch.CPVarDecl
len=8
name='_nasdata
next=Icpitembatch.CPVarDecl
len=20
name='_tipodoc
next=Icpitembatch.CPVarDecl
len=20
name='_numdoc
next=Icpitembatch.CPVarDecl
len=8
name='_docril
next=Icpitembatch.CPVarDecl
len=30
name='_autril
next=Icpitembatch.CPVarDecl
len=8
name='_docsca
next=Icpitembatch.CPVarDecl
len=16
name='_codfis
next=Icpitembatch.CPVarDecl
len=16
name='_connes
next=Icpitembatch.CPVarDecl
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
len=1
name='xSesso
next=Icpitembatch.CPVarDecl
len=6
name='xCAB
next=Icpitembatch.CPVarDecl
len=6
name='xDIP
next=Icpitembatch.CPVarDecl
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
len=8
name='xData
next=Icpitembatch.CPVarDecl
len=8
name='xDatF
next=Icpitembatch.CPVarDecl
len=1
name='_flgbanca
next=Icpitembatch.CPVarDecl
comment='Contatore record nuovi
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
comment='Contatore record aggiornati
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
comment='Contatore record invariati
len=10
name='cNumInv
next=Icpitembatch.CPVarDecl
len=1
name='_esito
next=Icpitembatch.CPVarDecl
len=10
name='_idbase
next=Icpitembatch.CPVarDecl
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
len=2
name='_interprv
next=Icpitembatch.CPVarDecl
len=2
name='_doctype
next=Icpitembatch.CPVarDecl
len=4
name='_codana
next=Icpitembatch.CPVarDecl
len=2
name='_codsin
next=Icpitembatch.CPVarDecl
len=1
name='_segno
next=Icpitembatch.CPVarDecl
len=3
name='_uifdest
next=Icpitembatch.CPVarDecl
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
len=10
name='_prog
next=Icpitembatch.CPVarDecl
len=1
name='_nocf
next=Icpitembatch.CPVarDecl
len=50
name='_condoc
next=Icpitembatch.CPVarDecl
len=60
name='_idfile
next=Icpitembatch.CPVarDecl
len=5
name='_mage
next=Icpitembatch.CPVarDecl
len=20
name='_oldcodfis
next=Icpitembatch.CPVarDecl
len=16
name='_ocodfis
next=Icpitembatch.CPVarDecl
len=14
name='_dtimport
next=Icpitembatch.CPVarDecl
len=10
name='_txtope
next=Icpitembatch.CPVarDecl
len=1
name='_errore
next=Icpitembatch.CPVarDecl
len=10
name='_nerrori
next=Icpitembatch.CPVarDecl
len=10
name='eProg
next=Icpitembatch.CPVarDecl
len=3
name='_codstanas
next=Icpitembatch.CPVarDecl
len=3
name='_codstares
next=Icpitembatch.CPVarDecl
len=4
name='_siglacit
next=Icpitembatch.CPVarDecl
len=4
name='_siglasta
next=Icpitembatch.CPVarDecl
len=10
name='_codcit
next=Icpitembatch.CPVarDecl
len=100
name='_merr
next=Icpitembatch.CPVarDecl
len=5
name='_oldmac
next=Icpitembatch.CPVarDecl
len=1
name='_aggcli
next=Icpitembatch.CPVarDecl
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
len=2
name='_intertip
next=Icpitembatch.CPVarDecl
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
len=2
name='_tipope
next=Icpitembatch.CPVarDecl
len=25
name='_rapporto
next=Icpitembatch.CPVarDecl
len=100
name='_priga
next=Icpitembatch.CPVarDecl
comment='Codice Macroagente
len=5
name='w_codmage
next=Icpitembatch.CPVarDecl
len=1
name='w_xMAFLGRAP
next=Icpitembatch.CPVarDecl
len=1
name='w_xMAFLGBON
next=Icpitembatch.CPVarDecl
len=1
name='w_xMAFLGCKR
next=Icpitembatch.CPVarDecl
len=1
name='w_xMAFLGASR
next=Icpitembatch.CPVarDecl
len=6
name='w_xMADIPSTD
next=Icpitembatch.CPVarDecl
len=1
name='w_xMAFLGCHKDAT
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
len=10
name='_idb2
next=Icpitembatch.CPVarDecl
len=30
name='_citdip
next=Icpitembatch.CPVarDecl
len=6
name='_cabdip
next=Icpitembatch.CPVarDecl
len=2
name='_provdip
next=Icpitembatch.CPVarDecl
len=10
name='_id
next=Icpitembatch.CPVarDecl
comment='Nome file con path
len=128
name='_filename
next=Icpitembatch.CPVarDecl
len=6
name='_dipid
next=Icpitembatch.CPVarDecl
len=50
name='_nfile
next=Icpitembatch.CPVarDecl
len=50
name='_filen
next=Icpitembatch.CPVarDecl
len=10
name='_nerrage
next=Icpitembatch.CPVarDecl
frm_seek='mcErrateDef.MCRDef
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_seek='mcErrateDef.MCRDef
name='rowErrate
next=Icpitembatch.CPVarDecl
frm_seek='mcErrateDef.MCRDef
name='mcErrAge
next=Icpitembatch.CPVarDecl
frm_seek='mcErrateDef.MCRDef
name='mcAgeDuo
next=Icpitembatch.CPVarDecl
len=10
name='_contage
next=Icpitembatch.CPVarDecl
len=10
name='_idb
next=Icpitembatch.CPVarDecl
len=1
name='_flgvalage
next=Icpitembatch.CPVarDecl
len=4
name='_anno
obj='Var
pag=1
prev=O260
I
obj='Var
pag=1
prev=O259
I
obj='Var
pag=1
prev=O258
I
obj='Var
obj_type='N
pag=1
prev=O257
I
obj='Var
obj_type='MC
pag=1
prev=O256
I
obj='Var
obj_type='MC
pag=1
prev=O255
I
obj='Var
obj_type='R
pag=1
prev=O254
I
obj='Var
obj_type='MC
pag=1
prev=O253
I
obj='Var
obj_type='N
pag=1
prev=O252
I
obj='Var
pag=1
prev=O251
I
obj='Var
pag=1
prev=O250
I
obj='Var
pag=1
prev=O249
I
obj='Var
pag=1
prev=O248
I
obj='Var
obj_type='N
pag=1
prev=O247
I
obj='Var
pag=1
prev=O246
I
obj='Var
pag=1
prev=O245
I
obj='Var
pag=1
prev=O244
I
obj='Var
pag=1
prev=O243
I
obj='Var
pag=1
prev=O242
I
obj='Var
pag=1
prev=O241
I
obj='Var
pag=1
prev=O240
I
obj='Var
pag=1
prev=O239
I
obj='Var
pag=1
prev=O238
I
obj='Var
pag=1
prev=O237
I
obj='Var
pag=1
prev=O236
I
obj='Var
pag=1
prev=O235
I
obj='Var
pag=1
prev=O234
I
obj='Var
pag=1
prev=O233
I
obj='Var
pag=1
prev=O232
I
obj='Var
pag=1
prev=O231
I
obj='Var
pag=1
prev=O230
I
obj='Var
pag=1
prev=O229
I
obj='Var
obj_type='M
pag=1
prev=O228
I
obj='Var
pag=1
prev=O227
I
obj='Var
pag=1
prev=O226
I
obj='Var
obj_type='N
pag=1
prev=O225
I
obj='Var
pag=1
prev=O224
I
obj='Var
pag=1
prev=O223
I
obj='Var
pag=1
prev=O222
I
obj='Var
pag=1
prev=O221
I
obj='Var
pag=1
prev=O220
I
obj='Var
pag=1
prev=O219
I
obj='Var
pag=1
prev=O218
I
obj='Var
obj_type='N
pag=1
prev=O217
I
obj='Var
obj_type='N
pag=1
prev=O216
I
obj='Var
obj_type='N
pag=1
prev=O215
I
obj='Var
obj_type='M
pag=1
prev=O214
I
obj='Var
obj_type='T
pag=1
prev=O213
I
obj='Var
pag=1
prev=O212
I
obj='Var
pag=1
prev=O211
I
obj='Var
pag=1
prev=O210
I
obj='Var
pag=1
prev=O209
I
obj='Var
pag=1
prev=O208
I
obj='Var
obj_type='N
pag=1
prev=O207
I
obj='Var
pag=1
prev=O206
I
obj='Var
pag=1
prev=O205
I
obj='Var
pag=1
prev=O204
I
obj='Var
pag=1
prev=O203
I
obj='Var
pag=1
prev=O202
I
obj='Var
pag=1
prev=O201
I
obj='Var
pag=1
prev=O200
I
obj='Var
pag=1
prev=O199
I
obj='Var
pag=1
prev=O198
I
obj='Var
pag=1
prev=O197
I
obj='Var
pag=1
prev=O196
I
obj='Var
pag=1
prev=O195
I
obj='Var
obj_type='N
pag=1
prev=O194
I
obj='Var
obj_type='N
pag=1
prev=O193
I
obj='Var
obj_type='N
pag=1
prev=O192
I
obj='Var
obj_type='N
pag=1
prev=O191
I
obj='Var
pag=1
prev=O190
I
obj='Var
pag=1
prev=O189
I
obj='Var
pag=1
prev=O188
I
obj='Var
pag=1
prev=O187
I
obj='Var
pag=1
prev=O186
I
obj='Var
pag=1
prev=O185
I
obj='Var
pag=1
prev=O184
I
obj='Var
pag=1
prev=O183
I
obj='Var
pag=1
prev=O182
I
obj='Var
obj_type='N
pag=1
prev=O181
I
obj='Var
pag=1
prev=O180
I
obj='Var
pag=1
prev=O179
I
obj='Var
pag=1
prev=O178
I
obj='Var
pag=1
prev=O177
I
obj='Var
obj_type='D
pag=1
prev=O176
I
obj='Var
pag=1
prev=O175
I
obj='Var
obj_type='D
pag=1
prev=O174
I
obj='Var
pag=1
prev=O173
I
obj='Var
pag=1
prev=O172
I
obj='Var
obj_type='D
pag=1
prev=O171
I
obj='Var
pag=1
prev=O170
I
obj='Var
pag=1
prev=O169
I
obj='Var
pag=1
prev=O168
I
obj='Var
pag=1
prev=O167
I
obj='Var
pag=1
prev=O166
I
obj='Var
pag=1
prev=O165
I
obj='Var
pag=1
prev=O164
I
obj='Var
pag=1
prev=O163
I
obj='Var
pag=1
prev=O162
I
obj='Var
pag=1
prev=O161
I
obj='Var
pag=1
prev=O160
I
obj='Var
pag=1
prev=O159
I
obj='Var
pag=1
prev=O158
I
obj='Var
pag=1
prev=O157
I
obj='Var
pag=1
prev=O156
I
obj='Var
pag=1
prev=O155
I
obj='Var
pag=1
prev=O154
I
obj='Var
pag=1
prev=O153
I
obj='Var
pag=1
prev=O152
I
obj='Var
obj_type='N
pag=1
prev=O151
I
obj='Var
obj_type='N
pag=1
prev=O150
I
obj='Var
pag=1
prev=O149
I
obj='Var
obj_type='D
pag=1
prev=O148
I
obj='Var
pag=1
prev=O147
I
obj='Var
pag=1
prev=O146
I
obj='Var
pag=1
prev=O145
I
obj='Var
obj_type='N
pag=1
prev=O144
I
obj='Var
obj_type='N
pag=1
prev=O143
I
obj='Var
pag=1
prev=O142
I
obj='Var
pag=1
prev=O141
I
obj='Var
pag=1
prev=O140
I
obj='Var
obj_type='N
pag=1
prev=O139
I
obj='Var
pag=1
prev=O138
I
obj='Var
pag=1
prev=O137
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3
fatherSonIndex=0
len=1
name='w_tipodest
next=Icpitembatch.CPVarDecl
len=1
name='w_impzip
next=Icpitembatch.CPVarDecl
comment='Destinazione finale
len=1
name='w_destfin
nonlocal=True
obj='Var
pag=1
prev=O266
I
nonlocal=True
obj='Var
obj_type='N
pag=1
prev=O265
I
nonlocal=True
obj='Var
pag=1
I
I
]
w=[
150
150
]
x=14
y=17
I
Icpitembatch.CPRemark
frm_calc='Variabili loclai
next=Icpitembatch.CPVarDecl
len=1
name='_rap
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
len=10
name='cProgRap
next=Icpitembatch.CPRemark
frm_calc='Verifica se il rapporto continuativo esiste già
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_codrap
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_rap
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=4
prev=O284
sel_field='*
sel_name='rapopebo
sel_where='rapopebo->RAPPORTO=_codrap
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O286
fatherSonIndex=0
frm_calc=[
'rapopebo->DATAOPE > _datope
]
h=[
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='rapopebo
father=O290
fatherSonIndex=0
next=Icpitembatch.CPWrite
arch='intestbo
obj='Write
pag=4
prev=O295
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'_codrap
]
wr_field=[
'DATAINI
]
wr_op=[
'=
]
wr_var=[
'_datope
]
I
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'_codrap
]
wr_field=[
'DATAOPE
]
wr_op=[
'=
]
wr_var=[
'_datope
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=4
prev=O281
sel_field='*
sel_name='xapopebo
sel_where='xapopebo->RAPPORTO=_codrap
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O284
fatherSonIndex=0
frm_calc=[
'xapopebo->DATAOPE > _datope
]
h=[
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xapopebo
father=O313
fatherSonIndex=0
next=Icpitembatch.CPWrite
arch='xntestbo
obj='Write
pag=4
prev=O318
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'_codrap
]
wr_field=[
'DATAINI
]
wr_op=[
'=
]
wr_var=[
'_datope
]
I
obj='Write
pag=4
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'_codrap
]
wr_field=[
'DATAOPE
]
wr_op=[
'=
]
wr_var=[
'_datope
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O279
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O281
fatherSonIndex=0
frm_calc=[
'_rap = 0
]
h=[
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O336
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRG"+LRTrim(w_codmage)+"\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProgRap
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(w_codmage)+cProgRap
len=16
name='_codrap
next=Icpitembatch.CPInsert
arch='wurapporti
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xnarapbo
next=Icpitembatch.CPInsert
arch='knarapbo
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='xapopebo
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='xntestbo
obj='Insert
pag=4
prev=O351
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'1
'_datope
''P'
'_connes
'cInfProg2
'_codrap
''0'
''0'
'DateToChar(_datope)+cInfProg2+'0'
'_connes
'nProgImp2
]
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O350
var_op='asgn
I
obj='Insert
pag=4
prev=O349
rd_kfield=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'DATAOPE
'DATAREG
'DESCCIT
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOOPRAP
'UNIQUECODE
'VALUTA
]
rd_kvar=[
'DateToChar(_datope)
'_intercab
'_coddip
'_intercod
'_datope
'Date()
'_intercit
''3'
''0'
'cInfProg1
'DateToChar(_datope)+cInfProg1+'0'
'cInfProg2
''3'
'nProgImp
'_interprv
'_codrap
''0'
''1'
'_intertip
''23'
'_uniquecode
''242'
]
I
obj='Var
obj_type='N
pag=4
prev=O348
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
prev=O347
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
prev=O346
var_op='asgn
I
obj='Insert
pag=4
prev=O345
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
]
rd_kvar=[
'_codrap
'LRTrim(_cognome) + " " + LRTrim(_nome)
''P'
]
I
obj='Insert
pag=4
prev=O344
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'MACODICE
]
rd_kvar=[
'_codrap
'LRTrim(_cognome) + " " + LRTrim(_nome)
''0'
''E'
''242'
''99'
'w_codmage
]
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O343
var_op='asgn
I
obj='Insert
pag=4
prev=O342
rd_kfield=[
'RWMACAGE
'RWCODRAP
'RWCODFIS
]
rd_kvar=[
'w_codmage
'cProgRap
'_connes
]
I
obj='Var
pag=4
prev=O341
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O281
fatherSonIndex=1
frm_calc=[
'_rap = 0
]
h=[
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O365
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRG"+LRTrim(w_codmage)+"\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cProgRap
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(w_codmage)+cProgRap
len=16
name='_codrap
next=Icpitembatch.CPInsert
arch='wurapporti
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='anarapbo
next=Icpitembatch.CPInsert
arch='knarapbo
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPInsert
arch='rapopebo
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPInsert
arch='intestbo
obj='Insert
pag=4
prev=O380
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'TIPOPERS
'CODINTER
'NUMPROG1
'RAPPORTO
'TIPORAP
'STATOREG
'IDEREG
'COLLEGAMEN
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'1
'_datope
''P'
'_connes
'cInfProg2
'_codrap
''0'
''0'
'DateToChar(_datope)+cInfProg2+'0'
'_connes
'nProgImp2
]
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O379
var_op='asgn
I
obj='Insert
pag=4
prev=O378
rd_kfield=[
'CDATOPE
'CODCAB
'CODDIPE
'CODINTER
'DATAOPE
'DATAREG
'DESCCIT
'FLAGLIRE
'FLAGRAP
'IDBASE
'IDEREG
'NUMPROG
'OPRAP
'PRGIMPINF
'PROVINCIA
'RAPPORTO
'STATOREG
'TIPOINF
'TIPOINTER
'TIPOOPRAP
'UNIQUECODE
'VALUTA
]
rd_kvar=[
'DateToChar(_datope)
'_intercab
'_coddip
'_intercod
'_datope
'Date()
'_intercit
''3'
''0'
'cInfProg1
'DateToChar(_datope)+cInfProg1+'0'
'cInfProg2
''3'
'nProgImp
'_interprv
'_codrap
''0'
''1'
'_intertip
''23'
'_uniquecode
''242'
]
I
obj='Var
obj_type='N
pag=4
prev=O377
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
prev=O376
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
prev=O375
var_op='asgn
I
obj='Insert
pag=4
prev=O374
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
]
rd_kvar=[
'_codrap
'LRTrim(_cognome) + " " + LRTrim(_nome)
''D'
]
I
obj='Insert
pag=4
prev=O373
rd_kfield=[
'RAPPORTO
'DESCRAP
'TIPORAP
'FLAGLIRE
'VALUTA
'TIPOAG
'MACODICE
]
rd_kvar=[
'_codrap
'LRTrim(_cognome) + " " + LRTrim(_nome)
''0'
''E'
''242'
''99'
'w_codmage
]
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O372
var_op='asgn
I
obj='Insert
pag=4
prev=O371
rd_kfield=[
'RWMACAGE
'RWCODRAP
'RWCODFIS
]
rd_kvar=[
'w_codmage
'cProgRap
'_connes
]
I
obj='Var
pag=4
prev=O370
var_op='asgn
I
obj='Var
pag=4
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=4
prev=O278
sel_field='*
sel_name='wurapporti
sel_where='wurapporti->RWCODFIS=_connes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O279
fatherSonIndex=0
frm_calc='1
len=1
name='_rap
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(wurapporti->RWMACAGE)+wurapporti->RWCODRAP
len=16
name='_codrap
obj='Var
pag=4
prev=O396
var_op='asgn
I
obj='Var
obj_type='N
pag=4
pagelocal=True
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O277
var_op='asgn
I
obj='Var
pag=4
prev=O276
var_op='asgn
I
obj='Remark
pag=4
prev=O275
I
obj='Var
pag=4
pagelocal=True
prev=O274
I
obj='Var
pag=4
pagelocal=True
prev=O273
I
obj='Var
pag=4
pagelocal=True
prev=O272
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O271
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O270
I
obj='Var
obj_type='N
pag=4
pagelocal=True
prev=O269
I
obj='Remark
pag=4
x=19
y=26
I
Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_codfis)) < 16 or not(arfn_poscodfis(_codfis))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O399
fatherSonIndex=0
frm_calc=[
'(Upper(LRTrim(w_NASSTATO)) = 'ITALIA' or Upper(LRTrim(w_NASSTATO))='ITALY') and Empty(_nascitta)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(Upper(LRTrim(w_NASSTATO)) = 'ITALIA' or Upper(LRTrim(w_NASSTATO))='ITALY' or Empty(LRTrim(w_NASSTATO))) and Empty(_siglacit)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_nasstato)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(Upper(LRTrim(w_NASSTATO)) <>  'ITALIA' and Upper(LRTrim(w_NASSTATO)) <> 'ITALY' and not(Empty(w_NASSTATO))) and Empty(_siglasta)
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc=''Codice Fiscale Ricalcolato Errato - Probabili dati mancanti'
len=100
name='_merr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Codice Fiscale Ricalcolato Errato - Probabili dati mancanti |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc=''*8'
len=2
name='_tiperr
obj='Var
pag=5
prev=O417
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O416
var_op='asgn
I
obj='Var
pag=5
prev=O413
var_op='asgn
I
obj='If
pag=5
prev=O410
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O413
fatherSonIndex=0
frm_calc='_listerr + "* Stato di nascita errato |"
len=10
name='_listerr
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O407
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O410
fatherSonIndex=0
frm_calc='_listerr + "* Stato di nascita mancante o errato |"
len=10
name='_listerr
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O404
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O407
fatherSonIndex=0
frm_calc='_listerr + "* Città di nascita errata |"
len=10
name='_listerr
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O404
fatherSonIndex=0
frm_calc='_listerr + "* Città di nascita mancante |"
len=10
name='_listerr
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O399
fatherSonIndex=1
frm_calc=''+1'
len=2
name='_tiperr
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
x=1205
y=5007
I
Icpitembatch.CPIfElse
frm_calc=[
'not(arfn_poscodfis(_codfis))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O438
fatherSonIndex=0
frm_calc='_codfis
len=20
name='_oldcodfis
next=Icpitembatch.CPBeginEnd
comment='variabili per il calcolo del codice fiscale
h=[
19
19
]
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_calccodfis_wu
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(w_CODFISC)) < 16 or not(arfn_poscodfis(w_CODFISC))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O446
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O447
fatherSonIndex=0
frm_calc=[
'(Upper(LRTrim(w_NASSTATO)) = 'ITALIA' or Upper(LRTrim(w_NASSTATO))='ITALY') and Empty(_nascitta)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(Upper(LRTrim(w_NASSTATO)) = 'ITALIA' or Upper(LRTrim(w_NASSTATO))='ITALY' or Empty(LRTrim(w_NASSTATO))) and Empty(_siglacit)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_nasstato)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(Upper(LRTrim(w_NASSTATO)) <>  'ITALIA' and Upper(LRTrim(w_NASSTATO)) <> 'ITALY' and not(Empty(w_NASSTATO))) and Empty(_siglasta)
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc=''Codice Fiscale Ricalcolato - Probabili dati anagrafici errati o mancanti'
len=100
name='_merr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Codice Fiscale Ricalcolato - Probabili dati anagrafici errati o mancanti |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPVarDecl
frm_calc=''*9'
len=2
name='_tiperr
obj='Var
pag=5
prev=O466
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O465
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O464
var_op='asgn
I
obj='Var
pag=5
prev=O461
var_op='asgn
I
obj='If
pag=5
prev=O458
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O461
fatherSonIndex=0
frm_calc='_listerr + "* Stato di nascita errato |"
len=10
name='_listerr
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O455
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O458
fatherSonIndex=0
frm_calc='_listerr + "* Stato di nascita mancante |"
len=10
name='_listerr
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O452
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O455
fatherSonIndex=0
frm_calc='_listerr + "* Città di nascita errata |"
len=10
name='_listerr
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O452
fatherSonIndex=0
frm_calc='_listerr + "* Città di nascita mancante |"
len=10
name='_listerr
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O447
fatherSonIndex=1
frm_calc=''+1'
len=2
name='_tiperr
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=5
prev=O444
I
obj='Begin
pag=5
prev=O443
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Codice Fiscale
father=O444
fatherSonIndex=0
frm_calc='''
len=16
name='w_CODFISC
next=Icpitembatch.CPVarDecl
comment='Data Nascita
frm_calc='_nasdata
len=8
name='w_DATANASC
next=Icpitembatch.CPVarDecl
comment='Luogo di Nascita
frm_calc='_nascitta
len=30
name='w_NASCOMUN
next=Icpitembatch.CPVarDecl
comment='Stato di nascita
frm_calc='_nasstato
len=30
name='w_NASSTATO
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_codstanas
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='_siglacit
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='_siglasta
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_codstanas))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(w_NASSTATO)) and (Upper(LRTrim(w_NASSTATO)) = 'ITALIA' or Upper(LRTrim(w_NASSTATO))='ITALY')
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(w_NASSTATO)) and Upper(LRTrim(w_NASSTATO)) <> 'ITALIA' and Upper(LRTrim(w_NASSTATO)) <> 'ITALY'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
frm_calc='_cognome
len=26
name='w_COGNOME
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
frm_calc='LRTrim(_cognome)+" "+LRTrim(_nome)
len=70
name='w_RAGSOC
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
frm_calc='_nome
len=25
name='w_NOME
next=Icpitembatch.CPVarDecl
comment='Sesso
frm_calc='iif(_sesso='M','1',iif(_sesso='F','2',''))
len=1
name='w_SESSO
obj='Var
pag=5
prev=O508
var_op='asgn
I
obj='Var
pag=5
prev=O507
var_op='asgn
I
obj='Var
pag=5
prev=O506
var_op='asgn
I
obj='Var
pag=5
prev=O503
var_op='asgn
I
obj='If
pag=5
prev=O500
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbstati
father=O503
fatherSonIndex=0
obj='Read
pag=5
rd_field=[
'SIGLA
]
rd_kfield=[
'DESCRI
]
rd_kvar=[
'_nasstato
]
rd_var=[
'_siglasta
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O497
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O500
fatherSonIndex=0
obj='Read
pag=5
rd_field=[
'SIGLA
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_nascitta
]
rd_var=[
'_siglacit
]
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O496
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O497
fatherSonIndex=0
frm_calc=[
'Substr(_codfis,12,1)='Z'
'not(Empty(Substr(_codfis,12,1))) and Substr(_codfis,12,1) <> 'Z'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
comment='Stato di nascita
frm_calc='_nasstato
len=30
name='w_NASSTATO
obj='Var
pag=5
prev=O528
var_op='asgn
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbstati
father=O528
fatherSonIndex=0
obj='Read
pag=5
rd_field=[
'DESCRI
'SIGLA
]
rd_kfield=[
'SIGLA
]
rd_kvar=[
'Substr(_codfis,12,4)
]
rd_var=[
'_nasstato
'_siglasta
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O528
fatherSonIndex=1
frm_calc=''ITALIA'
len=30
name='_nasstato
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O495
rd_field=[
'SIGLA
]
rd_kfield=[
'DESCRI
]
rd_kvar=[
'Upper(_nasstato)
]
rd_var=[
'_codstanas
]
I
obj='Var
pag=5
prev=O494
var_op='asgn
I
obj='Var
pag=5
prev=O493
var_op='asgn
I
obj='Var
pag=5
prev=O492
var_op='asgn
I
obj='Var
pag=5
prev=O491
var_op='asgn
I
obj='Var
pag=5
prev=O490
var_op='asgn
I
obj='Var
obj_type='D
pag=5
prev=O489
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O438
fatherSonIndex=1
frm_calc=[
'Substr(_codfis,12,1)='Z'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbstati
father=O549
fatherSonIndex=0
obj='Read
pag=5
rd_field=[
'DESCRI
]
rd_kfield=[
'SIGLA
]
rd_kvar=[
'Substr(_codfis,12,4)
]
rd_var=[
'_nasstato
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O549
fatherSonIndex=1
frm_calc=''ITALIA'
len=30
name='_nasstato
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
x=1354
y=5228
I
Icpitembatch.CPVarDecl
frm_calc=''Codice Fiscale Originale - Codice Fiscale non valido'
len=100
name='_merr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPVarDecl
frm_calc=''*X'
len=2
name='_tiperr
obj='Var
pag=5
prev=O564
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O563
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
x=1018
y=5334
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumInv
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPRemark
frm_calc='Salta la prima riga in quanti dice solo cose di trasmissione
next=Icpitembatch.CPRemark
frm_calc='Legge il file
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Informazioni Elaborate: '+LRTrim(Str(conta,10,0)) + ' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'_nerrori > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O581
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O578
var_op='asgn
I
obj='If
pag=2
prev=O577
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O578
fatherSonIndex=0
frm_calc='gMsgProc + 'Sono stati rilevati '+LRTrim(Str(_nerrori,10,0)) + ' errori dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O575
var_op='asgn
I
obj='Try
pag=2
prev=O574
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O575
fatherSonIndex=0
frm_calc='// Legge il file﷯CSVReader reader = new CSVReaderBuilder(new FileReader(_filename)).withCSVParser(new CSVParserBuilder().withSeparator(';').build()).build();﷯String [] nextLine;﷯while ((nextLine = reader.readNext()) != null) { ﷯  if (nextLine.length==35) {
next=Icpitembatch.CPBeginEnd
comment='Azzera variabili Locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Riempie Variabili Valori
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPExec
check='man
frm_calc='// Chiude ciclo e if  ﷯  }﷯}
next=Icpitembatch.CPTransaction
frm_calc='commit
next=Icpitembatch.CPExec
check='man
frm_calc='// Chiude il file e lo cancella﷯reader.close();﷯FileLibMit.DeleteFile("appo/"+nomefileimport);
obj='Exec
pag=2
prev=O596
I
obj='Transaction
pag=2
prev=O595
I
obj='Exec
pag=2
prev=O594
I
obj='Var
obj_type='N
pag=2
prev=O592
var_op='asgn
I
obj='Begin
pag=2
prev=O590
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati anagrafici
father=O592
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Dati Residenza
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Dati Controparte
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Dati Operazione
h=[
19
19
]
obj='Begin
pag=2
prev=O604
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O606
fatherSonIndex=0
frm_calc='CharToDate(Substr(nextLine[13),7,4)+Substr(nextLine[13),4,2)+Left(nextLine[13),2))
len=8
name='_datope
next=Icpitembatch.CPVarDecl
dec=2
frm_calc='Val(nextLine[17])
len=15
name='_importo
next=Icpitembatch.CPVarDecl
dec=2
frm_calc='Val(nextLine[18])
len=15
name='_contanti
next=Icpitembatch.CPVarDecl
frm_calc='iif(w_xMAFLGBON='S','S','N')
len=1
name='_flgcash
next=Icpitembatch.CPVarDecl
frm_calc=''10'
len=2
name='_tipope
next=Icpitembatch.CPIfElse
frm_calc=[
'nextLine[16]='D' or nextLine[16]='S'
'nextLine[16]='R' or nextLine[16]='A'  or nextLine[16]='Q'
]
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[29]
len=10
name='_uniquecode
next=Icpitembatch.CPRead
arch='tbmacage
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(w_codmage)+"-"+LRTrim(nomefileimport)
len=60
name='_idfile
next=Icpitembatch.CPVarDecl
frm_calc='iif(nextLine[34]='IT112',LRTrim(nextLine[20]),'FN'+LRTrim(nextLine[20]))
len=6
name='_dipid
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPExec
check='page
frm_calc='5
next=Icpitembatch.CPIfElse
frm_calc=[
'_esito = 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_esito=1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono state elaborate '+LRTrim(Str(conta,10,0))+' informazioni del file '+nomefileimport
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=2
prev=O627
var_op='asgn
I
obj='If
pag=2
prev=O624
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O627
fatherSonIndex=0
frm_calc='_nerrori + 1
len=10
name='_nerrori
next=Icpitembatch.CPVarDecl
frm_seek='AppendBlank
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[0]
frm_seek='colonna01
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[1]
frm_seek='colonna02
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[2]
frm_seek='colonna03
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[3]
frm_seek='colonna04
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[4]
frm_seek='colonna05
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[5]
frm_seek='colonna06
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[6]
frm_seek='colonna07
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[7]
frm_seek='colonna08
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[8]
frm_seek='colonna09
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[9]
frm_seek='colonna10
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[10]
frm_seek='colonna11
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[11]
frm_seek='colonna12
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[12]
frm_seek='colonna13
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[13]
frm_seek='colonna14
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[14]
frm_seek='colonna15
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[15]
frm_seek='colonna16
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[16]
frm_seek='colonna17
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[17]
frm_seek='colonna18
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[18]
frm_seek='colonna19
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[19]
frm_seek='colonna20
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[20]
frm_seek='colonna21
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[21]
frm_seek='colonna22
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[22]
frm_seek='colonna23
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[23]
frm_seek='colonna24
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[24]
frm_seek='colonna25
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[25]
frm_seek='colonna26
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[26]
frm_seek='colonna27
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[27]
frm_seek='colonna28
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[28]
frm_seek='colonna29
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[29]
frm_seek='colonna30
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[30]
frm_seek='colonna31
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[31]
frm_seek='colonna32
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[32]
frm_seek='colonna33
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[33]
frm_seek='colonna34
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[34]
frm_seek='colonna35
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_calc='_listerr
frm_seek='colonna36
name='mcErrate
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcErrate
obj='Var
obj_type='MC
pag=2
prev=O670
var_op='meth
I
obj='Var
obj_type='MC
pag=2
prev=O669
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O668
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O667
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O666
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O665
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O664
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O663
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O662
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O661
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O660
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O659
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O658
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O657
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O656
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O655
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O654
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O653
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O652
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O651
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O650
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O649
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O648
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O647
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O646
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O645
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O644
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O643
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O642
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O641
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O640
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O639
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O638
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O637
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O636
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O635
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O634
var_op='prop
I
obj='Var
obj_type='MC
pag=2
prev=O633
var_op='meth
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O623
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Scrive dati cliente
father=O624
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPExec
check='page
frm_calc='8
next=Icpitembatch.CPIfElse
frm_calc=[
'_esito=-1
]
h=[
19
19
]
obj='If
pag=2
prev=O678
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExitLoop
father=O679
fatherSonIndex=0
obj='ExitLoop
pag=2
I
I
]
w=[
150
150
]
I
obj='Exec
pag=2
prev=O677
I
obj='Var
pag=2
prev=O675
var_op='asgn
I
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O675
fatherSonIndex=0
frm_calc='''
len=16
name='_connes
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_prov
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_cab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_idb2
next=Icpitembatch.CPRead
arch='tbcitta
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_connes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O693
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O694
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPOCLI\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='_codfis
len=16
name='_connes
next=Icpitembatch.CPInsert
arch='personbo
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=50
name='_condoc
next=Icpitembatch.CPRead
arch='kersonbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_condoc))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPInsert
arch='personbo_agg
obj='Insert
pag=2
prev=O705
rd_kfield=[
'CONNES
'FLGBANCA
]
rd_kvar=[
'_codfis
'w_xMAFLGCHKDAT
]
I
obj='If
pag=2
prev=O704
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='kersonbo
father=O705
fatherSonIndex=0
h=[
19
19
]
obj='Insert
pag=2
rd_kfield=[
'CONNES
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'CAP
'SESSO
'DATAVALI
'TIPOPERS
'COGNOME
'NOME
'TIPINTER
'CFESTERO
'NASSTATO
'ALLINEATO
'ALLINEATONOMECNOME
'PROGIMPORT
'PEP
'PROVINCIA
'CODCAB
'IDFILE
]
rd_kvar=[
'LRTrim(w_codmage)+"_"+_codfis+"_"+LRTrim(_doctype)+"_"+Left(_numdoc,15)
'Left(LRTrim(_cognome)+" "+LRTrim(_nome),70)
'Left(_via,35)
'iif(_nocf=0,_codfis,'')
'_nasdata
'Left(_nascitta,30)
''600'
'''
''600'
'_doctype
'Left(_numdoc,15)
'_docril
'Left(_autril,30)
'Left(_citta,30)
'Left(_cap,5)
'iif(_sesso='M','1',iif(_sesso='F','2',''))
'_docsca
''P'
'Left(_cognome,26)
'Left(_nome,25)
'Left(_nasprov,2)
'_nocf
'Left(_nasstato,30)
'0
'0
'nProgImp
''N'
'Left(_prov,2)
'Left(_cab,6)
'_idfile
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O713
fatherSonIndex=0
frm_calc='gMsgProc +"KERSONBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O722
I
obj='Exec
pag=2
prev=O721
I
obj='Var
obj_type='N
pag=2
prev=O720
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O719
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='kersonbo
father=O705
fatherSonIndex=1
frm_calc='Errore in aggiornamento ARCHPERS
h=[
19
19
]
obj='Write
pag=2
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(w_codmage)+"_"+_codfis+"_"+LRTrim(_doctype)+"_"+Left(_numdoc,15)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O726
fatherSonIndex=0
frm_calc='gMsgProc +"KERSONBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O736
I
obj='Exec
pag=2
prev=O735
I
obj='Var
obj_type='N
pag=2
prev=O734
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O733
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'CAP
'SESSO
'DATAVALI
'COGNOME
'NOME
'TIPINTER
'NASSTATO
'ALLINEATONOMECNOME
'PEP
'IDFILE
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Left(_cab,6)
'Left(LRTrim(_cognome)+" "+LRTrim(_nome),70)
'Left(_via,35)
'_codfis
'_nasdata
'Left(_nascitta,30)
''600'
'''
''600'
'_doctype
'Left(_numdoc,15)
'_docril
'Left(_autril,30)
'Left(_citta,30)
'Left(_prov,2)
'Left(_cap,5)
'iif(_sesso='M','1',iif(_sesso='F','2',''))
'_docsca
'Left(_cognome,26)
'Left(_nome,25)
'Left(_nasprov,2)
'Left(_nasstato,30)
'0
''N'
'_idfile
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O703
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'w_codmage+"_"+_codfis+"_"+LRTrim(_doctype)+"_"+Left(_numdoc,15)
]
rd_var=[
'_condoc
]
I
obj='Var
pag=2
prev=O701
var_op='asgn
I
obj='Insert
pag=2
prev=O700
rd_kfield=[
'CONNES
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'CAP
'SESSO
'DATAVALI
'TIPOPERS
'COGNOME
'NOME
'TIPINTER
'CFESTERO
'NASSTATO
'ALLINEATO
'ALLINEATONOMECNOME
'PROGIMPORT
'PEP
'PROVINCIA
'CODCAB
'IDFILE
'OLDCODFISC
'MACROAGENTE
]
rd_kvar=[
'_codfis
'Left(LRTrim(_cognome)+" "+LRTrim(_nome),70)
'Left(_via,35)
'iif(_nocf=0,_codfis,'')
'_nasdata
'Left(_nascitta,30)
''600'
'''
''600'
'_doctype
'Left(_numdoc,15)
'_docril
'Left(_autril,30)
'Left(_citta,30)
'Left(_cap,5)
'iif(_sesso='M','1',iif(_sesso='F','2',''))
'_docsca
''P'
'Left(_cognome,26)
'Left(_nome,25)
'Left(_nasprov,2)
'_nocf
'Left(_nasstato,30)
'0
'0
'nProgImp
''N'
'Left(_prov,2)
'Left(_cab,6)
'_idfile
'_oldcodfis
'w_codmage
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O701
fatherSonIndex=0
frm_calc='gMsgProc +"PERSONBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O754
I
obj='Exec
pag=2
prev=O753
I
obj='Var
obj_type='N
pag=2
prev=O752
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O751
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=2
prev=O699
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O694
fatherSonIndex=1
frm_calc=''X'
len=1
name='_flgbanca
next=Icpitembatch.CPVarDecl
frm_calc=''X'
len=1
name='_flgvalage
next=Icpitembatch.CPRead
arch='personbo_agg
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_aggcli
next=Icpitembatch.CPIfElse
frm_calc=[
'w_xMAFLGCHKDAT='S'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_aggcli = 1
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=50
name='_condoc
next=Icpitembatch.CPRead
arch='kersonbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_condoc))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O769
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='kersonbo
father=O770
fatherSonIndex=0
h=[
19
19
]
obj='Insert
pag=2
rd_kfield=[
'CONNES
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'CAP
'SESSO
'DATAVALI
'TIPOPERS
'COGNOME
'NOME
'TIPINTER
'CFESTERO
'NASSTATO
'ALLINEATO
'ALLINEATONOMECNOME
'PROGIMPORT
'PEP
'PROVINCIA
'CODCAB
'IDFILE
]
rd_kvar=[
'LRTrim(w_codmage)+"_"+_codfis+"_"+LRTrim(_doctype)+"_"+Left(_numdoc,15)
'Left(LRTrim(_cognome)+" "+LRTrim(_nome),70)
'Left(_via,35)
'iif(_nocf=0,_codfis,'')
'_nasdata
'Left(_nascitta,30)
''600'
'''
''600'
'_doctype
'Left(_numdoc,15)
'_docril
'Left(_autril,30)
'Left(_citta,30)
'Left(_cap,5)
'iif(_sesso='M','1',iif(_sesso='F','2',''))
'_docsca
''P'
'Left(_cognome,26)
'Left(_nome,25)
'Left(_nasprov,2)
'_nocf
'Left(_nasstato,30)
'0
'0
'nProgImp
''N'
'Left(_prov,2)
'Left(_cab,6)
'_idfile
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O775
fatherSonIndex=0
frm_calc='gMsgProc +"KERSONBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O784
I
obj='Exec
pag=2
prev=O783
I
obj='Var
obj_type='N
pag=2
prev=O782
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O781
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O770
fatherSonIndex=1
frm_calc=[
'_aggcli=1
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='kersonbo
father=O788
fatherSonIndex=0
frm_calc='Errore in aggiornamento ARCHPERS
h=[
19
19
]
obj='Write
pag=2
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(w_codmage)+"_"+_codfis+"_"+LRTrim(_doctype)+"_"+Left(_numdoc,15)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O793
fatherSonIndex=0
frm_calc='gMsgProc +"KERSONBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O803
I
obj='Exec
pag=2
prev=O802
I
obj='Var
obj_type='N
pag=2
prev=O801
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O800
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'CAP
'SESSO
'DATAVALI
'COGNOME
'NOME
'TIPINTER
'NASSTATO
'ALLINEATONOMECNOME
'PEP
'IDFILE
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Left(_cab,6)
'Left(LRTrim(_cognome)+" "+LRTrim(_nome),70)
'Left(_via,35)
'iif(_nocf=0,_codfis,'')
'_nasdata
'Left(_nascitta,30)
''600'
'''
''600'
'_doctype
'Left(_numdoc,15)
'_docril
'Left(_autril,30)
'Left(_citta,30)
'Left(_prov,2)
'Left(_cap,5)
'iif(_sesso='M','1',iif(_sesso='F','2',''))
'_docsca
'Left(_cognome,26)
'Left(_nome,25)
'Left(_nasprov,2)
'Left(_nasstato,30)
'0
''N'
'_idfile
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O768
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(w_codmage)+"_"+_codfis+"_"+LRTrim(_doctype)+"_"+Left(_numdoc,15)
]
rd_var=[
'_condoc
]
I
obj='Var
pag=2
prev=O765
var_op='asgn
I
obj='If
pag=2
prev=O762
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O765
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_xMAFLGCHKDAT='S' or _flgbanca='N' or _flgbanca='X' or _flgvalage='X' or _flgvalage='N'
'(_flgbanca='S' or _flgvalage='S') and w_xMAFLGCHKDAT='N'
]
h=[
19
19
19
]
obj='If
pag=2
prev=O818
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='personbo
father=O820
fatherSonIndex=0
frm_calc='Errore in aggiornamento ARCHPERS
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_xMAFLGCHKDAT='S'
]
h=[
19
19
]
obj='If
pag=2
prev=O825
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O827
fatherSonIndex=0
frm_calc=[
'_flgbanca='X'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='personbo_agg
father=O832
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'CONNES
'FLGBANCA
]
rd_kvar=[
'_codfis
''S'
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='personbo_agg
father=O832
fatherSonIndex=1
obj='Write
pag=2
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'_codfis
]
wr_field=[
'FLGBANCA
]
wr_op=[
'=
]
wr_var=[
''S'
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=2
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'_connes
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O825
fatherSonIndex=0
frm_calc='gMsgProc +"PERSONBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O858
I
obj='Exec
pag=2
prev=O857
I
obj='Var
obj_type='N
pag=2
prev=O856
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O855
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'CAP
'SESSO
'DATAVALI
'COGNOME
'NOME
'TIPINTER
'NASSTATO
'ALLINEATONOMECNOME
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Left(_cab,6)
'Left(LRTrim(_cognome)+" "+LRTrim(_nome),70)
'Left(_via,35)
'iif(_nocf=0,_codfis,'')
'_nasdata
'Left(_nascitta,30)
''600'
'''
''600'
'_doctype
'Left(_numdoc,15)
'_docril
'Left(_autril,30)
'Left(_citta,30)
'Left(_prov,2)
'Left(_cap,5)
'iif(_sesso='M','1','2')
'_docsca
'Left(_cognome,26)
'Left(_nome,25)
'Left(_nasprov,2)
'Left(_nasstato,30)
'0
''N'
'_idfile
'_oldcodfis
'w_codmage
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='personbo
father=O820
fatherSonIndex=1
frm_calc='Errore in aggiornamento ARCHPERS
h=[
19
19
]
obj='Write
pag=2
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'_connes
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O865
fatherSonIndex=0
frm_calc='gMsgProc +"PERSONBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O875
I
obj='Exec
pag=2
prev=O874
I
obj='Var
obj_type='N
pag=2
prev=O873
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O872
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
wr_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'CAP
'DATAVALI
'ALLINEATONOMECNOME
'PEP
'IDFILE
'MACROAGENTE
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Left(_cab,6)
'Left(LRTrim(_cognome)+" "+LRTrim(_nome),70)
'Left(_via,35)
''600'
'''
''600'
'_doctype
'Left(_numdoc,15)
'_docril
'Left(_autril,30)
'Left(_citta,30)
'Left(_prov,2)
'Left(_cap,5)
'_docsca
'0
''N'
'_idfile
'w_codmage
]
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=2
prev=O817
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES=_connes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O818
fatherSonIndex=0
h=[
19
19
]
obj='Insert
pag=2
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'datamodi
'IDFILE
'OLDCODFISC
'MACROAGENTE
]
rd_kvar=[
'cProgSto
'personbo->CONNES
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'Date()
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O884
fatherSonIndex=0
frm_calc='gMsgProc +"WERSONBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=2
prev=O893
I
obj='Exec
pag=2
prev=O892
I
obj='Var
obj_type='N
pag=2
prev=O891
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O890
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O761
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O762
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPCase
father=O762
fatherSonIndex=1
frm_calc=[
'LRTrim(w_codmage)='COSTA'
'w_codmage='FININ'
'w_codmage='BCAUC'
'w_codmage='BCISP'
'w_codmage='BCASS' or LRTrim(w_codmage)='E998' or LRTrim(w_codmage)='EBDSS' or LRTrim(w_codmage)='I999'
'w_codmage='DHLSP'
'w_codmage='TRAVX'
]
h=[
19
19
19
19
19
19
19
19
]
obj='Case
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O902
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O902
fatherSonIndex=1
frm_calc=[
'_oldmac <> 'COSTA'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O909
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O902
fatherSonIndex=2
frm_calc=[
'_oldmac <> 'COSTA' and _oldmac <> 'FININ'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O917
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O902
fatherSonIndex=3
frm_calc=[
'_oldmac <> 'COSTA' and _oldmac <> 'FININ' and _oldmac <> 'BCAUC'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O925
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O902
fatherSonIndex=4
frm_calc=[
'_oldmac <> 'COSTA' and _oldmac <> 'FININ' and _oldmac <> 'BCAUC' and _oldmac <> 'BCISP'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O933
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O902
fatherSonIndex=5
frm_calc=[
'_oldmac = 'TRAVX' or _oldmac='DHLSP'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O941
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O902
fatherSonIndex=6
frm_calc=[
'_oldmac='TRAVX'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O949
fatherSonIndex=0
frm_calc='1
len=1
name='_aggcli
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
150
150
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=2
prev=O760
var_op='asgn
I
obj='Read
pag=2
prev=O759
rd_field=[
'FLGBANCA
'FLGVALIDO
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'_codfis
]
rd_var=[
'_flgbanca
'_flgvalage
]
I
obj='Var
pag=2
prev=O758
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O692
rd_field=[
'CONNES
'MACROAGENTE
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'_codfis
]
rd_var=[
'_connes
'_oldmac
]
I
obj='Read
pag=2
prev=O691
rd_field=[
'PROV
'CAB
'IDBASE
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_citta
]
rd_var=[
'_prov
'_cab
'_idb2
]
I
obj='Var
pag=2
prev=O690
var_op='asgn
I
obj='Var
pag=2
prev=O689
var_op='asgn
I
obj='Var
pag=2
prev=O688
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=2
prev=O622
I
obj='Read
pag=2
prev=O621
rd_field=[
'CODDIP
]
rd_kfield=[
'TERMINALID
'MACROAGENTE
]
rd_kvar=[
'LRTrim(nextLine[20])
'w_codmage
]
rd_var=[
'_coddip
]
I
obj='Var
pag=2
prev=O620
var_op='asgn
I
obj='Var
pag=2
prev=O619
var_op='asgn
I
obj='Read
pag=2
prev=O618
rd_field=[
'MADIPSTD
'MAFLGASR
'MAFLGBON
'MAFLGCKR
'MAFLGRAP
'MACODICE
'MAFLGCHKDAT
]
rd_kfield=[
'MANAIDWU
]
rd_kvar=[
'Left(nextLine[34],5)
]
rd_var=[
'w_xMADIPSTD
'w_xMAFLGASR
'w_xMAFLGBON
'w_xMAFLGCKR
'w_xMAFLGRAP
'w_codmage
'w_xMAFLGCHKDAT
]
I
obj='Var
pag=2
prev=O615
var_op='asgn
I
obj='If
pag=2
prev=O614
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O615
fatherSonIndex=0
frm_calc=''I9'
len=4
name='_codana
next=Icpitembatch.CPVarDecl
frm_calc=''1M'
len=2
name='_codsin
next=Icpitembatch.CPVarDecl
frm_calc=''D'
len=1
name='_segno
obj='Var
pag=2
prev=O984
var_op='asgn
I
obj='Var
pag=2
prev=O983
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O615
fatherSonIndex=1
frm_calc=''I8'
len=4
name='_codana
next=Icpitembatch.CPVarDecl
frm_calc=''2M'
len=2
name='_codsin
next=Icpitembatch.CPVarDecl
frm_calc=''A'
len=1
name='_segno
obj='Var
pag=2
prev=O988
var_op='asgn
I
obj='Var
pag=2
prev=O987
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O613
var_op='asgn
I
obj='Var
pag=2
prev=O612
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O611
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O610
var_op='asgn
I
obj='Var
obj_type='D
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O602
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O604
fatherSonIndex=0
frm_calc='LRTrim(nextLine[26])
len=25
name='_nomecp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(nextLine[25])
len=26
name='_cognomecp
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(nextLine[27]))
len=3
name='_statodest
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_uifdest
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_uifdest)
]
h=[
19
19
]
obj='If
pag=2
prev=O998
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='DecodeStati
father=O999
fatherSonIndex=0
obj='Read
pag=2
rd_field=[
'CODSTA
]
rd_kfield=[
'account
]
rd_kvar=[
'_statodest
]
rd_var=[
'_codstares
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=2
prev=O997
rd_field=[
'CODSTA
]
rd_kfield=[
'DESCRI
]
rd_kvar=[
'_statodest
]
rd_var=[
'_uifdest
]
I
obj='Var
pag=2
prev=O996
var_op='asgn
I
obj='Var
pag=2
prev=O995
var_op='asgn
I
obj='Var
pag=2
prev=O994
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O600
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O602
fatherSonIndex=0
frm_calc='LRTrim(nextLine[11])
len=40
name='_citta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_codcit
next=Icpitembatch.CPRead
arch='DecodeCitta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(LRTrim(nextLine[30]])
len=50
name='_paese
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_codstares
next=Icpitembatch.CPRead
arch='DecodeStati
obj='Read
pag=2
prev=O1021
rd_field=[
'CODSTA
]
rd_kfield=[
'account
]
rd_kvar=[
'_paese
]
rd_var=[
'_codstares
]
I
obj='Var
pag=2
prev=O1020
var_op='asgn
I
obj='Var
pag=2
prev=O1019
var_op='asgn
I
obj='Read
pag=2
prev=O1018
rd_field=[
'IDBASE
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_citta
]
rd_var=[
'_codcit
]
I
obj='Var
pag=2
prev=O1017
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='variabili per il calcolo del codice fiscale
father=O600
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[1]
len=26
name='_cognome
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[2]
len=25
name='_nome
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[3]
len=35
name='_via
next=Icpitembatch.CPVarDecl
frm_calc='iif(LRTrim(nextLine[4])='S',0,1)
len=1
name='_nocf
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[5]
len=16
name='_codfis
next=Icpitembatch.CPIfElse
frm_calc=[
'_nocf=0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPBeginEnd
comment='Dati Del documento
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(nextLine[31])
len=8
name='_nasdata
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[32]
len=1
name='_sesso
obj='Var
pag=2
prev=O1046
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O1044
var_op='asgn
I
obj='Begin
pag=2
prev=O1041
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1044
fatherSonIndex=0
frm_calc='nextLine[7]
len=20
name='_numdoc
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(nextLine[9])
len=8
name='_docril
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(nextLine[8])
len=8
name='_docsca
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[10]
len=30
name='_autril
next=Icpitembatch.CPBeginEnd
comment='Tipo Documento
h=[
19
19
]
obj='Begin
pag=2
prev=O1053
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O1054
fatherSonIndex=0
frm_calc=[
'LRTrim(nextLine[12])='PP'
'LRTrim(nextLine[12])='CI'
'LRTrim(nextLine[12])='PA'
'LRTrim(nextLine[12])='FC'
]
h=[
19
19
19
19
19
19
]
haselse=True
obj='Case
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1058
fatherSonIndex=0
frm_calc=''03'
len=2
name='_doctype
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1058
fatherSonIndex=1
frm_calc=''01'
len=2
name='_doctype
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1058
fatherSonIndex=2
frm_calc=''02'
len=2
name='_doctype
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1058
fatherSonIndex=3
frm_calc=''04'
len=2
name='_doctype
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1058
fatherSonIndex=4
frm_calc=''06'
len=2
name='_doctype
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O1052
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O1051
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O1050
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O1040
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1041
fatherSonIndex=0
frm_calc='_codfis
len=16
name='_ocodfis
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(_codfis,12,1)='Z'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O1077
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1078
fatherSonIndex=0
frm_calc=''EE'
len=2
name='_nasprov
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_nasstato
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_nasstato)
]
h=[
19
19
]
obj='If
pag=2
prev=O1085
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbstatna
father=O1086
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_nasstato)
]
h=[
19
19
]
obj='If
pag=2
prev=O1091
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1092
fatherSonIndex=0
frm_calc='LRTrim(nextLine[6])
len=30
name='_nasstato
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=2
rd_field=[
'DESCRI
]
rd_kfield=[
'SIGLA
]
rd_kvar=[
'Substr(_codfis,12,4)
]
rd_var=[
'_nasstato
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=2
prev=O1084
rd_field=[
'DESCRI
]
rd_kfield=[
'SIGLA
]
rd_kvar=[
'Substr(_codfis,12,4)
]
rd_var=[
'_nasstato
]
I
obj='Var
pag=2
prev=O1083
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1078
fatherSonIndex=1
frm_calc='''
len=30
name='_nascitta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_nasprov
next=Icpitembatch.CPRead
arch='tbcitta
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_nascitta)
]
h=[
19
19
]
obj='If
pag=2
prev=O1111
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcittna
father=O1112
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_nascitta)
]
h=[
19
19
]
obj='If
pag=2
prev=O1117
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O1118
fatherSonIndex=0
obj='Read
pag=2
rd_field=[
'PROV
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'LRTrim(nextLine[6])
]
rd_var=[
'_nasprov
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=2
rd_field=[
'PROV
'CITTA
]
rd_kfield=[
'SIGLA
]
rd_kvar=[
'Substr(_codfis,12,4)
]
rd_var=[
'_nasprov
'_nascitta
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=2
prev=O1110
rd_field=[
'PROV
'CITTA
]
rd_kfield=[
'SIGLA
]
rd_kvar=[
'Substr(_codfis,12,4)
]
rd_var=[
'_nasprov
'_nascitta
]
I
obj='Var
pag=2
prev=O1109
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1041
fatherSonIndex=1
frm_calc='''
len=2
name='_nasprov
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_nasstato
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_nascitta
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(nextLine[6])))
]
h=[
19
19
]
obj='If
pag=2
prev=O1142
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1143
fatherSonIndex=0
frm_calc='''
len=3
name='_codstanas
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(nextLine[6])
len=50
name='_luonas
next=Icpitembatch.CPRead
arch='DecodeStati
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_codstanas))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_nasstato) and Empty(_nascitta)
]
h=[
19
19
]
obj='If
pag=2
prev=O1151
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbstati
father=O1154
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_codstanas))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O1159
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1160
fatherSonIndex=0
frm_calc=''EE'
len=2
name='_nasprov
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O1160
fatherSonIndex=1
obj='Read
pag=2
rd_field=[
'PROV
'CITTA
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_luonas
]
rd_var=[
'_nasprov
'_nascitta
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
rd_field=[
'CODSTA
'DESCRI
]
rd_kfield=[
'DESCRI
]
rd_kvar=[
'LRTrim(_luonas)
]
rd_var=[
'_codstanas
'_nasstato
]
I
I
]
w=[
150
150
]
I
obj='If
pag=2
prev=O1150
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbstati
father=O1151
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='_nasprov
obj='Var
pag=2
prev=O1180
var_op='asgn
I
obj='Read
pag=2
rd_field=[
'DESCRI
]
rd_kfield=[
'CODSTA
]
rd_kvar=[
'_codstanas
]
rd_var=[
'_nasstato
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='DecodeCitta
father=O1151
fatherSonIndex=1
next=Icpitembatch.CPRead
arch='tbcitta
obj='Read
pag=2
prev=O1187
rd_field=[
'PROV
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_nascitta
]
rd_var=[
'_nasprov
]
I
obj='Read
pag=2
rd_field=[
'CITTAMIT
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_luonas
]
rd_var=[
'_nascitta
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O1149
rd_field=[
'CODSTA
'DESCRI
]
rd_kfield=[
'account
]
rd_kvar=[
'_luonas
]
rd_var=[
'_codstanas
'_nasstato
]
I
obj='Var
pag=2
prev=O1148
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O1141
var_op='asgn
I
obj='Var
pag=2
prev=O1140
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=2
prev=O1039
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O1038
var_op='asgn
I
obj='Var
pag=2
prev=O1037
var_op='asgn
I
obj='Var
pag=2
prev=O1036
var_op='asgn
I
obj='Var
pag=2
prev=O1034
var_op='asgn
I
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Codice Fiscale
father=O1034
fatherSonIndex=0
frm_calc='''
len=16
name='w_CODFISC
next=Icpitembatch.CPVarDecl
comment='Data Nascita
frm_calc='NullDate()
len=8
name='w_DATANASC
next=Icpitembatch.CPVarDecl
comment='Luogo di Nascita
frm_calc='''
len=30
name='w_NASCOMUN
next=Icpitembatch.CPVarDecl
comment='Stato di nascita
frm_calc='''
len=30
name='w_NASSTATO
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
frm_calc='''
len=26
name='w_COGNOME
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
frm_calc='''
len=70
name='w_RAGSOC
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
frm_calc='''
len=25
name='w_NOME
next=Icpitembatch.CPVarDecl
comment='Sesso
frm_calc='''
len=1
name='w_SESSO
obj='Var
pag=2
prev=O1212
var_op='asgn
I
obj='Var
pag=2
prev=O1211
var_op='asgn
I
obj='Var
pag=2
prev=O1210
var_op='asgn
I
obj='Var
pag=2
prev=O1209
var_op='asgn
I
obj='Var
pag=2
prev=O1208
var_op='asgn
I
obj='Var
pag=2
prev=O1207
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O1206
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O589
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O590
fatherSonIndex=0
frm_calc='1
len=1
name='_i
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_esito
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_tipoop
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_uniquecode
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datope
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_impstr
next=Icpitembatch.CPVarDecl
dec=2
frm_calc='0
len=15
name='_importo
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_statodest
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_isodest
next=Icpitembatch.CPVarDecl
frm_calc='''
len=26
name='_cognome
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='_nome
next=Icpitembatch.CPVarDecl
frm_calc='''
len=40
name='_citta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_cap
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_via
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_prov
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_cab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_resstato
next=Icpitembatch.CPVarDecl
frm_calc='''
len=26
name='_cognomecp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='_nomecp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_sesso
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_nascitta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_nasstato
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_nasprov
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_nasdata
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_tipodoc
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_numdoc
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_docril
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_autril
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_docsca
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_codfis
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_ocodfis
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_connes
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_doctype
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='_codana
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_codsin
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_segno
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_nocf
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_txtope
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_oldcodfis
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_oldmac
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='w_xMAFLGRAP
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='w_xMAFLGBON
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='w_xMAFLGCKR
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='w_xMAFLGASR
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='w_xMADIPSTD
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='w_xMAFLGCHKDAT
obj='Var
pag=2
prev=O1267
var_op='asgn
I
obj='Var
pag=2
prev=O1266
var_op='asgn
I
obj='Var
pag=2
prev=O1265
var_op='asgn
I
obj='Var
pag=2
prev=O1264
var_op='asgn
I
obj='Var
pag=2
prev=O1263
var_op='asgn
I
obj='Var
pag=2
prev=O1262
var_op='asgn
I
obj='Var
pag=2
prev=O1261
var_op='asgn
I
obj='Var
pag=2
prev=O1260
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1259
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O1258
var_op='asgn
I
obj='Var
pag=2
prev=O1257
var_op='asgn
I
obj='Var
pag=2
prev=O1256
var_op='asgn
I
obj='Var
pag=2
prev=O1255
var_op='asgn
I
obj='Var
pag=2
prev=O1254
var_op='asgn
I
obj='Var
pag=2
prev=O1253
var_op='asgn
I
obj='Var
pag=2
prev=O1252
var_op='asgn
I
obj='Var
pag=2
prev=O1251
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O1250
var_op='asgn
I
obj='Var
pag=2
prev=O1249
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O1248
var_op='asgn
I
obj='Var
pag=2
prev=O1247
var_op='asgn
I
obj='Var
pag=2
prev=O1246
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O1245
var_op='asgn
I
obj='Var
pag=2
prev=O1244
var_op='asgn
I
obj='Var
pag=2
prev=O1243
var_op='asgn
I
obj='Var
pag=2
prev=O1242
var_op='asgn
I
obj='Var
pag=2
prev=O1241
var_op='asgn
I
obj='Var
pag=2
prev=O1240
var_op='asgn
I
obj='Var
pag=2
prev=O1239
var_op='asgn
I
obj='Var
pag=2
prev=O1238
var_op='asgn
I
obj='Var
pag=2
prev=O1237
var_op='asgn
I
obj='Var
pag=2
prev=O1236
var_op='asgn
I
obj='Var
pag=2
prev=O1235
var_op='asgn
I
obj='Var
pag=2
prev=O1234
var_op='asgn
I
obj='Var
pag=2
prev=O1233
var_op='asgn
I
obj='Var
pag=2
prev=O1232
var_op='asgn
I
obj='Var
pag=2
prev=O1231
var_op='asgn
I
obj='Var
pag=2
prev=O1230
var_op='asgn
I
obj='Var
pag=2
prev=O1229
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O1228
var_op='asgn
I
obj='Var
pag=2
prev=O1227
var_op='asgn
I
obj='Var
obj_type='D
pag=2
prev=O1226
var_op='asgn
I
obj='Var
pag=2
prev=O1225
var_op='asgn
I
obj='Var
pag=2
prev=O1224
var_op='asgn
I
obj='Var
pag=2
prev=O1223
var_op='asgn
I
obj='Var
pag=2
prev=O1222
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O1221
var_op='asgn
I
obj='Var
obj_type='M
pag=2
prev=O1220
var_op='asgn
I
obj='Var
pag=2
prev=O1219
var_op='asgn
I
obj='Var
obj_type='N
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Exec
pag=2
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O575
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=2
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=2
prev=O573
I
obj='Remark
pag=2
prev=O572
I
obj='Remark
pag=2
prev=O571
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O570
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O569
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O568
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O567
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O566
var_op='asgn
I
obj='Remark
pag=2
x=10
y=19
I
Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + czipfile + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Inizio estrazione del file '+ czipfile
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"\appo\"+czipfile
len=200
name='cpercorsozip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"\appo\"
len=200
name='cdirectoryfile
next=Icpitembatch.CPExec
check='man
frm_calc='try {﷯      // Apro il file zip﷯      java.util.zip.ZipFile zf = new java.util.zip.ZipFile(cpercorsozip);﷯﷯      //Conto il numero di file all interno del file zip e creo un array di stringhe per memorizzare i nomi file﷯      conteggio=zf.size();﷯      lista=new String[conteggio];﷯      ﷯      // Enumerate each entry﷯      i=0;﷯      for (java.util.Enumeration entries = zf.entries(); entries.hasMoreElements();) {﷯          // Get the entry name﷯          lista[i] = ((java.util.zip.ZipEntry)entries.nextElement()).getName();﷯          i++;﷯      }﷯     zf.close();﷯     } catch (java.io.IOException e) {﷯     }﷯try {﷯      // Apro il file zip﷯      java.util.zip.ZipFile zf = new java.util.zip.ZipFile(cpercorsozip);﷯﷯      byte[] buffer = new byte[1024]; ﷯      java.util.Enumeration entries = zf.entries();﷯      while(entries.hasMoreElements() ) {﷯        java.util.zip.ZipEntry entry = (java.util.zip.ZipEntry)entries.nextElement();﷯﷯        System.err.println("Extracting file: " + entry.getName());﷯        java.io.InputStream in =zf.getInputStream(entry);﷯        java.io.OutputStream out = new java.io.BufferedOutputStream(new java.io.FileOutputStream(cdirectoryfile+entry.getName()));﷯﷯        int len;﷯﷯        while((len = in.read(buffer)) >= 0){﷯          out.write(buffer, 0, len);﷯        }﷯﷯          in.close();﷯          out.close();﷯      }﷯﷯      zf.close();﷯} catch (java.io.IOException ioe) {﷯      System.err.println("Unhandled exception:");﷯      ioe.printStackTrace();﷯      return;﷯}
next=Icpitembatch.CPDelete
arch='tmp_list_imprich
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='contanome
next=Icpitembatch.CPVarDecl
frm_calc='0
len=3
name='_priorita
next=Icpitembatch.CPWhile
frm_calc='contanome<conteggio
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+czipfile)
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine estrazione del file '+ czipfile
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +czipfile + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1286
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1285
var_op='asgn
I
obj='Exec
pag=3
prev=O1283
I
obj='While
pag=3
prev=O1282
sons=[
Icpitembatch.CPItemSon
comment='Assegnal apriorità ad ogni file e lo inserisce in tmp_list
instr=Icpitembatch.CPExec
check='man
father=O1283
fatherSonIndex=0
frm_calc='buffernomefile=lista[contanome];
next=Icpitembatch.CPVarDecl
frm_calc='iif(At('LOCATION',Upper(buffernomefile)) >0,1,2)
len=3
name='_priorita
next=Icpitembatch.CPInsert
arch='tmp_list_imprich
next=Icpitembatch.CPVarDecl
frm_calc='contanome+1
len=10
name='contanome
obj='Var
obj_type='N
pag=3
prev=O1292
var_op='asgn
I
obj='Insert
pag=3
prev=O1291
rd_kfield=[
'nomefile
'priorita
]
rd_kvar=[
'buffernomefile
'_priorita
]
I
obj='Var
obj_type='N
pag=3
prev=O1290
var_op='asgn
I
obj='Exec
pag=3
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O1281
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O1280
var_op='asgn
I
obj='Delete
pag=3
prev=O1279
rd_kfield=[
'nomefile
]
rd_kop=[
'=
]
rd_kvar=[
'czipfile
]
I
obj='Exec
pag=3
prev=O1278
I
obj='Var
pag=3
prev=O1277
var_op='asgn
I
obj='Var
pag=3
prev=O1276
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1275
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=3
prev=O1273
var_op='asgn
I
obj='Select
pag=3
sel_field='*
sel_name='tmp_list_imprich
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1273
fatherSonIndex=0
frm_calc='LRTrim(tmp_list_imprich->nomefile)
len=100
name='czipfile
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
x=14
y=18
I
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumMod
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumInv
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_nerrori
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPRemark
frm_calc='Salta la prima riga in quanti dice solo cose di trasmissione
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(nomefileimport)
len=60
name='_idfile
next=Icpitembatch.CPRemark
frm_calc='Legge il file
next=Icpitembatch.CPBeginEnd
comment='Legge il file per verificare se ci sono delle doppie
h=[
19
19
]
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Informazioni Elaborate: '+LRTrim(Str(conta,10,0)) + ' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Nuove Agenzie '+LRTrim(Str(cNumNew,10,0)) + ' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Agenzie Aggiornate '+LRTrim(Str(cNumMod,10,0)) + ' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Agenzie Scartate '+LRTrim(Str(_nerrage,10,0)) + ' dal file '+nomefileimport+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +nomefileimport + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFile('./appo/'+nomefileimport)
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione del file '+nomefileimport
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O1325
var_op='asgn
I
obj='Exec
pag=6
prev=O1324
I
obj='Exec
pag=6
prev=O1323
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O1322
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O1321
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O1320
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O1319
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O1317
var_op='asgn
I
obj='Try
pag=6
prev=O1316
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1317
fatherSonIndex=0
frm_calc='// Legge il file﷯reader = new CSVReaderBuilder(new FileReader(_filename)).withCSVParser(new CSVParserBuilder().withSeparator(';').build()).build();﷯while ((nextLine = reader.readNext()) != null) {﷯  if (nextLine.length==9) {
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(nextLine[0]))) and Len(LRTrim(nextLine[0])) > 3
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono state elaborate '+LRTrim(Str(conta,10,0))+' informazioni del file '+nomefileimport
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPExec
check='man
frm_calc='// Chiude ciclo e if﷯  }﷯}
next=Icpitembatch.CPTransaction
frm_calc='commit
next=Icpitembatch.CPExec
check='man
frm_calc='// Chiude il file e lo cancella﷯reader.close();﷯FileLibMit.DeleteFile("appo/"+nomefileimport);
obj='Exec
pag=6
prev=O1336
I
obj='Transaction
pag=6
prev=O1335
I
obj='Exec
pag=6
prev=O1334
I
nonlocal=True
obj='Var
pag=6
prev=O1333
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O1330
var_op='asgn
I
obj='If
pag=6
prev=O1329
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Controlla Agenzia Doppia
father=O1330
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Riempie Variabili Valori
h=[
19
19
]
obj='Begin
pag=6
prev=O1340
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1342
fatherSonIndex=0
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_prov
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_cap
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_cab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_idbase
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='w_codmage
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
next=Icpitembatch.CPRead
arch='DecodeCitta
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(_citta),LRTrim(nextLine[3]),_citta)
len=40
name='_citta
next=Icpitembatch.CPRead
arch='tbcitta
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_idbase) or _contage > 1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
prev=O1358
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1359
fatherSonIndex=0
frm_calc='_nerrage + 1
len=10
name='_nerrage
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[0]
frm_seek='AppendWithKey
name='mcErrAge
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[0]
frm_seek='colonna01
name='mcErrAge
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[1]
frm_seek='colonna02
name='mcErrAge
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[2]
frm_seek='colonna03
name='mcErrAge
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[3]
frm_seek='colonna04
name='mcErrAge
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[4]
frm_seek='colonna05
name='mcErrAge
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[5]
frm_seek='colonna06
name='mcErrAge
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[6]
frm_seek='colonna07
name='mcErrAge
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[7]
frm_seek='colonna08
name='mcErrAge
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[8]
frm_seek='colonna09
name='mcErrAge
next=Icpitembatch.CPVarDecl
frm_calc='iif(_contage>1,'Duplicazione Agenzia','Mancano i dati completi della località')
frm_seek='colonna10
name='mcErrAge
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcErrAge
obj='Var
obj_type='MC
pag=6
prev=O1375
var_op='meth
I
obj='Var
obj_type='MC
pag=6
prev=O1374
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1373
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1372
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1371
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1370
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1369
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1368
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1367
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1366
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1365
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1364
var_op='meth
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbmacage
father=O1359
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=6
prev=O1378
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1379
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPInsert
arch='anadip
obj='Insert
pag=6
prev=O1384
rd_kfield=[
'CODDIP
'DESCRIZ
'DESCCIT
'PROVINCIA
'AGENTE
'MACROAGENTE
'AGACCODE
'CAB
'CAP
'IDCITTA
'DOMICILIO
'TERMINALID
]
rd_kvar=[
'LRTrim(Substr(nextLine[0],4,6))
'Left(LRTrim(nextLine[1]),30)
'_citta
'Left(LRTrim(nextLine[4]),2)
'1
'w_codmage
'Left(LRTrim(nextLine[0]),10)
'_cab
'_cap
'_idbase
'Left(LRTrim(nextLine[2]),40)
'nextLine[7]
]
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1379
fatherSonIndex=1
frm_calc='cNumMod + 1
len=10
name='cNumMod
next=Icpitembatch.CPWrite
arch='anadip
obj='Write
pag=6
prev=O1389
rd_kfield=[
'CODDIP
]
rd_kop=[
'=
]
rd_kvar=[
'_coddip
]
wr_field=[
'DESCRIZ
'IDCITTA
'DESCCIT
'PROVINCIA
'CAB
'AGENTE
'MACROAGENTE
'DOMICILIO
'CAP
'AGACCODE
'TERMINALID
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Left(LRTrim(nextLine[1]),30)
'_idbase
'_citta
'_prov
'_cab
'1
'w_codmage
'Left(LRTrim(nextLine[2]),40)
'_cap
'Left(LRTrim(nextLine[0]),10)
'nextLine[7]
]
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=6
rd_field=[
'MACODICE
]
rd_kfield=[
'MANAIDWU
]
rd_kvar=[
'nextLine[6]
]
rd_var=[
'w_codmage
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=6
prev=O1357
rd_field=[
'CAB
'PROV
'CAP
'IDBASE
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_citta
]
rd_var=[
'_cab
'_prov
'_cap
'_idbase
]
I
obj='Var
pag=6
prev=O1356
var_op='asgn
I
obj='Read
pag=6
prev=O1353
rd_field=[
'CITTAMIT
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'LRTrim(nextLine[3])
]
rd_var=[
'_citta
]
I
obj='If
pag=6
prev=O1352
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anadip
father=O1353
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
obj='If
pag=6
prev=O1413
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anadip
father=O1414
fatherSonIndex=0
obj='Read
pag=6
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'LRTrim(Substr(nextLine[0],4,6))
]
rd_var=[
'_coddip
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
rd_field=[
'CODDIP
]
rd_kfield=[
'TERMINALID
]
rd_kvar=[
'nextLine[7]
]
rd_var=[
'_coddip
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=6
prev=O1351
rd_field=[
'CODDIP
]
rd_kfield=[
'AGACCODE
]
rd_kvar=[
'LRTrim(nextLine[0])
]
rd_var=[
'_coddip
]
I
obj='Var
pag=6
prev=O1350
var_op='asgn
I
obj='Var
pag=6
prev=O1349
var_op='asgn
I
obj='Var
pag=6
prev=O1348
var_op='asgn
I
obj='Var
pag=6
prev=O1347
var_op='asgn
I
obj='Var
pag=6
prev=O1346
var_op='asgn
I
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1340
fatherSonIndex=0
frm_calc='0
len=10
name='_contage
next=Icpitembatch.CPForEach
for_variable='rowErrate
for_variable_type='mcErrateDef.MCRDef
h=[
19
19
]
iterator_expr='mcAgeDuo
obj='ForEach
pag=6
prev=O1437
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1438
fatherSonIndex=0
frm_calc=[
'LRTrim(rowErrate.colonna01)=LRTrim(nextLine[0]) or LRTrim(rowErrate.colonna08)=LRTrim(nextLine[7])
]
h=[
19
19
]
obj='If
pag=6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1442
fatherSonIndex=0
frm_calc='_contage + 1
len=10
name='_contage
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1330
fatherSonIndex=1
frm_calc='_nerrage + 1
len=10
name='_nerrage
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[0]
frm_seek='AppendWithKey
name='mcErrAge
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[0]
frm_seek='colonna01
name='mcErrAge
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[1]
frm_seek='colonna02
name='mcErrAge
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[2]
frm_seek='colonna03
name='mcErrAge
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[3]
frm_seek='colonna04
name='mcErrAge
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[4]
frm_seek='colonna05
name='mcErrAge
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[5]
frm_seek='colonna06
name='mcErrAge
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[6]
frm_seek='colonna07
name='mcErrAge
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[7]
frm_seek='colonna08
name='mcErrAge
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[8]
frm_seek='colonna09
name='mcErrAge
next=Icpitembatch.CPVarDecl
frm_calc=''Dati non completi'
frm_seek='colonna10
name='mcErrAge
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcErrAge
obj='Var
obj_type='MC
pag=6
prev=O1463
var_op='meth
I
obj='Var
obj_type='MC
pag=6
prev=O1462
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1461
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1460
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1459
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1458
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1457
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1456
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1455
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1454
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1453
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1452
var_op='meth
I
obj='Var
obj_type='N
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=6
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1317
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=6
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=6
prev=O1314
I
obj='Begin
pag=6
prev=O1313
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1314
fatherSonIndex=0
frm_calc='// Legge il file﷯CSVReader reader = new CSVReaderBuilder(new FileReader(_filename)).withCSVParser(new CSVParserBuilder().withSeparator(';').build()).build();﷯String [] nextLine;﷯while ((nextLine = reader.readNext()) != null) {﷯  if (nextLine.length==9) {
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[0]
frm_seek='AppendWithKey
name='mcAgeDuo
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[0]
frm_seek='colonna01
name='mcAgeDuo
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[1]
frm_seek='colonna02
name='mcAgeDuo
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[2]
frm_seek='colonna03
name='mcAgeDuo
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[3]
frm_seek='colonna04
name='mcAgeDuo
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[4]
frm_seek='colonna05
name='mcAgeDuo
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[5]
frm_seek='colonna06
name='mcAgeDuo
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[6]
frm_seek='colonna07
name='mcAgeDuo
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[7]
frm_seek='colonna08
name='mcAgeDuo
next=Icpitembatch.CPVarDecl
frm_calc='nextLine[8]
frm_seek='colonna09
name='mcAgeDuo
next=Icpitembatch.CPVarDecl
frm_seek='SaveRow
name='mcAgeDuo
next=Icpitembatch.CPExec
check='man
frm_calc='// Chiude ciclo e if﷯  }﷯}
next=Icpitembatch.CPTransaction
frm_calc='commit
next=Icpitembatch.CPExec
check='man
frm_calc='// Chiude il file e lo cancella﷯reader.close();
obj='Exec
pag=6
prev=O1484
I
obj='Transaction
pag=6
prev=O1483
I
obj='Exec
pag=6
prev=O1482
I
obj='Var
obj_type='MC
pag=6
prev=O1481
var_op='meth
I
obj='Var
obj_type='MC
pag=6
prev=O1480
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1479
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1478
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1477
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1476
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1475
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1474
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1473
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1472
var_op='prop
I
obj='Var
obj_type='MC
pag=6
prev=O1471
var_op='meth
I
obj='Exec
pag=6
I
I
]
w=[
150
150
]
I
obj='Remark
pag=6
prev=O1312
I
obj='Var
pag=6
prev=O1311
var_op='asgn
I
obj='Remark
pag=6
prev=O1310
I
nonlocal=True
obj='Var
obj_type='M
pag=6
prev=O1309
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O1308
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O1307
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O1306
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O1305
var_op='asgn
I
obj='Var
obj_type='N
pag=6
prev=O1304
var_op='asgn
I
obj='Remark
pag=6
x=15
y=16
I
Icpitembatch.CPBeginEnd
comment='Gestisce la modifica della transazione
h=[
19
19
]
obj='Begin
pag=7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1487
fatherSonIndex=0
frm_calc='''
len=10
name='_idbase
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_idbase)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(_idbase))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=7
prev=O1494
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
father=O1497
fatherSonIndex=0
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPIfElse
frm_calc=[
'_tdest='O'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=7
prev=O1502
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1503
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPInsert
arch='operazbo
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='docopebo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_tiperr))
]
h=[
19
19
]
obj='If
pag=7
prev=O1513
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1514
fatherSonIndex=0
frm_calc=''+0'
len=2
name='_tiperr
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Write
pag=7
prev=O1511
rd_kfield=[
'NUMPROG
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg2
]
wr_field=[
'CONNESCLI
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DATAVALI
'DOMICILIO
'DESCCIT
'PROVINCIA
'CAP
'IDFILE
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Left(_connes,16)
'Left(_doctype,2)
'Left(_numdoc,15)
'_docril
'Left(_autril,30)
'_docsca
'Left(_via,35)
'Left(_citta,30)
'Left(_prov,2)
'Left(_cap,5)
'_idfile
]
I
obj='Insert
pag=7
prev=O1510
rd_kfield=[
'C_RAG
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'CONNESCLI
'CONNESDOC
'DATAOPE
'DATAREG
'DESCCIT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'IDBASE
'IDEREG
'IDFILE
'MTCN
'NUMPROG
'OPRAP
'PRGIMPOPE
'PROVINCIA
'RAPPORTO
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ANNOOPE
'TIPOLEG
'OPERAZMOD
'DATARETT
]
rd_kvar=[
'Left(LRTrim(_cognomecp)+" "+LRTrim(_nomecp),70)
'_uifdest
'1
'DateToChar(_datope)
'DateToChar(_datope)
'DateToChar(Date())
'_codana
'_intercab
'_coddip
'_intercod
'_codsin
'_codfis
'LRTrim(w_codmage)+"_"+_codfis+"_"+LRTrim(_doctype)+"_"+Left(_numdoc,15)
'_datope
'Date()
'Left(_intercit,30)
'iif(w_xMAFLGBON='S','0','1')
''0'
''3'
'cOpeProg1
'"O"+Right(cOpeProg2,9)+_idb2
'_idfile
'_uniquecode
'cOpeProg2
''1'
'nProgImp
'_interprv
'_codrap
'_uniquecode
'_segno
''1'
''1'
'_tipope
'iif(_tipope='10',_importo*100,0)
'_importo*100
'_uniquecode
''242'
'Year(_datope)
''0'
'_idreg
'Date()
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1511
fatherSonIndex=0
frm_calc='gMsgProc +"OPERAZBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='-1
len=1
name='_esito
obj='Var
obj_type='N
pag=7
prev=O1533
var_op='asgn
I
obj='Exec
pag=7
prev=O1532
I
nonlocal=True
obj='Var
obj_type='M
pag=7
prev=O1531
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=7
prev=O1508
var_op='asgn
I
obj='Select
pag=7
sel_field='operazbo->IDBASE,operazbo->NUMPROG,operazbo->DATAOPE,operazbo->FLAGRAP2
sel_name='operazbo
sel_where='operazbo->IDBASE=_idbase and (operazbo->STATOREG='0'  or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1508
fatherSonIndex=0
frm_calc='operazbo->IDBASE
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(operazbo->FLAGRAP2) or operazbo->FLAGRAP2='S',Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(operazbo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='operazbo->IDEREG
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
frm_calc='operazbo->NUMPROG
len=11
name='cOpeProg2
next=Icpitembatch.CPWrite
arch='operazbo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=7
prev=O1547
sel_field='*
sel_name='terzistiope
sel_where='terzistiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='merzistiope
father=O1549
fatherSonIndex=0
obj='Insert
pag=7
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'IDREG
]
rd_kvar=[
'_oldidb
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=7
prev=O1545
sel_field='*
sel_name='beneficope
sel_where='beneficope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='meneficope
father=O1547
fatherSonIndex=0
obj='Insert
pag=7
rd_kfield=[
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CODSOG
'CPROWNUM
'IDBASE
'IDFILEBO
'IDREG
'LEGAME
'NUMCOL
'RAPCOL
'TIPOFILE
'UCODE
]
rd_kvar=[
'beneficope->C_CAB
'beneficope->C_CAP
'beneficope->C_CTA
'beneficope->C_IND
'beneficope->C_PRV
'beneficope->C_RAG
'beneficope->C_RAPPORTO
'beneficope->C_STA
'beneficope->CODSOG
'beneficope->CPROWNUM
'beneficope->IDBASE
'_oldidb
'_idreg
'beneficope->LEGAME
'beneficope->NUMCOL
'beneficope->RAPCOL
'beneficope->TIPOFILE
'beneficope->UCODE
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=7
prev=O1543
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mlientiope
father=O1545
fatherSonIndex=0
obj='Insert
pag=7
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=7
prev=O1542
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mogopebo
father=O1543
fatherSonIndex=0
obj='Insert
pag=7
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=7
prev=O1541
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'operazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
'FLAGRAP2
]
wr_op=[
'=
'=
'=
]
wr_var=[
''3'
'Date()
'_flagrap2
]
I
obj='Var
pag=7
prev=O1540
var_op='asgn
I
obj='Var
pag=7
prev=O1539
var_op='asgn
I
obj='Var
pag=7
prev=O1538
var_op='asgn
I
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
father=O1503
fatherSonIndex=1
frm_calc=''JLMNOTUV?'
len=9
name='stringaflagrap2
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPInsert
arch='fraziobo
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='docfrabo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_tiperr))
]
h=[
19
19
]
obj='If
pag=7
prev=O1589
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1590
fatherSonIndex=0
frm_calc=''+0'
len=2
name='_tiperr
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Write
pag=7
prev=O1587
rd_kfield=[
'NUMPROG
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg2
]
wr_field=[
'CONNESCLI
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DATAVALI
'DOMICILIO
'DESCCIT
'PROVINCIA
'CAP
'IDFILE
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Left(_connes,16)
'Left(_doctype,2)
'Left(_numdoc,15)
'_docril
'Left(_autril,30)
'_docsca
'Left(_via,35)
'Left(_citta,30)
'Left(_prov,2)
'Left(_cap,5)
'_idfile
]
I
obj='Insert
pag=7
prev=O1586
rd_kfield=[
'C_RAG
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'CONNESCLI
'CONNESDOC
'DATAOPE
'DATAREG
'DESCCIT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'IDBASE
'IDEREG
'IDFILE
'MTCN
'NUMPROG
'OPRAP
'PRGIMPFRZ
'PROVINCIA
'RAPPORTO
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ANNOOPE
'OPERAZMOD
'DATARETT
]
rd_kvar=[
'Left(LRTrim(_cognomecp)+" "+LRTrim(_nomecp),70)
'_uifdest
'1
'DateToChar(_datope)
'DateToChar(_datope)
'DateToChar(Date())
'_codana
'_intercab
'_coddip
'_intercod
'_codsin
'_codfis
'LRTrim(w_codmage)+"_"+_codfis+"_"+LRTrim(_doctype)+"_"+Left(_numdoc,15)
'_datope
'Date()
'Left(_intercit,30)
'iif(w_xMAFLGBON='S','0','1')
''0'
''3'
'cOpeProg1
'"F"+Right(cOpeProg2,9)+_idb2
'_idfile
'_uniquecode
'cOpeProg2
''1'
'nProgImp
'_interprv
'_codrap
'_uniquecode
'_segno
''1'
''1'
'_tipope
'iif(_tipope='10',_importo*100,0)
'_importo*100
'_uniquecode
''242'
'Year(_datope)
'_idreg
'Date()
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1587
fatherSonIndex=0
frm_calc='gMsgProc +"FRAZIOBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='-1
len=1
name='_esito
obj='Var
obj_type='N
pag=7
prev=O1609
var_op='asgn
I
obj='Exec
pag=7
prev=O1608
I
nonlocal=True
obj='Var
obj_type='M
pag=7
prev=O1607
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=7
prev=O1584
var_op='asgn
I
obj='Select
pag=7
prev=O1583
sel_field='fraziobo->IDBASE,fraziobo->NUMPROG,fraziobo->DATAOPE,fraziobo->FLAGRAP2
sel_name='fraziobo
sel_where='fraziobo->IDBASE=_idbase and (fraziobo->STATOREG='0'  or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1584
fatherSonIndex=0
frm_calc='fraziobo->IDBASE
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(fraziobo->FLAGRAP2) or fraziobo->FLAGRAP2='Z',Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(fraziobo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='fraziobo->IDEREG
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
frm_calc='operazbo->NUMPROG
len=11
name='cOpeProg2
next=Icpitembatch.CPWrite
arch='fraziobo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=7
prev=O1623
sel_field='*
sel_name='terzistifrz
sel_where='terzistifrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='merzistifrz
father=O1625
fatherSonIndex=0
obj='Insert
pag=7
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'IDREG
]
rd_kvar=[
'_oldidb
'terzistifrz->CODSOG
'terzistifrz->TIPOFILE
'terzistifrz->NUMCOL
'terzistifrz->LEGAME
'terzistifrz->RAPCOL
'terzistifrz->UCODE
'terzistifrz->IDBASE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=7
prev=O1621
sel_field='*
sel_name='beneficfrz
sel_where='beneficfrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='meneficfrz
father=O1623
fatherSonIndex=0
obj='Insert
pag=7
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
'IDREG
]
rd_kvar=[
'_oldidb
'beneficfrz->CPROWNUM
'beneficfrz->CODSOG
'beneficfrz->TIPOFILE
'beneficfrz->NUMCOL
'beneficfrz->LEGAME
'beneficfrz->RAPCOL
'beneficfrz->UCODE
'beneficfrz->IDBASE
'beneficfrz->C_RAG
'beneficfrz->C_STA
'beneficfrz->C_CTA
'beneficfrz->C_CAB
'beneficfrz->C_PRV
'beneficfrz->C_IND
'beneficfrz->C_CAP
'beneficfrz->C_RAPPORTO
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=7
prev=O1619
sel_field='*
sel_name='clientifrz
sel_where='clientifrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mlientifrz
father=O1621
fatherSonIndex=0
obj='Insert
pag=7
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'clientifrz->CODSOG
'clientifrz->LEGAME
'clientifrz->IDBASE
'clientifrz->NUMCOL
'clientifrz->TIPOFILE
'clientifrz->RAPCOL
'clientifrz->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=7
prev=O1618
sel_field='*
sel_name='sogopefbo
sel_where='sogopefbo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mogopefbo
father=O1619
fatherSonIndex=0
obj='Insert
pag=7
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'sogopefbo->CPROWNUM
'sogopefbo->CODSOG
'sogopefbo->LEGAME
'sogopefbo->IDBASE
'sogopefbo->NUMCOL
'sogopefbo->TIPOFILE
'sogopefbo->RAPCOL
'sogopefbo->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=7
prev=O1617
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'fraziobo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
'FLAGRAP2
]
wr_op=[
'=
'=
'=
]
wr_var=[
''3'
'Date()
'_flagrap2
]
I
obj='Var
pag=7
prev=O1616
var_op='asgn
I
obj='Var
pag=7
prev=O1615
var_op='asgn
I
obj='Var
pag=7
prev=O1614
var_op='asgn
I
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=7
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1497
fatherSonIndex=1
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPVarDecl
frm_calc=''*Y'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Operazione da modificare non presente in AUI |"
len=10
name='_listerr
obj='Var
obj_type='M
pag=7
prev=O1661
var_op='asgn
I
obj='Var
pag=7
prev=O1660
var_op='asgn
I
obj='Var
obj_type='N
pag=7
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=7
prev=O1492
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1494
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=7
sel_field='fraziobo->IDBASE
sel_name='fraziobo
sel_where='fraziobo->MTCN=Left(LRTrim(_uniquecode),10) and (fraziobo->STATOREG='0' or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1666
fatherSonIndex=0
frm_calc='fraziobo->IDBASE
len=10
name='_idbase
next=Icpitembatch.CPVarDecl
frm_calc=''F'
len=1
name='_tdest
obj='Var
pag=7
prev=O1670
var_op='asgn
I
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=7
prev=O1491
sel_field='operazbo->IDBASE
sel_name='operazbo
sel_where='operazbo->MTCN=Left(LRTrim(_uniquecode),10) and (operazbo->STATOREG='0' or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1492
fatherSonIndex=0
frm_calc='operazbo->IDBASE
len=10
name='_idbase
next=Icpitembatch.CPVarDecl
frm_calc=''O'
len=1
name='_tdest
obj='Var
pag=7
prev=O1676
var_op='asgn
I
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=7
var_op='asgn
I
I
]
w=[
150
150
]
x=15
y=15
I
Icpitembatch.CPBeginEnd
comment='Scrive dati operazione
h=[
19
19
]
obj='Begin
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1680
fatherSonIndex=0
frm_calc='''
len=16
name='_codrap
next=Icpitembatch.CPIfElse
frm_calc=[
'w_xMAFLGRAP='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_xMAFLGASR='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_destfin='O'
'w_destfin='F'
]
h=[
19
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Crea Operazione Extraconto se necessario
h=[
19
19
]
obj='Begin
pag=8
prev=O1691
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1694
fatherSonIndex=0
frm_calc=[
'w_tipodest='D'
]
h=[
19
19
]
obj='If
pag=8
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1698
fatherSonIndex=0
frm_calc='Str(Year(_datope),4,0)
len=4
name='_anno
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_idbase
next=Icpitembatch.CPRead
arch='opextrbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_idbase)
]
h=[
19
19
]
obj='If
pag=8
prev=O1705
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1706
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PROGOPEX\'"+LRTrim(gAzienda)+"'",0,10)
len=10
name='_id
next=Icpitembatch.CPInsert
arch='opextrbo
obj='Insert
pag=8
prev=O1711
rd_kfield=[
'COLLEG
'ANNO
'IDBASE
'DATAOPE
'NOTE
'PROGOPEX
'COINT
'RAPPORTO
]
rd_kvar=[
'_codfis
'_anno
'LibreriaMit.UniqueId()
'_datope
''Generato da  MTCN: '+ _uniquecode
'_id
''2'
'_anno+"_"+LRTrim(_codfis)
]
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
prev=O1704
rd_field=[
'IDBASE
]
rd_kfield=[
'COLLEG
'ANNO
]
rd_kvar=[
'_codfis
'_anno
]
rd_var=[
'_idbase
]
I
obj='Var
pag=8
prev=O1703
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=8
prev=O1688
sons=[
Icpitembatch.CPItemSon
comment='Se destinazione operazioni
instr=Icpitembatch.CPVarDecl
father=O1691
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
prev=O1724
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1725
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PPOPER1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPInsert
arch='xperazbo
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xocopebo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_tiperr))
]
h=[
19
19
]
obj='If
pag=8
prev=O1734
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1736
fatherSonIndex=0
frm_calc=''+0'
len=2
name='_tiperr
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=8
prev=O1732
rd_kfield=[
'NUMPROG
'CONNESCLI
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DATAVALI
'DOMICILIO
'DESCCIT
'PROVINCIA
'CAP
'IDFILE
]
rd_kvar=[
'cOpeProg2
'Left(_connes,16)
'Left(_doctype,2)
'Left(_numdoc,15)
'_docril
'Left(_autril,30)
'_docsca
'Left(_via,35)
'Left(_citta,30)
'Left(_prov,2)
'Left(_cap,5)
'_idfile
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1734
fatherSonIndex=0
frm_calc='gMsgProc +"XOCOPEBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN " + _uniquecode + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='-1
len=1
name='_esito
obj='Var
obj_type='N
pag=8
prev=O1749
var_op='asgn
I
obj='Exec
pag=8
prev=O1748
I
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O1747
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Insert
pag=8
prev=O1731
rd_kfield=[
'ANNOOPE
'C_RAG
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'CONNESCLI
'CONNESDOC
'DATAOPE
'DATAREG
'DESCCIT
'FLAGRAP
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'IDBASE
'IDEREG
'IDFILE
'MTCN
'NUMPROG
'OPRAP
'PRGIMPOPE
'PROVINCIA
'RAPPORTO
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
]
rd_kvar=[
'Year(_datope)
'Left(LRTrim(_cognomecp)+" "+LRTrim(_nomecp),70)
'_uifdest
'1
'DateToChar(_datope)
'DateToChar(_datope)
'DateToChar(Date())
'_codana
'_intercab
'_coddip
'_intercod
'_codsin
'_codfis
'LRTrim(w_codmage)+"_"+_codfis+"_"+LRTrim(_doctype)+"_"+Left(_numdoc,15)
'_datope
'Date()
'Left(_intercit,30)
'iif(Empty(_codrap),'','0')
'iif(w_xMAFLGBON='S','0','1')
''0'
''3'
'cOpeProg1
'DateToChar(_datope)+cOpeProg2+"X"
'_idfile
'_uniquecode
'cOpeProg2
''1'
'nProgImp
'_interprv
'_codrap
'_uniquecode
'_segno
''0'
''1'
''0'
'_tipope
'iif(w_xMAFLGBON='S',0,_importo)
'_importo
'_uniquecode
''242'
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1732
fatherSonIndex=0
frm_calc='gMsgProc +"XPERAZBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='-1
len=1
name='_esito
obj='Var
obj_type='N
pag=8
prev=O1758
var_op='asgn
I
obj='Exec
pag=8
prev=O1757
I
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O1756
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=8
prev=O1730
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1725
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("POPERAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPInsert
arch='operazbo
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='docopebo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_tiperr))
]
h=[
19
19
]
obj='If
pag=8
prev=O1766
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1768
fatherSonIndex=0
frm_calc=''+0'
len=2
name='_tiperr
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=8
prev=O1764
rd_kfield=[
'NUMPROG
'CONNESCLI
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DATAVALI
'DOMICILIO
'DESCCIT
'PROVINCIA
'CAP
'IDFILE
]
rd_kvar=[
'cOpeProg2
'Left(_connes,16)
'Left(_doctype,2)
'Left(_numdoc,15)
'_docril
'Left(_autril,30)
'_docsca
'Left(_via,35)
'Left(_citta,30)
'Left(_prov,2)
'Left(_cap,5)
'_idfile
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1766
fatherSonIndex=0
frm_calc='gMsgProc +"DOCOPEBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='-1
len=1
name='_esito
obj='Var
obj_type='N
pag=8
prev=O1781
var_op='asgn
I
obj='Exec
pag=8
prev=O1780
I
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O1779
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Insert
pag=8
prev=O1763
rd_kfield=[
'ANNOOPE
'C_RAG
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'CONNESCLI
'CONNESDOC
'DATAOPE
'DATAREG
'DESCCIT
'FLAGRAP
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'IDBASE
'IDEREG
'IDFILE
'MTCN
'NUMPROG
'OPRAP
'PRGIMPOPE
'PROVINCIA
'RAPPORTO
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
]
rd_kvar=[
'Year(_datope)
'Left(LRTrim(_cognomecp)+" "+LRTrim(_nomecp),70)
'_uifdest
'1
'DateToChar(_datope)
'DateToChar(_datope)
'DateToChar(Date())
'_codana
'_intercab
'_coddip
'_intercod
'_codsin
'_codfis
'LRTrim(w_codmage)+"_"+_codfis+"_"+LRTrim(_doctype)+"_"+Left(_numdoc,15)
'_datope
'Date()
'Left(_intercit,30)
'iif(Empty(_codrap),'','0')
'iif(w_xMAFLGBON='S','0','1')
''0'
''3'
'cOpeProg1
'DateToChar(_datope)+cOpeProg2+"X"
'_idfile
'_uniquecode
'cOpeProg2
''1'
'nProgImp
'_interprv
'_codrap
'_uniquecode
'_segno
''0'
''1'
''0'
'_tipope
'iif(w_xMAFLGBON='S',0,_importo*100)
'_importo*100
'_uniquecode
''242'
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1764
fatherSonIndex=0
frm_calc='gMsgProc +"OPERAZBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='-1
len=1
name='_esito
obj='Var
obj_type='N
pag=8
prev=O1790
var_op='asgn
I
obj='Exec
pag=8
prev=O1789
I
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O1788
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=8
prev=O1762
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
collapsed=True
comment='Se destinazione frazionate
instr=Icpitembatch.CPVarDecl
father=O1691
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=8
prev=O1795
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1796
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PPFRAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPFRAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPInsert
arch='xraziobo
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xocfrabo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_tiperr))
]
h=[
19
19
]
obj='If
pag=8
prev=O1805
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1807
fatherSonIndex=0
frm_calc=''+0'
len=2
name='_tiperr
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=8
prev=O1803
rd_kfield=[
'NUMPROG
'CONNESCLI
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DATAVALI
'DOMICILIO
'DESCCIT
'PROVINCIA
'CAP
'IDFILE
]
rd_kvar=[
'cOpeProg2
'Left(_connes,16)
'Left(_doctype,2)
'Left(_numdoc,15)
'_docril
'Left(_autril,30)
'_docsca
'Left(_via,35)
'Left(_citta,30)
'Left(_prov,2)
'Left(_cap,5)
'_idfile
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1805
fatherSonIndex=0
frm_calc='gMsgProc +"XOCFRABO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN " + _uniquecode + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='-1
len=1
name='_esito
obj='Var
obj_type='N
pag=8
prev=O1820
var_op='asgn
I
obj='Exec
pag=8
prev=O1819
I
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O1818
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Insert
pag=8
prev=O1802
rd_kfield=[
'ANNOOPE
'C_RAG
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'CONNESCLI
'CONNESDOC
'DATAOPE
'DATAREG
'DESCCIT
'FLAGRAP
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'IDBASE
'IDEREG
'IDFILE
'MTCN
'NUMPROG
'OPRAP
'PRGIMPFRZ
'PROVINCIA
'RAPPORTO
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
]
rd_kvar=[
'Year(_datope)
'Left(LRTrim(_cognomecp)+" "+LRTrim(_nomecp),70)
'_uifdest
'1
'DateToChar(_datope)
'DateToChar(_datope)
'DateToChar(Date())
'_codana
'_intercab
'_coddip
'_intercod
'_codsin
'_codfis
'LRTrim(w_codmage)+"_"+_codfis+"_"+LRTrim(_doctype)+"_"+Left(_numdoc,15)
'_datope
'Date()
'Left(_intercit,30)
'iif(Empty(_codrap),'','0')
'iif(w_xMAFLGBON='S','0','1')
''0'
''3'
'cOpeProg1
'DateToChar(_datope)+cOpeProg2+"X"
'_idfile
'_uniquecode
'cOpeProg2
''1'
'nProgImp
'_interprv
'_codrap
'_uniquecode
'_segno
''0'
''1'
''0'
'_tipope
'iif(w_xMAFLGBON='S',0,_importo*100)
'_importo*100
'_uniquecode
''242'
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1803
fatherSonIndex=0
frm_calc='gMsgProc +"XRAZIOBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='-1
len=1
name='_esito
obj='Var
obj_type='N
pag=8
prev=O1829
var_op='asgn
I
obj='Exec
pag=8
prev=O1828
I
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O1827
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=8
prev=O1801
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1796
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PFRAZIO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPInsert
arch='fraziobo
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='docfrabo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_tiperr))
]
h=[
19
19
]
obj='If
pag=8
prev=O1837
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1839
fatherSonIndex=0
frm_calc=''+0'
len=2
name='_tiperr
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=8
prev=O1835
rd_kfield=[
'NUMPROG
'CONNESCLI
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DATAVALI
'DOMICILIO
'DESCCIT
'PROVINCIA
'CAP
'IDFILE
]
rd_kvar=[
'cOpeProg2
'Left(_connes,16)
'Left(_doctype,2)
'Left(_numdoc,15)
'_docril
'Left(_autril,30)
'_docsca
'Left(_via,35)
'Left(_citta,30)
'Left(_prov,2)
'Left(_cap,5)
'_idfile
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1837
fatherSonIndex=0
frm_calc='gMsgProc +"DOCFRABO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='-1
len=1
name='_esito
obj='Var
obj_type='N
pag=8
prev=O1852
var_op='asgn
I
obj='Exec
pag=8
prev=O1851
I
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O1850
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Insert
pag=8
prev=O1834
rd_kfield=[
'ANNOOPE
'C_RAG
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODDIPE
'CODINTER
'CODVOC
'CONNESCLI
'CONNESDOC
'DATAOPE
'DATAREG
'DESCCIT
'FLAGRAP
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'IDBASE
'IDEREG
'IDFILE
'MTCN
'NUMPROG
'OPRAP
'PRGIMPFRZ
'PROVINCIA
'RAPPORTO
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'TIPOLEG
]
rd_kvar=[
'Year(_datope)
'Left(LRTrim(_cognomecp)+" "+LRTrim(_nomecp),70)
'_uifdest
'1
'DateToChar(_datope)
'DateToChar(_datope)
'DateToChar(Date())
'_codana
'_intercab
'_coddip
'_intercod
'_codsin
'_codfis
'LRTrim(w_codmage)+"_"+_codfis+"_"+LRTrim(_doctype)+"_"+Left(_numdoc,15)
'_datope
'Date()
'Left(_intercit,30)
'iif(Empty(_codrap),'','0')
'iif(w_xMAFLGBON='S','0','1')
''0'
''3'
'cOpeProg1
'DateToChar(_datope)+cOpeProg2+"X"
'_idfile
'_uniquecode
'cOpeProg2
''1'
'nProgImp
'_interprv
'_codrap
'_uniquecode
'_segno
''0'
''1'
'_tipope
'iif(w_xMAFLGBON='S',0,_importo*100)
'_importo*100
'_uniquecode
''242'
''0'
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1835
fatherSonIndex=0
frm_calc='gMsgProc +"FRAZIOBO - Rilevati errori nel file "+LRTrim(nomefileimport)+" per l'operazione MTCN "+_uniquecode+NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc +"Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='-1
len=1
name='_esito
obj='Var
obj_type='N
pag=8
prev=O1860
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
prev=O1859
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=8
prev=O1833
var_op='asgn
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=8
prev=O1685
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1688
fatherSonIndex=0
frm_calc='_codfis
len=16
name='_codrap
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=8
prev=O1684
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O1685
fatherSonIndex=0
frm_calc='4
obj='Exec
pag=8
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
x=10
y=20
I
Icpitembatch.CPRemark
frm_calc='Formato Excel
next=Icpitembatch.CPVarDecl
frm_calc='"Errori_TRX_"+DateToChar(Date())+".xlsx"
len=50
name='_filen
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/export/"+LRTrim(gAzienda)+"/"+LRTrim(_filen)
len=50
name='_nfile
next=Icpitembatch.CPRemark
frm_calc='Seleziona i record
next=Icpitembatch.CPBeginEnd
comment='Creo file per risultati
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Crea la prima riga
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Creo le righe
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Creazione file excel
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='tmp_listafile
obj='Insert
pag=9
prev=O1884
rd_kfield=[
'nomefile
'priorita
'hyperlynk
]
rd_kvar=[
'LRTrim(_filen)
'1
'LRTrim(gUrlApp)+"export/"+LRTrim(gAzienda)+"/"+LRTrim(_filen)
]
I
obj='Begin
pag=9
prev=O1882
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O1884
fatherSonIndex=0
frm_calc=''Attendere. Creazione del file excel ...'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPExec
check='man
frm_calc='//Ridimensiono le colonne in base al contenuto﷯sheet.trackAllColumnsForAutoSizing() ;﷯sheet.autoSizeColumn(0);﷯sheet.autoSizeColumn(1);﷯sheet.autoSizeColumn(2);﷯sheet.autoSizeColumn(3);﷯sheet.autoSizeColumn(4);﷯sheet.autoSizeColumn(5);﷯sheet.autoSizeColumn(6);﷯sheet.autoSizeColumn(7);﷯sheet.autoSizeColumn(8);﷯sheet.autoSizeColumn(9);﷯sheet.autoSizeColumn(10);﷯sheet.autoSizeColumn(11);﷯sheet.autoSizeColumn(12);﷯sheet.autoSizeColumn(13);﷯sheet.autoSizeColumn(14);﷯sheet.autoSizeColumn(15);﷯sheet.autoSizeColumn(16);﷯sheet.autoSizeColumn(17);﷯sheet.autoSizeColumn(18);﷯sheet.autoSizeColumn(19);﷯sheet.autoSizeColumn(20);﷯sheet.autoSizeColumn(21);﷯sheet.autoSizeColumn(22);﷯sheet.autoSizeColumn(23);﷯sheet.autoSizeColumn(24);﷯sheet.autoSizeColumn(25);﷯sheet.autoSizeColumn(26);﷯sheet.autoSizeColumn(27);﷯sheet.autoSizeColumn(28);﷯sheet.autoSizeColumn(29);﷯sheet.autoSizeColumn(30);﷯sheet.autoSizeColumn(31);﷯sheet.autoSizeColumn(32);﷯sheet.autoSizeColumn(33);﷯sheet.autoSizeColumn(34);﷯sheet.autoSizeColumn(35);﷯sheet.autoSizeColumn(36);
next=Icpitembatch.CPExec
check='man
frm_calc='// scrivo il file di esito﷯FileOutputStream fileOut = new FileOutputStream(CPLib.LRTrim(_nfile));﷯//write this workbook to an Outputstream.﷯wb.write(fileOut);﷯fileOut.flush();﷯fileOut.close();
obj='Exec
pag=9
prev=O1892
I
obj='Exec
pag=9
prev=O1891
I
nonlocal=True
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=9
prev=O1880
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O1882
fatherSonIndex=0
for_variable='rowErrate
for_variable_type='mcErrateDef.MCRDef
h=[
19
19
]
iterator_expr='mcErrate
obj='ForEach
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1897
fatherSonIndex=0
frm_calc='// Scrive la riga﷯row = sheet.createRow(r);﷯cell = row.createCell(0);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna01));﷯cell = row.createCell(1);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna02));﷯cell = row.createCell(2);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna03));﷯cell = row.createCell(3);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna04));﷯cell = row.createCell(4);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna05));﷯cell = row.createCell(5);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna06));﷯cell = row.createCell(6);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna07));﷯cell = row.createCell(7);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna08));﷯cell = row.createCell(8);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna09));﷯cell = row.createCell(9);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna10));﷯cell = row.createCell(10);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna11));﷯cell = row.createCell(11);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna12));﷯cell = row.createCell(12);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna13));﷯cell = row.createCell(13);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna14));﷯cell = row.createCell(14);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna15));﷯cell = row.createCell(15);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna16));﷯cell = row.createCell(16);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna17));﷯cell = row.createCell(17);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna18));﷯cell = row.createCell(18);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna19));﷯cell = row.createCell(19);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna20));﷯cell = row.createCell(20);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna21));﷯cell = row.createCell(21);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna22));﷯cell = row.createCell(22);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna23));﷯cell = row.createCell(23);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna24));﷯cell = row.createCell(24);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna25));﷯cell = row.createCell(25);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna26));﷯cell = row.createCell(26);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna27));﷯cell = row.createCell(27);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna28));﷯cell = row.createCell(28);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna29));﷯cell = row.createCell(29);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna30));﷯cell = row.createCell(30);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna31));﷯cell = row.createCell(31);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna32));﷯cell = row.createCell(32);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna33));﷯cell = row.createCell(33);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna34));﷯cell = row.createCell(34);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna35));﷯cell = row.createCell(35);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna36));﷯cell = row.createCell(36);﷯cell.setCellValue(CPLib.LRTrim("N"));﷯r++;
obj='Exec
pag=9
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=9
prev=O1878
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1880
fatherSonIndex=0
frm_calc='//Azzero i contatori di fogli letti e righe scritte﷯_i = 0;﷯r=0;﷯//Creo il record da scrivere﷯row = sheet.createRow(r);﷯cell =  row.createCell(0);﷯cell.setCellValue("NDG");﷯cell.setCellStyle(cs);﷯cell =  row.createCell(1);﷯cell.setCellValue("COGNOME");﷯cell.setCellStyle(cs);﷯cell = row.createCell(2);﷯cell.setCellValue("NOME");﷯cell.setCellStyle(cs);﷯cell = row.createCell(3);﷯cell.setCellValue("INDIRIZZO");﷯cell.setCellStyle(cs);﷯cell =  row.createCell(4);﷯cell.setCellValue("FLAG CODICE FISCALE");﷯cell.setCellStyle(cs);﷯cell =  row.createCell(5);﷯cell.setCellValue("CODICE FISCALE");﷯cell.setCellStyle(cs);﷯cell =  row.createCell(6);﷯cell.setCellValue("LUOGO DI NASCITA");﷯cell.setCellStyle(cs);﷯cell =  row.createCell(7);﷯cell.setCellValue("NUM. DOCUMENTO");﷯cell.setCellStyle(cs);﷯cell =  row.createCell(8);﷯cell.setCellValue("DATA SCADENZA");﷯cell.setCellStyle(cs);﷯cell = row.createCell(9);﷯cell.setCellValue("DATA RILASCIO");﷯cell.setCellStyle(cs);﷯cell = row.createCell(10);﷯cell.setCellValue("AUTORITA' RILASCIO");﷯cell.setCellStyle(cs);﷯cell = row.createCell(11);﷯cell.setCellValue("CITTA' DI RESIDENZA");﷯cell.setCellStyle(cs);﷯cell = row.createCell(12);﷯cell.setCellValue("TIPO DOCUMENTO");﷯cell.setCellStyle(cs);﷯cell = row.createCell(13);﷯cell.setCellValue("DATA OPERAZIONE");﷯cell.setCellStyle(cs);﷯cell = row.createCell(14);﷯cell.setCellValue("VALUTA");﷯cell.setCellStyle(cs);﷯cell = row.createCell(15);﷯cell.setCellValue("FLAG CONTANTI");﷯cell.setCellStyle(cs);﷯cell = row.createCell(16);﷯cell.setCellValue("TIPO TRANSAZIONE");﷯cell.setCellStyle(cs);﷯cell = row.createCell(17);﷯cell.setCellValue("IMPORTO TRX");﷯cell.setCellStyle(cs);﷯cell = row.createCell(18);﷯cell.setCellValue("CONTANTI TRX");﷯cell.setCellStyle(cs);﷯cell = row.createCell(19);﷯cell.setCellValue("UNIQUE ID TRX");﷯cell.setCellStyle(cs);﷯cell = row.createCell(20);﷯cell.setCellValue("CODICE AGENZIA");﷯cell.setCellStyle(cs);﷯cell = row.createCell(21);﷯cell.setCellValue("PCID");﷯cell.setCellStyle(cs);﷯cell = row.createCell(22);﷯cell.setCellValue("CODICE OPERATORE");﷯cell.setCellStyle(cs);﷯cell = row.createCell(23);﷯cell.setCellValue("CITTA' AGENZIA");﷯cell.setCellStyle(cs);﷯cell = row.createCell(24);﷯cell.setCellValue("NOME AGENZIA");﷯cell.setCellStyle(cs);﷯cell = row.createCell(25);﷯cell.setCellValue("COGNOME CONTROPARTE");﷯cell.setCellStyle(cs);﷯cell = row.createCell(26);﷯cell.setCellValue("NOME CONTROPARTE");﷯cell.setCellStyle(cs);﷯cell = row.createCell(27);﷯cell.setCellValue("STATO CONTROPARTE");﷯cell.setCellStyle(cs);﷯cell = row.createCell(28);﷯cell.setCellValue("CITTA' DEST. CONTROPARTE");﷯cell.setCellStyle(cs);﷯cell = row.createCell(29);﷯cell.setCellValue("MTCN");﷯cell.setCellStyle(cs);﷯cell = row.createCell(30);﷯cell.setCellValue("PAESE RESIDENZA CLIENTE");﷯cell.setCellStyle(cs);﷯cell = row.createCell(31);﷯cell.setCellValue("DATA DI NASCITA");﷯cell.setCellStyle(cs);﷯cell = row.createCell(32);﷯cell.setCellValue("SESSO");﷯cell.setCellStyle(cs);﷯cell = row.createCell(33);﷯cell.setCellValue("CODICE CATASTALE");﷯cell.setCellStyle(cs);﷯cell = row.createCell(34);﷯cell.setCellValue("MACROAGENTE");﷯cell.setCellStyle(cs);﷯cell = row.createCell(35);﷯cell.setCellValue("ERRORI RILEVATI");﷯cell.setCellStyle(cs);﷯cell = row.createCell(36);﷯cell.setCellValue("OPERAZIONE CORRETTA");﷯cell.setCellStyle(cs);﷯r++;
obj='Exec
pag=9
I
I
]
w=[
150
150
]
I
obj='Begin
pag=9
prev=O1877
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1878
fatherSonIndex=0
frm_calc='// creo il contenitore dei fogli﷯wb = new SXSSFWorkbook();﷯sheet = (SXSSFSheet) wb.createSheet("Foglio1") ;﷯CellStyle cs = wb.createCellStyle();﷯cs.setFillForegroundColor(IndexedColors.LIME.getIndex());﷯cs.setFillPattern(FillPatternType.SOLID_FOREGROUND);﷯Font f = wb.createFont();﷯f.setBold(true);﷯f.setFontHeightInPoints((short) 11);﷯cs.setFont(f);﷯
obj='Exec
pag=9
I
I
]
w=[
150
150
]
I
obj='Remark
pag=9
prev=O1876
I
obj='Var
pag=9
prev=O1875
var_op='asgn
I
obj='Var
pag=9
prev=O1874
var_op='asgn
I
obj='Remark
pag=9
x=11
y=20
I
Icpitembatch.CPRemark
frm_calc='Formato Excel
next=Icpitembatch.CPVarDecl
frm_calc='"Errori_Location_"+DateToChar(Date())+".xlsx"
len=50
name='_filen
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(gPathApp)+"/export/"+LRTrim(gAzienda)+"/"+LRTrim(_filen)
len=50
name='_nfile
next=Icpitembatch.CPRemark
frm_calc='Seleziona i record
next=Icpitembatch.CPBeginEnd
comment='Creo file per risultati
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Crea la prima riga
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Creo le righe
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Creazione file excel
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='tmp_listafile
obj='Insert
pag=10
prev=O1922
rd_kfield=[
'nomefile
'priorita
'hyperlynk
]
rd_kvar=[
'LRTrim(_filen)
'2
'LRTrim(gUrlApp)+"export/"+LRTrim(gAzienda)+"/"+LRTrim(_filen)
]
I
obj='Begin
pag=10
prev=O1920
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O1922
fatherSonIndex=0
frm_calc=''Attendere. Creazione del file excel ...'
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPExec
check='man
frm_calc='//Ridimensiono le colonne in base al contenuto﷯sheet.trackAllColumnsForAutoSizing() ;﷯sheet.autoSizeColumn(0);﷯sheet.autoSizeColumn(1);﷯sheet.autoSizeColumn(2);﷯sheet.autoSizeColumn(3);﷯sheet.autoSizeColumn(4);﷯sheet.autoSizeColumn(5);﷯sheet.autoSizeColumn(6);﷯sheet.autoSizeColumn(7);﷯sheet.autoSizeColumn(8);﷯sheet.autoSizeColumn(9);
next=Icpitembatch.CPExec
check='man
frm_calc='// scrivo il file di esito﷯FileOutputStream fileOut = new FileOutputStream(CPLib.LRTrim(_nfile));﷯//write this workbook to an Outputstream.﷯wb.write(fileOut);﷯fileOut.flush();﷯fileOut.close();
obj='Exec
pag=10
prev=O1930
I
obj='Exec
pag=10
prev=O1929
I
nonlocal=True
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=10
prev=O1918
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O1920
fatherSonIndex=0
for_variable='rowErrate
for_variable_type='mcErrateDef.MCRDef
h=[
19
19
]
iterator_expr='mcErrAge
obj='ForEach
orderby_expr='colonna01
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1935
fatherSonIndex=0
frm_calc='// Scrive la riga﷯row = sheet.createRow(r);﷯cell = row.createCell(0);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna01));﷯cell = row.createCell(1);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna02));﷯cell = row.createCell(2);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna03));﷯cell = row.createCell(3);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna04));﷯cell = row.createCell(4);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna05));﷯cell = row.createCell(5);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna06));﷯cell = row.createCell(6);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna07));﷯cell = row.createCell(7);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna08));﷯cell = row.createCell(8);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna09));﷯cell = row.createCell(9);﷯cell.setCellValue(CPLib.LRTrim(rowErrate.colonna10));﷯r++;
obj='Exec
pag=10
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=10
prev=O1916
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1918
fatherSonIndex=0
frm_calc='//Azzero i contatori di fogli letti e righe scritte﷯_i = 0;﷯r=0;﷯//Creo il record da scrivere﷯row = sheet.createRow(r);﷯cell =  row.createCell(0);﷯cell.setCellValue("Agency Account code");﷯cell.setCellStyle(cs);﷯cell =  row.createCell(1);﷯cell.setCellValue("Agency Name");﷯cell.setCellStyle(cs);﷯cell = row.createCell(2);﷯cell.setCellValue("Agency Address");﷯cell.setCellStyle(cs);﷯cell = row.createCell(3);﷯cell.setCellValue("Agency City");﷯cell.setCellStyle(cs);﷯cell =  row.createCell(4);﷯cell.setCellValue("Agency Province");﷯cell.setCellStyle(cs);﷯cell =  row.createCell(5);﷯cell.setCellValue("IsSubagent");﷯cell.setCellStyle(cs);﷯cell =  row.createCell(6);﷯cell.setCellValue("Network");﷯cell.setCellStyle(cs);﷯cell =  row.createCell(7);﷯cell.setCellValue("TerminalID");﷯cell.setCellStyle(cs);﷯cell =  row.createCell(8);﷯cell.setCellValue("Telephon number");﷯cell.setCellStyle(cs);﷯cell =  row.createCell(9);﷯cell.setCellValue("Motivo Scarto");﷯cell.setCellStyle(cs);﷯r++;
obj='Exec
pag=10
I
I
]
w=[
150
150
]
I
obj='Begin
pag=10
prev=O1915
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1916
fatherSonIndex=0
frm_calc='// creo il contenitore dei fogli﷯wb = new SXSSFWorkbook();﷯sheet = (SXSSFSheet) wb.createSheet("Foglio1") ;﷯CellStyle cs = wb.createCellStyle();﷯cs.setFillForegroundColor(IndexedColors.LIME.getIndex());﷯cs.setFillPattern(FillPatternType.SOLID_FOREGROUND);﷯Font f = wb.createFont();﷯f.setBold(true);﷯f.setFontHeightInPoints((short) 11);﷯cs.setFont(f);
obj='Exec
pag=10
I
I
]
w=[
150
150
]
I
obj='Remark
pag=10
prev=O1914
I
obj='Var
pag=10
prev=O1913
var_op='asgn
I
obj='Var
pag=10
prev=O1912
var_op='asgn
I
obj='Remark
pag=10
x=11
y=18
I
Icpitembatch.CPBeginEnd
comment='Verifica se operazione già caricata
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_idb)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1950
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Verifica dipendenza
father=O1952
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Verifica dati anagrafici
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Verifica eventuale esistenza rapporto
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Controlla dati cliente
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Controlla dati contoparte
h=[
19
19
]
obj='Begin
pag=5
prev=O1963
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1965
fatherSonIndex=0
frm_calc=[
'Empty(_cognomecp)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_nomecp)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_uifdest)
]
h=[
19
19
]
obj='If
pag=5
prev=O1972
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1975
fatherSonIndex=0
frm_calc=''*P'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Manca stato destinazione |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O1981
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O1980
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1969
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1972
fatherSonIndex=0
frm_calc=''*P'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Manca nome conroparte |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O1987
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O1986
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1969
fatherSonIndex=0
frm_calc=''*P'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Manca cognome conroparte |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O1993
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O1992
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
prev=O1961
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1963
fatherSonIndex=0
frm_calc='0
len=1
name='_errore
next=Icpitembatch.CPVarDecl
frm_calc='''
len=100
name='_merr
next=Icpitembatch.CPIfElse
frm_calc=[
'_nocf=1
'_nocf=0
]
h=[
19
19
19
]
obj='If
pag=5
prev=O2000
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2001
fatherSonIndex=0
frm_calc='_codfis
len=20
name='_oldcodfis
next=Icpitembatch.CPIfElse
frm_calc=[
'(Empty(_nasstato) and Empty(_nascitta)) or Empty(_nasdata) or Empty(_cognome) or Empty(_nome) or Empty(_sesso)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O2006
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2007
fatherSonIndex=0
frm_calc='_listerr + "* Mancanza dati per calcolo codice fiscale fittizio |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O2012
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='variabili per il calcolo del codice fiscale
father=O2007
fatherSonIndex=1
h=[
19
19
]
next=Icpitembatch.CPExec
check='bat
frm_calc='arrt_calccodfis_wu
next=Icpitembatch.CPVarDecl
frm_calc='w_CODFISC
len=16
name='_codfis
obj='Var
pag=5
prev=O2017
var_op='asgn
I
obj='Exec
pag=5
prev=O2015
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Codice Fiscale
father=O2015
fatherSonIndex=0
frm_calc='''
len=16
name='w_CODFISC
next=Icpitembatch.CPVarDecl
comment='Data Nascita
frm_calc='_nasdata
len=8
name='w_DATANASC
next=Icpitembatch.CPVarDecl
comment='Luogo di Nascita
frm_calc='_nascitta
len=30
name='w_NASCOMUN
next=Icpitembatch.CPVarDecl
comment='Stato di nascita
frm_calc='_nasstato
len=30
name='w_NASSTATO
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
frm_calc='_cognome
len=26
name='w_COGNOME
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
frm_calc='LRTrim(_cognome)+" "+LRTrim(_nome)
len=70
name='w_RAGSOC
next=Icpitembatch.CPVarDecl
comment='Ragione Sociale
frm_calc='_nome
len=25
name='w_NOME
next=Icpitembatch.CPVarDecl
comment='Sesso
frm_calc='iif(_sesso='M','1',iif(_sesso='F','2',''))
len=1
name='w_SESSO
obj='Var
pag=5
prev=O2027
var_op='asgn
I
obj='Var
pag=5
prev=O2026
var_op='asgn
I
obj='Var
pag=5
prev=O2025
var_op='asgn
I
obj='Var
pag=5
prev=O2024
var_op='asgn
I
obj='Var
pag=5
prev=O2023
var_op='asgn
I
obj='Var
pag=5
prev=O2022
var_op='asgn
I
obj='Var
obj_type='D
pag=5
prev=O2021
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2001
fatherSonIndex=1
frm_calc=[
'Empty(_codfis)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2032
fatherSonIndex=0
frm_calc='_listerr + "* Codice Fiscale Non Presente |"
len=10
name='_listerr
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2032
fatherSonIndex=1
frm_calc=[
'not(arfn_chkcodfis(_codfis,'000',_nocf))
]
h=[
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2039
fatherSonIndex=0
frm_calc='_listerr + "* Codice Fiscale Originale - Codice Fiscale non valido |"
len=10
name='_listerr
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=5
prev=O1999
var_op='asgn
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
prev=O1959
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1961
fatherSonIndex=0
frm_calc=[
'w_xMAFLGCKR='S'
]
h=[
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2051
fatherSonIndex=0
frm_calc=[
'Len(LRTrim(_codfis))=16
]
h=[
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2056
fatherSonIndex=0
frm_calc='''
len=25
name='_rapporto
next=Icpitembatch.CPRead
arch='anarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_rapporto))
]
h=[
19
19
]
obj='If
pag=5
prev=O2062
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2063
fatherSonIndex=0
frm_calc=''*1'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Rapporto non esistente |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O2069
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O2068
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O2061
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'LRTrim(_codfis)
]
rd_var=[
'_rapporto
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
prev=O1957
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1959
fatherSonIndex=0
frm_calc=[
'Year(_datope) < 1900
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_nasdata)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_doctype)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_docril)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_docsca)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_numdoc)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_autril)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_sesso)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_nasstato) and Empty(_nascitta)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_codstares)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_codcit) and _codstares='086'
]
h=[
19
19
]
obj='If
pag=5
prev=O2108
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2111
fatherSonIndex=0
frm_calc='_listerr + "* Manca la città di residenza |"
len=10
name='_listerr
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O2105
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2108
fatherSonIndex=0
frm_calc='_listerr + "* Manca lo stato di residenza |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_id
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_id + 1
len=10
name='_id
next=Icpitembatch.CPInsert
arch='DecodeStati
obj='Insert
pag=5
prev=O2124
rd_kfield=[
'id
'account
]
rd_kvar=[
'_id
'_paese
]
I
obj='Var
obj_type='N
pag=5
prev=O2122
var_op='asgn
I
obj='Select
pag=5
prev=O2121
sel_name='qbe_maxstati
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2122
fatherSonIndex=0
frm_calc='qbe_maxstati->MAXID
len=10
name='_id
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O2120
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O2102
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2105
fatherSonIndex=0
frm_calc=''*7'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Manca il luogo di nascita |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Manca lo stato di residenza |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_id
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_id + 1
len=10
name='_id
next=Icpitembatch.CPInsert
arch='DecodeStati
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_id
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_id + 1
len=10
name='_id
next=Icpitembatch.CPInsert
arch='DecodeCitta
obj='Insert
pag=5
prev=O2147
rd_kfield=[
'ID
'CITTA
]
rd_kvar=[
'_id
'_luonas
]
I
obj='Var
obj_type='N
pag=5
prev=O2145
var_op='asgn
I
obj='Select
pag=5
prev=O2144
sel_name='qbe_maxcitta
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2145
fatherSonIndex=0
frm_calc='qbe_maxcitta->MAXID
len=10
name='_id
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O2143
var_op='asgn
I
obj='Insert
pag=5
prev=O2142
rd_kfield=[
'id
'account
]
rd_kvar=[
'_id
'_luonas
]
I
obj='Var
obj_type='N
pag=5
prev=O2140
var_op='asgn
I
obj='Select
pag=5
prev=O2139
sel_name='qbe_maxstati
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2140
fatherSonIndex=0
frm_calc='qbe_maxstati->MAXID
len=10
name='_id
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
prev=O2138
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O2137
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O2136
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O2135
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O2099
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2102
fatherSonIndex=0
frm_calc=''*7'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Manca il genere della persona |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O2165
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O2164
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O2096
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2099
fatherSonIndex=0
frm_calc=''*7'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Autorità di rilascio del documento assente |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O2171
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O2170
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O2093
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2096
fatherSonIndex=0
frm_calc=''*7'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* ID (Numero) del documento assente |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O2177
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O2176
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O2090
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2093
fatherSonIndex=0
frm_calc=''*C'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Data di scadenza del documento assente |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O2183
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O2182
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2093
fatherSonIndex=1
frm_calc=[
'Year(_docsca) < 1900
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_datope > _docsca
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_docril > _docsca
]
h=[
19
19
]
obj='If
pag=5
prev=O2189
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2192
fatherSonIndex=0
frm_calc=''*7'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Data di scadenza del documento inferiore alla data di rilascio |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O2198
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O2197
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O2186
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2189
fatherSonIndex=0
frm_calc=''*7'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Data di scadenza del documento inferiore alla data dell'operazione |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O2204
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O2203
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2186
fatherSonIndex=0
frm_calc=''*6'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Data di scadenza del documento errata |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O2210
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O2209
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=5
prev=O2087
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2090
fatherSonIndex=0
frm_calc=''*B'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Data di rilascio del documento assente |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O2217
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O2216
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2090
fatherSonIndex=1
frm_calc=[
'Year(_docril) < 1900
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_docril > _datope
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_docril = _nasdata
]
h=[
19
19
]
obj='If
pag=5
prev=O2223
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2226
fatherSonIndex=0
frm_calc=''*5'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Data di rilascio del documento coincide con la data di nascita |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O2232
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O2231
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O2220
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2223
fatherSonIndex=0
frm_calc=''*5'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Data di rilascio del documento superiore alla data operazione |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O2238
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O2237
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2220
fatherSonIndex=0
frm_calc=''*5'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Data di rilascio del documento errata |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O2244
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O2243
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=5
prev=O2084
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2087
fatherSonIndex=0
frm_calc=''*E'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "*Tipo del documento assente |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O2251
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O2250
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O2081
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2084
fatherSonIndex=0
frm_calc=''*A'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Data di nascita non presente |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O2257
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O2256
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2084
fatherSonIndex=1
frm_calc=[
'Year(_nasdata) < 1900
]
h=[
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2260
fatherSonIndex=0
frm_calc=''*4'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Data di nascita errata |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O2266
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O2265
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2081
fatherSonIndex=0
frm_calc=''*3'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Data operazione non valida |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O2273
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O2272
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1957
fatherSonIndex=0
frm_calc='''
len=5
name='_mage
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_prog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_citdip
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_cabdip
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_provdip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_prog))
'LRTrim(_mage) <> LRTrim(w_codmage)
'Empty(w_codmage)
]
h=[
19
19
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_cabdip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_provdip)
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_citdip)
]
h=[
19
19
]
obj='If
pag=5
prev=O2291
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2294
fatherSonIndex=0
frm_calc=''*1'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Agenzia priva di città |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O2300
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O2299
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O2288
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2291
fatherSonIndex=0
frm_calc=''*1'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Agenzia priva di provincia |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O2306
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O2305
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O2285
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2288
fatherSonIndex=0
frm_calc=''*1'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Agenzia priva di codice CAB |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O2312
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O2311
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O2284
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2285
fatherSonIndex=0
frm_calc=''*1'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Agenzia non ancora censita |" 
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O2318
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O2317
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2285
fatherSonIndex=1
frm_calc=''*2'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Agenzia collegata ad un altro MacroAgente |"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O2322
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O2321
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2285
fatherSonIndex=2
frm_calc=''*D'
len=2
name='_tiperr
next=Icpitembatch.CPVarDecl
frm_calc='_listerr + "* Agenzia non collegata a nessun MacroAgente |" 
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O2326
var_op='asgn
I
obj='Var
obj_type='M
pag=5
prev=O2325
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Read
pag=5
prev=O2283
rd_field=[
'CODDIP
'MACROAGENTE
'DESCCIT
'CAB
'PROVINCIA
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'_coddip
]
rd_var=[
'_prog
'_mage
'_citdip
'_cabdip
'_provdip
]
I
obj='Var
pag=5
prev=O2282
var_op='asgn
I
obj='Var
pag=5
prev=O2281
var_op='asgn
I
obj='Var
pag=5
prev=O2280
var_op='asgn
I
obj='Var
pag=5
prev=O2279
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1952
fatherSonIndex=1
frm_calc='_listerr + "* Operazione già caricata sul sistema"
len=10
name='_listerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
obj='Var
obj_type='N
pag=5
prev=O2335
var_op='asgn
I
obj='Var
obj_type='M
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1950
fatherSonIndex=0
frm_calc='''
len=10
name='_idb
next=Icpitembatch.CPRead
arch='operazbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_idb)
]
h=[
19
19
]
obj='If
pag=5
prev=O2341
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xperazbo
father=O2342
fatherSonIndex=0
obj='Read
pag=5
rd_field=[
'IDBASE
]
rd_kfield=[
'MTCN
'DATAOPE
'SEGNO
]
rd_kvar=[
'_uniquecode
'_datope
'_segno
]
rd_var=[
'_idb
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O2340
rd_field=[
'IDBASE
]
rd_kfield=[
'MTCN
'DATAOPE
'SEGNO
]
rd_kvar=[
'_uniquecode
'_datope
'_segno
]
rd_var=[
'_idb
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
x=23
y=19
I
]
ManualBlocks={
'BO - Header
Icpmanualblocks.CPManualBlocks
code='import java.util.*;﷯import java.util.Iterator;﷯import java.io.File;﷯import java.io.FileReader;﷯import java.io.FileWriter;﷯import com.opencsv.*;﷯import java.util.ArrayList;﷯import java.io.InputStream;﷯import java.io.FileInputStream;﷯import java.io.FileOutputStream;﷯import org.apache.poi.xssf.usermodel.XSSFCell;﷯import org.apache.poi.xssf.usermodel.XSSFRow;﷯import org.apache.poi.xssf.usermodel.XSSFSheet;﷯import org.apache.poi.xssf.usermodel.XSSFWorkbook;﷯import org.apache.poi.xssf.usermodel.XSSFCellStyle;﷯import org.apache.poi.xssf.streaming.SXSSFWorkbook;﷯import org.apache.poi.xssf.streaming.SXSSFSheet;﷯import org.apache.poi.ss.usermodel.*;﷯import org.apache.poi.xssf.streaming.SXSSFCell;﷯import org.apache.poi.xssf.streaming.SXSSFRow;﷯import org.apache.poi.xssf.streaming.SXSSFSheet;﷯import org.apache.poi.xssf.streaming.SXSSFWorkbook;
name='BO - Header
I
'BO - Properties
Icpmanualblocks.CPManualBlocks
code='public int _i;﷯public int _y;﷯public int _righe;﷯public int conta;﷯public int r;﷯String sheetName = "Foglio1";﷯public String[] lista;﷯public String[] campi;﷯public int conteggio;﷯public int i;﷯public int contanome;﷯public int nfogli;﷯public int ncampi;﷯public SXSSFWorkbook wb;﷯public SXSSFSheet sheet;﷯public Row row; ﷯public Cell cell;﷯public CellStyle cs;﷯public Font f;
name='BO - Properties
I
}
comment='Importa i dati (WURSI)
date_creat=#2006-06-20
date_rev=#2021-02-17
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'FileLibMit
'Utilities
'LibreriaMit
]
modcnt=919
page_result_class=[
'
'
'
'
'
'
'
'
'
'
]
page_result_type=[
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
]
page_uid=[
'KVAAPYDNKQ
'UPMTOCCRWP
'QQGHBXZEZK
'IEGTUBANOR
'QTOFUTDVIT
'QSUNBYHISQ
'UNADCYQXQO
'WCEIQJHTLC
'KDPGWSCVNG
'KIBZOZBLHG
]
pagename=[
'Page_1
'Page_2
'Page_3
'Page_4
'Page_5
'Page_6
'Page_7
'Page_8
'Page_9
'Page_10
]
pagenote=[
'
'
'
'
'
'
'
'
'
'
]
pagetitle=[
'Main
'Elabora il file
'Estrazione ZIP
'Crea Rapporti
'Controllo dati
'Agenzie
'Modifica Transazione
'Inserimento Transazione
'File Excel Errori Transazioni
'File Excel Errori Agenzie
]
runtime_filters=2
tpl_name='Routine
work_file=[
'aeoprig
'anadip
'anarapbo
'beneficope
'clientiope
'docfrabo
'docopebo
'fraziobo
'intermbo
'intestbo
'kersonbo
'knarapbo
'meneficope
'merzistiope
'mlientiope
'mogopebo
'mtimperr
'mtimport
'mtstati
'operazbo
'opextrbo
'personbo
'rapopebo
'sogopebo
'tbcauana
'tbcitta
'tbmacage
'tbstati
'terzistiope
'tmp_impwu
'tmp_list_imprich
'wersonbo
'wuchkimp
'wuchkimp_sf
'wucodes
'wurapporti
'xapopebo
'xnarapbo
'xntestbo
'xocfrabo
'xocopebo
'xperazbo
'xraziobo
'sogopefbo
'clientifrz
'beneficfrz
'terzistifrz
'meneficfrz
'merzistifrz
'mlientifrz
'mogopefbo
'DecodeStati
'DecodeCitta
'personbo_agg
'tbcittna
'tbstatna
'tmp_listafile
]
work_filter=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
I
*--*
*----*
