* --- CodePainter Revolution Batch Vers. 5.1
￼Icpbatch.CPBatch
Items=[
Icpitembatch.CPBeginEnd
comment='Variabili del caller
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Dichiarazione Variabili Globali
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc=''Ora Inizio Import: '+ arfn_fdatetime(DateTime()) + ' del file ' + w_nomefile + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'FileLibMit.ExistFile(LRTrim(gPathDoc)+"/appo/"+LRTrim(gAzienda)+"/"+LRTrim(w_nomefile))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Import: '+ arfn_fdatetime(DateTime()) + ' del file ' + w_nomefile + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O12
var_op='asgn
I
obj='If
pag=1
prev=O11
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='data rettifica
father=O12
fatherSonIndex=0
frm_calc='Date()
len=8
name='w_DATARETT
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='// Chiude il file excel e lo cancella﷯//workbook.close();﷯FileLibMit.DeleteFilePath(CPLib.LRTrim(gPathApp)+"/appo/"+CPLib.LRTrim(gAzienda)+"/"+CPLib.LRTrim(w_nomefile));
obj='Exec
pag=1
prev=O20
I
obj='Try
pag=1
prev=O19
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Apro il foglio e verifico quante pagine ha
father=O20
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='_i = 0
next=Icpitembatch.CPVarDecl
frm_calc='Str(Year(Date()) - 10,4,0)
len=4
name='_annoage
next=Icpitembatch.CPWhile
frm_calc='_i < conta
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='workbook.close()
next=Icpitembatch.CPTransaction
frm_calc='commit
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Elaborazione Terminata con successo!'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=1
prev=O32
var_op='asgn
I
obj='Transaction
pag=1
prev=O31
I
obj='Exec
pag=1
prev=O29
I
obj='While
pag=1
prev=O28
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O29
fatherSonIndex=0
frm_calc='_righe = 0;﷯Sheet sheet = workbook.getSheet(_i);﷯_righe = sheet.getRows();﷯_y = 1;
next=Icpitembatch.CPWhile
frm_calc='_y <_righe
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_i++;
obj='Exec
pag=1
prev=O37
I
obj='While
pag=1
prev=O36
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Legge le colonne e scrive i dati nelle variabili appoggio
father=O37
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili per colonne
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column23))) and column23='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column24))) and column24='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column25))) and column25='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column26))) and column26='S'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(column27))) and column27='S'
]
h=[
19
19
]
next=Icpitembatch.CPExec
check='man
frm_calc='_y++;
obj='Exec
pag=1
prev=O58
I
obj='If
pag=1
prev=O55
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O58
fatherSonIndex=0
frm_calc='"Sto eseguendo il blocco dei dati anagrafici del soggetto con codice: " + LRTrim(column04)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + "Sto eseguendo il blocco dei dati anagrafici del soggetto con codice: " + LRTrim(column04) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPMerge
arch='personbo_agg
obj='Merge
pag=1
prev=O65
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(column04)
]
wr_field=[
'CONNES
'FLGANAVAL
]
wr_mode=[
'ins
'ins/upd
]
wr_op=[
'=
'=
]
wr_var=[
'LRTrim(column04)
''S'
]
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O64
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O52
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O55
fatherSonIndex=0
frm_calc='"Sto eseguendo il blocco del codice fiscale del soggetto con codice: " + LRTrim(column04)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + "Sto eseguendo il blocco del codice fiscale del soggetto con codice: " + LRTrim(column04) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPMerge
arch='personbo_agg
obj='Merge
pag=1
prev=O78
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(column04)
]
wr_field=[
'CONNES
'FLGVALIDO
]
wr_mode=[
'ins
'ins/upd
]
wr_op=[
'=
'=
]
wr_var=[
'LRTrim(column04)
''S'
]
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O77
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O49
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O52
fatherSonIndex=0
frm_calc='"Sto aggiornando la data di modifica delle operazioni del soggetto con codice: " + LRTrim(column04)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + "Sto aggiornando la data di modifica delle operazioni del soggetto con codice: " + LRTrim(column04) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPWrite
arch='opextrbo
obj='Write
pag=1
prev=O91
rd_kfield=[
'COLLEG
'INVIATO
'ANNULLA
'ANNO
]
rd_kop=[
'=
'=
'<>
'>=
]
rd_kvar=[
'LRTrim(column04)
'1
'1
'_annoage
]
wr_field=[
'DATAMODI
'CFESTERO
]
wr_op=[
'=
'=
]
wr_var=[
'Date()
'Left(LRTrim(column18),1)
]
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O90
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O46
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O49
fatherSonIndex=0
frm_calc='"Sto aggiornando la data di modifica dell'operazione extraconto con codice: " + LRTrim(column01)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + "Sto aggiornando la data di modifica dell'operazione extraconto con codice: " + LRTrim(column01) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_inviato
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_annullato
next=Icpitembatch.CPRead
arch='opextrbo
next=Icpitembatch.CPIfElse
frm_calc=[
'_inviato=1 and _annullato<> 1
]
h=[
19
19
]
obj='If
pag=1
prev=O106
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O107
fatherSonIndex=0
obj='Write
pag=1
rd_kfield=[
'RAPPORTO
'ANNO
]
rd_kop=[
'=
'>=
]
rd_kvar=[
'LRTrim(column01)
'_annoage
]
wr_field=[
'DATAMODI
'CFESTERO
]
wr_op=[
'=
'=
]
wr_var=[
'Date()
'Left(LRTrim(column18),1)
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=1
prev=O105
rd_field=[
'INVIATO
'ANNULLA
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'LRTrim(column01)
]
rd_var=[
'_inviato
'_annullato
]
I
obj='Var
obj_type='N
pag=1
prev=O104
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O103
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O102
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O44
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O46
fatherSonIndex=0
frm_calc='Left(LRTrim(column04),16)
len=16
name='_connes
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sto aggiornando i dati del soggetto con NDG: ' + LRTrim(_connes)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Sto aggiornando i dati del soggetto con NDG: ' + LRTrim(_connes) + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'gFlgWU='S'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O133
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O136
fatherSonIndex=0
next=Icpitembatch.CPWrite
arch='personbo
expected_rows=1
obj='Write
pag=1
prev=O141
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'_connes
]
wr_field=[
'CODFISC
'RAGSOC
'COGNOME
'NOME
'SESSO
'DATANASC
'NASCOMUN
'NASSTATO
'TIPINTER
'DESCCIT
'PROVINCIA
'CODCAB
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'TIPOPERS
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Left(LRTrim(column06),16)
'Left(LRTrim(column05),70)
'Left(LRTrim(column08),26)
'Left(LRTrim(column09),25)
'iif(LRTrim(column10)='M','1',iif(LRTrim(column10)='F','2',''))
'CharToDate(LRTrim(column11))
'Left(LRTrim(column12),30)
'Left(LRTrim(column13),30)
'Left(LRTrim(column14),2)
'Left(LRTrim(column15),30)
'Left(LRTrim(column16),2)
'Left(LRTrim(column17),6)
'Left(LRTrim(column19),2)
'Left(LRTrim(column20),15)
'CharToDate(column21)
'Left(LRTrim(column22),6)
'Left(LRTrim(column07),1)
]
I
obj='Write
pag=1
rd_kfield=[
'COLLEG
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'_connes
'Right(LRTrim(column03),4)
]
wr_field=[
'CFESTERO
]
wr_op=[
'=
]
wr_var=[
'Left(LRTrim(column18),1)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='opextrbo
father=O136
fatherSonIndex=1
next=Icpitembatch.CPWrite
arch='personbo
expected_rows=1
obj='Write
pag=1
prev=O156
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'_connes
]
wr_field=[
'CODFISC
'RAGSOC
'COGNOME
'NOME
'SESSO
'DATANASC
'NASCOMUN
'NASSTATO
'TIPINTER
'DESCCIT
'PROVINCIA
'CODCAB
'CFESTERO
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'TIPOPERS
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Left(LRTrim(column06),16)
'Left(LRTrim(column05),70)
'Left(LRTrim(column08),26)
'Left(LRTrim(column09),25)
'iif(LRTrim(column10)='M','1',iif(LRTrim(column10)='F','2',''))
'CharToDate(LRTrim(column11))
'Left(LRTrim(column12),30)
'Left(LRTrim(column13),30)
'Left(LRTrim(column14),2)
'Left(LRTrim(column15),30)
'Left(LRTrim(column16),2)
'Left(LRTrim(column17),6)
'iif(Left(LRTrim(column18),1)='S',1,0)
'Left(LRTrim(column19),2)
'Left(LRTrim(column20),15)
'CharToDate(column21)
'Left(LRTrim(column22),6)
'Left(LRTrim(column07),1)
]
I
obj='Write
pag=1
rd_kfield=[
'COLLEG
'ANNO
]
rd_kop=[
'=
'=
]
rd_kvar=[
'_connes
'Right(LRTrim(column03),4)
]
wr_field=[
'CFESTERO
]
wr_op=[
'=
]
wr_var=[
'Left(LRTrim(column18),1)
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=1
prev=O131
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O133
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=1
prev=O173
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES = _connes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O174
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'datamodi
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
]
rd_kvar=[
'cProgSto
'personbo->CONNES
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'Date()
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=1
prev=O130
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=_connes and wersonbo->datamodi=w_DATARETT
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O131
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O129
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O128
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
prev=O127
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O42
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O44
fatherSonIndex=0
frm_calc='Upper(a01.getContents())
len=25
name='column01
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a02.getContents())
len=25
name='column02
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a03.getContents())
len=25
name='column03
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a04.getContents())
len=25
name='column04
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a05.getContents())
len=25
name='column05
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a06.getContents())
len=25
name='column06
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a07.getContents())
len=25
name='column07
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a08.getContents())
len=25
name='column08
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a09.getContents())
len=25
name='column09
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a10.getContents())
len=25
name='column10
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a11.getContents())
len=25
name='column11
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a12.getContents())
len=25
name='column12
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a13.getContents())
len=25
name='column13
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a14.getContents())
len=25
name='column14
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a15.getContents())
len=25
name='column15
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a16.getContents())
len=25
name='column16
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a17.getContents())
len=25
name='column17
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a18.getContents())
len=25
name='column18
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a19.getContents())
len=25
name='column19
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a20.getContents())
len=25
name='column20
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a21.getContents())
len=25
name='column21
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a22.getContents())
len=25
name='column22
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a23.getContents())
len=25
name='column23
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a24.getContents())
len=25
name='column24
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a25.getContents())
len=25
name='column25
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a26.getContents())
len=25
name='column26
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a27.getContents())
len=25
name='column27
next=Icpitembatch.CPVarDecl
frm_calc='Upper(a28.getContents())
len=25
name='column28
obj='Var
pag=1
prev=O216
var_op='asgn
I
obj='Var
pag=1
prev=O215
var_op='asgn
I
obj='Var
pag=1
prev=O214
var_op='asgn
I
obj='Var
pag=1
prev=O213
var_op='asgn
I
obj='Var
pag=1
prev=O212
var_op='asgn
I
obj='Var
pag=1
prev=O211
var_op='asgn
I
obj='Var
pag=1
prev=O210
var_op='asgn
I
obj='Var
pag=1
prev=O209
var_op='asgn
I
obj='Var
pag=1
prev=O208
var_op='asgn
I
obj='Var
pag=1
prev=O207
var_op='asgn
I
obj='Var
pag=1
prev=O206
var_op='asgn
I
obj='Var
pag=1
prev=O205
var_op='asgn
I
obj='Var
pag=1
prev=O204
var_op='asgn
I
obj='Var
pag=1
prev=O203
var_op='asgn
I
obj='Var
pag=1
prev=O202
var_op='asgn
I
obj='Var
pag=1
prev=O201
var_op='asgn
I
obj='Var
pag=1
prev=O200
var_op='asgn
I
obj='Var
pag=1
prev=O199
var_op='asgn
I
obj='Var
pag=1
prev=O198
var_op='asgn
I
obj='Var
pag=1
prev=O197
var_op='asgn
I
obj='Var
pag=1
prev=O196
var_op='asgn
I
obj='Var
pag=1
prev=O195
var_op='asgn
I
obj='Var
pag=1
prev=O194
var_op='asgn
I
obj='Var
pag=1
prev=O193
var_op='asgn
I
obj='Var
pag=1
prev=O192
var_op='asgn
I
obj='Var
pag=1
prev=O191
var_op='asgn
I
obj='Var
pag=1
prev=O190
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O42
fatherSonIndex=0
frm_calc='// Leggo le celle﷯Cell a01 = sheet.getCell(0,_y);﷯Cell a02 = sheet.getCell(1,_y);﷯Cell a03 = sheet.getCell(2,_y);﷯Cell a04 = sheet.getCell(3,_y);﷯Cell a05 = sheet.getCell(4,_y);﷯Cell a06 = sheet.getCell(5,_y);﷯Cell a07 = sheet.getCell(6,_y);﷯Cell a08 = sheet.getCell(7,_y);﷯Cell a09 = sheet.getCell(8,_y);﷯Cell a10 = sheet.getCell(9,_y);﷯Cell a11 = sheet.getCell(10,_y);﷯Cell a12 = sheet.getCell(11,_y);﷯Cell a13 = sheet.getCell(12,_y);﷯Cell a14 = sheet.getCell(13,_y);﷯Cell a15 = sheet.getCell(14,_y);﷯Cell a16 = sheet.getCell(15,_y);﷯Cell a17 = sheet.getCell(16,_y);﷯Cell a18 = sheet.getCell(17,_y);﷯Cell a19 = sheet.getCell(18,_y);﷯Cell a20 = sheet.getCell(19,_y);﷯Cell a21 = sheet.getCell(20,_y);﷯Cell a22 = sheet.getCell(21,_y);﷯Cell a23 = sheet.getCell(22,_y);﷯Cell a24 = sheet.getCell(23,_y);﷯Cell a25 = sheet.getCell(24,_y);﷯Cell a26 = sheet.getCell(25,_y);﷯Cell a27 = sheet.getCell(26,_y);﷯Cell a28 = sheet.getCell(27,_y);
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O27
var_op='asgn
I
obj='Exec
pag=1
prev=O25
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O25
fatherSonIndex=0
frm_calc='//base﷯Workbook workbook = Workbook.getWorkbook(new File(CPLib.LRTrim(gPathDoc)+"/appo/"+CPLib.LRTrim(gAzienda)+"/"+CPLib.LRTrim(w_nomefile)));﷯conta = workbook.getNumberOfSheets();
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMessage
father=O20
fatherSonIndex=1
frm_calc=''Errore SQL: ' + m_Sql.TransactionErrorMessage() + NL
msg_type='Error
next=Icpitembatch.CPVarDecl
comment='Messaggio
frm_calc='gMsgProc + 'Errore SQL: ' + m_Sql.TransactionErrorMessage() + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='rollback
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Elaborazione Abortita per presenza di errori!'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=1
prev=O232
var_op='asgn
I
obj='Transaction
pag=1
prev=O231
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O230
var_op='asgn
I
obj='Message
pag=1
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=1
prev=O18
I
obj='Var
obj_type='D
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O9
var_op='asgn
I
obj='Begin
pag=1
prev=O7
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Azienda
father=O9
fatherSonIndex=0
global=True
len=10
name='gAzienda
next=Icpitembatch.CPVarDecl
comment='Path Applicazione
global=True
len=80
name='gPathApp
next=Icpitembatch.CPVarDecl
comment='Path Applicazione
global=True
len=80
name='gPathDoc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='Messaggio
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Gestione WU
global=True
len=1
name='gFlgWU
nonlocal=True
obj='Var
pag=1
prev=O242
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O241
I
nonlocal=True
obj='Var
pag=1
prev=O240
I
nonlocal=True
obj='Var
pag=1
prev=O239
I
nonlocal=True
obj='Var
pag=1
prev=O238
I
nonlocal=True
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O5
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O7
fatherSonIndex=0
len=25
name='column01
next=Icpitembatch.CPVarDecl
len=25
name='column02
next=Icpitembatch.CPVarDecl
len=25
name='column03
next=Icpitembatch.CPVarDecl
len=25
name='column04
next=Icpitembatch.CPVarDecl
len=25
name='column05
next=Icpitembatch.CPVarDecl
len=25
name='column06
next=Icpitembatch.CPVarDecl
len=25
name='column07
next=Icpitembatch.CPVarDecl
len=25
name='column08
next=Icpitembatch.CPVarDecl
len=25
name='column09
next=Icpitembatch.CPVarDecl
len=25
name='column10
next=Icpitembatch.CPVarDecl
len=25
name='column11
next=Icpitembatch.CPVarDecl
len=25
name='column12
next=Icpitembatch.CPVarDecl
len=25
name='column13
next=Icpitembatch.CPVarDecl
len=25
name='column14
next=Icpitembatch.CPVarDecl
len=25
name='column15
next=Icpitembatch.CPVarDecl
len=25
name='column16
next=Icpitembatch.CPVarDecl
len=25
name='column17
next=Icpitembatch.CPVarDecl
len=25
name='column18
next=Icpitembatch.CPVarDecl
len=25
name='column19
next=Icpitembatch.CPVarDecl
len=25
name='column20
next=Icpitembatch.CPVarDecl
len=25
name='column21
next=Icpitembatch.CPVarDecl
len=25
name='column22
next=Icpitembatch.CPVarDecl
len=25
name='column23
next=Icpitembatch.CPVarDecl
len=25
name='column24
next=Icpitembatch.CPVarDecl
len=25
name='column25
next=Icpitembatch.CPVarDecl
len=25
name='column26
next=Icpitembatch.CPVarDecl
len=25
name='column27
next=Icpitembatch.CPVarDecl
len=25
name='column28
obj='Var
pag=1
prev=O273
I
obj='Var
pag=1
prev=O272
I
obj='Var
pag=1
prev=O271
I
obj='Var
pag=1
prev=O270
I
obj='Var
pag=1
prev=O269
I
obj='Var
pag=1
prev=O268
I
obj='Var
pag=1
prev=O267
I
obj='Var
pag=1
prev=O266
I
obj='Var
pag=1
prev=O265
I
obj='Var
pag=1
prev=O264
I
obj='Var
pag=1
prev=O263
I
obj='Var
pag=1
prev=O262
I
obj='Var
pag=1
prev=O261
I
obj='Var
pag=1
prev=O260
I
obj='Var
pag=1
prev=O259
I
obj='Var
pag=1
prev=O258
I
obj='Var
pag=1
prev=O257
I
obj='Var
pag=1
prev=O256
I
obj='Var
pag=1
prev=O255
I
obj='Var
pag=1
prev=O254
I
obj='Var
pag=1
prev=O253
I
obj='Var
pag=1
prev=O252
I
obj='Var
pag=1
prev=O251
I
obj='Var
pag=1
prev=O250
I
obj='Var
pag=1
prev=O249
I
obj='Var
pag=1
prev=O248
I
obj='Var
pag=1
prev=O247
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5
fatherSonIndex=0
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
len=16
name='_connes
next=Icpitembatch.CPVarDecl
comment='data rettifica
len=8
name='w_DATARETT
next=Icpitembatch.CPVarDecl
len=1
name='_inviato
next=Icpitembatch.CPVarDecl
len=1
name='_annullato
next=Icpitembatch.CPVarDecl
len=4
name='_annoage
obj='Var
pag=1
prev=O282
I
obj='Var
obj_type='N
pag=1
prev=O281
I
obj='Var
obj_type='N
pag=1
prev=O280
I
obj='Var
obj_type='D
pag=1
prev=O279
I
obj='Var
pag=1
prev=O278
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='nome file da importare
father=O3
fatherSonIndex=0
len=80
name='w_nomefile
obj='Var
pag=1
param=True
I
I
]
w=[
150
150
]
x=14
y=15
I
]
ManualBlocks={
'BO - Header
Icpmanualblocks.CPManualBlocks
code='import java.io.File; ﷯import java.lang.Double;﷯import jxl.*;
name='BO - Header
I
'BO - Properties
Icpmanualblocks.CPManualBlocks
code='public int _i;﷯public int _y;﷯public int _righe;﷯public int conta;
name='BO - Properties
I
}
comment='Import Correzione Errori
date_creat=#2014-09-03
date_rev=#2023-01-04
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'FileLibMit
'Utilities
'FileLibMit
]
modcnt=304
page_result_class=[
'
]
page_result_type=[
'U
]
page_uid=[
'VZNEIIHYYJ
]
pagename=[
'Page_1
]
pagenote=[
'
]
pagetitle=[
'Main
]
runtime_filters=2
tpl_name='Function
work_file=[
'opextrbo
'personbo
'personbo_agg
'wersonbo
]
work_filter=[
'
'
]
I
*--*
*----*
