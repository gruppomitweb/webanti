* --- CodePainter Revolution Batch Vers. 4.7
Icpbatch.CPBatch
Items=[
Icpitembatch.CPRemark
frm_calc='Legge il file di testo e porta i dati nella tabella
next=Icpitembatch.CPVarDecl
comment='memory cursor dei connes delle anagrafiche
frm_seek='mcConnes.MCRDef
name='personbo_mc
next=Icpitembatch.CPVarDecl
comment='row del connes dell'anagrafica
frm_seek='mcConnes.MCRDef
name='personbo_row
next=Icpitembatch.CPVarDecl
comment='memory cursor dipendenze
frm_seek='anadip
name='anadip_mc
next=Icpitembatch.CPVarDecl
comment='causali analitiche
frm_seek='tbcauana
name='tbcausana_mc
next=Icpitembatch.CPVarDecl
comment='memory cursor della tabella delle citta
frm_seek='tbcitta
name='tbcitta_mc
next=Icpitembatch.CPVarDecl
comment='Memori cursor per errori
frm_seek='tmp_errimp
name='mcErrori
next=Icpitembatch.CPVarDecl
len=3
name='_conteggio
next=Icpitembatch.CPVarDecl
len=3
name='_conteggio2
next=Icpitembatch.CPVarDecl
len=3
name='_attuale
next=Icpitembatch.CPMessage
frm_calc=''Creo MC causale anlitica'
next=Ispitembatch.CPMemoryCursor
data_source='tbcauana
key_expression='Left(LRTrim(tbcauana->CODCAU)+Space(4),4)+Left(LRTrim(tbcauana->CAUSINT)+Space(2),2)
mem_curs_name='tbcausana_mc
next=Icpitembatch.CPVarDecl
frm_calc='tbcausana_mc.RecCount()
len=3
name='_conteggio2
next=Icpitembatch.CPExec
check='man
frm_calc='System.out.println("Mccausali "+_conteggio2);
next=Icpitembatch.CPMessage
frm_calc=''Creo MC città'
next=Ispitembatch.CPMemoryCursor
data_source='tbcitta
expected_rows=10000
mem_curs_name='tbcitta_mc
next=Icpitembatch.CPVarDecl
frm_calc='tbcitta_mc.RecCount()
len=3
name='_conteggio2
next=Icpitembatch.CPExec
check='man
frm_calc='System.out.println("Mccitta "+_conteggio2);
next=Icpitembatch.CPMessage
frm_calc=''Creo MC dipendenze'
next=Ispitembatch.CPMemoryCursor
data_source='anadip
key_expression='anadip->CODDIP
mem_curs_name='anadip_mc
next=Icpitembatch.CPVarDecl
frm_calc='anadip_mc.RecCount()
len=3
name='_conteggio2
next=Icpitembatch.CPExec
check='man
frm_calc='System.out.println("Mcanadip "+_conteggio2);
next=Icpitembatch.CPMessage
frm_calc=''Fine generazione Mc. Inizio elaborazione'
next=Icpitembatch.CPVarDecl
frm_calc='0
len=3
name='_conteggio
next=Icpitembatch.CPMessage
frm_calc=''Generazione key su connes'
next=Icpitembatch.CPExec
check='man
frm_calc='System.out.println("Mcpersone  key"+_conteggio);
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPMessage
frm_calc=''Fine generazione key su connes'
next=Icpitembatch.CPExec
check='man
frm_calc='System.out.println("Mcpersone  key fine"+_conteggio);
next=Icpitembatch.CPBeginEnd
comment='dati intermediario
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Messaggio
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
comment='Azienda
global=True
len=10
name='gAzienda
next=Icpitembatch.CPVarDecl
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
comment='descrizione errore
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
comment='variabile necessaria per saltare i controlli
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
len=2
name='_interprv
next=Icpitembatch.CPVarDecl
len=10
name='_unicode
next=Icpitembatch.CPVarDecl
len=1
name='_esito
next=Icpitembatch.CPVarDecl
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
len=11
name='_numprog
next=Icpitembatch.CPVarDecl
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
len=1
name='cFlagLire
next=Icpitembatch.CPVarDecl
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
len=10
name='conta
next=Icpitembatch.CPVarDecl
len=15
name='_totin
next=Icpitembatch.CPVarDecl
len=15
name='_totout
next=Icpitembatch.CPVarDecl
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
len=8
name='_datarett
next=Icpitembatch.CPVarDecl
len=10
name='_idb2
next=Icpitembatch.CPVarDecl
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
len=35
name='_benind
next=Icpitembatch.CPVarDecl
len=5
name='_bencap
next=Icpitembatch.CPVarDecl
len=1
name='_opeerr
next=Icpitembatch.CPVarDecl
len=15
name='_max
next=Icpitembatch.CPVarDecl
len=15
name='_min
next=Icpitembatch.CPVarDecl
len=15
name='_tot
next=Icpitembatch.CPVarDecl
len=1
name='_mono
next=Icpitembatch.CPVarDecl
len=15
name='_cicli
next=Icpitembatch.CPVarDecl
len=15
name='_contacicli
next=Icpitembatch.CPVarDecl
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
len=15
name='_top
next=Icpitembatch.CPVarDecl
len=1
name='_generr
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='cNumNew
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' delle operazioni' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPForEach
for_variable='rowErr
for_variable_type='tmp_errimp
h=[
19
19
]
iterator_expr='mcErrori
next=Icpitembatch.CPMessage
frm_calc=''Fine elaborazione'
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Operazioni Inserite o modificate: '+LRTrim(Str(cNumNew,10,0)) + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' delle operazioni' + NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Fine importazione delle operazioni'
global=True
len=10
name='gMsgImp
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O99
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
prev=O98
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
prev=O97
var_op='asgn
I
obj='Message
pag=1
prev=O95
I
obj='ForEach
pag=1
prev=O93
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O95
fatherSonIndex=0
frm_calc=[
'rowErr.numriga=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='imp_archope
father=O103
fatherSonIndex=0
obj='Write
pag=1
rd_kfield=[
'INFORM
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(rowErr.nomearch)
]
wr_field=[
'IPCOLLEG
]
wr_op=[
'=
]
wr_var=[
''Errore'
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='imp_archfraz
father=O103
fatherSonIndex=1
obj='Write
pag=1
rd_kfield=[
'INFORM
]
rd_kop=[
'=
]
rd_kvar=[
'LRTrim(rowErr.nomearch)
]
wr_field=[
'IPCOLLEG
]
wr_op=[
'=
]
wr_var=[
''Errore'
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Try
pag=1
prev=O92
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O93
fatherSonIndex=0
frm_calc='0
len=1
name='_generr
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=15
name='_max
next=Icpitembatch.CPVarDecl
frm_calc='0
len=15
name='_min
next=Icpitembatch.CPVarDecl
frm_calc='0
len=15
name='_tot
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(_tot > 5000,0,1)
len=1
name='_mono
next=Icpitembatch.CPIfElse
frm_calc=[
'_mono = 1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='1
len=15
name='_contacicli
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='conta
next=Icpitembatch.CPWhile
frm_calc='_contacicli<=_cicli
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_generr=1
]
h=[
19
19
]
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=1
prev=O143
I
obj='If
pag=1
prev=O141
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O143
fatherSonIndex=0
frm_calc='transaction error
obj='Transaction
pag=1
I
I
]
w=[
150
150
]
I
obj='While
pag=1
prev=O140
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O141
fatherSonIndex=0
frm_calc=[
'_mono = 1
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'_top>=_min
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='_contacicli+1
len=15
name='_contacicli
obj='Var
obj_type='N
pag=1
prev=O156
var_op='asgn
I
obj='If
pag=1
prev=O153
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O156
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=1
sel_name='imp_archfraz
sel_where='imp_archfraz->CONTATORE >= _bottom and imp_archfraz->CONTATORE <= _top
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O162
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' operazioni '
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPMessage
frm_calc=''Sto elaborando frazionata %1 su %2'
msg_parms=[
'LRTrim(Str(conta,10,0))
'LRTrim(Str(_tot,10,0))
]
next=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O170
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O172
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(imp_archfraz->CODDIPE)))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(imp_archfraz->UNIQUECODE)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc='_flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(imp_archfraz->RIFIMP)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(imp_archfraz->DATAOPE)))) or Empty(LRTrim(_numprog))
]
h=[
19
19
]
obj='If
pag=1
prev=O194
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O197
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(imp_archfraz->DATAOPE)))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PFRAZIO1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPCase
frm_calc=[
'imp_archfraz->FLAGLIRE='S' or imp_archfraz->FLAGLIRE='1' or imp_archfraz->FLAGLIRE='7'
'imp_archfraz->FLAGLIRE='E' or imp_archfraz->FLAGLIRE='3' or imp_archfraz->FLAGLIRE='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(imp_archfraz->DATAREG)) or _flgdataim=1,Date(),CharToDate(imp_archfraz->DATAREG))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(imp_archfraz->FLAGCONT='1' or imp_archfraz->FLAGCONT='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(imp_archfraz->FLAGFRAZ),'0',iif(imp_archfraz->FLAGFRAZ='S','1',iif(imp_archfraz->FLAGFRAZ='N','1',imp_archfraz->FLAGFRAZ)))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(imp_archfraz->NUMPROG)
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPIfElse
frm_calc=[
'tbcausana_mc.GoToKey(Left(LRTrim(imp_archfraz->CODANA)+Space(4),4)+Left(LRTrim(imp_archfraz->CODVOC)+Space(2),2))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPFRZ\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' operazioni '
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='imp_archfraz->IMPIN
len=15
name='_totin
next=Icpitembatch.CPVarDecl
frm_calc='imp_archfraz->IMPOUT
len=15
name='_totout
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='fraziobo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_oldidb)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=1
prev=O228
var_op='asgn
I
obj='If
pag=1
prev=O226
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O228
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='sogopefbo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='clientifrz
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='beneficfrz
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='terzistifrz
obj='Delete
pag=1
prev=O243
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=1
prev=O242
sel_field='*
sel_name='terzistifrz
sel_where='terzistifrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistifrz
father=O243
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'cOpeProg1
'terzistifrz->CODSOG
'terzistifrz->TIPOFILE
'terzistifrz->NUMCOL
'terzistifrz->LEGAME
'terzistifrz->RAPCOL
'terzistifrz->UCODE
'terzistifrz->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=1
prev=O240
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=1
prev=O239
sel_field='*
sel_name='beneficfrz
sel_where='beneficfrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficfrz
father=O240
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
]
rd_kvar=[
'cOpeProg1
'beneficfrz->CPROWNUM
'beneficfrz->CODSOG
'beneficfrz->TIPOFILE
'beneficfrz->NUMCOL
'beneficfrz->LEGAME
'beneficfrz->RAPCOL
'beneficfrz->UCODE
'beneficfrz->IDBASE
'beneficfrz->C_RAG
'beneficfrz->C_STA
'beneficfrz->C_CTA
'beneficfrz->C_CAB
'beneficfrz->C_PRV
'beneficfrz->C_IND
'beneficfrz->C_CAP
'beneficfrz->C_RAPPORTO
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=1
prev=O237
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=1
prev=O236
sel_field='*
sel_name='clientifrz
sel_where='clientifrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientifrz
father=O237
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'clientifrz->CODSOG
'clientifrz->LEGAME
'clientifrz->IDBASE
'clientifrz->NUMCOL
'clientifrz->TIPOFILE
'clientifrz->RAPCOL
'clientifrz->UCODE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=1
prev=O234
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=1
sel_field='*
sel_name='sogopefbo
sel_where='sogopefbo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sogopefbo
father=O234
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'sogopefbo->CPROWNUM
'sogopefbo->CODSOG
'sogopefbo->LEGAME
'sogopefbo->IDBASE
'sogopefbo->NUMCOL
'sogopefbo->TIPOFILE
'sogopefbo->RAPCOL
'sogopefbo->UCODE
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=1
prev=O224
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPFRZ
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
'IMPIN
'IMPOUT
]
rd_kvar=[
'imp_archfraz->AMMONT
'Val(Right(imp_archfraz->DATAOPE,4))
'arfn_conv_stato_uic(Left(LRTrim(imp_archfraz->AREAGEO),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'imp_archfraz->C_RAPPORTO
'_bensta
'Val(imp_archfraz->CAMBIO) / 10000
'Right(imp_archfraz->DATAOPE,4)+Substr(imp_archfraz->DATAOPE,3,2)+Left(imp_archfraz->DATAOPE,2)
'Right(imp_archfraz->DATAOPE,4)+Substr(imp_archfraz->DATAOPE,3,2)+Left(imp_archfraz->DATAOPE,2)
'DateToChar(_datareg)
'imp_archfraz->CODANA
'_intercab
'imp_archfraz->CODCAB2
'imp_archfraz->CODDIPE
'imp_archfraz->CODINT2
'_intercod
'imp_archfraz->CODVOC
'imp_archfraz->CONNALTRO
'imp_archfraz->CONNESBEN
'imp_archfraz->CONNESCLI
'imp_archfraz->CONNESOPER
'CharToDate(Right(imp_archfraz->DATAIMP,4)+Substr(imp_archfraz->DATAIMP,3,2)+Left(imp_archfraz->DATAIMP,2))
'CharToDate(Right(imp_archfraz->DATAOPE,4)+Substr(imp_archfraz->DATAOPE,3,2)+Left(imp_archfraz->DATAOPE,2))
'_datareg
'_datarett
'imp_archfraz->DESC2
'_intercit
'imp_archfraz->DESCINTER
'imp_archfraz->DUCOLLEG
'imp_archfraz->DURAT
'cFlagCont
'cFlagFraz
'cFlagLire
'imp_archfraz->FLAGRAP
'_flagrap2
'cOpeProg1
'cIdCau
'"O"+Right(cOpeProg2,9)+_idb2
'imp_archfraz->INFORM
'imp_archfraz->IPCOLLEG
'imp_archfraz->MODSVOL
'imp_archfraz->NATURA
'cOpeProg2
'imp_archfraz->AGOPER
'_idreg
''1'
'CharToDateTime(Substr(imp_archfraz->ORACOLLEG,5,4)+Substr(imp_archfraz->ORACOLLEG,3,2)+Left(imp_archfraz->ORACOLLEG,2)+Substr(imp_archfraz->ORACOLLEG,9,6))
'arfn_conv_stato_uic(imp_archfraz->PAESE)
'imp_archfraz->PAGASOGOP
'nProgImp
'imp_archfraz->PROV2
'_interprv
'imp_archfraz->RAGIO
'imp_archfraz->RAPPORTBEN
'imp_archfraz->RAPPORTO
'imp_archfraz->RAREA
'imp_archfraz->RCOMP
'imp_archfraz->RFREQ
'imp_archfraz->RIFIMP
'imp_archfraz->RIMP
'imp_archfraz->RRAGIO
'imp_archfraz->RTIPO
'imp_archfraz->SCOPO
'imp_archfraz->SEGNO
'_statoreg
'Left(LRTrim(imp_archfraz->TIPO),3)
''1'
'imp_archfraz->TIPOINT2
'imp_archfraz->TIPOINTER
'imp_archfraz->TIPOLEG
'imp_archfraz->TIPOOPRAP
'Val(imp_archfraz->TOTCONT)
'Val(imp_archfraz->TOTLIRE)
'imp_archfraz->UNIQUECODE
'imp_archfraz->VALUTA
'imp_archfraz->ZCPARTE
'_colleg
'_idb2
'_totin / 100
'_totout / 100
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O226
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nella tabella delle operazioni per l'operazione in data "+CharToDate(imp_archfraz->DATAOPE)+" con importo "+Str((Val(imp_archfraz->TOTLIRE))/100,14,2)+". L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''%1'
msg_parms=[
'gMsgProc
]
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=1
prev=O293
I
obj='Var
obj_type='N
pag=1
prev=O292
var_op='asgn
I
obj='Exec
pag=1
prev=O290
I
obj='Transaction
pag=1
prev=O289
I
obj='ExitLoop
pag=1
prev=O288
I
obj='Var
obj_type='N
pag=1
prev=O287
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Begin
pag=1
prev=O223
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O224
fatherSonIndex=0
frm_calc='Upper(imp_archfraz->C_RAG)
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(imp_archfraz->C_STA)
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(imp_archfraz->C_CTA)
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='imp_archfraz->C_CAB
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(imp_archfraz->C_PRV)
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(imp_archfraz->C_IND)
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(imp_archfraz->C_CAP)
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(imp_archfraz->CONNESBEN))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(imp_archfraz->CONNESBEN)) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=1
prev=O308
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O311
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(imp_archfraz->RAPPORTO)))
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O316
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=1
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=imp_archfraz->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O321
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=1
prev=O332
I
obj='Read
pag=1
prev=O331
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=1
prev=O330
var_op='asgn
I
obj='Var
pag=1
prev=O329
var_op='asgn
I
obj='Var
pag=1
prev=O328
var_op='asgn
I
obj='Var
pag=1
prev=O327
var_op='asgn
I
obj='Var
pag=1
prev=O326
var_op='asgn
I
obj='Var
pag=1
prev=O325
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O305
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O308
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=1
prev=O349
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'imp_archfraz->CONNESBEN
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=1
prev=O348
var_op='asgn
I
obj='Var
pag=1
prev=O347
var_op='asgn
I
obj='Var
pag=1
prev=O346
var_op='asgn
I
obj='Var
pag=1
prev=O345
var_op='asgn
I
obj='Var
pag=1
prev=O344
var_op='asgn
I
obj='Var
pag=1
prev=O343
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O304
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O305
fatherSonIndex=0
for_variable='RowMCCitta
for_variable_type='tbcitta
h=[
19
19
]
iterator_expr='tbcitta_mc
obj='ForEach
orderby_expr='CITTA
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O358
fatherSonIndex=0
frm_calc='RowMCCitta.CAB
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='RowMCCitta.PROV
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='RowMCCitta.CAP
len=5
name='_bencap
obj='Var
pag=1
prev=O363
var_op='asgn
I
obj='Var
pag=1
prev=O362
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
where_expr='_bencta=tbcitta_mc.CITTA
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O303
var_op='asgn
I
obj='Var
pag=1
prev=O302
var_op='asgn
I
obj='Var
pag=1
prev=O301
var_op='asgn
I
obj='Var
pag=1
prev=O300
var_op='asgn
I
obj='Var
pag=1
prev=O299
var_op='asgn
I
obj='Var
pag=1
prev=O298
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O222
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O221
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O220
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O219
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O216
var_op='asgn
I
obj='If
pag=1
prev=O215
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O216
fatherSonIndex=0
frm_calc='tbcausana_mc.idbase
len=4
name='cIdCau
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O214
var_op='asgn
I
obj='Var
pag=1
prev=O213
var_op='asgn
I
obj='Var
pag=1
prev=O212
var_op='asgn
I
obj='Var
pag=1
prev=O211
var_op='asgn
I
obj='Var
pag=1
prev=O210
var_op='asgn
I
obj='Var
obj_type='D
pag=1
prev=O207
var_op='asgn
I
obj='Case
pag=1
prev=O206
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O207
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O207
fatherSonIndex=1
frm_calc=[
'imp_archfraz->FLAGLIRE = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O376
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O376
fatherSonIndex=1
frm_calc='imp_archfraz->FLAGLIRE
len=1
name='cFlagLire
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O207
fatherSonIndex=2
frm_calc='imp_archfraz->FLAGLIRE
len=1
name='cFlagLire
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=1
prev=O205
var_op='asgn
I
obj='Var
pag=1
prev=O202
var_op='asgn
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O202
fatherSonIndex=0
frm_calc='_numprog
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''1'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
obj='Var
obj_type='D
pag=1
prev=O391
var_op='asgn
I
obj='Var
pag=1
prev=O390
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O202
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("PFRAZIO2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''0'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datarett
obj='Var
obj_type='D
pag=1
prev=O395
var_op='asgn
I
obj='Var
pag=1
prev=O394
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O191
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O194
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(imp_archfraz->DATAOPE)) or IsNull(imp_archfraz->DATAOPE)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O401
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=1
prev=O406
sel_field='fraziobo->IDBASE
sel_name='fraziobo
sel_where='fraziobo->NUMPROG=_numprog and (fraziobo->STATOREG='0'  or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O407
fatherSonIndex=0
frm_calc='"E' stata cancellata l'operazione con codice "+_numprog
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPWrite
arch='fraziobo
obj='Write
pag=1
prev=O411
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'fraziobo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
]
wr_var=[
''2'
'Date()
]
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
father=O401
fatherSonIndex=1
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"E' stata variata l'operazione con codice "+_numprog
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPRemark
frm_calc='Stranezza su idreg da vericare se corretto averlo aggiunto nella quey sottostante
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=1
prev=O423
sel_field='fraziobo->IDBASE,fraziobo->NUMPROG,fraziobo->DATAOPE,fraziobo->FLAGRAP2,fraziobo->IDEREG
sel_name='fraziobo
sel_where='fraziobo->NUMPROG=_numprog and (fraziobo->STATOREG='0'  or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O424
fatherSonIndex=0
frm_calc='fraziobo->IDBASE
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(fraziobo->FLAGRAP2) or fraziobo->FLAGRAP2='S',Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(fraziobo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='fraziobo->IDEREG
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='fraziobo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=1
prev=O436
sel_field='*
sel_name='terzistifrz
sel_where='terzistifrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='merzistifrz
father=O438
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'IDREG
]
rd_kvar=[
'_oldidb
'terzistifrz->CODSOG
'terzistifrz->TIPOFILE
'terzistifrz->NUMCOL
'terzistifrz->LEGAME
'terzistifrz->RAPCOL
'terzistifrz->UCODE
'terzistifrz->IDBASE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=1
prev=O434
sel_field='*
sel_name='beneficfrz
sel_where='beneficfrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='meneficfrz
father=O436
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
'IDREG
]
rd_kvar=[
'_oldidb
'beneficfrz->CPROWNUM
'beneficfrz->CODSOG
'beneficfrz->TIPOFILE
'beneficfrz->NUMCOL
'beneficfrz->LEGAME
'beneficfrz->RAPCOL
'beneficfrz->UCODE
'beneficfrz->IDBASE
'beneficfrz->C_RAG
'beneficfrz->C_STA
'beneficfrz->C_CTA
'beneficfrz->C_CAB
'beneficfrz->C_PRV
'beneficfrz->C_IND
'beneficfrz->C_CAP
'beneficfrz->C_RAPPORTO
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=1
prev=O432
sel_field='*
sel_name='clientifrz
sel_where='clientifrz->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mlientifrz
father=O434
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'clientifrz->CODSOG
'clientifrz->LEGAME
'clientifrz->IDBASE
'clientifrz->NUMCOL
'clientifrz->TIPOFILE
'clientifrz->RAPCOL
'clientifrz->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=1
prev=O431
sel_field='*
sel_name='sogopefbo
sel_where='sogopefbo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mogopefbo
father=O432
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'sogopefbo->CPROWNUM
'sogopefbo->CODSOG
'sogopefbo->LEGAME
'sogopefbo->IDBASE
'sogopefbo->NUMCOL
'sogopefbo->TIPOFILE
'sogopefbo->RAPCOL
'sogopefbo->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=1
prev=O430
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'fraziobo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
'FLAGRAP2
]
wr_op=[
'=
'=
'=
]
wr_var=[
''3'
'Date()
'_flagrap2
]
I
obj='Var
pag=1
prev=O429
var_op='asgn
I
obj='Var
pag=1
prev=O428
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=1
prev=O422
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O421
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O190
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O191
fatherSonIndex=0
frm_calc=[
'Upper(imp_archfraz->RIFIMP)='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O475
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=1
sel_field='fraziobo->NUMPROG
sel_name='fraziobo
sel_where='fraziobo->INFORM = imp_archfraz->INFORM and (fraziobo->STATOREG='0' or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O480
fatherSonIndex=0
frm_calc='fraziobo->NUMPROG
len=11
name='_numprog
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O475
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=1
sel_field='fraziobo->NUMPROG
sel_name='fraziobo
sel_where='fraziobo->RIFIMP = imp_archfraz->RIFIMP and (fraziobo->STATOREG='0' or fraziobo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O487
fatherSonIndex=0
frm_calc='fraziobo->NUMPROG
len=11
name='_numprog
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O189
var_op='asgn
I
obj='Var
pag=1
prev=O188
var_op='asgn
I
obj='Var
pag=1
prev=O187
var_op='asgn
I
obj='Var
pag=1
prev=O184
var_op='asgn
I
obj='If
pag=1
prev=O183
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='fraziobo
father=O184
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O497
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O498
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nella tabella delle operazioni per l'operazione in data "+CharToDate(imp_archfraz->DATAOPE)+" con importo "+Str((Val(imp_archfraz->TOTLIRE))/100,14,2)+". L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''%1'
msg_parms=[
'gMsgProc
]
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=1
prev=O505
I
obj='Transaction
pag=1
prev=O504
I
obj='Var
obj_type='N
pag=1
prev=O503
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=1
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'imp_archfraz->UNIQUECODE
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O182
var_op='asgn
I
obj='Remark
pag=1
prev=O179
I
obj='If
pag=1
prev=O177
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O179
fatherSonIndex=0
frm_calc=[
'anadip_mc.GoToKey(imp_archfraz->CODDIPE)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(imp_archfraz->DESCCIT)+LRTrim(imp_archfraz->CODCAB)+LRTrim(imp_archfraz->PROVINCIA)))
]
h=[
19
19
]
obj='If
pag=1
prev=O516
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O519
fatherSonIndex=0
frm_calc='LRTrim(imp_archfraz->DESCCIT)
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(imp_archfraz->CODCAB)
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(imp_archfraz->PROVINCIA)
len=2
name='_interprv
obj='Var
pag=1
prev=O525
var_op='asgn
I
obj='Var
pag=1
prev=O524
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O516
fatherSonIndex=0
frm_calc='anadip_mc.CODDIP
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='anadip_mc.DESCCIT
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='anadip_mc.CAB
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='anadip_mc.PROVINCIA
len=2
name='_interprv
obj='Var
pag=1
prev=O532
var_op='asgn
I
obj='Var
pag=1
prev=O531
var_op='asgn
I
obj='Var
pag=1
prev=O530
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O516
fatherSonIndex=1
frm_calc='gMsgProc +"Rilevati errori nella tabella delle operazioni per l'operazione in data "+CharToDate(imp_archfraz->DATAOPE)+" con importo "+Str((Val(imp_archfraz->TOTLIRE))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(imp_archfraz->CODDIPE)+" non è prensente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=1
prev=O536
I
obj='Var
obj_type='N
pag=1
prev=O535
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O177
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(imp_archfraz->CODINTER)),_codinter,imp_archfraz->CODINTER)
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(imp_archfraz->DESCCIT)),_citinter,imp_archfraz->DESCCIT)
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(imp_archfraz->CODCAB)),_cabinter,imp_archfraz->CODCAB)
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(imp_archfraz->PROVINCIA)),_prvinter,imp_archfraz->PROVINCIA)
len=2
name='_interprv
obj='Var
pag=1
prev=O544
var_op='asgn
I
obj='Var
pag=1
prev=O543
var_op='asgn
I
obj='Var
pag=1
prev=O542
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Memori cursor per errori
father=O172
fatherSonIndex=1
frm_seek='AppendBlank
name='mcErrori
next=Icpitembatch.CPVarDecl
comment='Memori cursor per errori
frm_calc='imp_archfraz->INFORM
frm_seek='nomearch
name='mcErrori
next=Icpitembatch.CPVarDecl
comment='Memori cursor per errori
frm_calc='2
frm_seek='numriga
name='mcErrori
next=Icpitembatch.CPVarDecl
comment='Memori cursor per errori
frm_seek='SaveRow
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_opeerr
obj='Var
obj_type='N
pag=1
prev=O551
var_op='asgn
I
obj='Var
obj_type='MC
pag=1
prev=O550
var_op='meth
I
obj='Var
obj_type='MC
pag=1
prev=O549
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O548
var_op='prop
I
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=1
prev=O168
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O170
fatherSonIndex=0
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(imp_archfraz->CONNESCLI)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(imp_archfraz->CONNESOPER))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(imp_archfraz->CONNESBEN))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(imp_archfraz->CONNALTRO))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(imp_archfraz->CONNESCLI)) and Empty(LRTrim(imp_archfraz->RAPPORTO)) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=1
prev=O567
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O570
fatherSonIndex=0
frm_calc=''Rapporto continuativo o Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_generr
obj='Var
obj_type='N
pag=1
prev=O576
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O575
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O564
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O567
fatherSonIndex=0
frm_calc=[
'not(personbo_mc.GoToKey(imp_archfraz->CONNALTRO))
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O581
fatherSonIndex=0
frm_calc='iif(Empty(_descerr),'Anagrafica Soggetto per conto del quale assente',_descerr+' Anagrafica Soggetto per conto del quale assente')
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_generr
obj='Var
obj_type='N
pag=1
prev=O587
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O586
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O561
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O564
fatherSonIndex=0
frm_calc=[
'not(personbo_mc.GoToKey(imp_archfraz->CONNESBEN))
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O593
fatherSonIndex=0
frm_calc='iif(Empty(_descerr),'Anagrafica Controparte Operazione assente',_descerr+' Anagrafica Controparte Operazione assente')
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_generr
obj='Var
obj_type='N
pag=1
prev=O599
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O598
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O558
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O561
fatherSonIndex=0
frm_calc=[
'not(personbo_mc.GoToKey(imp_archfraz->CONNESOPER))
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O605
fatherSonIndex=0
frm_calc='iif(Empty(_descerr),'Anagrafica Soggetto Operante Operazione assente',_descerr+' Anagrafica Soggetto Operante Operazione assente')
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_generr
obj='Var
obj_type='N
pag=1
prev=O611
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O610
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O557
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O558
fatherSonIndex=0
frm_calc=[
'not(personbo_mc.GoToKey(LRTrim(imp_archfraz->CONNESCLI)))
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O617
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente. Inform: '+imp_archfraz->INFORM
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_generr
obj='Var
obj_type='N
pag=1
prev=O623
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O622
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O556
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Message
pag=1
prev=O167
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O166
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O153
fatherSonIndex=0
frm_calc='_min
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_max
len=15
name='_top
obj='Var
obj_type='N
pag=1
prev=O632
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O153
fatherSonIndex=1
frm_calc=[
'_contacicli=1
'_contacicli = _cicli
]
h=[
19
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O635
fatherSonIndex=0
frm_calc='_min
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_min + 999
len=15
name='_top
obj='Var
obj_type='N
pag=1
prev=O640
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O635
fatherSonIndex=1
frm_calc='_top + 1
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_max
len=15
name='_top
obj='Var
obj_type='N
pag=1
prev=O643
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O635
fatherSonIndex=2
frm_calc='_top + 1
len=15
name='_bottom
next=Icpitembatch.CPVarDecl
frm_calc='_bottom + 999
len=15
name='_top
obj='Var
obj_type='N
pag=1
prev=O646
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O139
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O136
var_op='asgn
I
obj='If
pag=1
prev=O135
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O136
fatherSonIndex=0
frm_calc=[
'_tot = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O653
fatherSonIndex=0
frm_calc='0
len=15
name='_cicli
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O653
fatherSonIndex=1
frm_calc='1
len=15
name='_cicli
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O136
fatherSonIndex=1
frm_calc='iif(Mod(_tot,1000) <> 0,Int(_tot/1000) + 1,Int(_tot/1000))
len=15
name='_cicli
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O133
var_op='asgn
I
obj='Select
pag=1
prev=O132
sel_name='qbe_imp_archfraz_minmax
sel_type='sqry
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O133
fatherSonIndex=0
frm_calc='qbe_imp_archfraz_minmax->MAXPRG
len=15
name='_max
next=Icpitembatch.CPVarDecl
frm_calc='qbe_imp_archfraz_minmax->MINPRG
len=15
name='_min
next=Icpitembatch.CPVarDecl
frm_calc='qbe_imp_archfraz_minmax->TOTPRG
len=15
name='_tot
obj='Var
obj_type='N
pag=1
prev=O668
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O667
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O131
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O130
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O128
var_op='asgn
I
obj='Select
pag=1
prev=O127
sel_name='imp_archope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O128
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc=''Sono stati elaborate '+LRTrim(Str(conta,10,0))+' operazioni '
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPMessage
frm_calc=''Sto elaborando operazione %1'
msg_parms=[
'LRTrim(Str(conta,10,0))
]
next=Icpitembatch.CPBeginEnd
comment='Verifica presenza soggetti
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=1
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O677
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPBeginEnd
comment='Dati intermediario
father=O679
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(imp_archope->CODDIPE)))
]
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Verifico la presenza dell'_unicode per evitare duplicazioni di informazioni diverse con lo stesso _unicode
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_unicode
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(imp_archope->UNIQUECODE)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_rifimp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=20
name='_idreg
next=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
frm_calc='_flagrap2
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_numprog
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(imp_archope->RIFIMP)) > 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_numprog)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'(not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(imp_archope->DATAOPE)))) or Empty(LRTrim(_numprog))
]
h=[
19
19
]
obj='If
pag=1
prev=O701
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O704
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(_numprog))) and not(Empty(LRTrim(imp_archope->DATAOPE)))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='_idb2
next=Icpitembatch.CPCase
frm_calc=[
'imp_archope->FLAGLIRE='S' or imp_archope->FLAGLIRE='1' or imp_archope->FLAGLIRE='7'
'imp_archope->FLAGLIRE='E' or imp_archope->FLAGLIRE='3' or imp_archope->FLAGLIRE='5'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(imp_archope->DATAREG)) or _flgdataim=1,Date(),CharToDate(imp_archope->DATAREG))
len=8
name='_datareg
next=Icpitembatch.CPVarDecl
frm_calc='iif(imp_archope->FLAGCONT='1' or imp_archope->FLAGCONT='S','1','0') 
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(imp_archope->FLAGFRAZ),'0',iif(imp_archope->FLAGFRAZ='S','1',iif(imp_archope->FLAGFRAZ='N','1',imp_archope->FLAGFRAZ)))
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(imp_archope->NUMPROG)
len=12
name='_colleg
next=Icpitembatch.CPVarDecl
frm_calc='iif(not(Empty(LRTrim(_colleg))),'2',cFlagFraz)
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPIfElse
frm_calc=[
'tbcausana_mc.GoToKey(Left(LRTrim(imp_archope->CODANA)+Space(4),4)+Left(LRTrim(imp_archope->CODVOC)+Space(2),2))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='imp_archope->IMPIN
len=15
name='_totin
next=Icpitembatch.CPVarDecl
frm_calc='imp_archope->IMPOUT
len=15
name='_totout
next=Icpitembatch.CPBeginEnd
comment='Legge i dati del beneficiario
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='operazbo
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(_oldidb)))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cNumNew + 1
len=10
name='cNumNew
obj='Var
obj_type='N
pag=1
prev=O733
var_op='asgn
I
obj='If
pag=1
prev=O731
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O733
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='sogopebo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='clientiope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='beneficope
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='terzistiope
obj='Delete
pag=1
prev=O748
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=1
prev=O747
sel_field='*
sel_name='terzistiope
sel_where='terzistiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='terzistiope
father=O748
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
]
rd_kvar=[
'cOpeProg1
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=1
prev=O745
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=1
prev=O744
sel_field='*
sel_name='beneficope
sel_where='beneficope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='beneficope
father=O745
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
]
rd_kvar=[
'cOpeProg1
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=1
prev=O742
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=1
prev=O741
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='clientiope
father=O742
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=1
prev=O739
rd_kfield=[
'IDFILEBO
]
rd_kop=[
'=
]
rd_kvar=[
'_oldidb
]
I
obj='Select
pag=1
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='sogopebo
father=O739
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
]
rd_kvar=[
'cOpeProg1
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=1
prev=O729
rd_kfield=[
'AMMONT
'ANNOOPE
'AREAGEO
'C_CAB
'C_CAP
'C_CTA
'C_IND
'C_PRV
'C_RAG
'C_RAPPORTO
'C_STA
'CAMBIO
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'CONNALTRO
'CONNESBEN
'CONNESCLI
'CONNESOPER
'DATAIMP
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'DUCOLLEG
'DURAT
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'FLAGRAP2
'IDBASE
'idcauana
'IDEREG
'INFORM
'IPCOLLEG
'MODSVOL
'NATURA
'NUMPROG
'OPERAG
'OPERAZMOD
'OPRAP
'ORACOLLEG
'PAESE
'PAGASOGOP
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAGIO
'RAPPORTBEN
'RAPPORTO
'RAREA
'RCOMP
'RFREQ
'RIFIMP
'RIMP
'RRAGIO
'RTIPO
'SCOPO
'SEGNO
'STATOREG
'TIPO
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'UNIQUECODE
'VALUTA
'ZCPARTE
'COLLEG
'IDBASE2
'IMPIN
'IMPOUT
]
rd_kvar=[
'imp_archope->AMMONT
'Val(Right(imp_archope->DATAOPE,4))
'arfn_conv_stato_uic(Left(LRTrim(imp_archope->AREAGEO),3))
'_bencab
'Left(_bencap,5)
'_bencta
'_benind
'_benprv
'_benrag
'imp_archope->C_RAPPORTO
'_bensta
'Val(imp_archope->CAMBIO) / 10000
'Right(imp_archope->DATAOPE,4)+Substr(imp_archope->DATAOPE,3,2)+Left(imp_archope->DATAOPE,2)
'Right(imp_archope->DATAOPE,4)+Substr(imp_archope->DATAOPE,3,2)+Left(imp_archope->DATAOPE,2)
'DateToChar(_datareg)
'imp_archope->CODANA
'_intercab
'imp_archope->CODCAB2
'imp_archope->CODDIPE
'imp_archope->CODINT2
'_intercod
'imp_archope->CODVOC
'imp_archope->CONNALTRO
'imp_archope->CONNESBEN
'imp_archope->CONNESCLI
'imp_archope->CONNESOPER
'CharToDate(Right(imp_archope->DATAIMP,4)+Substr(imp_archope->DATAIMP,3,2)+Left(imp_archope->DATAIMP,2))
'CharToDate(Right(imp_archope->DATAOPE,4)+Substr(imp_archope->DATAOPE,3,2)+Left(imp_archope->DATAOPE,2))
'_datareg
'_datarett
'imp_archope->DESC2
'_intercit
'imp_archope->DESCINTER
'imp_archope->DUCOLLEG
'imp_archope->DURAT
'cFlagCont
'cFlagFraz
'cFlagLire
'imp_archope->FLAGRAP
'_flagrap2
'cOpeProg1
'cIdCau
'"O"+Right(cOpeProg2,9)+_idb2
'imp_archope->INFORM
'imp_archope->IPCOLLEG
'imp_archope->MODSVOL
'imp_archope->NATURA
'cOpeProg2
'imp_archope->AGOPER
'_idreg
''1'
'CharToDateTime(Substr(imp_archope->ORACOLLEG,5,4)+Substr(imp_archope->ORACOLLEG,3,2)+Left(imp_archope->ORACOLLEG,2)+Substr(imp_archope->ORACOLLEG,9,6))
'arfn_conv_stato_uic(imp_archope->PAESE)
'imp_archope->PAGASOGOP
'nProgImp
'imp_archope->PROV2
'_interprv
'imp_archope->RAGIO
'imp_archope->RAPPORTBEN
'imp_archope->RAPPORTO
'imp_archope->RAREA
'imp_archope->RCOMP
'imp_archope->RFREQ
'imp_archope->RIFIMP
'imp_archope->RIMP
'imp_archope->RRAGIO
'imp_archope->RTIPO
'imp_archope->SCOPO
'imp_archope->SEGNO
'_statoreg
'Left(LRTrim(imp_archope->TIPO),3)
''1'
'imp_archope->TIPOINT2
'imp_archope->TIPOINTER
'imp_archope->TIPOLEG
'imp_archope->TIPOOPRAP
'Val(imp_archope->TOTCONT)
'Val(imp_archope->TOTLIRE)
'imp_archope->UNIQUECODE
'imp_archope->VALUTA
'imp_archope->ZCPARTE
'_colleg
'_idb2
'_totin / 100
'_totout / 100
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O731
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nella tabella delle operazioni per l'operazione in data "+CharToDate(imp_archope->DATAOPE)+" con importo "+Str((Val(imp_archope->TOTLIRE))/100,14,2)+". L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''%1'
msg_parms=[
'gMsgProc
]
next=Icpitembatch.CPExec
check='man
frm_calc='m_cLastMsgError = "";
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=1
prev=O798
I
obj='Var
obj_type='N
pag=1
prev=O797
var_op='asgn
I
obj='Exec
pag=1
prev=O795
I
obj='Transaction
pag=1
prev=O794
I
obj='ExitLoop
pag=1
prev=O793
I
obj='Var
obj_type='N
pag=1
prev=O792
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Begin
pag=1
prev=O728
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O729
fatherSonIndex=0
frm_calc='Upper(imp_archope->C_RAG)
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='arfn_conv_stato_uic(imp_archope->C_STA)
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='Upper(imp_archope->C_CTA)
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='imp_archope->C_CAB
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='Upper(imp_archope->C_PRV)
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='Upper(imp_archope->C_IND)
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='Upper(imp_archope->C_CAP)
len=5
name='_bencap
next=Icpitembatch.CPIfElse
frm_calc=[
'_bensta = '086' and Empty(_bencab) 
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(imp_archope->CONNESBEN))) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(imp_archope->CONNESBEN)) and Empty(LRTrim(_benrag+_bensta+_bencta+_bencab+_benprv+_benind+_bencap)) and _frapcli='S'
]
h=[
19
19
]
obj='If
pag=1
prev=O813
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O816
fatherSonIndex=0
frm_calc=[
'not(Empty(LRTrim(imp_archope->RAPPORTO)))
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O821
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=1
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=imp_archope->RAPPORTO
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O826
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=1
prev=O837
I
obj='Read
pag=1
prev=O836
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'intestbo->CODINTER
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=1
prev=O835
var_op='asgn
I
obj='Var
pag=1
prev=O834
var_op='asgn
I
obj='Var
pag=1
prev=O833
var_op='asgn
I
obj='Var
pag=1
prev=O832
var_op='asgn
I
obj='Var
pag=1
prev=O831
var_op='asgn
I
obj='Var
pag=1
prev=O830
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O810
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O813
fatherSonIndex=0
frm_calc='''
len=70
name='_benrag
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_bensta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_bencta
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='''
len=35
name='_benind
next=Icpitembatch.CPVarDecl
frm_calc='''
len=5
name='_bencap
next=Icpitembatch.CPRead
arch='personbo
obj='Read
pag=1
prev=O854
rd_field=[
'CODCAB
'RAGSOC
'DOMICILIO
'DESCCIT
'PROVINCIA
'PAESE
'CAP
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'imp_archope->CONNESBEN
]
rd_var=[
'_bencab
'_benrag
'_benind
'_bencta
'_benprv
'_bensta
'_bencap
]
I
obj='Var
pag=1
prev=O853
var_op='asgn
I
obj='Var
pag=1
prev=O852
var_op='asgn
I
obj='Var
pag=1
prev=O851
var_op='asgn
I
obj='Var
pag=1
prev=O850
var_op='asgn
I
obj='Var
pag=1
prev=O849
var_op='asgn
I
obj='Var
pag=1
prev=O848
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O809
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPForEach
father=O810
fatherSonIndex=0
for_variable='RowMCCitta
for_variable_type='tbcitta
h=[
19
19
]
iterator_expr='tbcitta_mc
obj='ForEach
orderby_expr='CITTA
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O863
fatherSonIndex=0
frm_calc='RowMCCitta.CAB
len=6
name='_bencab
next=Icpitembatch.CPVarDecl
frm_calc='RowMCCitta.PROV
len=2
name='_benprv
next=Icpitembatch.CPVarDecl
frm_calc='RowMCCitta.CAP
len=5
name='_bencap
obj='Var
pag=1
prev=O868
var_op='asgn
I
obj='Var
pag=1
prev=O867
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
where_expr='_bencta=tbcitta_mc.CITTA
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O808
var_op='asgn
I
obj='Var
pag=1
prev=O807
var_op='asgn
I
obj='Var
pag=1
prev=O806
var_op='asgn
I
obj='Var
pag=1
prev=O805
var_op='asgn
I
obj='Var
pag=1
prev=O804
var_op='asgn
I
obj='Var
pag=1
prev=O803
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O727
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O726
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O723
var_op='asgn
I
obj='If
pag=1
prev=O722
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O723
fatherSonIndex=0
frm_calc='tbcausana_mc.idbase
len=4
name='cIdCau
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O721
var_op='asgn
I
obj='Var
pag=1
prev=O720
var_op='asgn
I
obj='Var
pag=1
prev=O719
var_op='asgn
I
obj='Var
pag=1
prev=O718
var_op='asgn
I
obj='Var
pag=1
prev=O717
var_op='asgn
I
obj='Var
obj_type='D
pag=1
prev=O714
var_op='asgn
I
obj='Case
pag=1
prev=O713
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O714
fatherSonIndex=0
frm_calc=''1'
len=1
name='cFlagLire
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O714
fatherSonIndex=1
frm_calc=[
'imp_archope->FLAGLIRE = 'E'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O881
fatherSonIndex=0
frm_calc=''3'
len=1
name='cFlagLire
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O881
fatherSonIndex=1
frm_calc='imp_archope->FLAGLIRE
len=1
name='cFlagLire
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O714
fatherSonIndex=2
frm_calc='imp_archope->FLAGLIRE
len=1
name='cFlagLire
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
pag=1
prev=O712
var_op='asgn
I
obj='Var
pag=1
prev=O709
var_op='asgn
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O709
fatherSonIndex=0
frm_calc='_numprog
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''1'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='Date()
len=8
name='_datarett
obj='Var
obj_type='D
pag=1
prev=O896
var_op='asgn
I
obj='Var
pag=1
prev=O895
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O709
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("POPERAZ2\'"+LRTrim(gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc=''0'
len=1
name='_statoreg
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_datarett
obj='Var
obj_type='D
pag=1
prev=O900
var_op='asgn
I
obj='Var
pag=1
prev=O899
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O698
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O701
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(imp_archope->DATAOPE)) or IsNull(imp_archope->DATAOPE)
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O906
fatherSonIndex=0
frm_calc='cNumNew + 1
len=10
name='cNumNew
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=1
prev=O911
sel_field='operazbo->IDBASE
sel_name='operazbo
sel_where='operazbo->NUMPROG=_numprog and (operazbo->STATOREG='0'  or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Messaggio Import
father=O912
fatherSonIndex=0
frm_calc='"E' stata cancellata l'operazione con codice "+_numprog
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPWrite
arch='operazbo
obj='Write
pag=1
prev=O916
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'operazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
]
wr_op=[
'=
'=
]
wr_var=[
''2'
'Date()
]
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='stringa di valori di flagrap2
father=O906
fatherSonIndex=1
frm_calc=''ABCDEFGHI'
len=9
name='stringaflagrap2
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
frm_calc='"E' stata variata l'operazione con codice "+_numprog
global=True
len=10
name='gMsgImp
next=Icpitembatch.CPRemark
frm_calc='Stranezza su idreg da vericare se corretto averlo aggiunto nella quey sottostante
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=1
prev=O928
sel_field='operazbo->IDBASE,operazbo->NUMPROG,operazbo->DATAOPE,operazbo->FLAGRAP2,operazbo->IDEREG
sel_name='operazbo
sel_where='operazbo->NUMPROG=_numprog and (operazbo->STATOREG='0'  or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O929
fatherSonIndex=0
frm_calc='operazbo->IDBASE
len=10
name='_oldidb
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(operazbo->FLAGRAP2) or operazbo->FLAGRAP2='S',Left(stringaflagrap2,1),Substr(stringaflagrap2,(At(operazbo->FLAGRAP2,stringaflagrap2)+1),1))
len=1
name='_flagrap2
next=Icpitembatch.CPVarDecl
frm_calc='operazbo->IDEREG
len=20
name='_idreg
next=Icpitembatch.CPWrite
arch='operazbo
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=1
prev=O941
sel_field='*
sel_name='terzistiope
sel_where='terzistiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='merzistiope
father=O943
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'IDFILEBO
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'IDREG
]
rd_kvar=[
'_oldidb
'terzistiope->CODSOG
'terzistiope->TIPOFILE
'terzistiope->NUMCOL
'terzistiope->LEGAME
'terzistiope->RAPCOL
'terzistiope->UCODE
'terzistiope->IDBASE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=1
prev=O939
sel_field='*
sel_name='beneficope
sel_where='beneficope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='meneficope
father=O941
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'TIPOFILE
'NUMCOL
'LEGAME
'RAPCOL
'UCODE
'IDBASE
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'C_RAPPORTO
'IDREG
]
rd_kvar=[
'_oldidb
'beneficope->CPROWNUM
'beneficope->CODSOG
'beneficope->TIPOFILE
'beneficope->NUMCOL
'beneficope->LEGAME
'beneficope->RAPCOL
'beneficope->UCODE
'beneficope->IDBASE
'beneficope->C_RAG
'beneficope->C_STA
'beneficope->C_CTA
'beneficope->C_CAB
'beneficope->C_PRV
'beneficope->C_IND
'beneficope->C_CAP
'beneficope->C_RAPPORTO
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=1
prev=O937
sel_field='*
sel_name='clientiope
sel_where='clientiope->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mlientiope
father=O939
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'IDFILEBO
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'clientiope->CODSOG
'clientiope->LEGAME
'clientiope->IDBASE
'clientiope->NUMCOL
'clientiope->TIPOFILE
'clientiope->RAPCOL
'clientiope->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=1
prev=O936
sel_field='*
sel_name='sogopebo
sel_where='sogopebo->IDFILEBO=_oldidb
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='mogopebo
father=O937
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'IDFILEBO
'CPROWNUM
'CODSOG
'LEGAME
'IDBASE
'NUMCOL
'TIPOFILE
'RAPCOL
'UCODE
'IDREG
]
rd_kvar=[
'_oldidb
'sogopebo->CPROWNUM
'sogopebo->CODSOG
'sogopebo->LEGAME
'sogopebo->IDBASE
'sogopebo->NUMCOL
'sogopebo->TIPOFILE
'sogopebo->RAPCOL
'sogopebo->UCODE
'_idreg
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=1
prev=O935
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'operazbo->IDBASE
]
wr_field=[
'STATOREG
'DATARETT
'FLAGRAP2
]
wr_op=[
'=
'=
'=
]
wr_var=[
''3'
'Date()
'_flagrap2
]
I
obj='Var
pag=1
prev=O934
var_op='asgn
I
obj='Var
pag=1
prev=O933
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=1
prev=O927
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O926
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O697
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O698
fatherSonIndex=0
frm_calc=[
'Upper(imp_archope->RIFIMP)='XXXXXXXXX'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O980
fatherSonIndex=0
h=[
19
19
]
obj='Select
pag=1
sel_field='operazbo->NUMPROG
sel_name='operazbo
sel_where='operazbo->INFORM = imp_archope->INFORM and (operazbo->STATOREG='0' or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O985
fatherSonIndex=0
frm_calc='operazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O980
fatherSonIndex=1
h=[
19
19
]
obj='Select
pag=1
sel_field='operazbo->NUMPROG
sel_name='operazbo
sel_where='operazbo->RIFIMP = imp_archope->RIFIMP and (operazbo->STATOREG='0' or operazbo->STATOREG='1')
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O992
fatherSonIndex=0
frm_calc='operazbo->NUMPROG
len=11
name='_numprog
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O696
var_op='asgn
I
obj='Var
pag=1
prev=O695
var_op='asgn
I
obj='Var
pag=1
prev=O694
var_op='asgn
I
obj='Var
pag=1
prev=O691
var_op='asgn
I
obj='If
pag=1
prev=O690
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='operazbo
father=O691
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_unicode)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O1002
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1003
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nella tabella delle operazioni per l'operazione in data "+CharToDate(imp_archope->DATAOPE)+" con importo "+Str((Val(imp_archope->TOTLIRE))/100,14,2)+". L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''%1'
msg_parms=[
'gMsgProc
]
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=1
prev=O1010
I
obj='Transaction
pag=1
prev=O1009
I
obj='Var
obj_type='N
pag=1
prev=O1008
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=1
rd_field=[
'UNIQUECODE
]
rd_kfield=[
'UNIQUECODE
]
rd_kvar=[
'imp_archope->UNIQUECODE
]
rd_var=[
'_unicode
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O689
var_op='asgn
I
obj='Remark
pag=1
prev=O686
I
obj='If
pag=1
prev=O684
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O686
fatherSonIndex=0
frm_calc=[
'anadip_mc.GoToKey(imp_archope->CODDIPE)
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(imp_archope->DESCCIT)+LRTrim(imp_archope->CODCAB)+LRTrim(imp_archope->PROVINCIA)))
]
h=[
19
19
]
obj='If
pag=1
prev=O1021
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1024
fatherSonIndex=0
frm_calc='LRTrim(imp_archope->DESCCIT)
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(imp_archope->CODCAB)
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(imp_archope->PROVINCIA)
len=2
name='_interprv
obj='Var
pag=1
prev=O1030
var_op='asgn
I
obj='Var
pag=1
prev=O1029
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1021
fatherSonIndex=0
frm_calc='anadip_mc.CODDIP
len=6
name='_coddip
next=Icpitembatch.CPVarDecl
frm_calc='anadip_mc.DESCCIT
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='anadip_mc.CAB
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='anadip_mc.PROVINCIA
len=2
name='_interprv
obj='Var
pag=1
prev=O1037
var_op='asgn
I
obj='Var
pag=1
prev=O1036
var_op='asgn
I
obj='Var
pag=1
prev=O1035
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1021
fatherSonIndex=1
frm_calc='gMsgProc +"Rilevati errori nella tabella delle operazioni per l'operazione in data "+CharToDate(imp_archope->DATAOPE)+" con importo "+Str((Val(imp_archope->TOTLIRE))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(imp_archope->CODDIPE)+" non è prensente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=1
prev=O1041
I
obj='Var
obj_type='N
pag=1
prev=O1040
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O684
fatherSonIndex=0
frm_calc='iif(Empty(LRTrim(imp_archope->CODINTER)),_codinter,imp_archope->CODINTER)
len=11
name='_intercod
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(imp_archope->DESCCIT)),_citinter,imp_archope->DESCCIT)
len=30
name='_intercit
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(imp_archope->CODCAB)),_cabinter,imp_archope->CODCAB)
len=6
name='_intercab
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(LRTrim(imp_archope->PROVINCIA)),_prvinter,imp_archope->PROVINCIA)
len=2
name='_interprv
obj='Var
pag=1
prev=O1049
var_op='asgn
I
obj='Var
pag=1
prev=O1048
var_op='asgn
I
obj='Var
pag=1
prev=O1047
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Memori cursor per errori
father=O679
fatherSonIndex=1
frm_seek='AppendBlank
name='mcErrori
next=Icpitembatch.CPVarDecl
comment='Memori cursor per errori
frm_calc='imp_archope->INFORM
frm_seek='nomearch
name='mcErrori
next=Icpitembatch.CPVarDecl
comment='Memori cursor per errori
frm_calc='1
frm_seek='numriga
name='mcErrori
next=Icpitembatch.CPVarDecl
comment='Memori cursor per errori
frm_seek='SaveRow
name='mcErrori
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_opeerr
obj='Var
obj_type='N
pag=1
prev=O1056
var_op='asgn
I
obj='Var
obj_type='MC
pag=1
prev=O1055
var_op='meth
I
obj='Var
obj_type='MC
pag=1
prev=O1054
var_op='prop
I
obj='Var
obj_type='MC
pag=1
prev=O1053
var_op='prop
I
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
150
]
I
obj='Begin
pag=1
prev=O675
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O677
fatherSonIndex=0
frm_calc='''
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_findsub
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(imp_archope->CONNESCLI)))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(imp_archope->CONNESOPER))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(imp_archope->CONNESBEN))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(imp_archope->CONNALTRO))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(imp_archope->CONNESCLI)) and Empty(LRTrim(imp_archope->RAPPORTO)) and _findsub = 1
]
h=[
19
19
]
obj='If
pag=1
prev=O1072
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1075
fatherSonIndex=0
frm_calc=''Rapporto continuativo o Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_generr
obj='Var
obj_type='N
pag=1
prev=O1081
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O1080
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O1069
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1072
fatherSonIndex=0
frm_calc=[
'not(personbo_mc.GoToKey(imp_archope->CONNALTRO))
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1086
fatherSonIndex=0
frm_calc='iif(Empty(_descerr),'Anagrafica Soggetto per conto del quale assente',_descerr+' Anagrafica Soggetto per conto del quale assente')
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_generr
obj='Var
obj_type='N
pag=1
prev=O1092
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O1091
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O1066
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1069
fatherSonIndex=0
frm_calc=[
'not(personbo_mc.GoToKey(imp_archope->CONNESBEN))
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1098
fatherSonIndex=0
frm_calc='iif(Empty(_descerr),'Anagrafica Controparte Operazione assente',_descerr+' Anagrafica Controparte Operazione assente')
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_generr
obj='Var
obj_type='N
pag=1
prev=O1104
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O1103
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O1063
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1066
fatherSonIndex=0
frm_calc=[
'not(personbo_mc.GoToKey(imp_archope->CONNESOPER))
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1110
fatherSonIndex=0
frm_calc='iif(Empty(_descerr),'Anagrafica Soggetto Operante Operazione assente',_descerr+' Anagrafica Soggetto Operante Operazione assente')
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_generr
obj='Var
obj_type='N
pag=1
prev=O1116
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O1115
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O1062
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1063
fatherSonIndex=0
frm_calc=[
'not(personbo_mc.GoToKey(LRTrim(imp_archope->CONNESCLI)))
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1122
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente. Inform: '+imp_archope->INFORM
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_generr
obj='Var
obj_type='N
pag=1
prev=O1128
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O1127
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O1061
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Message
pag=1
prev=O674
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O673
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O93
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=1
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=1
prev=O91
I
obj='Var
obj_type='N
pag=1
prev=O90
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
prev=O89
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O88
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
prev=O86
var_op='asgn
I
obj='Select
pag=1
prev=O85
sel_field='*
sel_name='intermbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O86
fatherSonIndex=0
frm_calc='intermbo->CODINTER
len=11
name='_codinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->DESCCIT
len=30
name='_citinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->CODCAB
len=6
name='_cabinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->PROVINCIA
len=2
name='_prvinter
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->FLGOPEXTR
len=1
name='_flgmodi
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->FLGDATAIM
len=1
name='_flgdataim
next=Icpitembatch.CPVarDecl
frm_calc='intermbo->FLGRAPCLI
len=1
name='_frapcli
obj='Var
pag=1
prev=O1144
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O1143
var_op='asgn
I
obj='Var
pag=1
prev=O1142
var_op='asgn
I
obj='Var
pag=1
prev=O1141
var_op='asgn
I
obj='Var
pag=1
prev=O1140
var_op='asgn
I
obj='Var
pag=1
prev=O1139
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O84
I
obj='Var
obj_type='N
pag=1
prev=O83
I
obj='Var
obj_type='N
pag=1
prev=O82
I
obj='Var
obj_type='N
pag=1
prev=O81
I
obj='Var
obj_type='N
pag=1
prev=O80
I
obj='Var
obj_type='N
pag=1
prev=O79
I
obj='Var
obj_type='N
pag=1
prev=O78
I
obj='Var
obj_type='N
pag=1
prev=O77
I
obj='Var
obj_type='N
pag=1
prev=O76
I
obj='Var
obj_type='N
pag=1
prev=O75
I
obj='Var
pag=1
prev=O74
I
obj='Var
pag=1
prev=O73
I
obj='Var
pag=1
prev=O72
I
obj='Var
pag=1
prev=O71
I
obj='Var
pag=1
prev=O70
I
obj='Var
pag=1
prev=O69
I
obj='Var
pag=1
prev=O68
I
obj='Var
pag=1
prev=O67
I
obj='Var
obj_type='D
pag=1
prev=O66
I
obj='Var
pag=1
prev=O65
I
obj='Var
pag=1
prev=O64
I
obj='Var
pag=1
prev=O63
I
obj='Var
obj_type='N
pag=1
prev=O62
I
obj='Var
obj_type='N
pag=1
prev=O61
I
obj='Var
obj_type='N
pag=1
prev=O60
I
obj='Var
obj_type='N
pag=1
prev=O59
I
obj='Var
pag=1
prev=O58
I
obj='Var
pag=1
prev=O57
I
obj='Var
pag=1
prev=O56
I
obj='Var
pag=1
prev=O55
I
obj='Var
obj_type='D
pag=1
prev=O54
I
obj='Var
pag=1
prev=O53
I
obj='Var
pag=1
prev=O52
I
obj='Var
pag=1
prev=O51
I
obj='Var
pag=1
prev=O50
I
obj='Var
pag=1
prev=O49
I
obj='Var
pag=1
prev=O48
I
obj='Var
pag=1
prev=O47
I
obj='Var
obj_type='N
pag=1
prev=O46
I
obj='Var
pag=1
prev=O45
I
obj='Var
pag=1
prev=O44
I
obj='Var
pag=1
prev=O43
I
obj='Var
pag=1
prev=O42
I
obj='Var
pag=1
prev=O41
I
obj='Var
obj_type='N
pag=1
prev=O40
I
obj='Var
pag=1
prev=O39
I
obj='Var
pag=1
prev=O38
I
obj='Var
obj_type='N
pag=1
prev=O37
I
nonlocal=True
obj='Var
pag=1
prev=O36
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O35
I
nonlocal=True
obj='Var
pag=1
prev=O33
I
obj='Begin
pag=1
prev=O32
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O33
fatherSonIndex=0
len=11
name='_codinter
next=Icpitembatch.CPVarDecl
len=30
name='_citinter
next=Icpitembatch.CPVarDecl
len=6
name='_cabinter
next=Icpitembatch.CPVarDecl
len=2
name='_prvinter
next=Icpitembatch.CPVarDecl
len=1
name='_flgmodi
next=Icpitembatch.CPVarDecl
len=1
name='_flgdataim
next=Icpitembatch.CPVarDecl
len=1
name='_frapcli
obj='Var
pag=1
prev=O1154
I
obj='Var
obj_type='N
pag=1
prev=O1153
I
obj='Var
pag=1
prev=O1152
I
obj='Var
pag=1
prev=O1151
I
obj='Var
pag=1
prev=O1150
I
obj='Var
pag=1
prev=O1149
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Exec
pag=1
prev=O31
I
obj='Message
pag=1
prev=O29
I
obj='Select
pag=1
prev=O28
sel_field='personbo->CONNES
sel_name='personbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='memory cursor dei connes delle anagrafiche
father=O29
fatherSonIndex=0
frm_calc='LRTrim(personbo->CONNES)
frm_seek='AppendWithKey
name='personbo_mc
next=Icpitembatch.CPVarDecl
comment='memory cursor dei connes delle anagrafiche
frm_calc='personbo->CONNES
frm_seek='connes
name='personbo_mc
next=Icpitembatch.CPVarDecl
frm_calc='_conteggio+1
len=3
name='_conteggio
next=Icpitembatch.CPMessage
frm_calc=''Generazione key su connes numero %1'
msg_parms=[
'_conteggio
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Mod(_conteggio,100)=0
]
h=[
19
19
]
obj='If
pag=1
prev=O1162
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1164
fatherSonIndex=0
frm_calc='System.out.println("Mcpersone  key "+_conteggio);
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Message
pag=1
prev=O1161
I
obj='Var
obj_type='N
pag=1
prev=O1160
var_op='asgn
I
obj='Var
obj_type='MC
pag=1
prev=O1159
var_op='prop
I
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Exec
pag=1
prev=O27
I
obj='Message
pag=1
prev=O26
I
obj='Var
obj_type='N
pag=1
prev=O25
var_op='asgn
I
obj='Message
pag=1
prev=O24
I
obj='Exec
pag=1
prev=O23
I
obj='Var
obj_type='N
pag=1
prev=O22
var_op='asgn
I
obj='MemoryCursor
pag=1
prev=O21
sel_field='*
sel_name='anadip
sel_type='fltb
I
obj='Message
pag=1
prev=O20
I
obj='Exec
pag=1
prev=O19
I
obj='Var
obj_type='N
pag=1
prev=O18
var_op='asgn
I
obj='MemoryCursor
pag=1
prev=O17
sel_name='tbcitta
sel_type='fltb
I
obj='Message
pag=1
prev=O16
I
obj='Exec
pag=1
prev=O15
I
obj='Var
obj_type='N
pag=1
prev=O14
var_op='asgn
I
obj='MemoryCursor
pag=1
prev=O13
sel_field='*
sel_name='tbcauana
sel_type='fltb
I
obj='Message
pag=1
prev=O12
I
obj='Var
obj_type='N
pag=1
prev=O11
I
obj='Var
obj_type='N
pag=1
prev=O10
I
obj='Var
obj_type='N
pag=1
prev=O9
I
obj='Var
obj_type='MC
pag=1
prev=O8
I
obj='Var
obj_type='MC
pag=1
prev=O7
I
obj='Var
obj_type='MC
pag=1
prev=O6
I
obj='Var
obj_type='MC
pag=1
prev=O5
I
obj='Var
obj_type='R
pag=1
prev=O4
I
obj='Var
obj_type='MC
pag=1
prev=O3
I
obj='Remark
pag=1
x=10
y=5
I
Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''%1'
msg_parms=[
'_descerr
]
obj='Transaction
pag=1
x=793
y=3438
I
Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''%1'
msg_parms=[
'_descerr
]
next=Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''%1'
msg_parms=[
'_descerr
]
obj='Transaction
pag=1
prev=O1174
I
obj='Transaction
pag=1
x=890
y=3642
I
Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''%1'
msg_parms=[
'_descerr
]
obj='Transaction
pag=1
x=1163
y=3828
I
Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''%1'
msg_parms=[
'_descerr
]
obj='Transaction
pag=1
x=1166
y=3963
I
Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''%1'
msg_parms=[
'_descerr
]
obj='Transaction
pag=1
x=1077
y=6160
I
Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''%1'
msg_parms=[
'_descerr
]
obj='Transaction
pag=1
x=1208
y=6267
I
Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''%1'
msg_parms=[
'_descerr
]
obj='Transaction
pag=1
x=1456
y=6374
I
Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''%1'
msg_parms=[
'_descerr
]
obj='Transaction
pag=1
x=1143
y=6891
I
Icpitembatch.CPTransaction
frm_calc='transaction error
frm_seek=''%1'
msg_parms=[
'_descerr
]
obj='Transaction
pag=1
x=1111
y=6995
I
Icpitembatch.CPMessage
frm_calc=''Creo MC persone'
next=Ispitembatch.CPMemoryCursor
data_source='mcConnes.MCRDef
expected_rows=340000
mem_curs_name='personbo_mc
next=Icpitembatch.CPVarDecl
frm_calc='personbo_mc.RecCount()
len=3
name='_conteggio2
next=Icpitembatch.CPExec
check='man
frm_calc='System.out.println("Mcpersone "+_conteggio2);
obj='Exec
pag=1
prev=O1194
I
obj='Var
obj_type='N
pag=1
prev=O1193
var_op='asgn
I
obj='MemoryCursor
pag=1
prev=O1192
sel_field='personbo->CONNES
sel_name='personbo
sel_order='personbo->CONNES
sel_type='fltb
I
obj='Message
pag=1
x=570
y=493
I
Icpitembatch.CPIfElse
frm_calc=[
'personbo_mc.RecCount()<>0
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
comment='memory cursor dei connes delle anagrafiche
father=O1196
fatherSonIndex=0
frm_seek='GoTop
name='personbo_mc
next=Icpitembatch.CPWhile
frm_calc='personbo_mc.RecNo()<personbo_mc.RecCount()
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='memory cursor dei connes delle anagrafiche
frm_calc='personbo_mc.connes
frm_seek='SetKey
name='personbo_mc
next=Icpitembatch.CPVarDecl
comment='memory cursor dei connes delle anagrafiche
frm_seek='SaveRow
name='personbo_mc
obj='Var
obj_type='MC
pag=1
prev=O1204
var_op='meth
I
obj='Var
obj_type='MC
pag=1
prev=O1202
var_op='meth
I
obj='While
pag=1
prev=O1201
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='memory cursor dei connes delle anagrafiche
father=O1202
fatherSonIndex=0
frm_calc='personbo_mc.connes
frm_seek='SetKey
name='personbo_mc
next=Icpitembatch.CPVarDecl
comment='memory cursor dei connes delle anagrafiche
frm_seek='SaveRow
name='personbo_mc
next=Icpitembatch.CPVarDecl
frm_calc='_conteggio+1
len=3
name='_conteggio
next=Icpitembatch.CPVarDecl
frm_calc='personbo_mc.RecNo()
len=3
name='_attuale
next=Icpitembatch.CPMessage
frm_calc=''Generazione key su connes numero %1 --- %2 / %3'
msg_parms=[
'_conteggio
'_attuale
'_conteggio2
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Mod(_conteggio,100)=0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='memory cursor dei connes delle anagrafiche
frm_seek='Skip
name='personbo_mc
obj='Var
obj_type='MC
pag=1
prev=O1214
var_op='meth
I
obj='If
pag=1
prev=O1212
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1214
fatherSonIndex=0
frm_calc='System.out.println("Mcpersone  key "+_conteggio+"  ---  "+_attuale+" / "+_conteggio2);
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Message
pag=1
prev=O1211
I
obj='Var
obj_type='N
pag=1
prev=O1210
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O1209
var_op='asgn
I
obj='Var
obj_type='MC
pag=1
prev=O1208
var_op='meth
I
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
]
x=837
y=1127
I
Icpitembatch.CPMessage
frm_calc=''Creo MC persone'
next=Ispitembatch.CPMemoryCursor
data_source='mcConnes.MCRDef
expected_rows=340000
key_expression='personbo->CONNES
mem_curs_name='personbo_mc
next=Icpitembatch.CPVarDecl
frm_calc='personbo_mc.RecCount()
len=3
name='_conteggio
next=Icpitembatch.CPExec
check='man
frm_calc='System.out.println("Mcpersone "+_conteggio);
obj='Exec
pag=1
prev=O1226
I
obj='Var
obj_type='N
pag=1
prev=O1225
var_op='asgn
I
obj='MemoryCursor
pag=1
prev=O1224
sel_field='personbo->CONNES
sel_name='personbo
sel_order='personbo->CONNES
sel_type='fltb
I
obj='Message
pag=1
x=590
y=349
I
Icpitembatch.CPIfElse
frm_calc=[
'personbo_mc.RecCount()<>0
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='memory cursor dei connes delle anagrafiche
father=O1228
fatherSonIndex=0
frm_seek='GoTop
name='personbo_mc
next=Icpitembatch.CPWhile
frm_calc='personbo_mc.RecNo()<personbo_mc.RecCount()
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='memory cursor dei connes delle anagrafiche
frm_calc='personbo_mc.connes
frm_seek='SetKey
name='personbo_mc
obj='Var
obj_type='MC
pag=1
prev=O1234
var_op='meth
I
obj='While
pag=1
prev=O1233
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='memory cursor dei connes delle anagrafiche
father=O1234
fatherSonIndex=0
frm_calc='personbo_mc.connes
frm_seek='SetKey
name='personbo_mc
next=Icpitembatch.CPVarDecl
comment='memory cursor dei connes delle anagrafiche
frm_seek='SaveRow
name='personbo_mc
next=Icpitembatch.CPVarDecl
frm_calc='_conteggio+1
len=3
name='_conteggio
next=Icpitembatch.CPExec
check='man
frm_calc='System.out.println("Mcpersone  key "+_conteggio);
next=Icpitembatch.CPMessage
frm_calc=''Generazione key su connes numero %1'
msg_parms=[
'_conteggio
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Mod(_conteggio,100)=0
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='memory cursor dei connes delle anagrafiche
frm_seek='Skip
name='personbo_mc
obj='Var
obj_type='MC
pag=1
prev=O1245
var_op='meth
I
obj='If
pag=1
prev=O1243
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1245
fatherSonIndex=0
frm_calc='System.out.println("Mcpersone  key "+_conteggio);
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Message
pag=1
prev=O1242
I
obj='Exec
pag=1
prev=O1241
I
obj='Var
obj_type='N
pag=1
prev=O1240
var_op='asgn
I
obj='Var
obj_type='MC
pag=1
prev=O1239
var_op='meth
I
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='MC
pag=1
var_op='meth
I
I
]
w=[
150
150
]
x=731
y=636
I
Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./appo/'+nomefileimport)
len=1
name='fhand
obj='Var
pag=1
var_op='asgn
x=615
y=1509
I
Icpitembatch.CPRead
arch='tbcitta
obj='Read
pag=1
rd_field=[
'CAB
'PROV
'CAP
]
rd_kfield=[
'CITTA
]
rd_kvar=[
'_bencta
]
rd_var=[
'_bencab
'_benprv
'_bencap
]
x=969
y=6792
I
Icpitembatch.CPExec
frm_calc='FileLibMit.WriteLine(ohand,riga+" - "+_descerr)
obj='Exec
pag=1
x=820
y=8746
I
Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,206,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,302,16)))) and _findsub=1
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(Substr(riga,484,16)))) and _findsub=1
]
h=[
19
19
]
obj='If
pag=1
prev=O1270
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1273
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=1
prev=O1279
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1280
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto per conto del quale assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=1
prev=O1285
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=1
prev=O1278
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,484,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O1267
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1270
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=1
prev=O1296
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1297
fatherSonIndex=0
frm_calc=''Anagrafica Controparte Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=1
prev=O1302
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=1
prev=O1295
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,302,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O1264
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1267
fatherSonIndex=0
frm_calc='''
len=16
name='_conadd
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_conadd))
]
h=[
19
19
]
obj='If
pag=1
prev=O1313
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1314
fatherSonIndex=0
frm_calc=''Anagrafica Soggetto Operante Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=1
prev=O1319
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=1
prev=O1312
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,206,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=1
prev=O1263
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1264
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=1
prev=O1329
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=1
prev=O1262
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'LRTrim(Substr(riga,190,16))
]
rd_var=[
'_conadd
]
I
obj='Var
pag=1
var_op='asgn
x=1255
y=956
I
Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='_coddip
next=Icpitembatch.CPRead
arch='anadip
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(_coddip)
]
h=[
19
19
]
obj='If
pag=1
prev=O1337
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1338
fatherSonIndex=0
frm_calc='gMsgProc +"Rilevati errori nel file "+nomefileimport+" per l'operazione in data "+CharToDate(Right(Left(riga,8),4)+Substr(Left(riga,8),3,2)+Left(Left(riga,8),2))+" con importo "+Str((Val(Substr(riga,160,15)))/100,14,2)+" si è indicata la dipendenza con codice: " + LRTrim(Substr(riga,257,6))+" non è prensente  in anagrafica dipendenze." +" Ricreare il file ARCHDIP e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annullata automaticamente."+ NL
global=True
len=120
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='1
len=1
name='_esito
next=Icpitembatch.CPExitLoop
obj='ExitLoop
pag=1
prev=O1344
I
obj='Var
obj_type='N
pag=1
prev=O1343
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=1
prev=O1336
rd_field=[
'DESCCIT
'CAB
'PROVINCIA
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'Substr(riga,257,6)
]
rd_var=[
'_intercit
'_intercab
'_interprv
'_coddip
]
I
obj='Var
pag=1
var_op='asgn
x=995
y=2146
I
Icpitembatch.CPRead
arch='tbcauana
obj='Read
pag=1
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,10,4)
'Substr(riga,14,2)
]
rd_var=[
'cIdCau
]
x=910
y=5850
I
Icpitembatch.CPVarDecl
len=16
name='_conadd
next=Icpitembatch.CPRemark
frm_calc='Variabile per le read su personbo
obj='Remark
pag=1
prev=O1356
I
obj='Var
pag=1
x=759
y=31
I
Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
next=Icpitembatch.CPForEach
for_variable='rowconnes
for_variable_type='mcConnes.MCRDef
h=[
19
19
]
iterator_expr='personbo_mc
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=0
]
h=[
19
19
]
obj='If
pag=1
prev=O1359
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1361
fatherSonIndex=0
frm_calc=''Anagrafica Intestatario Operazione assente'
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=1
prev=O1366
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=1
prev=O1358
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1359
fatherSonIndex=0
frm_calc='1
len=1
name='_findsub
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
where_expr='imp_archope->CONNESCLI=personbo_mc.connes
I
obj='Var
obj_type='N
pag=1
var_op='asgn
x=1003
y=2671
I
Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
next=Icpitembatch.CPForEach
for_variable='rowconnes
for_variable_type='mcConnes.MCRDef
h=[
19
19
]
iterator_expr='personbo_mc
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=0
]
h=[
19
19
]
obj='If
pag=1
prev=O1374
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1376
fatherSonIndex=0
frm_calc='iif(Empty(_descerr),'Anagrafica Soggetto Operante Operazione assente',_descerr+' Anagrafica Soggetto Operante Operazione assente')
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=1
prev=O1381
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=1
prev=O1373
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1374
fatherSonIndex=0
frm_calc='1
len=1
name='_findsub
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
where_expr='imp_archope->CONNESOPER=personbo_mc.connes
I
obj='Var
obj_type='N
pag=1
var_op='asgn
x=1046
y=2971
I
Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
next=Icpitembatch.CPForEach
for_variable='rowconnes
for_variable_type='mcConnes.MCRDef
h=[
19
19
]
iterator_expr='personbo_mc
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=0
]
h=[
19
19
]
obj='If
pag=1
prev=O1389
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1391
fatherSonIndex=0
frm_calc='iif(Empty(_descerr),'Anagrafica Soggetto per conto del quale assente',_descerr+' Anagrafica Soggetto per conto del quale assente')
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=1
prev=O1396
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=1
prev=O1388
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1389
fatherSonIndex=0
frm_calc='1
len=1
name='_findsub
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
where_expr='imp_archope->CONNALTRO=personbo_mc.connes
I
obj='Var
obj_type='N
pag=1
var_op='asgn
x=1049
y=3525
I
Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
next=Icpitembatch.CPForEach
for_variable='rowconnes
for_variable_type='mcConnes.MCRDef
h=[
19
19
]
iterator_expr='personbo_mc
next=Icpitembatch.CPIfElse
frm_calc=[
'_findsub=0
]
h=[
19
19
]
obj='If
pag=1
prev=O1404
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1406
fatherSonIndex=0
frm_calc='iif(Empty(_descerr),'Anagrafica Controparte Operazione assente',_descerr+' Anagrafica Controparte Operazione assente')
len=50
name='_descerr
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_findsub
obj='Var
obj_type='N
pag=1
prev=O1411
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='ForEach
pag=1
prev=O1403
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1404
fatherSonIndex=0
frm_calc='1
len=1
name='_findsub
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
where_expr='imp_archope->CONNESBEN=personbo_mc.connes
I
obj='Var
obj_type='N
pag=1
var_op='asgn
x=1042
y=3260
I
Icpitembatch.CPVarDecl
frm_calc='0
len=3
name='_conteggio
next=Icpitembatch.CPMessage
frm_calc=''Generazione key su connes'
next=Icpitembatch.CPExec
check='man
frm_calc='System.out.println("Mcpersone  key"+_conteggio);
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPMessage
frm_calc=''Fine generazione key su connes'
obj='Message
pag=1
prev=O1421
I
obj='Select
pag=1
prev=O1420
sel_field='personbo->CONNES
sel_name='personbo
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='row del connes dell'anagrafica
father=O1421
fatherSonIndex=0
frm_calc='personbo->CONNES
frm_seek='connes
name='personbo_row
next=Icpitembatch.CPVarDecl
comment='memory cursor dei connes delle anagrafiche
frm_calc='personbo->CONNES,personbo_row
frm_seek='AppendRowWithKey
name='personbo_mc
next=Icpitembatch.CPVarDecl
comment='memory cursor dei connes delle anagrafiche
frm_seek='SaveRow
name='personbo_mc
next=Icpitembatch.CPVarDecl
frm_calc='_conteggio+1
len=3
name='_conteggio
next=Icpitembatch.CPMessage
frm_calc=''Generazione key su connes numero %1'
msg_parms=[
'_conteggio
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Mod(_conteggio,100)=0
]
h=[
19
19
]
obj='If
pag=1
prev=O1430
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='man
father=O1432
fatherSonIndex=0
frm_calc='System.out.println("Mcpersone  key "+_conteggio);
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Message
pag=1
prev=O1429
I
obj='Var
obj_type='N
pag=1
prev=O1428
var_op='asgn
I
obj='Var
obj_type='MC
pag=1
prev=O1427
var_op='meth
I
obj='Var
obj_type='MC
pag=1
prev=O1426
var_op='meth
I
obj='Var
obj_type='R
pag=1
var_op='prop
I
I
]
w=[
150
150
]
I
obj='Exec
pag=1
prev=O1419
I
obj='Message
pag=1
prev=O1418
I
obj='Var
obj_type='N
pag=1
var_op='asgn
x=927
y=99
I
]
comment='Importazione da tabelle del DB
date_creat=#2015-12-17
date_rev=#2016-06-03
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'Utilities
]
modcnt=101
runtime_filters=2
tpl_name='Routine
work_file=[
'imp_archope
'operazbo
'sogopebo
'clientiope
'beneficope
'terzistiope
'intestbo
'personbo
'intermbo
'anadip
'tbcauana
'tbcitta
'mogopebo
'mlientiope
'meneficope
'merzistiope
'imp_archfraz
'fraziobo
'terzistifrz
'beneficfrz
'clientifrz
'sogopefbo
'mogopefbo
'mlientifrz
'meneficfrz
'merzistifrz
]
work_filter=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
I
*--*
*----*
