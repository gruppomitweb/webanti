* --- CodePainter Revolution Batch Vers. 5.1
￼Icpbatch.CPBatch
Items=[
Icpitembatch.CPBeginEnd
comment='Definizione variabili caller
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Definizione variabili locali
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili Locali
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Variabili globali
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='Utilities.SetUserCode(1)
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetCompany()
len=10
name='_oldazi
next=Icpitembatch.CPVarDecl
frm_calc=''Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + NL
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='0
len=1
name='_esito
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili caller
h=[
19
19
]
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(fileelab))
next=Icpitembatch.CPMessage
frm_calc='"%1"
msg_parms=[
'_gMsgProc
]
msg_type='Debug
obj='Message
pag=1
prev=O20
I
obj='Exec
pag=1
prev=O19
I
obj='Exec
pag=1
prev=O17
I
obj='Try
pag=1
prev=O16
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Import Dati
father=O17
fatherSonIndex=0
h=[
19
19
]
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Azzeramento archivi se richiesto
father=O25
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Contatore Operazioni
frm_calc='0
len=10
name='cNumOpe
next=Icpitembatch.CPVarDecl
comment='Contatore Rapporti
frm_calc='0
len=10
name='cNumRap
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='0
len=10
name='cNumPer
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='0
len=10
name='cNumInf
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='0
len=10
name='cNumTit
next=Icpitembatch.CPVarDecl
frm_calc='_gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + w_nomefile + NL
len=10
name='_gMsgProc
next=Icpitembatch.CPIfElse
frm_calc=[
'FileLibMit.ExistFile("conf.imp")
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O36
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O37
fatherSonIndex=0
frm_calc='FileLibMit.OpenRead('conf.imp')
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.ReadLine(fhand)
len=128
name='_pathfile
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPExec
check='man
frm_calc='// Cancella vecchi file esiti﷯File di = new File(CPLib.LRTrim(_pathfile)+"/");﷯File fl[] = di.listFiles();﷯int _i;﷯int count=0;﷯for (_i=0; _i < fl.length; _i++)  {﷯w_nomefile=fl[_i].toString();﷯//  fl[_i].delete();﷯}
next=Icpitembatch.CPIfElse
frm_calc=[
'At('.zip',Lower(w_nomefile)) <> 0
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenReadPath(LRTrim(fileelab))
len=1
name='fhand
next=Icpitembatch.CPCase
frm_calc=[
'w_tipoimp='M' or w_tipoimp='R'
'w_tipoimp='S'
]
h=[
19
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Messaggi finali
next=Icpitembatch.CPVarDecl
frm_calc='_gMsgProc + 'Soggetti Inseriti/Aggiornati: '+LRTrim(Str(cNumPer,10,0)) + ' dal file '+w_nomefile+NL
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='_gMsgProc + 'Rapporti Inseriti: '+LRTrim(Str(cNumRap,10,0)) + ' dal file '+w_nomefile+NL
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='_gMsgProc + 'Informazioni Inserite: '+LRTrim(Str(cNumInf,10,0)) + ' dal file '+w_nomefile+NL
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='_gMsgProc + 'Operazioni Inserite: '+LRTrim(Str(cNumOpe,10,0)) + ' dal file '+w_nomefile+NL
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='_gMsgProc + 'Titolari Inseriti: '+LRTrim(Str(cNumTit,10,0)) + ' dal file '+w_nomefile+NL
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='_gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +w_nomefile + NL
len=10
name='_gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=1
prev=O59
I
obj='Var
obj_type='M
pag=1
prev=O58
var_op='asgn
I
obj='Var
obj_type='M
pag=1
prev=O57
var_op='asgn
I
obj='Var
obj_type='M
pag=1
prev=O56
var_op='asgn
I
obj='Var
obj_type='M
pag=1
prev=O55
var_op='asgn
I
obj='Var
obj_type='M
pag=1
prev=O54
var_op='asgn
I
obj='Var
obj_type='M
pag=1
prev=O53
var_op='asgn
I
obj='Remark
pag=1
prev=O50
I
obj='Case
pag=1
prev=O49
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPDropTemporaryTable
father=O50
fatherSonIndex=0
next=Icpitembatch.CPDropTemporaryTable
next=Icpitembatch.CPDropTemporaryTable
next=Icpitembatch.CPDropTemporaryTable
next=Icpitembatch.CPServerTemporaryTable
next=Icpitembatch.CPServerTemporaryTable
next=Icpitembatch.CPServerTemporaryTable
next=Icpitembatch.CPServerTemporaryTable
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipoimp = 'M'
'w_tipoimp = 'R'
]
h=[
19
19
19
]
obj='If
pag=1
prev=O71
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPDelete
arch='tmp_operazbo_ol
father=O73
fatherSonIndex=0
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPDelete
arch='tmp_rapopebo_ol
next=Icpitembatch.CPWrite
arch='tmp_rapopebo_ol
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='tmp_rapopebo_ol
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='tmp_rapopebo_ol
next=Icpitembatch.CPInsert
arch='xnarapbo
next=Icpitembatch.CPInsert
arch='xapopebo
next=Icpitembatch.CPInsert
arch='xntestbo
obj='Insert
pag=1
prev=O90
sel_field='*
sel_name='tmp_intestbo_ol
sel_type='sql
I
obj='Insert
pag=1
prev=O89
sel_field='*
sel_name='tmp_rapopebo_ol
sel_type='sql
I
obj='Insert
pag=1
prev=O88
sel_field='*
sel_name='tmp_anarapbo
sel_type='sql
I
obj='Write
pag=1
prev=O86
rd_kfield=[
'TIPOOPRAP
]
rd_kop=[
'=
]
rd_kvar=[
''46'
]
wr_field=[
'TIPOOPRAP
]
wr_op=[
'=
]
wr_var=[
''45'
]
I
obj='Select
pag=1
prev=O85
sel_field='tmp_rapopebo_ol->RAPPORTO,tmp_rapopebo_ol->IDBASE,tmp_rapopebo_ol->DATAOPE,tmp_rapopebo_ol->NUMPROG
sel_name='tmp_rapopebo_ol
sel_where='tmp_rapopebo_ol->TIPOOPRAP='46'
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tmp_intestbo_ol
father=O86
fatherSonIndex=0
obj='Write
pag=1
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'tmp_rapopebo_ol->RAPPORTO
]
wr_field=[
'DATAINI
'DATAFINE
'NUMPROG1
'NUMPROG2
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'tmp_rapopebo_ol->DATAOPE
'NullDate()
'tmp_rapopebo_ol->NUMPROG
'''
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=1
prev=O83
rd_kfield=[
'TIPOOPRAP
]
rd_kop=[
'=
]
rd_kvar=[
''36'
]
wr_field=[
'TIPOOPRAP
]
wr_op=[
'=
]
wr_var=[
''35'
]
I
obj='Select
pag=1
prev=O82
sel_field='tmp_rapopebo_ol->RAPPORTO,tmp_rapopebo_ol->IDBASE,tmp_rapopebo_ol->DATAOPE,tmp_rapopebo_ol->NUMPROG
sel_name='tmp_rapopebo_ol
sel_where='tmp_rapopebo_ol->TIPOOPRAP='36'
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tmp_intestbo_ol
father=O83
fatherSonIndex=0
obj='Write
pag=1
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'tmp_rapopebo_ol->RAPPORTO
]
wr_field=[
'DATAINI
'DATAFINE
'NUMPROG1
'NUMPROG2
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'tmp_rapopebo_ol->DATAOPE
'NullDate()
'tmp_rapopebo_ol->NUMPROG
'''
]
I
I
]
w=[
150
150
]
I
obj='Write
pag=1
prev=O81
rd_kfield=[
'TIPOOPRAP
]
rd_kop=[
'=
]
rd_kvar=[
''28'
]
wr_field=[
'TIPOOPRAP
]
wr_op=[
'=
]
wr_var=[
''25'
]
I
obj='Delete
pag=1
prev=O79
rd_kfield=[
'TIPOOPRAP
'TIPOOPRAP
'TIPOOPRAP
]
rd_kop=[
'<>
'<>
'<>
]
rd_kvar=[
''28'
''36'
''46'
]
I
obj='Select
pag=1
prev=O78
sel_field='*
sel_name='tmp_rapopebo_ol
sel_where='tmp_rapopebo_ol->TIPOOPRAP='26'
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='tmp_intestbo_ol
father=O79
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='tmp_rapopebo_ol
next=Icpitembatch.CPDelete
arch='tmp_anarapbo
obj='Delete
pag=1
prev=O136
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'tmp_rapopebo_ol->RAPPORTO
]
I
obj='Delete
pag=1
prev=O135
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'tmp_rapopebo_ol->RAPPORTO
]
I
obj='Delete
pag=1
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'tmp_rapopebo_ol->RAPPORTO
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=1
rd_kfield=[
'1
]
rd_kop=[
'=
]
rd_kvar=[
'1
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='tmp_rapopebo_ol
father=O73
fatherSonIndex=1
next=Icpitembatch.CPDelete
arch='tmp_rapopebo_ol
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=1
prev=O153
sel_field='*
sel_name='tmp_operazbo_ol
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O154
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xperazbo
father=O158
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'IDBASE
'NUMPROG
'DATAOPE
'TIPOINTER
'CODINTER
'TIPOINF
'IDEREG
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'OPRAP
'TIPOOPRAP
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'STATOREG
'OPERAZMOD
'DATARETT
'CONNESCLI
'CONNESOPER
'CONNESBEN
'COLLEG
'CAMBIO
'RAPPORTBEN
'FLAGRAP2
'OPERATORE
'AUTOM
'idcauana
'OPERAG
'DOCFILE
'RESPINS
'INFORM
'CDATOPE
'NOPROT
'UCODE
'CDATAOPE
'ZCPARTE
'RAGIO
'MODSVOL
'AREAGEO
'RIFIMP
'SCOPO
'NATURA
'RTIPO
'RCOMP
'RIMP
'RFREQ
'RRAGIO
'RAREA
'TIPO
'PRGIMPOPE
'UNIQUECODE
'AMMONT
'DURAT
'CONNALTRO
'CONNESDOC
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'DATAIMP
'C_RAPPORTO
'PAGASOGOP
'MTCN
'IDFILE
'CDATREG
]
rd_kvar=[
'tmp_operazbo_ol->IDBASE
'tmp_operazbo_ol->NUMPROG
'tmp_operazbo_ol->DATAOPE
'tmp_operazbo_ol->TIPOINTER
'tmp_operazbo_ol->CODINTER
'tmp_operazbo_ol->TIPOINF
'tmp_operazbo_ol->IDEREG
'tmp_operazbo_ol->CODDIPE
'tmp_operazbo_ol->DESCCIT
'tmp_operazbo_ol->PROVINCIA
'tmp_operazbo_ol->CODCAB
'tmp_operazbo_ol->FLAGFRAZ
'tmp_operazbo_ol->FLAGCONT
'tmp_operazbo_ol->CODANA
'tmp_operazbo_ol->CODVOC
'tmp_operazbo_ol->TIPOINT2
'tmp_operazbo_ol->CODINT2
'tmp_operazbo_ol->PAESE
'tmp_operazbo_ol->DESC2
'tmp_operazbo_ol->PROV2
'tmp_operazbo_ol->CODCAB2
'tmp_operazbo_ol->DESCINTER
'tmp_operazbo_ol->RAPPORTO
'tmp_operazbo_ol->FLAGRAP
'tmp_operazbo_ol->TIPOLEG
'Date()
'tmp_operazbo_ol->OPRAP
'tmp_operazbo_ol->TIPOOPRAP
'tmp_operazbo_ol->FLAGLIRE
'tmp_operazbo_ol->VALUTA
'tmp_operazbo_ol->SEGNO
'tmp_operazbo_ol->TOTLIRE
'tmp_operazbo_ol->TOTCONT
'tmp_operazbo_ol->STATOREG
'tmp_operazbo_ol->OPERAZMOD
'tmp_operazbo_ol->DATARETT
'tmp_operazbo_ol->CONNESCLI
'tmp_operazbo_ol->CONNESOPER
'tmp_operazbo_ol->CONNESBEN
'tmp_operazbo_ol->COLLEG
'tmp_operazbo_ol->CAMBIO
'tmp_operazbo_ol->RAPPORTBEN
'tmp_operazbo_ol->FLAGRAP2
'tmp_operazbo_ol->OPERATORE
'tmp_operazbo_ol->AUTOM
'tmp_operazbo_ol->idcauana
'tmp_operazbo_ol->OPERAG
'tmp_operazbo_ol->DOCFILE
'tmp_operazbo_ol->RESPINS
'tmp_operazbo_ol->INFORM
'tmp_operazbo_ol->CDATOPE
'tmp_operazbo_ol->NOPROT
'tmp_operazbo_ol->UCODE
'tmp_operazbo_ol->CDATAOPE
'tmp_operazbo_ol->ZCPARTE
'tmp_operazbo_ol->RAGIO
'tmp_operazbo_ol->MODSVOL
'tmp_operazbo_ol->AREAGEO
'tmp_operazbo_ol->RIFIMP
'tmp_operazbo_ol->SCOPO
'tmp_operazbo_ol->NATURA
'tmp_operazbo_ol->RTIPO
'tmp_operazbo_ol->RCOMP
'tmp_operazbo_ol->RIMP
'tmp_operazbo_ol->RFREQ
'tmp_operazbo_ol->RRAGIO
'tmp_operazbo_ol->RAREA
'tmp_operazbo_ol->TIPO
'tmp_operazbo_ol->PRGIMPOPE
'tmp_operazbo_ol->UNIQUECODE
'tmp_operazbo_ol->AMMONT
'tmp_operazbo_ol->DURAT
'tmp_operazbo_ol->CONNALTRO
'tmp_operazbo_ol->CONNESDOC
'tmp_operazbo_ol->C_RAG
'tmp_operazbo_ol->C_STA
'tmp_operazbo_ol->C_CTA
'tmp_operazbo_ol->C_CAB
'tmp_operazbo_ol->C_PRV
'tmp_operazbo_ol->C_IND
'tmp_operazbo_ol->C_CAP
'tmp_operazbo_ol->DATAIMP
'tmp_operazbo_ol->C_RAPPORTO
'tmp_operazbo_ol->PAGASOGOP
'tmp_operazbo_ol->MTCN
'tmp_operazbo_ol->IDFILE
'tmp_operazbo_ol->CDATREG
]
sel_field='*
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='operazbo
father=O158
fatherSonIndex=1
obj='Insert
pag=1
rd_kfield=[
'IDBASE
'NUMPROG
'DATAOPE
'TIPOINTER
'CODINTER
'TIPOINF
'IDEREG
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'OPRAP
'TIPOOPRAP
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'STATOREG
'OPERAZMOD
'DATARETT
'CONNESCLI
'CONNESOPER
'CONNESBEN
'COLLEG
'CAMBIO
'RAPPORTBEN
'FLAGRAP2
'OPERATORE
'AUTOM
'idcauana
'OPERAG
'DOCFILE
'RESPINS
'INFORM
'CDATOPE
'NOPROT
'UCODE
'CDATAOPE
'ZCPARTE
'RAGIO
'MODSVOL
'AREAGEO
'RIFIMP
'SCOPO
'NATURA
'RTIPO
'RCOMP
'RIMP
'RFREQ
'RRAGIO
'RAREA
'TIPO
'PRGIMPOPE
'UNIQUECODE
'AMMONT
'DURAT
'CONNALTRO
'CONNESDOC
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
'DATAIMP
'C_RAPPORTO
'PAGASOGOP
'MTCN
'IDFILE
'CDATREG
]
rd_kvar=[
'tmp_operazbo_ol->IDBASE
'tmp_operazbo_ol->NUMPROG
'tmp_operazbo_ol->DATAOPE
'tmp_operazbo_ol->TIPOINTER
'tmp_operazbo_ol->CODINTER
'tmp_operazbo_ol->TIPOINF
'tmp_operazbo_ol->IDEREG
'tmp_operazbo_ol->CODDIPE
'tmp_operazbo_ol->DESCCIT
'tmp_operazbo_ol->PROVINCIA
'tmp_operazbo_ol->CODCAB
'tmp_operazbo_ol->FLAGFRAZ
'tmp_operazbo_ol->FLAGCONT
'tmp_operazbo_ol->CODANA
'tmp_operazbo_ol->CODVOC
'tmp_operazbo_ol->TIPOINT2
'tmp_operazbo_ol->CODINT2
'tmp_operazbo_ol->PAESE
'tmp_operazbo_ol->DESC2
'tmp_operazbo_ol->PROV2
'tmp_operazbo_ol->CODCAB2
'tmp_operazbo_ol->DESCINTER
'tmp_operazbo_ol->RAPPORTO
'tmp_operazbo_ol->FLAGRAP
'tmp_operazbo_ol->TIPOLEG
'Date()
'tmp_operazbo_ol->OPRAP
'tmp_operazbo_ol->TIPOOPRAP
'tmp_operazbo_ol->FLAGLIRE
'tmp_operazbo_ol->VALUTA
'tmp_operazbo_ol->SEGNO
'tmp_operazbo_ol->TOTLIRE
'tmp_operazbo_ol->TOTCONT
'tmp_operazbo_ol->STATOREG
'tmp_operazbo_ol->OPERAZMOD
'tmp_operazbo_ol->DATARETT
'tmp_operazbo_ol->CONNESCLI
'tmp_operazbo_ol->CONNESOPER
'tmp_operazbo_ol->CONNESBEN
'tmp_operazbo_ol->COLLEG
'tmp_operazbo_ol->CAMBIO
'tmp_operazbo_ol->RAPPORTBEN
'tmp_operazbo_ol->FLAGRAP2
'tmp_operazbo_ol->OPERATORE
'tmp_operazbo_ol->AUTOM
'tmp_operazbo_ol->idcauana
'tmp_operazbo_ol->OPERAG
'tmp_operazbo_ol->DOCFILE
'tmp_operazbo_ol->RESPINS
'tmp_operazbo_ol->INFORM
'tmp_operazbo_ol->CDATOPE
'tmp_operazbo_ol->NOPROT
'tmp_operazbo_ol->UCODE
'tmp_operazbo_ol->CDATAOPE
'tmp_operazbo_ol->ZCPARTE
'tmp_operazbo_ol->RAGIO
'tmp_operazbo_ol->MODSVOL
'tmp_operazbo_ol->AREAGEO
'tmp_operazbo_ol->RIFIMP
'tmp_operazbo_ol->SCOPO
'tmp_operazbo_ol->NATURA
'tmp_operazbo_ol->RTIPO
'tmp_operazbo_ol->RCOMP
'tmp_operazbo_ol->RIMP
'tmp_operazbo_ol->RFREQ
'tmp_operazbo_ol->RRAGIO
'tmp_operazbo_ol->RAREA
'tmp_operazbo_ol->TIPO
'tmp_operazbo_ol->PRGIMPOPE
'tmp_operazbo_ol->UNIQUECODE
'tmp_operazbo_ol->AMMONT
'tmp_operazbo_ol->DURAT
'tmp_operazbo_ol->CONNALTRO
'tmp_operazbo_ol->CONNESDOC
'tmp_operazbo_ol->C_RAG
'tmp_operazbo_ol->C_STA
'tmp_operazbo_ol->C_CTA
'tmp_operazbo_ol->C_CAB
'tmp_operazbo_ol->C_PRV
'tmp_operazbo_ol->C_IND
'tmp_operazbo_ol->C_CAP
'tmp_operazbo_ol->DATAIMP
'tmp_operazbo_ol->C_RAPPORTO
'tmp_operazbo_ol->PAGASOGOP
'tmp_operazbo_ol->MTCN
'tmp_operazbo_ol->IDFILE
'tmp_operazbo_ol->CDATREG
]
sel_field='*
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Delete
pag=1
prev=O152
rd_kfield=[
'TIPOOPRAP
]
rd_kop=[
'=
]
rd_kvar=[
''46'
]
I
obj='Delete
pag=1
rd_kfield=[
'TIPOOPRAP
]
rd_kop=[
'=
]
rd_kvar=[
''36'
]
I
I
]
w=[
150
150
150
]
I
obj='While
pag=1
prev=O70
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O71
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O181
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O182
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPRemark
frm_calc='Verifico il tipo di riga
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,14,1)
len=1
name='xTipo
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,234,1)='1','S','N')
len=1
name='xOpe
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipo='1'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O190
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O191
fatherSonIndex=0
frm_calc=[
'xOpe='S'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O196
fatherSonIndex=0
frm_calc='7
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O196
fatherSonIndex=1
frm_calc='8
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O191
fatherSonIndex=1
frm_calc=[
'xOpe='S'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O206
fatherSonIndex=0
frm_calc='9
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O206
fatherSonIndex=1
frm_calc='10
obj='Exec
pag=1
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=1
prev=O189
var_op='asgn
I
obj='Var
pag=1
prev=O188
var_op='asgn
I
obj='Remark
pag=1
prev=O187
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='TempTable
pag=1
prev=O69
sel_type='def
server_table='tmp_operazbo_ol
I
obj='TempTable
pag=1
prev=O68
sel_type='def
server_table='tmp_intestbo_ol
I
obj='TempTable
pag=1
prev=O67
sel_type='def
server_table='tmp_rapopebo_ol
I
obj='TempTable
pag=1
prev=O66
sel_type='def
server_table='tmp_anarapbo
I
obj='DropTempTable
pag=1
prev=O65
server_table='tmp_rapopebo_ol
I
obj='DropTempTable
pag=1
prev=O64
server_table='tmp_intestbo_ol
I
obj='DropTempTable
pag=1
prev=O63
server_table='tmp_anarapbo
I
obj='DropTempTable
pag=1
server_table='tmp_operazbo_ol
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWhile
father=O50
fatherSonIndex=1
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
obj='While
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O219
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O223
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O224
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPRemark
frm_calc='Verifico il tipo di riga
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,14,1)
len=1
name='xTipo
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipo='1'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O231
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O232
fatherSonIndex=0
frm_calc='Substr(riga,234,1)
len=1
name='xOpe
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,234,2)='25' or Substr(riga,234,2)='28','S','N')
len=1
name='cDelega
next=Icpitembatch.CPVarDecl
frm_calc='NullDate()
len=8
name='_dataope
next=Icpitembatch.CPCase
frm_calc=[
'xOpe='1'
'xOpe='5'
]
h=[
19
19
19
19
]
haselse=True
obj='Case
pag=1
prev=O239
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O240
fatherSonIndex=0
frm_calc='2
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O240
fatherSonIndex=1
frm_calc='11
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O240
fatherSonIndex=2
frm_calc='3
obj='Exec
pag=1
I
I
]
w=[
150
150
150
150
]
I
obj='Var
obj_type='D
pag=1
prev=O238
var_op='asgn
I
obj='Var
pag=1
prev=O237
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O232
fatherSonIndex=1
frm_calc=[
'xOpe='1'
'xOpe='5'
]
h=[
19
19
19
19
]
haselse=True
obj='Case
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O252
fatherSonIndex=0
frm_calc=[
'xTipo='2' or xTipo='3'
'xTipo='4'
'xTipo='5'
'xTipo='6'
'xTipo='7'
'xTipo='8'
'xTipo='9'
]
h=[
19
19
19
19
19
19
19
19
]
obj='Case
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O257
fatherSonIndex=0
frm_calc='4
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O257
fatherSonIndex=2
frm_calc='14
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O257
fatherSonIndex=4
frm_calc='4
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
I
Icpitembatch.CPItemSon
I
]
w=[
150
150
150
150
150
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O252
fatherSonIndex=1
frm_calc='12
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O252
fatherSonIndex=2
frm_calc='5
obj='Exec
pag=1
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=1
prev=O230
var_op='asgn
I
obj='Remark
pag=1
prev=O229
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=1
prev=O46
var_op='asgn
I
obj='If
pag=1
prev=O45
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
check='page
father=O46
fatherSonIndex=0
frm_calc='13
obj='Exec
pag=1
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O46
fatherSonIndex=1
frm_calc='w_nomefile
len=128
name='fileelab
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=1
prev=O44
I
obj='Exec
pag=1
prev=O43
I
obj='Var
pag=1
prev=O42
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O37
fatherSonIndex=1
frm_calc='transaction error
frm_seek='Non esiste il file di configurazione per l'import dei dati
obj='Transaction
pag=1
raise_on_trans_err=True
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='M
pag=1
prev=O35
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O34
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O33
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O32
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O31
var_op='asgn
I
obj='Var
obj_type='N
pag=1
prev=O29
var_op='asgn
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='xelegabo
father=O29
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='xntestbo
next=Icpitembatch.CPDelete
arch='xapopebo
next=Icpitembatch.CPDelete
arch='xnarapbo
next=Icpitembatch.CPDelete
arch='xperazbo
next=Icpitembatch.CPDelete
arch='xperazbo_agg
next=Icpitembatch.CPDelete
arch='xapotit
next=Icpitembatch.CPDelete
arch='delegabo
next=Icpitembatch.CPDelete
arch='intestbo
next=Icpitembatch.CPDelete
arch='intestit
next=Icpitembatch.CPDelete
arch='rapopebo
next=Icpitembatch.CPDelete
arch='anarapbo
next=Icpitembatch.CPDelete
arch='operazbo_agg
next=Icpitembatch.CPDelete
arch='operazbo
next=Icpitembatch.CPDelete
arch='rapotit
next=Icpitembatch.CPDelete
arch='personbo_agg
next=Icpitembatch.CPDelete
arch='personbo
next=Icpitembatch.CPDelete
arch='wersonbo
next=Icpitembatch.CPDelete
arch='cpwarn
obj='Delete
pag=1
prev=O309
rd_kfield=[
'warncode
]
rd_kop=[
'=
]
rd_kvar=[
'_gAzienda
]
I
obj='Delete
pag=1
prev=O308
sel_type='all
I
obj='Delete
pag=1
prev=O307
sel_type='all
I
obj='Delete
pag=1
prev=O306
sel_type='all
I
obj='Delete
pag=1
prev=O305
sel_type='all
I
obj='Delete
pag=1
prev=O304
sel_type='all
I
obj='Delete
pag=1
prev=O303
sel_type='all
I
obj='Delete
pag=1
prev=O302
sel_type='all
I
obj='Delete
pag=1
prev=O301
sel_type='all
I
obj='Delete
pag=1
prev=O300
sel_type='all
I
obj='Delete
pag=1
prev=O299
sel_type='all
I
obj='Delete
pag=1
prev=O298
sel_type='all
I
obj='Delete
pag=1
prev=O297
sel_type='all
I
obj='Delete
pag=1
prev=O296
sel_type='all
I
obj='Delete
pag=1
prev=O295
sel_type='all
I
obj='Delete
pag=1
prev=O294
sel_type='all
I
obj='Delete
pag=1
prev=O293
sel_type='all
I
obj='Delete
pag=1
prev=O292
sel_type='all
I
obj='Delete
pag=1
sel_type='all
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O17
fatherSonIndex=1
frm_calc='_gMsgProc + "Rilevati errori nell'impotazione dei file! Ricreare il file segnalato e rieseguire l'import dei dati. La procedura annullera automaticamente l'importazione" + NL
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='_gMsgProc + 'Errore SQL: ' + m_Sql.TransactionErrorMessage() + NL
len=10
name='_gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='rollback
obj='Transaction
pag=1
prev=O318
I
obj='Var
obj_type='M
pag=1
prev=O317
var_op='asgn
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=1
prev=O14
I
obj='Begin
pag=1
prev=O13
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O14
fatherSonIndex=0
frm_calc=''D'
len=1
name='w_tipodest
next=Icpitembatch.CPVarDecl
frm_calc=''S'
len=1
name='w_tipoimp
next=Icpitembatch.CPVarDecl
frm_calc=''A'
len=1
name='w_flgrae
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=1
prev=O325
sel_field='*
sel_name='cpazi
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O326
fatherSonIndex=0
frm_calc='Utilities.SetCompany(LRTrim(cpazi->codazi))
next=Icpitembatch.CPVarDecl
comment='Azienda
frm_calc='LRTrim(cpazi->codazi)
len=10
name='_gAzienda
obj='Var
pag=1
prev=O330
var_op='asgn
I
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O324
var_op='asgn
I
obj='Var
pag=1
prev=O323
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O12
var_op='asgn
I
obj='Var
obj_type='M
pag=1
prev=O11
var_op='asgn
I
obj='Var
pag=1
prev=O10
var_op='asgn
I
obj='Exec
pag=1
prev=O8
I
obj='Begin
pag=1
prev=O6
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Azienda
father=O8
fatherSonIndex=0
len=10
name='_gAzienda
next=Icpitembatch.CPVarDecl
len=10
name='_gMsgProc
obj='Var
obj_type='M
pag=1
prev=O336
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O5
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O6
fatherSonIndex=0
len=1
name='fhand
next=Icpitembatch.CPVarDecl
len=10
name='riga
next=Icpitembatch.CPVarDecl
len=25
name='xRapportox
next=Icpitembatch.CPVarDecl
comment='Contatore Operazioni
len=10
name='cNumOpe
next=Icpitembatch.CPVarDecl
comment='Contatore Rapporti
len=10
name='cNumRap
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
len=10
name='cNumPer
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
len=10
name='cNumInf
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
len=10
name='cNumTit
next=Icpitembatch.CPVarDecl
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
len=1
name='xTipo
next=Icpitembatch.CPVarDecl
len=1
name='xOpe
next=Icpitembatch.CPVarDecl
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
len=16
name='cConnes
next=Icpitembatch.CPVarDecl
len=16
name='xCF
next=Icpitembatch.CPVarDecl
len=16
name='cCF
next=Icpitembatch.CPVarDecl
len=6
name='xCodCab
next=Icpitembatch.CPVarDecl
len=30
name='xCitta
next=Icpitembatch.CPVarDecl
len=6
name='cCliProg
next=Icpitembatch.CPVarDecl
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
len=1
name='xSesso
next=Icpitembatch.CPVarDecl
len=3
name='xRam
next=Icpitembatch.CPVarDecl
len=2
name='xTD
next=Icpitembatch.CPVarDecl
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
len=6
name='xCAB
next=Icpitembatch.CPVarDecl
len=6
name='xDIP
next=Icpitembatch.CPVarDecl
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
len=16
name='cCli1
next=Icpitembatch.CPVarDecl
len=10
name='xIDB
next=Icpitembatch.CPVarDecl
len=8
name='xData
next=Icpitembatch.CPVarDecl
len=8
name='xDatF
next=Icpitembatch.CPVarDecl
len=1
name='cFlagLire
next=Icpitembatch.CPVarDecl
len=1
name='cFlagCont
next=Icpitembatch.CPVarDecl
len=1
name='cFlagFraz
next=Icpitembatch.CPVarDecl
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
len=1
name='xCFE
next=Icpitembatch.CPVarDecl
len=10
name='conta
next=Icpitembatch.CPVarDecl
len=1
name='_esito
next=Icpitembatch.CPVarDecl
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
len=15
name='nProgRap
next=Icpitembatch.CPVarDecl
len=15
name='nProgOpe
next=Icpitembatch.CPVarDecl
len=5
name='nMaxR
next=Icpitembatch.CPVarDecl
len=1
name='streg
next=Icpitembatch.CPVarDecl
len=25
name='xAppRap
next=Icpitembatch.CPVarDecl
len=1
name='xTipoInf
next=Icpitembatch.CPVarDecl
len=70
name='cRagSoc
next=Icpitembatch.CPVarDecl
len=16
name='xIDBx
next=Icpitembatch.CPVarDecl
len=10
name='xMaxRow
next=Icpitembatch.CPVarDecl
len=1
name='cTipPer
next=Icpitembatch.CPVarDecl
len=8
name='xDatOpe
next=Icpitembatch.CPVarDecl
len=1
name='cDelega
next=Icpitembatch.CPVarDecl
len=15
name='cProgSto
next=Icpitembatch.CPVarDecl
len=200
name='cpercorsozip
next=Icpitembatch.CPVarDecl
len=200
name='cdirectoryfile
next=Icpitembatch.CPVarDecl
len=128
name='fileelab
next=Icpitembatch.CPVarDecl
len=8
name='_dataope
next=Icpitembatch.CPVarDecl
len=2
name='_prvnas
next=Icpitembatch.CPVarDecl
len=128
name='_pathfile
obj='Var
pag=1
prev=O404
I
obj='Var
pag=1
prev=O403
I
obj='Var
obj_type='D
pag=1
prev=O402
I
obj='Var
pag=1
prev=O401
I
obj='Var
pag=1
prev=O400
I
obj='Var
pag=1
prev=O399
I
obj='Var
pag=1
prev=O398
I
obj='Var
pag=1
prev=O397
I
obj='Var
obj_type='D
pag=1
prev=O396
I
obj='Var
pag=1
prev=O395
I
obj='Var
obj_type='N
pag=1
prev=O394
I
obj='Var
pag=1
prev=O393
I
obj='Var
pag=1
prev=O392
I
obj='Var
pag=1
prev=O391
I
obj='Var
pag=1
prev=O390
I
obj='Var
pag=1
prev=O389
I
obj='Var
obj_type='N
pag=1
prev=O388
I
obj='Var
obj_type='N
pag=1
prev=O387
I
obj='Var
obj_type='N
pag=1
prev=O386
I
obj='Var
obj_type='N
pag=1
prev=O385
I
obj='Var
obj_type='N
pag=1
prev=O384
I
obj='Var
pag=1
prev=O383
I
obj='Var
pag=1
prev=O382
I
obj='Var
obj_type='N
pag=1
prev=O381
I
obj='Var
obj_type='N
pag=1
prev=O380
I
obj='Var
obj_type='N
pag=1
prev=O379
I
obj='Var
pag=1
prev=O378
I
obj='Var
obj_type='N
pag=1
prev=O377
I
obj='Var
pag=1
prev=O376
I
obj='Var
pag=1
prev=O375
I
obj='Var
pag=1
prev=O374
I
obj='Var
pag=1
prev=O373
I
obj='Var
pag=1
prev=O372
I
obj='Var
pag=1
prev=O371
I
obj='Var
pag=1
prev=O370
I
obj='Var
pag=1
prev=O369
I
obj='Var
pag=1
prev=O368
I
obj='Var
pag=1
prev=O367
I
obj='Var
pag=1
prev=O366
I
obj='Var
pag=1
prev=O365
I
obj='Var
pag=1
prev=O364
I
obj='Var
pag=1
prev=O363
I
obj='Var
pag=1
prev=O362
I
obj='Var
pag=1
prev=O361
I
obj='Var
pag=1
prev=O360
I
obj='Var
pag=1
prev=O359
I
obj='Var
pag=1
prev=O358
I
obj='Var
pag=1
prev=O357
I
obj='Var
pag=1
prev=O356
I
obj='Var
pag=1
prev=O355
I
obj='Var
pag=1
prev=O354
I
obj='Var
pag=1
prev=O353
I
obj='Var
pag=1
prev=O352
I
obj='Var
pag=1
prev=O351
I
obj='Var
pag=1
prev=O350
I
obj='Var
pag=1
prev=O349
I
obj='Var
pag=1
prev=O348
I
obj='Var
obj_type='N
pag=1
prev=O347
I
obj='Var
obj_type='N
pag=1
prev=O346
I
obj='Var
obj_type='N
pag=1
prev=O345
I
obj='Var
obj_type='N
pag=1
prev=O344
I
obj='Var
obj_type='N
pag=1
prev=O343
I
obj='Var
pag=1
prev=O342
I
obj='Var
obj_type='M
pag=1
prev=O341
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Remark
pag=1
prev=O3
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O3
fatherSonIndex=0
len=1
name='w_tipodest
next=Icpitembatch.CPVarDecl
len=1
name='w_tipoimp
next=Icpitembatch.CPVarDecl
len=1
name='w_flgrae
next=Icpitembatch.CPVarDecl
len=128
name='w_nomefile
next=Icpitembatch.CPVarDecl
len=10
name='_oldazi
obj='Var
pag=1
prev=O412
I
obj='Var
pag=1
prev=O411
I
obj='Var
pag=1
prev=O410
I
obj='Var
pag=1
prev=O409
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
x=15
y=13
I
Icpitembatch.CPRemark
frm_calc='Importa i dati base delle operazioni
next=Icpitembatch.CPVarDecl
comment='Contatore Operazioni
frm_calc='cNumOpe + 1
len=10
name='cNumOpe
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Substr(riga,79,8))
len=8
name='_dataope
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O417
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O418
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PPOPER1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,199,25),Space(25))
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,224,1),Space(1))
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,35,6)
len=6
name='xDIP
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xDIP)))
]
h=[
19
19
]
next=Icpitembatch.CPRead
arch='tbcauana
next=Icpitembatch.CPInsert
arch='xperazbo
h=[
19
19
]
obj='Insert
pag=2
prev=O434
rd_kfield=[
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'idcauana
'IDEREG
'NUMPROG
'OPERAZMOD
'OPRAP
'PAESE
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAPPORTO
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
'COLLEG
]
rd_kvar=[
'Substr(riga,79,8)
'Substr(riga,79,8)
'Substr(riga,226,8)
'Substr(riga,89,4)
'Substr(riga,41,6)
'Substr(riga,111,6)
'Substr(riga,35,6)
'Substr(riga,97,11)
'Substr(riga,3,11)
'Substr(riga,93,2)
'CharToDate(Substr(riga,79,8))
'Date()
'CharToDate(Substr(riga,249,8))
'Substr(riga,117,30)
'Substr(riga,47,30)
'Substr(riga,149,50)
'Substr(riga,88,1)
'Substr(riga,87,1)
'Substr(riga,277,1)
'xTipRap
'cOpeProg1
'cIdCau
'Substr(riga,79,8) + cOpeProg2 + Substr(riga,248,1)
'cOpeProg2
'Substr(riga,257,20)
'Substr(riga,234,1)
'Substr(riga,108,3)
'nProgImp
'Substr(riga,147,2)
'Substr(riga,77,2)
'xRapporto
'LRTrim(Substr(riga,312,12))
'Substr(riga,281,1)
'Substr(riga,248,1)
''1'
'Substr(riga,95,2)
'Substr(riga,1,2)
'Substr(riga,225,1)
'Substr(riga,234,2)
'Val(Substr(riga,297,15))
'Val(Substr(riga,282,15))
'Substr(riga,278,3)
'LRTrim(Substr(riga,236,12))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O435
fatherSonIndex=0
frm_calc='_gMsgProc +"Rilevati errori nel file "+w_nomefile+" per l'operazione in data "+Substr(riga,79,8)+" con importo "+Str((Val(Substr(riga,282,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
len=10
name='_gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=2
prev=O441
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Read
pag=2
prev=O431
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,89,4)
'Substr(riga,93,2)
]
rd_var=[
'cIdCau
]
I
obj='If
pag=2
prev=O430
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anadip
father=O431
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDIPx))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O450
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anadip
father=O451
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'CODDIP
'DESCRIZ
'CAB
'DESCCIT
'PROVINCIA
]
rd_kvar=[
'xDIP
'xDIP
'Substr(riga,41,6)
'Substr(riga,47,30)
'Substr(riga,77,2)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='anadip
father=O451
fatherSonIndex=1
obj='Write
pag=2
rd_kfield=[
'CODDIP
]
rd_kop=[
'=
]
rd_kvar=[
'xDIP
]
wr_field=[
'DESCCIT
'CAB
'PROVINCIA
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Substr(riga,47,30)
'Substr(riga,41,6)
'Substr(riga,77,2)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'xDIP
]
rd_var=[
'xDIPx
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O429
var_op='asgn
I
obj='Var
pag=2
prev=O428
var_op='asgn
I
obj='Var
pag=2
prev=O427
var_op='asgn
I
obj='Var
pag=2
prev=O426
var_op='asgn
I
obj='Var
pag=2
prev=O425
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O424
var_op='asgn
I
obj='Var
pag=2
prev=O423
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O418
fatherSonIndex=1
frm_calc='Utilities.GetAutonumber("POPERAZ1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("POPERAZ2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,199,25),Space(25))
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,224,1),Space(1))
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPRead
arch='tbcauana
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,35,6)
len=6
name='xDIP
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xDIP)))
]
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='operazbo
h=[
19
19
]
obj='Insert
pag=2
prev=O483
rd_kfield=[
'CDATAOPE
'CDATOPE
'CDATREG
'CODANA
'CODCAB
'CODCAB2
'CODDIPE
'CODINT2
'CODINTER
'CODVOC
'COLLEG
'DATAOPE
'DATAREG
'DATARETT
'DESC2
'DESCCIT
'DESCINTER
'FLAGCONT
'FLAGFRAZ
'FLAGLIRE
'FLAGRAP
'IDBASE
'idcauana
'IDEREG
'NUMPROG
'OPERAZMOD
'OPRAP
'PAESE
'PRGIMPOPE
'PROV2
'PROVINCIA
'RAPPORTO
'RIFIMP
'SEGNO
'STATOREG
'TIPOINF
'TIPOINT2
'TIPOINTER
'TIPOLEG
'TIPOOPRAP
'TOTCONT
'TOTLIRE
'VALUTA
]
rd_kvar=[
'Substr(riga,79,8)
'Substr(riga,79,8)
'Substr(riga,226,8)
'Substr(riga,89,4)
'Substr(riga,41,6)
'Substr(riga,111,6)
'Substr(riga,35,6)
'Substr(riga,97,11)
'Substr(riga,3,11)
'Substr(riga,93,2)
'LRTrim(Substr(riga,236,12))
'CharToDate(Substr(riga,79,8))
'Date()
'CharToDate(Substr(riga,249,8))
'Substr(riga,117,30)
'Substr(riga,47,30)
'Substr(riga,149,50)
'Substr(riga,88,1)
'Substr(riga,87,1)
'Substr(riga,277,1)
'xTipRap
'cOpeProg1
'cIdCau
'Substr(riga,79,8) + cOpeProg2 + Substr(riga,248,1)
'cOpeProg2
'Substr(riga,257,20)
'Substr(riga,234,1)
'Substr(riga,108,3)
'nProgImp
'Substr(riga,147,2)
'Substr(riga,77,2)
'xRapporto
'LRTrim(Substr(riga,312,12))
'Substr(riga,281,1)
'Substr(riga,248,1)
''1'
'Substr(riga,95,2)
'Substr(riga,1,2)
'Substr(riga,225,1)
'Substr(riga,234,2)
'Val(Substr(riga,297,15))
'Val(Substr(riga,282,15))
'Substr(riga,278,3)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O486
fatherSonIndex=0
frm_calc='_gMsgProc +"Rilevati errori nel file "+w_nomefile+" per l'operazione in data "+CharToDate(Substr(riga,79,8))+" con importo "+Str((Val(Substr(riga,282,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL﷯
len=10
name='_gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=2
prev=O492
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='If
pag=2
prev=O482
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anadip
father=O483
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDIPx))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O497
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anadip
father=O498
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'CODDIP
'DESCRIZ
'CAB
'DESCCIT
'PROVINCIA
]
rd_kvar=[
'xDIP
'xDIP
'Substr(riga,41,6)
'Substr(riga,47,30)
'Substr(riga,77,2)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='anadip
father=O498
fatherSonIndex=1
obj='Write
pag=2
rd_kfield=[
'CODDIP
]
rd_kop=[
'=
]
rd_kvar=[
'xDIP
]
wr_field=[
'DESCCIT
'CAB
'PROVINCIA
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Substr(riga,47,30)
'Substr(riga,41,6)
'Substr(riga,77,2)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'xDIP
]
rd_var=[
'xDIPx
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O481
var_op='asgn
I
obj='Var
pag=2
prev=O480
var_op='asgn
I
obj='Read
pag=2
prev=O479
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,89,4)
'Substr(riga,93,2)
]
rd_var=[
'cIdCau
]
I
obj='Var
pag=2
prev=O478
var_op='asgn
I
obj='Var
pag=2
prev=O477
var_op='asgn
I
obj='Var
pag=2
prev=O476
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O475
var_op='asgn
I
obj='Var
pag=2
prev=O474
var_op='asgn
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='D
pag=2
prev=O416
var_op='asgn
I
obj='Var
obj_type='N
pag=2
prev=O415
var_op='asgn
I
obj='Remark
pag=2
x=18
y=24
I
Icpitembatch.CPRemark
frm_calc='Importa i dati base dei rapporti
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='cNumInf + 1
len=10
name='cNumInf
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=3
prev=O526
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O527
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGPINFO1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,199,25),Space(25))
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,224,1),Space(1))
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,248,1)='2','2',iif(Substr(riga,248,1)='0','S','A'))
len=1
name='streg
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,35,6)
len=6
name='xDIP
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xDIP)))
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Inserisce Rapporto
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xapopebo
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Inserisce Intestatario
h=[
19
19
]
obj='Begin
pag=3
prev=O546
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O548
fatherSonIndex=0
frm_calc='''
len=1
name='xTipoInf
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPExec
check='page
frm_calc='6
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A' or xTipoInf='C'
]
h=[
19
19
]
obj='If
pag=3
prev=O554
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='xntestbo
father=O555
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A'
'xTipoInf='C'
]
h=[
19
19
19
]
obj='If
pag=3
prev=O561
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xntestbo
father=O564
fatherSonIndex=0
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'TIPOPERS
'DATAINI
]
wr_op=[
'=
'=
]
wr_var=[
''P'
'CharToDate(Substr(riga,79,8))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xntestbo
father=O564
fatherSonIndex=1
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Substr(riga,79,8))
'cInfProg2
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=3
prev=O560
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O561
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xntestbo
h=[
19
19
]
obj='Insert
pag=3
prev=O589
rd_kfield=[
'IDBASE
'CPROWNUM
'NUMPROG1
'STATOREG
'RAPPORTO
'TIPORAP
'PRGIMPSOG
'TIPOPERS
]
rd_kvar=[
'xIDB
'xMaxRow + 1
'cInfProg2
''0'
'xRapporto
'Substr(riga,224,1)
'nProgImp2
''P'
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O591
fatherSonIndex=0
frm_calc='_gMsgProc +"Rilevati errori nel file "+w_nomefile+" per la registrazione dell'intestatario dell'informazione in data "+Substr(riga,79,8)+" relativa al rapporto: "+ xRapporto +" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
len=10
name='_gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=3
prev=O597
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=3
prev=O588
sel_field='xntestbo->CPROWNUM
sel_name='xntestbo
sel_order='xntestbo->CPROWNUM
sel_where='xntestbo->RAPPORTO=xRapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O589
fatherSonIndex=0
frm_calc='xntestbo->CPROWNUM
len=10
name='xMaxRow
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O587
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=3
rd_field=[
'IDBASE
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'xRapporto
]
rd_var=[
'xIDB
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=3
prev=O553
I
obj='Var
pag=3
prev=O552
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=3
prev=O544
rd_kfield=[
'IDBASE
'NUMPROG
'DATAOPE
'TIPOINTER
'CODINTER
'TIPOINF
'IDEREG
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'OPRAP
'TIPOOPRAP
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'STATOREG
'OPERAZMOD
'DATARETT
'COLLEG
'PRGIMPINF
'CDATOPE
'CDATREG
]
rd_kvar=[
'cInfProg1
'cInfProg2
'CharToDate(Substr(riga,79,8))
'Substr(riga,1,2)
'Substr(riga,3,11)
''1'
'Substr(riga,79,8) + cOpeProg2 + streg
'Substr(riga,35,6)
'Substr(riga,47,30)
'Substr(riga,77,2)
'Substr(riga,41,6)
'Substr(riga,87,1)
'Substr(riga,88,1)
'Substr(riga,89,4)
'Substr(riga,93,2)
'Substr(riga,95,2)
'Substr(riga,97,11)
'Substr(riga,108,3)
'Substr(riga,117,30)
'Substr(riga,147,2)
'Substr(riga,111,6)
'Substr(riga,149,50)
'xRapporto
'xTipRap
'Substr(riga,225,1)
'CharToDate(Substr(riga,226,8))
'Substr(riga,234,1)
'Substr(riga,234,2)
'Substr(riga,277,1)
'Substr(riga,278,3)
'Substr(riga,281,1)
'Val(Substr(riga,282,15))
'Val(Substr(riga,297,15))
'Substr(riga,248,1)
'Substr(riga,257,20)
'CharToDate(Substr(riga,249,8))
'Substr(riga,236,12)
'nProgImp
'Substr(riga,79,8)
'Substr(riga,226,8)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O546
fatherSonIndex=0
frm_calc='_gMsgProc +"Rilevati errori nel file "+w_nomefile+" per l'informazione in data "+Substr(riga,79,8)+" relativa al rapporto: "+xRapporto+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
len=10
name='_gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=3
prev=O615
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Begin
pag=3
prev=O541
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O544
fatherSonIndex=0
frm_calc='''
len=25
name='xAppRap
next=Icpitembatch.CPRead
arch='xnarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xAppRap))
]
h=[
19
19
]
obj='If
pag=3
prev=O621
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Rapporti
father=O622
fatherSonIndex=0
frm_calc='cNumRap + 1
len=10
name='cNumRap
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgRap
next=Icpitembatch.CPInsert
arch='xnarapbo
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='xRapportox
next=Icpitembatch.CPRead
arch='knarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xRapportox))
]
h=[
19
19
]
obj='If
pag=3
prev=O631
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='knarapbo
father=O632
fatherSonIndex=0
obj='Insert
pag=3
rd_kfield=[
'RAPPORTO
'TIPORAP
]
rd_kvar=[
'xRapporto
''P'
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=3
prev=O630
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'xRapporto
]
rd_var=[
'xRapportox
]
I
obj='Var
pag=3
prev=O629
var_op='asgn
I
obj='Insert
pag=3
prev=O628
rd_kfield=[
'RAPPORTO
'TIPORAP
'FLAGLIRE
'VALUTA
]
rd_kvar=[
'xRapporto
'Substr(riga,224,1)
'iif(Substr(riga,277,1)='1','L',iif(Substr(riga,277,1)='2','V','E'))
'Substr(riga,278,3)
]
I
obj='Var
obj_type='N
pag=3
prev=O627
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=3
prev=O620
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'xRapporto
]
rd_var=[
'xAppRap
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O540
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anadip
father=O541
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDIPx))
]
h=[
19
19
]
obj='If
pag=3
prev=O655
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anadip
father=O656
fatherSonIndex=0
obj='Insert
pag=3
rd_kfield=[
'CODDIP
'DESCRIZ
]
rd_kvar=[
'xDIP
'xDIP
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=3
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'xDIP
]
rd_var=[
'xDIPx
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O539
var_op='asgn
I
obj='Var
pag=3
prev=O538
var_op='asgn
I
obj='Var
pag=3
prev=O537
var_op='asgn
I
obj='Var
pag=3
prev=O536
var_op='asgn
I
obj='Var
pag=3
prev=O535
var_op='asgn
I
obj='Var
pag=3
prev=O534
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O533
var_op='asgn
I
obj='Var
pag=3
prev=O532
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O527
fatherSonIndex=1
frm_calc='''
len=1
name='xTipoInf
next=Icpitembatch.CPExec
check='page
frm_calc='6
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf <> 'X'
]
h=[
19
19
]
obj='If
pag=3
prev=O672
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O673
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGINFO1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGINFO2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,199,25),Space(25))
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,224,1),Space(1))
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Substr(riga,79,8))
len=8
name='xDatOpe
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,248,1)='2','2',iif(Substr(riga,248,1)='0','S','A'))
len=1
name='streg
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,35,6)
len=6
name='xDIP
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xDIP)))
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Inserisce Rapporto
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='rapopebo
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Inserisce Intestatario
h=[
19
19
]
obj='Begin
pag=3
prev=O693
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O695
fatherSonIndex=0
frm_calc=[
'cDelega <> 'S'
]
h=[
19
19
]
obj='If
pag=3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O699
fatherSonIndex=0
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A' or xTipoInf='C'
]
h=[
19
19
]
obj='If
pag=3
prev=O704
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='intestbo
father=O705
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A'
'xTipoInf='C'
]
h=[
19
19
19
]
obj='If
pag=3
prev=O711
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestbo
father=O714
fatherSonIndex=0
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xRapporto
'1
]
wr_field=[
'TIPOPERS
'DATAINI
]
wr_op=[
'=
'=
]
wr_var=[
''P'
'CharToDate(Substr(riga,79,8))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestbo
father=O714
fatherSonIndex=1
obj='Write
pag=3
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Substr(riga,79,8))
'cInfProg2
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=3
prev=O710
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O711
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='intestbo
h=[
19
19
]
obj='Insert
pag=3
prev=O739
rd_kfield=[
'IDBASE
'CPROWNUM
'NUMPROG1
'STATOREG
'RAPPORTO
'TIPORAP
'PRGIMPSOG
]
rd_kvar=[
'cInfProg1
'xMaxRow + 1
'cInfProg2
''0'
'xRapporto
'Substr(riga,224,1)
'nProgImp2
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O741
fatherSonIndex=0
frm_calc='_gMsgProc +"Rilevati errori nel file "+w_nomefile+" per la registrazione dell'intestatario dell'informazione in data "+Substr(riga,79,8)+" relativa al rapporto: "+ xRapporto +" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
len=10
name='_gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=3
prev=O747
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Select
pag=3
prev=O738
sel_field='intestbo->CPROWNUM
sel_name='intestbo
sel_order='intestbo->CPROWNUM
sel_where='intestbo->RAPPORTO=xRapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O739
fatherSonIndex=0
frm_calc='intestbo->CPROWNUM
len=10
name='xMaxRow
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O737
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=3
rd_field=[
'IDBASE
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'xRapporto
]
rd_var=[
'xIDB
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Insert
pag=3
prev=O691
rd_kfield=[
'IDBASE
'NUMPROG
'DATAOPE
'TIPOINTER
'CODINTER
'TIPOINF
'IDEREG
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'OPRAP
'TIPOOPRAP
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'STATOREG
'OPERAZMOD
'DATARETT
'COLLEG
'PRGIMPINF
'CDATOPE
'CDATREG
]
rd_kvar=[
'cInfProg1
'cInfProg2
'CharToDate(Substr(riga,79,8))
'Substr(riga,1,2)
'Substr(riga,3,11)
''1'
'Substr(riga,79,8) + cOpeProg2 + streg
'Substr(riga,35,6)
'Substr(riga,47,30)
'Substr(riga,77,2)
'Substr(riga,41,6)
'Substr(riga,87,1)
'Substr(riga,88,1)
'Substr(riga,89,4)
'Substr(riga,93,2)
'Substr(riga,95,2)
'Substr(riga,97,11)
'Substr(riga,108,3)
'Substr(riga,117,30)
'Substr(riga,147,2)
'Substr(riga,111,6)
'Substr(riga,149,50)
'xRapporto
'xTipRap
'Substr(riga,225,1)
'CharToDate(Substr(riga,226,8))
'Substr(riga,234,1)
'Substr(riga,234,2)
'Substr(riga,277,1)
'Substr(riga,278,3)
'Substr(riga,281,1)
'Val(Substr(riga,282,15))
'Val(Substr(riga,297,15))
'Substr(riga,248,1)
'Substr(riga,257,20)
'CharToDate(Substr(riga,249,8))
'Substr(riga,236,12)
'nProgImp
'Substr(riga,79,8)
'Substr(riga,226,8)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O693
fatherSonIndex=0
frm_calc='_gMsgProc +"Rilevati errori nel file "+w_nomefile+" per l'informazione in data "+Substr(riga,79,8)+" relativa al rapporto: "+xRapporto+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
len=10
name='_gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=3
prev=O766
I
obj='Var
obj_type='M
pag=3
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Begin
pag=3
prev=O688
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O691
fatherSonIndex=0
frm_calc='''
len=25
name='xAppRap
next=Icpitembatch.CPRead
arch='anarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xAppRap))
]
h=[
19
19
]
obj='If
pag=3
prev=O772
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Rapporti
father=O773
fatherSonIndex=0
frm_calc='cNumRap + 1
len=10
name='cNumRap
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgRap
next=Icpitembatch.CPInsert
arch='anarapbo
next=Icpitembatch.CPVarDecl
frm_calc='''
len=25
name='xRapportox
next=Icpitembatch.CPRead
arch='knarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xRapportox))
]
h=[
19
19
]
obj='If
pag=3
prev=O782
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='knarapbo
father=O783
fatherSonIndex=0
obj='Insert
pag=3
rd_kfield=[
'RAPPORTO
'TIPORAP
]
rd_kvar=[
'xRapporto
''D'
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=3
prev=O781
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'xRapporto
]
rd_var=[
'xRapportox
]
I
obj='Var
pag=3
prev=O780
var_op='asgn
I
obj='Insert
pag=3
prev=O779
rd_kfield=[
'RAPPORTO
'TIPORAP
'FLAGLIRE
'VALUTA
'PRGIMPRAP
]
rd_kvar=[
'xRapporto
'Substr(riga,224,1)
'iif(Substr(riga,277,1)='1','L',iif(Substr(riga,277,1)='2','V','E'))
'Substr(riga,278,3)
'nProgRap
]
I
obj='Var
obj_type='N
pag=3
prev=O778
var_op='asgn
I
obj='Var
obj_type='N
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=3
prev=O771
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'xRapporto
]
rd_var=[
'xAppRap
]
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=3
prev=O687
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPRead
arch='anadip
father=O688
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDIPx))
]
h=[
19
19
]
obj='If
pag=3
prev=O806
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anadip
father=O807
fatherSonIndex=0
obj='Insert
pag=3
rd_kfield=[
'CODDIP
'DESCRIZ
]
rd_kvar=[
'xDIP
'xDIP
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=3
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'xDIP
]
rd_var=[
'xDIPx
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=3
prev=O686
var_op='asgn
I
obj='Var
pag=3
prev=O685
var_op='asgn
I
obj='Var
pag=3
prev=O684
var_op='asgn
I
obj='Var
pag=3
prev=O683
var_op='asgn
I
obj='Var
obj_type='D
pag=3
prev=O682
var_op='asgn
I
obj='Var
pag=3
prev=O681
var_op='asgn
I
obj='Var
pag=3
prev=O680
var_op='asgn
I
obj='Var
obj_type='N
pag=3
prev=O679
var_op='asgn
I
obj='Var
pag=3
prev=O678
var_op='asgn
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Exec
pag=3
prev=O671
I
obj='Var
pag=3
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=3
prev=O525
var_op='asgn
I
obj='Remark
pag=3
x=12
y=18
I
Icpitembatch.CPRemark
frm_calc='Importa i soggetti delle operazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,35,16)
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,202,16)
len=16
name='xCF
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCF)) and Empty(LRTrim(xConnes))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPBeginEnd
comment='Calcola valori da salvare
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPIfElse
frm_calc=[
'xNewSog = 'S'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPCase
frm_calc=[
'xTipo='2' or xTipo='3' or xTipo='7'
'xTipo='4' or xTipo='8'
'xTipo='5'
'xTipo='6' or xTipo='9'
]
h=[
19
19
19
19
19
]
obj='Case
pag=4
prev=O832
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O835
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O840
fatherSonIndex=0
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O840
fatherSonIndex=1
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O835
fatherSonIndex=1
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O862
fatherSonIndex=0
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O862
fatherSonIndex=1
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O835
fatherSonIndex=2
frm_calc=[
'Empty(LRTrim(xConnes)) and Empty(LRTrim(cConnes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O884
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O889
fatherSonIndex=0
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,51,70)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,124,6)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O889
fatherSonIndex=1
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,51,70)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,124,6)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O884
fatherSonIndex=1
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O911
fatherSonIndex=0
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESBEN
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xConnes
'Substr(riga,51,70)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,124,6)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O911
fatherSonIndex=1
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESBEN
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xConnes
'Substr(riga,51,70)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,124,6)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O835
fatherSonIndex=3
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O934
fatherSonIndex=0
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNALTRO
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O934
fatherSonIndex=1
obj='Write
pag=4
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNALTRO
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
150
150
]
I
obj='If
pag=4
prev=O831
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='personbo
father=O832
fatherSonIndex=0
obj='Insert
pag=4
rd_kfield=[
'CONNES
'CODFISC
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'AUTRILASC
'DATARILASC
'SESSO
'NASSTATO
'TIPOPERS
'CFESTERO
'TIPINTER
]
rd_kvar=[
'xConnes
'xCF
'Substr(riga,51,70)
'Substr(riga,124,6)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'CharToDate(Substr(riga,218,8))
'cCNAS
'Substr(riga,256,3)
'xRam
'Substr(riga,262,3)
'xTD
'Substr(riga,293,15)
'Substr(riga,316,30)
'CharToDate(Substr(riga,308,8))
'xSesso
'cSNAS
'cTipPer
'iif(Empty(xCF),1,0)
'_prvnas
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O832
fatherSonIndex=1
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='personbo
obj='Write
pag=4
prev=O965
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'xConnes
]
wr_field=[
'CODFISC
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'AUTRILASC
'DATARILASC
'SESSO
'NASSTATO
'TIPOPERS
'CFESTERO
'TIPINTER
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xCF
'Substr(riga,51,70)
'Substr(riga,124,6)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'CharToDate(Substr(riga,218,8))
'cCNAS
'Substr(riga,256,3)
'xRam
'Substr(riga,262,3)
'xTD
'Substr(riga,293,15)
'Substr(riga,316,30)
'CharToDate(Substr(riga,308,8))
'xSesso
'cSNAS
'cTipPer
'iif(Empty(xCF),1,0)
'_prvnas
]
I
obj='If
pag=4
prev=O963
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O965
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(_gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=4
prev=O977
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES = xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O978
fatherSonIndex=0
obj='Insert
pag=4
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'datamodi
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
'DATAVARAGE
'SETTSINT2
'FATCA
'BANCABEN
'TIN
'ODB
'TELEF
'TIPOORO
'CODORO
'IDNASCOMUN
'IDNASSTATO
'NOTIT
]
rd_kvar=[
'cProgSto
'xConnes
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'_dataope
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
'personbo->DATAVARAGE
'personbo->SETTSINT2
'personbo->FATCA
'personbo->BANCABEN
'personbo->TIN
'personbo->ODB
'personbo->TELEF
'personbo->TIPOORO
'personbo->CODORO
'personbo->IDNASCOMUN
'personbo->IDNASSTATO
'personbo->NOTIT
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=4
prev=O962
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=xConnes and wersonbo->datamodi=_dataope
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O963
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=4
prev=O829
var_op='asgn
I
obj='Begin
pag=4
prev=O826
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPCase
father=O829
fatherSonIndex=0
frm_calc=[
'Substr(riga,346,1)='M'
'Substr(riga,346,1)='F'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_prvnas
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,226,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(xCF))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgrae = 'R'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,291,2)
len=2
name='xTD
next=Icpitembatch.CPIfElse
frm_calc=[
'xTD <> '01' and xTD <> '02' and xTD <> '03' and xTD <> '04' and xTD <> '05' and xTD <> '06'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Empty(xSesso),'G','P')
len=1
name='cTipPer
obj='Var
pag=4
prev=O1007
var_op='asgn
I
obj='If
pag=4
prev=O1006
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1007
fatherSonIndex=0
frm_calc='''
len=2
name='xTD
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=4
prev=O1003
var_op='asgn
I
obj='If
pag=4
prev=O1000
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1003
fatherSonIndex=0
frm_calc='iif(Substr(riga,259,3)='000','',Substr(riga,259,3))
len=3
name='xRam
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1003
fatherSonIndex=1
frm_calc='''
len=3
name='xRam
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=4
prev=O999
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1000
fatherSonIndex=0
frm_calc=[
'Substr(xCF,12,1) = 'Z' and Len(LRTrim(xCF))=16
'Substr(xCF,12,1) <> 'Z' and Len(LRTrim(xCF))=16
]
h=[
19
19
19
]
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1023
fatherSonIndex=0
frm_calc='Substr(riga,226,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='_prvnas
obj='Var
pag=4
prev=O1029
var_op='asgn
I
obj='Var
pag=4
prev=O1028
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tbcitta
father=O1023
fatherSonIndex=1
obj='Read
pag=4
rd_field=[
'PROV
]
rd_kfield=[
'SIGLA
]
rd_kvar=[
'Substr(xCF,12,4)
]
rd_var=[
'_prvnas
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1000
fatherSonIndex=1
frm_calc='Substr(riga,226,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
next=Icpitembatch.CPVarDecl
frm_calc=''EE'
len=2
name='_prvnas
obj='Var
pag=4
prev=O1040
var_op='asgn
I
obj='Var
pag=4
prev=O1039
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=4
prev=O998
var_op='asgn
I
obj='Var
pag=4
prev=O997
var_op='asgn
I
obj='Var
pag=4
prev=O994
var_op='asgn
I
obj='Case
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O994
fatherSonIndex=0
frm_calc=''1'
len=1
name='xSesso
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O994
fatherSonIndex=1
frm_calc=''2'
len=1
name='xSesso
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O994
fatherSonIndex=2
frm_calc='Substr(riga,346,1)
len=1
name='xSesso
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=4
prev=O825
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O826
fatherSonIndex=0
frm_calc=''N'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='cConnes
obj='Var
pag=4
prev=O1054
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O826
fatherSonIndex=1
frm_calc=''N'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='cConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cConnes))
]
h=[
19
19
]
obj='If
pag=4
prev=O1059
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1060
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(xCF))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1065
fatherSonIndex=0
frm_calc=''S'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cConnes
obj='Var
pag=4
prev=O1070
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1065
fatherSonIndex=1
frm_calc='''
len=16
name='cConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cConnes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=4
prev=O1074
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1075
fatherSonIndex=0
frm_calc=''S'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cConnes
obj='Var
pag=4
prev=O1080
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1075
fatherSonIndex=1
frm_calc='cConnes
len=16
name='xConnes
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=4
prev=O1073
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xCF
]
rd_var=[
'cConnes
]
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=4
prev=O1058
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'cConnes
]
I
obj='Var
pag=4
prev=O1057
var_op='asgn
I
obj='Var
pag=4
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=4
prev=O824
var_op='asgn
I
obj='Var
pag=4
prev=O823
var_op='asgn
I
obj='Remark
pag=4
x=14
y=21
I
Icpitembatch.CPRemark
frm_calc='Importa i soggetti dei rapporti
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf = 'A' or xTipoInf = 'C'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='P'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='D'
]
h=[
19
19
]
obj='If
pag=5
prev=O1100
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
father=O1103
fatherSonIndex=0
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,346,1)='M'
'Substr(riga,346,1)='F'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,226,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(xCF,12,1) = 'Z' and Len(LRTrim(xCF))=16
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgrae = 'R'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,291,2)
len=2
name='xTD
next=Icpitembatch.CPIfElse
frm_calc=[
'xTD <> '01' and xTD <> '02' and xTD <> '03' and xTD <> '04' and xTD <> '05' and xTD <> '06'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Len(LRTrim(xCF))=16,'P','G')
len=1
name='cTipPer
next=Icpitembatch.CPWrite
arch='personbo
obj='Write
pag=5
prev=O1124
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'cConnes
]
wr_field=[
'CODFISC
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'AUTRILASC
'DATARILASC
'SESSO
'NASSTATO
'TIPOPERS
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xCF
'Substr(riga,51,70)
'Substr(riga,124,6)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'CharToDate(Substr(riga,218,8))
'cCNAS
'Substr(riga,256,3)
'xRam
'Substr(riga,262,3)
'xTD
'Substr(riga,293,15)
'Substr(riga,316,30)
'CharToDate(Substr(riga,308,8))
'xSesso
'cSNAS
'cTipPer
]
I
obj='Var
pag=5
prev=O1121
var_op='asgn
I
obj='If
pag=5
prev=O1120
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1121
fatherSonIndex=0
frm_calc='''
len=2
name='xTD
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1117
var_op='asgn
I
obj='If
pag=5
prev=O1114
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1117
fatherSonIndex=0
frm_calc='iif(Substr(riga,259,3)='000','',Substr(riga,259,3))
len=3
name='xRam
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1117
fatherSonIndex=1
frm_calc='''
len=3
name='xRam
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=5
prev=O1113
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1114
fatherSonIndex=0
frm_calc='Substr(riga,226,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=5
prev=O1144
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1112
var_op='asgn
I
obj='Var
pag=5
prev=O1109
var_op='asgn
I
obj='Case
pag=5
prev=O1108
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1109
fatherSonIndex=0
frm_calc=''1'
len=1
name='xSesso
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1109
fatherSonIndex=1
frm_calc=''2'
len=1
name='xSesso
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1109
fatherSonIndex=2
frm_calc='Substr(riga,346,1)
len=1
name='xSesso
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1097
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O1100
fatherSonIndex=0
frm_calc='Calcola il progressivo di registrazione
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(_gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1159
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES = cConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O1160
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'datamodi
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
]
rd_kvar=[
'cProgSto
'personbo->CONNES
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'xDatOpe
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1158
var_op='asgn
I
obj='Remark
pag=5
I
I
]
w=[
150
150
]
I
obj='If
pag=5
prev=O1096
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1097
fatherSonIndex=0
frm_calc='Substr(riga,35,16)
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,202,16)
len=16
name='xCF
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCF)) and Empty(LRTrim(xConnes))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,51,70)
len=70
name='cRagSoc
next=Icpitembatch.CPIfElse
frm_calc=[
'xNewSog = 'S'
]
h=[
19
19
]
next=Icpitembatch.CPCase
frm_calc=[
'xTipo='2' or xTipo='3'  or xTipo='7'
'xTipo='4' or xTipo='5'
'xTipo='6'
]
h=[
19
19
19
19
]
obj='Case
pag=5
prev=O1177
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1180
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
next=Icpitembatch.CPWrite
arch='knarapbo
obj='Write
pag=5
prev=O1185
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'DESCRAP
]
wr_op=[
'=
]
wr_var=[
'Left(LRTrim(cRagSoc),50)
]
I
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1185
fatherSonIndex=0
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow > 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1198
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xntestbo
father=O1200
fatherSonIndex=0
next=Icpitembatch.CPWrite
arch='xnarapbo
obj='Write
pag=5
prev=O1205
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'DESCRAP
]
wr_op=[
'=
]
wr_var=[
'Left(LRTrim(cRagSoc),50)
]
I
obj='Write
pag=5
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xRapporto
'cMaxRow
]
wr_field=[
'CODINTER
]
wr_op=[
'=
]
wr_var=[
'cConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1200
fatherSonIndex=1
frm_calc='''
len=16
name='xIDBx
next=Icpitembatch.CPRead
arch='xntestbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDBx))
]
h=[
19
19
]
obj='If
pag=5
prev=O1221
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1222
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1229
sel_field='*
sel_name='xntestbo
sel_where='xntestbo->RAPPORTO=xRapporto and xntestbo->CPROWNUM=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='xntestbo
father=O1230
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'CODINTER
'DATAFINE
'NUMPROG1
'NUMPROG2
'RAPPORTO
'TIPORAP
'STATOREG
'PRGIMPSOG
'TIPOPERS
]
rd_kvar=[
'xIDB
'cMaxRow
'xntestbo->DATAINI
'cConnes
'xntestbo->DATAFINE
'xntestbo->NUMPROG1
'xntestbo->NUMPROG2
'xRapporto
'xntestbo->TIPORAP
''0'
'nProgImp2
''P'
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1228
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1227
var_op='asgn
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O1220
rd_field=[
'CODINTER
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'xRapporto
'cConnes
]
rd_var=[
'xIDBx
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=5
par_expr=[
'xRapporto
]
par_name=[
'xRapporto
]
prev=O1197
sel_field='xntestbo->CPROWNUM
sel_name='qbe_offline_max_int
sel_order='xntestbo->CPROWNUM
sel_type='sqry
sel_where='xntestbo->RAPPORTO = xRapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1198
fatherSonIndex=0
frm_calc='qbe_offline_max_int->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1185
fatherSonIndex=1
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow > 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1252
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='intestbo
father=O1254
fatherSonIndex=0
next=Icpitembatch.CPWrite
arch='anarapbo
obj='Write
pag=5
prev=O1259
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'DESCRAP
]
wr_op=[
'=
]
wr_var=[
'Left(LRTrim(cRagSoc),50)
]
I
obj='Write
pag=5
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xRapporto
'cMaxRow
]
wr_field=[
'CODINTER
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1254
fatherSonIndex=1
frm_calc='''
len=16
name='xIDBx
next=Icpitembatch.CPRead
arch='intestbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDBx))
]
h=[
19
19
]
obj='If
pag=5
prev=O1275
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1276
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=5
prev=O1283
sel_field='*
sel_name='intestbo
sel_where='intestbo->RAPPORTO=xRapporto and intestbo->CPROWNUM=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='intestbo
father=O1284
fatherSonIndex=0
obj='Insert
pag=5
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'CODINTER
'DATAFINE
'NUMPROG1
'NUMPROG2
'RAPPORTO
'TIPORAP
'STATOREG
'PRGIMPSOG
]
rd_kvar=[
'xIDB
'cMaxRow
'intestbo->DATAINI
'cConnes
'intestbo->DATAFINE
'intestbo->NUMPROG1
'intestbo->NUMPROG2
'intestbo->RAPPORTO
'intestbo->TIPORAP
''0'
'nProgImp2
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1282
var_op='asgn
I
obj='Var
obj_type='N
pag=5
prev=O1281
var_op='asgn
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O1274
rd_field=[
'CODINTER
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'xRapporto
'cConnes
]
rd_var=[
'xIDBx
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Select
pag=5
prev=O1251
sel_field='xntestbo->CPROWNUM
sel_name='qbe_offline_max_int_d
sel_order='xntestbo->CPROWNUM
sel_type='sqry
sel_where='xntestbo->RAPPORTO = xRapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1252
fatherSonIndex=0
frm_calc='qbe_offline_max_int_d->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1180
fatherSonIndex=1
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xapopebo
father=O1304
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'cDelega='S'
]
h=[
19
19
]
obj='If
pag=5
prev=O1309
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1310
fatherSonIndex=0
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow = 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A'
'xTipoInf='C'
]
h=[
19
19
19
]
obj='If
pag=5
prev=O1318
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xelegabo
father=O1321
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xRapporto
'cMaxRow
]
wr_field=[
'DATAINI
'NUMPROG1
]
wr_op=[
'=
'=
]
wr_var=[
'xDatOpe
'cInfProg2
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xelegabo
father=O1321
fatherSonIndex=1
obj='Write
pag=5
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xRapporto
'cMaxRow
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'xDatOpe
'cInfProg2
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=5
prev=O1316
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1318
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='xelegabo
obj='Insert
pag=5
prev=O1346
rd_kfield=[
'RAPPORTO
'CPROWNUM
'CODINTER
'DESCINTER
'TIPORAP
'TIPOPERS
'STATOREG
'IDBASE
]
rd_kvar=[
'xRapporto
'cMaxRow
'cConnes
'Substr(riga,51,70)
'xTipRap
''P'
''0'
'LibreriaMit.UniqueId()
]
I
obj='Var
obj_type='N
pag=5
prev=O1344
var_op='asgn
I
obj='Select
pag=5
sel_field='xelegabo->CPROWNUM
sel_name='delegabo
sel_order='xelegabo->CPROWNUM
sel_where='xelegabo->RAPPORTO=xRapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1344
fatherSonIndex=0
frm_calc='xelegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1315
sel_field='xelegabo->CPROWNUM
sel_name='xelegabo
sel_where='xelegabo->RAPPORTO=xRapporto and xelegabo->CODINTER=cConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1316
fatherSonIndex=0
frm_calc='xelegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Write
pag=5
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cInfProg1
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'cConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='rapopebo
father=O1304
fatherSonIndex=1
next=Icpitembatch.CPIfElse
frm_calc=[
'cDelega='S'
]
h=[
19
19
]
obj='If
pag=5
prev=O1367
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1368
fatherSonIndex=0
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'cMaxRow = 0
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A'
'xTipoInf='C'
]
h=[
19
19
19
]
obj='If
pag=5
prev=O1376
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='delegabo
father=O1379
fatherSonIndex=0
obj='Write
pag=5
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xRapporto
'cMaxRow
]
wr_field=[
'DATAINI
'NUMPROG1
]
wr_op=[
'=
'=
]
wr_var=[
'xDatOpe
'cInfProg2
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='delegabo
father=O1379
fatherSonIndex=1
obj='Write
pag=5
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xRapporto
'cMaxRow
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'xDatOpe
'cInfProg2
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=5
prev=O1374
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPSelect
father=O1376
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPInsert
arch='delegabo
obj='Insert
pag=5
prev=O1404
rd_kfield=[
'RAPPORTO
'CPROWNUM
'CODINTER
'DESCINTER
'TIPORAP
'TIPOPERS
'STATOREG
'IDBASE
]
rd_kvar=[
'xRapporto
'cMaxRow
'cConnes
'Substr(riga,51,70)
'xTipRap
''P'
''0'
'LibreriaMit.UniqueId()
]
I
obj='Var
obj_type='N
pag=5
prev=O1402
var_op='asgn
I
obj='Select
pag=5
sel_field='delegabo->CPROWNUM
sel_name='delegabo
sel_order='delegabo->CPROWNUM
sel_where='delegabo->RAPPORTO=xRapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1402
fatherSonIndex=0
frm_calc='delegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Select
pag=5
prev=O1373
sel_field='delegabo->CPROWNUM
sel_name='delegabo
sel_order='delegabo->CPROWNUM
sel_where='delegabo->RAPPORTO=xRapporto and delegabo->CODINTER=cConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1374
fatherSonIndex=0
frm_calc='delegabo->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Write
pag=5
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cInfProg1
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'cConnes
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
I
]
w=[
150
150
150
150
]
I
obj='If
pag=5
prev=O1176
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
father=O1177
fatherSonIndex=0
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,346,1)='M'
'Substr(riga,346,1)='F'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,226,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(xCF,12,1) = 'Z' and Len(LRTrim(xCF))=16
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgrae = 'R'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,291,2)
len=2
name='xTD
next=Icpitembatch.CPIfElse
frm_calc=[
'xTD <> '01' and xTD <> '02' and xTD <> '03' and xTD <> '04' and xTD <> '05' and xTD <> '06'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Len(LRTrim(xCF))=16,'P','G')
len=1
name='cTipPer
next=Icpitembatch.CPInsert
arch='personbo
obj='Insert
pag=5
prev=O1445
rd_kfield=[
'CONNES
'CODFISC
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'AUTRILASC
'DATARILASC
'SESSO
'NASSTATO
'TIPOPERS
]
rd_kvar=[
'xConnes
'xCF
'Substr(riga,51,70)
'Substr(riga,124,6)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'CharToDate(Substr(riga,218,8))
'cCNAS
'Substr(riga,256,3)
'xRam
'Substr(riga,262,3)
'xTD
'Substr(riga,293,15)
'Substr(riga,316,30)
'CharToDate(Substr(riga,308,8))
'xSesso
'cSNAS
'cTipPer
]
I
obj='Var
pag=5
prev=O1442
var_op='asgn
I
obj='If
pag=5
prev=O1441
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1442
fatherSonIndex=0
frm_calc='''
len=2
name='xTD
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1438
var_op='asgn
I
obj='If
pag=5
prev=O1435
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1438
fatherSonIndex=0
frm_calc='iif(Substr(riga,259,3)='000','',Substr(riga,259,3))
len=3
name='xRam
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1438
fatherSonIndex=1
frm_calc='''
len=3
name='xRam
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=5
prev=O1434
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1435
fatherSonIndex=0
frm_calc='Substr(riga,226,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=5
prev=O1461
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1433
var_op='asgn
I
obj='Var
pag=5
prev=O1430
var_op='asgn
I
obj='Case
pag=5
prev=O1429
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1430
fatherSonIndex=0
frm_calc=''1'
len=1
name='xSesso
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1430
fatherSonIndex=1
frm_calc=''2'
len=1
name='xSesso
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1430
fatherSonIndex=2
frm_calc='Substr(riga,346,1)
len=1
name='xSesso
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
obj_type='N
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=5
prev=O1173
var_op='asgn
I
obj='If
pag=5
prev=O1172
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1173
fatherSonIndex=0
frm_calc=''S'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cConnes
obj='Var
pag=5
prev=O1476
var_op='asgn
I
obj='Var
pag=5
prev=O1475
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1173
fatherSonIndex=1
frm_calc=''N'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='cConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cConnes))
]
h=[
19
19
]
obj='If
pag=5
prev=O1481
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1482
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(xCF))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1487
fatherSonIndex=0
frm_calc=''S'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cConnes
obj='Var
pag=5
prev=O1492
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1487
fatherSonIndex=1
frm_calc='''
len=16
name='cConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cConnes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=5
prev=O1496
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1497
fatherSonIndex=0
frm_calc=''S'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cConnes
obj='Var
pag=5
prev=O1502
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1497
fatherSonIndex=1
frm_calc='cConnes
len=16
name='xConnes
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=5
prev=O1495
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xCF
]
rd_var=[
'cConnes
]
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=5
prev=O1480
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'cConnes
]
I
obj='Var
pag=5
prev=O1479
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=5
prev=O1171
var_op='asgn
I
obj='Var
pag=5
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=5
x=14
y=16
I
Icpitembatch.CPRemark
frm_calc='Controllo se apertura o chiusura o altro
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,234,2)='26' or Substr(riga,234,2)='28' or Substr(riga,234,2)='36'  or Substr(riga,234,2)='38' or Substr(riga,234,2)='46' or Substr(riga,234,2)='50'  or Substr(riga,234,2)='52'
'Substr(riga,234,2)='21' or Substr(riga,234,2)='22' or Substr(riga,234,2)='23' or Substr(riga,234,2)='25' or Substr(riga,234,2)='33' or Substr(riga,234,2)='34' or Substr(riga,234,2)='35'  or Substr(riga,234,2)='37' or Substr(riga,234,2)='43' or Substr(riga,234,2)='44' or Substr(riga,234,2)='45'  or Substr(riga,234,2)='51'  or Substr(riga,234,2)='53' or Substr(riga,234,2)='58'
'Substr(riga,234,2)='31' or Substr(riga,234,2)='54'
'Substr(riga,234,2)='32' or Substr(riga,234,2)='55'
]
h=[
19
19
19
19
19
19
]
haselse=True
obj='Case
pag=6
prev=O1519
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1520
fatherSonIndex=0
frm_calc=''C'
len=1
name='xTipoInf
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1520
fatherSonIndex=1
frm_calc=''A'
len=1
name='xTipoInf
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1520
fatherSonIndex=2
frm_calc=''P'
len=1
name='xTipoInf
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1520
fatherSonIndex=3
frm_calc=''D'
len=1
name='xTipoInf
obj='Var
pag=6
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1520
fatherSonIndex=4
frm_calc=''X'
len=1
name='xTipoInf
obj='Var
pag=6
var_op='asgn
I
I
]
w=[
150
150
150
150
150
150
]
I
obj='Remark
pag=6
x=18
y=28
I
Icpitembatch.CPRemark
frm_calc='Importa i dati base delle operazioni
next=Icpitembatch.CPVarDecl
comment='Contatore Operazioni
frm_calc='cNumOpe + 1
len=10
name='cNumOpe
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cOpeProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PPOPER2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cOpeProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPOPE\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,199,25),Space(25))
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,224,1),Space(1))
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,35,6)
len=6
name='xDIP
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xDIP)))
]
h=[
19
19
]
next=Icpitembatch.CPRead
arch='tbcauana
next=Icpitembatch.CPInsert
arch='tmp_operazbo_ol
h=[
19
19
]
obj='Insert
pag=7
prev=O1548
rd_kfield=[
'IDBASE
'NUMPROG
'DATAOPE
'TIPOINTER
'CODINTER
'TIPOINF
'IDEREG
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'OPRAP
'TIPOOPRAP
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'STATOREG
'OPERAZMOD
'DATARETT
'RIFIMP
'idcauana
'CDATOPE
'CDATAOPE
'PRGIMPOPE
'CDATREG
'COLLEG
]
rd_kvar=[
'cOpeProg1
'cOpeProg2
'CharToDate(Substr(riga,79,8))
'Substr(riga,1,2)
'Substr(riga,3,11)
''1'
'Substr(riga,79,8) + cOpeProg2 + Substr(riga,248,1)
'Substr(riga,35,6)
'Substr(riga,47,30)
'Substr(riga,77,2)
'Substr(riga,41,6)
'Substr(riga,87,1)
'Substr(riga,88,1)
'Substr(riga,89,4)
'Substr(riga,93,2)
'Substr(riga,95,2)
'Substr(riga,97,11)
'Substr(riga,108,3)
'Substr(riga,117,30)
'Substr(riga,147,2)
'Substr(riga,111,6)
'Substr(riga,149,50)
'xRapporto
'xTipRap
'Substr(riga,225,1)
'CharToDate(Substr(riga,226,8))
'Substr(riga,234,1)
'Substr(riga,234,2)
'Substr(riga,277,1)
'Substr(riga,278,3)
'Substr(riga,281,1)
'Val(Substr(riga,282,15))
'Val(Substr(riga,297,15))
'Substr(riga,248,1)
'Substr(riga,257,20)
'CharToDate(Substr(riga,249,8))
'LRTrim(Substr(riga,236,12))
'cIdCau
'Substr(riga,79,8)
'Substr(riga,79,8)
'nProgImp
'Substr(riga,226,8)
'LRTrim(Substr(riga,236,12))
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1549
fatherSonIndex=0
frm_calc='_gMsgProc +"Rilevati errori nel file "+w_nomefile+" per l'operazione in data "+Substr(riga,79,8)+" con importo "+Str((Val(Substr(riga,282,15)))/100,14,2)+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
len=10
name='_gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=7
prev=O1555
I
obj='Var
obj_type='M
pag=7
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Read
pag=7
prev=O1545
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
]
rd_kvar=[
'Substr(riga,89,4)
'Substr(riga,93,2)
]
rd_var=[
'cIdCau
]
I
obj='If
pag=7
prev=O1544
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anadip
father=O1545
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDIPx))
]
h=[
19
19
]
obj='If
pag=7
prev=O1564
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anadip
father=O1565
fatherSonIndex=0
obj='Insert
pag=7
rd_kfield=[
'CODDIP
'DESCRIZ
]
rd_kvar=[
'xDIP
'xDIP
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=7
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'xDIP
]
rd_var=[
'xDIPx
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=7
prev=O1543
var_op='asgn
I
obj='Var
pag=7
prev=O1542
var_op='asgn
I
obj='Var
pag=7
prev=O1541
var_op='asgn
I
obj='Var
pag=7
prev=O1540
var_op='asgn
I
obj='Var
pag=7
prev=O1539
var_op='asgn
I
obj='Var
obj_type='N
pag=7
prev=O1538
var_op='asgn
I
obj='Var
pag=7
prev=O1537
var_op='asgn
I
obj='Var
pag=7
prev=O1536
var_op='asgn
I
obj='Var
obj_type='N
pag=7
prev=O1535
var_op='asgn
I
obj='Remark
pag=7
x=15
y=20
I
Icpitembatch.CPRemark
frm_calc='Importa i dati base dei rapporti
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='cNumInf + 1
len=10
name='cNumInf
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPINFO2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPINF\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,199,25),Space(25))
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,224,1),Space(1))
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,248,1)='2','2',iif(Substr(riga,248,1)='0','S','A'))
len=1
name='streg
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,35,6)
len=6
name='xDIP
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xDIP)))
]
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='tmp_rapopebo_ol
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Inserisce Rapporto e Intestatario
h=[
19
19
]
obj='Begin
pag=8
prev=O1593
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1595
fatherSonIndex=0
frm_calc='''
len=25
name='xAppRap
next=Icpitembatch.CPRead
arch='tmp_anarapbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xAppRap))
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='xTipoInf
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='xIDB
next=Icpitembatch.CPExec
check='page
frm_calc='6
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A' or xTipoInf='C'
]
h=[
19
19
]
obj='If
pag=8
prev=O1606
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='tmp_intestbo_ol
father=O1607
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDB))
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='A'
'xTipoInf='C'
]
h=[
19
19
19
]
obj='If
pag=8
prev=O1613
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tmp_intestbo_ol
father=O1616
fatherSonIndex=0
obj='Write
pag=8
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'TIPOPERS
'DATAINI
]
wr_op=[
'=
'=
]
wr_var=[
''P'
'CharToDate(Substr(riga,79,8))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tmp_intestbo_ol
father=O1616
fatherSonIndex=1
obj='Write
pag=8
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'DATAFINE
'NUMPROG2
]
wr_op=[
'=
'=
]
wr_var=[
'CharToDate(Substr(riga,79,8))
'cInfProg2
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=8
prev=O1612
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1613
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPInsert
arch='tmp_intestbo_ol
h=[
19
19
]
obj='Insert
pag=8
prev=O1640
rd_kfield=[
'IDBASE
'CPROWNUM
'NUMPROG1
'STATOREG
'RAPPORTO
'TIPORAP
'PRGIMPSOG
'TIPOPERS
]
rd_kvar=[
'xIDB
'1
'cInfProg2
''0'
'xRapporto
'Substr(riga,224,1)
'nProgImp2
''P'
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1641
fatherSonIndex=0
frm_calc='_gMsgProc +"Rilevati errori nel file "+w_nomefile+" per la registrazione dell'intestatario dell'informazione in data "+Substr(riga,79,8)+" relativa al rapporto: "+ xRapporto +" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
len=10
name='_gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=8
prev=O1647
I
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='Var
pag=8
prev=O1639
var_op='asgn
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
rd_field=[
'IDBASE
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'xRapporto
]
rd_var=[
'xIDB
]
I
I
]
w=[
150
150
]
I
obj='Exec
pag=8
prev=O1605
I
obj='Var
pag=8
prev=O1604
var_op='asgn
I
obj='Var
pag=8
prev=O1601
var_op='asgn
I
obj='If
pag=8
prev=O1600
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Rapporti
father=O1601
fatherSonIndex=0
frm_calc='cNumRap + 1
len=10
name='cNumRap
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPRAP\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgRap
next=Icpitembatch.CPInsert
arch='tmp_anarapbo
obj='Insert
pag=8
prev=O1659
rd_kfield=[
'RAPPORTO
'TIPORAP
'FLAGLIRE
'VALUTA
]
rd_kvar=[
'xRapporto
'Substr(riga,224,1)
'iif(Substr(riga,277,1)='1','L',iif(Substr(riga,277,1)='2','V','E'))
'Substr(riga,278,3)
]
I
obj='Var
obj_type='N
pag=8
prev=O1658
var_op='asgn
I
obj='Var
obj_type='N
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
prev=O1599
rd_field=[
'RAPPORTO
]
rd_kfield=[
'RAPPORTO
]
rd_kvar=[
'xRapporto
]
rd_var=[
'xAppRap
]
I
obj='Var
pag=8
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Insert
pag=8
prev=O1590
rd_kfield=[
'IDBASE
'NUMPROG
'DATAOPE
'TIPOINTER
'CODINTER
'TIPOINF
'IDEREG
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'OPRAP
'TIPOOPRAP
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'STATOREG
'OPERAZMOD
'DATARETT
'COLLEG
'PRGIMPINF
'CDATREG
'CDATOPE
]
rd_kvar=[
'cInfProg1
'cInfProg2
'CharToDate(Substr(riga,79,8))
'Substr(riga,1,2)
'Substr(riga,3,11)
''1'
'Substr(riga,79,8) + cOpeProg2 + streg
'Substr(riga,35,6)
'Substr(riga,47,30)
'Substr(riga,77,2)
'Substr(riga,41,6)
'Substr(riga,87,1)
'Substr(riga,88,1)
'Substr(riga,89,4)
'Substr(riga,93,2)
'Substr(riga,95,2)
'Substr(riga,97,11)
'Substr(riga,108,3)
'Substr(riga,117,30)
'Substr(riga,147,2)
'Substr(riga,111,6)
'Substr(riga,149,50)
'xRapporto
'xTipRap
'Substr(riga,225,1)
'CharToDate(Substr(riga,226,8))
'Substr(riga,234,1)
'Substr(riga,234,2)
'Substr(riga,277,1)
'Substr(riga,278,3)
'Substr(riga,281,1)
'Val(Substr(riga,282,15))
'Val(Substr(riga,297,15))
'Substr(riga,248,1)
'Substr(riga,257,20)
'CharToDate(Substr(riga,249,8))
'Substr(riga,236,12)
'nProgImp
'Substr(riga,226,8)
'Substr(riga,79,8)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1593
fatherSonIndex=0
frm_calc='_gMsgProc +"Rilevati errori nel file "+w_nomefile+" per l'informazione in data "+Substr(riga,79,8)+" relativa al rapporto: "+xRapporto+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
len=10
name='_gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=8
prev=O1673
I
obj='Var
obj_type='M
pag=8
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='If
pag=8
prev=O1589
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anadip
father=O1590
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDIPx))
]
h=[
19
19
]
obj='If
pag=8
prev=O1678
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anadip
father=O1679
fatherSonIndex=0
obj='Insert
pag=8
rd_kfield=[
'CODDIP
'DESCRIZ
]
rd_kvar=[
'xDIP
'xDIP
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=8
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'xDIP
]
rd_var=[
'xDIPx
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=8
prev=O1588
var_op='asgn
I
obj='Var
pag=8
prev=O1587
var_op='asgn
I
obj='Var
pag=8
prev=O1586
var_op='asgn
I
obj='Var
pag=8
prev=O1585
var_op='asgn
I
obj='Var
pag=8
prev=O1584
var_op='asgn
I
obj='Var
pag=8
prev=O1583
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O1582
var_op='asgn
I
obj='Var
pag=8
prev=O1581
var_op='asgn
I
obj='Var
pag=8
prev=O1580
var_op='asgn
I
obj='Var
obj_type='N
pag=8
prev=O1579
var_op='asgn
I
obj='Remark
pag=8
x=21
y=23
I
Icpitembatch.CPRemark
frm_calc='Importa i soggetti dei rapporti
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,35,16)
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,202,16)
len=16
name='xCF
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCF)) and Empty(LRTrim(xConnes))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,51,70)
len=70
name='cRagSoc
next=Icpitembatch.CPIfElse
frm_calc=[
'xNewSog = 'S'
]
h=[
19
19
]
next=Icpitembatch.CPCase
frm_calc=[
'xTipo='2' or xTipo='3'
'xTipo='4' or xTipo='5'
]
h=[
19
19
19
]
obj='Case
pag=10
prev=O1700
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1703
fatherSonIndex=0
frm_calc='0
len=4
name='cMaxRow
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPRead
arch='tmp_intestbo_ol
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDBx))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
prev=O1711
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tmp_intestbo_ol
father=O1712
fatherSonIndex=0
next=Icpitembatch.CPWrite
arch='tmp_anarapbo
obj='Write
pag=10
prev=O1717
rd_kfield=[
'RAPPORTO
]
rd_kop=[
'=
]
rd_kvar=[
'xRapporto
]
wr_field=[
'DESCRAP
]
wr_op=[
'=
]
wr_var=[
'Left(LRTrim(cRagSoc),50)
]
I
obj='Write
pag=10
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kop=[
'=
'=
]
rd_kvar=[
'xRapporto
'cMaxRow
]
wr_field=[
'CODINTER
]
wr_op=[
'=
]
wr_var=[
'cConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1712
fatherSonIndex=1
frm_calc='''
len=16
name='xIDBx
next=Icpitembatch.CPRead
arch='tmp_intestbo_ol
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xIDBx))
]
h=[
19
19
]
obj='If
pag=10
prev=O1733
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1734
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGIMPSOG\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp2
next=Icpitembatch.CPVarDecl
frm_calc='cMaxRow + 1
len=4
name='cMaxRow
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=10
name='xIDB
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=10
prev=O1741
sel_field='*
sel_name='tmp_intestbo_ol
sel_where='tmp_intestbo_ol->RAPPORTO=xRapporto and tmp_intestbo_ol->CPROWNUM=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tmp_intestbo_ol
father=O1742
fatherSonIndex=0
obj='Insert
pag=10
rd_kfield=[
'IDBASE
'CPROWNUM
'DATAINI
'CODINTER
'DATAFINE
'NUMPROG1
'NUMPROG2
'RAPPORTO
'TIPORAP
'STATOREG
'PRGIMPSOG
'TIPOPERS
]
rd_kvar=[
'xIDB
'cMaxRow
'tmp_intestbo_ol->DATAINI
'cConnes
'tmp_intestbo_ol->DATAFINE
'tmp_intestbo_ol->NUMPROG1
'tmp_intestbo_ol->NUMPROG2
'xRapporto
'tmp_intestbo_ol->TIPORAP
''0'
'nProgImp2
''P'
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
prev=O1740
var_op='asgn
I
obj='Var
obj_type='N
pag=10
prev=O1739
var_op='asgn
I
obj='Var
obj_type='N
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
prev=O1732
rd_field=[
'CODINTER
]
rd_kfield=[
'RAPPORTO
'CODINTER
]
rd_kvar=[
'xRapporto
'cConnes
]
rd_var=[
'xIDBx
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=10
prev=O1709
rd_field=[
'CODINTER
]
rd_kfield=[
'RAPPORTO
'CPROWNUM
]
rd_kvar=[
'xRapporto
'cMaxRow
]
rd_var=[
'xIDBx
]
I
obj='Select
pag=10
prev=O1708
sel_field='tmp_intestbo_ol->CPROWNUM
sel_name='tmp_intestbo_ol
sel_order='tmp_intestbo_ol->CPROWNUM
sel_where='tmp_intestbo_ol->RAPPORTO=xRapporto
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1709
fatherSonIndex=0
frm_calc='tmp_intestbo_ol->CPROWNUM
len=4
name='cMaxRow
obj='Var
obj_type='N
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tmp_rapopebo_ol
father=O1703
fatherSonIndex=1
obj='Write
pag=10
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cInfProg1
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'cConnes
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=10
prev=O1699
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
father=O1700
fatherSonIndex=0
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,346,1)='M'
'Substr(riga,346,1)='F'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,226,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(xCF,12,1) = 'Z' and Len(LRTrim(xCF))=16
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,259,3)='000','',Substr(riga,259,3))
len=3
name='xRam
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,291,2)
len=2
name='xTD
next=Icpitembatch.CPIfElse
frm_calc=[
'xTD <> '01' and xTD <> '02' and xTD <> '03' and xTD <> '04' and xTD <> '05' and xTD <> '06'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Len(LRTrim(xCF))=16,'P','G')
len=1
name='cTipPer
next=Icpitembatch.CPInsert
arch='personbo
obj='Insert
pag=10
prev=O1790
rd_kfield=[
'CONNES
'CODFISC
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'AUTRILASC
'DATARILASC
'SESSO
'NASSTATO
'TIPOPERS
]
rd_kvar=[
'xConnes
'xCF
'Substr(riga,51,70)
'Substr(riga,124,6)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'CharToDate(Substr(riga,218,8))
'cCNAS
'Substr(riga,256,3)
'xRam
'Substr(riga,262,3)
'xTD
'Substr(riga,293,15)
'Substr(riga,316,30)
'CharToDate(Substr(riga,308,8))
'xSesso
'cSNAS
'cTipPer
]
I
obj='Var
pag=10
prev=O1787
var_op='asgn
I
obj='If
pag=10
prev=O1786
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1787
fatherSonIndex=0
frm_calc='''
len=2
name='xTD
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
prev=O1785
var_op='asgn
I
obj='Var
pag=10
prev=O1782
var_op='asgn
I
obj='If
pag=10
prev=O1781
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1782
fatherSonIndex=0
frm_calc='Substr(riga,226,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=10
prev=O1800
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
prev=O1780
var_op='asgn
I
obj='Var
pag=10
prev=O1777
var_op='asgn
I
obj='Case
pag=10
prev=O1776
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1777
fatherSonIndex=0
frm_calc=''1'
len=1
name='xSesso
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1777
fatherSonIndex=1
frm_calc=''2'
len=1
name='xSesso
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1777
fatherSonIndex=2
frm_calc='Substr(riga,346,1)
len=1
name='xSesso
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
obj_type='N
pag=10
prev=O1775
var_op='asgn
I
obj='Var
obj_type='N
pag=10
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=10
prev=O1696
var_op='asgn
I
obj='If
pag=10
prev=O1695
sons=[
Icpitembatch.CPItemSon
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1696
fatherSonIndex=1
frm_calc=''N'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='cConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cConnes))
]
h=[
19
19
]
obj='If
pag=10
prev=O1817
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1818
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(xCF))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1823
fatherSonIndex=0
frm_calc=''S'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cConnes
obj='Var
pag=10
prev=O1828
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1823
fatherSonIndex=1
frm_calc='''
len=16
name='cConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cConnes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=10
prev=O1832
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1833
fatherSonIndex=0
frm_calc=''S'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cConnes
obj='Var
pag=10
prev=O1838
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1833
fatherSonIndex=1
frm_calc='cConnes
len=16
name='xConnes
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=10
prev=O1831
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xCF
]
rd_var=[
'cConnes
]
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=10
prev=O1816
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'cConnes
]
I
obj='Var
pag=10
prev=O1815
var_op='asgn
I
obj='Var
pag=10
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=10
prev=O1694
var_op='asgn
I
obj='Var
pag=10
prev=O1693
var_op='asgn
I
obj='Remark
pag=10
x=18
y=22
I
Icpitembatch.CPRemark
frm_calc='Importa i soggetti delle operazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,35,16)
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,202,16)
len=16
name='xCF
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCF)) and Empty(LRTrim(xConnes))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPIfElse
frm_calc=[
'xNewSog = 'S'
]
h=[
19
19
]
next=Icpitembatch.CPCase
frm_calc=[
'xTipo='2' or xTipo='3'
'xTipo='4'
'xTipo='5'
]
h=[
19
19
19
19
]
obj='Case
pag=9
prev=O1860
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tmp_operazbo_ol
father=O1863
fatherSonIndex=0
obj='Write
pag=9
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tmp_operazbo_ol
father=O1863
fatherSonIndex=1
obj='Write
pag=9
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tmp_operazbo_ol
father=O1863
fatherSonIndex=2
obj='Write
pag=9
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESBEN
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
]
w=[
150
150
150
150
]
I
obj='If
pag=9
prev=O1857
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
father=O1860
fatherSonIndex=0
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,346,1)='M'
'Substr(riga,346,1)='F'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,226,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(xCF,12,1) = 'Z' and Len(LRTrim(xCF))=16
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,259,3)='000','',Substr(riga,259,3))
len=3
name='xRam
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,291,2)
len=2
name='xTD
next=Icpitembatch.CPIfElse
frm_calc=[
'xTD <> '01' and xTD <> '02' and xTD <> '03' and xTD <> '04' and xTD <> '05' and xTD <> '06'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Len(LRTrim(xCF))=16,'P','G')
len=1
name='cTipPer
next=Icpitembatch.CPInsert
arch='personbo
obj='Insert
pag=9
prev=O1909
rd_kfield=[
'CONNES
'CODFISC
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'AUTRILASC
'DATARILASC
'SESSO
'NASSTATO
'TIPOPERS
]
rd_kvar=[
'xConnes
'xCF
'Substr(riga,51,70)
'Substr(riga,124,6)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'CharToDate(Substr(riga,218,8))
'cCNAS
'Substr(riga,256,3)
'xRam
'Substr(riga,262,3)
'xTD
'Substr(riga,293,15)
'Substr(riga,316,30)
'CharToDate(Substr(riga,308,8))
'xSesso
'cSNAS
'cTipPer
]
I
obj='Var
pag=9
prev=O1906
var_op='asgn
I
obj='If
pag=9
prev=O1905
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1906
fatherSonIndex=0
frm_calc='''
len=2
name='xTD
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O1904
var_op='asgn
I
obj='Var
pag=9
prev=O1901
var_op='asgn
I
obj='If
pag=9
prev=O1900
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1901
fatherSonIndex=0
frm_calc='Substr(riga,226,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=9
prev=O1919
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=9
prev=O1899
var_op='asgn
I
obj='Var
pag=9
prev=O1896
var_op='asgn
I
obj='Case
pag=9
prev=O1895
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1896
fatherSonIndex=0
frm_calc=''1'
len=1
name='xSesso
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1896
fatherSonIndex=1
frm_calc=''2'
len=1
name='xSesso
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1896
fatherSonIndex=2
frm_calc='Substr(riga,346,1)
len=1
name='xSesso
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
obj_type='N
pag=9
prev=O1894
var_op='asgn
I
obj='Var
obj_type='N
pag=9
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=9
prev=O1856
sons=[
Icpitembatch.CPItemSon
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1857
fatherSonIndex=1
frm_calc=''N'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='cConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cConnes))
]
h=[
19
19
]
obj='If
pag=9
prev=O1936
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1937
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(xCF))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1942
fatherSonIndex=0
frm_calc=''S'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cConnes
obj='Var
pag=9
prev=O1947
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1942
fatherSonIndex=1
frm_calc='''
len=16
name='cConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cConnes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=9
prev=O1951
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1952
fatherSonIndex=0
frm_calc=''S'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cConnes
obj='Var
pag=9
prev=O1957
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1952
fatherSonIndex=1
frm_calc='cConnes
len=16
name='xConnes
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=9
prev=O1950
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xCF
]
rd_var=[
'cConnes
]
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=9
prev=O1935
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'cConnes
]
I
obj='Var
pag=9
prev=O1934
var_op='asgn
I
obj='Var
pag=9
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=9
prev=O1855
var_op='asgn
I
obj='Var
pag=9
prev=O1854
var_op='asgn
I
obj='Remark
pag=9
x=15
y=20
I
Icpitembatch.CPRemark
frm_calc='Importa i dati base dei rapporti
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='cNumTit + 1
len=10
name='cNumTit
next=Icpitembatch.CPIfElse
frm_calc=[
'w_tipodest = 'P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=11
prev=O1974
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1975
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGPTIT1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGPTIT2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTIT\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,199,25),Space(25))
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,224,1),Space(1))
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,248,1)='2','2',iif(Substr(riga,248,1)='0','S','A'))
len=1
name='streg
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,35,6)
len=6
name='xDIP
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xDIP)))
]
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='xapotit
h=[
19
19
]
obj='Insert
pag=11
prev=O1989
rd_kfield=[
'IDBASE
'NUMPROG
'DATAOPE
'TIPOINTER
'CODINTER
'TIPOINF
'IDEREG
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'OPRAP
'TIPOOPRAP
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'STATOREG
'OPERAZMOD
'DATARETT
'COLLEG
'PRGIMPTIT
'CDATOPE
'CDATREG
]
rd_kvar=[
'cInfProg1
'cInfProg2
'CharToDate(Substr(riga,79,8))
'Substr(riga,1,2)
'Substr(riga,3,11)
''1'
'Substr(riga,79,8) + cOpeProg2 + streg
'Substr(riga,35,6)
'Substr(riga,47,30)
'Substr(riga,77,2)
'Substr(riga,41,6)
'Substr(riga,87,1)
'Substr(riga,88,1)
'Substr(riga,89,4)
'Substr(riga,93,2)
'Substr(riga,95,2)
'Substr(riga,97,11)
'Substr(riga,108,3)
'Substr(riga,117,30)
'Substr(riga,147,2)
'Substr(riga,111,6)
'Substr(riga,149,50)
'xRapporto
'xTipRap
'Substr(riga,225,1)
'CharToDate(Substr(riga,226,8))
'Substr(riga,234,1)
'Substr(riga,234,2)
'Substr(riga,277,1)
'Substr(riga,278,3)
'Substr(riga,281,1)
'Val(Substr(riga,282,15))
'Val(Substr(riga,297,15))
'Substr(riga,248,1)
'Substr(riga,257,20)
'CharToDate(Substr(riga,249,8))
'Substr(riga,236,12)
'nProgImp
'Substr(riga,79,8)
'Substr(riga,226,8)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1992
fatherSonIndex=0
frm_calc='_gMsgProc +"Rilevati errori nel file "+w_nomefile+" per l'informazione in data "+Substr(riga,79,8)+" relativa al legame: "+xRapporto+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
len=10
name='_gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=11
prev=O1998
I
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='If
pag=11
prev=O1988
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anadip
father=O1989
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDIPx))
]
h=[
19
19
]
obj='If
pag=11
prev=O2003
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anadip
father=O2004
fatherSonIndex=0
obj='Insert
pag=11
rd_kfield=[
'CODDIP
'DESCRIZ
]
rd_kvar=[
'xDIP
'xDIP
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=11
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'xDIP
]
rd_var=[
'xDIPx
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=11
prev=O1987
var_op='asgn
I
obj='Var
pag=11
prev=O1986
var_op='asgn
I
obj='Var
pag=11
prev=O1985
var_op='asgn
I
obj='Var
pag=11
prev=O1984
var_op='asgn
I
obj='Var
pag=11
prev=O1983
var_op='asgn
I
obj='Var
pag=11
prev=O1982
var_op='asgn
I
obj='Var
obj_type='N
pag=11
prev=O1981
var_op='asgn
I
obj='Var
pag=11
prev=O1980
var_op='asgn
I
obj='Var
pag=11
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1975
fatherSonIndex=1
frm_calc='''
len=1
name='xTipoInf
next=Icpitembatch.CPExec
check='page
frm_calc='6
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf <> 'X'
]
h=[
19
19
]
obj='If
pag=11
prev=O2020
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2021
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PRGTITO1\'"+LRTrim(_gAzienda)+"'",'',10)
len=10
name='cInfProg1
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGTITO2\'"+LRTrim(_gAzienda)+"'",'',11)
len=11
name='cInfProg2
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PRGIMPTIT\'"+LRTrim(_gAzienda)+"'",0,15)
len=15
name='nProgImp
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,199,25),Space(25))
len=25
name='xRapporto
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,199,25) <> '00000000000000000000000000',Substr(riga,224,1),Space(1))
len=1
name='xTipRap
next=Icpitembatch.CPVarDecl
frm_calc='CharToDate(Substr(riga,79,8))
len=8
name='xDatOpe
next=Icpitembatch.CPVarDecl
frm_calc='iif(Substr(riga,248,1)='2','2',iif(Substr(riga,248,1)='0','S','A'))
len=1
name='streg
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='cIdCau
next=Icpitembatch.CPVarDecl
frm_calc='''
len=6
name='xDIPx
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,35,6)
len=6
name='xDIP
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xDIP)))
]
h=[
19
19
]
next=Icpitembatch.CPInsert
arch='rapotit
h=[
19
19
]
obj='Insert
pag=11
prev=O2036
rd_kfield=[
'IDBASE
'NUMPROG
'DATAOPE
'TIPOINTER
'CODINTER
'TIPOINF
'IDEREG
'CODDIPE
'DESCCIT
'PROVINCIA
'CODCAB
'FLAGFRAZ
'FLAGCONT
'CODANA
'CODVOC
'TIPOINT2
'CODINT2
'PAESE
'DESC2
'PROV2
'CODCAB2
'DESCINTER
'RAPPORTO
'FLAGRAP
'TIPOLEG
'DATAREG
'OPRAP
'TIPOOPRAP
'FLAGLIRE
'VALUTA
'SEGNO
'TOTLIRE
'TOTCONT
'STATOREG
'OPERAZMOD
'DATARETT
'COLLEG
'PRGIMPTIT
'CDATOPE
'CDATREG
]
rd_kvar=[
'cInfProg1
'cInfProg2
'CharToDate(Substr(riga,79,8))
'Substr(riga,1,2)
'Substr(riga,3,11)
''1'
'Substr(riga,79,8) + cOpeProg2 + streg
'Substr(riga,35,6)
'Substr(riga,47,30)
'Substr(riga,77,2)
'Substr(riga,41,6)
'Substr(riga,87,1)
'Substr(riga,88,1)
'Substr(riga,89,4)
'Substr(riga,93,2)
'Substr(riga,95,2)
'Substr(riga,97,11)
'Substr(riga,108,3)
'Substr(riga,117,30)
'Substr(riga,147,2)
'Substr(riga,111,6)
'Substr(riga,149,50)
'xRapporto
'xTipRap
'Substr(riga,225,1)
'CharToDate(Substr(riga,226,8))
'Substr(riga,234,1)
'Substr(riga,234,2)
'Substr(riga,277,1)
'Substr(riga,278,3)
'Substr(riga,281,1)
'Val(Substr(riga,282,15))
'Val(Substr(riga,297,15))
'Substr(riga,248,1)
'Substr(riga,257,20)
'CharToDate(Substr(riga,248,8))
'Substr(riga,236,12)
'nProgImp
'Substr(riga,79,8)
'Substr(riga,226,8)
]
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2039
fatherSonIndex=0
frm_calc='_gMsgProc +"Rilevati errori nel file "+w_nomefile+" per l'informazione in data "+Substr(riga,79,8)+" relativa al legame: "+xRapporto+" Ricreare il file e rieseguire l'import dei dati. L'attuale procedura di importazione verrà annulata automaticamente."+ NL
len=10
name='_gMsgProc
next=Icpitembatch.CPExec
check='man
frm_calc='// Azzera messaggio errore﷯m_cLastMsgError = "";
obj='Exec
pag=11
prev=O2045
I
obj='Var
obj_type='M
pag=11
var_op='asgn
I
I
]
test_zero_rows=True
w=[
150
150
]
I
obj='If
pag=11
prev=O2035
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRead
arch='anadip
father=O2036
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xDIPx))
]
h=[
19
19
]
obj='If
pag=11
prev=O2050
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='anadip
father=O2051
fatherSonIndex=0
obj='Insert
pag=11
rd_kfield=[
'CODDIP
'DESCRIZ
]
rd_kvar=[
'xDIP
'xDIP
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=11
rd_field=[
'CODDIP
]
rd_kfield=[
'CODDIP
]
rd_kvar=[
'xDIP
]
rd_var=[
'xDIPx
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=11
prev=O2034
var_op='asgn
I
obj='Var
pag=11
prev=O2033
var_op='asgn
I
obj='Var
pag=11
prev=O2032
var_op='asgn
I
obj='Var
pag=11
prev=O2031
var_op='asgn
I
obj='Var
obj_type='D
pag=11
prev=O2030
var_op='asgn
I
obj='Var
pag=11
prev=O2029
var_op='asgn
I
obj='Var
pag=11
prev=O2028
var_op='asgn
I
obj='Var
obj_type='N
pag=11
prev=O2027
var_op='asgn
I
obj='Var
pag=11
prev=O2026
var_op='asgn
I
obj='Var
pag=11
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Exec
pag=11
prev=O2019
I
obj='Var
pag=11
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=11
prev=O1973
var_op='asgn
I
obj='Remark
pag=11
x=16
y=17
I
Icpitembatch.CPRemark
frm_calc='Importa i soggetti dei rapporti
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf = 'A' or xTipoInf = 'C'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='P'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'xTipoInf='D'
]
h=[
19
19
]
obj='If
pag=12
prev=O2071
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
father=O2074
fatherSonIndex=0
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,346,1)='M'
'Substr(riga,346,1)='F'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,226,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(xCF,12,1) = 'Z' and Len(LRTrim(xCF))=16
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgrae = 'R'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,291,2)
len=2
name='xTD
next=Icpitembatch.CPIfElse
frm_calc=[
'xTD <> '01' and xTD <> '02' and xTD <> '03' and xTD <> '04' and xTD <> '05' and xTD <> '06'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Len(LRTrim(xCF))=16,'P','G')
len=1
name='cTipPer
next=Icpitembatch.CPWrite
arch='personbo
obj='Write
pag=12
prev=O2095
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'cConnes
]
wr_field=[
'CODFISC
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'AUTRILASC
'DATARILASC
'SESSO
'NASSTATO
'TIPOPERS
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xCF
'Substr(riga,51,70)
'Substr(riga,124,6)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'CharToDate(Substr(riga,218,8))
'cCNAS
'Substr(riga,256,3)
'xRam
'Substr(riga,262,3)
'xTD
'Substr(riga,293,15)
'Substr(riga,316,30)
'CharToDate(Substr(riga,308,8))
'xSesso
'cSNAS
'cTipPer
]
I
obj='Var
pag=12
prev=O2092
var_op='asgn
I
obj='If
pag=12
prev=O2091
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2092
fatherSonIndex=0
frm_calc='''
len=2
name='xTD
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=12
prev=O2088
var_op='asgn
I
obj='If
pag=12
prev=O2085
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2088
fatherSonIndex=0
frm_calc='iif(Substr(riga,259,3)='000','',Substr(riga,259,3))
len=3
name='xRam
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2088
fatherSonIndex=1
frm_calc='''
len=3
name='xRam
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=12
prev=O2084
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2085
fatherSonIndex=0
frm_calc='Substr(riga,226,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=12
prev=O2115
var_op='asgn
I
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=12
prev=O2083
var_op='asgn
I
obj='Var
pag=12
prev=O2080
var_op='asgn
I
obj='Case
pag=12
prev=O2079
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2080
fatherSonIndex=0
frm_calc=''1'
len=1
name='xSesso
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2080
fatherSonIndex=1
frm_calc=''2'
len=1
name='xSesso
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2080
fatherSonIndex=2
frm_calc='Substr(riga,346,1)
len=1
name='xSesso
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=12
prev=O2068
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPRemark
father=O2071
fatherSonIndex=0
frm_calc='Calcola il progressivo di registrazione
next=Icpitembatch.CPVarDecl
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(_gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=12
prev=O2130
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES = cConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O2131
fatherSonIndex=0
obj='Insert
pag=12
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'datamodi
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
]
rd_kvar=[
'cProgSto
'personbo->CONNES
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'Date()
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=12
prev=O2129
var_op='asgn
I
obj='Remark
pag=12
I
I
]
w=[
150
150
]
I
obj='If
pag=12
prev=O2067
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2068
fatherSonIndex=0
frm_calc='Substr(riga,35,16)
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,202,16)
len=16
name='xCF
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(xCF)) and Empty(LRTrim(xConnes))
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,51,70)
len=70
name='cRagSoc
next=Icpitembatch.CPIfElse
frm_calc=[
'xNewSog = 'S'
]
h=[
19
19
]
next=Icpitembatch.CPCase
frm_calc=[
'xTipo='2' or xTipo='3'
'xTipo='6'
]
h=[
19
19
19
]
obj='Case
pag=12
prev=O2148
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2151
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xapotit
father=O2156
fatherSonIndex=0
obj='Write
pag=12
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cInfProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='rapotit
father=O2156
fatherSonIndex=1
obj='Write
pag=12
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cInfProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2151
fatherSonIndex=1
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xapotit
father=O2178
fatherSonIndex=0
obj='Write
pag=12
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cInfProg1
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='rapotit
father=O2178
fatherSonIndex=1
obj='Write
pag=12
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cInfProg1
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
obj='If
pag=12
prev=O2147
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
father=O2148
fatherSonIndex=0
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPCase
frm_calc=[
'Substr(riga,346,1)='M'
'Substr(riga,346,1)='F'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,226,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(xCF,12,1) = 'Z' and Len(LRTrim(xCF))=16
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgrae = 'R'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,291,2)
len=2
name='xTD
next=Icpitembatch.CPIfElse
frm_calc=[
'xTD <> '01' and xTD <> '02' and xTD <> '03' and xTD <> '04' and xTD <> '05' and xTD <> '06'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Len(LRTrim(xCF))=16,'P','G')
len=1
name='cTipPer
next=Icpitembatch.CPInsert
arch='personbo
obj='Insert
pag=12
prev=O2218
rd_kfield=[
'CONNES
'CODFISC
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'AUTRILASC
'DATARILASC
'SESSO
'NASSTATO
'TIPOPERS
]
rd_kvar=[
'xConnes
'xCF
'Substr(riga,51,70)
'Substr(riga,124,6)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'CharToDate(Substr(riga,218,8))
'cCNAS
'Substr(riga,256,3)
'xRam
'Substr(riga,262,3)
'xTD
'Substr(riga,293,15)
'Substr(riga,316,30)
'CharToDate(Substr(riga,308,8))
'xSesso
'cSNAS
'cTipPer
]
I
obj='Var
pag=12
prev=O2215
var_op='asgn
I
obj='If
pag=12
prev=O2214
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2215
fatherSonIndex=0
frm_calc='''
len=2
name='xTD
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=12
prev=O2211
var_op='asgn
I
obj='If
pag=12
prev=O2208
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2211
fatherSonIndex=0
frm_calc='iif(Substr(riga,259,3)='000','',Substr(riga,259,3))
len=3
name='xRam
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2211
fatherSonIndex=1
frm_calc='''
len=3
name='xRam
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=12
prev=O2207
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2208
fatherSonIndex=0
frm_calc='Substr(riga,226,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=12
prev=O2234
var_op='asgn
I
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=12
prev=O2206
var_op='asgn
I
obj='Var
pag=12
prev=O2203
var_op='asgn
I
obj='Case
pag=12
prev=O2202
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2203
fatherSonIndex=0
frm_calc=''1'
len=1
name='xSesso
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2203
fatherSonIndex=1
frm_calc=''2'
len=1
name='xSesso
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2203
fatherSonIndex=2
frm_calc='Substr(riga,346,1)
len=1
name='xSesso
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
obj='Var
obj_type='N
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=12
prev=O2144
var_op='asgn
I
obj='If
pag=12
prev=O2143
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2144
fatherSonIndex=0
frm_calc=''S'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='LibreriaMit.UniqueId()
len=16
name='xConnes
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cConnes
obj='Var
pag=12
prev=O2249
var_op='asgn
I
obj='Var
pag=12
prev=O2248
var_op='asgn
I
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2144
fatherSonIndex=1
frm_calc=''N'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='cConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cConnes))
]
h=[
19
19
]
obj='If
pag=12
prev=O2254
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2255
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(xCF))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2260
fatherSonIndex=0
frm_calc=''S'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cConnes
obj='Var
pag=12
prev=O2265
var_op='asgn
I
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2260
fatherSonIndex=1
frm_calc='''
len=16
name='cConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cConnes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=12
prev=O2269
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2270
fatherSonIndex=0
frm_calc=''S'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cConnes
obj='Var
pag=12
prev=O2275
var_op='asgn
I
obj='Var
pag=12
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2270
fatherSonIndex=1
frm_calc='cConnes
len=16
name='xConnes
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=12
prev=O2268
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xCF
]
rd_var=[
'cConnes
]
I
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=12
prev=O2253
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'cConnes
]
I
obj='Var
pag=12
prev=O2252
var_op='asgn
I
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
pag=12
prev=O2142
var_op='asgn
I
obj='Var
pag=12
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Remark
pag=12
x=17
y=19
I
Icpitembatch.CPVarDecl
frm_calc='_gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' + LRTrim(w_nomefile) + NL
len=10
name='_gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(w_nomefile)
len=200
name='cpercorsozip
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(_pathfile)+"/"
len=200
name='cdirectoryfile
next=Icpitembatch.CPExec
check='man
frm_calc='try {﷯      // Apro il file zip﷯      java.util.zip.ZipFile zf = new java.util.zip.ZipFile(cpercorsozip);﷯﷯      //Conto il numero di file all interno del file zip e creo un array di stringhe per memorizzare i nomi file﷯      conteggio=zf.size();﷯      lista=new String[conteggio];﷯      ﷯      // Enumerate each entry﷯      i=0;﷯      for (java.util.Enumeration entries = zf.entries(); entries.hasMoreElements();) {﷯          // Get the entry name﷯          lista[i] = ((java.util.zip.ZipEntry)entries.nextElement()).getName();﷯          i++;﷯      }﷯     zf.close();﷯     } catch (java.io.IOException e) {﷯     }﷯try {﷯      // Apro il file zip﷯      java.util.zip.ZipFile zf = new java.util.zip.ZipFile(cpercorsozip);﷯﷯      byte[] buffer = new byte[1024]; ﷯      java.util.Enumeration entries = zf.entries();﷯      while(entries.hasMoreElements() ) {﷯        java.util.zip.ZipEntry entry = (java.util.zip.ZipEntry)entries.nextElement();﷯        java.io.InputStream in =zf.getInputStream(entry);﷯        java.io.OutputStream out = new java.io.BufferedOutputStream(new java.io.FileOutputStream(cdirectoryfile+entry.getName()));﷯﷯        int len;﷯﷯        while((len = in.read(buffer)) >= 0){﷯          out.write(buffer, 0, len);﷯        }﷯﷯          in.close();﷯          out.close();﷯      }﷯﷯      zf.close();﷯} catch (java.io.IOException ioe) {﷯      System.err.println("Unhandled exception:");﷯      ioe.printStackTrace();﷯      return;﷯}
next=Icpitembatch.CPVarDecl
frm_calc='LRTrim(_pathfile)+"/"+LRTrim(lista[0])
len=128
name='fileelab
next=Icpitembatch.CPExec
frm_calc='FileLibMit.DeleteFilePath(LRTrim(w_nomefile))
next=Icpitembatch.CPVarDecl
frm_calc='_gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file ' +LRTrim(w_nomefile) + NL
len=10
name='_gMsgProc
obj='Var
obj_type='M
pag=13
prev=O2297
var_op='asgn
I
obj='Exec
pag=13
prev=O2296
I
obj='Var
pag=13
prev=O2295
var_op='asgn
I
obj='Exec
pag=13
prev=O2294
I
obj='Var
pag=13
prev=O2293
var_op='asgn
I
obj='Var
pag=13
prev=O2292
var_op='asgn
I
obj='Var
obj_type='M
pag=13
var_op='asgn
x=14
y=14
I
Icpitembatch.CPRemark
frm_calc='Importa i soggetti delle operazioni
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,35,16)
len=16
name='xConnes
next=Icpitembatch.CPIfElse
frm_calc=[
'not(Empty(LRTrim(xConnes)))
]
h=[
19
19
]
next=Icpitembatch.CPCase
frm_calc=[
'xTipo='2' or xTipo='3' or xTipo='7'
'xTipo='4' or xTipo='8'
'xTipo='5'
'xTipo='6' or xTipo='9'
]
h=[
19
19
19
19
19
]
obj='Case
pag=14
prev=O2301
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2304
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O2309
fatherSonIndex=0
obj='Write
pag=14
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O2309
fatherSonIndex=1
obj='Write
pag=14
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESCLI
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2304
fatherSonIndex=1
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O2331
fatherSonIndex=0
obj='Write
pag=14
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O2331
fatherSonIndex=1
obj='Write
pag=14
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESOPER
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2304
fatherSonIndex=2
frm_calc=[
'Empty(LRTrim(xConnes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2353
fatherSonIndex=0
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O2358
fatherSonIndex=0
obj='Write
pag=14
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,51,70)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,124,6)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O2358
fatherSonIndex=1
obj='Write
pag=14
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,51,70)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,124,6)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2353
fatherSonIndex=1
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O2380
fatherSonIndex=0
obj='Write
pag=14
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESBEN
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xConnes
'Substr(riga,51,70)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,124,6)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O2380
fatherSonIndex=1
obj='Write
pag=14
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNESBEN
'C_RAG
'C_STA
'C_CTA
'C_CAB
'C_PRV
'C_IND
'C_CAP
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xConnes
'Substr(riga,51,70)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,124,6)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2304
fatherSonIndex=3
frm_calc=[
'w_tipodest='P'
'w_tipodest='D'
]
h=[
19
19
19
]
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='xperazbo
father=O2403
fatherSonIndex=0
obj='Write
pag=14
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNALTRO
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='operazbo
father=O2403
fatherSonIndex=1
obj='Write
pag=14
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'cOpeProg1
]
wr_field=[
'CONNALTRO
]
wr_op=[
'=
]
wr_var=[
'xConnes
]
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
150
150
150
]
I
obj='If
pag=14
prev=O2300
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O2301
fatherSonIndex=0
frm_calc=''N'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='''
len=16
name='cConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cConnes))
]
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Calcola valori da salvare
h=[
19
19
]
next=Icpitembatch.CPVarDecl
comment='Contatore Soggetti
frm_calc='cNumPer + 1
len=10
name='cNumPer
next=Icpitembatch.CPIfElse
frm_calc=[
'xNewSog = 'S'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
prev=O2435
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='personbo
father=O2436
fatherSonIndex=0
obj='Insert
pag=14
rd_kfield=[
'CONNES
'CODFISC
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'AUTRILASC
'DATARILASC
'SESSO
'NASSTATO
'TIPOPERS
]
rd_kvar=[
'xConnes
'xCF
'Substr(riga,51,70)
'Substr(riga,124,6)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'CharToDate(Substr(riga,218,8))
'cCNAS
'Substr(riga,256,3)
'xRam
'Substr(riga,262,3)
'xTD
'Substr(riga,293,15)
'Substr(riga,316,30)
'CharToDate(Substr(riga,308,8))
'xSesso
'cSNAS
'cTipPer
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2436
fatherSonIndex=1
frm_calc='''
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cProgSto))
]
h=[
19
19
]
next=Icpitembatch.CPWrite
arch='personbo
obj='Write
pag=14
prev=O2448
rd_kfield=[
'CONNES
]
rd_kop=[
'=
]
rd_kvar=[
'xConnes
]
wr_field=[
'CODFISC
'RAGSOC
'CODCAB
'PAESE
'DESCCIT
'PROVINCIA
'DOMICILIO
'CAP
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'AUTRILASC
'DATARILASC
'SESSO
'NASSTATO
'TIPOPERS
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'xCF
'Substr(riga,51,70)
'Substr(riga,124,6)
'Substr(riga,121,3)
'Substr(riga,130,30)
'Substr(riga,160,2)
'Substr(riga,162,35)
'Substr(riga,197,5)
'CharToDate(Substr(riga,218,8))
'cCNAS
'Substr(riga,256,3)
'xRam
'Substr(riga,262,3)
'xTD
'Substr(riga,293,15)
'Substr(riga,316,30)
'CharToDate(Substr(riga,308,8))
'xSesso
'cSNAS
'cTipPer
]
I
obj='If
pag=14
prev=O2446
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2448
fatherSonIndex=0
frm_calc='Utilities.GetAutonumber("PSTOPERS\'"+LRTrim(_gAzienda)+"'","",15)
len=15
name='cProgSto
next=Icpitembatch.CPSelect
h=[
19
19
]
obj='Select
pag=14
prev=O2460
sel_field='*
sel_name='personbo
sel_where='personbo->CONNES = xConnes
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='wersonbo
father=O2461
fatherSonIndex=0
obj='Insert
pag=14
rd_kfield=[
'sanumpro
'CONNES
'CODCAB
'RAGSOC
'DOMICILIO
'CODFISC
'DATANASC
'NASCOMUN
'SOTGRUP
'RAMOGRUP
'SETTSINT
'TIPODOC
'NUMDOCUM
'DATARILASC
'AUTRILASC
'DESCCIT
'PROVINCIA
'PAESE
'CAP
'CODINTER
'TIPINTER
'TIPOPERS
'CODDIPE
'PARTIVA
'NOTE
'SESSO
'SOSPMAF
'idcitta
'datamodi
'DATAVALI
'NASSTATO
'DOCFILE
'NOME
'COGNOME
'CFESTERO
'OLDCONNES
'DATEXTRA
'PKTBSPECIE
'COMPORT
'ATTIV
'RNATGIU
'RATTIV
'RCOMP
'RAREA
'ALLINEATO
'ALLINEATONOMECNOME
'RAGSOCOLD
'PROGIMPORT
'PROGIMP_C
'AREAGEO
'PEP
'IDFILE
'OLDCODFISC
'MACROAGENTE
'SPOTID
'DATASEGN
'OLDSETSIN
'DATAVARAGE
'SETTSINT2
'FATCA
'BANCABEN
'TIN
'ODB
'TELEF
'TIPOORO
'CODORO
'IDNASCOMUN
'IDNASSTATO
'NOTIT
]
rd_kvar=[
'cProgSto
'xConnes
'personbo->CODCAB
'personbo->RAGSOC
'personbo->DOMICILIO
'personbo->CODFISC
'personbo->DATANASC
'personbo->NASCOMUN
'personbo->SOTGRUP
'personbo->RAMOGRUP
'personbo->SETTSINT
'personbo->TIPODOC
'personbo->NUMDOCUM
'personbo->DATARILASC
'personbo->AUTRILASC
'personbo->DESCCIT
'personbo->PROVINCIA
'personbo->PAESE
'personbo->CAP
'personbo->CODINTER
'personbo->TIPINTER
'personbo->TIPOPERS
'personbo->CODDIPE
'personbo->PARTIVA
'personbo->NOTE
'personbo->SESSO
'personbo->SOSPMAF
'personbo->idcitta
'Date()
'personbo->DATAVALI
'personbo->NASSTATO
'personbo->DOCFILE
'personbo->NOME
'personbo->COGNOME
'personbo->CFESTERO
'personbo->OLDCONNES
'personbo->DATEXTRA
'personbo->PKTBSPECIE
'personbo->COMPORT
'personbo->ATTIV
'personbo->RNATGIU
'personbo->RATTIV
'personbo->RCOMP
'personbo->RAREA
'personbo->ALLINEATO
'personbo->ALLINEATONOMECNOME
'personbo->RAGSOCOLD
'personbo->PROGIMPORT
'personbo->PROGIMP_C
'personbo->AREAGEO
'personbo->PEP
'personbo->IDFILE
'personbo->OLDCODFISC
'personbo->MACROAGENTE
'personbo->SPOTID
'personbo->DATASEGN
'personbo->OLDSETSIN
'personbo->DATAVARAGE
'personbo->SETTSINT2
'personbo->FATCA
'personbo->BANCABEN
'personbo->TIN
'personbo->ODB
'personbo->TELEF
'personbo->TIPOORO
'personbo->CODORO
'personbo->IDNASCOMUN
'personbo->IDNASSTATO
'personbo->NOTIT
]
I
I
]
w=[
150
150
]
I
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=14
prev=O2445
sel_field='wersonbo->sanumpro
sel_name='wersonbo
sel_where='wersonbo->CONNES=xConnes and wersonbo->datamodi=Date()
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2446
fatherSonIndex=0
frm_calc='wersonbo->sanumpro
len=15
name='cProgSto
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Var
obj_type='N
pag=14
prev=O2433
var_op='asgn
I
obj='Begin
pag=14
prev=O2430
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPCase
father=O2433
fatherSonIndex=0
frm_calc=[
'Substr(riga,346,1)='M'
'Substr(riga,346,1)='F'
]
h=[
19
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,226,30)
len=30
name='cCNAS
next=Icpitembatch.CPIfElse
frm_calc=[
'Substr(xCF,12,1) = 'Z' and Len(LRTrim(xCF))=16
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'w_flgrae = 'R'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,291,2)
len=2
name='xTD
next=Icpitembatch.CPIfElse
frm_calc=[
'xTD <> '01' and xTD <> '02' and xTD <> '03' and xTD <> '04' and xTD <> '05' and xTD <> '06'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='iif(Len(LRTrim(xCF))=16,'P','G')
len=1
name='cTipPer
obj='Var
pag=14
prev=O2489
var_op='asgn
I
obj='If
pag=14
prev=O2488
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2489
fatherSonIndex=0
frm_calc='''
len=2
name='xTD
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=14
prev=O2485
var_op='asgn
I
obj='If
pag=14
prev=O2482
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2485
fatherSonIndex=0
frm_calc='iif(Substr(riga,259,3)='000','',Substr(riga,259,3))
len=3
name='xRam
obj='Var
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2485
fatherSonIndex=1
frm_calc='''
len=3
name='xRam
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='If
pag=14
prev=O2481
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2482
fatherSonIndex=0
frm_calc='Substr(riga,226,30)
len=30
name='cSNAS
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='cCNAS
obj='Var
pag=14
prev=O2505
var_op='asgn
I
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=14
prev=O2480
var_op='asgn
I
obj='Var
pag=14
prev=O2477
var_op='asgn
I
obj='Case
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2477
fatherSonIndex=0
frm_calc=''1'
len=1
name='xSesso
obj='Var
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2477
fatherSonIndex=1
frm_calc=''2'
len=1
name='xSesso
obj='Var
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2477
fatherSonIndex=2
frm_calc='Substr(riga,346,1)
len=1
name='xSesso
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='If
pag=14
prev=O2429
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O2430
fatherSonIndex=0
frm_calc=[
'Empty(LRTrim(xCF))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2519
fatherSonIndex=0
frm_calc=''S'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cConnes
obj='Var
pag=14
prev=O2524
var_op='asgn
I
obj='Var
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2519
fatherSonIndex=1
frm_calc='''
len=16
name='cConnes
next=Icpitembatch.CPRead
arch='personbo
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(cConnes))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=14
prev=O2528
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2529
fatherSonIndex=0
frm_calc=''S'
len=1
name='xNewSog
next=Icpitembatch.CPVarDecl
frm_calc='xConnes
len=16
name='cConnes
obj='Var
pag=14
prev=O2534
var_op='asgn
I
obj='Var
pag=14
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2529
fatherSonIndex=1
frm_calc='cConnes
len=16
name='xConnes
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=14
prev=O2527
rd_field=[
'CONNES
]
rd_kfield=[
'CODFISC
]
rd_kvar=[
'xCF
]
rd_var=[
'cConnes
]
I
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
obj='Read
pag=14
prev=O2428
rd_field=[
'CONNES
]
rd_kfield=[
'CONNES
]
rd_kvar=[
'xConnes
]
rd_var=[
'cConnes
]
I
obj='Var
pag=14
prev=O2427
var_op='asgn
I
obj='Var
pag=14
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=14
prev=O2299
var_op='asgn
I
obj='Remark
pag=14
x=12
y=20
I
]
ManualBlocks={
'BO - Header
Icpmanualblocks.CPManualBlocks
code='import java.io.*;
name='BO - Header
I
'BO - Properties
Icpmanualblocks.CPManualBlocks
code='public String[] lista;﷯public int conteggio;﷯public int i;﷯public int contanome;
name='BO - Properties
I
}
comment='Import Scarico OffLINE (Scheduler)
date_creat=#2006-06-20
date_rev=#2019-05-21
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'Utilities
'LibreriaMit
'FileLibMit
]
modcnt=598
page_result_class=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
page_result_type=[
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
'U
]
page_uid=[
'DGHXGDVUYP
'EZDCMJCTUI
'YKUKDBCDRH
'SAPCTHNUVI
'ZBOQDBKIYI
'QHUQJYTCQM
'TWJXWEWESK
'JXUBOCMZBX
'PDNNFPHWYY
'AIGWQRAJLC
'SLTRPRQLHW
'RTKEJQSEGV
'HWRCOQMWLU
'JUKVVRHWNU
]
pagename=[
'Page_1
'Page_2
'Page_3
'Page_4
'Page_5
'Page_6
'Page_7
'Page_8
'Page_9
'Page_10
'Page_11
'Page_12
'Page_13
'Page_14
]
pagenote=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
pagetitle=[
'Main
'Operazioni (Dati Base)
'Rapporti (Dati Base)
'Operazioni (Soggetti)
'Rapporti (Soggetti)
'Controllo Se Apertura o Chiusura
'Operazioni (dati Base) su appoggio
'Rapporti (Dati Base) su Appoggio
'Operazioni (Soggetti) su appoggio
'Rapporti (Soggetti) su appoggio
'Titolari (Dati Base)
'Titolari (Soggetti)
'Estrai Zip
'Controparti
]
public=True
runtime_filters=2
tpl_name='Routine
work_file=[
'anadip
'anarapbo
'intestbo
'operazbo
'personbo
'rapopebo
'tbcauana
'tbcitta
'tbvalute
'xapopebo
'xnarapbo
'xntestbo
'xperazbo
'knarapbo
'tmp_operazbo_ol
'tmp_rapopebo_ol
'tmp_anarapbo
'tmp_intestbo_ol
'delegabo
'xelegabo
'cpwarn
'wersonbo
'xapotit
'rapotit
'intestit
'cpazi
'intermbo
'xperazbo_agg
]
work_filter=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
I
*--*
*----*
