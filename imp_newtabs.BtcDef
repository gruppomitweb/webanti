* --- CodePainter Revolution Batch Vers. 5.1
￼Icpbatch.CPBatch
Items=[
Icpitembatch.CPBeginEnd
comment='Dichiarazione variabili del caller
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Definizione variabili locali
h=[
19
19
]
next=Icpitembatch.CPRemark
frm_calc='Dichiarazione variabili globali
next=Icpitembatch.CPVarDecl
comment='Messaggio Import
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPRemark
frm_calc='Lettura Tabelle
next=Icpitembatch.CPTransaction
next=Icpitembatch.CPTry
h=[
19
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'pTipo='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O12
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O14
fatherSonIndex=0
frm_calc=''ELABORAZIONE TERMINATA'
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMessage
father=O14
fatherSonIndex=1
frm_calc=''Import Tabelle di base terminato'
msg_type='Info
obj='Message
pag=1
I
I
]
w=[
150
150
150
]
I
obj='Try
pag=1
prev=O11
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPBeginEnd
comment='Aggiorna TBTIPDOC
father=O12
fatherSonIndex=0
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBTIPLEG
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBSTGRU
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBRAMGRU
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBSETSIN
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBTIPINT
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBTIPREG
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBVALUTE
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBCAUANA + TBCAUSIN
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBSTATI
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBCITTA
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBESITOAE
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBRAPP
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBTIPNAT
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBERRORISID
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBERRSIDDGN
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBRICEVUTESID
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBERRDGE
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBSTATNA
h=[
19
19
]
next=Icpitembatch.CPExec
check='page
frm_calc='2
next=Icpitembatch.CPTransaction
frm_calc='commit
next=Icpitembatch.CPIfElse
frm_calc=[
'pTipo='B'
]
h=[
19
19
]
obj='If
pag=1
prev=O64
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPExec
father=O65
fatherSonIndex=0
frm_calc='FileLibMit.DeleteFile('aggtabs.lst')
obj='Exec
pag=1
I
I
]
w=[
150
150
]
I
obj='Transaction
pag=1
prev=O63
I
obj='Exec
pag=1
prev=O61
I
obj='Begin
pag=1
prev=O59
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O61
fatherSonIndex=0
frm_calc=[
'w_tbstatna='S'
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O74
fatherSonIndex=0
next=Icpitembatch.CPTry
h=[
19
19
19
]
obj='Try
pag=1
prev=O79
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O80
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbstatna.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/tbstatna.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbstatna.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=1
prev=O89
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O88
var_op='asgn
I
obj='Exec
pag=1
prev=O86
I
obj='While
pag=1
prev=O85
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O86
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O93
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O94
fatherSonIndex=0
frm_calc=''TBSTATNA - Inserimento codice '+ Left(riga,4)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_code10
next=Icpitembatch.CPRead
arch='tbstatna
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code10)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O101
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbstatna
father=O102
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'SIGLA
'ISO
'ISO2
'INIZIO
'FINE
'SIGLANEW
'VARIATO
'DESCRI
'IDBASE
'IDTBLS
'CODSTA
]
rd_kvar=[
'Left(riga,4)
'Substr(riga,5,3)
'Substr(riga,8,2)
'CharToDate(Substr(riga,10,8))
'CharToDate(Substr(riga,18,8))
'Substr(riga,26,4)
'CharToDate(Substr(riga,30,8))
'Substr(riga,38,50)
'Substr(riga,88,10)
'Substr(riga,98,1)
'Substr(riga,99,3)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbstatna
father=O102
fatherSonIndex=1
obj='Write
pag=1
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'Substr(riga,88,10)
]
wr_field=[
'DESCRI
'SIGLA
'ISO
'ISO2
'INIZIO
'FINE
'SIGLANEW
'VARIATO
'IDTBLS
'CODSTA
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,38,50)
'Left(riga,4)
'Substr(riga,5,3)
'Substr(riga,8,2)
'CharToDate(Substr(riga,10,8))
'CharToDate(Substr(riga,18,8))
'Substr(riga,26,4)
'CharToDate(Substr(riga,30,8))
'Substr(riga,98,1)
'Substr(riga,99,3)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
prev=O100
rd_field=[
'IDBASE
]
rd_kfield=[
'IDBASE
]
rd_kvar=[
'Substr(riga,88,10)
]
rd_var=[
'_code10
]
I
obj='Var
pag=1
prev=O99
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O84
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O80
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=1
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=1
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O57
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O59
fatherSonIndex=0
frm_calc=[
'w_tberrdge='S'
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O132
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tberrdge.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/tberrdge.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tberrdge.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O141
var_op='asgn
I
obj='Exec
pag=1
prev=O139
I
obj='While
pag=1
prev=O138
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O139
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O145
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O146
fatherSonIndex=0
frm_calc=''TBERRDGE - Inserimento codice '+ Substr(riga,1,3)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_code3
next=Icpitembatch.CPRead
arch='tberrdge
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code3)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O153
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tberrdge
father=O154
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'DGECODICE
'DGEDESCRI
'DGEAZIONE
'DGECONSEG
]
rd_kvar=[
'Left(riga,3)
'Substr(riga,4,118)
'Substr(riga,122,52)
'Substr(riga,174,100)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tberrdge
father=O154
fatherSonIndex=1
obj='Write
pag=1
rd_kfield=[
'DGECODICE
]
rd_kop=[
'=
]
rd_kvar=[
'Left(riga,3)
]
wr_field=[
'DGEDESCRI
'DGEAZIONE
'DGECONSEG
]
wr_op=[
'=
'=
'=
]
wr_var=[
'Substr(riga,4,118)
'Substr(riga,122,52)
'Substr(riga,174,100)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
prev=O152
rd_field=[
'DGECODICE
]
rd_kfield=[
'DGECODICE
]
rd_kvar=[
'Substr(riga,1,3)
]
rd_var=[
'_code3
]
I
obj='Var
pag=1
prev=O151
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O137
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O55
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O57
fatherSonIndex=0
frm_calc=[
'w_tbricevutesid='S'
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPDelete
arch='tbricevutesid
father=O181
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbricevutesid.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/tbricevutesid.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbricevutesid.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O191
var_op='asgn
I
obj='Exec
pag=1
prev=O189
I
obj='While
pag=1
prev=O188
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O189
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O195
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O196
fatherSonIndex=0
frm_calc=''TBRICEVUTE - Inserimento codice '+ Substr(riga,2,3)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_code3
next=Icpitembatch.CPRead
arch='tbricevutesid
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code3)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O203
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbricevutesid
father=O204
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'ESITIPO
'ESICODICE
'ESIDESCRI
]
rd_kvar=[
'Left(riga,1)
'Substr(riga,2,3)
'Substr(riga,5,128)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbricevutesid
father=O204
fatherSonIndex=1
obj='Write
pag=1
rd_kfield=[
'ESICODICE
]
rd_kop=[
'=
]
rd_kvar=[
'Substr(riga,2,3)
]
wr_field=[
'ESIDESCRI
'ESITIPO
]
wr_op=[
'=
'=
]
wr_var=[
'Substr(riga,5,128)
'Left(riga,1)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
prev=O202
rd_field=[
'ESICODICE
]
rd_kfield=[
'ESICODICE
]
rd_kvar=[
'Substr(riga,2,3)
]
rd_var=[
'_code3
]
I
obj='Var
pag=1
prev=O201
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O187
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O186
var_op='asgn
I
obj='Delete
pag=1
sel_type='all
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O53
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O55
fatherSonIndex=0
frm_calc=[
'w_tberrsiddgn='S'
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='tberrsiddgn
father=O231
fatherSonIndex=0
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tberrsiddgn.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/tberrsiddgn.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tberrsiddgn.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O241
var_op='asgn
I
obj='Exec
pag=1
prev=O239
I
obj='While
pag=1
prev=O238
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O239
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O245
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O246
fatherSonIndex=0
frm_calc=''TBERRSIDDGN - Inserimento codice '+ Left(riga,1)+Substr(riga,17,3)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_code3
next=Icpitembatch.CPRead
arch='tberrsiddgn
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code3)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O253
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tberrsiddgn
father=O254
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'DGNTIPO
'DGNTIPOERR
'DGNCODICE
'DGNDESCRI
]
rd_kvar=[
'Left(riga,1)
'Substr(riga,2,15)
'Substr(riga,17,3)
'Substr(riga,20,100)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tberrsiddgn
father=O254
fatherSonIndex=1
obj='Write
pag=1
rd_kfield=[
'DGNTIPO
'DGNCODICE
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,1)
'Substr(riga,17,3)
]
wr_field=[
'DGNTIPOERR
'DGNDESCRI
]
wr_op=[
'=
'=
]
wr_var=[
'Substr(riga,2,15)
'Substr(riga,20,100)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
prev=O252
rd_field=[
'DGNCODICE
]
rd_kfield=[
'DGNTIPO
'DGNCODICE
]
rd_kvar=[
'Left(riga,1)
'Substr(riga,17,3)
]
rd_var=[
'_code3
]
I
obj='Var
pag=1
prev=O251
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O237
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O236
var_op='asgn
I
obj='Delete
pag=1
sel_type='all
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O51
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O53
fatherSonIndex=0
frm_calc=[
'w_tberrorisid='S'
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O281
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tberrorisid.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/tberrorisid.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tberrorisid.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O290
var_op='asgn
I
obj='Exec
pag=1
prev=O288
I
obj='While
pag=1
prev=O287
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O288
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O294
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O295
fatherSonIndex=0
frm_calc=''TBERRORISID - Inserimento codice '+ Left(riga,3)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_code3
next=Icpitembatch.CPRead
arch='tberrorisid
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code3)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O302
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tberrorisid
father=O303
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'SIDCODICE
'SIDTIPOELAB
'SIDDESCRI
]
rd_kvar=[
'Left(riga,3)
'Substr(riga,4,15)
'Substr(riga,19,100)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tberrorisid
father=O303
fatherSonIndex=1
obj='Write
pag=1
rd_kfield=[
'SIDCODICE
]
rd_kop=[
'=
]
rd_kvar=[
'Left(riga,3)
]
wr_field=[
'SIDTIPOELAB
'SIDDESCRI
]
wr_op=[
'=
'=
]
wr_var=[
'Substr(riga,4,15)
'Substr(riga,19,100)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
prev=O301
rd_field=[
'SIDCODICE
]
rd_kfield=[
'SIDCODICE
]
rd_kvar=[
'Left(riga,3)
]
rd_var=[
'_code3
]
I
obj='Var
pag=1
prev=O300
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O286
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O49
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O51
fatherSonIndex=0
frm_calc=[
'w_tbtipnat='S'
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O330
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbtipnat.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/tbtipnat.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbtipnat.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O339
var_op='asgn
I
obj='Exec
pag=1
prev=O337
I
obj='While
pag=1
prev=O336
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O337
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O343
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O344
fatherSonIndex=0
frm_calc=''TBTIPNAT - Inserimento codice '+ Left(riga,1)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_code1
next=Icpitembatch.CPRead
arch='tbtipnat
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code1)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O351
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbtipnat
father=O352
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'TIPONAT
'DESCRI
]
rd_kvar=[
'Left(riga,1)
'Substr(riga,2,110)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbtipnat
father=O352
fatherSonIndex=1
obj='Write
pag=1
rd_kfield=[
'TIPONAT
]
rd_kop=[
'=
]
rd_kvar=[
'Left(riga,1)
]
wr_field=[
'DESCRI
]
wr_op=[
'=
]
wr_var=[
'Substr(riga,2,110)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
prev=O350
rd_field=[
'TIPONAT
]
rd_kfield=[
'TIPONAT
]
rd_kvar=[
'Left(riga,1)
]
rd_var=[
'_code1
]
I
obj='Var
pag=1
prev=O349
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O335
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O47
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O49
fatherSonIndex=0
frm_calc=[
'w_tbrapp='S'
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O379
fatherSonIndex=0
frm_calc=[
'pTipo='P'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('newtab/tbrapp.txt')
len=1
name='fhand
next=Icpitembatch.CPDelete
arch='tbrapp
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPIfElse
frm_calc=[
'pTipo='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O391
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O392
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbrapp.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMessage
father=O392
fatherSonIndex=1
frm_calc=''Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbrapp.txt'
msg_type='Info
obj='Message
pag=1
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=1
prev=O389
I
obj='While
pag=1
prev=O388
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O389
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O403
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O404
fatherSonIndex=0
frm_calc=''TBRAPP - Inserimento codice '+ Left(riga,4)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_code10
next=Icpitembatch.CPRead
arch='tbrapp
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code10)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O411
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbrapp
father=O412
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'IDBASE
'CODICE
'DESCRI
'NOTE
'IDTBLS
'IMP1
'IMP2
'IMP3
'IMP4
'IMP5
'IMP6
]
rd_kvar=[
'Left(riga,10)
'Substr(riga,11,2)
'Substr(riga,13,50)
'Substr(riga,63,254)
'Substr(riga,317,1)
'iif(Len(LRTrim(Substr(riga,318,250)))=0,'Vale Zero',Substr(riga,318,250))
'iif(Len(LRTrim(Substr(riga,568,250)))=0,'Vale Zero',Substr(riga,568,250))
'iif(Len(LRTrim(Substr(riga,818,250)))=0,'Vale Zero',Substr(riga,818,250))
'iif(Len(LRTrim(Substr(riga,1068,250)))=0,'Vale Zero',Substr(riga,1068,250))
'iif(Len(LRTrim(Substr(riga,1318,250)))=0,'Vale Zero',Substr(riga,1318,250))
'iif(Len(LRTrim(Substr(riga,1568,250)))=0,'Vale Zero',Substr(riga,1568,250))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbrapp
father=O412
fatherSonIndex=1
obj='Write
pag=1
rd_kfield=[
'CODICE
]
rd_kop=[
'=
]
rd_kvar=[
'Substr(riga,11,2)
]
wr_field=[
'DESCRI
'NOTE
'IMP1
'IMP2
'IMP3
'IMP4
'IMP5
'IMP6
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,13,50)
'Substr(riga,63,254)
'iif(Len(LRTrim(Substr(riga,318,250)))=0,'Vale Zero',Substr(riga,318,250))
'iif(Len(LRTrim(Substr(riga,568,250)))=0,'Vale Zero',Substr(riga,568,250))
'iif(Len(LRTrim(Substr(riga,818,250)))=0,'Vale Zero',Substr(riga,818,250))
'iif(Len(LRTrim(Substr(riga,1068,250)))=0,'Vale Zero',Substr(riga,1068,250))
'iif(Len(LRTrim(Substr(riga,1318,250)))=0,'Vale Zero',Substr(riga,1318,250))
'iif(Len(LRTrim(Substr(riga,1568,250)))=0,'Vale Zero',Substr(riga,1568,250))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
prev=O410
rd_field=[
'IDBASE
]
rd_kfield=[
'CODICE
]
rd_kvar=[
'Substr(riga,11,2)
]
rd_var=[
'_code10
]
I
obj='Var
pag=1
prev=O409
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Delete
pag=1
prev=O387
sel_type='all
I
obj='Var
pag=1
prev=O384
var_op='asgn
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O384
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbrapp.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMessage
father=O384
fatherSonIndex=1
frm_calc=''Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbrapp.txt'
msg_type='Info
obj='Message
pag=1
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O45
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O47
fatherSonIndex=0
frm_calc=[
'w_tbesitoage='S'
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O445
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbesitoae.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/tbesitoae.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbesitoae.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O454
var_op='asgn
I
obj='Exec
pag=1
prev=O452
I
obj='While
pag=1
prev=O451
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O452
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O458
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O459
fatherSonIndex=0
frm_calc=''TBESITOAE - Inserimento codice '+ Left(riga,4)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_code3
next=Icpitembatch.CPRead
arch='tbesitoae
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code3)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O466
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbesitoae
father=O467
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'TIPO
'CODICE
'DESCRI
]
rd_kvar=[
'Left(riga,1)
'Substr(riga,2,3)
'Substr(riga,5,254)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbesitoae
father=O467
fatherSonIndex=1
obj='Write
pag=1
rd_kfield=[
'TIPO
'CODICE
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,1)
'Substr(riga,2,3)
]
wr_field=[
'DESCRI
]
wr_op=[
'=
]
wr_var=[
'Substr(riga,5,254)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
prev=O465
rd_field=[
'CODICE
]
rd_kfield=[
'TIPO
'CODICE
]
rd_kvar=[
'Left(riga,1)
'Substr(riga,2,3)
]
rd_var=[
'_code3
]
I
obj='Var
pag=1
prev=O464
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O450
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O43
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O45
fatherSonIndex=0
frm_calc=[
'w_tbcitta='S'
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O494
fatherSonIndex=0
frm_calc=[
'pTipo='P'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/tbcitta.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPIfElse
frm_calc=[
'pTipo='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O505
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O506
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbcitta.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMessage
father=O506
fatherSonIndex=1
frm_calc=''Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbcitta.txt' 
msg_type='Info
obj='Message
pag=1
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=1
prev=O503
I
obj='While
pag=1
prev=O502
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O503
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O517
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O518
fatherSonIndex=0
frm_calc='Substr(riga,72,4)
len=4
name='_code4
next=Icpitembatch.CPVarDecl
frm_calc=''COMUNI - Inserimento codice '+ _code4
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=10
name='_code10
next=Icpitembatch.CPRead
arch='tbcitta
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_code10))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O526
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O527
fatherSonIndex=0
frm_calc='iif(Len(LRTrim(Substr(riga,5,5))) > 2,'',LRTrim(Substr(riga,5,5)))
len=2
name='_code2
next=Icpitembatch.CPInsert
arch='tbcitta
obj='Insert
pag=1
prev=O532
rd_kfield=[
'IDBASE
'CITTA
'PROV
'IDTBLS
'SIGLA
'CAB
'CAP
'PKTBSTATI
'PREF
]
rd_kvar=[
'LibreriaMit.UniqueId()
'Left(riga,40)
'Substr(riga,47,2)
''*'
'_code4
'Substr(riga,41,6)
'Substr(riga,49,9)
'Substr(riga,58,3)
'Substr(riga,76,4)
]
I
obj='Var
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbcitta
father=O527
fatherSonIndex=1
next=Icpitembatch.CPWrite
arch='DecodeCitta
obj='Write
pag=1
prev=O537
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_code10
]
wr_field=[
'CITTAMIT
'CAB
'PROV
'CAPMIT
'PKTBSTATI
'SIGLA
'PREF
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Left(riga,40)
'Substr(riga,41,6)
'Substr(riga,47,2)
'Substr(riga,49,9)
'Substr(riga,58,3)
'_code4
'Substr(riga,76,4)
]
I
obj='Write
pag=1
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_code10
]
wr_field=[
'CITTA
'CAB
'PROV
'CAP
'PKTBSTATI
'SIGLA
'PREF
'IDTBLS
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Left(riga,40)
'Substr(riga,41,6)
'Substr(riga,47,2)
'Substr(riga,49,9)
'Substr(riga,58,3)
'_code4
'Substr(riga,76,4)
'"*"
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
prev=O525
rd_field=[
'IDBASE
]
rd_kfield=[
'SIGLA
]
rd_kvar=[
'_code4
]
rd_var=[
'_code10
]
I
obj='Var
pag=1
prev=O524
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
prev=O523
var_op='asgn
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O499
var_op='asgn
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O499
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbcitta.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMessage
father=O499
fatherSonIndex=1
frm_calc=''Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbcitta.txt' 
msg_type='Info
obj='Message
pag=1
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O41
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O43
fatherSonIndex=0
frm_calc=[
'w_tbstati='S'
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O568
fatherSonIndex=0
frm_calc=[
'pTipo='P'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/tbstati.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPIfElse
frm_calc=[
'pTipo='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O579
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O580
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbstati.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMessage
father=O580
fatherSonIndex=1
frm_calc=''Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbstati.txt' + NL
msg_type='Info
obj='Message
pag=1
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=1
prev=O577
I
obj='While
pag=1
prev=O576
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O577
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O591
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O592
fatherSonIndex=0
frm_calc=''TBSTATI - Inserimento codice '+ Left(riga,3)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_code3
next=Icpitembatch.CPRead
arch='tbstati
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code3)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O599
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbstati
father=O600
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'CODSTA
'DESCRI
'SIGLA
'ISO
'ISO2
'IDBASE
'FLGSAE
]
rd_kvar=[
'Left(riga,3)
'Substr(riga,9,40)
'Substr(riga,50,4)
'Substr(riga,4,3)
'Substr(riga,7,2)
'Substr(riga,53,10)
'Substr(riga,81,3)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbstati
father=O600
fatherSonIndex=1
obj='Write
pag=1
rd_kfield=[
'CODSTA
]
rd_kop=[
'=
]
rd_kvar=[
'Left(riga,3)
]
wr_field=[
'DESCRI
'SIGLA
'ISO
'ISO2
'FLGSAE
]
wr_op=[
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,9,40)
'Substr(riga,50,4)
'Substr(riga,4,3)
'Substr(riga,7,2)
'Substr(riga,81,3)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
prev=O598
rd_field=[
'CODSTA
]
rd_kfield=[
'CODSTA
]
rd_kvar=[
'Left(riga,3)
]
rd_var=[
'_code3
]
I
obj='Var
pag=1
prev=O597
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O573
var_op='asgn
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O573
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbstati.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMessage
father=O573
fatherSonIndex=1
frm_calc=''Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbstati.txt' + NL
msg_type='Info
obj='Message
pag=1
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O39
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O41
fatherSonIndex=0
frm_calc=[
'w_tbcauana='S'
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O633
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbcausin.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPDelete
arch='cauanainter
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/tbcausin.txt')
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='''
len=30
name='_lista
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbcausin.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbcauana.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/tbcauana.txt')
len=1
name='fhand
next=Icpitembatch.CPVarDecl
frm_calc='-1
len=10
name='conta
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbcauana.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O653
var_op='asgn
I
obj='Exec
pag=1
prev=O651
I
obj='While
pag=1
prev=O649
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O651
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O657
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O658
fatherSonIndex=0
frm_calc=''TBCAUANA - Inserimento codice '+ Left(riga,4)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='Substr(riga,174,50)
len=30
name='_lista
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='_code4
next=Icpitembatch.CPRead
arch='tbcauana
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_code4))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O666
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O667
fatherSonIndex=0
frm_calc='conta + 1
len=10
name='conta
next=Icpitembatch.CPVarDecl
frm_calc='Right('0000'+LRTrim(Str(conta,10,0)),4)
len=4
name='_code4
next=Icpitembatch.CPInsert
arch='tbcauana
obj='Insert
pag=1
prev=O673
rd_kfield=[
'idbase
'DESCRI
'CODCAU
'SEGNO
'CAUSINT
'DATAVALI
'VALPERINT
'FLGINTER
]
rd_kvar=[
'_code4
'Substr(riga,5,165)
'Left(riga,4)
'Substr(riga,170,1)
'Substr(riga,171,2)
'iif(LRTrim(Substr(riga,224,8))='',NullDate(),CharToDate(Substr(riga,224,8)))
'_lista
'Substr(riga,173,1)
]
I
obj='Var
pag=1
prev=O672
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbcauana
father=O667
fatherSonIndex=1
obj='Write
pag=1
rd_kfield=[
'idbase
]
rd_kop=[
'=
]
rd_kvar=[
'_code4
]
wr_field=[
'DESCRI
'CODCAU
'SEGNO
'CAUSINT
'DATAVALI
'VALPERINT
'FLGINTER
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,5,165)
'Left(riga,4)
'Substr(riga,170,1)
'Substr(riga,171,2)
'iif(LRTrim(Substr(riga,224,8))='',NullDate(),CharToDate(Substr(riga,224,8)))
'_lista
'Substr(riga,173,1)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
prev=O665
rd_field=[
'idbase
]
rd_kfield=[
'CODCAU
'CAUSINT
'VALPERINT
]
rd_kvar=[
'LRTrim(Left(riga,4))
'Substr(riga,171,2)
'_lista
]
rd_var=[
'_code4
]
I
obj='Var
pag=1
prev=O664
var_op='asgn
I
obj='Var
pag=1
prev=O663
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Select
pag=1
prev=O648
sel_field='tbcauana->idbase
sel_name='tbcauana
sel_order='tbcauana->idbase
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O649
fatherSonIndex=0
frm_calc=[
'Val(tbcauana->idbase) > conta
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O694
fatherSonIndex=0
frm_calc='Val(tbcauana->idbase)
len=10
name='conta
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='N
pag=1
prev=O647
var_op='asgn
I
obj='Var
pag=1
prev=O646
var_op='asgn
I
obj='Exec
pag=1
prev=O645
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O644
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O642
var_op='asgn
I
obj='While
pag=1
prev=O641
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O642
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O704
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O705
fatherSonIndex=0
frm_calc=''TBCAUSIN - Inserimento codice '+ Left(riga,2)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPRead
arch='tbcausin
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_code))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O711
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbcausin
father=O712
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'CODVOC
'DESCRIZ
'DATAVALI
]
rd_kvar=[
'Left(riga,2)
'Substr(riga,3,165)
'iif(Empty(LRTrim(Substr(riga,169,8))),NullDate(),CharToDate(Substr(riga,169,8)))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbcausin
father=O712
fatherSonIndex=1
obj='Write
pag=1
rd_kfield=[
'CODVOC
]
rd_kop=[
'=
]
rd_kvar=[
'Left(riga,2)
]
wr_field=[
'DESCRIZ
'DATAVALI
]
wr_op=[
'=
'=
]
wr_var=[
'Substr(riga,3,165)
'iif(Empty(LRTrim(Substr(riga,169,8))),NullDate(),CharToDate(Substr(riga,169,8)))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
prev=O710
rd_field=[
'CODVOC
]
rd_kfield=[
'CODVOC
]
rd_kvar=[
'Left(riga,2)
]
rd_var=[
'_code
]
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O640
var_op='asgn
I
obj='Var
pag=1
prev=O639
var_op='asgn
I
obj='Delete
pag=1
prev=O638
sel_type='all
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O37
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O39
fatherSonIndex=0
frm_calc=[
'w_tbvalute='S'
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O739
fatherSonIndex=0
frm_calc=[
'pTipo='P'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/tbvalute.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPIfElse
frm_calc=[
'pTipo='P'
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O750
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O751
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbvalute.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMessage
father=O751
fatherSonIndex=1
frm_calc=''Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbvalute.txt'
msg_type='Info
obj='Message
pag=1
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=1
prev=O748
I
obj='While
pag=1
prev=O747
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O748
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O762
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O763
fatherSonIndex=0
frm_calc=''TBVALUTE - Inserimento codice '+ Left(riga,3)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_code3
next=Icpitembatch.CPRead
arch='tbvalute
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code3)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O770
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbvalute
father=O771
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'CODVAL
'DESCRI
'ISO
]
rd_kvar=[
'Left(riga,3)
'Substr(riga,4,45)
'Substr(riga,49,3)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbvalute
father=O771
fatherSonIndex=1
obj='Write
pag=1
rd_kfield=[
'CODVAL
]
rd_kop=[
'=
]
rd_kvar=[
'Left(riga,3)
]
wr_field=[
'DESCRI
'ISO
]
wr_op=[
'=
'=
]
wr_var=[
'Substr(riga,4,45)
'Substr(riga,49,3)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
prev=O769
rd_field=[
'CODVAL
]
rd_kfield=[
'CODVAL
]
rd_kvar=[
'Left(riga,3)
]
rd_var=[
'_code3
]
I
obj='Var
pag=1
prev=O768
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O744
var_op='asgn
I
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O744
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbvalute.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMessage
father=O744
fatherSonIndex=1
frm_calc=''Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbvalute.txt'
msg_type='Info
obj='Message
pag=1
I
I
]
w=[
150
150
150
]
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O35
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O37
fatherSonIndex=0
frm_calc=[
'w_tbtipreg='S'
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O804
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbtipreg.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/tbtipreg.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbtipreg.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O813
var_op='asgn
I
obj='Exec
pag=1
prev=O811
I
obj='While
pag=1
prev=O810
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O811
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O817
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O818
fatherSonIndex=0
frm_calc=''TBTIPREG - Inserimento codice '+ Substr(riga,193,2)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_code
next=Icpitembatch.CPRead
arch='tbtipreg
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O825
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbtipreg
father=O826
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'CODICE
'DES1
'DES2
'TIPREG
'OPERAZIO
'DATAINI
'DATAFINE
]
rd_kvar=[
'Substr(riga,193,2)
'Substr(riga,2,90)
'Substr(riga,92,60)
'Left(riga,1)
'Substr(riga,192,1)
'iif(Empty(LRTrim(Substr(riga,196,8))),NullDate(),CharToDate(Substr(riga,155,8)))
'iif(Empty(LRTrim(Substr(riga,204,8))),NullDate(),CharToDate(Substr(riga,163,8)))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbtipreg
father=O826
fatherSonIndex=1
obj='Write
pag=1
rd_kfield=[
'CODICE
]
rd_kop=[
'=
]
rd_kvar=[
'Substr(riga,193,2)
]
wr_field=[
'DES1
'DES2
'TIPREG
'OPERAZIO
'DATAINI
'DATAFINE
]
wr_op=[
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,2,90)
'Substr(riga,92,60)
'Left(riga,1)
'Substr(riga,192,1)
'iif(Empty(LRTrim(Substr(riga,196,8))),NullDate(),CharToDate(Substr(riga,196,8)))
'iif(Empty(LRTrim(Substr(riga,204,8))),NullDate(),CharToDate(Substr(riga,204,8)))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
prev=O824
rd_field=[
'CODICE
]
rd_kfield=[
'CODICE
]
rd_kvar=[
'Substr(riga,193,2)
]
rd_var=[
'_code
]
I
obj='Var
pag=1
prev=O823
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O809
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O33
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O35
fatherSonIndex=0
frm_calc=[
'w_tbtipint='S'
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O853
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbtipint.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/tbtipint.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbtipint.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O862
var_op='asgn
I
obj='Exec
pag=1
prev=O860
I
obj='While
pag=1
prev=O859
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O860
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O866
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O867
fatherSonIndex=0
frm_calc=''TBTIPINT - Inserimento codice '+ Left(riga,2)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_code
next=Icpitembatch.CPRead
arch='tbtipint
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O874
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbtipint
father=O875
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'TIPOINT
'DESCRI
'VIGILATO
]
rd_kvar=[
'Left(riga,2)
'Substr(riga,3,190)
'Val(Substr(riga,261,1))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbtipint
father=O875
fatherSonIndex=1
obj='Write
pag=1
rd_kfield=[
'TIPOINT
]
rd_kop=[
'=
]
rd_kvar=[
'Left(riga,2)
]
wr_field=[
'DESCRI
'VIGILATO
]
wr_op=[
'=
'=
]
wr_var=[
'Substr(riga,3,190)
'Val(Substr(riga,261,1))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
prev=O873
rd_field=[
'TIPOINT
]
rd_kfield=[
'TIPOINT
]
rd_kvar=[
'Left(riga,2)
]
rd_var=[
'_code
]
I
obj='Var
pag=1
prev=O872
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O858
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O31
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O33
fatherSonIndex=0
frm_calc=[
'w_tbsetsin='S'
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='tbsetsina
father=O902
fatherSonIndex=0
next=Icpitembatch.CPDelete
arch='tbsetsin
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbsetsin.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/tbsetsin.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbsetsin.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O913
var_op='asgn
I
obj='Exec
pag=1
prev=O911
I
obj='While
pag=1
prev=O910
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O911
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O917
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O918
fatherSonIndex=0
frm_calc='Val(LRTrim(Substr(riga,365,2)))
len=5
name='_id
next=Icpitembatch.CPVarDecl
frm_calc=''TBSETSIN - Inserimento codice '+ Left(riga,3)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_code3
next=Icpitembatch.CPRead
arch='tbsetsin
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_code3))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O926
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbsetsin
father=O927
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'IDSETSIN
'SETSINT
'DESCRI
'DAGRU1
'AGRU1
'DAGRU2
'AGRU2
'DAGRU3
'AGRU3
'DAGRU4
'AGRU4
'DAGRU5
'AGRU5
'DAGRU6
'AGRU6
'DASOT1
'ASOT1
'DASOT2
'ASOT2
'DASOT3
'ASOT3
'DASOT4
'ASOT4
'DASOT5
'ASOT5
'DASOT6
'ASOT6
'DASOT7
'ASOT7
'DASOT8
'ASOT8
'DASOT9
'ASOT9
'DASOT10
'ASOT10
'DASOT11
'ASOT11
'DASOT12
'ASOT12
'DAATE1
'AATE1
'DAATE2
'AATE2
'DAATE3
'AATE3
'DAATE4
'AATE4
'DAATE5
'AATE5
'DAATE6
'AATE6
'DATAINI
'DATAFINE
]
rd_kvar=[
'_id
'Left(riga,3)
'Substr(riga,4,200)
'Substr(riga,204,3)
'Substr(riga,207,3)
'Substr(riga,210,3)
'Substr(riga,213,3)
'Substr(riga,216,3)
'Substr(riga,219,3)
'Substr(riga,222,3)
'Substr(riga,225,3)
'Substr(riga,228,3)
'Substr(riga,231,3)
'Substr(riga,234,3)
'Substr(riga,237,3)
'Substr(riga,241,3)
'Substr(riga,244,3)
'Substr(riga,247,3)
'Substr(riga,250,3)
'Substr(riga,253,3)
'Substr(riga,256,3)
'Substr(riga,259,3)
'Substr(riga,262,3)
'Substr(riga,265,3)
'Substr(riga,268,3)
'Substr(riga,271,3)
'Substr(riga,274,3)
'Substr(riga,277,3)
'Substr(riga,280,3)
'Substr(riga,283,3)
'Substr(riga,286,3)
'Substr(riga,289,3)
'Substr(riga,292,3)
'Substr(riga,295,3)
'Substr(riga,298,3)
'Substr(riga,301,3)
'Substr(riga,304,3)
'Substr(riga,307,3)
'Substr(riga,310,3)
'Substr(riga,313,3)
'Substr(riga,316,3)
'Substr(riga,319,3)
'Substr(riga,322,3)
'Substr(riga,325,3)
'Substr(riga,328,3)
'Substr(riga,331,3)
'Substr(riga,334,3)
'Substr(riga,337,3)
'Substr(riga,340,3)
'Substr(riga,343,3)
'Substr(riga,346,3)
'CharToDate(Substr(riga,349,8))
'CharToDate(Substr(riga,357,8))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbsetsin
father=O927
fatherSonIndex=1
obj='Write
pag=1
rd_kfield=[
'SETSINT
'IDSETSIN
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,3)
'_id
]
wr_field=[
'DESCRI
'DAGRU1
'AGRU1
'DAGRU2
'AGRU2
'DAGRU3
'AGRU3
'DAGRU4
'AGRU4
'DAGRU5
'AGRU5
'DAGRU6
'AGRU6
'DASOT1
'ASOT1
'DASOT2
'ASOT2
'DASOT3
'ASOT3
'DASOT4
'ASOT4
'DASOT5
'ASOT5
'DASOT6
'ASOT6
'DASOT7
'ASOT7
'DASOT8
'ASOT8
'DASOT9
'ASOT9
'DASOT10
'ASOT10
'DASOT11
'ASOT11
'DASOT12
'ASOT12
'DAATE1
'AATE1
'DAATE2
'AATE2
'DAATE3
'AATE3
'DAATE4
'AATE4
'DAATE5
'AATE5
'DAATE6
'AATE6
'DATAINI
'DATAFINE
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,4,200)
'Substr(riga,204,3)
'Substr(riga,207,3)
'Substr(riga,210,3)
'Substr(riga,213,3)
'Substr(riga,216,3)
'Substr(riga,219,3)
'Substr(riga,222,3)
'Substr(riga,225,3)
'Substr(riga,228,3)
'Substr(riga,231,3)
'Substr(riga,234,3)
'Substr(riga,237,3)
'Substr(riga,241,3)
'Substr(riga,244,3)
'Substr(riga,247,3)
'Substr(riga,250,3)
'Substr(riga,253,3)
'Substr(riga,256,3)
'Substr(riga,259,3)
'Substr(riga,262,3)
'Substr(riga,265,3)
'Substr(riga,268,3)
'Substr(riga,271,3)
'Substr(riga,274,3)
'Substr(riga,277,3)
'Substr(riga,280,3)
'Substr(riga,283,3)
'Substr(riga,286,3)
'Substr(riga,289,3)
'Substr(riga,292,3)
'Substr(riga,295,3)
'Substr(riga,298,3)
'Substr(riga,301,3)
'Substr(riga,304,3)
'Substr(riga,307,3)
'Substr(riga,310,3)
'Substr(riga,313,3)
'Substr(riga,316,3)
'Substr(riga,319,3)
'Substr(riga,322,3)
'Substr(riga,325,3)
'Substr(riga,328,3)
'Substr(riga,331,3)
'Substr(riga,334,3)
'Substr(riga,337,3)
'Substr(riga,340,3)
'Substr(riga,343,3)
'Substr(riga,346,3)
'CharToDate(Substr(riga,349,8))
'CharToDate(Substr(riga,357,8))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
prev=O925
rd_field=[
'SETSINT
]
rd_kfield=[
'IDSETSIN
]
rd_kvar=[
'_id
]
rd_var=[
'_code
]
I
obj='Var
pag=1
prev=O924
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
prev=O923
var_op='asgn
I
obj='Var
obj_type='N
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O909
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O908
var_op='asgn
I
obj='Delete
pag=1
prev=O907
sel_type='all
I
obj='Delete
pag=1
sel_type='all
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O29
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O31
fatherSonIndex=0
frm_calc=[
'w_tbramgru='S'
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O954
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbramgru.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/tbramgru.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbramgru.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O963
var_op='asgn
I
obj='Exec
pag=1
prev=O961
I
obj='While
pag=1
prev=O960
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O961
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O967
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O968
fatherSonIndex=0
frm_calc=''TBRAMGRU - Inserimento codice '+ Left(riga,3)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_code
next=Icpitembatch.CPRead
arch='tbramgru
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code3)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O975
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbramgru
father=O976
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'RAMGRU
'DESCRI
]
rd_kvar=[
'Left(riga,3)
'Substr(riga,4,70)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbramgru
father=O976
fatherSonIndex=1
obj='Write
pag=1
rd_kfield=[
'RAMGRU
]
rd_kop=[
'=
]
rd_kvar=[
'Left(riga,3)
]
wr_field=[
'DESCRI
]
wr_op=[
'=
]
wr_var=[
'Substr(riga,4,70)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
prev=O974
rd_field=[
'RAMGRU
]
rd_kfield=[
'RAMGRU
]
rd_kvar=[
'Left(riga,3)
]
rd_var=[
'_code3
]
I
obj='Var
pag=1
prev=O973
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O959
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O27
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O29
fatherSonIndex=0
frm_calc=[
'w_tbstgru='S'
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1003
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbstgru.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/tbstgru.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbstgru.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O1012
var_op='asgn
I
obj='Exec
pag=1
prev=O1010
I
obj='While
pag=1
prev=O1009
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1010
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O1016
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1017
fatherSonIndex=0
frm_calc=''TBSTGRU - Inserimento codice '+ Left(riga,3)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_code
next=Icpitembatch.CPRead
arch='tbstgru
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code3)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O1024
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbstgru
father=O1025
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'SOTGRU
'DESCRI
'TIPOSOT
'DATAINI
'DATAFINE
]
rd_kvar=[
'Left(riga,3)
'Substr(riga,4,200)
'Substr(riga,204,1)
'CharToDate(Substr(riga,206,8))
'CharToDate(Substr(riga,214,8))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbstgru
father=O1025
fatherSonIndex=1
obj='Write
pag=1
rd_kfield=[
'SOTGRU
]
rd_kop=[
'=
]
rd_kvar=[
'Left(riga,3)
]
wr_field=[
'DESCRI
'TIPOSOT
'DATAINI
'DATAFINE
]
wr_op=[
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,4,200)
'Substr(riga,204,1)
'CharToDate(Substr(riga,206,8))
'CharToDate(Substr(riga,214,8))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
prev=O1023
rd_field=[
'SOTGRU
]
rd_kfield=[
'SOTGRU
]
rd_kvar=[
'Left(riga,3)
]
rd_var=[
'_code3
]
I
obj='Var
pag=1
prev=O1022
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O1008
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
prev=O25
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O27
fatherSonIndex=0
frm_calc=[
'w_tbtipleg='S'
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1052
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbtipleg.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/tbtipleg.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbtipleg.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O1061
var_op='asgn
I
obj='Exec
pag=1
prev=O1059
I
obj='While
pag=1
prev=O1058
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1059
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O1065
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1066
fatherSonIndex=0
frm_calc=''TBTIPLEG - Inserimento codice '+ Left(riga,1)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=1
name='_code1
next=Icpitembatch.CPRead
arch='tbtipleg
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code1)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O1073
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbtipleg
father=O1074
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'TIPLEG
'DESCRIZ
'DATAINI
'DATAFINE
'FILTRO
'DESCRIZ2
'DATAINID2
'DATAFIND2
]
rd_kvar=[
'Left(riga,1)
'Substr(riga,2,95)
'CharToDate(Substr(riga,97,8))
'CharToDate(Substr(riga,105,8))
'Substr(riga,113,1)
'Substr(riga,114,95)
'CharToDate(Substr(riga,209,8))
'CharToDate(Substr(riga,217,8))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbtipleg
father=O1074
fatherSonIndex=1
obj='Write
pag=1
rd_kfield=[
'TIPLEG
]
rd_kop=[
'=
]
rd_kvar=[
'Left(riga,1)
]
wr_field=[
'DESCRIZ
'DATAINI
'DATAFINE
'FILTRO
'DESCRIZ2
'DATAINID2
'DATAFIND2
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,2,95)
'CharToDate(Substr(riga,97,8))
'CharToDate(Substr(riga,105,8))
'Substr(riga,113,1)
'Substr(riga,114,95)
'CharToDate(Substr(riga,209,8))
'CharToDate(Substr(riga,217,8))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
prev=O1072
rd_field=[
'TIPLEG
]
rd_kfield=[
'TIPLEG
]
rd_kvar=[
'Left(riga,1)
]
rd_var=[
'_code1
]
I
obj='Var
pag=1
prev=O1071
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O1057
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O25
fatherSonIndex=0
frm_calc=[
'w_tbtipdoc='S'
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1101
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbtipdoc.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/tbtipdoc.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbtipdoc.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O1110
var_op='asgn
I
obj='Exec
pag=1
prev=O1108
I
obj='While
pag=1
prev=O1107
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1108
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O1114
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1115
fatherSonIndex=0
frm_calc=''TBTIPDOC - Inserimento codice '+ Left(riga,2)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_code
next=Icpitembatch.CPRead
arch='tbtipdoc
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O1122
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbtipdoc
father=O1123
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'TIPDOC
'DESCRI
]
rd_kvar=[
'Left(riga,2)
'Substr(riga,3,30)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbtipdoc
father=O1123
fatherSonIndex=1
obj='Write
pag=1
rd_kfield=[
'TIPDOC
]
rd_kop=[
'=
]
rd_kvar=[
'Left(riga,2)
]
wr_field=[
'DESCRI
]
wr_op=[
'=
]
wr_var=[
'Substr(riga,3,30)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
prev=O1121
rd_field=[
'TIPDOC
]
rd_kfield=[
'TIPDOC
]
rd_kvar=[
'Left(riga,2)
]
rd_var=[
'_code
]
I
obj='Var
pag=1
prev=O1120
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O1106
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O12
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=1
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=1
prev=O10
I
obj='Remark
pag=1
prev=O9
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O8
I
nonlocal=True
obj='Var
pag=1
prev=O7
I
obj='Remark
pag=1
prev=O5
I
obj='Begin
pag=1
prev=O3
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O5
fatherSonIndex=0
len=1
name='fhand
next=Icpitembatch.CPVarDecl
len=10
name='riga
next=Icpitembatch.CPVarDecl
len=1
name='_code1
next=Icpitembatch.CPVarDecl
len=2
name='_code
next=Icpitembatch.CPVarDecl
len=2
name='_code2
next=Icpitembatch.CPVarDecl
len=3
name='_code3
next=Icpitembatch.CPVarDecl
len=4
name='_code4
next=Icpitembatch.CPVarDecl
len=10
name='_code10
next=Icpitembatch.CPVarDecl
len=11
name='_code11
next=Icpitembatch.CPVarDecl
len=40
name='_code40
next=Icpitembatch.CPVarDecl
len=10
name='_codenum
next=Icpitembatch.CPVarDecl
len=70
name='_dbaicab
next=Icpitembatch.CPVarDecl
len=10
name='conta
next=Icpitembatch.CPVarDecl
len=30
name='_lista
next=Icpitembatch.CPVarDecl
len=10
name='_oldazi
next=Icpitembatch.CPVarDecl
len=4
name='_id4
next=Icpitembatch.CPVarDecl
len=100
name='_stringa
next=Icpitembatch.CPVarDecl
len=5
name='_id
obj='Var
obj_type='N
pag=1
prev=O1169
I
obj='Var
pag=1
prev=O1168
I
obj='Var
pag=1
prev=O1167
I
obj='Var
pag=1
prev=O1166
I
obj='Var
pag=1
prev=O1165
I
obj='Var
obj_type='N
pag=1
prev=O1164
I
obj='Var
pag=1
prev=O1163
I
obj='Var
obj_type='N
pag=1
prev=O1162
I
obj='Var
pag=1
prev=O1161
I
obj='Var
pag=1
prev=O1160
I
obj='Var
pag=1
prev=O1159
I
obj='Var
pag=1
prev=O1158
I
obj='Var
pag=1
prev=O1157
I
obj='Var
pag=1
prev=O1156
I
obj='Var
pag=1
prev=O1155
I
obj='Var
pag=1
prev=O1154
I
obj='Var
obj_type='M
pag=1
prev=O1153
I
obj='Var
pag=1
I
I
]
w=[
150
150
]
I
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O3
fatherSonIndex=0
len=1
name='w_tbcitta
next=Icpitembatch.CPVarDecl
len=1
name='w_tbstati
next=Icpitembatch.CPVarDecl
len=1
name='w_tbsetsin
next=Icpitembatch.CPVarDecl
len=1
name='w_tbcauana
next=Icpitembatch.CPVarDecl
len=1
name='w_inter2bo
next=Icpitembatch.CPVarDecl
len=1
name='w_tbvalute
next=Icpitembatch.CPVarDecl
len=1
name='w_tbtipreg
next=Icpitembatch.CPVarDecl
len=1
name='w_tbtipint
next=Icpitembatch.CPVarDecl
len=1
name='w_tbesitoage
next=Icpitembatch.CPVarDecl
len=1
name='w_tbrapp
next=Icpitembatch.CPVarDecl
len=1
name='w_tbstgru
next=Icpitembatch.CPVarDecl
len=1
name='w_tbramgru
next=Icpitembatch.CPVarDecl
len=1
name='w_tbtipdoc
next=Icpitembatch.CPVarDecl
len=1
name='w_tbtipleg
next=Icpitembatch.CPVarDecl
len=1
name='w_tbtipnat
next=Icpitembatch.CPVarDecl
len=1
name='w_tberrorisid
next=Icpitembatch.CPVarDecl
len=1
name='w_tberrsiddgn
next=Icpitembatch.CPVarDecl
len=1
name='w_tbricevutesid
next=Icpitembatch.CPVarDecl
len=1
name='w_tbcittna
next=Icpitembatch.CPVarDecl
len=1
name='w_tbstatna
next=Icpitembatch.CPVarDecl
len=1
name='w_tberrdge
next=Icpitembatch.CPVarDecl
len=1
name='w_tbprvreg
next=Icpitembatch.CPVarDecl
len=1
name='w_tbesielb
next=Icpitembatch.CPVarDecl
len=1
name='w_convgio
next=Icpitembatch.CPVarDecl
len=1
name='w_staticrs
next=Icpitembatch.CPVarDecl
len=1
name='w_tbcandistr
next=Icpitembatch.CPVarDecl
len=1
name='w_tbluonas
next=Icpitembatch.CPVarDecl
len=1
name='w_tbprovsv
next=Icpitembatch.CPVarDecl
len=1
name='w_rapogg
next=Icpitembatch.CPVarDecl
len=1
name='w_tbnatura
next=Icpitembatch.CPVarDecl
len=1
name='w_tbscopo
next=Icpitembatch.CPVarDecl
len=1
name='w_tbrisglob
next=Icpitembatch.CPVarDecl
len=1
name='pTipo
obj='Var
pag=1
param=True
prev=O1205
I
obj='Var
pag=1
param=True
prev=O1204
I
obj='Var
pag=1
param=True
prev=O1203
I
obj='Var
pag=1
param=True
prev=O1202
I
obj='Var
pag=1
param=True
prev=O1201
I
obj='Var
pag=1
param=True
prev=O1200
I
obj='Var
pag=1
param=True
prev=O1199
I
obj='Var
pag=1
param=True
prev=O1198
I
obj='Var
pag=1
param=True
prev=O1197
I
obj='Var
pag=1
param=True
prev=O1196
I
obj='Var
pag=1
param=True
prev=O1195
I
obj='Var
pag=1
param=True
prev=O1194
I
obj='Var
pag=1
param=True
prev=O1193
I
obj='Var
pag=1
param=True
prev=O1192
I
obj='Var
pag=1
param=True
prev=O1191
I
obj='Var
pag=1
param=True
prev=O1190
I
obj='Var
pag=1
param=True
prev=O1189
I
obj='Var
pag=1
param=True
prev=O1188
I
obj='Var
pag=1
param=True
prev=O1187
I
obj='Var
pag=1
param=True
prev=O1186
I
obj='Var
pag=1
param=True
prev=O1185
I
obj='Var
pag=1
param=True
prev=O1184
I
obj='Var
pag=1
param=True
prev=O1183
I
obj='Var
pag=1
param=True
prev=O1182
I
obj='Var
pag=1
param=True
prev=O1181
I
obj='Var
pag=1
param=True
prev=O1180
I
obj='Var
pag=1
param=True
prev=O1179
I
obj='Var
pag=1
param=True
prev=O1178
I
obj='Var
pag=1
param=True
prev=O1177
I
obj='Var
pag=1
param=True
prev=O1176
I
obj='Var
pag=1
param=True
prev=O1175
I
obj='Var
pag=1
param=True
prev=O1174
I
obj='Var
pag=1
param=True
I
I
]
w=[
150
150
]
x=9
y=10
I
Icpitembatch.CPBeginEnd
comment='Aggiorna TBPRVREG
h=[
19
19
]
obj='Begin
pag=1
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1208
fatherSonIndex=0
frm_calc=[
'w_tbprvreg='S'
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1212
fatherSonIndex=0
next=Icpitembatch.CPTry
h=[
19
19
19
]
obj='Try
pag=1
prev=O1217
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1218
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbprvreg.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/tbprvreg.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbprvreg.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=1
prev=O1227
I
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O1226
var_op='asgn
I
obj='Exec
pag=1
prev=O1224
I
obj='While
pag=1
prev=O1223
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1224
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O1231
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1232
fatherSonIndex=0
frm_calc=''TBPRVREG - Inserimento codice '+ Substr(riga,1,2)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_code
next=Icpitembatch.CPRead
arch='tbprvreg
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O1239
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbprvreg
father=O1240
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'SIGLA
'PROVINCIA
'REGIONE
]
rd_kvar=[
'Left(riga,2)
'Upper(Substr(riga,3,21))
'Upper(Substr(riga,24,21))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbprvreg
father=O1240
fatherSonIndex=1
obj='Write
pag=1
rd_kfield=[
'SIGLA
]
rd_kop=[
'=
]
rd_kvar=[
'Left(riga,2)
]
wr_field=[
'PROVINCIA
'REGIONE
]
wr_op=[
'=
'=
]
wr_var=[
'Upper(Substr(riga,3,21))
'Upper(Substr(riga,24,21))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
prev=O1238
rd_field=[
'SIGLA
]
rd_kfield=[
'SIGLA
]
rd_kvar=[
'Substr(riga,1,2)
]
rd_var=[
'_code
]
I
obj='Var
pag=1
prev=O1237
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O1222
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1218
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=1
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=1
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
x=1204
y=4383
I
Icpitembatch.CPIfElse
frm_calc=[
'w_inter2bo='S'
]
h=[
19
19
]
obj='If
pag=1
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPVarDecl
father=O1268
fatherSonIndex=0
frm_calc='Utilities.GetCompany()
len=10
name='_oldazi
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='Utilities.SetCompany(_oldazi)
obj='Exec
pag=1
prev=O1274
I
obj='Select
pag=1
prev=O1273
sel_field='*
sel_name='cpazi
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1274
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbabicab.txt - Azienda: '+cpazi->CODAZI + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='Utilities.SetCompany(cpazi->codazi)
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/tbabicab.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbabicab.txt - Azienda: '+cpazi->CODAZI + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=1
prev=O1284
var_op='asgn
I
obj='Exec
pag=1
prev=O1282
I
obj='While
pag=1
prev=O1281
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1282
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=1
prev=O1288
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1289
fatherSonIndex=0
frm_calc=''TBABICAB - Inserimento codice '+ Left(riga,5)+"-"+Substr(riga,6,5)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_code11
next=Icpitembatch.CPRead
arch='inter2bo
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code11)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=1
prev=O1296
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='inter2bo
father=O1297
fatherSonIndex=0
obj='Insert
pag=1
rd_kfield=[
'CODINTER
'RAGSOC
'CODCAB
'DOMICILIO
'CODFISC
'DESCCIT
'PROVINCIA
'CAP
'PAESE
'TIPINTER
]
rd_kvar=[
'Left(riga,5)+"-"+Substr(riga,6,5)
'Substr(riga,11,70)
'Substr(riga,91,6)
'Substr(riga,97,35)
'Left(riga,5)
'Substr(riga,217,30)
'Substr(riga,292,2)
'Substr(riga,287,5)
''086'
''02'
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='inter2bo
father=O1297
fatherSonIndex=1
obj='Write
pag=1
rd_kfield=[
'CODINTER
]
rd_kop=[
'=
]
rd_kvar=[
'Left(riga,5)+"-"+Substr(riga,6,5)
]
wr_field=[
'RAGSOC
'CODCAB
'DOMICILIO
'CODFISC
'DESCCIT
'PROVINCIA
'CAP
'PAESE
'TIPINTER
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,11,70)
'Substr(riga,91,6)
'Substr(riga,97,35)
'Left(riga,5)
'Substr(riga,217,30)
'Substr(riga,292,2)
'Substr(riga,287,5)
''086'
''02'
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=1
prev=O1295
rd_field=[
'CODINTER
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'Left(riga,5)+"-"+Substr(riga,6,5)
]
rd_var=[
'_code11
]
I
obj='Var
pag=1
prev=O1294
var_op='asgn
I
nonlocal=True
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
prev=O1280
var_op='asgn
I
obj='Exec
pag=1
prev=O1279
I
nonlocal=True
obj='Var
obj_type='M
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=1
var_op='asgn
I
I
]
w=[
150
150
]
x=1174
y=2632
I
Icpitembatch.CPBeginEnd
comment='Aggiorna TBCITTNA
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna INTER2BO
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBESIELB
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna CONVGIO
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBSTATIOCSE
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBCANDISTR
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBLUONAS
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBPROVSV
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna RAPOGG
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBNATURA
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBSCOPO
h=[
19
19
]
next=Icpitembatch.CPBeginEnd
comment='Aggiorna TBRISGLOB
h=[
19
19
]
obj='Begin
pag=2
prev=O1342
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1344
fatherSonIndex=0
frm_calc=[
'w_tbrisglob='S'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1348
fatherSonIndex=0
next=Icpitembatch.CPTry
h=[
19
19
19
]
obj='Try
pag=2
prev=O1353
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1354
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbrisglob.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('newtab/tbrisglob.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbrisglob.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=2
prev=O1363
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O1362
var_op='asgn
I
obj='Exec
pag=2
prev=O1360
I
obj='While
pag=2
prev=O1359
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1360
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=2
prev=O1367
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1368
fatherSonIndex=0
frm_calc=''TBRISGLOB - Inserimento codice '+ Left(riga,1)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='""
len=1
name='_code1
next=Icpitembatch.CPRead
arch='tbrisglob
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code1)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O1375
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbrisglob
father=O1376
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'CODICE
'DESCRI
'IDBASE
]
rd_kvar=[
'Left(riga,1)
'Substr(riga,2,60)
'Substr(riga,61,10)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbrisglob
father=O1376
fatherSonIndex=1
obj='Write
pag=2
rd_kfield=[
'CODICE
]
rd_kop=[
'=
]
rd_kvar=[
'Left(riga,1)
]
wr_field=[
'DESCRI
'IDBASE
]
wr_op=[
'=
'=
]
wr_var=[
'Substr(riga,2,60)
'Substr(riga,61,10)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O1374
rd_field=[
'CODICE
]
rd_kfield=[
'CODICE
]
rd_kvar=[
'Left(riga,1)
]
rd_var=[
'_code1
]
I
obj='Var
pag=2
prev=O1373
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O1358
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1354
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=2
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=2
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O1340
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1342
fatherSonIndex=0
frm_calc=[
'w_tbscopo='S'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1406
fatherSonIndex=0
next=Icpitembatch.CPTry
h=[
19
19
19
]
obj='Try
pag=2
prev=O1411
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1412
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbscopo.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('newtab/tbscopo.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbscopo.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=2
prev=O1421
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O1420
var_op='asgn
I
obj='Exec
pag=2
prev=O1418
I
obj='While
pag=2
prev=O1417
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1418
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=2
prev=O1425
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1426
fatherSonIndex=0
frm_calc=''TBSCOPO - Inserimento codice '+ Left(riga,5)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_codenum
next=Icpitembatch.CPRead
arch='tbscopo
next=Icpitembatch.CPIfElse
frm_calc=[
'_codenum = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O1433
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbscopo
father=O1434
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'CODICE
'DESCRI
]
rd_kvar=[
'Val(Left(riga,5))
'Substr(riga,6,100)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbscopo
father=O1434
fatherSonIndex=1
obj='Write
pag=2
rd_kfield=[
'CODICE
]
rd_kop=[
'=
]
rd_kvar=[
'Val(Left(riga,5))
]
wr_field=[
'DESCRI
]
wr_op=[
'=
]
wr_var=[
'Substr(riga,6,100)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O1432
rd_field=[
'CODICE
]
rd_kfield=[
'CODICE
]
rd_kvar=[
'Val(Left(riga,5))
]
rd_var=[
'_codenum
]
I
obj='Var
obj_type='N
pag=2
prev=O1431
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O1416
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1412
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=2
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=2
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O1338
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1340
fatherSonIndex=0
frm_calc=[
'w_tbnatura='S'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1464
fatherSonIndex=0
next=Icpitembatch.CPTry
h=[
19
19
19
]
obj='Try
pag=2
prev=O1469
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1470
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbnatura.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('newtab/tbnatura.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbnatura.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=2
prev=O1479
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O1478
var_op='asgn
I
obj='Exec
pag=2
prev=O1476
I
obj='While
pag=2
prev=O1475
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1476
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=2
prev=O1483
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1484
fatherSonIndex=0
frm_calc=''TBNATURA - Inserimento codice '+ Left(riga,5)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='0
len=10
name='_codenum
next=Icpitembatch.CPRead
arch='tbnatura
next=Icpitembatch.CPIfElse
frm_calc=[
'_codenum = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O1491
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbnatura
father=O1492
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'CODICE
'DESCRI
]
rd_kvar=[
'Val(Left(riga,5))
'Substr(riga,6,100)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbnatura
father=O1492
fatherSonIndex=1
obj='Write
pag=2
rd_kfield=[
'CODICE
]
rd_kop=[
'=
]
rd_kvar=[
'Val(Left(riga,5))
]
wr_field=[
'DESCRI
]
wr_op=[
'=
]
wr_var=[
'Substr(riga,6,100)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O1490
rd_field=[
'CODICE
]
rd_kfield=[
'CODICE
]
rd_kvar=[
'Val(Left(riga,5))
]
rd_var=[
'_codenum
]
I
obj='Var
obj_type='N
pag=2
prev=O1489
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O1474
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1470
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=2
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=2
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O1336
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1338
fatherSonIndex=0
frm_calc=[
'w_rapogg='S'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1522
fatherSonIndex=0
next=Icpitembatch.CPTry
h=[
19
19
19
]
obj='Try
pag=2
prev=O1527
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1528
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbrappogg.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('newtab/tbrappogg.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del filetbrappogg.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=2
prev=O1537
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O1536
var_op='asgn
I
obj='Exec
pag=2
prev=O1534
I
obj='While
pag=2
prev=O1533
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1534
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=2
prev=O1541
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1542
fatherSonIndex=0
frm_calc=''TBRAPPOGG - Inserimento codice '+ Left(riga,3)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_code
next=Icpitembatch.CPRead
arch='tbrappogg
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code3)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O1549
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbrappogg
father=O1550
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'CODICE
'DESCRI
]
rd_kvar=[
'Left(riga,3)
'Substr(riga,4,100)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbrappogg
father=O1550
fatherSonIndex=1
obj='Write
pag=2
rd_kfield=[
'CODICE
]
rd_kop=[
'=
]
rd_kvar=[
'Left(riga,3)
]
wr_field=[
'DESCRI
]
wr_op=[
'=
]
wr_var=[
'Substr(riga,4,100)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O1548
rd_field=[
'CODICE
]
rd_kfield=[
'CODICE
]
rd_kvar=[
'Left(riga,3)
]
rd_var=[
'_code3
]
I
obj='Var
pag=2
prev=O1547
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O1532
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1528
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=2
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=2
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O1334
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1336
fatherSonIndex=0
frm_calc=[
'w_tbprovsv='S'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1580
fatherSonIndex=0
next=Icpitembatch.CPTry
h=[
19
19
19
]
obj='Try
pag=2
prev=O1585
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1586
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbprovsv.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPDelete
arch='tbprovsv
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('newtab/tbprovsv.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbprovsv.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=2
prev=O1596
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O1595
var_op='asgn
I
obj='Exec
pag=2
prev=O1593
I
obj='While
pag=2
prev=O1592
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1593
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=2
prev=O1600
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1601
fatherSonIndex=0
frm_calc=''TBPROVSV - Inserimento codice '+ Substr(riga,1,2)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_code
next=Icpitembatch.CPRead
arch='tbprovsv
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O1608
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbprovsv
father=O1609
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'SIGLA
'PROVINCIA
'SIGLASV
]
rd_kvar=[
'Left(riga,2)
'Upper(Substr(riga,3,30))
'Upper(Substr(riga,33,5))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbprovsv
father=O1609
fatherSonIndex=1
obj='Write
pag=2
rd_kfield=[
'SIGLA
'SIGLASV
]
rd_kop=[
'=
'=
]
rd_kvar=[
'Left(riga,2)
'Upper(Substr(riga,33,5))
]
wr_field=[
'PROVINCIA
]
wr_op=[
'=
]
wr_var=[
'Upper(Substr(riga,3,30))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O1607
rd_field=[
'SIGLA
]
rd_kfield=[
'SIGLA
'SIGLASV
]
rd_kvar=[
'Substr(riga,1,2)
'Upper(Substr(riga,33,5))
]
rd_var=[
'_code
]
I
obj='Var
pag=2
prev=O1606
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O1591
var_op='asgn
I
obj='Delete
pag=2
prev=O1590
sel_type='all
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1586
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=2
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=2
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O1332
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1334
fatherSonIndex=0
frm_calc=[
'w_tbluonas='S'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1639
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file comuni_ccat.res' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/comuni_ccat.res')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file comuni_ccat.res' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O1648
var_op='asgn
I
obj='Exec
pag=2
prev=O1646
I
obj='While
pag=2
prev=O1645
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1646
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=2
prev=O1652
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1653
fatherSonIndex=0
frm_calc=''TBLUONAS - Inserimento codice '+ Substr(riga,At("*",riga)+1,4)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=4
name='_code4
next=Icpitembatch.CPRead
arch='tbluonas
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code4)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O1660
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbluonas
father=O1661
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'SIGLA
'DESCRI
'PROVINCIA
]
rd_kvar=[
'Substr(riga,At("*",riga)+1,4)
'Left(riga,At("*",riga)-1)
'Right(LRTrim(riga),2)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbluonas
father=O1661
fatherSonIndex=1
obj='Write
pag=2
rd_kfield=[
'SIGLA
]
rd_kop=[
'=
]
rd_kvar=[
'Substr(riga,At("*",riga)+1,4)
]
wr_field=[
'DESCRI
'PROVINCIA
]
wr_op=[
'=
'=
]
wr_var=[
'Left(riga,At("*",riga)-1)
'Right(LRTrim(riga),2)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O1659
rd_field=[
'SIGLA
]
rd_kfield=[
'SIGLA
]
rd_kvar=[
'Substr(riga,At("*",riga)+1,4)
]
rd_var=[
'_code4
]
I
obj='Var
pag=2
prev=O1658
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O1644
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O1330
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1332
fatherSonIndex=0
frm_calc=[
'w_tbcandistr='S'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1688
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbcandistr.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/tbcandistr.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbcandistr.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O1697
var_op='asgn
I
obj='Exec
pag=2
prev=O1695
I
obj='While
pag=2
prev=O1694
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1695
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=2
prev=O1701
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1702
fatherSonIndex=0
frm_calc=''TBCANDISTR - Inserimento codice '+ Substr(riga,1,3)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=3
name='_code3
next=Icpitembatch.CPRead
arch='tbcandistr
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code3)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O1709
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbcandistr
father=O1710
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'CODICE
'DESCRI
]
rd_kvar=[
'Left(riga,3)
'Substr(riga,4,50)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbcandistr
father=O1710
fatherSonIndex=1
obj='Write
pag=2
rd_kfield=[
'CODICE
]
rd_kop=[
'=
]
rd_kvar=[
'Left(riga,3)
]
wr_field=[
'DESCRI
]
wr_op=[
'=
]
wr_var=[
'Substr(riga,4,50)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O1708
rd_field=[
'CODICE
]
rd_kfield=[
'CODICE
]
rd_kvar=[
'Substr(riga,1,3)
]
rd_var=[
'_code3
]
I
obj='Var
pag=2
prev=O1707
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O1693
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O1328
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1330
fatherSonIndex=0
frm_calc=[
'w_staticrs='S'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1737
fatherSonIndex=0
next=Icpitembatch.CPTry
h=[
19
19
19
]
obj='Try
pag=2
prev=O1742
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='tbstatiocse
father=O1743
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'pTipo='P'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('newtab/stati_ocse.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPIfElse
frm_calc=[
'pTipo='P'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=2
prev=O1755
I
obj='If
pag=2
prev=O1754
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1755
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file stati_ocse.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMessage
father=O1755
fatherSonIndex=1
frm_calc=''Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file stati_ocse.txt'
msg_type='Info
obj='Message
pag=2
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=2
prev=O1752
I
obj='While
pag=2
prev=O1751
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1752
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=2
prev=O1767
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1768
fatherSonIndex=0
frm_calc=[
'pTipo='P'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=5
name='_id
next=Icpitembatch.CPRead
arch='tbstatiocse
next=Icpitembatch.CPIfElse
frm_calc=[
'_id=0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O1777
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbstatiocse
father=O1778
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'NUMERO
'DESCRI
'ANNO
'STATOUIF
]
rd_kvar=[
'Val(LRTrim(Left(riga,3)))
'LRTrim(Substr(riga,4,40))
'Val(LRTrim(Substr(riga,44,4)))
'LRTrim(Substr(riga,48,3))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbstatiocse
father=O1778
fatherSonIndex=1
obj='Write
pag=2
rd_kfield=[
'NUMERO
]
rd_kop=[
'=
]
rd_kvar=[
'Val(LRTrim(Left(riga,3)))
]
wr_field=[
'DESCRI
'ANNO
'STATOUIF
]
wr_op=[
'=
'=
'=
]
wr_var=[
'LRTrim(Substr(riga,4,40))
'Val(LRTrim(Substr(riga,44,4)))
'LRTrim(Substr(riga,48,3))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O1776
rd_field=[
'NUMERO
]
rd_kfield=[
'NUMERO
]
rd_kvar=[
'Val(LRTrim(Substr(riga,1,3)))
]
rd_var=[
'_id
]
I
obj='Var
obj_type='N
pag=2
prev=O1773
var_op='asgn
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1773
fatherSonIndex=0
frm_calc=''TBSTATIOCSE - Inserimento codice '+ Substr(riga,1,3)
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O1748
var_op='asgn
I
obj='If
pag=2
prev=O1747
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1748
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file stati_ocse.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMessage
father=O1748
fatherSonIndex=1
frm_calc=' 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file stati_ocse.txt'
msg_type='Info
obj='Message
pag=2
I
I
]
w=[
150
150
150
]
I
obj='Delete
pag=2
sel_type='all
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1743
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=2
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=2
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O1326
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1328
fatherSonIndex=0
frm_calc=[
'w_convgio='S'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1818
fatherSonIndex=0
next=Icpitembatch.CPTry
h=[
19
19
19
]
obj='Try
pag=2
prev=O1823
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPDelete
arch='cgo_tbconvgio
father=O1824
fatherSonIndex=0
next=Icpitembatch.CPIfElse
frm_calc=[
'pTipo='P'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('newtab/convgioco.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPIfElse
frm_calc=[
'pTipo='P'
]
h=[
19
19
19
]
haselse=True
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=2
prev=O1836
I
obj='If
pag=2
prev=O1835
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1836
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file convgioco.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMessage
father=O1836
fatherSonIndex=1
frm_calc=''Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file convgioco.txt'
msg_type='Info
obj='Message
pag=2
I
I
]
w=[
150
150
150
]
I
obj='Exec
pag=2
prev=O1833
I
obj='While
pag=2
prev=O1832
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1833
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=2
prev=O1848
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1849
fatherSonIndex=0
frm_calc=[
'pTipo='P'
]
h=[
19
19
]
next=Icpitembatch.CPVarDecl
frm_calc='0
len=5
name='_id
next=Icpitembatch.CPRead
arch='cgo_tbconvgio
next=Icpitembatch.CPIfElse
frm_calc=[
'_id=0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O1858
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='cgo_tbconvgio
father=O1859
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'CODGIO
'TIPGIO
]
rd_kvar=[
'Val(LRTrim(Left(riga,3)))
'LRTrim(Substr(riga,4,3))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='cgo_tbconvgio
father=O1859
fatherSonIndex=1
obj='Write
pag=2
rd_kfield=[
'CODGIO
]
rd_kop=[
'=
]
rd_kvar=[
'Val(LRTrim(Left(riga,3)))
]
wr_field=[
'TIPGIO
]
wr_op=[
'=
]
wr_var=[
'LRTrim(Substr(riga,4,3))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O1857
rd_field=[
'CODGIO
]
rd_kfield=[
'CODGIO
]
rd_kvar=[
'Val(LRTrim(Substr(riga,1,3)))
]
rd_var=[
'_id
]
I
obj='Var
obj_type='N
pag=2
prev=O1854
var_op='asgn
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1854
fatherSonIndex=0
frm_calc=''CONVGIOCO - Inserimento codice '+ Substr(riga,1,3)
global=True
len=120
name='gMsgImp
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O1829
var_op='asgn
I
obj='If
pag=2
prev=O1828
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1829
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file convgioco.txt' + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPMessage
father=O1829
fatherSonIndex=1
frm_calc=' 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file convgioco.txt'
msg_type='Info
obj='Message
pag=2
I
I
]
w=[
150
150
150
]
I
obj='Delete
pag=2
sel_type='all
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1824
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=2
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=2
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O1324
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1326
fatherSonIndex=0
frm_calc=[
'w_tbesielb='S'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1899
fatherSonIndex=0
next=Icpitembatch.CPTry
h=[
19
19
19
]
obj='Try
pag=2
prev=O1904
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1905
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbesielb.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/tbesielb.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbesielb.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=2
prev=O1914
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O1913
var_op='asgn
I
obj='Exec
pag=2
prev=O1911
I
obj='While
pag=2
prev=O1910
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1911
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=2
prev=O1918
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1919
fatherSonIndex=0
frm_calc=''TBESIELB - Inserimento codice '+ Substr(riga,1,3)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=2
name='_code
next=Icpitembatch.CPRead
arch='tbesielb
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code3)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O1926
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbesielb
father=O1927
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'EECODICE
'EEDESCRI
'EELETINI
]
rd_kvar=[
'Left(riga,3)
'LRTrim(Substr(riga,4,128))
'Upper(Substr(riga,132,1))
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbesielb
father=O1927
fatherSonIndex=1
obj='Write
pag=2
rd_kfield=[
'EECODICE
]
rd_kop=[
'=
]
rd_kvar=[
'Left(riga,3)
]
wr_field=[
'EEDESCRI
'EELETINI
]
wr_op=[
'=
'=
]
wr_var=[
'LRTrim(Substr(riga,4,128))
'Upper(Substr(riga,132,1))
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O1925
rd_field=[
'EECODICE
]
rd_kfield=[
'EECODICE
]
rd_kvar=[
'Substr(riga,1,3)
]
rd_var=[
'_code3
]
I
obj='Var
pag=2
prev=O1924
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O1909
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O1905
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=2
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=2
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
prev=O1322
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1324
fatherSonIndex=0
frm_calc=[
'w_inter2bo='S'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1957
fatherSonIndex=0
frm_calc='Utilities.GetCompany()
len=10
name='_oldazi
next=Icpitembatch.CPSelect
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='Utilities.SetCompany(_oldazi)
obj='Exec
pag=2
prev=O1963
I
obj='Select
pag=2
prev=O1962
sel_field='*
sel_name='cpazi
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1963
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file abicab.txt - Azienda: '+cpazi->CODAZI + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPExec
frm_calc='Utilities.SetCompany(cpazi->codazi)
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('newtab/abicab.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file abicab.txt - Azienda: '+cpazi->CODAZI + NL
global=True
len=10
name='gMsgProc
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O1973
var_op='asgn
I
obj='Exec
pag=2
prev=O1971
I
obj='While
pag=2
prev=O1970
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1971
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=2
prev=O1977
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPIfElse
father=O1978
fatherSonIndex=0
frm_calc=[
'Left(riga,1)='1'
]
h=[
19
19
]
next=Icpitembatch.CPIfElse
frm_calc=[
'Left(riga,1)='2'
]
h=[
19
19
]
obj='If
pag=2
prev=O1983
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1986
fatherSonIndex=0
frm_calc=''ABICAB - Inserimento codice '+ Substr(riga,3,5)+"-"+Substr(riga,8,5)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=11
name='_code11
next=Icpitembatch.CPRead
arch='inter2bo
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(_code11)) = 0
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O1993
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='inter2bo
father=O1994
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'CODINTER
'RAGSOC
'CODCAB
'DOMICILIO
'CODFISC
'DESCCIT
'PROVINCIA
'CAP
'PAESE
'TIPINTER
]
rd_kvar=[
'Substr(riga,3,5)+"-"+Substr(riga,8,5)
'_dbaicab
'Substr(riga,14,6)
'Substr(riga,21,35)
'Substr(riga,3,5)
'Substr(riga,141,30)
'Substr(riga,186,2)
'Substr(riga,181,5)
''086'
''02'
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='inter2bo
father=O1994
fatherSonIndex=1
obj='Write
pag=2
rd_kfield=[
'CODINTER
]
rd_kop=[
'=
]
rd_kvar=[
'Substr(riga,3,5)+"-"+Substr(riga,8,5)
]
wr_field=[
'RAGSOC
'CODCAB
'DOMICILIO
'CODFISC
'DESCCIT
'PROVINCIA
'CAP
'PAESE
'TIPINTER
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'_dbaicab
'Substr(riga,14,6)
'Substr(riga,21,35)
'Substr(riga,3,5)
'Substr(riga,141,30)
'Substr(riga,186,2)
'Substr(riga,181,5)
''086'
''02'
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O1992
rd_field=[
'CODINTER
]
rd_kfield=[
'CODINTER
]
rd_kvar=[
'Substr(riga,3,5)+"-"+Substr(riga,8,5)
]
rd_var=[
'_code11
]
I
obj='Var
pag=2
prev=O1991
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O1983
fatherSonIndex=0
frm_calc='Substr(riga,14,70)
len=70
name='_dbaicab
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O1969
var_op='asgn
I
obj='Exec
pag=2
prev=O1968
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
I
obj='Begin
pag=2
sons=[
Icpitembatch.CPItemSon
collapsed=True
instr=Icpitembatch.CPIfElse
father=O1322
fatherSonIndex=0
frm_calc=[
'w_tbcittna='S'
]
h=[
19
19
]
obj='If
pag=2
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O2027
fatherSonIndex=0
next=Icpitembatch.CPTry
h=[
19
19
19
]
obj='Try
pag=2
prev=O2032
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2033
fatherSonIndex=0
frm_calc='gMsgProc + 'Ora Inizio Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbcittna.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPVarDecl
frm_calc='FileLibMit.OpenRead('./newtab/tbcittna.txt')
len=1
name='fhand
next=Icpitembatch.CPWhile
frm_calc='not(FileLibMit.Eof(fhand))
h=[
19
19
]
next=Icpitembatch.CPExec
frm_calc='FileLibMit.Close(fhand)
next=Icpitembatch.CPVarDecl
frm_calc='gMsgProc + 'Ora Fine Processo: '+ arfn_fdatetime(DateTime()) + ' del file tbcittna.txt' + NL
global=True
len=10
name='gMsgProc
next=Icpitembatch.CPTransaction
frm_calc='commit
obj='Transaction
pag=2
prev=O2042
I
nonlocal=True
obj='Var
obj_type='M
pag=2
prev=O2041
var_op='asgn
I
obj='Exec
pag=2
prev=O2039
I
obj='While
pag=2
prev=O2038
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2039
fatherSonIndex=0
frm_calc='FileLibMit.ReadLine(fhand)
len=10
name='riga
next=Icpitembatch.CPIfElse
frm_calc=[
'Len(LRTrim(riga)) > 0
]
h=[
19
19
]
obj='If
pag=2
prev=O2046
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPVarDecl
father=O2047
fatherSonIndex=0
frm_calc=''TBCITTNA - Inserimento Città '+ Substr(riga,2,40)
global=True
len=120
name='gMsgImp
next=Icpitembatch.CPVarDecl
frm_calc='''
len=40
name='_code40
next=Icpitembatch.CPRead
arch='tbcittna
next=Icpitembatch.CPIfElse
frm_calc=[
'Empty(LRTrim(_code40))
]
h=[
19
19
19
]
haselse=True
obj='If
pag=2
prev=O2054
sons=[
Icpitembatch.CPItemSon
instr=Icpitembatch.CPInsert
arch='tbcittna
father=O2055
fatherSonIndex=0
obj='Insert
pag=2
rd_kfield=[
'IDTBLS
'IDBASE
'IDCITTA
'IDISTAT
'CITTA
'CITTAX
'IDREGIO
'PROV
'CAB
'SIGLA
'CAP
'PREF
'DATAINI
'DATAFIN
'ATTCES
'CODID
]
rd_kvar=[
'Left(riga,1)
'Substr(riga,2,40)
'Substr(riga,42,5)
'Substr(riga,47,6)
'Substr(riga,53,60)
'Substr(riga,113,40)
'Substr(riga,153,2)
'Substr(riga,155,2)
'Substr(riga,157,6)
'Substr(riga,163,4)
'Substr(riga,167,5)
'Substr(riga,172,5)
'CharToDate(Substr(riga,177,8))
'CharToDate(Substr(riga,185,8))
'Substr(riga,193,1)
'Substr(riga,194,8)
]
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPWrite
arch='tbcittna
father=O2055
fatherSonIndex=1
obj='Write
pag=2
rd_kfield=[
'IDBASE
]
rd_kop=[
'=
]
rd_kvar=[
'_code40
]
wr_field=[
'IDCITTA
'IDISTAT
'CITTA
'CITTAX
'IDREGIO
'PROV
'CAB
'SIGLA
'CAP
'PREF
'DATAINI
'DATAFIN
'ATTCES
'CODID
]
wr_op=[
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
'=
]
wr_var=[
'Substr(riga,42,5)
'Substr(riga,47,6)
'Substr(riga,53,60)
'Substr(riga,113,40)
'Substr(riga,153,2)
'Substr(riga,155,2)
'Substr(riga,157,6)
'Substr(riga,163,4)
'Substr(riga,167,5)
'Substr(riga,172,5)
'CharToDate(Substr(riga,177,8))
'CharToDate(Substr(riga,185,8))
'Substr(riga,193,1)
'Substr(riga,194,8)
]
I
I
]
w=[
150
150
150
]
I
obj='Read
pag=2
prev=O2053
rd_field=[
'IDBASE
]
rd_kfield=[
'IDBASE
]
rd_kvar=[
'Substr(riga,2,40)
]
rd_var=[
'_code40
]
I
obj='Var
pag=2
prev=O2052
var_op='asgn
I
nonlocal=True
obj='Var
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
]
w=[
150
150
]
I
obj='Var
pag=2
prev=O2037
var_op='asgn
I
nonlocal=True
obj='Var
obj_type='M
pag=2
var_op='asgn
I
I
Icpitembatch.CPItemSon
instr=Icpitembatch.CPTransaction
father=O2033
fatherSonIndex=1
frm_calc='rollback
obj='Transaction
pag=2
I
I
]
w=[
150
150
150
]
I
obj='Transaction
pag=2
I
I
]
w=[
150
150
]
I
I
]
w=[
150
150
]
x=12
y=17
I
]
comment='Importa i valori delle nuove tabelle
date_creat=#2010-05-31
date_rev=#2021-11-11
dic_name='plan
ev_class='SPBatchEvents
libraries=[
'Utilities
'LibreriaMit
'FileLibMit
]
modcnt=154
page_result_class=[
'
'
]
page_result_type=[
'U
'U
]
page_uid=[
'UHAXUKJSYG
'FXXIIVLWZH
]
pagename=[
'Page_1
'Page_2
]
pagenote=[
'
'
]
pagetitle=[
'Principale
'Estensione
]
runtime_filters=2
tpl_name='Routine
work_file=[
'personbo
'tbcitta
'tbtipint
'cauanainter
'tbtipreg
'tbstati
'tbvalute
'tbcauana
'tbcausin
'aefiles
'tbsetsin
'inter2bo
'cpazi
'f_xbrl_def
'xbrl_def
'tbesitoae
'tbrapp
'tbstgru
'tbramgru
'tbtipdoc
'tbtipleg
'tbtipnat
'tberrorisid
'tberrsiddgn
'tbricevutesid
'tbstatna
'tbcittna
'tbsetsina
'tberrdge
'tbprvreg
'tbesielb
'tbnascita
'cgo_tbconvgio
'tbstatiocse
'DecodeCitta
'tbcandistr
'tbluonas
'tbprovsv
'tbrappogg
'tbnatura
'tbscopo
'tbrisglob
]
work_filter=[
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
'
]
I
*--*
*----*
